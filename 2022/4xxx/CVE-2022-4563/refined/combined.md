=== Content from securedrop.org_9e236742_20250114_182945.html ===

[Skip to content](#title)
# Have a document to share?

## You are not anonymous while using this browser!

Here's what you need to do to download Tor Browser to be anonymous online:

1. Go to <https://www.torproject.org>.
2. Download and install Tor Browser.
3. Launch Tor Browser and return to this site. You are now anonymous online.

# Your Tor security settings are too low!

## Set your Tor security level to "Safest" for maximum protection

1. Click the **shield** **icon** in the browser toolbar
2. Click **Advanced Security Settings**
3. Select **Safest** and close the **Preferences** tab
4. Refresh the page

# Have a document to share?

## Follow these steps to protect your anonymity:

1. Choose a safe location, not a work computer.
2. Download the desktop version of Tor Browser from <https://www.torproject.org/>
3. Launch Tor Browser and return to this site. You are are now anonymous online.

## Main menu

[Home
![](/static/images/logo_solid-HappyKeyhole.svg)
![](/static/images/logo_solid-HappyKeyhole-3x.png)

![Securedrop](/static/images/_site_title.svg)
![Securedrop](/static/images/site_title.png)](/)

* [Overview](/overview/)
* [List of SecureDrops](/directory/)
* [News](/news/)
* [Contribute](/contribute/)
* [Donate](https://freedom.press/donate/)
* [Docs](https://docs.securedrop.org/en/stable/)
* [Research](/research/)
* [![Search](/static/images/search.svg)
  ![Search](/static/images/search.png)](/search)

## Mobile menu

SecureDrop Logo in Color

* [Home](/)
* [Overview](/overview/)
* [List of SecureDrops](/directory/)
* [News](/news/)
* [Contribute](/contribute/)
* [Donate](https://freedom.press/donate/)
* [Docs](https://docs.securedrop.org/en/stable/)
* [Research](/research/)

## [Security Advisory](/news/security-advisory/)

# Security Advisory: Permissions-related vulnerability

December 12, 2022

A security issue was found on the SecureDrop server environment during an internal code audit. [SecureDrop 2.5.1](/news/securedrop-2_5_1-released/) has been released to fix this issue; SecureDrops should automatically update within 24 hours. The vulnerability was not exploitable remotely and requires an attacker to already have code execution on the server.

The core issue was incorrect ownership of executable Python code in `/var/www/securedrop`. As the folder was owned by the web application user, `www-data`, it was possible to edit the management script (`manage.py`) or any of its dependencies and trigger code execution by root via multiple vectors.

We have fixed the main permission issue by [changing](https://github.com/freedomofpress/securedrop/commit/228f7b63d70b33a8dabb673fd23bc05ce7c1139b) all executable files to be only writable by root, as well as de-privileging any command that does not require root permissions in the first place. Now `www-data` can no longer modify executable files, Python bytecode or the instance configuration. The cronjobs are [now triggered](https://github.com/freedomofpress/securedrop/commit/efb2c766fe388c9cb22ac8c7bb5c89c214b7ddce) from the `www-data` private crontab. In the [OSSEC monitoring rules](https://github.com/freedomofpress/securedrop/commit/6b4147b3adc29b4ee01e41a764d89ee785c72a3b) and the `securedrop-app-code` package [postinstall script](https://github.com/freedomofpress/securedrop/commit/9fc2cb19a510fb7dd9e66e96aa87a501c8e266b1), every command that does not need elevated privileges is prefixed with `sudo -u www-data`, with specific attention paid to any read or write operation potentially vulnerable to symlink attacks.

SecureDrop attempts to bring defense in depth on its server configuration, by employing hardening measures such as strict AppArmor profiles for Internet-facing services and a grsecurity-hardened kernel. We discovered the vulnerability as part of an internal round of hardening, in which we are actively reviewing system configurations to add further defence in the event of an attacker achieving unprivileged local code execution.

The vulnerability has a score of High according to [CVSSv3](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator):

CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:H

However, in order to exploit it, as the A(ttack) V(ector) is defined as L(ocal), code execution is a strict requirement. As such, the vulnerability is a local privilege escalation only.

Researchers may submit any security vulnerability either through our [bug bounty program](https://bugcrowd.com/freedomofpress), or via encrypted email to securedrop@freedom.press ([public key](https://media.securedrop.org/media/documents/fpf-email.asc), fingerprint: 734F 6E70 7434 ECA6 C007 E1AE 82BD 6C96 16DA BB79).

[Return to
News](/news/)

## Get support

![Search](/static/images/search.svg)
![Search](/static/images/search.png)

Search

Search

* [Priority Support](/priority-support/)
* [Documentation](https://docs.securedrop.org)
* [Journalist Guide](https://docs.securedrop.org/en/stable/journalist.html)
* [Administrator Guide](https://docs.securedrop.org/en/stable/admin.html)
* [Install SecureDrop](https://docs.securedrop.org/en/stable/admin/installation/installation_overview.html)
* [Request Help](/help/)
* [Training](/training/)

[Donate](https://freedom.press/donate)
[Contribute](/contribute/)

![White cube with keyhole (Securedrop logo)](/static/images/logo_transparent-footer-HappyKeyhole2.svg)
![White cube with keyhole (Securedrop logo)](/static/images/logo_transparent-HappyKeyhole-1x.png)

SecureDrop is a project of [Freedom of the Press Foundation](https://freedom.press)

### Footer navigation

* [Donate](https://freedom.press/donate/)
* [Contribute](/contribute/)
* [Privacy policy](https://freedom.press/privacy-policy/)
* [Contact Form](/help/)
* [News](/news/)

[![Mastodon Profile](/static/images/mastodon.svg)
![Mastodon Profile](/static/images/mastodon.png)](https://social.freedom.press/%40securedrop)

[![Twitter Profile](/static/images/twitter.svg)
![Twitter Profile](/static/images/twitter.png)](https://twitter.com/securedrop)

SecureDrop release signing key (not for communication)
[2359 E653 8C06 13E6 5295 5E6C 188E DD3B 7B22 E6A3](https://media.securedrop.org/media/documents/securedrop-release-key-2021-3.asc)

Tor address
sdolvtfhatvsysc6l34d65ymdwxcujausv7k5jk4cy5ttzhjoi6fzvyd.onion

![](https://analytics.freedom.press/piwik.php?idsite=3)



=== Content from github.com_25b054ce_20250114_182943.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreedomofpress%2Fsecuredrop%2Fpull%2F6704)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreedomofpress%2Fsecuredrop%2Fpull%2F6704)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=freedomofpress%2Fsecuredrop)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[freedomofpress](/freedomofpress)
/
**[securedrop](/freedomofpress/securedrop)**
Public

* [Notifications](/login?return_to=%2Ffreedomofpress%2Fsecuredrop) You must be signed in to change notification settings
* [Fork
  688](/login?return_to=%2Ffreedomofpress%2Fsecuredrop)
* [Star
   3.6k](/login?return_to=%2Ffreedomofpress%2Fsecuredrop)

* [Code](/freedomofpress/securedrop)
* [Issues
  451](/freedomofpress/securedrop/issues)
* [Pull requests
  22](/freedomofpress/securedrop/pulls)
* [Actions](/freedomofpress/securedrop/actions)
* [Projects
  1](/freedomofpress/securedrop/projects)
* [Wiki](/freedomofpress/securedrop/wiki)
* [Security](/freedomofpress/securedrop/security)
* [Insights](/freedomofpress/securedrop/pulse)

Additional navigation options

* [Code](/freedomofpress/securedrop)
* [Issues](/freedomofpress/securedrop/issues)
* [Pull requests](/freedomofpress/securedrop/pulls)
* [Actions](/freedomofpress/securedrop/actions)
* [Projects](/freedomofpress/securedrop/projects)
* [Wiki](/freedomofpress/securedrop/wiki)
* [Security](/freedomofpress/securedrop/security)
* [Insights](/freedomofpress/securedrop/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ffreedomofpress%2Fsecuredrop%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ffreedomofpress%2Fsecuredrop%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Apply 2.5.1 fixes to develop #6704

 Merged

[zenmonkeykstop](/zenmonkeykstop)
merged 7 commits into
[develop](/freedomofpress/securedrop/tree/develop "freedomofpress/securedrop:develop")
from
[251-on-develop](/freedomofpress/securedrop/tree/251-on-develop "freedomofpress/securedrop:251-on-develop")

Dec 9, 2022

 Merged

# [Apply 2.5.1 fixes to develop](#top) #6704

[zenmonkeykstop](/zenmonkeykstop)
merged 7 commits into
[develop](/freedomofpress/securedrop/tree/develop "freedomofpress/securedrop:develop")
from
[251-on-develop](/freedomofpress/securedrop/tree/251-on-develop "freedomofpress/securedrop:251-on-develop")

Dec 9, 2022

[Conversation
1](/freedomofpress/securedrop/pull/6704)
[Commits
7](/freedomofpress/securedrop/pull/6704/commits)
[Checks
0](/freedomofpress/securedrop/pull/6704/checks)
[Files changed](/freedomofpress/securedrop/pull/6704/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![legoktm](https://avatars.githubusercontent.com/u/81392?s=60&v=4)](/legoktm)

Copy link

Member

### @legoktm **[legoktm](/legoktm)** commented [Dec 8, 2022](#issue-1485326568) • edited by zenmonkeykstop Loading

## Status

Ready for review

## Description of Changes

Rebase of the 2.5.1 patches onto develop.

## Testing

* Check that all commits from <https://github.com/freedomofpress/securedrop/commits/release/2.5.1> except the "SecureDrop 2.5.1" release one are on develop or in this PR
* CI passes

Other than that, all the commits have already gone through pretty rigorous testing.

Sorry, something went wrong.

All reactions

 [legoktm](/legoktm)
added 6 commits
[December 8, 2022 13:19](#commits-pushed-5e45b3f)

[![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

`[Fix permissions on /var/www/securedrop](/freedomofpress/securedrop/pull/6704/commits/5e45b3f74bf0a6a9ec1030c7c34f8b11d6b0b19d "Fix permissions on /var/www/securedrop

/var/www/securedrop is now root-owned but world readable. This ensures
that code can only be added/modified/removed by root, not www-data.

The package already installs files /var/www/securedrop with the correct
permissions, we were just clobbering it in the postinst, which is now
removed. We have an explicit chmod to adjust directory permissions.

We need special handling for config.py since it is installed by ansible
instead of the package. Since it contains secrets, we want it to be
only-readable by root/www-data and no one else.

The custom_logo.png is writable by www-data so administrators can change
the logo from the web interface. In the future this could be moved
somewhere else. The file may not exist yet (fresh installs), so we create
it if necessary.

testinfra checks have been updated with the new permissions and took the
time to de-duplicate the list of app directories in 7 different yaml files.")`
 …

`[5e45b3f](/freedomofpress/securedrop/pull/6704/commits/5e45b3f74bf0a6a9ec1030c7c34f8b11d6b0b19d)`

```
/var/www/securedrop is now root-owned but world readable. This ensures
that code can only be added/modified/removed by root, not www-data.

The package already installs files /var/www/securedrop with the correct
permissions, we were just clobbering it in the postinst, which is now
removed. We have an explicit chmod to adjust directory permissions.

We need special handling for config.py since it is installed by ansible
instead of the package. Since it contains secrets, we want it to be
only-readable by root/www-data and no one else.

The custom_logo.png is writable by www-data so administrators can change
the logo from the web interface. In the future this could be moved
somewhere else. The file may not exist yet (fresh installs), so we create
it if necessary.

testinfra checks have been updated with the new permissions and took the
time to de-duplicate the list of app directories in 7 different yaml files.
```

[![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

`[Manipulate gpg config file as www-data](/freedomofpress/securedrop/pull/6704/commits/b0526a06f8ca713cce74b63e00d3730618d89691 "Manipulate gpg config file as www-data

An attacker with access to www-data could have gpg-agent.conf be a
symlink to a root-owned file (e.g. /etc/passwd) and trick the postinst
into clobbering that file as root. Because the content is fixed, it's
pretty low risk but straightforward to fix.")`
 …

`[b0526a0](/freedomofpress/securedrop/pull/6704/commits/b0526a06f8ca713cce74b63e00d3730618d89691)`

```
An attacker with access to www-data could have gpg-agent.conf be a
symlink to a root-owned file (e.g. /etc/passwd) and trick the postinst
into clobbering that file as root. Because the content is fixed, it's
pretty low risk but straightforward to fix.
```

[![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

`[Run manage.py cron jobs as www-data](/freedomofpress/securedrop/pull/6704/commits/9169606decd3c81c38ffba95dd0f51c72cba66e7 "Run manage.py cron jobs as www-data

* Add a postinst snippet to migrate the root crontab over to www-data
  on upgrade.
* Modify ansible task to install cron jobs for www-data on new installs
* Update testinfra checks to look at the www-data cron for the tmp
  cleaning job and verify that root's crontab is empty.")`
 …

`[9169606](/freedomofpress/securedrop/pull/6704/commits/9169606decd3c81c38ffba95dd0f51c72cba66e7)`

```
* Add a postinst snippet to migrate the root crontab over to www-data
  on upgrade.
* Modify ansible task to install cron jobs for www-data on new installs
* Update testinfra checks to look at the www-data cron for the tmp
  cleaning job and verify that root's crontab is empty.
```

[![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

`[Avoid running Python code as root in postinst](/freedomofpress/securedrop/pull/6704/commits/228a434891b763a762d707257a923aaf9a464d3c "Avoid running Python code as root in postinst

There's no need for us to run this as root, all the files alembic needs
to touch (primarily the SQLite database) are writable by www-data. We
specifically run the backup copying and deletion steps as www-data too
so symlink attacks can't be used to have root clobber other files.

For `mod_wsgi-express module-config`, we ship the generated file in the
package itself. In a future (non-hotfix) release we will generate the
file at build-time instead of hardcoding it.")`
 …

`[228a434](/freedomofpress/securedrop/pull/6704/commits/228a434891b763a762d707257a923aaf9a464d3c)`

```
There's no need for us to run this as root, all the files alembic needs
to touch (primarily the SQLite database) are writable by www-data. We
specifically run the backup copying and deletion steps as www-data too
so symlink attacks can't be used to have root clobber other files.

For `mod_wsgi-express module-config`, we ship the generated file in the
package itself. In a future (non-hotfix) release we will generate the
file at build-time instead of hardcoding it.
```

[![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

`[Run OSSEC checks as www-data](/freedomofpress/securedrop/pull/6704/commits/411946a2f4336e1e18ac88259a9c07ae268df09f "Run OSSEC checks as www-data")`

`[411946a](/freedomofpress/securedrop/pull/6704/commits/411946a2f4336e1e18ac88259a9c07ae268df09f)`

[![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

`[Don't hardcode username/repository in CI config, support private forks](/freedomofpress/securedrop/pull/6704/commits/f2466b3074cd7b2081461354cdd3c682b36e6ccd "Don't hardcode username/repository in CI config, support private forks

Makes it possible to run CI in forks. For a private repository,
you'll need to set up a personal access token[1] and store it as a
\"GITHUB_AUTH\" environment variable in CircleCI.

[1] https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token")`
 …

`[f2466b3](/freedomofpress/securedrop/pull/6704/commits/f2466b3074cd7b2081461354cdd3c682b36e6ccd)`

```
Makes it possible to run CI in forks. For a private repository,
you'll need to set up a personal access token[1] and store it as a
"GITHUB_AUTH" environment variable in CircleCI.

[1] <https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token>
```

 [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)
[legoktm](/legoktm)
requested a review
from a team
as a [code owner](/freedomofpress/securedrop/blob/49fa4b0347f3ad1d83b7b77cc594082ba83e33fb/.github/CODEOWNERS#L1)
[December 8, 2022 20:07](#event-7992582127)

[![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

`[Add SecureDrop 2.5.1 changelog entry](/freedomofpress/securedrop/pull/6704/commits/6935e7c61f497b84d73c33978bb463109bebc593 "Add SecureDrop 2.5.1 changelog entry")`

`[6935e7c](/freedomofpress/securedrop/pull/6704/commits/6935e7c61f497b84d73c33978bb463109bebc593)`

[![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=40&v=4)](/zenmonkeykstop)
[zenmonkeykstop](/zenmonkeykstop)
self-assigned this
[Dec 9, 2022](#event-8000022256)

[![zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=60&v=4)](/zenmonkeykstop)

**[zenmonkeykstop](/zenmonkeykstop)**
approved these changes
[Dec 9, 2022](#pullrequestreview-1212233419)

 [View reviewed changes](/freedomofpress/securedrop/pull/6704/files/6935e7c61f497b84d73c33978bb463109bebc593)

Copy link

Contributor

### @zenmonkeykstop **[zenmonkeykstop](/zenmonkeykstop)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM (replicated the cherry-picking process and compared just to be sure).

Sorry, something went wrong.

All reactions

[![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=40&v=4)](/zenmonkeykstop)
[zenmonkeykstop](/zenmonkeykstop)
merged commit [`aa8fe5b`](/freedomofpress/securedrop/commit/aa8fe5b25a75efd6620bad3be9d6037542948c47)
into
develop

[Dec 9, 2022](https://github.com/freedomofpress/securedrop/pull/6704#event-8001884814)

[![@cfm](https://avatars.githubusercontent.com/u/357435?s=40&v=4)](/cfm)
[cfm](/cfm)
mentioned this pull request
[Oct 10, 2023](#ref-issue-1936133727)

[Regression: OSSEC sending daily login reports, even if a user hasn't logged in
#6982](/freedomofpress/securedrop/issues/6982)

Closed

 [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)
[legoktm](/legoktm)
deleted the
251-on-develop

branch
[January 9, 2025 22:04](#event-15874109329)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreedomofpress%2Fsecuredrop%2Fpull%2F6704)

Reviewers

[![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=40&v=4)](/zenmonkeykstop) [zenmonkeykstop](/zenmonkeykstop)

zenmonkeykstop approved these changes

Assignees

[![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=40&v=4)](/zenmonkeykstop) [zenmonkeykstop](/zenmonkeykstop)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@legoktm](https://avatars.githubusercontent.com/u/81392?s=52&v=4)](/legoktm) [![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=52&v=4)](/zenmonkeykstop)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2ae28d1a_20250114_182940.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreedomofpress%2Fsecuredrop%2Fcommit%2Fb0526a06f8ca713cce74b63e00d3730618d89691)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreedomofpress%2Fsecuredrop%2Fcommit%2Fb0526a06f8ca713cce74b63e00d3730618d89691)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=freedomofpress%2Fsecuredrop)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[freedomofpress](/freedomofpress)
/
**[securedrop](/freedomofpress/securedrop)**
Public

* [Notifications](/login?return_to=%2Ffreedomofpress%2Fsecuredrop) You must be signed in to change notification settings
* [Fork
  688](/login?return_to=%2Ffreedomofpress%2Fsecuredrop)
* [Star
   3.6k](/login?return_to=%2Ffreedomofpress%2Fsecuredrop)

* [Code](/freedomofpress/securedrop)
* [Issues
  451](/freedomofpress/securedrop/issues)
* [Pull requests
  22](/freedomofpress/securedrop/pulls)
* [Actions](/freedomofpress/securedrop/actions)
* [Projects
  1](/freedomofpress/securedrop/projects)
* [Wiki](/freedomofpress/securedrop/wiki)
* [Security](/freedomofpress/securedrop/security)
* [Insights](/freedomofpress/securedrop/pulse)

Additional navigation options

* [Code](/freedomofpress/securedrop)
* [Issues](/freedomofpress/securedrop/issues)
* [Pull requests](/freedomofpress/securedrop/pulls)
* [Actions](/freedomofpress/securedrop/actions)
* [Projects](/freedomofpress/securedrop/projects)
* [Wiki](/freedomofpress/securedrop/wiki)
* [Security](/freedomofpress/securedrop/security)
* [Insights](/freedomofpress/securedrop/pulse)

## Commit

[Permalink](/freedomofpress/securedrop/commit/b0526a06f8ca713cce74b63e00d3730618d89691)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Manipulate gpg config file as www-data

[Browse files](/freedomofpress/securedrop/tree/b0526a06f8ca713cce74b63e00d3730618d89691)
Browse the repository at this point in the history

```
An attacker with access to www-data could have gpg-agent.conf be a
symlink to a root-owned file (e.g. /etc/passwd) and trick the postinst
into clobbering that file as root. Because the content is fixed, it's
pretty low risk but straightforward to fix.
```

* Loading branch information

[![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

[legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
committed
Dec 8, 2022

1 parent
[5e45b3f](/freedomofpress/securedrop/commit/5e45b3f74bf0a6a9ec1030c7c34f8b11d6b0b19d)

commit b0526a0

Showing
**1 changed file**
with
**9 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

16 changes: 9 additions & 7 deletions

16
[securedrop/debian/securedrop-app-code.postinst](#diff-fcce06c6215975f9a87206f4948ba689803d8a3304054f3f3e28384b670ff08b "securedrop/debian/securedrop-app-code.postinst")

Show comments

[View file](/freedomofpress/securedrop/blob/b0526a06f8ca713cce74b63e00d3730618d89691/securedrop/debian/securedrop-app-code.postinst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -169,35 +169,37 @@ case "$1" in |
|  |  | chmod 0700 "$dir" |
|  |  | done |
|  |  |  |
|  |  | chown -R www-data:www-data /var/lib/securedrop |
|  |  |  |
|  |  | # Ensure required gpg-agent.conf is in place, see #4013. |
|  |  | if [ -e "/var/lib/securedrop/keys/gpg-agent.conf" ]; then |
|  |  |  |
|  |  | # gpg-agent.conf does exist, update it if needed. |
|  |  | if ! grep -qE '^allow-loopback-pinentry$' /var/lib/securedrop/keys/gpg-agent.conf; then |
|  |  | echo allow-loopback-pinentry >> /var/lib/securedrop/keys/gpg-agent.conf |
|  |  | echo allow-loopback-pinentry | sudo -u www-data tee -a /var/lib/securedrop/keys/gpg-agent.conf |
|  |  | fi |
|  |  | if ! grep -qE '^default-cache-ttl 0$' /var/lib/securedrop/keys/gpg-agent.conf; then |
|  |  | echo 'default-cache-ttl 0' >> /var/lib/securedrop/keys/gpg-agent.conf |
|  |  | echo 'default-cache-ttl 0' | sudo -u www-data tee -a /var/lib/securedrop/keys/gpg-agent.conf |
|  |  | fi |
|  |  |  |
|  |  | else |
|  |  | # gpg-agent.conf does not yet exist, create it. |
|  |  | echo allow-loopback-pinentry > /var/lib/securedrop/keys/gpg-agent.conf |
|  |  | echo 'default-cache-ttl 0' >> /var/lib/securedrop/keys/gpg-agent.conf |
|  |  | echo allow-loopback-pinentry | sudo -u www-data tee /var/lib/securedrop/keys/gpg-agent.conf |
|  |  | echo 'default-cache-ttl 0' | sudo -u www-data tee -a /var/lib/securedrop/keys/gpg-agent.conf |
|  |  | fi |
|  |  |  |
|  |  | # Migrate private keyring to gpg2.1 if needed |
|  |  | if [ ! -d "/var/lib/securedrop/keys/private-keys-v1.d" ]; then |
|  |  | # Then we should migrate the keyring |
|  |  | gpg2 --homedir=/var/lib/securedrop/keys --batch --import < /var/lib/securedrop/keys/secring.gpg |
|  |  | # shellcheck disable=SC2024 |
|  |  | sudo -u www-data gpg2 --homedir=/var/lib/securedrop/keys --batch --import < /var/lib/securedrop/keys/secring.gpg |
|  |  | fi |
|  |  |  |
|  |  | chown -R www-data:www-data /var/lib/securedrop |
|  |  |  |
|  |  | # /var/www/securedrop should be owned by root and world-readable. |
|  |  | # Permissions on specific files will be loosened after |
|  |  | chown -R root:root /var/www/securedrop |
|  |  | chmod 755 /var/www/securedrop |
|  |  |  |
|  |  | # Make sure config.py is owned by root and readable by www-data, |
|  |  | # but not world-readable |
|  |  | if [ -f "/var/www/securedrop/config.py" ]; then |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b0526a0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreedomofpress%2Fsecuredrop%2Fcommit%2Fb0526a06f8ca713cce74b63e00d3730618d89691) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_300bc98e_20250114_182942.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreedomofpress%2Fsecuredrop%2Fcompare%2F2.5.0...2.5.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffreedomofpress%2Fsecuredrop%2Fcompare%2F2.5.0...2.5.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=freedomofpress%2Fsecuredrop)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[freedomofpress](/freedomofpress)
/
**[securedrop](/freedomofpress/securedrop)**
Public

* [Notifications](/login?return_to=%2Ffreedomofpress%2Fsecuredrop) You must be signed in to change notification settings
* [Fork
  688](/login?return_to=%2Ffreedomofpress%2Fsecuredrop)
* [Star
   3.6k](/login?return_to=%2Ffreedomofpress%2Fsecuredrop)

* [Code](/freedomofpress/securedrop)
* [Issues
  451](/freedomofpress/securedrop/issues)
* [Pull requests
  22](/freedomofpress/securedrop/pulls)
* [Actions](/freedomofpress/securedrop/actions)
* [Projects
  1](/freedomofpress/securedrop/projects)
* [Wiki](/freedomofpress/securedrop/wiki)
* [Security](/freedomofpress/securedrop/security)
* [Insights](/freedomofpress/securedrop/pulse)

Additional navigation options

* [Code](/freedomofpress/securedrop)
* [Issues](/freedomofpress/securedrop/issues)
* [Pull requests](/freedomofpress/securedrop/pulls)
* [Actions](/freedomofpress/securedrop/actions)
* [Projects](/freedomofpress/securedrop/projects)
* [Wiki](/freedomofpress/securedrop/wiki)
* [Security](/freedomofpress/securedrop/security)
* [Insights](/freedomofpress/securedrop/pulse)

[Permalink](https://github.com/freedomofpress/securedrop/compare/freedomofpress%3A5e7cb43...freedomofpress%3A8a3cfe4)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
freedomofpress/securedrop

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
2.5.0

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/freedomofpress/securedrop/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.5.1)

Could not load tags

Nothing to show

[{{ refName }}
default](/freedomofpress/securedrop/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.5.1)

 Loading

...

*head repository:*
freedomofpress/securedrop

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
2.5.1

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/freedomofpress/securedrop/compare/2.5.0...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/freedomofpress/securedrop/compare/2.5.0...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

* 15

  commits
* 35

  files changed
* 3

  contributors

### Commits on Oct 18, 2022

1. [Merge pull request](/freedomofpress/securedrop/commit/f6baa8865074f949a671e78acbbe1d1ba0c35b58) [#6653](https://github.com/freedomofpress/securedrop/pull/6653) [from freedomofpress/bump-to-2.5.0-version](/freedomofpress/securedrop/commit/f6baa8865074f949a671e78acbbe1d1ba0c35b58)
    …

   ```
   [2.5.0] Bump to release version
   ```

   [![@cfm](https://avatars.githubusercontent.com/u/357435?s=40&v=4)](/cfm)

   [cfm](/freedomofpress/securedrop/commits?author=cfm "View all commits by cfm")
   authored
   Oct 18, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/f6baa8865074f949a671e78acbbe1d1ba0c35b58)
   * Copy full SHA for f6baa88
   * [Browse repository at this point](/freedomofpress/securedrop/tree/f6baa8865074f949a671e78acbbe1d1ba0c35b58)

   Copy the full SHA

    [f6baa88](/freedomofpress/securedrop/commit/f6baa8865074f949a671e78acbbe1d1ba0c35b58)View commit details

   Browse the repository at this point in the history

### Commits on Dec 7, 2022

1. [Fix permissions on /var/www/securedrop](/freedomofpress/securedrop/commit/228f7b63d70b33a8dabb673fd23bc05ce7c1139b)
    …

   ```
   /var/www/securedrop is now root-owned but world readable. This ensures
   that code can only be added/modified/removed by root, not www-data.

   The package already installs files /var/www/securedrop with the correct
   permissions, we were just clobbering it in the postinst, which is now
   removed. We have an explicit chmod to adjust directory permissions.

   We need special handling for config.py since it is installed by ansible
   instead of the package. Since it contains secrets, we want it to be
   only-readable by root/www-data and no one else.

   The custom_logo.png is writable by www-data so administrators can change
   the logo from the web interface. In the future this could be moved
   somewhere else. The file may not exist yet (fresh installs), so we create
   it if necessary.

   testinfra checks have been updated with the new permissions and took the
   time to de-duplicate the list of app directories in 7 different yaml files.
   ```

   [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

   [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
   committed
   Dec 7, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/228f7b63d70b33a8dabb673fd23bc05ce7c1139b)
   * Copy full SHA for 228f7b6
   * [Browse repository at this point](/freedomofpress/securedrop/tree/228f7b63d70b33a8dabb673fd23bc05ce7c1139b)

   Copy the full SHA

    [228f7b6](/freedomofpress/securedrop/commit/228f7b63d70b33a8dabb673fd23bc05ce7c1139b)View commit details

   Browse the repository at this point in the history
2. [Manipulate gpg config file as www-data](/freedomofpress/securedrop/commit/20063734c1a86df37d87e015a3995773a166a2e7)
    …

   ```
   An attacker with access to www-data could have gpg-agent.conf be a
   symlink to a root-owned file (e.g. /etc/passwd) and trick the postinst
   into clobbering that file as root. Because the content is fixed, it's
   pretty low risk but straightforward to fix.
   ```

   [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

   [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
   committed
   Dec 7, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/20063734c1a86df37d87e015a3995773a166a2e7)
   * Copy full SHA for 2006373
   * [Browse repository at this point](/freedomofpress/securedrop/tree/20063734c1a86df37d87e015a3995773a166a2e7)

   Copy the full SHA

    [2006373](/freedomofpress/securedrop/commit/20063734c1a86df37d87e015a3995773a166a2e7)View commit details

   Browse the repository at this point in the history
3. [Run manage.py cron jobs as www-data](/freedomofpress/securedrop/commit/efb2c766fe388c9cb22ac8c7bb5c89c214b7ddce)
    …

   ```
   * Add a postinst snippet to migrate the root crontab over to www-data
     on upgrade.
   * Modify ansible task to install cron jobs for www-data on new installs
   * Update testinfra checks to look at the www-data cron for the tmp
     cleaning job and verify that root's crontab is empty.
   ```

   [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

   [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
   committed
   Dec 7, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/efb2c766fe388c9cb22ac8c7bb5c89c214b7ddce)
   * Copy full SHA for efb2c76
   * [Browse repository at this point](/freedomofpress/securedrop/tree/efb2c766fe388c9cb22ac8c7bb5c89c214b7ddce)

   Copy the full SHA

    [efb2c76](/freedomofpress/securedrop/commit/efb2c766fe388c9cb22ac8c7bb5c89c214b7ddce)View commit details

   Browse the repository at this point in the history
4. [Avoid running Python code as root in postinst](/freedomofpress/securedrop/commit/9fc2cb19a510fb7dd9e66e96aa87a501c8e266b1)
    …

   ```
   There's no need for us to run this as root, all the files alembic needs
   to touch (primarily the SQLite database) are writable by www-data. We
   specifically run the backup copying and deletion steps as www-data too
   so symlink attacks can't be used to have root clobber other files.

   For `mod_wsgi-express module-config`, we ship the generated file in the
   package itself. In a future (non-hotfix) release we will generate the
   file at build-time instead of hardcoding it.
   ```

   [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

   [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
   committed
   Dec 7, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/9fc2cb19a510fb7dd9e66e96aa87a501c8e266b1)
   * Copy full SHA for 9fc2cb1
   * [Browse repository at this point](/freedomofpress/securedrop/tree/9fc2cb19a510fb7dd9e66e96aa87a501c8e266b1)

   Copy the full SHA

    [9fc2cb1](/freedomofpress/securedrop/commit/9fc2cb19a510fb7dd9e66e96aa87a501c8e266b1)View commit details

   Browse the repository at this point in the history
5. [Run OSSEC checks as www-data](/freedomofpress/securedrop/commit/6b4147b3adc29b4ee01e41a764d89ee785c72a3b)

   [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

   [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
   committed
   Dec 7, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/6b4147b3adc29b4ee01e41a764d89ee785c72a3b)
   * Copy full SHA for 6b4147b
   * [Browse repository at this point](/freedomofpress/securedrop/tree/6b4147b3adc29b4ee01e41a764d89ee785c72a3b)

   Copy the full SHA

    [6b4147b](/freedomofpress/securedrop/commit/6b4147b3adc29b4ee01e41a764d89ee785c72a3b)View commit details

   Browse the repository at this point in the history
6. [Don't hardcode username/repository in CI config, support private forks](/freedomofpress/securedrop/commit/00980a9cb382384dce3747be2b60168d11d5421e)
    …

   ```
   Makes it possible to run CI in forks. For a private repository,
   you'll need to set up a personal access token[1] and store it as a
   "GITHUB_AUTH" environment variable in CircleCI.

   [1] <https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token>
   ```

   [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

   [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
   committed
   Dec 7, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/00980a9cb382384dce3747be2b60168d11d5421e)
   * Copy full SHA for 00980a9
   * [Browse repository at this point](/freedomofpress/securedrop/tree/00980a9cb382384dce3747be2b60168d11d5421e)

   Copy the full SHA

    [00980a9](/freedomofpress/securedrop/commit/00980a9cb382384dce3747be2b60168d11d5421e)View commit details

   Browse the repository at this point in the history
7. [upgraded pytest to 7.2.0, thereby dropping unmaintained dependencies](/freedomofpress/securedrop/commit/c011f814e3dd8b70230e1078f02cc24bb02f8a0b)
    …

   ```
   (cherry picked from commit [3e3e02c](https://github.com/freedomofpress/securedrop/commit/3e3e02c6dff2e78152e37ab334ce10081ebf4495))
   ```

   [![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=40&v=4)](/zenmonkeykstop) [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

   [zenmonkeykstop](/freedomofpress/securedrop/commits?author=zenmonkeykstop "View all commits by zenmonkeykstop")
   authored and
   [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
   committed
   Dec 7, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/c011f814e3dd8b70230e1078f02cc24bb02f8a0b)
   * Copy full SHA for c011f81
   * [Browse repository at this point](/freedomofpress/securedrop/tree/c011f814e3dd8b70230e1078f02cc24bb02f8a0b)

   Copy the full SHA

    [c011f81](/freedomofpress/securedrop/commit/c011f814e3dd8b70230e1078f02cc24bb02f8a0b)View commit details

   Browse the repository at this point in the history
8. [updated Pillow from 9.0.1 to 9.3.0](/freedomofpress/securedrop/commit/d8382f9ea9544f0235ac0001c4cda797720cd026)
    …

   ```
   (cherry picked from commit [35cddea](https://github.com/freedomofpress/securedrop/commit/35cddea781bb3eeeac928c5e8e3b4f62951fbc9f))
   ```

   [![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=40&v=4)](/zenmonkeykstop) [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

   [zenmonkeykstop](/freedomofpress/securedrop/commits?author=zenmonkeykstop "View all commits by zenmonkeykstop")
   authored and
   [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
   committed
   Dec 7, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/d8382f9ea9544f0235ac0001c4cda797720cd026)
   * Copy full SHA for d8382f9
   * [Browse repository at this point](/freedomofpress/securedrop/tree/d8382f9ea9544f0235ac0001c4cda797720cd026)

   Copy the full SHA

    [d8382f9](/freedomofpress/securedrop/commit/d8382f9ea9544f0235ac0001c4cda797720cd026)View commit details

   Browse the repository at this point in the history
9. [Updated builder image to version tagged as 2022\_11\_23](/freedomofpress/securedrop/commit/cb527ddd8a81524816182e78401aee08248d61d9)
    …

   ```
   (cherry picked from commit [ce46487](https://github.com/freedomofpress/securedrop/commit/ce46487c2c1ca5e379988cbe65f86088d10c16cd))
   ```

   [![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=40&v=4)](/zenmonkeykstop) [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

   [zenmonkeykstop](/freedomofpress/securedrop/commits?author=zenmonkeykstop "View all commits by zenmonkeykstop")
   authored and
   [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
   committed
   Dec 7, 2022

   Configuration menu

   * [View commit details](/freedomofpress/securedrop/commit/cb527ddd8a81524816182e78401aee08248d61d9)
   * Copy full SHA for cb527dd
   * [Browse repository at this point](/freedomofpress/securedrop/tree/cb527ddd8a81524816182e78401aee08248d61d9)

   Copy the full SHA

    [cb527dd](/freedomofpress/securedrop/commit/cb527ddd8a81524816182e78401aee08248d61d9)View commit details

   Browse the repository at this point in the history
10. [updated wheel to 0.38.4 to clear safety issue](/freedomofpress/securedrop/commit/2df8e0ababacd36504602e82084f37e6d0ca781a)
     …

    ```
    (cherry picked from commit [6b61df8](https://github.com/freedomofpress/securedrop/commit/6b61df884ab3ce7aa75735b70b766e9c552ea436))
    ```

    [![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=40&v=4)](/zenmonkeykstop) [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

    [zenmonkeykstop](/freedomofpress/securedrop/commits?author=zenmonkeykstop "View all commits by zenmonkeykstop")
    authored and
    [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
    committed
    Dec 7, 2022

    Configuration menu

    * [View commit details](/freedomofpress/securedrop/commit/2df8e0ababacd36504602e82084f37e6d0ca781a)
    * Copy full SHA for 2df8e0a
    * [Browse repository at this point](/freedomofpress/securedrop/tree/2df8e0ababacd36504602e82084f37e6d0ca781a)

    Copy the full SHA

     [2df8e0a](/freedomofpress/securedrop/commit/2df8e0ababacd36504602e82084f37e6d0ca781a)View commit details

    Browse the repository at this point in the history
11. [Updated kernel version to 5.15.74](/freedomofpress/securedrop/commit/896c2079ab2d968beedf950abad986cdb023c9f4)
     …

    ```
    This is needed for testinfra checks to pass.
    ```

    [![@zenmonkeykstop](https://avatars.githubusercontent.com/u/2782952?s=40&v=4)](/zenmonkeykstop) [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

    [zenmonkeykstop](/freedomofpress/securedrop/commits?author=zenmonkeykstop "View all commits by zenmonkeykstop")
    authored and
    [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
    committed
    Dec 7, 2022

    Configuration menu

    * [View commit details](/freedomofpress/securedrop/commit/896c2079ab2d968beedf950abad986cdb023c9f4)
    * Copy full SHA for 896c207
    * [Browse repository at this point](/freedomofpress/securedrop/tree/896c2079ab2d968beedf950abad986cdb023c9f4)

    Copy the full SHA

     [896c207](/freedomofpress/securedrop/commit/896c2079ab2d968beedf950abad986cdb023c9f4)View commit details

    Browse the repository at this point in the history
12. [Update builder to 2022\_12\_07](/freedomofpress/securedrop/commit/ab75f7858a02d4a8b561de03775121ad386941a7)
     …

    ```
    (cherry picked from commit [3cf90fb](https://github.com/freedomofpress/securedrop/commit/3cf90fb4534140a2c68d835e0f3586c2e4f4127c))
    ```

    [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

    [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
    committed
    Dec 7, 2022

    Configuration menu

    * [View commit details](/freedomofpress/securedrop/commit/ab75f7858a02d4a8b561de03775121ad386941a7)
    * Copy full SHA for ab75f78
    * [Browse repository at this point](/freedomofpress/securedrop/tree/ab75f7858a02d4a8b561de03775121ad386941a7)

    Copy the full SHA

     [ab75f78](/freedomofpress/securedrop/commit/ab75f7858a02d4a8b561de03775121ad386941a7)View commit details

    Browse the repository at this point in the history
13. [Update dev Dockerfile for new Tor Browser download paths](/freedomofpress/securedrop/commit/ab1863dbeec8a075f8142b752b498074252fcdf7)
     …

    ```
    Starting with Tor Browser 12, all languages are included so it's
    just called "ALL" instead of "en-US".

    (cherry picked from commit [b18900b](https://github.com/freedomofpress/securedrop/commit/b18900b4b96064a1e96d48d53dc09ee11ec90097))
    ```

    [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

    [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
    committed
    Dec 7, 2022

    Configuration menu

    * [View commit details](/freedomofpress/securedrop/commit/ab1863dbeec8a075f8142b752b498074252fcdf7)
    * Copy full SHA for ab1863d
    * [Browse repository at this point](/freedomofpress/securedrop/tree/ab1863dbeec8a075f8142b752b498074252fcdf7)

    Copy the full SHA

     [ab1863d](/freedomofpress/securedrop/commit/ab1863dbeec8a075f8142b752b498074252fcdf7)View commit details

    Browse the repository at this point in the history
14. [SecureDrop 2.5.1](/freedomofpress/securedrop/commit/8a3cfe4cbd628c53356d49b8f1efca6eac960afa)

    [![@legoktm](https://avatars.githubusercontent.com/u/81392?s=40&v=4)](/legoktm)

    [legoktm](/freedomofpress/securedrop/commits?author=legoktm "View all commits by legoktm")
    committed
    Dec 7, 2022

    Configuration menu

    * [View commit details](/freedomofpress/securedrop/commit/8a3cfe4cbd628c53356d49b8f1efca6eac960afa)
    * Copy full SHA for 8a3cfe4
    * [Browse repository at this point](/freedomofpress/securedrop/tree/8a3cfe4cbd628c53356d49b8f1efca6eac960afa)

    Copy the full SHA

     [8a3cfe4](/freedomofpress/securedrop/commit/8a3cfe4cbd628c53356d49b8f1efca6eac960afa)View commit details

    Browse the repository at this point in the history

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff 2.5.0...2.5.1`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


