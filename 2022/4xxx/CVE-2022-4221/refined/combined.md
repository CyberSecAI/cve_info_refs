=== Content from onekey.com_2dafcfa6_20250114_190445.html ===
Ready for the New EU Cyber Resilience Act?[Learn More](/cra-readiness-assessment)

Solutions

Roles[Product Owner](/role/product-owner)[PSIRT Manager](/role/psirt-manager)[CTO/CIO](/role/cto-cio)[Head of Development](/role/head-of-development)[Product Compliance Manager](/role/product-compliance-manager)Use Cases[SBOM Management](/use-case/sbom-management)Industries[Manufacturing](/industry/manufacturing)[Automotive](/industry/automotive)[Medical](/industry/medical)[TELCO](/industry/telco)[Software Dev](/industry/software-dev)[Infrastructure](/industry/infrastructure)Product

ONEKEY PlatformYour All-in-One Cybersecurity and Compliance Solution[Platform Overview](/platform-overview)Features[SBOM Management](/feature/sbom-management)[Impact Assessment](/feature/automated-impact-assessment) [Vulnerability Analysis](/feature/automated-vulnerability-analysis)[Compliance Wizard](/feature/compliance-wizard)[Zero-Day Detection](/feature/zero-day-detection)[Monitoring](/feature/monitoring)[License Detection](/feature/license)[Custom Analysis Profiles](/feature/profiles)[![ONEKEY 360Â° Comprehensive Product Cybersecurity & Compliance](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/67121fed08268feb9f6b269b_whitepaperhero.avif)![](https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg)WhitepapersSep 1, 2024ONEKEY 360Â° Comprehensive Product Cybersecurity & Compliance](/resource/onekey-360deg-comprehensive-product-cybersecurity-compliance)[Expert Consulting](/expert-consulting)Resources

ONEKEY ResourcesAll our resources combined in one place[Resources](/resources)Resources[Blog](/resources/blog)[Research](/resources/research)[Success Stories](/resources/success-stories)[Events](/resources/events)[Whitepapers](/resources/whitepapers)[FAQs](/faq)[![Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/6745b8752e1c64e8087e6d40_AdobeStock_847826864%20(1)%201.avif)![](https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg)ResearchNov 26, 2024Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers](/resource/critical-vulnerabilities-in-ev-charging-stations-analysis-of-echarge-controllers)Company

[About Us](/about-us)[Careers](/careers)[Contact](/contact)[Newsletter](/newsletter)[Press Release](/press-releases)[![Cyber Resilience Act bans products with known vulnerabilities](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b822e403bdc2f3221d575_6712ae1b7f657cc8b66be3ee_02.jpeg)Press ReleaseJun 6, 2024Cyber Resilience Act bans products with known vulnerabilities](/press-release/cyber-resilience-act-bans-products-with-known-vulnerabilities)[Book a Demo](/book-a-demo)[Book a Demo](/book-a-demo)

[Resources](/resources)>[Research](/resources/research)>Security Advisory: Asus M25 NAS Vulnerability
# Security Advisory: Asus M25 NAS Vulnerability

![Security Advisory: Asus M25 NAS Vulnerability](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b824787fa1cccd32089b4_6712ae63f045700b98904967_07.jpeg)![](https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg)November 30, 20224Â min readTablE of contentsExample H2
## READY TO UPGRADE YOUR RISK MANAGEMENT?

Make cybersecurity and compliance efficient and effective with ONEKEY.

[Book a Demo](/book-a-demo)
## Introduction

We recently deployed the first component of our "zero-day identification" module, which aimed at identifying vulnerability patterns in scripting languages. It's been a long time coming and we want to share a few technical details about it with you.

Our objective is to support identification of vulnerability patterns in both scripting languages and compiled binaries. We started off with scripting languages as it seemed to be the easiest path to get results fast. Our first order of business was to identify the distribution of scripting languages within our corpus based off our file categorization. These statistics guided us in choosing which languages to support first.

![](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b8bbb38084bb808ba3432_image-1.png)

Given what we observed, we chose to focus on two languages: Python and PHP. JavaScript is well represented too but it's mostly observed in client-side web administration interfaces code, which is not that interesting to an attacker. Shell scripts and Lua code will probably be the next ones to be supported.

## Static Code Analysis

To identify vulnerabilities, we perform taint analysis by reconstructing the abstract syntax tree and we then traverse this tree. With this approach, we can dramatically increase accuracy of the results and assure that user-controlled input is actually being processed in an insecure way, reducing the overall number of false-positives reported. At the moment, we look for the following vulnerability classes:

* arbitrary command injection ([CWE-77](https://cwe.mitre.org/data/definitions/77.html))

* path traversal ([CWE-23](https://cwe.mitre.org/data/definitions/23.html))

* SQL injection ([CWE-89](https://cwe.mitre.org/data/definitions/89.html))

* insecure communications ([CWE-319](https://cwe.mitre.org/data/definitions/319.html) / [CWE-923](https://cwe.mitre.org/data/definitions/923.html))

* weak cryptographic ciphers / hashing algorithms usage ([CWE-327](https://cwe.mitre.org/data/definitions/327.html))

* loose equality ([CWE-697](https://cwe.mitre.org/data/definitions/697.html))

* unsafe deserialization ([CWE-502](https://cwe.mitre.org/data/definitions/502.html))

Before deploying the PHP static code analysis checker, we tested it with hundreds of selected sample firmware images and reviewed the results. This led to the discovery of around 15 critical bugs spanning 6 different vendors. All these bugs were reported to affected vendors and are in the process of being fixed.

Except this one.

This one is special because it affects a NAS device from Asus, which according to them "*has been EOL for years*", with the latest firmware version dating back 10 years. Since there's no fix in sight, we don't have to wait for the 90 days and can publish the interesting details.

With this analysis module only being the first step and active research being conducted in the area of automated detection of potential 0-day vulnerabilities, you may expect a constant stream of technical advisories about bugs we already identified and ones we still have to uncover.

Now onto the advisory !

## Arbitrary Command Injection Through Cookies

A command injection bug was identified during our scan campaign, so we downloaded the sample and validated the automated results manually.

| **Affected vendor & product** | Asus M25 NAS |
| --- | --- |
| **Vendor Advisory** | NONE |
| **Vulnerable version** | All versions |
| **Fixed version** | None |
| **CVE IDs** | [CVE-2022-4221](https://www.cve.org/CVERecord?id=CVE-2022-4221) |
| **Impact** | 9.8 (Critical) [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| **Credit** | Q. Kaiser, ONEKEY Research LabResearch supported by [Certainity](https://www.certainity.com/) |

This bug is probably the easiest one we had to deal with. As we can see in the screenshot below, a cookie value is used unsanitized in a call to `exec()`. By adding a semi-colon followed by any kind of arbitrary command, we can inject commands. The code is reachable unauthenticated.

![](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b8bbc38084bb808ba3593_nas_m25_rce_cookie-1024x579.png)

The interesting part here is that Asus copied this file from AjaXplorer, an open-source project, but inserted the command injection bug by trying to add some authentication layer (code between "`ALPHA_CUSTOMIZE`" comment).

![](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/671b8bbb38084bb808ba342f_image.png)

## Key Takeaways

You may argue this vulnerability is very obvious and easy to find - and you are absolutely right. It is easy to find and it should have never ended up in production in the first place. Not 10 years ago and especially not today. But bugs like this are a steady companion when researching the security of embedded devices and underline the importance of shedding light into the supply-chain of your devices. This makes the security level of SBOM, device configuration, and also proprietary applications transparent - the only way to reliably determine your own security posture and cyber resilience.

## Timeline

**2022-09-12** - Sent coordinated disclosure request to security@asus.com

**2022-09-13** - Asus answered "[...] since this model, NAS-M25 is end of life for years, we will not maintain its firmware and its security.".

**2022-12-01** - ONEKEY release its advisory

Share
## About Onekey

[ONEKEY](/) is the leading European specialist in Product Cybersecurity & Compliance Management and part of the investment portfolio of [PricewaterhouseCoopers Germany (PwC)](https://www.pwc.de/de.html). The unique combination of an automated Product Cybersecurity & Compliance Platform (PCCP) with expert knowledge and consulting services provides fast and comprehensive analysis, support, and management to improve product cybersecurity and compliance from product purchasing, design, development, production to end-of-life.

![](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/67583204f930179edfad5cb3_2024-09%20ONEKEY-TEAM_Mallorca.avif)

CONTACT:

Marketing Manager
sara.fortmann@onekey.com

euromarcom public relations GmbH
+49 611 973 150
team@euromarcom.de

## RELATED RESEARCH ARTICLES

![Unblob 2024 Highlights: Sandboxing, Reporting, and Community Milestones](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/675192012562197008d3c477_Image%20Frame%20124.avif)ResearchDec 5, 202410Â min read
### Unblob 2024 Highlights: Sandboxing, Reporting, and Community Milestones

Explore the latest developments in Unblob, including enhanced sandboxing with Landlock, improved carving reporting, and ÏÂ² randomness analysis. Celebrate community contributions, academic research collaborations, and new format handlers, while looking forward to exciting updates in 2025.

[Read More](/resource/unblob-2024-highlights-sandboxing-reporting-and-community-milestones)![Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/6745b8752e1c64e8087e6d40_AdobeStock_847826864%20(1)%201.avif)ResearchNov 26, 202420Â min read
### Critical Vulnerabilities in EV Charging Stations: Analysis of eCharge Controllers

Discover how severe security flaws, including unauthenticated remote command execution (CVE-2024-11665 & CVE-2024-11666), affect eCharge EV charging controllers. Learn about insecure firmware practices, cloud infrastructure issues, and actionable steps to mitigate risks in EV charging systems.

[Read More](/resource/critical-vulnerabilities-in-ev-charging-stations-analysis-of-echarge-controllers)![Security Advisory: Unauthenticated Command Injection in Mitel IP Phones](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0d8/67209c8a2e0431878267653a_AdobeStock_493462234.jpeg)ResearchNov 17, 202415Â min read
### Security Advisory: Unauthenticated Command Injection in Mitel IP Phones

Discover critical vulnerabilities in Mitel SIP phones that allow unauthenticated command injection. Learn how outdated input parsing can expose your devices and why it's essential to scan firmware for security risks. Protect your network with our in-depth analysis and expert takeaways.

[Read More](/resource/security-advisory-unauthenticated-command-injection-in-mitel-ip-phones)
## Ready to automate your Product Cybersecurity & Compliance?

Make cybersecurity and compliance efficient and effective withÂ ONEKEY.

[Book a Demo](/book-a-demo)

![onekey logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66ec7d83c10fbfa879b33dd9_ONEKEY_Logo_Neon.svg)Solutions[Product Owner](/role/product-owner)[PSIRT Manager](/role/psirt-manager)[CTO/CIO](/role/cto-cio)[Head of Development](/role/head-of-development)[Product Compliance Manager](/role/product-compliance-manager)[SBOM Management](/use-case/sbom-management)Product[Platform Overview](/platform-overview)[SBOM Management](/feature/sbom-management)[Impact Assessment](/feature/automated-impact-assessment) [Vulnerability Analysis](/feature/automated-vulnerability-analysis) [Compliance Wizard](/feature/compliance-wizard)[Zero-Day Detection](/feature/zero-day-detection)[Monitoring](/feature/monitoring)[License Detection](/feature/license)[Custom Analysis Profiles](/feature/profiles)Industries[Manufacturing](/industry/manufacturing)[Automotive](/industry/automotive)[Medical](/industry/medical)[Telco](/industry/telco)[Software Dev](/industry/software-dev)[Infrastructure](/industry/infrastructure)Resources[Blog](/resources/blog)[Research](/resources/research)[Success Stories](/resources/success-stories)[Events](/resources/events)[Whitepapers](/resources/whitepapers)[FAQs](/faq)Company[About Us](/about-us)[Careers](/careers)[Contact](/contact)[Newsletter](/newsletter)[Press Releases](/press-releases)Social[LinkedIn](https://www.linkedin.com/company/onekey-sec/)[Twitter (X)](https://x.com/onekey_sec)

[Privacy policy](/privacy-policy)[Impressum](/imprint)[Responsible Disclosure Policy](/responsible-disclosure-policy)![Security logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9c52cda15bb54ea28e_Frame%201000003145.png)![Allianz logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9d773dfd7f6acbffc5_Frame%201000003146.avif)![Cybersecurity Made In Europe logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9d6e4f46bc39d692ea_Frame%201000003144.avif)![ECSO logo](https://cdn.prod.website-files.com/66e0617dd66a9d24cea2d0cd/66fe7e9d1b01b2cbe0045cea_Frame%201000003152.avif)ONEKeY 2024


