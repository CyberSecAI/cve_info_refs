=== Content from gitlab.com_8c666d41_20250114_192000.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Group integration settings sensitive information exposed to project maintainers

**[HackerOne report #1796210](https://hackerone.com/reports/1796210)** by `vaib25vicky` on 2022-12-08, assigned to `GitLab Team`:

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

Hi,

##### Summary

Integration settings such as Discord and Slack notifications require webhook url which is a unique url with token that allows access to user discord/slack.

Anyone with access to this webhook url can access discord/slack and send any content/message without authentication.

So, for this reason when Gitlab discord/slack integration is configured, then Gitlab don't show the webhook url to other members of the project in the UI.

However, I've found that integration api is disclosing the webhook url to other members of the project.

This is a security issue and an attack scenario is like:

1. Group owner creates a Discord integration at group level
2. Project maintainers when go to Discord integration page at project level can't see the sensitive url such as webhook url
3. Project maintainers uses integration api `GET /projects/:id/integrations/discord` and gain access to the group owner's Discord webhook url

##### Steps to reproduce

1. Group owner set-up Discord integration at group level by going over `https://gitlab.com/groups/<group-name>/-/settings/integrations/discord/edit`
2. Lets suppose there's a project inside the group and there exists a maintainer named `foo`
3. `foo` uses the integration api and gain access to group owner Discord webhook url

```
curl --request GET \
  --url https://gitlab.com/api/v4/projects/<PROJECT-ID>/integrations/discord \
  --header 'Content-Type: application/json' \
  --header 'PRIVATE-TOKEN: <USER-ACCESS-TOKEN>'

```

##### What is the current *bug* behavior?

Webhook url by Discord/Slack and similar apps are sensitive information. Gitlab protects this url in the UI but not in the api.

Even if there two owner in the project then second owner can't access tokens and sensitive urls set-up by the first owner in the integration settings.

##### What is the expected *correct* behavior?

Expected behavior here is to masked or not show the discord/slack webhook urls in api responses just like we don't show them in the website UI

##### Output of checks

This bug happens on GitLab.com

#### Impact

The webhook urls allow accessing and sending customs message in the channels in discord/slack without any authentication. If they are leaked to unauthorized user then he/she can send arbitrary messages and depending upon the configuration can use this same bug to run commands in the channels.

Thanks!

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_87b0773d_20250114_191959.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-4462.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-4462.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-4462.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-4462.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Mar 04, 2023

  [2fad590e](/gitlab-org/cves/-/commit/2fad590e6b7f9ed4edcbcc442666d68e9686d16b)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/2fad590e6b7f9ed4edcbcc442666d68e9686d16b)
  ·
  2fad590e

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 04, 2023

  2fad590e

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/2fad590e6b7f9ed4edcbcc442666d68e9686d16b)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Mar 04, 2023

Loading


