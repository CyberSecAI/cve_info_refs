=== Content from github.com_e13b6876_20250114_203414.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonekey-sec%2Fubi_reader%2Fpull%2F57)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonekey-sec%2Fubi_reader%2Fpull%2F57)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=onekey-sec%2Fubi_reader)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[onekey-sec](/onekey-sec)
/
**[ubi\_reader](/onekey-sec/ubi_reader)**
Public

* [Notifications](/login?return_to=%2Fonekey-sec%2Fubi_reader) You must be signed in to change notification settings
* [Fork
  138](/login?return_to=%2Fonekey-sec%2Fubi_reader)
* [Star
   547](/login?return_to=%2Fonekey-sec%2Fubi_reader)

* [Code](/onekey-sec/ubi_reader)
* [Issues
  9](/onekey-sec/ubi_reader/issues)
* [Pull requests
  5](/onekey-sec/ubi_reader/pulls)
* [Discussions](/onekey-sec/ubi_reader/discussions)
* [Actions](/onekey-sec/ubi_reader/actions)
* [Projects
  0](/onekey-sec/ubi_reader/projects)
* [Wiki](/onekey-sec/ubi_reader/wiki)
* [Security](/onekey-sec/ubi_reader/security)
* [Insights](/onekey-sec/ubi_reader/pulse)

Additional navigation options

* [Code](/onekey-sec/ubi_reader)
* [Issues](/onekey-sec/ubi_reader/issues)
* [Pull requests](/onekey-sec/ubi_reader/pulls)
* [Discussions](/onekey-sec/ubi_reader/discussions)
* [Actions](/onekey-sec/ubi_reader/actions)
* [Projects](/onekey-sec/ubi_reader/projects)
* [Wiki](/onekey-sec/ubi_reader/wiki)
* [Security](/onekey-sec/ubi_reader/security)
* [Insights](/onekey-sec/ubi_reader/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fonekey-sec%2Fubi_reader%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fonekey-sec%2Fubi_reader%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix path traversal vulnerability. #57

 Merged

[jrspruitt](/jrspruitt)
merged 1 commit into
[onekey-sec:master](/onekey-sec/ubi_reader/tree/master "onekey-sec/ubi_reader:master")
from
onekey-sec:fix-path-traversal

Jun 17, 2022

 Merged

# [Fix path traversal vulnerability.](#top) #57

[jrspruitt](/jrspruitt)
merged 1 commit into
[onekey-sec:master](/onekey-sec/ubi_reader/tree/master "onekey-sec/ubi_reader:master")
from
onekey-sec:fix-path-traversal

Jun 17, 2022

[Conversation
9](/onekey-sec/ubi_reader/pull/57)
[Commits
1](/onekey-sec/ubi_reader/pull/57/commits)
[Checks
0](/onekey-sec/ubi_reader/pull/57/checks)
[Files changed](/onekey-sec/ubi_reader/pull/57/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![qkaiser](https://avatars.githubusercontent.com/u/569494?s=60&v=4)](/qkaiser)

Copy link

Contributor

### @qkaiser **[qkaiser](/qkaiser)** commented [May 19, 2022](#issue-1241381507)

Hi !

We've been working on various enhancements to ubi\_reader at <https://github.com/IoT-Inspector/ubi_reader/>, one of them is a security fix for potential path traversals.

ubireader\_extract\_files could lead to path traversal when run against specifically crafted UBIFS files, allowing the attacker to overwrite files outside of the extraction directory (provided the process has write access to that file or directory).

This is due to the fact that a node name (`dent_node.name`) is considered trusted and joined to the extraction directory path during processing, then the node content is written to that joined path. By crafting a malicious UBIFS file with node names holding path traversal payloads (e.g. `../../tmp/outside.txt`), we can make ubi\_reader write outside of the extraction directory.

This is problematic, even more so if end users run ubi\_reader with elevated privileges in order have the ability to create block devices.

Let me know if you need malicious UBIFS samples for your tests.

Sorry, something went wrong.

All reactions

[![@jrspruitt](https://avatars.githubusercontent.com/u/875801?s=80&u=d5647d5f76c7456d0d759daf6c74046d229a5359&v=4)](/jrspruitt)

Copy link

Contributor

### **[jrspruitt](/jrspruitt)** commented [May 24, 2022](#issuecomment-1136294109)

| Hi QKaiser,  Thank you for pointing this out, I was able to modify an image to demonstrate this, good catch, never thought of it. I am having a problem with the patch though. In is\_safe\_path, matchpath is an absolute path, while basedir is a relative path causing os.path.commonpath() to error out with "Can't mix absolute and relative paths".  I assume the fix here is giving basedir the same treatment as path.  Also just to note, there was an update recently to version 0.8.0 that fixed a major flaw, where in certain files would not be extracted accurately. Should not conflict with what you have done.  -Jason |
| --- |

All reactions

Sorry, something went wrong.

[![@qkaiser](https://avatars.githubusercontent.com/u/569494?s=80&u=e3e38a72510b4dfa037b8083ea44755cb8e5b7be&v=4)](/qkaiser)

Copy link

Contributor

Author

### **[qkaiser](/qkaiser)** commented [May 30, 2022](#issuecomment-1141263029)

| I'll look into doing proper normalization prior to checking path so there is no mixup error being raised. Will keep you posted. |
| --- |

All reactions

Sorry, something went wrong.

[![@qkaiser](https://avatars.githubusercontent.com/u/569494?s=80&u=e3e38a72510b4dfa037b8083ea44755cb8e5b7be&v=4)](/qkaiser)

Copy link

Contributor

Author

### **[qkaiser](/qkaiser)** commented [Jun 13, 2022](#issuecomment-1153715674) • edited Loading

| [@jrspruitt](https://github.com/jrspruitt) I fixed the code and simplified the function, let me know if that works for you. |
| --- |

All reactions

Sorry, something went wrong.

[![@jrspruitt](https://avatars.githubusercontent.com/u/875801?s=80&u=d5647d5f76c7456d0d759daf6c74046d229a5359&v=4)](/jrspruitt)

Copy link

Contributor

### **[jrspruitt](/jrspruitt)** commented [Jun 15, 2022](#issuecomment-1156857172)

| Hi QKaiser,  It worked good, but I had to make one little fix. dent\_path is set after is\_safe\_path() is called, so that if it fails, an error is thrown "extract\_files Error: local variable 'dent\_path' referenced before assignment" when trying to print the error.  I just had to put dent\_path = ... before is\_safe\_path() like  ```     dent_path = os.path.realpath(os.path.join(path, dent_node.name))      if not is_safe_path(path, dent_node.name):         log(extract_dents, 'path traversal attempt: %s, discarding' % (dent_path))         return  ```  If you could make that change I can merge your changes, thanks.  -Jason |
| --- |

All reactions

Sorry, something went wrong.

[![@qkaiser](https://avatars.githubusercontent.com/u/569494?s=80&u=e3e38a72510b4dfa037b8083ea44755cb8e5b7be&v=4)](/qkaiser)

Copy link

Contributor

Author

### **[qkaiser](/qkaiser)** commented [Jun 16, 2022](#issuecomment-1157380185)

| Good catch. I just changed the log call to use `dent_node.name` given that it's the value we're validating. |
| --- |

All reactions

Sorry, something went wrong.

[![@jrspruitt](https://avatars.githubusercontent.com/u/875801?s=80&u=d5647d5f76c7456d0d759daf6c74046d229a5359&v=4)](/jrspruitt)

Copy link

Contributor

### **[jrspruitt](/jrspruitt)** commented [Jun 16, 2022](#issuecomment-1158186537)

| Hi QKaiser, Passes all my tests now, thank you for that.  I'm just wondering now, if this should be an error, which would show regardless of log settings. If someone went through the trouble to make an image like this, there could be more to it, and this would be a first line alert that more precaution could be needed with the contents. Something like  ```        error(extract_dents, 'Warn', 'Path traversal attempt: %s, discarding' % (dent_node.name))  ```  This would only print a warning, unless error action is set to exit. If you don't want to mess with it, I can fix this in the next commit, I found a similar issue near by I'll need to fix anyhow.  Thank you for this bug fix. -Jason |
| --- |

All reactions

Sorry, something went wrong.

[![@qkaiser](https://avatars.githubusercontent.com/u/569494?s=40&v=4)](/qkaiser)

`[Fix path traversal vulnerability.](/onekey-sec/ubi_reader/pull/57/commits/c6a1272b178a4a2a04cfc88c87f6e195b16eddb5 "Fix path traversal vulnerability.

ubireader_extract_files could lead to path traversal when run against
specifically crafted UBIFS files, allowing the attacker to overwrite
files outside of the extraction directory (provided the process has
write access to that file or directory).")`
 …

`[c6a1272](/onekey-sec/ubi_reader/pull/57/commits/c6a1272b178a4a2a04cfc88c87f6e195b16eddb5)`

```
ubireader_extract_files could lead to path traversal when run against
specifically crafted UBIFS files, allowing the attacker to overwrite
files outside of the extraction directory (provided the process has
write access to that file or directory).
```

[![@qkaiser](https://avatars.githubusercontent.com/u/569494?s=80&u=e3e38a72510b4dfa037b8083ea44755cb8e5b7be&v=4)](/qkaiser)

Copy link

Contributor

Author

### **[qkaiser](/qkaiser)** commented [Jun 17, 2022](#issuecomment-1158536094)

| That makes sense, I edited my branch to use `error()`. |
| --- |

All reactions

Sorry, something went wrong.

[![@jrspruitt](https://avatars.githubusercontent.com/u/875801?s=40&u=d5647d5f76c7456d0d759daf6c74046d229a5359&v=4)](/jrspruitt)
[jrspruitt](/jrspruitt)
merged commit [`d5d68e6`](/onekey-sec/ubi_reader/commit/d5d68e6b1b9f7070c29df5f67fc060f579ae9139)
into
onekey-sec:master

[Jun 17, 2022](https://github.com/onekey-sec/ubi_reader/pull/57#event-6826516458)

[![@jrspruitt](https://avatars.githubusercontent.com/u/875801?s=80&u=d5647d5f76c7456d0d759daf6c74046d229a5359&v=4)](/jrspruitt)

Copy link

Contributor

### **[jrspruitt](/jrspruitt)** commented [Jun 17, 2022](#issuecomment-1158541742)

| QKaiser thank you very much.  -Jason |
| --- |

All reactions

Sorry, something went wrong.

[![@qkaiser](https://avatars.githubusercontent.com/u/569494?s=80&u=e3e38a72510b4dfa037b8083ea44755cb8e5b7be&v=4)](/qkaiser)

Copy link

Contributor

Author

### **[qkaiser](/qkaiser)** commented [Jan 31, 2023](#issuecomment-1410061365)

| Hi Jason,  We have an upcoming publication about similar vulnerabilities affecting different extractors in jefferson, yaffshiv, and binwalk. We requested CVEs for each of these vulnerability so that users are aware they should upgrade to the latest version (through dependabot for example).  The one that was fixed in ubi-reader is [CVE-2023-0591](https://github.com/advisories/GHSA-vp2x-3mc3-3cj4 "CVE-2023-0591"), you're credited as remediation reviewer :) |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fonekey-sec%2Fubi_reader%2Fpull%2F57)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@qkaiser](https://avatars.githubusercontent.com/u/569494?s=52&v=4)](/qkaiser) [![@jrspruitt](https://avatars.githubusercontent.com/u/875801?s=52&v=4)](/jrspruitt)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3779daa5_20250114_203415.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonekey-sec%2Fubi_reader%2Freleases%2Ftag%2Fv0.8.5-master)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonekey-sec%2Fubi_reader%2Freleases%2Ftag%2Fv0.8.5-master)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=onekey-sec%2Fubi_reader)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[onekey-sec](/onekey-sec)
/
**[ubi\_reader](/onekey-sec/ubi_reader)**
Public

* [Notifications](/login?return_to=%2Fonekey-sec%2Fubi_reader) You must be signed in to change notification settings
* [Fork
  138](/login?return_to=%2Fonekey-sec%2Fubi_reader)
* [Star
   547](/login?return_to=%2Fonekey-sec%2Fubi_reader)

* [Code](/onekey-sec/ubi_reader/tree/v0.8.5-master)
* [Issues
  9](/onekey-sec/ubi_reader/issues)
* [Pull requests
  5](/onekey-sec/ubi_reader/pulls)
* [Discussions](/onekey-sec/ubi_reader/discussions)
* [Actions](/onekey-sec/ubi_reader/actions)
* [Projects
  0](/onekey-sec/ubi_reader/projects)
* [Wiki](/onekey-sec/ubi_reader/wiki)
* [Security](/onekey-sec/ubi_reader/security)
* [Insights](/onekey-sec/ubi_reader/pulse)

Additional navigation options

* [Code](/onekey-sec/ubi_reader/tree/v0.8.5-master)
* [Issues](/onekey-sec/ubi_reader/issues)
* [Pull requests](/onekey-sec/ubi_reader/pulls)
* [Discussions](/onekey-sec/ubi_reader/discussions)
* [Actions](/onekey-sec/ubi_reader/actions)
* [Projects](/onekey-sec/ubi_reader/projects)
* [Wiki](/onekey-sec/ubi_reader/wiki)
* [Security](/onekey-sec/ubi_reader/security)
* [Insights](/onekey-sec/ubi_reader/pulse)

[Releases](/onekey-sec/ubi_reader/releases)
[Tags](/onekey-sec/ubi_reader/tags)

# v0.8.5-master

* [v0.8.5-master](/onekey-sec/ubi_reader/tree/v0.8.5-master)
* [`26c41bd`](/onekey-sec/ubi_reader/commit/26c41bd1b63417e2eef07db2281b21f9a94d0fab)
* Compare

  Choose a tag to compare

  Could not load tags

  Nothing to show

  [{{ refName }}
  default](/onekey-sec/ubi_reader/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.8.5-master)

   Loading

  [View all tags](/onekey-sec/ubi_reader/tags)

[v0.8.5-master](/onekey-sec/ubi_reader/releases/tag/v0.8.5-master)

* [v0.8.5-master](/onekey-sec/ubi_reader/tree/v0.8.5-master)
* [`26c41bd`](/onekey-sec/ubi_reader/commit/26c41bd1b63417e2eef07db2281b21f9a94d0fab)
* Compare

  Choose a tag to compare

  Could not load tags

  Nothing to show

  [{{ refName }}
  default](/onekey-sec/ubi_reader/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.8.5-master)

   Loading

  [View all tags](/onekey-sec/ubi_reader/tags)

![@jrspruitt](https://avatars.githubusercontent.com/u/875801?s=40&v=4)
[jrspruitt](/jrspruitt)
tagged this
04 Dec 04:27

```
Fixed Python2 and old block removal
```

 Assets
2

 Loading

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f44fbb7f_20250114_203412.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonekey-sec%2Fubi_reader%2Fcommit%2Fd5d68e6b1b9f7070c29df5f67fc060f579ae9139)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonekey-sec%2Fubi_reader%2Fcommit%2Fd5d68e6b1b9f7070c29df5f67fc060f579ae9139)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=onekey-sec%2Fubi_reader)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[onekey-sec](/onekey-sec)
/
**[ubi\_reader](/onekey-sec/ubi_reader)**
Public

* [Notifications](/login?return_to=%2Fonekey-sec%2Fubi_reader) You must be signed in to change notification settings
* [Fork
  138](/login?return_to=%2Fonekey-sec%2Fubi_reader)
* [Star
   547](/login?return_to=%2Fonekey-sec%2Fubi_reader)

* [Code](/onekey-sec/ubi_reader)
* [Issues
  9](/onekey-sec/ubi_reader/issues)
* [Pull requests
  5](/onekey-sec/ubi_reader/pulls)
* [Discussions](/onekey-sec/ubi_reader/discussions)
* [Actions](/onekey-sec/ubi_reader/actions)
* [Projects
  0](/onekey-sec/ubi_reader/projects)
* [Wiki](/onekey-sec/ubi_reader/wiki)
* [Security](/onekey-sec/ubi_reader/security)
* [Insights](/onekey-sec/ubi_reader/pulse)

Additional navigation options

* [Code](/onekey-sec/ubi_reader)
* [Issues](/onekey-sec/ubi_reader/issues)
* [Pull requests](/onekey-sec/ubi_reader/pulls)
* [Discussions](/onekey-sec/ubi_reader/discussions)
* [Actions](/onekey-sec/ubi_reader/actions)
* [Projects](/onekey-sec/ubi_reader/projects)
* [Wiki](/onekey-sec/ubi_reader/wiki)
* [Security](/onekey-sec/ubi_reader/security)
* [Insights](/onekey-sec/ubi_reader/pulse)

## Commit

[Permalink](/onekey-sec/ubi_reader/commit/d5d68e6b1b9f7070c29df5f67fc060f579ae9139)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#57](https://github.com/onekey-sec/ubi_reader/pull/57) from onekey-sec/fix-path-traversal

[Browse files](/onekey-sec/ubi_reader/tree/d5d68e6b1b9f7070c29df5f67fc060f579ae9139)
Browse the repository at this point in the history

```
Fix path traversal vulnerability.
```

* Loading branch information

[![@jrspruitt](https://avatars.githubusercontent.com/u/875801?s=40&v=4)](/jrspruitt)

[jrspruitt](/onekey-sec/ubi_reader/commits?author=jrspruitt "View all commits by jrspruitt")
authored
Jun 17, 2022

2 parents
[b04b1bd](/onekey-sec/ubi_reader/commit/b04b1bd67d2e664bd0e0b47c1c74425b05d1bb5b)
+
[c6a1272](/onekey-sec/ubi_reader/commit/c6a1272b178a4a2a04cfc88c87f6e195b16eddb5)

commit d5d68e6

Showing
**1 changed file**
with
**10 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

12 changes: 10 additions & 2 deletions

12
[ubireader/ubifs/output.py](#diff-9701fbf2239b9a1296d436ca2d8e6b4683ec595eaed75eba504015f9cd187f4c "ubireader/ubifs/output.py")

Show comments

[View file](/onekey-sec/ubi_reader/blob/d5d68e6b1b9f7070c29df5f67fc060f579ae9139/ubireader/ubifs/output.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -26,6 +26,10 @@ |
|  |  | from ubireader.ubifs.misc import decompress |
|  |  | from ubireader.debug import error, log, verbose\_log |
|  |  |  |
|  |  | def is\_safe\_path(basedir, path): |
|  |  | basedir = os.path.realpath(basedir) |
|  |  | path = os.path.realpath(os.path.join(basedir, path)) |
|  |  | return basedir == os.path.commonpath((basedir, path)) |
|  |  |  |
|  |  | def extract\_files(ubifs, out\_path, perms=False): |
|  |  | """Extract UBIFS contents to\_path/ |
| Expand Down  Expand Up | | @@ -59,8 +63,12 @@ def extract\_dents(ubifs, inodes, dent\_node, path='', perms=False): |
|  |  | return |
|  |  |  |
|  |  | inode = inodes[dent\_node.inum] |
|  |  | dent\_path = os.path.join(path, dent\_node.name) |
|  |  |  |
|  |  |  |
|  |  | if not is\_safe\_path(path, dent\_node.name): |
|  |  | error(extract\_dents, 'Warning', 'Path traversal attempt: %s, discarding' % (dent\_node.name)) |
|  |  | return |
|  |  | dent\_path = os.path.realpath(os.path.join(path, dent\_node.name)) |
|  |  |  |
|  |  | if dent\_node.type == UBIFS\_ITYPE\_DIR: |
|  |  | try: |
|  |  | if not os.path.exists(dent\_path): |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d5d68e6`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonekey-sec%2Fubi_reader%2Fcommit%2Fd5d68e6b1b9f7070c29df5f67fc060f579ae9139) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


