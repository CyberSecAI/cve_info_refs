The provided content relates to a commit that addresses SQL injection vulnerabilities, suggesting it might be related to CVE-2022-4093.

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient sanitization of user-supplied input when constructing SQL queries, specifically within `LIKE` clauses and `REGEXP` operations. The code was using `$db->escape()` followed by `$db->escapeforlike()`, where `$db->escapeforlike()` was not properly escaping characters for use in LIKE clauses, and where the order of escapes was incorrect.

**Weaknesses/Vulnerabilities Present:**
- **SQL Injection:** The primary vulnerability is SQL injection, arising from unsanitized input being directly incorporated into SQL queries.
- **Insufficient Input Sanitization:** The code was using `$db->escape` and `$db->escapeforlike` but not in the correct order for preventing SQL Injection. The fix applies `escape` after `escapeforlike`.
- **Vulnerable Database Interactions:** The functions `getPagesFromSearchCriterias` in `website.lib.php`, contact searching in `list.php` and import functions in `import_csv.modules.php` and `import_xlsx.modules.php` were vulnerable when building SQL queries.

**Impact of Exploitation:**
- **Data Breach:** A successful SQL injection could allow an attacker to retrieve sensitive data from the database.
- **Data Manipulation:** Attackers could also modify or delete data within the database.
- **Application Compromise:** Depending on the database permissions, the attacker could potentially gain control over the application.

**Attack Vectors:**
- **Search Functionality:** Exploiting the search functionality by injecting malicious code through search parameters in `getPagesFromSearchCriterias`.
- **Social Network Fields:** Malicious input through social network fields in the contact list or during import operations, where the content was being used in SQL `REGEXP` and `LIKE` clauses.
- **Import functions:** CSV and XLSX import functionality, where user-provided data was not properly sanitized and incorporated into the queries.

**Required Attacker Capabilities/Position:**
- The attacker needs to have access to the application's user interface or import functionalities.
- They need to be able to inject malicious SQL code into the search fields or data fields used for contact search or import.
- No specific privilege level is required, only the ability to pass input to the affected functions.

**Additional Details:**
- The fix involves changing the order of the escaping functions to `$db->escape($db->escapeforlike($input))` instead of `$db->escapeforlike($db->escape($input))`. This ensures that characters are properly escaped for use in SQL queries using `LIKE` clauses and `REGEXP` operations, preventing SQL injection.
- The commit includes a new unit test `Website.class.php` to verify the fix.

The commit fixes SQL injection vulnerabilities by properly escaping user inputs, preventing potential data breaches and unauthorized access.