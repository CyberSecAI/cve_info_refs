- **Root cause of vulnerability**: The plugin prioritizes obtaining the visitor's IP address from specific HTTP headers over the server-provided `REMOTE_ADDR`.
- **Weaknesses/vulnerabilities present**: IP address spoofing vulnerability. The plugin trusts user-supplied HTTP headers for IP address determination.
- **Impact of exploitation**: An attacker can bypass IP-based blocks implemented by the plugin, potentially gaining access or performing actions that would otherwise be restricted.
- **Attack vectors**: The attacker crafts HTTP requests, setting the following headers to a desired spoofed IP: `HTTP_X_REAL_IP`, `HTTP_X_FORWARDED_FOR`, `HTTP_CF_CONNECTING_IP`, or `HTTP_CLIENT_IP`.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the target server, setting custom HTTP headers.