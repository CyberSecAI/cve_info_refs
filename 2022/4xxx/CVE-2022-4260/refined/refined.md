- **Root cause of vulnerability:** The WP-Ban plugin fails to sanitize and escape some of its settings, specifically the "Banned Referrers" and "Banned Message" fields.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code into the plugin settings, which will then be executed in the browsers of users who visit the website, allowing for actions such as stealing cookies or redirecting to malicious websites.
- **Attack vectors:** The attacker must have administrative privileges to access the plugin settings page. They inject the malicious code via the "Banned Referrers" and "Banned Message" fields. The vulnerability is triggered when a user visits the website with a referrer matching the banned referrer, causing the malicious code to execute.
- **Required attacker capabilities/position:** The attacker needs to have administrator-level access to the WordPress dashboard.