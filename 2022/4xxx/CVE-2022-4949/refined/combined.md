=== Content from xenbits.xen.org_e5ef787c_20250114_180440.html ===

# Information

| Advisory | [XSA-443](advisory-443.html) |
| --- | --- |
| Public release | 2023-10-10 12:00 |
| Updated | 2023-11-09 15:18 |
| Version | 4 |
| CVE(s) | [CVE-2023-34325](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-34325) [CVE-2022-4949](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4949) |
| Title | Multiple vulnerabilities in libfsimage disk handling |

# Files

<advisory-443.txt> (signed advisory file)

<xsa443/xsa443-01.patch>

<xsa443/xsa443-02.patch>

<xsa443/xsa443-03.patch>

<xsa443/xsa443-4.15-01.patch>

<xsa443/xsa443-4.15-02.patch>

<xsa443/xsa443-4.15-03.patch>

<xsa443/xsa443-4.15-04.patch>

<xsa443/xsa443-4.15-05.patch>

<xsa443/xsa443-4.15-06.patch>

<xsa443/xsa443-4.15-07.patch>

<xsa443/xsa443-4.15-08.patch>

<xsa443/xsa443-4.15-09.patch>

<xsa443/xsa443-4.15-10.patch>

<xsa443/xsa443-4.15-11.patch>

<xsa443/xsa443-4.16-01.patch>

<xsa443/xsa443-4.16-02.patch>

<xsa443/xsa443-4.16-03.patch>

<xsa443/xsa443-4.16-04.patch>

<xsa443/xsa443-4.16-05.patch>

<xsa443/xsa443-4.16-06.patch>

<xsa443/xsa443-4.16-07.patch>

<xsa443/xsa443-4.16-08.patch>

<xsa443/xsa443-4.16-09.patch>

<xsa443/xsa443-4.16-10.patch>

<xsa443/xsa443-4.16-11.patch>

<xsa443/xsa443-4.17-01.patch>

<xsa443/xsa443-4.17-02.patch>

<xsa443/xsa443-4.17-03.patch>

<xsa443/xsa443-4.17-04.patch>

<xsa443/xsa443-4.17-05.patch>

<xsa443/xsa443-4.17-06.patch>

<xsa443/xsa443-4.17-07.patch>

<xsa443/xsa443-4.17-08.patch>

<xsa443/xsa443-4.17-09.patch>

<xsa443/xsa443-4.17-10.patch>

<xsa443/xsa443-4.17-11.patch>

<xsa443/xsa443-04.patch>

<xsa443/xsa443-05.patch>

<xsa443/xsa443-06.patch>

<xsa443/xsa443-07.patch>

<xsa443/xsa443-08.patch>

<xsa443/xsa443-09.patch>

<xsa443/xsa443-10.patch>

<xsa443/xsa443-11.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

        Xen Security Advisory CVE-2023-34325,CVE-2022-4949 / XSA-443
                               version 4

	   Multiple vulnerabilities in libfsimage disk handling

UPDATES IN VERSION 4
====================

Added reference to CVE for upstream grub project.

ISSUE DESCRIPTION
=================

libfsimage contains parsing code for several filesystems, most of them based on
grub-legacy code.  libfsimage is used by pygrub to inspect guest disks.

Pygrub runs as the same user as the toolstack (root in a priviledged domain).

At least one issue has been reported to the Xen Security Team that allows an
attacker to trigger a stack buffer overflow in libfsimage.  After further
analisys the Xen Security Team is no longer confident in the suitability of
libfsimage when run against guest controlled input with super user priviledges.

In order to not affect current deployments that rely on pygrub patches are
provided in the resolution section of the advisory that allow running pygrub in
deprivileged mode.

CVE-2023-4949 refers to the original issue in the upstream grub
project ("An attacker with local access to a system (either through a
disk or external drive) can present a modified XFS partition to
grub-legacy in such a way to exploit a memory corruption in grub’s XFS
file system implementation.")  CVE-2023-34325 refers specifically to
the vulnerabilities in Xen's copy of libfsimage, which is decended
from a very old version of grub.

IMPACT
======

A guest using pygrub can escalate its privilege to that of the domain
construction tools (i.e., normally, to control of the host).

VULNERABLE SYSTEMS
==================

All Xen versions are affected.

MITIGATION
==========

Ensuring that guests do not use the pygrub bootloader will avoid this
vulnerability.

For cases where the PV guest is known to be 64bit, and uses grub2 as a
bootloader, pvgrub is a suitable alternative pygrub.

Running only HVM guests will avoid the vulnerability.

CREDITS
=======

This issue was discovered by Ferdinand Nölscher of Google.

RESOLUTION
==========

Applying patches 1-4 resolves the libfsimage XFS stack overflow.  Applying
patches 5-11 add additional functionality to pygrub and libxl in order to run
pygrub in a restricted environment using a specific UID.  Check xl.cfg man page
for information on the bootloader_restrict option.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa443/xsa443-??.patch          xen-unstable
xsa443/xsa443-4.17-??.patch     Xen 4.17.x
xsa443/xsa443-4.16-??.patch     Xen 4.16.x
xsa443/xsa443-4.15-??.patch     Xen 4.15.x

$ sha256sum xsa443*/*
[d2b306efd35b1e207904f4142be724c4b70bacafae73f8efd5ee12570eb235a1  xsa443/xsa443-01.patch](xsa443/xsa443-01.patch)
[3af33399c9966465ef65461c344fe0c3184a21a59830de8e3701122cda4f5483  xsa443/xsa443-02.patch](xsa443/xsa443-02.patch)
[a260be66f02307143d9e776cac2b95735011056bebd718f175680f879563ea21  xsa443/xsa443-03.patch](xsa443/xsa443-03.patch)
[170d511df3a3898ab0302f7e85bc63127cb0b75f73fdcd83104d3f358365f648  xsa443/xsa443-4.15-01.patch](xsa443/xsa443-4.15-01.patch)
[16c942da8929ab240a8807da05d9b39bbabfb34adc4f5a63bc3d2d99568973b1  xsa443/xsa443-4.15-02.patch](xsa443/xsa443-4.15-02.patch)
[13fd27948f5a5e21e1a8e0ddf218ec79b44f1fca55fdc371c932ad2dfa5c23ea  xsa443/xsa443-4.15-03.patch](xsa443/xsa443-4.15-03.patch)
[1c865b8f0048483ea76e8cfbeba1536ca6cbde04c58a7e0d485d46c063046cf4  xsa443/xsa443-4.15-04.patch](xsa443/xsa443-4.15-04.patch)
[115b9561c0ea8f155d60049a1e60a26e5261147b1d2672d8a96313aef5dd95e6  xsa443/xsa443-4.15-05.patch](xsa443/xsa443-4.15-05.patch)
[5e54fe8fcd56de43e9035e57ed964cc677aca853b6f205f8576f56aa8f968bf0  xsa443/xsa443-4.15-06.patch](xsa443/xsa443-4.15-06.patch)
[a0bd7681bd541b21d069cd025cfb97c798c35041300d5cc86f59941471b88b3c  xsa443/xsa443-4.15-07.patch](xsa443/xsa443-4.15-07.patch)
[165795217669df7fa2f6bcb3eb820f93391c7d46422eb941ae359b43ce5c510f  xsa443/xsa443-4.15-08.patch](xsa443/xsa443-4.15-08.patch)
[fe8be8c39f83567597ec5077bd6fe8b57324d5f6bed7f5cfbed7df43008f7835  xsa443/xsa443-4.15-09.patch](xsa443/xsa443-4.15-09.patch)
[48936926848af29786490dd6db3dcfaf8ed8443f1d6ae896dcb95c930e2f4c21  xsa443/xsa443-4.15-10.patch](xsa443/xsa443-4.15-10.patch)
[213b6a45198869869248b2e3c096fd327f7b0cccbd68faa12335134172c7c908  xsa443/xsa443-4.15-11.patch](xsa443/xsa443-4.15-11.patch)
[170d511df3a3898ab0302f7e85bc63127cb0b75f73fdcd83104d3f358365f648  xsa443/xsa443-4.16-01.patch](xsa443/xsa443-4.16-01.patch)
[16c942da8929ab240a8807da05d9b39bbabfb34adc4f5a63bc3d2d99568973b1  xsa443/xsa443-4.16-02.patch](xsa443/xsa443-4.16-02.patch)
[13fd27948f5a5e21e1a8e0ddf218ec79b44f1fca55fdc371c932ad2dfa5c23ea  xsa443/xsa443-4.16-03.patch](xsa443/xsa443-4.16-03.patch)
[1c865b8f0048483ea76e8cfbeba1536ca6cbde04c58a7e0d485d46c063046cf4  xsa443/xsa443-4.16-04.patch](xsa443/xsa443-4.16-04.patch)
[115b9561c0ea8f155d60049a1e60a26e5261147b1d2672d8a96313aef5dd95e6  xsa443/xsa443-4.16-05.patch](xsa443/xsa443-4.16-05.patch)
[5e54fe8fcd56de43e9035e57ed964cc677aca853b6f205f8576f56aa8f968bf0  xsa443/xsa443-4.16-06.patch](xsa443/xsa443-4.16-06.patch)
[a0bd7681bd541b21d069cd025cfb97c798c35041300d5cc86f59941471b88b3c  xsa443/xsa443-4.16-07.patch](xsa443/xsa443-4.16-07.patch)
[165795217669df7fa2f6bcb3eb820f93391c7d46422eb941ae359b43ce5c510f  xsa443/xsa443-4.16-08.patch](xsa443/xsa443-4.16-08.patch)
[fe8be8c39f83567597ec5077bd6fe8b57324d5f6bed7f5cfbed7df43008f7835  xsa443/xsa443-4.16-09.patch](xsa443/xsa443-4.16-09.patch)
[c9538238f4b636b7d093a59610b0eab2e7fd409a7cc9e988d006bee4c9b944f7  xsa443/xsa443-4.16-10.patch](xsa443/xsa443-4.16-10.patch)
[62147de7a6b8a0073c7abe204da25e94871a32c4e3851f9feccf065976dc0267  xsa443/xsa443-4.16-11.patch](xsa443/xsa443-4.16-11.patch)
[3322213303481fea964cf18e09b172d42caf21fe662c947ae6ddc0d8a1789fa1  xsa443/xsa443-4.17-01.patch](xsa443/xsa443-4.17-01.patch)
[02cf94559407d693ef2dcfc47671b63f5f27019dd759bae3b5eaaa922fb4ea74  xsa443/xsa443-4.17-02.patch](xsa443/xsa443-4.17-02.patch)
[189bef69380d6fbd7f571b2fe11908bac26a650e2b0d040e12b8c1266373f8c8  xsa443/xsa443-4.17-03.patch](xsa443/xsa443-4.17-03.patch)
[cdb4f0dd47a6c8a759ae4ffd400f2ce72675b8779ca5576dea74e372ca77a021  xsa443/xsa443-4.17-04.patch](xsa443/xsa443-4.17-04.patch)
[2147dcf95b1ad36da0961e2c084072fa9eb59486e9c0ed43444d268a17d01ee1  xsa443/xsa443-4.17-05.patch](xsa443/xsa443-4.17-05.patch)
[a523273792a77fa55a7ab8925369edcb9d9ae50e8e9236be43f23e66aaa0f5e2  xsa443/xsa443-4.17-06.patch](xsa443/xsa443-4.17-06.patch)
[54f97e027c80bfed8e3559ba8d89a69d2f4c48e1017c2090af029a01efe49741  xsa443/xsa443-4.17-07.patch](xsa443/xsa443-4.17-07.patch)
[79667e7b8fbfa43f9135ba14ca364c63e1e7e7c3a68ae12513fe0204e57fa2bd  xsa443/xsa443-4.17-08.patch](xsa443/xsa443-4.17-08.patch)
[11125e8da5f9e8313d943e6cbba2ff160478681c290b1413c88113292cca91c4  xsa443/xsa443-4.17-09.patch](xsa443/xsa443-4.17-09.patch)
[113bbc294e10be4e8bf9855536114f875add033f790504f5c744b38da85d1b11  xsa443/xsa443-4.17-10.patch](xsa443/xsa443-4.17-10.patch)
[7e5c7d4ef0b148ce9421c1856ced8b023bae22abc8e13956fe2832628c9d4189  xsa443/xsa443-4.17-11.patch](xsa443/xsa443-4.17-11.patch)
[eb81bcbaf1016bce77696c1f2f5cd90b22e11eaa02d15c36c4c704b02981c50d  xsa443/xsa443-04.patch](xsa443/xsa443-04.patch)
[5a099d8bf6a06e318f9ff92491ae4191fd2a3f8637a3c9616173bd2c7d56dbb6  xsa443/xsa443-05.patch](xsa443/xsa443-05.patch)
[32733ee7dd1baf81338d50532876f211660dd65eb44f3ea121604b4c897ba30f  xsa443/xsa443-06.patch](xsa443/xsa443-06.patch)
[9dfe8e70ed3007dbe46de75d6790baa770d91ac42d6abf642ca0f11b8b2d6b6d  xsa443/xsa443-07.patch](xsa443/xsa443-07.patch)
[b8040da4d2ef22ed9f96e1648fa8c4682f82bce2d17bbdd9f2250c48f8858d10  xsa443/xsa443-08.patch](xsa443/xsa443-08.patch)
[4b0fa7efd271de010943a2974e178d6e9c44c5181a94fc58ddd3f9ecd953d572  xsa443/xsa443-09.patch](xsa443/xsa443-09.patch)
[f1b97a6ee5dc15a2b85ffde12242eb65d885b244419f34d737eb4489769f7224  xsa443/xsa443-10.patch](xsa443/xsa443-10.patch)
[eafccd01a5458baf2a7f39b3e533fd3638d6f728078c437247dc712856422706  xsa443/xsa443-11.patch](xsa443/xsa443-11.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmVM+FMMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZU7AIALBwYs4RFK+Q3YhyXBdKCFybnRJmj6qVgeJXZr7m
lk1SFdickZpnWrV7UL/BlLbR/PuYSqbkICYVoyVqMTOP/O5UHTxpZEP1q9SqAW0z
Jm/7oi1YNkBc/XKYUoEW2Z/k6S3dTzG+iNTB5Xn25DKZtzTb3YtaNCuMGqWYHDfz
Q/NHc3uLtxnXKjq/YMSs9ig2VEjRTphkiTe37mN0hFmnXDBlxtZHj1h5iw1DwO/o
W64C4H+3DlI5SA7yTY1EEVPWfNr+t/GqvafgAVMcy1WGutHTZVaMp814ctxXvAex
grTDK/k+jmEa12zCWodkf85EZNCisVnyBfoo5W9DJ2w2Udo=
=eeA0
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from blog.nintechnet.com_80a63aeb_20250114_180441.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Critical vulnerability in WordPress AdSanity plugin.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [January 25, 2022 - 12:17pm [+0700]](https://blog.nintechnet.com/critical-vulnerability-in-wordpress-adsanity-plugin/)

WordPress [AdSanity](https://adsanityplugin.com/) plugin is prone to a critical vulnerability affecting version 1.8.1 and below that could allow a low-privilege user to perform arbitrary file upload, remote code execution and stored cross-site scripting attacks.

### Broken Access Control

CVSS v3.1: [9.9 (Critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L)

When creating an ad, the plugin allows the upload of a ZIP file. That process is managed inside the “adsanity/views/html5-upload.php” script, by the `adsanity_html5_upload` AJAX action that loads the `ajax_upload` function:

```
/**
 * Handles the zip file upload via ajax
 */
public static function ajax_upload() {

   // Check the nonce
   if ( ! array_key_exists( 'security', $_POST ) ||
       ! wp_verify_nonce( $_POST['security'], 'adsanity-html5-upload' ) ) {
      wp_send_json_error( 'Security' );
      return;
   }

   // Check that all of the parts are here
   if ( ! array_key_exists( 'file_upload', $_FILES ) ||
       ! array_key_exists( 'tmp_name', $_FILES['file_upload'] ) ||
       ! array_key_exists( 'type', $_FILES['file_upload'] ) ||
       ! array_key_exists( 'ad_id', $_POST ) ) {
      wp_send_json_error( 'Request is missing parts' );
      return;
   }

   // Possible mime type for a zip file
   $allowed_mime_types = array(
      'application/zip',
      'application/octet-stream',
      'application/x-zip-compressed',
      'multipart/x-zip',
   );

   if ( ! in_array( $_FILES['file_upload']['type'], $allowed_mime_types ) ) {
      wp_send_json_error( [
         'message' => esc_js( __( 'Invalid filetype.', 'adsanity' ) ),
      ], 400 );
      return;
   }

   $upload_dir = wp_upload_dir();
   $upload_base_dir = $upload_dir['basedir'];
   $adsanity_dir = trailingslashit( $upload_base_dir ) . 'adsanity/';
   $ad_id = $_POST['ad_id'];
   $ad_dir = $adsanity_dir . $ad_id;

   // Create the ad src for use in meta
   $ad_src = trailingslashit( trailingslashit( $upload_dir['baseurl'] ) . 'adsanity/' . $ad_id );

   // Get the path to this ad
   $ad_path = trailingslashit( trailingslashit( $upload_dir['basedir'] ) . 'adsanity/' . $ad_id );

   /**
    * Initialize WP_Filesystem
    * Used for unzip_file and rmdir
    */
   global $wp_filesystem;
   WP_Filesystem();

   // Check to see if there has already been an upload to this folder
   if ( is_dir( $ad_path ) ) {
      // Remove the folder
      $wp_filesystem->rmdir( $ad_path, true );
   }

   // Unzip the files
   $unzipped = unzip_file( $_FILES['file_upload']['tmp_name'], $ad_dir );

   if ( ! $unzipped ) {
      wp_send_json_error( 'File upload error', 500 );
      return;
   }

   // Scan the directory for this ad
   $scanned = scandir( $ad_path );

   /**
    * Check to see if this only contains a directory
    * HTML5 ads can be uploaded as a zip file
    * of only files, or a zipped folder
    */
   while (
      3 === count( $scanned ) &&
      is_dir( $ad_path . trailingslashit( $scanned[2] ) ) &&
      ! in_array( 'index.html', $scanned )
   ) {
      // Update the path and src with the new inner folder added
      $ad_path .= trailingslashit( $scanned[2] );
      $ad_src .= trailingslashit( $scanned[2] );
      // Re-scan
      $scanned = scandir( $ad_path );
   }

   // Check for the existence of an index.html file
   if ( ! in_array( 'index.html', $scanned ) ) {
      wp_send_json_error( [
         'message' => esc_js( __( 'Zip file must contain an index.html file.', 'adsanity' ) ),
      ], 400 );
   }

   update_post_meta( $ad_id, 'ad_src', $ad_src );

   wp_send_json_success( array( 'src' => $ad_src ) );

}

```

That function is used to upload and extract the content of a ZIP archive into the “wp-content/uploads/adsanity/{post\_id}/” folder. It only has a security nonce, accessible to any user with Contributor or above privileges, and a simple check to ensure there’s an index.html file inside the archive. After the upload, the function will return the full path to the folder where the files were extracted:

```
{"success":true,"data":{"src":"http:\/\/example.com\/wp-content\/uploads\/adsanity\/407\/"}}
```

A low-privilege user such as a Contributor can upload any file into that folder:

![](../wp-content/uploads/2022/01/AdSanity-arbitrary-file-upload-vulnerability.png)

If the blog has a .htaccess file to prevent PHP code execution inside the /uploads/ folder, the attacker can easily override that protection by uploading another .htaccess.

In the ads management section, the plugin injects inside a metabox an iframe that points to the directory where the files were extracted:

```
<?php
// Get ad src
global $post;
$ad_src = get_post_meta( $post->ID, 'ad_src', true );
if ( $ad_src ) { ?>
   <iframe src="<?php echo esc_attr( trailingslashit( $ad_src ) ); ?>" scrolling="no" frameborder="0"></iframe>
<?php } ?>

```

The attacker can add an index.php script inside the ZIP archive. Its code will be loaded by the iframe instead of the index.html file, and executed inside the metabox each time a user accesses the ads manager in the backend:

![](../wp-content/uploads/2022/01/AdSanity-remote-code-execution-vulnerability.png)

Additionally, the attacker can upload files with JavaScript code too, which could be used to target the administrator reviewing the post:

![](../wp-content/uploads/2022/01/AdSanity-stored-XSS-vulnerability.png)

###

### Timeline

The issue was reported to the developer on January 13, 2022, and a new version 1.8.2 was released on January 14, 2022. Note that the new version doesn’t allow Contributor users to upload files but still allow Author+ users to do so, therefore if you have Author users registered on your blog, you may exercise extreme caution. Note also that if you’re using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), only the Admin (single site) and Superadmin (multisite) will be allowed to access the upload function, any other user will be blocked.

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Critical%20vulnerability%20in%20WordPress%20AdSanity%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fcritical-vulnerability-in-wordpress-adsanity-plugin%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fcritical-vulnerability-in-wordpress-adsanity-plugin%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Critical%20vulnerability%20in%20WordPress%20AdSanity%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Fcritical-vulnerability-in-wordpress-adsanity-plugin%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Code Profiler: WordPress Website Performance Profiling Made Easy.](https://blog.nintechnet.com/code-profiler-wordpress-website-performance-profiling-made-easy/)[Next Unauthenticated function injection vulnerability in WordPress Sparkling theme.](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-sparkling-theme/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)



=== Content from www.openwall.com_857c54ce_20250114_180440.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <E1r16oW-0002Ya-8S@xenbits.xenproject.org>
Date: Thu, 09 Nov 2023 15:19:24 +0000
From: Xen.org security team <security@....org>
To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,
 xen-users@...ts.xen.org, oss-security@...ts.openwall.com
CC: Xen.org security team <security-team-members@....org>
Subject: Xen Security Advisory 443 v4 (CVE-2023-34325,CVE-2022-4949) -
 Multiple vulnerabilities in libfsimage disk handling

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

        Xen Security Advisory CVE-2023-34325,CVE-2022-4949 / XSA-443
                               version 4

	   Multiple vulnerabilities in libfsimage disk handling

UPDATES IN VERSION 4
====================

Added reference to CVE for upstream grub project.

ISSUE DESCRIPTION
=================

libfsimage contains parsing code for several filesystems, most of them based on
grub-legacy code.  libfsimage is used by pygrub to inspect guest disks.

Pygrub runs as the same user as the toolstack (root in a priviledged domain).

At least one issue has been reported to the Xen Security Team that allows an
attacker to trigger a stack buffer overflow in libfsimage.  After further
analisys the Xen Security Team is no longer confident in the suitability of
libfsimage when run against guest controlled input with super user priviledges.

In order to not affect current deployments that rely on pygrub patches are
provided in the resolution section of the advisory that allow running pygrub in
deprivileged mode.

CVE-2023-4949 refers to the original issue in the upstream grub
project ("An attacker with local access to a system (either through a
disk or external drive) can present a modified XFS partition to
grub-legacy in such a way to exploit a memory corruption in grub’s XFS
file system implementation.")  CVE-2023-34325 refers specifically to
the vulnerabilities in Xen's copy of libfsimage, which is decended
from a very old version of grub.

IMPACT
======

A guest using pygrub can escalate its privilege to that of the domain
construction tools (i.e., normally, to control of the host).

VULNERABLE SYSTEMS
==================

All Xen versions are affected.

MITIGATION
==========

Ensuring that guests do not use the pygrub bootloader will avoid this
vulnerability.

For cases where the PV guest is known to be 64bit, and uses grub2 as a
bootloader, pvgrub is a suitable alternative pygrub.

Running only HVM guests will avoid the vulnerability.

CREDITS
=======

This issue was discovered by Ferdinand Nölscher of Google.

RESOLUTION
==========

Applying patches 1-4 resolves the libfsimage XFS stack overflow.  Applying
patches 5-11 add additional functionality to pygrub and libxl in order to run
pygrub in a restricted environment using a specific UID.  Check xl.cfg man page
for information on the bootloader_restrict option.

Note that patches for released versions are generally prepared to
apply to the stable branches, and may not apply cleanly to the most
recent release tarball.  Downstreams are encouraged to update to the
tip of the stable branch before applying these patches.

xsa443/xsa443-??.patch          xen-unstable
xsa443/xsa443-4.17-??.patch     Xen 4.17.x
xsa443/xsa443-4.16-??.patch     Xen 4.16.x
xsa443/xsa443-4.15-??.patch     Xen 4.15.x

$ sha256sum xsa443*/*
d2b306efd35b1e207904f4142be724c4b70bacafae73f8efd5ee12570eb235a1  xsa443/xsa443-01.patch
3af33399c9966465ef65461c344fe0c3184a21a59830de8e3701122cda4f5483  xsa443/xsa443-02.patch
a260be66f02307143d9e776cac2b95735011056bebd718f175680f879563ea21  xsa443/xsa443-03.patch
170d511df3a3898ab0302f7e85bc63127cb0b75f73fdcd83104d3f358365f648  xsa443/xsa443-4.15-01.patch
16c942da8929ab240a8807da05d9b39bbabfb34adc4f5a63bc3d2d99568973b1  xsa443/xsa443-4.15-02.patch
13fd27948f5a5e21e1a8e0ddf218ec79b44f1fca55fdc371c932ad2dfa5c23ea  xsa443/xsa443-4.15-03.patch
1c865b8f0048483ea76e8cfbeba1536ca6cbde04c58a7e0d485d46c063046cf4  xsa443/xsa443-4.15-04.patch
115b9561c0ea8f155d60049a1e60a26e5261147b1d2672d8a96313aef5dd95e6  xsa443/xsa443-4.15-05.patch
5e54fe8fcd56de43e9035e57ed964cc677aca853b6f205f8576f56aa8f968bf0  xsa443/xsa443-4.15-06.patch
a0bd7681bd541b21d069cd025cfb97c798c35041300d5cc86f59941471b88b3c  xsa443/xsa443-4.15-07.patch
165795217669df7fa2f6bcb3eb820f93391c7d46422eb941ae359b43ce5c510f  xsa443/xsa443-4.15-08.patch
fe8be8c39f83567597ec5077bd6fe8b57324d5f6bed7f5cfbed7df43008f7835  xsa443/xsa443-4.15-09.patch
48936926848af29786490dd6db3dcfaf8ed8443f1d6ae896dcb95c930e2f4c21  xsa443/xsa443-4.15-10.patch
213b6a45198869869248b2e3c096fd327f7b0cccbd68faa12335134172c7c908  xsa443/xsa443-4.15-11.patch
170d511df3a3898ab0302f7e85bc63127cb0b75f73fdcd83104d3f358365f648  xsa443/xsa443-4.16-01.patch
16c942da8929ab240a8807da05d9b39bbabfb34adc4f5a63bc3d2d99568973b1  xsa443/xsa443-4.16-02.patch
13fd27948f5a5e21e1a8e0ddf218ec79b44f1fca55fdc371c932ad2dfa5c23ea  xsa443/xsa443-4.16-03.patch
1c865b8f0048483ea76e8cfbeba1536ca6cbde04c58a7e0d485d46c063046cf4  xsa443/xsa443-4.16-04.patch
115b9561c0ea8f155d60049a1e60a26e5261147b1d2672d8a96313aef5dd95e6  xsa443/xsa443-4.16-05.patch
5e54fe8fcd56de43e9035e57ed964cc677aca853b6f205f8576f56aa8f968bf0  xsa443/xsa443-4.16-06.patch
a0bd7681bd541b21d069cd025cfb97c798c35041300d5cc86f59941471b88b3c  xsa443/xsa443-4.16-07.patch
165795217669df7fa2f6bcb3eb820f93391c7d46422eb941ae359b43ce5c510f  xsa443/xsa443-4.16-08.patch
fe8be8c39f83567597ec5077bd6fe8b57324d5f6bed7f5cfbed7df43008f7835  xsa443/xsa443-4.16-09.patch
c9538238f4b636b7d093a59610b0eab2e7fd409a7cc9e988d006bee4c9b944f7  xsa443/xsa443-4.16-10.patch
62147de7a6b8a0073c7abe204da25e94871a32c4e3851f9feccf065976dc0267  xsa443/xsa443-4.16-11.patch
3322213303481fea964cf18e09b172d42caf21fe662c947ae6ddc0d8a1789fa1  xsa443/xsa443-4.17-01.patch
02cf94559407d693ef2dcfc47671b63f5f27019dd759bae3b5eaaa922fb4ea74  xsa443/xsa443-4.17-02.patch
189bef69380d6fbd7f571b2fe11908bac26a650e2b0d040e12b8c1266373f8c8  xsa443/xsa443-4.17-03.patch
cdb4f0dd47a6c8a759ae4ffd400f2ce72675b8779ca5576dea74e372ca77a021  xsa443/xsa443-4.17-04.patch
2147dcf95b1ad36da0961e2c084072fa9eb59486e9c0ed43444d268a17d01ee1  xsa443/xsa443-4.17-05.patch
a523273792a77fa55a7ab8925369edcb9d9ae50e8e9236be43f23e66aaa0f5e2  xsa443/xsa443-4.17-06.patch
54f97e027c80bfed8e3559ba8d89a69d2f4c48e1017c2090af029a01efe49741  xsa443/xsa443-4.17-07.patch
79667e7b8fbfa43f9135ba14ca364c63e1e7e7c3a68ae12513fe0204e57fa2bd  xsa443/xsa443-4.17-08.patch
11125e8da5f9e8313d943e6cbba2ff160478681c290b1413c88113292cca91c4  xsa443/xsa443-4.17-09.patch
113bbc294e10be4e8bf9855536114f875add033f790504f5c744b38da85d1b11  xsa443/xsa443-4.17-10.patch
7e5c7d4ef0b148ce9421c1856ced8b023bae22abc8e13956fe2832628c9d4189  xsa443/xsa443-4.17-11.patch
eb81bcbaf1016bce77696c1f2f5cd90b22e11eaa02d15c36c4c704b02981c50d  xsa443/xsa443-04.patch
5a099d8bf6a06e318f9ff92491ae4191fd2a3f8637a3c9616173bd2c7d56dbb6  xsa443/xsa443-05.patch
32733ee7dd1baf81338d50532876f211660dd65eb44f3ea121604b4c897ba30f  xsa443/xsa443-06.patch
9dfe8e70ed3007dbe46de75d6790baa770d91ac42d6abf642ca0f11b8b2d6b6d  xsa443/xsa443-07.patch
b8040da4d2ef22ed9f96e1648fa8c4682f82bce2d17bbdd9f2250c48f8858d10  xsa443/xsa443-08.patch
4b0fa7efd271de010943a2974e178d6e9c44c5181a94fc58ddd3f9ecd953d572  xsa443/xsa443-09.patch
f1b97a6ee5dc15a2b85ffde12242eb65d885b244419f34d737eb4489769f7224  xsa443/xsa443-10.patch
eafccd01a5458baf2a7f39b3e533fd3638d6f728078c437247dc712856422706  xsa443/xsa443-11.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmVM+FMMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZU7AIALBwYs4RFK+Q3YhyXBdKCFybnRJmj6qVgeJXZr7m
lk1SFdickZpnWrV7UL/BlLbR/PuYSqbkICYVoyVqMTOP/O5UHTxpZEP1q9SqAW0z
Jm/7oi1YNkBc/XKYUoEW2Z/k6S3dTzG+iNTB5Xn25DKZtzTb3YtaNCuMGqWYHDfz
Q/NHc3uLtxnXKjq/YMSs9ig2VEjRTphkiTe37mN0hFmnXDBlxtZHj1h5iw1DwO/o
W64C4H+3DlI5SA7yTY1EEVPWfNr+t/GqvafgAVMcy1WGutHTZVaMp814ctxXvAex
grTDK/k+jmEa12zCWodkf85EZNCisVnyBfoo5W9DJ2w2Udo=
=eeA0
-----END PGP SIGNATURE-----

Download attachment "[xsa443/xsa443-01.patch](3/1)" of type "application/octet-stream" (1907 bytes)

Download attachment "[xsa443/xsa443-02.patch](3/2)" of type "application/octet-stream" (1174 bytes)

Download attachment "[xsa443/xsa443-03.patch](3/3)" of type "application/octet-stream" (4970 bytes)

Download attachment "[xsa443/xsa443-4.15-01.patch](3/4)" of type "application/octet-stream" (1907 bytes)

Download attachment "[xsa443/xsa443-4.15-02.patch](3/5)" of type "application/octet-stream" (1174 bytes)

Download attachment "[xsa443/xsa443-4.15-03.patch](3/6)" of type "application/octet-stream" (5023 bytes)

Download attachment "[xsa443/xsa443-4.15-04.patch](3/7)" of type "application/octet-stream" (2138 bytes)

Download attachment "[xsa443/xsa443-4.15-05.patch](3/8)" of type "application/octet-stream" (2019 bytes)

Download attachment "[xsa443/xsa443-4.15-06.patch](3/9)" of type "application/octet-stream" (2036 bytes)

Download attachment "[xsa443/xsa443-4.15-07.patch](3/10)" of type "application/octet-stream" (4265 bytes)

Download attachment "[xsa443/xsa443-4.15-08.patch](3/11)" of type "application/octet-stream" (4477 bytes)

Download attachment "[xsa443/xsa443-4.15-09.patch](3/12)" of type "application/octet-stream" (12166 bytes)

Download attachment "[xsa443/xsa443-4.15-10.patch](3/13)" of type "application/octet-stream" (9005 bytes)

Download attachment "[xsa443/xsa443-4.15-11.patch](3/14)" of type "application/octet-stream" (6491 bytes)

Download attachment "[xsa443/xsa443-4.16-01.patch](3/15)" of type "application/octet-stream" (1907 bytes)

Download attachment "[xsa443/xsa443-4.16-02.patch](3/16)" of type "application/octet-stream" (1174 bytes)

Download attachment "[xsa443/xsa443-4.16-03.patch](3/17)" of type "application/octet-stream" (5023 bytes)

Download attachment "[xsa443/xsa443-4.16-04.patch](3/18)" of type "application/octet-stream" (2138 bytes)

Download attachment "[xsa443/xsa443-4.16-05.patch](3/19)" of type "application/octet-stream" (2019 bytes)

Download attachment "[xsa443/xsa443-4.16-06.patch](3/20)" of type "application/octet-stream" (2036 bytes)

Download attachment "[xsa443/xsa443-4.16-07.patch](3/21)" of type "application/octet-stream" (4265 bytes)

Download attachment "[xsa443/xsa443-4.16-08.patch](3/22)" of type "application/octet-stream" (4477 bytes)

Download attachment "[xsa443/xsa443-4.16-09.patch](3/23)" of type "application/octet-stream" (12166 bytes)

Download attachment "[xsa443/xsa443-4.16-10.patch](3/24)" of type "application/octet-stream" (9005 bytes)

Download attachment "[xsa443/xsa443-4.16-11.patch](3/25)" of type "application/octet-stream" (6491 bytes)

Download attachment "[xsa443/xsa443-4.17-01.patch](3/26)" of type "application/octet-stream" (1907 bytes)

Download attachment "[xsa443/xsa443-4.17-02.patch](3/27)" of type "application/octet-stream" (1174 bytes)

Download attachment "[xsa443/xsa443-4.17-03.patch](3/28)" of type "application/octet-stream" (5023 bytes)

Download attachment "[xsa443/xsa443-4.17-04.patch](3/29)" of type "application/octet-stream" (2165 bytes)

Download attachment "[xsa443/xsa443-4.17-05.patch](3/30)" of type "application/octet-stream" (2019 bytes)

Download attachment "[xsa443/xsa443-4.17-06.patch](3/31)" of type "application/octet-stream" (2036 bytes)

Download attachment "[xsa443/xsa443-4.17-07.patch](3/32)" of type "application/octet-stream" (4265 bytes)

Download attachment "[xsa443/xsa443-4.17-08.patch](3/33)" of type "application/octet-stream" (4477 bytes)

Download attachment "[xsa443/xsa443-4.17-09.patch](3/34)" of type "application/octet-stream" (12166 bytes)

Download attachment "[xsa443/xsa443-4.17-10.patch](3/35)" of type "application/octet-stream" (9005 bytes)

Download attachment "[xsa443/xsa443-4.17-11.patch](3/36)" of type "application/octet-stream" (6491 bytes)

Download attachment "[xsa443/xsa443-04.patch](3/37)" of type "application/octet-stream" (2193 bytes)

Download attachment "[xsa443/xsa443-05.patch](3/38)" of type "application/octet-stream" (2019 bytes)

Download attachment "[xsa443/xsa443-06.patch](3/39)" of type "application/octet-stream" (2036 bytes)

Download attachment "[xsa443/xsa443-07.patch](3/40)" of type "application/octet-stream" (4265 bytes)

Download attachment "[xsa443/xsa443-08.patch](3/41)" of type "application/octet-stream" (4477 bytes)

Download attachment "[xsa443/xsa443-09.patch](3/42)" of type "application/octet-stream" (12161 bytes)

Download attachment "[xsa443/xsa443-10.patch](3/43)" of type "application/octet-stream" (15952 bytes)

Download attachment "[xsa443/xsa443-11.patch](3/44)" of type "application/octet-stream" (6527 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.wordfence.com_8c1f0a82_20250114_180442.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# AdSanity < 1.8.2 - Authenticated Arbitrary File Upload

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   AdSanity < 1.8.2 - Authenticated Arbitrary File Upload

8.8

**Unrestricted Upload of File with Dangerous Type**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2022-4949](https://www.cve.org/CVERecord?id=CVE-2022-4949) |
| --- | --- |
| CVSS | 8.8 (High) |
| Publicly Published | January 25, 2022 |
| Last Updated | January 22, 2024 |
| Researcher | [Jerome Bruandet - NinTechNet](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/jerome-bruandet-1) |

### Description

The AdSanity plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the 'ajax\_upload' function in versions up to, and including, 1.8.1. This makes it possible for authenticated attackers with Contributor+ level privileges to upload arbitrary files on the affected sites server which makes remote code execution possible.

#### References

* [blog.nintechnet.com](https://blog.nintechnet.com/critical-vulnerability-in-wordpress-adsanity-plugin/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fadsanity%2Fadsanity-182-authenticated-arbitrary-file-upload&t=AdSanity%20%3C%201.8.2%20-%20Authenticated%20Arbitrary%20File%20Upload "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fadsanity%2Fadsanity-182-authenticated-arbitrary-file-upload&text=AdSanity%20%3C%201.8.2%20-%20Authenticated%20Arbitrary%20File%20Upload "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fadsanity%2Fadsanity-182-authenticated-arbitrary-file-upload "LinkedIn")
Email

## Vulnerability Details for AdSanity

#### [AdSanity](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/adsanity)

| Software Type | Plugin |
| --- | --- |
| Software Slug | adsanity |
| Patched? | Yes |
| Remediation | Update to version 1.8.2, or a newer patched version |
| Affected Version | * < 1.8.2 |
| Patched Version | * 1.8.2 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


