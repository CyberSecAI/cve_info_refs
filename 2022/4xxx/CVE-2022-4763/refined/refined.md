- **Root cause of vulnerability:** The Icon Widget plugin does not properly validate and escape shortcode attributes before outputting them, leading to a stored XSS vulnerability.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability due to improper sanitization of shortcode attributes.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code that executes in the context of other users' browsers, including those with administrative privileges. This could lead to account takeover, data theft, or other malicious actions.
- **Attack vectors:** By crafting a malicious shortcode with a payload in the `classes` attribute (e.g., `[icon_widget classes='" onmouseover="alert(1)"']`), an attacker with Contributor+ role can inject malicious code that will be executed when a page containing the shortcode is viewed.
- **Required attacker capabilities/position:** An attacker needs to have at least Contributor role permissions on the WordPress site to be able to add or edit posts/pages and insert shortcodes, the malicious code executes when other users visit the page containing the shortcode.