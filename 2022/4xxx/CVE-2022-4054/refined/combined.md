=== Content from gitlab.com_0c8c8b25_20250115_085834.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Webhook secret tokens can be leaked by maintainer changing URL

**[HackerOne report #1757999](https://hackerone.com/reports/1757999)** by `joaxcar` on 2022-11-01, assigned to [@greg](/greg "Greg Myers"):

[Report](#report) | [How To Reproduce](#how-to-reproduce) | [Imported issue](https://gitlab.com/gitlab-org/gitlab/-/issues/383113 "Maintainer can leak webhook secret token by changing the webhook URL")

## Report

Imported from h1: [#383113 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/383113 "Maintainer can leak webhook secret token by changing the webhook URL")

#### Summary

Since issue [#359989 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/359989 "Hide secret tokens in webhook settings form") was merged, webhook secrets are now hidden for maintainers of a project after they are saved. The UI and API gives no way of retrieving the secret after configuration.

However, a maintainer with access to the project webhook settings could change the webhook URL to a different endpoint and extract the secret token via the request sent to that endpoint.

#### Impact

Secret webhook tokens are discoverable to project maintainers who change the webhook URL.

#### What is the current *bug* behavior?

Secret token value is retained, *not* reset upon changing the webhook URL.

#### What is the expected *correct* behavior?

Secret token will be reset and not retained after changing a webhook URL.

#### Relevant logs and/or screenshots

#### Output of checks

This bug happens on GitLab.com

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

1. Create a new project
2. Go to <https://gitlab.com/GROUP/PROJECT/-/hooks> and configure a webhook. Make sure you also add a secret token.
3. Click save
4. Invite another user to the project as a maintainer
5. Log into GitLab as the newly-appointed maintainer
6. Go to the project hooks as this user <https://gitlab.com/GROUP/PROJECT/-/hooks>
7. Modify webhook URL to point to an endpoint that can be used to sniff/extract the secret token (webhook.site)
8. Test the webhook
9. Get secret token from request header sent to the new endpoint
10. (Optional) Change webhook URL back to original URL to restore functionality and reduce likelihook of detection

Related to [#381895 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/381895 "Webhook secret tokens leaked in webhook logs")

Edited Nov 17, 2022 by [Greg Myers](/greg)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_1b506d72_20250115_085832.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-4054.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-4054.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-4054.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2022/CVE-2022-4054.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jan 20, 2023

  [47fcbe18](/gitlab-org/cves/-/commit/47fcbe18b81aaa6269fd8a456991aa8543b4b94a)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/47fcbe18b81aaa6269fd8a456991aa8543b4b94a)
  ·
  47fcbe18

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 20, 2023

  47fcbe18

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/47fcbe18b81aaa6269fd8a456991aa8543b4b94a)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jan 20, 2023

Loading


