The provided content relates to CVE-2022-31061.

**Root cause of vulnerability:**
The vulnerability is due to an SQL injection flaw present in the login page. Specifically, the code parsing the authentication method (`login_auth`) was vulnerable to injection. The `login_auth` parameter is used to determine the authentication method (local, LDAP, mail, external). The original code used `strstr` and `explode`, and directly used the value to set up the database query, which could be manipulated to perform SQL injection.

**Weaknesses/vulnerabilities present:**
- SQL Injection (CWE-89)
- Improper input validation of the `login_auth` parameter

**Impact of exploitation:**
- An attacker could potentially execute arbitrary SQL queries on the database, leading to data exfiltration, modification, or complete compromise of the application and its underlying data.
- The vulnerability can be exploited without needing to be logged in, increasing the severity.

**Attack vectors:**
- The vulnerability is accessible through the login page, specifically by manipulating the `login_auth` parameter in the login request.

**Required attacker capabilities/position:**
- The attacker needs network access to the vulnerable GLPI instance.
- No prior authentication is required to exploit this vulnerability.
- The attacker needs to manipulate the `login_auth` parameter to inject malicious SQL code.

**Additional Notes:**
- The provided diff shows how the vulnerability was patched. The code was changed to use `preg_match` with named capture groups to extract the authentication type and ID. It also converts the extracted ID to an integer, preventing SQL injection.
- The vulnerable versions are >= 9.3.0 and the patched versions are 9.5.8 and 10.0.2.