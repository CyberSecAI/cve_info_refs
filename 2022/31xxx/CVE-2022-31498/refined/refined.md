The provided content contains information about CVE-2022-31498.

**Root cause of vulnerability:**
The vulnerability is caused by a lack of input sanitization in the `patient_match_dialog.php` script. Specifically, the `key` GET parameter is not properly sanitized, allowing for the injection of malicious JavaScript code.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS) vulnerability.

**Impact of exploitation:**
- An attacker can execute arbitrary JavaScript code in the context of the victim's browser. This can lead to various malicious actions, such as:
    - Stealing session cookies, potentially gaining unauthorized access to the application
    - Redirecting the victim to malicious websites
    - Defacing the website
    - Performing actions on behalf of the victim

**Attack vectors:**
- The vulnerability is triggered by crafting a malicious URL that includes the XSS payload in the `key` parameter.
- The attacker needs to convince a victim to click on the malicious link or include it into an iframe on an attacker controlled website.

**Required attacker capabilities/position:**
- The attacker needs to craft a malicious URL containing the XSS payload.
- The attacker needs to deliver this malicious link to a victim.
- The attacker does not need any special privileges to trigger the vulnerability.

**Technical Details:**

The vulnerability is present in the following URL:
`librehealth_host/orders/patient_match_dialog.php?key=<script>alert(document.cookie)</script>`

The provided proof of concept demonstrates how an attacker can inject JavaScript code via the `key` parameter. When a user opens the crafted URL, the JavaScript code will be executed. In this specific proof of concept the attacker uses the script `alert(document.cookie)` to show the user's cookies.

The provided content also suggests a remediation of this issue: `Add htmlspecialchars() before printing values`.