=== Content from github.com_5fc501e8_20250115_095109.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2Ff7758457b7ec3489d525e39aa753cc70809d9ad9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2Ff7758457b7ec3489d525e39aa753cc70809d9ad9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=DSpace%2FDSpace)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DSpace](/DSpace)
/
**[DSpace](/DSpace/DSpace)**
Public

* [Notifications](/login?return_to=%2FDSpace%2FDSpace) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FDSpace%2FDSpace)
* [Star
   919](/login?return_to=%2FDSpace%2FDSpace)

* [Code](/DSpace/DSpace)
* [Issues
  591](/DSpace/DSpace/issues)
* [Pull requests
  160](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects
  0](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

Additional navigation options

* [Code](/DSpace/DSpace)
* [Issues](/DSpace/DSpace/issues)
* [Pull requests](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

## Commit

[Permalink](/DSpace/DSpace/commit/f7758457b7ec3489d525e39aa753cc70809d9ad9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[DS-4133] Improve URL handling in Controlled Vocab JSPUI servlet

[Browse files](/DSpace/DSpace/tree/f7758457b7ec3489d525e39aa753cc70809d9ad9)
Browse the repository at this point in the history

* Loading branch information

[![@kshepherd](https://avatars.githubusercontent.com/u/194773?s=40&v=4)](/kshepherd)

[kshepherd](/DSpace/DSpace/commits?author=kshepherd "View all commits by kshepherd")
committed
Jan 14, 2022

1 parent
[e196e74](/DSpace/DSpace/commit/e196e748ade863a035c2861f0b5b87951479c918)

commit f775845

Showing
**1 changed file**
with
**10 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

12 changes: 10 additions & 2 deletions

12
[dspace-jspui/src/main/java/org/dspace/app/webui/servlet/ControlledVocabularyServlet.java](#diff-efdbfd863f6f3efb4cf04e7e34440226814cac13dc194f241cc6387cf9bdc580 "dspace-jspui/src/main/java/org/dspace/app/webui/servlet/ControlledVocabularyServlet.java")

Show comments

[View file](/DSpace/DSpace/blob/f7758457b7ec3489d525e39aa753cc70809d9ad9/dspace-jspui/src/main/java/org/dspace/app/webui/servlet/ControlledVocabularyServlet.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,6 +14,7 @@ |
|  |  | import javax.servlet.http.HttpServletRequest; |
|  |  | import javax.servlet.http.HttpServletResponse; |
|  |  |  |
|  |  | import org.apache.log4j.Logger; |
|  |  | import org.dspace.authorize.AuthorizeException; |
|  |  | import org.dspace.core.Context; |
|  |  |  |
| Expand All | | @@ -25,8 +26,8 @@ |
|  |  | \*/ |
|  |  | public class ControlledVocabularyServlet extends DSpaceServlet |
|  |  | { |
|  |  | // private static Logger log = |
|  |  | // Logger.getLogger(ControlledVocabularyServlet.class); |
|  |  | private static Logger log = |
|  |  | Logger.getLogger(ControlledVocabularyServlet.class); |
|  |  |  |
|  |  | protected void doDSGet(Context context, HttpServletRequest request, |
|  |  | HttpServletResponse response) throws ServletException, IOException, |
| Expand All | | @@ -37,6 +38,13 @@ protected void doDSGet(Context context, HttpServletRequest request, |
|  |  | String filter = ""; |
|  |  | String callerUrl = request.getParameter("callerUrl"); |
|  |  |  |
|  |  | // callerUrl must starts with URL outside DSpace request context path |
|  |  | if(!callerUrl.startsWith(request.getContextPath())) { |
|  |  | log.error("Controlled vocabulary caller URL would result in redirect outside DSpace web app: " + callerUrl + ". Rejecting request with 400 Bad Request."); |
|  |  | response.sendError(400, "The caller URL must be within the DSpace base URL of " + request.getContextPath()); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | if (request.getParameter("ID") != null) |
|  |  | { |
|  |  | ID = request.getParameter("ID"); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f775845`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2Ff7758457b7ec3489d525e39aa753cc70809d9ad9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_00e9274e_20250115_095109.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2F28eb8158210d41168a62ed5f9e044f754513bc37)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2F28eb8158210d41168a62ed5f9e044f754513bc37)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=DSpace%2FDSpace)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DSpace](/DSpace)
/
**[DSpace](/DSpace/DSpace)**
Public

* [Notifications](/login?return_to=%2FDSpace%2FDSpace) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FDSpace%2FDSpace)
* [Star
   919](/login?return_to=%2FDSpace%2FDSpace)

* [Code](/DSpace/DSpace)
* [Issues
  591](/DSpace/DSpace/issues)
* [Pull requests
  160](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects
  0](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

Additional navigation options

* [Code](/DSpace/DSpace)
* [Issues](/DSpace/DSpace/issues)
* [Pull requests](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

## Commit

[Permalink](/DSpace/DSpace/commit/28eb8158210d41168a62ed5f9e044f754513bc37)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[DS-4383] Request Item Servlet escape HTML

[Browse files](/DSpace/DSpace/tree/28eb8158210d41168a62ed5f9e044f754513bc37)
Browse the repository at this point in the history

* Loading branch information

[![@kshepherd](https://avatars.githubusercontent.com/u/194773?s=40&v=4)](/kshepherd)

[kshepherd](/DSpace/DSpace/commits?author=kshepherd "View all commits by kshepherd")
committed
Jul 26, 2022

1 parent
[56e7604](/DSpace/DSpace/commit/56e76049185bbd87c994128a9d77735ad7af0199)

commit 28eb815

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**8 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* dspace-jspui/src/main/java/org/dspace/app/webui

  + servlet

    - dspace-jspui/src/main/java/org/dspace/app/webui/servlet/RequestItemServlet.java
      [RequestItemServlet.java](#diff-47989e7471fb01fa89394238de023a1f645e0c5ebe7c927f1473e2a828710dd7)
  + util

    - dspace-jspui/src/main/java/org/dspace/app/webui/util/RequestItemManager.java
      [RequestItemManager.java](#diff-87e6dbb5f3c5394a3295825cda906b01f3acb5950928fab0d0ec749a559c0cc4)

## There are no files selected for viewing

11 changes: 6 additions & 5 deletions

11
[dspace-jspui/src/main/java/org/dspace/app/webui/servlet/RequestItemServlet.java](#diff-47989e7471fb01fa89394238de023a1f645e0c5ebe7c927f1473e2a828710dd7 "dspace-jspui/src/main/java/org/dspace/app/webui/servlet/RequestItemServlet.java")

Show comments

[View file](/DSpace/DSpace/blob/28eb8158210d41168a62ed5f9e044f754513bc37/dspace-jspui/src/main/java/org/dspace/app/webui/servlet/RequestItemServlet.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,6 +8,7 @@ |
|  |  | package org.dspace.app.webui.servlet; |
|  |  |  |
|  |  | import org.apache.commons.lang.StringUtils; |
|  |  | import org.apache.commons.lang3.StringEscapeUtils; |
|  |  | import org.apache.log4j.Logger; |
|  |  | import org.dspace.app.requestitem.RequestItemAuthor; |
|  |  | import org.dspace.app.requestitem.RequestItemAuthorExtractor; |
| Expand Down  Expand Up | | @@ -135,7 +136,7 @@ private void processForm (Context context, |
|  |  | // handle |
|  |  | String handle = request.getParameter("handle"); |
|  |  |  |
|  |  | String bitstream\_id=request.getParameter("bitstream-id"); |
|  |  | int bitstream\_id= UIUtil.getIntParameter(request, "bitstream-id"); |
|  |  |  |
|  |  | // Title |
|  |  | String title = null; |
| Expand All | | @@ -160,7 +161,7 @@ private void processForm (Context context, |
|  |  | } |
|  |  |  |
|  |  | // User email from context |
|  |  | String requesterEmail = request.getParameter("email"); |
|  |  | String requesterEmail = StringEscapeUtils.escapeHtml4(request.getParameter("email")); |
|  |  | EPerson currentUser = context.getCurrentUser(); |
|  |  | String userName = null; |
|  |  |  |
| Expand All | | @@ -172,8 +173,8 @@ private void processForm (Context context, |
|  |  |  |
|  |  | if (request.getParameter("submit") != null) |
|  |  | { |
|  |  | String reqname = request.getParameter("reqname"); |
|  |  | String coment = request.getParameter("coment"); |
|  |  | String reqname = StringEscapeUtils.escapeHtml4(request.getParameter("reqname")); |
|  |  | String coment = StringEscapeUtils.escapeHtml4(request.getParameter("coment")); |
|  |  | if (coment == null || coment.equals("")) |
|  |  | coment = ""; |
|  |  | boolean allfiles = "true".equals(request.getParameter("allfiles")); |
| Expand Down  Expand Up | | @@ -217,7 +218,7 @@ private void processForm (Context context, |
|  |  | email.addArgument(requesterEmail); |
|  |  | email.addArgument(allfiles ? I18nUtil |
|  |  | .getMessage("itemRequest.all") : Bitstream.find( |
|  |  | context, Integer.parseInt(bitstream\_id)).getName()); |
|  |  | context, bitstream\_id).getName()); |
|  |  | email.addArgument(HandleManager.getCanonicalForm(item |
|  |  | .getHandle())); |
|  |  | email.addArgument(title); // request item title |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[dspace-jspui/src/main/java/org/dspace/app/webui/util/RequestItemManager.java](#diff-87e6dbb5f3c5394a3295825cda906b01f3acb5950928fab0d0ec749a559c0cc4 "dspace-jspui/src/main/java/org/dspace/app/webui/util/RequestItemManager.java")

Show comments

[View file](/DSpace/DSpace/blob/28eb8158210d41168a62ed5f9e044f754513bc37/dspace-jspui/src/main/java/org/dspace/app/webui/util/RequestItemManager.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -118,7 +118,7 @@ protected static String getNewToken(Context context, int bitstreamId |
|  |  | \* @exception SQLExeption |
|  |  | \* |
|  |  | \*/ |
|  |  | public static String getLinkTokenEmail(Context context, String bitstreamId |
|  |  | public static String getLinkTokenEmail(Context context, int bitstreamId |
|  |  | , int itemID, String reqEmail, String reqName, boolean allfiles) |
|  |  | throws SQLException |
|  |  | { |
| Expand All | | @@ -128,7 +128,7 @@ public static String getLinkTokenEmail(Context context, String bitstreamId |
|  |  | base.endsWith("/") ? "" : "/").append( |
|  |  | "request-item").append("?step=" + RequestItemServlet.ENTER\_TOKEN) |
|  |  | .append("&token=") |
|  |  | .append(getNewToken(context, Integer.parseInt(bitstreamId), itemID, reqEmail, reqName, allfiles)) |
|  |  | .append(getNewToken(context, bitstreamId, itemID, reqEmail, reqName, allfiles)) |
|  |  | .toString(); |
|  |  |  |
|  |  | return specialLink; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `28eb815`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2F28eb8158210d41168a62ed5f9e044f754513bc37) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_604d571a_20250115_095110.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fsecurity%2Fadvisories%2FGHSA-4wm8-c2vv-xrpq)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fsecurity%2Fadvisories%2FGHSA-4wm8-c2vv-xrpq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=DSpace%2FDSpace)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DSpace](/DSpace)
/
**[DSpace](/DSpace/DSpace)**
Public

* [Notifications](/login?return_to=%2FDSpace%2FDSpace) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FDSpace%2FDSpace)
* [Star
   919](/login?return_to=%2FDSpace%2FDSpace)

* [Code](/DSpace/DSpace)
* [Issues
  591](/DSpace/DSpace/issues)
* [Pull requests
  160](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects
  0](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

Additional navigation options

* [Code](/DSpace/DSpace)
* [Issues](/DSpace/DSpace/issues)
* [Pull requests](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

# Cross Site Scripting (XSS) possible in JSPUI "Request a Copy" feature

Moderate

[tdonohue](/tdonohue)
published
GHSA-4wm8-c2vv-xrpq
Jul 29, 2022

## Package

maven

dspace-jspui
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

5.0<=6.3

## Patched versions

6.4, 5.11

## Description

### Impact

The JSPUI "Request a Copy" feature does not properly escape values submitted and stored from the "Request a Copy" form. This means that item requests could be vulnerable to XSS attacks. This vulnerability only impacts the JSPUI.

*This vulnerability does NOT impact the XMLUI or 7.x.*

### Patches

*DSpace 6.x:*

* Fixed in 6.4 via commit: [503a6af](https://github.com/DSpace/DSpace/commit/503a6af57fd720c37b0d86c34de63baa5dd85819)
* 6.x patch file: <https://github.com/DSpace/DSpace/commit/503a6af57fd720c37b0d86c34de63baa5dd85819.patch> (may be applied manually if an immediate upgrade to 6.4 is not possible)

*DSpace 5.x:*

* Fixed in 5.11 via commit: [28eb815](https://github.com/DSpace/DSpace/commit/28eb8158210d41168a62ed5f9e044f754513bc37)
* 5.x patch file: <https://github.com/DSpace/DSpace/commit/28eb8158210d41168a62ed5f9e044f754513bc37.patch> (may be applied manually if an immediate upgrade to 5.11 or 6.4 is not possible)

#### Apply the patch to your DSpace

If at all possible, we recommend upgrading your DSpace site based on the upgrade instructions. However, if you are unable to do so, you can manually apply the above patches as follows:

1. Download the appropriate patch file to the machine where DSpace is running
2. From the `[dspace-src]` folder, apply the patch, e.g. `git apply [name-of-file].patch`
3. Now, update your DSpace site (based loosely on the Upgrade instructions). This generally involves three steps:
   1. Rebuild DSpace, e.g. `mvn -U clean package` (This will recompile all DSpace code)
   2. Redeploy DSpace, e.g. `ant update` (This will copy all updated WARs / configs to your installation directory). Depending on your setup you also may need to copy the updated WARs over to your Tomcat webapps folder.
   3. Restart Tomcat

### Workarounds

As a workaround, you can temporarily disable the "Request a Copy" feature by either commenting out the below configuration (or setting its value to empty):

```
# Comment out this default value
# request.item.type = all

```

Once your JSPUI site is patched, you can re-enable this setting. See [https://wiki.lyrasis.org/display/DSDOC6x/Request+a+Copy](https://wiki.lyrasis.org/display/DSDOC6x/Request%2Ba%2BCopy) for more information on this setting.

### References

Discovered & reported by Andrea Bollini of 4Science

### For more information

If you have any questions or comments about this advisory:

* Email us at security@dspace.org

### Severity

Moderate

### CVE ID

CVE-2022-31192

### Weaknesses

[CWE-80](/advisories?query=cwe%3A80)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


