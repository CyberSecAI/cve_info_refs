The provided content is related to CVE-2022-31390.

**Root cause of vulnerability:**
The vulnerability is due to the lack of validation of the `download_url` parameter in the `update` function of the `TemplateController.php` file. This allows an attacker to control the URL used in the `fopen` function.

**Weaknesses/vulnerabilities present:**
- Server-Side Request Forgery (SSRF)

**Impact of exploitation:**
- An attacker can induce the server-side application to make requests to unintended locations, including internal services. This could allow for information disclosure or further exploitation of internal systems.

**Attack vectors:**
- Sending a crafted POST request to `/index.php/admins/Template/update.html` with a malicious `download_url` parameter and `action=start-download`.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HTTP requests to the vulnerable application.
- The attacker needs knowledge of the vulnerable endpoint.
- The attacker needs to have a valid session or be able to authenticate to the vulnerable admin functionality.