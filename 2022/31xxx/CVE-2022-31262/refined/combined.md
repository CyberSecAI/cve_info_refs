=== Content from secure77.de_a9841692_20250114_181219.html ===


[![Secure77](https://secure77.de/wp-content/uploads/2022/09/Zeichenflaeche-1white.png)](https://secure77.de/)

[Toggle Side Menu](#sidr)

* [Home](https://secure77.de/home/)
* [Notes](https://notes.secure77.de)
* [Subjects](https://secure77.de/category/subjects/)
  + [Researches](https://secure77.de/category/subjects/researches/)
  + [Sheets](https://secure77.de/category/subjects/sheets/)
  + [Misc](https://secure77.de/category/subjects/misc/)
* [Development](https://secure77.de/category/development/)
  + [Projects](https://secure77.de/category/development/projects/)
  + [Perlite](https://secure77.de/perlite/)
  + [Scripts / Tools](https://secure77.de/category/development/scripts/)
* [Links](https://secure77.de/links-partner/)
* [Impressum](https://secure77.de/impressum/)
* [About Me](https://secure77.de/about-me/)

[Secure77](https://secure77.de/)

Techblog and Security

![](https://secure77.de/wp-content/uploads/2022/04/image-16.png)

# GOG Galaxy – CVE-2022-31262

Posted: [11. August 2022](https://secure77.de/gog-galaxy-cve-2022-31262/ "21:55") *by* [secure77](https://secure77.de/author/blogadminsecure77/ "Beiträge von secure77")

[Researches](https://secure77.de/category/subjects/researches/)

With my researches, described on my other post [Hunting for LPEs in Gaming Software](https://secure77.de/hunting-for-lpes-in-gaming-software/). I was curious about GOG services which run as Local System. I installed GOG on a „fresh“ Windows 11 and Windows 10 system and focused again to the Service „GalaxCommunication“. As we can see the Service is still running with SYSTEM privileges. tested GOG Versions: 2.0.46 from Februar, 16th 2022 (found exploit) – 2.0.51 from June, 2022 (still exploitable)

[![](https://secure77.de/wp-content/uploads/2022/04/image-14.png)](https://secure77.de/wp-content/uploads/2022/04/image-14.png)

I figured out, that the access to the „C:\ProgramData\GOG.com\Galaxy\redists“ folder is restricted, so a normal user cant write to this location.

[![](https://secure77.de/wp-content/uploads/2022/04/image-9.png)](https://secure77.de/wp-content/uploads/2022/04/image-9.png)
[![](https://secure77.de/wp-content/uploads/2022/04/image-10.png)](https://secure77.de/wp-content/uploads/2022/04/image-10.png)

But interesting is the fact, that the user who has installed GOG still have full (owner) permissions to the parent folders „Galaxy“ and „GOG.com“. Of course for the installation of GOG you need elevated permissions, but the folder permissions doesn’t belog to that elevated user, they belong to the current user, elevated or not.

As example: I have the user „testuser“ who has no administrativ permissions and the user „admin“ who belongs to the local administrators. When you install GOG as the testuser you need to provide the password from an administrator like the user admin. That is ok and intended but as mentioned before, after the installation our testuser is the owner of the Galaxy and GOG.com folders.

[![](https://secure77.de/wp-content/uploads/2022/04/image-11.png)](https://secure77.de/wp-content/uploads/2022/04/image-11.png)
[![](https://secure77.de/wp-content/uploads/2022/04/image-12.png)](https://secure77.de/wp-content/uploads/2022/04/image-12.png)

But why is this a problem? Well, first I thought, as owner from a folder I should be able to overwrite the subfolders with my own permissions, but this is not possible. As soon you will try this, you will receive the following error message for folders and files were you don`t have permissions to

[![](https://secure77.de/wp-content/uploads/2022/04/image-13.png)](https://secure77.de/wp-content/uploads/2022/04/image-13.png)

---

## Bypass the Restriction

But what we can do is to rename the hole parent folder, and what we also can do is to create a new folder with the same name and a subfolder redists in it. And now we are able to write to „C:\ProgramData\GOG.com\Galaxy\redists“!

---

## The Exploit

So the exploit steps are fairly easy

1. Rename „C:\ProgramData\GOG.com\Galaxy“ to „C:\ProgramData\GOG.com\Galaxy\_orig“
2. Create a new folder „C:\ProgramData\GOG.com\Galaxy“
3. Create a new folder „C:\ProgramData\GOG.com\Galaxy\redists“
4. Store your payload as „C:\ProgramData\GOG.com\Galaxy\redists\GalaxyCommunication.exe“
5. Start the service

The service start will fail but your payload will be executed as system

The final exploit can be found here: <https://github.com/secure-77/CVE-2022-31262>

I created a simple PowerShell script which handles the copy and restore process and a c++ executable that spawns a system shell to the current user session.

[![](https://secure77.de/wp-content/uploads/2022/04/image-16.png)](https://secure77.de/wp-content/uploads/2022/04/image-16.png)

---

## POC

---

## Disclosure Timeline

* Reported to GOG Support on 09.04.2022
* Get confirmation about the finding from GOG on 19.05.2022
* Requested CVE-2022-31262 on 22.05.2022
* Asked about any fix or informaiton on 18.07.2022
* No further information or fix was provided by vendor
* Latest Version 2.0.51 is still vulnerable on 11.08.2022
* Published the POC and [CVE-2022-31262](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31262) on 11.08.2022

---

### Schreibe einen Kommentar [Antworten abbrechen](/gog-galaxy-cve-2022-31262/#respond)

Deine E-Mail-Adresse wird nicht veröffentlicht. Erforderliche Felder sind mit \* markiert

Kommentar \*

Name \*

E-Mail \*

Website

 Meinen Namen, meine E-Mail-Adresse und meine Website in diesem Browser für die nächste Kommentierung speichern.

Δ

Copyright © 2025 · All Rights Reserved ·
Secure77 · Theme: Portfolio Lite by [Organic Themes](http://organicthemes.com/)

This website uses cookies and google analytics. If you continue to use the website, we assume that you agree.OK[Datenschutzerklärung](https://secure77.de/datenschutzerklaerung/)



=== Content from secure77.de_98dda2cc_20250114_181219.html ===


[![Secure77](https://secure77.de/wp-content/uploads/2022/09/Zeichenflaeche-1white.png)](https://secure77.de/)

[Toggle Side Menu](#sidr)

* [Home](https://secure77.de/home/)
* [Notes](https://notes.secure77.de)
* [Subjects](https://secure77.de/category/subjects/)
  + [Researches](https://secure77.de/category/subjects/researches/)
  + [Sheets](https://secure77.de/category/subjects/sheets/)
  + [Misc](https://secure77.de/category/subjects/misc/)
* [Development](https://secure77.de/category/development/)
  + [Projects](https://secure77.de/category/development/projects/)
  + [Perlite](https://secure77.de/perlite/)
  + [Scripts / Tools](https://secure77.de/category/development/scripts/)
* [Links](https://secure77.de/links-partner/)
* [Impressum](https://secure77.de/impressum/)
* [About Me](https://secure77.de/about-me/)

[Secure77](https://secure77.de/)

Techblog and Security

[☰ list view](?list=true)

[## GOG Galaxy – CVE-2022-31262

![](https://secure77.de/wp-content/uploads/2022/04/image-16.png)](https://secure77.de/gog-galaxy-cve-2022-31262/)

[## Hunting for LPEs in Gaming Software

![](https://secure77.de/wp-content/uploads/2022/04/image-4.png)](https://secure77.de/hunting-for-lpes-in-gaming-software/)

[## RE: DC-932L Reversing a Webcam Part 3 – Building the Firmware

![](https://secure77.de/wp-content/uploads/2022/05/image-10.png)](https://secure77.de/re-d-link-dc-932l-webcam-building-the-firmware/)

[## RE: DC-932L Reversing a Webcam Part 2 – Extracting the Firmware

![](https://secure77.de/wp-content/uploads/2022/05/Pasted-image-20220502211412.png)](https://secure77.de/re-d-link-dc-932l-webcam-extracting-the-firmware/)

[## RE: DC-932L Reversing a Webcam Part 1 – Getting a Shell

![](https://secure77.de/wp-content/uploads/2022/05/image-1.png)](https://secure77.de/d-link-dcs-932l-webcam-hacking/)

[## NTLM Attack in Metabase CVE-2022-24853

![](https://secure77.de/wp-content/uploads/2021/12/image-9.png)](https://secure77.de/metabase-ntlm-relay-attack/)

[## gMSA Passwords](https://secure77.de/gmsa-passwords/)

Doing one of the recent HTB Boxes i came across the tool https://nettools.net and learned how you can retrieve gMSA passwords with it: https://nettools.net/howto-retrieving-gmsa-password-details/ Additional to the howto from NetTools you can change the encoding for the desired attribute to only retrieve the current password this will print you only the current password as hex

[Continue Reading „gMSA Passwords“](https://secure77.de/gmsa-passwords/)

[## PHP Voting System – Unauthenticated Remote Code Execution

![](https://secure77.de/wp-content/uploads/2021/05/2021-05-06-23_24_18-Voting-System-using-PHP.png)](https://secure77.de/php-voting-system-unauthenticated-remote-code-execution/)

[## PHP Voting System – Admin Authentication Bypass (SQLI)

![](https://secure77.de/wp-content/uploads/2021/05/2021-05-06-23_24_18-Voting-System-using-PHP.png)](https://secure77.de/php-voting-system-admin-authentication-bypass-sqli/)

[## Research Valheim Server Passwords

![](https://secure77.de/wp-content/uploads/2021/03/25140721-valheim-pvp-kaempfe-spieler-bierpong-survial-spiele-trend-hamburg-thumb-1Kea.jpg)](https://secure77.de/valheim-password-phishing-poc/)

## Seitennummerierung der Beiträge

1
[2](https://secure77.de/category/subjects/researches/page/2/)
[Next Page »](https://secure77.de/category/subjects/researches/page/2/)

Copyright © 2025 · All Rights Reserved ·
Secure77 · Theme: Portfolio Lite by [Organic Themes](http://organicthemes.com/)

This website uses cookies and google analytics. If you continue to use the website, we assume that you agree.OK[Datenschutzerklärung](https://secure77.de/datenschutzerklaerung/)



=== Content from github.com_11267cf1_20250115_112015.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsecure-77%2FCVE-2022-31262)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsecure-77%2FCVE-2022-31262)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=secure-77%2FCVE-2022-31262)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[secure-77](/secure-77)
/
**[CVE-2022-31262](/secure-77/CVE-2022-31262)**
Public

* [Notifications](/login?return_to=%2Fsecure-77%2FCVE-2022-31262) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fsecure-77%2FCVE-2022-31262)
* [Star
   4](/login?return_to=%2Fsecure-77%2FCVE-2022-31262)

GOG Galaxy LPE Exploit

[4
stars](/secure-77/CVE-2022-31262/stargazers) [0
forks](/secure-77/CVE-2022-31262/forks) [Branches](/secure-77/CVE-2022-31262/branches) [Tags](/secure-77/CVE-2022-31262/tags) [Activity](/secure-77/CVE-2022-31262/activity)
 [Star](/login?return_to=%2Fsecure-77%2FCVE-2022-31262)

 [Notifications](/login?return_to=%2Fsecure-77%2FCVE-2022-31262) You must be signed in to change notification settings

* [Code](/secure-77/CVE-2022-31262)
* [Issues
  0](/secure-77/CVE-2022-31262/issues)
* [Pull requests
  0](/secure-77/CVE-2022-31262/pulls)
* [Actions](/secure-77/CVE-2022-31262/actions)
* [Projects
  0](/secure-77/CVE-2022-31262/projects)
* [Security](/secure-77/CVE-2022-31262/security)
* [Insights](/secure-77/CVE-2022-31262/pulse)

Additional navigation options

* [Code](/secure-77/CVE-2022-31262)
* [Issues](/secure-77/CVE-2022-31262/issues)
* [Pull requests](/secure-77/CVE-2022-31262/pulls)
* [Actions](/secure-77/CVE-2022-31262/actions)
* [Projects](/secure-77/CVE-2022-31262/projects)
* [Security](/secure-77/CVE-2022-31262/security)
* [Insights](/secure-77/CVE-2022-31262/pulse)

# secure-77/CVE-2022-31262

    main[Branches](/secure-77/CVE-2022-31262/branches)[Tags](/secure-77/CVE-2022-31262/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[10 Commits](/secure-77/CVE-2022-31262/commits/main/) | | |
| [GalaxyCommunication.cpp](/secure-77/CVE-2022-31262/blob/main/GalaxyCommunication.cpp "GalaxyCommunication.cpp") | | [GalaxyCommunication.cpp](/secure-77/CVE-2022-31262/blob/main/GalaxyCommunication.cpp "GalaxyCommunication.cpp") |  |  |
| [GalaxyCommunication.exe](/secure-77/CVE-2022-31262/blob/main/GalaxyCommunication.exe "GalaxyCommunication.exe") | | [GalaxyCommunication.exe](/secure-77/CVE-2022-31262/blob/main/GalaxyCommunication.exe "GalaxyCommunication.exe") |  |  |
| [README.md](/secure-77/CVE-2022-31262/blob/main/README.md "README.md") | | [README.md](/secure-77/CVE-2022-31262/blob/main/README.md "README.md") |  |  |
| [exploit.ps1](/secure-77/CVE-2022-31262/blob/main/exploit.ps1 "exploit.ps1") | | [exploit.ps1](/secure-77/CVE-2022-31262/blob/main/exploit.ps1 "exploit.ps1") |  |  |
| [poc.gif](/secure-77/CVE-2022-31262/blob/main/poc.gif "poc.gif") | | [poc.gif](/secure-77/CVE-2022-31262/blob/main/poc.gif "poc.gif") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2022-31262

GOG Galaxy 2.X LPE Exploit [CVE-2022-31262](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31262)

Tested Versions 2.0.46 - 2.0.51 (latest at 11.08.2022), older versions may also be vulnerable

Blog Post about the finding: <https://secure77.de/gog-galaxy-cve-2022-31262/>

LPE found via: <https://github.com/secure-77/PSAccessFinder>

## POC Demo

[![Demo POC](https://github.com/secure-77/CVE-2022-31262/raw/main/poc.gif)](https://www.youtube.com/watch?v=Bgdbx5TJShI)

Thanks to [Wh04m1001](https://github.com/Wh04m1001) for the cpp support

## About

GOG Galaxy LPE Exploit

### Resources

[Readme](#readme-ov-file)

[Activity](/secure-77/CVE-2022-31262/activity)
### Stars

[**4**
stars](/secure-77/CVE-2022-31262/stargazers)
### Watchers

[**5**
watching](/secure-77/CVE-2022-31262/watchers)
### Forks

[**0**
forks](/secure-77/CVE-2022-31262/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fsecure-77%2FCVE-2022-31262&report=secure-77+%28user%29)

## [Releases](/secure-77/CVE-2022-31262/releases)

No releases published

## [Packages 0](/users/secure-77/packages?repo_name=CVE-2022-31262)

No packages published

## Languages

* [PowerShell
  76.0%](/secure-77/CVE-2022-31262/search?l=powershell)
* [C++
  24.0%](/secure-77/CVE-2022-31262/search?l=c%2B%2B)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


