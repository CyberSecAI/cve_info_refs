=== Content from www.mozilla.org_d0c5fc99_20250114_213700.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-22

## Security Vulnerabilities fixed in Thunderbird 91.10

Announced
May 31, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.10

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-31736: Cross-Origin resource's length leaked](#CVE-2022-31736)

Reporter
Luan Herrera
Impact
high
##### Description

A malicious website could have learned the size of a cross-origin resource that supported Range requests.

##### References

* [Bug 1735923](https://bugzilla.mozilla.org/show_bug.cgi?id=1735923)

#### [#CVE-2022-31737: Heap buffer overflow in WebGL](#CVE-2022-31737)

Reporter
Atte Kettunen
Impact
high
##### Description

A malicious webpage could have caused an out-of-bounds write in WebGL, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1743767](https://bugzilla.mozilla.org/show_bug.cgi?id=1743767)

#### [#CVE-2022-31738: Browser window spoof using fullscreen mode](#CVE-2022-31738)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When exiting fullscreen mode, an iframe could have confused the browser about the current state of fullscreen, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1756388](https://bugzilla.mozilla.org/show_bug.cgi?id=1756388)

#### [#CVE-2022-31739: Attacker-influenced path traversal when saving downloaded files](#CVE-2022-31739)

Reporter
Chaobin Zhang
Impact
high
##### Description

When downloading files on Windows, the % character was not escaped, which could have lead to a download incorrectly being saved to attacker-influenced paths that used variables such as %HOMEPATH% or %APPDATA%.
*This bug only affects Thunderbird for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1765049](https://bugzilla.mozilla.org/show_bug.cgi?id=1765049)

#### [#CVE-2022-31740: Register allocation problem in WASM on arm64](#CVE-2022-31740)

Reporter
Gary Kwong
Impact
high
##### Description

On arm64, WASM code could have resulted in incorrect assembly generation leading to a register allocation problem, and a potentially exploitable crash.

##### References

* [Bug 1766806](https://bugzilla.mozilla.org/show_bug.cgi?id=1766806)

#### [#CVE-2022-31741: Uninitialized variable leads to invalid memory read](#CVE-2022-31741)

Reporter
Cybeats PSI Team
Impact
high
##### Description

A crafted CMS message could have been processed incorrectly, leading to an invalid memory read, and potentially further memory corruption.

##### References

* [Bug 1767590](https://bugzilla.mozilla.org/show_bug.cgi?id=1767590)

#### [#CVE-2022-1834: Braille space character caused incorrect sender email to be shown for a digitally signed email](#CVE-2022-1834)

Reporter
Jonathan von Niessen
Impact
high
##### Description

When displaying the sender of an email, and the sender name contained the Braille Pattern Blank space character multiple times, Thunderbird would have displayed all the spaces. This could have been used by an attacker to send an email message with the attacker's digital signature, that was shown with an arbitrary sender email address chosen by the attacker. If the sender name started with a false email address, followed by many Braille space characters, the attacker's email address was not visible. Because Thunderbird compared the invisible sender address with the signature's email address, if the signing key or certificate was accepted by Thunderbird, the email was shown as having a valid digital signature.

##### References

* [Bug 1767816](https://bugzilla.mozilla.org/show_bug.cgi?id=1767816)

#### [#CVE-2022-31742: Querying a WebAuthn token with a large number of allowCredential entries may have leaked cross-origin information](#CVE-2022-31742)

Reporter
Michal
Impact
moderate
##### Description

An attacker could have exploited a timing attack by sending a large number of allowCredential entries and detecting the difference between invalid key handles and cross-origin key handles. This could have led to cross-origin account linking in violation of WebAuthn goals.

##### References

* [Bug 1730434](https://bugzilla.mozilla.org/show_bug.cgi?id=1730434)

#### [#CVE-2022-31747: Memory safety bugs fixed in Thunderbird 91.10](#CVE-2022-31747)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Nicolas B. Pierron, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 91.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760765%2C1765610%2C1766283%2C1767365%2C1768559%2C1768734)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_b68de4a0_20250114_213659.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-20

## Security Vulnerabilities fixed in Firefox 101

Announced
May 31, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 101

#### [#CVE-2022-31736: Cross-Origin resource's length leaked](#CVE-2022-31736)

Reporter
Luan Herrera
Impact
high
##### Description

A malicious website could have learned the size of a cross-origin resource that supported Range requests.

##### References

* [Bug 1735923](https://bugzilla.mozilla.org/show_bug.cgi?id=1735923)

#### [#CVE-2022-31737: Heap buffer overflow in WebGL](#CVE-2022-31737)

Reporter
Atte Kettunen
Impact
high
##### Description

A malicious webpage could have caused an out-of-bounds write in WebGL, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1743767](https://bugzilla.mozilla.org/show_bug.cgi?id=1743767)

#### [#CVE-2022-31738: Browser window spoof using fullscreen mode](#CVE-2022-31738)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When exiting fullscreen mode, an iframe could have confused the browser about the current state of fullscreen, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1756388](https://bugzilla.mozilla.org/show_bug.cgi?id=1756388)

#### [#CVE-2022-31739: Attacker-influenced path traversal when saving downloaded files](#CVE-2022-31739)

Reporter
Chaobin Zhang
Impact
high
##### Description

When downloading files on Windows, the % character was not escaped, which could have lead to a download incorrectly being saved to attacker-influenced paths that used variables such as %HOMEPATH% or %APPDATA%.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1765049](https://bugzilla.mozilla.org/show_bug.cgi?id=1765049)

#### [#CVE-2022-31740: Register allocation problem in WASM on arm64](#CVE-2022-31740)

Reporter
Gary Kwong
Impact
high
##### Description

On arm64, WASM code could have resulted in incorrect assembly generation leading to a register allocation problem, and a potentially exploitable crash.

##### References

* [Bug 1766806](https://bugzilla.mozilla.org/show_bug.cgi?id=1766806)

#### [#CVE-2022-31741: Uninitialized variable leads to invalid memory read](#CVE-2022-31741)

Reporter
Cybeats PSI Team
Impact
high
##### Description

A crafted CMS message could have been processed incorrectly, leading to an invalid memory read, and potentially further memory corruption.

##### References

* [Bug 1767590](https://bugzilla.mozilla.org/show_bug.cgi?id=1767590)

#### [#CVE-2022-31742: Querying a WebAuthn token with a large number of allowCredential entries may have leaked cross-origin information](#CVE-2022-31742)

Reporter
Michal
Impact
moderate
##### Description

An attacker could have exploited a timing attack by sending a large number of allowCredential entries and detecting the difference between invalid key handles and cross-origin key handles. This could have led to cross-origin account linking in violation of WebAuthn goals.

##### References

* [Bug 1730434](https://bugzilla.mozilla.org/show_bug.cgi?id=1730434)

#### [#CVE-2022-31743: HTML Parsing incorrectly ended HTML comments prematurely](#CVE-2022-31743)

Reporter
Linus Särud
Impact
moderate
##### Description

Firefox's HTML parser did not correctly interpret HTML comment tags, resulting in an incongruity with other browsers. This could have been used to escape HTML comments on pages that put user-controlled data in them.

##### References

* [Bug 1747388](https://bugzilla.mozilla.org/show_bug.cgi?id=1747388)

#### [#CVE-2022-31744: CSP bypass enabling stylesheet injection](#CVE-2022-31744)

Reporter
Gertjan
Impact
moderate
##### Description

An attacker could have injected CSS into stylesheets accessible via internal URIs, such as resource:, and in doing so bypass a page's Content Security Policy.

##### References

* [Bug 1757604](https://bugzilla.mozilla.org/show_bug.cgi?id=1757604)

#### [#CVE-2022-31745: Incorrect Assertion caused by unoptimized array shift operations](#CVE-2022-31745)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

If array shift operations are not used, the Garbage Collector may have become confused about valid objects.

##### References

* [Bug 1760944](https://bugzilla.mozilla.org/show_bug.cgi?id=1760944)

#### [#CVE-2022-1919: Memory Corruption when manipulating webp images](#CVE-2022-1919)

Reporter
Irvan Kurniawan
Impact
low
##### Description

An attacker could have caused an uninitialized variable on the stack to be mistakenly freed, causing a potentially exploitable crash.

##### References

* [Bug 1761275](https://bugzilla.mozilla.org/show_bug.cgi?id=1761275)

#### [#CVE-2022-31747: Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](#CVE-2022-31747)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Nicolas B. Pierron, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 100 and Firefox ESR 91.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760765%2C1765610%2C1766283%2C1767365%2C1768559%2C1768734)

#### [#CVE-2022-31748: Memory safety bugs fixed in Firefox 101](#CVE-2022-31748)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Timothy Nikkel, Randell Jesup, Jon Coppeard, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 100. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 101](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1713773%2C1762201%2C1762469%2C1762770%2C1764878%2C1765226%2C1765782%2C1765973%2C1767177%2C1767181%2C1768232%2C1768251%2C1769869)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_487f1bb6_20250114_213700.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-21

## Security Vulnerabilities fixed in Firefox ESR 91.10

Announced
May 31, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.10

#### [#CVE-2022-31736: Cross-Origin resource's length leaked](#CVE-2022-31736)

Reporter
Luan Herrera
Impact
high
##### Description

A malicious website could have learned the size of a cross-origin resource that supported Range requests.

##### References

* [Bug 1735923](https://bugzilla.mozilla.org/show_bug.cgi?id=1735923)

#### [#CVE-2022-31737: Heap buffer overflow in WebGL](#CVE-2022-31737)

Reporter
Atte Kettunen
Impact
high
##### Description

A malicious webpage could have caused an out-of-bounds write in WebGL, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1743767](https://bugzilla.mozilla.org/show_bug.cgi?id=1743767)

#### [#CVE-2022-31738: Browser window spoof using fullscreen mode](#CVE-2022-31738)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When exiting fullscreen mode, an iframe could have confused the browser about the current state of fullscreen, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1756388](https://bugzilla.mozilla.org/show_bug.cgi?id=1756388)

#### [#CVE-2022-31739: Attacker-influenced path traversal when saving downloaded files](#CVE-2022-31739)

Reporter
Chaobin Zhang
Impact
high
##### Description

When downloading files on Windows, the % character was not escaped, which could have lead to a download incorrectly being saved to attacker-influenced paths that used variables such as %HOMEPATH% or %APPDATA%.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1765049](https://bugzilla.mozilla.org/show_bug.cgi?id=1765049)

#### [#CVE-2022-31740: Register allocation problem in WASM on arm64](#CVE-2022-31740)

Reporter
Gary Kwong
Impact
high
##### Description

On arm64, WASM code could have resulted in incorrect assembly generation leading to a register allocation problem, and a potentially exploitable crash.

##### References

* [Bug 1766806](https://bugzilla.mozilla.org/show_bug.cgi?id=1766806)

#### [#CVE-2022-31741: Uninitialized variable leads to invalid memory read](#CVE-2022-31741)

Reporter
Cybeats PSI Team
Impact
high
##### Description

A crafted CMS message could have been processed incorrectly, leading to an invalid memory read, and potentially further memory corruption.

##### References

* [Bug 1767590](https://bugzilla.mozilla.org/show_bug.cgi?id=1767590)

#### [#CVE-2022-31742: Querying a WebAuthn token with a large number of allowCredential entries may have leaked cross-origin information](#CVE-2022-31742)

Reporter
Michal
Impact
moderate
##### Description

An attacker could have exploited a timing attack by sending a large number of allowCredential entries and detecting the difference between invalid key handles and cross-origin key handles. This could have led to cross-origin account linking in violation of WebAuthn goals.

##### References

* [Bug 1730434](https://bugzilla.mozilla.org/show_bug.cgi?id=1730434)

#### [#CVE-2022-31747: Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](#CVE-2022-31747)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Nicolas B. Pierron, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 100 and Firefox ESR 91.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760765%2C1765610%2C1766283%2C1767365%2C1768559%2C1768734)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_4575caa4_20250114_213657.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1743767)
* [XML](/show_bug.cgi?ctype=xml&id=1743767)

Closed
[Bug 1743767](/show_bug.cgi?id=1743767)
(CVE-2022-31737)

Opened 3 years ago
Closed 3 years ago

# heap-buffer-overflow in mozilla::gl::GLContext::raw\_fReadPixels

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

heap-buffer-overflow in mozilla::gl::GLContext::raw\_fReadPixels

## Categories

### (Core :: Graphics: CanvasWebGL, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20CanvasWebGL#Graphics%3A%20CanvasWebGL)

Graphics: CanvasWebGL
▾

Core :: Graphics: CanvasWebGL
Bugs with the WebGL Canvas Context.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20CanvasWebGL&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20CanvasWebGL&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20CanvasWebGL)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

102 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [101+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=101%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) |
| firefox100 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=wontfix) |
| firefox101 | [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed) |
| firefox102 | [+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 101+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox100 |  | wontfix |
| firefox101 | + | fixed |
| firefox102 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: attekett, Assigned: jgilbert)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ca6a57abf052ac63d917d5dae1cc0f00?d=mm&size=40)  [jgilbert](/user_profile?user_id=419431)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/6e1d9fb30a393b4b29162e824f2b7321?d=mm&size=40)  [attekett](/user_profile?user_id=420648)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ca6a57abf052ac63d917d5dae1cc0f00?d=mm&size=40)  [jgilbert](/user_profile?user_id=419431)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1743084](/show_bug.cgi?id=1743084 "RESOLVED DUPLICATE - Crash in js::ContextChecks::check or js::TenuringTracer::onObjectEdge(JSObject*) with WebGL canvas test case")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-bounds, reporter-external, sec-high, Whiteboard: [post-critsmash-triage][adv-main101+][adv-esr91.10+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-31737

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main101+][adv-esr91.10+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a15671040_1689 "3 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | [qe-verify](#a15032669_553429 "3 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 1 obsolete file)

| [heap-buffer-overflow-mozilla-glGLContextraw\_fReadPixels.html](/attachment.cgi?id=9253176)  [3 years ago](#c0)  [Atte Kettunen](/user_profile?user_id=420648)   340 bytes, text/html |  | [Details](/attachment.cgi?id=9253176&action=edit) |
| --- | --- | --- |
| [prefs.js](/attachment.cgi?id=9253177)  [3 years ago](#c1)  [Atte Kettunen](/user_profile?user_id=420648)   8.80 KB, text/javascript |  | [Details](/attachment.cgi?id=9253177&action=edit) |
| [log\_ffp\_asan\_21682.log.21844.txt](/attachment.cgi?id=9253178)  [3 years ago](#c2)  [Atte Kettunen](/user_profile?user_id=420648)   14.89 KB, text/plain |  | [Details](/attachment.cgi?id=9253178&action=edit) |
| [Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.](/attachment.cgi?id=9274154)  [3 years ago](#c14)  [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)   48 bytes, text/x-phabricator-request | tjr : [approval-mozilla-beta+](#c17 "3 years ago")  tjr : [sec-approval+](#c17 "3 years ago") | [Details](/attachment.cgi?id=9274154&action=edit) | [Review](/attachment.cgi?id=9274154) |
| [[esr91 backport] 0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch](/attachment.cgi?id=9276352)  [3 years ago](#c21)  [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)   1.81 KB, text/plain |  | [Details](/attachment.cgi?id=9276352&action=edit) |
| [0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch](/attachment.cgi?id=9276496)  [3 years ago](#c25)  [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)   1.77 KB, patch | RyanVM : [approval-mozilla-esr91+](#c26 "3 years ago") | [Details](/attachment.cgi?id=9276496&action=edit) | [Diff](/attachment.cgi?id=9276496&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1743767&attachment=9276496) |
| [advisory.txt](/attachment.cgi?id=9278352)  [3 years ago](#c28)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   184 bytes, text/plain |  | [Details](/attachment.cgi?id=9278352&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1743767#c0)• 3 years ago |
|  | |

Attached file
[heap-buffer-overflow-mozilla-glGLContextraw\_fReadPixels.html](attachment.cgi?id=9253176)
— [Details](attachment.cgi?id=9253176&action=edit)

Tested on:

OS: Ubuntu 20.04 in VMware VM

Firefox:

```
fuzzfetch --target firefox --os Linux --asan --fuzzing -n firefox
[2021-12-01 10:14:05] Identified task: https://firefox-ci-tc.services.mozilla.com/api/index/v1/task/gecko.v2.mozilla-central.latest.firefox.linux64-fuzzing-asan-opt
[2021-12-01 10:14:05] > Task ID: Frxzk0u7Qeu4nG7rilMWAQ
[2021-12-01 10:14:05] > Rank: 1638335107
[2021-12-01 10:14:05] > Changeset: 89800efd9e5cfcf0146767961a63d5c4e2a86e2c
[2021-12-01 10:14:05] > Build ID: 20211201050507
[2021-12-01 10:14:05] > Downloading: https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/Frxzk0u7Qeu4nG7rilMWAQ/artifacts/public/build/target.tar.bz2 (382.95MiB total)

```

prefs.js: fuzzing prefs.js generated with prefpicker, adding as an attachment.

I have reproduced the issue on my machine with/without the fuzzing prefs.js, and with/without Xvfb . Including prefs.js as an attachment to ensure reproducibility.

The write size can be changed by changing the canvas width. For example changing width and 300px, the write will be size 1200, 10px and it will be 40. 1px on fuzzfetch --fuzzing build will result to a

```
Hit MOZ_CRASH(Trying to run a non-debug fuzzing build.) at /builds/worker/checkouts/gecko/third_party/rust/neqo-crypto/src/aead_fuzzing.rs:19

```

I don't think it is related to the issue. Using 1px with regular asan-build downloaded without `--fuzzing` doesn't crash, but other tested values 10px up reproduced sameway on regular and fuzzing builds.

Reproducing:

```
$ ffpuppet -p ~/prefs.js -u ./heap-buffer-overflow-mozilla-glGLContextraw_fReadPixels.html ./firefox/firefox --xvfb -d
[2021-12-01 10:37:01] Launching Firefox...
[2021-12-01 10:37:13] Running Firefox (pid: 16680)...
[2021-12-01 10:37:14] Shutting down...
[2021-12-01 10:37:16] Firefox process is closed. (Reason: <Reason.ALERT: 0>)
[2021-12-01 10:37:16] Displaying logs...
===
=== Dumping 'log_ffp_asan_16655.log.16807.txt' (14.89KB)
===
=================================================================
==16807==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f59218c8c00 at pc 0x55ee081ba203 bp 0x7fff0cc77200 sp 0x7fff0cc769c0
WRITE of size 1600 at 0x7f59218c8c00 thread T0 (file:// Content)
    #0 0x55ee081ba202 in __interceptor_memcpy /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:827:5

```

ASAN-trace(truncated, full trace as an attachment):

```
==16807==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f59218c8c00 at pc 0x55ee081ba203 bp 0x7fff0cc77200 sp 0x7fff0cc769c0
WRITE of size 1600 at 0x7f59218c8c00 thread T0 (file:// Content)
    #0 0x55ee081ba202 in __interceptor_memcpy /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:827:5
    #1 0x7f59333e3ef8  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x320ef8)
    #2 0x7f59332997fc  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x1d67fc)
    #3 0x7f59333e42dc  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x3212dc)
    #4 0x7f59333e4b15  (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x321b15)
    #5 0x7f59c93ecd70 in mozilla::gl::GLContext::raw_fReadPixels(int, int, int, int, unsigned int, unsigned int, void*) /builds/worker/workspace/obj-build/dist/include/GLContext.h:1568:5
    #6 0x7f59cc103cb1 in mozilla::WebGLContext::DoReadPixelsAndConvert(mozilla::webgl::FormatInfo const*, mozilla::webgl::ReadPixelsDesc const&, unsigned long, unsigned long, unsigned int) /builds/worker/checkouts/gecko/dom/canvas/WebGLContextGL.cpp
    #7 0x7f59cc106190 in mozilla::WebGLContext::ReadPixelsImpl(mozilla::webgl::ReadPixelsDesc const&, unsigned long, unsigned long) /builds/worker/checkouts/gecko/dom/canvas/WebGLContextGL.cpp:1238:7
    #8 0x7f59cc1041a7 in mozilla::WebGLContext::ReadPixelsInto(mozilla::webgl::ReadPixelsDesc const&, mozilla::Range<unsigned char> const&) /builds/worker/checkouts/gecko/dom/canvas/WebGLContextGL.cpp:962:10
    #9 0x7f59cbfe89b4 in mozilla::HostWebGLContext::ReadPixelsInto(mozilla::webgl::ReadPixelsDesc const&, mozilla::Range<unsigned char> const&) const /builds/worker/checkouts/gecko/dom/canvas/HostWebGLContext.h:646:22
...
    #53 0x55ee08252dfd in content_process_main(mozilla::Bootstrap*, int, char**) /builds/worker/checkouts/gecko/browser/app/../../ipc/contentproc/plugin-container.cpp:57:28
    #54 0x55ee08253228 in main /builds/worker/checkouts/gecko/browser/app/nsBrowserApp.cpp:327:18
    #55 0x7f59e54b50b2 in __libc_start_main /build/glibc-eX1tMB/glibc-2.31/csu/../csu/libc-start.c:308:16
    #56 0x55ee081a1ec9 in _start (/firefox/firefox+0x5cec9)

0x7f59218c8c00 is located 0 bytes to the right of 640000-byte region [0x7f592182c800,0x7f59218c8c00)
allocated by thread T0 (file:// Content) here:
    #0 0x55ee0821e632 in __interceptor_calloc /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cpp:138:3
    #1 0x7f59d39151cb in AllocateArrayBufferContents /builds/worker/checkouts/gecko/js/src/vm/ArrayBufferObject.cpp:459:11
    #2 0x7f59d39151cb in std::tuple<js::ArrayBufferObject*, unsigned char*> js::ArrayBufferObject::createBufferAndData<(js::ArrayBufferObject::FillContents)0>(JSContext*, unsigned long, js::AutoSetNewObjectMetadata&, JS::Handle<JSObject*>) /builds/worker/checkouts/gecko/js/src/vm/ArrayBufferObject.cpp:1351:18
    #3 0x7f59d390ceea in js::ArrayBufferObject::createZeroed(JSContext*, unsigned long, JS::Handle<JSObject*>) /builds/worker/checkouts/gecko/js/src/vm/ArrayBufferObject.cpp:1414:7
...
    #22 0x7f59ce5744aa in mozilla::dom::ScriptElement::MaybeProcessScript() /builds/worker/checkouts/gecko/dom/script/ScriptElement.cpp:118:18
    #23 0x7f59c91a2d6e in nsIScriptElement::AttemptToExecute() /builds/worker/workspace/obj-build/dist/include/nsIScriptElement.h:211:18

SUMMARY: AddressSanitizer: heap-buffer-overflow /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:827:5 in __interceptor_memcpy
Shadow bytes around the buggy address:
...
==16807==ABORTING

```

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1743767#c1)• 3 years ago |
|  | |

Attached file
[prefs.js](attachment.cgi?id=9253177)
— [Details](attachment.cgi?id=9253177&action=edit)

Attaching the prefs.js used to reproduce, if prefpicker generated doesn't reproduce clearly.

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1743767#c2)• 3 years ago |
|  | |

Attached file
[log\_ffp\_asan\_21682.log.21844.txt](attachment.cgi?id=9253178)
— [Details](attachment.cgi?id=9253178&action=edit)

Full AddressSanitizer output.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a29286_159069)• 3 years ago |

Group: firefox-core-security → gfx-core-securityComponent: General → Canvas: WebGLProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1743767#c3)• 3 years ago |
|  | |

The prefs include webgl.enable-draft-extensions and webgl.enable-privileged-extensions, so maybe these aren't standard web-exposed APIs being used. (I haven't looked at the test case.)

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1743767#c4)• 3 years ago |
|  | |

The issue reproduces without usage of the prefs.js. Also I tested that it reproduces with the mentioned webgl.enable-draft-extensions and webgl.enable-privileged-extensions set to false, from the attached prefs.js.

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a76316_419431)• 3 years ago |

Assignee: nobody → jgilbert

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1743767#c5)• 3 years ago |
|  | |

A Pernosco session is available here: <https://pernos.co/debug/DVAXc3npneKx7gxWx-6hxA/index.html>

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a553371_578488)• 3 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a654300_1689)• 3 years ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1743767#c6)• 3 years ago |
|  | |

So the y=-1 is valid, but we're actually writing *too far*, rather than too early.

Our code to handle this is super wrong, and just resets to row0 but doesn't decrease the amount it reads, so it tries to read 400x400px starting at a 100x1px offset into the destination buffer, which gladly writes off the end of that buffer.

We need better ranged types here. We cast Range into uintptr\_t too early, but unfortunately that's because we need to handle both the void\* and uintptr\_t-into-pbo usecase.

Sending a void\* that doesn't point to valid memory into glReadPixels is actually super against the rules in c++ (pointers must point within a valid range of their types, with one element of slack on either end for end/reverse-end), so we try to minimize the amount of code we have that treats this pbo offset as a void\*.

We *could* go in-for-a-penny-in-for-a-pound and use a Range<uint8\_t>[0,pbo->ByteSize()], but that seems like tempting fate.

Instead I'm making a RangedInt<T> struct with CheckedInt<T>, that we can use as RangedInt<uintptr\_t>.

Writing this code, it actually makes some of the bounds checks much easier, so win-win.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1743767#c7)• 3 years ago |
|  | |

The severity field is not set for this bug.

:jgilbert, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a4730738_419431)• 3 years ago |

Severity: -- → S3Flags: needinfo?(jgilbert)Priority: -- → P1

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1743767#c8)• 3 years ago |
|  | |

Please retest now that we've landed [bug 1750310](/show_bug.cgi?id=1750310 "RESOLVED FIXED - Centralize and reuse pixelstorei pack/unpack validation and calculations").

Flags: needinfo?(attekett)

|  | [Atte Kettunen](/user_profile?user_id=420648)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1743767#c9)• 3 years ago |
|  | |

Still reproduces.

From mozilla-central log, it looks like the patch from [bug #1750310](/show_bug.cgi?id=1750310 "RESOLVED FIXED - Centralize and reuse pixelstorei pack/unpack validation and calculations") is included in the version that fuzzfetch downloads.

```

:$ fuzzfetch --target firefox --central --os Linux --asan --fuzzing -n firefox
[2022-02-24 23:42:17] Identified task: https://firefox-ci-tc.services.mozilla.com/api/index/v1/task/gecko.v2.mozilla-central.latest.firefox.linux64-fuzzing-asan-opt
[2022-02-24 23:42:17] > Task ID: OuiYrcUqRpyXyRqT52NfQQ
[2022-02-24 23:42:17] > Rank: 1645739161
[2022-02-24 23:42:17] > Changeset: fb443d9a5f9cfaa17acc81c25473d7093d5cf696
[2022-02-24 23:42:17] > Build ID: 20220224214601
[2022-02-24 23:42:17] > Downloading: https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/OuiYrcUqRpyXyRqT52NfQQ/artifacts/public/build/target.tar.bz2 (436.42MiB total)
[2022-02-24 23:42:31] .. downloaded (32.73MB/s)
[2022-02-24 23:42:31] .. extracting
[2022-02-24 23:46:07] Extracted into /firefox

```

Reproducing:

```
:$ ffpuppet ./firefox/firefox -u ./heap-buffer-overflow-mozilla-glGLContextraw_fReadPixels.html -d
[2022-02-24 23:50:10] Launching Firefox...
[2022-02-24 23:50:23] Running Firefox (pid: 3217697)...
[2022-02-24 23:50:25] Shutting down...
[2022-02-24 23:50:28] Firefox process is closed. (Reason: ALERT)
[2022-02-24 23:50:28] Displaying logs...
===
=== Dumping 'log_ffp_asan_3217695.log.3217783.txt' (16.62KB)
===
=================================================================
==3217783==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7fe68cffac00 at pc 0x55a99b0c1c13 bp 0x7ffe42bd5ab0 sp 0x7ffe42bd5270
WRITE of size 1600 at 0x7fe68cffac00 thread T0 (file:// Content)
    #0 0x55a99b0c1c12 in __interceptor_memcpy /builds/worker/fetches/llvm-project/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:827:5
    #1 0x7fe694dfa758  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0x39a758)
    #2 0x7fe694cb44cb  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0x2544cb)
    #3 0x7fe694dfab34  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0x39ab34)
    #4 0x7fe694dfb385  (/usr/lib/x86_64-linux-gnu/dri/vmwgfx_dri.so+0x39b385)
    #5 0x7fe6af901950 in mozilla::gl::GLContext::raw_fReadPixels(int, int, int, int, unsigned int, unsigned int, void*) /builds/worker/workspace/obj-build/dist/include/GLContext.h:1568:5
    #6 0x7fe6b28f1953 in mozilla::WebGLContext::DoReadPixelsAndConvert(mozilla::webgl::FormatInfo const*, mozilla::webgl::ReadPixelsDesc const&, unsigned long, unsigned long, unsigned int) /builds/worker/checkouts/gecko/dom/canvas/WebGLContextGL.cpp
...

```
Flags: needinfo?(attekett)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1743767#c10)• 3 years ago |
|  | |

Thanks!

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1743767#c11)• 3 years ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:jgilbert, could you consider increasing the severity of this security bug?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#severity_high_security.py).

Flags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1743767#c12)• 3 years ago |
|  | |

S2 is probably right for this, though it's primarily on Mesa it seems?

Severity: S3 → S2Flags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1743767#c13)• 3 years ago |
|  | |

Well it doesn't repro on this system anymore. I wonder if this is a different machine than the one I investigated it on originally?

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1743767#c14)• 3 years ago |
|  | |

Attached file
[Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.](attachment.cgi?id=9274154)
— [Details](attachment.cgi?id=9274154&action=edit)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1743767#c16)• 3 years ago |
|  | |

Comment on [attachment 9274154](/attachment.cgi?id=9274154 "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.") [[details]](/attachment.cgi?id=9274154&action=edit "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.")

[Bug 1743767](/show_bug.cgi?id=1743767 "RESOLVED FIXED - heap-buffer-overflow in mozilla::gl::GLContext::raw_fReadPixels") - Tighten bounds and add asserts for row-by-row ReadPixels.

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Tricky but not impossible.

  I'm definitely adding asserts in a patch to a bug that's restricted-access, though I don't say exactly what the problem is. I don't know how to answer "is this a bullseye on the security problem", so I said "no", because there's still some thinking required of any adversary looking at this.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Should be pretty easy.
* **How likely is this patch to cause regressions; how much testing does it need?**: unlikely if it gets through CI
* **Is Android affected?**: Yes
[Attachment #9274154](/attachment.cgi?id=9274154&action=edit "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1743767#c17)• 3 years ago |
|  | |

Comment on [attachment 9274154](/attachment.cgi?id=9274154 "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.") [[details]](/attachment.cgi?id=9274154&action=edit "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.")

[Bug 1743767](/show_bug.cgi?id=1743767 "RESOLVED FIXED - heap-buffer-overflow in mozilla::gl::GLContext::raw_fReadPixels") - Tighten bounds and add asserts for row-by-row ReadPixels.

Let's land and uplift this one mid-next week, on May 11.

[Attachment #9274154](/attachment.cgi?id=9274154&action=edit "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.") -
Flags: sec-approval?
[Attachment #9274154](/attachment.cgi?id=9274154&action=edit "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.") -
Flags: sec-approval+
[Attachment #9274154](/attachment.cgi?id=9274154&action=edit "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.") -
Flags: approval-mozilla-esr91+
[Attachment #9274154](/attachment.cgi?id=9274154&action=edit "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.") -
Flags: approval-mozilla-beta+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1743767#c18)• 3 years ago |
|  | |

Tighten bounds and add asserts for row-by-row ReadPixels. r=gfx-reviewers,lsalzman

<https://hg.mozilla.org/integration/autoland/rev/4a4eec75fcd72e9f87e54a45a4ff2c809d0dcd00>

<https://hg.mozilla.org/mozilla-central/rev/4a4eec75fcd7>

Group: gfx-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 3 years ago
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 102 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1743767#c19)• 3 years ago |
|  | |

Comment on [attachment 9274154](/attachment.cgi?id=9274154 "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.") [[details]](/attachment.cgi?id=9274154&action=edit "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.")

[Bug 1743767](/show_bug.cgi?id=1743767 "RESOLVED FIXED - heap-buffer-overflow in mozilla::gl::GLContext::raw_fReadPixels") - Tighten bounds and add asserts for row-by-row ReadPixels.

This needs a rebased patch for ESR91.

Flags: needinfo?(jgilbert)
[Attachment #9274154](/attachment.cgi?id=9274154&action=edit "Bug 1743767 - Tighten bounds and add asserts for row-by-row ReadPixels.") -
Flags: approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1743767#c20)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1743767&comment_id=15896572 "1 revision") |
| uplift | |

Landed for 101.0b6.

<https://hg.mozilla.org/releases/mozilla-beta/rev/832630d39630>

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=wontfix)
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox101](/buglist.cgi?f1=cf_tracking_firefox101&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B)
[tracking-firefox102](/buglist.cgi?f1=cf_tracking_firefox102&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [101+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=101%2B)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1743767#c21)• 3 years ago |
|  | |

Attached file
[[esr91 backport] 0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch](attachment.cgi?id=9276352) (obsolete)
— [Details](attachment.cgi?id=9276352&action=edit)

Flags: needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1743767#c22)• 3 years ago |
|  | |

I can't build esr91 on Windows or Mac, and I can't seem to push it to Try either, so here's the patch I guess? I hope it builds!

Flags: needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1743767#c23)• 3 years ago |
|  | |

Comment on [attachment 9276352](/attachment.cgi?id=9276352 "[esr91 backport] 0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch") [[details]](/attachment.cgi?id=9276352&action=edit "[esr91 backport] 0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch")

[esr91 backport] 0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch

Busted on Try:

<https://treeherder.mozilla.org/jobs?repo=try&group_state=expanded&revision=d65aef008c21ee597b78aea149d1bc8d53ad89c2>

FWIW, I find for ESR, the easiest way to get a Try push going is to use |./mach try empty| and add jobs to the push via TH.

[Attachment #9276352](/attachment.cgi?id=9276352&action=edit "[esr91 backport] 0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch") -
Attachment is obsolete: trueFlags: needinfo?(ryanvm) → needinfo?(jgilbert)

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1743767#c24)• 3 years ago |
|  | |

Thanks! I'm trying that.

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1743767#c25)• 3 years ago |
|  | |

Attached patch

[0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch](attachment.cgi?id=9276496&action=diff)
— [Details](attachment.cgi?id=9276496&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1743767&attachment=9276496)

Seems green:

<https://treeherder.mozilla.org/jobs?repo=try&revision=2a204bec20c1858c5eedf8f34a2a4f8903de30ed>

Flags: needinfo?(jgilbert) → needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1743767#c26)• 3 years ago |
|  | |

Comment on [attachment 9276496](/attachment.cgi?id=9276496 "0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch") [[details]](/attachment.cgi?id=9276496&action=edit "0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch") [[diff]](/attachment.cgi?id=9276496&action=diff "0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1743767&attachment=9276496)

0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch

Approved for 91.10esr. Thanks for the quick rebase!

Flags: needinfo?(ryanvm)
[Attachment #9276496](/attachment.cgi?id=9276496&action=edit "0001-Bug-1743767-esr91-Tighten-bounds-and-add-asserts-for.patch") -
Flags: approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1743767#c27)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/00f5d50b71c6>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a15032669_553429)• 3 years ago |

Flags: qe-verify-Whiteboard: [post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a15147467_578488)• 3 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main101+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1743767#c28)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9278352)
— [Details](attachment.cgi?id=9278352&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a15232313_578488)• 3 years ago |

Whiteboard: [post-critsmash-triage][adv-main101+] → [post-critsmash-triage][adv-main101+][adv-esr91.10+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a15234215_578488)• 3 years ago |

Alias: CVE-2022-31737

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a15671040_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Jim Blandy :jimb](/user_profile?user_id=298765) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1743767#c29)• 3 years ago |
|  | |

> Hit MOZ\_CRASH(Trying to run a non-debug fuzzing build.) at /builds/worker/checkouts/gecko/third\_party/rust/neqo-crypto/src/aead\_fuzzing.rs:19

This is [bug 1743672](/show_bug.cgi?id=1743672 "RESOLVED FIXED - Websocket fuzzers hit neqo assertion."), for reference.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a35579570_1689)• 2 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1743767#a78741385_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1743767&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Atte Kettunen](/user_profile?user_id=420648)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


