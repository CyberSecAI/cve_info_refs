- **Root cause of vulnerability**: Harbor fails to validate user permissions when updating tag retention policies. Specifically, the PUT `/retentions/{id}` API endpoint does not properly check if the authenticated user has access to the project associated with the specified retention policy ID.
- **Weaknesses/vulnerabilities present**: Insufficient authorization checks on the PUT `/retentions/{id}` API endpoint, allowing users to modify tag retention policies of projects they do not have access to.
- **Impact of exploitation**: An attacker can modify tag retention policies configured in other projects, potentially leading to unintended data deletion or retention, and impacting the operational status of affected projects.
- **Attack vectors**: Network-based attack through the PUT `/retentions/{id}` API endpoint.
- **Required attacker capabilities/position**: The attacker needs to have a low level of privileges and be an authenticated user within the Harbor system. No user interaction is required for the exploitation to occur.