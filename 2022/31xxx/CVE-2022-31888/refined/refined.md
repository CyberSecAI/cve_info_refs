Based on the provided content, here's the breakdown of the session fixation vulnerability (CVE-2022-31888) in osTicket:

**Root Cause:**
The application did not invalidate the existing session cookie upon successful login (both for admin and user portals). This allowed an attacker to potentially control the session value before authentication.

**Weaknesses/Vulnerabilities:**
- **Session Fixation:** The primary vulnerability is the failure to invalidate and regenerate the session ID upon successful login.
- **Lack of Session Management:** The application does not create a new session, nor invalidate the old session upon login.

**Impact of Exploitation:**
- **Session Hijacking:** If an attacker can set or access a session identifier before a user authenticates, the attacker can then hijack the user's session after they log in. This means the attacker can impersonate the user.

**Attack Vectors:**
- The attacker needs to access or control the session cookie before the legitimate user authenticates. This could be achieved through various means such as:
  -   Social Engineering the user to click on a link with a crafted session cookie.
  -   Man-in-the-Middle attacks.
  -   If the application has other vulnerabilities to set cookies.

**Required Attacker Capabilities/Position:**
- The attacker must be able to somehow influence or observe the session cookie of a user before they log in.
- The attacker does not require to be authenticated, they only need to be able to observe or set the session id.

**Additional Details (from the provided content):**
- The vulnerability was found during dynamic analysis (fuzzing the login pages).
- The fix involved regenerating the session ID and invalidating the old session on both the agent and end-user login pages as seen in the provided commit diffs.
- The `regenerateSession()` method is now called in `include/class.auth.php` during login to prevent session fixation.