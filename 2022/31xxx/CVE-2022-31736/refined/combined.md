=== Content from www.mozilla.org_b68de4a0_20250114_221610.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-20

## Security Vulnerabilities fixed in Firefox 101

Announced
May 31, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 101

#### [#CVE-2022-31736: Cross-Origin resource's length leaked](#CVE-2022-31736)

Reporter
Luan Herrera
Impact
high
##### Description

A malicious website could have learned the size of a cross-origin resource that supported Range requests.

##### References

* [Bug 1735923](https://bugzilla.mozilla.org/show_bug.cgi?id=1735923)

#### [#CVE-2022-31737: Heap buffer overflow in WebGL](#CVE-2022-31737)

Reporter
Atte Kettunen
Impact
high
##### Description

A malicious webpage could have caused an out-of-bounds write in WebGL, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1743767](https://bugzilla.mozilla.org/show_bug.cgi?id=1743767)

#### [#CVE-2022-31738: Browser window spoof using fullscreen mode](#CVE-2022-31738)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When exiting fullscreen mode, an iframe could have confused the browser about the current state of fullscreen, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1756388](https://bugzilla.mozilla.org/show_bug.cgi?id=1756388)

#### [#CVE-2022-31739: Attacker-influenced path traversal when saving downloaded files](#CVE-2022-31739)

Reporter
Chaobin Zhang
Impact
high
##### Description

When downloading files on Windows, the % character was not escaped, which could have lead to a download incorrectly being saved to attacker-influenced paths that used variables such as %HOMEPATH% or %APPDATA%.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1765049](https://bugzilla.mozilla.org/show_bug.cgi?id=1765049)

#### [#CVE-2022-31740: Register allocation problem in WASM on arm64](#CVE-2022-31740)

Reporter
Gary Kwong
Impact
high
##### Description

On arm64, WASM code could have resulted in incorrect assembly generation leading to a register allocation problem, and a potentially exploitable crash.

##### References

* [Bug 1766806](https://bugzilla.mozilla.org/show_bug.cgi?id=1766806)

#### [#CVE-2022-31741: Uninitialized variable leads to invalid memory read](#CVE-2022-31741)

Reporter
Cybeats PSI Team
Impact
high
##### Description

A crafted CMS message could have been processed incorrectly, leading to an invalid memory read, and potentially further memory corruption.

##### References

* [Bug 1767590](https://bugzilla.mozilla.org/show_bug.cgi?id=1767590)

#### [#CVE-2022-31742: Querying a WebAuthn token with a large number of allowCredential entries may have leaked cross-origin information](#CVE-2022-31742)

Reporter
Michal
Impact
moderate
##### Description

An attacker could have exploited a timing attack by sending a large number of allowCredential entries and detecting the difference between invalid key handles and cross-origin key handles. This could have led to cross-origin account linking in violation of WebAuthn goals.

##### References

* [Bug 1730434](https://bugzilla.mozilla.org/show_bug.cgi?id=1730434)

#### [#CVE-2022-31743: HTML Parsing incorrectly ended HTML comments prematurely](#CVE-2022-31743)

Reporter
Linus Särud
Impact
moderate
##### Description

Firefox's HTML parser did not correctly interpret HTML comment tags, resulting in an incongruity with other browsers. This could have been used to escape HTML comments on pages that put user-controlled data in them.

##### References

* [Bug 1747388](https://bugzilla.mozilla.org/show_bug.cgi?id=1747388)

#### [#CVE-2022-31744: CSP bypass enabling stylesheet injection](#CVE-2022-31744)

Reporter
Gertjan
Impact
moderate
##### Description

An attacker could have injected CSS into stylesheets accessible via internal URIs, such as resource:, and in doing so bypass a page's Content Security Policy.

##### References

* [Bug 1757604](https://bugzilla.mozilla.org/show_bug.cgi?id=1757604)

#### [#CVE-2022-31745: Incorrect Assertion caused by unoptimized array shift operations](#CVE-2022-31745)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

If array shift operations are not used, the Garbage Collector may have become confused about valid objects.

##### References

* [Bug 1760944](https://bugzilla.mozilla.org/show_bug.cgi?id=1760944)

#### [#CVE-2022-1919: Memory Corruption when manipulating webp images](#CVE-2022-1919)

Reporter
Irvan Kurniawan
Impact
low
##### Description

An attacker could have caused an uninitialized variable on the stack to be mistakenly freed, causing a potentially exploitable crash.

##### References

* [Bug 1761275](https://bugzilla.mozilla.org/show_bug.cgi?id=1761275)

#### [#CVE-2022-31747: Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](#CVE-2022-31747)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Nicolas B. Pierron, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 100 and Firefox ESR 91.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760765%2C1765610%2C1766283%2C1767365%2C1768559%2C1768734)

#### [#CVE-2022-31748: Memory safety bugs fixed in Firefox 101](#CVE-2022-31748)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Timothy Nikkel, Randell Jesup, Jon Coppeard, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 100. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 101](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1713773%2C1762201%2C1762469%2C1762770%2C1764878%2C1765226%2C1765782%2C1765973%2C1767177%2C1767181%2C1768232%2C1768251%2C1769869)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_d0c5fc99_20250114_221611.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-22

## Security Vulnerabilities fixed in Thunderbird 91.10

Announced
May 31, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.10

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-31736: Cross-Origin resource's length leaked](#CVE-2022-31736)

Reporter
Luan Herrera
Impact
high
##### Description

A malicious website could have learned the size of a cross-origin resource that supported Range requests.

##### References

* [Bug 1735923](https://bugzilla.mozilla.org/show_bug.cgi?id=1735923)

#### [#CVE-2022-31737: Heap buffer overflow in WebGL](#CVE-2022-31737)

Reporter
Atte Kettunen
Impact
high
##### Description

A malicious webpage could have caused an out-of-bounds write in WebGL, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1743767](https://bugzilla.mozilla.org/show_bug.cgi?id=1743767)

#### [#CVE-2022-31738: Browser window spoof using fullscreen mode](#CVE-2022-31738)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When exiting fullscreen mode, an iframe could have confused the browser about the current state of fullscreen, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1756388](https://bugzilla.mozilla.org/show_bug.cgi?id=1756388)

#### [#CVE-2022-31739: Attacker-influenced path traversal when saving downloaded files](#CVE-2022-31739)

Reporter
Chaobin Zhang
Impact
high
##### Description

When downloading files on Windows, the % character was not escaped, which could have lead to a download incorrectly being saved to attacker-influenced paths that used variables such as %HOMEPATH% or %APPDATA%.
*This bug only affects Thunderbird for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1765049](https://bugzilla.mozilla.org/show_bug.cgi?id=1765049)

#### [#CVE-2022-31740: Register allocation problem in WASM on arm64](#CVE-2022-31740)

Reporter
Gary Kwong
Impact
high
##### Description

On arm64, WASM code could have resulted in incorrect assembly generation leading to a register allocation problem, and a potentially exploitable crash.

##### References

* [Bug 1766806](https://bugzilla.mozilla.org/show_bug.cgi?id=1766806)

#### [#CVE-2022-31741: Uninitialized variable leads to invalid memory read](#CVE-2022-31741)

Reporter
Cybeats PSI Team
Impact
high
##### Description

A crafted CMS message could have been processed incorrectly, leading to an invalid memory read, and potentially further memory corruption.

##### References

* [Bug 1767590](https://bugzilla.mozilla.org/show_bug.cgi?id=1767590)

#### [#CVE-2022-1834: Braille space character caused incorrect sender email to be shown for a digitally signed email](#CVE-2022-1834)

Reporter
Jonathan von Niessen
Impact
high
##### Description

When displaying the sender of an email, and the sender name contained the Braille Pattern Blank space character multiple times, Thunderbird would have displayed all the spaces. This could have been used by an attacker to send an email message with the attacker's digital signature, that was shown with an arbitrary sender email address chosen by the attacker. If the sender name started with a false email address, followed by many Braille space characters, the attacker's email address was not visible. Because Thunderbird compared the invisible sender address with the signature's email address, if the signing key or certificate was accepted by Thunderbird, the email was shown as having a valid digital signature.

##### References

* [Bug 1767816](https://bugzilla.mozilla.org/show_bug.cgi?id=1767816)

#### [#CVE-2022-31742: Querying a WebAuthn token with a large number of allowCredential entries may have leaked cross-origin information](#CVE-2022-31742)

Reporter
Michal
Impact
moderate
##### Description

An attacker could have exploited a timing attack by sending a large number of allowCredential entries and detecting the difference between invalid key handles and cross-origin key handles. This could have led to cross-origin account linking in violation of WebAuthn goals.

##### References

* [Bug 1730434](https://bugzilla.mozilla.org/show_bug.cgi?id=1730434)

#### [#CVE-2022-31747: Memory safety bugs fixed in Thunderbird 91.10](#CVE-2022-31747)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Nicolas B. Pierron, and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 91.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760765%2C1765610%2C1766283%2C1767365%2C1768559%2C1768734)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_eeb5ec4b_20250114_221609.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1735923)
* [XML](/show_bug.cgi?ctype=xml&id=1735923)

Closed
[Bug 1735923](/show_bug.cgi?id=1735923)
(CVE-2022-31736)

Opened 3 years ago
Closed 3 years ago

# Leaking size of cross-origin resources by using Range Requests and Service Workers

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Leaking size of cross-origin resources by using Range Requests and Service Workers

## Categories

### (Core :: Audio/Video: Playback, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Audio%2FVideo%3A%20Playback#Audio%2FVideo%3A%20Playback)

Audio/Video: Playback
▾

Core :: Audio/Video: Playback
For problems related to the HTML 5 media elements (<video> and <audio>) -- including WebM, MP4, MSE and EME issues. This would also typically include decoding problems in the codecs themselves (e.g. VP8, VP9, H.264, AAC) experienced during playback.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo%3A%20Playback&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo%3A%20Playback&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Audio%2FVideo%3A%20Playback)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

102 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [101+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=101%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox100 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=wontfix) |
| firefox101 | [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=verified) |
| firefox102 | [+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 101+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox100 |  | wontfix |
| firefox101 | + | verified |
| firefox102 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: luan.herrera, Assigned: karlt)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/15d034eb5ed480cb10a8a9e41e8b9f13?d=mm&size=40)  [karlt](/user_profile?user_id=274246)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ba2a5c0bbda10d1a79e7c58d5653dba5?d=mm&size=40)  [luan.herrera](/user_profile?user_id=550455)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

### (Regressed 1 open bug, [URL](https://lbherrera.github.io/lab/firefox/range-0553e1f/index.html "https://lbherrera.github.io/lab/firefox/range-0553e1f/index.html") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1764515](/show_bug.cgi?id=1764515 "RESOLVED FIXED - Remove \"media.block-midflight-redirects\" pref")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1735923&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1735923)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1876866](/show_bug.cgi?id=1876866 "NEW - Intermittent [TVw] TEST-UNEXPECTED-TIMEOUT | /service-workers/service-worker/fetch-canvas-tainting-video-with-range-request.https.html | synth and cross-origin fallback range responses - Test timed out"), [1780905](/show_bug.cgi?id=1780905 "RESOLVED DUPLICATE - MP4 videos with moov box at the end of the file will display as corrupted if they do not load fully."), [1781063](/show_bug.cgi?id=1781063 "VERIFIED FIXED - MP4 file served with Content-Security-Policy: sandbox doesn't play in Firefox when loaded as document"), [1781759](/show_bug.cgi?id=1781759 "VERIFIED FIXED - cross-origin Mp4 Videos not played when loaded as document in iFrame"), [1810922](/show_bug.cgi?id=1810922 "RESOLVED INCOMPLETE - Intermittent TVw [tier 2] ::: Test verification FAIL | TinderboxPrint: Per-test run of .../fetch-canvas-tainting-video-with-range-request.https.html<br/>: FAILURE")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[lbherrera.github.io/lab/firefox/range...](https://lbherrera.github.io/lab/firefox/range-0553e1f/index.html "https://lbherrera.github.io/lab/firefox/range-0553e1f/index.html")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1465074](/show_bug.cgi?id=1465074 "NEW - Allow range requests to pass through a service worker"), [1441153](/show_bug.cgi?id=1441153 "VERIFIED FIXED - Cross origin leak of resource size using media element"), [1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)"), [CVE-2022-45403](/show_bug.cgi?id=1762078 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=990849 "https://bugs.chromium.org/p/chromium/issues/detail?id=990849")

## Details

### (Keywords: csectype-sop, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main101+][adv-esr91.10+], [wptsync upstream])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-31736

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main101+][adv-esr91.10+], [wptsync upstream]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a17954233_1689 "3 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | [sec-bounty-hof](#a33337832_578488 "2 years ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty-hof | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files)

| [index.html](/attachment.cgi?id=9246038)  [3 years ago](#c0)  [Luan Herrera](/user_profile?user_id=550455)   2.48 KB, text/html |  | [Details](/attachment.cgi?id=9246038&action=edit) |
| --- | --- | --- |
| [sw.js](/attachment.cgi?id=9246039)  [3 years ago](#c1)  [Luan Herrera](/user_profile?user_id=550455)   478 bytes, text/javascript |  | [Details](/attachment.cgi?id=9246039&action=edit) |
| [Bug 1735923 - error on opacity change r?edenchuang](/attachment.cgi?id=9272577)  [3 years ago](#c15)  [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)   48 bytes, text/x-phabricator-request | tjr : [approval-mozilla-beta+](#c19 "3 years ago")  tjr : [sec-approval+](#c19 "3 years ago") | [Details](/attachment.cgi?id=9272577&action=edit) | [Review](/attachment.cgi?id=9272577) |
| [Bug 1735923 - avoid caching effects with a different query parameter for each subtest r?padenot](/attachment.cgi?id=9272578)  [3 years ago](#c16)  [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9272578&action=edit) | [Review](/attachment.cgi?id=9272578) |
| [Bug 1735923 test mixing of synthesized and network fallback range responses r?edenchuang](/attachment.cgi?id=9272579)  [3 years ago](#c17)  [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9272579&action=edit) | [Review](/attachment.cgi?id=9272579) |
| [error on opacity change - for esr91](/attachment.cgi?id=9275133)  [3 years ago](#c22)  [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)   4.62 KB, patch | RyanVM : [approval-mozilla-esr91+](#c24 "3 years ago") | [Details](/attachment.cgi?id=9275133&action=edit) | [Diff](/attachment.cgi?id=9275133&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1735923&attachment=9275133) |
| [advisory.txt](/attachment.cgi?id=9278198)  [3 years ago](#c32)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   160 bytes, text/plain |  | [Details](/attachment.cgi?id=9278198&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Luan Herrera](/user_profile?user_id=550455)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1735923#c0)• 3 years ago |
|  | |

Attached file
[index.html](attachment.cgi?id=9246038)
— [Details](attachment.cgi?id=9246038&action=edit)

When a cross-origin resource is used in an audio/video tag, a request containing the Range header asking for "bytes=0-" is issued.

If the request is intercepted using a Service Worker and we respond with an arbitrary Content-Range header, e.g:

e.respondWith(new Response("A", {status: 206, headers: { "Content-Range": "bytes 0-1/5000", "Content-Type": "audio/mp4" }}));

Firefox will be tricked into thinking it got the first byte of the audio/video and then ask for the remaining bytes by issuing a new request containing the "Range: bytes=1-" header.

If we decide not to intercept the subsequent request, it will go directly to the server and ask for the remaining bytes, and the response will contain bytes ranging from 1 to the total bytes of the cross-origin response.

If the total number of bytes from the cross-origin response is smaller than the total amount we stipulated when we intercepted the initial ranged request, Firefox will be fooled into thinking it needs to request more bytes, and the target's server will throw a "416 Range Not Satisfiable" error response code as it is not able to fulfill the request (as it already sent all bytes for that particular request).

We can detect when this behavior happens by counting the number of resources in performance.getEntries(), allowing an attacker to leak the exact size of cross-origin resources that accept range requests.

In the PoC, the size of <https://www.google.com/robots.txt> is being brute-forced starting on byte 7260. In a real attack, it would be trying to get the size through binary search.

This vulnerability is useful for XS-Search attacks. A real-world example is [https://medium.com/@luanherrera/xs-searching-googles-bug-tracker-to-find-out-vulnerable-source-code-50d8135b7549](https://medium.com/%40luanherrera/xs-searching-googles-bug-tracker-to-find-out-vulnerable-source-code-50d8135b7549) (more on <https://github.com/xsleaks/xsleaks/wiki/Real-World-Examples>).

This is a variation of a bug I reported to Chrome a few years ago (<https://bugs.chromium.org/p/chromium/issues/detail?id=990849>).

Here's a video reproducing the issue:

<https://youtu.be/pj2tvVRzglg>

VERSION

Version: 93.0 (64-bit)

Operating System: Windows 10

REPRODUCTION CASE

1. Access <https://lbherrera.github.io/lab/firefox/range-0553e1f/index.html>
2. Click on the "check" button and after a moment you should see messages about the leaked size of the cross-origin resource.

I have also attached the files used in the PoC - if you prefer, you can reproduce the attack by downloading and hosting index.html and sw.js on a web server.

CREDIT INFORMATION

Reporter credit: Luan Herrera (@lbherrera\_)

Flags: sec-bounty?

|  | [Luan Herrera](/user_profile?user_id=550455)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1735923#c1)• 3 years ago |
|  | |

Attached file
[sw.js](attachment.cgi?id=9246039)
— [Details](attachment.cgi?id=9246039&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a45243_159069)• 3 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: Service WorkersProduct: Firefox → Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a514691_1689)• 3 years ago |

Type: task → defectKeywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=990849>

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1735923#c2)• 3 years ago |
|  | |

Looking at the Chromium discussion, it seems that we need to produce performance entries also when the server returns a 416 response. I'm not sure what the right component for that is.

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a1090496_621888)• 3 years ago |

Component: DOM: Service Workers → Performance

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1735923#c3)• 3 years ago |
|  | |

I think the fundamental problem here (as also detailed in the Chromium bug mentioned above in a comment by Jake) is <https://github.com/whatwg/fetch/issues/144#issuecomment-368040980>. There was some work on addressing this in the HTML standard for media elements in <https://github.com/whatwg/html/pull/2814> but that has stalled unfortunately. Nevertheless, we need to address it in Firefox. Allowing opaque and non-opaque responses to be mixed is dangerous.

Luan, did you report this bug to Chrome as well? Because it sounds like they didn't go for the fix Jake recommend and instead addressed the symptom, which I would expect not to work long term.

Component: Performance → Audio/VideoSee Also: → [1465074](/show_bug.cgi?id=1465074 "NEW - Allow range requests to pass through a service worker")

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a1252781_102998)• 3 years ago |

See Also: → [1441153](/show_bug.cgi?id=1441153 "VERIFIED FIXED - Cross origin leak of resource size using media element")

|  | [Luan Herrera](/user_profile?user_id=550455)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1735923#c4)• 3 years ago |
|  | |

(In reply to Anne (:annevk) from [comment #3](/show_bug.cgi?id=1735923#c3 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers"))

> I think the fundamental problem here (as also detailed in the Chromium bug mentioned above in a comment by Jake) is <https://github.com/whatwg/fetch/issues/144#issuecomment-368040980>. There was some work on addressing this in the HTML standard for media elements in <https://github.com/whatwg/html/pull/2814> but that has stalled unfortunately. Nevertheless, we need to address it in Firefox. Allowing opaque and non-opaque responses to be mixed is dangerous.
>
> Luan, did you report this bug to Chrome as well? Because it sounds like they didn't go for the fix Jake recommend and instead addressed the symptom, which I would expect not to work long term.

Hey Anne, a few days after submitting this report I found a different variation that works on Chrome and sent a report to them as well. As far as I can tell, the fix they plan will require a spec change (they said they have an agreement from Mozilla and the spec editor to make this change via private communication), but it seems it will tackle the symptom and not <https://github.com/whatwg/html/pull/2814>.

|  | [Bryce Seager van Dyk [:bryce] (he/him) - Not reading bugmail](/user_profile?user_id=560379) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a2307404_560379)• 3 years ago |

Blocks: [media-triage](/show_bug.cgi?id=1708504 "NEW - [meta] Media Triage")

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1735923#c5)• 3 years ago |
|  | |

The severity field is not set for this bug.

:bryce, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(bvandyk)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1735923#c6)• 3 years ago |
|  | |

Paul, any thoughts here, sounds like we might need to wait on some spec changes to address.

Severity: -- → S2Flags: needinfo?(bvandyk) → needinfo?(padenot)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1735923#c7)• 3 years ago |
|  | |

I don't think we should wait for specifications to change as fixing this there is quite involved and hasn't been prioritized. (This area has been known to be problematic for at least five years.)

1. Jake's fundamental fix is essentially not allowing mixing of non-opaque and opaque responses in media elements. Arguably one problem here is that the cross-origin request is still made. It seems like it should be possible to network error earlier when we detect a cross-origin request after we've started using same-origin responses.
2. There's another solution to this problem outside of media elements, which is that we fix Resource Timing along the lines suggested in <https://github.com/w3c/resource-timing/issues/165>, but it's not clear to me that it could not be exploited in other ways. E.g., it seems timing the cross-origin response might also give the attacker some information about whether it's a 206 or 416. (There's also <https://github.com/whatwg/fetch/pull/1311> about exposing network errors to Resource Timing as well, but there's no agreement on that yet.)

|  | [Paul Adenot (:padenot)](/user_profile?user_id=404637) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1735923#c8)• 3 years ago |
|  | |

(In reply to Anne (:annevk) from [comment #7](/show_bug.cgi?id=1735923#c7 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers"))

> It seems like it should be possible to network error earlier when we detect a cross-origin request after we've started using same-origin responses.

Probably, as long as this has no Web Compat implications, it was an issue last time.

Flags: needinfo?(padenot)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1735923#c9)• 3 years ago |
|  | |

Waiting on some spec discussions.

Keywords: [stalled](/buglist.cgi?keywords=stalled&resolution=---)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a4796279_102998)• 3 years ago |

Keywords: [stalled](/buglist.cgi?keywords=stalled&resolution=---)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1735923#c10)• 3 years ago |
|  | |

After some discussion, we're going to take a shot at implementing option #1 in [comment 7](/show_bug.cgi?id=1735923#c7 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers").

Flags: needinfo?(padenot)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a7229253_279663)• 3 years ago |

Assignee: nobody → padenotNo longer blocks: [media-triage](/show_bug.cgi?id=1708504 "NEW - [meta] Media Triage")

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a11805336_279663)• 3 years ago |

Assignee: padenot → karlt

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1735923#c11)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1735923&comment_id=15824277 "1 revision") |
|  | |

Firefox [adds ResourceTiming entries](https://searchfox.org/mozilla-central/rev/840881e1232f664a58b39caaae6284c7bcf121df/netwerk/protocol/http/HttpBaseChannel.cpp#5094) for both 206 and 416 responses.

In Firefox, a shorter than ServiceWorker-exagerated cross-origin resource is distinguishable due to Firefox making an additional range request when the cross-origin server returns a shorter response than expected.

The expected length is [set](https://searchfox.org/mozilla-central/rev/840881e1232f664a58b39caaae6284c7bcf121df/dom/media/MediaCache.cpp#1942) based on the range total [from the initial response](https://searchfox.org/mozilla-central/rev/1c54648c082efdeb08cf6a5e3a8187e83f7549b9/dom/media/ChannelMediaResource.cpp#227,241,244) (from the ServiceWorker in this case).

The expected length can be [increased when a longer response is received](https://searchfox.org/mozilla-central/rev/840881e1232f664a58b39caaae6284c7bcf121df/dom/media/MediaCache.cpp#2042), but the [final assessment that could have used the total bytes received to correctly shorten the expected length](https://searchfox.org/mozilla-central/rev/840881e1232f664a58b39caaae6284c7bcf121df/dom/media/MediaCache.cpp#2126) is not reached before the additional request is sent due to a [comparison based on the incorrect length](https://searchfox.org/mozilla-central/rev/840881e1232f664a58b39caaae6284c7bcf121df/dom/media/ChannelMediaResource.cpp#371).

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a13688032_274246)• 3 years ago |

Status: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a14336280_274246)• 3 years ago |

Component: Audio/Video → Audio/Video: Playback

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a14336531_274246)• 3 years ago |

See Also: → [1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)")

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a14342557_274246)• 3 years ago |

See Also: → [CVE-2022-45403](/show_bug.cgi?id=1762078 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests")

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1735923#c12)• 3 years ago |
|  | |

(In reply to Anne (:annevk) from [comment #7](/show_bug.cgi?id=1735923#c7 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers"))

> 1. Jake's fundamental fix is essentially not allowing mixing of non-opaque and opaque responses in media elements.

That alone is not going to resolve the issue here as the length is already exposed to the ServiceWorker when the media element makes the additional range request (which later happens to respond with 416), so I've split this off into [bug 1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)").

> Arguably one problem here is that the cross-origin request is still made. It seems like it should be possible to network error earlier when we detect a cross-origin request after we've started using same-origin responses.

Filed [bug 1762078](/show_bug.cgi?id=1762078 "RESOLVED FIXED - ServiceWorker-added timing attacks to infer length or existence of cross-origin resources from no-cors media element requests") for that, addressing which would require going off spec.

This and [bug 1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)") can be addressed without requiring any spec change that has not yet been agreed.

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1735923#c13)• 3 years ago |
|  | |

(In reply to Karl Tomlinson (:karlt) from [comment #12](/show_bug.cgi?id=1735923#c12 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers"))

> (In reply to Anne (:annevk) from [comment #7](/show_bug.cgi?id=1735923#c7 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers"))
>
> > 1. Jake's fundamental fix is essentially not allowing mixing of non-opaque and opaque responses in media elements.
>
> That alone is not going to resolve the issue here as the length is already exposed to the ServiceWorker when the media element makes the additional range request (which later happens to respond with 416), so I've split this off into [bug 1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)").

I was wrong here. That additional range request is not made when [bug 1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)") is addressed, so I'll fold [bug 1762068](/show_bug.cgi?id=1762068 "RESOLVED DUPLICATE - Mixing of cross-origin and ServiceWorker range responses with media element (cross-origin data leak)") into this.

I'll address [comment 11](/show_bug.cgi?id=1735923#c11 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers") in [bug 1765025](/show_bug.cgi?id=1765025 "RESOLVED FIXED - Incorrect use of Content-Length when Content-Range has no complete-length field").

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1735923#c15)• 3 years ago |
|  | |

Attached file
[Bug 1735923 - error on opacity change r?edenchuang](attachment.cgi?id=9272577)
— [Details](attachment.cgi?id=9272577&action=edit)

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1735923#c16)• 3 years ago |
|  | |

Attached file
[Bug 1735923 - avoid caching effects with a different query parameter for each subtest r?padenot](attachment.cgi?id=9272578)
— [Details](attachment.cgi?id=9272578&action=edit)

to work around <https://bugzilla.mozilla.org/show_bug.cgi?id=1129121>

Depends on D143865

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1735923#c17)• 3 years ago |
|  | |

Attached file
[Bug 1735923 test mixing of synthesized and network fallback range responses r?edenchuang](attachment.cgi?id=9272579)
— [Details](attachment.cgi?id=9272579&action=edit)

Depends on D143866

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1735923#c18)• 3 years ago |
|  | |

Comment on [attachment 9272577](/attachment.cgi?id=9272577 "Bug 1735923 - error on opacity change r?edenchuang") [[details]](/attachment.cgi?id=9272577&action=edit "Bug 1735923 - error on opacity change r?edenchuang")

[Bug 1735923](/show_bug.cgi?id=1735923 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers") - error on opacity change r?edenchuang

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Comments in the patch describe the flaw but do not have all the details on how to exploit the flaw. Info on how to construct media resource leading bytes to exploit the flaw are public at <https://github.com/whatwg/fetch/issues/144#issuecomment-368040980> and [bug 1441153 comment 0](/show_bug.cgi?id=1441153#c0 "VERIFIED FIXED - Cross origin leak of resource size using media element"). These are not referenced in the patch.

This bug report identifies a further exploit, which is similar but different to a public [Chrome issue](https://bugs.chromium.org/p/chromium/issues/detail?id=990849#c0)..

The patch [changes the results](https://phabricator.services.mozilla.com/D143865?id=568139#inline-799761) of a test that uses [related techniques](https://searchfox.org/mozilla-central/source/testing/web-platform/tests/fetch/range/resources/range-sw.js#186,191-193), but still different from the exploits mentioned here.

* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**: The surrounding code has not changed since June 2019, so any conflicts for backports should be limited to expected test results.
* **How likely is this patch to cause regressions; how much testing does it need?**: Gecko already has reasonably [different behavior with range requests in ServiceWorker](https://bugzilla.mozilla.org/show_bug.cgi?id=1465074), so I'm not expecting sites to be depending on Gecko's vulnerable behavior.

  If any sites are depending on the vulnerable behavior, then I don't know how we could continue to support them.

The key area of risk might be if the patch should error on media element load in an unintentional situation. Existing tests were helpful in identifying flaws in previous iterations of this patch.

* **Is Android affected?**: Yes
[Attachment #9272577](/attachment.cgi?id=9272577&action=edit "Bug 1735923 - error on opacity change r?edenchuang") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1735923#c19)• 3 years ago |
|  | |

Comment on [attachment 9272577](/attachment.cgi?id=9272577 "Bug 1735923 - error on opacity change r?edenchuang") [[details]](/attachment.cgi?id=9272577&action=edit "Bug 1735923 - error on opacity change r?edenchuang")

[Bug 1735923](/show_bug.cgi?id=1735923 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers") - error on opacity change r?edenchuang

Approved to land and uplift

[Attachment #9272577](/attachment.cgi?id=9272577&action=edit "Bug 1735923 - error on opacity change r?edenchuang") -
Flags: sec-approval?
[Attachment #9272577](/attachment.cgi?id=9272577&action=edit "Bug 1735923 - error on opacity change r?edenchuang") -
Flags: sec-approval+
[Attachment #9272577](/attachment.cgi?id=9272577&action=edit "Bug 1735923 - error on opacity change r?edenchuang") -
Flags: approval-mozilla-beta+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1735923#c20)• 3 years ago |
|  | |

error on opacity change r=edenchuang

<https://hg.mozilla.org/integration/autoland/rev/56757e00ffb4fbea5c67b67d86d081949065dd6d>

<https://hg.mozilla.org/mozilla-central/rev/56757e00ffb4>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 102 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1735923#c21)• 3 years ago |
|  | |

Landed for 101.0b3.

<https://hg.mozilla.org/releases/mozilla-beta/rev/cc3d50e3408b>

Please nominate this for ESR uplift too when you get a chance.

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=wontfix)
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox101](/buglist.cgi?f1=cf_tracking_firefox101&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B)
[tracking-firefox102](/buglist.cgi?f1=cf_tracking_firefox102&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [101+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=101%2B)Flags: needinfo?(karlt)

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1735923#c22)• 3 years ago |
|  | |

Attached patch

[error on opacity change - for esr91](attachment.cgi?id=9275133&action=diff)
— [Details](attachment.cgi?id=9275133&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1735923&attachment=9275133)

Flags: needinfo?(karlt)

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1735923#c23)• 3 years ago |
|  | |

Comment on [attachment 9275133](/attachment.cgi?id=9275133 "error on opacity change - for esr91") [[details]](/attachment.cgi?id=9275133&action=edit "error on opacity change - for esr91") [[diff]](/attachment.cgi?id=9275133&action=diff "error on opacity change - for esr91") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1735923&attachment=9275133)

error on opacity change - for esr91

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-high
* **User impact if declined**:
* **Fix Landed on Version**: 102
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: The key area of risk might be if the patch should cause error on media element load in an unintentional situation. Existing tests were helpful in identifying flaws in previous iterations of this patch.
[Attachment #9275133](/attachment.cgi?id=9275133&action=edit "error on opacity change - for esr91") -
Attachment is patch: true
[Attachment #9275133](/attachment.cgi?id=9275133&action=edit "error on opacity change - for esr91") -
Flags: approval-mozilla-esr91?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1735923#c24)• 3 years ago |
|  | |

Comment on [attachment 9275133](/attachment.cgi?id=9275133 "error on opacity change - for esr91") [[details]](/attachment.cgi?id=9275133&action=edit "error on opacity change - for esr91") [[diff]](/attachment.cgi?id=9275133&action=diff "error on opacity change - for esr91") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1735923&attachment=9275133)

error on opacity change - for esr91

Approved for 91.10esr.

[Attachment #9275133](/attachment.cgi?id=9275133&action=edit "error on opacity change - for esr91") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1735923#c25)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/dfc94f10465c>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1735923#c26)• 3 years ago |
| backout | |

Backed out from ESR for causing test\_midflight\_redirect\_blocked.html failures.

<https://hg.mozilla.org/releases/mozilla-esr91/rev/c5fe204aa88c475fcea7e59cf34b1899bb3d6776>

Log:

<https://treeherder.mozilla.org/logviewer?job_id=376969368&repo=mozilla-esr91&lineNumber=4269>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)Flags: needinfo?(karlt)

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a17538130_274246)• 3 years ago |

Depends on: [1764515](/show_bug.cgi?id=1764515 "RESOLVED FIXED - Remove \"media.block-midflight-redirects\" pref")

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1735923#c27)• 3 years ago |
|  | |

Ah, sorry. We need to uplift the fix for [bug 1764515](/show_bug.cgi?id=1764515 "RESOLVED FIXED - Remove \"media.block-midflight-redirects\" pref") before landing this on esr91.

Flags: needinfo?(karlt)

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a17564285_500622)• 3 years ago |

Flags: qe-verify+

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a17564803_500622)• 3 years ago |

QA Whiteboard: [qa-triaged]

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1735923#c28)• 3 years ago |
|  | |

Verified as fixed on Windows 10 x64, macOS 11.6 and on Ubuntu 20.04 x64.

[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=verified)
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=verified)

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1735923#c29)• 3 years ago |
|  | |

(In reply to Karl Tomlinson (:karlt) from [comment #27](/show_bug.cgi?id=1735923#c27 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers"))

> Ah, sorry. We need to uplift the fix for [bug 1764515](/show_bug.cgi?id=1764515 "RESOLVED FIXED - Remove \"media.block-midflight-redirects\" pref") before landing this on esr91.

Assuming this needs Ryan's attention then?

Flags: needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1735923#c30)• 3 years ago |
| uplift | |

Re-landed with [bug 1764515](/show_bug.cgi?id=1764515 "RESOLVED FIXED - Remove \"media.block-midflight-redirects\" pref") included.

<https://hg.mozilla.org/releases/mozilla-esr91/rev/9f143c561b4b>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)Flags: needinfo?(ryanvm)

|  | [Hani Yacoub, Desktop QA](/user_profile?user_id=583007) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1735923#c31)• 3 years ago |
|  | |

Verified as fixed on Windows 10 x64, macOS 11.6 and on Ubuntu 20.04 x64.

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a17954233_1689)• 3 years ago |

Flags: sec-bounty? → sec-bounty-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a19245385_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main101+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1735923#c32)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9278198)
— [Details](attachment.cgi?id=9278198&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a19329933_578488)• 3 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main101+] → [reporter-external] [client-bounty-form] [verif?][adv-main101+][adv-esr91.10+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a19331745_578488)• 3 years ago |

Alias: CVE-2022-31736

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a24541019_309398)• 2 years ago |

Regressions: [1781063](/show_bug.cgi?id=1781063 "VERIFIED FIXED - MP4 file served with Content-Security-Policy: sandbox doesn't play in Firefox when loaded as document")

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a24549316_274246)• 2 years ago |

Regressions: [1780905](/show_bug.cgi?id=1780905 "RESOLVED DUPLICATE - MP4 videos with moov box at the end of the file will display as corrupted if they do not load fully.")

|  | [Alice0775 White](/user_profile?user_id=293623) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a24671655_293623)• 2 years ago |

Regressions: [1781759](/show_bug.cgi?id=1781759 "VERIFIED FIXED - cross-origin Mp4 Videos not played when loaded as document in iFrame")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a33337832_578488)• 2 years ago |

Flags: sec-bounty-hof+

|  | [Paul Adenot (:padenot)](/user_profile?user_id=404637) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a39202154_404637)• 2 years ago |

Flags: needinfo?(padenot)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a39677111_1689)• 2 years ago |

Group: core-security-release

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1735923#c33)• 2 years ago |
|  | |

Pushed by ktomlinson@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/84202394415c>
avoid caching effects with a different query parameter for each subtest r=padenot
<https://hg.mozilla.org/integration/autoland/rev/7069c85fec77>
test mixing of synthesized and network fallback range responses r=edenchuang

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1735923#c34)• 2 years ago |
|  | |

Created web-platform-tests PR <https://github.com/web-platform-tests/wpt/pull/38020> for changes under testing/web-platform/tests

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a39731022_611017)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main101+][adv-esr91.10+] → [reporter-external] [client-bounty-form] [verif?][adv-main101+][adv-esr91.10+], [wptsync upstream]

|  | [Atila Butkovits](/user_profile?user_id=661920) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1735923#c35)• 2 years ago |
|  | |

Backed out for causing wpt failures at fetch-canvas-tainting-video-with-range-request.https.html.

Backout link: <https://hg.mozilla.org/integration/autoland/rev/d31325fafb89f1f88e5ebcb4e27bd9acfbba9f97>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=7069c85fec77caed088493004093aa8f10627c82&selectedTaskRun=R27u3REJTQaY3nr5jIvlDQ.0>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=402723251&repo=autoland&lineNumber=9377>

Flags: needinfo?(karlt)

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1735923#c36)• 2 years ago |
|  | |

Upstream PR was closed without merging

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1735923#c37)• 2 years ago |
|  | |

Pushed by ktomlinson@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/9db99c7863bd>
avoid caching effects with a different query parameter for each subtest r=padenot
<https://hg.mozilla.org/integration/autoland/rev/041c72f0ce79>
test mixing of synthesized and network fallback range responses r=edenchuang

|  | [Treeherder Bug Filer](/user_profile?user_id=573381) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a39764587_573381)• 2 years ago |

Regressions: [1810922](/show_bug.cgi?id=1810922 "RESOLVED INCOMPLETE - Intermittent TVw [tier 2] ::: Test verification FAIL | TinderboxPrint: Per-test run of .../fetch-canvas-tainting-video-with-range-request.https.html<br/>: FAILURE")

|  | [Noemi Erli[:noemi\_erli]](/user_profile?user_id=600656) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1735923#c38)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1735923&comment_id=16240644 "3 revisions") |
|  | |

Backed out 2 changesets ([Bug 1735923](/show_bug.cgi?id=1735923 "VERIFIED FIXED - Leaking size of cross-origin resources by using Range Requests and Service Workers")) for causing failures in fetch-canvas-tainting-video-with-range-request.https.html CLOSED TREE

Push with failures: <https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&collapsedPushes=842382&selectedTaskRun=N5dAVRH8S8qUVHQf9eJHrQ.0&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=041c72f0ce794ce0c6e66dfd1e8ff9708b074c8d>

Log: <https://treeherder.mozilla.org/logviewer?job_id=402748729&repo=autoland&lineNumber=15318>

And possible <https://treeherder.mozilla.org/logviewer?job_id=402742037&repo=autoland&lineNumber=12465> which points a high frequency since this bug originally landed

Backout: <https://hg.mozilla.org/integration/autoland/rev/bafeaf331566e802a4de32808818017479ef81fe>

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1735923#c39)• 2 years ago |
|  | |

Upstream PR was closed without merging

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a71377537_600971)• 1 year ago |

[Attachment #9272579](/attachment.cgi?id=9272579&action=edit "Bug 1735923 test mixing of synthesized and network fallback range responses r?edenchuang") -
Attachment description: Bug 1735923 - test mixing of synthesized and network fallback range responses r?edenchuang → Bug 1735923 test mixing of synthesized and network fallback range responses r?edenchuang

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1735923#c40)• 1 year ago |
|  | |

Pushed by ktomlinson@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/c2b31f79499e>
avoid caching effects with a different query parameter for each subtest r=padenot

|  | [Iulian Moraru](/user_profile?user_id=682863) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1735923#c41)• 1 year ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/c2b31f79499e>

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1735923#c42)• 1 year ago |
|  | |

Upstream PR merged by moz-wptsync-bot

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1735923#c43)• 1 year ago |
|  | |

Pushed by ktomlinson@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/8aee0017e037>
test mixing of synthesized and network fallback range responses r=edenchuang

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1735923#c44)• 1 year ago |
|  | |

Created web-platform-tests PR <https://github.com/web-platform-tests/wpt/pull/44238> for changes under testing/web-platform/tests

|  | [Treeherder Bug Filer](/user_profile?user_id=573381) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a72057122_573381)• 1 year ago |

Regressions: [1876866](/show_bug.cgi?id=1876866 "NEW - Intermittent [TVw] TEST-UNEXPECTED-TIMEOUT | /service-workers/service-worker/fetch-canvas-tainting-video-with-range-request.https.html | synth and cross-origin fallback range responses - Test timed out")

|  | [Narcis Beleuzu [:NarcisB]](/user_profile?user_id=600627) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1735923#c45)• 1 year ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/8aee0017e037>

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1735923#c46)• 1 year ago |
|  | |

Upstream PR merged by moz-wptsync-bot

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a74664692_274246)• 11 months ago |

Flags: needinfo?(karlt)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1735923#a82838820_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1735923&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Luan Herrera](/user_profile?user_id=550455)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_487f1bb6_20250114_221611.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-21

## Security Vulnerabilities fixed in Firefox ESR 91.10

Announced
May 31, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.10

#### [#CVE-2022-31736: Cross-Origin resource's length leaked](#CVE-2022-31736)

Reporter
Luan Herrera
Impact
high
##### Description

A malicious website could have learned the size of a cross-origin resource that supported Range requests.

##### References

* [Bug 1735923](https://bugzilla.mozilla.org/show_bug.cgi?id=1735923)

#### [#CVE-2022-31737: Heap buffer overflow in WebGL](#CVE-2022-31737)

Reporter
Atte Kettunen
Impact
high
##### Description

A malicious webpage could have caused an out-of-bounds write in WebGL, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1743767](https://bugzilla.mozilla.org/show_bug.cgi?id=1743767)

#### [#CVE-2022-31738: Browser window spoof using fullscreen mode](#CVE-2022-31738)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When exiting fullscreen mode, an iframe could have confused the browser about the current state of fullscreen, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1756388](https://bugzilla.mozilla.org/show_bug.cgi?id=1756388)

#### [#CVE-2022-31739: Attacker-influenced path traversal when saving downloaded files](#CVE-2022-31739)

Reporter
Chaobin Zhang
Impact
high
##### Description

When downloading files on Windows, the % character was not escaped, which could have lead to a download incorrectly being saved to attacker-influenced paths that used variables such as %HOMEPATH% or %APPDATA%.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1765049](https://bugzilla.mozilla.org/show_bug.cgi?id=1765049)

#### [#CVE-2022-31740: Register allocation problem in WASM on arm64](#CVE-2022-31740)

Reporter
Gary Kwong
Impact
high
##### Description

On arm64, WASM code could have resulted in incorrect assembly generation leading to a register allocation problem, and a potentially exploitable crash.

##### References

* [Bug 1766806](https://bugzilla.mozilla.org/show_bug.cgi?id=1766806)

#### [#CVE-2022-31741: Uninitialized variable leads to invalid memory read](#CVE-2022-31741)

Reporter
Cybeats PSI Team
Impact
high
##### Description

A crafted CMS message could have been processed incorrectly, leading to an invalid memory read, and potentially further memory corruption.

##### References

* [Bug 1767590](https://bugzilla.mozilla.org/show_bug.cgi?id=1767590)

#### [#CVE-2022-31742: Querying a WebAuthn token with a large number of allowCredential entries may have leaked cross-origin information](#CVE-2022-31742)

Reporter
Michal
Impact
moderate
##### Description

An attacker could have exploited a timing attack by sending a large number of allowCredential entries and detecting the difference between invalid key handles and cross-origin key handles. This could have led to cross-origin account linking in violation of WebAuthn goals.

##### References

* [Bug 1730434](https://bugzilla.mozilla.org/show_bug.cgi?id=1730434)

#### [#CVE-2022-31747: Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](#CVE-2022-31747)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Nicolas B. Pierron, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 100 and Firefox ESR 91.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760765%2C1765610%2C1766283%2C1767365%2C1768559%2C1768734)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


