=== Content from sec-consult.com_0cd6d91b_20250114_191832.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/schwachstellen-infiray-iray-waermebildkamera/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple Vulnerabilities in Infiray IRAY-A8Z3 thermal camera
# Multiple Vulnerabilities in Infiray IRAY-A8Z3 thermal camera

Title

Multiple Vulnerabilities

Product

Infiray IRAY-A8Z3 thermal camera

Vulnerable Version

V1.0.957

Fixed Version

None

CVE Number

CVE-2022-31208, CVE-2022-31209, CVE-2022-31210, CVE-2022-31211

Impact

critical

Homepage

[http://www.infiray.com/](http://www.infiray.com/ "http://www.infiray.com/")

Found

01.02.2021

By

S. Robertz (Office Vienna), F. Lienhart | SEC Consult Vulnerability Lab

The IRAY A8Z3 thermal camera for industrial application, manufactured by Infiray/IRay Technologies is affected by multiple vulnerabilities. These are a direct consequence of insecure coding practices, insecure configuration and outdated software components within the embedded firmware. Multiple attack vectors were found that will result in remote code execution (RCE). The vendor did not reply anymore to our communication attempts, hence it is unclear whether patches are available.

## Vendor description

*"IRay Technology Co., Ltd. is a wholly-owned subsidiary of Raytron Technology Co., Ltd. (SSE: 688002). As a high-tech enterprise, IRay Technology develops and manufactures infrared FPA detectors, thermal imaging modules, and other products, with completely independent intellectual property rights. We are committed to providing global customers with professional thermal imaging products and solutions. The main products include IRFPA detectors, thermal imaging cores, and terminal products for application."*

Source: <http://www.infiray.com/about.html>

## Business recommendation

The vendor was unresponsive during the disclosure process. Hence it is unclear whether patches are available. Customers are urged to approach their vendor contact and request security reviews and updates.

SEC Consult recommends to perform a thorough security review of these products conducted by security professionals to identify and resolve all security issues.

## Vulnerability overview/description

### 1) Hardcoded Web Credentials (CVE-2022-31210)

The binary file "/usr/local/sbin/webproject/set\_param.cgi" contains hardcoded credentials to the web application. As these accounts cannot be deactivated or change their passwords, they are considered to be backdoor accounts.

### 2) Authenticated Remote Code Execution (CVE-2022-31208)

The webserver contains an endpoint that can execute arbitrary commands by manipulating the "cmd\_string" URL parameter. The user can login using one of the backdoor accounts from issue 1.

### 3) Potential Buffer Overflow (CVE-2022-31209)

The firmware contains a potential buffer overflow by calling strcpy() without checking the string length beforehand.

### 4) Telnet Root Shell without Password (CVE-2022-31211)

The camera offers a shell through a telnet connection. The root user does not require a password per default. Thus, anyone on the local network can execute arbitrary commands as root on the camera.

### 5) Multiple Outdated Software Components

Multiple outdated software components containing vulnerabilities were found by the IoT Inspector (ONEKEY) firmware analysis platform.

## Proof of concept

### 1) Hardcoded Web Credentials (CVE-2022-31210)

The following cgi program will be executed during the login process:

```
http ://<my_ip>:8080/set_param.cgi?&group_tag=hash_param_bridge&set_cmd=loading&length=35&name=<user>&password=<password>&access=0&0.3543773172371312
```

The following de-compilation shows the code flow with the hardcoded passwords:

```
[ PoC removed ]
```

The authentication works by comparing the URL supplied username with the string **"[removed]".** Afterwards it will compare the password parameter to **"[removed]"** as well. If both string parameters match, a message will be removed from the messaging queue. Otherwise the function will just return. The same comparison holds for the admin account.

Furthermore, string comparisons are made without checking the case. Hence, drastically improving the chances of brute-force attacks.

### 2) Authenticated Remote Code Execution (CVE-2022-31208)

The web application offers an option to view the device log. Opening following URL while logged in as admin (e.g. with hardcoded password from section 1) will trigger the request:

```
http ://<my_ip>:8080/cmd.cgi?cmd_tag=cmd_passthrough&cmd_string=[removed]
```

By changing the "cmd\_string" parameter, arbitrary commands can be executed with the rights of the webserver (www-data). The de-compiled code can be seen in following snippet:

```
[ PoC removed ]
```

The "cmd\_string" parameter is directly passed into popen() and hence executed.

### 3) Potential Buffer-Overflow (CVE-2022-31209)

The firmware contains a potential buffer overflow vulnerability:

```
[ PoC removed ]
```

A pointer to the "next\_url" parameter is supplied. A buffer of 64 bytes is allocated and the parameter value copied to it without checking the string length. Hence, a "next\_url" parameter with more than 64 bytes could be supplied in order to overflow the buffer. Please note that this vulnerability is only based on firmware analysis and thus was not tested in a live scenario.

### 4) Telnet Root Shell without Password (CVE-2022-31211)

The camera has a telnetd server running on port 23 per default. The root password is empty. If the telnet port is exposed to the internet, an attacker could easily connect to the device and gain root access. The telnet server cannot be deactivated and the root password cannot be changed through the web interface.

### 5) Multiple Outdated Software Components

IoT Inspector (ONEKEY) recognized multiple outdated software components with known vulnerabilities:

```
BusyBox 1.25.0:                                  6 CVEs
curl 7.54.0:                                    13 CVEs
Dnsmasq 2.76:                                    9 CVEs
lighttpd 1.4.41:                                 2 CVEs
Linux Kernel 3.10.104:                        1004 CVEs
hostapd 2.5:                                    22 CVEs
wpa_supplicant 2.5-devel_rtw_r17190.20160415:   12 CVEs
```
## Vulnerable / tested versions

The following product/firmware version has been tested:

* Infiray IRAY-A8Z3 V1.0.957

It has to be assumed that further products or firmware versions are affected as well.

## Vendor contact timeline

| 2021-02-24 | Contacting vendor through email address found on their website (sales@infiray.com) |
| --- | --- |
| 2021-03-11 | Contacted vendor again through sales@infiray.com |
| 2021-04-12 | Contacting vendor through sales@infiray.com and InfiRay.CS@iraytek.com |
| 2021-04-12 | Response from Sales Director, does not understand what to do with the information |
| 2021-04-12 | Requesting a contact to the product owner or developer |
| 2021-04-13 | Sending unencrypted security advisory to two provided email addresses. |
| 2021-04-29 | Requesting status from vendor, no reply. |
| 2022-04-05 | Requested status from vendor, no reply. |
| 2022-06-07 | Release of security advisory. |

## Solution

The vendor was unresponsive during the disclosure process. Hence it is unclear whether patches are available. Customers are urged to approach their vendor contact and request security reviews and updates.

### Workaround:

None

### Advisory URL:

<https://sec-consult.com/vulnerability-lab/>

EOF S. Robertz, F. Lienhart / @2022

*Interested to work with the experts of SEC Consult?*

*Send us your [application](https://sec-consult.com/career/)*

*Interested in improving your cyber security with the experts of SEC Consult?*

*Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all


