Based on the provided content, here's a breakdown of the vulnerability described in CVE-2022-31790:

**Root Cause of Vulnerability:**

- The vulnerability lies in the `wgcgi` component of WatchGuard Firebox and XTM appliances.
- It stems from a lack of proper sanitization of user-supplied input when constructing an XPath query.
- Specifically, the `name` parameter (representing the authentication server name) from an HTTP POST request is directly embedded into an XPath query without any validation.

**Weaknesses/Vulnerabilities Present:**

- **XPath Injection:** The primary vulnerability is an XPath injection, allowing an attacker to manipulate the XPath query used to retrieve authentication server configurations.
- **Lack of Input Sanitization:**  The system fails to sanitize or validate the `name` parameter before using it in the XPath query. This permits injection of malicious XPath expressions.

**Impact of Exploitation:**

- **Information Disclosure:** Successful exploitation allows an unauthenticated attacker to retrieve sensitive authentication server settings from the device's XML configuration file. This information may include details about LDAP servers, Active Directory configurations, or other user databases.
- **Time-Based Data Exfiltration:** Since the response to the XPath query does not directly leak data, the vulnerability is exploited by using time-based techniques, by using XPath functions that cause significant delays in execution based on the boolean evaluation of the injected conditions.

**Attack Vectors:**

- **Network:** Remote attackers can exploit this vulnerability over the network through the exposed web interface on port 443.
- **HTTP POST Request:** The attack is performed by sending a crafted HTTP POST request to the `/wgcgi.cgi` endpoint, containing a malicious payload in the `fw_domain` parameter.

**Required Attacker Capabilities/Position:**

- **Unauthenticated Access:** An attacker does not need prior authentication to exploit this vulnerability.
- **Network Access:** The attacker needs network access to the vulnerable device. This usually means being on the same network or having a path to reach the device over the internet.
- **Ability to Craft HTTP Request:** The attacker must be capable of constructing and sending HTTP POST requests with the specific parameters required to trigger the vulnerability.

**Additional Notes:**

- This vulnerability is exploitable on WatchGuard Firebox and XTM appliances running vulnerable versions of Fireware OS.
- The exploitation is considered "blind" because the application's response does not directly disclose any information about the query results. Time-based injection techniques are needed to exfiltrate data.
- The vulnerability was discovered by Charles Fol from LEXFO/AMBIONICS.
- WatchGuard assigned it the identifier WSGA-2022-00017.
- The vulnerability was patched in Fireware OS versions 12.8.1, 12.5.10, and 12.1.4.