The provided content relates to CVE-2022-31071.

**Root cause of vulnerability:**
The `octopoller` gem version 0.2.0 was published with world-writable files. Specifically, the gem was packed with files having their permissions set to `-rw-rw-rw-` (0666) instead of `rw-r--r--` (0644).

**Weaknesses/vulnerabilities present:**
The vulnerability is due to the incorrect file permissions in the published gem. The files were set as world-writable, which means that any user (group and public) with access to the instance where the gem was installed could modify the files.

**Impact of exploitation:**
Malicious code already present and running on a machine (separate from this package) could modify the gem's files and change its behavior during runtime. This could lead to arbitrary code execution or other malicious activity.

**Attack vectors:**
The attack vector is through the installation of the vulnerable gem version 0.2.0. If an attacker has code running on the same system where the vulnerable gem is installed, they can modify the gem's files due to the world-writable permissions.

**Required attacker capabilities/position:**
The attacker needs to have code running on the same machine where the vulnerable `octopoller` gem (version 0.2.0) is installed and have the ability to write to the gem's files. This means the attacker would already need to have some level of access to the affected system.

The provided content also includes details of the fix for the issue which includes the addition of a validation script (`script/validate`) to check for file permissions before publishing a gem.