=== Content from github.com_411f675c_20250114_183606.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2Fafcc6c3389729b85d5c7b0230cbf9aaf7452f31a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2Fafcc6c3389729b85d5c7b0230cbf9aaf7452f31a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=DSpace%2FDSpace)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DSpace](/DSpace)
/
**[DSpace](/DSpace/DSpace)**
Public

* [Notifications](/login?return_to=%2FDSpace%2FDSpace) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FDSpace%2FDSpace)
* [Star
   919](/login?return_to=%2FDSpace%2FDSpace)

* [Code](/DSpace/DSpace)
* [Issues
  590](/DSpace/DSpace/issues)
* [Pull requests
  164](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects
  0](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

Additional navigation options

* [Code](/DSpace/DSpace)
* [Issues](/DSpace/DSpace/issues)
* [Pull requests](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

## Commit

[Permalink](/DSpace/DSpace/commit/afcc6c3389729b85d5c7b0230cbf9aaf7452f31a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[DS-4449] Sanitise stacktrace output and default to NOT output stackt…

[Browse files](/DSpace/DSpace/tree/afcc6c3389729b85d5c7b0230cbf9aaf7452f31a)
Browse the repository at this point in the history

```
…races
```

* Loading branch information

[![@kshepherd](https://avatars.githubusercontent.com/u/194773?s=40&v=4)](/kshepherd)

[kshepherd](/DSpace/DSpace/commits?author=kshepherd "View all commits by kshepherd")
committed
May 27, 2022

1 parent
[ebb83a7](/DSpace/DSpace/commit/ebb83a75234d3de9be129464013e998dc929b68d)

commit afcc6c3

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**14 additions**
and
**11 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* dspace-jspui/src/main

  + java/org/dspace/app/webui/servlet

    - dspace-jspui/src/main/java/org/dspace/app/webui/servlet/InternalErrorServlet.java
      [InternalErrorServlet.java](#diff-d6231c5a5ee8f9d5d7e449a2f340b22d6a61eca33e9a08817cba8666a5c071a6)
  + webapp/error

    - dspace-jspui/src/main/webapp/error/internal.jsp
      [internal.jsp](#diff-e94c521fc0b8de392e80d94f4e720f3c887f1ffd957c80800436ab439c80a3ff)

## There are no files selected for viewing

6 changes: 5 additions & 1 deletion

6
[dspace-jspui/src/main/java/org/dspace/app/webui/servlet/InternalErrorServlet.java](#diff-d6231c5a5ee8f9d5d7e449a2f340b22d6a61eca33e9a08817cba8666a5c071a6 "dspace-jspui/src/main/java/org/dspace/app/webui/servlet/InternalErrorServlet.java")

Show comments

[View file](/DSpace/DSpace/blob/afcc6c3389729b85d5c7b0230cbf9aaf7452f31a/dspace-jspui/src/main/java/org/dspace/app/webui/servlet/InternalErrorServlet.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,6 +8,7 @@ |
|  |  | package org.dspace.app.webui.servlet; |
|  |  |  |
|  |  | import java.io.IOException; |
|  |  | import java.util.UUID; |
|  |  |  |
|  |  | import javax.servlet.ServletException; |
|  |  | import javax.servlet.http.HttpServlet; |
| Expand Down  Expand Up | | @@ -37,6 +38,8 @@ public class InternalErrorServlet extends HttpServlet |
|  |  | protected void doGet(HttpServletRequest request, |
|  |  | HttpServletResponse response) throws ServletException, IOException |
|  |  | { |
|  |  |  |
|  |  | UUID errorCode = UUID.randomUUID(); |
|  |  | // Get the exception that occurred, if any |
|  |  | Throwable t = (Throwable) request |
|  |  | .getAttribute("javax.servlet.error.exception"); |
| Expand All | | @@ -45,14 +48,15 @@ protected void doGet(HttpServletRequest request, |
|  |  |  |
|  |  | // Log the error. Since we don't have a context, we need to |
|  |  | // build the info "by hand" |
|  |  | String logMessage = ":session\_id=" + request.getSession().getId() |
|  |  | String logMessage = ":error\_code=" + errorCode + ":session\_id=" + request.getSession().getId() |
|  |  | + ":internal\_error:" + logInfo; |
|  |  |  |
|  |  | log.warn(logMessage, t); |
|  |  |  |
|  |  | // Now we try and mail the designated user, if any |
|  |  | UIUtil.sendAlert(request, (Exception) t); |
|  |  |  |
|  |  | request.setAttribute("javax.servlet.error.code", errorCode.toString()); |
|  |  | JSPManager.showJSP(request, response, "/error/internal.jsp"); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

19 changes: 9 additions & 10 deletions

19
[dspace-jspui/src/main/webapp/error/internal.jsp](#diff-e94c521fc0b8de392e80d94f4e720f3c887f1ffd957c80800436ab439c80a3ff "dspace-jspui/src/main/webapp/error/internal.jsp")

Show comments

[View file](/DSpace/DSpace/blob/afcc6c3389729b85d5c7b0230cbf9aaf7452f31a/dspace-jspui/src/main/webapp/error/internal.jsp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ |
|  |  | prefix="fmt" %> |
|  |  |  |
|  |  | <%@ page import="java.io.PrintWriter" %> |
|  |  | <%@ page import="org.apache.commons.lang.StringUtils" %> |
|  |  |  |
|  |  | <%@ page isErrorPage="true" %> |
|  |  |  |
| Expand All | | @@ -40,17 +41,15 @@ |
|  |  | </p> |
|  |  | <!-- |
|  |  | <% |
|  |  | Throwable ex = (Throwable) request.getAttribute("javax.servlet.error.exception"); |
|  |  | if(ex == null) out.println("No stack trace available<br/>"); |
|  |  | String exCode = (String) request.getAttribute("javax.servlet.error.code"); |
|  |  | if(StringUtils.isBlank(exCode)) { |
|  |  | out.println("No error code available"); |
|  |  | } |
|  |  | else { |
|  |  | for(Throwable t = ex ; t!=null; t = t.getCause()) |
|  |  | { |
|  |  | out.println(t.getMessage()); |
|  |  | out.println("============================================="); |
|  |  | t.printStackTrace(new PrintWriter(out)); |
|  |  | out.println("\n\n\n"); |
|  |  | } |
|  |  | } |
|  |  | out.println("System error code: " + exCode); |
|  |  | } |
|  |  | out.println("============================================="); |
|  |  | out.println("\n\n\n"); |
|  |  | %> |
|  |  | --> |
|  |  | </dspace:layout> |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `afcc6c3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fcommit%2Fafcc6c3389729b85d5c7b0230cbf9aaf7452f31a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_daa0e38e_20250114_183608.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fsecurity%2Fadvisories%2FGHSA-c2j7-66m3-r4ff)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDSpace%2FDSpace%2Fsecurity%2Fadvisories%2FGHSA-c2j7-66m3-r4ff)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=DSpace%2FDSpace)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DSpace](/DSpace)
/
**[DSpace](/DSpace/DSpace)**
Public

* [Notifications](/login?return_to=%2FDSpace%2FDSpace) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2FDSpace%2FDSpace)
* [Star
   919](/login?return_to=%2FDSpace%2FDSpace)

* [Code](/DSpace/DSpace)
* [Issues
  590](/DSpace/DSpace/issues)
* [Pull requests
  164](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects
  0](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

Additional navigation options

* [Code](/DSpace/DSpace)
* [Issues](/DSpace/DSpace/issues)
* [Pull requests](/DSpace/DSpace/pulls)
* [Actions](/DSpace/DSpace/actions)
* [Projects](/DSpace/DSpace/projects)
* [Security](/DSpace/DSpace/security)
* [Insights](/DSpace/DSpace/pulse)

# "Internal System Error" page in JSPUI prints exceptions and stack traces without sanitization

Low

[tdonohue](/tdonohue)
published
GHSA-c2j7-66m3-r4ff
Jul 29, 2022

## Package

maven

dspace-jspui
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

4.0 <= 6.3

## Patched versions

6.4

## Description

### Impact

When an "Internal System Error" occurs in the JSPUI, then entire exception (including stack trace) is available. Information in this stacktrace may be useful to an attacker in launching a more sophisticated attack. This vulnerability only impacts the JSPUI.

*This vulnerability does NOT impact the XMLUI or 7.x.*

### Patches

*DSpace 6.x:*

* Fixed in 6.4 via commit: [afcc6c3](https://github.com/DSpace/DSpace/commit/afcc6c3389729b85d5c7b0230cbf9aaf7452f31a)
* 6.x patch file: <https://github.com/DSpace/DSpace/commit/afcc6c3389729b85d5c7b0230cbf9aaf7452f31a.patch> (may be applied manually if an immediate upgrade to 6.4 or above is not possible)

*DSpace 5.x:*

* The 6.x patch file can also be applied to an older 5.x installation.
* Alternatively, you can simply apply the workaround documented below. The detailed error information embedded in `internal.jsp` is not necessary for the JSPUI to function.

#### Apply the patch to your DSpace

If at all possible, we recommend upgrading your DSpace site based on the upgrade instructions. However, if you are unable to do so, you can manually apply the above patches as follows:

1. Download the appropriate patch file to the machine where DSpace is running
2. From the `[dspace-src]` folder, apply the patch, e.g. `git apply [name-of-file].patch`
3. Now, update your DSpace site (based loosely on the Upgrade instructions). This generally involves three steps:
   1. Rebuild DSpace, e.g. `mvn -U clean package` (This will recompile all DSpace code)
   2. Redeploy DSpace, e.g. `ant update` (This will copy all updated WARs / configs to your installation directory). Depending on your setup you also may need to copy the updated WARs over to your Tomcat webapps folder.
   3. Restart Tomcat

### Workarounds

The detailed error information embedded in `internal.jsp` is not necessary for the JSPUI to function. Because this error information is also available in the `dspace.log` files, it does not need to be displayed in `internal.jsp`.

Modify your `internal.jsp`, and disable the display of the error message. This is most easily done by setting the returned exception to "null" at all times. For example, add a new line between line number 43 and 44

```
// This line should exist around line number 43
Throwable ex = (Throwable) request.getAttribute("javax.servlet.error.exception");
// Add workaround for security issue. Ensure exception is always set to null.
ex = null;
// This line should exist around line number 44
if(ex == null) out.println("No stack trace available<br/>");

```
### References

Discovered & reported by Ozkan Erdogan (Brunel University London)

### For more information

If you have any questions or comments about this advisory:

* Email us at security@dspace.org

### Severity

Low

### CVE ID

CVE-2022-31189

### Weaknesses

[CWE-209](/advisories?query=cwe%3A209)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


