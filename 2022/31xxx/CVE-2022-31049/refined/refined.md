Based on the provided information, here's a breakdown of the vulnerability associated with CVE-2022-31049:

**Root Cause of Vulnerability:**
- The `receiverName` variable, used in the password recovery email of the Extbase felogin plugin for TYPO3 CMS, was vulnerable to HTML injection due to a lack of sanitization. User-submitted content was not properly encoded in HTML emails.

**Weaknesses/Vulnerabilities Present:**
- Cross-Site Scripting (XSS) vulnerability (CWE-79) due to missing sanitization of user-controlled input.
- Improper neutralization of script-related HTML tags in a web page (CWE-74)

**Impact of Exploitation:**
- An attacker could inject malicious HTML code into the `receiverName` field. This code would then be included in the password recovery email sent to the user.
- When the user opens the email, the injected HTML could be executed by their email client, potentially allowing the attacker to perform actions like:
    - Stealing cookies or session tokens.
    - Redirecting the user to a malicious site.
    - Displaying phishing content within the email.

**Attack Vectors:**
- The attack vector is network-based.
- An attacker could exploit the vulnerability by submitting a crafted username (or other input used for `receiverName`) containing malicious HTML code through the TYPO3 frontend login form.
- The injected payload is then sent via email, and the vulnerability is triggered when the user views this email within their email client.

**Required Attacker Capabilities/Position:**
- The attacker would need to be able to interact with the frontend login form, e.g., by attempting a password recovery. This means an attacker only needs low privileges to trigger the vulnerability.
- They would need to craft a malicious HTML payload and inject it into the user-supplied input.
- The attacker relies on the user opening the email using a vulnerable mail client.

**Additional Information:**

- The vulnerability is considered a "Medium" severity issue with a CVSS score of 4.9
- The issue was fixed by passing the `receiverName` variable through the `f:format.htmlspecialchars` ViewHelper, which properly escapes HTML characters.
- Affected TYPO3 versions:
    - 9.0.0-9.5.34 ELTS
    - 10.0.0-10.4.28
    - 11.0.0-11.5.10
- Patched TYPO3 versions:
    - 9.5.35 ELTS
    - 10.4.29
    - 11.5.11