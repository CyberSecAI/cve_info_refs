```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from a lack of proper input validation in the `WishListProductSearchProvider.php` file, specifically within the `getProductsOrCount` function. The `$query->getSortOrder()->toLegacyOrderWay()` method returns a value that is not validated, leading to a SQL injection vulnerability.",
    "weaknesses": [
      "SQL Injection (CWE-89)"
    ],
    "impact": "An authenticated customer can perform SQL injection attacks, potentially leading to unauthorized access to sensitive data, data modification, or other malicious actions.",
    "attack_vectors": "Network-based attacks.",
    "required_capabilities": "The attacker needs to be an authenticated customer (low privilege)."
  },
  "additional_notes": "The vulnerability is present in versions >=2.0.0 of the prestashop/blockwishlist module and is fixed in version 2.1.1. The comments in the commit indicate that the issue arises because the `toLegacyOrderWay()` method returns an unfiltered value that is directly concatenated into the SQL query. While `toLegacyOrderWay()` itself calls `getDirection()` which is expected to return either `asc`, `desc`, or `random`, there may be a way for the attacker to inject arbitrary values and bypass these checks or the checks may be missing in some cases."
}
```