=== Content from gist.github.com_b6206a6e_20250115_135748.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fcmb69%2F7155d511152bdf40a0b2c0105c65e905)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fcmb69%2F7155d511152bdf40a0b2c0105c65e905&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fcmb69%2F7155d511152bdf40a0b2c0105c65e905) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fcmb69%2F7155d511152bdf40a0b2c0105c65e905&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=64&v=4)](/cmb69)

# [cmb69](/cmb69)/**[.patch](/cmb69/7155d511152bdf40a0b2c0105c65e905)** Secret

Created
October 18, 2022 10:14

Show Gist options

* [Download ZIP](/cmb69/7155d511152bdf40a0b2c0105c65e905/archive/4f05b98dcbba64f2b724d909346f6191fcb48503.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fcmb69%2F7155d511152bdf40a0b2c0105c65e905)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fcmb69%2F7155d511152bdf40a0b2c0105c65e905)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/cmb69/7155d511152bdf40a0b2c0105c65e905.js&quot;&gt;&lt;/script&gt;
* Save cmb69/7155d511152bdf40a0b2c0105c65e905 to your computer and use it in GitHub Desktop.

[Code](/cmb69/7155d511152bdf40a0b2c0105c65e905)
[Revisions
1](/cmb69/7155d511152bdf40a0b2c0105c65e905/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/cmb69/7155d511152bdf40a0b2c0105c65e905.js&quot;&gt;&lt;/script&gt;

Save cmb69/7155d511152bdf40a0b2c0105c65e905 to your computer and use it in GitHub Desktop.

[Download ZIP](/cmb69/7155d511152bdf40a0b2c0105c65e905/archive/4f05b98dcbba64f2b724d909346f6191fcb48503.zip)

Fix for PHP bug #81739

 [Raw](/cmb69/7155d511152bdf40a0b2c0105c65e905/raw/4f05b98dcbba64f2b724d909346f6191fcb48503/.patch)

[**.patch**](#file-patch)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | From 44c528b35be125f5ba747b1902df79915d9b663d Mon Sep 17 00:00:00 2001 |
| --- | --- |
|  | From: "Christoph M. Becker" <cmbecker69@gmx.de> |
|  | Date: Tue, 18 Oct 2022 12:13:16 +0200 |
|  | Subject: [PATCH] Fix #81739: OOB read due to insufficient validation in |
|  | imageloadfont() |
|  |  |
|  | If we swap the byte order of the relevant header bytes, we need to make |
|  | sure again that the following multiplication does not overflow. |
|  | --- |
|  | ext/gd/gd.c | 7 +++++++ |
|  | ext/gd/tests/bug81739.phpt | 24 ++++++++++++++++++++++++ |
|  | 2 files changed, 31 insertions(+) |
|  | create mode 100644 ext/gd/tests/bug81739.phpt |
|  |  |
|  | diff --git a/ext/gd/gd.c b/ext/gd/gd.c |
|  | index 336a739692..fde93bba49 100644 |
|  | --- a/ext/gd/gd.c |
|  | +++ b/ext/gd/gd.c |
|  | @@ -1485,6 +1485,12 @@ PHP\_FUNCTION(imageloadfont) |
|  | font->w = FLIPWORD(font->w); |
|  | font->h = FLIPWORD(font->h); |
|  | font->nchars = FLIPWORD(font->nchars); |
|  | + if (overflow2(font->nchars, font->h) || overflow2(font->nchars \* font->h, font->w )) { |
|  | + php\_error\_docref(NULL, E\_WARNING, "Error reading font, invalid font header"); |
|  | + efree(font); |
|  | + php\_stream\_close(stream); |
|  | + RETURN\_FALSE; |
|  | + } |
|  | body\_size = font->w \* font->h \* font->nchars; |
|  | } |
|  |  |
|  | @@ -1495,6 +1501,7 @@ PHP\_FUNCTION(imageloadfont) |
|  | RETURN\_FALSE; |
|  | } |
|  |  |
|  | + ZEND\_ASSERT(body\_size > 0); |
|  | font->data = emalloc(body\_size); |
|  | b = 0; |
|  | while (b < body\_size && (n = php\_stream\_read(stream, &font->data[b], body\_size - b)) > 0) { |
|  | diff --git a/ext/gd/tests/bug81739.phpt b/ext/gd/tests/bug81739.phpt |
|  | new file mode 100644 |
|  | index 0000000000..cc2a90381b |
|  | --- /dev/null |
|  | +++ b/ext/gd/tests/bug81739.phpt |
|  | @@ -0,0 +1,24 @@ |
|  | +--TEST-- |
|  | +Bug #81739 (OOB read due to insufficient validation in imageloadfont()) |
|  | +--SKIPIF-- |
|  | +<?php |
|  | +if (!extension\_loaded("gd")) die("skip gd extension not available"); |
|  | +?> |
|  | +--FILE-- |
|  | +<?php |
|  | +$s = fopen(\_\_DIR\_\_ . "/font.font", "w"); |
|  | +// header without character data |
|  | +fwrite($s, "\x01\x00\x00\x00\x20\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00"); |
|  | +fclose($s); |
|  | +var\_dump(imageloadfont(\_\_DIR\_\_ . "/font.font")); |
|  | +?> |
|  | +--CLEAN-- |
|  | +<?php |
|  | +@unlink(\_\_DIR\_\_ . "/font.font"); |
|  | +?> |
|  | +--EXPECTF-- |
|  | +Warning: imageloadfont(): %croduct of memory allocation multiplication would exceed INT\_MAX, failing operation gracefully |
|  | + in %s on line %d |
|  | + |
|  | +Warning: imageloadfont(): Error reading font, invalid font header in %s on line %d |
|  | +bool(false) |
|  | \ No newline at end of file |
|  | -- |
|  | 2.38.0.windows.1 |
|  |  |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fcmb69%2F7155d511152bdf40a0b2c0105c65e905)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7166b39e_20250115_135743.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

The PHP Interpreter

[www.php.net](https://www.php.net "https://www.php.net")

### License

[View license](/php/php-src/blob/master/LICENSE)

[38.5k
stars](/php/php-src/stargazers) [7.8k
forks](/php/php-src/forks) [Branches](/php/php-src/branches) [Tags](/php/php-src/tags) [Activity](/php/php-src/activity)
 [Star](/login?return_to=%2Fphp%2Fphp-src)

 [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  563](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

# php/php-src

    master[Branches](/php/php-src/branches)[Tags](/php/php-src/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[140,050 Commits](/php/php-src/commits/master/) | | |
| [.circleci](/php/php-src/tree/master/.circleci ".circleci") | | [.circleci](/php/php-src/tree/master/.circleci ".circleci") |  |  |
| [.github](/php/php-src/tree/master/.github ".github") | | [.github](/php/php-src/tree/master/.github ".github") |  |  |
| [TSRM](/php/php-src/tree/master/TSRM "TSRM") | | [TSRM](/php/php-src/tree/master/TSRM "TSRM") |  |  |
| [Zend](/php/php-src/tree/master/Zend "Zend") | | [Zend](/php/php-src/tree/master/Zend "Zend") |  |  |
| [benchmark](/php/php-src/tree/master/benchmark "benchmark") | | [benchmark](/php/php-src/tree/master/benchmark "benchmark") |  |  |
| [build](/php/php-src/tree/master/build "build") | | [build](/php/php-src/tree/master/build "build") |  |  |
| [docs-old](/php/php-src/tree/master/docs-old "docs-old") | | [docs-old](/php/php-src/tree/master/docs-old "docs-old") |  |  |
| [docs](/php/php-src/tree/master/docs "docs") | | [docs](/php/php-src/tree/master/docs "docs") |  |  |
| [ext](/php/php-src/tree/master/ext "ext") | | [ext](/php/php-src/tree/master/ext "ext") |  |  |
| [main](/php/php-src/tree/master/main "main") | | [main](/php/php-src/tree/master/main "main") |  |  |
| [pear](/php/php-src/tree/master/pear "pear") | | [pear](/php/php-src/tree/master/pear "pear") |  |  |
| [sapi](/php/php-src/tree/master/sapi "sapi") | | [sapi](/php/php-src/tree/master/sapi "sapi") |  |  |
| [scripts](/php/php-src/tree/master/scripts "scripts") | | [scripts](/php/php-src/tree/master/scripts "scripts") |  |  |
| [tests](/php/php-src/tree/master/tests "tests") | | [tests](/php/php-src/tree/master/tests "tests") |  |  |
| [win32](/php/php-src/tree/master/win32 "win32") | | [win32](/php/php-src/tree/master/win32 "win32") |  |  |
| [.editorconfig](/php/php-src/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/php/php-src/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gdbinit](/php/php-src/blob/master/.gdbinit ".gdbinit") | | [.gdbinit](/php/php-src/blob/master/.gdbinit ".gdbinit") |  |  |
| [.gitattributes](/php/php-src/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/php/php-src/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/php/php-src/blob/master/.gitignore ".gitignore") | | [.gitignore](/php/php-src/blob/master/.gitignore ".gitignore") |  |  |
| [CODING\_STANDARDS.md](/php/php-src/blob/master/CODING_STANDARDS.md "CODING_STANDARDS.md") | | [CODING\_STANDARDS.md](/php/php-src/blob/master/CODING_STANDARDS.md "CODING_STANDARDS.md") |  |  |
| [CONTRIBUTING.md](/php/php-src/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/php/php-src/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [EXTENSIONS](/php/php-src/blob/master/EXTENSIONS "EXTENSIONS") | | [EXTENSIONS](/php/php-src/blob/master/EXTENSIONS "EXTENSIONS") |  |  |
| [LICENSE](/php/php-src/blob/master/LICENSE "LICENSE") | | [LICENSE](/php/php-src/blob/master/LICENSE "LICENSE") |  |  |
| [NEWS](/php/php-src/blob/master/NEWS "NEWS") | | [NEWS](/php/php-src/blob/master/NEWS "NEWS") |  |  |
| [README.REDIST.BINS](/php/php-src/blob/master/README.REDIST.BINS "README.REDIST.BINS") | | [README.REDIST.BINS](/php/php-src/blob/master/README.REDIST.BINS "README.REDIST.BINS") |  |  |
| [README.md](/php/php-src/blob/master/README.md "README.md") | | [README.md](/php/php-src/blob/master/README.md "README.md") |  |  |
| [SECURITY.md](/php/php-src/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/php/php-src/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [UPGRADING](/php/php-src/blob/master/UPGRADING "UPGRADING") | | [UPGRADING](/php/php-src/blob/master/UPGRADING "UPGRADING") |  |  |
| [UPGRADING.INTERNALS](/php/php-src/blob/master/UPGRADING.INTERNALS "UPGRADING.INTERNALS") | | [UPGRADING.INTERNALS](/php/php-src/blob/master/UPGRADING.INTERNALS "UPGRADING.INTERNALS") |  |  |
| [buildconf](/php/php-src/blob/master/buildconf "buildconf") | | [buildconf](/php/php-src/blob/master/buildconf "buildconf") |  |  |
| [buildconf.bat](/php/php-src/blob/master/buildconf.bat "buildconf.bat") | | [buildconf.bat](/php/php-src/blob/master/buildconf.bat "buildconf.bat") |  |  |
| [codecov.yml](/php/php-src/blob/master/codecov.yml "codecov.yml") | | [codecov.yml](/php/php-src/blob/master/codecov.yml "codecov.yml") |  |  |
| [configure.ac](/php/php-src/blob/master/configure.ac "configure.ac") | | [configure.ac](/php/php-src/blob/master/configure.ac "configure.ac") |  |  |
| [php.ini-development](/php/php-src/blob/master/php.ini-development "php.ini-development") | | [php.ini-development](/php/php-src/blob/master/php.ini-development "php.ini-development") |  |  |
| [php.ini-production](/php/php-src/blob/master/php.ini-production "php.ini-production") | | [php.ini-production](/php/php-src/blob/master/php.ini-production "php.ini-production") |  |  |
| [run-tests.php](/php/php-src/blob/master/run-tests.php "run-tests.php") | | [run-tests.php](/php/php-src/blob/master/run-tests.php "run-tests.php") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
* Security
[![PHP](https://camo.githubusercontent.com/d3fa29c31c08000037c47e6551b3a42e5fcde1a65b1137b6e4c346d684eb242b/68747470733a2f2f7777772e7068702e6e65742f696d616765732f6c6f676f732f6e65772d7068702d6c6f676f2e737667)](https://www.php.net)

# The PHP Interpreter

PHP is a popular general-purpose scripting language that is especially suited to
web development. Fast, flexible and pragmatic, PHP powers everything from your
blog to the most popular websites in the world. PHP is distributed under the
[PHP License v3.01](/php/php-src/blob/master/LICENSE).

[![Push](https://github.com/php/php-src/actions/workflows/push.yml/badge.svg)](https://github.com/php/php-src/actions/workflows/push.yml)
[![Fuzzing Status](https://camo.githubusercontent.com/cc47c2b6137bb74bd3ef8b0144df512d6c2e1803811f53ecda03021258d0fc86/68747470733a2f2f6f73732d66757a7a2d6275696c642d6c6f67732e73746f726167652e676f6f676c65617069732e636f6d2f6261646765732f7068702e737667)](https://bugs.chromium.org/p/oss-fuzz/issues/list?sort=-opened&can=1&q=proj:php)

## Documentation

The PHP manual is available at [php.net/docs](https://www.php.net/docs).

## Installation

### Prebuilt packages and binaries

Prebuilt packages and binaries can be used to get up and running fast with PHP.

For Windows, the PHP binaries can be obtained from
[windows.php.net](https://windows.php.net). After extracting the archive the
`*.exe` files are ready to use.

For other systems, see the [installation chapter](https://www.php.net/install).

### Building PHP source code

*For Windows, see [Build your own PHP on Windows](https://wiki.php.net/internals/windows/stepbystepbuild_sdk_2).*

For a minimal PHP build from Git, you will need autoconf, bison, and re2c. For
a default build, you will additionally need libxml2 and libsqlite3.

On Ubuntu, you can install these using:

```
sudo apt install -y pkg-config build-essential autoconf bison re2c \
                    libxml2-dev libsqlite3-dev

```

On Fedora, you can install these using:

```
sudo dnf install re2c bison autoconf make libtool ccache libxml2-devel sqlite-devel

```

Generate configure:

```
./buildconf

```

Configure your build. `--enable-debug` is recommended for development, see
`./configure --help` for a full list of options.

```
# For development
./configure --enable-debug
# For production
./configure

```

Build PHP. To speed up the build, specify the maximum number of jobs using `-j`:

```
make -j4

```

The number of jobs should usually match the number of available cores, which
can be determined using `nproc`.

## Testing PHP source code

PHP ships with an extensive test suite, the command `make test` is used after
successful compilation of the sources to run this test suite.

It is possible to run tests using multiple cores by setting `-jN` in
`TEST_PHP_ARGS`:

```
make TEST_PHP_ARGS=-j4 test

```

Shall run `make test` with a maximum of 4 concurrent jobs: Generally the maximum
number of jobs should not exceed the number of cores available.

The [qa.php.net](https://qa.php.net) site provides more detailed info about
testing and quality assurance.

## Installing PHP built from source

After a successful build (and test), PHP may be installed with:

```
make install

```

Depending on your permissions and prefix, `make install` may need super user
permissions.

## PHP extensions

Extensions provide additional functionality on top of PHP. PHP consists of many
essential bundled extensions. Additional extensions can be found in the PHP
Extension Community Library - [PECL](https://pecl.php.net).

## Contributing

The PHP source code is located in the Git repository at
[github.com/php/php-src](https://github.com/php/php-src). Contributions are most
welcome by forking the repository and sending a pull request.

Discussions are done on GitHub, but depending on the topic can also be relayed
to the official PHP developer mailing list internals@lists.php.net.

New features require an RFC and must be accepted by the developers. See
[Request for comments - RFC](https://wiki.php.net/rfc) and
[Voting on PHP features](https://wiki.php.net/rfc/voting) for more information
on the process.

Bug fixes don't require an RFC. If the bug has a GitHub issue, reference it in
the commit message using `GH-NNNNNN`. Use `#NNNNNN` for tickets in the old
[bugs.php.net](https://bugs.php.net) bug tracker.

```
Fix GH-7815: php_uname doesn't recognise latest Windows versions
Fix #55371: get_magic_quotes_gpc() throws deprecation warning

```

See [Git workflow](https://wiki.php.net/vcs/gitworkflow) for details on how pull
requests are merged.

### Guidelines for contributors

See further documents in the repository for more information on how to
contribute:

* [Contributing to PHP](/php/php-src/blob/master/CONTRIBUTING.md)
* [PHP coding standards](/php/php-src/blob/master/CODING_STANDARDS.md)
* [Internal documentation](https://php.github.io/php-src/)
* [Mailing list rules](/php/php-src/blob/master/docs/mailinglist-rules.md)
* [PHP release process](/php/php-src/blob/master/docs/release-process.md)

## Credits

For the list of people who've put work into PHP, please see the
[PHP credits page](https://www.php.net/credits.php).

## About

The PHP Interpreter

[www.php.net](https://www.php.net "https://www.php.net")

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/php/php-src/activity)
[Custom properties](/php/php-src/custom-properties)
### Stars

[**38.5k**
stars](/php/php-src/stargazers)
### Watchers

[**1.4k**
watching](/php/php-src/watchers)
### Forks

[**7.8k**
forks](/php/php-src/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src&report=php+%28user%29)

## [Releases 3](/php/php-src/releases)

[PHP 8.4.2
Latest

Dec 20, 2024](/php/php-src/releases/tag/php-8.4.2)
[+ 2 releases](/php/php-src/releases)

## [Contributors 975](/php/php-src/graphs/contributors)

* [![@dstogov](https://avatars.githubusercontent.com/u/2510034?s=64&v=4)](https://github.com/dstogov)
* [![@nikic](https://avatars.githubusercontent.com/u/216080?s=64&v=4)](https://github.com/nikic)
* [![@weltling](https://avatars.githubusercontent.com/u/22016?s=64&v=4)](https://github.com/weltling)
* [![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=64&v=4)](https://github.com/cmb69)
* [![@laruence](https://avatars.githubusercontent.com/u/382813?s=64&v=4)](https://github.com/laruence)
* [![@tony2001](https://avatars.githubusercontent.com/u/42386?s=64&v=4)](https://github.com/tony2001)
* [![@smalyshev](https://avatars.githubusercontent.com/u/155000?s=64&v=4)](https://github.com/smalyshev)
* [![@pierrejoye](https://avatars.githubusercontent.com/u/282408?s=64&v=4)](https://github.com/pierrejoye)
* [![@felipensp](https://avatars.githubusercontent.com/u/773947?s=64&v=4)](https://github.com/felipensp)
* [![@nielsdos](https://avatars.githubusercontent.com/u/7771979?s=64&v=4)](https://github.com/nielsdos)
* [![@zsuraski](https://avatars.githubusercontent.com/u/2006098?s=64&v=4)](https://github.com/zsuraski)
* [![@faizshukri](https://avatars.githubusercontent.com/u/1219518?s=64&v=4)](https://github.com/faizshukri)
* [![@remicollet](https://avatars.githubusercontent.com/u/270445?s=64&v=4)](https://github.com/remicollet)
* [![@krakjoe](https://avatars.githubusercontent.com/u/2236138?s=64&v=4)](https://github.com/krakjoe)

[+ 961 contributors](/php/php-src/graphs/contributors)

## Languages

* [C
  67.0%](/php/php-src/search?l=c)
* [PHP
  30.8%](/php/php-src/search?l=php)
* [C++
  0.6%](/php/php-src/search?l=c%2B%2B)
* [M4
  0.4%](/php/php-src/search?l=m4)
* [Shell
  0.3%](/php/php-src/search?l=shell)
* [Lua
  0.3%](/php/php-src/search?l=lua)
* Other
  0.6%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a25eb5c7_20250115_135747.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2F88b603768f8e5074ad5cbdccc1e0779089fac9d0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2F88b603768f8e5074ad5cbdccc1e0779089fac9d0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.5k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  737](/php/php-src/issues)
* [Pull requests
  563](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Commit

[Permalink](/php/php-src/commit/88b603768f8e5074ad5cbdccc1e0779089fac9d0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

imageloadfont: Perform overflow check before calculation

[Browse files](/php/php-src/tree/88b603768f8e5074ad5cbdccc1e0779089fac9d0)
Browse the repository at this point in the history

```
Instead of afterwards...
```

* Loading branch information

[![@nikic](https://avatars.githubusercontent.com/u/216080?s=40&v=4)](/nikic)

[nikic](/php/php-src/commits?author=nikic "View all commits by nikic")
committed
Jun 19, 2019

1 parent
[2a9fc31](/php/php-src/commit/2a9fc310211eb0ed5ee2b2954a57c49c17c7e6a7)

commit 88b6037

Showing
**1 changed file**
with
**7 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

14 changes: 7 additions & 7 deletions

14
[ext/gd/gd.c](#diff-00d1efef2247b288c86a6c3bfefac111a4774fbc5453fdc02dcf36c4a23da283 "ext/gd/gd.c")

Show comments

[View file](/php/php-src/blob/88b603768f8e5074ad5cbdccc1e0779089fac9d0/ext/gd/gd.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1443,6 +1443,13 @@ PHP\_FUNCTION(imageloadfont) |
|  |  | body\_size\_check = php\_stream\_tell(stream) - hdr\_size; |
|  |  | php\_stream\_seek(stream, i, SEEK\_SET); |
|  |  |  |
|  |  | if (overflow2(font->nchars, font->h) || overflow2(font->nchars \* font->h, font->w )) { |
|  |  | php\_error\_docref(NULL, E\_WARNING, "Error reading font, invalid font header"); |
|  |  | efree(font); |
|  |  | php\_stream\_close(stream); |
|  |  | RETURN\_FALSE; |
|  |  | } |
|  |  |  |
|  |  | body\_size = font->w \* font->h \* font->nchars; |
|  |  | if (body\_size != body\_size\_check) { |
|  |  | font->w = FLIPWORD(font->w); |
| Expand All | | @@ -1451,13 +1458,6 @@ PHP\_FUNCTION(imageloadfont) |
|  |  | body\_size = font->w \* font->h \* font->nchars; |
|  |  | } |
|  |  |  |
|  |  | if (overflow2(font->nchars, font->h) || overflow2(font->nchars \* font->h, font->w )) { |
|  |  | php\_error\_docref(NULL, E\_WARNING, "Error reading font, invalid font header"); |
|  |  | efree(font); |
|  |  | php\_stream\_close(stream); |
|  |  | RETURN\_FALSE; |
|  |  | } |
|  |  |  |
|  |  | if (body\_size != body\_size\_check) { |
|  |  | php\_error\_docref(NULL, E\_WARNING, "Error reading font"); |
|  |  | efree(font); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `88b6037`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2F88b603768f8e5074ad5cbdccc1e0779089fac9d0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.php.net_dc1fd3ea_20250115_095540.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Sec Bug](bug.php?id=81739) #81739 | OOB read due to insufficient input validation in imageloadfont() | | | | | | --- | --- | --- | --- | --- | --- | | Submitted: | 2022-10-12 16:13 UTC | Modified: | 2022-10-24 00:58 UTC |  | | From: | cmb@php.net | Assigned: | [stas](search.php?cmd=display&assign=stas) ([profile](https://people.php.net/stas)) | | Status: | Closed | Package: | [GD related](search.php?cmd=display&package_name[]=GD+related) | | PHP Version: | 7.4Git-2022-10-12 (Git) | OS: | \* | | Private report: | No | CVE-ID: | [2022-31630](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31630) |   View [Developer](bug.php?id=81739&edit=1) [Edit](bug.php?id=81739&edit=2)   **[2022-10-12 16:13 UTC] [cmb@php.net](//people.php.net/cmb)** ``` Description: ------------ It is possible to construct font files supposed to be loaded by imageloadfont() which trigger OOB reads if the fonts are actually accessed (e.g. by imagechar()).  The given test scripts exploits that by triggering the assignment of a zero byte memory allocation to gdFont.data (which is happily accepted by imageloadfont()), and to read beyond this "buffer" when calling imagechar().  So if an application allows to upload arbitrary font files and working with these, it is likely vulnerable.   Test script: --------------- <?php  $s = fopen(__DIR__ . "/font.font", "w"); // header without character data fwrite($s, "\x01\x00\x00\x00\x20\x00\x00\x00\x08\x00\x00\x00\x08\x00\x00\x00"); fclose($s); $font = imageloadfont(__DIR__ . "/font.font"); $im = imagecreate(10, 10); imagechar($im, $font, 0, 0, " ", imagecolorallocate($im, 255, 255, 255));   Actual result: -------------- OOB read (not unlikely resulting in a segfault, but could be worse).   ``` PatchesPull Requests Pull requests:  * [Generate correct links for <type> elements](https://github.com/php/phd/pull/33)   (phd/33) HistoryAllCommentsChangesGit/SVN commitsRelated reports  **[2022-10-12 16:14 UTC] [cmb@php.net](//people.php.net/cmb)** -Assigned To: +Assigned To: cmb **[2022-10-12 18:17 UTC] [stas@php.net](//people.php.net/stas)** -CVE-ID: +CVE-ID: needed **[2022-10-18 10:17 UTC] [cmb@php.net](//people.php.net/cmb)** -Assigned To: cmb +Assigned To: stas **[2022-10-18 10:17 UTC] [cmb@php.net](//people.php.net/cmb)** ``` This issue has been introduced with commit 88b6037[1], so versions prior to PHP 7.4.0 are not affected.  We could simply revert that commit, but maybe it is better to duplicate the overflow check to avoid confusion.  Suggested patch: <<https://gist.github.com/cmb69/7155d511152bdf40a0b2c0105c65e905>>.  When merging the test into PHP-8.1, please replace the --SKIPIF-- section with --EXTENSIONS-- gd  [1] <<https://github.com/php/php-src/commit/88b603768f8e5074ad5cbdccc1e0779089fac9d0>>  ``` **[2022-10-24 00:44 UTC] [stas@php.net](//people.php.net/stas)** -CVE-ID: needed +CVE-ID: 2022-31630 **[2022-10-24 00:58 UTC] [stas@php.net](//people.php.net/stas)** -Status: Assigned +Status: Closed **[2022-10-24 00:58 UTC] [stas@php.net](//people.php.net/stas)** ``` The fix for this bug has been committed. If you are still experiencing this bug, try to check out latest source from <https://github.com/php/php-src> and re-test. Thank you for the report, and for helping us make PHP better.    ``` **[2023-08-29 01:04 UTC] tinocofa1220 at gmail dot com** ``` The following pull request has been associated:  Patch Name: Generate correct links for <type> elements On GitHub:  <https://github.com/php/phd/pull/33> Patch:      <https://github.com/php/phd/pull/33.patch>  ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Wed Jan 15 09:01:28 2025 UTC |



=== Content from github.com_cf5937aa_20250115_135750.html ===
From 85332bf7123eabef3a6414055f6d78e1ed9a54ea Mon Sep 17 00:00:00 2001
From: George Peter Banyard
Date: Fri, 13 Nov 2020 15:36:00 +0000
Subject: [PATCH 1/6] Link types to their own type page/section
---
phpdotnet/phd/Package/PHP/XHTML.php | 6 ++++++
1 file changed, 6 insertions(+)
diff --git a/phpdotnet/phd/Package/PHP/XHTML.php b/phpdotnet/phd/Package/PHP/XHTML.php
index 50f52131..c75e242d 100644
--- a/phpdotnet/phd/Package/PHP/XHTML.php
+++ b/phpdotnet/phd/Package/PHP/XHTML.php
@@ -541,6 +541,10 @@ public function format\_type\_text($type, $tagname) {
case "double":
$href = "language.types.float";
break;
+ // old name for callable
+ case "callback":
+ $href = "language.types.callable";
+ break;
case "boolean":
case "integer":
case "float":
@@ -557,6 +561,8 @@ public function format\_type\_text($type, $tagname) {
$href = "language.types.$t";
break;
case "mixed":
+ case "void":
+ case "static":
$href = "language.types.declarations";
$fragment = "language.types.declarations.$t";
break;
From 6e0bb4df34c51b009421a89035a111ff2c79300a Mon Sep 17 00:00:00 2001
From: George Peter Banyard
Date: Fri, 13 Nov 2020 15:42:13 +0000
Subject: [PATCH 2/6] Always format type elements so that they link to their
type page
---
phpdotnet/phd/Package/PHP/XHTML.php | 10 +++++-----
1 file changed, 5 insertions(+), 5 deletions(-)
diff --git a/phpdotnet/phd/Package/PHP/XHTML.php b/phpdotnet/phd/Package/PHP/XHTML.php
index c75e242d..94fe8556 100644
--- a/phpdotnet/phd/Package/PHP/XHTML.php
+++ b/phpdotnet/phd/Package/PHP/XHTML.php
@@ -107,13 +107,13 @@ abstract class Package\_PHP\_XHTML extends Package\_Generic\_XHTML {
),
'refname' => 'format\_refname\_text',
'type' => array(
- /\* DEFAULT \*/ 'format\_type\_if\_object\_or\_pseudo\_text',
+ /\* DEFAULT \*/ 'format\_type\_text',
'classsynopsisinfo' => false,
- 'fieldsynopsis' => 'format\_type\_if\_object\_or\_pseudo\_text',
- 'methodparam' => 'format\_type\_if\_object\_or\_pseudo\_text',
+ 'fieldsynopsis' => 'format\_type\_text',
+ 'methodparam' => 'format\_type\_text',
'methodsynopsis' => 'format\_type\_methodsynopsis\_text',
'type' => array(
- /\* DEFAULT \*/ 'format\_type\_if\_object\_or\_pseudo\_text',
+ /\* DEFAULT \*/ 'format\_type\_text',
'methodsynopsis' => 'format\_type\_methodsynopsis\_text',
),
),
@@ -486,7 +486,7 @@ public function format\_methodsynopsis($open, $name, $attrs, $props) {
}
foreach ($this->cchunk["methodsynopsis"]["returntypes"] as $return\_type) {
- $formatted\_type = self::format\_type\_if\_object\_or\_pseudo\_text($return\_type, "type");
+ $formatted\_type = self::format\_type\_text($return\_type, "type");
if ($formatted\_type === false) {
$formatted\_type = $return\_type;
}
From 4018eeed7722d87ba9d7ac7362fa8278552f02c1 Mon Sep 17 00:00:00 2001
From: George Peter Banyard
Date: Tue, 27 Jul 2021 00:38:26 +0200
Subject: [PATCH 3/6] Drop types which should not be handled there
---
phpdotnet/phd/Package/PHP/XHTML.php | 6 ------
1 file changed, 6 deletions(-)
diff --git a/phpdotnet/phd/Package/PHP/XHTML.php b/phpdotnet/phd/Package/PHP/XHTML.php
index 94fe8556..2f1884d7 100644
--- a/phpdotnet/phd/Package/PHP/XHTML.php
+++ b/phpdotnet/phd/Package/PHP/XHTML.php
@@ -541,10 +541,6 @@ public function format\_type\_text($type, $tagname) {
case "double":
$href = "language.types.float";
break;
- // old name for callable
- case "callback":
- $href = "language.types.callable";
- break;
case "boolean":
case "integer":
case "float":
@@ -561,8 +557,6 @@ public function format\_type\_text($type, $tagname) {
$href = "language.types.$t";
break;
case "mixed":
- case "void":
- case "static":
$href = "language.types.declarations";
$fragment = "language.types.declarations.$t";
break;
From de0a65705dce65368e3592faaac81f72f3e143b7 Mon Sep 17 00:00:00 2001
From: George Peter Banyard
Date: Tue, 27 Jul 2021 00:43:08 +0200
Subject: [PATCH 4/6] Remove format\_type\_if\_object\_or\_pseudo\_text() function
---
phpdotnet/phd/Package/PHP/XHTML.php | 12 ------------
1 file changed, 12 deletions(-)
diff --git a/phpdotnet/phd/Package/PHP/XHTML.php b/phpdotnet/phd/Package/PHP/XHTML.php
index 2f1884d7..d0e50bc9 100644
--- a/phpdotnet/phd/Package/PHP/XHTML.php
+++ b/phpdotnet/phd/Package/PHP/XHTML.php
@@ -515,18 +515,6 @@ public function format\_type\_methodsynopsis\_text($type, $tagname) {
return "";
}
- public function format\_type\_if\_object\_or\_pseudo\_text($type, $tagname) {
- if (strtolower($type) === "null" && $this->simple\_nullable) {
- return "";
- }
-
- if (in\_array(strtolower($type), array("bool", "int", "double", "boolean", "integer", "float", "string", "array", "object", "resource", "null"))) {
- return false;
- }
-
- return self::format\_type\_text($type, $tagname);
- }
-
public function format\_type\_text($type, $tagname) {
$t = strtr(strtolower($type), ["\_" => "-", "\\" => "-"]);
$href = $fragment = "";
From 49b2b7d634888137b8c1ca6a4f67cad5b1b438c7 Mon Sep 17 00:00:00 2001
From: George Peter Banyard
Date: Tue, 27 Jul 2021 01:38:07 +0200
Subject: [PATCH 5/6] Add link to null for simple nullable types
---
phpdotnet/phd/Package/PHP/XHTML.php | 7 ++++++-
1 file changed, 6 insertions(+), 1 deletion(-)
diff --git a/phpdotnet/phd/Package/PHP/XHTML.php b/phpdotnet/phd/Package/PHP/XHTML.php
index d0e50bc9..81e04819 100644
--- a/phpdotnet/phd/Package/PHP/XHTML.php
+++ b/phpdotnet/phd/Package/PHP/XHTML.php
@@ -482,7 +482,12 @@ public function format\_methodsynopsis($open, $name, $attrs, $props) {
) {
$this->simple\_nullable = true;
$this->type\_separator = "";
- $types[] = '?';
+
+ if ($this->chunked) {
+ $types[] = '[?](language.types.null%27%20.%20%24this-%3EgetExt%28%29.%20%27)';
+ } else {
+ $types[] = '[?](#language.types.null)';
+ }
}
foreach ($this->cchunk["methodsynopsis"]["returntypes"] as $return\_type) {
From 263f953b0cfce6d2a6e631b31ac765c75f4aeeb8 Mon Sep 17 00:00:00 2001
From: George Peter Banyard
Date: Thu, 29 Jul 2021 01:28:14 +0200
Subject: [PATCH 6/6] Maybe fix generation for nullable types
---
phpdotnet/phd/Package/PHP/XHTML.php | 7 ++++++-
1 file changed, 6 insertions(+), 1 deletion(-)
diff --git a/phpdotnet/phd/Package/PHP/XHTML.php b/phpdotnet/phd/Package/PHP/XHTML.php
index 81e04819..5eb66318 100644
--- a/phpdotnet/phd/Package/PHP/XHTML.php
+++ b/phpdotnet/phd/Package/PHP/XHTML.php
@@ -331,7 +331,12 @@ public function format\_type($open, $tag, $attrs, $props) {
) {
$this->simple\_nullable = true;
$this->type\_separator = "";
- $retval .= '?';
+
+ if ($this->chunked) {
+ $retval .= '[?](language.types.null%27%20.%20%24this-%3EgetExt%28%29.%20%27)';
+ } else {
+ $retval .= '[?](#language.types.null)';
+ }
} else {
$this->type\_separator = $isUnionType ? "|" : "&";
}


=== Content from github.com_176629f3_20250115_135746.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphd%2Fpull%2F33)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphd%2Fpull%2F33)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=php%2Fphd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[phd](/php/phd)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphd) You must be signed in to change notification settings
* [Fork
  49](/login?return_to=%2Fphp%2Fphd)
* [Star
   77](/login?return_to=%2Fphp%2Fphd)

* [Code](/php/phd)
* [Issues
  10](/php/phd/issues)
* [Pull requests
  6](/php/phd/pulls)
* [Actions](/php/phd/actions)
* [Security](/php/phd/security)
* [Insights](/php/phd/pulse)

Additional navigation options

* [Code](/php/phd)
* [Issues](/php/phd/issues)
* [Pull requests](/php/phd/pulls)
* [Actions](/php/phd/actions)
* [Security](/php/phd/security)
* [Insights](/php/phd/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fphp%2Fphd%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fphp%2Fphd%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Generate correct links for <type> elements #33

 Closed

[Girgias](/Girgias)
wants to merge
6
commits into
[php:master](/php/phd/tree/master "php/phd:master")
from
[Girgias:link-new-type-decl-page](/Girgias/phd/tree/link-new-type-decl-page "Girgias/phd:link-new-type-decl-page")

 Closed

# [Generate correct links for <type> elements](#top) #33

[Girgias](/Girgias)
wants to merge
6
commits into
[php:master](/php/phd/tree/master "php/phd:master")
from
[Girgias:link-new-type-decl-page](/Girgias/phd/tree/link-new-type-decl-page "Girgias/phd:link-new-type-decl-page")

[Conversation
19](/php/phd/pull/33)
[Commits
6](/php/phd/pull/33/commits)
[Checks
0](/php/phd/pull/33/checks)
[Files changed](/php/phd/pull/33/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![Girgias](https://avatars.githubusercontent.com/u/7906688?s=60&v=4)](/Girgias)

Copy link

Member

### @Girgias **[Girgias](/Girgias)** commented [Nov 13, 2020](#issue-742550591)

 *No description provided.*

Sorry, something went wrong.

All reactions

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=80&u=7ec59f5ef95aa5b3f78fa7c0556425e44feb97e9&v=4)](/cmb69)

Copy link

Member

### **[cmb69](/cmb69)** commented [Jul 24, 2021](#issuecomment-886064756)

| Could you please rebase? |
| --- |

All reactions

Sorry, something went wrong.

 [![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&u=efacb80aba882e3f6c252d23767ccf4dfff90b26&v=4)](/Girgias)
[Girgias](/Girgias)
[force-pushed](/php/phd/compare/bb6997d0accbbe8fc2781995b0b5d1572e05743b..6b08acb3c28cd79f822e56015589cb8fdde4070b)
the
link-new-type-decl-page

branch
from
[`bb6997d`](/php/phd/commit/bb6997d0accbbe8fc2781995b0b5d1572e05743b) to
[`6b08acb`](/php/phd/commit/6b08acb3c28cd79f822e56015589cb8fdde4070b)  [Compare](/php/phd/compare/bb6997d0accbbe8fc2781995b0b5d1572e05743b..6b08acb3c28cd79f822e56015589cb8fdde4070b)
[July 24, 2021 22:31](#event-5064430840)

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=80&u=efacb80aba882e3f6c252d23767ccf4dfff90b26&v=4)](/Girgias)

Copy link

Member

Author

### **[Girgias](/Girgias)** commented [Jul 24, 2021](#issuecomment-886118895) • edited Loading

| Done the rebase and did some clean-up for the support for `void` at the same time (and add `static` although unlikely).  I also don't really understand the purpose of the `format_type_if_object_or_pseudo_text()` function. |
| --- |

All reactions

Sorry, something went wrong.

[![cmb69](https://avatars.githubusercontent.com/u/2306138?s=60&v=4)](/cmb69)

**[cmb69](/cmb69)**
reviewed
[Jul 26, 2021](#pullrequestreview-714742887)

 [View reviewed changes](/php/phd/pull/33/files)

[phpdotnet/phd/Package/PHP/XHTML.php](/php/phd/pull/33/files#diff-c372d6edb12a842ef8a20b14089597d81f1b11f5e0fb7f98f9f305528b133ef5)
Outdated

Show resolved

Hide resolved

[![cmb69](https://avatars.githubusercontent.com/u/2306138?s=60&v=4)](/cmb69)

**[cmb69](/cmb69)**
reviewed
[Jul 26, 2021](#pullrequestreview-714743009)

 [View reviewed changes](/php/phd/pull/33/files)

[phpdotnet/phd/Package/PHP/XHTML.php](/php/phd/pull/33/files#diff-c372d6edb12a842ef8a20b14089597d81f1b11f5e0fb7f98f9f305528b133ef5)
Outdated

Show resolved

Hide resolved

[![kocsismate](https://avatars.githubusercontent.com/u/6057627?s=60&v=4)](/kocsismate)

**[kocsismate](/kocsismate)**
reviewed
[Jul 26, 2021](#pullrequestreview-714755430)

 [View reviewed changes](/php/phd/pull/33/files)

[phpdotnet/phd/Package/PHP/XHTML.php](/php/phd/pull/33/files#diff-c372d6edb12a842ef8a20b14089597d81f1b11f5e0fb7f98f9f305528b133ef5)
Outdated

|  |  | @@ -500,6 +504,8 @@ public function format\_type\_text($type, $tagname) { | |
| --- | --- | --- | --- |
|  |  | $href = "language.types.$t"; |
|  |  | break; |
|  |  | case "mixed": |
|  |  | case "void": |

Copy link

Member

### @kocsismate **[kocsismate](/kocsismate)** [Jul 26, 2021](#discussion_r676535906)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

There's a `format_void()` methodas well, which apparently renders void return types.

Sorry, something went wrong.

All reactions

Copy link

Member

### @kocsismate **[kocsismate](/kocsismate)** [Jul 26, 2021](#discussion_r676537224) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Also, I added 2 `<span class="type">?</span>` tags yesterday, which IMO should be updated as well

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @Girgias **[Girgias](/Girgias)** [Jul 26, 2021](#discussion_r676602260)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Hum, I don't really know how to do this frankly, because from my understanding this works on the XML? So I would imagine it gets initially rendered with links like `A|null` before getting transformed again?

And I'll drop void then, didn't know it was already handled

Sorry, something went wrong.

All reactions

Copy link

Member

### @kocsismate **[kocsismate](/kocsismate)** [Jul 26, 2021](#discussion_r676612089)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

yeah, phd converts XML to HTML, but in case of simple nullable types, I had to discard the render of the null subtype, and insert a `<span class="type">?</span>` before the other subtype of the union type gets rendered. So what I wanted to ask you is to add the href directly to these HTML tags as well.

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @Girgias **[Girgias](/Girgias)** [Jul 26, 2021](#discussion_r676648472)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Can you point me to where to the name of this function?

Sorry, something went wrong.

All reactions

Load more…

Copy link

Member

Author

### @Girgias **[Girgias](/Girgias)** [Jul 26, 2021](#discussion_r677014067)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

`format_type()` doesn't call `format_type_text()` so I didn't update it as I imagine this is already not displaying links.

Sorry, something went wrong.

All reactions

Copy link

Member

### @kocsismate **[kocsismate](/kocsismate)** [Jul 27, 2021](#discussion_r677210342)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

`format_type()` is only called for rendering the tag itself, but `format_type_text()` is automatically called for the text inside the type tags. Now, that you changed `format_methodsynopsis()`, `?` has the link at the return type positions, but since `format_type_text()` was left out, `?` at parameter positions`are missing the links.

Sorry, something went wrong.

All reactions

Copy link

Member

### @kocsismate **[kocsismate](/kocsismate)** [Jul 27, 2021](#discussion_r677211817)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

There's still another problem with simple nullable parameters:

```
/* Methods */
public __construct(
    ? $locale,
    int $dateType,
    int $timeType,
    IntlTimeZone|DateTimeZone|string|null $timezone = null,
    IntlCalendar|int|null $calendar = null,
    string $pattern = ""
)

```

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @Girgias **[Girgias](/Girgias)** [Jul 28, 2021](#discussion_r678718598)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Frankly I do not understand how the fuck these method call happen, so I have no clue if what I'm doing makes any sense. When I opened this PR initially it was just after a commit which broke the generation of the links, so I looked at this and tried to fix it. But I have ZERO understanding of PhD, and just trying to figure out how shit works here is... painful.

Sorry, something went wrong.

All reactions

Copy link

Member

### @kocsismate **[kocsismate](/kocsismate)** [Jul 29, 2021](#discussion_r679089229)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It's a bit better now: `?` characters both at the parameter as well as the return type position have the link. However, neither `void`, not `false` have them. As mentioned previously, you can add the link directly to the former one at phpdotnet/phd/Package/Generic/XHTML.php:1045, but I'm not sure what to do with `false`.

In order to fix the issue with the disappearing type in case of simple nullable types, you have to apply the following patch:

```
Index: phpdotnet/phd/Package/PHP/XHTML.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/phpdotnet/phd/Package/PHP/XHTML.php b/phpdotnet/phd/Package/PHP/XHTML.php
--- a/phpdotnet/phd/Package/PHP/XHTML.php	(revision e64f1141d524e7ad56e0a88c5cf161cfe5a6341d)
+++ b/phpdotnet/phd/Package/PHP/XHTML.php	(date 1627560074288)
@@ -546,12 +546,14 @@
         case "array":
         case "object":
         case "resource":
+        case "callable":
+        case "iterable":
+            $href = "language.types.$t";
+            break;
         case "null":
             if ($this->simple_nullable) {
                 return "";
             }
-        case "callable":
-        case "iterable":
             $href = "language.types.$t";
             break;
         case "mixed":

```

Sorry, something went wrong.

All reactions

[phpdotnet/phd/Package/PHP/XHTML.php](/php/phd/pull/33/files#diff-c372d6edb12a842ef8a20b14089597d81f1b11f5e0fb7f98f9f305528b133ef5)

|  |  | @@ -442,7 +442,7 @@ public function format\_methodsynopsis($open, $name, $attrs, $props) { | |
| --- | --- | --- | --- |
|  |  | if ($this->cchunk["methodsynopsis"]["returntypes"]) { |
|  |  | $types = []; |
|  |  | foreach ($this->cchunk["methodsynopsis"]["returntypes"] as $return\_type) { |
|  |  | $formatted\_type = self::format\_type\_if\_object\_or\_pseudo\_text($return\_type, "type"); |

Copy link

Member

### @kocsismate **[kocsismate](/kocsismate)** [Jul 26, 2021](#discussion_r676539044)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I believe `phpdotnet\phd\Package_PHP_XHTML::format_type_if_object_or_pseudo_text` is not used anywhere else so itcan be removed

Sorry, something went wrong.

All reactions

 [Girgias](/Girgias)
added 5 commits
[July 27, 2021 01:18](#commits-pushed-85332bf)

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&v=4)](/Girgias)

`[Link types to their own type page/section](/php/phd/pull/33/commits/85332bf7123eabef3a6414055f6d78e1ed9a54ea "Link types to their own type page/section")`

`[85332bf](/php/phd/pull/33/commits/85332bf7123eabef3a6414055f6d78e1ed9a54ea)`

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&v=4)](/Girgias)

`[Always format type elements so that they link to their type page](/php/phd/pull/33/commits/6e0bb4df34c51b009421a89035a111ff2c79300a "Always format type elements so that they link to their type page")`

`[6e0bb4d](/php/phd/pull/33/commits/6e0bb4df34c51b009421a89035a111ff2c79300a)`

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&v=4)](/Girgias)

`[Drop types which should not be handled there](/php/phd/pull/33/commits/4018eeed7722d87ba9d7ac7362fa8278552f02c1 "Drop types which should not be handled there")`

`[4018eee](/php/phd/pull/33/commits/4018eeed7722d87ba9d7ac7362fa8278552f02c1)`

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&v=4)](/Girgias)

`[Remove format_type_if_object_or_pseudo_text() function](/php/phd/pull/33/commits/de0a65705dce65368e3592faaac81f72f3e143b7 "Remove format_type_if_object_or_pseudo_text() function")`

`[de0a657](/php/phd/pull/33/commits/de0a65705dce65368e3592faaac81f72f3e143b7)`

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&v=4)](/Girgias)

`[Add link to null for simple nullable types](/php/phd/pull/33/commits/49b2b7d634888137b8c1ca6a4f67cad5b1b438c7 "Add link to null for simple nullable types")`

`[49b2b7d](/php/phd/pull/33/commits/49b2b7d634888137b8c1ca6a4f67cad5b1b438c7)`

 [![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&u=efacb80aba882e3f6c252d23767ccf4dfff90b26&v=4)](/Girgias)
[Girgias](/Girgias)
[force-pushed](/php/phd/compare/6b08acb3c28cd79f822e56015589cb8fdde4070b..49b2b7d634888137b8c1ca6a4f67cad5b1b438c7)
the
link-new-type-decl-page

branch
from
[`6b08acb`](/php/phd/commit/6b08acb3c28cd79f822e56015589cb8fdde4070b) to
[`49b2b7d`](/php/phd/commit/49b2b7d634888137b8c1ca6a4f67cad5b1b438c7)  [Compare](/php/phd/compare/6b08acb3c28cd79f822e56015589cb8fdde4070b..49b2b7d634888137b8c1ca6a4f67cad5b1b438c7)
[July 26, 2021 23:38](#event-5071250927)

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&v=4)](/Girgias)

`[Maybe fix generation for nullable types](/php/phd/pull/33/commits/263f953b0cfce6d2a6e631b31ac765c75f4aeeb8 "Maybe fix generation for nullable types")`

`[263f953](/php/phd/pull/33/commits/263f953b0cfce6d2a6e631b31ac765c75f4aeeb8)`

[![kocsismate](https://avatars.githubusercontent.com/u/6057627?s=60&v=4)](/kocsismate)

**[kocsismate](/kocsismate)**
reviewed
[Jul 29, 2021](#pullrequestreview-717995658)

 [View reviewed changes](/php/phd/pull/33/files/263f953b0cfce6d2a6e631b31ac765c75f4aeeb8)

[phpdotnet/phd/Package/PHP/XHTML.php](/php/phd/pull/33/files/263f953b0cfce6d2a6e631b31ac765c75f4aeeb8#diff-c372d6edb12a842ef8a20b14089597d81f1b11f5e0fb7f98f9f305528b133ef5)

|  |  | } |
| --- | --- | --- |
|  |  |  |
|  |  | foreach ($this->cchunk["methodsynopsis"]["returntypes"] as $return\_type) { |
|  |  | $formatted\_type = self::format\_type\_if\_object\_or\_pseudo\_text($return\_type, "type"); |
|  |  | $formatted\_type = self::format\_type\_text($return\_type, "type"); |
|  |  | if ($formatted\_type === false) { |

Copy link

Member

### @kocsismate **[kocsismate](/kocsismate)** [Jul 29, 2021](#discussion_r679077821)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

a false return is impossible now

Sorry, something went wrong.

All reactions

[phpdotnet/phd/Package/PHP/XHTML.php](/php/phd/pull/33/files#diff-c372d6edb12a842ef8a20b14089597d81f1b11f5e0fb7f98f9f305528b133ef5)
Outdated

|  |  | @@ -500,6 +504,8 @@ public function format\_type\_text($type, $tagname) { | |
| --- | --- | --- | --- |
|  |  | $href = "language.types.$t"; |
|  |  | break; |
|  |  | case "mixed": |
|  |  | case "void": |

Copy link

Member

### @kocsismate **[kocsismate](/kocsismate)** [Jul 29, 2021](#discussion_r679089229)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It's a bit better now: `?` characters both at the parameter as well as the return type position have the link. However, neither `void`, not `false` have them. As mentioned previously, you can add the link directly to the former one at phpdotnet/phd/Package/Generic/XHTML.php:1045, but I'm not sure what to do with `false`.

In order to fix the issue with the disappearing type in case of simple nullable types, you have to apply the following patch:

```
Index: phpdotnet/phd/Package/PHP/XHTML.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/phpdotnet/phd/Package/PHP/XHTML.php b/phpdotnet/phd/Package/PHP/XHTML.php
--- a/phpdotnet/phd/Package/PHP/XHTML.php	(revision e64f1141d524e7ad56e0a88c5cf161cfe5a6341d)
+++ b/phpdotnet/phd/Package/PHP/XHTML.php	(date 1627560074288)
@@ -546,12 +546,14 @@
         case "array":
         case "object":
         case "resource":
+        case "callable":
+        case "iterable":
+            $href = "language.types.$t";
+            break;
         case "null":
             if ($this->simple_nullable) {
                 return "";
             }
-        case "callable":
-        case "iterable":
             $href = "language.types.$t";
             break;
         case "mixed":

```

Sorry, something went wrong.

All reactions

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&u=efacb80aba882e3f6c252d23767ccf4dfff90b26&v=4)](/Girgias)
[Girgias](/Girgias)
mentioned this pull request
[Jul 31, 2022](#ref-pullrequest-1321455276)

[Rewrite type section
php/doc-en#1726](/php/doc-en/pull/1726)
 Merged

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&u=efacb80aba882e3f6c252d23767ccf4dfff90b26&v=4)](/Girgias)
[Girgias](/Girgias)
mentioned this pull request
[Feb 7, 2024](#ref-pullrequest-2123064301)

[Fix tests
#91](/php/phd/pull/91)
 Merged

[![@haszi](https://avatars.githubusercontent.com/u/13745441?s=40&v=4)](/haszi)
[haszi](/haszi)
mentioned this pull request
[Feb 11, 2024](#ref-pullrequest-2129179590)

[Add links to type tags
#94](/php/phd/pull/94)
 Merged

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=80&u=efacb80aba882e3f6c252d23767ccf4dfff90b26&v=4)](/Girgias)

Copy link

Member

Author

### **[Girgias](/Girgias)** commented [Feb 13, 2024](#issuecomment-1942056418)

| Closed in favour of [#94](https://github.com/php/phd/pull/94) |
| --- |

All reactions

Sorry, something went wrong.

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&u=efacb80aba882e3f6c252d23767ccf4dfff90b26&v=4)](/Girgias)
[Girgias](/Girgias)
closed this
[Feb 13, 2024](#event-11791988265)

 [![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=40&u=efacb80aba882e3f6c252d23767ccf4dfff90b26&v=4)](/Girgias)
[Girgias](/Girgias)
deleted the
link-new-type-decl-page

branch
[February 13, 2024 17:26](#event-11791988709)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphd%2Fpull%2F33)

Reviewers

[![@kocsismate](https://avatars.githubusercontent.com/u/6057627?s=40&v=4)](/kocsismate) [kocsismate](/kocsismate)

kocsismate left review comments

[![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=40&v=4)](/cmb69) [cmb69](/cmb69)

cmb69 left review comments

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@Girgias](https://avatars.githubusercontent.com/u/7906688?s=52&v=4)](/Girgias) [![@cmb69](https://avatars.githubusercontent.com/u/2306138?s=52&v=4)](/cmb69) [![@kocsismate](https://avatars.githubusercontent.com/u/6057627?s=52&v=4)](/kocsismate)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from people.php.net_5e3d1783_20250115_135749.html ===


[![php](//php.net/images/logo.php?people)people](/)

* [Manage](https://main.php.net/manage/users.php)
* [Help](https://wiki.php.net/web/people)

# Stanislav Malyshev

## stas

![Picture of Stanislav Malyshev](//www.gravatar.com/avatar/2abfb1613a54da98d2ad76907550d6eb.jpg?s=460)

* stas@php.net
* [0 open bugs assigned](https://bugs.php.net/search.php?cmd=display&order_by=ts2&direction=DESC&status=Open&assign=stas)
* [edit on main](https://main.php.net/manage/users.php?username=stas)

﻿

* [Copyright © 2001-2025 The PHP Group](//php.net/copyright)
* [Other PHP.net sites](//php.net/sites)
* [Privacy policy](//php.net/privacy)


