=== Content from www.openwall.com_4cb3f227_20250114_213738.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2023/02/04/1) [[thread-next>]](../../../2023/02/04/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Y91yP6mYIZ+UXmgf@alf.mars>
Date: Fri, 3 Feb 2023 21:44:47 +0100
From: Helmut Grohne <helmut@...divi.de>
To: oss-security@...ts.openwall.com
Subject: sox: patches for old vulnerabilities

Hi,

I am working on fixing known vulnerabilities in sox and since upstream
seems mostly dead (no commits in more than a year, no replies to bug
reports), I am posting my results here. My work on sox is compensated by
Freexian SARL.

I located two distinct memory leaks.

The fix for CVE-2017-11358 introduced a regression. Reading any hcom
file would result in an error. This made the test suite fail, but since
nobody seems to run the test suite, this ended up being shipped in e.g.
multiple Debian releases.

On 64bit big endian systems, a 64bit integer is incorrectly truncated to
the upper 32bits. This subsequently causes an assertion failure or a
stack overflow in a -DNDEBUG build. This issue also breaks the test
suite. I do not think that this is exploitable and do not intend to
request a CVE.

I'm attaching patches for these as well as patches for the following
vulnerabilities:
 * CVE-2021-3643 and CVE-2021-23210
 * CVE-2021-23159 and CVE-2021-23172
 * CVE-2021-33844
 * CVE-2021-40426
 * CVE-2022-31650
 * CVE-2022-31651

I welcome reviews and propose adding these patches to distributions that
ship sox. I will upload these patches to Debian.

Please Cc me in replies.

Helmut

View attachment "[fix-resource-leak-comments.patch](3/1)" of type "text/x-diff" (314 bytes)

View attachment "[fix-resource-leak-hcom.patch](3/2)" of type "text/x-diff" (1445 bytes)

View attachment "[fix-regression-in-CVE-2017-11358.patch](3/3)" of type "text/x-diff" (1833 bytes)

View attachment "[fix-hcom-big-endian.patch](3/4)" of type "text/x-diff" (1023 bytes)

View attachment "[CVE-2021-23159.patch](3/5)" of type "text/x-diff" (737 bytes)

View attachment "[CVE-2021-33844.patch](3/6)" of type "text/x-diff" (1102 bytes)

View attachment "[CVE-2021-3643.patch](3/7)" of type "text/x-diff" (652 bytes)

View attachment "[CVE-2021-40426.patch](3/8)" of type "text/x-diff" (822 bytes)

View attachment "[CVE-2022-31650.patch](3/9)" of type "text/x-diff" (1642 bytes)

View attachment "[CVE-2022-31651.patch](3/10)" of type "text/x-diff" (859 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.debian.org_3b0fb8cb_20250114_213738.html ===


---

[[Date Prev](msg00008.html)][[Date Next](msg00010.html)]
[[Thread Prev](msg00008.html)][[Thread Next](msg00010.html)]
[[Date Index](maillist.html#00009)]
[[Thread Index](threads.html#00009)]

# [SECURITY] [DLA 3315-1] sox security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3315-1] sox security update
* *From*: Helmut Grohne <helmut@subdivi.de>
* *Date*: Fri, 10 Feb 2023 07:10:28 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/Y%2BXf1FIzV3r9LCf0%40alf.mars)Â [Y+Xf1FIzV3r9LCf0@alf.mars](msg00009.html)>
* *Mail-followup-to*: Helmut Grohne <helmut@subdivi.de>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3315-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Helmut Grohne
February 10, 2023                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : sox
Version        : 14.4.2+git20190427-1+deb10u1
CVE ID         : CVE-2019-13590 CVE-2021-3643 CVE-2021-23159 CVE-2021-23172
                 CVE-2021-23210 CVE-2021-33844 CVE-2021-40426 CVE-2022-31650
                 CVE-2022-31651
Debian Bug     : 933372 1010374 1012138 1012516 1021133 1021134 1021135

This update fixes multiple file format validation vulnerabilities that could
result in memory access violations such as buffer overflows and floating point
exceptions. It also fixes a regression in hcom parsing introduced when fixing
CVE-2017-11358.

CVE-2019-13590

    In sox-fmt.h (startread function), there is an integer overflow on the
    result of integer addition (wraparound to 0) fed into the lsx_calloc macro
    that wraps malloc. When a NULL pointer is returned, it is used without a
    prior check that it is a valid pointer, leading to a NULL pointer
    dereference on lsx_readbuf in formats_i.c.

CVE-2021-3643

    The lsx_adpcm_init function within libsox leads to a
    global-buffer-overflow. This flaw allows an attacker to input a malicious
    file, leading to the disclosure of sensitive information.

CVE-2021-23159

    A vulnerability was found in SoX, where a heap-buffer-overflow occurs
    in function lsx_read_w_buf() in formats_i.c file. The vulnerability is
    exploitable with a crafted file, that could cause an application to
    crash.

CVE-2021-23172

    A vulnerability was found in SoX, where a heap-buffer-overflow occurs
    in function startread() in hcom.c file. The vulnerability is
    exploitable with a crafted hcomn file, that could cause an application
    to crash.

CVE-2021-23210

    A floating point exception (divide-by-zero) issue was discovered in
    SoX in functon read_samples() of voc.c file. An attacker with a
    crafted file, could cause an application to crash.

CVE-2021-33844

    A floating point exception (divide-by-zero) issue was discovered in
    SoX in functon startread() of wav.c file. An attacker with a crafted
    wav file, could cause an application to crash.

CVE-2021-40426

    A heap-based buffer overflow vulnerability exists in the sphere.c
    start_read() functionality of Sound Exchange libsox. A specially-crafted
    file can lead to a heap buffer overflow. An attacker can provide a
    malicious file to trigger this vulnerability.

CVE-2022-31650

    There is a floating-point exception in lsx_aiffstartwrite in aiff.c.

CVE-2022-31651

    There is an assertion failure in rate_init in rate.c.

For Debian 10 buster, these problems have been fixed in version
14.4.2+git20190427-1+deb10u1.

We recommend that you upgrade your sox packages.

For the detailed security status of sox please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/sox>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpu6zlgGb8Vg.pgp)**

*Description:* PGP signature

---



=== Content from www.debian.org_fbffa963_20250114_213739.html ===


---

[[Date Prev](msg00044.html)][[Date Next](msg00046.html)]
[[Thread Prev](msg00044.html)][[Thread Next](msg00046.html)]
[[Date Index](maillist.html#00045)]
[[Thread Index](threads.html#00045)]

# [SECURITY] [DSA 5356-1] sox security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5356-1] sox security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Mon, 20 Feb 2023 19:08:52 +0000
* *Message-id*: <Y/PFRPGRXqeQ02Ys@seger.debian.org>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5356-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
February 20, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : sox
CVE ID         : CVE-2021-3643 CVE-2021-23159 CVE-2021-23172 CVE-2021-23210
                 CVE-2021-33844 CVE-2021-40426 CVE-2022-31650 CVE-2022-31651
Debian Bug     : 1010374 1012138 1012516 1021133 1021134 1021135

Multiple security issues were discovered in Sox, the Swiss Army knife of
sound processing programs, which could result in denial of service or
potentially the execution of arbitrary code if a malformed audio file
is processed.

For the stable distribution (bullseye), these problems have been fixed in
version 14.4.2+git20190427-2+deb11u1.

We recommend that you upgrade your sox packages.

For the detailed security status of sox please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/sox>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmPzxOgACgkQEMKTtsN8
TjYaEhAAlz/kw36CztzPYWoje596qLuQKtTWW6AHLRvE1jOcum2ymDmEqePfjg+b
HXQPGGhU8Fd6StyXFnqrCW7pvrhcIcQNYZfUqvTcmIlOTdumyZxpoIBaRIk7m68H
MFd7o0Nc7/fJpHyAw4Oobn+kyZj1Tf3uoiHrqZS45RUG02jIIKV+7rkYxE7qIzHi
HiS9IBIpeBGljQ4RyLZ+eyNNQuF+7X7Ep29aym6l2nsOSHkDZETvpHKj+4TrMPvZ
QLQJ3hrbPoTIHQtsWWbDX8WD3NwXOBRCXwxIOlnXhjiFN5Toc7x0YB0mTdzmXYQ8
LWex4xDYtM/tJE4oipCV3/iD/c/d9Q3F0y1ielQeVuA6YEdTkLp1RoBUkMeWhXIy
LoDjmOdzNIHPX/8EfPSup83Adwv7Py8g7ZbNWj/FRhUjtpP8j54TD8y3uHQkPmoN
E6UXylMOkckcIO/RjrbNLCWhvtJ3xgTwWZCGurbkA4okVvXvOyS6h+A77OW5CkDq
Xh3hRlsHjsvhjJc5J504r0r4fBulfkrnegoDJEzl9LvPIFtXmx6HZlkVuzMam30o
7neR5Rw2cPd8l0uMsJXevW6xBMB42eAUXd2bhmw7iXNUIOVxZaGMspgHxhI8dkSb
GxmPtBNaUQqtcqSRTzSoKVqkD/rarnjUnMStvxeGd6X1PUU7qJw=
=+n6U
-----END PGP SIGNATURE-----

```

---


