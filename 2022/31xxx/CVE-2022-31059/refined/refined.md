The provided content relates to CVE-2022-31059.

**Root cause of vulnerability:**
The vulnerability stems from the improper handling of event names within the Discourse Calendar plugin. Specifically, event names were not being correctly escaped during parsing and rendering.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS):  The lack of proper escaping of event names allows for the injection of malicious scripts, leading to XSS vulnerabilities.

**Impact of exploitation:**
- An attacker could inject malicious JavaScript code into event names, which would then be executed in the browsers of users viewing the calendar. This could lead to various impacts, including but not limited to:
  - Stealing user session cookies
  - Redirecting users to malicious websites
  - Defacing the website
  - Performing actions on behalf of the user

**Attack vectors:**
- Network: An attacker could exploit this vulnerability by creating or editing an event with a malicious name.

**Required attacker capabilities/position:**
- The attacker needs to have the ability to create or edit events within the Discourse Calendar plugin. This usually requires high privileges on the forum where the calendar is used.
- This vulnerability only affects sites which have modified or disabled Discourse’s default Content Security Policy (CSP).

**Additional details:**
- The vulnerability was patched by correctly escaping the event name in the plugin’s code, as shown in the provided commit diffs.
- A database migration was also added to unescape existing event names.
- The fix also includes escaping the `topic_title` in the notification widgets, not just the event names.
- The CVSS score is 6.5, with high confidentiality and integrity impact.
- The attack complexity is low, no user interaction is required and the attacker requires high privileges.