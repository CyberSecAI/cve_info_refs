The provided content discusses two related vulnerabilities in Umbraco CMS, CVE-2022-22690 and CVE-2022-22691. This analysis focuses on CVE-2022-22691 as requested.

**CVE-2022-22691:**

*   **Root Cause:** The vulnerability stems from how Umbraco CMS handles the "ApplicationUrl" configuration. Specifically, it uses the host header from the incoming HTTP request to determine the application URL when the "UmbracoApplicationUrl" is not explicitly set. This allows an attacker to manipulate the host header and poison password reset URLs.
*   **Weaknesses/Vulnerabilities:**
    *   **Lack of Input Validation/Sanitization:** The `GetApplicationUrlFromCurrentRequest` function directly uses the `request.Host` value from the HTTP request without validation.
    *   **Improper URL Handling:** The application uses this attacker-controlled URL to construct password reset links.
*   **Impact of Exploitation:**
    *   **Password Reset Poisoning:** An attacker can manipulate the "ApplicationUrl" to point to their server. When a user initiates a password reset, the generated reset URL will contain the attacker's server address. The attacker can then intercept the password reset token when the user clicks the malicious link, leading to account takeover.
    * **Unexpected Password Reset Emails:** The password reset process can be triggered on behalf of a user with a malicious hostname set. The user will receive an unexpected password reset email containing a malicious link, which if clicked, results in the users token being intercepted
*   **Attack Vectors:**
    *   The attacker sends a crafted HTTP request to the Umbraco server with a malicious host header.
*   **Required Attacker Capabilities/Position:**
    *   The attacker needs to be able to send HTTP requests to the Umbraco server.
    *   The IIS server must not have bindings configured to restrict the permitted hostnames, allowing requests with arbitrary host headers to be processed.

**Additional Notes:**
*   The article mentions that a partial fix was introduced in Umbraco version 9.2.0, where password reset and user invites no longer use the cached ApplicationUrl, but instead regenerate it each time. However, it also notes that this is not a complete fix as the password reset process could be invoked on behalf of a user with a malicious hostname set. Additionally, some areas such as content notifications, healthcheck notifications, and the keep-alive task remain vulnerable.
*   A complete fix is to explicitly set the `UmbracoApplicationUrl` within the Umbraco configuration or to specify a specific hostname in the IIS bindings to prevent exploitation.
*   The content provides more details than the official CVE description by detailing the vulnerable code, the attack process, and the fixes.