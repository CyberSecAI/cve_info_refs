The provided content relates to CVE-2022-22762.

**Root cause of vulnerability:**
The vulnerability is caused by a timing issue in how Firefox for Android handles JavaScript dialogs (alerts or prompts) after a 302 redirect to a data: URI. The browser was not dismissing all dialog prompts on navigation, only the last one, leading to the possibility of multiple prompts being displayed concurrently.

**Weaknesses/vulnerabilities present:**
- Improper handling of JavaScript dialog prompts during page navigation.
- Failure to dismiss all dialog prompts when navigating away from a page.
- Race condition that can lead to multiple prompts being displayed simultaneously.

**Impact of exploitation:**
- Displaying spoofed JavaScript alerts or prompts over another domain.
- Potential for social engineering attacks by misleading users with fake prompts seemingly originating from a trusted domain.
- Displaying prompts that could ask for user input.

**Attack vectors:**
- A malicious website redirects the browser to a data: URI using a 302 redirect.
- The data: URI contains JavaScript that generates multiple dialog prompts.
- The user may interact with the prompts or the tab could be restored after a browser restart.

**Required attacker capabilities/position:**
- The attacker needs to host a website that can redirect the user to a crafted data: URI.
- The attacker needs to craft the data: URI to include JavaScript for generating multiple dialog prompts.

**Additional details:**
- The vulnerability primarily impacts Firefox for Android.
- The issue can be reproduced by clicking "Try Again" on the error page after the initial redirect, or when the tab is restored after a cold start.
- The timing issue is more likely to be reproducible on slower devices.
- The fix involves keeping track of all dialog prompts created and dismissing all of them on navigation, instead of just the last one.
- The severity of the vulnerability was initially considered low, but later elevated by the reporter to moderate due to potential data exfiltration via prompts.
- A patch was implemented and released in Firefox 97 to address this vulnerability.