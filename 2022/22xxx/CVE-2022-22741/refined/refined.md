The provided content relates to CVE-2022-22741.

**Root cause of vulnerability:**
- When resizing a popup window while it is requesting fullscreen access, the window loses track of its fullscreen state due to a bug in the window widget. This causes the browser to fail to exit fullscreen mode when the user attempts to.

**Weaknesses/vulnerabilities present:**
- The browser fails to exit fullscreen mode after resizing the window with `window.resizeBy()` or `resizeTo()`.
- The fullscreen notification is hidden, making it more difficult for the user to realize they are in fullscreen mode.
- The "esc" key is blocked from exiting fullscreen, however other keyboard shortcuts still function, such as "ctrl+w"

**Impact of exploitation:**
- The user is trapped in fullscreen mode, unable to exit without using workarounds like alt-tabbing to a different window.
- A malicious site can obscure the browser's UI, leading to potential spoofing attacks.
- This vulnerability leads to a denial-of-service type issue due to the user being unable to exit fullscreen mode.

**Attack vectors:**
- A malicious website could open a popup window.
- The website would then use JavaScript to call `requestFullScreen` on the popup window.
- Then, the website would use `window.resizeBy()` or `resizeTo()` to resize the popup.

**Required attacker capabilities/position:**
- The attacker needs to be able to host a malicious website.
- The attacker needs to be able to execute JavaScript on the victim's browser.
- The attacker needs to be able to open a popup window.
- The vulnerability only affects Firefox on Windows.