Based on the provided information, here's a breakdown of the vulnerability described in CVE-2022-22748:

**Root Cause of Vulnerability:**
- The vulnerability stems from how Firefox handles server-side redirects to external protocol handlers. When a website redirects to an external protocol (like `ms-calculator:`), the browser displays a dialog asking the user for permission to open the external application. However, instead of showing the origin of the redirecting URL, it incorrectly displays the origin of the initiating page.

**Weaknesses/Vulnerabilities Present:**
- **Origin Spoofing:** The primary weakness is the ability to spoof the origin displayed in the external protocol launch dialog. This can trick users into believing the dialog is coming from a trusted site, even when it's initiated by a malicious one.
- **Bypassing Security Protections:** The vulnerability can bypass common protections like CSP and iframe sandboxing in most scenarios.
- **Lack of Proper Handling for Redirects to External Protocols**:  Firefox did not properly handle server-side redirects to external protocols.

**Impact of Exploitation:**
- **Deception:** Attackers can trick users into launching malicious applications by spoofing the origin of the launch dialog.
- **Unintended Application Execution:** This vulnerability could lead to users unintentionally launching applications they did not intend to open, potentially allowing malicious code execution.
- **Bypassing User Consent:** If the user has previously selected "Always allow {origin} to open {protocol} links" option, or if allowed via enterprise policy, no user interaction is needed for exploitation.

**Attack Vectors:**
- **Link Clicks:** A malicious link on a website that redirects to an external protocol can trigger the spoofed dialog when clicked by a user.
- **JavaScript Redirects:** A website can use `window.location` or `window.open()` to redirect to an external protocol, which will display the dialog with the spoofed origin.
- **IFrames:**  An attacker could embed a malicious iframe, which then redirects to an external protocol, causing the dialog to show the origin of the parent page rather than the iframe's content.
- **Server Side Redirects:** The vulnerability relies on the server redirecting the request to an external protocol, which triggers the malicious behaviour.

**Required Attacker Capabilities/Position:**
- **Malicious Website:** The attacker needs to control or have access to a website (or part of a website) that can perform the redirect to an external protocol.
- **User Interaction:** In most cases the attack requires the user to click a link or interact with the malicious website, unless "Always allow..." options are enabled.
- **Knowledge of External Protocols**: The attacker needs to know which external protocols they want to use, in order to exploit the vulnerability.

**Additional Notes**
- The bug report mentions that the behavior is reproducible in other browsers, which implies a general issue in how browsers handle redirects to external protocols.
-  The fix involves using the origin of the last server serving a redirect or the initiating document when there is no redirect. This is to ensure the dialog shows the correct origin instead of the origin of the first page that started the navigation chain.