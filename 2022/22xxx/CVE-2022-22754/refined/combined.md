=== Content from www.mozilla.org_0e94bf8d_20250114_234737.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-05

## Security Vulnerabilities fixed in Firefox ESR 91.6

Announced
February 8, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.6

#### [#CVE-2022-22753: Privilege Escalation to SYSTEM on Windows via Maintenance Service](#CVE-2022-22753)

Reporter
Seb Patane
Impact
high
##### Description

A Time-of-Check Time-of-Use bug existed in the Maintenance (Updater) Service that could be abused to grant Users write access to an arbitrary directory. This could have been used to escalate to SYSTEM access.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1732435](https://bugzilla.mozilla.org/show_bug.cgi?id=1732435)

#### [#CVE-2022-22754: Extensions could have bypassed permission confirmation during update](#CVE-2022-22754)

Reporter
Rob Wu
Impact
high
##### Description

If a user installed an extension of a particular type, the extension could have auto-updated itself and while doing so, bypass the prompt which grants the new version the new requested permissions.

##### References

* [Bug 1750565](https://bugzilla.mozilla.org/show_bug.cgi?id=1750565)

#### [#CVE-2022-22756: Drag and dropping an image could have resulted in the dropped object being an executable](#CVE-2022-22756)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If a user was convinced to drag and drop an image to their desktop or other folder, the resulting object could have been changed into an executable script which would have run arbitrary code after the user clicked on it.

##### References

* [Bug 1317873](https://bugzilla.mozilla.org/show_bug.cgi?id=1317873)

#### [#CVE-2022-22759: Sandboxed iframes could have executed script if the parent appended elements](#CVE-2022-22759)

Reporter
Johan Carlsson
Impact
moderate
##### Description

If a document created a sandboxed iframe without `allow-scripts`, and subsequently appended an element to the iframe's document that e.g. had a JavaScript event handler - the event handler would have run despite the iframe's sandbox.

##### References

* [Bug 1739957](https://bugzilla.mozilla.org/show_bug.cgi?id=1739957)

#### [#CVE-2022-22760: Cross-Origin responses could be distinguished between script and non-script content-types](#CVE-2022-22760)

Reporter
Luan Herrera
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1740985](https://bugzilla.mozilla.org/show_bug.cgi?id=1740985)
* [Bug 1748503](https://bugzilla.mozilla.org/show_bug.cgi?id=1748503)

#### [#CVE-2022-22761: frame-ancestors Content Security Policy directive was not enforced for framed extension pages](#CVE-2022-22761)

Reporter
Mart Gil Robles (Mart at FlowCrypt)
Impact
moderate
##### Description

Web-accessible extension pages (pages with a moz-extension:// scheme) were not correctly enforcing the frame-ancestors directive when it was used in the Web Extension's Content Security Policy.

##### References

* [Bug 1745566](https://bugzilla.mozilla.org/show_bug.cgi?id=1745566)

#### [#CVE-2022-22763: Script Execution during invalid object state](#CVE-2022-22763)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

When a worker is shutdown, it was possible to cause script to run late in the lifecycle, at a point after where it should not be possible.

##### References

* [Bug 1740534](https://bugzilla.mozilla.org/show_bug.cgi?id=1740534)

#### [#CVE-2022-22764: Memory safety bugs fixed in Firefox 97 and Firefox ESR 91.6](#CVE-2022-22764)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Paul Adenot and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 96 and Firefox ESR 91.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 97 and Firefox ESR 91.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1742682%2C1744165%2C1746545%2C1748210%2C1748279)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_000817b2_20250114_234739.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-06

## Security Vulnerabilities fixed in Thunderbird 91.6

Announced
February 8, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 91.6

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2022-22753: Privilege Escalation to SYSTEM on Windows via Maintenance Service](#CVE-2022-22753)

Reporter
Seb Patane
Impact
high
##### Description

A Time-of-Check Time-of-Use bug existed in the Maintenance (Updater) Service that could be abused to grant Users write access to an arbitrary directory. This could have been used to escalate to SYSTEM access.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1732435](https://bugzilla.mozilla.org/show_bug.cgi?id=1732435)

#### [#CVE-2022-22754: Extensions could have bypassed permission confirmation during update](#CVE-2022-22754)

Reporter
Rob Wu
Impact
high
##### Description

If a user installed an extension of a particular type, the extension could have auto-updated itself and while doing so, bypass the prompt which grants the new version the new requested permissions.

##### References

* [Bug 1750565](https://bugzilla.mozilla.org/show_bug.cgi?id=1750565)

#### [#CVE-2022-22756: Drag and dropping an image could have resulted in the dropped object being an executable](#CVE-2022-22756)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If a user was convinced to drag and drop an image to their desktop or other folder, the resulting object could have been changed into an executable script which would have run arbitrary code after the user clicked on it.

##### References

* [Bug 1317873](https://bugzilla.mozilla.org/show_bug.cgi?id=1317873)

#### [#CVE-2022-22759: Sandboxed iframes could have executed script if the parent appended elements](#CVE-2022-22759)

Reporter
Johan Carlsson
Impact
moderate
##### Description

If a document created a sandboxed iframe without `allow-scripts`, and subsequently appended an element to the iframe's document that e.g. had a JavaScript event handler - the event handler would have run despite the iframe's sandbox.

##### References

* [Bug 1739957](https://bugzilla.mozilla.org/show_bug.cgi?id=1739957)

#### [#CVE-2022-22760: Cross-Origin responses could be distinguished between script and non-script content-types](#CVE-2022-22760)

Reporter
Luan Herrera
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1740985](https://bugzilla.mozilla.org/show_bug.cgi?id=1740985)
* [Bug 1748503](https://bugzilla.mozilla.org/show_bug.cgi?id=1748503)

#### [#CVE-2022-22761: frame-ancestors Content Security Policy directive was not enforced for framed extension pages](#CVE-2022-22761)

Reporter
Mart Gil Robles (Mart at FlowCrypt)
Impact
moderate
##### Description

Web-accessible extension pages (pages with a moz-extension:// scheme) were not correctly enforcing the frame-ancestors directive when it was used in the Web Extension's Content Security Policy.

##### References

* [Bug 1745566](https://bugzilla.mozilla.org/show_bug.cgi?id=1745566)

#### [#CVE-2022-22763: Script Execution during invalid object state](#CVE-2022-22763)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

When a worker is shutdown, it was possible to cause script to run late in the lifecycle, at a point after where it should not be possible.

##### References

* [Bug 1740534](https://bugzilla.mozilla.org/show_bug.cgi?id=1740534)

#### [#CVE-2022-22764: Memory safety bugs fixed in Thunderbird 91.6](#CVE-2022-22764)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Paul Adenot and the Mozilla Fuzzing Team reported memory safety bugs present in Thunderbird 91.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1742682%2C1744165%2C1746545%2C1748210%2C1748279)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_84c69bca_20250114_234736.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-04

## Security Vulnerabilities fixed in Firefox 97

Announced
February 8, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 97

#### [#CVE-2022-22753: Privilege Escalation to SYSTEM on Windows via Maintenance Service](#CVE-2022-22753)

Reporter
Seb Patane
Impact
high
##### Description

A Time-of-Check Time-of-Use bug existed in the Maintenance (Updater) Service that could be abused to grant Users write access to an arbitrary directory. This could have been used to escalate to SYSTEM access.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1732435](https://bugzilla.mozilla.org/show_bug.cgi?id=1732435)

#### [#CVE-2022-22754: Extensions could have bypassed permission confirmation during update](#CVE-2022-22754)

Reporter
Rob Wu
Impact
high
##### Description

If a user installed an extension of a particular type, the extension could have auto-updated itself and while doing so, bypass the prompt which grants the new version the new requested permissions.

##### References

* [Bug 1750565](https://bugzilla.mozilla.org/show_bug.cgi?id=1750565)

#### [#CVE-2022-22755: XSL could have allowed JavaScript execution after a tab was closed](#CVE-2022-22755)

Reporter
Jack Wrenn
Impact
moderate
##### Description

By using XSL Transforms, a malicious webserver could have served a user an XSL document that would continue to execute JavaScript (within the bounds of the same-origin policy) even after the tab was closed.

##### References

* [Bug 1309630](https://bugzilla.mozilla.org/show_bug.cgi?id=1309630)

#### [#CVE-2022-22756: Drag and dropping an image could have resulted in the dropped object being an executable](#CVE-2022-22756)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If a user was convinced to drag and drop an image to their desktop or other folder, the resulting object could have been changed into an executable script which would have run arbitrary code after the user clicked on it.

##### References

* [Bug 1317873](https://bugzilla.mozilla.org/show_bug.cgi?id=1317873)

#### [#CVE-2022-22757: Remote Agent did not prevent local websites from connecting](#CVE-2022-22757)

Reporter
James Graham
Impact
moderate
##### Description

Remote Agent, used in WebDriver, did not validate the Host or Origin headers. This could have allowed websites to connect back locally to the user's browser to control it.
*This bug only affected Firefox when WebDriver was enabled, which is not the default configuration.*

##### References

* [Bug 1720098](https://bugzilla.mozilla.org/show_bug.cgi?id=1720098)

#### [#CVE-2022-22758: tel: links could have sent USSD codes to the dialer on Firefox for Android](#CVE-2022-22758)

Reporter
Kirtikumar Anandrao Ramchandani, Patrick Walker & Eric Lawrence
Impact
moderate
##### Description

When clicking on a tel: link, USSD codes, specified after a `*` character, would be included in the phone number. On certain phones, or on certain carriers, if the number was dialed this could perform actions on a user's account, similar to a cross-site request forgery attack.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1728742](https://bugzilla.mozilla.org/show_bug.cgi?id=1728742)

#### [#CVE-2022-22759: Sandboxed iframes could have executed script if the parent appended elements](#CVE-2022-22759)

Reporter
Johan Carlsson
Impact
moderate
##### Description

If a document created a sandboxed iframe without `allow-scripts`, and subsequently appended an element to the iframe's document that e.g. had a JavaScript event handler - the event handler would have run despite the iframe's sandbox.

##### References

* [Bug 1739957](https://bugzilla.mozilla.org/show_bug.cgi?id=1739957)

#### [#CVE-2022-22760: Cross-Origin responses could be distinguished between script and non-script content-types](#CVE-2022-22760)

Reporter
Luan Herrera
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1740985](https://bugzilla.mozilla.org/show_bug.cgi?id=1740985)
* [Bug 1748503](https://bugzilla.mozilla.org/show_bug.cgi?id=1748503)

#### [#CVE-2022-22761: frame-ancestors Content Security Policy directive was not enforced for framed extension pages](#CVE-2022-22761)

Reporter
Mart Gil Robles (Mart at FlowCrypt)
Impact
moderate
##### Description

Web-accessible extension pages (pages with a moz-extension:// scheme) were not correctly enforcing the frame-ancestors directive when it was used in the Web Extension's Content Security Policy.

##### References

* [Bug 1745566](https://bugzilla.mozilla.org/show_bug.cgi?id=1745566)

#### [#CVE-2022-22762: JavaScript Dialogs could have been displayed over other domains on Firefox for Android](#CVE-2022-22762)

Reporter
James Lee
Impact
low
##### Description

Under certain circumstances, a JavaScript alert (or prompt) could have been shown while another website was displayed underneath it. This could have been abused to trick the user.
*This bug only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1743931](https://bugzilla.mozilla.org/show_bug.cgi?id=1743931)

#### [#CVE-2022-22764: Memory safety bugs fixed in Firefox 97 and Firefox ESR 91.6](#CVE-2022-22764)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Paul Adenot and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 96 and Firefox ESR 91.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 97 and Firefox ESR 91.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1742682%2C1744165%2C1746545%2C1748210%2C1748279)

#### [#CVE-2022-0511: Memory safety bugs fixed in Firefox 97](#CVE-2022-0511)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Gabriele Svelto, Sebastian Hengst, Randell Jesup, Luan Herrera, Lars T Hansen, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 96. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 97](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1713579%2C1735448%2C1743821%2C1746313%2C1746314%2C1746316%2C1746321%2C1746322%2C1746323%2C1746412%2C1746430%2C1746451%2C1746488%2C1746875%2C1746898%2C1746905%2C1746907%2C1746917%2C1747128%2C1747137%2C1747331%2C1747346%2C1747439%2C1747457%2C1747870%2C1749051%2C1749274%2C1749831)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_fa21a605_20250114_234734.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1750565)
* [XML](/show_bug.cgi?ctype=xml&id=1750565)

Closed
[Bug 1750565](/show_bug.cgi?id=1750565)
(CVE-2022-22754)

Opened 3 years ago
Closed 3 years ago

# Extension permission prompts skipped via dictionary

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Extension permission prompts skipped via dictionary

## Categories

### (Toolkit :: Add-ons Manager, defect, P1)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Add-ons%20Manager#Add-ons%20Manager)

Add-ons Manager
▾

Toolkit :: Add-ons Manager
The management and update windows for extensions and themes (add-ons).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Add-ons%20Manager)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S1

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

98 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [97+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=97%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) |
| firefox96 | [-](/buglist.cgi?f1=cf_tracking_firefox96&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix) |
| firefox97 | [+](/buglist.cgi?f1=cf_tracking_firefox97&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=fixed) |
| firefox98 | [+](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 97+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox96 | - | wontfix |
| firefox97 | + | fixed |
| firefox98 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: robwu, Assigned: robwu)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40)  [robwu](/user_profile?user_id=447061)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40)  [robwu](/user_profile?user_id=447061)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=40)  [zombie](/user_profile?user_id=445095)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1455121](/show_bug.cgi?id=1455121 "RESOLVED DUPLICATE - Prevent updates from themes to webextensions")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1753276](/show_bug.cgi?id=1753276 "NEW - Sign Dictionary Add-On types and require new addon types to be signed")

## Details

### (Keywords: csectype-priv-escalation, sec-high, Whiteboard: [sec-survey][post-critsmash-triage][adv-main97+][adv-esr91.6+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-22754

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sec-survey][post-critsmash-triage][adv-main97+][adv-esr91.6+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [aryx](/user_profile?user_id=258347) | [in-testsuite](#c17 "3 years ago") | + |
| --- | --- | --- |
| [aryx](/user_profile?user_id=258347) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Bug 1750565 - Reject addon type changes in updates](/attachment.cgi?id=9259526)  [3 years ago](#c1)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c13 "3 years ago")  diannaS : [approval-mozilla-release-](#a184572_690067 "3 years ago")  RyanVM : [approval-mozilla-esr91+](#c13 "3 years ago")  tjr : [sec-approval+](#c7 "3 years ago") | [Details](/attachment.cgi?id=9259526&action=edit) | [Review](/attachment.cgi?id=9259526) |
| --- | --- | --- |
| [Bug 1750565 - Test that addon types cannot be changed in updates](/attachment.cgi?id=9259539)  [3 years ago](#c4)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9259539&action=edit) | [Review](/attachment.cgi?id=9259539) |
| [advisory.txt](/attachment.cgi?id=9261960)  [3 years ago](#c16)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   277 bytes, text/plain |  | [Details](/attachment.cgi?id=9261960&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1750565#c0)• 3 years ago |
|  | |

Extensions should only be able to use powerful extension APIs after users have consented via a permission prompt that lists the requested permissions.

I found that these checks can be bypassed, by getting the user to install an innocent-looking (unsigned) dictionary, and then exploiting the update mechanism to convert it to a (powerful) extension.

This works because of the following implementation details:

* Auto-updates for add-ons are enabled by default
  + auto-update starts in [AddonManager.jsm's `backgroundUpdateCheck`](https://searchfox.org/mozilla-central/rev/72c7cef167829b6f1e24cae216fa261934c455fc/toolkit/mozapps/extensions/AddonManager.jsm#1330-1358)
  + manual update with a similar bug starts at [aboutaddons.js's `checkForUpdate`](https://searchfox.org/mozilla-central/rev/72c7cef167829b6f1e24cae216fa261934c455fc/toolkit/mozapps/extensions/content/aboutaddons.js#320-359)
* A code path to skip permission prompts for upgrades from legacy extensions to WebExtensions, introduced in [bug 1339552](/show_bug.cgi?id=1339552 "VERIFIED FIXED - Do not prompt with permissions when upgrading from a legacy add-on to a WebExtension version"):
  + Background updates skips prompts in [AddonManager.jsm's `_updatePromptHandler`](https://searchfox.org/mozilla-central/rev/72c7cef167829b6f1e24cae216fa261934c455fc/toolkit/mozapps/extensions/AddonManager.jsm#1265-1269)
  + Manually triggered updates skips prompts in [aboutaddonsCommon.js's `installPromptHandler`](https://searchfox.org/mozilla-central/rev/72c7cef167829b6f1e24cae216fa261934c455fc/toolkit/mozapps/extensions/content/aboutaddonsCommon.js#68-72)
* The logic that computes permissions for WebExtensions returns `null` for non-extension WebExtensions, in [Extension.jsm's `manifestPermissions` getter](https://searchfox.org/mozilla-central/rev/72c7cef167829b6f1e24cae216fa261934c455fc/toolkit/components/extensions/Extension.jsm#748-751)
* At add-on installation/updates, add-ons may freely change addon type
  + Firefox does not check `addon.type` when an update is loaded, by [XPIInstall.jsm's `loadManifest` method of `AddonInstall`](https://searchfox.org/mozilla-central/rev/72c7cef167829b6f1e24cae216fa261934c455fc/toolkit/mozapps/extensions/internal/XPIInstall.jsm#1535).
  + While AMO [prevents add-ons from changing types](https://github.com/mozilla/addons-server/blob/aaf7ef1354afa590a04b8b6c37e90f391cbff384/src/olympia/files/utils.py#L967-L971), this AMO check can be bypassed if it is possible to get the user to install an add-on that has not been submitted to AMO. That means that the add-on is not signed.
  + Signatures are required (on release) for all add-on types, except the ["dictionary" add-on type](https://searchfox.org/mozilla-central/rev/72c7cef167829b6f1e24cae216fa261934c455fc/toolkit/components/extensions/Extension.jsm#483) (because it is not listed in [SIGNED\_TYPES](https://searchfox.org/mozilla-central/rev/72c7cef167829b6f1e24cae216fa261934c455fc/toolkit/mozapps/extensions/internal/XPIDatabase.jsm#162-167)).

To reproduce this:

1. Create a `manifest.json` file with the following content. Note that I have picked an arbitrary ID from an add-on hosted on AMO (and Firefox uses AMO to check for updates by default), but I could also have added an `update_url` that points to a self-hosted update endpoint.

```
{
    "name": "Dictate crx",
    "version": "0.0.0.1",
    "manifest_version": 2,
    "dictionaries": {},
    "applications": {
        "gecko": {
            "id": "crxviewer-firefox@robwu.nl"
        }
    }
}

```

2. Create a zip file with the name `unsigned.xpi` containing the above `manifest.json` file. Note that this is an unsigned add-on.
3. Open the xpi in Firefox. Firefox shows an installation prompt, but no special warnings.
   * Note that Firefox will show an icon from the add-on from AMO, because Firefox fetches additional metadata from AMO by default.
4. Visit `about:addons`, click on the Gear icon and click on the "Check for updates" menu item.
5. Click on the "Dictionaries" list at `about:addons` and look for the above add-on, and similarly look at the "Extensions" list in `about:addons`.

Expected:

* At step 5, the "Dictionaries" list should still show the "Dictate crx" add-on (dictionary).
* Or, after step 4, the update should at least be blocked on a permission prompt.

Actual:

* At step 5, the "Dictionaries" list is empty, and the "Extensions" list shows the extension from AMO.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a16_447061)• 3 years ago |

Component: General → Add-ons ManagerProduct: WebExtensions → Toolkit

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a1426_445095)• 3 years ago |

Priority: -- → P1

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a1475_445095)• 3 years ago |

Severity: -- → S1
[tracking-firefox97](/buglist.cgi?f1=cf_tracking_firefox97&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox97&o1=equals&v1=%3F)
[tracking-firefox98](/buglist.cgi?f1=cf_tracking_firefox98&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%3F)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a1563_447061)• 3 years ago |

Assignee: nobody → robStatus: NEW → ASSIGNED

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a5719_24572)• 3 years ago |

[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=affected)
[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=affected)
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox96](/buglist.cgi?f1=cf_tracking_firefox96&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox96&o1=equals&v1=%2B)
[tracking-firefox97](/buglist.cgi?f1=cf_tracking_firefox97&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox97&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox97&o1=equals&v1=%2B)
[tracking-firefox98](/buglist.cgi?f1=cf_tracking_firefox98&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox98&o1=equals&v1=%2B)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1750565#c1)• 3 years ago |
|  | |

Attached file
[Bug 1750565 - Reject addon type changes in updates](attachment.cgi?id=9259526)
— [Details](attachment.cgi?id=9259526&action=edit)

|  | [William Durand [:willdurand]](/user_profile?user_id=603050) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1750565#c2)• 3 years ago |
|  | |

(In reply to Rob Wu [:robwu] from [comment #0](/show_bug.cgi?id=1750565#c0 "RESOLVED FIXED - Extension permission prompts skipped via dictionary"))

> While AMO prevents add-ons from changing types, this AMO check can be bypassed if it is possible to get the user to install an add-on that has not been submitted to AMO. That means that the add-on is not signed.
>
> [...]
>
> Signatures are required (on release) for all add-on types, except the "dictionary" add-on type (because it is not listed in SIGNED\_TYPES).
>
> [...]
>
> Create a zip file with the name unsigned.xpi containing the above manifest.json file. Note that this is an unsigned add-on.

This *only* works because the initial add-on is unsigned, right? But because this add-on is a dictionary, nothing prevents a user to install it as signing isn't required? As a separate task, should we sign dictionaries?

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1750565#c3)• 3 years ago |
|  | |

(In reply to William Durand [:willdurand] from [comment #2](/show_bug.cgi?id=1750565#c2 "RESOLVED FIXED - Extension permission prompts skipped via dictionary"))

> This *only* works because the initial add-on is unsigned, right? But because this add-on is a dictionary, nothing prevents a user to install it as signing isn't required?

Yes. There is of course an initial install prompt like any other, but there are no further doorhangers with permission requests.

> As a separate task, should we sign dictionaries?

Dictionaries are intentionally not signed, but I cannot find why exactly (<https://wiki.mozilla.org/Add-ons/Extension_Signing>).

I guess that signing was enforced to guard against (privileged) code execution (with some work being done to reduce the capabilities of legacy dictionaries in [bug 1193926](/show_bug.cgi?id=1193926 "RESOLVED FIXED - Don't register chrome for dictionary add-ons")).

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1750565#c4)• 3 years ago |
|  | |

Attached file
[Bug 1750565 - Test that addon types cannot be changed in updates](attachment.cgi?id=9259539)
— [Details](attachment.cgi?id=9259539&action=edit)

|  | [Andreas Wagner [:TheOne] [use NI]](/user_profile?user_id=544074) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1750565#c5)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1750565&comment_id=15737981 "1 revision") |
|  | |

I am not sure we intentionally and actually excluded dictionaries from signing. As far as I can remember, we started with extensions and extended the list from there when we saw the need. I don't have the bugs handy at the moment, but I recall for both themes and langpacks, they were specific use-cases or vulnerabilities that signing solved or mitigated.

IMHO, we should sign all add-on types and consciously exclude only when there is a strong need not to sign, rather than waiting for a need to start signing.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a99160_447061)• 3 years ago |

Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1750565#c6)• 3 years ago |
|  | |

Comment on [attachment 9259526](/attachment.cgi?id=9259526 "Bug 1750565 - Reject addon type changes in updates") [[details]](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates")

[Bug 1750565](/show_bug.cgi?id=1750565 "RESOLVED FIXED - Extension permission prompts skipped via dictionary") - Reject addon type changes in updates

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not easily. A key to exploiting the reported vulnerability is to use the dictionary addon type, which is not obvious from the patch with the fix, nor from the unit test. The unit test tests the theme->extension addon type change, which is not even possible in practice, because both addon types require signing, and AMO rejects submissions of mismatching types.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: ESR91
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely to cause regressions. Switching between add-on types is not supported, and AMO already rejects add-on submissions that switch types.
[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: sec-approval?

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a102285_447061)• 3 years ago |

[Attachment #9259539](/attachment.cgi?id=9259539&action=edit "Bug 1750565 - Test that addon types cannot be changed in updates") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1750565#c7)• 3 years ago |
|  | |

Comment on [attachment 9259526](/attachment.cgi?id=9259526 "Bug 1750565 - Reject addon type changes in updates") [[details]](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates")

[Bug 1750565](/show_bug.cgi?id=1750565 "RESOLVED FIXED - Extension permission prompts skipped via dictionary") - Reject addon type changes in updates

Approved to land and uplift.

I think it would be good to explore what defensive programming we could add to this area in a followup bug. e.g. besides just signing dictionaries (which would be a longer-term goal), instead of an opt-in SIGNED\_TYPES structure, why not an opt-out structure?

[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: sec-approval? → sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1750565#c8)• 3 years ago |
|  | |

Comment on [attachment 9259539](/attachment.cgi?id=9259539 "Bug 1750565 - Test that addon types cannot be changed in updates") [[details]](/attachment.cgi?id=9259539&action=edit "Bug 1750565 - Test that addon types cannot be changed in updates")

[Bug 1750565](/show_bug.cgi?id=1750565 "RESOLVED FIXED - Extension permission prompts skipped via dictionary") - Test that addon types cannot be changed in updates

Clearing sec-approval from the test. It can land after March 8th assuming this patches goes out in 97.

[Attachment #9259539](/attachment.cgi?id=9259539&action=edit "Bug 1750565 - Test that addon types cannot be changed in updates") -
Flags: sec-approval?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1750565#c9)• 3 years ago |
|  | |

Reject addon type changes in updates r=rpl

<https://hg.mozilla.org/integration/autoland/rev/c00713da5d85bb7ea4dfebaef729faf1a7e8dddc>

<https://hg.mozilla.org/mozilla-central/rev/c00713da5d85>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox98](/buglist.cgi?f1=cf_status_firefox98&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox98&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 98 Branch

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1750565#c10)• 3 years ago |
|  | |

Comment on [attachment 9259526](/attachment.cgi?id=9259526 "Bug 1750565 - Reject addon type changes in updates") [[details]](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates")

[Bug 1750565](/show_bug.cgi?id=1750565 "RESOLVED FIXED - Extension permission prompts skipped via dictionary") - Reject addon type changes in updates

### Beta/Release Uplift Approval Request

* **User impact if declined**: Add-ons can escalate privileges without the user's consent.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Issue is well understood; Very precise patch that fixes the problem without side effects.
* **String changes made/needed**:

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**:
* **User impact if declined**: Add-ons can escalate privileges without the user's consent.
* **Fix Landed on Version**: 98 with pending uplift to beta/release
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Issue is well understood; Very precise patch that fixes the problem without side effects.
[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: approval-mozilla-release?
[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: approval-mozilla-esr91?
[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: approval-mozilla-beta?

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1750565#c11)• 3 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1750565) to reply.

Flags: needinfo?(rob)Whiteboard: [sec-survey]

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a184572_690067)• 3 years ago |

[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: approval-mozilla-release? → approval-mozilla-release-

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1750565#c12)• 3 years ago |
|  | |

In the response to the sec-survey: static analysis could not have caught this bug.

"Are you able to summarize what pattern caused this bug?"

> Migration logic relied on incorrect assumptions. When stricter security controls were implemented, migration logic was added to silently convert from the previous insecure format for backwards-compatibility. The condition for migration was not specific enough, which allows attackers to craft a sample to abuse this logic to bypass the security controls.

In this reply,

* "security controls" refers to the extension permission system.
* "migration logic ... convert from the previous insecure format" refers to the code path to migrate from legacy extensions to WebExtensions (from bug [bug 1339552](/show_bug.cgi?id=1339552 "VERIFIED FIXED - Do not prompt with permissions when upgrading from a legacy add-on to a WebExtension version")).
* "condition for migration was not specific enough" refers to the fact that the logic was meant for legacy extensions, but the check tested the presence of permissions in a database, and did not account for the fact that there are add-on types without permissions.
* "craft a sample to abuse this logic to bypass the security controls." refers to the proof of concept from the bug report.

The use of unsigned dictionaries in the exploit has raised questions about this practice (e.g. [comment 5](/show_bug.cgi?id=1750565#c5 "RESOLVED FIXED - Extension permission prompts skipped via dictionary"), [comment 7](/show_bug.cgi?id=1750565#c7 "RESOLVED FIXED - Extension permission prompts skipped via dictionary")). While the requirement of signing for most add-on types has somewhat mitigated this bug, it is only because of [extra checks on AMO](https://github.com/mozilla/addons-server/blob/aaf7ef1354afa590a04b8b6c37e90f391cbff384/src/olympia/files/utils.py#L967-L971) that run before signing. This AMO-side check is the reason that the comparable test case in [D136238](https://phabricator.services.mozilla.com/D136238) is not a working exploit in the wild.

Flags: needinfo?(rob)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a197672_690067)• 3 years ago |

[status-firefox96](/buglist.cgi?f1=cf_status_firefox96&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox96&o1=equals&v1=wontfix)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1750565#c13)• 3 years ago |
|  | |

Comment on [attachment 9259526](/attachment.cgi?id=9259526 "Bug 1750565 - Reject addon type changes in updates") [[details]](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates")

[Bug 1750565](/show_bug.cgi?id=1750565 "RESOLVED FIXED - Extension permission prompts skipped via dictionary") - Reject addon type changes in updates

Approved for 97.0b6 and 91.6esr.

[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: approval-mozilla-esr91?
[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: approval-mozilla-esr91+
[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: approval-mozilla-beta?
[Attachment #9259526](/attachment.cgi?id=9259526&action=edit "Bug 1750565 - Reject addon type changes in updates") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1750565#c14)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/236f7fc1af37>

[status-firefox97](/buglist.cgi?f1=cf_status_firefox97&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox97&o1=equals&v1=fixed)
[tracking-firefox96](/buglist.cgi?f1=cf_tracking_firefox96&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox96&o1=equals&v1=%2B) → [-](/buglist.cgi?f1=cf_tracking_firefox96&o1=equals&v1=-)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [97+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=97%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1750565#c15)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/deb38ff00378>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a918880_488993)• 3 years ago |

Whiteboard: [sec-survey] → [sec-survey][post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a1385170_578488)• 3 years ago |

Whiteboard: [sec-survey][post-critsmash-triage] → [sec-survey][post-critsmash-triage][adv-main97+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a1396881_578488)• 3 years ago |

See Also: → [1753276](/show_bug.cgi?id=1753276 "NEW - Sign Dictionary Add-On types and require new addon types to be signed")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1750565#c16)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9261960)
— [Details](attachment.cgi?id=9261960&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a1542288_578488)• 3 years ago |

Whiteboard: [sec-survey][post-critsmash-triage][adv-main97+] → [sec-survey][post-critsmash-triage][adv-main97+][adv-esr91.6+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a1816503_578488)• 3 years ago |

Alias: CVE-2022-22754

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a10292676_1689)• 3 years ago |

Flags: in-testsuite?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1750565#c17)• 3 years ago |
|  | |

Test that addon types cannot be changed in updates r=rpl

<https://hg.mozilla.org/integration/autoland/rev/e4333eb8c6defd50546c955ca05418ccb5c5d688>

<https://hg.mozilla.org/mozilla-central/rev/e4333eb8c6de>

Flags: in-testsuite? → in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a19154348_1689)• 2 years ago |

Group: core-security-release

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1750565#a77156273_447061)• 7 months ago |

Duplicate of this bug: [1455121](/show_bug.cgi?id=1455121 "RESOLVED DUPLICATE - Prevent updates from themes to webextensions")
You need to [log in](/show_bug.cgi?id=1750565&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Rob Wu [:robwu]](/user_profile?user_id=447061)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


