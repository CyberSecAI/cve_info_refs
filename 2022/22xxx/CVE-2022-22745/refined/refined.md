Based on the provided content, here's the breakdown of CVE-2022-22745:

**Root cause of vulnerability:**
The vulnerability stems from the fact that `securitypolicyviolation` events were triggered for `frame-ancestors` violations. This resulted in the leakage of cross-origin information to the parent frame.

**Weaknesses/vulnerabilities present:**
- Cross-origin information leakage: The `securitypolicyviolation` event, when triggered by `frame-ancestors` violations, was exposing the URL of the blocked resource to the parent frame, thus violating the Same-Origin Policy.
- Improper handling of CSP violations: The browser was incorrectly generating violation reports for `frame-ancestors` in situations where it shouldn't, allowing the parent frame to gain information about the blocked resource.

**Impact of exploitation:**
- Information disclosure: An attacker could potentially gain knowledge of resources blocked by the `frame-ancestors` directive, which could reveal information about the content being loaded within the iframe or the user's browsing behavior.

**Attack vectors:**
- Malicious website: A malicious website could embed an iframe with a cross-origin resource that would violate the frame-ancestors CSP of the parent frame. By listening to the `securitypolicyviolation` event, the malicious website could extract the blocked URL.

**Required attacker capabilities/position:**
- The attacker needs to control a website that can embed an iframe.
- The attacker needs to be able to induce a `frame-ancestors` CSP violation by loading a cross-origin resource in the iframe.
- The attacker requires the ability to set up an event handler to listen for `securitypolicyviolation` events.

**Additional Notes:**
- The fix for this issue involved preventing the triggering of `securitypolicyviolation` events for `frame-ancestors` violations, which stops the cross-origin information from leaking to the parent frame.
- This vulnerability was present in Firefox and Firefox ESR. It was fixed in Firefox 96 and Firefox ESR 91.5
- Chromium had a similar issue, which was addressed prior to this fix.
- This bug was classified as a moderate severity security issue.