=== Content from github.com_1517b5ae_20250114_183029.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmoxi624%2Fmogu_blog_v2%2Fissues%2F62)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmoxi624%2Fmogu_blog_v2%2Fissues%2F62)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=moxi624%2Fmogu_blog_v2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[moxi624](/moxi624)
/
**[mogu\_blog\_v2](/moxi624/mogu_blog_v2)**
Public

* [Notifications](/login?return_to=%2Fmoxi624%2Fmogu_blog_v2) You must be signed in to change notification settings
* [Fork
  502](/login?return_to=%2Fmoxi624%2Fmogu_blog_v2)
* [Star
   1.7k](/login?return_to=%2Fmoxi624%2Fmogu_blog_v2)

* [Code](/moxi624/mogu_blog_v2)
* [Issues
  8](/moxi624/mogu_blog_v2/issues)
* [Pull requests
  41](/moxi624/mogu_blog_v2/pulls)
* [Discussions](/moxi624/mogu_blog_v2/discussions)
* [Actions](/moxi624/mogu_blog_v2/actions)
* [Projects
  0](/moxi624/mogu_blog_v2/projects)
* [Security](/moxi624/mogu_blog_v2/security)
* [Insights](/moxi624/mogu_blog_v2/pulse)

Additional navigation options

* [Code](/moxi624/mogu_blog_v2)
* [Issues](/moxi624/mogu_blog_v2/issues)
* [Pull requests](/moxi624/mogu_blog_v2/pulls)
* [Discussions](/moxi624/mogu_blog_v2/discussions)
* [Actions](/moxi624/mogu_blog_v2/actions)
* [Projects](/moxi624/mogu_blog_v2/projects)
* [Security](/moxi624/mogu_blog_v2/security)
* [Insights](/moxi624/mogu_blog_v2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmoxi624%2Fmogu_blog_v2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmoxi624%2Fmogu_blog_v2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# mogu\_blog\_v5.2 backend Management System has an vulnerability of uploading arbitrary files #62

Closed

[shitmoutainC0de](/shitmoutainC0de) opened this issue
Mar 8, 2022
· 2 comments

Closed

# [mogu\_blog\_v5.2 backend Management System has an vulnerability of uploading arbitrary files](#top) #62

[shitmoutainC0de](/shitmoutainC0de) opened this issue
Mar 8, 2022
· 2 comments

Labels
[bug](/moxi624/mogu_blog_v2/labels/bug)
Something isn't working

## Comments

[![@shitmoutainC0de](https://avatars.githubusercontent.com/u/96566383?s=80&v=4)](/shitmoutainC0de)

Copy link

### **[shitmoutainC0de](/shitmoutainC0de)** commented [Mar 8, 2022](#issue-1162310450)

| 1.Black box pentesting  Using mogu2021:mogu2021 to log in the mogu\_blog\_v5.2 backend Management System.  [image](https://user-images.githubusercontent.com/96566383/157186244-d3e77ff9-2dac-420c-bce7-b6f1ea903a8e.png)  Find the Blog Management - Blog Management - Local-file Upload feature . [image](https://user-images.githubusercontent.com/96566383/157186279-c44f2b18-29cc-4512-9ca7-87d2b58dcb7a.png)  Click this blue button to select a local image for uploading, and then click the green button to put the image to server side [image](https://user-images.githubusercontent.com/96566383/157186295-6c7d33fc-7ddb-4505-bb82-70cf9547b4a5.png)  At this point, use the burp suite to capture the request packet. [image](https://user-images.githubusercontent.com/96566383/157186319-807ba3a1-6115-4f3e-aa1b-1264bdcfeb38.png)  and then forward it to the Repeater module.  Try to send a request to upload a normal image and you can see that the image was uploaded successfully.  And the response packet returns the address information of the image. [image](https://user-images.githubusercontent.com/96566383/157186355-5fefa9e9-b1e7-4633-abfe-0a6eca6ee687.png)  Splice the address in the response packet with the url to try to access the image we just uploaded .  The whole url : [http://23.224.61.136:8600//blog/admin/png/2022/3/8/1646708813850.png](http://23.224.61.136:8600/blog/admin/png/2022/3/8/1646708813850.png)  You can see the successful access to the uploaded image. [image](https://user-images.githubusercontent.com/96566383/157186387-b708e87f-7b0f-4717-8ad2-413b9b944232.png)  Back in the burp suite, try changing the contents of the file in the request package to xss payload，as well as trying to change the file name to an html suffix. [image](https://user-images.githubusercontent.com/96566383/157186414-816ad458-60ad-41ba-a65b-994467e411e1.png)  You can see the successful upload and the file path in the response package.  Splice the file path to the url and open a new browser (without admin cookies/session/token) to try to access it.  The whole url : <http://23.224.61.136:8600///blog/admin/html/2022/3/8/1646709195222.html> [image](https://user-images.githubusercontent.com/96566383/157186425-660b69c5-d95b-448b-ac80-f9f35d5ff2f5.png)  You can see that the xss payload was successfully executed and that there is an arbitrary file to upload.  Try again to modify the request package and found that arbitrary file uploads were possible while the feature was intended to allow only image format files to be uploaded.  jsp: [image](https://user-images.githubusercontent.com/96566383/157186441-85e809eb-c339-45c8-ad83-717ff9dddb71.png)  php: [image](https://user-images.githubusercontent.com/96566383/157186469-65648b7c-42ee-4573-b728-4ad21d9b373a.png)  cpp: [image](https://user-images.githubusercontent.com/96566383/157186488-b3ac1f7e-78f6-49ad-950f-eb30a0248e37.png)  2.White box pentest  Based on the url of the image upload request (/mogu-picture/file/pictures), we can tell that the class that handles the image upload function is located in the /mogu-picture subproject [image](https://user-images.githubusercontent.com/96566383/157186502-b066b777-68a6-49d0-b32c-2bc3efa262a3.png) [image](https://user-images.githubusercontent.com/96566383/157186516-88a8ba9e-df7e-4f2b-9dc7-84dc9d8eca38.png)  According to the request url (mogu-picture/file/pictures) continue to locate the FileRestApi.java class  mogu\_blog/mogu\_blog\_v2/mogu\_picture/src/main/java/com/moxi/mogublog/picture/restapi/FileRestApi.java [image](https://user-images.githubusercontent.com/96566383/157186535-50930646-5e25-478a-9dc8-445d012e27dd.png)  With [@RequestMapping](https://github.com/RequestMapping)("/file") you can see that all requests for the /file path will be processed by this class  And requests for the /file/pictures path are handled by the uploadPics() method of this class [image](https://user-images.githubusercontent.com/96566383/157186551-4c4bdd9d-b3a9-4e09-91dd-65cf7aaf31f0.png)  This method first obtains the system configuration file, and this step does not perform any checks on the suffix name, format, or file content of the uploaded file  This method then calls the batchUploadFile() method of the FileServiceImpl class instance object [image](https://user-images.githubusercontent.com/96566383/157186616-275e42ab-9c5c-4ca3-a447-5fc37e5c6116.png)  Follow up in the batchUploadFile() method of the FileServiceImpl class to see its source code [image](https://user-images.githubusercontent.com/96566383/157186636-29b425ee-24fe-44b8-a020-3b222deeecd6.png)  The first part of the code is to get some files and system base information, none of which is file-checked  Continuing to follow up to the code for file uploads,  You can see that there is no strict verification of the uploaded file extension, file content, or file format [image](https://user-images.githubusercontent.com/96566383/157186650-1a3cba4d-e85e-4718-919d-8d16019c4107.png)  The next code execution reaches the try /catch {} block, which involves the uploadFile() method of the QiniuServiceImpl class [image](https://user-images.githubusercontent.com/96566383/157186664-b1181eaa-8056-4526-873b-cf1cb3d3cbb1.png)  Going deeper into this method leads to the uploadSingleFile() method. [image](https://user-images.githubusercontent.com/96566383/157186678-c5d3f4fb-966a-4923-bbc3-540a57ddd20c.png)  You can see that the file suffix, file format and file content are still not strictly verified.  Back in the batchUploadFile() method of the FileServiceImpl class,  After checking the code after , not only the code for uploading the QiNiu server did not have strict file verification, but also the code for uploading Minio server and the code for uploading to the local server was not strictly verified.  Finally, in the batchUploadFile() method of the FileServiceImpl class, the following code will be executed. [image](https://user-images.githubusercontent.com/96566383/157186701-aa19fa04-a502-4139-936e-0790957da957.png)  Set the information of the uploaded file to some settings.  Then save and upload feedback to the client response file.  The entire code execution process does not strictly check the suffix name, file format, and file content of the uploaded files.  This allows attackers to use the file upload interface to upload arbitrary files and even insert xss payloads. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@moxi624](https://avatars.githubusercontent.com/u/18610136?s=80&u=9e6ce7ab9a1d2f6eb8467ed3c4a2afba3d142607&v=4)](/moxi624)

Copy link

Owner

### **[moxi624](/moxi624)** commented [Jun 5, 2022](#issuecomment-1146752985)

| I'm really sorry that I just noticed this issue recently. There may still be a problem with the background interface of uploading avatar. The format uploaded by users is not strictly verified, and only the front-end is used for processing. I will fix this problem recently. Thank you again for your kind feedback. This problem is the same as the other one, and I will try to fix it together：[#65](https://github.com/moxi624/mogu_blog_v2/issues/65) |
| --- |

All reactions

Sorry, something went wrong.

[![@moxi624](https://avatars.githubusercontent.com/u/18610136?s=40&u=9e6ce7ab9a1d2f6eb8467ed3c4a2afba3d142607&v=4)](/moxi624)
[moxi624](/moxi624)
added
the
[bug](/moxi624/mogu_blog_v2/labels/bug)
Something isn't working
label
[Jun 5, 2022](#event-6743254579)

[moxi624](/moxi624)
added a commit
that referenced
this issue
[Jun 5, 2022](#ref-commit-2d9eb94)
[![@moxi624](https://avatars.githubusercontent.com/u/18610136?s=40&u=9e6ce7ab9a1d2f6eb8467ed3c4a2afba3d142607&v=4)](/moxi624)

`[fix：图片上传接口增加格式校验；](/moxi624/mogu_blog_v2/commit/2d9eb941cda8fd168f9447cd6b4262f31f074d92 "fix：图片上传接口增加格式校验；https://github.com/moxi624/mogu_blog_v2/issues/62")[#62](https://github.com/moxi624/mogu_blog_v2/issues/62)`

`[2d9eb94](/moxi624/mogu_blog_v2/commit/2d9eb941cda8fd168f9447cd6b4262f31f074d92)`

[![@moxi624](https://avatars.githubusercontent.com/u/18610136?s=80&u=9e6ce7ab9a1d2f6eb8467ed3c4a2afba3d142607&v=4)](/moxi624)

Copy link

Owner

### **[moxi624](/moxi624)** commented [Jun 5, 2022](#issuecomment-1146766254)

| Checking the file format on the back end should solve the problem you mentioned： [2d9eb94](https://github.com/moxi624/mogu_blog_v2/commit/2d9eb941cda8fd168f9447cd6b4262f31f074d92) |
| --- |

All reactions

Sorry, something went wrong.

[![@moxi624](https://avatars.githubusercontent.com/u/18610136?s=40&u=9e6ce7ab9a1d2f6eb8467ed3c4a2afba3d142607&v=4)](/moxi624)
[moxi624](/moxi624)
closed this as [completed](/moxi624/mogu_blog_v2/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 5, 2022](#event-6743309778)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmoxi624%2Fmogu_blog_v2%2Fissues%2F62)

Assignees

No one assigned

Labels

[bug](/moxi624/mogu_blog_v2/labels/bug)
Something isn't working

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@moxi624](https://avatars.githubusercontent.com/u/18610136?s=52&v=4)](/moxi624) [![@shitmoutainC0de](https://avatars.githubusercontent.com/u/96566383?s=52&v=4)](/shitmoutainC0de)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


