=== Content from myses.de_5157567c_20250114_201605.html ===
CVE-2022-27247 – A story about an IDOR wellness

Photo by Nicolas Arnold on Unsplash

Story behind all this
Everything just started with a simple idea to book some wellness vacation with my wife back in March
2020. I have booked a nice Hotel and received the following E-Mail.

As the COVID Situation got worse, we were unable to go on our wellness weekend. For some reason this
Mail caught back my attraction in March 2022. I was curious if the Login-Link from almost 2 years ago
would still work and clicked on it.

Great. The link still worked, and I was able to view my address and booking data. Sweet. But we are all
curious enough to look a lot deeper into or from a different angle to this kind of services as a “normal”
user / person would do. So, let’s dive into it.

Technical Analysis and Information Gathering

The link to the Login-Booking-Service was juicy enough.

https://redacted-host.com/booking/cdsAdressen.php?GastHash=04f276d8&AdrlnrHash=081cd3f8

I found two URI parameters to play with.

-  GastHash
-  AdrlnrHash

First, they have a “strange” format. They are not regular numeric IDs or UIDs. Given the fact that they
only contain numbers from 1-9 and characters from a – f this is very likely a hex representation of
something we don’t know. Yet. The webpage was asynchronously loading more data from a backend
using JavaScript. The following picture shows the output after the loading spinner faded out of the
screen.

Not much magic was needed to translate our hex-URI parameters into something more meaningful. But
how did I do this?

As said, it looked like the page was loading more data from some sort of backend. There are many ways
capturing the traffic from a website, but I like to use the easy ways. Hitting F12 on my keyboard brings up
the Browsers Development-tools. The Network tab will show all outgoing request made while loading or
interacting with the page.

There was a request reaching out to a backend API loading my address data and this time the IDs are
looking more like something we know. But where does this information come from? Something
translated the Hashes into real IDs. The Browsers Developer tools are enough tooling to find exactly
what I needed. First, check who initiated the call to the backend API.

There was a JavaScript function `funcAblauf` and `Laden` that called the `ajax` function. Inspecting the
page source showed the initial function call of `funcAblauf`.

So, it looks like that the translation of the hashes into real numeric IDs happened somewhere in the PHP
code. But let’s try some simple decoding and maybe we are lucky and can reverse it.

> parseInt("081cd3f8",16)

136107000

> 136107000 / 1000

136107

> parseInt("04f276d8",16)

82999000

> 82999000 / 1000

82999

Yes. We can reverse it. It is basically the ID times 1000 and the hex representation of that number. I have
no idea why that format was used but, in any case, it was not to complicated to reverse it.

As I know the way the IDs are calculated now, I was playing around with the `getAdressen.php` endpoint.

Like with most of the applications I am looking at I simply used the request as it was originally sent by the
application. Again, a web browser was enough to get the information I needed.

Jack. The response is somehow unreadable, again. But based on the encoding I had a guess. Maybe
Base64? I used my favorite tool for playing around with such kind of hashes. CyberChef.

Base64-Decode reviled another HEX-String.

Adding another Recipe “From Hex” printed the clear text data. My Address-Information. Bingo.

With all this information I had enough knowledge about the service and the architecture to finally dive
into the process of finding a vulnerability.

As the I-Dor opens
Let me put together what I have found so far.

-  An PHP Endpoint `getAdressen.php` with URI parameters `LnrAdresse` und `LnrGastKont`

accepting numeric IDs.
Two real IDs I can start with

-

My main goal was to read address information from other users. That said I asked myself “what happens
if I would change the IDs in `LnrAdresse` some other ID? But wait I need the `LnrGastKont` as well as the
`LnrAddress` ID. Do I really need them both?”

I have deleted `LnrAddress` param.

N2IyMjQ2NjU2ODZjNjU3MjIyM2EyMjRiNjU2OTZlNjUyMDQ1MmQ0ZDYxNjk2YzIwMjIyYzI
yNDQ2MTc0NjU2ZTIyM2E1YjVkN2Q=

This response was a way too short to hold some real data. Again, CyberChef can help to understand the
response.

{"Fehler":"Keine E-Mail ","Daten":[]}

So it said: No Email and the data array was empty. Is this the end of story? No I tried something different.

I set `LnrAdresse` to `1` and resubmited my request. And guess what?! I saw the exact same result as in
my original request but this time with a static `LnrAddress` ID.  That means the parameter for
`LnrAdresse` needs to be present but it looked like it was not checked or verified at all.

Next, I have tried to increment the `LnrGastKost` by 1. Nothing. Another plus 1. Nothing.

“Maybe I should write a script for that? okay no let’s try one last time.”

+ 1. And I got a hit! I saw a much longer Base64 / Hex String in my browser Window. CyberChef baked
the nice output.

Impact

The IDOR was perfect. I was able to enumarte any address I wanted to.  In combination with other
Endpoints of the same API, I was able to view all Booking-Information. To demonstrate the exploit to the
supplier I have created a Python Script enumerating 1000 Adresses and prints the first 100 characters of
the JSON response. With this technique I was able to lookup thounds of addresses and booking
information in 4 Hotels in Germany and Austria. After submitting the PoC the supplier aknowleged that
11 Hotels where effected in total by this vulnerability.

As the CVE reads, the data sets contained personal information from the person who booked the Hotel
as well as the person / persons who traveled with that person – like:

-
Full name
-  Date of Birth
-
Full Address
-
Phone Numbers
-
E-Mail address
-
Passport number
-
Licence Plate
-  Date of arrivial and special whishes / notes.

In combination with other leaks these information are very userful for bad actors. Therfor it is so
important to protect our digital footprints and with this vulnerability disclousure the cyberspace was
made a little bit more secure.

Timeline

Vulnerability found: 15.03.2022

CVE Reserved: 18.03.2022

First Contact with the software supplier: 19.03.2022

Online-Meeting to show the PoC: 23.03.2022

All Online-Booking Tools went offline: 23.03.2022

Updated deployed on Test-System for Retesting: 28.03.2022

Retesting finished: 03.04.2022

CVE and Write-Up Published:



=== Content from myses.de_cb8ad439_20250114_201604.html ===


[![logo](http://myses.de/wp-content/uploads/2017/02/logo_transparent.png)
![dark logo](http://myses.de/wp-content/uploads/2017/02/logo_transparent.png) ![light logo](http://myses.de/wp-content/uploads/2017/02/logo_transparent.png)](https://www.myses.de/)

* [Home](https://www.myses.de/)
* [About](https://www.myses.de/#about)
* [Contact](https://www.myses.de/#contact)

[![logo](http://myses.de/wp-content/uploads/2017/02/logo_transparent.png)
![dark logo](http://myses.de/wp-content/uploads/2017/02/logo_transparent.png) ![light logo](http://myses.de/wp-content/uploads/2017/02/logo_transparent.png)](https://www.myses.de/)

* [Home](https://www.myses.de/)
* [About](https://www.myses.de/#about)
* [Contact](https://www.myses.de/#contact)

[![mobile-logo](http://myses.de/wp-content/uploads/2017/02/logo_transparent.png)](https://www.myses.de/)

* [Home](https://www.myses.de/)
* [About](https://www.myses.de/#about)
* [Contact](https://www.myses.de/#contact)

![](https://www.myses.de/wp-content/themes/startit/assets/css/img/pixel-video.png)

![Video thumb](http://myses.de/wp-content/uploads/2017/02/2017-04-05-18_43_50-6272-Konvertiert.eps_-bei-311-RGB_Vorschau.png "No video playback capabilities")

### We love to code!

### Egal ob Web-CMS oder Eigenentwicklung! Wir lieben Ihre Projekte!

[Erfahren Sie mehr!](http://myses.de/#about)

## About Us

**„Was wir tun, tun wir mit Leidenschaft! Die Systeme und Projekte unserer Kunden behandeln wir, als wären es unsere eigenen!“**

*Timo Stark – CEO SES IT und Web Solutions*

![](https://www.myses.de/wp-content/uploads/2017/04/timo_round400-150x150.png)

Webentwicklung

Maßgeschneiderte Individualsoftware oder Anpassung von bestehenden Webapplikation. Hier sind wir zuhause!

[Let's Code](http://myses.de/)

Infrastruktur

Egal ob Web oder Non-Web Infrastruktur. Die Installation von Linux und Windows Servern inkl. gewünschter Zusatzsoftware sind für uns Alltag!

[Weiter](http://myses.de)

Hosting

Hier findet Ihre Webprojekt ein sicheres und beständiges Zuhause.

[Einziehen!](http://myses.de)

Consulting

Wir sind Ihre kompetenter Berater im Punkto Web- und IT-Infrastruktur. Egal ob bestehende oder neue Projekte. Wir begleiten Sie gerne.

[Mehr erfahren](http://myses.de)

 Ihr Name (Pflichtfeld)

 Ihre E-Mail-Adresse (Pflichtfeld)

 Betreff

 Ihre Nachricht

[recaptcha]

Kontaktieren Sie uns gerne bei Fragen bezüglich unseren Leistungen und Angeboten. Jederzeit und selbstverständlich auch telefonisch.

###### Büro Georgensgmünd

Kellerstraße 7

91166 Georgensgmünd

Mobil: +49(0) 171 – 645 034 9

Mail:   info@myses.de

(c) 2019
[![logo](http://myses.de/wp-content/uploads/2017/02/logo_transparent.png)](http://myses.de)

SES IT und Web Solutions

Kellerstraße 7, 91166 Georgensgmünd - GERMANY

Email: info[at]myses.de

Phone: +49 (0) 171 - 645 034 9

* [Impressum](https://www.myses.de/impressum/)
* [Datenschutz](https://www.myses.de/datenschutz/)

 Letzte Blog-Posts


