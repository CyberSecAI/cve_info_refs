=== Content from lists.debian.org_ef1692a1_20250115_084135.html ===


---

[[Date Prev](msg00001.html)][[Date Next](msg00003.html)]
[[Thread Prev](msg00001.html)][[Thread Next](msg00003.html)]
[[Date Index](maillist.html#00002)]
[[Thread Index](threads.html#00002)]

# [SECURITY] [DLA 3093-1] rails security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3093-1] rails security update
* *From*: Abhijith PA <abhijith@debian.org>
* *Date*: Sat, 3 Sep 2022 17:04:10 +0530
* *Message-id*: <[[üîé]](/msgid-search/YxM7suKjzKPHqPMo%40debian.org)¬†[YxM7suKjzKPHqPMo@debian.org](msg00002.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3093-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
September 03, 2022                            <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : rails
Version        : 2:5.2.2.1+dfsg-1+deb10u4
CVE ID         : CVE-2022-21831 CVE-2022-22577 CVE-2022-23633 CVE-2022-27777
                 CVE-2022-32224

The following vulnerabilities have been discovered in rails, a ruby
based MVC frame work for web development.

CVE-2022-21831

    A code injection vulnerability exists in the Active Storage that
    could allow an attacker to execute code via image_processing
    arguments.

CVE-2022-22577

    An XSS Vulnerability in Action Pack that could allow an attacker
    to bypass CSP for non HTML like responses.

CVE-2022-23633

    Action Pack is a framework for handling and responding to web
    requests. Under certain circumstances response bodies will not be
    closed. In the event a response is *not* notified of a `close`,
    `ActionDispatch::Executor` will not know to reset thread local
    state for the next request. This can lead to data being leaked to
    subsequent requests.

CVE-2022-27777

    A XSS Vulnerability in Action View tag helpers which would allow
    an attacker to inject content if able to control input into
    specific attributes.

CVE-2022-32224

    When serialized columns that use YAML (the default) are
    deserialized, Rails uses YAML.unsafe_load to convert the YAML data
    in to Ruby objects. If an attacker can manipulate data in the
    database (via means like SQL injection), then it may be possible
    for the attacker to escalate to an RCE.

For Debian 10 buster, these problems have been fixed in version
2:5.2.2.1+dfsg-1+deb10u4.

We recommend that you upgrade your rails packages.

For the detailed security status of rails please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/rails>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAmMTO7IACgkQhj1N8u2c
KO89+hAAlHdukBafPxAkxERCOgORBS+R3W3ahdz1hLnzuEjmjgXw0H3/48tOYUUl
U7a7qV3GZY7g77y4iS4MSBNjBNDEkmn5bMoCmN3rcwbMbU/NBNltOpXGEAN8HzPb
LoH3Um5OeaFsQFqN+UAa7Kdg61AgAAFQwe3aow5Ypz/7bWL9UQsnnS9RUMTUeGJs
JMWay9MlDbuNb1B+0u13ZosdYGA/Yz2AlJKA9uV++0ab10S6EIp64iqm0TYarMpF
oZvwUAP7Jx4cpuGxhdJC06Rh3W56RDSEXdWYOQ/aKd7UQbgWAz5VzqINrJ3VyLRE
uU+m2loqfWkDeVNapLLt284XH6imbp6vVbJL5vZ23afjtJFjZ1ehe77m59P1qAjl
lw/dAasbRLIIC0NbnHSOBfj9CLUzYO22A5FTP11QUH1gOp7CIQYMMSNWaFQQ+jmr
xApDzZCwj/IXrnJcuRqAxf/Y4715+6gwiSk2OuFLOpNvaIMOChmC6XyVt0D/V0up
EWmRpIN9Om2yVmaNBE9vSAEmefPF7axpzEh8GRwsHIsX/MRLnWHc3ru/rlQ48SC1
fkKwojwL3n7Fretbr4kEWL0FWFCzQ2HVu5g5iYldn3mWpDt1nXoB5e14EwLcSPWv
lq8OSfN+Akf38RkxvtVv3E8Qc0WvkDMJ1zIqDhEE0V6UUJPci7w=
=bov/
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_1cbec435_20250115_084136.html ===


---

[[Date Prev](msg00060.html)][[Date Next](msg00062.html)]
[[Thread Prev](msg00060.html)][[Thread Next](msg00062.html)]
[[Date Index](maillist.html#00061)]
[[Thread Index](threads.html#00061)]

# [SECURITY] [DSA 5372-1] rails security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5372-1] rails security update
* *From*: Aron Xu <aron@debian.org>
* *Date*: Mon, 13 Mar 2023 03:06:47 +0000
* *Message-id*: <[[üîé]](/msgid-search/E1pbYWN-00FGrv-9t%40seger.debian.org)¬†[E1pbYWN-00FGrv-9t@seger.debian.org](msg00061.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5372-1                   security@debian.org
<https://www.debian.org/security/>                                  Aron Xu
March 13, 2023                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : rails
CVE ID         : CVE-2021-22942 CVE-2021-44528 CVE-2022-21831 CVE-2022-22577
                 CVE-2022-23633 CVE-2022-27777 CVE-2023-22792 CVE-2023-22794
                 CVE-2023-22795 CVE-2023-22796
Debian Bug     : 992586 1001817 1011940 1011941 1005389 1016982 1030050

Multiple vunerabilities were discovered in rails, the Ruby based server-side
MVC web application framework, which could result in XSS, data disclosure
and open redirect.

For the stable distribution (bullseye), these problems have been fixed in
version 2:6.0.3.7+dfsg-2+deb11u1.

We recommend that you upgrade your rails packages.

For the detailed security status of rails please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/rails>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCAAdFiEEhhz+aYQl/Bp4OTA7O1LKKgqv2VQFAmQOknYACgkQO1LKKgqv
2VSlyQf/X1+iNclWDo1qfYJFkoQeVDnEbLRohaYp/Jqu/CssQRDs5h09VcKEnWfg
uvMdgDXeVJu4gEIwnfUfgK4QnT1XwWlAJxH9YHEpYjBuzKJ6W0CJVFrmYCe2lKdq
3SfuZc7PK2MigtvACCpJevj1mRfRQjwfPYfduV8wNid+U+AOmeTF8yrcrJ4W092Q
mfk8RKtN3xWIFjJfOM/b8EPWEWYm1ozVl8+FwTc8d1+1nV6fXcoTZ0bICuII21VB
grfFqI79F6HNpIrsq3asC0QGE2uYcipTe5BhApQI7yQB6bOQ2AQ/CUj0rR1cGz3S
wmOoy4xm/vyD3O4oPqOCfSh+FuDm7Q==
=zqIV
-----END PGP SIGNATURE-----

```

---



=== Content from discuss.rubyonrails.org_2aae71e2_20250115_084134.html ===


![Ruby on Rails Discussions](data:image/svg;base64...)
Loading

[Ruby on Rails Discussions](/)

# [[CVE-2022-27777] Possible XSS Vulnerability in Action View tag helpers](/t/cve-2022-27777-possible-xss-vulnerability-in-action-view-tag-helpers/80534)

[Security Announcements](/c/security-announcements/9)

[tenderlove](https://discuss.rubyonrails.org/u/tenderlove)
(Aaron Patterson)

April 26, 2022, 7:42pm

1

There is a possible XSS vulnerability in Action View tag helpers. Passing
untrusted input as hash keys can lead to a possible XSS vulnerability. This
vulnerability has been assigned the CVE identifier CVE-2022-27777.

* Versions Affected: ALL
* Not affected: NONE
* Fixed Versions: 7.0.2.4, 6.1.5.1, 6.0.4.8, 5.2.7.1

## Impact

If untrusted data is passed as the hash key for tag attributes, there is a
possibility that the untrusted data may not be properly escaped which can
lead to an XSS vulnerability.

Impacted code will look something like this:

```
check_box_tag('thename', 'thevalue', false, aria: { malicious_input => 'thevalueofaria' })

```

Where the ‚Äúmalicious\_input‚Äù variable contains untrusted data.

All users running an affected release should either upgrade or use one of the
workarounds immediately.

## Releases

The FIXED releases are available at the normal locations.

## Workarounds

Escape the untrusted data before using it as a key for tag helper methods.

## Patches

To aid users who aren‚Äôt able to upgrade immediately we have provided patches for
the two supported release series. They are in git-am format and consist of a
single changeset.

* 5-2-tag-helper-xss.patch - Patch for 5.2 series
* 6-0-tag-helper-xss.patch - Patch for 6.0 series
* 6-1-tag-helper-xss.patch - Patch for 6.1 series
* 7-0-tag-helper-xss.patch - Patch for 7.0 series

## Credits

Thank you to [√Ålvaro Mart√≠n Fraguas](https://hackerone.com/amartinfraguas) for
reporting the issue and providing patches!

[5-2-tag-helper-xss.patch](/uploads/short-url/auU4s1xchkyNXled90hh7PIlryN.patch) (16.2 KB)
[6-0-tag-helper-xss.patch](/uploads/short-url/oDFpnm5ERuazFawXSP0VZmFcUv7.patch) (15.7 KB)
[6-1-tag-helper-xss.patch](/uploads/short-url/nPYp1lDA45UQzJb91AjgYaeAPPE.patch) (19.8 KB)
[7-0-tag-helper-xss.patch](/uploads/short-url/AlwF3nasYm7ZhTpGdxKT6tpDocO.patch) (19.9 KB)

1 Like

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Possible XSS Vulnerability in Action Controller](https://discuss.rubyonrails.org/t/possible-xss-vulnerability-in-action-controller/84947)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,¬† [patch](https://discuss.rubyonrails.org/tag/patch) | 2 | 7726 | February 27, 2024 |
| [[CVE-2022-32209] Possible XSS Vulnerability in Rails::Html::Sanitizer](https://discuss.rubyonrails.org/t/cve-2022-32209-possible-xss-vulnerability-in-rails-sanitizer/80800)  [Security Announcements](/c/security-announcements/9) | 0 | 4090 | June 9, 2022 |
| [[CVE-2022-22577] Possible XSS Vulnerability in Action Pack](https://discuss.rubyonrails.org/t/cve-2022-22577-possible-xss-vulnerability-in-action-pack/80533)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) | 0 | 11545 | April 26, 2022 |
| [[CVE-2024-54133] Possible Content Security Policy bypass in Action Dispatch](https://discuss.rubyonrails.org/t/cve-2024-54133-possible-content-security-policy-bypass-in-action-dispatch/88178)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,¬† [security](https://discuss.rubyonrails.org/tag/security) | 0 | 749 | December 10, 2024 |
| [[CVE-2020-8264] Possible XSS Vulnerability in Action Pack in Development Mode](https://discuss.rubyonrails.org/t/cve-2020-8264-possible-xss-vulnerability-in-action-pack-in-development-mode/76368)  [Security Announcements](/c/security-announcements/9) | 1 | 5526 | October 16, 2020 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


