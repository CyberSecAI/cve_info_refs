Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from an issue in the MariaDB optimizer when handling window functions within an expression in the ORDER BY clause of a subquery. Specifically, it is triggered when the window function `AVG()` with a large constant is divided by a string, leading to a crash.

**Weaknesses/Vulnerabilities Present:**
-   **Division by String:** The vulnerability is triggered when performing division by a string in combination with a specific window function.
-   **Incorrect handling of window functions in ORDER BY:** The optimizer fails to properly handle the given combination of window function and ORDER BY clause causing a crash.

**Impact of Exploitation:**
-   **Denial of Service (DoS):** Successful exploitation of this vulnerability results in a crash of the MariaDB server, leading to a denial of service.

**Attack Vectors:**
-   **SQL Injection:** The attack vector involves crafting a specific SQL query containing the vulnerable window function within a subquery's `ORDER BY` clause and executing it.

**Required Attacker Capabilities/Position:**
- The attacker needs the ability to execute arbitrary SQL queries on the vulnerable MariaDB instance. The vulnerability does not require any specific user privileges.

**Additional Details:**
- The provided Jira issue MDEV-28094 includes a Proof of Concept (PoC) query that triggers the vulnerability:
```sql
SELECT EXISTS ( ( SELECT -1 ORDER BY AVG ( 2147483647 ) OVER ( ROWS BETWEEN UNBOUNDED PRECEDING AND 83 PRECEDING ) / 'x' ) ) ;
```
-   The issue is marked as a "Blocker" priority, highlighting its severity.
-   The issue affects MariaDB versions 10.9.0, 10.4, 10.5, 10.6, 10.7, and 10.8.
-   The vulnerability has been fixed in MariaDB versions 10.4.25, 10.5.16, 10.6.8, and 10.7.4.
-   The vulnerability is related to MDEV-25630 "Crash with window function in left expr of IN subquery"
-   The NetApp advisory NTAP-20220526-0006 lists CVE-2022-27451 as one of several CVEs related to MariaDB vulnerabilities that could lead to DoS.