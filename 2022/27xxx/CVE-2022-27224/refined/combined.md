=== Content from gist.github.com_d0de7068_20250115_092635.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fsomerandomdudeonetheinternet%2F2caeb201e249160fa82204ef640c8cdf)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fsomerandomdudeonetheinternet%2F2caeb201e249160fa82204ef640c8cdf&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fsomerandomdudeonetheinternet%2F2caeb201e249160fa82204ef640c8cdf) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fsomerandomdudeonetheinternet%2F2caeb201e249160fa82204ef640c8cdf&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@somerandomdudeonetheinternet](https://avatars.githubusercontent.com/u/13917476?s=64&v=4)](/somerandomdudeonetheinternet)

# [somerandomdudeonetheinternet](/somerandomdudeonetheinternet)/**[Galleon Systems GPS Command Injection.txt](/somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf)**

Created
May 6, 2022 21:48

Show Gist options

* [Download ZIP](/somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf/archive/30dd8681e422047639d439eb5db61ef6990bf91b.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fsomerandomdudeonetheinternet%2F2caeb201e249160fa82204ef640c8cdf)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fsomerandomdudeonetheinternet%2F2caeb201e249160fa82204ef640c8cdf)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf.js&quot;&gt;&lt;/script&gt;
* Save somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf to your computer and use it in GitHub Desktop.

[Code](/somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf)
[Revisions
1](/somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf.js&quot;&gt;&lt;/script&gt;

Save somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf to your computer and use it in GitHub Desktop.

[Download ZIP](/somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf/archive/30dd8681e422047639d439eb5db61ef6990bf91b.zip)

An issue was discovered in Galleon NTS-6002-GPS > 4.14.103-Galleon-NTS-6002 V12-4

 [Raw](/somerandomdudeonetheinternet/2caeb201e249160fa82204ef640c8cdf/raw/30dd8681e422047639d439eb5db61ef6990bf91b/Galleon%2520Systems%2520GPS%2520Command%2520Injection.txt)

[**Galleon Systems GPS Command Injection.txt**](#file-galleon-systems-gps-command-injection-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | > An authenticated attacker can perform |
| --- | --- |
|  | > command injection as root via shell metacharacters within the Network |
|  | > Tools section of the web-management interface. All three networking |
|  | > tools are affected (Ping, Traceroute, and DNS Lookup) and their |
|  | > respective input fields (ping\_address, trace\_address, |
|  | > nslookup\_address). |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [VulnerabilityType Other] |
|  | > Command Injection |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Vendor of Product] |
|  | > Galleon Systems |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Affected Product Code Base] |
|  | > Galleon NTS-6002-GPS - 4.14.103-Galleon-NTS-6002.V12 - #4 / No publicly disclosed fixed version as of yet |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Affected Component] |
|  | > All three networking tools presented on the interface are affected (Ping, Traceroute and DNS Lookup) and their respective input fields |
|  | > (ping\_address, trace\_address, nslookup\_address). |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Attack Type] |
|  | > Remote |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Impact Code execution] |
|  | > true |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Impact Information Disclosure] |
|  | > true |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Attack Vectors] |
|  | > Authenticated - Command Injection via Management Interface |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Has vendor confirmed or acknowledged the vulnerability?] |
|  | > true |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Discoverer] |
|  | > Victor van der Helm - Pen Test Partners |
|  | > |
|  | > ------------------------------------------ |
|  | > |
|  | > [Reference] |
|  | > https://www.galsys.co.uk/support/software-download.html |
|  |  |
|  | Use CVE-2022-27224. |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fsomerandomdudeonetheinternet%2F2caeb201e249160fa82204ef640c8cdf)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.galsys.co.uk_44d394d4_20250115_092636.html ===

[![galsys logo - ntp time server and synchronisation products](https://www.galsys.co.uk/images/galsys-ntp-time-server-and-synchronisation-products-logo.png)](https://www.galsys.co.uk/)

Call us: **0121 608 7230**
Site Navigation

* [Home](https://www.galsys.co.uk/index.html)
* [Products](https://www.galsys.co.uk/products.html)
* [Why Galleon](https://www.galsys.co.uk/galleon/index.html)
* [Support](https://www.galsys.co.uk/support/index.html)
* [Blog](https://www.galsys.co.uk/news/)
* [Contact](https://www.galsys.co.uk/contact.php)

# Software Download Page

## Galleon's list of product web and User Manuals for download

## NTS-6002

![](https://www.galsys.co.uk/images/manual-images/nts-6002-320x200.jpg)

[NTS-6002 V12 Firmware version »](https://support.galsys.co.uk/)

## NTS-6001

![](https://www.galsys.co.uk/images/manual-images/nts-6001-320x200.jpg)

[NTS-6001 V12 Firmware version »](https://support.galsys.co.uk/)

## NTS-4000

![](https://www.galsys.co.uk/images/manual-images/nts-4000-r-320x200.jpg)

Debug software is available if you are having issues with your unit. Information on this can also be found in the manuals.

[NTS-4000 Firmware software »](https://www.galsys.co.uk/download/ntpv262.frm)

[NTS-4000 Software »](https://www.galsys.co.uk/download/nesdk.exe)

## SignalClocks

![](https://www.galsys.co.uk/images/manual-images/signalclocks-320x200.jpg)

---

Download PuTTY client.

[PuTTY »](https://www.galsys.co.uk/software/PuTTY/putty.exe)

## Inova Clocks

![](https://www.galsys.co.uk/images/manual-images/inovaclocks-320x200.jpg)

Download PuTTY client.

[PuTTY »](https://www.galsys.co.uk/software/PuTTY/putty.exe)

---

## NTP Server Checker

Welcome to the Free Galleon NTP server checker. This software is a test tool that acts as a client to a NTP server. The Galleon SNTP client reports on the responses it receives and allows you to check the accuracy and precision of a NTP time server. You can specify how many requests to send and how large the time between each. The SNTP server checker is easy to use and can test the accuracy and reliability of any NTP server.

![](https://www.galsys.co.uk/images/ntpc-320x440.jpg)

[NTP Server Checker Tool »](https://www.galsys.co.uk/software/NTPChecker/ntpc.exe)

---

International sites:

## Visit our international sites:

[![English](https://www.galsys.co.uk/flags/English.png)](https://www.galsys.co.uk/ "English")
[![French](https://www.galsys.co.uk/flags/French.png)](https://fr.galsys.co.uk/support/software-download.html "French")
[![German](https://www.galsys.co.uk/flags/German.png)](https://de.galsys.co.uk/support/software-download.html "German")
[![Italian](https://www.galsys.co.uk/flags/Italian.png)](https://it.galsys.co.uk/support/software-download.html "Italian")
[![Spanish](https://www.galsys.co.uk/flags/Spanish.png)](https://es.galsys.co.uk/support/software-download.html "Spanish")
[![English USA](https://www.galsys.co.uk/flags/USA.png)](https://www.ntp-time-server.com/support/software-download.html "English USA")
[![Portuguese](https://www.galsys.co.uk/flags/Portuguese.png)](https://pt.galsys.co.uk/support/software-download.html "Portuguese")
[![Swedish](https://www.galsys.co.uk/flags/Swedish.png)](https://sv.galsys.co.uk/support/software-download.html "Swedish")
[![Dutch](https://www.galsys.co.uk/flags/Dutch.png)](https://nl.galsys.co.uk/support/software-download.html "Dutch")
[![Norwegian](https://www.galsys.co.uk/flags/Norwegian.png)](https://no.galsys.co.uk/support/software-download.html "Norwegian")
[![Arabic](https://www.galsys.co.uk/flags/Arabic.png)](https://ar.galsys.co.uk/support/software-download.html "Arabic")
[![Malay](https://www.galsys.co.uk/flags/Malay.png)](https://ms.galsys.co.uk/support/software-download.html "Malay")
[![Polish](https://www.galsys.co.uk/flags/Polish.png)](https://pl.galsys.co.uk/support/software-download.html "Polish")
[![Turkish](https://www.galsys.co.uk/flags/Turkish.png)](https://tr.galsys.co.uk/support/software-download.html "Turkish")
[![Danish](https://www.galsys.co.uk/flags/Danish.png)](https://da.galsys.co.uk/support/software-download.html "Danish")

### [Products](https://www.galsys.co.uk/products.html)

* [NTP servers](https://www.galsys.co.uk/ntp-servers/index.html)
* [Network clocks & displays](https://www.galsys.co.uk/network-clocks-displays/index.html)
* [Network time servers](https://www.galsys.co.uk/network-time-servers/index.html)
* [Time receivers](https://www.galsys.co.uk/time-receivers/index.html)
* [NTP client software](https://www.galsys.co.uk/ntp-client-software/index.html)
* [Antennas](https://www.galsys.co.uk/antennas/index.html)
* [Modules](https://www.galsys.co.uk/modules/index.html)
* [Accessories](https://www.galsys.co.uk/accessories/index.html)

### Quick Enquiry

Quick Contact Form

Fill in the form or call **0121 608 7230** for more information on how a Galleon Time Server can work for you.

Full name:

Email Address:

Phone Number:

Message (Optional):

Please contact me to discuss the Galleon product range.

Submit Enquiry

We respect your privacy - [read our policy](https://www.galsys.co.uk/privacy.html "This link will open in a new window").

## Popular Products

### [GPS NTP Server](https://www.galsys.co.uk/ntp-servers/nts-6001-gps-ntp-server.html)

 [![GPS NTP Server](https://www.galsys.co.uk/images/icons/gps-ntp-server-pp.jpg "View the GPS NTP Server")](https://www.galsys.co.uk/ntp-servers/nts-6001-gps-ntp-server.html)

A Network timeserver using the GPS signal to synchronise time across large computer networks.

### [NTP Network Clock](https://www.galsys.co.uk/network-clocks-displays/index.html)

 [![Network Clock Display](https://www.galsys.co.uk/images/icons/network-clock-display-pp.jpg "View the Network Clock Display")](https://www.galsys.co.uk/network-clocks-displays/index.html)

The perfect partner for any Galleon NTP server or time server. Display Consistent and accurate time throughout your organization.

### [Network Time Server](https://www.galsys.co.uk/ntp-servers/nts-4000s-ntp-server.html)

 [![MSF NTP Server](https://www.galsys.co.uk/images/icons/ntp-server-pp.jpg "View the MSF NTP Server")](https://www.galsys.co.uk/ntp-servers/nts-4000s-ntp-server.html)

A complete solution for synchronising the time across any computer network.

### [Time Server](https://www.galsys.co.uk/network-time-servers/ts-700-gps-network-time-server.html)

 [![GPS Network Time Server](https://www.galsys.co.uk/images/icons/time-server-pp.jpg "View the GPS Network Time Server")](https://www.galsys.co.uk/network-time-servers/ts-700-gps-network-time-server.html)

GPS clock providing time synchronisation for computer systems

### [Time Receiver](https://www.galsys.co.uk/time-receivers/ac-500-msf-time-receiver.html)

 [![MSF Time Receiver](https://www.galsys.co.uk/images/icons/time-receiver-pp.jpg "View the MSF Time Receiver")](https://www.galsys.co.uk/time-receivers/ac-500-msf-time-receiver.html)

A complete solution for synchronising the time on a single computer to the MSF (radio) atomic time signals.

* [Home](https://www.galsys.co.uk/)
* [FAQ](https://www.galsys.co.uk/support/faq.html)
* [Blog](https://www.galsys.co.uk/news/)
* [Blog RSS feed](https://www.galsys.co.uk/news/feed/ "Subscribe to the Galsys RSS feed")

UK Sales: 0121 608 7230

* International Sites:
* [British Site](https://www.galsys.co.uk/ "English UK")
* [American Site](https://www.ntp-time-server.com "English USA")
* [Polish Site](https://www.galsys.pl "Polski")
* [French Site](https://www.galsys.eu "Français")
* [German Site](https://www.galsys.de "Deutsch")
* [Italian Site](https://www.galsys.it "Italiano")
* [Spanish Site](https://www.galsys.es "Espanól")
* [Dutch Site](https://www.galsys.nl "Nederlandse")

* © 1996 - 2025 Galleon Systems. All Rights Reserved.
* [Privacy Policy](https://www.galsys.co.uk/privacy.html)
* [Terms of Use](https://www.galsys.co.uk/terms.html)

* ### Popular Categories:
* [NTP Server](https://www.galsys.co.uk/ntp-servers/index.html)
* [Network Clock](https://www.galsys.co.uk/network-clocks-displays/index.html)
* [Network Time Server](https://www.galsys.co.uk/network-time-servers/index.html)
* [Time Receiver](https://www.galsys.co.uk/time-receivers/index.html)
* [Antennas](https://www.galsys.co.uk/antennas/index.html)
* [Modules](https://www.galsys.co.uk/modules/index.html)



=== Content from www.pentestpartners.com_a81e6c03_20250115_092636.html ===


[![Pen Test Partners Logo](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-ptp.png)

Security consulting and testing services](https://www.pentestpartners.com)

+44 20 3095 0500

+1 646 693 2501

* [About](https://www.pentestpartners.com/about-us/)
  + [PTP in the USA](https://www.pentestpartners.com/about-us/ptp-in-the-usa/)
  + [Careers](https://www.pentestpartners.com/about-us/careers/)
  + [Our Vision and Values](https://www.pentestpartners.com/our-vision-and-values/)
  + [In the news](https://www.pentestpartners.com/about-us/in-the-news/)
  + [Environmental Statement](https://www.pentestpartners.com/about-us/environmental-statement/)
  + [Vulnerability Disclosure Policy](https://www.pentestpartners.com/about-us/vulnerability-disclosure-policy/)
* [Services](https://www.pentestpartners.com/penetration-testing-services/)
  + [Red Teaming](https://www.pentestpartners.com/penetration-testing-services/red-teaming/)
  + [Purple Teaming](https://www.pentestpartners.com/penetration-testing-services/purple-teaming/)
  + [Penetration Testing](https://www.pentestpartners.com/penetration-testing-services/penetration-testing/)
  + [Agile Environment Testing](https://www.pentestpartners.com/penetration-testing-services/agile-environment-testing/)
  + [Aviation Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/aviation-cyber-security-testing/)
  + [Automotive & IoT Testing](https://www.pentestpartners.com/penetration-testing-services/automotive-and-iot-testing/)
  + [Maritime Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/maritime-cyber-security-testing/)
  + [Cloud Services Security](https://www.pentestpartners.com/penetration-testing-services/cloud-services-security/)
  + [DevOps Lifecycle Assurance](https://www.pentestpartners.com/devops-lifecycle-assurance/)
  + [Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)
  + [Physical Security](https://www.pentestpartners.com/penetration-testing-services/physical-security/)
  + [Security Training](https://www.pentestpartners.com/penetration-testing-services/security-training/)
  + [Papa – Proactive Advanced Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)
  + [ICS, IIoT, SCADA Security Testing](https://www.pentestpartners.com/penetration-testing-services/ics-iiot-scada-security-testing/)
  + [CBEST Red Teaming](https://www.pentestpartners.com/penetration-testing-services/cbest-threat-intelligence-led-red-teaming/)
  + [CREST OVS Mobile & Apps](https://www.pentestpartners.com/crest-owasp-verification-standard-ovs-program/)
  + [TIBER-EU Assessments](https://www.pentestpartners.com/penetration-testing-services/tiber-eu-assessments/)
  + [CREST STAR-FS](https://www.pentestpartners.com/penetration-testing-services/crest-star-fs-assessments/)
  + [Cyber Essentials Testing](https://www.pentestpartners.com/penetration-testing-services/cyber-essentials-testing/)
  + [Cyber Security Consulting](https://www.pentestpartners.com/penetration-testing-services/cyber-security-consulting/)
  + [Compromise Assessment](https://www.pentestpartners.com/compromise-assessment/)
  + [Digital Forensics Services](https://www.pentestpartners.com/digital-forensics-services/)
  + [Incident Response Services](https://www.pentestpartners.com/incident-response-services/)
  + [Incident Response Retained Service](https://www.pentestpartners.com/incident-response-retained-service/)
  + [Incident Response Policy Assessment & Development](https://www.pentestpartners.com/incident-response-policy-assessment-development/)
  + [Attack Surface Assessment](https://www.pentestpartners.com/attack-surface-assessment/)
* [Events](https://www.pentestpartners.com/events-and-speaking/)
* [Security Blog](https://www.pentestpartners.com/security-blog/)
* [Demo Videos](https://www.pentestpartners.com/resources/hack-demo-videos/)
* [Contact Us](https://www.pentestpartners.com/contact-us/)

For the best user experience please upgrade your browser

Blog: Vulnerability Disclosure

# Galleon NTS-6002-GPS Command Injection vulnerability (CVE-2022-27224)

Victor van der Helm
20 May 2022

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2022/05/gall-cve-headline.png)

### TL;DR

Galleon Systems’ GPS NTP time server had a command injection vulnerability in the firmware of their NTS GPS device which could allow total control of the device through the web management interface.

### The vulnerability – CVE-2022-27224

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27224>

* Device: Galleon NTS-6002-GPS
* Firmware version: 4.14.103-Galleon-NTS-6002.V12 – #4 (possibly also V12 – #5)
* Web Server: nginx/1.15.7
* CVSSv3.1 Rating: 7.2
* Metric: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2022/05/gall-cve1.png)

### Summary

A vulnerability was discovered in Galleon NTS-6002-GPS 4.14.103-Galleon-NTS-6002.V12 #4. A low privilege authenticated attacker can perform command injection as the root user, by supplying shell metacharacters to forms on the Network Tools section of the web-management interface. All three networking tools are affected (Ping, Traceroute, and DNS Lookup) and their respective input fields (ping\_address, trace\_address, nslookup\_address).

In the examples below, we are targeting one of the three vulnerable pages (in this case DNS Lookup). The vulnerable endpoint is “/tools/dolookup” and the parameter “nslookup\_address”.

Example commands used to enumerate and perform command injection via the pages and injectable page parameters mentioned above (“buffer” is a chosen random input word expected by the application):

```
buffer&id;
```
```
buffer&id&whoami&ifconfig;
```
```
buffer&id&pwd&ls;
```

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2022/05/gall-cve2.png)

### Exploitation

The underlying system did not allow some characters to be passed, these can be worked around using shell facilities. We can avoid the use of spaces by using the IFS shell variable (Input Field Separator):

```
buffer&cat${IFS}index.php
```

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2022/05/gall-cve3.png)

Forward slashes “/” were also not accepted. In bash these can be replicated by using variable substitution, such as ${HOME:0:1}. This extracts the first character for the HOME shell variables, which, as the variable is a full path, is equal to the “/” character. With these substitutions we can submit most shell commands, such as:

```
buffer&cat${IFS}${HOME:0:1}etc${HOME:0:1}passwd
```
```
buffer&cat${IFS}${HOME:0:1}etc${HOME:0:1}shadow
```

The final command injection string gets the local Un\*x system’s password hash file. This is only accessible with “root” level privileges on the device, and therefore highlights another issue of the web management UI server being run via the “root” administrative account rather than a more sensible choice such as “www-var” or “apache”.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2022/05/gall-cve4.png)

### Disclosure timeline

* Nov 21 – Initial disclosure to Galleon Systems
* Jan 22 – Acceptance of part of the vulnerability
* Jan 22 – Vendor started the vulnerability registration (CVE ID request dropped by MITRE due to failure by Galleon to provide additional information)
* Mar 22 – I disclosed the vulnerability to MITRE myself
* May 22 – MITRE acknowledged the vulnerability – CVE ID provided

### Background

I found the vulnerability almost accidentally while doing other work. Wanting a change of focus I explored the web admin UI looking for basic vulnerabilities. Much to my surprise I found this device to be vulnerable.

### Realistic impact

Command injection on a GPS powered NTP device could in theory be quite devastating. Once “root” level privileged command execution is gained on the device, an attacker could gain control over the network time which could interfere with the Kerberos authentication protocol. This would be compounded if no backup NTP source is available.

The compromised device could be turned into an attacker’s network persistence backdoor or even be used to disrupt SCADA / ICS systems reliant on accurate time. It is down to the attacker’s creativity at this stage. Although if you are lucky, they might just exfiltrate the “root” account password and spray the network hoping to find password re-use.

### Mitigations

At the time of writing the vendor was working on releasing a newer iteration of the device’s software which would patch the identified security issues. However it has not yet been released, and to the best our knowledge the update has not been tested or verified.

* While waiting for a vendor software patch, these devices should be properly restricted with firewalls at a host and / or network level in a manner that would only allow for IT management devices to authenticate to the device.
* Further, ensure the device is making use of a suitably complex and unique password so that an attacker could not trivially guess the password to the device’s web admin UI.
* Ensure that more than one high tier NTP source is used to provide time for the network.

### Disclosure challenges

The vendor attempted to deny that the webserver was running with “root” privileges. Here’s what they said to us:

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2022/05/gall-cve5.png)

This had us falling about laughing!

We disproved this crazy statement. There are two indications that the webserver was indeed running as the superuser “root”. Most importantly, the User Identifier (UID) returned when performing an “id” command returned a UID of value “0” which always indicates that the current user is a superuser and therefore the “root” user.

![](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![](https://www.pentestpartners.com/content/uploads/2020/05/gall-cve6.png)

Furthermore, as seen in the screenshots above, it was possible to retrieve the “/etc/shadow” hash file that is typically only accessible by the “root” account or an account with delegated “root” privileges (e.g SUID).

### References

* <https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-27224>

### Share

### Categories

Show all
Android  (71)
Automotive Security  (24)
Aviation Cyber Security  (44)
Blockchain  (3)
Breach Handling  (1)
Careers At PTP  (1)
Cloud Security  (5)
Code Repository  (1)
Consultancy advice  (5)
Consumer Advice  (34)
Cyber Essentials  (1)
Cyber Liability Insurance  (5)
DFIR  (29)
Hardware Hacking  (19)
Heartbleed  (5)
Honeypots  (6)
How-Tos  (264)
In the news  (1)
Internet Of Things  (169)
Macs / Apple  (31)
Maritime Cyber Security  (47)
Medical Device Security  (3)
Opinions  (107)
OPSEC  (9)
OT, ICS, IIoT, SCADA  (22)
Passwords  (39)
PCI Advice  (2)
Ransomware  (2)
Red Teaming  (26)
Reverse Engineering  (12)
Security Blog  (808)
Shameless Self Promotion  (11)
Show on homepage  (6)
Social Engineering  (12)
Sustainability  (2)
Virtual Environments  (1)
Vulnerabilities that aren’t  (4)
Vulnerability Advisory  (45)
Vulnerability Disclosure  (20)

[# See the other cool stuff we've been doing…](/blog/)

[DFIR

# Tackling AI threats. Advanced DFIR methods and tools for deepfake detection

13 Jan 2025](https://www.pentestpartners.com/security-blog/tackling-ai-threats-advanced-dfir-methods-and-tools-for-deepfake-detection/)

[Aviation Cyber Security

# The unexpected effects of GPS spoofing on aviation safety

09 Jan 2025](https://www.pentestpartners.com/security-blog/the-unexpected-effects-of-gps-spoofing-on-aviation-safety/)

[DFIR

# 10 Non-tech things you wish you had done after being breached

07 Jan 2025](https://www.pentestpartners.com/security-blog/10-non-tech-things-you-wish-you-had-done-after-being-breached/)

[Aviation Cyber Security

# The surprising existence of the erase button on cockpit voice recorders

03 Jan 2025](https://www.pentestpartners.com/security-blog/the-surprising-existence-of-the-erase-button-on-cockpit-voice-recorders/)

[Internet Of Things

# Heels on fire. Hacking smart ski socks

23 Dec 2024](https://www.pentestpartners.com/security-blog/heels-on-fire-hacking-smart-ski-socks/)

[Services

### Penetration Testing

Find out more »](https://www.pentestpartners.com/penetration-testing-services/penetration-testing/)

### Our People

Being introduced to, and getting to know your tester is an often overlooked part of the process. Yes, our work is über technical, but faceless relationships do nobody any good.

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-alert.svg)](https://www.pentestpartners.com/penetration-testing-services/suffered-a-security-breach/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-mobile-security.svg)
## Mobile Security](https://www.pentestpartners.com/penetration-testing-services/mobile-security/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-social-engineering-grey.svg)
## Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-webapp.svg)
## Web application testing](https://www.pentestpartners.com/penetration-testing-services/web-application-testing/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-data-compliance-grey.svg)
## Security Consuting](https://www.pentestpartners.com/penetration-testing-services/security-consulting/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-papa-grey.svg)
## Papa - PTP Advance Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)

### Get in touch

**UK Office:**

Pen Test Partners LLP

Unit 2, Verney Junction Business Park

Buckingham

MK18 2LB

United Kingdom

+44 20 3095 0500
[Contact Us »](/contact-us/)

###

**US Office:**

+1 646 693 2501
[[email protected]](/cdn-cgi/l/email-protection#b8d1d6ded7f8c8ddd6ccddcbccc8d9caccd6ddcacb96dbd7d5)

### Connect

[Twitter](https://twitter.com/PentestPartners)
[LinkedIn](https://www.linkedin.com/company/pen-test-partners)
[YouTube](https://www.youtube.com/channel/UC2HCAhj6JiOsV_PcMFrjykw)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-pentest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-fs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/csir-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-ovs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![logo-cbest](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cbest.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-check-ncsc.png)](https://www.ncsc.gov.uk/organisations/pen-test-partners)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-assure.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cyber-essentials2023.png)](https://iasme.co.uk/cyber-essentials/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/bsi-iso27001-logo-22.png)](/content/uploads/2023/12/PTP-ISO27001-Certificate-2023.pdf)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-pci-certified.png)](https://www.pcisecuritystandards.org/assessors_and_solutions/qualified_security_assessors)

[Privacy Policy](/privacy-policy/)

[Terms of Service](/terms-of-website-use/)

Manage Cookies

Company number: OC353362

VAT reg number: GB825526427

© 2025 Pen Test Partners


