The provided content relates to CVE-2022-27244.

**Root cause of vulnerability:**
The vulnerability stems from the lack of proper sanitization of user-controlled input, specifically the `CustomAuth_name` configuration. This allows a malicious site administrator to inject a cross-site scripting (XSS) payload.

**Weaknesses/vulnerabilities present:**
- Stored XSS vulnerability: The injected payload is stored in the database and executed each time an administrator modifies a user. This is a persistent, or stored, XSS vulnerability.
- Insufficient input sanitization: The application fails to properly sanitize user input before displaying it on the page. Specifically, the value from `Configure::read('Plugin.CustomAuth_name')` was directly used without HTML escaping.

**Impact of exploitation:**
- Arbitrary JavaScript execution: An attacker can execute malicious JavaScript code in the context of other users' browsers when they access the user add/edit forms.
- Account compromise: Through XSS, the attacker might be able to steal session cookies or perform actions on behalf of another administrator.
- Data manipulation: An attacker might be able to modify data or inject content into the application.

**Attack vectors:**
- Malicious site administrator: A user with administrative privileges can inject the XSS payload.
- User add/edit forms: The vulnerability is triggered when an administrator modifies a user's information, causing the stored payload to be executed.

**Required attacker capabilities/position:**
- The attacker needs to be a site administrator to be able to modify the application settings. This is an authenticated attack, requiring high privilege within the system.