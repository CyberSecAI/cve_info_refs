=== Content from mendelson-e-c.com_638decb8_20250114_182003.html ===

[Skip to main content](#main-content)

[![mendelson-e-commerce GmbH](https://mendelson-e-c.com/sites/default/files/images/corporate/mendelson_banner.png)](/)

* [Home](https://mendelson-e-c.com/)
* [Company](https://mendelson-e-c.com/company)
* [Products](https://mendelson-e-c.com/products)
* [Shop](http://shop.mendelson-e-c.com)
* [Customers](https://mendelson-e-c.com/mendelsoncustomer)
* [Community](https://mendelson-e-c.com/forum)

# mendelson OFTP2 2020 b272 released

Dec
22
2020

1min read
A-
A+

read

* [*facebook*](https://www.facebook.com/sharer/sharer.php?u=https://mendelson-e-c.com/node/3355&t=mendelson%20OFTP2%202020%20b272%20released)
* [*twitter*](http://twitter.com/share?text=mendelson%20OFTP2%202020%20b272%20released&url=https://mendelson-e-c.com/node/3355)
* *email*
* *print*

By development

![mendelson OFTP2](/sites/default/files/styles/thumbnail/public/2020-12/logo_oftp2_with_text_0.png?itok=EwHcZnx3)

Directory traversal vulnerability, Partner delete

* Added an additional check on the content of SFID.SFIDDATE and SFID.SFIDTIME to prevent invalid content that allowed to write files somewhere in the file system. If the content is not numeric the system will now answer with a SFNA.SFNAREAS=99
* Regression: It was impossible to delete a partner if it had a postprocessing event assigned. If you don't want to update you could just keep the partner and rename him to a new one if your require additional parters.

Tags
[OFTP2](https://mendelson-e-c.com/blog/OFTP2)

* [*twitter*](http://twitter.com/mendelson/)
* [*linkedin*](http://www.linkedin.com/company/mendelson/)
* [*blog*](/blog)

## COMPANY

We are a leading global provider of cutting-edge enterprise communications software.

We offer you standards-based and platform-independent software for electronic business data exchange (EDI) and enterprise application integration (EAI).

[READ MORE](/company)

## SUPPORT

We’re with you every step of the way.

Combine our software with a proven methodology that helps you go fast now and with every new request.

[READ MORE](/support)

## Recent comments

* [Examining the log found this…](https://mendelson-e-c.com/comment/1885)2 months 4 weeks ago
* [Examining the log found this…](https://mendelson-e-c.com/comment/1884)2 months 4 weeks ago
* [Please check the AS2 system…](https://mendelson-e-c.com/comment/1883)2 months 4 weeks ago

## Footer menu

* [Home](https://mendelson-e-c.com/)
* [Login](https://mendelson-e-c.com/user/login)
* [Legal Disclosure](https://mendelson-e-c.com/legaldisclosure)
* [Privacy Policy](https://mendelson-e-c.com/privacy)
* [Contact](https://mendelson-e-c.com/contact)
* [[English]](https://mendelson-e-c.com/)
* [[Deutsch]](https://mendelson.de/)

© 1999-2024 mendelson-e-commerce GmbH



=== Content from insinuator.net_577b20c6_20250114_182002.html ===


[Insinuator.net](https://insinuator.net/)

Bold Statements

Primary Menu

* [About](https://insinuator.net/about/)

* [RSS Feed](https://insinuator.net/?feed=rss)
* [Follow us](http://twitter.com/insinuator)

## Categories

* [Breaking](https://insinuator.net/category/breaking/)
* [Building](https://insinuator.net/category/building/)
* [Events](https://insinuator.net/category/events/)
* [Misc](https://insinuator.net/category/misc/)
## Tags

[4G](https://insinuator.net/tag/4g/)
[Active Directory](https://insinuator.net/tag/active-directory/)
[advisory](https://insinuator.net/tag/advisory/)
[Android](https://insinuator.net/tag/android/)
[Black Hat](https://insinuator.net/tag/black-hat/)
[blackhoodie](https://insinuator.net/tag/blackhoodie/)
[Bluetooth](https://insinuator.net/tag/bluetooth/)
[C3](https://insinuator.net/tag/c3/)
[Cisco](https://insinuator.net/tag/cisco/)
[cloud](https://insinuator.net/tag/cloud/)
[Day-Con](https://insinuator.net/tag/day-con/)
[disclosure](https://insinuator.net/tag/disclosure/)
[Docker](https://insinuator.net/tag/docker/)
[ERNW white paper](https://insinuator.net/tag/ernw-white-paper/)
[exploit](https://insinuator.net/tag/exploit/)
[forensics](https://insinuator.net/tag/forensics/)
[fuzzing](https://insinuator.net/tag/fuzzing/)
[GSM](https://insinuator.net/tag/gsm/)
[hardening](https://insinuator.net/tag/hardening/)
[hardware](https://insinuator.net/tag/hardware/)
[HITB](https://insinuator.net/tag/hitb/)
[iOS](https://insinuator.net/tag/ios/)
[IoT](https://insinuator.net/tag/iot/)
[IPv6](https://insinuator.net/tag/ipv6/)
[Linux](https://insinuator.net/tag/linux/)
[malware](https://insinuator.net/tag/malware/)
[medical](https://insinuator.net/tag/medical/)
[network](https://insinuator.net/tag/network/)
[pentest](https://insinuator.net/tag/pentest/)
[reversing](https://insinuator.net/tag/reversing/)
[RIPE](https://insinuator.net/tag/ripe/)
[risk](https://insinuator.net/tag/risk/)
[SAP](https://insinuator.net/tag/sap/)
[SDR](https://insinuator.net/tag/sdr/)
[Telco](https://insinuator.net/tag/telco/)
[TelcoSecDay](https://insinuator.net/tag/telcosecday/)
[tool](https://insinuator.net/tag/tool/)
[TROOPERS](https://insinuator.net/tag/troopers/)
[trust](https://insinuator.net/tag/trust/)
[virtualization](https://insinuator.net/tag/virtualization/)
[VMware](https://insinuator.net/tag/vmware/)
[VoIP](https://insinuator.net/tag/voip/)
[vulnerability](https://insinuator.net/tag/vulnerability/)
[web application](https://insinuator.net/tag/web-application/)
[Windows](https://insinuator.net/tag/windows/)
## Archives

Archives
Select Month
 November 2024  (2)
 September 2024  (2)
 August 2024  (2)
 June 2024  (2)
 May 2024  (4)
 April 2024  (4)
 February 2024  (1)
 October 2023  (3)
 September 2023  (2)
 August 2023  (1)
 July 2023  (1)
 June 2023  (2)
 May 2023  (3)
 December 2022  (1)
 September 2022  (2)
 August 2022  (1)
 June 2022  (1)
 April 2022  (1)
 March 2022  (1)
 December 2021  (1)
 October 2021  (1)
 July 2021  (1)
 May 2021  (4)
 April 2021  (2)
 March 2021  (1)
 February 2021  (3)
 January 2021  (5)
 December 2020  (4)
 November 2020  (6)
 October 2020  (2)
 September 2020  (5)
 July 2020  (3)
 June 2020  (1)
 May 2020  (1)
 April 2020  (2)
 March 2020  (3)
 February 2020  (3)
 January 2020  (2)
 December 2019  (2)
 November 2019  (6)
 October 2019  (4)
 September 2019  (3)
 August 2019  (3)
 July 2019  (6)
 June 2019  (6)
 May 2019  (7)
 April 2019  (7)
 March 2019  (2)
 February 2019  (4)
 January 2019  (14)
 December 2018  (4)
 November 2018  (11)
 October 2018  (6)
 September 2018  (1)
 August 2018  (4)
 July 2018  (3)
 June 2018  (3)
 May 2018  (3)
 April 2018  (5)
 March 2018  (8)
 February 2018  (12)
 January 2018  (2)
 December 2017  (2)
 November 2017  (3)
 October 2017  (7)
 September 2017  (5)
 August 2017  (3)
 July 2017  (3)
 June 2017  (6)
 May 2017  (5)
 April 2017  (3)
 March 2017  (8)
 February 2017  (6)
 January 2017  (8)
 December 2016  (12)
 November 2016  (14)
 October 2016  (12)
 September 2016  (12)
 August 2016  (9)
 July 2016  (9)
 June 2016  (7)
 May 2016  (10)
 April 2016  (23)
 March 2016  (29)
 February 2016  (14)
 January 2016  (12)
 December 2015  (15)
 November 2015  (6)
 October 2015  (9)
 September 2015  (7)
 August 2015  (5)
 July 2015  (6)
 June 2015  (14)
 May 2015  (9)
 April 2015  (9)
 March 2015  (13)
 February 2015  (10)
 January 2015  (18)
 December 2014  (10)
 November 2014  (10)
 October 2014  (7)
 September 2014  (3)
 August 2014  (9)
 July 2014  (5)
 June 2014  (1)
 May 2014  (9)
 April 2014  (1)
 March 2014  (3)
 February 2014  (5)
 January 2014  (13)
 December 2013  (5)
 November 2013  (5)
 October 2013  (4)
 September 2013  (1)
 August 2013  (10)
 July 2013  (10)
 June 2013  (5)
 May 2013  (4)
 April 2013  (10)
 March 2013  (4)
 February 2013  (12)
 January 2013  (6)
 December 2012  (2)
 November 2012  (4)
 October 2012  (1)
 September 2012  (3)
 July 2012  (3)
 June 2012  (3)
 May 2012  (8)
 April 2012  (2)
 March 2012  (5)
 February 2012  (6)
 January 2012  (4)
 December 2011  (7)
 November 2011  (7)
 October 2011  (6)
 September 2011  (3)
 August 2011  (3)
 July 2011  (6)
 June 2011  (4)
 May 2011  (4)
 April 2011  (5)
 March 2011  (5)
 January 2011  (2)
 December 2010  (6)
 November 2010  (5)
 October 2010  (3)
 September 2010  (4)
 August 2010  (5)
 July 2010  (6)
 June 2010  (2)
 December 2009  (1)
 November 2009  (1)
 October 2009  (3)
 0  (1)

Search for:

Search

* [ERNW](https://www.ernw.de)
* [ERNW Research](https://www.ernw-research.de)

[Back](https://insinuator.net/#post-13693)

[Misc](https://insinuator.net/category/misc/)
[March 24, 2022](https://insinuator.net/2022/03/a-tale-of-an-oftp2-vulnerability/) by [Oliver Matula](https://insinuator.net/author/omatula/)
# A Tale of an OFTP2 Vulnerability

This is a guest post from Thomas Smits.

## A long time ago in a galaxy far, far away….

In my ordinary life, I teach computer science at the University of Applied Sciences in Mannheim but for some months, I was an intern at ERNW learning a lot about IT security and penetration testing. One of these learnings is that old protocols can be fun and breaking them even more. But let’s start at the beginning of the story…

Back in the year 1986: Top Gun, Platoon, and Crocodile Dundee were the top-grossing films in the cinema and IBM sold the very first laptop computer, called IBM PC Convertible (model 5140). The Internet Engineering Task Force (IETF) was just founded and Boris Becker won the Wimbledon Championships for the second time. A group of engineers of the Organisation for Data Exchange by Tele Transmission in Europe (ODETTE) met and specified OFTP, a protocol to transfer files over … no, there was no Internet commercially available at that time … X.25 networks. X.25 itself dates back to 1976 and is a packet-switched protocol for WANs. The OFTP protocol tried to “address the electronic data interchange (EDI) requirements of the European automotive industry” [RFC2204, page 3](https://tools.ietf.org/html/rfc2204). With the rise of the Internet, OFTP was extended in 1997 to support TCP/IP in addition to X.25 as the transport protocol ([RFC2204](https://tools.ietf.org/html/rfc2204)) and in 2007 again to include encryption and authentication ([RFC5024](https://tools.ietf.org/html/rfc5024)). With RFC5024 we have the most recent specification of the protocol which is called “OFTP2”. They somehow skipped their 10-year cycle (86, 97, 07) and did not release a current specification in the last 14 years.

## Implementing an OFTP2 client

During a penetration test, we encountered a service listening on port 3305. It greeted any visitor with the banner “IODETTE FTP READY ” (the blank at the end is not a typo but part of the message). This was my, and everybody else’s, initial encounter with OFTP2. The following question was, how to evaluate a service for security vulnerabilities if you cannot speak its protocol? The answer is: You have to learn the protocol and write a tool that speaks it. There is [one open-source implementation of OFTP2](https://sourceforge.net/projects/mendelson-oftp2/) available, but it is relatively complex and did not look like something we wanted to use. As an intern, I had some time and sat down to write a clean-room implementation of the OFTP2 protocol only based on the RFC.

You can find the implementation of the OFTP2-Client on [GitHub](https://github.com/thomsmits/oftp2-client).

There are some fun facts about OFTP2:

* Every message exchanged between client and server starts with a one-letter command, like the *I* in the banner.
* Some numeric values are transferred as strings like *01024*, padded to a fixed length with leading zeros, for example, the maximum size of a message (SSIDSDEB).
* Some numeric values are transferred as binary data in network byte order, for example, the length of an authentication challenge (AUCHCHLL).
* Boolean values and flags are indicated by the characters *Y* and *N*.
* Blanks are important because message fields are padded with blanks to their specified length, e.g. “X5O2010CUSTOMER 01024RNNN099N ” showing us a server response.
* The actual data sent to the server during the file transfer has to be broken down into sub-records of 63 bytes. The sender has to split the data into these chunks; the receiver has to reassemble them.
* The addressing of communication partners is based on the so-called Odette ID.

All things considered, it looks like a protocol extended several times with a little lack of orthogonality.

## Know your Odette ID

Once you have a client that talks OFTP2, you need to know at least one valid Odette ID that is configured as a communication partner on the server. Otherwise, the server will not accept your message and will not initiate a session with you.

If you know such an ID, the server will tell you its Odette ID as part of the session handshake. This is quite an attractive feature because you can use it to find new Odette IDs — just try a known one on some servers and collect the IDs you receive as an answer to collect even more IDs.

The format of the ID is: *Onnnnccccccccccccccssssss*

* *O*: the first character is always *O*
* *nnnn*: a four-digit number with leading zeros, called the *International Code Designator* (*ICD*). Only the numbers 0002-0189 are globally registered (see [ICD list](https://www.cyber-identity.com/download/ICD-list.pdf)). In Germany, you can expect to see *0013* and *0177* quite often because they are registered to the [VDA](https://www.vda.de) and [Odette consortium](https://www.odette.org).
* *cccccccccccccc*: A 14 character *Organisation Code* that typically consists of the character set *[A-Z\-0-9]*. Which characters are allowed, depends on the [ICD](https://www.cyber-identity.com/download/ICD-list.pdf).
* *ssssss*: a 6 character computer sub address that normally consists of the character set *[A-Z\-0-9]*.

The ID has not to take up the full 25 characters but can be shorter. In this case, it is padded with blanks to the right.

If the Odette ID starts with *O013* the next six characters are numeric, e.g. *O0013000243AEG*.

*LOCAL* and *O1999MENDELSONDE* work out-of-the-box on some server implementations. Additionally, companies sometimes publish the ID or you can ask if you are good at social engineering.

In the case of the penetration tests, we knew valid Odette IDs due to other security vulnerabilities.

## Finding a directory traversal

The protocol is made to transfer files, so it accepts arbitrary data and stores it somewhere on disk. Therefore, the first vulnerabilities to search for are *directory traversals*: Can we store our file at a location we chose?

OFTP2 maintains no notion of directories, thus there is no “change dir” command like in FTP. The sender provides a name for the file (called virtual dataset name, SFIDDSN) and a bunch of other information like file date, sizes, etc. How the server determines the local file name and its location is completely up to the server’s implementation.

The server we encountered during our tests was from the German company [Mendelson GmbH](http://mendelson-e-c.com/oftp2). This particular implementation stores the received files in a dedicated folder for every sender’s ID and transfers them to another folder after processing. The local file name is taken from the virtual dataset name (SFIDDSN) and the file’s date (SFIDDATE) and time (SFIDTIME) are concatenated to distinguish different files with an identical name. The OFTP2 specification allows the characters *[0-9A-Z/\-.&() ]* for the virtual file name and the characters *[0-9]* for the date and time fields (5.3.3. in RFC5024). The *.* and */* in the virtual file name looked promising but the */* was filtered out by the implementation, so no directory traversal via the data set name (SFIDDSN). What the developers missed is that the date and time fields should contain only *[0-9]* according to the specification, but the client may ignore this and send any character.

Bingo! There is a directory traversal: Set the virtual file name (SFIDDSN) to *..*, the date (SFIDDATE) to *//./../.* and the time (SFIDTIME) to *./../test1* and the server will concatenate all three to the filename *..//./../../../test1*.

The resulting path must have exactly 20 characters due to the length limitations of the used fields. Nevertheless, by using */./* and *//*, any target path shorter than 20 characters can be transformed into one with exactly 20 characters.

Although the number of directories you can walk up and down the file system hierarchy is limited due to the fields’ length restrictions, it is at least possible to reach the main installation directory of the OFTP2 server and replace configuration files or do other harm.

This vulnerability was reported on the [vendor website](https://mendelson-e-c.com/node/3355) and fixed in version OFTP2 1.1 b43, released 2021-01-13.

## Conclusion

Ancient protocols are cryptic, and implementing them can be a pain, but they are not in the focus of security researchers. Therefore, there may be some fame still waiting for you.

And never have trust in the fact that the communication partner will adhere to the protocol. At least the bad guys will not.

## Summary

Name of affected product: mendelson OFTP2

Fixed version: 1.1 b43

Vulnerability type: Directory Traversal

Root cause: Inproper Input Validation

Impact: File write to arbitrary directories

[Back](https://insinuator.net/#post-13693)

## Post navigation

[Release of PTE Analysis plugins for Volatility 3](https://insinuator.net/2021/12/release-of-pte-analysis-plugins-for-volatility-3/)[Solving client-side controls once and for all](https://insinuator.net/2022/04/solving-client-side-controls-once-and-for-all/)

[Imprint](/about) | [Privacy Policy](/privacy) | ©2025 ERNW Enno Rey Netzwerke GmbH


