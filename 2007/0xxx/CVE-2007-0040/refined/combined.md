=== Content from archive.cert.uni-stuttgart.de_372e62ca_20250124_234222.html ===

[UniversitÃ¤t Stuttgart](https://uni-stuttgart.de/)

[![Logo der Stabsstelle Informationssicherheit der UniversitÃ¤t Stuttgart](/img/stabsstelle-360.png)](/)
[![Logo des RUS-CERT](/img/ruscert-360.png)](/)

* [Home](/)
* [Aktuelles](/blog)
* [Services](/services)
* [Themen](/topics)
* [Ãber uns](/about)
* [Kontakt](/contact)

Home

# Stabsstelle Informationssicherheit (RUS-CERT)

**Kontakt**

E-Mail: mail@cert.uni-stuttgart.de

Telefon: +49 711 685 **12378**

[Mehr...](/contact)

Die Stabsstelle Informationssicherheit (RUS-CERT) ist fÃ¼r die IT- und Informationssicherheit der UniversitÃ¤t Stuttgart zustÃ¤ndig. Sie ist Stabsstelle der [Kanzlerin](https://www.uni-stuttgart.de/universitaet/organisation/leitung/kanzlerin/) und damit direkt der UniversitÃ¤tsleitung unterstellt. Als Computernotfallteam (Computer Emergency Response Team, CERT) ist sie unter anderem die zentrale Melde- und Koordinationsstelle fÃ¼r InformationssicherheitsvorfÃ¤lle.

## Aktuelles

### [Anstehendes Support-Ende (âEnd of lifeâ) von Windows 10](/blog/2024-10-14-windows-10-end-of-life)

Wir weisen darauf hin, dass Windows 10 ab dem 14. Oktober 2025 keine kostenlosen Sicherheitsupdates mehr erhÃ¤lt und ohne weitere MaÃnahmen nicht mehr im Uninetz betrieben werden darf. Wir zeigen mÃ¶gliche Optionen fÃ¼r Windows-10-Rechner auf. FÃ¼r neue Hardware oder kostenpflichtige Sicherheitsupdates kÃ¶nnen Kosten auf die Betreiber:innen zukommen.

### [Windows-Feature âRecallâ](/blog/2024-06-19-recall)

Aus aktuellem Anlass weist die Stabsstelle Informationssicherheit auf Probleme mit dem neuen Windows-Feature âRecallâ hin und rÃ¤t von der Verwendung ab.

### [Umgang mit vermeintlichen Warnungen des Virenscanners im Browser](/blog/2024-05-13-malicious-browser-popups)

Immer wieder erhalten wir Anfragen von Nutzer:innen, bei denen der Rechner den Fund von Malware meldet. Nicht in allen FÃ¤llen sind dies echte Warnungen unserer Endpoint Protection LÃ¶sung. Die andere ErklÃ¤rung ist, dass es sich um Push-Nachrichten aus dem Browser handeln kann, mit der die Person vor dem Rechner dazu verleitet werden soll, Malware zu installieren. Wir zeigen, wie sich falsche von echten Meldungen unterscheiden lassen und beschreiben am Beispiel von Google Chrome, wie Push-Nachrichten deaktiviert werden kÃ¶nnen.

## Mitgliedschaften

[![Logo von FIRST](/img/logo-first-120.png)](https://www.first.org/)
[![Logo von TI](/img/logo-ti-120.png)](https://www.trusted-introducer.org/)
[![Logo des CV](/img/logo-cv-120.png)](https://www.cert-verbund.de/)
[![Logo des EDUCV](/img/logo-educv-120.png)](https://www.educv.de/)

Formalia

* [Impressum](/impressum)
* [Datenschutz](/privacy)

Die Stabsstelle

* [Kontakt](/contact)
* [Jobs](/jobs)

Dokumente

* [Leitlinie zur Informations­sicherheit (ISL)](/leitlinie-zur-informationssicherheit.pdf)

Navigation

* [Home](/index)
* [Aktuelles](/blog)
* [Services](/services)
* [Themen](/topics)
* [Ãber uns](/about)
* [Kontakt](/contact)



=== Content from support.microsoft.com_629526cc_20250126_043323.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Filter Actions

* Article
* 11/17/2009
## In this article

Applies To: Windows 7, Windows Server 2008 R2

A filter action defines the security requirements for the data transmission. Filter actions can be defined when you create a policy or before you create a policy. Filter lists are available to any policy. To define a filter list, right-click the IP Security Policy node and select **Manage filter lists and filter actions**.

A filter action can be configured to:

## Permit traffic

IPsec passes this traffic to and from the TCP/IP driver without modification or the requirement for security. This is appropriate for traffic from computers that are not IPsec-capable. Be sure to limit the IP filter list to a minimal scope when using this type of filter action, so that you do not permit traffic that should be secured.

Consider allowing ICMP traffic for troubleshooting purposes. You might also need to allow a computer that is not in your domain (for example, a consultant's computer) access to another computer in your domain. You can use the permit filter action to allow this access.

Important

The permit filter action allows access without authentication, data integrity, or encryption. Anyone using a computer with the IP address specified in the filter list is given the access. All traffic between the computers is done in plaintext; no integrity checks are performed.

## Block traffic

IPsec silently discards blocked traffic. When using a blocking filter action, be sure to use an IP filter list that defines the correct scope of IP addresses. Using larger scopes increases the chance of blocking traffic between valid computers.

## Negotiate security

If you enable the **Accept unsecured communication, but always respond using IPSec** option, IPsec attempts to negotiate security associations (SAs) and the sending or receiving of IPsec-protected traffic. However, if the peer cannot use IPsec, the communication will be allowed without IPsec protection. After you choose this filter action, you can also configure the following:

* Security methods and their order. This list of methods defines in which order the methods will be attempted. The first successful method will be used and the remaining methods will not be attempted. Typically, the list should be ordered from highest security to lowest security, so that the most secure method is used.
* Acceptance of initial incoming unsecured traffic (**Accept unsecured communication, but always respond using IPSec**). IPsec allows an incoming packet that matches the configured filter list to be unsecured (that is, not protected by IPsec). However, the outgoing response to the incoming packet must be protected. This setting is useful when you are using the default response rule for clients. When a group of servers are configured with a rule that secures communications with any IP address and accepts unsecured communication, responding with only secured communications, enabling the default response rule on client computers ensures that the clients will respond to the server request to negotiate security. To prevent denial-of-service attacks, this option should be disabled for secure computers connected to the Internet.
* Enabling of communication with non-IPsec-enabled computers (**Allow unsecured communication if a secure connection cannot be established**). IPsec falls back to unsecured communication, if necessary. Again, you should limit the IP filter list to a minimal scope. Otherwise, if negotiation fails for any reason, any communications affected by the rule in which this filter action resides could result in data being sent without security. If you are concerned about unsecured communication, you might consider disabling these settings. However, communication with computers that cannot initiate IPsec, such as legacy systems, might be blocked. To prevent denial-of-service attacks, this option should be disabled for secure computers connected to the Internet.
* Generation of quick mode session keys from new main mode keying material (**Session key perfect forward secrecy (PFS)**). Enabling session key PFS ensures that main mode master keying material cannot be used to derive more than one quick mode session key. When quick mode PFS is enabled, a new Diffie-Hellman key exchange is performed to generate new main mode master keying material before the new quick mode key is created. Session key (quick mode) PFS does not require main mode reauthentication and uses fewer resources than master key (main mode) PFS.

## IPsec security methods

Each security method defines the security requirements of any communications to which the associated rule applies. Creating multiple security methods increases the chance that a common method can be found between two computers. The Internet Key Exchange (IKE) component reads the list of security methods in descending order and sends a list of allowed security methods to the other peer. The first method in common is selected. Typically, the most secure methods appear at the top of the list; the least secure methods appear at the bottom of the list.

### Predefined security methods

The following security methods are predefined:

#### Encryption and Integrity

Uses the ESP protocol to provide data confidentiality (encryption) with the triple Data Encryption Standard (3DES) algorithm, data integrity and authentication with the Secure Hash Algorithm 1 (SHA1) integrity algorithm, and default key lifetimes (100 megabytes (MB), 1 hour). If you require both data and addressing (IP header) protection, you can create a custom security method. If you do not require encryption, use Integrity only.

#### Integrity only

Uses the ESP protocol to provide data integrity and authentication with the SHA1 integrity algorithm and default key lifetimes (100 MB, 1 hour). In this configuration, ESP does not provide data confidentiality (encryption).

#### Custom security methods

If the predefined Encryption and Integrity or Integrity only settings do not meet your security requirements, you can specify custom security methods. For example, you can use custom methods when encryption and address integrity, stronger algorithms, or key lifetimes must be specified. When configuring a custom security method, you can configure the following:

##### Security protocols

Both AH (data and address integrity without encryption) and ESP (data integrity and encryption) can be enabled in a custom security method when you require IP header integrity and data encryption. If you chose to enable both, you do not need to specify an integrity algorithm for ESP.

Note

The AH protocol cannot be used over network address translation (NAT) devices because it uses a hash of the header. NAT devices alter the header, so the packet will not authenticate properly.

##### Integrity algorithm

Message Digest 5 (MD5), which uses a 128-bit key. This algorithm is no longer considered secure and should be used only when interoperability requires its use.

SHA1, which uses a 160-bit key. SHA1 is a stronger hash than MD5 and is compliant with the Federal Information Processing Standard (FIPS).

##### Encryption algorithm

3DES is the most secure of the DES combinations and somewhat slower in performance. 3DES processes each block three times, using three unique 56-bit keys.

DES uses a single 56-bit key and is used when the higher security and overhead of 3DES is not required. This algorithm is no longer considered secure and should only be used when interoperability requires it.

Session key (quick mode) settings determine when, not how, a new key is generated. You can specify a lifetime in kilobytes (KB), seconds, or both. For example, if the communication takes 10,000 seconds and you specify the key lifetime as 1000 seconds, 10 keys will be generated to complete the transfer. This ensures that, even if an attacker manages to determine one session key and decipher part of a communication, the attacker cannot decipher the entire communication. By default, new quick mode keys are generated for every 100 MB of data or every hour. Any time a key lifetime is reached, the SA, in addition to the key refresh or regeneration, is also renegotiated.

**To create a filter action using the New Rule Properties dialog box**

1. On the **Rules** tab of the **IP Security Policy Properties** dialog, clear the **Use Add Wizard** check box if you want to create the filter action in the property dialog box. If you want to use the wizard, leave the check box selected. Click **Add**. The following instructions are for creating a filter list using the dialog box.
2. On the **Filter Action** tab of the **Rule Properties** dialog box, clear the **Use Add Wizard** checkbox and click **Add**.
3. On the **Security Methods** tab, select the method (action) that the rule will use.
4. (Optional) On the **Description** tab, type a description of the filter action. This description can help you sort through filter actions and allows you to quickly identify the filter action without having to open its properties.
5. Click **OK**.
6. Repeat steps 4 through 8 to add additional filter actions to the list.

Note

Although the rule can list several filter actions, only one filter action can be used per rule.

7. On the **Filter Action** tab, select the appropriate filter action for the rule and click **OK**.

**To create a filter action using the Manage filter lists and filter actions dialog box**

1. Right-click the IP Security Policy node and select **Manage IP filter lists and filter actions**.
2. On the **Manage Filter Actions** tab, clear the **Use Add Wizard** check box if you want to create the filter action using the property dialog box. If you want to use the wizard, leave the check box selected. Click **Add**. The following instructions are for creating a filter list using the dialog box. The directions below do not use the wizard.
3. On the **Security Methods** tab, select the method and click **OK**.
4. If you selected the Negotiate security option, you can add multiple methods and specify the order they will be attempted. To do this click **Add**.
5. (Optional) On the **Description** tab, type a description of the filter. This description can help you sort through filters and allows you to quickly identify the filter without having to open its properties.
6. Click **OK**.
7. Repeat steps 4 through 8 to add filter actions to the list.

## See Also

#### Concepts

[Filter Lists](cc732038%28v%3Dws.10%29)

[IPsec Authentication](cc772338%28v%3Dws.10%29)

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.kb.cert.org_35c74bce_20250124_234254.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#487905

## Microsoft Windows Active Directory fails to properly validate LDAP requests

#### Vulnerability Note VU#487905

Original Release Date: 2007-07-10 | Last Revised: 2007-07-19

---

### Overview

A vulnerability in Windows Active Directory could allow a remote attacker to execute arbitrary code on a vulnerable system.

### Description

| The Lightweight Directory Access Protocol ([LDAP](http://tools.ietf.org/html/rfc4510)) is a standard protocol that enables users to query or modify the data in a meta directory. Microsoft's Active Directory is a directory service provided with Windows 2000 Server and Windows 2003 Server that stores information about objects on a network and makes this information available to users and network administrators. LDAP is the primary access protocol for Windows Active Directory.  The LDAP service provided with these systems fails to perform sufficient checks for the number of convertible attributes included in a LDAP request. This vulnerability could be exploited by a remote attacker with the ability to supply a specially crafted packet to the affected system. Microsoft states that the attacker would not need to be authenticated to exploit this vulnerability on an affected Windows 2000 Server system while the attacker must have valid authentication credentials to exploit this vulnerability on an affected Windows Server 2003 system. |
| --- |

### Impact

| A remote attacker may be to execute arbitrary code on an affected system or cause the Active Directory service to crash, resulting in a denial of service. |
| --- |

### Solution

| **Apply a patch from the vendor**Microsoft has addressed this issue in [Microsoft Security Bulletin MS07-039](http://www.microsoft.com/technet/security/bulletin/ms07-039.mspx). Users are encouraged to review this bulletin and apply the updates it refers to. |
| --- |

| **Workarounds**In addition to the patches referred to above, Microsoft Security Bulletin MS07-039 also contains several [workarounds](http://www.microsoft.com/technet/security/bulletin/ms07-039.mspx#EYBAC) for this issue. Users, particularly those who are unable to apply the patches are encouraged to implement these workarounds. |
| --- |

### Vendor Information

487905
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23487905/) to view vendors.**
### [Microsoft Corporation](#CRDY-74YQRZ) Affected

Updated:  July 10, 2007

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Microsoft has addressed this issue in [Microsoft Security Bulletin MS07-039](http://www.microsoft.com/technet/security/bulletin/ms07-039.mspx). Users are encouraged to review this bulletin and apply the updates it refers to.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/technet/security/bulletin/ms07-039.mspx>
* <http://secunia.com/advisories/26002/>
* <http://www.iss.net/threats/267.html>
### Acknowledgements

Thanks to Microsoft for reporting this vulnerability. Microsoft, in turn, credits Neel Mehta of IBM Internet Security Systems X-Force, for reporting this issue to them.

This document was written by Chad R Dougherty.

### Other Information

| **CVE IDs:** | [CVE-2007-0040](http://web.nvd.nist.gov/vuln/detail/CVE-2007-0040) |
| --- | --- |
| **Severity Metric:** | 12.66 |
| **Date Public:** | 2007-07-10 |
| **Date First Published:** | 2007-07-10 |
| **Date Last Updated:** | 2007-07-19 16:07 UTC |
| **Document Revision:** | 8 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from docs.microsoft.com_90e14611_20250124_234258.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2007/ms07-039.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS07-039 - Critical

## Vulnerability in Windows Active Directory Could Allow Remote Code Execution (926122)

Published: July 10, 2007 | Updated: July 12, 2007

**Version:** 1.1

### General Information

#### Executive Summary

This critical security update resolves a privately reported vulnerability in implementations of Active Directory on Windows 2000 Server and Windows Server 2003 that could allow remote code execution or a denial of service condition. Attacks attempting to exploit this vulnerability would most likely result in a denial of service condition. However remote code execution could be possible. On Windows Server 2003 an attacker must have valid logon credentials to exploit this vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts.

This is a critical security update for supported editions of Windows 2000 and an important security update for supported editions of Windows Server 2003. For more information, see the subsection, **Affected and Non-Affected Software**, in this section.

This security update addresses the vulnerability by validating the number of convertible attributes in the client LDAP request. For more information about the vulnerability, see the next section, **Vulnerability Information**.

**Recommendation.** Microsoft recommends that customers apply the update immediately.

**Known Issues.** None.

#### Affected and Non-Affected Software

The following software have been tested to determine which editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| Operating System | Maximum Security Impact | Aggregate Severity Rating | Bulletins Replaced by This Update |
| --- | --- | --- | --- |
| [Microsoft Windows 2000 Server Service Pack 4](https://www.microsoft.com/download/details.aspx?familyid=812e62c5-6e19-4b3b-8a10-861b871e1b41) | Remote Code Execution | Critical | None |
| [Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=28e84603-8159-4429-aaff-a1020531e84f) | Remote Code Execution | Important | None |
| [Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=107902f9-be94-457f-a936-519efbd64779) | Remote Code Execution | Important | None |
| [Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems](https://www.microsoft.com/download/details.aspx?familyid=e5e5b425-fe7d-49d5-973f-f3fd7a1e04eb) | Remote Code Execution | Important | None |

**Non-Affected Software**

| Operating System |
| --- |
| Windows 2000 Professional Service Pack 4 |
| Windows XP Service Pack 2 |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 |
| Windows Vista |
| Windows Vista x64 Edition |
| Active Directory Application Mode (ADAM) Service Pack 1 |

**Note:** These editions of Windows are not affected because they do not include the Active Directory server component.

## Frequently Asked Questions (FAQ) Related to This Security Update

**I do not have any of the Affected Software installed. Why am I being offered the security update?**

While the vulnerabilities addressed by this security update only affect Windows 2000 Server and Windows Server 2003 systems that are functioning in a domain controller role, the vulnerable code exists on all supported editions of Windows 2000 and Windows 2003. This update is offered to all systems that contain the vulnerable code.

**I have ADAM installed, what should I do?**

The vulnerable code does not exist in ADAM Service Pack 1. However, vulnerable code does exist in versions previous to ADAM Service Pack 1. We recommend installing Service Pack 1 for ADAM. For more information on ADAM Service Pack 1, please visit the [ADAM SP1 download site](https://www.microsoft.com/download/details.aspx?familyid=9688f8b9-1034-4ef6-a3e5-2a2a57b5c8e4&displaylang;=en).

**What is ADAM?**

ADAM provides data storage and retrieval for directory-enabled applications, without the dependencies that are required for the Active Directory service. ADAM provides much of the same functionality as Active Directory, but it does not require the deployment of domains or domain controllers, and the directory schema for ADAM is completely independent of the enterprise schema you may be using in an Active Directory domain. You can run multiple instances of ADAM concurrently on a single computer, with an independently managed schema for each ADAM instance.
For more information on ADAM, please see the [Introduction to Active Directory Application Mode](https://www.microsoft.com/windowsserver2003/adam/default.mspx).

**I am using an older release of the software discussed in this security bulletin. What should I do?**

The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. To determine the support life cycle for your software release, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. For more information about the Windows Product Lifecycle, visit the following [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742). For more information about the extended security update support period for these software releases, visit the [Microsoft Product Support Services Web site](https://go.microsoft.com/fwlink/?linkid=33328).

Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the [Microsoft Worldwide Information Web site](https://go.microsoft.com/fwlink/?linkid=33329), select the country, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Windows Operating System Product Support Lifecycle FAQ](https://go.microsoft.com/fwlink/?linkid=33330).

### Vulnerability Information

## Severity Ratings and Vulnerability Identifiers

| Affected Software | Active Directory Remote Code Execution Vulnerability - CVE-2007-0040 | Active Directory Denial of Service Vulnerability - CVE- 2007-3028 | Aggregate Severity Rating |
| --- | --- | --- | --- |
| Windows 2000 Server Service Pack 4 | **Critical** \ Remote Code Execution | **Important** \ Denial Of Service | **Critical** |
| Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2 | **Important** \ Remote Code Execution | None | **Important** |
| Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2 | **Important** \ Remote Code Execution | None | **Important** |
| Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | **Important** \ Remote Code Execution | None | **Important** |

## Windows Active Directory Remote Code Execution Vulnerability- CVE-2007-0040

A remote code execution vulnerability exists in the way that Active Directory validates a LDAP request. An attacker who successfully exploited this vulnerability could take complete control of an affected system.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2007-0040](https://www.cve.org/CVERecord?id=CVE-2007-0040).

#### Mitigating Factors for Windows Active Directory Remote Code Execution Vulnerability- CVE-2007-0040

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* For customers who require the affected component, firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed.
* Attacks attempting to exploit this vulnerability would most likely result in a denial of service condition. However remote code execution could be possible.
* On Windows Server 2003 an attacker must have valid logon credentials to exploit this vulnerability; the vulnerability can not be exploited by an anonymous user.

#### Workarounds for Windows Active Directory Remote Code Execution Vulnerability- CVE-2007-0040

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Block the following at the firewall:**

  TCP port 389

  This port is used to initiate connection with the affected component. Blocking it at the enterprise firewall, both inbound and outbound, will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, visit [TCP and UDP Port Assignments](https://go.microsoft.com/fwlink/?linkid=21312).
* **To help protect from network-based attempts to exploit this vulnerability, block the affected ports by using IPSec on the affected systems.**

  Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in [Microsoft Knowledge Base Article 313190](https://support.microsoft.com/kb/313190) and [Microsoft Knowledge Base Article 813878](https://support.microsoft.com/kb/813878).

#### FAQ for Windows Active Directory Remote Code Execution Vulnerability- CVE-2007-0040

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system remotely. An attacker could then install programs or view, change, or delete data; or create new accounts with full user rights.

**Note.** Attacks attempting to exploit this vulnerability would most likely result in a denial of service condition. However remote code execution could be possible and the scope is therefore larger than only a denial of service.

**What causes the vulnerability?**

The LDAP service performs insufficient checks for the number of convertible attributes included in a LDAP request.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could take complete control of the affected system.

**How could an attacker exploit the vulnerability?**

For Windows 2000 Server, any anonymous user with access to the target network could deliver a specially crafted network packet to the affected system in order to exploit this vulnerability. On Windows Server 2003, the attacker must have valid authentication credentials to try to exploit this vulnerability.

**What systems are primarily at risk from the vulnerability?**

LDAP is a requirement for Active Directory. Therefore, any Windows 2000 Server or Windows Server 2003 that is running as an Active Directory Server is affected by this vulnerability.

**Could the vulnerability be exploited over the Internet?**

Yes. An attacker could try to exploit this vulnerability over the Internet. However common firewall practices contain Active Directory requests to within the enterprise infrastructure. Firewall best practices can help protect against attacks that originate from the Internet.

**What is LDAP?**

[LDAP](https://msdn2.microsoft.com/library/aa503238.aspx) (Lightweight Directory Access Protocol) is an industry-standard protocol that enables authorized users to query or modify the data in a meta directory. In Windows Server 2000 and Windows Server 2003, LDAP is one protocol used to access data in the Active Directory.

**What does the update do?**

The update removes the vulnerability by performing checks for the number of convertible attributes included in an LDAP request.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

## Windows Active Directory Denial of Service Vulnerability- CVE-2007-3028

A denial of service vulnerability exists in the way that Microsoft Active Directory validates a client-sent LDAP request. An attacker could exploit the vulnerability by sending a specially crafted LDAP request to a server running Active Directory. An attacker who successfully exploited this vulnerability could cause the server to temporarily stop responding.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2007-3028](https://www.cve.org/CVERecord?id=CVE-2007-3028).

#### Mitigating Factors for Windows Active Directory Denial of Service Vulnerability- CVE-2007-3028

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* For customers who require the affected component, firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed.
* Windows Server 2003 editions are not affected by this vulnerability.

#### Workarounds for Windows Active Directory Denial of Service Vulnerability- CVE-2007-3028

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Block the following at the firewall:**

  TCP ports 389 and 3268

  These ports are used to initiate connections with the affected component. Blocking these at the enterprise firewall, both inbound and outbound, will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, visit [TCP and UDP Port Assignments](https://go.microsoft.com/fwlink/?linkid=21312).
* **To help protect from network-based attempts to exploit this vulnerability, block the affected ports by using IPSec on the affected systems.**

  Use Internet Protocol security (IPSec) to help protect network communications. Detailed information about IPSec and about how to apply filters is available in [Microsoft Knowledge Base Article 313190](https://support.microsoft.com/kb/313190) and [Microsoft Knowledge Base Article 813878](https://support.microsoft.com/kb/813878).

#### FAQ for Windows Active Directory Denial of Service Vulnerability- CVE-2007-3028

**What is the scope of the vulnerability?**

This is a denial of service vulnerability. An attacker who exploited this vulnerability could cause the affected system to temporarily stop responding. During that time, the server would be unable to respond to requests. Note that the denial of service vulnerability would not allow an attacker to execute code or to elevate their user rights, but it could cause the affected system to stop accepting requests.

**What causes the vulnerability?**

The LDAP service performs incorrect decoding of data that is sent in the client LDAP request.

**How could an attacker exploit the vulnerability?**

An attacker could try to exploit the vulnerability by sending a specially crafted request to an affected system. The message could then cause the affected system to stop responding.

**What systems are primarily at risk from the vulnerability?**

LDAP is a requirement for Active Directory. Therefore, any Windows 2000 Server that is running as an Active Directory Server is affected by this vulnerability.

**Could the vulnerability be exploited over the Internet?**

Yes. An attacker could try to exploit this vulnerability over the Internet. However common firewall practices contain Active Directory requests to within the enterprise infrastructure. Firewall best practices can help protect against attacks that originate from the Internet.

**What is LDAP?**

[LDAP](https://msdn2.microsoft.com/library/aa503238.aspx) (Lightweight Directory Access Protocol) is an industry-standard protocol that enables authorized users to query or modify the data in a meta directory. In Windows Server 2000 and Windows Server 2003, LDAP is one protocol used to access data in the Active Directory.

**What does the update do?**

The update removes the vulnerability by validating the client sent LDAP request logic.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

### Update Information

## Detection and Deployment Tools and Guidance

Manage the software and security updates you need to deploy to the servers, desktop, and mobile computers in your organization. For more information see the [TechNet Update Management Center](https://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](https://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products.

Security updates are available from [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747), [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130), and [Office Update](https://go.microsoft.com/fwlink/?linkid=21135). Security updates are also available at the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for "security\_patch." Finally, security updates can be downloaded from the Windows Update Catalog. For more information about the Windows Update Catalog, see [Microsoft Knowledge Base Article 323166](https://support.microsoft.com/kb/323166).

**Detection and Deployment Guidance**

Microsoft has provided detection and deployment guidance for this monthâs security updates. This guidance will also help IT professionals understand how they can use various tools to help deploy the security update, such as Windows Update, Microsoft Update, Office Update, the Microsoft Baseline Security Analyzer (MBSA), the Office Detection Tool, Microsoft Systems Management Server (SMS), the Extended Security Update Inventory Tool, and the Enterprise Update Scan Tool (EST). For more information, see [Microsoft Knowledge Base Article 910723](https://support.microsoft.com/kb/910723).

**Microsoft Baseline Security Analyzer**

Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA visit [Microsoft Baseline Security Analyzer Web site](https://go.microsoft.com/fwlink/?linkid=21134). The following table provides the MBSA detection summary for this security update.

| Software | MBSA 1.2.1 | MBSA 2.0.1 |
| --- | --- | --- |
| Microsoft Windows 2000 Server Service Pack 4 | Yes | Yes |
| Windows Server 2003 Service Pack 1 and Microsoft Windows Server 2003 Service Pack 2 | Yes | Yes |
| Windows Server 2003 x64 Edition and Microsoft Windows Server 2003 x64 Edition Service Pack 2 | No | Yes |
| Windows Server 2003 with SP1 for Itanium-based Systems and Microsoft Windows Server 2003 with SP2 for Itanium-based Systems | No | Yes |

For more information about MBSA, visit the [MBSA Web site](https://go.microsoft.com/fwlink/?linkid=21134). For more information about the software that Microsoft Update and MBSA 2.0 currently do not detect, see [Microsoft Knowledge Base Article 895660](https://support.microsoft.com/kb/895660).

**Windows Server Update Services**

By using Windows Server Update Services (WSUS), administrators can deploy the latest critical updates and security updates for Windows 2000 operating systems and later, Office XP and later, Exchange Server 2003, and SQL Server 2000 to Windows 2000 and later operating systems. For more information about how to deploy this security update using Windows Server Update Services, visit the [Windows Server Update Services Web site](https://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server**

The following table provides the SMS detection and deployment summary for this security update.

| Software | SMS 2.0 | SMS 2003 |
| --- | --- | --- |
| Microsoft Windows 2000 Service Pack 4 | Yes | Yes |
| Windows Server 2003 Service Pack 1 and Microsoft Windows Server 2003 Service Pack 2 | Yes | Yes |
| Windows Server 2003 x64 Edition and Microsoft Windows Server 2003 x64 Edition Service Pack 2 | No | Yes |
| Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | No | Yes |

SMS 2.0 and SMS 2003 Software Update Services (SUS) Feature Pack can use MBSA 1.2.1 for detection and therefore have the same limitation that is listed earlier in this bulletin related to programs that MBSA 1.2.1 does not detect.

For SMS 2.0, the SMS SUS Feature Pack, which includes the Security Update Inventory Tool (SUIT), can be used by SMS to detect security updates. SMS SUIT uses the MBSA 1.2.1 engine for detection. For more information about SUIT, visit the following [Microsoft Web site](https://support.microsoft.com/kb/894154/). For more information about the limitations of SUIT, see [Microsoft Knowledge Base Article 306460](https://support.microsoft.com/kb/306460/). The SMS SUS Feature Pack also includes the Microsoft Office Inventory Tool to detect required updates for Microsoft Office applications.

For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](https://update.microsoft.com/microsoftupdate) and that are supported by [Windows Server Update Services](https://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, visit the following [Microsoft Web site](https://go.microsoft.com/fwlink/?linkid=72181). SMS 2003 can also use the Microsoft Office Inventory Tool to detect required updates for Microsoft Office applications.

For more information about SMS, visit the [SMS Web site](https://go.microsoft.com/fwlink/?linkid=21158).

## Security Update Deployment

**Affected Software**

For information about the specific security update for your affected software, click the appropriate link:

#### Windows 2000 Server (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue may be included in a future update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | Windows 2000 Server Service Pack 4:\ Windows2000-kb926122-x86-enu /quiet |
| Installing without restarting | Windows 2000 Server Service Pack 4:\ Windows2000-kb926122-Windows2000sp4-x86-enu /norestart |
| Update log file | Windows 2000 Server Service Pack 4:\ KB926122.log |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required | You must restart your system after you apply this security update. |
| Hotpatching | Not applicable |
| **Removal Information** | Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB926122$\Spuninst folder |
| **File Information** | See the subsection, **File Information**, in this section for the full file manifest |
| **Registry Key Verification** | For Windows 2000 Server Service Pack 4:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB926122\Filelist |

#### File Information

The English version of this security update has the file attributes that are listed in the following table. The dates and times for these files are listed in coordinated universal time (UTC). When you view the file information, it is converted to local time. To find the difference between UTC and local time, use the **Time Zone** tab in the Date and Time tool in Control Panel.

For all supported editions of Windows 2000 Server:

| File Name | Version | Date | Time | Size |
| --- | --- | --- | --- | --- |
| ntdsa.dll | 5.0.2195.7135 | 22-Apr-2007 | 17:52 | 939,280 |
| sp3res.dll | 5.0.2195.7135 | 18-Apr-2007 | 16:36 | 6,239,232 |

**Note** For a complete list of supported versions and editions, see the Support Lifecycle Index. For a complete list of service packs, see [Lifecycle Supported Service Packs](https://support.microsoft.com/gp/lifesupsps). For more information on the support lifecycle policy, see [Microsoft Support Lifecycle](https://support.microsoft.com/lifecycle/).

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/overwriteoem** | Overwrites OEM files without prompting |
| **/nobackup** | Does not back up files needed for uninstall |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |
| **/extract[:path]** | Extracts files without starting the Setup program |
| **/ER** | Enables extended error reporting |
| **/verbose** | Enables verbose logging. During installation, creates %Windir%\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.

     **Note** Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.

     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
* **Registry Key Verification**

  You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the **Reference Table** in this section.

  These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.

#### Windows Server 2003 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | All supported 32-bit editions, x64 editions, and Itanium-based editions of Windows Server 2003:\ Windowsserver2003-kb926122-x86-enu /quiet |
| Installing without restarting | All supported 32-bit editions, x64 editions, and Itanium-based editions of Windows Server 2003:\ Windowsserver2003-kb926122-x86-enu /norestart |
| Update log file | KB926122.log |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required | You must restart your system after you apply this security update. |
| Hotpatching | This security update does not support HotPatching. For more information about HotPatching see [Microsoft Knowledge Base Article 897341](https://support.microsoft.com/kb/897341). |
| **Removal Information** | All supported 32-bit editions, x64 editions, and Itanium-based editions of Windows Server 2003:\ Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the Use the Spuninst.exe utility, located in the %Windir%$NTUninstallKB926122$\Spuninst folder |
| **File Information** | See the subsection, **File Information**, in this section for the full file manifest |
| **Registry Key Verification** | All supported 32-bit editions, x64 editions, and Itanium-based editions of Windows Server 2003:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB926122\Filelist |

#### File Information

The English version of this security update has the file attributes that are listed in the following table. The dates and times for these files are listed in coordinated universal time (UTC). When you view the file information, it is converted to local time. To find the difference between UTC and local time, use the **Time Zone** tab in the Date and Time tool in Control Panel.

For all supported 32-bit editions of Windows Server 2003:

| File Name | Version | Date | Time | Size | Folder |
| --- | --- | --- | --- | --- | --- |
| ntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 17:49 | 1,515,520 | SP1GDR |
| ntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 17:59 | 1,521,664 | SP1QFE |
| w03a2409.dll | 5.2.3790.2926 | 26-Apr-2007 | 22:22 | 27,648 | SP1QFE |
| ntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 18:04 | 1,522,176 | SP2GDR |
| ntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 17:53 | 1,522,176 | SP2QFE |
| w03a2409.dll | 5.2.3790.4070 | 27-Apr-2007 | 04:04 | 453,632 | SP2QFE |

For all supported x64 editions of Windows Server 2003:

| File Name | Version | Date | Time | Size | CPU | Folder |
| --- | --- | --- | --- | --- | --- | --- |
| ntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 19:02 | 2,946,560 | X64 | SP1GDR |
| Wntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 19:02 | 1,515,520 | X86 | SP1GDR\wow |
| ntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 19:02 | 2,964,992 | X64 | SP1QFE |
| w03a2409.dll | 5.2.3790.2926 | 29-Apr-2007 | 19:02 | 28,160 | X64 | SP1QFE |
| Wntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 19:02 | 1,521,664 | X86 | SP1QFE\wow |
| ww03a2409.dll | 5.2.3790.2926 | 29-Apr-2007 | 19:02 | 27,648 | X86 | SP1QFE\wow |
| ntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 19:04 | 2,966,528 | X64 | SP2GDR |
| Wntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 19:04 | 1,522,176 | X86 | SP2GDR\wow |
| ntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 18:59 | 2,966,528 | X64 | SP2QFE |
| w03a2409.dll | 5.2.3790.4070 | 29-Apr-2007 | 18:59 | 454,144 | X64 | SP2QFE |
| Wntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 18:59 | 1,522,176 | X86 | SP2QFE\wow |
| ww03a2409.dll | 5.2.3790.4070 | 29-Apr-2007 | 18:59 | 453,632 | X86 | SP2QFE\wow |

For all supported Itanium-based editions of Windows Server 2003:

| File Name | Version | Date | Time | Size | CPU | Folder |
| --- | --- | --- | --- | --- | --- | --- |
| ntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 18:58 | 4,237,312 | IA-64 | SP1GDR |
| Wntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 18:58 | 1,515,520 | X86 | SP1GDR\wow |
| ntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 18:59 | 4,250,624 | IA-64 | SP1QFE |
| w03a2409.dll | 5.2.3790.2926 | 29-Apr-2007 | 18:59 | 26,624 | IA-64 | SP1QFE |
| Wntdsa.dll | 5.2.3790.2926 | 29-Apr-2007 | 18:59 | 1,521,664 | X86 | SP1QFE\wow |
| ww03a2409.dll | 5.2.3790.2926 | 29-Apr-2007 | 18:59 | 27,648 | X86 | SP1QFE\wow |
| ntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 19:03 | 4,253,696 | IA-64 | SP2GDR |
| Wntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 19:03 | 1,522,176 | X86 | SP2GDR\wow |
| ntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 18:59 | 4,253,696 | IA-64 | SP2QFE |
| w03a2409.dll | 5.2.3790.4070 | 29-Apr-2007 | 18:59 | 452,608 | IA-64 | SP2QFE |
| Wntdsa.dll | 5.2.3790.4070 | 29-Apr-2007 | 18:59 | 1,522,176 | X86 | SP2QFE\wow |
| ww03a2409.dll | 5.2.3790.4070 | 29-Apr-2007 | 18:59 | 453,632 | X86 | SP2QFE\wow |

**Note** For a complete list of supported versions and editions, see the [Support Lifecycle Index](https://support.microsoft.com/gp/lifeselectindex/). For a complete list of service packs, see [Lifecycle Supported Service Packs](https://support.microsoft.com/gp/lifesupsps). For more information on the support lifecycle policy, see [Microsoft Support Lifecycle](https://support.microsoft.com/lifecycle/).

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks to see if one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/overwriteoem** | Overwrites OEM files without prompting |
| **/nobackup** | Does not back up files needed for uninstall |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |
| **/integrate:path** | Integrates the update into the Windows source files. These files are located at the path that is specified in the switch. |
| **/extract[:path]** | Extracts files without starting the Setup program |
| **/ER** | Enables extended error reporting |
| **/verbose** | Enables verbose logging. During installation, creates %Windir%\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |

**Verifying that the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.

     **Note** Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.

     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
* **Registry Key Verification**

  You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the **Reference Table** in this section.

  These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* Peter Winter-Smith of [NGSSoftware](https://www.nextgenss.com/), for reporting the Windows Active Directory Denial of Service Vulnerability-CVE-2007-3028.
* Neel Mehta of [IBM Internet Security Systems x-Force](https://xforce.iss.net/), for reporting the Windows Active Directory Remote Code Execution Vulnerability-CVE-2007-0040.

#### Support

* Customers in the U.S. and Canada can receive technical support from [Microsoft Product Support Services](https://go.microsoft.com/fwlink/?linkid=21131) at 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates.
* International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the [International Support Web site](https://go.microsoft.com/fwlink/?linkid=21155).

#### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (July 10, 2007): Bulletin published.

  V1.1 (July 12, 2007): Bulletin Revised: Updating bulletin to add FAQ section for ADAM dependencies and deployment to all 2000 and 2003 systems.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.vupen.com_8b5e2c51_20250124_234257.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


