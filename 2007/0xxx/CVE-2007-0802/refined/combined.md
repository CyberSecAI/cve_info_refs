=== Content from bugzilla.mozilla.org_93f1dd54_20250124_230813.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/367538)
* [XML](/show_bug.cgi?ctype=xml&id=367538)

Closed
[Bug 367538](/show_bug.cgi?id=367538)

Opened 18 years ago
Closed 17 years ago

# Firefox Phishing Protection bypass

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox Phishing Protection bypass

## Categories

### (Toolkit :: Safe Browsing, defect, P3)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Safe%20Browsing#Safe%20Browsing)

Safe Browsing
▾

Toolkit :: Safe Browsing
Safe Browsing UI and service (includes phishing protection).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Safe%20Browsing&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Safe%20Browsing&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Safe%20Browsing)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.0 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: kaneda, Assigned: tony)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f649648e89b7a08eaf922b4b24ed29d3?d=mm&size=40)  [tony](/user_profile?user_id=236963)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/cb93bd138e40ebb0735b2ab228ec2f1e?d=mm&size=40)  [kaneda](/user_profile?user_id=269928)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/bd10912fd8637cc64f00edd465ca8b0d?d=mm&size=40)  [dimi](/user_profile?user_id=468232)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

23 people

## References

### ( [URL](http://kaneda.bohater.net/security/20070111-firefox_2.0.0.1_bypass_phishing_protection.php "http://kaneda.bohater.net/security/20070111-firefox_2.0.0.1_bypass_phishing_protection.php") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[kaneda.bohater.net/security/20070111-...](http://kaneda.bohater.net/security/20070111-firefox_2.0.0.1_bypass_phishing_protection.php "http://kaneda.bohater.net/security/20070111-firefox_2.0.0.1_bypass_phishing_protection.php")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: verified1.8.1.12)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[verified1.8.1.12](/buglist.cgi?keywords=verified1.8.1.12&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [beltzner](/user_profile?user_id=137548) | [blocking-firefox3](#a24613261_137548 "17 years ago") | + |
| --- | --- | --- |
| [beltzner](/user_profile?user_id=137548) | blocking-firefox3 | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [blocking1.8.1.12](#a31112082_1689 "17 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.8.1.12 | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [check url and url with multiple slashes collapsed](/attachment.cgi?id=259472)  [18 years ago](#c20)  [Tony Chang (Google)](/user_profile?user_id=236963)   5.85 KB, patch | dcamp : [review+](#c28 "17 years ago")  dveditz : [approval1.8.1.12+](#c29 "17 years ago") | [Details](/attachment.cgi?id=259472&action=edit) | [Diff](/attachment.cgi?id=259472&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=367538&attachment=259472) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Kanedaaa](/user_profile?user_id=269928)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=367538#c0)• 18 years ago |
|  | |

User-Agent: Opera/9.10 (X11; Linux i686; U; en)
Build Identifier: 2.0.0.1 for Linux and 2.0.0.1 for Windows XP
It is possible to bypass Phishing Protection by add some characters to URL address. URL will be still valid and will work properly but we are not aware of Phishing warning.
When we add "/" char at the end of domain in URL field - for Phishing Protection it will be another site than original and Phishing Protection Test will fail. Example: When my URL is on Phishing List: <http://kaneda.bohater.net/phish.html> - warning will be displayed
<http://kaneda.bohater.net//phish.html> - warning will NOT be displayed
Of course we can add more "/".
Like live shows [Firefox HexEncoding Anti-Phishing bypass URL: <http://sla.ckers.org/forum/read.php?13,2253> ] Phishers can use this technique in near future to abusive actions.
Reproducible: Always
Steps to Reproduce:
1. Open url with more /// in URL address which is added to Phishing BlackList
2.
3.
Actual Results:
FireFox dosnt display AntiPhishing warning.
Expected Results:
Its should display AntiPhishing warning

|  | [Dave Townsend [:mossop]](/user_profile?user_id=91159) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=367538#c1)• 18 years ago |
|  | |

Im not sure this is really a problem. How many people add extra text to the url
they follow from a phishing email or such?
Sure the phishers can add extra text to get past the filter, but then they can
just change the url completely just as easily.

|  | [Kanedaaa](/user_profile?user_id=269928)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=367538#c2)• 18 years ago |
|  | |

Like in URL: <http://sla.ckers.org/forum/read.php?13,2253> we can see phishers are using this kind of technique.
When they are making mail with phishing address - they can add few "/" and they are sure that FireFox users [and Opera btw, but not IE] will be not protected via AntiPhishing technique. They can add "/" char every day and still use just one URL address, and this mean that this security is buggy IMHO.

|  | [Dave Townsend [:mossop]](/user_profile?user_id=91159) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=367538#c3)• 18 years ago |
|  | |

I cant actually see anything there that mentions that though I admit I havent taken the time to read it in full. However what it does point out is that the phishing list uses regex's so really this is something google can counteract with the list they provide.

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=367538#c4)• 18 years ago |
|  | |

The IP normalization was fixed in [bug 356355](/show_bug.cgi?id=356355 "VERIFIED FIXED - numeric domain normalization only happens on enchash table values") and live in Firefox 2.0.0.1.
The other cases (like adding a slash or query params) are handled by the enchash table which contains regular expressions. Using the goog-black-url list as an example doesn't reflect all the checks that take place. More information is on the wiki:
[http://wiki.mozilla.org/Phishing\_Protection:\_Server\_Spec#Encrypted\_Hash\_Format](http://wiki.mozilla.org/Phishing_Protection%3A_Server_Spec#Encrypted_Hash_Format)

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a585124_236963)• 18 years ago |

Status: UNCONFIRMED → RESOLVEDClosed: 18 years agoResolution: --- → INVALID

|  | [Rubén Martín [:Nukeador] ❌ [away till Aug 31st]](/user_profile?user_id=215534) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=367538#c5)• 18 years ago |
|  | |

Well, maybe it could be resolved using the google service, but what if you don't want to use it?
The problem persist, for example try these ones:
Normal one:
<http://www.mozilla.com/en-US/firefox/its-a-trap.html>
URL modified:
<http://www.mozilla.com/en-US//firefox//its-a-trap.html>

|  | [Rubén Martín [:Nukeador] ❌ [away till Aug 31st]](/user_profile?user_id=215534) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=367538#c6)• 18 years ago |
|  | |

A "real" example:
[http://202.64.93.106/www.paypal.com//cgi-bin/webscr\_cmd=\_login-run2652/](http://202.64.93.106/www.paypal.com//cgi-bin/webscr_cmd%3D_login-run2652/)
\*Notice the double // in the url, no phising alert... apparently but:
[http://202.64.93.106/www.paypal.com//cgi-bin/webscr\_cmd=\_login-run2652/](http://202.64.93.106/www.paypal.com//cgi-bin/webscr_cmd%3D_login-run2652/)
Same url without the double (intended) // in the url, and we get a phishing alert.
You can check the same behavior with any phishing site:
<http://sb.google.com/safebrowsing/update?version=goog-black-url:1:7753>
IMO the bug must be reopen.

|  | [Rubén Martín [:Nukeador] ❌ [away till Aug 31st]](/user_profile?user_id=215534) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=367538#c7)• 18 years ago |
|  | |

Sorry the correct phishing url without the double / is:
[http://202.64.93.106/www.paypal.com/cgi-bin/webscr\_cmd=\_login-run2652/](http://202.64.93.106/www.paypal.com/cgi-bin/webscr_cmd%3D_login-run2652/)
As you can see the phishing alert pops up.

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=367538#c8)• 18 years ago |
|  | |

Reopening.
Just tested with Firefox 2.0.0.1 with several real examples from my spam box :
<http://222.173.145.98/.bankofamerica.com/sas/profile/step1.htm>
triggers an alert
<http://222.173.145.98/.bankofamerica.com//sas/profile/step1.htm>
Does not trigger an alert
[Comment #4](/show_bug.cgi?id=367538#c4 "VERIFIED FIXED - Firefox Phishing Protection bypass") says that this is solved while having the google service activated, it is not, with google automatics url checking activated, the double-slash \*does\* bypass google antiphishing protection.
Furthermore, even if it were solved with a better server-side sanitization of the url, it wouldn't solve the problem for most of our users since Google URL check is not the default behaviour.
The URL should be sanitize with the removal of successive slashes \*before\* comparing it with the local list or google's online service.Status: RESOLVED → UNCONFIRMEDResolution: INVALID → ---

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a1556788_24572)• 18 years ago |

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=367538#c9)• 18 years ago |
|  | |

(In reply to [comment #8](/show_bug.cgi?id=367538#c8 "VERIFIED FIXED - Firefox Phishing Protection bypass"))
> [Comment #4](/show_bug.cgi?id=367538#c4 "VERIFIED FIXED - Firefox Phishing Protection bypass") says that this is solved while having the google service activated,
> it is not, with google automatics url checking activated, the double-slash
> \*does\* bypass google antiphishing protection.
Sorry, let me try to explain better. Urls are checked against two different lists. The first list (goog-black-url that you're getting the example from) is basically a simple string compare. Adding slashes will get around that list.
The second list contains regular expressions keyed on site domain names. This is the goog-black-enchash table that you're not including and looks like this:
<http://sb.google.com/safebrowsing/update?version=goog-black-enchash:1:17971>
A detailed explanation is provided in the wiki link above, but suffice it to say, since it uses regular expressions, it could be used to catch double slashes.
> The URL should be sanitize with the removal of successive slashes \*before\*
> comparing it with the local list or google's online service.
I believe that how double slashes are handled is a feature of the web server. I don't think it's always true that foo.com/bar/betz.html and foo.com/bar//betz.html will always resolve to the same page. Because of that, I think it's dangerous to do such canonicalizations.
Status: NEW → RESOLVEDClosed: 18 years ago → 18 years agoResolution: --- → INVALID

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=367538#c10)• 18 years ago |
|  | |

>I believe that how double slashes are handled is a feature of the web server.
>I don't think it's always true that foo.com/bar/betz.html and
>foo.com/bar//betz.html will always resolve to the same page. Because of that,
>I think it's dangerous to do such canonicalizations.
Indeed, in the case of using the mod\_rewrite apache module, slashes can mean different pages but that does not invalidate my point since we are not directing users to a different page but checking a sanitized URI to the locally/remotely stored list of phishing sites to provide the best information available to our users.
The reporter is demoing a documented way to easily bypass Firefox' antiphishing, you are saying that indeed this method works but that it is not a bug since it could \*potentially\* be fixed server-side. Either it is not a bug and then no improvement is required in the remote regex at all, or it is a bug and then it should not be resolved as INVALID. At worst, the bug should be resolved as WONTFIX as in "this is a known limitation to the antiphishing system and we do not intend to protect users from Phishing sites using this kind of URI masking technique".
Basically, my point is that if the user visits a page that we \*know\* is a phishing page, the phishing alarm should ring, whatever the syntax of the URI he clicked on to get to the page. If we know a page is a phishing site and we don't alert the user because it has an unusual request-URI, IMO we are doing the wrong thing and there is room for enhancement in this area.Resolution: INVALID → FIXED

|  | [Rubén Martín [:Nukeador] ❌ [away till Aug 31st]](/user_profile?user_id=215534) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=367538#c11)• 18 years ago |
|  | |

Tony said,
> A detailed explanation is provided in the wiki link above, but suffice it to
say, since it uses regular expressions, it could be used to catch double
slashes.
It could be used or it will be used to catch them?
I think this problem is more serious than we think, phishing attackers use all in their hands to bypass phishing filters, url obfuscation or the double slashes are two examples.
Firefox is the only browser that fails with this, Opera's latest compilation has corrected this issue and IE is immune.
So, what we are going to to?

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=367538#c12)• 18 years ago |
|  | |

(In reply to [comment #11](/show_bug.cgi?id=367538#c11 "VERIFIED FIXED - Firefox Phishing Protection bypass"))
> It could be used or it will be used to catch them?
>
> I think this problem is more serious than we think, phishing attackers use all
> in their hands to bypass phishing filters, url obfuscation or the double
> slashes are two examples.
I think the plan going forward is to move everything from goog-black-url to goog-black-enchash and have regular expressions for everything. This will catch more small variations in URLs. This can be done on the server and doesn't require changes to the client code.

|  | [Rubén Martín [:Nukeador] ❌ [away till Aug 31st]](/user_profile?user_id=215534) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=367538#c13)• 18 years ago |
|  | |

(In reply to [comment #12](/show_bug.cgi?id=367538#c12 "VERIFIED FIXED - Firefox Phishing Protection bypass"))
> I think the plan going forward is to move everything from goog-black-url to
> goog-black-enchash and have regular expressions for everything. This will
> catch more small variations in URLs. This can be done on the server and
> doesn't require changes to the client code.
And this will solve the problem to users who don't use/don't want to use the antiphising feature using google service?

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=367538#c14)• 18 years ago |
|  | |

(In reply to [comment #13](/show_bug.cgi?id=367538#c13 "VERIFIED FIXED - Firefox Phishing Protection bypass"))
>
> And this will solve the problem to users who don't use/don't want to use the
> antiphising feature using google service?
Yes, this will work for anyone with phishing protection enabled. The "check using a downloaded list of suspected sites" option uses the goog-black-url and goog-black-enchash tables.

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a1891884_76551)• 18 years ago |

OS: Linux → AllHardware: PC → All

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=367538#c15)• 18 years ago |
|  | |

This bug is definitely not fixed! It is still possible to add additional slashes to circumvent the phishing filter. Tested with Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.2pre) Gecko/20070221 BonEcho/2.0.0.2pre ID:2007022104.
I opened an URL from the blacklist (which was mentioned in [comment 6](/show_bug.cgi?id=367538#c6 "VERIFIED FIXED - Firefox Phishing Protection bypass")) and got the phishing alert message:
<http://www.deutsche-bank.de.pbcank_id06997591.allroe.biz/kunden/>
After adding a slash no more warning is visible:
<http://www.deutsche-bank.de.pbcank_id06997591.allroe.biz//kunden/>
This should be fixed immediately. And please don't close this bug again until it's really fixed.Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a3331674_24572)• 18 years ago |

URL: [http://kaneda.bohater.net/security/20...](http://kaneda.bohater.net/security/20070111-firefox_2.0.0.1_bypass_phishing_protection.php)

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=367538#c16)• 18 years ago |
|  | |

Mike and Benjamin, who is responsible to fix this issue? There is no response from Google for a longer time and this issue is still present!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a5104204_1689)• 18 years ago |

Assignee: nobody → tonyStatus: REOPENED → NEW

|  | [Hideki Yamane](/user_profile?user_id=275017) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=367538#c17)• 18 years ago |
|  | |

Hi, I'm using iceweasel 2.0.0.3-1 in Debian unstable.
I've checked it with phishing URI,
<http://carovoip.oriontel.com.ar/a2billing/Public/wells/mn1_da2_on/cgi-bin/session.php>
and it warns.
Even if I've added a slash with that URI, it also warns to me.
<http://carovoip.oriontel.com.ar//a2billing/Public/wells/mn1_da2_on/cgi-bin/session.php>
...and visited that URI but changed it from domain name to ip address, <http://200.63.71.35/a2billing/Public/wells/mn1_da2_on/cgi-bin/session.php> ,
no more warning.

|  | [Kanedaaa](/user_profile?user_id=269928)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=367538#c18)• 18 years ago |
|  | |

Now its depends from something probably, for example:
dont warn:
<http://alumnisec.com.ve//circulares/new.egg.com/security/customer/>
warn:
<http://alumnisec.com.ve/circulares/new.egg.com/security/customer/>
warn:
<http://71.10.211.161:81/cgi-bin-sk/webscr.php?dispatch=5885d80a13c0db1fa28a1d10438a80ebc99745074d>
warn:
<http://71.10.211.161:81//cgi-bin-sk/webscr.php?dispatch=5885d80a13c0db1fa28a1d10438a80ebc99745074d>

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=367538#c19)• 18 years ago |
|  | |

Lookups in goog-black-enchash (the regular expression list) now handle double slashes. I'll be making a patch to have lookups in goog-black-url also handle double slashes.Status: NEW → ASSIGNED

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=367538#c20)• 18 years ago |
|  | |

Attached patch

[check url and url with multiple slashes collapsed](attachment.cgi?id=259472&action=diff)
— [Details](attachment.cgi?id=259472&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=367538&attachment=259472)

This patch also removes the extra lookup that was needed for looking up non-normalized IP addresses (see [bug 356355](/show_bug.cgi?id=356355 "VERIFIED FIXED - numeric domain normalization only happens on enchash table values")). It's no longer needed because the server normalizes all numeric addresses.
[Attachment #259472](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") -
Flags: review?(bryner)

|  | [AndrewM](/user_profile?user_id=251691) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=367538#c21)• 17 years ago |
|  | |

This still seems to be a problem in nightlies (for instance, try <http://www.mozilla.com/firefox//its-a-trap.html>), should this make Firefox 3?Flags: blocking-firefox3?

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a24460414_159758)• 17 years ago |

[Attachment #259472](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") -
Flags: review?(gavin.sharp)

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=367538#c22)• 17 years ago |
|  | |

IMO this should be critical. User don't get warned when they open such a modified website and can lose identity data. It should be fixed ASAP. This bug is still open too long. No idea if phishing sites already use that way to circumvent the built-in filter.Severity: major → criticalVersion: unspecified → Trunk

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a24490246_76551)• 17 years ago |

Summary: Firefox 2.0.0.1 Phishing Protection bypass → Firefox Phishing Protection bypass

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a24613261_137548)• 17 years ago |

Flags: blocking-firefox3? → blocking-firefox3+

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=367538#c23)• 17 years ago |
|  | |

The majority of our users who can be affected by this bug are using Firefox 2. Asking approval for 1.8.1.10 to get closed this hole ASAP.Flags: blocking1.8.1.10?

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=367538#c24)• 17 years ago |
|  | |

Comment on [attachment 259472](/attachment.cgi?id=259472 "check url and url with multiple slashes collapsed") [[details]](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") [[diff]](/attachment.cgi?id=259472&action=diff "check url and url with multiple slashes collapsed") [[review]](/page.cgi?id=splinter.html&ignore=&bug=367538&attachment=259472)
check url and url with multiple slashes collapsed
This patch is obsolete. We no longer use multiple table types (url, enchash, domain), it's all in a single table hashed table now. See [bug 387196](/show_bug.cgi?id=387196 "RESOLVED FIXED - support the new google safebrowsing protocol").
[Attachment #259472](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") -
Attachment is obsolete: true
[Attachment #259472](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") -
Flags: review?(gavin.sharp)
[Attachment #259472](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") -
Flags: review?(bryner)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=367538#c25)• 17 years ago |
|  | |

Comment on [attachment 259472](/attachment.cgi?id=259472 "check url and url with multiple slashes collapsed") [[details]](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") [[diff]](/attachment.cgi?id=259472&action=diff "check url and url with multiple slashes collapsed") [[review]](/page.cgi?id=splinter.html&ignore=&bug=367538&attachment=259472)
check url and url with multiple slashes collapsed
But it wouldn't be obsolete for fixing this issue on the 1.8 branch

|  | [Mike Connor [:mconnor]](/user_profile?user_id=96908) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a25205526_96908)• 17 years ago |

Target Milestone: --- → Firefox 3 M10

|  | [Mike Connor [:mconnor]](/user_profile?user_id=96908) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a25401793_96908)• 17 years ago |

Priority: -- → P3Target Milestone: Firefox 3 M10 → Firefox 3 M11

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=367538#c26)• 17 years ago |
|  | |

Tony: should we land this patch on the 1.8 branch

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=367538#c27)• 17 years ago |
|  | |

Comment on [attachment 259472](/attachment.cgi?id=259472 "check url and url with multiple slashes collapsed") [[details]](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") [[diff]](/attachment.cgi?id=259472&action=diff "check url and url with multiple slashes collapsed") [[review]](/page.cgi?id=splinter.html&ignore=&bug=367538&attachment=259472)
check url and url with multiple slashes collapsed
I think it's pretty low risk, so sending to dave for review.
[Attachment #259472](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") -
Attachment is obsolete: false
[Attachment #259472](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") -
Flags: review?(dcamp)

|  | [Dave Camp (:dcamp)](/user_profile?user_id=265995) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=367538#c28)• 17 years ago |
|  | |

Comment on [attachment 259472](/attachment.cgi?id=259472 "check url and url with multiple slashes collapsed") [[details]](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") [[diff]](/attachment.cgi?id=259472&action=diff "check url and url with multiple slashes collapsed") [[review]](/page.cgi?id=splinter.html&ignore=&bug=367538&attachment=259472)
check url and url with multiple slashes collapsed
looks good to me
[Attachment #259472](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") -
Flags: review?(dcamp) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a31112082_1689)• 17 years ago |

Flags: blocking1.8.1.12? → blocking1.8.1.12+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=367538#c29)• 17 years ago |
|  | |

Comment on [attachment 259472](/attachment.cgi?id=259472 "check url and url with multiple slashes collapsed") [[details]](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") [[diff]](/attachment.cgi?id=259472&action=diff "check url and url with multiple slashes collapsed") [[review]](/page.cgi?id=splinter.html&ignore=&bug=367538&attachment=259472)
check url and url with multiple slashes collapsed
approved for 1.8.1.12, a=dveditz for release-drivers
[Attachment #259472](/attachment.cgi?id=259472&action=edit "check url and url with multiple slashes collapsed") -
Flags: approval1.8.1.12+

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a31145850_76551)• 17 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)Whiteboard: checkin-needed (1.8 branch)

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=367538#c30)• 17 years ago |
|  | |

Checking in content/enchash-decrypter.js;
/cvsroot/mozilla/toolkit/components/url-classifier/content/enchash-decrypter.js,v <-- enchash-decrypter.js
new revision: 1.1.2.8; previous revision: 1.1.2.7
done
Checking in content/trtable.js;
/cvsroot/mozilla/toolkit/components/url-classifier/content/trtable.js,v <-- trtable.js
new revision: 1.1.2.9; previous revision: 1.1.2.8
done
Status: ASSIGNED → RESOLVEDClosed: 18 years ago → 17 years agoKeywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---) → [fixed1.8.1.12](/buglist.cgi?keywords=fixed1.8.1.12&resolution=---)Resolution: --- → FIXEDWhiteboard: checkin-needed (1.8 branch)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=367538#c31)• 17 years ago |
|  | |

I see no difference of behavior between nightly branch builds of 1.8.1.12 and released 2.0.0.11 with <http://www.mozilla.com/firefox//its-a-trap.html>.

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=367538#c32)• 17 years ago |
|  | |

The test URLs are hardcoded and go through a different code path. They were originally put in place to test the UI, not the url classifier. Try picking one of the URLs from <http://sb.google.com/safebrowsing/update?version=goog-black-url:1:-1>

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=367538#c33)• 17 years ago |
|  | |

Thanks Tony. Phishing protection works with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.12pre) Gecko/20080122 BonEcho/2.0.0.12pre
But why I don't get the warning with latest Firefox 3 nightly builds at all? I believe the same list of websites is used for different browser versions? Firefox 3 never warns the user when opening a website listed on your mentioned black list.
=> REOPENStatus: RESOLVED → REOPENEDKeywords: [fixed1.8.1.12](/buglist.cgi?keywords=fixed1.8.1.12&resolution=---) → [verified1.8.1.12](/buglist.cgi?keywords=verified1.8.1.12&resolution=---)Resolution: FIXED → ---

|  | [Tony Chang (Google)](/user_profile?user_id=236963)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=367538#c34)• 17 years ago |
|  | |

Firefox 3 uses a completely different protocol for sending the phishing/malware data. The list I pointed out above isn't used in Firefox 3. If there are bugs in FF3, they should be in a separate bug.Status: REOPENED → RESOLVEDClosed: 17 years ago → 17 years agoResolution: --- → FIXED

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=367538#c35)• 17 years ago |
|  | |

Tony, where can I find the list of phishing sites which should be used for Fx3? If I can reproduce it that Fx3 doesn't show a warning, I'll file a new bug.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=367538#c36)• 17 years ago |
|  | |

When I go to:
<http://inferplus.com/cache/www3.netbank.commbank.com.au/www3.netbank.commbank.com.au/www3.netbank.commbank.com.au/www3.netbank.commbank.com.au/www3.netbank.commbank.com.au/www3.netbank.commbank.com.au/www3.netbank.commbank.com.au/update/logon.htm>
in Firefox 2.0.0.11, I get told it is a forgery. If I go in the 2.0.0.12 nightly from last night, I do not get told. I just did this side by side with clean profiles.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=367538#c37)• 17 years ago |
|  | |

Ok, profile must have been downloading the list.
If I use <http://classifiedsphilippines.com/userimgs/dert.htm>, I get warnings in both 2.0.0.11 and the 2.0.0.12 nightly. I can't make the bug happen by adding '/' in 2.0.0.11 though.

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=367538#c38)• 17 years ago |
|  | |

As mentioned before this was a Firefox 2 issue only. Adjusting flags to reflect reality.Status: RESOLVED → VERIFIEDTarget Milestone: Firefox 3 M11 → ---Version: Trunk → 2.0 Branch

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=367538#a231973889_1)• 11 years ago |

Product: Firefox → Toolkit
You need to [log in](/show_bug.cgi?id=367538&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tony Chang (Google)](/user_profile?user_id=236963)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


