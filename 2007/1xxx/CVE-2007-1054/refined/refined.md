Based on the provided information, here's an analysis of CVE-2007-1054:

**Root Cause of Vulnerability:**

*   The vulnerability is a Cross-Site Scripting (XSS) issue within the AJAX functionality of MediaWiki.
*   The root cause lies in insufficient input sanitization within the `action=ajax` parameter, specifically when handling the `rs` parameter.

**Weaknesses/Vulnerabilities Present:**

*   **Cross-Site Scripting (XSS):** The core vulnerability is XSS. This allows an attacker to inject malicious scripts into web pages viewed by other users.
*   **UTF-7 Encoding Bypass:** The initial fix for the XSS vulnerability could be bypassed by encoding the malicious script using UTF-7 encoding. This is due to how some browsers, particularly Internet Explorer, handle character encoding.
*   **Lack of proper input validation:** The application was not properly validating or sanitizing user-supplied input within the `rs` parameter when the `action=ajax` parameter is present.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** Successful exploitation can lead to arbitrary JavaScript execution in the victim's browser.
*   **Session Hijacking:** An attacker could potentially steal session cookies, enabling them to hijack user accounts.
*   **Phishing:** The attacker could redirect users to malicious websites, potentially for credential harvesting.
*   **Defacement:** An attacker could alter the content displayed on the page.

**Attack Vectors:**

*   **URL Injection:** The primary attack vector is through crafted URLs. By manipulating the `rs` parameter in a URL like `http://[Host]/wiki/index.php?action=ajax&rs=[XSS]`, an attacker can inject malicious code.

**Required Attacker Capabilities/Position:**

*   **Ability to Craft URLs:** The attacker needs the ability to construct a malicious URL with the proper encoding and injected code.
*   **Target User Interaction:** The attacker needs to get the victim to visit the crafted URL, typically through links in emails, messages, or other web pages.
*   **Target Browser:** Specifically, the UTF-7 bypass exploit depends on the browser's ability to auto-detect the character set which IE was vulnerable to.

**Technical Details**
*   The vulnerability affected MediaWiki versions 1.8.2 and below with a plain XSS attack.
*   The XSS was fixed in later versions (1.8.3, 1.9.0rc2, 1.9.0, 1.9.1, 1.9.2) but can be bypassed with UTF-7 encoding when the browser's auto-detection feature is enabled.
*   The parameter exploited is 'rs' within the 'action=ajax' call

**Example Exploits**

*   `http://[Host]/wiki/index.php?action=ajax&rs=%3Cscript%3Ewindow.open('http://www.bugsec.com')%3C/script%3E` (for v1.8.2 and below)
*   `http://[Host]/wiki/index.php?action=ajax&rs=+ADw-SCRIPT+AD4-window.open('http://www.bugsec.com');+ADw-/SCRIPT+AD4-` (UTF-7 encoded)
*   `http://[Host]/wiki/index.php?action=ajax&rs=%2B%41%44%77%2D%53%43%52%49%50%54%2B%41%44%34%2D%61%6C%65%72%74%28%27%58%53%53%27%29%3B%2B%41%44%77%2D%2F%53%43%52%49%50%54%2B%41%44%34%2D` (URL encoded UTF-7)

**Additional Notes:**

*   The `wgUseAjax` setting in MediaWiki must be enabled for the vulnerability to be exploitable. While it is stated that this is enabled by default this is not correct according to the provided text.
*   The vulnerability was publicly disclosed on the Bugtraq mailing list.
*   The fix involved proper handling of user input to prevent injection of malicious JavaScript code.

The provided content contains more detail than the official CVE description, including specific examples and the encoding bypass technique.