```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from a SQL injection flaw in the `abget_blocked` function of the NukeSentinel module due to insufficient sanitization of the `Client-IP` HTTP header.",
    "weaknesses": [
      "SQL Injection",
      "Insufficient input sanitization",
	  "File disclosure"
    ],
    "impact": "An attacker can exploit this vulnerability to disclose arbitrary files on the server by manipulating the `Client-IP` header. This allows reading sensitive files such as configuration files and potentially other files on the server.",
    "attack_vectors": [
      "HTTP Header Manipulation",
      "SQL Injection"
    ],
    "required_capabilities": "The attacker needs to be able to send HTTP requests with a modified `Client-IP` header to the vulnerable web server."
  },
  "additional_details": "The exploit works by injecting SQL code into the `Client-IP` header, which is then used in a SQL query within the `abget_blocked` function. This allows the attacker to control the SQL query and subsequently the data retrieved. The vulnerability is triggered when the `blocked` function calls `abget_blockerrow` and `abget_template`, eventually leading to the arbitrary file disclosure. The provided exploit code constructs a specific SQL injection string and adds it to the `Client-IP` header to trigger the vulnerability. The `mysqlchar` function is used to encode SQL commands within the header and prevent filtering. A regex check on the client IP is bypassed by prepending a valid IP address to the SQL injection payload."
}
```