=== Content from marc.info_3f582b06_20250125_164446.html ===

```
[[prev in list](?l=full-disclosure&m=117259893202735&w=2)] [[next in list](?l=full-disclosure&m=117259910724199&w=2)] [[prev in thread](?l=full-disclosure&m=117259893202735&w=2)] [[next in thread](?l=bugtraq&m=117259476131602&w=2)]
List:       [full-disclosure](?l=full-disclosure&r=1&w=2)
Subject:    [Re: [Full-disclosure] Firefox onUnload + document.write() memory](?t=117219465400001&r=1&w=2)
From:       [Michal Zalewski <lcamtuf () dione ! ids ! pl>](?a=93644469700001&r=1&w=2)
Date:       [2007-02-27 13:29:11](?l=full-disclosure&r=1&w=2&b=200702)
Message-ID: [Pine.LNX.4.58.0702271423130.21707 () dione](?i=Pine.LNX.4.58.0702271423130.21707%20()%20dione)
[Download RAW [message](?l=full-disclosure&m=117258301222007&q=mbox) or [body](?l=full-disclosure&m=117258301222007&q=raw)]

On Tue, 27 Feb 2007, Richard Moore wrote:

> <html>
> <body onunload="location = self.location">
> <a href="<http://slashdot.org/>"><http://slashdot.org/></a>
> </body>
> </html>

Yeah, and the other way round: <http://lcamtuf.coredump.cx/ietrap/>, when
used with FF 2.0.0.2, puts you on a page that:

  1) Has URL bar data and favicon from the target site,
  2) Views source of what you added with document.write(),
  3) Displays as blank.

Moreover, repeatedly setting document.location = "xxx"; on departure may
land you at slashdot.org/xxx instead (meaning the update is being
performed in the context of the new page).

Although this looks like a Really Bad Thing (tm), I didn't succeed in
modifying /ietrap/ to display a malicious payload (though feels like it's
sooo close), nor in manipulating DOM in the latter example to do anything
other than annoying the user (because 2.0.0.1 kept crashing ;-). Still,
I'm not gonna sleep well until this is fixed.

/mz

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
[[prev in list](?l=full-disclosure&m=117259893202735&w=2)] [[next in list](?l=full-disclosure&m=117259910724199&w=2)] [[prev in thread](?l=full-disclosure&m=117259893202735&w=2)] [[next in thread](?l=bugtraq&m=117259476131602&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_ac402443_20250125_164447.html ===

```
[[prev in list](?l=full-disclosure&m=117258989310711&w=2)] [[next in list](?l=full-disclosure&m=117259876724287&w=2)] [[prev in thread](?l=bugtraq&m=117259476131602&w=2)] [next in thread]
List:       [full-disclosure](?l=full-disclosure&r=1&w=2)
Subject:    [Re: [Full-disclosure] Firefox onUnload + document.write() memory](?t=117219465400001&r=1&w=2)
From:       [Richard Moore <rich () westpoint ! ltd ! uk>](?a=103764047900001&r=1&w=2)
Date:       [2007-02-27 16:05:16](?l=full-disclosure&r=1&w=2&b=200702)
Message-ID: [45E456BC.4050601 () westpoint ! ltd ! uk](?i=45E456BC.4050601%20()%20westpoint%20!%20ltd%20!%20uk)
[Download RAW [message](?l=full-disclosure&m=117259225402112&q=mbox) or [body](?l=full-disclosure&m=117259225402112&q=raw)]

Resent as I realised I'm not subscribed here

Michal Zalewski wrote:
> I can't really comment on whether
> this fixes the problem once and for all, because I haven't really examined
> the changes implemented for 364692, but yeah, my example no longer crashes
> the browser for me.

I think there are still underlying problems in the code as the
following illustrates:

1. Put this in a web page, then view it in firefox.

<html>
<body onunload="location = self.location">
<a href="<http://slashdot.org/>"><http://slashdot.org/></a>
</body>
</html>

2. Click on the link which should take you to slashdot and you'll end
up back where you were (this has been known about for ages).

3. Now do 'View Source' and you get shown the sourcecode to slashdot
rather than the source code for the page you're viewing.

Actual Results:
View source displays the contents of the wrong site

Expected Results:
I'd expect to see the source code for the page I'm viewing.

A web page could trigger the link itself using DOM events (or naviagate
away using javascript form submission) and use this technique to hide
the source code of a malicious page from the user. I did a quick check
that document.cookie wasn't chcking the wrong URL, but I have not
checked extensively which other parts of the browser can be spoofed
in this fashion.

I reported this via bugzilla, but it was closed as a duplicate of bug
253497 which was reported in 2004.

Cheers

Rich.
--
Richard Moore, Principal Software Engineer,
Westpoint Ltd,
Albion Wharf, 19 Albion Street, Manchester, M1 5LN, England
Tel: +44 161 237 1028
Fax: +44 161 237 1031

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
[[prev in list](?l=full-disclosure&m=117258989310711&w=2)] [[next in list](?l=full-disclosure&m=117259876724287&w=2)] [[prev in thread](?l=bugtraq&m=117259476131602&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


