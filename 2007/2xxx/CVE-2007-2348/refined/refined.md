```
{
  "CVE-2007-2348": [
    {
      "Root cause of vulnerability": "lftp did not properly escape shell metacharacters when generating shell scripts using the `mirror --script` command.",
      "Weaknesses/vulnerabilities present": "Improperly quoted shell commands in scripts generated by `mirror --script`.",
      "Impact of exploitation": "An attacker controlling a malicious FTP server could execute arbitrary commands on a user's system by tricking them into running a crafted lftp script generated using the `mirror --script` command.",
      "Attack vectors": "A malicious FTP server provides a file structure containing symbolic links with special characters in their names. The user uses `lftp mirror --script` to generate a script to download the files. The user then executes the generated script.",
      "Required attacker capabilities/position": "Attacker needs to control an FTP server and the user needs to be tricked into running the malicious script generated with lftp."
    },
    {
      "Root cause of vulnerability": "The `mirror --script` command in lftp generates shell scripts without properly escaping the names and targets of symbolic links.",
      "Weaknesses/vulnerabilities present": "Inadequate input sanitization or escaping of symbolic link names and targets in shell scripts.",
       "Impact of exploitation": "A malicious actor could craft symbolic links to include shell commands. If a user runs an lftp script generated by the `mirror --script` command containing these malicious links, those commands would execute as the user.",
      "Attack vectors": "Attacker sets up a malicious FTP server containing specially crafted symbolic links. The victim then uses `lftp mirror --script` to generate a script, and then executes that script.",
      "Required attacker capabilities/position": "The attacker needs to control a malicious FTP server. The victim must execute the generated script."
    }
  ]
}
```