```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2007-2165",
      "description": "The Auth API in ProFTPD before 20070417, when multiple simultaneous authentication modules are configured, does not require that the module that checks authentication is the same as the module that retrieves authentication data, which might allow remote attackers to bypass authentication, as demonstrated by use of SQLAuthTypes Plaintext in mod_sql, with data retrieved from /etc/passwd.",
      "root_cause": "ProFTPD's Auth API allows different modules to handle user data retrieval and authentication, leading to inconsistencies and potential bypass.",
      "weaknesses": [
        "The Auth API does not enforce that the same module which provides user data also performs the authentication.",
        "Use of `SQLAuthTypes Plaintext` allows for simple string comparison during authentication."
      ],
      "impact": "Remote attackers can bypass authentication and gain unauthorized access by using a less strict authentication policy configured in one module while another module provides user data.  For example, if `SQLAuthTypes Plaintext` is used, a system user can log in with a password of `!` or `*` despite having a disabled password in `/etc/shadow`.",
      "attack_vector": "Remote network access via the FTP protocol.",
       "required_capabilities": "An attacker needs to have network access to the FTP service and knowledge of system user accounts. The attacker also needs to know the password of the system account in the case of plaintext authentication."
    },
        {
      "cve_id": "CVE-2007-2165",
      "description": "proftpd allows logins with almost no password if configured with SQLAuthTypes Plaintext",
      "root_cause": "When `SQLAuthTypes Plaintext` is enabled, proftpd uses a simple string comparison for authentication, ignoring the disabled passwords (e.g., `!` or `*`) in `/etc/shadow` for system users.",
        "weaknesses": [
          "The `SQLAuthTypes Plaintext` setting allows authentication with any string matching the stored password, even special characters like `!` or `*` used to indicate disabled passwords.",
          "ProFTPD does not validate the password against the system's shadow file when using plaintext authentication for system accounts."
        ],
      "impact": "An attacker can gain unauthorized access to system accounts by using disabled password values such as `!` or `*` as the password if plaintext authentication is enabled, potentially leading to arbitrary actions on the server.",
      "attack_vector": "Remote network access via the FTP protocol.",
       "required_capabilities": "An attacker requires network access to the FTP server and knowledge of a valid user in the system as well as knowledge that the server uses `SQLAuthTypes Plaintext`."
    }
  ]
}
```