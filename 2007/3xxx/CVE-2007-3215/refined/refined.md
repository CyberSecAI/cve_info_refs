```
{
  "CVE-2007-3215": {
    "description": "The PHPMailer class, when configured to use sendmail, is vulnerable to remote command execution due to a lack of input validation. The sendmail command is constructed using non-escaped user input, allowing for the execution of arbitrary shell commands.",
    "vulnerability_details": {
      "root_cause": "Insufficient input validation when constructing the sendmail command.",
      "weaknesses": [
        "Use of `sprintf` with user-controlled data in shell command construction",
        "Lack of input sanitization of the `Sender` and `Sendmail` variables"
      ],
      "impact": "Remote command execution. An attacker can execute arbitrary shell commands on the server.",
      "attack_vector": "By manipulating the `Sender` parameter when PHPMailer is configured to use Sendmail.",
      "attacker_capabilities": "The attacker needs to be able to trigger an email being sent by the vulnerable application, likely through user-controllable inputs that ultimately influence the `Sender` or `Sendmail` variables.",
       "affected_versions": "PHPMailer versions before the fix. Specifically mentioned is vTiger CRM 5.2.1 and below (which uses a vulnerable version of phpmailer)."
    },
        "Workaround": "The flawed code portion can be patched with:\n393: $sendmail = sprintf(\"%s -oi -f %s -t\", escapeshellcmd($this->Sendmail), escapeshellarg($this->Sender));\n395: $sendmail = sprintf(\"%s -oi -t\", escapeshellcmd($this->Sendmail));"
  }
}
```