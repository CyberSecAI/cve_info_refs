```
{
  "CVE-2007-3732": {
    "Description": "In Linux 2.6 before 2.6.23, the TRACE_IRQS_ON function in iret_exc calls a C function without ensuring that the segments are set properly. The kernel's %fs needs to be restored before the call in TRACE_IRQS_ON and before enabling interrupts, so that \"current\" references work. Without this, \"current\" used in the window between iret_exc and the middle of error_code where %fs is reset, would crash.",
    "Root cause of vulnerability": "The TRACE_IRQS_ON function in iret_exc calls a C function without ensuring that the segments are set properly.",
    "Weaknesses/vulnerabilities": "The kernel's %fs segment is not restored before calling a C function in TRACE_IRQS_ON and before enabling interrupts.",
    "Impact of exploitation": "A crash due to incorrect \"current\" references during the window between iret_exc and the middle of error_code, where %fs is not yet reset.",
    "Attack vectors": "The vulnerability occurs during the iret_exc fixup path when iret generates an exception due to bogus %cs:%eip or %ss:%esp on the way back to user mode.",
    "Required attacker capabilities/position": "An attacker can trigger the vulnerability by causing an exception during a return to user mode via the iret instruction with invalid segment registers. This could possibly be achieved through ptrace manipulation."
  }
}
```