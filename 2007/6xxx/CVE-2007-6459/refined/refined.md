- **Root cause of vulnerability**: The vulnerability stems from the insecure use of the `system()` function in `diagdns.php` and `diagconnect.php` within the Anon Proxy Server application. The application does not properly sanitize user-provided input passed to the `host` parameter, allowing for command injection. The application enables `magic_quotes_gpc=on`, which does not protect `system()` from taint.
- **Weaknesses/vulnerabilities present**: Remote Command Execution vulnerability due to insufficient input sanitization.
- **Impact of exploitation**: An attacker can execute arbitrary system commands on the server hosting the vulnerable application.
- **Attack vectors**: By sending a crafted HTTP GET request to `diagdns.php` or `diagconnect.php` with malicious commands injected into the `host` parameter.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the server hosting the vulnerable application, and needs to know the path to the `diagdns.php` and `diagconnect.php` files.