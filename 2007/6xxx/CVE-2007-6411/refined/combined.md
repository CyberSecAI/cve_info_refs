=== Content from cxsecurity.com_1bb9d0a7_20250126_125203.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_d640b53e_20250126_125202.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_a4a3d2dc_20250126_125204.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_25521515_20250125_234415.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Gadu-Gadu Local/Remote Buffer Overflow vulnerability** **2007.12.17** Credit:  **[j00ru](https://cxsecurity.com/author/j00ru/1/)**  Risk: **High** Local: ****Yes**** Remote: ****Yes**** CVE: **[CVE-2007-6411](https://cxsecurity.com/cveshow/CVE-2007-6411/ "Click to see CVE-2007-6411")** CWE: **[CWE-119](https://cxsecurity.com/cwe/CWE-119 "CWE-119")**  CVSS Base Score: **4.3/10** Impact Subscore: **2.9/10** Exploitability Subscore: **8.6/10** Exploit range: **Remote** Attack complexity: **Medium** Authentication: **No required** Confidentiality impact: **None** Integrity impact: **None** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

Team Vexillium
Security Advisory
http://vexillium.org/
Name : Gadu-Gadu
Class : Buffer Overflow
Threat level : VERY HIGH
Discovered : 2007-11-10
Published : 2007-11-22
Credit : j00ru//vx
Vulnerable : Gadu-Gadu 7.7 [Build 3669], prior versions may also be affected.
==[ Abstract ]==
Gadu-Gadu is a free internet communicator used by milions of polish people.
It allows to talk, hear and even see other internauts through the net.
It also supports the possibility to express feelings using some provided
emoticons. These emoticons' strings with associated graphic filenames are
stored in "emots.txt" file.
The GG Client is vulnerable to a buffer overflow attack, in the code
that moves the "emots.txt" file data to some local buffers. The program
doesn't check if the size of data to move is not greater than the size
of the destination buffer. Successful exploitation may lead to arbitrary
code execution or the process' denial of service (gg.exe termination).
==[ Details ]==
Function vulnerable to the attack is placed at the 0x00443CE2 address:
.text:00443CE2 HandleEmotsConfig proc near ; CODE XREF: sub\_4A55F6:loc\_4A5C90p
.text:00443CE2 mov eax, offset loc\_561ECC
.text:00443CE7 call \_\_EH\_prolog
.text:00443CEC mov eax, 26588
.text:00443CF1 call \_\_alloca\_probe
.text:00443CF6 push ebx
.text:00443CF7 lea eax, [ebp-24h]
.text:00443CFA push esi
.text:00443CFB push eax
.text:00443CFC call sub\_443A9E
.text:00443D01 xor esi, esi
(...)
It is responsible for opening the "\emots\\_NUMBER\_\emots.txt" files, and then reading
information about emoticons and their graphic equivalents. This is how an exemplary
line of configuration file looks like:
("emoticon","emoticon",...),"graphic\_file.gif","graphic\_file.gif"
If there's only one string associated to a gif file, the brackets can be skipped.
Also the third part of line isn't essential - it's just the name of optional graphic
file in NETSCAPE GIF format.
During the process of copying data from currently opened file (2nd and 3rd part of
configuration line) to some local buffers, the program doesn't check the
strings' lengths, what can lead to overwriting the 500-byte buffers placed on the stack.
Vulnerable code that copies the name of first gfx file is shown below:
.text:00443E37 loc\_443E37: ; CODE XREF: HandleEmotsConfig+164j
.text:00443E37 cmp al, '"'
.text:00443E39 jz short loc\_443E48
.text:00443E3B mov [ecx], al
.text:00443E3D inc ecx
.text:00443E3E inc edi
.text:00443E3F mov [ebp-18h], edi
.text:00443E42
.text:00443E42 loc\_443E42: ; CODE XREF: HandleEmotsConfig+153j
.text:00443E42 mov al, [edi]
.text:00443E44 cmp al, 20h
.text:00443E46 jnb short loc\_443E37
As you can see, there's no size limitation of the data being moved.
It's, in fact, the same situation in the second piece of code:
.text:00443E87 loc\_443E87: ; CODE XREF: HandleEmotsConfig+1B6j
.text:00443E87 cmp cl, '"'
.text:00443E8A jz short loc\_443E9F
.text:00443E8C mov [eax], cl
.text:00443E8E inc eax
.text:00443E8F inc edi
.text:00443E90
.text:00443E90 loc\_443E90: ; CODE XREF: HandleEmotsConfig+1A3j
.text:00443E90 mov cl, [edi]
.text:00443E92 cmp cl, ' '
.text:00443E95 mov [ebp-18h], edi
.text:00443E98 jnb short loc\_443E87
A Proof of Concept file created during this research exploits bugs in filename
copying code, but it is also possible to execute arbitrary code using an buffer
overflow in other places in the fuction - responsible for moving data such as
strings describing the emoticons and so on.
When copying data using code shown above, the values of some local variables, return
addresses etc. may be overwritten. Modification of proper amount of stack data causes
an exception. There are several reasons for the exception being generated. It can happen
when the filename placed in "emots.txt" is longer than the size of stack,
or in a function under 0x0052F5D0 address, called by the emoticon parsing code:
.text:00443EEE call unknown\_libname\_52 ; Microsoft VisualC 2-8/net runtime
to be more precise, the instruction under 0x0052F62A causes an exception, because
of the fact that EDI register value is zero in that moment:
.text:0052F62A rep movsd
Among all the data we are able to overwrite, there is a SEH structure, which contains
an address of function being called by the system each time an exception occurs.
Since we can easily cause such an exception, having full control of the address,
where the code execution is passed to, we can make gg.exe execute any code we want.
==[ Solution ]==
The simplest and most effective solution is to place a piece of code checking if the
length of string being copied is not too big. It should be put in every data-moving loop
in the function. It is also worth thinking of moving the local buffers to global process
memory - in case of buffer overflow vulnerability there would be no possibility to
overwrite such important stack data like return/seh addresses etc.
==[ Exploit ]==
A special file exploiting described vulnerability has been created, but isn't going
to be published in any form.
==[ Vendor Status ]==
The vendor has been informed about discovered bug, and released a fixed version.
== Disclaimer ==
This document and all the information it contains is provided "as is",
without any warranty. Author is not responsible for the misuse
of the information provided in this advisory. The advisory is
provided for educational purposes only.
Permission is hereby granted to redistribute this advisory, providing
that no changes are made and that the copyright notices and
disclaimers remain intact.
------------------------------------------
Copyright (C) 2007 j00ru of the Vexillium.
------------------------------------------

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007120046)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top


