=== Content from security-tracker.debian.org_7ce79c09_20250126_043343.html ===

# CVE-2007-6210

| **Name** | CVE-2007-6210 |
| --- | --- |
| **Description** | zabbix\_agentd 1.1.4 in ZABBIX before 1.4.3 runs "UserParameter" scripts with gid 0, which might allow local users to gain privileges. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2007-6210) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2007-6210); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2007-6210), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2007-6210), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2007-6210), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2007-6210), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2007-6210), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2007-6210), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2007-6210), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2007-6210)/[CVE](https://www.suse.com/security/cve/CVE-2007-6210/), GitHub [advisories](https://github.com/advisories?query=CVE-2007-6210)/[code](https://github.com/search?type=Code&q=%22CVE-2007-6210%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2007-6210%22), [web search](https://duckduckgo.com/html?q=%22CVE-2007-6210%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-1420-1](/tracker/DSA-1420-1), [DTSA-93-1](/tracker/DTSA-93-1) |
| **Debian Bugs** | [452682](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=452682) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [zabbix](/tracker/source-package/zabbix) ([PTS](https://tracker.debian.org/pkg/zabbix)) | bullseye | 1:5.0.8+dfsg-1 | fixed |
|  | bullseye (security) | 1:5.0.45+dfsg-1+deb11u1 | fixed |
|  | bookworm | 1:6.0.14+dfsg-1 | fixed |
|  | sid | 1:7.0.6+dfsg-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [zabbix](/tracker/source-package/zabbix) | source | etch | 1:1.1.4-10etch1 |  | [DSA-1420-1](/tracker/DSA-1420-1) |  |
| [zabbix](/tracker/source-package/zabbix) | source | lenny | 1:1.4.1-4+lenny1 |  | [DTSA-93-1](/tracker/DTSA-93-1) |  |
| [zabbix](/tracker/source-package/zabbix) | source | (unstable) | 1:1.4.2-4 |  |  | [452682](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=452682) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from bugs.debian.org_8fc4b29c_20250124_234601.html ===

# Debian Bug report logs - #452682 zabbix-agent runs as user 'zabbix' with gid=0 (root), configuring additional groups doesn't work

[![version graph](version.cgi?absolute=0;fixed=zabbix%2F1%3A1.4.2-4;fixed=zabbix%2F1%3A1.4.1-4%2Blenny1;fixed=zabbix%2F1%3A1.1.4-10etch1;collapse=1;width=2;package=zabbix-agent;found=zabbix%2F1%3A1.1.4-10;height=2)](version.cgi?info=1;found=zabbix%2F1%3A1.1.4-10;absolute=0;collapse=1;fixed=zabbix%2F1%3A1.4.2-4;fixed=zabbix%2F1%3A1.4.1-4%2Blenny1;fixed=zabbix%2F1%3A1.1.4-10etch1;package=zabbix-agent)

Package:
[zabbix-agent](pkgreport.cgi?package=zabbix-agent);
Maintainer for [zabbix-agent](pkgreport.cgi?package=zabbix-agent) is [Dmitry Smirnov <onlyjob@debian.org>](pkgreport.cgi?maint=onlyjob%40debian.org); Source for [zabbix-agent](pkgreport.cgi?package=zabbix-agent) is [src:zabbix](pkgreport.cgi?src=zabbix) ([PTS](https://tracker.debian.org/pkg/zabbix), [buildd](https://buildd.debian.org/zabbix), [popcon](https://qa.debian.org/popcon.php?package=zabbix)).

Reported by: [Bas van Schaik <bas@tuxes.nl>](pkgreport.cgi?submitter=bas%40tuxes.nl)

Date: Sat, 24 Nov 2007 14:54:02 UTC

Severity: important

Tags: moreinfo, patch, security

Found in version zabbix/1:1.1.4-10

Fixed in versions zabbix/1:1.4.2-4, zabbix/1:1.4.1-4+lenny1, zabbix/1:1.1.4-10etch1

**Done:** Michael Ablassmeier <abi@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=452682;mbox=yes), [status mbox](bugreport.cgi?bug=452682;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=452682;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=2), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Bas van Schaik <bas@tuxes.nl>`:

New Bug report received and forwarded. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=4), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=5), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=bas%40tuxes.nl)
From: Bas van Schaik <bas@tuxes.nl>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: zabbix-agent runs as user 'zabbix' with gid=0 (root),
configuring additional groups doesn't work
Date: Sat, 24 Nov 2007 15:43:40 +0100
```
Package: zabbix-agent
Version: 1:1.1.4-10
Severity: important

The zabbix-agentd process runs as user 'zabbix' by default, which is of
course very desirable. However, the process' gid defaults to 0 (root)
which did really surprise me. On systems using this group for
administrative purposes, this (unconfigurable) default can yield a
significant security risk.

This weird behaviour has another downside: it is impossible to configure
additional groups for the zabbix-agentd process. Say you want a
zabbix-agent script to parse some logfiles in /var/log, it is impossible
to achieve this by only configuring the 'zabbix' user in group 'adm'.

-- System Information:
Debian Release: 4.0
  APT prefers stable
  APT policy: (500, 'stable')
Architecture: i386 (i686)
Shell:  /bin/sh linked to /bin/bash
Kernel: Linux 2.6.18-4-xen-686
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)

Versions of packages zabbix-agent depends on:
ii  adduser                     3.102        Add and remove users and groups
ii  debconf [debconf-2.0]       1.5.11       Debian configuration management sy
ii  libc6                       2.3.6.ds1-13 GNU C Library: Shared libraries
ii  libldap2                    2.1.30-13.3  OpenLDAP libraries
ii  logrotate                   3.7.1-3      Log rotation utility
ii  ucf                         2.0020       Update Configuration File: preserv

zabbix-agent recommends no packages.

-- debconf information:
  zabbix-agent/server:

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=7), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Michael Ablassmeier <abi@grinser.de>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=9), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=10), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=abi%40grinser.de)
From: Michael Ablassmeier <abi@grinser.de>
To: Bas van Schaik <bas@tuxes.nl>, 452682@bugs.debian.org
Cc: control@bugs.debian.org
Subject: Re: Bug#452682: zabbix-agent runs as user 'zabbix' with gid=0 (root), configuring additional groups doesn't work
Date: Sat, 24 Nov 2007 20:19:11 +0100
```
tags 452682 + moreinfo
tags 452682 + unreproducible
thanks

hi Bas,

On Sat, Nov 24, 2007 at 03:43:40PM +0100, Bas van Schaik wrote:
> The zabbix-agentd process runs as user 'zabbix' by default, which is of
> course very desirable. However, the process' gid defaults to 0 (root)
> which did really surprise me. On systems using this group for
> administrative purposes, this (unconfigurable) default can yield a
> significant security risk.

i cant reproduce this. Installing zabbix-agent on a etch sytem results
in an agent running with uid and gid set to zabbix:

root@k:/tmp# ps -G zabbix -o user,group,pid
USER     GROUP      PID
zabbix   zabbix   32428
zabbix   zabbix   32429

looking at the sourcecode, zabbix does setgid and setuid if started
as root, can you confirm you dont have a error message telling you
about a failed setgid in your agents log?

       /* running as root ?*/
        if((getuid()==0) || (getgid()==0))
        {
                pwd = getpwnam("zabbix");
                if ( pwd == NULL )
                {
                        fprintf(stderr,"User zabbix does not exist.\n");
                        fprintf(stderr, "Cannot run as root !\n");
                        exit(FAIL);
                }
                if( (setgid(pwd->pw_gid) ==-1) || (setuid(pwd->pw_uid) == -1) )
                {
                        fprintf(stderr,"Cannot setgid or setuid to zabbix [%s]\n", strerror(errno));
                        exit(FAIL);
                }

bye,
    - michael

```

---

**Tags added: moreinfo**
Request was from `Michael Ablassmeier <abi@grinser.de>`
to `control@bugs.debian.org`.
(Sat, 24 Nov 2007 19:21:05 GMT) ([full text](bugreport.cgi?bug=452682;msg=12), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=12), [link](#11)).

---

**Tags added: unreproducible**
Request was from `Michael Ablassmeier <abi@grinser.de>`
to `control@bugs.debian.org`.
(Sat, 24 Nov 2007 19:21:06 GMT) ([full text](bugreport.cgi?bug=452682;msg=14), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=14), [link](#13)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=16), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=16), [link](#15)).

---

**Acknowledgement sent** to `Bas van Schaik <bas@tuxes.nl>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=18), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=18), [link](#17)).

---

[Message #19](#19) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=19), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=19), reply):

![](/cgi-bin/libravatar.cgi?email=bas%40tuxes.nl)
From: Bas van Schaik <bas@tuxes.nl>
To: 452682@bugs.debian.org
Cc: Michael Ablassmeier <abi@grinser.de>
Subject: Re: Bug#452682: zabbix-agent runs as user 'zabbix' with gid=0 (root),
configuring additional groups doesn't work
Date: Sun, 25 Nov 2007 12:21:17 +0100
```
Hi Michael,

I'm sorry, I should have been a little bit more clear about this. The
zabbix_agentd process runs as zabbix:zabbix indeed, but the so called
"UserParameter" scripts run with user:group zabbix:root. Or at least,
this is the output of such a script calling `id`:
> uid=110(zabbix) gid=111(zabbix) groups=0(root)
Where is the 'root' group coming from? The user 'zabbix' certainly is
_not_ in the group 'root' on my servers!

So you're right: this bug is actually not related to the zabbix_agentd
process, but to the scripts invoked by that process. The same holds for
the problem with additional groups. Check the output of `id zabbix`
invoked on a simple root shell and compare it to the output of the
UserParameter script:
> uid=110(zabbix) gid=111(zabbix) groups=111(zabbix),4(adm)
Note that the user 'zabbix' actually is in the group 'adm': this way it
is able to read mail logfiles from /var/log. However, the group 'adm'
has disappeared from the `id` output from the UserParameter script?

Regards!

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=21), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent** to `Michael Ablassmeier <abi@grinser.de>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=23), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=24), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=abi%40grinser.de)
From: Michael Ablassmeier <abi@grinser.de>
To: Bas van Schaik <bas@tuxes.nl>, 452682@bugs.debian.org
Subject: Re: Bug#452682: zabbix-agent runs as user 'zabbix' with gid=0
(root), configuring additional groups doesn't work
Date: Sun, 25 Nov 2007 14:19:46 +0100
```
hi Bas,

On Sun, Nov 25, 2007 at 12:21:17PM +0100, Bas van Schaik wrote:
> I'm sorry, I should have been a little bit more clear about this. The
> zabbix_agentd process runs as zabbix:zabbix indeed, but the so called
> "UserParameter" scripts run with user:group zabbix:root. Or at least,
> this is the output of such a script calling `id`:
> > uid=110(zabbix) gid=111(zabbix) groups=0(root)
> Where is the 'root' group coming from? The user 'zabbix' certainly is
> _not_ in the group 'root' on my servers!

i think this is due to the fact that the zabbix_agentd process only uses
setuid/setgid to drop its privileges. Now i think on linux, if setuid is
invoked from an user with uid 0, the old uid/gid is saved to the saved
set-uid/gid.

The agent uses popen in order to execute the UserCommands. I think popen just
as exec* resets the gid to the saved-set-gid, which is then 0, thus the
executed programm ends up with gid set to root.

Not sure if this is actually wanted by the zabbix devs, im going to have a talk
about this with upstream.

bye,
	- michael

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=26), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=26), [link](#25)).

---

**Acknowledgement sent** to `Michael Ablassmeier <abi@grinser.de>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=28), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=29), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=abi%40grinser.de)
From: Michael Ablassmeier <abi@grinser.de>
To: Bas van Schaik <bas@tuxes.nl>, 452682@bugs.debian.org
Subject: Re: Bug#452682: zabbix-agent runs as user 'zabbix' with gid=0
(root), configuring additional groups doesn't work
Date: Sun, 25 Nov 2007 15:01:15 +0100
```
hi again,

On Sun, Nov 25, 2007 at 02:19:46PM +0100, Michael Ablassmeier wrote:
> The agent uses popen in order to execute the UserCommands. I think popen just
> as exec* resets the gid to the saved-set-gid, which is then 0, thus the
> executed programm ends up with gid set to root.

just a short example of whats happening and how to reproduce this:

 > #include <sys/types.h>
 > #include <unistd.h>
 > #include <pwd.h>
 > #include <stdio.h>
 >
 > int main() {
 >         struct passwd           *pw;
 >         pw = getpwnam("abi");
 >         FILE *pipe;
 >         char buf[25];
 >         setgid(pw->pw_gid);
 >         setuid(pw->pw_uid);
 >
 >         printf("my gid: %d\n", getegid());
 >         printf("my uid: %d\n", getuid());
 >
 >         pipe = popen("/usr/bin/id", "r");
 >         while (fgets(buf, sizeof buf, pipe)) {
 >                 printf("%s", buf);
 >         }
 >         printf("\n");
 >         pclose(pipe);
 > }

root@radiohead:~# ./a.out
my gid: 1000
my uid: 1000
uid=1000(abi) gid=1000(abi) groups=0(root),102(lpadmin),1001(wheel)

bye,
	- michael

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=31), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=31), [link](#30)).

---

**Acknowledgement sent** to `Michael Ablassmeier <abi@grinser.de>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=33), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=33), [link](#32)).

---

[Message #34](#34) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=34), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=34), reply):

![](/cgi-bin/libravatar.cgi?email=abi%40grinser.de)
From: Michael Ablassmeier <abi@grinser.de>
To: Bas van Schaik <bas@tuxes.nl>, 452682@bugs.debian.org
Subject: Re: Bug#452682: zabbix-agent runs as user 'zabbix' with gid=0
(root), configuring additional groups doesn't work
Date: Sun, 25 Nov 2007 15:34:50 +0100
```
and hi, yet again,

On Sun, Nov 25, 2007 at 03:01:15PM +0100, Michael Ablassmeier wrote:
> On Sun, Nov 25, 2007 at 02:19:46PM +0100, Michael Ablassmeier wrote:
> > The agent uses popen in order to execute the UserCommands. I think popen just
> > as exec* resets the gid to the saved-set-gid, which is then 0, thus the
> > executed programm ends up with gid set to root.
>
> just a short example of whats happening and how to reproduce this:
>
>  > #include <sys/types.h>
>  > #include <unistd.h>
>  > #include <pwd.h>
>  > #include <stdio.h>
>  >
>  > int main() {
>  >         struct passwd           *pw;
>  >         pw = getpwnam("abi");
>  >         FILE *pipe;
>  >         char buf[25];
>  >         setgid(pw->pw_gid);
>  >         setuid(pw->pw_uid);

i think the solution here is to use initgroups, which does set the right group
settings, like:

	setgid(..);
	initgroups(..,..);
	setuid(..);

 root@radiohead:~# ./a.out
 my gid: 1000
 my uid: 1000
 uid=1000(abi) gid=1000(abi) groups=1000(abi)

 root@radiohead:~# ./a.out
 my gid: 1000
 my uid: 1000
 cat: /tmp/file: Permission denied

 root@radiohead:~# ls -alh /tmp/file
 -rw-r----- 1 root root 7 Nov 25 15:13 /tmp/file

so, i think the zabbix_agentd should use initgroups() in order to set its
group information, im going to forward this to upstream.

bye,
	- michael

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=36), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=36), [link](#35)).

---

**Acknowledgement sent** to `Michael Ablassmeier <abi@grinser.de>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=38), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=38), [link](#37)).

---

[Message #39](#39) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=39), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=39), reply):

![](/cgi-bin/libravatar.cgi?email=abi%40grinser.de)
From: Michael Ablassmeier <abi@grinser.de>
To: 452682@bugs.debian.org, Bas van Schaik <bas@tuxes.nl>
Subject: Re: Bug#452682: zabbix-agent runs as user 'zabbix' with gid=0
(root), configuring additional groups doesn't work
Date: Sun, 25 Nov 2007 15:55:13 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=452682;msg=39) (text/plain, inline)]
```
```
hi again,

On Sun, Nov 25, 2007 at 03:01:15PM +0100, Michael Ablassmeier wrote:
> On Sun, Nov 25, 2007 at 02:19:46PM +0100, Michael Ablassmeier wrote:
> > The agent uses popen in order to execute the UserCommands. I think popen just
> > as exec* resets the gid to the saved-set-gid, which is then 0, thus the
> > executed programm ends up with gid set to root.

initgroups() is the way to go.
Attached patch should fix this issue.

bye,
	- michael

```
```
[[initgroups.diff](bugreport.cgi?att=1;bug=452682;filename=initgroups.diff;msg=39) (text/x-diff, attachment)]
```

---

**Tags removed: unreproducible**
Request was from `Michael Ablassmeier <abi@debian.org>`
to `control@bugs.debian.org`.
(Sun, 25 Nov 2007 15:03:05 GMT) ([full text](bugreport.cgi?bug=452682;msg=41), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=41), [link](#40)).

---

**Tags added: patch**
Request was from `Michael Ablassmeier <abi@debian.org>`
to `control@bugs.debian.org`.
(Sun, 25 Nov 2007 15:03:07 GMT) ([full text](bugreport.cgi?bug=452682;msg=43), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=43), [link](#42)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=45), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=45), [link](#44)).

---

**Acknowledgement sent** to `Bas van Schaik <bas@tuxes.nl>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=47), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=47), [link](#46)).

---

[Message #48](#48) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=48), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=48), reply):

![](/cgi-bin/libravatar.cgi?email=bas%40tuxes.nl)
From: Bas van Schaik <bas@tuxes.nl>
To: 452682@bugs.debian.org
Cc: Michael Ablassmeier <abi@grinser.de>
Subject: Re: Bug#452682: zabbix-agent runs as user 'zabbix' with gid=0 (root),
configuring additional groups doesn't work
Date: Sun, 25 Nov 2007 16:40:10 +0100
```
Thanks for the quick fix, Michael! I hope upstream will fix this soon so
the patch will appear in testing.

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=50), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=50), [link](#49)).

---

**Acknowledgement sent** to `"Thijs Kinkhorst" <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=52), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=52), [link](#51)).

---

[Message #53](#53) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=53), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=53), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: "Thijs Kinkhorst" <thijs@debian.org>
To: "Michael Ablassmeier" <abi@grinser.de>
Cc: team@security.debian.org,
452682@bugs.debian.org,
bas@tuxes.nl
Subject: Re: zabbix - zabbix-agent: UserParameters are execuited with gid 0
Date: Thu, 29 Nov 2007 10:02:18 +0100 (CET)
```
Hi Michael,

On Wed, November 28, 2007 17:48, Michael Ablassmeier wrote:
> to be a bit more specific about this:
>
> an privileged user (root) may configure an UserParameter like this one in
>  /etc/zabbix/zabbix-agentd.conf (hard core example):
>
>
> UserParameter=cat[*],cat $1

Thank you for contacting us about it. It's definitely a bug which should
be fixed, but I'm trying to assess whether it's severe enough to warrant a
DSA.

Zabbix is a monitoring tool. I would therefore assume that zabbix' users
already have quite a level of implied trust; it's not quite common that a
random user has access to zabbix and can exectute commands, right? Or am I
missing something?

thanks,
Thijs

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=55), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=55), [link](#54)).

---

**Acknowledgement sent** to `Michael Ablassmeier <abi@grinser.de>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=57), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=57), [link](#56)).

---

[Message #58](#58) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=58), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=58), reply):

![](/cgi-bin/libravatar.cgi?email=abi%40grinser.de)
From: Michael Ablassmeier <abi@grinser.de>
To: Thijs Kinkhorst <thijs@debian.org>, 452682@bugs.debian.org
Subject: Re: Bug#452682: zabbix - zabbix-agent: UserParameters are execuited with gid 0
Date: Thu, 29 Nov 2007 10:21:04 +0100
```
hi Thijs,

On Thu, Nov 29, 2007 at 10:02:18AM +0100, Thijs Kinkhorst wrote:
> On Wed, November 28, 2007 17:48, Michael Ablassmeier wrote:
> > to be a bit more specific about this:
> >
> > an privileged user (root) may configure an UserParameter like this one in
> >  /etc/zabbix/zabbix-agentd.conf (hard core example):
> >
> >
> > UserParameter=cat[*],cat $1
>
> Thank you for contacting us about it. It's definitely a bug which should
> be fixed, but I'm trying to assess whether it's severe enough to warrant a
> DSA.

im not sure either ..

> Zabbix is a monitoring tool. I would therefore assume that zabbix' users
> already have quite a level of implied trust; it's not quite common that a
> random user has access to zabbix and can exectute commands, right? Or am I
> missing something?

well, its not like random users have access to the zabbix frontend, thats right.
So they indeed have a good level of trust (or should have). However, its still
possible for them to root remote machines, given the fact the zabbix admin
gives them access to the item configuration and there is an flexible user
parameter ..

If you guys decide its not worth a DSA, im going to upload a fixed version to
stable-propsed-updates - or something.

bye,
    - michael

```

---

**Tags added: security**
Request was from `Thijs Kinkhorst <thijs@debian.org>`
to `control@bugs.debian.org`.
(Fri, 30 Nov 2007 17:00:05 GMT) ([full text](bugreport.cgi?bug=452682;msg=60), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=60), [link](#59)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Zabbix Maintainers <kobold-zabbix@debian.org>`:

`Bug#452682`; Package `zabbix-agent`.
([full text](bugreport.cgi?bug=452682;msg=62), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=62), [link](#61)).

---

**Acknowledgement sent** to `Thijs Kinkhorst <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Zabbix Maintainers <kobold-zabbix@debian.org>`.
([full text](bugreport.cgi?bug=452682;msg=64), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 452682@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=65), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: Thijs Kinkhorst <thijs@debian.org>
To: Michael Ablassmeier <abi@grinser.de>
Cc: 452682@bugs.debian.org
Subject: Re: Bug#452682: zabbix - zabbix-agent: UserParameters are execuited with gid 0
Date: Tue, 4 Dec 2007 12:20:33 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=452682;msg=65) (text/plain, inline)]
```
```
On Thursday 29 November 2007 10:21, Michael Ablassmeier wrote:
> well, its not like random users have access to the zabbix frontend, thats
> right. So they indeed have a good level of trust (or should have). However,
> its still possible for them to root remote machines, given the fact the
> zabbix admin gives them access to the item configuration and there is an
> flexible user parameter ..

This is CVE id [CVE-2007-6210](https://security-tracker.debian.org/tracker/CVE-2007-6210), please reference it in any changelogs and
announcements. Could you also ask upstream to put it into their changelog and
announcement?

The DSA is ready, except for some buildd issues.

Thijs

```
```
[[Message part 2](bugreport.cgi?att=1;bug=452682;msg=65) (application/pgp-signature, inline)]
```

---

**Reply sent** to `Michael Ablassmeier <abi@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=452682;msg=67), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=67), [link](#66)).

---

**Notification sent** to `Bas van Schaik <bas@tuxes.nl>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=452682;msg=69), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=69), [link](#68)).

---

[Message #70](#70) received at 452682-close@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=70), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=70), reply):

![](/cgi-bin/libravatar.cgi?email=abi%40debian.org)
From: Michael Ablassmeier <abi@debian.org>
To: 452682-close@bugs.debian.org
Subject: Bug#452682: fixed in zabbix 1:1.4.2-4
Date: Thu, 06 Dec 2007 08:47:05 +0000
```
Source: zabbix
Source-Version: 1:1.4.2-4

We believe that the bug you reported is fixed in the latest version of
zabbix, which is due to be installed in the Debian FTP archive:

zabbix-agent_1.4.2-4_amd64.deb
  to pool/main/z/zabbix/zabbix-agent_1.4.2-4_amd64.deb
zabbix-frontend-php_1.4.2-4_all.deb
  to pool/main/z/zabbix/zabbix-frontend-php_1.4.2-4_all.deb
zabbix-server-mysql_1.4.2-4_amd64.deb
  to pool/main/z/zabbix/zabbix-server-mysql_1.4.2-4_amd64.deb
zabbix-server-pgsql_1.4.2-4_amd64.deb
  to pool/main/z/zabbix/zabbix-server-pgsql_1.4.2-4_amd64.deb
zabbix_1.4.2-4.diff.gz
  to pool/main/z/zabbix/zabbix_1.4.2-4.diff.gz
zabbix_1.4.2-4.dsc
  to pool/main/z/zabbix/zabbix_1.4.2-4.dsc

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 452682@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Michael Ablassmeier <abi@debian.org> (supplier of updated zabbix package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Thu, 06 Dec 2007 09:12:19 +0100
Source: zabbix
Binary: zabbix-server-mysql zabbix-agent zabbix-server-pgsql zabbix-frontend-php
Architecture: source all amd64
Version: 1:1.4.2-4
Distribution: unstable
Urgency: high
Maintainer: abi@grinser.de
Changed-By: Michael Ablassmeier <abi@debian.org>
Description:
 zabbix-agent - software for monitoring of your networks -- agent
 zabbix-frontend-php - software for monitoring of your servers -- php frontend
 zabbix-server-mysql - software for monitoring of your networks -- server
 zabbix-server-pgsql - software for monitoring of your networks -- server
Closes: [452682](bugreport.cgi?bug=452682)
Changes:
 zabbix (1:1.4.2-4) unstable; urgency=high
 .
   * Fix execution of UserParameter with gid 0.
     Closes: #[452682](bugreport.cgi?bug=452682) ([CVE-2007-6210](https://security-tracker.debian.org/tracker/CVE-2007-6210))
Files:
 390764aa4620b9967dbebb45d933b4eb 859 net optional zabbix_1.4.2-4.dsc
 5ed5dcb89312da96432cd38ad438535f 20203 net optional zabbix_1.4.2-4.diff.gz
 125ce82c9baebe99729abf368f02a04c 166962 net optional zabbix-agent_1.4.2-4_amd64.deb
 11b5ac1d476aeb740d603c85647599ef 320548 net optional zabbix-server-mysql_1.4.2-4_amd64.deb
 419cad8b30a03dd694e01a6aa8cc7646 320542 net optional zabbix-server-pgsql_1.4.2-4_amd64.deb
 b88c0eadc3dce38ca97429a844f19be3 969134 net optional zabbix-frontend-php_1.4.2-4_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFHV7LQEFV7g4B8rCURAnsrAKCNdSD4yUm+67oC2IclslQWimW0jwCfVAz4
TtL3qaXL50WBCgkuJMvlvzc=
=htbI
-----END PGP SIGNATURE-----

```

---

**Reply sent** to `Michael Ablassmeier <abi@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=452682;msg=72), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=72), [link](#71)).

---

**Notification sent** to `Bas van Schaik <bas@tuxes.nl>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=452682;msg=74), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=74), [link](#73)).

---

[Message #75](#75) received at 452682-close@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=75), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=75), reply):

![](/cgi-bin/libravatar.cgi?email=abi%40debian.org)
From: Michael Ablassmeier <abi@debian.org>
To: 452682-close@bugs.debian.org
Subject: Bug#452682: fixed in zabbix 1:1.4.1-4+lenny1
Date: Thu, 06 Dec 2007 17:32:05 +0000
```
Source: zabbix
Source-Version: 1:1.4.1-4+lenny1

We believe that the bug you reported is fixed in the latest version of
zabbix, which is due to be installed in the Debian FTP archive:

zabbix-agent_1.4.1-4+lenny1_amd64.deb
  to pool/main/z/zabbix/zabbix-agent_1.4.1-4+lenny1_amd64.deb
zabbix-frontend-php_1.4.1-4+lenny1_all.deb
  to pool/main/z/zabbix/zabbix-frontend-php_1.4.1-4+lenny1_all.deb
zabbix-server-mysql_1.4.1-4+lenny1_amd64.deb
  to pool/main/z/zabbix/zabbix-server-mysql_1.4.1-4+lenny1_amd64.deb
zabbix-server-pgsql_1.4.1-4+lenny1_amd64.deb
  to pool/main/z/zabbix/zabbix-server-pgsql_1.4.1-4+lenny1_amd64.deb
zabbix_1.4.1-4+lenny1.diff.gz
  to pool/main/z/zabbix/zabbix_1.4.1-4+lenny1.diff.gz
zabbix_1.4.1-4+lenny1.dsc
  to pool/main/z/zabbix/zabbix_1.4.1-4+lenny1.dsc

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 452682@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Michael Ablassmeier <abi@debian.org> (supplier of updated zabbix package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Thu, 06 Dec 2007 09:45:01 +0100
Source: zabbix
Binary: zabbix-server-mysql zabbix-agent zabbix-server-pgsql zabbix-frontend-php
Architecture: source all amd64
Version: 1:1.4.1-4+lenny1
Distribution: testing-security
Urgency: high
Maintainer: abi@grinser.de
Changed-By: Michael Ablassmeier <abi@debian.org>
Description:
 zabbix-agent - software for monitoring of your networks -- agent
 zabbix-frontend-php - software for monitoring of your servers -- php frontend
 zabbix-server-mysql - software for monitoring of your networks -- server
 zabbix-server-pgsql - software for monitoring of your networks -- server
Closes: [452682](bugreport.cgi?bug=452682)
Changes:
 zabbix (1:1.4.1-4+lenny1) testing-security; urgency=high
 .
   * Fix UserParameter execution with gid 0
     Closes: #[452682](bugreport.cgi?bug=452682) ([CVE-2007-6210](https://security-tracker.debian.org/tracker/CVE-2007-6210))
Files:
 a5ddea84a53ac1a9a2458663385af267 873 net optional zabbix_1.4.1-4+lenny1.dsc
 c9e9a12eeb3ae784075cb7899f200889 3246817 net optional zabbix_1.4.1.orig.tar.gz
 a9a0b0079ec816560dfd0841e49134da 19531 net optional zabbix_1.4.1-4+lenny1.diff.gz
 df69fb5317a3836e2eb5d9627cfcc458 161976 net optional zabbix-agent_1.4.1-4+lenny1_amd64.deb
 b97b2d988821fcffde550a075d55bb7f 285228 net optional zabbix-server-mysql_1.4.1-4+lenny1_amd64.deb
 544c2ee6ccc0e66ce83be9e720e5d0d9 285282 net optional zabbix-server-pgsql_1.4.1-4+lenny1_amd64.deb
 fdf566daeb06515ea62bac8b513833e4 953314 net optional zabbix-frontend-php_1.4.1-4+lenny1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFHV7qWEFV7g4B8rCURApf5AJ9oJ1ssrsn+RknHsiFR8vBmCygeQQCdGzoP
5cfQjlEMz+o8YSDkSeenLIE=
=pwPx
-----END PGP SIGNATURE-----

```

---

**Reply sent** to `Michael Ablassmeier <abi@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=452682;msg=77), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=77), [link](#76)).

---

**Notification sent** to `Bas van Schaik <bas@tuxes.nl>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=452682;msg=79), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=79), [link](#78)).

---

[Message #80](#80) received at 452682-close@bugs.debian.org ([full text](bugreport.cgi?bug=452682;msg=80), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=80), reply):

![](/cgi-bin/libravatar.cgi?email=abi%40debian.org)
From: Michael Ablassmeier <abi@debian.org>
To: 452682-close@bugs.debian.org
Subject: Bug#452682: fixed in zabbix 1:1.1.4-10etch1
Date: Thu, 20 Dec 2007 19:54:09 +0000
```
Source: zabbix
Source-Version: 1:1.1.4-10etch1

We believe that the bug you reported is fixed in the latest version of
zabbix, which is due to be installed in the Debian FTP archive:

zabbix-agent_1.1.4-10etch1_amd64.deb
  to pool/main/z/zabbix/zabbix-agent_1.1.4-10etch1_amd64.deb
zabbix-frontend-php_1.1.4-10etch1_all.deb
  to pool/main/z/zabbix/zabbix-frontend-php_1.1.4-10etch1_all.deb
zabbix-server-mysql_1.1.4-10etch1_amd64.deb
  to pool/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_amd64.deb
zabbix-server-pgsql_1.1.4-10etch1_amd64.deb
  to pool/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_amd64.deb
zabbix_1.1.4-10etch1.diff.gz
  to pool/main/z/zabbix/zabbix_1.1.4-10etch1.diff.gz
zabbix_1.1.4-10etch1.dsc
  to pool/main/z/zabbix/zabbix_1.1.4-10etch1.dsc

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 452682@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Michael Ablassmeier <abi@debian.org> (supplier of updated zabbix package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Mon,  3 Dec 2007 08:09:25 +0000
Source: zabbix
Binary: zabbix-server-mysql zabbix-agent zabbix-server-pgsql zabbix-frontend-php
Architecture: source all amd64
Version: 1:1.1.4-10etch1
Distribution: stable-security
Urgency: high
Maintainer: Zabbix Maintainers <kobold-zabbix@debian.org>
Changed-By: Michael Ablassmeier <abi@debian.org>
Description:
 zabbix-agent - software for monitoring of your networks -- agent
 zabbix-frontend-php - software for monitoring of your servers -- php frontend
 zabbix-server-mysql - software for monitoring of your networks -- server
 zabbix-server-pgsql - software for monitoring of your networks -- server
Closes: [452682](bugreport.cgi?bug=452682)
Changes:
 zabbix (1:1.1.4-10etch1) stable-security; urgency=high
 .
   * Fix execution of UserParameters with gid 0. (CVE-2007-XXX)
     Closes: #[452682](bugreport.cgi?bug=452682)
Files:
 4b021367fae2f83903168622449ac3d5 850 net optional zabbix_1.1.4-10etch1.dsc
 8e733e41506dd34759daba01deeeefd9 1511210 net optional zabbix_1.1.4.orig.tar.gz
 853af44b6fa0f9519710af72d728283b 19016 net optional zabbix_1.1.4-10etch1.diff.gz
 88afd49700d9c27830b144c976d01bbc 121058 net optional zabbix-agent_1.1.4-10etch1_amd64.deb
 84ff800dfeeaaa15b5bc54da2c60d541 187334 net optional zabbix-server-mysql_1.1.4-10etch1_amd64.deb
 f287da9192ed398e4a91eeb466f5d0f2 197896 net optional zabbix-server-pgsql_1.1.4-10etch1_amd64.deb
 2094fd712f01e85f293ffba7628271a3 337552 net optional zabbix-frontend-php_1.1.4-10etch1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFHU9cdEFV7g4B8rCURAtI5AJ0Zg+P+75vy1qtSRcxIGmWAwniLUACg5os+
7QqXodNn8RdGNGcLypl4sIc=
=1rVC
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 18 Jan 2008 07:36:41 GMT) ([full text](bugreport.cgi?bug=452682;msg=82), [mbox](bugreport.cgi?bug=452682;mbox=yes;msg=82), [link](#81)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=452682).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 23:46:01 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.debian.org_49d3c4c3_20250124_234603.html ===


---

[[Date Prev](msg00200.html)][[Date Next](msg00202.html)]
[[Thread Prev](msg00200.html)][[Thread Next](msg00202.html)]
[[Date Index](maillist.html#00201)]
[[Thread Index](threads.html#00201)]

# [SECURITY] [DSA 1420-1] New zabbix packages fix privilege escalation

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1420-1] New zabbix packages fix privilege escalation
* *From*: Thijs Kinkhorst <thijs@debian.org>
* *Date*: Wed, 05 Dec 2007 20:14:40 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1Izzhg-00089j-CW%40klecker.debian.org)Â [E1Izzhg-00089j-CW@klecker.debian.org](msg00201.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1420-1                  security@debian.org
<http://www.debian.org/security/>                          Thijs Kinkhorst
December 05, 2007                     <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : zabbix
Vulnerability  : programming error
Problem-Type   : remote
Debian-specific: no
CVE ID         : CVE-2007-6210
Debian Bug     : 452682

Bas van Schaik discovered that the agentd process of Zabbix, a network
monitor system, may run user-supplied commands as group id root, not
zabbix, which may lead to a privilege escalation.

For the stable distribution (etch), this problem has been fixed in version
1:1.1.4-10etch1

zabbix is not included in the oldstable distribution (sarge).

We recommend that you upgrade your zabbix packages.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 4.0 alias etch
- -------------------------------

Stable updates are available for alpha, amd64, arm, hppa, i386, ia64, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix_1.1.4-10etch1.dsc>
    Size/MD5 checksum:      850 4b021367fae2f83903168622449ac3d5
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix_1.1.4-10etch1.diff.gz>
    Size/MD5 checksum:    19016 853af44b6fa0f9519710af72d728283b
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix_1.1.4.orig.tar.gz>
    Size/MD5 checksum:  1511210 8e733e41506dd34759daba01deeeefd9

Architecture independent packages:

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-frontend-php_1.1.4-10etch1_all.deb>
    Size/MD5 checksum:   337552 2094fd712f01e85f293ffba7628271a3

alpha architecture (DEC Alpha)

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_alpha.deb>
    Size/MD5 checksum:   199540 d3c60f5e84c4c24622a93b7b88fcf21b
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-agent_1.1.4-10etch1_alpha.deb>
    Size/MD5 checksum:   134628 a1bc2d6920993443affd3a8751b9ca17
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_alpha.deb>
    Size/MD5 checksum:   208906 3c13b8046ff57e0fa8aea50f2be9ab55

amd64 architecture (AMD x86_64 (AMD64))

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-agent_1.1.4-10etch1_amd64.deb>
    Size/MD5 checksum:   121058 88afd49700d9c27830b144c976d01bbc
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_amd64.deb>
    Size/MD5 checksum:   187334 84ff800dfeeaaa15b5bc54da2c60d541
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_amd64.deb>
    Size/MD5 checksum:   197896 f287da9192ed398e4a91eeb466f5d0f2

arm architecture (ARM)

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-agent_1.1.4-10etch1_arm.deb>
    Size/MD5 checksum:   114812 54d95bd62d7fc9c4f7f489b3a6aa61b1
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_arm.deb>
    Size/MD5 checksum:   184154 a86d542d9e915e3218857f627987b4da
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_arm.deb>
    Size/MD5 checksum:   195136 69e6a2e140d706ea2e2345af3e4c7079

hppa architecture (HP PA RISC)

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-agent_1.1.4-10etch1_hppa.deb>
    Size/MD5 checksum:   129776 94cf53bf377404b7e735e03958c06b45
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_hppa.deb>
    Size/MD5 checksum:   198254 61e71f3347893b5db188f84639aa5408
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_hppa.deb>
    Size/MD5 checksum:   207124 ba7edc382a338dd1c199f5195c70600c

mips architecture (MIPS (Big Endian))

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_mips.deb>
    Size/MD5 checksum:   191732 2bf4f31683e0cbc336761bb289637935
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_mips.deb>
    Size/MD5 checksum:   202436 895df858131cb2a7cdaf08872990a5ad
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-agent_1.1.4-10etch1_mips.deb>
    Size/MD5 checksum:   127066 92ffdb635471d03e6557feb09c964b14

mipsel architecture (MIPS (Little Endian))

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-agent_1.1.4-10etch1_mipsel.deb>
    Size/MD5 checksum:   127084 1ec77d9776f50835b0de53280f6d1566
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_mipsel.deb>
    Size/MD5 checksum:   202602 0e6f7eacb323cd92e794374b3ace26f5
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_mipsel.deb>
    Size/MD5 checksum:   191870 37f5495aa653af479e47fbd7eaa9d881

powerpc architecture (PowerPC)

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_powerpc.deb>
    Size/MD5 checksum:   200586 d6f8539a23ef645e1acd89053d0ee9b4
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_powerpc.deb>
    Size/MD5 checksum:   190128 f15156135f21e6038ea6ecbba9fd39b1
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-agent_1.1.4-10etch1_powerpc.deb>
    Size/MD5 checksum:   124226 db888cf3cc5d4052f5df1faca2e2b959

s390 architecture (IBM S/390)

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_s390.deb>
    Size/MD5 checksum:   186494 31fe6349c1df9707e07dcc7f3188f4fa
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-agent_1.1.4-10etch1_s390.deb>
    Size/MD5 checksum:   120012 57d1846b5821c0160ec04fc896f035cb
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_s390.deb>
    Size/MD5 checksum:   197310 73739f20a98209392de313cb1f43add7

sparc architecture (Sun SPARC/UltraSPARC)

  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-pgsql_1.1.4-10etch1_sparc.deb>
    Size/MD5 checksum:   190724 2139419b2569163970b964008989ceef
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-agent_1.1.4-10etch1_sparc.deb>
    Size/MD5 checksum:   113630 2845f0b14a5a8d57b20cb4646af97f2a
  <http://security.debian.org/pool/updates/main/z/zabbix/zabbix-server-mysql_1.1.4-10etch1_sparc.deb>
    Size/MD5 checksum:   181714 275fe787f58c0cec7dcbdfe05505778f

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFHVvhfYrVLjBFATsMRAtztAJ4tPwqq/mnldOLs5uOV6q4fR8a0DwCeNjNu
mHiRd9dwvpiLl50n5eJi5Hk=
=QVTQ
-----END PGP SIGNATURE-----

```

---


