=== Content from blog.cryptographyengineering.com_7fc5e024_20250124_211812.html ===

[Skip to content](#content)
[Menu](#slide-menu)
# [A Few Thoughts on Cryptographic Engineering](https://blog.cryptographyengineering.com/)

## Some random thoughts about crypto. Notes from a course I teach. Pictures of my dachshunds.

![](https://matthewdgreen.files.wordpress.com/2016/08/matthew-green.jpg?w=200&h=300)
# Matthew Green

I'm a cryptographer and professor at Johns Hopkins University. I've designed and analyzed cryptographic systems used in wireless networks, payment systems and digital content protection platforms. In my research I look at the various ways cryptography can be used to promote user privacy.

[My academic website](https://matthewgreen.io)

[BlueSky](https://bsky.app/profile/did%3Aplc%3Axvgztewzbfh7bpnklayrsvds)

[Mastodon](https://ioc.exchange/%40matthew_d_green)

[Twitter](https://twitter.com/matthew_d_green)

[Top Posts](https://blog.cryptographyengineering.com/top-posts/)

[Useful crypto resources](https://staging.cryptographyengineering.com/useful-cryptography-resources/)

[Bitcoin tipjar](https://blog.cryptographyengineering.com/p/bitcoin-tipjar.html)

[Cryptopals challenges](http://cryptopals.com/)

[Applied Cryptography Research: A Board](https://acrab.isi.jhu.edu/)

[Journal of Cryptographic Engineering
(not related to this blog)](http://www.springer.com/computer/security%2Band%2Bcryptology/journal/13389)

Search for:

# Top Posts & Pages

* [Let's talk about AI and end-to-end encryption](https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/)
* [Is Telegram really an encrypted messaging app?](https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/)
* [Zero Knowledge Proofs: An illustrated primer](https://blog.cryptographyengineering.com/2014/11/27/zero-knowledge-proofs-illustrated-primer/)
* [What's the matter with PGP?](https://blog.cryptographyengineering.com/2014/08/13/whats-matter-with-pgp/)
* [Attack of the week: RC4 is kind of broken in TLS](https://blog.cryptographyengineering.com/2013/03/12/attack-of-week-rc4-is-kind-of-broken-in/)
* [All Posts](https://blog.cryptographyengineering.com/all-posts/)
* [Attack of the week: FREAK (or 'factoring the NSA for fun and profit')](https://blog.cryptographyengineering.com/2015/03/03/attack-of-week-freak-or-factoring-nsa/)
* [A very casual introduction to Fully Homomorphic Encryption](https://blog.cryptographyengineering.com/2012/01/02/very-casual-introduction-to-fully/)
* [One-Time Programs](https://blog.cryptographyengineering.com/2022/10/27/one-time-programs/)
* [How to choose an Authenticated Encryption mode](https://blog.cryptographyengineering.com/2012/05/19/how-to-choose-authenticated-encryption/)
 *Banner image by Matt Blaze*
# Archives

Archives
Select Month
 January 2025  (1)
 August 2024  (1)
 April 2024  (1)
 January 2024  (1)
 November 2023  (1)
 October 2023  (1)
 August 2023  (1)
 May 2023  (2)
 April 2023  (1)
 March 2023  (1)
 December 2022  (1)
 October 2022  (1)
 June 2022  (1)
 January 2022  (1)
 August 2021  (1)
 July 2021  (1)
 March 2021  (1)
 November 2020  (1)
 August 2020  (1)
 July 2020  (1)
 April 2020  (1)
 March 2020  (1)
 January 2020  (1)
 December 2019  (1)
 October 2019  (1)
 September 2019  (1)
 June 2019  (1)
 February 2019  (1)
 December 2018  (1)
 October 2018  (1)
 September 2018  (1)
 July 2018  (2)
 May 2018  (1)
 April 2018  (3)
 February 2018  (1)
 January 2018  (2)
 December 2017  (1)
 November 2017  (1)
 October 2017  (2)
 September 2017  (1)
 July 2017  (1)
 March 2017  (1)
 February 2017  (1)
 January 2017  (1)
 November 2016  (1)
 August 2016  (2)
 July 2016  (1)
 June 2016  (1)
 March 2016  (2)
 December 2015  (1)
 November 2015  (1)
 October 2015  (1)
 September 2015  (1)
 August 2015  (1)
 July 2015  (1)
 May 2015  (1)
 April 2015  (2)
 March 2015  (1)
 February 2015  (3)
 January 2015  (1)
 December 2014  (1)
 November 2014  (1)
 October 2014  (3)
 September 2014  (1)
 August 2014  (1)
 July 2014  (1)
 April 2014  (2)
 March 2014  (1)
 February 2014  (1)
 January 2014  (1)
 December 2013  (4)
 October 2013  (1)
 September 2013  (4)
 August 2013  (1)
 July 2013  (1)
 June 2013  (2)
 May 2013  (1)
 April 2013  (2)
 March 2013  (2)
 February 2013  (3)
 January 2013  (2)
 December 2012  (1)
 November 2012  (1)
 October 2012  (4)
 September 2012  (3)
 August 2012  (4)
 July 2012  (2)
 June 2012  (3)
 May 2012  (5)
 April 2012  (6)
 March 2012  (4)
 February 2012  (7)
 January 2012  (8)
 December 2011  (11)
 November 2011  (13)
 October 2011  (7)
 September 2011  (8)

[Matthew Green](https://blog.cryptographyengineering.com/author/matthewdgreen/ "Posts by Matthew Green")
in [Dual EC](https://blog.cryptographyengineering.com/category/dual-ec/), [NSA](https://blog.cryptographyengineering.com/category/nsa/), [RNGs](https://blog.cryptographyengineering.com/category/rngs/)
September 20, 2013August 21, 2016
628 Words

# RSA warns developers not to use RSA products

[![](https://i0.wp.com/siliconangle.com/files/2011/08/RSA_EMC_logo.jpg)](http://siliconangle.com/files/2011/08/RSA_EMC_logo.jpg)In today’s news of the weird, RSA (a division of EMC) has [recommended](http://arstechnica.com/security/2013/09/stop-using-nsa-influence-code-in-our-product-rsa-tells-customers/) that developers desist from using the (allegedly) ‘backdoored’ [Dual\_EC\_DRBG](http://en.wikipedia.org/wiki/Dual_EC_DRBG) random number generator — which happens to be the *default* in RSA’s BSafe cryptographic toolkit. Youch.

In case you’re missing the story here, Dual\_EC\_DRBG (which I [wrote about yesterday](https://blog.cryptographyengineering.com/2013/09/the-many-flaws-of-dualecdrbg.html)) is the random number generator voted most likely to be backdoored by the NSA. The story here is that — despite many valid concerns about this generator — RSA went ahead and made it the *default* generator used for all cryptography in its flagship cryptography library. The implications for RSA and RSA-based products are staggering. In the worst case a modestly bad but *by no means* worst case, the NSA may be able to intercept SSL/TLS connections made by products implemented with BSafe.

So why would RSA pick Dual\_EC as the default? You got me. Not only is Dual\_EC hilariously slow — which has real performance implications — it was shown to be *a just plain bad random number generator* all the way back in 2006. By 2007, when Shumow and Ferguson raised the possibility of a [backdoor in the specification](http://rump2007.cr.yp.to/15-shumow.pdf), no sensible cryptographer would go near the thing.

And the killer is that RSA employs a number of highly distinguished cryptographers! It’s unlikely that they’d all miss the news about Dual\_EC.

We can only speculate about the past. But here in the present we get to watch RSA’s CTO Sam Curry publicly defend RSA’s choices. I sort of feel bad for the guy. But let’s make fun of it anyway.

I’ll take his [statement](http://arstechnica.com/security/2013/09/stop-using-nsa-influence-code-in-our-product-rsa-tells-customers/) line by line (Sam is the boldface):

> ***“Plenty of other crypto functions (PBKDF2, bcrypt, scrypt) will iterate a hash 1000 times specifically to make it slower.”***

Password hash functions are built deliberately slow to frustrate [dictionary attacks](http://en.wikipedia.org/wiki/Dictionary_attack). Making a random number generator slow is just dumb.

> ***At the time, elliptic curves were in vogue***

Say what?

> ***and hash-based RNG was under scrutiny.***

Nonsense. A single *obsolete* hash based generator (FIPS 186) was under scrutiny — and fixed. The NIST SP800-90 draft in which Dual\_EC appeared ALSO provided three perfectly nice non-backdoored generators: two based on hash functions and one based on AES. BSafe even [implements some of them](http://developer-content.emc.com/docs/rsashare/share_for_java/1.1/dev_guide/group__LEARNJCE__RNG__HMACDRBG.html). Sam, this statement is just plain misleading.

> ***The hope was that elliptic curve techniques—based as they are on number theory—would not suffer many of the same weaknesses as other techniques (like the FIPS 186 SHA-1 generator) that were seen as negative***

Dual-EC suffers exactly the same sort of weaknesses as FIPS 186. *Unlike* the alternative generators in NIST SP800-90 it has a significant bias and really should not be used in production systems. RSA certainly had access to this information after the analyses were published in 2006.

> ***and Dual\_EC\_DRBG was an accepted and publicly scrutinized standard.***

And every bit of public scrutiny said the same thing: this thing is broken! Grab your children and run away!

> ***SP800-90 (which defines Dual EC DRBG) requires new features like continuous testing of the output, mandatory re-seeding,***

The exact same can be said for the hash-based and AES-based alternative generators you DIDN’T choose from SP800-90.

> ***optional prediction resistance and the ability to configure for different strengths.***

So did you take advantage of any of these options as part of the BSafe defaults? Why not? How about the very simple mitigations that NIST added to SP800-90A as a means to remove concerns that the generator might have a backdoor? Anyone?

There’s not too much else to say here. I guess the best way to put it is: this is all part of the process. First you find the disease. Then you see if you can cure it.

### *Related*

## Post navigation

[The Many Flaws of Dual\_EC\_DRBG](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/)[Let’s audit Truecrypt!](https://blog.cryptographyengineering.com/2013/10/14/lets-audit-truecrypt/)

## 20 thoughts on “RSA warns developers not to use RSA products”

1. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[JPGoldberg](https://www.blogger.com/profile/13464707043372692893)** says:
   [September 20, 2013 at 8:15 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1030)

   I actually liked the “elliptic curves were in vogue” part. Had other things been equal (though they emphatically were not), I could see making a choice among the four with “EC math is cool; let's go with that one.” Of course things were not close to equal at the time. Dual\_EC was slow, harder to implement, and most importantly was proven to have been backdoorable.

   But the “in vogue” reason is the only one offered that I could see actually playing a role at the time. The other reasons presented are obviously post-hoc nonsense that just makes them look stupid.
3. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Nemo](https://self-evident.org/)** says:
   [September 20, 2013 at 11:49 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1031)

   I think it's time to stop using the word “allegedly”. Of course Dual\_EC\_DRBG has a backdoor; this is perfectly obvious.

   As you say, the RSA folks are not stupid. For them to make this choice implies that they were incentivized, coerced, or both. This is also perfectly obvious.

   On the bright side, NSA apparently thinks EC discrete log is hard. The whole point, from their perspective, would be to insert a back door that only they could use.
5. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
   [September 21, 2013 at 11:07 am](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1034)

   > On the bright side, NSA apparently thinks EC discrete log is hard.

   We only know they believe it to be hard to anyone but them. They might have some insight on elliptic curves they assume to be so advanced that the public is not likely to find out in the coming decades.
7. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Nemo](https://self-evident.org/)** says:
   [September 21, 2013 at 3:51 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1035)

   Not only the public, who are morons, but similar agencies around the world. It is not in the “national security interest” for (e.g.) the U.S. banking system to be vulnerable to (e.g.) Chinese intelligence.

   More relevantly… If EC discrete log were easy for them, they would have no need to insert such an obvious back door; they could instead have generated P and Q in a convincingly random manner and then computed the value they need.

   So I repeat: This is actually pretty strong evidence that NSA considers EC discrete log to be a hard problem, or did in 2006.
9. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
   [September 22, 2013 at 12:59 am](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1036)

   I disagree on the “not stupid” part about the NSA. If they even had a basic working knowledge of deception, they would have made sure the generator looked attractive by making it fast and they certainly would have removed the bias. This way, we can only speculate that they forced it to be in there and used as default by RSA by plain, old-fashioned coercion instead of subtlety. It stinks of ham-handed incompetence.

   Quite frankly, the NSA now looks like a bunch of incompetent hacks with a very limited clue, but tons of money and far, far too much power.
11. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Pattern\_Juggled](http://cryptostorm.is)** says:
    [September 22, 2013 at 11:02 am](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1037)

    With all due respect, I must disagree that this episode shows NSA incompetence. Why do I do so?

    Because it worked.

    Ham-fisted? Yes, a bit. But look: yes, “everyone” knew in 2006 this thing had been NSA backdoored. To make that clear, a colleague of mine who was in prison at the time heard about it… in prison. So this was hardly a secret. However, the goal wasn't to keep it secret from geeky crypto nuts – the goal was to get it into production systems.

    Ahem.

    The reason they didn't make a PSRG that was cleverly backdoored and speedy is that doing is is very difficult – perhaps even not congruent with the way our universe is put together. No doubt, they tried – and they have lots of smart folks working on this stuff. What they got was a backdoored PSRG that more or less worked but was terribly slow – and then they crammed it down NIST's throat, and got it into production as a DEFAULT with RSA… which meant countless folks used it without being aware of it.

    Mission accomplished.

    Sure, people like us (those reading and commenting here) wouldn't have accepted the default and were waving our hands about when it came to this dog of an RNG (which is actually quite disrespectful to dogs). But nobody listened to us back then, really. We did our thing, and worried our worries, and talked to each other breathlessly… and it was just background noise. This thing was “government recommended by an independent agency” and RSA could slide it in without needing any real cover story at all.

    Aaaaa… the days before Snowden, eh?

    Three substantive points:

    1. Well-said, Nemo – this is no longer an “allegedly” backdoored piece of crap. It's NSA backdoored. Even in criminal cases in America, where “proof beyond a reasonable doubt” is the dispositive metric, when someone is convicted by a jury (or pleads guilty), she is no longer “alleged” to have done the deed. She did. She may continue to protest her innocence, of course – but everyone else crosses a grey threshold and drops “alleged” from discourse. The same is true here; this is no mere allegation, and using that weasel-word essentially become euphemism now that so much confirming data – and zero disconfirming data – are available.

    2. Nicely said, again, re the strength of ECC in general. Game theoretically, the NSA wouldn't have burned time and effort and political capital to push this thing into NIST-land if they had magic keys to ECC. Indeed, they'd have let a REAL EC-based PSRG float to the top, since it would have been (even more) widely adopted – having no baggage as did extant example. That they didn't do this, and that they did work hard to get this ham-fisted crack in the door leads by logical interpolation to the conclusion that they didn't at the time (2005-ish) have magic keys. Maybe they found 'em since then, or maybe they had 'em back then but were so secretive about it that even their NIST-bullying teams didn't know about it… but those are less supported by Occam.

    3. RSA didn't do this. Individual people at RSA did this. Who were they? Who had signatory authority over this? Where is he or she today? Why isn't someone from the hallowed halls of “investigative journalism” sticking a microphone in his/her face and asking hard questions? Why isn't someone checking real estate records to see if vacation homes were bought concurrently (mostly metaphorical example)? Accountability means someone is ACCOUNTABLE – a person, not just some amorphous company name.
13. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Pattern\_Juggled](http://cryptostorm.is)** says:
    [September 22, 2013 at 11:03 am](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1038)

    {continued past character limit of prior post…}

    The people who had their fingers in this particular cookie jar should never, ever be trusted again with anything relating to security. Ever. That sends a strong signal: get caught with your thumb on the scale and NSA calling cards in your pocket, and your career in security is over. Well, not over – you can always get a job as a shill for Hayden and the rest of the cyberwar-military complex, spreading FUD & profiting every step of the way.

    Still and all, we need to know who. So we can learn from this example, as Dr. Green says – and so we can ask them about what motivated their betrayal. That's fair, no?
15. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 22, 2013 at 11:38 am](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1039)

    Good points. I still think incompetent, as it was just too obvious. They should have refrained from putting the backdoored generator in there if they could not make it faster than the others. At that time, yes, only competent people cared, and I have personal experience of how difficult it can be to explain even to a security-conscious company that some crypto implemented by a reputable vendor can be bad.

    But the mind-sets of the semi-competent are always changing and the occasional panic is normal. If one happens, evidence like the one in this case, suddenly becomes important. Backdooring crypto needs to be done with a very long-term perspective or you lose the ability. Just the same as with putting sleeper agents in place (to use a not-quite accurate analogy). While not certain, it seems the NSA has just lost credibility for a long time and so have some of their victims/accomplices.

    I do fully agree about personal accountability. If you collaborated in such an immoral action, your personal reputation must go down the drain publicly and permanently. If you have a PhD in CS or related, it must be removed. Your name must turn up as somebody that damaged the field significantly in web-searches, and hiring you for a security position must be very risky or basically impossible.
17. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Matthew Green](https://www.blogger.com/profile/05041984203678598124)** says:
    [September 22, 2013 at 5:18 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1040)

    There was nothing semi-competent about the cryptographers working at RSA in 2005. I worked with several. It sickens me to think they might have been complicit, so I choose to believe they were kept out of the loop. Which still requires an active and malicious decision on somebody's part, IMHO.
19. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 22, 2013 at 8:21 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1042)

    Indeed. I never meant to call the cryptographers incompetent, but the “active and malicious” party is, IMO. Too greedy, too little sense of self-preservation, no long-term vision. Good for us though, because we now \_have\_ a smoking gun.

    Still, in the right climate even an ordinarily honorable person can become corrupt or lose perspective. While that is sad, I think we have to start looking at what outside influences and pressure cryptographers are under before trusting them. Good thing is that academics should usually be fine, academic freedom is still a significant protection and I don't think you can coerce somebody decent to go against his or her own field to this degree by refusing to fund projects.
21. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Nicholas Weaver](https://www.blogger.com/profile/17126451524439541478)** says:
    [September 23, 2013 at 3:02 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1044)

    I suspect bribery, either (unlikely) overt (to perhaps just a single programmer) or more likely covert (“Make this the default for government sales”).

    Its almost certainly the latter: somebody either stated or implied that making Dual\_EC\_DRBG the default was a requirement for government sales. Especially since this is the “FIPS compliant” version, that would mean that such a default (since the government must buy the FIPS version) would be the default for everyone.

    Since Dual\_EC\_DRBG is actually good (well, almost good, there is still the minor bias issue, but 'good enough') if you are the only one with the key to the backdoor, it is a 'safe' backdoor if its running on government systems.
23. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Nicholas Weaver](https://www.blogger.com/profile/17126451524439541478)** says:
    [September 23, 2013 at 3:21 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1045)

    This also suggests the following: Most crypto products are going to use libraries. Find out which ones by default use Dual\_EC\_DRBG. This should be known as the “Bribe List”: All these companies took 30 pieces of silver to betray their customers.
25. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Nemo](https://self-evident.org/)** says:
    [September 23, 2013 at 4:01 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1046)

    The big question, IMO, is whether Microsoft is on that list:

    <http://crypto.stackexchange.com/questions/10486/>

    No convincing answers so far.
27. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 23, 2013 at 9:25 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1047)

    RSA got popped a couple years ago, anyone remember? Mass token relacement under strict NDA?

    I'm sure that RSA managed that incident without any help from anyone apart from their PR people. No reason to talk to NSA about it.

    Could someone remind me why RSA are still in business while Diginotar aren't?
29. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Cosmetic Dentist](http://www.dentartistry.com.au/cosmetic-dentistry-sydney)** says:
    [September 24, 2013 at 10:24 am](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1049)

    interesting piece to read, giving every subject enlightenment for us to gain better knowledge about cryptography. Thanks for sharing [Cosmetic Dentist](http://www.dentartistry.com.au/cosmetic-dentistry-sydney)
31. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 25, 2013 at 6:37 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1055)

    I am left speechless
33. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 26, 2013 at 4:08 am](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1056)

    Well, looks like the American government and the American crypto community are pretty corrupt.
35. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 27, 2013 at 9:27 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1057)

    While the Dual\_EC\_DRBG story is interesting, I think the rabbit hole goes much deeper. It is pretty common knowledge that NSA has “classified mathematics” and cryptanalytic techniques that they have developed independently over many decades. Thus, it is prudent to ask whether or not they have used those techniques to undermine more than just a single PRNG.

    What about public-key systems? Is there some subtle weakness that the “standards” specify that only NSA knows about? What about those algorithms that NSA released (DSA SHA-1)? Do they have built-in weaknesses? What about block ciphers? Did NIST choose Rijndael because it has some unknown mathematical weakness? We do know that it has a very simple algebraic structure (which has been a major contention of people like Courtois). Does NSA have viable algebraic attacks against it? It's key schedule is also generally referred to as “lousy” by people like Schneier. Nonetheless, the public crypto community at large voted for it, so it's hard to contend that NIST had something up it's sleeve. However, NIST has the power to “override” the vote if they so choose. It just so happens they didn't in this case.

    Block ciphers have a lot of research behind them and it's generally accepted that it's pretty hard to hide weaknesses in them. Thus, my bet is on public-keys. I suspect that there may be something hidden in the various public-key generation protocols. It is easier to hide a “trap door” in a public-key system than it is in a block cipher.

    Also, the SHA-3 algorithm, Keccak, seems to utilize a primitive (sponges) that doesn't seem to have near the research behind it that previous constructions like MD have. Is there some weakness that NSA found with such a construction?
37. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [October 1, 2013 at 3:47 pm](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1058)

    It could also have been as simple as “If you want the government to continue buying millions and millions of dollars worth of your products every year, you will do the following for us. If you don't, we have a migration path already worked out for one of your compeditors' products. The choice is yours.”

    Money talks.
39. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **craig** says:
    [October 12, 2013 at 10:55 am](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/#comment-1066)

    Thankyou for the excellent articles.

    I suppose the question that the masses will ask is: “how do I know if I'm affected? “. Of course, the glib answer is that you \_are\_ affected…but isn't particularly helpful.

    It would be great if a follow up article could be written that gives the masses help on how to ensure their systems are fixed. The scope of this backdoor is mind boggling…

    Craig

Comments are closed.

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

Menu
## Menu

* [Home](https://matthewdgreen.wordpress.com)
* [About Me](https://blog.cryptographyengineering.com/about-me/)
* [Bitcoin Tipjar](https://blog.cryptographyengineering.com/bitcoin-tipjar/)
* [Top Posts](https://blog.cryptographyengineering.com/top-posts/)
* [All Posts](https://blog.cryptographyengineering.com/all-posts/)
* [Useful Cryptography Resources](https://blog.cryptographyengineering.com/useful-cryptography-resources/)

* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) A Few Thoughts on Cryptographic Engineering](https://blog.cryptographyengineering.com)

  Join 1,017 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.cryptographyengineering.com%252F2013%252F09%252F20%252Frsa-warns-developers-against-its-own%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) A Few Thoughts on Cryptographic Engineering](https://blog.cryptographyengineering.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.cryptographyengineering.com%252F2013%252F09%252F20%252Frsa-warns-developers-against-its-own%252F)
  + [Copy shortlink](https://wp.me/pE4dk-3F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/)
  + [View post in Reader](https://wordpress.com/read/blogs/9549322/posts/227)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from threatpost.com_9e39f88f_20250124_211818.html ===


[Threatpost](https://threatpost.com/)

* [Podcasts](https://threatpost.com/microsite/threatpost-podcasts-going-beyond-the-headlines/)
* [Malware](https://threatpost.com/category/malware-2/)
* [Vulnerabilities](https://threatpost.com/category/vulnerabilities/)
* [InfoSec Insiders](https://threatpost.com/microsite/infosec-insiders-community/)
* [Webinars](https://threatpost.com/category/webinars/)

 Search

* [iOS 7 Plagued By Yet Another Lockscreen Bypass FlawPrevious article](https://threatpost.com/ios-7-plagued-by-yet-another-lockscreen-bypass-flaw/102375/)
* [Hackers Bypass iPhone 5S Touch IDNext article](https://threatpost.com/hackers-bypass-iphone-5s-touch-id/102382/)

# In Wake of Latest Crypto Revelations, ‘Everything is Suspect’

[![](https://media.threatpost.com/wp-content/uploads/sites/103/2021/06/10095238/avatar_def-60x60.png)](https://threatpost.com/author/michael/)

Author:
[Michael Mimoso](https://threatpost.com/author/michael/)

September 20, 2013  1:18 pm

 minute read

**Share this article:**

![](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2013/08/07041803/cryptography.jpg)

RSA has asked developers to stop using the Dual EC DRBG encryption algorithm in products, but experts are concerned why RSA used a possibly compromised algorithm in the first place.

So now that RSA Security has urged developers to back away from the table and stop using the maligned Dual Elliptic Curve Deterministic Random Bit Generation (Dual EC DRBG) algorithm, the question begging to be asked is why did RSA use it in the first place?

Going back to 2007 and a seminal [presentation at the CRYPTO conference](http://rump2007.cr.yp.to/15-shumow.pdf) by Dan Shumow and Niels Ferguson, there have been suspicions about Dual EC DRBG primarily because it was backed by the National Security Agency, which initially proposed the algorithm as a standard. Cryptographer [Bruce Schneier wrote in a 2007 essay](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html) that the algorithm contains a weakness that “can only be described as a backdoor.”

Given the current climate and revelations about NSA surveillance of Americans, and implications the spy agency manipulated standards efforts, in particular those overseen by NIST, Dual EC DRBG and other crypto standards are going to be scrutinized top to bottom—not to mention the deterioration of trust in any product built on that standard.

“I wrote about it in 2007 and said it was suspect. I didn’t like it back then because it was from the government,” Schneier told Threatpost today. “It was designed so that it could contain a backdoor. Back then I was suspicious, now I’m terrified.

“We don’t know what’s been tampered with. Nothing can be trusted. Everything is suspect,” Schneier said.

Iin his essay, Schneier wrote that not only was the algorithm derided as slow compared to better available algorithms, but it had a bias, meaning that the random numbers it generates aren’t so random. Dual EC DRBG was one of four approved random bit generators in NIST Special Publication 800-90, but it sticks out like a sore thumb.

“What Shumow and Ferguson showed is that these numbers have a relationship with a second, secret set of numbers that can act as a kind of skeleton key. If you know the secret numbers, you can predict the output of the random-number generator after collecting just 32 bytes of its output,” Schneier wrote. “To put that in real terms, you only need to monitor one TLS Internet encryption connection in order to crack the security of that protocol. If you know the secret numbers, you can completely break any instantiation of Dual\_EC\_DRBG.

“The researchers don’t know what the secret numbers are,” Schneier said. “But because of the way the algorithm works, the person who produced the constants might know; he had the mathematical opportunity to produce the constants and the secret numbers in tandem.”

RSA advised its developer customers via email yesterday to no longer use the algorithm, following a [similar NIST recommendation](https://csrc.nist.gov/publications/PubsDrafts.html#SP-800-90-A%20Rev%201%20B%20and%20C) last week. The algorithm is the default pseudo random number generator in a number of RSA products, including the RSA BSAFE libraries and RSA’s key management product RSA Data Protection Manager. BSAFE is embedded in many applications, providing cryptography, digital certificates and TLS security. RSA said the current product documentation can help developers change the PRNG in their respective implementations. RSA also said it would review its products to determine where the algorithm is in use and make the appropriate changes.

RSA CTO Sam Curry told [Wired magazine](https://www.wired.com/threatlevel/2013/09/rsa-advisory-nsa-algorithm/), which first reported the story yesterday, the algorithm has been part of RSA libraries since 2004, two years before it was approved by NIST.

“Every product that we at RSA make, if it has a crypto function, we may or may not ourselves have decided to use this algorithm,” Curry told Wired. “So we’re also going to go through and make sure that we ourselves follow our own advice and aren’t using this algorithm.”

Matthew Green, a cryptographer and research professor at Johns Hopkins University, said RSA had no good reason to use the algorithm, and its decision to do so puts the security of any product using the BSAFE library into question.

“There’s no good reason whatsoever, just none,” Green said. “There was no good reason before the [Crypto 2007] backdoor presentation. It was a poor decision then, and afterwards I kind of think it was malpractice. People have known about this for a long time.”

RSA’s core product, its SecurID two-factor authentication tokens, was breached in 2011 and data stolen in that attack was used to attack Lockheed Martin and others in the defense industry. RSA said it spent more than $66 million cleaning up from the attack and helping customers. An untold number of RSA SecurID tokens were recalled and replaced. A source close to the matter told Threatpost that SecurID currently does not use the Dual EC DRBG random number generator, nor did it prior to the 2011 attack.

In the meantime, the immediate fallout is that we should expect more technology companies to make similar announcements about NIST-approved and NSA-influenced encryption. Experts are concerned too about the damage being inflicted upon NIST as a standards body. It’s likely these revelations will force greater scrutiny on the NIST-NSA relationship and nudge users and providers away from the standard in time.

“The U.S. has had an enormous influence on crypto around the world because we have NIST,” Green said in an interview before the RSA news broke. “You could see people break away from NIST, which would hurt everyone, and move to regional standards. That stuff is a problem.

“We trust NIST because there are a lot smart people there. If you split up into regions, it’s possible things could get less secure,” Green added. “You could end up with more vulnerabilities; standards get weaker the less effort you put into it.”

Schneier agreed that scrutiny will tighten on NIST.

“The fact is, NIST has been tarnished badly, and we really need them,” he said. “This is the biggest problem: The NSA has broken the fundamental social contract of the Internet.”

**Share this article:**

* [Cryptography](https://threatpost.com/category/cryptography/)

### Suggested articles

[![fbi warning egregor ransomware](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2021/01/08091437/globe-540x270.jpg)](https://threatpost.com/fbi-egregor-attacks-businesses-worldwide/162885/)
## [FBI Warns of Egregor Attacks on Businesses Worldwide](https://threatpost.com/fbi-egregor-attacks-businesses-worldwide/162885/)

The agency said the malware has already compromised more than 150 organizations and provided insight into its ransomware-as-a-service behavior.

January 8, 2021

[![](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2020/12/17122725/Zodiac-540x270.jpg)](https://threatpost.com/cryptologists-zodiac-killer-340-cipher/162353/)
## [Cryptologists Crack Zodiac Killer’s 340 Cipher](https://threatpost.com/cryptologists-zodiac-killer-340-cipher/162353/)

The Zodiac’s serial killer’s 340 cipher, which couldn’t be solved for 50 years, has been cracked by a remote team of mathematicians.

December 17, 2020

 [13](https://threatpost.com/cryptologists-zodiac-killer-340-cipher/162353/#comments)

[![enigma machine divers baltic](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2020/12/08153216/Stellnetz-Bergung-Enigma-Fund-c-Florian-Huber-submaris-540x270.jpg)](https://threatpost.com/divers-wwii-enigma-cipher-baltic/162045/)
## [Divers Pull Rare Surviving WWII Enigma Cipher Machine from Bottom of the Baltic](https://threatpost.com/divers-wwii-enigma-cipher-baltic/162045/)

This sealogged Nazi machine will undergo restoration.

December 8, 2020

[![Cybersecurity for your growing business](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2022/09/05095106/cybersecurity_336_300x2.jpg)](https://www.kaspersky.com/small-to-medium-business-security/cloud?reseller=gl_KES-Cloud-ThreatPost_awarn_ona_smm__all_b2b_some_ban_______&utm_source=threatpost&utm_medium=sm-project&utm_campaign=gl_KES-Cloud-ThreatPost_kk0084&utm_content=banner&utm_term=gl_threatpost_organic_w84uo46uhuoqivv)
### InfoSec Insider

* [![](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2022/04/29082135/cloud-digital-64x64.png)](https://threatpost.com/secure-move-cloud/180335/ "Securing Your Move to the Hybrid Cloud")
  ## [Securing Your Move to the Hybrid Cloud](https://threatpost.com/secure-move-cloud/180335/)

  August 1, 2022
* [![](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2016/12/06095327/01_intro_iot-e1520348007355-64x64.png)](https://threatpost.com/physical-security-maintenance/180269/ "Why Physical Security Maintenance Should Never Be an Afterthought")
  ## [Why Physical Security Maintenance Should Never Be an Afterthought](https://threatpost.com/physical-security-maintenance/180269/)

  July 25, 2022
* [![](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2019/06/20122305/Ransomware-64x64.jpg)](https://threatpost.com/contis-costa-rica/180258/ "Conti’s Reign of Chaos: Costa Rica in the Crosshairs")
  ## [Conti’s Reign of Chaos: Costa Rica in the Crosshairs](https://threatpost.com/contis-costa-rica/180258/)

  July 20, 2022
* [![](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2018/07/19123143/Security_Cyber_Insurance-64x64.jpg)](https://threatpost.com/war-impact-cyber-insurance/180185/ "How War Impacts Cyber Insurance")
  ## [How War Impacts Cyber Insurance](https://threatpost.com/war-impact-cyber-insurance/180185/)

  July 12, 2022
* [![Cutting Through the Noise from Daily Alerts](https://media.kasperskycontenthub.com/wp-content/uploads/sites/103/2021/08/03142545/Cutting-Through-the-Noise-from-Daily-Alerts-64x64.png)](https://threatpost.com/rethinking-vulnerability-management/180177/ "Rethinking Vulnerability Management in a Heightened Threat Landscape")
  ## [Rethinking Vulnerability Management in a Heightened Threat Landscape](https://threatpost.com/rethinking-vulnerability-management/180177/)

  July 11, 2022

[![Cybersecurity for your growing business](https://kasperskycontenthub.com/threatpost-global/files/2022/09/cybersecurity_336_500x2.jpg)](https://www.kaspersky.com/small-to-medium-business-security/cloud?reseller=gl_KES-Cloud-ThreatPost_awarn_ona_smm__all_b2b_some_ban_______&utm_source=threatpost&utm_medium=sm-project&utm_campaign=gl_KES-Cloud-ThreatPost_kk0084&utm_content=banner&utm_term=gl_threatpost_organic_w84uo46uhuoqivv)

[Threatpost](https://threatpost.com/)

[The First Stop For Security News](https://threatpost.com/)

* [Home](https://threatpost.com/)
* [About Us](https://threatpost.com/about-threatpost/)
* [Contact Us](https://threatpost.com/contact-us/)
* [RSS Feeds](https://threatpost.com/rss-feeds/)

* Copyright © 2025 Threatpost
* [Privacy Policy](https://threatpost.com/privacy-policy/)
* [Terms and Conditions](https://threatpost.com/tos/)

### Topics

* [Black Hat](https://threatpost.com/category/bh/)
* [Breaking News](https://threatpost.com/category/breaking-news/)
* [Cloud Security](https://threatpost.com/category/cloud-security/)
* [Critical Infrastructure](https://threatpost.com/category/critical-infrastructure/)
* [Cryptography](https://threatpost.com/category/cryptography/)
* [Facebook](https://threatpost.com/category/facebook/)
* [Government](https://threatpost.com/category/government/)
* [Hacks](https://threatpost.com/category/hacks/)
* [IoT](https://threatpost.com/category/iot/)
* [Malware](https://threatpost.com/category/malware-2/)
* [Mobile Security](https://threatpost.com/category/mobile-security/)
* [Podcasts](https://threatpost.com/category/podcasts/)
* [Privacy](https://threatpost.com/category/privacy/)
* [RSAC](https://threatpost.com/category/rsac/)
* [Security Analyst Summit](https://threatpost.com/category/sas/)
* [Videos](https://threatpost.com/category/videos/)
* [Vulnerabilities](https://threatpost.com/category/vulnerabilities/)
* [Web Security](https://threatpost.com/category/web-security/)

[Threatpost](https://threatpost.com/)

### Topics

* [Cloud Security](https://threatpost.com/category/cloud-security/)
* [Malware](https://threatpost.com/category/malware-2/)
* [Vulnerabilities](https://threatpost.com/category/vulnerabilities/)
* [Privacy](https://threatpost.com/category/privacy/)

Show all

* [Black Hat](https://threatpost.com/category/bh/)
* [Critical Infrastructure](https://threatpost.com/category/critical-infrastructure/)
* [Cryptography](https://threatpost.com/category/cryptography/)
* [Facebook](https://threatpost.com/category/facebook/)
* [Featured](https://threatpost.com/category/featured/)
* [Government](https://threatpost.com/category/government/)
* [Hacks](https://threatpost.com/category/hacks/)
* [IoT](https://threatpost.com/category/iot/)
* [Mobile Security](https://threatpost.com/category/mobile-security/)
* [Podcasts](https://threatpost.com/category/podcasts/)
* [RSAC](https://threatpost.com/category/rsac/)
* [Security Analyst Summit](https://threatpost.com/category/sas/)
* [Slideshow](https://threatpost.com/category/slideshow/)
* [Videos](https://threatpost.com/category/videos/)
* [Web Security](https://threatpost.com/category/web-security/)
### Authors

* [Elizabeth Montalbano](https://threatpost.com/author/elizabethmontalbano/)
* [Nate Nelson](https://threatpost.com/author/natenelson/)
### Threatpost

* [Home](https://threatpost.com/)
* [About Us](https://threatpost.com/about-threatpost/)
* [Contact Us](https://threatpost.com/contact-us/)
* [RSS Feeds](https://threatpost.com/rss-feeds/)

 Search

InfoSec Insider
### Infosec Insider Post

Infosec Insider content is written by a trusted community of Threatpost cybersecurity subject matter experts. Each contribution has a goal of bringing a unique voice to important cybersecurity topics. Content strives to be of the highest quality, objective and non-commercial.

Sponsored
### Sponsored Content

Sponsored Content is paid for by an advertiser. Sponsored content is written and edited by members of our sponsor community. This content creates an opportunity for a sponsor to provide insight and commentary from their point-of-view directly to the Threatpost audience. The Threatpost editorial team does not participate in the writing or editing of Sponsored Content.



=== Content from rump2007.cr.yp.to_c0f9b1c2_20250124_211815.html ===
On the Possibility of a Back Door
in the NIST SP800-90 Dual Ec
Prng

Dan Shumow
Niels Ferguson
Microsoft

The Dual Ec PRNG

•  φ : prime curve → integers

φ (x,y) = x

•  P, Q points on the curve (per SP800-90)

si+1

si

Equations:

φ(ri*P)

φ
(si*P)

ri

φ(ri*Q)

ti

LSBbitlen-16(ti)

ri = φ(si*P)

ti = φ(ri*Q)

si+1 = φ(ri*P)

The Objection

• Point P is generator of the curve (per

SP800-90).

• Point Q is a specified constant. It is not

stated how it was derived.

• NIST prime curves have prime order.  So

there exists e such that Qe = P.

The Attack

• Output: S, the set of possible values of si+1

 the internal

state of the Dual Ec PRNG at the subsequent step.

• Suppose an attacker knows value e.

Given: a block of output oi from a Dual EC PRNG

Instance
Set S = {}.
For 0 ≤ u ≤ 216 −1
  x = u|oi
  z (cid:15495) x3 + ax + b mod p.

If y (cid:15495) z1/2 mod p exists => A = (x,y) is on the curve

S = S U {φ(e*A)}.

How this works:

• One of the values x = ti

If A is the point with x coordinate ti

 then:

A = ri * Q

  Thus:

φ(e*A) = φ(e* ri * Q) = φ(ri * P) = si+1.

  => si+1 is in S.
• |S| ≈ 215

Experimental Verification

1. Pick NIST P-256 Curve
2. Chose random d
3. Chose Q2 = d*P
4. Replace Q with Q2
5. Given |Output| = 32 > out block length
6. Filter out si+1 values that do not generate next

2 bytes.

In every experiment 32 bytes of output was

sufficient to uniquely identify the internal state
of the PRNG.

The Main Point

• If an attacker knows d such that d*P = Q

then they can easily compute e such that
e*Q = P (invert mod group order)

• If an attacker knows e then they can determine a
small number of possibilities for the internal state
of the Dual Ec PRNG and predict future outputs.
• We do not know how the point Q was chosen, so
we don’t know if the algorithm designer knows d
or e.

Conclusion

• WHAT WE ARE NOT SAYING:

NIST intentionally put a back door in this PRNG

• WHAT WE ARE SAYING:

The prediction resistance of this PRNG (as
presented in NIST SP800-90) is dependent on
solving one instance of the elliptic curve discrete
log problem.
(And we do not know if the algorithm designer
knew this before hand.)

Suggestions for Improvement

• Truncate off more than the top 16 bits of

the output block.
– Results on extractors from x coordinates of

EC points of prime curves suggest truncating
off the top bitlen/2 bits is reasonable.
• Generate a random point Q for each

instance of the PRNG.



=== Content from arstechnica.com_96941662_20250124_211809.html ===


[Skip to content](#main)

[Ars Technica home](https://arstechnica.com/)

Sections

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

* [Feature](/features/)
* [Reviews](/reviews/)
* [Store](/store/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Pin to story

Theme

* HyperLight
* Day & Night
* Dark
* System

Search dialog...

Sign In

Sign in dialog...

Sign in

Biz & IT

# Stop using NSA-influenced code in our products, RSA tells customers

Firm "strongly recommends" customers stop using RNG reported to contain NSA backdoor.

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
–
Sep 19, 2013 6:43 pm

| [83](https://arstechnica.com/information-technology/2013/09/stop-using-nsa-influence-code-in-our-product-rsa-tells-customers/#comments "83 comments")

![](https://cdn.arstechnica.net/wp-content/uploads/2013/09/rsa_logo-4e58102-listing.gif)

Text
settings

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Minimize to nav

Officials from RSA Security are advising customers of the company's BSAFE toolkit and Data Protection Manager to stop using a crucial cryptography component in the products that were recently revealed to contain a backdoor engineered by the National Security Agency (NSA).

An advisory sent to select RSA customers on Thursday confirms that both products by default use something known as Dual EC\_DRBG when creating cryptographic keys. The specification, which was approved in 2006 by the National Institute of Standards and Technology (NIST) and later by the International Organization for Standardization, [contains a backdoor that was inserted by the NSA](http://bits.blogs.nytimes.com/2013/09/10/government-announces-steps-to-restore-confidence-on-encryption-standards/), *The New York Times* reported last week. RSA's advisory came 24 hours after Ars asked the company if it intended to warn BSAFE customers about the deliberately crippled pseudo random number generator (PRNG), which is so weak that it undermines the security of most or all cryptography systems that use it.

"To ensure a high level of assurance in their application, RSA strongly recommends that customers discontinue use of Dual EC DRBG and move to a different PRNG," the RSA advisory stated. "Technical guidance, including how to change the default PRNG in most libraries, is available in the most current product documentation" on RSA's websites.

The BSAFE library is used to implement cryptographic functions into products, including at least some versions of the McAfee Firewall Enterprise Control Center, according to [NIST certifications](http://csrc.nist.gov/groups/STM/cavp/documents/drbg/drbgval.html). The RSA Data Protection Manager is used to manage cryptographic keys. Confirmation that both use the backdoored RNG means that an untold number of third-party products may be bypassed not only by advanced intelligence agencies, but possibly by other adversaries who have the resources to carry out attacks that use specially designed hardware to quickly cycle through possible keys until the correct one is guessed.

McAfee representatives issued a statement that confirmed the McAfee Firewall Enterprise Control Center 5.3.1 supported the Dual\_EC\_DRBG, but only when deployed in federal government or government contractor customer environments, where [this FIPS certification](http://csrc.nist.gov/groups/STM/cavp/documents/drbg/drbgval.html) has recommended it. The product uses the newer SHA1 PRNG random number generator in all other settings.

The NIST certification page lists dozens of other products that also use the weak RNG. Most of those appear to be one-off products. More significant is the embrace of BSAFE as the default RNG, because the tool has the ability to spawn a large number of derivative crypto systems that are highly susceptible to being broken.

## In the beginning ...

From the beginning, Dual EC\_DRBG—short for Dual Elliptic Curve Deterministic Random Bit Generator—struck some cryptographers as an odd choice for one of NIST's officially sanctioned RNGs. It was literally hundreds of times slower than typical RNGs, and its basis in "discrete logarithm" mathematics was highly unusual in production environments.

"I personally believed that it was some theoretical cryptographer's pet project," one cryptographer who asked not to be named told Ars. "I envisioned a mathematician, annoyed at the lack of theoretical foundation in random number generation, badgering his way into an NIST standard."

A year after NIST approved the RNG as a standard, two Microsoft researchers devised an attack that allowed adversaries to [guess any key created with the RNG](http://rump2007.cr.yp.to/15-shumow.pdf) with relatively little work.

Johns Hopkins professor Matt Green recounts that failing and a wealth of other peculiarities surrounding the embrace of Dual\_EC\_DRBG in an [exhaustive technical analysis published Wednesday](http://blog.cryptographyengineering.com/2013/09/the-many-flaws-of-dualecdrbg.html). Among them, when Dual\_EC\_RNG was adopted, was that it had no security proof.

"In the course of proposing this complex and slow new PRNG where the *only frigging reason you'd ever use the thing is for its security reduction*, NIST forgot to provide one," Green wrote. "This is like selling someone a Mercedes and forgetting to include the hood ornament."

In an e-mail, RSA Chief of Technology Sam Curry defended the decision-making process that went into making the RNG the default way for BSAFE and Data Protection Manager to generate keys.

"The length of time that Dual\_EC\_DRBG takes can be seen as a virtue: it also slows down an attacker trying to guess the seed," he wrote. He continued:

> Plenty of other crypto functions (PBKDF2, bcrypt, scrypt) will iterate a hash 1000 times specifically to make it slower. At the time, elliptic curves were in vogue and hash-based RNG was under scrutiny. The hope was that elliptic curve techniques—based as they are on number theory—would not suffer many of the same weaknesses as other techniques (like the FIPS 186 SHA-1 generator) that were seen as negative, and Dual\_EC\_DRBG was an accepted and publicly scrutinized standard. SP800-90 (which defines Dual EC DRBG) requires new features like continuous testing of the output, mandatory re-seeding, optional prediction resistance, and the ability to configure for different strengths.

It will take time for people to ferret out all the products that use Dual\_EC\_DRBG, particularly as the sole or default RNG. Readers who know of others are invited to leave that information in a comment to this post.

[![Photo of Dan Goodin](/wp-content/uploads/2018/10/Dang.jpg)](https://arstechnica.com/author/dan-goodin/)
[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

Dan Goodin is Senior Security Editor at Ars Technica, where he oversees coverage of malware, computer espionage, botnets, hardware hacking, encryption, and passwords. In his spare time, he enjoys gardening, cooking, and following the independent music scene. Dan is based in San Francisco. Follow him at [here](https://infosec.exchange/%40dangoodin) on Mastodon and [here](https://bsky.app/profile/dangoodin.bsky.social) on Bluesky. Contact him on Signal at DanArs.82.

[83 Comments](https://arstechnica.com/information-technology/2013/09/stop-using-nsa-influence-code-in-our-product-rsa-tells-customers/#comments "83 comments")

Comments

[Forum view](https://arstechnica.com/civis/threads/stop-using-nsa-influence-code-in-our-product-rsa-tells-customers.1218623/)

![Loading](https://arstechnica.com/wp-content/themes/ars-v9/public/images/firework-loader.75ab30.gif)

[Prev story](https://arstechnica.com/gadgets/2013/09/dont-let-me-down-apple-ios-7-on-the-ipad-2/ "Go to: Don&rsquo;t let me down, Apple: iOS 7 on the iPad 2")

[Next story](https://arstechnica.com/information-technology/2013/09/more-than-trading-laptops-for-guns-it-entrepreneur-aims-to-rewire-baltimore/ "Go to: More than trading laptops for guns, IT entrepreneur aims to rewire Baltimore")

Most Read

1. [![Listing image for first story in Most Read: Florida man eats diet of butter, cheese, beef; cholesterol oozes from his body](https://cdn.arstechnica.net/wp-content/uploads/2025/01/GettyImages-486885317-768x432.jpg)](https://arstechnica.com/health/2025/01/florida-man-eats-diet-of-butter-cheese-beef-cholesterol-oozes-from-his-body/)

   1.
   [Florida man eats diet of butter, cheese, beef; cholesterol oozes from his body](https://arstechnica.com/health/2025/01/florida-man-eats-diet-of-butter-cheese-beef-cholesterol-oozes-from-his-body/)
2. 2.
   [All federal agencies ordered to terminate remote work—ideally within 30 days](https://arstechnica.com/tech-policy/2025/01/all-federal-agencies-ordered-to-terminate-remote-work-ideally-within-30-days/)
3. 3.
   [Trump’s FCC chair gets to work on punishing TV news stations accused of bias](https://arstechnica.com/tech-policy/2025/01/trumps-fcc-chair-gets-to-work-on-punishing-news-stations-accused-of-bias/)
4. 4.
   [George R.R. Martin has co-authored a physics paper](https://arstechnica.com/uncategorized/2025/01/george-r-r-martin-has-co-authored-a-physics-paper/)
5. 5.
   [OpenAI launches Operator, an AI agent that can operate your computer](https://arstechnica.com/ai/2025/01/openai-launches-operator-an-ai-agent-that-can-operate-your-computer/)

Customize

Ars Technica has been separating the signal from
the noise for over 25 years. With our unique combination of
technical savvy and wide-ranging interest in the technological arts
and sciences, Ars is the trusted source in a sea of information. After
all, you don’t need to know everything, only what’s important.

More
from Ars

* [About Us](https://arstechnica.com/about-us/)
* [Staff Directory](https://arstechnica.com/staff-directory/)
* [Newsletters](https://arstechnica.com/newsletters/)
* [Ars Videos](https://arstechnica.com/video/)
* [General FAQ](https://arstechnica.com/general-faq/)
* [RSS Feeds](https://arstechnica.com/rss-feeds/)

Contact

* [Contact us](https://arstechnica.com/contact-us/)
* [Advertise with us](https://www.condenast.com/brands/ars-technica)
* [Reprints](https://arstechnica.com/reprints/)

Do Not Sell My Personal
Information

© 2025 Condé Nast. All rights reserved. Use of and/or
registration on any portion of this site constitutes acceptance of our [User Agreement](https://www.condenast.com/user-agreement/) and
[Privacy Policy and
Cookie Statement](https://www.condenast.com/privacy-policy/) and [Ars
Technica Addendum](/amendment-to-conde-nast-user-agreement-privacy-policy/) and [Your
California Privacy Rights](https://www.condenast.com/privacy-policy/#california). Ars Technica may earn compensation on
sales from links on this site. [Read our
affiliate link policy](/affiliate-link-policy/). The material on this site may not be
reproduced, distributed, transmitted, cached or otherwise used, except
with the prior written permission of Condé Nast. [Ad
Choices](https://www.aboutads.info/)



=== Content from blog.cryptographyengineering.com_4815ad45_20250124_211813.html ===

[Skip to content](#content)
[Menu](#slide-menu)
# [A Few Thoughts on Cryptographic Engineering](https://blog.cryptographyengineering.com/)

## Some random thoughts about crypto. Notes from a course I teach. Pictures of my dachshunds.

![](https://matthewdgreen.files.wordpress.com/2016/08/matthew-green.jpg?w=200&h=300)
# Matthew Green

I'm a cryptographer and professor at Johns Hopkins University. I've designed and analyzed cryptographic systems used in wireless networks, payment systems and digital content protection platforms. In my research I look at the various ways cryptography can be used to promote user privacy.

[My academic website](https://matthewgreen.io)

[BlueSky](https://bsky.app/profile/did%3Aplc%3Axvgztewzbfh7bpnklayrsvds)

[Mastodon](https://ioc.exchange/%40matthew_d_green)

[Twitter](https://twitter.com/matthew_d_green)

[Top Posts](https://blog.cryptographyengineering.com/top-posts/)

[Useful crypto resources](https://staging.cryptographyengineering.com/useful-cryptography-resources/)

[Bitcoin tipjar](https://blog.cryptographyengineering.com/p/bitcoin-tipjar.html)

[Cryptopals challenges](http://cryptopals.com/)

[Applied Cryptography Research: A Board](https://acrab.isi.jhu.edu/)

[Journal of Cryptographic Engineering
(not related to this blog)](http://www.springer.com/computer/security%2Band%2Bcryptology/journal/13389)

Search for:

# Top Posts & Pages

* [Let's talk about AI and end-to-end encryption](https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/)
* [Is Telegram really an encrypted messaging app?](https://blog.cryptographyengineering.com/2024/08/25/telegram-is-not-really-an-encrypted-messaging-app/)
* [Zero Knowledge Proofs: An illustrated primer](https://blog.cryptographyengineering.com/2014/11/27/zero-knowledge-proofs-illustrated-primer/)
* [What's the matter with PGP?](https://blog.cryptographyengineering.com/2014/08/13/whats-matter-with-pgp/)
* [Attack of the week: RC4 is kind of broken in TLS](https://blog.cryptographyengineering.com/2013/03/12/attack-of-week-rc4-is-kind-of-broken-in/)
* [All Posts](https://blog.cryptographyengineering.com/all-posts/)
* [Attack of the week: FREAK (or 'factoring the NSA for fun and profit')](https://blog.cryptographyengineering.com/2015/03/03/attack-of-week-freak-or-factoring-nsa/)
* [A very casual introduction to Fully Homomorphic Encryption](https://blog.cryptographyengineering.com/2012/01/02/very-casual-introduction-to-fully/)
* [One-Time Programs](https://blog.cryptographyengineering.com/2022/10/27/one-time-programs/)
* [How to choose an Authenticated Encryption mode](https://blog.cryptographyengineering.com/2012/05/19/how-to-choose-authenticated-encryption/)
 *Banner image by Matt Blaze*
# Archives

Archives
Select Month
 January 2025  (1)
 August 2024  (1)
 April 2024  (1)
 January 2024  (1)
 November 2023  (1)
 October 2023  (1)
 August 2023  (1)
 May 2023  (2)
 April 2023  (1)
 March 2023  (1)
 December 2022  (1)
 October 2022  (1)
 June 2022  (1)
 January 2022  (1)
 August 2021  (1)
 July 2021  (1)
 March 2021  (1)
 November 2020  (1)
 August 2020  (1)
 July 2020  (1)
 April 2020  (1)
 March 2020  (1)
 January 2020  (1)
 December 2019  (1)
 October 2019  (1)
 September 2019  (1)
 June 2019  (1)
 February 2019  (1)
 December 2018  (1)
 October 2018  (1)
 September 2018  (1)
 July 2018  (2)
 May 2018  (1)
 April 2018  (3)
 February 2018  (1)
 January 2018  (2)
 December 2017  (1)
 November 2017  (1)
 October 2017  (2)
 September 2017  (1)
 July 2017  (1)
 March 2017  (1)
 February 2017  (1)
 January 2017  (1)
 November 2016  (1)
 August 2016  (2)
 July 2016  (1)
 June 2016  (1)
 March 2016  (2)
 December 2015  (1)
 November 2015  (1)
 October 2015  (1)
 September 2015  (1)
 August 2015  (1)
 July 2015  (1)
 May 2015  (1)
 April 2015  (2)
 March 2015  (1)
 February 2015  (3)
 January 2015  (1)
 December 2014  (1)
 November 2014  (1)
 October 2014  (3)
 September 2014  (1)
 August 2014  (1)
 July 2014  (1)
 April 2014  (2)
 March 2014  (1)
 February 2014  (1)
 January 2014  (1)
 December 2013  (4)
 October 2013  (1)
 September 2013  (4)
 August 2013  (1)
 July 2013  (1)
 June 2013  (2)
 May 2013  (1)
 April 2013  (2)
 March 2013  (2)
 February 2013  (3)
 January 2013  (2)
 December 2012  (1)
 November 2012  (1)
 October 2012  (4)
 September 2012  (3)
 August 2012  (4)
 July 2012  (2)
 June 2012  (3)
 May 2012  (5)
 April 2012  (6)
 March 2012  (4)
 February 2012  (7)
 January 2012  (8)
 December 2011  (11)
 November 2011  (13)
 October 2011  (7)
 September 2011  (8)

[Matthew Green](https://blog.cryptographyengineering.com/author/matthewdgreen/ "Posts by Matthew Green")
in [Dual EC](https://blog.cryptographyengineering.com/category/dual-ec/), [NSA](https://blog.cryptographyengineering.com/category/nsa/), [RNGs](https://blog.cryptographyengineering.com/category/rngs/)
September 18, 2013August 22, 2016
3,033 Words

# The Many Flaws of Dual\_EC\_DRBG

|  |
| --- |
| The Dual\_EC\_DRBG generator from [NIST SP800-90A](http://csrc.nist.gov/publications/nistpubs/800-90A/SP800-90A.pdf). |

***Update 9/19:*** *[RSA warns developers not to use the default Dual\_EC\_DRBG generator in BSAFE](http://arstechnica.com/security/2013/09/stop-using-nsa-influence-code-in-our-product-rsa-tells-customers/). Oh lord.*

As a technical follow up to my [previous post](https://blog.cryptographyengineering.com/2013/09/on-nsa.html) about the NSA’s war on crypto, I wanted to make a few specific points about standards. In particular I wanted to address the allegation that NSA inserted a backdoor into the [Dual-EC pseudorandom number generator](http://en.wikipedia.org/wiki/Dual_EC_DRBG).

For those not following the story, Dual-EC is a pseudorandom number generator proposed by [NIST](http://www.nist.gov/index.html) for international use back in 2006. Just a few months later, Shumow and Ferguson made cryptographic history by pointing out that [there might be an NSA backdoor](http://rump2007.cr.yp.to/15-shumow.pdf) in the algorithm. This possibility — fairly remarkable for an algorithm of this type — looked bad and smelled worse. If true, it spelled almost certain doom for anyone relying on Dual-EC to keep their system safe from spying eyes.

Now I should point out that much of this is ancient history. What *is* news today is the recent [leak of classified documents](http://www.theguardian.com/world/2013/sep/05/nsa-gchq-encryption-codes-security) that points a very emphatic finger towards Dual\_EC, or rather, to an unnamed ‘2006 NIST standard’. The evidence that Dual-EC is this standard has now become so hard to ignore that NIST recently took the unprecedented step of [warning implementers to avoid it altogether](http://www.propublica.org/documents/item/785571-itlbul2013-09-supplemental#document/p2).

Better late than never.

In this post I’m going to try to explain the curious story of Dual-EC. While I’ll do my best to keep this discussion at a high and non-mathematical level, be forewarned that I’m probably going to fail at least at a couple of points. I you’re not the mood for all that, here’s a short summary:

* In 2005-2006 NIST and NSA released a pseudorandom number generator based on elliptic curve cryptography. They released this standard — with very little explanation — both in the US and [abroad](http://www.iso.org/iso/home/store/catalogue_tc/catalogue_detail.htm?csnumber=54945).
* This RNG has some serious issues with *just being a good RNG.* The presence of such obvious bugs was mysterious to cryptographers.
* In 2007 a pair of Microsoft researchers pointed out that these vulnerabilities combined to produce a perfect storm, which — together with some knowledge that only NIST/NSA might have — opened a perfect backdoor into the random number generator itself.
* This backdoor may allow the NSA to break nearly any cryptographic system that uses it.

If you’re still with me, strap in. Here goes the long version.

### **Dual-EC**

For a good summary on the history of Dual-EC-DRBG, see this [2007 post](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html) by Bruce Schneier. Here I’ll just give the highlights.

Back in 2004-5, NIST decided to address a longstanding weakness of the [FIPS standards](https://en.wikipedia.org/wiki/Federal_Information_Processing_Standards), namely, the limited number of approved [pseudorandom bit generator](https://en.wikipedia.org/wiki/Pseudorandom_number_generator) algorithms (PRGs, or ‘DRBGs’ in NIST parlance) available to implementers. This was actually a bit of an issue for FIPS developers, since the [existing random number generators](http://csrc.nist.gov/groups/STM/cavp/documents/rng/931rngext.pdf) had some [known design weaknesses](https://www.schneier.com/paper-prngs.pdf).\*

NIST’s answer to this problem was [Special Publication 800-90](http://csrc.nist.gov/publications/nistpubs/800-90A/SP800-90A.pdf), parts of which were later wrapped up into the international standard [ISO 18031](http://www.iso.org/iso/home/store/catalogue_tc/catalogue_detail.htm?csnumber=54945). The NIST pub added four new generators to the FIPS canon. None these algorithms is a *true* random number generator in the sense that they collect physical entropy. Instead, what they do is process the (short) output of a true random number generator — like the [one in Linux](http://en.wikipedia.org/wiki//dev/random) — conditioning and stretching this ‘seed’ into a large number of *random-looking* bits you can use to get things done.\*\* This is particularly important for [FIPS-certified](http://csrc.nist.gov/groups/STM/cmvp/) cryptographic modules, since the [FIPS 140-2](http://csrc.nist.gov/publications/fips/fips140-2/fips1402.pdf) standards typically *require* you to use a DRBG as a kind of ‘post-processing’ — even when you have a decent hardware generator.

The first three SP800-90 proposals used standard [symmetric](http://en.wikipedia.org/wiki/Symmetric-key_algorithm)components like hash functions and block ciphers. [Dual\_EC\_DRBG](https://en.wikipedia.org/wiki/Dual_EC_DRBG) was the odd one out, since it employed mathematics more that are typically used to construct [public-key cryptosystems](http://en.wikipedia.org/wiki/Public-key_cryptography). This had some immediate consequences for the generator: Dual-EC is slow in a way that its cousins aren’t. Up to a thousand times slower.

Now before you panic about this, the inefficiency of Dual\_EC is *not necessarily*one of its flaws! Indeed, the inclusion of an algebraic generator actually makes a certain amount of sense. The academic literature includes a distinguished history of *provably secure* [PRGs based on on number theoretic assumptions](https://en.wikipedia.org/wiki/Blum_Blum_Shub), and it certainly didn’t hurt to consider one such construction for standardization. Most developers would probably use the faster symmetric alternatives, but perhaps a small number would prefer the added confidence of a provably-secure construction.

Unfortunately, here is where NIST ran into their first problem with Dual\_EC.

### ***Flaw #1: Dual-EC has no security proof***

Let me spell this out as clearly as I can. In the course of proposing this complex and slow new PRG where the *only damn* *reason you’d ever use the thing is for its security reduction,* NIST forgot to provide one. This is like selling someone a Mercedes and forgetting to attach the hood ornament.

I’d like to say this fact alone should have damned Dual\_EC, but sadly this is par for the course for NIST — which treats security proofs like those cool [Japanese cookies](http://www.averagebetty.com/images/vancouver_japanese_cookie.jpg) you can never find. In other words, a fancy, exotic *luxury*. Indeed, NIST has a nasty habit of dumping proof-writing work onto outside academics, often *after* the standard has been finalized and implemented in products everywhere.

So when NIST put forward its first draft of SP800-90 in 2005, academic cryptographers were left to analyze it from scratch. Which, to their great credit, [they were quite](http://eprint.iacr.org/2006/190.pdf) [successful](http://www.math.ntnu.no/~kristiag/drafts/dual-ec-drbg-comments.pdf) at.

The first thing reviewers noticed is that Dual-EC follows a known design paradigm — it’s a weird variant of an elliptic curve linear congruential generator. However they *also* noticed that NIST had made some odd rookie mistakes.

Now here we will have to get slightly wonky — though I will keep mathematics to a minimum. (I promise it will all come together in the end!) Constructions like Dual-EC have basically two stages:

[![](https://i0.wp.com/upload.wikimedia.org/wikipedia/commons/thumb/d/d0/ECClines-3.svg/346px-ECClines-3.svg.png)](http://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/ECClines-3.svg/346px-ECClines-3.svg.png)**1. A stage that generates a series of pseudorandom elliptic curve points**.Just like on the graph at right, an elliptic curve point is a pair (*x, y*) that satisfies an [elliptic curve](https://en.wikipedia.org/wiki/Elliptic_curve) equation. In general, both *x* and *y* are elements of a [finite field](http://en.wikipedia.org/wiki/Finite_field), which for our purposes means they’re just large integers.\*\*\*

The main operation of the PRNG is to apply mathematical operations to points on the elliptic curve, in order to generate new points that are pseudorandom — i.e., are indistinguishable from random points in some subgroup.

And the good news is that Dual-EC seems to do this first part beautifully! In fact [Brown and Gjøsteen](http://www.math.ntnu.no/~kristiag/drafts/dual-ec-drbg-comments.pdf) even *[proved](http://eprint.iacr.org/2007/048)*that this part of the generator is sound provided that the [Decisional Diffie-Hellman](https://en.wikipedia.org/wiki/Decisional_Diffie%E2%80%93Hellman_assumption) problem is hard in the specific elliptic curve subgroup. This is a well studied hardness assumption so we can probably feel pretty confident in this proof.

**2. Extract pseudorandom *bits* from the generated EC points.** While the *points* generated by Dual-EC may be pseudorandom, that doesn’t mean the specific (*x, y*) integer pairs are random bitstrings. For one thing, ‘*x*‘ and ‘*y*‘ are not really bitstrings at all, they’re integers less than some prime number. Most pairs don’t satisfy the curve equation or are not in the right subgroup. Hence you can’t just output the raw *x* or *y* values and expect them to make good pseudorandom bits.

Thus the second phase of the generator is to ‘extract’ *some* (but not all) of the bits from the EC points. Traditional literature designs do all sorts of things here — including hashing the point or dropping up to half of the bits of the *x-*coordinate. Dual-EC does something much simpler: it grabs the *x* coordinate, throws away the most significant 16-18 bits, and outputs the rest.

In 2006, first [Gjøsteen](http://www.math.ntnu.no/~kristiag/drafts/dual-ec-drbg-comments.pdf) and later [Schoenmakers and Sidorenko](http://eprint.iacr.org/2006/190) took a close look at Dual-EC and independently came up with a surprising result:

### ***Flaw #2: Dual-EC outputs too many bits***

Unlike those previous EC PRGs which output anywhere from 2/3 to half of the bits from the *x*-coordinate, Dual-EC outputs nearly the entire thing.

This is good for efficiency, but unfortunately it also gives Dual-EC a *bias.* Due to some quirks in the mathematics of the field operations, an attacker can now predict the next bits of Dual-EC output with a fairly small — but non-trivial — success probability, in the range of 0.1%. While this number may seem small to non-cryptographers, it’s basically a hanging offensefor a cryptographic random number generator where probability of predicting a future bit should be many orders of magnitude lower.

What’s just plain baffling is that this flaw ever saw the light of day. After all, the specification was developed by bright people at NIST — in collaboration with NSA. Either of those groups should *easily* have discovered a bug like this, especially since this issue had been previously studied. Indeed, within a few months of public release, *two separate* groups of academic cryptographers found it, and were able to implement an attack using standard PC equipment.

So in summary, the bias is mysterious and it seems to be very much an ‘own-goal’ on the NSA’s part. Why in the world would they release so much information from each EC point? It’s hard to say, but a bit more investigation reveals some interesting consequences:

### ***Flaw #3: You can guess the original EC point from looking at the output bits***

By itself this isn’t really a flaw, but will turn out to be interesting in just a minute.

Since Dual-EC outputs so many bits from the *x-*coordinate of each point — all but the most significant 16 bits — it’s relatively easy to guess the original source point by simply brute-forcing the missing 16 bits and solving the elliptic curve equation for *y. (*This is all high-school algebra, I swear!)

So what does this mean? In general, recovering the EC point shouldn’t actually be a huge problem. In theory it could lead to a weakness — say predicting future outputs — but in a proper design you would still have to solve a [discrete logarithm](https://en.wikipedia.org/wiki/Discrete_logarithm) instance for *each and every point* in order to predict the next bytes output by the generator.

And here is where things get interesting.

### ***Flaw #4*: *If you know a certain property about the Dual\_EC parameters, and can recover an output point, you can predict all subsequent outputs of the generator***

Did I tell you this would get interesting in a minute? I totally did.

The next piece of our puzzle [was discovered](http://rump2007.cr.yp.to/15-shumow.pdf) by Microsoft researchers Dan Shumow and Niels Ferguson, and announced at the CRYPTO 2007 rump session. I think this result can best be described via the totally intuitive diagram below. (Don’t worry, I’ll explain it!)

|  |
| --- |
| | Annotated diagram from [Shumow-Ferguson presentation](http://rump2007.cr.yp.to/15-shumow.pdf) (CRYPTO 2007). | | --- | |

The Dual-EC generator consists of two stages: a portion that generates the output bits (right) and a part that updates the internal state (left).

Starting from the “*r\_i*” value (circled, center) and heading right, the bit generation part first computes the output point using the function “*r\_i \* Q*” — where *Q* is an elliptic curve point defined in the parameters — then truncates 16 bits its off its *x-*coordinate to get the raw generator output. The “\*” operator here describes elliptic point multiplication, which is a complex operation that should be relatively hard to invert.

Note that everything after the point multiplication should be *easy* to invert and recover from the output, as we discussed in the previous section.

Every time the generator produces one block of output bits, it also *updates* its internal state. This is designed to prevent attacks where someone compromises the internal values of a working generator, then uses this value to wind the generator backwards and guess past outputs. Starting again from the circled “*r\_i*” value, the generator now heads upwards and computes the point “*r\_i \* P*” where *P* is a different elliptic curve point also described in the parameters. It then does some other stuff.

The theory here is that *P* and *Q* should be random points, and thus it should be difficult to find “*r\_i \* P*” used for state update even if you know the output point “*r\_i \* Q*” — which I stress you *do* know, because it’s easy to find. Going from one point to the other requires you to know a relationship between *P* and *Q, which you shouldn’t actually know* since they’re supposed to be random values. The difficulty of this is indicated by the thick red arrow.

|  |
| --- |
| Looks totally kosher to me. (Source: NIST SP800-90A) |

There is, however, one tiny little exception to this rule. What if *P* and *Q* aren’t entirely random values? What if you chose them yourself specifically so you’d know the mathematical relationship between the two points?

In this case it turns out you can easily compute the next PRG state after recovering a single output point (from 32 bytes of RNG output). This means you can follow the equations through and predict the *next* output. And the next output after that. And on forever and forever.\*\*\*\*

This is a huge deal in the case of [SSL/TLS](http://www.ietf.org/rfc/rfc2246.txt), for example. If I use the Dual-EC PRG to generate the “Client Random” nonce transmitted in the beginning of an SSL connection, then the NSA will be able to predict the “Pre-Master” secret that I’m going to generate during the RSA handshake. Given this information the connection is now a cleartext read. This is*not good.*

So now you should all be asking the most important question of all: *how the hell*did the NSA generate the specific *P* and *Q* values recommended in Appendix A of Dual-EC-DRBG? And do they know the relationship that allows them to run this attack? All of which brings us to:

### ***Flaw #5*: *Nobody knows where the recommended parameters came from***

And if you think that’s problematic, welcome to the club.

### **But why? And where is Dual-EC used?**

The ten million dollar question of Dual-EC is *why* the NSA would stick such an obviously backdoored algorithm into an important standard. Keep in mind that cryptographers found the major (bias) vulnerabilities almost immediately after Dual-EC shipped. The possibility of a ‘backdoor’ was announced in summer 2007. Who would still use it?

A few people have [gone through the list of CMVP-evaluated products](http://crypto.stackexchange.com/questions/10189/who-uses-dual-ec-drbg) and found that the answer is: *quite a few people would*. Most certify Dual-EC simply because it’s implemented in [OpenSSL-FIPS](http://www.openssl.org/docs/fips/fipsnotes.html), and they happen to use that library. But at least [one provider](http://csrc.nist.gov/groups/STM/cavp/documents/drbg/drbgval.html) certifies it *exclusively.* Yuck.

|  |
| --- |
| Hardcoded constants from the OpenSSL-FIPS |

It’s worth keeping in mind that NIST standards carry a lot of weight — even those that *might* have a backdoor. Folks who aren’t keeping up on the latest crypto results could still innocently use the thing, either by accident or (less innocently) because the government asked them to. Even if they don’t use it, they might include the code in their product — say through the inclusion of OpenSSL-FIPS or MS Crypto API — which means it’s just a function call away from being surreptitiously activated.

Which is why people need to stop including Dual-EC immediately. We have no idea what it’s for, but it needs to go away. Now.

### **So what about the curves?**

The last point I want to make is that the vulnerabilities in Dual-EC have precisely nothing to do with the specifics of the [NIST standard elliptic curves themselves](http://csrc.nist.gov/groups/ST/toolkit/documents/dss/NISTReCur.pdf). The ‘back door’ in Dual-EC comes exclusively from the relationship between *P* and *Q* — the latter of which is published only in the Dual-EC specification.The attack can work even if you don’t use the NIST pseudorandom curves.

However, the revelations about NIST and the NSA certainly make it worth our time to ask whether these curves themselves are somehow weak. The best answer to that question is: *we don’t know*. Others have observed that NIST’s process for generating the curves [leaves a lot to be desired](http://www.hyperelliptic.org/tanja/vortraege/20130531.pdf). But including some kind of hypothetical backdoor would be a *horrible, horrific* idea — one that would almost certainly blow back at us.

You’d think people with common sense would realize this. Unfortunately we can’t count on that anymore.

*Thanks to [Tanja Lange](http://www.hyperelliptic.org/tanja/) for her assistance proofing this post. Any errors in the text are entirely mine.*

*Notes:*

\* My recollection of this period is hazy, but prior to SP800-90 the two most common FIPS DRBGs in production were *(1)* the SHA1-based DSA generator of [FIPS 186-2](http://csrc.nist.gov/publications/fips/archive/fips186-2/fips186-2.pdf) and *(2)* [ANSI X9.31](http://csrc.nist.gov/groups/STM/cavp/documents/rng/931rngext.pdf). The DSA generator was a special-purpose generator based on SHA1, and was really designed just for that purpose. ANSI X9.31 used block ciphers, but suffered from some more subtle weaknesses it retained from the earlier X9.17 generator. These were pointed out by [Kelsey, Schneier, Wagner and Hall](https://www.schneier.com/paper-prngs.pdf).

*\*\** This is actually a requirement of the FIPS 140-2 specification. Since FIPS does not approve any true random number generators, it instead *mandates* that you run your true RNG output through a DRBG (PRNG) first. The only exception is if your true RNG has been approved ‘for classified use’.

\*\*\* Specifically, *x* and *y* are integers in the range *0* to *p-1* where *p* is a large prime number. A point is a pair (*x, y*) such that ![y^2 = x^3 + ax + b](https://i0.wp.com/upload.wikimedia.org/math/9/2/b/92bc19343fd705e286b3954f528b0993.png) mod *p.* The values *a* and *b* are defined as part of the curve parameters.

\*\*\*\* The process of predicting future outputs involves a few guesses, since you don’t know the exact output point (and had to guess at the missing 16 bits), but you can easily reduce this to a small set of candidates — then it’s just a question of looking at a few more bits of RNG output until you guess the right one.

### *Related*

## Post navigation

[A note on the NSA, the future and fixing mistakes](https://blog.cryptographyengineering.com/2013/09/10/a-note-on-nsa-future-and-fixing-mistakes/)[RSA warns developers not to use RSA products](https://blog.cryptographyengineering.com/2013/09/20/rsa-warns-developers-against-its-own/)

## 23 thoughts on “The Many Flaws of Dual\_EC\_DRBG”

1. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Javier Ramos](https://www.blogger.com/profile/17415230899433879435)** says:
   [September 19, 2013 at 1:59 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1015)

   I have degree from ITT Technical Institute. I was taught that the U.S. government mandates no encryption standard can surpass theirs and they have to be able to crack all encryption standards in play.

   I guess a new trend in Information Technology is going to emerge. Specifically a heightened increase in national IT security and pride. Brazil has already announced plans for a new dedicated backbone bypassing America. So much for globalization.
3. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
   [September 19, 2013 at 2:02 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1016)

   You Mr Green, Lange, Schneier, Bernstein etc became famous because of hero whistleblower Mr Snowden and the evil NSA. Your life must have changed for the better. Keep it up. In math and cryptographers we trust.
5. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **db** says:
   [September 19, 2013 at 5:49 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1017)

   The US government tried to mandate backdoors in everything by law in the 90s and lost due to public outcry. What they couldn't mandate by law they have ever since resorted to trying to get by subterfuge. They will never listen to what the people want, they are against the people.

   And reducing USA-centric-ness of the internet isn't killing globalization, it's enhancing globalization. The whole definition of “globalization” excludes there being one massive central authority controlling everything like the US has been doing! Why do people have an “I must be in charge to ensure harmony by force, otherwise there's chaos” attitude to everything? Open Source has taught us that that is not the case, it's just an excuse that dictators use to keep power.
7. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[lxgr](http://blog.lxgr.net/)** says:
   [September 19, 2013 at 10:34 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1018)

   Thank you, that was just the detailed analysis of the issue I was hoping to eventually find here 🙂

   I'm wondering about one thing: Assuming that somebody chose P and Q specifically for their mathematical relationship (i.e., they own the “secret key” to the DRBG), would they also be able to “rewind” the DRBG and recover previous outputs, or does this concern future outputs only?
9. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
   [September 19, 2013 at 10:45 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1019)

   Thank your for the very informative and interesting read 🙂

   So, without real knowledge of crypto, I would naively assume that, if we just use other EC points than the predefined P and Q, we could bypass the NSA-knows-the-ec-point-relationship problem and just use the basic algorithm of the standard.

   Or is the problem one level deeper, at the EC itself? Is the EC fundamentally corrupted?

   MK
11. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Vadim](http://rumyantsev.org)** says:
    [September 19, 2013 at 11:08 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1020)

    If the problem is in just two number P and Q, why hasn't somebody generated new set of numbers and explained to everyone how he did it? Seems like guys from OpenSSL could have done this. Why not?
13. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Rudd-O](https://www.blogger.com/profile/07681345274514958394)** says:
    [September 19, 2013 at 12:53 pm](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1021)

    This isn't about common sense — it's about corruption and lies.
15. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Matthew Green](https://www.blogger.com/profile/05041984203678598124)** says:
    [September 19, 2013 at 12:59 pm](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1022)

    No, you're absolutely right. Replacing “Q” with one generated randomly \*will\* kill the backdoor. Later versions of the spec include an (optional) Appendix describing how to do this. However I've looked at a couple of open implementations — including OpenSSL — and they still use the default parameters.

    As I said above, the backdoor in Dual\_EC has nothing to do with corruption of the elliptic curves themselves. But there's nothing wrong with an excess of caution right now.
17. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Matthew Green](https://www.blogger.com/profile/05041984203678598124)** says:
    [September 19, 2013 at 12:59 pm](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1023)

    You can generate your own “Q” value. But it's not the default in most implementations.
19. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Alexandre Anzala-Yamajako](https://www.blogger.com/profile/09360810877910199189)** says:
    [September 19, 2013 at 1:37 pm](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1024)

    The reason why tou would use the NIST (read NSA) mandated EC Points is the reason you would use any NIST (read NSA) approved algorithm : It has supposedly been vetted by experts cryptographers and are A (not necessarily THE) good choice. Implementing DUAL-EC exactly as NIST specified requires programming skills while changing the points requires some mild understanding of what a Elliptic Curve is.
    And last but not least, I'm not sure you can get a product certified if you actually chose other parameters as the ones that were specified by NIST (read, say-it-with-me NSA).
21. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 19, 2013 at 5:57 pm](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1025)

    I have a degree from the Blaine School of Cosmetology and I would love for you to state an actually credible source for that.
23. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[droope](https://www.blogger.com/profile/10165603102075089180)** says:
    [September 20, 2013 at 12:25 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1026)

    Hey Javier,

    A quick question, how is Brazil being able to communicate with Europe without being MITM'd by USA bad for globalization?

    It skips America because America is hostile, it's just common sense. Connections still would be able to reach America, or go through America if that is the most convenient path.
25. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 20, 2013 at 6:48 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1027)

    Ok, thank you for the clarification 🙂

    MK
27. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 20, 2013 at 10:15 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1028)

    Thanks for the post, Dr. Green. In the future I hope you tackle the question of the NIST elliptic curve generation “controversy” and let us know if there is truly anything fishy with that whole process.

    It's sad, but this whole Snowden debacle is going to cause a lot of distrust in NIST from now on. Perhaps that's a good thing as it might result in new findings from cryptographers who go back and really analyze these standards again.
29. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Jack Parsons](http://en.wikipedia.org/wiki/John_Whiteside_Parsons)** says:
    [September 21, 2013 at 1:14 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1032)

    Assume there are more obscure hacks hiding behind the obvious fix. In the intelligence biz, it's called a 'modified limited hangout': the ability to say “oh, yes, you caught us dead to rights” while distracting you from deeper wrongness.
31. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [September 23, 2013 at 9:40 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1043)

    I never fully understood what my teacher in a cryptography 101 lesson at university 20 years ago meant with: Be suspicious with algorithms where the design principles are not published. I simply couldn't imagine how a backdoor could be planted into an algorithms – now I can!
    Thanks for making this understandable to someone who is dealing with security in everyday practice, but who is not a mathematician. 🙂
33. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Blaine Bateman](https://www.blogger.com/profile/18216272967325227628)** says:
    [September 24, 2013 at 5:22 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1048)

    Purely for the entertainment value to the audience here, I offer that it occurred to me that the suspect P-Q could have been a test case provided by the NSA, along the lines of “Given how the algorithm is supposed to work, if we corrupt the P-Q pair by making them non-random using a specific mathematical relationship between them, then the algorithm should be provably not secure. Demonstrating this should increase the confidence that the correctly implemented algorithm is secure.” Then what happened is some arrogant scientist at NIST (full disclosure–I was formerly a NIST employee, and the terms of my departure still burn as a fire in the pit of my stomach) conveniently “forgot” to put the correct ones in the standard, or did it on purpose since “Anyone of modest skill in cryptography will detect the problem and come up with their own P-Q pair correctly. Anyone who doesn't deserves what they get.” There are, in my estimation, people that arrogant employed by NIST.
35. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Porcelain Veneers](http://www.dentartistry.com.au/porcelain-veneers)** says:
    [September 24, 2013 at 10:25 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1050)

    There’s no word to describe such a great masterpiece. You made such an interesting piece to read, giving every subject enlightenment for us to gain knowledge and information [Porcelain Veneers](http://www.dentartistry.com.au/porcelain-veneers)
37. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[Tanja Lange](https://www.hyperelliptic.org/tanja/)** says:
    [October 1, 2013 at 9:09 pm](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1060)

    From 'just' knowing log\_Q P you only get the future outputs. For getting past ones requires computing discrete logarithms. So far we don't know any way that this mathematical problem is easier on the NIST curves.
39. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **Anonymous** says:
    [October 3, 2013 at 11:40 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1061)

    I wonder if the choice of Brazil to bypass the US will help them…. Point of arrival probably will be a NSA-cooperative state. We all learned that the services of NSA and other secret services are so damned intertwined that it is impossible to transfer packets around the globe finally to hit one of their tapping points. And then…. With IPV6 we're lost…. Profiling is 50% of their information value, fully fully compatible with war time UK Y-stations, only capable to log the 'gibberish' from the Germans (Enigma traffic) but very very good in profiling the radio networks. At the start of the war the job actually was done by half. Look at the analogy…. Amazing, isn't it?
    <http://www.cryptomuseum.com>
41. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[CycleTimeChart](https://www.blogger.com/profile/17479869037491765636)** says:
    [October 8, 2013 at 2:39 am](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1063)

    I would appreciate your advice on how to publish a freeware encryption program I constructed.

    Please reply to DavidLNewton@comcast.net
43. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[David Jacobson](https://www.blogger.com/profile/03035235978314013454)** says:
    [October 10, 2013 at 4:12 pm](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1064)

    This comment has been removed by the author.
45. ![](https://0.gravatar.com/avatar/?s=48&d=identicon&r=PG) **[David Jacobson](https://www.blogger.com/profile/03035235978314013454)** says:
    [October 10, 2013 at 4:16 pm](https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/#comment-1065)

    Some of the comments ask why not just generate your own points. The naive answer is, “Sure, you can do that.” NIST SP 800-90A even discusses that as an option. However, if you want to have your device or code validated as FIPS 140-2 compliant, it has to pass some known answer tests. (You feed in the supplied value as though it was entropy, and check the first so many output blocks match the known answers.) And those tests are (I think) dependent on P and Q being as published in NIST SP 800-90A.

    So the short answer is “yes, you can”, but the catch is that you will have to have some sort of option to test with the published points, and the use your own, and you will have to convince the validation lab that this is all okay.

    The “I think” is because the published examples are on the NIST web site, but that is down due to the government shutdown, so I can't go look.

Comments are closed.

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

Menu
## Menu

* [Home](https://matthewdgreen.wordpress.com)
* [About Me](https://blog.cryptographyengineering.com/about-me/)
* [Bitcoin Tipjar](https://blog.cryptographyengineering.com/bitcoin-tipjar/)
* [Top Posts](https://blog.cryptographyengineering.com/top-posts/)
* [All Posts](https://blog.cryptographyengineering.com/all-posts/)
* [Useful Cryptography Resources](https://blog.cryptographyengineering.com/useful-cryptography-resources/)

* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) A Few Thoughts on Cryptographic Engineering](https://blog.cryptographyengineering.com)

  Join 1,017 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.cryptographyengineering.com%252F2013%252F09%252F18%252Fthe-many-flaws-of-dualecdrbg%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) A Few Thoughts on Cryptographic Engineering](https://blog.cryptographyengineering.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.cryptographyengineering.com%252F2013%252F09%252F18%252Fthe-many-flaws-of-dualecdrbg%252F)
  + [Copy shortlink](https://wp.me/pE4dk-3I)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/)
  + [View post in Reader](https://wordpress.com/read/blogs/9549322/posts/230)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from www.schneier.com_53e1b686_20250124_211818.html ===

# [Schneier on Security](https://www.schneier.com/)

Menu

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)

### Search

*Powered by [DuckDuckGo](https://duckduckgo.com/)*

Blog

Essays

Whole site

### Subscribe

[![Atom](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/rss-32px.png)](https://www.schneier.com/feed/atom/)[![Facebook](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/facebook-32px.png)](https://www.facebook.com/bruce.schneier)[![Twitter](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/twitter-32px.png)](https://twitter.com/schneierblog)[![Email](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/email-32px.png)](https://www.schneier.com/crypto-gram)

[Home](https://www.schneier.com)[Blog](https://www.schneier.com/blog/archives/)

## The Strange Story of Dual\_EC\_DRBG

Random numbers are critical for cryptography: for encryption keys, random authentication challenges, initialization vectors, nonces, key-agreement schemes, generating prime numbers and so on. Break the random-number generator, and most of the time you break the entire security system. Which is why you should worry about a new random-number standard that includes an algorithm that is slow, badly designed and just might contain a backdoor for the National Security Agency.

Generating random numbers isn’t easy, and researchers have discovered lots of [problems and attacks](http://www.cs.virginia.edu/~rjg7v/annotated.html) over the years. A recent [paper](http://eprint.iacr.org/2007/419) found a flaw in the Windows 2000 random-number generator. Another [paper](http://eprint.iacr.org/2006/086.pdf) found flaws in the Linux random-number generator. Back in 1996, an early version of SSL was [broken](http://www.ddj.com/windows/184409807) because of flaws in its random-number generator. With John Kelsey and Niels Ferguson in 1999, I co-authored [Yarrow](http://www.schneier.com/yarrow.html), a random-number generator based on [our own cryptanalysis work](http://www.schneier.com/paper-prngs.html). I improved this design four years later—and renamed it Fortuna—in the book [Practical Cryptography](http://www.schneier.com/pc.html), which I co-authored with Ferguson.

The U.S. government released a new official standard for random-number generators this year, and it will likely be followed by software and hardware developers around the world. Called [NIST Special Publication 800-90](http://csrc.nist.gov/publications/nistpubs/800-90/SP800-90revised_March2007.pdf) (.pdf), the 130-page document contains four different approved techniques, called DRBGs, or “Deterministic Random Bit Generators.” All four are based on existing cryptographic primitives. One is based on hash functions, one on [HMAC](http://en.wikipedia.org/wiki/HMAC%20), one on block ciphers and one on elliptic curves. It’s smart cryptographic design to use only a few well-trusted cryptographic primitives, so building a random-number generator out of existing parts is a good thing.

But one of those generators—the one based on elliptic curves—is not like the others. Called Dual\_EC\_DRBG, not only is it a mouthful to say, it’s also three orders of magnitude slower than its peers. It’s in the standard only because it’s been championed by the NSA, which first proposed it years ago in a related standardization project at the American National Standards Institute.

The NSA has always been intimately involved in U.S. cryptography standards—it is, after all, expert in making and breaking secret codes. So the agency’s participation in the NIST (the U.S. Commerce Department’s National Institute of Standards and Technology) standard is not sinister in itself. It’s only when you look under the hood at the NSA’s contribution that questions arise.

Problems with Dual\_EC\_DRBG [were](http://eprint.iacr.org/2006/190) first [described](http://eprint.iacr.org/2007/048) in early 2006. The math is complicated, but the general point is that the random numbers it produces have a small bias. The problem isn’t large enough to make the algorithm unusable—and Appendix E of the NIST standard describes an optional work-around to avoid the issue—but it’s cause for concern. Cryptographers are a conservative bunch: We don’t like to use algorithms that have even a whiff of a problem.

But today there’s an even bigger stink brewing around Dual\_EC\_DRBG. In an [informal presentation](http://rump2007.cr.yp.to/15-shumow.pdf) (.pdf) at the CRYPTO 2007 conference in August, Dan Shumow and Niels Ferguson showed that the algorithm contains a weakness that can only be described as a backdoor.

This is how it works: There are a bunch of constants—fixed numbers—in the standard used to define the algorithm’s elliptic curve. These constants are listed in Appendix A of the NIST publication, but nowhere is it explained where they came from.

What Shumow and Ferguson showed is that these numbers have a relationship with a second, secret set of numbers that can act as a kind of skeleton key. If you know the secret numbers, you can predict the output of the random-number generator after collecting just 32 bytes of its output. To put that in real terms, you only need to monitor one [TLS](http://en.wikipedia.org/wiki/Secure_Sockets_Layer%20) internet encryption connection in order to crack the security of that protocol. If you know the secret numbers, you can completely break any instantiation of Dual\_EC\_DRBG.

The researchers don’t know what the secret numbers are. But because of the way the algorithm works, the person who produced the constants might know; he had the mathematical opportunity to produce the constants and the secret numbers in tandem.

Of course, we have no way of knowing whether the NSA knows the secret numbers that break Dual\_EC-DRBG. We have no way of knowing whether an NSA employee working on his own came up with the constants—and has the secret numbers. We don’t know if someone from NIST, or someone in the ANSI working group, has them. Maybe nobody does.

We don’t know where the constants came from in the first place. We only know that whoever came up with them could have the key to this backdoor. And we know there’s no way for NIST—or anyone else—to prove otherwise.

This is scary stuff indeed.

Even if no one knows the secret numbers, the fact that the backdoor is present makes Dual\_EC\_DRBG very fragile. If someone were to solve just one instance of the algorithm’s elliptic-curve problem, he would effectively have the keys to the kingdom. He could then use it for whatever nefarious purpose he wanted. Or he could publish his result, and render every implementation of the random-number generator completely insecure.

It’s possible to implement Dual\_EC\_DRBG in such a way as to protect it against this backdoor, by generating new constants with another secure random-number generator and then publishing the seed. This method is even in the NIST document, in Appendix A. But the procedure is optional, and my guess is that most implementations of the Dual\_EC\_DRBG won’t bother.

If this story leaves you confused, join the club. I don’t understand why the NSA was so insistent about including Dual\_EC\_DRBG in the standard. It makes no sense as a trap door: It’s public, and rather obvious. It makes no sense from an engineering perspective: It’s too slow for anyone to willingly use it. And it makes no sense from a backwards-compatibility perspective: Swapping one random-number generator for another is easy.

My recommendation, if you’re in need of a random-number generator, is not to use Dual\_EC\_DRBG under any circumstances. If you have to use something in SP 800-90, use CTR\_DRBG or Hash\_DRBG.

In the meantime, both NIST and the NSA have some explaining to do.

This essay [originally appeared](http://www.wired.com/politics/security/commentary/securitymatters/2007/11/securitymatters_1115) on Wired.com.

Tags: [academic papers](https://www.schneier.com/tag/academic-papers/), [backdoors](https://www.schneier.com/tag/backdoors/), [books](https://www.schneier.com/tag/books/), [cryptography](https://www.schneier.com/tag/cryptography/), [essays](https://www.schneier.com/tag/essays/), [Linux](https://www.schneier.com/tag/linux/), [NIST](https://www.schneier.com/tag/nist/), [NSA](https://www.schneier.com/tag/nsa/), [operating systems](https://www.schneier.com/tag/operating-systems/), [Practical Cryptography](https://www.schneier.com/tag/practical-cryptography/), [random numbers](https://www.schneier.com/tag/random-numbers/), [vulnerabilities](https://www.schneier.com/tag/vulnerabilities/), [Windows](https://www.schneier.com/tag/windows/)

[Posted on November 15, 2007 at 6:08 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html) •
[75 Comments](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html#comments)

### Comments

Lolita stays anonymous •
[November 15, 2007 7:19 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74895)

I think you nailed the why. It is not any of the people you listed who pushed for this algorithm with a back door, it is the ones you didn’t mention.

The only sane explanation is some official / person in power who kept on pushing for this, regardless of what the techies said.

n00b •
[November 15, 2007 7:21 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74896)

Maybe they are counting on the fact, that most of the programmers don’t have crypto background and will just get the algorithm, test cases and go on implementing it.

Other idea might be to later mandate it’s use in some circumstances and have sort of key recovery mechanism without messy escrow or master keystore.

Matt •
[November 15, 2007 7:29 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74897)

I think perhaps you don’t give them enough credit. Have you considered the idea that Dual\_EC\_DRBG is a red herring, and the real threat remains hidden in one of the other algorithms?

Nostromo •
[November 15, 2007 7:44 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74898)

I don’t understand why anyone thinks it is a good idea to use crypto standards defined by the NSA. Of course they have a lot of experience in the field, and it is very valuable to have them review a proposed standard and point out its weaknesses. But they have an obvious interest in promoting the use of crypto that they can break. In the perpetual conflict between the government’s desire to control and the people’s desire to be free, they are simply on the wrong side.

[Steve Laniel](http://laniels.org/) •
[November 15, 2007 7:52 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74899)

Bruce writes: “If you have to use something in SP 800-90 …”.

This suggests that cryptographers shouldn’t use something in SP 800-90. I’m not a cryptographer, so I ask: what should we be using as our PRNG?

NotAllHomers •
[November 15, 2007 8:06 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74900)

Elliptic curves is the big clue here.

Pythagoras is well understood by the NSA. They will always try to put a “back door” into public encryption schemes. The flaw in DES is a classic case in point for those in the know so these “new” revaluations are not so new after all. The random number generator problem has been a favorite means to break a secure key for ages. Using the pit controller and reprogramming it to saturation on most home pc motherboards provides a good solution to the problem!

Karellen •
[November 15, 2007 8:33 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74901)

NotAllHomers > Huh? You say that the NSA will always try to put back doors in encryption schemes, and then bring up the DES flaw that the NSA fixed?!?

I do take it you’re talking about changes they made to the S-box constants in 1978 before DES was finalised, making it more secure against differential cryptanalysis. Differential cryptanalysis which the NSA invented in 1974 and wasn’t figured out by anyone else ’til 1990?[0]

So make your mind up – are the NSA always trying to make algorithms more secure, or less?

[0] <http://en.wikipedia.org/wiki/Data_Encryption_Standard#NSA.27s_involvement_in_the_design>

[Joe Patterson](http://www.terremark.com/) •
[November 15, 2007 8:50 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74902)

@Steve Laniel:

Fortuna, of course!

Nicholas Weaver •
[November 15, 2007 9:05 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74903)

I think it may be a “all your eggs in one basket” thing, that Dual\_EC\_DRBG proves to be computationally equivelent to the elliptic curve problem for public keys, so if there is an algorithmic breakthrough whith bones the pRNG, it also bones the public key operations as well. So if you have to do crisis management, it doesn’t make the problem any worse.

And because its something they have probably used for a LONG time, they want to make sure that all the old systems still apply to the “standard”, rather than having to replace them.

Matt •
[November 15, 2007 9:05 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74904)

Re: Karellen

They only fixed it because it was widely known. Wheels within wheels man, take the red pill and follow the rabbit hole.

John •
[November 15, 2007 9:12 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74905)

Oops. RNGs have more uses than cryptography. In my time (long ago) linearly congruential generators were in common use. They were no good for cryptography, but quite good for statistical purposes. They also had the advantage of generating pseudo-random sequences that could be reproduced (a big point).

But, in those days there was also a dearth of literature on non-linear generators (like nothing, a deafening silence), and some of my math friends suspected NSA influence.

So, the latest NIST standard may prove excellent for general use, but remain suspect for crypto.

That is nothing new.

Crypto is a specialized field. I believe that to be used effectively in the private sphere, we would need Corporate Security Agencies (CSAs) analogous to the NSA for the Government. I have yet to see that happen.

Nyhm •
[November 15, 2007 9:15 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74906)

This is not directly related to RNG, but some other references regarding the U.S. gov’t involvement in algorithm design from Bruce:

Regarding prime number choices for DH and DSA standardization: Practical Cryptography (Ferguson,Schneier) Ch 12.9, pp.220-222: “Other parts of that same U.S. government (e.g., NSA, CIA, FBI) have a vested interest in being able to break into private communications.”

Somewhere (could not find the reference), Bruce stated that the U.S. gov’t (NIST,NSA) would logically have stronger interest in providing strong *digital signature* functions (vs. strong encryption), which would imply producing good hash algorithms. (*Please double-check this, as I have no reference.*)

[Dave Walker](http://blogs.sun.com/davew/) •
[November 15, 2007 9:32 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74907)

It’s interesting to compare and contrast this case, to the famous case of the NSA requesting the contents of the S-boxes be changed in the prototype which eventually became DES. The fame, here, came when differential cryptananalysis was discovered in the non-NSA world, and the prototype was found to be particularly vulnerable whereas production DES was rather less so.

Yesterday, the NSA was making crypto stronger, without us knowing about it. Now, they might be introducing back doors.

How times change.

Andrew •
[November 15, 2007 9:45 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74908)

What about true hardware random number generators? They are becoming more common on various processors these days. The TI Omap series of ARM processors have them, as do the Cavium (and other) network processors. Given that some of these processors sell for only a few $, how hard can it really be for the big guys to add them to, say, an x86?

greg •
[November 15, 2007 9:55 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74909)

I thought that any algo with constants should use a public method to generate them or move them out of control of the designer. (aka n digits of pi or e).

But more impressive is that insisting on published algorithm’s is working. A hats of to the code breakers…NSA can’t be that far head of the published literature any more.

Clive Robinson •
[November 15, 2007 10:11 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74910)

As Bruce says’

“Generating random numbers isn’t easy”

“Problems with Dual\_EC\_DRBG were first described in early 2006. The math is complicated, but the general point is that the random numbers it produces have a small bias.”

Even non determanistic or True RNGs based on such things as radioactive decay have bias, that can be sufficiently predictable to weaken a system where it has not been taken into acount.

Likewise Noise Resistors and diodes can be subject to external signals which would add bias to their output.

And even interferance on the power cables in a building can have an effect on the output of any poorly designed physical RNG.

Oh and all physical sources of randomness usually produce very little in the way of random bits in any given time frame.

The usual suggestion for getting rid of bias and upping the bit rate is hashing a pool of entropy… Which unsurprisingly (due to complexity of the problem) has little real reasearch behind it, it just “feels right”.

Hashing has it’s own problem, if your source of randomness goes wrong and becomes predictable after it has been hashed it will not be obvious to the casual or unskilled observer.

And an entropy pool likewise has problems if an attacker can get access to any input to it (say via hitting the hard disk controler with lots of file access requests) they can eventually poison it to their advantage.

So even when designing in a True Random Generator you need to be very carefull with what you use/buy.

Barney •
[November 15, 2007 10:15 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74911)

It’s not really a backdoor, it’s more a flaw.

The recommendation to use other generators is, of course, relative.

If you really have to save the extra hour (in NSA time) it takes to break, then you just infiltrate the process.

UNTER •
[November 15, 2007 10:24 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74912)

Bruce,

This sounds like the old Heisenberg ploy. Someone at the NSA got orders from folks higher up to make a back-door PRNG. The mathematician thought this was absolutely imbecilic, useless, and dangerous, but he was under orders.

So he does what Heisenberg did with A-bomb work in Germany – he does the job poorly and slowly. “Yup, I’ve got it!” So it’s slow – that would dissuade good engineers who don’t have the maths to see it. It’s obvious – that dissuades the mathematicians who don’t care about efficiency.

The only people screwed are those who don’t think about the problem at all, much like the manager who demanded the back door. Probably a Bush political hack, I bet.

sooth\_sayer •
[November 15, 2007 10:50 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74913)

There might be a simpler and more human explanation.

The person in-charge or his/her protege did the work the DRBG’s .. sometimes such motivations drive people. Who hasn’t heard of Edison frying someone with AC to push DC.

I don’t understand why the source of constants has to be explained if the algorithm to generate them is provided.

The back-door scenario will be troublesome if it were proven for any set constants. That would be even a bigger back door than the one implied in the article.

FP •
[November 15, 2007 10:54 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74914)

@Andrew: “true hardware random number generators”

Most true random number generators are too slow for cryptography or other real-world applications.

When many random numbers are needed, and a true random number generator is available, it is usually only used to seed a pseudo-random number generators.

A good PRNG, when seeded with random input, produces “infinite” amounts of pseudo-numbers that are indistinguishable from “truly random” numbers.

anurag •
[November 15, 2007 11:28 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74915)

it seems more likely, given that the impl is slow, that there are problems with the other approaches that NSA is aware of, and they want something in the standard that is still viable that they can advise people to use. Ditto for choice of Q.

Its hard to see how they benefit from forcing a slow, complex, broken mechanism into the standard. A slow, complex, only known safe mechanism, I would understand.

That said, the fact that everyone else is placed in a position of just having to trust is certainly problematic.

Clive Robinson •
[November 15, 2007 11:30 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74916)

@FP,

“A good PRNG, when seeded with random input, produces “infinite” amounts of pseudo-numbers that are indistinguishable from “truly random” numbers.”

If only that where true…

It’s not, a very simple thought experiment disproves it. “Infinite” includes all numbers therefore their length is also infinite, a PRNG is limited to the size of numbers it produces by the size of it’s internal state (in bits).

Also You have the problem of how often you re-seed the PRNG. It depends on the unisity distance of the one way function of the PRNG. A bad example using DES then you would have to re-seed about every two block outputs to be theoreticaly secure…

ace •
[November 15, 2007 11:45 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74917)

Looking in 800-90: there are P-256, P-384 and P-521. Are they all broken? It sounds so? Then it’s more than unlucky coincidence.

aze •
[November 15, 2007 11:48 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74918)

I have a better theory. There’s only one reasonable reason to have a slower algorithm. That’s because it’s stronger than all the others. NSA knows secret weakness(es) in all other commercial crypto systems. So; the NSA have published this because they want to have decent commercial crypto available off the shelf for their own use. (I know this doesn’t sound very paranoid.. please just wait :-). All they have to insist on is full implementation of the standard and they get their own RNG which is actually secure.

Whatever weakness the other systems have that this doesn’t have, is dependent on the keying of the special constants. If you choose randomly you get a weak system. If you choose according to some rule that only they know you get a strong system. If you take the constants they give, you get a strong system with a backdoor.

This would also match with the way that Russian crypto systems are much slower and more conservative than most western ones. Maybe they know something about NSA crypto that we don’t know.

(now I get to find out why you should know more about crypto before commenting on Bruces blog.)

David (Toronto) •
[November 15, 2007 11:51 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74919)

Deja-DES-vu indeed.

Magic numbers, it even sounds like the S-box controversy all over again.

@Karellen & Dave Walker – Yes the NSA made the DES S-boxes stronger. However, somewhere along the line the key length got halved. DESCHAL and EFF wouldn’t have broken 112 bit DES in – my god that was 10 years ago. Nor today for that matter.

Maybe they are weakening it, maybe not. If they are and the parrallel holds, the magic numbers are a red-herring. So, what are we missing?

Having a fallback method is an interesting idea, but unless it’s just in case – the implications may be a bit of a worry.

Anonymous •
[November 15, 2007 12:00 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74920)

@ Clive Robinson

“‘Infinite’ includes all numbers therefore their length is also infinite, […]”

Wouldn’t that only be true if I were attempting to create an infinitely long series of UNIQUE numbers? If I allow for any given number to be used an indefinite number of times, shouldn’t I be able to create an infinite series of numbers that doesn’t include all numbers?

Greg Alexander •
[November 15, 2007 12:15 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74921)

Dear Mr. Schneier,

Why did you cite the Gutterman/Pinkas/Reinman paper? It picks nits and it only suggests three exploits:

\* if you have access to kernel memory on a stopped system, you can determine the previous random number generated. Newsflash: if you have access to kernel memory on a stopped system, you already won. Did you know that if you strace the program reading from /dev/urandom, you can see what numbers it is currently reading? Wow!

\* if you know the root password then you know certain attributes of the user’s first interaction with the computer which may help you predict entropy pool contents. In actuality, if you know the root password you already won. Even if you hadn’t, vaguaries in the way that it is typed (time of boot, time of login, speed of typing, typos, etc.) provide enough entropy to make this attack infeasible. As they note in the paper!!

\* if you know the complete set of network events going into a WRT router, you know its entropy pool. Since WRTs almost never contain private keys (and if they do, knowing the state of LRNG is of limited utility), you may as well replace the WRT with your own device if you have this kind of complete hardware access to the network. Further, at worst this is a weakness in a special case application of the LRNG rather than a general weakness in the LRNG.

It rounds out with a bunch of gnashing of teeth about documentation and open source development ideology, and a neither-here-nor-there whinge about a denial of service attack.

Frankly, if The Bruce Schneier is going to say that the LRNG is “flawed”, I’d hope you’d cite something a little bit less retarded. Or does your authority mean so little to you?

Savik •
[November 15, 2007 12:23 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74922)

The NSA is after all a government agency with a mission to protect national assets — meaning it helps business and individuals protect their assets. How? By providing secure encryption algorithms and best practices for securing systems, etc.

Just because they have the capability to perform nefarious activities does not mean that they do. And really — where is the evidence that they have?

Why so quick to jump to conspiracies all of the time?

Bryan Feir •
[November 15, 2007 12:27 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74923)

@ David (Also in Toronto):

The explanation I heard for NSA and their handling of the DES keys (which was more along the lines of ‘this is the only thing that really makes sense’, since the NSA is understandably unwilling to provide official answers):

Remember that part of the push for DES was a standard encryption system to be used by even the American government. (For Classified documents, at least; Secret and up were to use other methods.) So the NSA wouldn’t want it to be too easily broken.

Also emember that NSA has a large, classified budget. They have long been one of the biggest investors in supercomputer technology, and almost certainly had and still have access to a lot of high-end computing resources.

So basically, with DES they wanted a system that had no weaknesses that the Russians could exploit to crack it… but which was had a short enough key that the NSA could brute-force it themselves in a reasonable length of time.

DES was never supposed to be the be-all and end-all of encryption; even when it was first adopted, it was given a ‘shelf life’ of how long it would be considered useful before something stronger was needed.

There are all sorts of interesting bits about DES that tell you what its designers were thinking. Such as the initial permutation which shuffles the bits around and then shuffles them back. This has absolutely no effect on the actual cryptographic strength of the algorithm, and doesn’t affect hardware implementations at all… but it slows down purely software implementations.

Greg Alexander •
[November 15, 2007 12:28 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74924)

More details…. The previous post was about the “Analysis of the Linux Random Number Generator.” I decided to read “Cryptanalysis of the Random Number Generator of the Windows Operating System” from Dorrendorf/Gutterman/Pinkas, for contrast. I find it odd that the flaws in the Windows generator are described as “a flaw” while the FUD about the Linux generator is described as “flaws”. Let me compare and contrast:

* Entropy:
  + Linux: maybe predictable, if the moon lines up just right and you squint
  + Windows: only used every 128kB, not used for seed, and therefore mostly irrelevant
* forward-security attack:
  + Linux: possible to go back one value if there is no intervening entropy and if you have full access to kernel, O(2^64) or harder
  + Windows: possible to go back up to 128kB values with just access to user memory, O(2^23)
* backward-security attack:
  + Linux: O(1) iff there are *no* entropy events occurring whatsoever
  + Windows: O(1) for 128kB no matter what

The vulnerabilities are not even in the same realm. The Windows vulnerabilities are the sort of things that can and will be exploited in The Real World we all Know And Love. The Linux vulnerabilities are grasping at straws.

Bruce, whyfor behavest thou so disrespectfully towards facts?

Karellen •
[November 15, 2007 12:39 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74925)

David (Toronto) > The NSA did not halve the DES key length, it was originally 64 bits before they reduced it to 56 bits.

Anonymous •
[November 15, 2007 1:40 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74926)

anyone thought of the NSA inisisting on this rather obvious flaw to be included in the standard to divert attention from the other more subtle ones???? call me an unbeliever but not trusting agencies like the NSA has proved to be good practice throughout history 🙂

Anonymous •
[November 15, 2007 2:12 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74927)

Good to read your website/blog Bruce, critical issues.

Previous posters, some need to read about DES…

Dual\_EC\_DRBG: DES S box history seems a good starting point, see BS’s book, Applied Cryptography. Some ideas I’m pondering:

With Trusted Computing and DRM coming around, privacy rethink, Donald Kerr recent news, I’m glad the NSA puts up the target ballon of Dual\_EC\_DRBG. Mainstream needs crypto issues put up, to keep people honest. What happened with S boxes and those in the know, beyond reported in Applied Cryptography? Idea is, how proactive is the NSA to keep crypto from being a used as a hostile measure?

Trap doors and time to break seem critical design issues, unique keys in each hardware, with other crypto magic?

The NSA must be getting VERY good at crypto today, although others outside are too. Dual\_EC seems to have a good bad and ugly nature. Hopefully, the movie ends right, ahhhhhhhhh!

Jeremy •
[November 15, 2007 2:13 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74928)

@Anonymous

“If I allow for any given number to be used an indefinite number of times, shouldn’t I be able to create an infinite series of numbers that doesn’t include all numbers?”

Yes.

However, pseudo-random algorithms still can’t do this, because their internal state has finite size (required to run on a computer with finite memory). This means that, after some finite number of outputs, the generator has to enter a state that it’s been in before. At that point, the generator has entered a loop (though possibly a very long one). All outputs after that point are cyclic, and can be predicted knowing only the previous outputs and the cycle length.

Anonymous •
[November 15, 2007 3:04 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74929)

Andrew: “how hard can it really be for the big guys to add them to, say, an x86?”

They’ve been in VIA processors, and Intel/AMD chipsets, since the Socket 370/Socket A days.

RC •
[November 15, 2007 3:45 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74930)

The main problem with this deliberate vulnerability is that it proves the NSA is willing to act in this manner, casting doubt on all the other standards in which they have been substantially involved.

David (Toronto) •
[November 15, 2007 4:13 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74931)

@Karellen – I believe you are mistaken.

1. Wikipedia mentions both a 64 and 128 version of Lucifer predating DES, but is unclear which went forward.
2. Biryukov is clearer (in “Block Ciphers and Stream Ciphers: The State of the Art”) … “The structure of Lucifer was significantly altered and since the design rationale was never made public and the secret key size also went down from 128-bit to 56-bits this resulted in controversy, and distrust among the public.”

[Paul Wayper](http://mabula.net) •
[November 15, 2007 5:31 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74932)

Even if this is an obvious backdoor, there’s one way I can think of that they can still get to easily exploit it.

If all US Government servers were set up so that they used the Dual\_EC\_DRBG method, then no matter what random bit generation method you use the NSA already knows something about your encrypted data. Maybe this only allows them to decrypt the server’s side of the conversation. Maybe they can only break the encryption easily if both sides are using Dual\_EC\_DRBG. But forcing the hand of one party is a good start. And if you can get two Government machines to talk to eachother, you have a guaranteed ability to break their encryption.

So regardless of whether it’s slower, uglier and smells of fish, it may still give the powers that be a chance to listen in. Once it’s in the standard it’ll be very hard to shift.

Filias Cupio •
[November 15, 2007 7:31 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74933)

You could run two of the PRNG algorithms and XOR their output. In this case, someone would need to break both algorithms to break your PRNG.

Is this a sensible strategy? Would you get more cryptographic value for your cpu cycles/memory by using just one algorithm but with more rounds and/or longer keys?

Paran0id •
[November 15, 2007 8:01 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74934)

“My recommendation, if you’re in need of a random-number generator, is not to use Dual\_EC\_DRBG under any circumstances. If you have to use something in SP 800-90, use CTR\_DRBG or Hash\_DRBG.”

Oh Bruce!

You risk antagonising the Power.

Watch out for Black Helicopters.

David Thomas •
[November 15, 2007 10:25 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74935)

@Greg Alexander

… aren’t we sensitive! Bruce didn’t say the LRNG “is flawed,” he said that the paper “found flaws.” This is true – as much as they are not of practical concern, they are flaws. Appropriate discrimination between the Windows 2000 RNG and the Linux RNG was not the point of the article. What was Bruce’s recommendation? “Don’t use the LRNG”? No, it was “Don’t use Dual\_EC\_DRBG,” as it gives every indication of deliberate sabotage. Were the paper a survey of RNGs more generally, more details would be required. The point was how easy it is for RNGs to stray from ideal when you’re *trying* to make ’em work right, and that, in this case, they may not have been trying.

[Matthew Skala](http://ansuz.sooke.bc.ca/bonobo-conspiracy/) •
[November 15, 2007 11:00 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74936)

Filias Cupio: I think my PRNG is pretty good, but I want extra security, so I’ll XOR it with the output twice.

I agree with RC: regardless of why the NSA would suggest this PRNG with an obvious problem, the fact that they’re willing to do so is itself an important piece of information.

As for what their inscrutable reasons might be, I’m reminded of a comment about the old Soviet GOST block cipher, which I think I read in Bruce’s AC2: the cipher had selectable S-boxes, and it was speculated that the people in charge of crypto would give secure S-boxes to the people they wanted to have secure S-boxes, and insecure S-boxes to the people they wanted to have insecure S-boxes. I could see something like that coming into play here. If everyone implements the standard and the standard includes an insecure option among the secure ones, then someone who knows about that and wants to control whether a party’s communications are secure or not, just has to influence the party to choose the right option. The benefits of standardization, and of people you want to be secure and people you don’t want to be secure using the same software and probably not noticing that they’re using different settings for it, are huge.

Anonymous •
[November 16, 2007 1:20 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74937)

“The main problem with this deliberate vulnerability is that it proves the NSA is willing to act in this manner, casting doubt on all the other standards in which they have been substantially involved.” RC

Good point. So why do they push ECC so much? They have provided the curves more or less. Maybe like other curves the recommended curves will map to a group that the normal Index calculus can be used. Now the security of ECC is no better than other DL based PK methods. Problem is you use ECC because we think its safe to assume that the sub exponential Index methods don’t apply.

greg •
[November 16, 2007 1:21 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74938)

Sorry

Anonymous at November 16, 2007 01:20 AM

is me

[Q](http://picasaweb.google.com/freemovequantumexchange) •
[November 16, 2007 5:44 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74939)

All artithmetic generated random numbers suffer from this problem. If you maintain a list of all known used arithmetic random generators, then with an algoritm like C4.5 (search for “C4.5” with Google) you can easily discriminate which arthimetic random generation algorithm is used to produce the random numbers and therefore easily break the used computational secure algorithm.

The Information-Theoretic provable secure low-cost PC-based FreeMove Quantum Exchange Proof-of-Concept System therefore uses true Quantum Randomness instead of pseudo arithmetic randomness. By the way: This was already predicted in 1951 by John von Neumann.

More Information on this Research Proof-of-Concept can be found on the URL <http://picasaweb.google.com/freemovequantumexchange>

Clive Robinson •
[November 16, 2007 6:00 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74940)

@Matthew Skala,

“people in charge of crypto would give secure S-boxes to the people they wanted to have secure S-boxes, and insecure S-boxes to the people they wanted to have insecure S-boxes.”

Actualy there is a history of this happening. During WWII the U.S. issued a small field machine cipher based on a coin counting mechanism. It is now known that something aproaching 80% of the keys where relativly insecure. The argument given at the time was that if it was captured and copied the chances are that the adversery would not know about the relative security of the keys, and would in all probability end up predominantly using the relativly insecure keys. Likewise the possability of weakness in other Crypto AG ciphers suposedly put in by the NSA has been debated on numerous occasions.

It has been surmised that the NSA did not know about either Differential or Linear cryptanalysis at the time IBM made their original submission for DES.

It is known that the designers of DES actually discovered the weaknesses in the S-Boxes after developing their own “new” attack (T or tickle) which was later re-discovered by people playing around with early versions of FEAL. The level of involvment of the NSA in actually strengthaning the S-Boxs has never been released and is still something of a controversy (see Don Coppersmiths and others comments on the “T-Attack”). It has been further suggested that the NSA had no input other than to tell the IBM design team to keep their mouths shut for the sake of National Security.

Oddly the NSA assumed that DES would only be put in hardware and that they could control the technology supply to banks and the like. It has been said that it was one of their biggest (publicaly known) mistakes, it realy was responsible for kick starting the computer security industry and Universities delving into Crypto research

Later as we know the NSA tried to push a DES replacment which they tried to keep the internals of secret (Skipjack / CapStone / clipper) it was soundly rejected by just about everybody. In June 1998 they declasified the Skipjack algorithm and interestingly although it is secure in the implimentation the NSA released it is very brittle in that even very minor changes to the algorithm can weaken it greatly.

[Inglorion](http://inglorion.net/) •
[November 16, 2007 6:45 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74941)

While on the subject of PRNGs, I’d like to point people at my

deadbeef random number generator (<http://inglorion.net/software/deadbeef_rand/>).

While I made it as a kind of joke, I have the feeling that it

can be useful in practice, as it’s simple and seems to

perform fairly well. I don’t have the background to perform

a good analysis of it, but maybe someone here can help with that.

John •
[November 16, 2007 8:18 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74942)

There were a couple of comments on DES peculiarities that I want to add to.

1. The Initial Permutation. The DES designers never explained its purpose. It was widely believed that its purpose was to make software implementations costly, and thus prefer hardware.

However, somebody (I forgot his name, sorry – David Hoye?) came up with a clever scheme of boolean operations that achieved the IP quickly and cheaply.

1. Why the NSA preference for hardware?

My guess is purely legal. The Arms Import and Export Act began in 1954 with a different name, the Military something Act. At that time, effective crypto meant hardware. The ITAR, which implemented the law, listed crypto hardware (legally “devices”). Nobody thought of software.

Now, a law to be enforceable has to be fairly specific. If crypto is equipment, it could be argued that software isn’t equipment and thus is exportable without permission. It was a gap in the law.

Sometime in the early 80s somebody recognized the same gap I did, and software crypto was added to ITAR. Further, the Munitions Control Board extended the definition of cryptographic devices and software to include cryptanalytic devices and software in one of its bulletins.

But at the time of DES, NSA’s General Counsel feared that its legal authority did not extend to software implementations. At least, that is my surmise. Thus, the insistence on hardware.

TC •
[November 16, 2007 8:38 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74943)

I blame Elaine Roberts!

Rick •
[November 17, 2007 7:28 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74944)

Is this sort of bias something that the NSA might

expect the research community to detect? Or,

looking at it another way, was this a “test” to

see if the non-NSA community would detect

a backdoor?

Kerub •
[November 18, 2007 4:01 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74945)

why do not they let people put numbers ad random, in it…

IN\_the\_Surf •
[November 18, 2007 7:19 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74946)

Bruce,

For as much as you lament the current administration’s “fear tactics,” you sure do a great job yourself when it appears to benefit a point that *you* are making.

“…we have no way of knowing whether the NSA knows the secret numbers that break Dual\_EC-DRBG. We have no way of knowing whether an NSA employee working on his own came up with the constants—and has the secret numbers. We don’t know if someone from NIST, or someone in the ANSI working group, has them. Maybe nobody does.”

Bruce, the absence of proof is not proof of wrongdoing in this case. You are however presenting this lack of knowledge as if it were proof that wrongdoing is occurring.

I have no problem with you questioning the veracity or safety of such things; however, you should try and give some evidence to support your claims as well as be “open” enough to allow for others to do such things as well. You have a tendency to think that your questions, opinions, and worries are the rational ones. You are, by far, not the only “authority” on security topics.

Rangan •
[November 19, 2007 6:20 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74947)

Bruce

Why should we worry about contraversial PRNG – Dual\_EC\_DRNG?

We should think in a new line. Like, computing DRNG from Pi infinite series that will give a good entropy.

Rangan •
[November 19, 2007 6:32 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74948)

Bruce

Sometimes, DRNGs won’t be useful other than crypto applications. We should design DRNGs should be useful for multiple applications such as Information Security, Image processing, Digital Signal processing.

I don’t know CTR\_DRNG / Hash\_DRNG that will be useful for multiple applications. Give me some DRNGs that we can use for many things.

Brian •
[November 19, 2007 8:40 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74949)

Being completely ignorant of the math involved with ECs and PRNGs, has anyone tried factoring the constants from Appendix A of the NIST publication? Would that help in determining the secret numbers?

otho •
[November 19, 2007 2:31 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74950)

Very important news !

Even in Poland:)

<http://www.idg.pl/news/131422.html>

\_Anonymous •
[November 21, 2007 5:36 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74951)

One can only hope that Quad\_EC\_TFHA might be declassified someday in order to put an end to this conspiracy.

(TFHA = Tin Foil Hat Algorithm)

Stromseal •
[December 1, 2007 11:10 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74955)

The spooks already have the backdoor, frontdoor, sidedoor and the basement key. Oh, and there’s the secret trapdoor that they have told you about too.

Mike •
[July 31, 2008 3:30 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74980)

IN\_the\_Surf:

> You are however presenting this lack of knowledge as if it were proof that wrongdoing is occurring.

I don’t at all see how Bruce is saying that. He even writes: “We don’t know if someone from NIST, or someone in the ANSI working group, has them. *Maybe nobody does*“. He is highlighting a valid concern, but asking for more proof simply highlights that you don’t understand this problem at all. There cannot be any proof given about this, neither that this is not the case, so Bruce is asking to be cautious, and since there are other and better alternatives, it is a no-brainer to use them instead.

That you have to point out that Bruce is not the only authority on security topics (although I fail to see why it is relevant to mention that) tells me that this is more of a personal problem you have with Bruce, than anything else.

HUCK •
[September 17, 2008 1:43 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74981)

Has anyone from ANSI / NSA / etc. commented on this potential backdoor since this article was posted?

Thanks for keeping encryption sane for us all, Bruce.

[brain](http://-) •
[February 28, 2010 9:07 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74982)

please explain more on tickling attack

Dennis •
[July 6, 2013 8:45 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74983)

Intel includes a hardware random number generator starting with the Ivy Bridge chip. It produces 800 megabytes/second, using the hardware randomness as input to a cryptographic function. Google brings up plenty of articles, [such as this](http://electronicdesign.com/learning-resources/understanding-intels-ivy-bridge-random-number-generator).

Doc •
[July 6, 2013 5:30 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74984)

What if ephemeral DH elliptic curve keys are always generated by this generator? (as in TLS’ ECDHE\_RSA standard) Wouldn’t perfect-forward secrecy be a total sham?

<http://blogs.computerworld.com/encryption/22366/can-nsa-see-through-encrypted-web-pages-maybe-so>

<http://nmav.gnutls.org/2011/12/price-to-pay-for-perfect-forward.html>

Kernel Kurtz •
[July 6, 2013 7:22 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74985)

Who developed the constants? I’d start looking at car wrecks around that time. They lo-o-o-o-v-e car wrecks.

sapien\_red •
[July 7, 2013 11:01 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74986)

i have a nagging doubt , i suspect a double bluff.

they what people far far away from ecc and any crypto implementation based on it.

give a bad example with obvious flaws to scare them off

“its a trap”

i will be looking into ECC with renewed interest because of this 😉

Clive Robinson •
[July 8, 2013 6:35 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74987)

@ Dennis,

 *Intel includes a hardware random number generator… It produces 800 megabytes/second, using the hardware randomness as input to a cryptographic function.*

I would be very very cautious about the Intel RNG system.

One major issue is you cannot test it reliably because of the crypto function.

As I’ve repeatedly said in the past crypto/hash functions do not add entropy to the output of the basic entropy generator, using such systems are the equivalent of “sprinkling magic pixie dust” thinking.

Further the basic entropy generator is very likely to be subject to significant bias and noise that is not actually unpredictable (think powersupply noise it is mainly dependent on the input source and load conditions all of which are either measurable or influanceable).

If you cannot get directly at the output of the basic entropy generator than you cannot check it, thus all bets are off as to if it’s actually giving you any entropy at all…

whir •
[September 5, 2013 4:11 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74988)

*In the meantime, both NIST and the NSA have some explaining to do.*

[You don’t say.](http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html?hp&pagewanted=all)

[Yan Zhu](http://web.mit.edu/zyan/www) •
[September 9, 2013 1:01 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74989)

By the way, the link to NIST Special Publication 800-90 no longer works. I’ve posted this document to <http://web.mit.edu/zyan/Public/SP800-90revised_March2007.pdf> for now.

Thank you for this post!

[Yan Zhu](http://web.mit.edu/zyan/www) •
[September 9, 2013 3:25 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74990)

In addition, the current draft of NIST SP 800-90 is now open for public review “in light of recent reports”: <http://csrc.nist.gov/publications/PubsDrafts.html#SP-800-90-A%20Rev.%201,%20B,%20and%20C>

mika •
[December 21, 2013 6:09 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74991)

I wish you live one hundred years more

And I wish you train/educate some people

Peace…

afshin •
[December 21, 2013 6:42 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74993)

You are realy a hero of cryptograph world!

<http://www.theverge.com/2013/12/20/5231006/nsa-paid-10-million-for-a-back-door-into-rsa-encryption-according-to>

G Hardy •
[March 20, 2014 2:05 PM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74994)

The backdoor was part of a larger program named “Bullrun” by the NSA, which apparently has been more successful than is safe to reveal.

Reporting by the New York Times: <http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html?pagewanted=all>

Hussam •
[January 21, 2015 2:44 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74995)

You are really awesome Schneier as stated above in the comments in fact it is a backdoor for the NSA!

Wael •
[January 22, 2015 12:36 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74996)

Dual\_EC\_DRBG = ***Epileptic Curve Crapography*** 🙂

Nick P •
[January 22, 2015 12:46 AM](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/#comment-74997)

You were right to worry. Good advice too. Yet, it makes perfect sense if they think they can pay major crypto providers a lot of money to use it. And then they have easy access to so many communications. What doesn’t make sense for technical reasons can sometimes make sense for operational reasons in tradecraft. Just like marketing winning over technical superiority in commercial sector.

[![Atom Feed](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/rss.png)
Subscribe to comments on this entry](https://www.schneier.com/blog/archives/2007/11/the_strange_sto.html/feed/)

## Leave a comment [Cancel reply](/blog/archives/2007/11/the_strange_sto.html#respond)

All comments are now being held for moderation. For details, see [this blog post](https://www.schneier.com/blog/archives/2024/06/new-blog-moderation-policy.html).

[Login](https://www.schneier.com/wp-login.php?redirect_to=https%3A%2F%2Fwww.schneier.com%2Fblog%2Farchives%2F2007%2F11%2Fthe_strange_sto.html "Login")

Name

Email

URL:

 Remember personal info?

Fill in the blank: the name of this blog is Schneier on \_\_\_\_\_\_\_\_\_\_\_ (required):

Comments:

![](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/loader.gif)

**Allowed HTML**
<a href="URL"> • <em> <cite> <i> • <strong> <b> • <sub> <sup> • <ul> <ol> <li> • <blockquote> <pre>
**Markdown Extra** syntax via <https://michelf.ca/projects/php-markdown/extra/>

Δ

[← Illuminated Site of the Week](https://www.schneier.com/blog/archives/2007/11/illuminated_sit.html) [Hushmail Turns Data Over to Government →](https://www.schneier.com/blog/archives/2007/11/hushmail_turns.html)

Sidebar photo of Bruce Schneier by Joe MacInnis.

[Powered by WordPress](https://wordpress.com/wp/?partner_domain=www.schneier.com&utm_source=Automattic&utm_medium=colophon&utm_campaign=Concierge%20Referral&utm_term=www.schneier.com) [Hosted by Pressable](https://pressable.com/?utm_source=Automattic&utm_medium=rpc&utm_campaign=Concierge%20Referral&utm_term=concierge)

### About Bruce Schneier

![](https://149400697.v2.pressablecdn.com/wp-content/uploads/2019/10/Bruce-Schneier.jpg)

I am a [public-interest technologist](https://public-interest-tech.com/), working at the intersection of security, technology, and people. I've been writing about security issues on my [blog](/) since 2004, and in my monthly [newsletter](/crypto-gram/) since 1998. I'm a fellow and lecturer at Harvard's [Kennedy School](https://www.hks.harvard.edu/faculty/bruce-schneier), a board member of [EFF](https://www.eff.org/), and the Chief of Security Architecture at [Inrupt, Inc.](https://inrupt.com/) This personal website expresses the opinions of none of those organizations.

### Related Entries

* [Friday Squid Blogging: Cotton-and-Squid-Bone Sponge](https://www.schneier.com/blog/archives/2025/01/friday-squid-blogging-cotton-and-squid-bone-sponge.html)
* [Zero-Day Vulnerability in Ivanti VPN](https://www.schneier.com/blog/archives/2025/01/zero-day-vulnerability-in-ivanti-vpn.html)
* [ShredOS](https://www.schneier.com/blog/archives/2025/01/shredos.html)
* [Spyware Maker NSO Group Found Liable for Hacking WhatsApp](https://www.schneier.com/blog/archives/2024/12/spyware-maker-nso-group-found-liable-for-hacking-whatsapp.html)
* [Hacking Digital License Plates](https://www.schneier.com/blog/archives/2024/12/hacking-digital-license-plates.html)
* [Friday Squid Blogging: Biology and Ecology of the Colossal Squid](https://www.schneier.com/blog/archives/2024/12/friday-squid-blogging-biology-and-ecology-of-the-colossal-squid.html)
### Featured Essays

* [The Value of Encryption](https://www.schneier.com/essays/archives/2016/04/the_value_of_encrypt.html)
* [Data Is a Toxic Asset, So Why Not Throw It Out?](https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html)
* [How the NSA Threatens National Security](https://www.schneier.com/essays/archives/2014/01/how_the_nsa_threaten.html)
* [Terrorists May Use Google Earth, But Fear Is No Reason to Ban It](https://www.schneier.com/essays/archives/2009/01/terrorists_may_use_g.html)
* [In Praise of Security Theater](https://www.schneier.com/essays/archives/2007/01/in_praise_of_securit.html)
* [Refuse to be Terrorized](https://www.schneier.com/essays/archives/2006/08/refuse_to_be_terrori.html)
* [The Eternal Value of Privacy](https://www.schneier.com/essays/archives/2006/05/the_eternal_value_of.html)
* [Terrorists Don't Do Movie Plots](https://www.schneier.com/essays/archives/2005/09/terrorists_dont_do_m.html)

[More Essays](https://www.schneier.com/essays/)

### Blog Archives

* [Archive by Month](https://www.schneier.com/blog/calendar.html/)
* [100 Latest Comments](https://www.schneier.com/blog/newcomments.html/)

#### Blog Tags

* [3d printers](https://www.schneier.com/tag/3d-printers/)
* [9/11](https://www.schneier.com/tag/9-11/)
* [A Hacker's Mind](https://www.schneier.com/tag/a-hackers-mind/)
* [Aaron Swartz](https://www.schneier.com/tag/aaron-swartz/)
* [academic](https://www.schneier.com/tag/academic/)
* [academic papers](https://www.schneier.com/tag/academic-papers/)
* [accountability](https://www.schneier.com/tag/accountability/)
* [ACLU](https://www.schneier.com/tag/aclu/)
* [activism](https://www.schneier.com/tag/activism/)
* [Adobe](https://www.schneier.com/tag/adobe/)
* [advanced persistent threats](https://www.schneier.com/tag/advanced-persistent-threats/)
* [adware](https://www.schneier.com/tag/adware/)
* [AES](https://www.schneier.com/tag/aes/)
* [Afghanistan](https://www.schneier.com/tag/afghanistan/)
* [AI](https://www.schneier.com/tag/ai/)
* [air marshals](https://www.schneier.com/tag/air-marshals/)
* [air travel](https://www.schneier.com/tag/air-travel/)
* [airgaps](https://www.schneier.com/tag/airgaps/)
* [al Qaeda](https://www.schneier.com/tag/al-qaeda/)
* [alarms](https://www.schneier.com/tag/alarms/)
* [algorithms](https://www.schneier.com/tag/algorithms/)
* [alibis](https://www.schneier.com/tag/alibis/)
* [Amazon](https://www.schneier.com/tag/amazon/)
* [Android](https://www.schneier.com/tag/android/)
* [anonymity](https://www.schneier.com/tag/anonymity/)
* [Anonymous](https://www.schneier.com/tag/anonymous/)
* [antivirus](https://www.schneier.com/tag/antivirus/)
* [Apache](https://www.schneier.com/tag/apache/)
* [Apple](https://www.schneier.com/tag/apple/)
* [Applied Cryptography](https://www.schneier.com/tag/applied-cryptography/)

[More Tags](https://www.schneier.com/blog/tags.html/)

### Latest Book

[![A Hacker's Mind](https://149400697.v2.pressablecdn.com/wp-content/uploads/2022/10/book-mind-200w.jpg)](https://www.schneier.com/books/a-hackers-mind/)

[More Books](https://www.schneier.com/books/)

[![Support Bloggers' Rights!](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/join-eff@2x.png "Support Bloggers' Rights!")](https://www.eff.org/issues/bloggers/legal/join)
[![Defend Privacy--Support Epic](https://149400697.v2.pressablecdn.com/wp-content/themes/schneier/assets/images/support-epic@2x.png "Defend Privacy--Support Epic")](https://epic.org/donate-to-epic/)

* [Blog](https://www.schneier.com)
* [Newsletter](https://www.schneier.com/crypto-gram/)
* [Books](https://www.schneier.com/books/)
* [Essays](https://www.schneier.com/essays/)
* [News](https://www.schneier.com/news/)
* [Talks](https://www.schneier.com/talks/)
* [Academic](https://www.schneier.com/academic/)
* [About Me](https://www.schneier.com/blog/about/)


