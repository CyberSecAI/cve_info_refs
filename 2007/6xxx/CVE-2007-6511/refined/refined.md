Based on the provided content, here's an analysis of the vulnerability described:

**CVE ID:** CVE-2007-6511 (based on content from mrhinkydink.blogspot.com)

**Root Cause of Vulnerability:**
The vulnerability stems from the Websense Enterprise 6.3.1 software's inadequate handling of User-Agent headers in HTTP requests. It appears the software relies on identifying the type of application based on the User-Agent, but fails to properly filter requests with spoofed or unexpected User-Agent strings.

**Weaknesses/Vulnerabilities Present:**
- **User-Agent Spoofing:** The primary weakness is the ability to bypass the Websense filtering system by sending HTTP requests with a manipulated User-Agent header. Specific examples include using "RealPlayer G2," "MSMSGS," and "StoneHttpAgent" as User-Agent strings.
- **Insufficient Protocol Handling:** Websense incorrectly categorizes traffic with spoofed User-Agent headers as "Non-HTTP" traffic. This indicates a lack of proper parsing or protocol inspection.

**Impact of Exploitation:**
- **Web Filtering Bypass:** By spoofing the User-Agent, users can access websites that are supposed to be blocked by Websense policies.
- **Circumvention of Monitoring:** To some extent, the vulnerability allows bypassing of Websense monitoring, as the traffic may be categorized incorrectly as “Non-HTTP”.

**Attack Vectors:**
- **HTTP Request Manipulation:** Attackers must be able to manipulate the User-Agent header of their HTTP requests. This can be achieved through browser plugins, custom HTTP clients, or other request modification methods.

**Required Attacker Capabilities/Position:**
- The attacker needs to have the ability to send HTTP requests through a network protected by Websense Enterprise 6.3.1.
- The attacker must be able to modify the User-Agent header of their HTTP requests, which is possible with readily available browser extensions.

**Additional Details:**
- The blog post mentions that the vulnerability was tested with the ISA Server integration product, and it is assumed to work with other integration products as well.
- The vendor acknowledges this behavior in their KnowledgeBase article #976 and addressed the issue in database #92938.
- The workaround suggested is to disable the protocols associated with the spoofed User-Agent strings, which may not be feasible in all environments.