=== Content from securityreason.com_25c5b50b_20250125_032331.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cygwin.com_1b4a7c73_20250125_032329.html ===


This is the mail archive of the
cygwin-developers
mailing list for the [Cygwin project](http://cygwin.com/).

---

| Index Nav: | [[Date Index](index.html#00005)] [[Subject Index](subjects.html#00005)] [[Author Index](authors.html#00005)] [[Thread Index](threads.html#00005)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg00004.html)] [[Date Next](msg00006.html)] | [[Thread Prev](msg00004.html)] [[Thread Next](msg00006.html)] |
| Other format: | [[Raw text](/cgi-bin/get-raw-msg?listname=cygwin-developers&date=2007-11&msgid=47330C63.8000000%40isecauditors.com)] |

# Re: cygwin1.dll up to 1.5.22 overflow

* *From*: "Daniel Fdez. Bleda" <dfernandez at isecauditors dot com>
* *To*: Dave Korn <dave dot korn at artimi dot com>
* *Cc*: cygwin-developers at cygwin dot com
* *Date*: Thu, 08 Nov 2007 14:17:23 +0100
* *Subject*: Re: cygwin1.dll up to 1.5.22 overflow
* *References*: <[4732F1CB.90305@isecauditors.com](msg00001.html)> <[20071108114756.GV31224@calimero.vinschen.de](msg00002.html)> <[47331426.5000804@isecauditors.com](msg00003.html)> <[01de01c82206$e38e6f90$2e08a8c0@CAM.ARTIMI.COM](msg00004.html)>

---

```
Dave,

Here you have the requested info of the advisory:
----------------------------------------------------------------------
III. DESCRIPTION
--------------------------
Traditionally, linux filesystem allow 255 bytes long, nevertheless
cygwin allow 239 bytes and there is a check that prevents filenames
equal or major than 240.

In spite of the check, there is a 232 bytes long dynamic memory buffer
where is stored the filename, so that is possible make a evil filename
with 233-239 bytes long that bypasses the check and overflows the heap
maximum 7 bytes. So you have to penetrate in machine and put the
evil-file and then 7 bytes of the private heap and ebx and edi
registers where mine.

The following file has to be uploaded, if we use ***REMOVED***, cygwin
will be bofed and will execute the evil code.

AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTTUUUUVVVVWWWWXXXXYYYY
...
----------------------------------------------------------------------
I would like to avoid public discussion if you need (as I expect) more
information.

Regards,

Dave Korn escribió:
> On 08 November 2007 13:51, Daniel Fdez. Bleda wrote:
>
>> Dear Corinna,
>>
>> I understand from this that you are asking for that details about
>> explotation, pof, etc. of a vulnerability of a software should be
>> directly disclosed in the list? Sounds some kind of dangerous.
>>
>> I didn't usually include in "bugs" a bof that permits execute code.
>>
>> I'll do this as you requested omitting sensible information.
>
>   I understand your need for caution.  I think maybe we should consider what
> is the best course of action to take and perhaps write up a semi-formal
> announcement for the list instead?
>
>   Also, maybe we should retire the earlier vulnerable cygwin dll versions that
> are still on sourceware.org?
>
>   Cygwin is inherently insecure, the shared memory mechanism allows
> unauthenticated communication across trust boundaries between processes;
> without a major redesign it's always going to be vulnerable to privilige
> escalation in particular.  It's not advisable to run a cygwin-based service
> facing the public internet IMO.
>
>   Which was the vulnerable function?  I'd like to see how serious the
> opportunities for attack are before we rush into anything.
>
>
>     cheers,
>       DaveK

--
_________________________________
Daniel Fernández Bleda
Director Comercial
CISA, CISSP, ISO27001 Lead Auditor
OPSA/OPST Trainer, CHFI Instructor
dfernandez@isecauditors.com

Internet Security Auditors, S.L.
c. Santander, 101. Edif. A. 2º
E-08030 Barcelona (Spain)
Tel: +34 93 305 13 18
Fax: +34 93 278 22 48
Mov: +34 600 86 40 85
www.isecauditors.com
          ____________________________________
Este mensaje y los documentos que, en su caso lleve anexos, pueden
contener información CONFIDENCIAL. Por ello, se informa al
destinatario que la información contenida en el mismo es reservada y
su uso no autorizado, publicación o difusión, entera o parcialmente,
tanto en formato o medio físico como electrónico, sin el previo
consentimiento de Internet Security Auditors, está prohibida legalmente.

Si ha recibido este correo por error, le rogamos que nos lo comunique
por la misma vía o por teléfono (93 305 13 18), se abstenga de
realizar copias del mensaje o remitirlo o entregarlo a otra persona y
proceda a borrarlo de inmediato.

En cumplimiento de la Ley Orgánica 15/1999 de 13 de diciembre de
protección de datos de carácter personal, Internet Security Auditors
S.L., le informa de que sus datos personales se han incluido en
ficheros informatizados titularidad de Internet Security Auditors
S.L., que será el único destinatario de dichos datos, y cuya finalidad
exclusiva es la gestión de clientes y acciones de comunicación
comercial, y de que tiene la posibilidad de ejercer los derechos de
acceso, rectificación, cancelación y oposición previstos en la ley
mediante carta dirigida a Internet Security Auditors, c. Santander,
101. Edif. A. 2º 1ª, 08030 Barcelona, o vía e-mail a la siguiente
dirección de correo: legal@isecauditors.com

```

---

* **Follow-Ups**:
  + **[Re: cygwin1.dll up to 1.5.22 overflow](msg00006.html)**
    - *From:* Corinna Vinschen

* **References**:
  + **[cygwin1.dll up to 1.5.22 overflow](msg00001.html)**
    - *From:* Daniel Fdez. Bleda
  + **[Re: cygwin1.dll up to 1.5.22 overflow](msg00002.html)**
    - *From:* Corinna Vinschen
  + **[Re: cygwin1.dll up to 1.5.22 overflow](msg00003.html)**
    - *From:* Daniel Fdez. Bleda
  + **[RE: cygwin1.dll up to 1.5.22 overflow](msg00004.html)**
    - *From:* Dave Korn

| Index Nav: | [[Date Index](index.html#00005)] [[Subject Index](subjects.html#00005)] [[Author Index](authors.html#00005)] [[Thread Index](threads.html#00005)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg00004.html)] [[Date Next](msg00006.html)] | [[Thread Prev](msg00004.html)] [[Thread Next](msg00006.html)] |



=== Content from cygwin.com_0a4f35ad_20250125_032330.html ===


This is the mail archive of the
cygwin-developers
mailing list for the [Cygwin project](http://cygwin.com/).

---

| Index Nav: | [[Date Index](index.html#00026)] [[Subject Index](subjects.html#00026)] [[Author Index](authors.html#00026)] [[Thread Index](threads.html#00026)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg00025.html)] [Date Next] | [[Thread Prev](msg00025.html)] [[Thread Next](msg00014.html)] |
| Other format: | [[Raw text](/cgi-bin/get-raw-msg?listname=cygwin-developers&date=2007-11&msgid=20071120120207.GA23518%40ednor.casa.cgf.cx)] |

# Re: cygwin1.dll up to 1.5.22 overflow

* *From*: Christopher Faylor <cgf-use-the-mailinglist-please at cygwin dot com>
* *To*: cygwin-developers at cygwin dot com
* *Date*: Tue, 20 Nov 2007 07:02:07 -0500
* *Subject*: Re: cygwin1.dll up to 1.5.22 overflow
* *References*: <[1195553439.4742b29fbf2cd@mail.isecauditors.com](msg00024.html)>
* *Reply-to*: cygwin-developers at cygwin dot com

---

```
On Tue, Nov 20, 2007 at 11:10:39AM +0100, Jesus wrote:
>Hello developers,
>
>cygwin1.dll is vulnerable a dangerous buffer overflow that can be exploited
>remotelly.
>
>We can take control of ebp and edi  and  can redirect the execution flow.
>
>I think the version is 1.5.7-1 and prior:

I think we can rest easy if it really is 1.5.7-1.  That version is about three
years old and is no longer available for download.

cgf

```

---

* **References**:
  + **[Re: cygwin1.dll up to 1.5.22 overflow](msg00024.html)**
    - *From:* Jesus

| Index Nav: | [[Date Index](index.html#00026)] [[Subject Index](subjects.html#00026)] [[Author Index](authors.html#00026)] [[Thread Index](threads.html#00026)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg00025.html)] [Date Next] | [[Thread Prev](msg00025.html)] [[Thread Next](msg00014.html)] |



=== Content from cygwin.com_41e7bdad_20250125_032329.html ===


This is the mail archive of the
cygwin-developers
mailing list for the [Cygwin project](http://cygwin.com/).

---

| Index Nav: | [[Date Index](index.html#00024)] [[Subject Index](subjects.html#00024)] [[Author Index](authors.html#00024)] [[Thread Index](threads.html#00024)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg00023.html)] [[Date Next](msg00025.html)] | [[Thread Prev](msg00023.html)] [[Thread Next](msg00025.html)] |
| Other format: | [[Raw text](/cgi-bin/get-raw-msg?listname=cygwin-developers&date=2007-11&msgid=1195553439.4742b29fbf2cd%40mail.isecauditors.com)] |

# Re: cygwin1.dll up to 1.5.22 overflow

* *From*: Jesus <jolmos at isecauditors dot com>
* *To*: cygwin-developers at cygwin dot com
* *Date*: Tue, 20 Nov 2007 11:10:39 +0100
* *Subject*: Re: cygwin1.dll up to 1.5.22 overflow

---

```
Hello developers,

cygwin1.dll is vulnerable a dangerous buffer overflow that can be exploited
remotelly.

There are system administrators who use cygwin ssh to administrate their Windows
boxes.

Is possible to make a remote secure copy with a long filename that will make the
following violation:

$ cat scp.exe.stackdump
Exception: STATUS_ACCESS_VIOLATION at eip=6109008D
eax=6167343A ebx=5959595A ecx=6167343C edx=04A96F89 esi=6E6C0055 edi=59595957
ebp=6E6C006C esp=0022E51B program=C:\sshd\bin\scp.exe
cs=001B ds=0023 es=0023 fs=0038 gs=0000 ss=0023

(in that case is scp client who crashes, but any program crash, touch and ssh
too)

$ gdb /usr/bin/touch.exe
GNU gdb 2003-09-20-cvs (cygwin-special)
...
(gdb) r AAAA ...
Program received signal SIGSEGV, Segmentation fault.
0x61091eea in getppid () from /usr/bin/cygwin1.dll
(gdb) x/i 0x61091eea
0x61091eea <getppid+2954>:      mov    0xc(%ebp),%eax
(gdb) i r ebp eax
ebp            0x22006b 0x22006b
eax            0xffffffff       -1

We can take control of ebp and edi  and  can redirect the execution flow.

I think the version is 1.5.7-1 and prior:

sha0:~# strings /root/backup2/cygwin/bin/cygwin1.dll | grep -i cygwin\-
/netrel/src/cygwin-1.5.7-1/winsup/cygwin/cygheap.cc
/netrel/src/cygwin-1.5.7-1/winsup/cygwin/dir.cc
...

It seems that the problem is at getppid(), but this debuger is inside cygwin,
maybe debugging from outside will see diferent things.

regards

--
_________________________________
Jesús Olmos González
Analista en Seguridad
OPST CEH
Dpto. de Auditoría
jolmos@isecauditors.com

Internet Security Auditors, S.L.
c. Santander, 101. Edif. A. 2º
08030 Barcelona
Tel: 93 305 13 18
Fax: 93 278 22 48
www.isecauditors.com
          ____________________________________
Este mensaje y los documentos que, en su caso lleve anexos, pueden
contener información CONFIDENCIAL. Por ello, se informa al
destinatario que la información contenida en el mismo es reservada y
su uso no autorizado, publicación o difusión, entera o parcialmente,
tanto en formato o medio físico como electrónico, sin el previo
consentimiento de Internet Security Auditors, está prohibida legalmente.

Si ha recibido este correo por error, le rogamos que nos lo comunique
por la misma vía o por teléfono (93 305 13 18), se abstenga de
realizar copias del mensaje o remitirlo o entregarlo a otra persona y
proceda a borrarlo de inmediato.

En cumplimiento de la Ley Orgánica 15/1999 de 13 de diciembre de
protección de datos de carácter personal, Internet Security Auditors
S.L., le informa de que sus datos personales se han incluido en
ficheros informatizados titularidad de Internet Security Auditors
S.L., que será el único destinatario de dichos datos, y cuya finalidad
exclusiva es la gestión de clientes y acciones de comunicación
comercial, y de que tiene la posibilidad de ejercer los derechos de
acceso, rectificación, cancelación y oposición previstos en la ley
mediante carta dirigida a Internet Security Auditors, c. Santander,
101. Edif. A. 2º 1ª, 08030 Barcelona, o vía e-mail a la siguiente
dirección de correo: legal@isecauditors.com

```

---

* **Follow-Ups**:
  + **[RE: cygwin1.dll up to 1.5.22 overflow](msg00025.html)**
    - *From:* Dave Korn
  + **[Re: cygwin1.dll up to 1.5.22 overflow](msg00026.html)**
    - *From:* Christopher Faylor

| Index Nav: | [[Date Index](index.html#00024)] [[Subject Index](subjects.html#00024)] [[Author Index](authors.html#00024)] [[Thread Index](threads.html#00024)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg00023.html)] [[Date Next](msg00025.html)] | [[Thread Prev](msg00023.html)] [[Thread Next](msg00025.html)] |


