```
{
  "cve": "CVE-2007-6067",
  "description": "The regular expression handling code in PostgreSQL, which is adopted from TCL, can be exploited to trigger a temporary Denial of Service (DoS) attack. This occurs by causing the PostgreSQL server to consume large amounts of system memory and CPU resources. Systems with memory overcommit enabled (a default setting) may have the database server terminated by the kernel OOM killer.",
  "affected_packages": [
    "dev-db/postgresql",
    "postgresql"
  ],
  "vulnerability_details": {
    "root_cause": "A flaw in the regular expression handling code, specifically in the NFA (Nondeterministic Finite Automaton) cleanup process.",
    "weaknesses": [
      "Inefficient regular expression processing",
        "Lack of resource limits for regular expression operations",
       "Vulnerable regex NFA cleanup"
    ],
    "impact": "Temporary Denial of Service (DoS) due to high resource consumption (CPU and memory) and potential termination of the database server by the OOM killer.",
    "attack_vectors": [
      "Specially crafted SQL queries containing complex regular expressions."
    ],
    "attacker_capabilities": [
      "Remote authenticated attacker capable of sending SQL queries to the server."
    ],
     "additional_information": "The vulnerability was found in regular expression code adopted from TCL. It is triggered when a query containing complex regex is provided, leading to slow regex NFA cleanup, high memory consumption and eventually OOM killer taking down the server."
  },
  "patch_information": [
    {
      "vendor": "Gentoo",
      "resolution": "Upgrade to version >= 8.0.15, >= 7.4.19 or >= 7.3.21 of the dev-db/postgresql package."
    },
    {
     "vendor": "Red Hat",
      "resolution": "Red Hat recommends updating to the patched versions of the `tcl` package, included in RHSA-2013:0122. Additionally, postgresql was fixed in versions 8.2.6-1.fc8 and 8.2.6-1.fc7 for Fedora"
    },
    {
     "vendor": "openSUSE",
     "resolution": "openSUSE recommends updating to the patched versions of postgresql-8.1.11 for openSUSE 10.2 and SUSE Linux 10.1, postgresql-8.2.6 for openSUSE 10.3"
    },
    {
     "vendor": "Debian",
     "resolution": "Debian recommends updating to the patched version postgresql-7.4 7.4.19-0etch1 for etch, and 7.4.7-6sarge6 for sarge although backports for regex handling isn't included in sarge."
     }
  ]
}
```