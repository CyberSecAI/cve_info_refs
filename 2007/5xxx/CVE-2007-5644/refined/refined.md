- **Root cause of vulnerability:** The script `/ajax/sortcategories.php` does not properly sanitize user input, allowing for SQL injection. This script is intended for admin use to sort categories, but it's not protected from unauthorized users.
- **Weaknesses/vulnerabilities present:** Blind SQL Injection vulnerability in the `/ajax/sortcategories.php` script and also in `/ajax/sortroles.php`.
- **Impact of exploitation:** An attacker can exploit the SQL injection vulnerability to extract sensitive information from the database, such as user passwords. The exploit uses time-based blind SQL injection to infer data by observing the delay in response time.
- **Attack vectors:** The vulnerability is accessed through a crafted GET request to `/ajax/sortcategories.php`, specifically by manipulating the `CategoryID` parameter. The attacker crafts SQL queries within this parameter to extract information from the database.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the vulnerable application. No prior authentication is needed as the vulnerable scripts are not protected from unauthorized users. The attacker does require the `magic_quotes_gpc` setting to be off on the target.