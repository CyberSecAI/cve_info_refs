=== Content from access.redhat.com_88fd3948_20250126_061159.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_6c305684_20250125_051004.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D298651)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D298651)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D298651)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 298651

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 298651**](show_bug.cgi?id=298651)
(CVE-2007-5159)
- ntfs-3g allows access to partition the users normally should not have access to

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
ntfs-3g allows access to partition the users normally should not have access to

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2007-5159 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | ntfs-3g | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | rawhide | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | urgent | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Tom "spot" Callaway | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [F8Blocker](show_bug.cgi?id=235703 "CLOSED CURRENTRELEASE - Fedora 8 Blocker Tracker") | | TreeView+ | [depends on](buglist.cgi?bug_id=298651&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=298651&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2007-09-20 17:34 UTC by Thorsten Leemhuis | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2007-11-30 22:12 UTC ([History](show_activity.cgi?id=298651)) | | [CC List:](page.cgi?id=fields.html#cclist) | 3 users (show)  davidz lkundrak szaka | | Fixed In Version: | 2.7.0-5.fc7 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2007-09-25 08:29:09 UTC | | | Type: | --- | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=298651#c0)  Thorsten Leemhuis    2007-09-20 17:34:46 UTC  ``` Description of problem: Fuse in general and Fedora's way to let only members of the group fuse access and use fuse was discussed in <https://www.redhat.com/archives/fedora-desktop-list/2007-September/msg00163.html> and mails below in that thread.  There we noticed that members of the group fuse can get access to devices which they normally should not have access to. See <https://www.redhat.com/archives/fedora-desktop-list/2007-September/msg00163.html> ; the relevant parts of it:  $ ls -l /dev/sda3 brw-r----- 1 root disk 8, 3 14. Sep 16:10 /dev/sda3 $ groups thl fuse $ dd if=/dev/sda3 bs=512K count=1 | strings dd: opening `/dev/sda3': Permission denied $ mkdir ntfs $ /sbin/mount.ntfs-3g /dev/sda3 ntfs/ $ touch ntfs/foo $ ls -l ntfs/foo -rwxrwxrwx 1 thl thl 0 18. Sep 19:27 ntfs/foo  ntfs-3g IMHO should fail, as the users should not get access to random devices he has no access to. Quoting Alexander Larsson from <https://www.redhat.com/archives/fedora-desktop-list/2007-September/msg00171.html>  >Thats quite weird. The way I undestand fuse is that you run the >filesystem as your user, and then that filesystem (via libfuse) spawns >fusermount to open the fuse device and attach to the mountpoint. >fusermount then passes the fd to the fuse device back the the filesystem >process (via a socket) which then handles all the requests.  > >Reading the data source for the filesystem (if there is any) is only >done by the filesystem process, not by the setuid fusermount helper, so >it should not be able to read /dev/sda3.  Further investigation showed that ntfs-3g gets installed SUID root:  $ ls -l /sbin/mount.ntfs-3g  -rwsr-xr-- 1 root fuse 40528 17. Sep 23:14 /sbin/mount.ntfs-3g  That might be wrong as that afaics makes it possible for ntfs-3g to access devices which the user normally would not have access to. Quoting Alexander again, this time from <https://www.redhat.com/archives/fedora-desktop-list/2007-September/msg00174.html>  >Oh. That seems like a bad idea to me. If this drops privs after opening >the device I think you can attach to the process using e.g. gdb and call >any read() operation on the device. If might even mean (with some >creative exploits) that any fuse group user can read any block on any >disk.  Version-Release number of selected component (if applicable): ntfs-3g-1.913-1.fc8  Please note that I as ex-maintainer of fuse stumbled into this by accident -- I don't care much about fuse and ntfs-3g these days, but I think the behavior of ntfs-3g is a security bug.   ```  [Comment 1](show_bug.cgi?id=298651#c1)  David Zeuthen    2007-09-20 18:44:03 UTC  ``` I really think this is a security issue that needs dealing with.   ```  [Comment 2](show_bug.cgi?id=298651#c2)  Tom "spot" Callaway    2007-09-20 18:54:05 UTC  ``` It seems like the obvious fix here is to not have ntfs-3g setuid. Agree?   ```  [Comment 3](show_bug.cgi?id=298651#c3)  David Zeuthen    2007-09-20 19:10:54 UTC  ``` I think it makes sense to make any user user system-installed fuse file systems PROVIDED they have access to the underlying block device or whatever resource is backing the file system. E.g. if I use a FUSE module to access my gmail account, it should be possible for me to mount it somewhere under $HOME without having special privileges.  This is much like we allow any user to use any kernel file systems PROVIDED they have access to the underlying block device (NFS, however, is special I believe).  But the important part here is really that /sbin/mount.ntfs-3g is letting you use any block device you want just because you have access to /dev/fuse. That's the fundamental flaw; that program needs to also check that the invoking unprivileged user have access to the block device.   I think the best solution is probably to avoid setuid and let pam_console manage permissions on /dev/fuse. That way /sbin/mount.ntfs-3g probably wouldn't need to run as root at all and mounting would only work if you have access to the underlying block device.    ```  [Comment 4](show_bug.cgi?id=298651#c4)  David Zeuthen    2007-09-20 19:13:28 UTC  ``` Thinking more about it making /dev/fuse mode 0666 and removing the setuid root bit from /sbin/mount.ntfs-3g is probably what we need to do. Shrug.   ```  [Comment 5](show_bug.cgi?id=298651#c5)  Tom "spot" Callaway    2007-09-20 20:45:06 UTC  ``` I just built and created an update for fuse and ntfs-3g (fuse-2.7.0-4.fc7, ntfs-3g-1.913-2.fc7). Please test these when they hit to ensure that this resolves the security problem and doesn't affect functionality.   ```  [Comment 6](show_bug.cgi?id=298651#c6)  Lubomir Kundrak    2007-09-21 08:38:13 UTC  ``` The CVE identifier for this issue was requested.   ```  [Comment 7](show_bug.cgi?id=298651#c7)  Thorsten Leemhuis    2007-09-21 09:15:20 UTC  ``` (In reply to [comment #6](show_bug.cgi?id=298651#c6)) > The CVE identifier for this issue was requested.  In case it matters: it works the same way on Ubuntu 7.10/Gutsy afaisc -- if you are a member of the fuse-group there you as ordinary user can access devices which you normally would have no access to.     ```  [Comment 8](show_bug.cgi?id=298651#c8)  Alexander Larsson    2007-09-21 09:28:14 UTC  ``` /sbin/fusermount should be setuid, as its required for opening the fuse device and attaching it to the mountpoint (similar to how /bin/mount is setuid) . It should imho not be setuid for the fuse group, but for anyone so that normal users can mount stuff in e.g. their own homedirs.  However, that is a far cry from having mount.ntfs-3g being setuid. As far as I can tell the only reason for doing that is so that it can read the devices containing the filesystem. But this at the same time basically means any user in the fuse group can read any block device, which is horribly bad.   Making it possible for ntfs to access the device as the user is better done in other ways, like the admin chowning the particular device, or the user being in the disk group.   ```  [Comment 9](show_bug.cgi?id=298651#c9)  Alexander Larsson    2007-09-21 11:13:21 UTC  ``` davidz: Why should we change the ownership of /dev/fuse? I don't think that helps any.  All that is needed is that fusermount is correctly setuid and executable by everyone. It opens the device, verifies permissions (via config files and whatnot) and calls the mount syscall. Then it hands over the resulting fd to the non-privileged filesystem process.   ```  [Comment 10](show_bug.cgi?id=298651#c10)  Tom "spot" Callaway    2007-09-21 12:58:11 UTC  ``` /dev/fuse was 660 before I changed it. I can change it back, if needed. Just let me know. :)   ```  [Comment 11](show_bug.cgi?id=298651#c11)  David Zeuthen    2007-09-21 15:52:12 UTC  ``` (In reply to [comment #8](show_bug.cgi?id=298651#c8)) > /sbin/fusermount should be setuid, as its required for opening the fuse device > and attaching it to the mountpoint (similar to how /bin/mount is setuid) . It > should imho not be setuid for the fuse group, but for anyone so that normal > users can mount stuff in e.g. their own homedirs. >  > However, that is a far cry from having mount.ntfs-3g being setuid. As far as I > can tell the only reason for doing that is so that it can read the devices > containing the filesystem. But this at the same time basically means any user in > the fuse group can read any block device, which is horribly bad.  >  > Making it possible for ntfs to access the device as the user is better done in > other ways, like the admin chowning the particular device, or the user being in > the disk group.  Or just mounting it via HAL; that's how it works post-Fedora 7. E.g. if you have a dual-boot system your Windows partition should appear in Nautilus or KDE or whatever and if you try to mount it you may encounter a one-time-pain PolicyKit dialog asking for the root password. It's one-time-pain because you can select to keep the privilege forever. This is all configurable via PolicyKit.conf so it can be locked down any way the user desires.    ```  [Comment 12](show_bug.cgi?id=298651#c12)  David Zeuthen    2007-09-21 15:55:33 UTC  ``` (In reply to [comment #9](show_bug.cgi?id=298651#c9)) > davidz: Why should we change the ownership of /dev/fuse? I don't think that > helps any. >  > All that is needed is that fusermount is correctly setuid and executable by > everyone. It opens the device, verifies permissions (via config files and > whatnot) and calls the mount syscall. Then it hands over the resulting fd to the > non-privileged filesystem process.  Right, it's probably better to make fusermount setuid root so it can access the /dev/fuse file rather than making the /dev/fuse file accessible to everyone. Alternatively (and maybe a bit more secure) make fusermount setgid fuse and make /dev/fuse 0660. All that matters is that fusermount can open /dev/fuse; pick whatever works and is most secure, right?    ```  [Comment 13](show_bug.cgi?id=298651#c13)  Thorsten Leemhuis    2007-09-21 16:52:03 UTC  ``` (In reply to [comment #9](show_bug.cgi?id=298651#c9)) > davidz: Why should we change the ownership of /dev/fuse? I don't think that > helps any.  Agreed.  (In reply to [comment #10](show_bug.cgi?id=298651#c10)) > /dev/fuse was 660 before I changed it. I can change it back, if needed. Just let > me know. :)  Well, isn't making it 666 creating yet another problem? I'm not really sure, but if the device it 666 then the user afaics could compile his own fuse and use the device with it, thus circumventing the need to be a member of the fuse group to use fuse in general(Â¹)? Or am I missing something/got something really wrong now?  (Â¹) -- which is afaik want we want for now, until "someone sits down and really does audit fuse", as jeremy wrote in  <https://www.redhat.com/archives/fedora-desktop-list/2007-September/msg00151.html>    ```  [Comment 14](show_bug.cgi?id=298651#c14)  Tom "spot" Callaway    2007-09-21 17:06:01 UTC  ``` After thinking about it, /dev/fuse should be chmod 660 (not 666), and fusermount should be setuid root. I'm committing those changes now, and I'll respin the update.   ```  [Comment 15](show_bug.cgi?id=298651#c15)  Fedora Update System    2007-09-25 08:29:08 UTC  ``` fuse-2.7.0-5.fc7, ntfs-3g-1.913-2.fc7 has been pushed to the Fedora 7 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 16](show_bug.cgi?id=298651#c16)  Thorsten Leemhuis    2007-09-25 08:43:10 UTC  ``` (In reply to [comment #15](show_bug.cgi?id=298651#c15)) > fuse-2.7.0-5.fc7, ntfs-3g-1.913-2.fc7 has been pushed to the Fedora 7 stable repository.  If problems still persist, please make note of it in this bug report.  Hmmm. Lot's of users will likely run into problems now and will wonder how to make ntfs-3g work again -- wouldn't it be wise to do some formal announcement why the change was done and how users can make it work again?     ```  [Comment 17](show_bug.cgi?id=298651#c17)  Jan Engelhardt    2007-09-27 08:02:56 UTC  ``` How about just making /dev/fuse 666 and have no setuid/setgid bits set?   ```  [Comment 18](show_bug.cgi?id=298651#c18)  Thorsten Leemhuis    2007-09-27 10:57:47 UTC  ``` (In reply to [comment #17](show_bug.cgi?id=298651#c17)) > How about just making /dev/fuse 666 and have no setuid/setgid bits set?  Then fuse afaik doesn't work at all.  BTW, we are discussing different things in this bug and that seems to become more and more confusing afaics.  This bug was about ntfs-3g that could access hard disk partions it should have no access to because it was SUID root -- spot fixed that (BTW: thx spot).   But that's afaics mostly (totally?) independent of the /dev/fuse files, it's permissions or the permissions of the fuse executables.   ```  [Comment 19](show_bug.cgi?id=298651#c19)  Szabolcs Szakacsits    2007-09-27 21:03:48 UTC  ``` If mount(8) would execv euid=0 ntfs-3g (if the user has all the rights of course) and fuse would allow unprivileged fuseblk mounts then everything would work fine ntfs-3g non-setuid.  Btw, I think users can not get uncontrolled access to any devices by suid ntfs-3g via this way, only to NTFS ones (which can be still more than it should be). If the device is not NTFS then ntfs-3g exits without dropping the privilege. Opening a device via strace/gdb/etc obviously fails.    ```  [Comment 20](show_bug.cgi?id=298651#c20)  Tomas Hoger    2007-10-01 08:09:41 UTC  ``` CVE id [CVE-2007-5159](https://access.redhat.com/security/cve/CVE-2007-5159) was assigned to this issue.   ```  [Comment 21](show_bug.cgi?id=298651#c21)  Szabolcs Szakacsits    2007-10-06 12:09:46 UTC  ``` I'm sorry to say but the Fedora and CVE advisories and security analyzes don't look technically correct as of today.   First of all, this issue has nothing to do with FUSE.  The reason why suid-root is needed in some cases is explained here: <http://ntfs-3g.org/support.html#useroption>  Here is how suid-root ntfs-3g works:  unprivileged initialization (parsing options, etc) gain privilege load fuse module, fix missing fuse device open(2) the device immediately read the NTFS boot sector (first 512 bytes of the partition) exit without dropping privilege if it's not NTFS. mount with FUSE if the partition is NTFS. drop privilege function as a file system driver  Considering the above, could somebody please explain how a user, allowed to mount NTFS partitions via the ntfs-3g file permission settings, could gain read and write access to __arbitrary__ block device? What he can do are  1) gain information about if a device is NTFS or not 2) mount and read/write any NTFS partitions (file permission based, per device restriction is not possible until mount(8) is fixed if 'user' and 'users' mount option support is required).  So it's true that they get read/write access to any __NTFS__ block devices if they were allowed to execute ntfs-3g but I fail to see how users could get access to __any__ block devices via the way the advisories talk about.  Regards,  Szaka  -- NTFS-3G Lead Developer:  <http://ntfs-3g.org>    ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=298651&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


