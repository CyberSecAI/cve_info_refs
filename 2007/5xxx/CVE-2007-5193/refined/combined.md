=== Content from security-tracker.debian.org_426182c0_20250126_034248.html ===

# CVE-2007-5193

| **Name** | CVE-2007-5193 |
| --- | --- |
| **Description** | The default configuration for twiki 4.1.2 on Debian GNU/Linux, and possibly other operating systems, specifies the work area directory (cfg{RCS}{WorkAreaDir}) under the web document root, which might allow remote attackers to obtain sensitive information when .htaccess restrictions are not applied. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2007-5193) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2007-5193); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2007-5193), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2007-5193), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2007-5193), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2007-5193), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2007-5193), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2007-5193), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2007-5193), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2007-5193)/[CVE](https://www.suse.com/security/cve/CVE-2007-5193/), GitHub [advisories](https://github.com/advisories?query=CVE-2007-5193)/[code](https://github.com/search?type=Code&q=%22CVE-2007-5193%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2007-5193%22), [web search](https://duckduckgo.com/html?q=%22CVE-2007-5193%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [444982](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=444982) |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [twiki](/tracker/source-package/twiki) | source | (unstable) | 1:4.1.2-3 | low |  | [444982](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=444982) |

## Notes

```
[etch] - twiki <no-dsa> (Minor packaging flaw, doesn't warrant an update)

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from bugs.debian.org_c2cf11ae_20250124_214222.html ===

# Debian Bug report logs - #444982 CVE-2007-5193 information disclosure in default configuration

[![version graph](version.cgi?found=4.1.2-1;found=twiki%2F1%3A4.1.2-2;collapse=1;package=twiki;height=2;fixed=twiki%2F1%3A4.1.2-3;absolute=0;width=2)](version.cgi?absolute=0;fixed=twiki%2F1%3A4.1.2-3;package=twiki;info=1;found=4.1.2-1;found=twiki%2F1%3A4.1.2-2;collapse=1)

Package:
[twiki](pkgreport.cgi?package=twiki);
Maintainer for [twiki](pkgreport.cgi?package=twiki) is [(unknown)](pkgreport.cgi?maint=);

Reported by: [Olivier Berger <olivier.berger@int-edu.eu>](pkgreport.cgi?submitter=olivier.berger%40int-edu.eu)

Date: Tue, 2 Oct 2007 13:18:04 UTC

Severity: *grave*

Tags: security

Found in versions 4.1.2-1, twiki/1:4.1.2-2

Fixed in version twiki/1:4.1.2-3

**Done:** Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=444982;mbox=yes), [status mbox](bugreport.cgi?bug=444982;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=444982;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=2), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Olivier Berger <olivier.berger@int-edu.eu>`:

New Bug report received and forwarded. Copy sent to `Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`.
([full text](bugreport.cgi?bug=444982;msg=4), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=5), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=olivier.berger%40int-edu.eu)
From: Olivier Berger <olivier.berger@int-edu.eu>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: twiki: Potential security risk with default cfg{RCS}{WorkAreaDir}
Date: Tue, 02 Oct 2007 15:13:35 +0200
```
Package: twiki
Version: 4.1.2-1
Severity: normal

Hi.

Default config for cfg{RCS}{WorkAreaDir} is to use the PubDir/_work_areas/ as "work area" for plugins (see /var/www/twiki/pub/_work_areas/README).

However, this dir (/var/www/twiki/pub/_work_areas) potentialy exposes its content (as <http://localhost/twiki/pub/_work_areas>) on the web (it's only protected by a .htaccess, which may easily be inactive due to diabling of overrides in apache config).

This directory is supposed to be used by TWiki plugins to store tempfiles, etc. Exposing such files may constitute a security risk.

I think it may be wise to put such a work area in a dir like /var/lib/apache2/twiki which would be owned by www-data but not accessible from the web (by setting cfg{RCS}{WorkAreaDir} accordingly).

Hope this helps.

-- System Information:
Debian Release: lenny/sid
  APT prefers testing
  APT policy: (500, 'testing'), (500, 'stable')
Architecture: i386 (i686)

Kernel: Linux 2.6.18-5-xen-686 (SMP w/2 CPU cores)
Locale: LANG=fr_FR.UTF-8, LC_CTYPE=fr_FR.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/bash

Versions of packages twiki depends on:
ii  apache2.2-common           2.2.4-3       Next generation, scalable, extenda
ii  debconf [debconf-2.0]      1.5.14        Debian configuration management sy
pn  libalgorithm-diff-perl     <none>        (no description available)
pn  libcgi-session-perl        <none>        (no description available)
ii  libdigest-sha1-perl        2.11-2        NIST SHA-1 message digest algorith
pn  liberror-perl              <none>        (no description available)
ii  libhtml-parser-perl        3.56-1        A collection of modules that parse
pn  liblocale-maketext-lexicon <none>        (no description available)
pn  libtext-diff-perl          <none>        (no description available)
ii  liburi-perl                1.35.dfsg.1-1 Manipulates and accesses URI strin
ii  perl [libmime-base64-perl] 5.8.8-7       Larry Wall's Practical Extraction
ii  perl-modules [libnet-perl] 5.8.8-7       Core Perl modules
ii  rcs                        5.7-20        The GNU Revision Control System

twiki recommends no packages.

```

---

**Tags added: security**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Tue, 02 Oct 2007 19:21:02 GMT) ([full text](bugreport.cgi?bug=444982;msg=7), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=7), [link](#6)).

---

**Severity set to `important' from `normal'**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Thu, 04 Oct 2007 16:36:18 GMT) ([full text](bugreport.cgi?bug=444982;msg=9), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=9), [link](#8)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=11), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=11), [link](#10)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`.

Your message did not contain a Subject field. They are recommended and
useful because the title of a Bug is determined using this field.
Please remember to include a Subject field in your messages in future.

([full text](bugreport.cgi?bug=444982;msg=13), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=13), [link](#12)).

---

[Message #14](#14) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=14), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=14), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 444982@bugs.debian.org
Date: Thu, 4 Oct 2007 18:26:53 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=14) (text/plain, inline)]
```
```
Hi,
the following CVE id was assigned to this issue:
[CVE-2007-5193](https://security-tracker.debian.org/tracker/CVE-2007-5193)[0].

Please inform the upstream author about this and include the
CVE id in the changelog if you close this bug.

[0] <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5193>

Kind regards
Nico

--
Nico Golde - <http://ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=14) (application/pgp-signature, inline)]
```

---

**Changed Bug title to `potential disclosure of secret information in default configuration' from `twiki: Potential security risk with default cfg{RCS}{WorkAreaDir}'.**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Thu, 04 Oct 2007 16:42:15 GMT) ([full text](bugreport.cgi?bug=444982;msg=16), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=16), [link](#15)).

---

**Changed Bug title to `CVE-2007-5193 information disclosure in default configuration' from `potential disclosure of secret information in default configuration'.**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Sun, 07 Oct 2007 15:21:01 GMT) ([full text](bugreport.cgi?bug=444982;msg=18), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=18), [link](#17)).

---

**Reply sent** to `Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=444982;msg=20), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=20), [link](#19)).

---

**Notification sent** to `Olivier Berger <olivier.berger@int-edu.eu>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=444982;msg=22), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=22), [link](#21)).

---

[Message #23](#23) received at 444982-close@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=23), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=23), reply):

![](/cgi-bin/libravatar.cgi?email=SvenDowideit%40DistributedINFORMATION.com)
From: Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>
To: 444982-close@bugs.debian.org
Subject: Bug#444982: fixed in twiki 1:4.1.2-2
Date: Sat, 20 Oct 2007 19:32:03 +0000
```
Source: twiki
Source-Version: 1:4.1.2-2

We believe that the bug you reported is fixed in the latest version of
twiki, which is due to be installed in the Debian FTP archive:

twiki_4.1.2-2.diff.gz
  to pool/main/t/twiki/twiki_4.1.2-2.diff.gz
twiki_4.1.2-2.dsc
  to pool/main/t/twiki/twiki_4.1.2-2.dsc
twiki_4.1.2-2_all.deb
  to pool/main/t/twiki/twiki_4.1.2-2_all.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 444982@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Sven Dowideit <SvenDowideit@DistributedINFORMATION.com> (supplier of updated twiki package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Sun, 14 Oct 2007 09:53:40 +0100
Source: twiki
Binary: twiki
Architecture: source all
Version: 1:4.1.2-2
Distribution: unstable
Urgency: high
Maintainer: Sven Dowideit <svenud@ozemail.com.au>
Changed-By: Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>
Description:
 twiki      - A Web Based Collaboration Platform
Closes: [422245](bugreport.cgi?bug=422245) [444982](bugreport.cgi?bug=444982)
Changes:
 twiki (1:4.1.2-2) unstable; urgency=high
 .
   * secure /var/www/twiki/pub/_work_areas (Closes: #[444982](bugreport.cgi?bug=444982))
     [CVE-2007-5193](https://security-tracker.debian.org/tracker/CVE-2007-5193)
   * added Dutch translation (Closes: #[422245](bugreport.cgi?bug=422245))
Files:
 810eed28cb6c77417cefdfa015fda286 753 web optional twiki_4.1.2-2.dsc
 bff9682bdacc151e0397da058e2814fe 41373 web optional twiki_4.1.2-2.diff.gz
 c7eda992c26e43ad4a3d4cf997429ed8 4683946 web optional twiki_4.1.2-2_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iQCVAwUBRxpVqj6XMRfcxSjpAQIukgQApy95MfmY2MjPEor1D0Qpl/UmhOLlBwB8
5VRHaBhF2tqzYrOMqB6qwRrbge4tVC66uNt4AyYTJRtqpZMBek6VHxrGnoCfp7NU
mDCEdCngnKa1fXu1LdZMejU/Q+4zfOQvkP/GtAG+prWAaFBxe8Q1PASQ8LDhd2e3
64wtRfpYUYU=
=hh+3
-----END PGP SIGNATURE-----

```

---

**Bug reopened, originator not changed.**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Sat, 20 Oct 2007 19:57:01 GMT) ([full text](bugreport.cgi?bug=444982;msg=25), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=25), [link](#24)).

---

**Bug marked as found in version 1:4.1.2-2.**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Sat, 20 Oct 2007 19:57:03 GMT) ([full text](bugreport.cgi?bug=444982;msg=27), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=27), [link](#26)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=29), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=29), [link](#28)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`.
([full text](bugreport.cgi?bug=444982;msg=31), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=32), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 444982@bugs.debian.org
Cc: svenud@ozemail.com.au, ardo@debian.org, holger@debian.org
Subject: Re: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Sat, 20 Oct 2007 21:53:41 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=32) (text/plain, inline)]
```
```
Hi,
errm why on earth did you (Sven) search for another sponsor when
Holger was looking into your package but decided not to
upload it because of the changes you made?

You searched a new sponsor with exactly the same debdiff.

I am sorry but it looks like this was intentionally because
I Cced you in the mail stating why there is no way for this
package to get uploaded:
<http://lists.alioth.debian.org/pipermail/secure-testing-team/2007-October/001416.html>

Why did you ignore this, and Ardo, why did you upload this?

I reopened the bug in the meantime...
Kind regards
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=32) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=34), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=34), [link](#33)).

---

**Acknowledgement sent** to `Ardo van Rangelrooij <ardo@ardolabs.com>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`.
([full text](bugreport.cgi?bug=444982;msg=36), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=36), [link](#35)).

---

[Message #37](#37) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=37), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=37), reply):

![](/cgi-bin/libravatar.cgi?email=ardo%40ardolabs.com)
From: Ardo van Rangelrooij <ardo@ardolabs.com>
To: Nico Golde <nion@debian.org>, svenud@ozemail.com.au
Cc: 444982@bugs.debian.org, holger@debian.org
Subject: Re: marked as done (CVE-2007-5193 information disclosure in default
configuration)
Date: Sat, 20 Oct 2007 15:06:38 -0500
```
Nico Golde wrote:
> Hi,
> errm why on earth did you (Sven) search for another sponsor when
> Holger was looking into your package but decided not to
> upload it because of the changes you made?
>
> You searched a new sponsor with exactly the same debdiff.
>
> I am sorry but it looks like this was intentionally because
> I Cced you in the mail stating why there is no way for this
> package to get uploaded:
> <http://lists.alioth.debian.org/pipermail/secure-testing-team/2007-October/001416.html>
>
> Why did you ignore this, and Ardo, why did you upload this?

Nico,

Oops! Totally overlooked this one.  Yes, that should never have been uploaded.
 (For a moment I was afraid I took the wrong version from Sven's website, but
this is the only version for this fix.)

I also wasn't aware of you being involved in this.

Sven,

This is not good.  Let's never do this again.

Thanks,
Ardo

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=39), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=39), [link](#38)).

---

**Acknowledgement sent** to `Sven Dowideit <SvenDowideit@home.org.au>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=41), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=41), [link](#40)).

---

[Message #42](#42) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=42), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=42), reply):

![](/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au)
From: Sven Dowideit <SvenDowideit@home.org.au>
To: Ardo van Rangelrooij <ardo@ardolabs.com>, 444982@bugs.debian.org
Cc: Nico Golde <nion@debian.org>, svenud@ozemail.com.au,
holger@debian.org
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Sun, 21 Oct 2007 19:22:26 +1000
```
Bizzre,

I don't have any email from Holger, at any time, nor did I search for a
new sponsor. Ardo has been sponsoring this package for the last few
years, with Amaya helping me out both with the debian bits, and with
uploading when things were busy.

so, um, what are you debian people up to?

I also did not receive any information that there was an issue with this
package, so I guess there's a communications problem somewhere?

anyone want to fill me in?

(yes, I am not a DD, and have little time nor interest in becoming one,
I'm just trying hard to make twiki easier for people)

Sven

On Sat, 2007-10-20 at 15:06 -0500, Ardo van Rangelrooij wrote:
> Nico Golde wrote:
> > Hi,
> > errm why on earth did you (Sven) search for another sponsor when
> > Holger was looking into your package but decided not to
> > upload it because of the changes you made?
> >
> > You searched a new sponsor with exactly the same debdiff.
> >
> > I am sorry but it looks like this was intentionally because
> > I Cced you in the mail stating why there is no way for this
> > package to get uploaded:
> > <http://lists.alioth.debian.org/pipermail/secure-testing-team/2007-October/001416.html>
> >
> > Why did you ignore this, and Ardo, why did you upload this?
>
> Nico,
>
> Oops! Totally overlooked this one.  Yes, that should never have been uploaded.
>   (For a moment I was afraid I took the wrong version from Sven's website, but
> this is the only version for this fix.)
>
> I also wasn't aware of you being involved in this.
>
> Sven,
>
> This is not good.  Let's never do this again.
>
> Thanks,
> Ardo
>
>
--
Professional Wiki Innovation and Support
Sven Dowideit - <http://DistributedINFORMATION.com>
A WikiRing Partner <http://wikiring.com>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=44), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=44), [link](#43)).

---

**Acknowledgement sent** to `Sven Dowideit <SvenDowideit@home.org.au>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=46), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=46), [link](#45)).

---

[Message #47](#47) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=47), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=47), reply):

![](/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au)
From: Sven Dowideit <SvenDowideit@home.org.au>
To: 444982@bugs.debian.org
Cc: Ardo van Rangelrooij <ardo@ardolabs.com>,
Nico Golde <nion@debian.org>, svenud@ozemail.com.au,
holger@debian.org
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Sun, 21 Oct 2007 19:48:23 +1000
```
ok, following the url..

Nico, you seem to me to be incorrect.

777 is on the working/tmp dir only, which is not used for any web
content. Also, as the twiki cgi scripts are callable from the command
line by any user, requiring the working/tmp dir to be writable by any
user, I can't think of any way that this is fixable?

I guess for me to act on this, I'll need more information from you.
TWiki does have a very painful set of assumptions, which don't map
easily to debian, and as a non-DD, I need much more help than what
you've provided.

Sven

------------------------------------------
-       chmod 777 /tmp/twiki
-       chown $TWIKI_OWNER.www-data /tmp/twiki
+       chmod 777 /var/lib/twiki/working/tmp
+       chown $TWIKI_OWNER.www-data /var/lib/twiki/working/tmp

        #add softlinks to make adding plugins easier ()
        if [ ! -e /var/lib/twiki/lib ]; then

Thanks that you did not sponsor this upload. Why is setting the rights
to 777
done here? This would enable every user on the system to delete web
content
via a symlink attack. The old solution is of course not secure too.
Please fix this.

Kind regards
Nico

On Sun, 2007-10-21 at 19:22 +1000, Sven Dowideit wrote:
> Bizzre,
>
> I don't have any email from Holger, at any time, nor did I search for a
> new sponsor. Ardo has been sponsoring this package for the last few
> years, with Amaya helping me out both with the debian bits, and with
> uploading when things were busy.
>
> so, um, what are you debian people up to?
>
> I also did not receive any information that there was an issue with this
> package, so I guess there's a communications problem somewhere?
>
> anyone want to fill me in?
>
> (yes, I am not a DD, and have little time nor interest in becoming one,
> I'm just trying hard to make twiki easier for people)
>
> Sven
>
> On Sat, 2007-10-20 at 15:06 -0500, Ardo van Rangelrooij wrote:
> > Nico Golde wrote:
> > > Hi,
> > > errm why on earth did you (Sven) search for another sponsor when
> > > Holger was looking into your package but decided not to
> > > upload it because of the changes you made?
> > >
> > > You searched a new sponsor with exactly the same debdiff.
> > >
> > > I am sorry but it looks like this was intentionally because
> > > I Cced you in the mail stating why there is no way for this
> > > package to get uploaded:
> > > <http://lists.alioth.debian.org/pipermail/secure-testing-team/2007-October/001416.html>
> > >
> > > Why did you ignore this, and Ardo, why did you upload this?
> >
> > Nico,
> >
> > Oops! Totally overlooked this one.  Yes, that should never have been uploaded.
> >   (For a moment I was afraid I took the wrong version from Sven's website, but
> > this is the only version for this fix.)
> >
> > I also wasn't aware of you being involved in this.
> >
> > Sven,
> >
> > This is not good.  Let's never do this again.
> >
> > Thanks,
> > Ardo
> >
> >
--
Professional Wiki Innovation and Support
Sven Dowideit - <http://DistributedINFORMATION.com>
A WikiRing Partner <http://wikiring.com>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=49), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=49), [link](#48)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=51), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=51), [link](#50)).

---

[Message #52](#52) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=52), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=52), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Sven Dowideit <SvenDowideit@home.org.au>, 444982@bugs.debian.org
Cc: Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au,
holger@debian.org
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Sun, 21 Oct 2007 12:22:56 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=52) (text/plain, inline)]
```
```
Hi Sven,
* Sven Dowideit <SvenDowideit@home.org.au> [2007-10-21 11:57]:
> Bizzre,
>
> I don't have any email from Holger, at any time, nor did I search for a
> new sponsor. Ardo has been sponsoring this package for the last few
> years, with Amaya helping me out both with the debian bits, and with
> uploading when things were busy.

Oh ok

> so, um, what are you debian people up to?
>
> I also did not receive any information that there was an issue with this
> package, so I guess there's a communications problem somewhere?

I had you, Holger and Amaya in Cc of the mail to the
secure-testing-team list.

> anyone want to fill me in?
>
> (yes, I am not a DD, and have little time nor interest in becoming one,
> I'm just trying hard to make twiki easier for people)

And thats cool!

Ok looks some kind of bad communication so just let's don't
do it again :) Happy packaging.
Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=52) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=54), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=54), [link](#53)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=56), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=56), [link](#55)).

---

[Message #57](#57) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=57), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=57), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Sven Dowideit <SvenDowideit@home.org.au>, 444982@bugs.debian.org
Cc: Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au,
holger@debian.org
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Sun, 21 Oct 2007 12:26:43 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=57) (text/plain, inline)]
```
```
Hi Sven,
* Sven Dowideit <SvenDowideit@home.org.au> [2007-10-21 11:57]:
> ok, following the url..
>
> Nico, you seem to me to be incorrect.
>
> 777 is on the working/tmp dir only, which is not used for any web
> content.

I didn't say this but twiki is using it, no?
Lets assume you put a symlink in there with a name of a tmp
file that has to be written pointing to some web content (I
said web content because apache does not run with root) then
twiki will overwrite the file following the symlink because
the file names of the plugins are predictable.
If this is not the case I wonder why www-data is the group
name.

> Also, as the twiki cgi scripts are callable from the command
> line by any user, requiring the working/tmp dir to be writable by any
> user, I can't think of any way that this is fixable?

Then let them use /tmp but create unique file names using
for example mkstemp.

Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=57) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=59), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=59), [link](#58)).

---

**Acknowledgement sent** to `Olivier Berger <olivier.berger@int-edu.eu>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=61), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=61), [link](#60)).

---

[Message #62](#62) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=62), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=62), reply):

![](/cgi-bin/libravatar.cgi?email=olivier.berger%40int-edu.eu)
From: Olivier Berger <olivier.berger@int-edu.eu>
To: Sven Dowideit <SvenDowideit@home.org.au>, 444982@bugs.debian.org
Cc: Ardo van Rangelrooij <ardo@ardolabs.com>,
Nico Golde <nion@debian.org>,
svenud@ozemail.com.au, holger@debian.org
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure
in default configuration)
Date: Sun, 21 Oct 2007 16:47:35 +0200
```
Sven Dowideit a écrit :
> Bizzre,
>
> I don't have any email from Holger, at any time, nor did I search for a
> new sponsor. Ardo has been sponsoring this package for the last few
> years, with Amaya helping me out both with the debian bits, and with
> uploading when things were busy.
>
> so, um, what are you debian people up to?
>

Maybe the confusion with Nico is my fault.

I've commented
(<http://lists.debian.org/debian-mentors/2007/10/msg00244.html>) on the
recent email to debian-mentors of amaya on my
concerns with the fact that the twiki package would be no longer
sponsored...

I should probably have CC-ed Sven of this message.

I wasn't aware that you had another sponsor for twiki available. The
mail from Amaya made me think this was not the case.

Sorry about that.

P.S.: And... maybe if the twiki sponsor would be willing to sponsor also
packaging for other twiki-related packages (RFS:
<http://lists.debian.org/debian-mentors/2007/10/msg00075.html>) ... ;)

Best regards,

--
Olivier BERGER <olivier.berger@int-edu.eu> - OpenPGP: 6B829EEC
Ingénieur Recherche - Dept INF - INT Evry (<http://www.int-edu.eu>)

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=64), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=64), [link](#63)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=66), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=66), [link](#65)).

---

[Message #67](#67) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=67), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=67), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: control@bugs.debian.org
Cc: 444982@bugs.debian.org
Subject: severity of 444982 is grave
Date: Sun, 21 Oct 2007 23:52:10 +0200
```
# Automatically generated email from bts, devscripts version 2.10.9
# raising severity to prevent the new package to enter testing
severity 444982 grave

```

---

**Severity set to `grave' from `important'**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Sun, 21 Oct 2007 21:54:06 GMT) ([full text](bugreport.cgi?bug=444982;msg=69), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=69), [link](#68)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=71), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=71), [link](#70)).

---

**Acknowledgement sent** to `Sven Dowideit <SvenDowideit@home.org.au>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=73), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=73), [link](#72)).

---

[Message #74](#74) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=74), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=74), reply):

![](/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au)
From: Sven Dowideit <SvenDowideit@home.org.au>
To: Nico Golde <nion@debian.org>
Cc: 444982@bugs.debian.org, Ardo van Rangelrooij <ardo@ardolabs.com>,
svenud@ozemail.com.au, holger@debian.org
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Tue, 23 Oct 2007 17:40:18 +1000
```
I have a few questions:

Whats the difference between

chmod 777 /var/lib/twiki/working/tmp

 and

chmod 777 /tmp/twiki

as that is all it seems to me you're suggesting is the difference
between a CVE raised on a maybe problem that requires a very odd set of
circumstances and what you have labled as a grave error.

The tmp dir is used (mostly from apache, but also from the command line
and cron jobs) for session files and rcs for its very short lived
temporary files.

working/tmp is NOT used for any web data, it is used by rcs (presumably
responsible for its own security) and for session files which have their
own uniqued filename.

and so, I think you are in error, and need to read the code a little
before you make assertions like this.

Sven

On Sun, 2007-10-21 at 12:26 +0200, Nico Golde wrote:
> Hi Sven,
> * Sven Dowideit <SvenDowideit@home.org.au> [2007-10-21 11:57]:
> > ok, following the url..
> >
> > Nico, you seem to me to be incorrect.
> >
> > 777 is on the working/tmp dir only, which is not used for any web
> > content.
>
> I didn't say this but twiki is using it, no?
> Lets assume you put a symlink in there with a name of a tmp
> file that has to be written pointing to some web content (I
> said web content because apache does not run with root) then
> twiki will overwrite the file following the symlink because
> the file names of the plugins are predictable.
> If this is not the case I wonder why www-data is the group
> name.
>
> > Also, as the twiki cgi scripts are callable from the command
> > line by any user, requiring the working/tmp dir to be writable by any
> > user, I can't think of any way that this is fixable?
>
> Then let them use /tmp but create unique file names using
> for example mkstemp.
>
> Kind regards
> Nico
--
Professional Wiki Innovation and Support
Sven Dowideit - <http://DistributedINFORMATION.com>
A WikiRing Partner <http://wikiring.com>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=76), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=76), [link](#75)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=78), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=78), [link](#77)).

---

[Message #79](#79) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=79), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=79), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Sven Dowideit <SvenDowideit@home.org.au>, 444982@bugs.debian.org
Cc: Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au,
holger@debian.org
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Tue, 23 Oct 2007 10:51:49 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=79) (text/plain, inline)]
```
```
Hi Sven,
* Sven Dowideit <SvenDowideit@home.org.au> [2007-10-23 10:37]:
> I have a few questions:
>
> Whats the difference between
>
> chmod 777 /var/lib/twiki/working/tmp
>
>  and
>
> chmod 777 /tmp/twiki

Can you please read the mail I wrote and Cced you in?
I remember I wrote  "The old solution is of course not
secure too."

> as that is all it seems to me you're suggesting is the difference
> between a CVE raised on a maybe problem that requires a very odd set of
> circumstances and what you have labled as a grave error.
>
> The tmp dir is used (mostly from apache, but also from the command line
> and cron jobs) for session files and rcs for its very short lived
> temporary files.
>
> working/tmp is NOT used for any web data, it is used by rcs (presumably
> responsible for its own security) and for session files which have their
> own uniqued filename.

NOONE SAID THERE IS ANY WEBCONTENT STORED IN THERE, CAN YOU
PLEASE JUST READ UP WHAT A SYMLINK ATTACK IS? THANKS!

> and so, I think you are in error, and need to read the code a little
> before you make assertions like this.

Are you going to tell me that this directory in which every
user can write is *not* used by any process running with
different priviledges than with the user ones? If yes, you
are right, if not you are not, simple as is. And I don't
make any assertions, I just saw that you set insecure file
permissions /var and there is no reason to, look at your own
/var, not more not less.

This is the last mail from my side as long as you ignore
what I wrote in previous mails.

Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=79) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=81), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=81), [link](#80)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=83), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=83), [link](#82)).

---

[Message #84](#84) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=84), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=84), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Sven Dowideit <SvenDowideit@home.org.au>, 444982@bugs.debian.org
Cc: Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au,
holger@debian.org
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Tue, 23 Oct 2007 11:04:36 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=84) (text/plain, inline)]
```
```
Hi Sven,
btw about the insecure permissions, here you have the next
thing:
[nion@noname:~$] ls -l /var/lib/twiki/data/.htpasswd
-rw-rw-r-- 1 www-data www-data 25 2007-10-23 10:56 /var/lib/twiki/data/.htpasswd

I guess this is also not intended.
Kind regards
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=84) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=86), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=86), [link](#85)).

---

**Acknowledgement sent** to `Holger Levsen <holger@layer-acht.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=88), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=88), [link](#87)).

---

[Message #89](#89) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=89), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=89), reply):

![](/cgi-bin/libravatar.cgi?email=holger%40layer-acht.org)
From: Holger Levsen <holger@layer-acht.org>
To: Nico Golde <nion@debian.org>,
Sven Dowideit <SvenDowideit@home.org.au>, 444982@bugs.debian.org,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Tue, 23 Oct 2007 11:34:44 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=89) (text/plain, inline)]
```
```
Nico,

On Tuesday 23 October 2007 10:51, you wrote:
> NOONE SAID THERE IS ANY WEBCONTENT STORED IN THERE, CAN YOU
> PLEASE JUST READ UP WHAT A SYMLINK ATTACK IS? THANKS!
>
> This is the last mail from my side as long as you ignore
> what I wrote in previous mails.

I understand your frustration (that so many packages have the same security
problems over and over again), but there is no need to yell at someone.

As I see it, Sven is perfectly willing and able to fix issues in his code, it
just seems to me, that he doesnt understand symlink attacks, probably because
he never heard about them. The solution to make him understand this, is not
to yell at him and stop explaining, but rather continue explaining in a
friendly way.

Sven, please ignore Nicos tone and have a look at
<http://en.wikipedia.org/wiki/Symlink_race> :-)

Thanks & regards & happy hacking,
	Holger

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=89) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=91), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=91), [link](#90)).

---

**Acknowledgement sent** to `Sven Dowideit <SvenDowideit@home.org.au>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=93), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=93), [link](#92)).

---

[Message #94](#94) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=94), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=94), reply):

![](/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au)
From: Sven Dowideit <SvenDowideit@home.org.au>
To: Holger Levsen <holger@layer-acht.org>
Cc: Nico Golde <nion@debian.org>, 444982@bugs.debian.org,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Tue, 23 Oct 2007 21:28:40 +1000
```
mmm, following the link makes me even less convinced that there is a
problem.

the working/tmp dir is used for rcs tmp files, and twiki session files,
both of which use randomised unique filenames.

as the Wikipedia page suggests that the problem is avoided by using
randomised filenames, we seem to be done?

Nico, If i were ignoring what you wrote, I would not be replying. I have
unfortunately found nothing so far to make me understand that there in
fact is a problem. Evey extra detail you guys are giving me, is
reinforcing this opinion

As Holger points out, I am a part time packager (over debian, osx,
windows, rpm, and soon to be Solaris and maybe a few more), so I'm
looking to understand, not just to blindly agree to whatever you say.

Sven

On Tue, 2007-10-23 at 11:34 +0200, Holger Levsen wrote:
> Nico,
>
> On Tuesday 23 October 2007 10:51, you wrote:
> > NOONE SAID THERE IS ANY WEBCONTENT STORED IN THERE, CAN YOU
> > PLEASE JUST READ UP WHAT A SYMLINK ATTACK IS? THANKS!
> >
> > This is the last mail from my side as long as you ignore
> > what I wrote in previous mails.
>
> I understand your frustration (that so many packages have the same security
> problems over and over again), but there is no need to yell at someone.
>
> As I see it, Sven is perfectly willing and able to fix issues in his code, it
> just seems to me, that he doesnt understand symlink attacks, probably because
> he never heard about them. The solution to make him understand this, is not
> to yell at him and stop explaining, but rather continue explaining in a
> friendly way.
>
> Sven, please ignore Nicos tone and have a look at
> <http://en.wikipedia.org/wiki/Symlink_race> :-)
>
>
> Thanks & regards & happy hacking,
> 	Holger
--
Professional Wiki Innovation and Support
Sven Dowideit - <http://DistributedINFORMATION.com>
A WikiRing Partner <http://wikiring.com>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=96), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=96), [link](#95)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=98), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=98), [link](#97)).

---

[Message #99](#99) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=99), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=99), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Sven Dowideit <SvenDowideit@home.org.au>, 444982@bugs.debian.org
Cc: Holger Levsen <holger@layer-acht.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Tue, 23 Oct 2007 16:25:07 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=99) (text/plain, inline)]
```
```
Hi Sven,
ok trying again in a friendly way.
* Sven Dowideit <SvenDowideit@home.org.au> [2007-10-23 15:10]:
> mmm, following the link makes me even less convinced that there is a
> problem.
>
> the working/tmp dir is used for rcs tmp files, and twiki session files,
> both of which use randomised unique filenames.
>
> as the Wikipedia page suggests that the problem is avoided by using
> randomised filenames, we seem to be done?

Yes that is true however I never read twikis source code so
I just said that if this is just used for temporary files
that this would introduce a symlink attack. Of course this
is not the case if the names are really random, I am sorry
since I assumed you know what a symlink attack is and state
whether this is the case or not. So if the names are random
(and not like adding a process id to them) there is no
problem with this attack.

However there is also another
problem, since server installations often use partitions and
having a user controllable directory under /var would end up
enabling every user to fill the /var partition and thus
causing a denial of service for every other daemon running
on the system because they are not able to write log files
anymore.

> Nico, If i were ignoring what you wrote, I would not be replying.

Well that's unclear to me and really one of the reasons why
I was so pissed, since you for example wrote that there is
no web content stored in this directory while I never wrote
that there is... Anyway, let's forget this.

> I have
> unfortunately found nothing so far to make me understand that there in
> fact is a problem. Evey extra detail you guys are giving me, is
> reinforcing this opinion

Please consider the second situation I wrote above.

> As Holger points out, I am a part time packager (over debian, osx,
> windows, rpm, and soon to be Solaris and maybe a few more), so I'm
> looking to understand, not just to blindly agree to whatever you say.

;) That was never any attention, the opposite was the case,
I saw that this is world-read-writable, didn't read twikis
code, saw no intention to have 777 there, thats why I asked
" Why is setting the rights to 777 done here?". So I hoped that you
are able to judge if the is the case here but I wanted to
prevent to blindly upload this.

Kind regards
Nico
P.S. There is really nothing personal with you, it looks
like a bad example for a communication problem here.
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=99) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=101), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=101), [link](#100)).

---

**Acknowledgement sent** to `Joey Hess <joeyh@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=103), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=103), [link](#102)).

---

[Message #104](#104) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=104), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=104), reply):

![](/cgi-bin/libravatar.cgi?email=joeyh%40debian.org)
From: Joey Hess <joeyh@debian.org>
To: Holger Levsen <holger@layer-acht.org>, 444982@bugs.debian.org
Cc: Nico Golde <nion@debian.org>, Sven Dowideit <SvenDowideit@home.org.au>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Tue, 23 Oct 2007 16:14:08 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=104) (text/plain, inline)]
```
```
Holger Levsen wrote:
> Sven, please ignore Nicos tone and have a look at
> <http://en.wikipedia.org/wiki/Symlink_race> :-)

I would not recommend considering this wikipedia page an authoratitive
reference for what can and cannot be used for symlink attacks.

In particular, chosing a random filename and otherwise still writing to
the file insecurely does not solve a symlink attack security hole, it
just makes it N times more difficult for an attacker to successfully
perform the attack. Where N is an arbitrary measure of how hard it is to
guess the filename. For example, if I choose a random filename /tmp/foo.X, N
is approximately 62 (a-z, A-Z, 0-9). A more typical /tmp/foo.XXXXXX
obviously has a much higher value of N, but if the attack can be
performed frequently enough or for a long enough time period, the hole
is still possible to exploit.

It's much simpler and better to simply use security best practices that
avoid such attacks alltogether. For example, make sure that temp files
are opened with O_EXCL and symlink attacks become impossible.

Never using mode 777 directories, and at least using +t on shared
temporary directories such as /tmp is another such best practice that
avoids a whole class of security problems.

--
see shy jo

```
```
[[signature.asc](bugreport.cgi?att=1;bug=444982;filename=signature.asc;msg=104) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=106), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=106), [link](#105)).

---

**Acknowledgement sent** to `Joey Hess <joeyh@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=108), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=108), [link](#107)).

---

[Message #109](#109) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=109), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=109), reply):

![](/cgi-bin/libravatar.cgi?email=joeyh%40debian.org)
From: Joey Hess <joeyh@debian.org>
To: Sven Dowideit <SvenDowideit@home.org.au>, 444982@bugs.debian.org
Cc: Holger Levsen <holger@layer-acht.org>, Nico Golde <nion@debian.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Tue, 23 Oct 2007 16:45:09 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=109) (text/plain, inline)]
```
```
Sven Dowideit wrote:
> the working/tmp dir is used for rcs tmp files, and twiki session files,
> both of which use randomised unique filenames.

rcs opens its temp files with O_EXCL, so I don't think it will be vulnerable
to symlink attacks.

In twiki 4.1.2, I quickly found some temp file problems.

./lib/TWiki/Client.pm:        open( IPMAP, '>', $TWiki::cfg{TempfileDir}.'/ip2sid') ||

Trivial to exploit if you can write to $TWiki::cfg{TempfileDir}.

./lib/TWiki.pm:    my $passthruFilename = $TWiki::cfg{TempfileDir} . '/passthru_' . $uid;
./lib/TWiki.pm:    open(F, ">$passthruFilename") || die "{TempfileDir} cache not writable $!";

This $uid md5sum would be hard to guess. I still don't consider this
code fully secure from temp file attacks since it does not use O_EXCL.

I have not done a complete audit. Writing temp files to a 777 directory
scares me. What if another user deletes the temp file (since the directory
is not +t, anyone can)? What if a user deletes a temp file and replaces
the data in it with other data, which is then read back in? (For example,
the passthru_ file above is later read back in by another instance of twiki.)
Could a buffer overflow, malicious data, or incorrect data be substituted in
this way and used to attack twiki or rcs? Rather than trying to answer these
questions, I'd recommend tightening the temp directory permissions.

--
see shy jo

```
```
[[signature.asc](bugreport.cgi?att=1;bug=444982;filename=signature.asc;msg=109) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=111), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=111), [link](#110)).

---

**Acknowledgement sent** to `Sven Dowideit <SvenDowideit@home.org.au>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=113), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=113), [link](#112)).

---

[Message #114](#114) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=114), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=114), reply):

![](/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au)
From: Sven Dowideit <SvenDowideit@home.org.au>
To: Joey Hess <joeyh@debian.org>
Cc: 444982@bugs.debian.org, Holger Levsen <holger@layer-acht.org>,
Nico Golde <nion@debian.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Wed, 24 Oct 2007 08:16:13 +1000
```
neat summary Joey :)

The reason that I made it world writeable, is that twiki cgi's can be
run from the command line by anyone, and in doing so, create a session
file.

This is used by cronjobs, and so that users can script additions to
topics etc.

Basically, like much of the rest of TWiki, its security is a crock :(

Do you have any suggestions (other than re-writing TWiki?) or should I
just disable that funcionality and run away?

Sven

On Tue, 2007-10-23 at 16:45 -0400, Joey Hess wrote:
> Sven Dowideit wrote:
> > the working/tmp dir is used for rcs tmp files, and twiki session files,
> > both of which use randomised unique filenames.
>
> rcs opens its temp files with O_EXCL, so I don't think it will be vulnerable
> to symlink attacks.
>
> In twiki 4.1.2, I quickly found some temp file problems.
>
> ./lib/TWiki/Client.pm:        open( IPMAP, '>', $TWiki::cfg{TempfileDir}.'/ip2sid') ||
>
> Trivial to exploit if you can write to $TWiki::cfg{TempfileDir}.
>
> ./lib/TWiki.pm:    my $passthruFilename = $TWiki::cfg{TempfileDir} . '/passthru_' . $uid;
> ./lib/TWiki.pm:    open(F, ">$passthruFilename") || die "{TempfileDir} cache not writable $!";
>
> This $uid md5sum would be hard to guess. I still don't consider this
> code fully secure from temp file attacks since it does not use O_EXCL.
>
>
> I have not done a complete audit. Writing temp files to a 777 directory
> scares me. What if another user deletes the temp file (since the directory
> is not +t, anyone can)? What if a user deletes a temp file and replaces
> the data in it with other data, which is then read back in? (For example,
> the passthru_ file above is later read back in by another instance of twiki.)
> Could a buffer overflow, malicious data, or incorrect data be substituted in
> this way and used to attack twiki or rcs? Rather than trying to answer these
> questions, I'd recommend tightening the temp directory permissions.
>
--
Professional Wiki Innovation and Support
Sven Dowideit - <http://DistributedINFORMATION.com>
A WikiRing Partner <http://wikiring.com>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=116), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=116), [link](#115)).

---

**Acknowledgement sent** to `Joey Hess <joeyh@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=118), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=118), [link](#117)).

---

[Message #119](#119) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=119), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=119), reply):

![](/cgi-bin/libravatar.cgi?email=joeyh%40debian.org)
From: Joey Hess <joeyh@debian.org>
To: Sven Dowideit <SvenDowideit@home.org.au>
Cc: 444982@bugs.debian.org, Holger Levsen <holger@layer-acht.org>,
Nico Golde <nion@debian.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Tue, 23 Oct 2007 20:00:51 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=119) (text/plain, inline)]
```
```
Sven Dowideit wrote:
> neat summary Joey :)
>
> The reason that I made it world writeable, is that twiki cgi's can be
> run from the command line by anyone, and in doing so, create a session
> file.
>
> This is used by cronjobs, and so that users can script additions to
> topics etc.

Makeing the temporary directory mode 1777 would not prevent that, but
would prevent users from deleting and replacing twiki temp files.

That and making the opens use O_EXCL, would cover the security issues I
mentioned.

--
see shy jo

```
```
[[signature.asc](bugreport.cgi?att=1;bug=444982;filename=signature.asc;msg=119) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=121), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=121), [link](#120)).

---

**Acknowledgement sent** to `Sven Dowideit <SvenDowideit@home.org.au>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=123), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=123), [link](#122)).

---

[Message #124](#124) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=124), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=124), reply):

![](/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au)
From: Sven Dowideit <SvenDowideit@home.org.au>
To: Joey Hess <joeyh@debian.org>
Cc: 444982@bugs.debian.org, Holger Levsen <holger@layer-acht.org>,
Nico Golde <nion@debian.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Fri, 26 Oct 2007 16:57:12 +1000
```
ok, I'll implement this on the w/e, and push it into the upcoming 4.2
release. Thankyou Joey, as usual you've helped us unsafe bumbles again.

Sven

On Tue, 2007-10-23 at 20:00 -0400, Joey Hess wrote:
> Sven Dowideit wrote:
> > neat summary Joey :)
> >
> > The reason that I made it world writeable, is that twiki cgi's can be
> > run from the command line by anyone, and in doing so, create a session
> > file.
> >
> > This is used by cronjobs, and so that users can script additions to
> > topics etc.
>
> Makeing the temporary directory mode 1777 would not prevent that, but
> would prevent users from deleting and replacing twiki temp files.
>
> That and making the opens use O_EXCL, would cover the security issues I
> mentioned.
>
--
Professional Wiki Innovation and Support
Sven Dowideit - <http://DistributedINFORMATION.com>
A WikiRing Partner <http://wikiring.com>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=126), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=126), [link](#125)).

---

**Acknowledgement sent** to `Holger Levsen <holger@layer-acht.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=128), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=128), [link](#127)).

---

[Message #129](#129) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=129), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=129), reply):

![](/cgi-bin/libravatar.cgi?email=holger%40layer-acht.org)
From: Holger Levsen <holger@layer-acht.org>
To: Joey Hess <joeyh@debian.org>, 444982@bugs.debian.org,
Nico Golde <nion@debian.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Fri, 26 Oct 2007 12:30:19 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=129) (text/plain, inline)]
```
```
Hi,

On Tuesday 23 October 2007 22:14, Joey wrote:
> I would not recommend considering this wikipedia page an authoratitive
> reference for what can and cannot be used for symlink attacks.

Right.

Nonetheless I found it useful to quickly point out the problem, even if the
solution is not optimal.

> It's much simpler and better to simply use security best practices that
> avoid such attacks alltogether. For example, make sure that temp files
> are opened with O_EXCL and symlink attacks become impossible.
>
> Never using mode 777 directories, and at least using +t on shared
> temporary directories such as /tmp is another such best practice that
> avoids a whole class of security problems.

Does the (testing) security team have a comprehensive page with security best
and worst practices? To be able to point people at it, so one doesnt have to
point at "random" wikipedia pages or google hits?

regards,
	Holger

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=129) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=131), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=131), [link](#130)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=133), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=133), [link](#132)).

---

[Message #134](#134) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=134), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=134), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Holger Levsen <holger@layer-acht.org>, 444982@bugs.debian.org
Cc: Joey Hess <joeyh@debian.org>, Ardo van Rangelrooij <ardo@ardolabs.com>
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Fri, 26 Oct 2007 14:28:28 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=134) (text/plain, inline)]
```
```
Hi Holger,
* Holger Levsen <holger@layer-acht.org> [2007-10-26 13:54]:
> On Tuesday 23 October 2007 22:14, Joey wrote:
> > I would not recommend considering this wikipedia page an authoratitive
> > reference for what can and cannot be used for symlink attacks.
[...]
> Does the (testing) security team have a comprehensive page with security best
> and worst practices? To be able to point people at it, so one doesnt have to
> point at "random" wikipedia pages or google hits?

No, but I can recommend
[https://www.securecoding.cert.org/confluence/display/seccode/CERT+C+Programming+Language+Secure+Coding+Standard](https://www.securecoding.cert.org/confluence/display/seccode/CERT%2BC%2BProgramming%2BLanguage%2BSecure%2BCoding%2BStandard)
for some secure coding notes regarding the c language.
Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=134) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=136), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=136), [link](#135)).

---

**Acknowledgement sent** to `"era eriksson" <era@iki.fi>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=138), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=138), [link](#137)).

---

[Message #139](#139) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=139), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=139), reply):

![](/cgi-bin/libravatar.cgi?email=era%40iki.fi)
From: "era eriksson" <era@iki.fi>
To: 444982@bugs.debian.org
Subject: Secure coding guidelines
Date: Fri, 26 Oct 2007 21:48:25 +0300
```
On Fri, 26 Oct 2007 14:28:28 +0200, Nico Golde <nion@debian.org> wrote:
> > Does the (testing) security team have a comprehensive page with
> > security best and worst practices? To be able to point people at it,
> > so one [doesn't] have to point at "random" wikipedia pages or google
> > hits?
>
> No, but I can recommend [<[http://tinyurl.com/2sennu>]](http://tinyurl.com/2sennu%3E%5D)
> for some secure coding notes regarding the c language.

... which is huge and complex, and still not by any measure
"comprehensive".  This should tell you something about the reason
security problems aren't all that rare, and give you some idea why the
idea of a simple checklist usually cannot replace the one cure security
researchers have tried unsuccessfully now for many years: proper
education (while the other approach, architectures and designs which
leave less room for error, is in principle good, but very slow to pick
up steam, for somewhat obvious reasons).

Having said that, if you want checklist-type stuff, Lincoln D. Stein's
Web Security FAQ <<http://www.w3.org/Security/Faq/>> certainly ought to be
on the required reading list.

More generally, google for "secure CGI" and don't stop reading.  There
should be about 9,830,000 documents in the result set.

Hope this helps (-:

/* era */

--
If this were a real .signature, it would suck less.  Well, maybe not.

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=141), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=141), [link](#140)).

---

**Acknowledgement sent** to `"era eriksson" <era@iki.fi>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.

Your message did not contain a Subject field. They are recommended and
useful because the title of a Bug is determined using this field.
Please remember to include a Subject field in your messages in future.

([full text](bugreport.cgi?bug=444982;msg=143), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=143), [link](#142)).

---

[Message #144](#144) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=144), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=144), reply):

![](/cgi-bin/libravatar.cgi?email=era%40iki.fi)
From: "era eriksson" <era@iki.fi>
To: 444982@bugs.debian.org
Date: Fri, 26 Oct 2007 23:48:03 +0300
```
On Sun, 21 Oct 2007 19:48:23 +1000, Sven Dowideit
<SvenDowideit@home.org.au> wrote:
> 777 is on the working/tmp dir only, which is not used for any web
> content. Also, as the twiki cgi scripts are callable from the command
> line by any user, requiring the working/tmp dir to be writable by any
> user, I can't think of any way that this is fixable?

Longer term, how about improving the architecture by adding an API to
twiki itself?  As a twiki user, I have been longing desperately for
something like that for a long time, and that would help solve this
problem, too.

> TWiki does have a very painful set of assumptions, which don't map
> easily to debian

To some extent, it would fix this as well, I guess.

/* era */

PS. Some more secure CGI links for you: <<http://tinyurl.com/37tbz5>>
(brian d foy's CGI Meta FAQ) and from there in particular Simson
Garfinkel's <<http://thinkunix.net/web/cgi-rules.txt>> checklist.

--
If this were a real .signature, it would suck less.  Well, maybe not.

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=146), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=146), [link](#145)).

---

**Acknowledgement sent** to `Sven Dowideit <SvenDowideit@home.org.au>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=148), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=148), [link](#147)).

---

[Message #149](#149) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=149), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=149), reply):

![](/cgi-bin/libravatar.cgi?email=SvenDowideit%40home.org.au)
From: Sven Dowideit <SvenDowideit@home.org.au>
To: Joey Hess <joeyh@debian.org>
Cc: 444982@bugs.debian.org, Holger Levsen <holger@layer-acht.org>,
Nico Golde <nion@debian.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Mon, 29 Oct 2007 16:27:19 +1100
```
righto,

I've uploaded a new version to
<http://distributedinformation.com/TWikiDebian/> (twiki_4.1.2-3_all.deb)

   * secure /var/www/twiki/pub/_work_areas (Closes: #[444982](bugreport.cgi?bug=444982))
     [CVE-2007-5193](https://security-tracker.debian.org/tracker/CVE-2007-5193)
   * session files in /tmp/twiki, and add O_EXCL to files that go there
   * updated Vietnamese translation (Closes: #[426850](bugreport.cgi?bug=426850))
   * don't modify files that are not installed (Closes: #[444498](bugreport.cgi?bug=444498))

I've implemented Joey's suggestion of 1777 & O_EXCL - mostly the files in tmp are written by CGI::Session, that takes care of things.

I also moved the 1777 tmp dir back to /tmp/twiki, as per Nico's point wrt to filling /var

and fixed a few other bitzers

I've reported the issue upstream so we can look at doing a more lasting change for the next release.

Sven

On Fri, 2007-10-26 at 16:57 +1000, Sven Dowideit wrote:
> ok, I'll implement this on the w/e, and push it into the upcoming 4.2
> release. Thankyou Joey, as usual you've helped us unsafe bumbles again.
>
> Sven
>
> On Tue, 2007-10-23 at 20:00 -0400, Joey Hess wrote:
> > Sven Dowideit wrote:
> > > neat summary Joey :)
> > >
> > > The reason that I made it world writeable, is that twiki cgi's can be
> > > run from the command line by anyone, and in doing so, create a session
> > > file.
> > >
> > > This is used by cronjobs, and so that users can script additions to
> > > topics etc.
> >
> > Makeing the temporary directory mode 1777 would not prevent that, but
> > would prevent users from deleting and replacing twiki temp files.
> >
> > That and making the opens use O_EXCL, would cover the security issues I
> > mentioned.
> >
--
Professional Wiki Innovation and Support
Sven Dowideit - <http://DistributedINFORMATION.com>
A WikiRing Partner <http://wikiring.com>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=151), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=151), [link](#150)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=153), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=153), [link](#152)).

---

[Message #154](#154) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=154), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=154), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Sven Dowideit <SvenDowideit@home.org.au>
Cc: Joey Hess <joeyh@debian.org>, 444982@bugs.debian.org,
Holger Levsen <holger@layer-acht.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Mon, 29 Oct 2007 09:05:18 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=154) (text/plain, inline)]
```
```
Hi Sven,
* Sven Dowideit <SvenDowideit@home.org.au> [2007-10-29 08:34]:
> I've uploaded a new version to
> <http://distributedinformation.com/TWikiDebian/> (twiki_4.1.2-3_all.deb)
>
>
>    * secure /var/www/twiki/pub/_work_areas (Closes: #[444982](bugreport.cgi?bug=444982))
>      [CVE-2007-5193](https://security-tracker.debian.org/tracker/CVE-2007-5193)
>    * session files in /tmp/twiki, and add O_EXCL to files that go there
>    * updated Vietnamese translation (Closes: #[426850](bugreport.cgi?bug=426850))
>    * don't modify files that are not installed (Closes: #[444498](bugreport.cgi?bug=444498))
>
>
> I've implemented Joey's suggestion of 1777 & O_EXCL - mostly the files in tmp are written by CGI::Session, that takes care of things.
>
> I also moved the 1777 tmp dir back to /tmp/twiki, as per Nico's point wrt to filling /var
>
> and fixed a few other bitzers
>
> I've reported the issue upstream so we can look at doing a more lasting change for the next release.
[...]
I just looked at the debdiff, way better! I think if I
didn't miss something and noone
else complains about something this can be uploaded!
Thanks for working on this.
Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=154) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=156), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=156), [link](#155)).

---

**Acknowledgement sent** to `Amaya <amaya@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=158), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=158), [link](#157)).

---

[Message #159](#159) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=159), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=159), reply):

![](/cgi-bin/libravatar.cgi?email=amaya%40debian.org)
From: Amaya <amaya@debian.org>
To: Sven Dowideit <SvenDowideit@home.org.au>, 444982@bugs.debian.org
Cc: Joey Hess <joeyh@debian.org>, Holger Levsen <holger@layer-acht.org>,
Nico Golde <nion@debian.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Mon, 29 Oct 2007 10:25:15 +0100
```
Sven Dowideit wrote:
> I've uploaded a new version to
> <http://distributedinformation.com/TWikiDebian/> (twiki_4.1.2-3_all.deb)

Please remove me from uploaders.

--
  ·''`.             If I can't dance to it, it's not my revolution
 : :' :                                            -- Emma Goldman
 `. `'           Proudly running Debian GNU/Linux (unstable)
   `-     www.amayita.com  www.malapecora.com  www.chicasduras.com

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=161), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=161), [link](#160)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=163), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=163), [link](#162)).

---

[Message #164](#164) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=164), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=164), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Amaya <amaya@debian.org>, 444982@bugs.debian.org
Cc: Sven Dowideit <SvenDowideit@home.org.au>,
Holger Levsen <holger@layer-acht.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information disclosure in default configuration)
Date: Tue, 30 Oct 2007 16:25:17 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=444982;msg=164) (text/plain, inline)]
```
```
Hi Amaya,
* Amaya <amaya@debian.org> [2007-10-29 10:40]:
> Sven Dowideit wrote:
> > I've uploaded a new version to
> > <http://distributedinformation.com/TWikiDebian/> (twiki_4.1.2-3_all.deb)
>
> Please remove me from uploaders.

I am going to sponsor the twiki upload now.
Sven, no need to make a new source package for it, I just
remove Amaya from Uploaders before the build but please keep
track on it in future versions then.
Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=444982;msg=164) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Sven Dowideit <svenud@ozemail.com.au>`:

`Bug#444982`; Package `twiki`.
([full text](bugreport.cgi?bug=444982;msg=166), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=166), [link](#165)).

---

**Acknowledgement sent** to `Amaya <amaya@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Sven Dowideit <svenud@ozemail.com.au>`.
([full text](bugreport.cgi?bug=444982;msg=168), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=168), [link](#167)).

---

[Message #169](#169) received at 444982@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=169), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=169), reply):

![](/cgi-bin/libravatar.cgi?email=amaya%40debian.org)
From: Amaya <amaya@debian.org>
To: Nico Golde <nion@debian.org>
Cc: 444982@bugs.debian.org, Sven Dowideit <SvenDowideit@home.org.au>,
Holger Levsen <holger@layer-acht.org>,
Ardo van Rangelrooij <ardo@ardolabs.com>, svenud@ozemail.com.au
Subject: Re: Bug#444982: marked as done (CVE-2007-5193 information
disclosure in default configuration)
Date: Tue, 30 Oct 2007 16:37:31 +0100
```
Nico Golde wrote:
> I just remove Amaya from Uploaders before the build

thx!

> but please keep track on it in future versions then.

I am subscribed to the pts.

Happy sponsoring!

--
  ·''`.             If I can't dance to it, it's not my revolution
 : :' :                                            -- Emma Goldman
 `. `'           Proudly running Debian GNU/Linux (unstable)
   `-     www.amayita.com  www.malapecora.com  www.chicasduras.com

```

---

**Reply sent** to `Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=444982;msg=171), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=171), [link](#170)).

---

**Notification sent** to `Olivier Berger <olivier.berger@int-edu.eu>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=444982;msg=173), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=173), [link](#172)).

---

[Message #174](#174) received at 444982-close@bugs.debian.org ([full text](bugreport.cgi?bug=444982;msg=174), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=174), reply):

![](/cgi-bin/libravatar.cgi?email=SvenDowideit%40DistributedINFORMATION.com)
From: Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>
To: 444982-close@bugs.debian.org
Subject: Bug#444982: fixed in twiki 1:4.1.2-3
Date: Tue, 30 Oct 2007 16:02:03 +0000
```
Source: twiki
Source-Version: 1:4.1.2-3

We believe that the bug you reported is fixed in the latest version of
twiki, which is due to be installed in the Debian FTP archive:

twiki_4.1.2-3.diff.gz
  to pool/main/t/twiki/twiki_4.1.2-3.diff.gz
twiki_4.1.2-3.dsc
  to pool/main/t/twiki/twiki_4.1.2-3.dsc
twiki_4.1.2-3_all.deb
  to pool/main/t/twiki/twiki_4.1.2-3_all.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 444982@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Sven Dowideit <SvenDowideit@DistributedINFORMATION.com> (supplier of updated twiki package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Mon, 29 Oct 2007 09:53:40 +0100
Source: twiki
Binary: twiki
Architecture: source all
Version: 1:4.1.2-3
Distribution: unstable
Urgency: high
Maintainer: Sven Dowideit <svenud@ozemail.com.au>
Changed-By: Sven Dowideit <SvenDowideit@DistributedINFORMATION.com>
Description:
 twiki      - A Web Based Collaboration Platform
Closes: [426850](bugreport.cgi?bug=426850) [444498](bugreport.cgi?bug=444498) [444982](bugreport.cgi?bug=444982)
Changes:
 twiki (1:4.1.2-3) unstable; urgency=high
 .
   * secure /var/www/twiki/pub/_work_areas (Closes: #[444982](bugreport.cgi?bug=444982))
     [CVE-2007-5193](https://security-tracker.debian.org/tracker/CVE-2007-5193)
   * session files in /tmp/twiki, and add O_EXCL to files that go there
   * updated Vietnamese translation (Closes: #[426850](bugreport.cgi?bug=426850))
   * don't modify files that are not installed (Closes: #[444498](bugreport.cgi?bug=444498))
Files:
 9423004112178529f0ffc7f1c8a65f63 584 web optional twiki_4.1.2-3.dsc
 18ae3c838e2cbce1c273a33fc77b4cf5 42757 web optional twiki_4.1.2-3.diff.gz
 e94d70f89fb24130baf328be7713b1b2 4678106 web optional twiki_4.1.2-3_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFHJ1FQHYflSXNkfP8RArUfAJ0bglKUoDOpFIWYBZvg8dCal5K50gCfSDlO
KgsCk+kIByHtEYV0kBw0ai4=
=s+F0
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Thu, 29 Nov 2007 07:28:49 GMT) ([full text](bugreport.cgi?bug=444982;msg=176), [mbox](bugreport.cgi?bug=444982;mbox=yes;msg=176), [link](#175)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=444982).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 21:42:21 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


