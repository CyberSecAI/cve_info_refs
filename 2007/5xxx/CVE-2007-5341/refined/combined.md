=== Content from bugzilla.mozilla.org_42caf9fe_20250125_225759.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/345305)
* [XML](/show_bug.cgi?ctype=xml&id=345305)

Closed
[Bug 345305](/show_bug.cgi?id=345305)

Opened 19 years ago
Closed 17 years ago

# Arbitrary code execution with Venkman JavaScript Debugger

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Arbitrary code execution with Venkman JavaScript Debugger

## Categories

### (Other Applications Graveyard :: Venkman JS Debugger, defect)

[Product:](/describecomponents.cgi?product=Other%20Applications%20Graveyard)

Other Applications Graveyard
▾

Other Applications Graveyard
Old, retired Other Applications components
[See Open Bugs in This Product](/buglist.cgi?product=Other%20Applications%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Other%20Applications%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Other%20Applications%20Graveyard&component=Venkman%20JS%20Debugger#Venkman%20JS%20Debugger)

Venkman JS Debugger
▾

Other Applications Graveyard :: Venkman JS Debugger
Bugs, problems, enhancements for the Venkman JavaScript Debugger tool.
[See Open Bugs in This Component](/buglist.cgi?product=Other%20Applications%20Graveyard&component=Venkman%20JS%20Debugger&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Other%20Applications%20Graveyard&component=Venkman%20JS%20Debugger&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Other%20Applications%20Graveyard&component=Venkman%20JS%20Debugger)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |

## People

### (Reporter: moz\_bug\_r\_a4, Assigned: bugzilla-mozilla-20000923)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/7cf6149cb971b70921f45b6d7c26781b?d=mm&size=40)  [bugzilla-mozilla-20000923](/user_profile?user_id=18057)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9977bfa30af6394fdac2ad76abd078bd?d=mm&size=40)  [caillon](/user_profile?user_id=32335)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/5de37f4deb4e2ac039d463d504c60ba6?d=mm&size=40)  [moz\_bug\_r\_a4](/user_profile?user_id=194398)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[344495](/show_bug.cgi?id=344495 "VERIFIED FIXED - XSS against certain sites that are using scripts that access properties of top, parent or opener")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=345305&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=345305)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: fixed1.8.0.15, fixed1.8.1.8, Whiteboard: [sg:moderate] critical on debugged pages [vnk-0.9.88])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[fixed1.8.0.15](/buglist.cgi?keywords=fixed1.8.0.15&resolution=---),
[fixed1.8.1.8](/buglist.cgi?keywords=fixed1.8.1.8&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:moderate] critical on debugged pages [vnk-0.9.88]

Change Request:

---

Bug Flags:

| [mtschrep](/user_profile?user_id=210162) | [blocking1.8.1](#c0 "19 years ago") | - |
| --- | --- | --- |
| [mtschrep](/user_profile?user_id=210162) | blocking1.8.1 | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [blocking1.8.1.1](#c17 "18 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.8.1.1 | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [wanted1.8.1.x](#c19 "18 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | wanted1.8.1.x | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [blocking1.8.0.7](#c0 "19 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.8.0.7 | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [blocking1.8.0.9](#c17 "18 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.8.0.9 | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [wanted1.8.0.x](#c19 "18 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | wanted1.8.0.x | + |
| --- | --- | --- |
|  | sec-bounty | ? |
| --- | --- | --- |
|  | sec-bounty-hof |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Replace unsafe operations with stackframe-evals](/attachment.cgi?id=243179)  [18 years ago](#c18)  [James Ross](/user_profile?user_id=18057)   13.73 KB, patch | Gijs : [review+](#c22 "18 years ago")  dveditz : [approval1.8.1.8+](#c0 "17 years ago") | [Details](/attachment.cgi?id=243179&action=edit) | [Diff](/attachment.cgi?id=243179&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=345305&attachment=243179) |
| --- | --- | --- |
| [same diffed against 1.8.0](/attachment.cgi?id=306272)  [17 years ago](#c33)  [Alexander Sack](/user_profile?user_id=113760)   14.17 KB, patch | caillon : [approval1.8.0.next+](#c0 "17 years ago") | [Details](/attachment.cgi?id=306272&action=edit) | [Diff](/attachment.cgi?id=306272&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=345305&attachment=306272) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [moz\_bug\_r\_a4](/user_profile?user_id=194398)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=345305#c0)• 19 years ago |
|  | |

See [Bug 344494](/show_bug.cgi?id=344494 "RESOLVED FIXED - Arbitrary code execution with DOM Inspector by using Array.prototype methods (and Firebug)") and [Bug 344751](/show_bug.cgi?id=344751 "RESOLVED FIXED - Arbitrary code execution with FireBug").
Venkman is vulnerable to attacks using the Array.prototype methods, too.
Steps to Reproduce:
1. Open JavaScript Debugger (Venkman).
2. Open testcase.
3. Set a breakpoint at function xxx.
4. Click a button to call xxx().
5. Step over until after |var yyy = {};|.
6. Open the tree item for |yyy| in the Local Variables view.
An alert dialog that shows Components.stack will appear.

|  | [moz\_bug\_r\_a4](/user_profile?user_id=194398)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=345305#c1)• 19 years ago |
|  | |

Attached file
[testcase](attachment.cgi?id=229947)
— [Details](attachment.cgi?id=229947&action=edit)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=345305#c2)• 19 years ago |
|  | |

So venkman absolutely \_must\_ be able to access random properties "safely" to be at all useful... Maybe we should go with sicking's suggestion and if we detect an explicitly assigned getter we should list the getter code, not the value it would return? Is there a way to detect this? Are there other ways to make this work?Flags: blocking1.9a2?Flags: blocking1.8.1?Flags: blocking1.8.0.6?

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=345305#c3)• 19 years ago |
|  | |

(In reply to [comment #2](/show_bug.cgi?id=345305#c2 "RESOLVED FIXED - Arbitrary code execution with Venkman JavaScript Debugger"))
> So venkman absolutely \_must\_ be able to access random properties "safely" to be
> at all useful... Maybe we should go with sicking's suggestion and if we detect
> an explicitly assigned getter we should list the getter code, not the value it
> would return? Is there a way to detect this?
Yes, but it takes some care. The extension or XUL app has to call Object.prototype.\_\_lookupGetter\_\_ indirectly. Suggest using a helper:
function lookupGetter(untrustedObj, id) {
return Object.prototype.\_\_lookupGetter\_\_.call(untrustedObj, id);
}
/be
> Are there other ways to make this work?
Yes, we should not let any untrusted code gain privilege, no matter how indirect its influence on data or control flow. The kind of data-tainting architecture needed to support this is a goal, but not for the near term.
/be

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a29391_3881)• 19 years ago |

Flags: blocking1.8.1? → blocking1.8.1+

|  | [Blake Kaplan (:mrbkap) (inactive)](/user_profile?user_id=69426) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=345305#c4)• 19 years ago |
|  | |

(In reply to [comment #2](/show_bug.cgi?id=345305#c2 "RESOLVED FIXED - Arbitrary code execution with Venkman JavaScript Debugger"))
> Are there other ways to make this work?
Not from JavaScript proper. We'd need to expose some API written in C++ to avoid calling content-defined getters. (Is that a viable option)?

|  | [Mike Shaver (:shaver emeritus)](/user_profile?user_id=422) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=345305#c5)• 19 years ago |
|  | |

(In reply to [comment #3](/show_bug.cgi?id=345305#c3 "RESOLVED FIXED - Arbitrary code execution with Venkman JavaScript Debugger"))
> Yes, but it takes some care. The extension or XUL app has to call
> Object.prototype.\_\_lookupGetter\_\_ indirectly. Suggest using a helper:
>
> function lookupGetter(untrustedObj, id) {
> return Object.prototype.\_\_lookupGetter\_\_.call(untrustedObj, id);
> }
We'd need to take care that we don't call a booby-trapped .toString on the getter function either, of course...

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=345305#c6)• 19 years ago |
|  | |

Is calling JS\_GetProperty from C++ any different from just getting the property in chrome JS, from a security standpoint? That is, does the getter end up running with different principals in those two cases?
It really sounds to me like we might want a C++ class (similar to XPCNativeWrapper, and with similar auto-wrapping on gets, but not really XPConnect-related?) that various places that want to access content-set properties reasonably safely can use. It'd do things like look up the getter, and if it finds one handle converting it to string in a safe way, etc... At the very least, this is what we need in DOM Inspector and Venkman, looks like.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=345305#c7)• 19 years ago |
|  | |

CC'ing Joe so he can keep an eye on the proposed new functionality which would probably prove useful for Firebug as well.Whiteboard: [sg:moderate] critical on debugged pages

|  | [James Ross](/user_profile?user_id=18057)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=345305#c8)• 19 years ago |
|  | |

FWIW, I believe this could be fixed entirely within Venkman, mainly by tracking the frame that a value came from and using jsdIStackFrame.eval instead of unwrapping the value and just carelessly getting properties off it. This, in my simple experimentation, causes the testcase to throw up a "Permission denied to get property UnnamedClass.stack" dialog on top of the webpage.
An alternative is to give JSD a "get property safely" method that did getter checks, etc. (but that would only protect new back-ends).

|  | [moz\_bug\_r\_a4](/user_profile?user_id=194398)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=345305#c9)• 19 years ago |
|  | |

Attached file
[testcase 2 - for old branches](attachment.cgi?id=230067)
— [Details](attachment.cgi?id=230067&action=edit)

This works even on fx1.0.x and moz1.7.x. (My 1st testcase does not work on fx1.0.x and moz1.7.x.)

|  | [James Ross](/user_profile?user_id=18057)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=345305#c10)• 19 years ago |
|  | |

I've managed to protect Venkman from the issue here relatively easily, though it's not going to be fun to avoid using for..in on content objects (I have ideas, but they are not all that pretty). All the work relies extensively on having the debugger present, so none of it would benefit DOM Inspector.
My question right now is whether an application-specific fix or a more general core addition/change is preferred?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=345305#c11)• 19 years ago |
|  | |

For the 1.8.0 branch we should probably do "whatever works", unless the general fix is pretty easy.
For trunk, it might be worth thinking about a general fix.
For 1.8 branch, I'm not sure.

|  | [moz\_bug\_r\_a4](/user_profile?user_id=194398)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=345305#c12)• 19 years ago |
|  | |

It seems that the patch ([attachment 229913](/attachment.cgi?id=229913 "Patch to test") [[details]](/attachment.cgi?id=229913&action=edit "Patch to test") [[diff]](/attachment.cgi?id=229913&action=diff "Patch to test") [[review]](/page.cgi?id=splinter.html&ignore=&bug=344495&attachment=229913)) in [Bug 344495](/show_bug.cgi?id=344495 "VERIFIED FIXED - XSS against certain sites that are using scripts that access properties of top, parent or opener") also fixes the
privilege escalation bugs.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=345305#c13)• 19 years ago |
|  | |

Appears fixed by the patch in [bug 344495](/show_bug.cgi?id=344495 "VERIFIED FIXED - XSS against certain sites that are using scripts that access properties of top, parent or opener")Depends on: [344495](/show_bug.cgi?id=344495 "VERIFIED FIXED - XSS against certain sites that are using scripts that access properties of top, parent or opener")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a656595_1689)• 18 years ago |

Flags: blocking1.8.0.6? → blocking1.8.0.6+

|  | [James Ross](/user_profile?user_id=18057)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=345305#c14)• 18 years ago |
|  | |

I'm going to go ahead with the app-specific fix for Venkman over the next week. If a general fix happens, good for it, but Venkman will not be depending on it.Assignee: rginda → silver

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a2796661_1689)• 18 years ago |

Flags: blocking1.8.0.8?Flags: blocking1.8.0.7-Flags: blocking1.8.0.7+

|  | [James Ross](/user_profile?user_id=18057)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=345305#c15)• 18 years ago |
|  | |

This should not be blocking1.8.1+ unless someone is planning a core code fix. I've got a Venkman patch for this, which I'll attach after tidying it up a bit, but as it is app-level it has no need to block any release.Status: NEW → ASSIGNED

|  | [Mike Schroepfer](/user_profile?user_id=210162) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=345305#c16)• 18 years ago |
|  | |

Given [comment #15](/show_bug.cgi?id=345305#c15 "RESOLVED FIXED - Arbitrary code execution with Venkman JavaScript Debugger") I'm removing this from the blocking list... Thanks JamesFlags: blocking1.8.1+ → blocking1.8.1-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=345305#c17)• 18 years ago |
|  | |

Restoring lost blocking flagFlags: blocking1.8.1.1?Flags: blocking1.8.0.9?

|  | [James Ross](/user_profile?user_id=18057)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a7176184_18057)• 18 years ago |

Whiteboard: [sg:moderate] critical on debugged pages → [sg:moderate] critical on debugged pages [vnk-0.9.88]

|  | [James Ross](/user_profile?user_id=18057)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=345305#c18)• 18 years ago |
|  | |

Attached patch

[Replace unsafe operations with stackframe-evals](attachment.cgi?id=243179&action=diff)
— [Details](attachment.cgi?id=243179&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=345305&attachment=243179)

The aim is to never do:
- wrappedValue.getWrappedValue()
- unsafeObject["someProp"]
- for..in on unsafeObject
This patch does not claim to remove all calls to getWrappedValue(), as it is not inherently unsafe, but the less it is used the safer we all are. This patch fixes the code execution exploits for Locals, Watches and any other tree view of debuggee objects. If the code does not have a stack frame with which to safely evaluate the desired expression, the code asserts (in the caller) and dies (in evalString).
The advantage to this particular change (besides the obvious security implications) is that Venkman will see the values returned by getters as if the debuggee itself had queried them - something I much prefer to just having the getter code and/or security errors.
[Attachment #243179](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") -
Flags: review?(rginda)

|  | [James Ross](/user_profile?user_id=18057)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a8216785_18057)• 18 years ago |

OS: Windows XP → AllHardware: PC → AllVersion: unspecified → Trunk

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=345305#c19)• 18 years ago |
|  | |

We'll gladly consider this patch for the branches once it's reviewed (add the approval? request flags) but aren't going to block on it.Flags: wanted1.8.1.x+Flags: wanted1.8.0.x+Flags: blocking1.8.1.1?Flags: blocking1.8.1.1-Flags: blocking1.8.0.9?Flags: blocking1.8.0.9-

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a9801018_20209)• 18 years ago |

Flags: blocking1.9a2? → blocking1.9?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a12735748_1689)• 18 years ago |

Flags: blocking1.8.1.2+Flags: blocking1.8.0.10+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a15256082_1689)• 18 years ago |

Flags: blocking1.8.1.2+Flags: blocking1.8.0.10+

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=345305#c20)• 17 years ago |
|  | |

>+ // Note: uses an inline function to avoid polluting the frame's scope.
>+ var code = "(function(obj){" +
>+ " var string = '';" +
>+ " for (var prop in obj) {" +
>+ " if (string)" +
>+ " string += ',';" +
>+ " string += prop.quote();" +
>+ " }" +
>+ " return string;" +
>+ "})(" + this.expression + ")";
>+
>+ // list is undefined if an exception occured.
>+ var list = this.evalString(code);
>+ if (typeof list != "undefined") {
>+ <add stuff to propList>
>+ }
(I would have preferred to ask this on IRC, but connection problems are preventing me from doing that, so going here instead)
James: As far as I can tell, the above code means that if an object |obj| has a getter for some property that throws an exception, none of the properties are going to show up in the list anymore, because the value of |list| will be undefined and hence none of the properties get added to propList. If so, that'd seem like something which would need to be fixed before this patch gets r+. Please correct me if I'm misreading the patch or the consequences of it. :-)

|  | [James Ross](/user_profile?user_id=18057)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=345305#c21)• 17 years ago |
|  | |

Gijs: The above code doesn't call the getters, it only enumerates the properties. On trunk, objects can have their own enumerators (or I think they can, anyway), so it provides safety from anything they might do and will not list anything if they broke the enumeration part-way through. Whether that matters is a separate issue, as the old code would behave the same (but worse).

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=345305#c22)• 17 years ago |
|  | |

Comment on [attachment 243179](/attachment.cgi?id=243179 "Replace unsafe operations with stackframe-evals") [[details]](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") [[diff]](/attachment.cgi?id=243179&action=diff "Replace unsafe operations with stackframe-evals") [[review]](/page.cgi?id=splinter.html&ignore=&bug=345305&attachment=243179)
Replace unsafe operations with stackframe-evals
ok, then r=me.
So which of the 6 seemingly-applying approvals do I need? dveditz?
[Attachment #243179](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") -
Flags: review?(rginda) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=345305#c23)• 17 years ago |
|  | |

Which branch(es) does Venkman actually use? I'd imagine you need approval1.9? to land on the trunk these days, and approval1.8.1.7? to land on the MOZILLA\_1\_8\_BRANCH. If you ship a single version that works for all versions of Firefox/SeaMonkey then maybe you only need to land in one of those places, probably the trunk.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=345305#c24)• 17 years ago |
|  | |

Comment on [attachment 243179](/attachment.cgi?id=243179 "Replace unsafe operations with stackframe-evals") [[details]](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") [[diff]](/attachment.cgi?id=243179&action=diff "Replace unsafe operations with stackframe-evals") [[review]](/page.cgi?id=splinter.html&ignore=&bug=345305&attachment=243179)
Replace unsafe operations with stackframe-evals
We're NPOTB on trunk, so we don't need a1.9, I believe. As for branches, we ship with SeaMonkey and while we don't backport everything, this is a security fix without locale changes, so I'd imagine we want to have it on branch, if possible. Not sure which of the two a? I want in that case, so I'll just set both. Thanks, dveditz!
[Attachment #243179](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") -
Flags: approval1.8.1.7?
[Attachment #243179](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") -
Flags: approval-seamonkey1.1.4?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a35639588_159069)• 17 years ago |

[Attachment #243179](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") -
Flags: approval-seamonkey1.1.4? → approval-seamonkey1.1.5?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=345305#c25)• 17 years ago |
|  | |

If you're not putting security fixes into the trunk version then I'd prefer if the code were cvs rm'd from trunk. Otherwise people will assume the trunk is the latest and greatest.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=345305#c26)• 17 years ago |
|  | |

Comment on [attachment 243179](/attachment.cgi?id=243179 "Replace unsafe operations with stackframe-evals") [[details]](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") [[diff]](/attachment.cgi?id=243179&action=diff "Replace unsafe operations with stackframe-evals") [[review]](/page.cgi?id=splinter.html&ignore=&bug=345305&attachment=243179)
Replace unsafe operations with stackframe-evals
Since it's not part of Firefox but is in SeaMonkey I'll let the seamonkey-council folks approve this one for the 1.8 branch
[Attachment #243179](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") -
Flags: approval1.8.1.7?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=345305#c27)• 17 years ago |
|  | |

(In reply to [comment #25](/show_bug.cgi?id=345305#c25 "RESOLVED FIXED - Arbitrary code execution with Venkman JavaScript Debugger"))
> If you're not putting security fixes into the trunk version then I'd prefer if
> the code were cvs rm'd from trunk. Otherwise people will assume the trunk is
> the latest and greatest.
>
Eh? I'm confused. This patch is going into trunk fine. What gave you the impression it wouldn't? I was under the impression it would be better to cross-commit to trunk and branch, so I'm waiting on that approval before I commit anything. It's NPOTB because Venkman doesn't ship with Firefox, and that is why we don't need approval to land this code on trunk (similar to calendar, chatzilla and all the other projects that don't touch Firefox).

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=345305#c28)• 17 years ago |
|  | |

Comment on [attachment 243179](/attachment.cgi?id=243179 "Replace unsafe operations with stackframe-evals") [[details]](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") [[diff]](/attachment.cgi?id=243179&action=diff "Replace unsafe operations with stackframe-evals") [[review]](/page.cgi?id=splinter.html&ignore=&bug=345305&attachment=243179)
Replace unsafe operations with stackframe-evals
approved for 1.8.1.7, a=dveditz for release-drivers
[Attachment #243179](/attachment.cgi?id=243179&action=edit "Replace unsafe operations with stackframe-evals") -
Flags: approval-seamonkey1.1.5? → approval1.8.1.7+

|  | [James Ross](/user_profile?user_id=18057)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=345305#c29)• 17 years ago |
|  | |

The patch has been checked in to HEAD and MOZILLA\_1\_8\_BRANCH.
I am marking this bug FIXED as - as far as I can recall - the patch eliminates the specific attack vectors mentioned, and closes the general attack vector used. I would love for someone to properly test this, however.
Note that, as I said in [comment 18](/show_bug.cgi?id=345305#c18 "RESOLVED FIXED - Arbitrary code execution with Venkman JavaScript Debugger"), this does not necessarilly make Venkman completely safe, only reduces the potential attack surface somewhat (focused on the areas used in this bug). If someone wishes to do a further audit of getWrappedValue(), for example, I suggest they file security-sensitive bugs on any areas they find which could do with improvement.Status: ASSIGNED → RESOLVEDClosed: 17 years agoResolution: --- → FIXED

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a35985810_159069)• 17 years ago |

Keywords: [fixed1.8.1.7](/buglist.cgi?keywords=fixed1.8.1.7&resolution=---)

|  | [moz\_bug\_r\_a4](/user_profile?user_id=194398)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=345305#c30)• 17 years ago |
|  | |

It seems that most codes that use getWrappedValue() are exploitable.
(Previously, I didn't understand that the problem was caused by
getWrappedValue(), therefore I couldn't find attack vectors other than the one
mentioned in this bug.)
Should I file separate bugs on each area? (jsdExecutionHook, testBreakpoint,
ss\_setThisObj, cmdChangeValue, cmdEval, ...)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=345305#c31)• 17 years ago |
|  | |

(In reply to [comment #30](/show_bug.cgi?id=345305#c30 "RESOLVED FIXED - Arbitrary code execution with Venkman JavaScript Debugger"))
> It seems that most codes that use getWrappedValue() are exploitable.
> (Previously, I didn't understand that the problem was caused by
> getWrappedValue(), therefore I couldn't find attack vectors other than the one
> mentioned in this bug.)
>
> Should I file separate bugs on each area? (jsdExecutionHook, testBreakpoint,
> ss\_setThisObj, cmdChangeValue, cmdEval, ...)
>
Either that or file one bug with a clear list of affected places. Thanks!

|  | [moz\_bug\_r\_a4](/user_profile?user_id=194398)  Reporter |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=345305#c32)• 17 years ago |
|  | |

I filed [bug 396142](/show_bug.cgi?id=396142 "RESOLVED WONTFIX - Venkman: attack vectors that use getWrappedValue()").

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a48106569_20209)• 17 years ago |

Flags: blocking1.9?

|  | [Alexander Sack](/user_profile?user_id=113760) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=345305#c33)• 17 years ago |
|  | |

Attached patch

[same diffed against 1.8.0](attachment.cgi?id=306272&action=diff)
— [Details](attachment.cgi?id=306272&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=345305&attachment=306272)

[Attachment #306272](/attachment.cgi?id=306272&action=edit "same diffed against 1.8.0") -
Flags: approval1.8.0.15?

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=345305#c34)• 17 years ago |
|  | |

Comment on [attachment 306272](/attachment.cgi?id=306272 "same diffed against 1.8.0") [[details]](/attachment.cgi?id=306272&action=edit "same diffed against 1.8.0") [[diff]](/attachment.cgi?id=306272&action=diff "same diffed against 1.8.0") [[review]](/page.cgi?id=splinter.html&ignore=&bug=345305&attachment=306272)
same diffed against 1.8.0
a=caillon for 1.8.0.15
[Attachment #306272](/attachment.cgi?id=306272&action=edit "same diffed against 1.8.0") -
Flags: approval1.8.0.15? → approval1.8.0.15+

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=345305#c35)• 17 years ago |
|  | |

committed to 1.8.0 branchKeywords: [fixed1.8.0.15](/buglist.cgi?keywords=fixed1.8.0.15&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a80842807_1689)• 16 years ago |

Group: core-security

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=345305#a386327551_546015)• 6 years ago |

Product: Other Applications → Other Applications Graveyard
You need to [log in](/show_bug.cgi?id=345305&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [James Ross](/user_profile?user_id=18057)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.suse.com_abcc65b0_20250125_225800.html ===


| Bugzilla – Bug 332512 | VUL-0: Mozilla Firefox 2.0.0.8 update | Last modified: 2019-05-01 14:46:13 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D332512)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 332512**](show_bug.cgi?id=332512)
- VUL-0: Mozilla Firefox 2.0.0.8 update

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: Mozilla Firefox 2.0.0.8 update

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P5 - None **Severity**: Major | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | E-mail List | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | fixed\_bs, MozillaFirefox,mozilla,seam... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2007-10-10 11:44 UTC by Marcus Meissner | | --- | --- | | Modified: | 2019-05-01 14:46 UTC ([History](show_activity.cgi?id=332512)) | | CC List: | 3 users (show)  meissner security-team wolfgang | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=332512) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=332512&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=332512&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=332512#c0)  Marcus Meissner   2007-10-10 11:44:44 UTC  ``` Date: Tue, 09 Oct 2007 10:40:41 -0700 From: Daniel Veditz <dveditz@mozilla.com> User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)   To: security-announce <security-announce@mozilla.org> Subject: Upcoming Firefox 2.0.0.8 release being tested now Cc: release-drivers <release-drivers@mozilla.org>,         security-group <security-group@mozilla.org> Errors-To: security-announce-bounces@mozilla.org  We are wrapping up our Firefox 2.0.0.8 release and have a release candidate build available for testing at:  ftp://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2.0.0.8-candidates/rc2/  Our current plan is to release this to the beta channel on Thursday Oct 12 and release to the public Thursday Oct 18 assuming all goes well. Since this security update does not address any "firedrill" level problems we're taking the somewhat lengthy roll-out period to make sure there aren't any extension-breaking regressions from some of the riskier changes.  If additional regressions are found when beta-testing the rc2 builds the final release could be delayed to the week of October 22. _______________________________________________ Security-announce mailing list Security-announce@mozilla.org <https://mail.mozilla.org/listinfo/security-announce> Contents are confidential, do not post or forward without author's permission ``` [Comment 1](show_bug.cgi?id=332512#c1)  Marcus Meissner   2007-10-10 11:45:12 UTC  ``` Date: Tue, 09 Oct 2007 10:48:29 -0700 From: Daniel Veditz <dveditz@mozilla.com> User-Agent: Thunderbird 2.0.0.6 (Windows/20070728) To: security-announce <security-announce@mozilla.org> Subject: Re: Upcoming Firefox 2.0.0.8 release being tested now Cc: security-group <security-group@mozilla.org>,         release-drivers <release-drivers@mozilla.org> Errors-To: security-announce-bounces@mozilla.org  Daniel Veditz wrote: > Our current plan is to release this to the beta channel on Thursday Oct 12  Thursday Oct 11.  ``` [Comment 2](show_bug.cgi?id=332512#c2)  Marcus Meissner   2007-10-15 13:10:58 UTC  ``` Michael? ``` [Comment 3](show_bug.cgi?id=332512#c3)  Wolfgang Rosenauer   2007-10-15 13:18:57 UTC  ``` It's not yet public (outside of the beta channel) but I've prepared a package (not fully tested) for the buildservice. I just don't want to commit it because it would get out to the public. It needed a bit of work: - Seems that pango-cairo.patch is not needed anymore. The dependency in mozilla-decoder.cpp has been removed upstream - had to recreate startup.patch and configure.patch ``` [Comment 4](show_bug.cgi?id=332512#c4)  Marcus Meissner   2007-10-17 09:26:02 UTC  ``` To: Daniel Veditz <dveditz@mozilla.com> From: Josh Bressers <josh@bress.net> Subject: Re: Upcoming Firefox 2.0.0.8 release being tested now Comments: In-reply-to Josh Bressers <josh@bress.net>         message dated "Tue, 16 Oct 2007 10:36:33 -0400." Date: Tue, 16 Oct 2007 17:14:18 -0400 Cc: security-announce <security-announce@mozilla.org>,         release-drivers <release-drivers@mozilla.org>,         security-group <security-group@mozilla.org> Errors-To: security-announce-bounces@mozilla.org  > > I just took a look at the list of fixed security bugs.  Have you split them > up into their respective categories yet?  I'll start on that in a bit if > not for CVE assignment purposes. > > Let me know as I'd rather not duplicate work that has already been done. >  I presume the silence means nobody did this.  Below is my first pass at the bug list.  If nobody says anything, I'll assume you all agree and I'll assign CVE ids based off this list.  If you wish, I can also write the upstream advisories, but I'm not doing that without a request as I ended up eating a bunch of text last time I tried to help with that.  Here is the bugzilla query I used:  <https://bugzilla.mozilla.org/buglist.cgi?query_format=advanced&short_desc_type=allwordssubstr&short_desc=&long_desc_type=allwordssubstr&lon> +g_desc=&bug_file_loc_type=allwordssubstr&bug_file_loc=&status_whiteboard_type=allwordssubstr&status_whiteboard=sg%3A&keywords_type=anyword +s&keywords=verified1.8.1.8+fixed1.8.1.8&emailtype1=substring&email1=&emailtype2=substring&email2=&bugidtype=include&bug_id=&votes=&chfield +from=&chfieldto=Now&chfieldvalue=&cmdtype=doit&order=Reuse+same+sort+as+last+time&known_name=2.0.0.8+security+bugs&query_based_on=2.0.0.8+ +security+bugs&field0-0-0=noop&type0-0-0=noop&value0-0-0=  It should return 50 bugs   Unsorted -------- 392149 - Is this really an issue? 371360 - Trick the user when leaving the page 391043 - Trick the user by changing the titlebar 388784 - file input focus stealing vulnerability 390983 - addMicrosummaryGenerator sidebar method can install from file URI 378787 - Browser Digest Authentication Request Splitting 381412 - unicode XSS 394418 - Notify on text changes before firing mutation events (like 388784?) 381146 - sftp protocol support 388121 - about:blank has chrome privileges 395942 - quicktime pwns firefox  Crashes with evidence of memory corruption ------------------------------------------ 377535 - arbitrary code execution via accessability API 386382 - arbitrary code execution via accessability API 361745 - SVG arbitrary code execution 330563 - Crash with evil xbl testcase, using alert in constructor 378670 - Event handler crash 384877 - Toolkit crash 393770 - Crash in General 386914 - Toolkit crash  Layout Crashes -------------- 382376 354645 344064 387033 362901 379799 309322 387460 394014 341858 348126 378682 391974 392285 383129 384105  Javascript Crashes ------------------ 387844   325761   393537 387881 345305 372309 387955 390078  URI Handling Issues ------------------- 394974 389106 389580 389287  Probably Don't Care ---------- 393775 - NULL pointer deference 388424 - Crash when decoding FTP directory items (OOB read) 386998 - This isn't really a firefox flaw   --     JB  ``` [Comment 5](show_bug.cgi?id=332512#c5)  Marcus Meissner   2007-10-17 09:26:42 UTC  ``` Date: Tue, 16 Oct 2007 18:45:39 -0700 From: Daniel Veditz <dveditz@mozilla.com> User-Agent: Thunderbird 2.0.0.6 (Windows/20070728) To: Josh Bressers <josh@bress.net> Subject: Re: Upcoming Firefox 2.0.0.8 release being tested now Cc: security-announce <security-announce@mozilla.org>,         release-drivers <release-drivers@mozilla.org>,         security-group <security-group@mozilla.org> Errors-To: security-announce-bounces@mozilla.org  Josh Bressers wrote: > I presume the silence means nobody did this.  Sorry, silence meant I was busy doing it and was neglecting my mail :-(  > If you wish, I can also write the upstream advisories, but I'm not doing > that without a request as I ended up eating a bunch of text last time I > tried to help with that.  I am working on the advisories  > It should return 50 bugs  yup.  A few of those were fixed in FF2006 and 2007, and have the "fixed1.8.1.8" flag because we had to land the fixed on both the 2005-based release mini-branch as well as the main 1.8 branch. They're on the list to get re-verified to ensure the landing, but they're not new fixes.  > Unsorted These will likely get individual advisories  > 392149 - Is this really an issue? no  > 388784 - file input focus stealing vulnerability this one was from a Full-disclosure posting, might have a CVE already  > 378787 - Browser Digest Authentication Request Splitting This was also public and probably has a CVE  > 381412 - unicode XSS We are not going to release an advisory on this one yet, the problem also affect IE, Opera and Apple and we are coordinating a release with them. It was initially reported to us by JPCERT, but Kohei didn't find that they'd assigned a CVE. We should get one now and add it to the bug.  It might be 3 separate CVEs, the original one reported to us, and two similar ones discovered by Simon Montagu. The other browsers are vulnerable to different sets of the three.  > 394418 - Notify on text changes before firing mutation events (like 388784?) No, this is a content crash like [bug 387460](show_bug.cgi?id=387460 "RESOLVED NORESPONSE").  > 388121 - about:blank has chrome privileges fixed in FF2006  > 395942 - quicktime pwns firefox fixed in FF2007  >  > Crashes with evidence of memory corruption > ------------------------------------------ > 377535 - arbitrary code execution via accessability API null deref > 386382 - arbitrary code execution via accessability API > 361745 - SVG arbitrary code execution > 330563 - Crash with evil xbl testcase, using alert in constructor > 378670 - Event handler crash > 384877 - Toolkit crash null deref > 393770 - Crash in General > 386914 - Toolkit crash > > Layout Crashes I don't see these "layout" ones as separate from the above  > 382376 > 354645 > 344064 > 387033 > 362901 > 379799 this was a regression from 362901 (the one above)  > 309322 > 341858 > 348126 The latter two are regressions from the first one.  > 387460 > 394014 > 378682 > 391974 > 392285 > 383129 null deref, worse was speculative > 384105 > > Javascript Crashes > ------------------ > 387844 not "js", this goes up with the several DOM/XBL crashes above fixed by bug 267833 (which isn't on this list because it itself was not a security bug)  > 325761 Crash in Venkman extension, FF code change is prophylactic. Not "js" in any case.  > 393537 > 387881   This one deserves it's own advisory, it's not a simple memory crash  > 345305 bug in Venkman extension  > 372309   > 387955 > 390078 >  > URI Handling Issues > ------------------- > 394974 This is a follow-on fix for MFSA 2007-27 (the URI %-issue)  > 389106 > 389580 Fixed in FF2006  > 389287 not an issue, we fixed the ways it can be exploited in MFSA 2007-27  > Probably Don't Care > ---------- > 393775 - NULL pointer deference > 388424 - Crash when decoding FTP directory items (OOB read)  agree. also non-exploitable: (mentioned above, I think)  377535   383129   384877   > 386998 - This isn't really a firefox flaw no, but it's a vector to a an exploited-in-the-wild (patched) Windows bug. Maybe we combine it with [bug 394974](show_bug.cgi?id=394974 "RESOLVED FIXED") in a "bugs in Windows we're protecting you from" advisory.   ``` [Comment 6](show_bug.cgi?id=332512#c6)  Marcus Meissner   2007-10-17 09:28:49 UTC  ``` swampid: 14163 ``` [Comment 7](show_bug.cgi?id=332512#c7)  Marcus Meissner   2007-10-17 09:33:30 UTC  ``` Date: Wed, 17 Oct 2007 11:32:09 +0200 From: Alexander Sack <asac@jwsdot.com> To: Daniel Veditz <dveditz@mozilla.com> Subject: Re: Upcoming Firefox 2.0.0.8 release being tested now Mail-Followup-To: Daniel Veditz <dveditz@mozilla.com>,         Josh Bressers <josh@bress.net>,         security-announce <security-announce@mozilla.org>,         release-drivers <release-drivers@mozilla.org>,         security-group <security-group@mozilla.org> User-Agent: Mutt/1.5.15+20070412 (2007-04-11) Cc: security-announce <security-announce@mozilla.org>,         security-group <security-group@mozilla.org>,         release-drivers <release-drivers@mozilla.org>,         Josh Bressers <josh@bress.net> Errors-To: security-announce-bounces@mozilla.org  On Tue, Oct 16, 2007 at 06:45:39PM -0700, Daniel Veditz wrote: > Josh Bressers wrote: > > I presume the silence means nobody did this. > > Sorry, silence meant I was busy doing it and was neglecting my mail :-( > > > If you wish, I can also write the upstream advisories, but I'm not doing > > that without a request as I ended up eating a bunch of text last time I > > tried to help with that. > > I am working on the advisories  I don't know if the release is going to happen tomorrow. Can we (distributors) get at least a few days after you sent your initial advisory drafts out? If not this time, then maybe we can get back to this practice for the next release?    - Alexander ``` [Comment 8](show_bug.cgi?id=332512#c8)  Marcus Meissner   2007-10-17 15:32:59 UTC  ``` To: Daniel Veditz <dveditz@mozilla.com> From: Josh Bressers <josh@bress.net> Subject: Re: Upcoming Firefox 2.0.0.8 release being tested now Comments: In-reply-to Daniel Veditz <dveditz@mozilla.com>         message dated "Tue, 16 Oct 2007 18:45:39 -0700." Date: Wed, 17 Oct 2007 11:14:17 -0400 Cc: security-announce <security-announce@mozilla.org>,         security-group <security-group@mozilla.org>,         release-drivers <release-drivers@mozilla.org>,         Josh Bressers <josh@bress.net> Errors-To: security-announce-bounces@mozilla.org  > Josh Bressers wrote: > > I presume the silence means nobody did this. > > Sorry, silence meant I was busy doing it and was neglecting my mail :-( >  Thanks for the feedback.  So using your current guidance, here is the list I have.  It looks like I'll need to assign 8 CVE names.  Once you agree, I'll assign them.  I'm not going to touch the XSS thing right now.  I'll take a look and deal with CVE names once this release is out.   Unsorted - Need 5 ids, not counting the XSS thing -------- 371360 - CVE-2007-1095 Trick the user when leaving the page 391043 - Trick the user by changing the titlebar 388784 - CVE-2007-3511 file input focus stealing vulnerability 390983 - addMicrosummaryGenerator sidebar method can install from file URI 378787 - CVE-2007-2292 Browser Digest Authentication Request Splitting 381412 - unicode XSS - *** Figure this out later *** 394418 - Notify on text changes before firing mutation events 381146 - sftp protocol support 387881 - Arbitrary code execution by polluting implicit XPCNativeWrapper  Crashes with evidence of memory corruption - One CVE ID ------------------------------------------ 386382 - arbitrary code execution via accessability API 361745 - SVG arbitrary code execution 330563 - Crash with evil xbl testcase, using alert in constructor 378670 - Event handler crash 393770 - Crash in General 386914 - Toolkit crash 382376 354645 344064 387033 362901 309322 387460 394014 378682 391974 392285 384105 387844  Javascript Crashes - One CVE id (why are these different than the above?) ------------------ 393537 372309 387955 390078  Bugs in Venkman extension - One CVE ID ------------------------- 325761 345305  Broken windows things ------------------- 394974 - CVE-2007-4841 386998 - This isn't really a firefox flaw (No CVE id)  ``` [Comment 9](show_bug.cgi?id=332512#c9)  Marcus Meissner   2007-10-18 09:30:49 UTC  ``` Date: Wed, 17 Oct 2007 11:02:07 -0700 From: Daniel Veditz <dveditz@mozilla.com> User-Agent: Thunderbird 2.0.0.6 (Windows/20070728) To: Josh Bressers <josh@bress.net> Subject: Re: Upcoming Firefox 2.0.0.8 release being tested now Cc: security-announce <security-announce@mozilla.org>,         security-group <security-group@mozilla.org>,         release-drivers <release-drivers@mozilla.org> Errors-To: security-announce-bounces@mozilla.org  > Javascript Crashes - One CVE id (why are these different than the above?)  Various non-Mozilla projects--not all of them known to us--incorporate the SpiderMonkey engine. They'd be vulnerable to these but not the other core browser crashes. Any project incorporating "Gecko" would be vulnerable to both sets (give or take features that can be disabled like SVG).  ``` [Comment 10](show_bug.cgi?id=332512#c10)  Marcus Meissner   2007-10-18 09:31:14 UTC  ``` To: Josh Bressers <josh@bress.net>    From: Josh Bressers <josh@bress.net> Subject: Re: Upcoming Firefox 2.0.0.8 release being tested now Comments: In-reply-to Josh Bressers <josh@bress.net>         message dated "Wed, 17 Oct 2007 11:14:17 -0400." Date: Wed, 17 Oct 2007 14:53:24 -0400 Cc: release-drivers <release-drivers@mozilla.org>,         security-announce <security-announce@mozilla.org>,         security-group <security-group@mozilla.org>,         Daniel Veditz <dveditz@mozilla.com> Errors-To: security-announce-bounces@mozilla.org  OK, here goes.  > > > Unsorted - Need 5 ids, not counting the XSS thing > -------- > 371360 - CVE-2007-1095 Trick the user when leaving the page > 391043 - CVE-2007-5334 Trick the user by changing the titlebar > 388784 - CVE-2007-3511 file input focus stealing vulnerability > 390983 - CVE-2007-5335 addMicrosummaryGenerator sidebar method can install from file URI > 378787 - CVE-2007-2292 Browser Digest Authentication Request Splitting > 394418 - CVE-2007-5336 Notify on text changes before firing mutation events > 381146 - CVE-2007-5337 sftp protocol support > 387881 - CVE-2007-5338 Arbitrary code execution by polluting implicit XPCNativeWrapper > > Crashes with evidence of memory corruption - CVE-2007-5339 > ------------------------------------------ > 386382 361745 330563 378670 393770 386914 382376 354645 344064 387033 > 362901 309322 387460 394014 378682 391974 392285 384105 387844 > > Javascript Crashes - CVE-2007-5340 > ------------------ > 393537 372309 387955 390078 > > Bugs in Venkman extension - CVE-2007-5341 > ------------------------- > 325761 345305 > > Broken windows things > ------------------- > 394974 - CVE-2007-4841 > 386998 - This isn't really a firefox flaw (No CVE id) >  --     JB  ``` [Comment 11](show_bug.cgi?id=332512#c11)  Michael Wolf   2007-10-19 00:01:19 UTC  ``` I'm preparing packages for submission now... ``` [Comment 12](show_bug.cgi?id=332512#c12)  Michael Wolf   2007-10-19 01:00:50 UTC  ``` Submitted for 10.0, 10.1/sle10, 10.3, and STABLE/Factory.  A submission for 10.2 is coming soon.  A submission for nld9 might take longer, since fixes will need to be backported.   ``` [Comment 13](show_bug.cgi?id=332512#c13)  Michael Wolf   2007-10-19 01:37:19 UTC  ``` Submitted for 10.2. ``` [Comment 14](show_bug.cgi?id=332512#c14)  Wolfgang Rosenauer   2007-10-19 05:53:47 UTC  ``` Updates published on buildservice since last night.  Please note that we'd need updates for seamonkey as well. ``` [Comment 15](show_bug.cgi?id=332512#c15)  Marcus Meissner   2007-10-19 08:54:26 UTC  ``` Date: Thu, 18 Oct 2007 10:43:13 -0700 From: Daniel Veditz <dveditz@cruzio.com> User-Agent: Thunderbird 2.0.0.6 (Windows/20070728) To: security-announce <security-announce@mozilla.org>,         security-group <security-group@mozilla.org> Subject: Firefox 2.0.0.8 release this afternoon Errors-To: security-announce-bounces@mozilla.org  [-- Anhang #1 --] [-- Typ: text/plain, Kodierung: 7bit, Größe: 0,3K --]  We will be releasing Firefox 2.0.0.8 this afternoon as planned, attached please find the security advisories.  In testing with the unreleased Mac OS X Leopard we've found several non-security issues that we will release-note for now and address in Firefox 2.0.0.9: [http://wiki.mozilla.org/FF2:Leopard](http://wiki.mozilla.org/FF2%3ALeopard)  .... ``` [Comment 16](show_bug.cgi?id=332512#c16)  Marcus Meissner   2007-10-19 09:03:48 UTC  ``` MFSA 2007-29  Mozilla Foundation Security Advisory 2007-29  Title: Crashes with evidence of memory corruption (rv:1.8.1.8) Impact: Critical Announced: October 18, 2007 Reporter: Mozilla developers and community Products: Firefox, Thunderbird, SeaMonkey  Fixed in: Firefox 2.0.0.8   Thunderbird 2.0.0.8   SeaMonkey 1.1.5  Description  As part of the Firefox 2.0.0.8 update releases Mozilla developers fixed many bugs to improve the stability of the product. Some of these crashes showed evidence of memory corruption under certain circumstances and we presume that with enough effort at least some of these could be exploited to run arbitrary code.  Thunderbird shares the browser engine with Firefox and could be vulnerable if JavaScript were to be enabled in mail. This is not the default setting and we strongly discourage users from running JavaScript in mail. Without further investigation we cannot rule out the possibility that for some of these an attacker might be able to prepare memory for exploitation through some means other than JavaScript such as large images.  Workaround  Disable JavaScript until a version containing these fixes can be installed.  References  L. David Baron, Boris Zbarsky, Georgi Guninski, Paul Nickerson, Olli Pettay, Jesse Ruderman, Vladimir Sukhoy, Daniel Veditz, and Martijn Wargers reported crashes in the browser engine.    • CVE-2007-5339 Browser crashes  Igor Bukanov, Eli Friedman, and Jesse Ruderman reported crashes in the JavaScript engine.    • CVE-2007-5340   • JavaScript engine crashes  ``` [Comment 17](show_bug.cgi?id=332512#c17)  Marcus Meissner   2007-10-19 09:04:22 UTC  ``` MFSA 2007-30  Mozilla Foundation Security Advisory 2007-30  Title: onUnload Tailgating Impact: Low Announced: October 18, 2007 Reporter: Michal Zalewski Products: Firefox, SeaMonkey  Fixed in: Firefox 2.0.0.8   SeaMonkey 1.1.5  Description  Michal Zalewski demonstrated that onUnload event handlers had access to the  address of the new page about to be loaded, even if the navigation was triggered from outside the page content such as by using a bookmark, pressing the back button, or typing an address into the location bar. If the bookmark contained sensitive information in the URL the attacking page might be able to take advantage of it. An attacking page would also be able to redirect the user, perhaps to a phishing page that looked like the site the user thought they were about to visit.  References    • <https://bugzilla.mozilla.org/show_bug.cgi?id=371360>   • CVE-2007-1095  ``` [Comment 18](show_bug.cgi?id=332512#c18)  Marcus Meissner   2007-10-19 09:05:03 UTC  ``` MFSA 2007-31  Mozilla Foundation Security Advisory 2007-31  Title: Digest authentication request splitting Impact: Moderate Announced: October 18, 2007 Reporter: Stefano Di Paola Products: Firefox, SeaMonkey  Fixed in: Firefox 2.0.0.8   SeaMonkey 1.1.5  Description  Security researcher Stefano Di Paola reported that Firefox did not properly validate the user ID when making an HTTP request using Digest Authentication to log into a web site. A malicious page could abuse this to inject arbitrary HTTP headers by including a newline character in the user ID followed by the injected header data. If the user were connecting through a proxy the attacker could inject headers that a proxy would interpret as two separate requests for different hosts.  References    • IE 7 and Firefox Browsers Digest Authentication Request Splitting   • <https://bugzilla.mozilla.org/show_bug.cgi?id=378787>   • CVE-2007-2292  ``` [Comment 19](show_bug.cgi?id=332512#c19)  Marcus Meissner   2007-10-19 09:05:48 UTC  ``` MFSA 2007-32  Mozilla Foundation Security Advisory 2007-32  Title: File input focus stealing vulnerability Impact: Moderate Announced: October 18, 2007 Reporter: hong, Charles McAuley Products: Firefox, SeaMonkey  Fixed in: Firefox 2.0.0.8   SeaMonkey 1.1.5  Description  A user on the Sla.ckers.org forums named hong reported that a file upload   control could be filled programmatically by switching page focus to the label   before a file upload form control for selected keyboard events. An attacker could use this trick to steal files from the users' computer if the attacker knew the full pathnames to the desired fileis and could create a pretext that  would convince the user to type long enough to produce all the necessary characters.  This is a variant on a similar problem reported by Charles McAuley and independently rediscovered by Michal Zalewski that was fixed in Firefox 2.0.0.4.  References    • <https://bugzilla.mozilla.org/show_bug.cgi?id=388784>   • CVE-2007-3511   • <https://bugzilla.mozilla.org/show_bug.cgi?id=370092>   • CVE-2006-2894  ``` [Comment 20](show_bug.cgi?id=332512#c20)  Marcus Meissner   2007-10-19 09:06:13 UTC  ``` MFSA 2007-33  Mozilla Foundation Security Advisory 2007-33  Title: XUL pages can hide the window titlebar Impact: Low Announced: October 18, 2007 Reporter: Eli Friedman Products: Firefox, SeaMonkey  Fixed in: Firefox 2.0.0.8   SeaMonkey 1.1.5  Description  Mozilla developer Eli Friedman discovered that web pages written in the XUL markup language (rather than the usual HTML) can hide their window's titlebar. It may have been possible to abuse this ablity to create more convincing spoof and phishing pages.  References    • <https://bugzilla.mozilla.org/show_bug.cgi?id=391043>   • CVE-2007-5334  ``` [Comment 21](show_bug.cgi?id=332512#c21)  Marcus Meissner   2007-10-19 09:06:29 UTC  ``` MFSA 2007-34  Mozilla Foundation Security Advisory 2007-34  Title: Possible file stealing through sftp protocol Impact: Moderate Announced: October 18, 2007 Reporter: Georgi Guninski Products: Firefox, SeaMonkey  Fixed in: Firefox 2.0.0.8   SeaMonkey 1.1.5  Description  On Linux machines with gnome-vfs support the smb: and sftp: URI schemes are available in Firefox. Georgi Guninski showed that if an attacker can store the attack page in a mutually accessible location on the target server (/tmp perhaps) and lure the victim into loading it, the attacker could potentially read any file owned by the victim from known locations on that server.  References    • <https://bugzilla.mozilla.org/show_bug.cgi?id=381146>   • CVE-2007-5337  ``` [Comment 22](show_bug.cgi?id=332512#c22)  Marcus Meissner   2007-10-19 09:06:42 UTC  ``` MFSA 2007-35  Mozilla Foundation Security Advisory 2007-35  Title: XPCNativeWraper pollution using Script object Impact: Critical Announced: October 18, 2007 Reporter: moz_bug_r_a4    Products: Firefox, SeaMonkey  Fixed in: Firefox 2.0.0.8   SeaMonkey 1.1.5  Description  Mozilla security researcher moz_bug_r_a4 reported that it was possible to use the Script object to modify XPCNativeWrappers in such a way that subsequent    access by the browser chrome--such as by right-clicking to open a context menu--can cause attacker-supplied javascript to run with the same privileges as the user. This is similar to MFSA 2007-25 fixed in Firefox 2.0.0.5  References    • <https://bugzilla.mozilla.org/show_bug.cgi?id=387881>   • CVE-2007-5338  ``` [Comment 23](show_bug.cgi?id=332512#c23)  Marcus Meissner   2007-10-19 09:06:55 UTC  ``` MFSA 2007-36  Mozilla Foundation Security Advisory 2007-36  Title: URIs with invalid %-encoding mishandled by Windows Impact: Moderate Announced: October 18, 2007 Reporter: Billy Rios, Nate McFeters, Secunia Products: Firefox, Thunderbird, SeaMonkey  Fixed in: Firefox 2.0.0.8   Thunderbird 2.0.0.8   SeaMonkey 1.1.5  Description  On Windows XP with Internet Explorer 7 installed several "web related" URI     schemes do not launch the registered protocol-handler if the URI contains an invalid %-encoded sequence. This was initially reported by Billy Rios and Nate  McFeters with additional investigation by Secunia. A patch that mitigated the known exploits was shipped with Firefox 2.0.0.6 as described at MFSA 2007-27.  That mitigation did not prevent the incorrect file-handling programs from launching which left some risk. An additional fix has been applied to Firefox 2.0.0.8 that detects when Windows would mishandle these URIs so that the wrong program does not get launched.  References    • <https://bugzilla.mozilla.org/show_bug.cgi?id=394974>   • CVE-2007-4841  ``` [Comment 24](show_bug.cgi?id=332512#c24)  Marcus Meissner   2007-10-19 09:07:21 UTC  ``` To: Daniel Veditz <dveditz@cruzio.com> From: Josh Bressers <josh@bress.net> Subject: Re: Firefox 2.0.0.8 release this afternoon Comments: In-reply-to Daniel Veditz <dveditz@cruzio.com>         message dated "Thu, 18 Oct 2007 10:43:13 -0700." Date: Thu, 18 Oct 2007 14:10:50 -0400 Cc: security-announce <security-announce@mozilla.org>,         security-group <security-group@mozilla.org> Errors-To: security-announce-bounces@mozilla.org  > > We will be releasing Firefox 2.0.0.8 this afternoon as planned, attached > please find the security advisories. > > In testing with the unreleased Mac OS X Leopard we've found several > non-security issues that we will release-note for now and address in > Firefox 2.0.0.9: [http://wiki.mozilla.org/FF2:Leopard](http://wiki.mozilla.org/FF2%3ALeopard) >  Hi Dan,  These look good.  I have one nitpick though.  I'm not sure if I like the way the bugs in the catchall advisory are being referenced.  I was a bit confused when I first looked at it.  My initial impression was that there was only one issue being fixed.  I can however see the reasoning behind this, as the list is quite long.  --     JB  ``` [Comment 25](show_bug.cgi?id=332512#c25)  Marcus Meissner   2007-10-19 09:07:34 UTC  ``` Date: Thu, 18 Oct 2007 11:46:41 -0700  From: Daniel Veditz <dveditz@cruzio.com> User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)  To: Josh Bressers <josh@bress.net> Subject: Re: Firefox 2.0.0.8 release this afternoon Cc: security-announce <security-announce@mozilla.org>,         security-group <security-group@mozilla.org> Errors-To: security-announce-bounces@mozilla.org  Josh Bressers wrote: > These look good.  I have one nitpick though.  I'm not sure if I like the > way the bugs in the catchall advisory are being referenced.  I was a bit > confused when I first looked at it.  My initial impression was that there > was only one issue being fixed. > > I can however see the reasoning behind this, as the list is quite long.  Thanks for the feedback, it's an experiment so impressions welcome.  The reasoning isn't so much that the list is long but that in previous similar advisories long lists of bug numbers were pretty meaningless. This way people who are interested can get a list with a lot more information (I'll be removing the security flags from these bugs by time we ship).   People who aren't interested don't get a lot of extraneous junk.  Another alternative would be to link bug summaries instead of the plain text number links. I'm not sure the summaries are any more useful for the people who don't know the project, and having a nice query link seems like a useful thing for developer-types who do work on the project.  Anyone else have thoughts?  ``` [Comment 26](show_bug.cgi?id=332512#c26)  Marcus Meissner   2007-10-19 09:07:49 UTC  ``` Date: Thu, 18 Oct 2007 14:25:32 -0700  From: Tim Riley <timr@mozilla.com> User-Agent: Thunderbird 2.0.0.6 (Macintosh/20070728) To: Jesse Ruderman <jruderman@gmail.com> Subject: Re: Firefox 2.0.0.8 release this afternoon Cc: Daniel Veditz <dveditz@cruzio.com>,         security-announce <security-announce@mozilla.org>,         Josh Bressers <josh@bress.net>,         security-group <security-group@mozilla.org> Errors-To: security-announce-bounces@mozilla.org  [-- Anhang #1 --]    [-- Typ: text/plain, Kodierung: 7bit, Größe: 0,7K --]  I like Dan's general format summarizing each.    Adding a little descriptiveness to the link as Jesse recommends is always a goo idea. Any time you can add a sense of scale without adding lines or sentences is a good thing.  --Tim  Jesse Ruderman wrote: >I think it is more useful to link to the bug list rather than linking   >to each bug, but I understand Josh's concern.  How about including the >number of bugs in the link text?  So change "Browser crashes" to >something like "The 20 browser crash bugs". >_______________________________________________ >Security-group mailing list >Security-group@mozilla.org ><https://mail.mozilla.org/listinfo/security-group> >   ``` [Comment 27](show_bug.cgi?id=332512#c27)  Michael Wolf   2007-10-23 17:43:12 UTC  ``` mozilla/seamonkey packages have been submitted.  There's still no thunderbird update afaics. ``` [Comment 28](show_bug.cgi?id=332512#c28)  Wolfgang Rosenauer   2007-10-23 18:30:55 UTC  ``` No Thunderbird update yet, correct.  And please note that MozCorp missed some QA and found regressions in 2.0.0.8 which they intend to fix with 2.0.0.9 probably next week :-( <http://developer.mozilla.org/devnews/index.php/2007/10/22/firefox-2008-update-to-be-updated/> ``` [Comment 29](show_bug.cgi?id=332512#c29)  Marcus Meissner   2007-10-24 15:14:43 UTC  ``` Hmm.  What about mozilla-lib64 on sles9? mozilla-xulrunner? MozillaSunbird? ``` [Comment 30](show_bug.cgi?id=332512#c30)  Michael Wolf   2007-10-24 20:59:47 UTC  ``` (In reply to [comment #29](show_bug.cgi?id=332512#c29) from Marcus Meissner) > Hmm. >  > What about mozilla-lib64 on sles9?  The Version: for mozilla and mozilla-lib64 need to be kept in sync, which they are.  It's unclear whether mozilla-lib64 needs to be rebuilt anyway -- it probably should to be safe.  Will that happen automagically, or does something specific need to be done to make it happen?  > mozilla-xulrunner? > MozillaSunbird?  No word on these...   ``` [Comment 31](show_bug.cgi?id=332512#c31)  Wolfgang Rosenauer   2007-10-24 21:11:28 UTC  ``` (In reply to [comment #29](show_bug.cgi?id=332512#c29) from Marcus Meissner) > mozilla-xulrunner?  Since xulrunner ships most of the backend (and even toolkit parts of the UI) components it has basically the same flaws. I'm working on a new version in the buildservice but updating and maintaining compatibility for file paths (used in some packages' rpath) is not that easy. At least I ran into some issues in the past.  > MozillaSunbird?  Sunbird has no browser frontend and is basically only loading iCal like stuff. I think the risk is pretty low and no update is needed but then I'm not really a security expert.  ``` [Comment 32](show_bug.cgi?id=332512#c32)  Marcus Meissner   2007-11-14 13:28:23 UTC  ``` I doubt we will see a Thunderbird update, and we can track it elsewhere. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=332512)
* - [XML](show_bug.cgi?ctype=xml&id=332512)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=332512)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D332512)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from bugzilla.mozilla.org_c437ff6e_20250125_225757.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/325761)
* [XML](/show_bug.cgi?ctype=xml&id=325761)

Closed
[Bug 325761](/show_bug.cgi?id=325761)

Opened 19 years ago
Closed 15 years ago

# memory corruption in mozilla <object data='x-jsd:help'>

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

memory corruption in mozilla <object data='x-jsd:help'>

## Categories

### (Other Applications Graveyard :: Venkman JS Debugger, defect)

[Product:](/describecomponents.cgi?product=Other%20Applications%20Graveyard)

Other Applications Graveyard
▾

Other Applications Graveyard
Old, retired Other Applications components
[See Open Bugs in This Product](/buglist.cgi?product=Other%20Applications%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Other%20Applications%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Other%20Applications%20Graveyard&component=Venkman%20JS%20Debugger#Venkman%20JS%20Debugger)

Venkman JS Debugger
▾

Other Applications Graveyard :: Venkman JS Debugger
Bugs, problems, enhancements for the Venkman JavaScript Debugger tool.
[See Open Bugs in This Component](/buglist.cgi?product=Other%20Applications%20Graveyard&component=Venkman%20JS%20Debugger&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Other%20Applications%20Graveyard&component=Venkman%20JS%20Debugger&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Other%20Applications%20Graveyard&component=Venkman%20JS%20Debugger)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |

## People

### (Reporter: guninski, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/eb49beecdde375e0927ad6ebd7302ec1?d=mm&size=40)  [guninski](/user_profile?user_id=23768)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[324573](/show_bug.cgi?id=324573 "RESOLVED DUPLICATE - various issues in jsdch_aopen")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: fixed1.8.0.15, fixed1.8.1.8, Whiteboard: [sg:investigate] requires js debugger installed.)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[fixed1.8.0.15](/buglist.cgi?keywords=fixed1.8.0.15&resolution=---),
[fixed1.8.1.8](/buglist.cgi?keywords=fixed1.8.1.8&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:investigate] requires js debugger installed.

Change Request:

---

Bug Flags:

| [mtschrep](/user_profile?user_id=210162) | [blocking1.9](#c34 "17 years ago") | - |
| --- | --- | --- |
| [mtschrep](/user_profile?user_id=210162) | blocking1.9 | - |
| --- | --- | --- |
|  | sec-bounty | ? |
| --- | --- | --- |
|  | sec-bounty-hof |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [memory corruption](/attachment.cgi?id=210610)  [19 years ago](#c1)  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)   575 bytes, text/html |  | [Details](/attachment.cgi?id=210610&action=edit) |
| --- | --- | --- |
| [[checked in] Patch to change x-jsd to a DenyProtocol](/attachment.cgi?id=279337)  [17 years ago](#c18)  [:Gijs (he/him)](/user_profile?user_id=159069)   1.08 KB, patch | bzbarsky : [review+](#c20 "17 years ago")  bzbarsky : [superreview+](#c20 "17 years ago")  dveditz : [approval1.8.1.8+](#c0 "17 years ago")  caillon : [approval1.8.0.next+](#c0 "17 years ago") | [Details](/attachment.cgi?id=279337&action=edit) | [Diff](/attachment.cgi?id=279337&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=279337) |
| [Patch -w (reviewable)](/attachment.cgi?id=291766)  [17 years ago](#c26)  [:Gijs (he/him)](/user_profile?user_id=159069)   10.40 KB, patch | Biesinger : [review+](#c28 "17 years ago") | [Details](/attachment.cgi?id=291766&action=edit) | [Diff](/attachment.cgi?id=291766&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=291766) |
| [Patch](/attachment.cgi?id=291767)  [17 years ago](#c27)  [:Gijs (he/him)](/user_profile?user_id=159069)   12.01 KB, patch |  | [Details](/attachment.cgi?id=291767&action=edit) | [Diff](/attachment.cgi?id=291767&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=291767) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=325761#c0)• 19 years ago |
|  | |

there is a memory corruption in mozilla <object data='x-jsd:help'>
Mozilla 1.7.12
Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.7.12) Gecko/20060202
triggered by <object data='x-jsd:help'>
Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread -1218234688 (LWP 26508)]
0xb75c0de3 in XPTC\_InvokeByIndex () from /opt/mozilla-nightly/libxpcom.so
(gdb) x/i $eip
0xb75c0de3 <XPTC\_InvokeByIndex+39>: call \*(%edx)
(gdb) p/x $edx
$1 = 0x10
(gdb)
crash place/$eip seems to depend on previous actions.
win32 on wine also crashes.
testcase to follow.

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=325761#c1)• 19 years ago |
|  | |

Attached file
[memory corruption](attachment.cgi?id=210610)
— [Details](attachment.cgi?id=210610&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=325761#c2)• 19 years ago |
|  | |

Do you have venkman (the javascript debugger) installed? Just wondering if the corruption was from venkman-service.js, or happened even if not installed.

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=325761#c3)• 19 years ago |
|  | |

(In reply to [comment #2](/show_bug.cgi?id=325761#c2 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>"))
> Do you have venkman (the javascript debugger) installed? Just wondering if the
> corruption was from venkman-service.js, or happened even if not installed.
>
yes, have venkman jsd - default nightly install.

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=325761#c4)• 19 years ago |
|  | |

similar thunderbird related problem.
in html message:
<iframe src="mailbox://a@none.tld/?create>f00kb1l"></iframe>
(gdb) x/i $eip
0xb76db6ba <\_ZN18nsSimpleCharStringC1ERKS\_+26>: mov (%edx),%edx
(gdb) p/x $edx
$1 = 0x4
(gdb) info stack
#0 0xb76db6ba in nsSimpleCharString::nsSimpleCharString ()
from /opt/thunder-nightly/libxpcom\_compat.so
#1 0xb76ded8a in nsFileSpec::nsFileSpec ()
from /opt/thunder-nightly/libxpcom\_compat.so
#2 0xb76e255e in nsFileSpecImpl::nsFileSpecImpl ()
from /opt/thunder-nightly/libxpcom\_compat.so
#3 0xb76e2654 in nsFileSpecImpl::MakeInterface ()
from /opt/thunder-nightly/libxpcom\_compat.so
#4 0xb76e4daf in NS\_NewFileSpecWithSpec ()
from /opt/thunder-nightly/libxpcom\_compat.so
#5 0x08845523 in non-virtual thunk to nsRandomAccessInputStream::set\_at\_eof(int) ()
in case the stack is correct, nsFileSpecImpl::MakeInterface seems dangerous

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=325761#c5)• 19 years ago |
|  | |

i mean why at all the mailbox protocol tries to be loaded?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=325761#c6)• 19 years ago |
|  | |

> i mean why at all the mailbox protocol tries to be loaded?
Because it's just a protocol. Same for mailto:, etc. Known issue.
Is this a problem on trunk? Or would I need to debug on the 1.7 branch? :(

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=325761#c7)• 19 years ago |
|  | |

(In reply to [comment #6](/show_bug.cgi?id=325761#c6 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>"))
> > i mean why at all the mailbox protocol tries to be loaded?
>
> Because it's just a protocol. Same for mailto:, etc. Known issue.
>
i believe the security manager is supposed to block the mailbox protocol the same way for "file:" ?
iirc there have been cases in the past where actions were performed on user's mailbox via specific mailbox urls.
> Is this a problem on trunk? Or would I need to debug on the 1.7 branch? :(
>
looks like the mailbox problem (must be in mail message) affects both branch and trunk (thunderbird and seamonkey).
the jsd seems branch only, though not quite sure.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=325761#c8)• 19 years ago |
|  | |

> i believe the security manager is supposed to block the mailbox protocol
See [bug 305565](/show_bug.cgi?id=305565 "RESOLVED FIXED - <object> can be used to determine whether some types of local files exist"). It's fixed in 1.8, but apparently not in 1.7. And even then, it only disallows linking from other protocols, not from mailbox:// itself, no?
> looks like the mailbox problem (must be in mail message) affects both branch
> and trunk (thunderbird and seamonkey).
Probably worth a separate bug on mailnews (cc me, mscott).
> the jsd seems branch only, though not quite sure.
OK. :(

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=325761#c9)• 19 years ago |
|  | |

OK. So the jsd thing we're dying in GC. Presumably we have a dead object around or something... not sure yet.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=325761#c10)• 19 years ago |
|  | |

OK, so one obvious problem is that the asyncOpen impl for JSDChannel is ... not async. That would certainly cause various bustage....
I suspect that fixing that will fix this bug, but someone would need to actually post a jsd patch, I guess.
I also think we should:
1) Make it so only chrome can link to x-jsd (in the security manager)
2) Make it a priority for 1.9 (or even 1.8.1?) to let us ask protocol handlers
for such information.Assignee: general → rgindaComponent: General → JavaScript DebuggerProduct: Mozilla Application Suite → Other ApplicationsQA Contact: general → caillon

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=325761#c11)• 19 years ago |
|  | |

(In reply to [comment #8](/show_bug.cgi?id=325761#c8 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>"))
> > i believe the security manager is supposed to block the mailbox protocol
>
> See [bug 305565](/show_bug.cgi?id=305565 "RESOLVED FIXED - <object> can be used to determine whether some types of local files exist"). It's fixed in 1.8, but apparently not in 1.7. And even then,
> it only disallows linking from other protocols, not from mailbox:// itself, no?
can't see it.
>
> Probably worth a separate bug on mailnews (cc me, mscott).
>
will file a new bug, there are several strangenesses in mailbox, so probably the solution is to disable mailnews protocol.
iirc looking at code, there was a whitelist of safe internal protocol so either i am wrong or it is broken

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=325761#c12)• 19 years ago |
|  | |

(In reply to [comment #10](/show_bug.cgi?id=325761#c10 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>"))
> OK, so one obvious problem is that the asyncOpen impl for JSDChannel is ... not
> async. That would certainly cause various bustage....
>
can you comment on the exploitability of it - is it provable null dereference?

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=325761#c13)• 19 years ago |
|  | |

mailbox is [Bug 328454](/show_bug.cgi?id=328454 "RESOLVED FIXED - mailbox protocol in email message causes crash")

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=325761#c14)• 19 years ago |
|  | |

> can't see it.
I cced you.
> can you comment on the exploitability of it - is it provable null dereference?
It's more likely to be what you ran into -- a deleted object reference. :(

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=325761#c15)• 19 years ago |
|  | |

\*\*\* [Bug 324573](/show_bug.cgi?id=324573 "RESOLVED DUPLICATE - various issues in jsdch_aopen") has been marked as a duplicate of this bug. \*\*\*

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=325761#c16)• 17 years ago |
|  | |

To my knowledge, the 1.7 branch has been officially EOLed by now. bz, does Venkman still need something to do with this, or do we mark this invalid/fixed/something-else ?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=325761#c17)• 17 years ago |
|  | |

> bz, does Venkman still need something to do with this
Yes. This still gives memory corruption in 1.8 builds. And Venkman is violating the AsyncOpen contract: see [comment 10](/show_bug.cgi?id=325761#c10 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>").
On trunk untrusted content can't link to x-jsd URLs, but chrome and external apps can still do it (and then will get this sort of corruption).
So in brief:
1) On the 1.8 branch you need to change CheckLoadURI to make this a DenyProtocol.
2) You need to fix your broken AsyncOpen impl.Severity: normal → criticalVersion: 1.7 Branch → Trunk

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=325761#c18)• 17 years ago |
|  | |

Attached patch

[[checked in] Patch to change x-jsd to a DenyProtocol](attachment.cgi?id=279337&action=diff) (obsolete)
— [Details](attachment.cgi?id=279337&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=279337)

Not sure who I should ask for superreview (do I need to?).
Either way, r? on you, bz :-).
I'll look at the necessary venkman changes in a bit - probably not going to be as easy.Assignee: rginda → gijskruitbosch+bugsStatus: NEW → ASSIGNED
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: review?(bzbarsky)
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: approval1.8.1.7?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=325761#c19)• 17 years ago |
|  | |

I'm not a peer for that module.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=325761#c20)• 17 years ago |
|  | |

Comment on [attachment 279337](/attachment.cgi?id=279337 "[checked in] Patch to change x-jsd to a DenyProtocol") [[details]](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") [[diff]](/attachment.cgi?id=279337&action=diff "[checked in] Patch to change x-jsd to a DenyProtocol") [[review]](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=279337)
[checked in] Patch to change x-jsd to a DenyProtocol
r+sr=a=me
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: superreview+
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: review?(bzbarsky)
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: review+
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: approval1.9+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=325761#c21)• 17 years ago |
|  | |

Comment on [attachment 279337](/attachment.cgi?id=279337 "[checked in] Patch to change x-jsd to a DenyProtocol") [[details]](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") [[diff]](/attachment.cgi?id=279337&action=diff "[checked in] Patch to change x-jsd to a DenyProtocol") [[review]](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=279337)
[checked in] Patch to change x-jsd to a DenyProtocol
approval1.9=bz, really? This wouldn't apply to the trunk, and this aspect appears to be handled on trunk already: <http://bonsai.mozilla.org/cvsblame.cgi?file=mozilla/extensions/venkman/js/venkman-service.js&rev=1.16&mark=284#277>
approved for 1.8.1.7, a=dveditz
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: approval1.9+
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: approval1.8.1.7?
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: approval1.8.1.7+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=325761#c22)• 17 years ago |
|  | |

Yeah, I got carried away....

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=325761#c23)• 17 years ago |
|  | |

Checking in mozilla/caps/src/nsScriptSecurityManager.cpp;
/cvsroot/mozilla/caps/src/nsScriptSecurityManager.cpp,v <-- nsScriptSecurityManager.cpp
new revision: 1.266.2.19; previous revision: 1.266.2.18
done
Keywords: [fixed1.8.1.7](/buglist.cgi?keywords=fixed1.8.1.7&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=325761#a49950301_159069)• 17 years ago |

[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Attachment description: Patch to change x-jsd to a DenyProtocol → [checked in] Patch to change x-jsd to a DenyProtocol
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=325761#c24)• 17 years ago |
|  | |

I assume the bug remains open to deal with the non-async AsyncOpen?Whiteboard: [sg:critical?] requires js debugger installed.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=325761#c25)• 17 years ago |
|  | |

(In reply to [comment #24](/show_bug.cgi?id=325761#c24 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>"))
> I assume the bug remains open to deal with the non-async AsyncOpen?
>
Yes. I have a half-finished patch somewhere on my machine, it's a hard problem, I'm busy, and it's not exceptionally high on my priority list. If someone wants to take it and thinks they'll fix it within the next month or so, they probably should.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=325761#c26)• 17 years ago |
|  | |

Attached patch

[Patch -w (reviewable)](attachment.cgi?id=291766&action=diff)
— [Details](attachment.cgi?id=291766&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=291766)

This should do, I believe. It's not very pretty, but to be honest I couldn't quite figure out how to do this Better.
The only question I have left is whether the callback timer should be calling onStopRequest immediately. I'm not sure how the interaction with the content handler defined later works here, so I was a bit cautious to touch any of it. AFAICT calling onStopRequest from the content handler is Hard as we don't know which channel invoked it, and may therefor not be able to figure out the context for that call. But maybe I'm missing something.
Also, my lack of understanding of the aforementioned interaction between the JSDChannel and JSDContentHandler stopped me from using an input stream pump for that case as well... If that's possible, I think it's probably still a better solution than this nsITimer hackery.
r? on a netwerk peer as they seem most likely to be able to figure out what the heck is \*supposed\* to happen. I'll request review from jsd/venkman people afterwards.
[Attachment #291766](/attachment.cgi?id=291766&action=edit "Patch -w (reviewable)") -
Flags: review?(cbiesinger)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=325761#c27)• 17 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=291767&action=diff)
— [Details](attachment.cgi?id=291767&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=291767)

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=325761#c28)• 17 years ago |
|  | |

Comment on [attachment 291766](/attachment.cgi?id=291766 "Patch -w (reviewable)") [[details]](/attachment.cgi?id=291766&action=edit "Patch -w (reviewable)") [[diff]](/attachment.cgi?id=291766&action=diff "Patch -w (reviewable)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=291766)
Patch -w (reviewable)
- !iid.equals(nsISupports))
+ !iid.equals(nsISupports) && !iid.equals(nsIRequestObserver) &&
+ !iid.equals(nsIStreamListener))
I'd have kept nsISupports at the end, but it's your module :)
+ this.streamListener.onDataAvailable(this, this.context, this.stringStream,
+ offset, count);
that looks somewhat strange and I'm not sure it will necessarily work correctly. just pass on inputstream here instead of this.stringStream.
+OpenVnkListener.prototype.QueryInterface =
you don't need this, though I guess it doesn't harm to have it
+ //XXXgijs: call onStopRequest here?
yes. you must do that.
and you should also remove the channel from the loadgroup or the throbber will never stop.
+ // Null out to stop leaks:
if it's necessary here to prevent leaks, shouldn't jsdch\_onstoprequest also do it?
is there a reason that you're naming the context this.myContext here while it's this.context in JSDChannel? prefixing properties of this with "my" seems redundant.
[Attachment #291766](/attachment.cgi?id=291766&action=edit "Patch -w (reviewable)") -
Flags: review?(cbiesinger) → review+

|  | [Christian :Biesinger (don't email me, ping me on IRC)](/user_profile?user_id=15661) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=325761#c29)• 17 years ago |
|  | |

and fwiw, you can't call onStopRequest from the content handler. you can't be sure that it was an x-jsd channel that triggered it.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=325761#c30)• 17 years ago |
|  | |

(In reply to [comment #29](/show_bug.cgi?id=325761#c29 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>"))
> and fwiw, you can't call onStopRequest from the content handler. you can't be
> sure that it was an x-jsd channel that triggered it.
>
Yeah, that's exactly what I was struggling with. I'm not sure how the handoff from the JSDChannel to the content handler works, exactly, and whether or not I could get away with just calling onStopRequest immediately after calling onStartRequest. I would guess not, but if that's not possible, then where else am I supposed to do it? :-(

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=325761#c31)• 17 years ago |
|  | |

anyone know if this is a problem on the current trunk? does a patch need to land there? marking as a blocker for 1.9 until we know fore sure. go ahead and minus if this is branch only.Flags: blocking1.9?

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=325761#c32)• 17 years ago |
|  | |

trunk and 1.1.7 seem safe.
x-jsd: doesn't load at all - this seems sane:
Security Error: Content at <http://localhost:8080/bugjsd.html> may not load or link to x-jsd:help.

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=325761#c33)• 17 years ago |
|  | |

in addition manually loading x-jsd:help doesn't crash, just whines in js console

|  | [Mike Schroepfer](/user_profile?user_id=210162) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=325761#c34)• 17 years ago |
|  | |

Given [comment 32](/show_bug.cgi?id=325761#c32 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>") and [comment 33](/show_bug.cgi?id=325761#c33 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>") taking off the FF3 blocker list. Please re-nom if you ahve new dataFlags: blocking1.9? → blocking1.9-

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=325761#c35)• 17 years ago |
|  | |

biesi: could you give some advice re: [comment #30](/show_bug.cgi?id=325761#c30 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>")? That way I can come up with an updated patch to get this out of the world. :-)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=325761#c36)• 17 years ago |
|  | |

Looks like this is no longer critical because the protocol handler is not exposed to content. How serious is the remaining problem (in a security sense)?Whiteboard: [sg:critical?] requires js debugger installed. → [sg:investigate] requires js debugger installed.

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=325761#c37)• 17 years ago |
|  | |

i suppose this bug is fixed not counting disabling the protocol.
one way to reproduce something similar to it now is to trick the user to paste in location bar "x-jsd:help" - it displays debugger help if debugger is running

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=325761#c38)• 17 years ago |
|  | |

x-jsd:help invokes user supplied RegExp. do regexp-s allow code execution?

|  | [Alexander Sack](/user_profile?user_id=113760) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=325761#c39)• 17 years ago |
|  | |

Comment on [attachment 279337](/attachment.cgi?id=279337 "[checked in] Patch to change x-jsd to a DenyProtocol") [[details]](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") [[diff]](/attachment.cgi?id=279337&action=diff "[checked in] Patch to change x-jsd to a DenyProtocol") [[review]](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=279337)
[checked in] Patch to change x-jsd to a DenyProtocol
we have this in distro patches. requesting approval for 1.8.0.15.
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: approval1.8.0.15?

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=325761#c40)• 17 years ago |
|  | |

Comment on [attachment 279337](/attachment.cgi?id=279337 "[checked in] Patch to change x-jsd to a DenyProtocol") [[details]](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") [[diff]](/attachment.cgi?id=279337&action=diff "[checked in] Patch to change x-jsd to a DenyProtocol") [[review]](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=279337)
[checked in] Patch to change x-jsd to a DenyProtocol
a=caillon for 1.8.0.15
[Attachment #279337](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") -
Flags: approval1.8.0.15? → approval1.8.0.15+

|  | [Christopher Aillon (sabbatical, not receiving bugmail)](/user_profile?user_id=32335) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=325761#c41)• 17 years ago |
|  | |

Committed [attachment 279337](/attachment.cgi?id=279337 "[checked in] Patch to change x-jsd to a DenyProtocol") [[details]](/attachment.cgi?id=279337&action=edit "[checked in] Patch to change x-jsd to a DenyProtocol") [[diff]](/attachment.cgi?id=279337&action=diff "[checked in] Patch to change x-jsd to a DenyProtocol") [[review]](/page.cgi?id=splinter.html&ignore=&bug=325761&attachment=279337) to the 1.8.0 branchKeywords: [fixed1.8.0.15](/buglist.cgi?keywords=fixed1.8.0.15&resolution=---)

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=325761#a71009169_15223)• 17 years ago |

QA Contact: caillon → venkman

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=325761#c42)• 15 years ago |
|  | |

Sounds like this was FIXED, but I'm not sure.Status: ASSIGNED → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=325761#a129891100_1689)• 15 years ago |

Group: core-security

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=325761#c43)• 15 years ago |
|  | |

(In reply to [comment #42](/show_bug.cgi?id=325761#c42 "RESOLVED FIXED - memory corruption in mozilla <object data='x-jsd:help'>"))
> Sounds like this was FIXED, but I'm not sure.
Technically, the asyncopen contract is still violated by the current cmdline handler, I think. :-(

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=325761#a400730533_546015)• 6 years ago |

Product: Other Applications → Other Applications Graveyard
You need to [log in](/show_bug.cgi?id=325761&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


