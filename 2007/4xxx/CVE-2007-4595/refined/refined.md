Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2007-4595

**Root Cause of Vulnerability:**
The root cause is a lack of proper character set handling in the Mayaa template engine when processing user-supplied parameters, making it vulnerable to Cross-Site Scripting (XSS).

**Weaknesses/Vulnerabilities Present:**
- **Cross-Site Scripting (XSS):**  The application fails to sanitize or properly encode user-supplied data before including it in the generated HTML output.
- **Improper Character Set Handling:** The application does not enforce a specific character set for templates, or it uses a character set that is not universally recognized by web browsers.  Specifically:
  - If the template does not specify a character set in its meta tag.
  - If the template specifies a character set that the web browser does not recognize.

**Impact of Exploitation:**
- An attacker can inject malicious scripts into web pages rendered by Mayaa.
- Successful exploitation could allow the attacker to:
  - Steal session cookies
  - Redirect users to malicious sites
  - Modify the content of the web page
  - Perform other client-side attacks

**Attack Vectors:**
- **HTTP Parameter Injection:** An attacker can inject malicious scripts via HTTP request parameters that are subsequently rendered on the web page without proper encoding or sanitization.
- **Character Set Manipulation:** Attackers can utilize character sets different from the template's to inject the script which could then be executed by the user's browser

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send crafted HTTP requests containing malicious scripts.
- No specific authentication is required.
- The attacker's code will be executed within the context of the vulnerable web application

**Additional Details from the provided content:**
- The vulnerability affects Mayaa versions 1.1.11 and earlier.
- The vulnerability is related to the way Mayaa handles character sets in templates.
- If the template does not specify the character set, or if it specifies a character set not recognized by the web browser, an attacker can inject malicious scripts using a different character set, such as UTF-7, and leverage the browser's auto-detection to execute the injected script.
- The provided content also notes issues with the usage of "Shift\_JIS" and recommends using "Windows-31J" when reading template files created on Japanese Windows systems while outputting "Shift\_JIS" in the HTML meta tag to avoid issues with older Internet Explorer versions. This is resolved by setting the `convertCharset` parameter to `true`.
- The vulnerability was reported by Mr. Hiroki Fukumori of SecureSky Technology, Inc.