=== Content from struts.apache.org_02ee2380_20250125_054216.html ===


[Log in](https://cwiki.apache.org/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-001)
[Skip to sidebar](#nav-sidebar)
[Skip to main content](#main)
Linked ApplicationsLoading...[Apache Software Foundation](/confluence/)

* [Spaces](/confluence/spacedirectory/view.action "Spaces")

* Hit enter to search
* Help
  + [Online Help](https://docs.atlassian.com/confluence/docs-719/ "Visit the Confluence documentation home")
  + [Keyboard Shortcuts](/confluence "View available keyboard shortcuts")
  + [Feed Builder](/confluence/dashboard/configurerssfeed.action "Create your custom RSS feed.")
  + [What’s new](https://docs.atlassian.com/confluence/docs-719/help.whats.new.iframe.link)
  + [What’s new](https://confluence.atlassian.com/display/DOC/Confluence%2B7.19%2BRelease%2BNotes)
  + [Available Gadgets](/confluence "Browse gadgets provided by Confluence")
  + [About Confluence](/confluence/aboutconfluencepage.action "Get more information about Confluence")
* * [Log in](/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-001)

[![Apache Struts 2 Wiki](/confluence/images/logo/default-space-logo.svg)](/confluence/display/WW/Home "Apache Struts 2 Wiki")[Apache Struts 2 Wiki](/confluence/display/WW/Home "Apache Struts 2 Wiki")
##### Child pages

* [Security Bulletins](/confluence/display/WW/Security%2BBulletins "Security Bulletins")

* S2-001
Browse pagesConfigureSpace tools

* + [Attachments (0)](/confluence/pages/viewpageattachments.action?pageId=61776 "View Attachments")
  + [Page History](/confluence/pages/viewpreviousversions.action?pageId=61776)
  + [Resolved comments](/confluence)
  + [Page Information](/confluence/pages/viewinfo.action?pageId=61776)
  + [View in Hierarchy](/confluence/pages/reorderpages.action?key=WW&openId=61776#selectedPageInHierarchy)
  + [View Source](/confluence/plugins/viewsource/viewpagesrc.action?pageId=61776)
  + [Delete comments](/confluence/plugins/aptis/deleteAllComments/ask-user.action?pageId=61776)
  + [Export to PDF](/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=61776)
  + [Export to Word](/confluence/exportword?pageId=61776)
  + [Copy Page Tree](/confluence/plugins/tree-copy/preparing-copying.action?pageId=61776)

1. [Pages](/confluence/collector/pages.action?key=WW)- [Home](/confluence/display/WW/Home)- [Security Bulletins](/confluence/display/WW/Security%2BBulletins)

* Jira links
# [S2-001](/confluence/display/WW/S2-001)

* Created by  [Donald J. Brown](/confluence/display/~mrdon), last modified by  [Ted Husted](/confluence/display/~husted) on [Jul 23, 2007](/confluence/pages/diffpagesbyversion.action?pageId=61776&selectedPageVersions=5&selectedPageVersions=6 "Show changes")

## Summary

Remote code exploit on form validation error

| Who should read this | All Struts 2 developers |
| --- | --- |
| Impact of vulnerability | Remote code execution |
| Maximum security rating | Critical |
| Recommendation | Developers should immediately upgrade to [Struts 2.0.9](http://people.apache.org/builds/struts/2.0.9/) or upgrade to [XWork 2.0.4](http://www.opensymphony.com/xwork/download.action) |
| Affected Software | WebWork 2.1 (with altSyntax enabled), WebWork 2.2.0 - WebWork 2.2.5, Struts 2.0.0 - Struts 2.0.8 |
| Non-Affected Software | WebWork 2.0, WebWork 2.1 (with altSyntax disabled, which is the default) |
| Original JIRA Ticket | [WW-2030](http://issues.apache.org/struts/browse/WW-2030) |

## Problem

The 'altSyntax' feature of WebWork 2.1+ and Struts 2 allows OGNL expressions to be inserted into text strings and is processed recursively. This allows a malicious user to submit a string, usually through an HTML text field, containing an OGNL expression that will then be executed by the server if the form validation has failed. For example, say we had this form that required the 'phoneNumber' field to not be blank:

```

<s:form action="editUser">
  <s:textfield name="name" />
  <s:textfield name="phoneNumber" />
</s:form>

```

The user could leave the 'phoneNumber' field blank to trigger the validation error, then populate the 'name' field with %{1+1}. When the form is re-displayed to the user, the value of the 'name' field will be '2'. The reason is the value field is, by default, processed as %{name}, and since OGNL expressions are evaluated recursively, it is evaluated as if the expression was %{%{1+1}}.

The OGNL parsing code is actually in XWork and not in WebWork 2 or Struts 2.

## Solution

As of XWork 2.0.4, the OGNL parsing is changed so that it is not recursive. Therefore, in the example above, the result will be the expected %{1+1}. You can either obtain the [WebWork 2.0.4](http://www.opensymphony.com/webwork/download.action) or [Struts 2.0.9](http://people.apache.org/builds/struts/2.0.9/), which contains the corrected XWork library. Alternatively, you can obtain the patch and apply it to the XWork source code yourself.

* No labels

Overview
Content Tools
Apps

Powered by a free **Atlassian Confluence Open Source Project License** granted to Apache Software Foundation. [Evaluate Confluence today](https://www.atlassian.com/software/views/opensource-community-additional-license-offer).

* Powered by [Atlassian Confluence](https://www.atlassian.com/software/confluence) 7.19.30
* Printed by Atlassian Confluence 7.19.30
* [Report a bug](https://support.atlassian.com/confluence-server/)
* [Atlassian News](https://www.atlassian.com/company)

[Atlassian](https://www.atlassian.com/)

{"serverDuration": 71, "requestCorrelationId": "e024fabeaf740ca9"}


=== Content from www.vupen.com_72acd5b5_20250125_054216.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from www.vupen.com_e654d6b7_20250125_054216.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


