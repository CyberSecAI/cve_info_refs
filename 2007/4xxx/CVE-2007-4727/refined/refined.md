```
{
  "cve": "CVE-2007-4727",
  "description": "Buffer overflow in the fcgi_env_add function in mod_proxy_backend_fastcgi.c in the mod_fastcgi extension in lighttpd before 1.4.18 allows remote attackers to overwrite arbitrary CGI variables and execute arbitrary code via an HTTP request with a long content length, as demonstrated by overwriting the SCRIPT_FILENAME variable, aka a \"header overflow.\"",
  "vulnerability_details": {
    "root_cause": "The `fcgi_env_add` function in `mod_fastcgi.c` does not properly validate the length of the HTTP headers, leading to a buffer overflow when processing overly long headers.",
    "weaknesses": [
      "Improper Restriction of Operations within the Bounds of a Memory Buffer (CWE-119)"
    ],
    "impact": "Remote attackers can overwrite arbitrary CGI variables and execute arbitrary code with the privileges of the user running the web server. This can lead to full system compromise.",
    "attack_vectors": "A remote attacker sends a specially crafted HTTP request with an overly long content length to the vulnerable Lighttpd server. This long content length triggers a buffer overflow when the server processes the request, allowing an attacker to overwrite CGI variables.",
    "attacker_capabilities": "The attacker needs to be able to send HTTP requests to the vulnerable server. No authentication is required."
  },
  "affected_software": [
    {
      "name": "lighttpd",
      "versions": "< 1.4.18"
    }
  ],
  "exploitation": {
    "example": "An attacker could overwrite the `SCRIPT_FILENAME` variable to execute arbitrary code.",
    "complexity": "Medium"
  },
  "cvss": {
    "base_score": "6.8/10",
     "vector": "(AV:N/AC:M/Au:N/C:P/I:P/A:P)"
  },
  "remediation": "Upgrade to lighttpd version 1.4.18 or apply the `lighttpd-1.4.x_mod_fastcgi_overrun.patch`."
}
```