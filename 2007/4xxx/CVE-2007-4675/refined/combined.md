=== Content from blog.48bits.com_0c9b681b_20250125_123246.html ===


* [48Bits Blog](https://blog.48bits.com "48Bits ‚Ä¶ The one and a half architecture land.")

  [48Bits Mail](http://mail.48bits.com/ "48Bits Mail")

---

**Random IRC quote :** *me la follo como a un melÔøΩn*
[Los otros bugs‚Ä¶](https://blog.48bits.com/los-otros-bugs/)
[radare ‚Äì patrocinado por el papa espacial](https://blog.48bits.com/radare-patrocinado-por-el-papa-espacial/)

## [Bugs en Apple QuickTime y advisory de Microsoft para secdrv.sys](https://blog.48bits.com/bugs-en-apple-quicktime-y-advisory-de-microsoft-para-secdrvsys/)

Hola,

Esta semana se han hecho p√∫blicas una serie de [vulnerabilidades](http://docs.info.apple.com/article.html?artnum=306896) a raiz de la actualizaci√≥n de QuickTime a su [![QTGeist](http://blog.48bits.com/wp-content/uploads/2007/11/qt.thumbnail.JPG "QTGeist")](http://blog.48bits.com/wp-content/uploads/2007/11/qt.JPG "QTGeist")versi√≥n 7.3, como comentabamos en otros posts este producto parece estar d√°ndole guerra a Apple en cuanto a temas de seguridad se refiere.

A continuaci√≥n os pongo las referencias a las vulnerabilidades que hemos descubierto entre Rub√©n (reversemode) y yo, son cinco en total, tres de ellas de Rub√©n, otra m√≠a y una compartida entre los dos:

**Apple QuickTime Panorama Sample Atom Heap Buffer Overflow Vulnerability** :

[48Bits advisory](http://www.48bits.com/advisories/qt_pdat_heapbof.pdf)

[iDefense advisory](http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=620)

**Apple QuickTime Uncompressedfile Opcode Stack Overflow Vulnerability :**

[ZDI advisory](http://www.zerodayinitiative.com/advisories/ZDI-07-068.html)

**Apple QuickTime PICT File Poly Opcodes Heap Corruption Vulnerability :**

[ZDI advisory](http://www.zerodayinitiative.com/advisories/ZDI-07-067.html)

**Apple Quicktime PICT File PackBitsRgn Parsing Heap Corruption Vulnerability :**

[ZDI advisory](http://www.zerodayinitiative.com/advisories/ZDI-07-066.html)

**Apple QuickTime Color Table RGB Parsing Heap Corruption Vulnerability :**

[ZDI advisory](http://www.zerodayinitiative.com/advisories/ZDI-07-065.html)

Por otro lado Microsoft ha hecho p√∫blico un advisory para la vulnerabilidad que comentabamos hace unos d√≠as en el driver de Macrovisi√≥n, parece que [acertamos](http://blog.48bits.com/?p=172)! üòâ . Macrovisi√≥n ha actualizado ya el driver y est√° disponible en su sitio web, parece que Microsoft distribuir√° la actualizaci√≥n este martes :

[MSRC Blog post](http://blogs.technet.com/msrc/archive/2007/11/05/vulnerability-in-macrovision-secdrv-sys-driver-on-windows-xp-and-windows-2003.aspx)

[Microsoft advisory](http://www.microsoft.com/technet/security/advisory/944653.mspx)

Un saludo a todos y buen fin de semana !,

Mario

Por: Mario Ballano | [11/10/07](https://blog.48bits.com/bugs-en-apple-quicktime-y-advisory-de-microsoft-para-secdrvsys/) | [Noticias](https://blog.48bits.com/category/noticias/) | [Trackback](https://blog.48bits.com/bugs-en-apple-quicktime-y-advisory-de-microsoft-para-secdrvsys/trackback/) | [Comentarios [RSS 2.0]](https://blog.48bits.com/bugs-en-apple-quicktime-y-advisory-de-microsoft-para-secdrvsys/feed/)

### 3 Comentarios para ‚ÄúBugs en Apple QuickTime y advisory de Microsoft para secdrv.sys‚Äù

1. [Trancek](#comment-40197)

   Comment por [Trancek](http://www.trancek.es "Trancek") | 11/13/07 at 12:44 am

   Muy buenas esas vulnerabilidades que habeis encontrado jejeje, llevo pasandome un tiempo y me parece un sitio bastante bueno en cuanto a calidad de contenido, seguir as√≠, felicidades!!
2. [miguel](#comment-40198)

   Comment por [miguel](http://www.48bits.com "miguel") | 11/13/07 at 5:04 pm

   Muy buen trabajo

   Felicidades para ambos

   Y a seguir asi

   :o)

   Riau
3. [Amian](#comment-40199)

   Comment por Amian | 11/15/07 at 1:21 am

   Orale a seguir chingando los bugs weys, soys la cacerola! Aprieta la pizza!

### Se han cerrado los comentarios

48Bits Blog is proudly powered by [WordPress](http://wordpress.org "state-of-the-art semantic personal publishing platform") & [equiX](http://marcoss.com.ar/dsgn/equix/ "|X| - One Theme to Rule Them All").

Code is Poetry | [CSS](http://jigsaw.w3.org/css-validator/check/referer "Valid CSS!") | [XHTML](http://validator.w3.org/check?uri=referer "Valid XHTML 1.0!")



=== Content from secunia.com_0dc06896_20250125_123250.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner¬Æ

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera‚Äôs 2025 IT Priorities Report highlight what‚Äôs top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world‚Äôs best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world‚Äôs best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft‚Äôs Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren‚Äôt normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow¬Æ investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

¬© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

√ó

...



=== Content from www.48bits.com_8c836c4b_20250125_123252.html ===
[48Bits Advisory] QuickTime Panorama Sample Atom Heap Overflow
Mario Ballano B√°rcena ( mballano[_at_]gmail.com )

Abstract

QuickTime is prone to a heap overflow vulnerability when parsing malformed Panorama Sample Atoms, which are used in QuickTime Virtual Reality
Movies. This Vulnerability allows attackers to execute code on vulnerable installations. Successful exploitation via Web Browser requires that the
attacker should trick the user into visiting a specially crafted webpage.

Affected versions :

Tested with QuickTime VR extension 7.2.0.240 included with QuickTime Player 7.2

Analysis :

QuickTime file format structure :

QuickTime files are built using atom containers, which are the basic unit of information. Each Atom
has an atom header containing the following fields:

- Atom Size. (uint32)
- Type. (uint32)
- Extended size. (uint64, not always present)

Before the header each atom has its own structure.

QuickTime VR technology :

From Wikipedia :

"QuickTime VR (virtual reality) (also known as QTVR) is a type of image file format supported by Apple's QuickTime. It allows the creation and
viewing of photographically captured panoramas and the exploration of objects through images taken at multiple viewing angles. It functions as a
plugin for the standalone QuickTime Player, as well as working as a plugin for the QuickTime Web browser plugin. QuickTime VR will play on
Windows computers as well as Apple Macintosh computers.

Apple continues to include QuickTime VR in its QuickTime technology. Many software companies create authoring applications to create QuickTime
VR content."

Panorama Sample Atom structure :

From Apple's QuickTime File Format Reference :

"A panorama sample atom has an atom type of kQTVRPanoSampleDataAtomType ('pdat'). It describes a single panorama, including track reference
indexes of the scene and hot spot tracks and information about the default viewing angles and the source panoramic image. The structure of a
panorama sample atom is defined by the QTVRPanoSampleAtom data type:

typedef struct VRPanoSampleAtom {
    UInt16 majorVersion;
    UInt16 minorVersion;
    UInt32 imageRefTrackIndex;
    UInt32 hotSpotRefTrackIndex;
    Float32 minPan;
    Float32 maxPan;
    Float32 minTilt;
    Float32 maxTilt;
    Float32 minFieldOfView;
    Float32 maxFieldOfView;
    Float32 defaultPan;
    Float32 defaultTilt;
    Float32 defaultFieldOfView;
    UInt32 imageSizeX;
    UInt32 imageSizeY;
    UInt16 imageNumFramesX;
    UInt16 imageNumFramesY;
    UInt32 hotSpotSizeX;
    UInt32 hotSpotSizeY;
    UInt16 hotSpotNumFramesX;
    UInt16 hotSpotNumFramesY;
    UInt32 flags;
    OSType panoType;
    UInt32 reserved2;
} VRPanoSampleAtom, *VRPanoSampleAtomPtr; "

Disassemblies and analysis:

QuickTimeVR.qtx parses VR Atoms :

.text:67635DC0                 mov     ebp, [edi+0C2h]
.text:67635DC6                 push    ebp
.text:67635DC7                 mov     [esp+40h+var_18], ebp
.text:67635DCB                 call    sub_6765DA90
.text:67635DD0                 push    0
.text:67635DD2                 push    1
.text:67635DD4                 push    'pdat'        ; <- Panorama Sample Atom
.text:67635DD9                 push    0
.text:67635DDB                 push    ebp
.text:67635DDC                 call    GetAtom
.text:67635DE1                 mov     ebx, eax
.text:67635DE3                 add     esp, 18h
.text:67635DE6                 test    ebx, ebx
.text:67635DE8                 jz      loc_67636775
.text:67635DEE                 push    0
.text:67635DF0                 lea     edx, [esp+40h+arg_0]
.text:67635DF4                 push    edx
.text:67635DF5                 push    ebx
.text:67635DF6                 push    ebp
.text:67635DF7                 call    QT_dispatch_f1
.text:67635DFC                 add     esp, 10h
.text:67635DFF                 test    ax, ax
.text:67635E02                 mov     [esp+3Ch+var_28], eax
.text:67635E06                 jnz     loc_6763677D
.text:67635E0C                 mov     eax, [esp+3Ch+arg_0] <- Size of Atom
.text:67635E10                 push    0
.text:67635E12                 push    esi
.text:67635E13                 push    eax
.text:67635E14                 push    0
.text:67635E16                 push    ebx
.text:67635E17                 push    ebp
.text:67635E18                 call    QT_dispatch_f2  ; ends copying Atom with a funcion inside QuickTime.qts with wrong size

The atom gets copied using a wrapper for an statically compiled memcpy function inside QuickTime.qts :

.text:668DB8A0 ; int __cdecl memcpy_wrapper(void *Src,void *Dst,size_t Size)
.text:668DB8A0 memcpy_wrapper  proc near
.text:668DB8A0
.text:668DB8A0
.text:668DB8A0 Src             = dword ptr  4
.text:668DB8A0 Dst             = dword ptr  8
.text:668DB8A0 Size            = dword ptr  0Ch
.text:668DB8A0
.text:668DB8A0                 mov     eax, [esp+Size]
.text:668DB8A4                 mov     ecx, [esp+Src]
.text:668DB8A8                 mov     edx, [esp+Dst]
.text:668DB8AC                 push    eax             ; Size
.text:668DB8AD                 push    ecx             ; Src
.text:668DB8AE                 push    edx             ; Dst
.text:668DB8AF                 call    _memcpy
.text:668DB8B4                 add     esp, 0Ch
.text:668DB8B7                 retn
.text:668DB8B7 memcpy_wrapper  endp

Destination buffer has a fixed size, we can build a malformed Panorama Sample Atom specifying a big value in its size field at the header, resulting
in a heap corruption when atom gets copied.

There is a problem when trying to exploit it, because the heap gets overwritten with random data values, perhaps some kind of heap feng-shui could
allow a smart way to control this, but I think exploitation could be more reliable using other way :

Within the values we can ovewrite in the heap we can control a pointer which will be used later as parameter for a statically compiled free() :

.text:668DC4E0 free            proc near
.text:668DC4E0
.text:668DC4E0
.text:668DC4E0 arg_0           = dword ptr  4
.text:668DC4E0
.text:668DC4E0                 mov     eax, [esp+arg_0]
.text:668DC4E4                 test    eax, eax
.text:668DC4E6                 jnz     short not_null
.text:668DC4E8                 mov     ax, 65427
.text:668DC4EC                 retn
.text:668DC4ED ; ---------------------------------------------------------------------------
.text:668DC4ED
.text:668DC4ED not_null:
.text:668DC4ED                 mov     edx, [eax+4]    ; edx = lpmem->snd_field
.text:668DC4F0                 xor     ecx, ecx
.text:668DC4F2                 cmp     edx, eax          ; edx == edx->snd_filed ?
.text:668DC4F4                 setnz   cl
.text:668DC4F7                 push    esi
.text:668DC4F8                 dec     ecx
.text:668DC4F9                 and     ecx, eax
.text:668DC4FB                 mov     esi, ecx
.text:668DC4FD                 jz      short loc_668DC537
.text:668DC4FF                 test    byte ptr [esi+0Dh], 8
.text:668DC503                 jnz     short loc_668DC537
.text:668DC505                 push    esi
.text:668DC506                 call    sub_668DBDB0
.text:668DC50B                 mov     eax, [esi]
.text:668DC50D                 add     esp, 4
.text:668DC510                 test    eax, eax
.text:668DC512                 jz      short loc_668DC529
.text:668DC514                 push    eax
.text:668DC515                 call    sub_668DBAB0
.text:668DC51A                 mov     edx, [esi+8]
.text:668DC51D                 mov     eax, [esi]
.text:668DC51F                 push    edx             ; int
.text:668DC520                 push    eax             ; lpMem
.text:668DC521                 call    sub_668DB590
.text:668DC526                 add     esp, 0Ch
.text:668DC529
.text:668DC529 loc_668DC529:
.text:668DC529                 push    esi
.text:668DC52A                 call    sub_668DB5E0
.text:668DC52F                 add     esp, 4
.text:668DC532                 xor     ax, ax
.text:668DC535                 pop     esi
.text:668DC536                 retn
.text:668DC537 ; ---------------------------------------------------------------------------
.text:668DC537
.text:668DC537 loc_668DC537:
.text:668DC537
.text:668DC537                 mov     ax, 0FF91h
.text:668DC53B                 pop     esi
.text:668DC53C                 retn
.text:668DC53C free           endp

This pointer is located at AtomStart + 0x9C . In order to exploit this we must use a specially crafted structure and overwrite this pointer with its
address. I've done it using heap spraying as a Proof of Concept.

Attack Vectors :

‚Ä¢ Quicktime WebBrowser Plugin (remote!)
‚Ä¢ Quicktime Player
‚Ä¢ Quicktime PictureViewer

References:

‚Ä¢ QuickTime File Format : http://developer.apple.com/documentation/QuickTime/QTFF/index.html
‚Ä¢ QuickTime VR Technology (Apple) : http://www.apple.com/quicktime/technologies/qtvr/
‚Ä¢ QuickTime VR Technology (Wikipedia) : http://en.wikipedia.org/wiki/QuickTime_VR
‚Ä¢
‚Ä¢
‚Ä¢

iDefense Advisory : http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=620
CVE : http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4675
Apple Advisory : http://docs.info.apple.com/article.html?artnum=306896

Credit:

Analysis performed and vulnerability discovered by Mario Ballano B√°rcena from 48bits.com



=== Content from www.vupen.com_bc6c77ca_20250125_123255.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

¬© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


