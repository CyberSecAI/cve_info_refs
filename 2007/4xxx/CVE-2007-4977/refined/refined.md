```
{
  "CVE-2007-4977": {
    "related_content": true,
    "summary": "Coppermine <= 1.4.12 suffers from a local file inclusion vulnerability due to improper sanitization of the 'log' parameter in the viewlog.php script. Additionally, a cross-site scripting (XSS) vulnerability exists due to improper sanitization of the 'referer' parameter in mode.php.",
    "root_cause": "The script viewlog.php does not properly sanitize the 'log' parameter, and the script mode.php does not properly sanitize the 'referer' parameter.",
    "vulnerabilities": [
      "Local File Inclusion (LFI)",
      "Cross-Site Scripting (XSS)"
    ],
    "impact": "An attacker could potentially read sensitive files from the server using the LFI vulnerability and execute arbitrary JavaScript code in the user's browser using the XSS vulnerability. The LFI vulnerability requires admin privileges to exploit.",
    "attack_vectors": {
      "LFI": "The 'log' parameter in the viewlog.php script.",
      "XSS": "The 'referer' parameter in the mode.php script."
    },
    "attacker_capabilities": {
      "LFI": "An attacker requires administrator privileges.",
      "XSS": "An attacker can inject malicious script into the 'referer' parameter."
    },
     "more_info": "The advisory provided detailed information about the vulnerable parameters and the steps to manually fix them. The fix for LFI included stripping risky characters from the log file name and verifying that the directory of the log file is the current directory. The fix for XSS involved setting the 'referer' to 'index.php' if it contains 'http' or 'script' strings."
  }
}
```