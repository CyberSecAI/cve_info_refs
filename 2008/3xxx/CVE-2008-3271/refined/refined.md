```
{
  "CVE-2008-3271": {
    "description": "A synchronization issue in the `RequestFilterValve` of Apache Tomcat can, in rare circumstances, allow a user from a non-permitted IP address to gain access to a context that is protected using a valve that extends `RequestFilterValve`. This includes the standard `RemoteAddrValve` and `RemoteHostValve` implementations.",
    "vulnerability_details": {
      "root_cause": "The `RequestFilterValve` saves compiled regular expressions (RE) and reuses them for each request. However, the regular expressions are not thread-safe which leads to a synchronization issue, potentially allowing access from non-permitted IP addresses under heavy load.",
      "weaknesses": [
        "Thread-safety issue with regular expression usage in `RequestFilterValve`",
        "Improper IP address filtering logic"
      ],
      "impact": "A user from a non-permitted IP address may gain access to a protected context, which could potentially lead to information disclosure or other unauthorized access.",
      "attack_vectors": [
        "Network access using HTTP requests."
      ],
      "required_capabilities": "The attacker needs to send HTTP requests to the server. The vulnerability is more likely to be triggered under heavy load."
    },
    "affected_products": [
      "Apache Tomcat 4.1.0 to 4.1.31",
       "Apache Tomcat 5.5.0",
       "Interstage Application Server",
       "Interstage Apworks",
       "Interstage Business Application Server",
       "Interstage Job Workload Server",
        "Interstage Studio",
       "Interstage Web Server",
      "WebOTX Application Server"
    ],
    "additional_notes": "The vulnerability is more likely to be triggered under heavy load or specific timing sequences. The fix involved ensuring regular expressions are thread-safe. Directory listing was changed to be disabled by default to mitigate a similar issue, and a patch was proposed to improve performance for large directories by caching directory listings."
  }
}
```