=== Content from kuza55.blogspot.com_d90de67e_20250125_201644.html ===


[skip to main](#main)  |
[skip to sidebar](#sidebar)

# [Alex's Corner](http://kuza55.blogspot.com/)

## Saturday, July 12, 2008

### Some Random Safari Notes

I got to take a quick look at some Safari stuff at work a few days ago, and came away with a few notes that I thought might interest people about Safari:

Cross-Site Cooking works the same way as it does in Firefox 2.0, namely it works just as the RFC describes and we can set cookies for .co.uk, .com.au, etc.

HttpOnly is not supported.

Safari parses Set-Cookie headers like the RFC says, which means that cookies are comma separated (no other browsers seem to do this), which means that in ASP.NET and JSP, when you use the framework's method of setting cookies and you let the user control the value, they can inject arbitrary cookies by specifying something like ", arbitrary\_name=arbitrary\_value" as the cookie value.

Referers are not leaked from https to http, but are leaked from one https site to another https site.

The safari cache (at lest on windows) is an SQLite database where all the data is double hex encoded; it looks something like X'aabbccddeeff, etc, and when you strip the first two chars and decode it you get another blob which looks identical to the first one, which you then need to decode the same way and you get an XML document with the data, I wrote this dodgy PHP function to do the conversion for me: (you need to call it twice on the blob you extract from the database)

````
function decode_blob ($blob) {
 $ret = "";
 for ($i=2,$c=strlen($blob);$i<$c;$i+=2) {
  $ret .= chr(hexdec ($blob[$i].$blob[$i+1]));
 }
 return $ret;
}
````

On the iPhone (emulator at least; I didn't get to use an actual iPhone), the last character of the password field is shown before you type the next one in (and untill the field loses focus); this makes sense since it's hard to type on iPhones, but it's still curious.

Safari on the iPhone (emulator, again) doesn't seem to actually close, so unless you close the emulator (I'm assuming this is equivalent to turning off your iPhone; if that's even possible), all session cookies persist.

Hope that helps someone.

Posted by

[kuza55](https://www.blogger.com/profile/03932544559060480887 "author profile")

at

[Saturday, July 12, 2008](http://kuza55.blogspot.com/2008/07/some-random-safari-notes.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/23714519/6085720172882642613 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=23714519&postID=6085720172882642613&from=pencil "Edit Post")

Labels:
[Security (All)](http://kuza55.blogspot.com/search/label/Security%20%28All%29),
[Web App Sec](http://kuza55.blogspot.com/search/label/Web%20App%20Sec)

#### 5 comments:

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

Wow, security though obscurity with that SQLlite encoding! or is this normal behavior? I can't see any reason why they should do this other than preventing strange locales/entities being injected into that XML file, but even that sounds strange if I hear myself uttering that. :)

Any thoughts why they do this? it's a pretty interesting aka weird approach.

/rvdh 0x000000.com

[12 July 2008 at 11:40 pm](http://kuza55.blogspot.com/2008/07/some-random-safari-notes.html?showComment=1215870000000#c7168641080410903282 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=23714519&postID=7168641080410903282 "Delete Comment")

[![](//www.blogger.com/img/blogger_logo_round_35.png "kuza55")](https://www.blogger.com/profile/03932544559060480887)
[kuza55](https://www.blogger.com/profile/03932544559060480887)
said...

It seemed a bit odd to me as well, and I have no idea why they did that, I doubt it was meant to be security through obscurity since it's usually the first thing you try when you see some random digits...

I doubt it's to stop injection attacks since the whole xml file is encoded, but other than that I'm just as confused as anyone.

P.S. I was using sqliteman to view the database, not sure if that makes any difference though.

P.P.S. I remember the URLAndExit stuff (though I didn't know what it was) from way back when Kazaa was the shit (for me at least); you always got random media files which opened websites to try and get you to install malware, or just to do advertising. :)

[13 July 2008 at 5:41 pm](http://kuza55.blogspot.com/2008/07/some-random-safari-notes.html?showComment=1215934860000#c1708395426009153782 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=23714519&postID=1708395426009153782 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

Your php function is a bit too long. I would write the same this way :
function decode\_blob ($blob) {
 return pack('H\*', substr($blob, 2));
}

Hope it helps ;)

[29 July 2008 at 10:44 pm](http://kuza55.blogspot.com/2008/07/some-random-safari-notes.html?showComment=1217335440000#c7653594558304830066 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=23714519&postID=7653594558304830066 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

What do you mean?

[5 August 2008 at 11:59 pm](http://kuza55.blogspot.com/2008/07/some-random-safari-notes.html?showComment=1217944740000#c6361095625457485738 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=23714519&postID=6361095625457485738 "Delete Comment")

![](//resources.blogblog.com/img/blank.gif "Anonymous")

Anonymous
said...

what he meant to say is your a amature kid. Dont take that from him. I recommend: a .exe=killbill code Hclass=null\*/

[7 September 2008 at 4:07 pm](http://kuza55.blogspot.com/2008/07/some-random-safari-notes.html?showComment=1220767620000#c7921586919129748785 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=23714519&postID=7921586919129748785 "Delete Comment")

[Post a Comment](https://www.blogger.com/comment/fullpage/post/23714519/6085720172882642613)

[Newer Post](http://kuza55.blogspot.com/2008/07/licensing-content.html "Newer Post")

[Older Post](http://kuza55.blogspot.com/2008/07/cookie-path-traversal.html "Older Post")

[Home](http://kuza55.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://kuza55.blogspot.com/feeds/6085720172882642613/comments/default)

## About

This blog is primarily a place for me to post my own research, papers and random ideas. Most likely I'm not going to be commenting on things happening in security.

As such it will most likely not be updated very often.

Name: Alex
Alias: kuza55
Email: kuza55@gmail.com

You can also find me on the temporary sla.ckers.org channel:
irc.irchighway.net #slackers

## Web App Sec Blogs

* [ha.ckers.org (RSnake)](http://ha.ckers.org/)
* [Sylvan von Stuppe](http://sylvanvonstuppe.blogspot.com/)
* [Wisec (Stefano Di Paola)](http://www.wisec.it/sectou.php)
* [PHP Security Blog (Stefan Esser)](http://blog.php-security.org/)
* [It's a shampoo world anyway (Martin Johns)](http://shampoo.antville.org/)
* [Jeremiah Grossman's Blog](http://jeremiahgrossman.blogspot.com/)
* [Portswigger](http://blog.portswigger.net/)
* [Mephisto's Mind](http://mephistosmind.blogspot.com/)
* [p42 labs (thornmaker)](http://p42.us/)
* [0x000000 (Ronald van den Heetkamp)](http://www.0x000000.com/)
* [christian's weblog (christ1an)](http://christ1an.blogspot.com/)
* [Web App Security journ(ey)al (Kishor)](http://wasjournal.blogspot.com/)
* [RETURN $ecure; (Kyran)](http://kyran.wordpress.com/)
* [Disenchant's Blog](http://www.disenchant.ch/blog/)

## Security Blogs

* [Taking Network Security to the Streets (Ronald Koh)](http://hackathology.blogspot.com/)
* [Exhaustive Search (Matt Blaze)](http://www.crypto.com/blog/)
* [Adventures of the White Rabbit (tibbar)](http://www.tibbar.org/)

## Ezines

* [Uninformed](http://www.uninformed.org/)
* [.aware](http://www.awarenetwork.org/)
* [Phrack](http://www.phrack.org/)
* [K-1ine](http://www.nettwerked.net/files.html#K1INE)

## Other Sites

* [XSSed (XSS Archive w/ Mirror)](http://www.xssed.com/)
* [Hack In The Box](http://www.hackinthebox.org/)
* [CAcert](http://www.cacert.org/)

## Labels

* [Conferences](http://kuza55.blogspot.com/search/label/Conferences)
  (3)
* [CSRF](http://kuza55.blogspot.com/search/label/CSRF)
  (4)
* [Detection](http://kuza55.blogspot.com/search/label/Detection)
  (8)
* [DNS](http://kuza55.blogspot.com/search/label/DNS)
  (1)
* [Encoding](http://kuza55.blogspot.com/search/label/Encoding)
  (2)
* [Extension Hacking](http://kuza55.blogspot.com/search/label/Extension%20Hacking)
  (3)
* [Firefox](http://kuza55.blogspot.com/search/label/Firefox)
  (16)
* [General Security](http://kuza55.blogspot.com/search/label/General%20Security)
  (12)
* [HTTP](http://kuza55.blogspot.com/search/label/HTTP)
  (9)
* [IE](http://kuza55.blogspot.com/search/label/IE)
  (2)
* [Javascript](http://kuza55.blogspot.com/search/label/Javascript)
  (16)
* [MySpace](http://kuza55.blogspot.com/search/label/MySpace)
  (6)
* [Phishing](http://kuza55.blogspot.com/search/label/Phishing)
  (1)
* [PHP](http://kuza55.blogspot.com/search/label/PHP)
  (5)
* [RCSR](http://kuza55.blogspot.com/search/label/RCSR)
  (3)
* [Security (All)](http://kuza55.blogspot.com/search/label/Security%20%28All%29)
  (67)
* [SSO](http://kuza55.blogspot.com/search/label/SSO)
  (3)
* [Web App Sec](http://kuza55.blogspot.com/search/label/Web%20App%20Sec)
  (58)
* [XSS](http://kuza55.blogspot.com/search/label/XSS)
  (35)

## Blog Archive

* ►
  [2009](http://kuza55.blogspot.com/2009/)
  (1)
  + ►
    [July](http://kuza55.blogspot.com/2009/07/)
    (1)

* ▼
  [2008](http://kuza55.blogspot.com/2008/)
  (17)
  + ►
    [September](http://kuza55.blogspot.com/2008/09/)
    (2)
  + ►
    [August](http://kuza55.blogspot.com/2008/08/)
    (2)
  + ▼
    [July](http://kuza55.blogspot.com/2008/07/)
    (4)
    - [XSS-ing Firefox Extensions](http://kuza55.blogspot.com/2008/07/xss-ing-firefox-extensions.html)
    - [Licensing Content](http://kuza55.blogspot.com/2008/07/licensing-content.html)
    - [Some Random Safari Notes](http://kuza55.blogspot.com/2008/07/some-random-safari-notes.html)
    - [Cookie Path Traversal](http://kuza55.blogspot.com/2008/07/cookie-path-traversal.html)
  + ►
    [June](http://kuza55.blogspot.com/2008/06/)
    (1)
  + ►
    [April](http://kuza55.blogspot.com/2008/04/)
    (1)
  + ►
    [February](http://kuza55.blogspot.com/2008/02/)
    (6)
  + ►
    [January](http://kuza55.blogspot.com/2008/01/)
    (1)

* ►
  [2007](http://kuza55.blogspot.com/2007/)
  (48)
  + ►
    [October](http://kuza55.blogspot.com/2007/10/)
    (1)
  + ►
    [July](http://kuza55.blogspot.com/2007/07/)
    (2)
  + ►
    [June](http://kuza55.blogspot.com/2007/06/)
    (3)
  + ►
    [May](http://kuza55.blogspot.com/2007/05/)
    (2)
  + ►
    [April](http://kuza55.blogspot.com/2007/04/)
    (4)
  + ►
    [March](http://kuza55.blogspot.com/2007/03/)
    (4)
  + ►
    [February](http://kuza55.blogspot.com/2007/02/)
    (18)
  + ►
    [January](http://kuza55.blogspot.com/2007/01/)
    (14)

* ►
  [2006](http://kuza55.blogspot.com/2006/)
  (17)
  + ►
    [December](http://kuza55.blogspot.com/2006/12/)
    (3)
  + ►
    [November](http://kuza55.blogspot.com/2006/11/)
    (2)
  + ►
    [October](http://kuza55.blogspot.com/2006/10/)
    (5)
  + ►
    [April](http://kuza55.blogspot.com/2006/04/)
    (2)
  + ►
    [March](http://kuza55.blogspot.com/2006/03/)
    (5)

[![who"s online](http://whos.amung.us/widget/xc5b9oga)](http://whos.amung.us/show/xc5b9oga)


