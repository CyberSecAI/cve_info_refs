=== Content from bugs.debian.org_8a4b6fd2_20250125_225409.html ===

# Debian Bug report logs - #495968 gpicview: CVE-2008-3791 insecure temporary file usage

[![version graph](version.cgi?width=2;found=gpicview%2F0.1.9-1;height=2;package=gpicview;absolute=0;fixed=gpicview%2F0.1.9-2;collapse=1)](version.cgi?found=gpicview%2F0.1.9-1;info=1;collapse=1;absolute=0;fixed=gpicview%2F0.1.9-2;package=gpicview)

Package:
[gpicview](pkgreport.cgi?package=gpicview);
Maintainer for [gpicview](pkgreport.cgi?package=gpicview) is [Debian LXDE Maintainers <team+lxde@tracker.debian.org>](pkgreport.cgi?maint=team%2Blxde%40tracker.debian.org); Source for [gpicview](pkgreport.cgi?package=gpicview) is [src:gpicview](pkgreport.cgi?src=gpicview) ([PTS](https://tracker.debian.org/pkg/gpicview), [buildd](https://buildd.debian.org/gpicview), [popcon](https://qa.debian.org/popcon.php?package=gpicview)).

Reported by: [Wen-Yen Chuang <caleb@calno.com>](pkgreport.cgi?submitter=caleb%40calno.com)

Date: Thu, 21 Aug 2008 17:36:02 UTC

Severity: *grave*

Tags: security

Found in version gpicview/0.1.9-1

Fixed in version gpicview/0.1.9-2

**Done:** Nico Golde <nion@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=495968;mbox=yes), [status mbox](bugreport.cgi?bug=495968;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=495968;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=2), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Wen-Yen Chuang <caleb@calno.com>`:

New Bug report received and forwarded.
([full text](bugreport.cgi?bug=495968;msg=4), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=5), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=caleb%40calno.com)
From: Wen-Yen Chuang <caleb@calno.com>
To: submit@bugs.debian.org
Subject: [gpicview] security RC bugs
Date: Fri, 22 Aug 2008 01:31:35 +0800
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Package: gpicview
Version: 0.1.9-1
Severity: serious

There are three security bugs listed on sourceforge:
[1] [ 2019481 ] gpicview unsafe /tmp usage
[2] [ 2019485 ] gpicview ask_before_save is ignored with LIBJPEG
[3] [ 2019492 ] gpicview ask_before_save is ignored if auto_save_rotated

Thanks to Jeremy C. Reed for reporting these bugs and mailing me.
He also mailed to maintainers of other GNU/Linux and BSD distributions.

Kind regards
 Wen-Yen Chuang (caleb)

Reference:
[1]
<http://sourceforge.net/tracker/index.php?func=detail&aid=2019481&group_id=180858&atid=894869>
[2]
<http://sourceforge.net/tracker/index.php?func=detail&aid=2019485&group_id=180858&atid=894869>
[3]
<http://sourceforge.net/tracker/index.php?func=detail&aid=2019492&group_id=180858&atid=894869>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org>

iEYEARECAAYFAkitpnYACgkQdEpXpumNYVkzRQCfQHVlrWhzMNy0tw/ACvrQnrPr
JoMAn0N9Aa27wMv9IN1+0urrSfIsmaVQ
=xzDV
-----END PGP SIGNATURE-----

```

---

**Tags added: security**
Request was from `Francesco Poli <frx@firenze.linux.it>`
to `control@bugs.debian.org`.
(Thu, 21 Aug 2008 20:00:03 GMT) ([full text](bugreport.cgi?bug=495968;msg=7), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=7), [link](#6)).

---

**Severity set to `grave' from `serious'**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Wed, 27 Aug 2008 14:33:03 GMT) ([full text](bugreport.cgi?bug=495968;msg=9), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=9), [link](#8)).

---

**Severity set to `grave' from `grave'**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Wed, 27 Aug 2008 14:33:05 GMT) ([full text](bugreport.cgi?bug=495968;msg=11), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=11), [link](#10)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Wen-Yen Chuang <caleb@calno.com>`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=13), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=13), [link](#12)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Wen-Yen Chuang <caleb@calno.com>`.
([full text](bugreport.cgi?bug=495968;msg=15), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=15), [link](#14)).

---

[Message #16](#16) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=16), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=16), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 495968@bugs.debian.org
Subject: Re: [gpicview] security RC bugs
Date: Wed, 27 Aug 2008 16:47:42 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=495968;msg=16) (text/plain, inline)]
```
```
Hi,
[2] [ 2019485 ] gpicview ask_before_save is ignored with LIBJPEG
[3] [ 2019492 ] gpicview ask_before_save is ignored if auto_save_rotated

those are no security bugs, there is no way for another user
to exploit this. Those are just normal application bugs.

Kind regards
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=495968;msg=16) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=18), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=18), [link](#17)).

---

**Acknowledgement sent** to `Wen-Yen Chuang <caleb@calno.com>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=495968;msg=20), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=20), [link](#19)).

---

[Message #21](#21) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=21), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=21), reply):

![](/cgi-bin/libravatar.cgi?email=caleb%40calno.com)
From: Wen-Yen Chuang <caleb@calno.com>
To: 495968@bugs.debian.org, control@bugs.debian.org
Subject: Re: gpicview unsafe /tmp usage
Date: Fri, 29 Aug 2008 14:52:21 +0800
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

retitle 495968 gpicview unsafe /tmp usage
thanks

Thanks to Nico.
I have splitted those two bugs to #497005 and #497006.

Once upstream's #2019481 [1] is fixed, this bug can be closed.

I plan to orphan gpicview after release of Lenny,
no matter gpicview is in Lenny or not.

I am still happy to maintain gpicview *BEFORE* release of Lenny,
but I will not spend time to read its source code and trying to fix it
by myself.

If there are patches to fix upstream's #2019481, I will test it and
contact security and release team, trying to push gpicview to Lenny.

If anyone want to adopt gpicview, feel free to upload it as "New
maintainer" (even before release of Lenny).

I will mail to WNPP and orphan gpicview *AFTER* release of Lenny.
(If nobody adopt it before release of Lenny, of course.)

Kind regards
 Wen-Yen Chuang (caleb)

Reference:
[1] [ 2019481 ] gpicview unsafe /tmp usage
<http://sourceforge.net/tracker/index.php?func=detail&aid=2019481&group_id=180858&atid=894869>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org>

iEYEARECAAYFAki3nKUACgkQdEpXpumNYVnGCgCfU1QrPK5eQk9OHyEx7ahsSiWN
9w8An0qz2PFSEoayHciGF9IoZlb1GtBl
=kdY7
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to `gpicview unsafe /tmp usage' from `[gpicview] security RC bugs'.**
Request was from `Wen-Yen Chuang <caleb@calno.com>`
to `control@bugs.debian.org`.
(Fri, 29 Aug 2008 06:57:05 GMT) ([full text](bugreport.cgi?bug=495968;msg=23), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=23), [link](#22)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Wen-Yen Chuang <caleb@calno.com>`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=25), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=25), [link](#24)).

---

**Acknowledgement sent** to `Thomas Viehmann <tv@beamnet.de>`:

Extra info received and forwarded to list. Copy sent to `Wen-Yen Chuang <caleb@calno.com>`.
([full text](bugreport.cgi?bug=495968;msg=27), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=27), [link](#26)).

---

[Message #28](#28) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=28), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=28), reply):

![](/cgi-bin/libravatar.cgi?email=tv%40beamnet.de)
From: Thomas Viehmann <tv@beamnet.de>
To: 495968@bugs.debian.org
Cc: debian-release@lists.debian.org
Subject: remove gpicview from lenny?
Date: Sun, 31 Aug 2008 00:11:04 +0200
```
Hi,

based on the maintainer's comments in the bug log, it seems dubious
whether the bug #495968 (insecure /tmp file vulnerability) is fixed in
time for lenny. Given that it has never been released with Debian
before, it would be better to remove gpicview from lenny for now than to
risk releasing the vulnerable package.

Kind regards

T.
--
Thomas Viehmann, <http://thomas.viehmann.net/>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Wen-Yen Chuang <caleb@calno.com>`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=30), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=30), [link](#29)).

---

**Acknowledgement sent** to `droneauth@gmail.com`:

Extra info received and forwarded to list. Copy sent to `Wen-Yen Chuang <caleb@calno.com>`.
([full text](bugreport.cgi?bug=495968;msg=32), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=32), [link](#31)).

---

[Message #33](#33) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=33), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=33), reply):

![](/cgi-bin/libravatar.cgi?email=droneauth%40gmail.com)
From: Florian Maier <droneauth@gmail.com>
To: 495968@bugs.debian.org
Subject: (no subject)
Date: Sun, 31 Aug 2008 13:23:57 +0200
```
I had a look into the code and the fix for the /tmp file issue would be
a simple mkstemp call. But i'd also suggest to remove gpicview from the
release, as the quaility of the code is simply not good enough to be
released anytime soon.

There some possible buffer overflows, multiple hacks, TODO comments and
the coding style overall is bad.

Florian

--
Florian Maier
  gpg fingerprint: 18D6 0A4D 5719 12E6 88DA  6DCC E624 7AF6 8E27 8B26
  <http://www.marsmenschen.com/>   -  -   <http://www.planetlimux.org/>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Wen-Yen Chuang <caleb@calno.com>`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=35), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=35), [link](#34)).

---

**Acknowledgement sent** to `Neil McGovern <maulkin@halon.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Wen-Yen Chuang <caleb@calno.com>`.
([full text](bugreport.cgi?bug=495968;msg=37), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=38), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=maulkin%40halon.org.uk)
From: Neil McGovern <maulkin@halon.org.uk>
To: Thomas Viehmann <tv@beamnet.de>
Cc: 495968@bugs.debian.org, debian-release@lists.debian.org
Subject: Re: remove gpicview from lenny?
Date: Sun, 31 Aug 2008 14:56:17 +0100
```
On Sun, Aug 31, 2008 at 12:11:04AM +0200, Thomas Viehmann wrote:
> based on the maintainer's comments in the bug log, it seems dubious
> whether the bug #495968 (insecure /tmp file vulnerability) is fixed in
> time for lenny. Given that it has never been released with Debian
> before, it would be better to remove gpicview from lenny for now than to
> risk releasing the vulnerable package.
>

Removal hint added.

Neil
--
A. Because it breaks the logical sequence of discussion
Q. Why is top posting bad?
gpg key - <http://www.halon.org.uk/pubkey.txt> ; the.earth.li B345BDD3

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Wen-Yen Chuang <caleb@calno.com>`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=40), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=40), [link](#39)).

---

**Acknowledgement sent** to `"Ying-Chun Liu (PaulLiu)" <grandpaul@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Wen-Yen Chuang <caleb@calno.com>`.
([full text](bugreport.cgi?bug=495968;msg=42), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=42), [link](#41)).

---

[Message #43](#43) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=43), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=43), reply):

![](/cgi-bin/libravatar.cgi?email=grandpaul%40gmail.com)
From: "Ying-Chun Liu (PaulLiu)" <grandpaul@gmail.com>
To: 495968@bugs.debian.org
Subject: Re: gpicview:gpicview unsafe /tmp usage
Date: Tue, 02 Sep 2008 18:30:07 +0800
```
[[Message part 1](bugreport.cgi?att=0;bug=495968;msg=43) (text/plain, inline)]
```
```
Dear all,

I made a patch to fix this bug.

Regards,
 Paul

--
                                                PaulLiu(劉穎駿)
E-mail address: grandpaul@gmail.com

```
```
[[gpicview_mkstemp_0.1.9.patch](bugreport.cgi?att=1;bug=495968;filename=gpicview_mkstemp_0.1.9.patch;msg=43) (text/x-patch, inline)]
```
```
--- main-win.c.orig	2008-02-21 02:29:29.000000000 +0800
+++ main-win.c	2008-09-02 18:23:58.185143816 +0800
@@ -675,6 +675,11 @@

 #ifdef HAVE_LIBJPEG
 int rotate_and_save_jpeg_lossless(char *  filename,int angle){
+    char tmpfilename[] = {"/tmp/rot.jpg.XXXXXX"};
+    int tmpfilefd;
+    FILE *cp_in;
+    FILE *cp_out;
+    char cp_buf[512];
     JXFORM_CODE code = JXFORM_NONE;

     angle = angle % 360;
@@ -686,17 +691,34 @@
     else if(angle == 270)
         code = JXFORM_ROT_270;

+    /* create tmp file */
+    tmpfilefd = mkstemp(tmpfilename);
+    if (tmpfilefd == -1) {
+      return -1;
+    }
+    close(tmpfilefd);
+
     //rotate the image and save it to /tmp/rot.jpg
-    int error = jpegtran (filename, "/tmp/rot.jpg" , code);
+    int error = jpegtran (filename, tmpfilename , code);
     if(error)
         return error;

     //now copy /tmp/rot.jpg back to the original file
-    char command[strlen(filename)+50]; //this should not generate buffer owerflow
-    // MS: didn't know, how to make it better, maybe an own copy routine
-    sprintf(command,"cp /tmp/rot.jpg \"%s\"",filename);
-    system(command);
+    cp_in = fopen(tmpfilename,"rb");
+    cp_out = fopen(filename,"wb");
+    while (!feof(cp_in)) {
+      int n;
+      n = fread(cp_buf,1,sizeof(cp_buf),cp_in);
+      if (n<=0) {
+        break;
+      }
+      fwrite (cp_buf,1,n,cp_out);
+    }
+    fclose(cp_in);
+    fclose(cp_out);

+    /* remove tmp file */
+    unlink(tmpfilename);
     return 0;
 }
 #endif

```
```
[[signature.asc](bugreport.cgi?att=2;bug=495968;filename=signature.asc;msg=43) (application/pgp-signature, attachment)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=45), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=45), [link](#44)).

---

**Acknowledgement sent** to `Wen-Yen Chuang <caleb@calno.com>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=495968;msg=47), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=47), [link](#46)).

---

[Message #48](#48) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=48), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=48), reply):

![](/cgi-bin/libravatar.cgi?email=caleb%40calno.com)
From: Wen-Yen Chuang <caleb@calno.com>
To: 495968@bugs.debian.org
Subject: Re: gpicview unsafe /tmp usage
Date: Wed, 03 Sep 2008 20:00:33 +0800
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Thanks to Paul.

Andrew Lee has promised that he will adopt gpicview. [1]
He is the current collaborate maintainer of gpicview,
and is one of the Project Admins of gpicview.

gpicview still has other RC bugs, so I will not handle the patch
currently.

Kind regards
 Wen-Yen Chuang (caleb)

[1] <http://bugs.debian.org/497006#22>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org>

iEYEARECAAYFAki+fGEACgkQdEpXpumNYVnkxgCfVDG73eZj3mdsbNptyORse+CK
6pwAn3bZ3kSPU1FWa1bLonbJhaLU1H2x
=Vpx0
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Wen-Yen Chuang <caleb@calno.com>`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=50), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=50), [link](#49)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Wen-Yen Chuang <caleb@calno.com>`.
([full text](bugreport.cgi?bug=495968;msg=52), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=52), [link](#51)).

---

[Message #53](#53) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=53), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=53), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 495968@bugs.debian.org
Subject: CVE id
Date: Thu, 4 Sep 2008 00:29:25 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=495968;msg=53) (text/plain, inline)]
```
```
retitle 495968 gpicview: [CVE-2008-3791](https://security-tracker.debian.org/tracker/CVE-2008-3791) insecure temporary file creation
thanks

Hi,

[CVE-2008-3791](https://security-tracker.debian.org/tracker/CVE-2008-3791) has been assigned to this issue.
Please reference this CVE id in the changelog if you fix the
bug.

Cheers
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=495968;msg=53) (application/pgp-signature, inline)]
```

---

**Changed Bug title to `gpicview: CVE-2008-3791 insecure temporary file creation' from `gpicview unsafe /tmp usage'.**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Wed, 03 Sep 2008 22:42:03 GMT) ([full text](bugreport.cgi?bug=495968;msg=55), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=55), [link](#54)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Wen-Yen Chuang <caleb@calno.com>`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=57), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=57), [link](#56)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Wen-Yen Chuang <caleb@calno.com>`.
([full text](bugreport.cgi?bug=495968;msg=59), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=60), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 495968@bugs.debian.org
Subject: code execution possible as well
Date: Thu, 4 Sep 2008 18:15:18 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=495968;msg=60) (text/plain, inline)]
```
```
retitle 495968 gpicview: [CVE-2008-3791](https://security-tracker.debian.org/tracker/CVE-2008-3791), [CVE-2008-3904](https://security-tracker.debian.org/tracker/CVE-2008-3904) insecure tempfile usage and code execution
thanks

Hi,
I discovered that this piece of code also allows code
execution via crafted file names, have a look at:
<http://marc.info/?l=oss-security&m=122014008313454&w=4>
and
<http://marc.info/?l=oss-security&m=122040004828615&w=4>

this is [CVE-2008-3904](https://security-tracker.debian.org/tracker/CVE-2008-3904).

Cheers
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=495968;msg=60) (application/pgp-signature, inline)]
```

---

**Changed Bug title to `gpicview: CVE-2008-3791, CVE-2008-3904 insecure tempfile usage and code execution' from `gpicview: CVE-2008-3791 insecure temporary file creation'.**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Thu, 04 Sep 2008 16:18:11 GMT) ([full text](bugreport.cgi?bug=495968;msg=62), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=62), [link](#61)).

---

**Reply sent** to `Andrew Lee <andrew@linux.org.tw>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=495968;msg=64), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=64), [link](#63)).

---

**Notification sent** to `Wen-Yen Chuang <caleb@calno.com>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=495968;msg=66), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=66), [link](#65)).

---

[Message #67](#67) received at 495968-close@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=67), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=67), reply):

![](/cgi-bin/libravatar.cgi?email=andrew%40linux.org.tw)
From: Andrew Lee <andrew@linux.org.tw>
To: 495968-close@bugs.debian.org
Subject: Bug#495968: fixed in gpicview 0.1.9-2
Date: Sat, 06 Sep 2008 09:17:25 +0000
```
Source: gpicview
Source-Version: 0.1.9-2

We believe that the bug you reported is fixed in the latest version of
gpicview, which is due to be installed in the Debian FTP archive:

gpicview_0.1.9-2.diff.gz
  to pool/main/g/gpicview/gpicview_0.1.9-2.diff.gz
gpicview_0.1.9-2.dsc
  to pool/main/g/gpicview/gpicview_0.1.9-2.dsc
gpicview_0.1.9-2_amd64.deb
  to pool/main/g/gpicview/gpicview_0.1.9-2_amd64.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 495968@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Andrew Lee <andrew@linux.org.tw> (supplier of updated gpicview package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Tue, 02 Sep 2008 21:49:47 +0800
Source: gpicview
Binary: gpicview
Architecture: source amd64
Version: 0.1.9-2
Distribution: unstable
Urgency: high
Maintainer: Andrew Lee <andrew@linux.org.tw>
Changed-By: Andrew Lee <andrew@linux.org.tw>
Description:
 gpicview   - lightweight image viewer
Closes: [495968](bugreport.cgi?bug=495968) [497408](bugreport.cgi?bug=497408)
Changes:
 gpicview (0.1.9-2) unstable; urgency=high
 .
   * Applied gpicview_mkstemp_0.1.9.dpatch for two RC bug fix,
     set urgency=high. (Closes: #[495968](bugreport.cgi?bug=495968), #[497408](bugreport.cgi?bug=497408))
     Thanks PaulLiu(劉穎駿) <grandpaul@gmail.com> for the patch.
   * New Maintainer Upload. Thanks Wen-Yen Chuang's contribution in the
     past year. I adopt this package become official maintainer now.
Checksums-Sha1:
 e76ed76f5e561a928b039748f166893b0c61ba08 1029 gpicview_0.1.9-2.dsc
 4226090919ccf853e0db79b9216c28aea07b72c8 4050 gpicview_0.1.9-2.diff.gz
 2e7ef5f8310eda3278bcc7bc7e076bf52831a7de 48312 gpicview_0.1.9-2_amd64.deb
Checksums-Sha256:
 534e92ed09e9352b70d3391f63ebebf67ef2cd129f5631004c113dd575102371 1029 gpicview_0.1.9-2.dsc
 c45a7539d4d4181e8ee6ac16ca8c43dbd59ed904cb303e0a2c76de8f7f971292 4050 gpicview_0.1.9-2.diff.gz
 7dc466122ccc82ab0e26c41962955e2288be1e8716273609165d4bbebb0adcfc 48312 gpicview_0.1.9-2_amd64.deb
Files:
 2607c325fac79364303084e8dac2baf2 1029 graphics optional gpicview_0.1.9-2.dsc
 e86ad102968166ae258b994045da17f1 4050 graphics optional gpicview_0.1.9-2.diff.gz
 b0c46bf2111bffd7fc548eb283f67190 48312 graphics optional gpicview_0.1.9-2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iD8DBQFIwjzV9LSwzHl+v6sRAkKtAJ4/ZqvL6qCYtT11aNUlZc4K+r+ZZgCdEq6z
j0cplFJLf69Lcr4Xt1kQdKk=
=7hMf
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Wen-Yen Chuang <caleb@calno.com>`:

`Bug#495968`; Package `gpicview`.
([full text](bugreport.cgi?bug=495968;msg=69), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=69), [link](#68)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Wen-Yen Chuang <caleb@calno.com>`.
([full text](bugreport.cgi?bug=495968;msg=71), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=71), [link](#70)).

---

[Message #72](#72) received at 495968@bugs.debian.org ([full text](bugreport.cgi?bug=495968;msg=72), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=72), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: control@bugs.debian.org
Cc: 495968@bugs.debian.org, andrew@linux.org.tw
Subject: cloning and reopening
Date: Sat, 6 Sep 2008 12:54:24 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=495968;msg=72) (text/plain, inline)]
```
```
reopen 495968
retitle 495968 gpicview: [CVE-2008-3791](https://security-tracker.debian.org/tracker/CVE-2008-3791) insecure temporary file usage
clone 495968 -1
reopen -1
found -1 0.1.9-2
retitle -1 gpicview: [CVE-2008-3904](https://security-tracker.debian.org/tracker/CVE-2008-3904) arbitrary code execution via crafted file name
close 495968 0.1.9-2
reopen 497408
# don't close bugs that don't belong to your package.

Hi Andrew,
this bug closing was really not appropriate. Why do you
close bugs via the changelog that don't belong to your
package? Why do you just close a bug report that contains
multiple bugs but you just fix one?

Please don't do that.
Cheers
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=495968;msg=72) (application/pgp-signature, inline)]
```

---

**Bug reopened, originator not changed.**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Sat, 06 Sep 2008 10:57:32 GMT) ([full text](bugreport.cgi?bug=495968;msg=74), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=74), [link](#73)).

---

**Changed Bug title to `gpicview: CVE-2008-3791 insecure temporary file usage' from `gpicview: CVE-2008-3791, CVE-2008-3904 insecure tempfile usage and code execution'.**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Sat, 06 Sep 2008 10:57:33 GMT) ([full text](bugreport.cgi?bug=495968;msg=76), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=76), [link](#75)).

---

**Bug [495968](bugreport.cgi?bug=495968) cloned as bug [498022](bugreport.cgi?bug=498022).**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Sat, 06 Sep 2008 10:57:34 GMT) ([full text](bugreport.cgi?bug=495968;msg=78), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=78), [link](#77)).

---

**Bug marked as fixed in version 0.1.9-2, send any further explanations to Wen-Yen Chuang <caleb@calno.com>**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Sat, 06 Sep 2008 10:57:37 GMT) ([full text](bugreport.cgi?bug=495968;msg=80), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=80), [link](#79)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 06 Oct 2008 07:30:40 GMT) ([full text](bugreport.cgi?bug=495968;msg=82), [mbox](bugreport.cgi?bug=495968;mbox=yes;msg=82), [link](#81)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=495968).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 22:54:09 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security-tracker.debian.org_d1279115_20250126_123602.html ===

# CVE-2008-3791

| **Name** | CVE-2008-3791 |
| --- | --- |
| **Description** | src/main-win.c in GPicView 0.1.9 in Lightweight X11 Desktop Environment (LXDE) allows local users to overwrite arbitrary files via a symlink attack on the /tmp/rot.jpg temporary file. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2008-3791) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2008-3791); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2008-3791), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2008-3791), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2008-3791), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2008-3791), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2008-3791), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2008-3791), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2008-3791), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2008-3791)/[CVE](https://www.suse.com/security/cve/CVE-2008-3791/), GitHub [advisories](https://github.com/advisories?query=CVE-2008-3791)/[code](https://github.com/search?type=Code&q=%22CVE-2008-3791%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2008-3791%22), [web search](https://duckduckgo.com/html?q=%22CVE-2008-3791%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [495968](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=495968) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [gpicview](/tracker/source-package/gpicview) ([PTS](https://tracker.debian.org/pkg/gpicview)) | bookworm, bullseye | 0.2.5-3 | fixed |
|  | sid, trixie | 0.2.6-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [gpicview](/tracker/source-package/gpicview) | source | (unstable) | 0.1.9-2 | low |  | [495968](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=495968) |

## Notes

```
<http://sourceforge.net/tracker/index.php?func=detail&aid=2019481&group_id=180858&atid=894869>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.openwall.com_19f055f3_20250125_225410.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](../../../2008/08/25/3) [[thread-next>]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Pine.GSO.4.51.0808261015310.18466@faron.mitre.org>
Date: Tue, 26 Aug 2008 10:19:17 -0400 (EDT)
From: "Steven M. Christey" <coley@...us.mitre.org>
To: oss-security@...ts.openwall.com
cc: coley@...re.org
Subject: Re: CVE Request (gpicview)

Jan,

Are there common usage scenarios under which gpicview would receive the
filename to create from some external source, say, as a web browser
plugin?

I'm asking because the missing "ask_before_save" issues only seem like
non-security bugs - the user messing him/herself up - unless the target
file can be influenced by an external attacker.

> <http://sourceforge.net/tracker/index.php?func=detail&aid=2019481&group_id=180858&atid=894869>
>
> Possible symlink attack via the temporary created "/tmp/rot.jpg"
> file used for image rotation.

Use CVE-2008-3791

> 2,
>
> <http://sourceforge.net/tracker/index.php?func=detail&aid=2019485&group_id=180858&atid=894869>
>
> By presence of the LIBJPEG library we could without confirmation rewrite
> the by the symlink targeted JPEG filesystem file.
>
> 3,
>
> <http://sourceforge.net/tracker/index.php?func=detail&aid=2019492&group_id=180858&atid=894869>
>
> Consequences: Bad enough, just think about them in context of the two
> previously mentioned issues.

These two might need a second CVE depending on the influence over the file
that "ask_before_save" would ask about.

- Steve

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security-tracker.debian.org_1fe7c3f2_20250126_123603.html ===

# CVE-2008-3904

| **Name** | CVE-2008-3904 |
| --- | --- |
| **Description** | src/main-win.c in GPicView 0.1.9 in Lightweight X11 Desktop Environment (LXDE) allows context-dependent attackers to execute arbitrary commands via shell metacharacters in a filename. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2008-3904) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2008-3904); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2008-3904), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2008-3904), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2008-3904), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2008-3904), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2008-3904), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2008-3904), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2008-3904), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2008-3904)/[CVE](https://www.suse.com/security/cve/CVE-2008-3904/), GitHub [advisories](https://github.com/advisories?query=CVE-2008-3904)/[code](https://github.com/search?type=Code&q=%22CVE-2008-3904%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2008-3904%22), [web search](https://duckduckgo.com/html?q=%22CVE-2008-3904%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [498022](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=498022) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [gpicview](/tracker/source-package/gpicview) ([PTS](https://tracker.debian.org/pkg/gpicview)) | bookworm, bullseye | 0.2.5-3 | fixed |
|  | sid, trixie | 0.2.6-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [gpicview](/tracker/source-package/gpicview) | source | (unstable) | 0.1.9-2 | low |  | [498022](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=498022) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.openwall.com_04bda1b7_20250125_225410.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](../../../2008/08/27/1) [[<thread-prev]](5) [[thread-next>]](../../../2008/08/30/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <1219769601.9043.6.camel@dhcp-lab-164.englab.brq.redhat.com>
Date: Tue, 26 Aug 2008 18:53:21 +0200
From: Jan Lieskovsky <jlieskov@...hat.com>
To: coley@...re.org
Cc: oss-security@...ts.openwall.com
Subject: Re: CVE Request (gpicview)

Hello Steve,

  On Tue, 2008-08-26 at 10:19 -0400, Steven M. Christey wrote:
> Jan,
>
> Are there common usage scenarios under which gpicview would receive the
> filename to create from some external source, say, as a web browser
> plugin?
>
> I'm asking because the missing "ask_before_save" issues only seem like
> non-security bugs - the user messing him/herself up - unless the target
> file can be influenced by an external attacker.

I can't see any possibility, how the last two issues could be used by
an external attacker to destroy the targeted user image files
(when not considering the attack possible via CVE-2008-3791).

>
> > <http://sourceforge.net/tracker/index.php?func=detail&aid=2019481&group_id=180858&atid=894869>
> >
> > Possible symlink attack via the temporary created "/tmp/rot.jpg"
> > file used for image rotation.
>
> Use CVE-2008-3791
>
> > 2, <http://sourceforge.net/tracker/index.php?func=detail&aid=2019485&group_id=180858&atid=894869>
> > 3, > <http://sourceforge.net/tracker/index.php?func=detail&aid=2019492&group_id=180858&atid=894869>

> These two might need a second CVE depending on the influence over the file
> that "ask_before_save" would ask about.

These two rather normal bugs, than a security issues.

Thank you for checking!

Regards
Jan iankko Lieskovsky
RH Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_2a57c26b_20250125_225410.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](../../../2008/08/26/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <1219661157.7715.13.camel@iankko.englab.brq.redhat.com>
Date: Mon, 25 Aug 2008 12:45:57 +0200
From: Jan Lieskovsky <jlieskov@...hat.com>
To: coley@...re.org
Cc: oss-security@...ts.openwall.com
Subject: CVE Request (gpicview)

Hello Steve,

  could you please allocate a CVE id for the following
three gpicview issues:

1,

<http://sourceforge.net/tracker/index.php?func=detail&aid=2019481&group_id=180858&atid=894869>

Possible symlink attack via the temporary created "/tmp/rot.jpg"
file used for image rotation.

2,

<http://sourceforge.net/tracker/index.php?func=detail&aid=2019485&group_id=180858&atid=894869>

Related part of the code (the check for previous same filename file
existence is done only in the 'main_win_save' function):

#ifdef HAVE_LIBJPEG
    if(strcmp(type,"jpeg")==0){
        if(rotate_and_save_jpeg_lossless(file_name,mw->rotation_angle)!=0)
            main_win_show_error(mw, "Save failed! Check permissions.");
    } else
#endif
        main_win_save( mw, file_name, type, pref.ask_before_save );

By presence of the LIBJPEG library we could without confirmation rewrite
the by the symlink targeted JPEG filesystem file.

3,

<http://sourceforge.net/tracker/index.php?func=detail&aid=2019492&group_id=180858&atid=894869>

Related part of the code:

void on_rotate_clockwise( GtkWidget* btn, MainWin* mw )
{
    rotate_image( mw, GDK_PIXBUF_ROTATE_CLOCKWISE );
    mw->rotation_angle += 90;
    if(pref.auto_save_rotated){
        pref.ask_before_save = FALSE;
        on_save(btn,mw);
        pref.ask_before_save = TRUE;
    }
}

Consequences: Bad enough, just think about them in context of the two
previously mentioned issues.

Public mention of these issues:

<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=495968>

Thank you in advance!

Kind regards
Jan iankko Lieskovsky
RH Security Resposne Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


