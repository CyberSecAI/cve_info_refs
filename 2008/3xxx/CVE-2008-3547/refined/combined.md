=== Content from security.gentoo.org_24c28482_20250125_075547.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# OpenTTD: Execution of arbitrary code — GLSA **200903-09**

Multiple buffer overflows in OpenTTD might allow for the execution of
arbitrary code in the server.

### Affected packages

| Package | **games-simulation/openttd** on all architectures |
| --- | --- |
| Affected versions | < **0.6.3** |
| Unaffected versions | >= **0.6.3** |

### Background

OpenTTD is a clone of Transport Tycoon Deluxe.

### Description

Multiple buffer overflows have been reported in OpenTTD, when storing
long for client names (CVE-2008-3547), in the TruncateString function
in src/gfx.cpp (CVE-2008-3576) and in src/openttd.cpp when processing a
large filename supplied to the "-g" parameter in the ttd\_main function
(CVE-2008-3577).

### Impact

An authenticated attacker could exploit these vulnerabilities to
execute arbitrary code with the privileges of the OpenTTD server.

### Workaround

There is no known workaround at this time.

### Resolution

All OpenTTD users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=games-simulation/openttd-0.6.3"
```
### References

* [CVE-2008-3547](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3547)
* [CVE-2008-3576](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3576)
* [CVE-2008-3577](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3577)

**Release date**

March 07, 2009

**Latest revision**

March 07, 2009: 01

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [233929](https://bugs.gentoo.org/show_bug.cgi?id=233929)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.gentoo.org_43d56cf6_20250125_075544.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 233929
games-simulation/openttd <0.6.3 TruncateString() Buffer Overflow (CVE-2008-{3547,3576,3577})
Last modified: 2009-03-07 16:31:06 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=233929&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=233929&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 233929**](show_bug.cgi?id=233929)
(CVE-2008-3547)
- games-simulation/openttd <0.6.3 TruncateString() Buffer Overflow (CVE-2008-{3547,3576,3577})

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
games-simulation/openttd <0.6.3 TruncateString() Buffer Overflow (CVE-2008-{3...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2008-3547 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://secunia.com/advisories/31350/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B2/B1? [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | STABLEREQ | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [215776](show_bug.cgi?id=215776 "RESOLVED FIXED - [new version] games-simulation/openttd-0.6.3") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=233929&hide_resolved=1) | |  | | Reported: | 2008-08-05 01:28 UTC by Robert Buchholz (RETIRED) | | --- | --- | | Modified: | 2009-03-07 16:31 UTC ([History](show_activity.cgi?id=233929)) | | CC List: | 7 users (show)  bugzie esigra games gentoo heiko.rosemann robbat2 truebrain | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**openttd-0.6.2-truncate-string.patch**](attachment.cgi?id=162239 "View the content of the attachment") (openttd-0.6.2-truncate-string.patch,770 bytes, patch)  [2008-08-05 01:35 UTC](#attach_162239 "Go to the comment associated with the attachment"), Robert Buchholz (RETIRED) | *no flags* | [Details](attachment.cgi?id=162239&action=edit) | [Diff](attachment.cgi?id=162239&action=diff) | | [**backported fix for 0.5.x**](attachment.cgi?id=162242 "View the content of the attachment") (openttd-0.5.2-truncate-string.patch,611 bytes, patch)  [2008-08-05 05:30 UTC](#attach_162242 "Go to the comment associated with the attachment"), corec | *no flags* | [Details](attachment.cgi?id=162242&action=edit) | [Diff](attachment.cgi?id=162242&action=diff) | | [View All](attachment.cgi?bugid=233929&action=viewall)  [Add an attachment](attachment.cgi?bugid=233929&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=233929&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-05 01:28:09 UTC  ``` Secunia writes: A vulnerability has been reported in OpenTTD, which potentially can be exploited by malicious people to cause a DoS (Denial of Service) or to compromise a vulnerable system.  The vulnerability is caused due to a boundary error within the "TruncateString()" function in src/gfx.cpp. This can be exploited to potentially cause a buffer overflow via a specially crafted string.  Successful exploitation may allow execution of arbitrary code.  The vulnerability is reported in versions prior to 0.6.2.  SOLUTION: Update to version 0.6.2.  PROVIDED AND/OR DISCOVERED BY: Reported by the vendor.  ORIGINAL ADVISORY: <http://sourceforge.net/project/shownotes.php?release_id=617243> ```  [Comment 1](#c1)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-05 01:35:05 UTC  ``` Created [attachment 162239](attachment.cgi?id=162239 "openttd-0.6.2-truncate-string.patch") [[details](attachment.cgi?id=162239&action=edit "openttd-0.6.2-truncate-string.patch"), [diff](attachment.cgi?id=162239&action=diff "openttd-0.6.2-truncate-string.patch")] openttd-0.6.2-truncate-string.patch  Just for reference, the patch in question. It also affects 0.5.3 as it is in our tree, a backport should be trivial if the ebuild cannot be bumped to 0.6. ```  [Comment 2](#c2)  Mr. Bones. (RETIRED)   gentoo-dev  2008-08-05 01:47:18 UTC  ``` masked games-simulation/openttd until it's fixed. ```  [Comment 3](#c3)  corec    2008-08-05 05:30:30 UTC  ``` Created [attachment 162242](attachment.cgi?id=162242 "backported fix for 0.5.x") [[details](attachment.cgi?id=162242&action=edit "backported fix for 0.5.x"), [diff](attachment.cgi?id=162242&action=diff "backported fix for 0.5.x")] backported fix for 0.5.x  This is the backported patch of openttd-0.6.2-truncate-string.patch. Compiled fine with me and game playes without problems. This patch also works just fine with 0.5.3 because gfx.c files are identical in 0.5.2 and 0.5.3. ```  [Comment 4](#c4)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-05 10:36:02 UTC  ``` This might not be the only buffer overflow fixed in 0.6.2, see <http://thread.gmane.org/gmane.comp.security.oss.general/766> ```  [Comment 5](#c5)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-06 11:53:23 UTC  ``` As Nico pointed out in the URL above, further patches would need backporting. Is bumping to 0.6.2 an option for us? ```  [Comment 6](#c6)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-08 12:40:09 UTC  ``` CVE-2008-3547 for the Debian issue ```  [Comment 7](#c7)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-15 13:06:32 UTC  ``` CVE-2008-3576 for the TruncateString()  Games, any news here? ```  [Comment 8](#c8)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-15 13:09:01 UTC  ``` CVE-2008-3577:          Buffer overflow in src/openttd.cpp in OpenTTD before 0.6.2 allows          local users to execute arbitrary code via a large filename supplied to          the "-g" parameter in the ttd_main function.  NOTE: it is unlikely          that this issue would cross privilege boundaries in typical          environments.  ```  [Comment 9](#c9)  Mr. Bones. (RETIRED)   gentoo-dev  2008-08-15 17:35:42 UTC  ``` It's masked.  We'll fix it when we fix it. ```  [Comment 10](#c10)  Patric Stout    2008-10-16 12:32:26 UTC  ``` Would it be possible to change the hard mask to only versions before 0.6.3? 0.6.3 fixes all CVEs. As OpenTTD now wants to push out an overlay with ebuilds, the hard mask is holding it back (and I can't find a way to override the hard mask from within an overlay). Thank you in advance. ```  [Comment 11](#c11)  Christian Hoffmann (RETIRED)   gentoo-dev  2008-10-19 10:10:51 UTC  ``` (In reply to [comment #10](show_bug.cgi?id=233929#c10)) > Would it be possible to change the hard mask to only versions before 0.6.3? > 0.6.3 fixes all CVEs. As OpenTTD now wants to push out an overlay with ebuilds, > the hard mask is holding it back (and I can't find a way to override the hard > mask from within an overlay). Thank you in advance. A file named package.unmask in profiles/ should work, I guess, so no need to change the masks in our official tree.  games, you should probably bump and unmask, once you've got time.   ```  [Comment 12](#c12)  Patric Stout    2008-10-19 11:29:33 UTC  ``` (In reply to [comment #11](show_bug.cgi?id=233929#c11)) > A file named package.unmask in profiles/ should work, I guess, so no need to > change the masks in our official tree. >  > games, you should probably bump and unmask, once you've got time. >   Exactly my thoughts ... but I couldn't get it to work. Then of course there is a good possibility I am doing something wrong.  # cat profiles/package.unmask games-simulation/openttd  # emerge -av openttd (still fails)  (same for '=games-simulation/openttd-0.6.3' and '<=games-simulation/openttd-0.6.2') ..  But okay, I will just wait for someone to official add 0.6.3 in the portage. Tnx for your reply! ```  [Comment 13](#c13)  Tupone Alfredo   gentoo-dev  2008-11-10 20:41:16 UTC  ``` Version 0.6.3 is in portage now and unmasked. Can be closed? ```  [Comment 14](#c14)  Christian Hoffmann (RETIRED)   gentoo-dev  2008-11-10 20:58:52 UTC  ``` (In reply to [comment #13](show_bug.cgi?id=233929#c13)) > Version 0.6.3 is in portage now and unmasked. Can be closed? Nah, we need this stable first. 0.6.3 ready to go stable? ```  [Comment 15](#c15)  Tupone Alfredo   gentoo-dev  2008-11-27 19:45:13 UTC  ``` (In reply to [comment #14](show_bug.cgi?id=233929#c14)) > 0.6.3 ready to go stable? As it use EAPI=2 we should wait for portage to stabilize   ```  [Comment 16](#c16)  Patric Stout    2008-11-27 19:46:55 UTC  ``` But why is it using EAPI=2 in the first place? It is not like it uses any of the new features ... ```  [Comment 17](#c17)  Robert Buchholz (RETIRED)   gentoo-dev  2008-11-27 19:52:39 UTC  ``` (In reply to [comment #16](show_bug.cgi?id=233929#c16)) > But why is it using EAPI=2 in the first place? It is not like it uses any of > the new features ...  The ebuild does, it has USE deps and src_configure. We can either wait this out until portage with EAPI=2 is stable, or create an -r1 that reintroduces built_with_use moves the src_configure code. ```  [Comment 18](#c18)  Patric Stout    2008-11-27 19:57:01 UTC  ``` Ah, sorry, you are right. I am trying to get the following ebuild in the official portage for ages now .. I seem to fail to do so ;)  <http://packages.openttd.org/gentoo/overlay/games-simulation/openttd/openttd-0.6.3.ebuild>  It uses EAPI=1, and is what we as OpenTTD publish as official ebuilds at the moment (as at least the general public can use it ...) ```  [Comment 19](#c19)  Mathias Hablützel    2009-01-01 15:18:58 UTC  ``` Regarding the status on the openttd website would it be possible to stabilize the ebuild? The last post has been commited on th 27th of November ... ```  [Comment 20](#c20)  Robert Buchholz (RETIRED)   gentoo-dev  2009-01-02 14:03:21 UTC  ``` EAPI-2 portage is now stable, is 0.6.3 good to go now? ```  [Comment 21](#c21)  Robert Buchholz (RETIRED)   gentoo-dev  2009-01-13 17:06:37 UTC  ``` Robin, do you approve of this going stable? ```  [Comment 22](#c22)  Robin Johnson   archtester Gentoo Infrastructure gentoo-dev Security  2009-01-13 20:47:11 UTC  ``` rbu: +1 from me. ```  [Comment 23](#c23)  Robert Buchholz (RETIRED)   gentoo-dev  2009-01-13 21:02:58 UTC  ``` Arches, please test and mark stable: =games-simulation/openttd-0.6.3 Target keywords : "amd64 ppc ppc64 x86" ```  [Comment 24](#c24)  Markus Meier   gentoo-dev  2009-01-15 21:56:28 UTC  ``` tests fail on amd64/x86: >>> Test phase [check]: games-simulation/openttd-0.6.3 make -j2 -j1 check  make[1]: Entering directory `/var/tmp/portage/games-simulation/openttd-0.6.3/work/openttd-0.6.3/objs/release' [SRC] No such source-file: check.[c|cpp|mm|rc] make[1]: Leaving directory `/var/tmp/portage/games-simulation/openttd-0.6.3/work/openttd-0.6.3/objs/release' cc -Wl,-O1  check.o   -o check gcc: check.o: No such file or directory make: *** [check] Error 1  *   * ERROR: games-simulation/openttd-0.6.3 failed.  * Call stack:  *               ebuild.sh, line   49:  Called src_test  *             environment, line 2583:  Called _eapi0_src_test  *               ebuild.sh, line  602:  Called die  * The specific snippet of code:  *   			hasq test $FEATURES && die "Make check failed. See above for details."  *  The die message:  *   Make check failed. See above for details.  games-simulation/openttd-0.6.3  USE="alsa iconv png truetype zlib -debug -dedicated -scenarios -timidity"  Portage 2.1.6.4 (default/linux/x86/2008.0/desktop, gcc-4.1.2, glibc-2.6.1-r0, 2.6.28 i686) ================================================================= System uname: Linux-2.6.28-i686-Intel-R-_Core-TM-2_Duo_CPU_T8300_@_2.40GHz-with-glibc2.0 Timestamp of tree: Thu, 15 Jan 2009 20:30:01 +0000 app-shells/bash:     3.2_p39 dev-java/java-config: 1.3.7-r1, 2.1.6-r1 dev-lang/python:     2.4.4-r14, 2.5.2-r7 dev-python/pycrypto: 2.0.1-r6 dev-util/cmake:      2.4.6-r1 sys-apps/baselayout: 1.12.11.1 sys-apps/sandbox:    1.2.18.1-r2 sys-devel/autoconf:  2.13, 2.63 sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2 sys-devel/binutils:  2.18-r3 sys-devel/gcc-config: 1.4.0-r4 sys-devel/libtool:   1.5.26 virtual/os-headers:  2.6.27-r2 ACCEPT_KEYWORDS="x86" CBUILD="i686-pc-linux-gnu" CFLAGS="-O2 -march=i686 -pipe" CHOST="i686-pc-linux-gnu" CONFIG_PROTECT="/etc /opt/openfire/resources/security/ /opt/openjms/config /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/fax /usr/share/config /var/bind /var/lib/hsqldb /var/qmail/alias /var/qmail/control /var/spool/fax/etc /var/spool/torque" CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d" CXXFLAGS="-O2 -march=i686 -pipe" DISTDIR="/usr/portage/distfiles" FEATURES="collision-protect distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict test unmerge-orphans userfetch userpriv usersandbox" GENTOO_MIRRORS="<http://distfiles.gentoo.org> <http://distro.ibiblio.org/pub/linux/distributions/gentoo>" LDFLAGS="-Wl,-O1" LINGUAS="en en_GB de" MAKEOPTS="-j2" PKGDIR="/mnt/packages" PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages" PORTAGE_TMPDIR="/var/tmp" PORTDIR="/usr/portage" PORTDIR_OVERLAY="/usr/local/portage" SYNC="rsync://rsync.gentoo.org/gentoo-portage" USE="X acl acpi alsa apache2 avahi berkdb bluetooth branding bzip2 cairo cdr cli cracklib crypt cups dbus dri dvd dvdr dvdread eds emboss encode esd evo examples fam firefox fortran gdbm gif gnome gpm gstreamer gtk hal iconv ipv6 isdnlog jpeg kde ldap libnotify mad midi mikmod mp3 mpeg mudflap ncurses nls nptl nptlonly ogg opengl openmp pam pcre pdf perl png ppds pppd python qt3 qt3support qt4 quicktime readline reflection sdl session source spell spl ssl startup-notification svg sysfs tcpd test tiff truetype unicode usb vorbis win32codecs x86 xml xorg xulrunner xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en en_GB de" USERLAND="GNU" VIDEO_CARDS="fbdev glint i810 intel mach64 mga neomagic nv r128 radeon savage sis tdfx trident vesa vga via vmware voodoo" Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS ```  [Comment 25](#c25)  Brent Baude (RETIRED)   gentoo-dev  2009-01-16 17:28:21 UTC  ``` same here on ppc64 ```  [Comment 26](#c26)  Tobias Scherbaum (RETIRED)   gentoo-dev  2009-01-18 11:07:58 UTC  ``` (In reply to [comment #25](show_bug.cgi?id=233929#c25)) > same here on ppc64 >   and same for ppc.  back to [ebuild], please re-add arches once this is fixed. thanks. ```  [Comment 27](#c27)  Patric Stout    2009-01-19 12:41:07 UTC  ``` OpenTTD doesn't know how to do a 'make check'. Any way to disable this in the ebuild? ```  [Comment 28](#c28)  Mr. Bones. (RETIRED)   gentoo-dev  2009-01-30 14:54:43 UTC  ``` added restrict for test ```  [Comment 29](#c29)  Robert Buchholz (RETIRED)   gentoo-dev  2009-01-30 16:49:34 UTC  ``` Arches, please test and mark stable: =games-simulation/openttd-0.6.3 Target keywords : "amd64 ppc ppc64 x86" ```  [Comment 30](#c30)  Markus Meier   gentoo-dev  2009-01-30 20:40:43 UTC  ``` amd64/x86 stable ```  [Comment 31](#c31)  Tobias Scherbaum (RETIRED)   gentoo-dev  2009-02-01 21:07:09 UTC  ``` ppc stable ```  [Comment 32](#c32)  Brent Baude (RETIRED)   gentoo-dev  2009-02-02 15:20:08 UTC  ``` ppc64 done ```  [Comment 33](#c33)  Robert Buchholz (RETIRED)   gentoo-dev  2009-03-07 16:31:06 UTC  ``` GLSA 200903-09 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=233929)
* - [XML](show_bug.cgi?ctype=xml&id=233929)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=233929)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=233929&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=233929&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=233929&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from marc.info_99d601f2_20250125_075545.html ===

```
[[prev in list](?l=oss-security&m=121787622112598&w=2)] [[next in list](?l=oss-security&m=121794741316551&w=2)] [[prev in thread](?l=oss-security&m=121787604812284&w=2)] [[next in thread](?l=oss-security&m=121797672406282&w=2)]
List:       [oss-security](?l=oss-security&r=1&w=2)
Subject:    [Re: [oss-security] CVE id request: openttd](?t=121787620300005&r=1&w=2)
From:       [Robert Buchholz <rbu () gentoo ! org>](?a=116765956400008&r=1&w=2)
Date:       [2008-08-05 3:22:37](?l=oss-security&r=1&w=2&b=200808)
Message-ID: [200808050522.40342.rbu () gentoo ! org](?i=200808050522.40342.rbu%20()%20gentoo%20!%20org)
[Download RAW [message](?l=oss-security&m=121790659421159&q=mbox) or [body](?l=oss-security&m=121790659421159&q=raw)]

On Monday 04 August 2008, Nico Golde wrote:
> "OpenTTD servers of version 0.6.1 and below are susceptible to a
> remotely exploitable buffer overflow when the server is filled with
> companies and clients with names that are (near) the maximum allowed
> length for names. In the worst case OpenTTD will write the following
> (mostly remotely changable bytes) into 1460 bytes of malloc-ed
> memory:
> up to 11 times (amount of players) 118 bytes
> up to 8 times (amount of companies) 124 bytes
> and 7 "header" bytes
> Resulting in up to 2297 bytes being written in 1460 bytes of
> malloc-ed memory. This makes it possible to remotely crash the game
> or change the gamestate into an unrecoverable state.  "
>
> This is Debian bug #493714.
>
> I didn't yet have the time to check the diff between the versions.

Secunia interpreted [[1]](#1) the "remotely exploitable buffer overflows"
mentioned in the changelog [[2]](#2) to be a "boundary error within
the "TruncateString()" function in src/gfx.cpp". This would be the
following patch [[3]](#3). However, this would overwrite the buffer by max. 2
bytes, and does not match your bug description too well. Is this maybe
r13712 [[4]](#4) ?

Robert

[[1]](#-1) <http://secunia.com/advisories/31350/>
[[2]](#-2) <http://sourceforge.net/project/shownotes.php?release_id=617243>
[[3]](#-3) <https://bugs.gentoo.org/attachment.cgi?id=162239>
[[4]](#-4) svn diff -c 13712 svn://svn.openttd.org/trunk

[["signature.asc" (application/pgp-signature)]](?l=oss-security&m=121790659421159&q=p3)

[[prev in list](?l=oss-security&m=121787622112598&w=2)] [[next in list](?l=oss-security&m=121794741316551&w=2)] [[prev in thread](?l=oss-security&m=121787604812284&w=2)] [[next in thread](?l=oss-security&m=121797672406282&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from bugs.debian.org_79264b8f_20250125_075543.html ===

# Debian Bug report logs - #493714 openttd: Network exploitable buffer overrun

[![version graph](version.cgi?fixed=openttd%2F0.6.2-1;width=2;package=openttd;height=2;absolute=0;found=openttd%2F0.6.1-1;collapse=1)](version.cgi?collapse=1;absolute=0;found=openttd%2F0.6.1-1;info=1;fixed=openttd%2F0.6.2-1;package=openttd)

Package:
[openttd](pkgreport.cgi?package=openttd);
Maintainer for [openttd](pkgreport.cgi?package=openttd) is [Matthijs Kooijman <matthijs@stdin.nl>](pkgreport.cgi?maint=matthijs%40stdin.nl); Source for [openttd](pkgreport.cgi?package=openttd) is [src:openttd](pkgreport.cgi?src=openttd) ([PTS](https://tracker.debian.org/pkg/openttd), [buildd](https://buildd.debian.org/openttd), [popcon](https://qa.debian.org/popcon.php?package=openttd)).

Reported by: [rubidium@rbijker.net](pkgreport.cgi?submitter=rubidium%40rbijker.net)

Date: Mon, 4 Aug 2008 12:57:01 UTC

Severity: *grave*

Tags: security

Found in version openttd/0.6.1-1

Fixed in version openttd/0.6.2-1

**Done:** Matthijs Kooijman <matthijs@stdin.nl>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=493714;mbox=yes), [status mbox](bugreport.cgi?bug=493714;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=493714;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Matthijs Kooijman <matthijs@stdin.nl>`:

`Bug#493714`; Package `openttd`.
([full text](bugreport.cgi?bug=493714;msg=2), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `rubidium@rbijker.net`:

New Bug report received and forwarded. Copy sent to `Matthijs Kooijman <matthijs@stdin.nl>`.
([full text](bugreport.cgi?bug=493714;msg=4), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=493714;msg=5), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=rubidium%40rbijker.net)
From: "R. Bijker" <rubidium@rbijker.net>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: openttd: Network exploitable buffer overrun
Date: Mon, 04 Aug 2008 14:54:36 +0200
```
Package: openttd
Version: 0.6.1-1
Severity: grave
Tags: security
Justification: user security hole

OpenTTD servers of version 0.6.1 and below are susceptible to a remotely
exploitable buffer overflow when the server is filled with companies and
clients with names that are (near) the maximum allowed length for names.
In the worst case OpenTTD will write the following (mostly remotely
changable bytes) into 1460 bytes of malloc-ed memory:
up to 11 times (amount of players) 118 bytes
up to 8 times (amount of companies) 124 bytes
and 7 "header" bytes
Resulting in up to 2297 bytes being written in 1460 bytes of malloc-ed
memory. This makes it possible to remotely crash the game or change the
gamestate into an unrecoverable state.

There are three ways of fixing this:
- upgrading to 0.6.2.
- backporting the bugfixes to 0.6.1 and make a network-incompatible version
 of OpenTTD which makes it impossible to participate in multiplayer games
 with both Debian and non-Debian users.
- increase the allocation size, which will make it even network incompatible
 with itself.

Therefore the best way to fix this is by upgrading to 0.6.2, also in lenny.

-- System Information:
Debian Release: lenny/sid
 APT prefers unstable
 APT policy: (500, 'unstable')
Architecture: i386 (i686)

Kernel: Linux 2.6.26 (PREEMPT)
Locale: LANG=en_GB.UTF-8, LC_CTYPE=en_GB.UTF-8 (charmap=UTF-8) (ignored:
LC_ALL set to en_GB.utf8)
Shell: /bin/sh linked to /bin/bash

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Matthijs Kooijman <matthijs@stdin.nl>`:

`Bug#493714`; Package `openttd`.
([full text](bugreport.cgi?bug=493714;msg=7), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Matthijs Kooijman <matthijs@stdin.nl>`.
([full text](bugreport.cgi?bug=493714;msg=9), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 493714@bugs.debian.org ([full text](bugreport.cgi?bug=493714;msg=10), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 493714@bugs.debian.org
Subject: CVE-2008-3547
Date: Fri, 8 Aug 2008 10:44:37 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493714;msg=10) (text/plain, inline)]
```
```
Hi,
please reference [CVE-2008-3547](https://security-tracker.debian.org/tracker/CVE-2008-3547) as the CVE id in the
changelog if you close this bug.

Kind regards
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=493714;msg=10) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Matthijs Kooijman <matthijs@stdin.nl>`:

`Bug#493714`; Package `openttd`.
([full text](bugreport.cgi?bug=493714;msg=12), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent** to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Matthijs Kooijman <matthijs@stdin.nl>`.
([full text](bugreport.cgi?bug=493714;msg=14), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 493714@bugs.debian.org ([full text](bugreport.cgi?bug=493714;msg=15), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: "R. Bijker" <rubidium@rbijker.net>
Cc: 493714@bugs.debian.org
Subject: Re: openttd: Network exploitable buffer overrun
Date: Sun, 10 Aug 2008 16:53:59 +0200
```
R. Bijker wrote:
> Therefore the best way to fix this is by upgrading to 0.6.2, also in lenny.

I agree, can you upload 0.6.2 to unstable?

Cheers,
        Moritz

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Matthijs Kooijman <matthijs@stdin.nl>`:

`Bug#493714`; Package `openttd`.
([full text](bugreport.cgi?bug=493714;msg=17), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent** to `rubidium@rbijker.net`:

Extra info received and forwarded to list. Copy sent to `Matthijs Kooijman <matthijs@stdin.nl>`.
([full text](bugreport.cgi?bug=493714;msg=19), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 493714@bugs.debian.org ([full text](bugreport.cgi?bug=493714;msg=20), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=rubidium%40rbijker.net)
From: "R. Bijker" <rubidium@rbijker.net>
To: Moritz Muehlenhoff <jmm@inutil.org>
Cc: 493714@bugs.debian.org
Subject: Re: openttd: Network exploitable buffer overrun
Date: Sun, 10 Aug 2008 21:14:46 +0200
```
Moritz Muehlenhoff wrote:
> I agree, can you upload 0.6.2 to unstable?
>
> Cheers,
>         Moritz
>
I have absolutely no influence over getting OpenTTD 0.6.2 physically
uploaded to Debian-unstable.

Regards,
Remko Bijker

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Matthijs Kooijman <matthijs@stdin.nl>`:

`Bug#493714`; Package `openttd`.
([full text](bugreport.cgi?bug=493714;msg=22), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Matthijs Kooijman <matthijs@stdin.nl>`.
([full text](bugreport.cgi?bug=493714;msg=24), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 493714@bugs.debian.org ([full text](bugreport.cgi?bug=493714;msg=25), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Moritz Muehlenhoff <jmm@inutil.org>, 493714@bugs.debian.org
Cc: "R. Bijker" <rubidium@rbijker.net>
Subject: Re: Bug#493714: openttd: Network exploitable buffer overrun
Date: Sun, 10 Aug 2008 21:32:07 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493714;msg=25) (text/plain, inline)]
```
```
Hi Moritz,
* Moritz Muehlenhoff <jmm@inutil.org> [2008-08-10 20:42]:
> R. Bijker wrote:
> > Therefore the best way to fix this is by upgrading to 0.6.2, also in lenny.
>
> I agree, can you upload 0.6.2 to unstable?

I got a private mail by the maintainer stating:
"New version should be uploaded this weekend, I'll mail the
release team with details when that happens."

Cheers
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=493714;msg=25) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#493714`; Package `openttd`.
([full text](bugreport.cgi?bug=493714;msg=27), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent** to `Matthijs Kooijman <matthijs@stdin.nl>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=493714;msg=29), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 493714@bugs.debian.org ([full text](bugreport.cgi?bug=493714;msg=30), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=matthijs%40stdin.nl)
From: Matthijs Kooijman <matthijs@stdin.nl>
To: Nico Golde <nion@debian.org>, 493714@bugs.debian.org
Cc: Moritz Muehlenhoff <jmm@inutil.org>, "R. Bijker" <rubidium@rbijker.net>
Subject: Re: Bug#493714: openttd: Network exploitable buffer overrun
Date: Tue, 12 Aug 2008 11:33:17 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493714;msg=30) (text/plain, inline)]
```
```
Hi,

> I got a private mail by the maintainer stating:
> "New version should be uploaded this weekend, I'll mail the
> release team with details when that happens."
I'm having a bit of a problem with this upload, since my regular sponsor seems
to be away. I had asked a DD to upload it last weekend, but hasn't had time
for it yet. I've put the new version up at mentors.debian.net and asked for a
sponsor on debian-mentors@ as well.

Release team has also been mailed about possibly including this version in
testing.

Gr.

Matthijs

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493714;filename=signature.asc;msg=30) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Matthijs Kooijman <matthijs@stdin.nl>`:

`Bug#493714`; Package `openttd`.
([full text](bugreport.cgi?bug=493714;msg=32), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=32), [link](#31)).

---

**Acknowledgement sent** to `Thijs Kinkhorst <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Matthijs Kooijman <matthijs@stdin.nl>`.
([full text](bugreport.cgi?bug=493714;msg=34), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 493714@bugs.debian.org ([full text](bugreport.cgi?bug=493714;msg=35), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: Thijs Kinkhorst <thijs@debian.org>
To: 493714@bugs.debian.org
Cc: Moritz Muehlenhoff <jmm@inutil.org>,
"R. Bijker" <rubidium@rbijker.net>,
Nico Golde <nion@debian.org>
Subject: Re: Bug#493714: openttd: Network exploitable buffer overrun
Date: Wed, 13 Aug 2008 11:11:14 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493714;msg=35) (text/plain, inline)]
```
```
> > I got a private mail by the maintainer stating:
> > "New version should be uploaded this weekend, I'll mail the
> > release team with details when that happens."
>
> I'm having a bit of a problem with this upload, since my regular sponsor
> seems to be away. I had asked a DD to upload it last weekend, but hasn't
> had time for it yet. I've put the new version up at mentors.debian.net and
> asked for a sponsor on debian-mentors@ as well.

I've sponsored this upload now.

cheers,
Thijs

```
```
[[Message part 2](bugreport.cgi?att=1;bug=493714;msg=35) (application/pgp-signature, inline)]
```

---

**Reply sent** to `Matthijs Kooijman <matthijs@stdin.nl>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=493714;msg=37), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=37), [link](#36)).

---

**Notification sent** to `rubidium@rbijker.net`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=493714;msg=39), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=39), [link](#38)).

---

[Message #40](#40) received at 493714-close@bugs.debian.org ([full text](bugreport.cgi?bug=493714;msg=40), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=40), reply):

![](/cgi-bin/libravatar.cgi?email=matthijs%40stdin.nl)
From: Matthijs Kooijman <matthijs@stdin.nl>
To: 493714-close@bugs.debian.org
Subject: Bug#493714: fixed in openttd 0.6.2-1
Date: Wed, 13 Aug 2008 09:17:24 +0000
```
Source: openttd
Source-Version: 0.6.2-1

We believe that the bug you reported is fixed in the latest version of
openttd, which is due to be installed in the Debian FTP archive:

openttd_0.6.2-1.diff.gz
  to pool/contrib/o/openttd/openttd_0.6.2-1.diff.gz
openttd_0.6.2-1.dsc
  to pool/contrib/o/openttd/openttd_0.6.2-1.dsc
openttd_0.6.2-1_i386.deb
  to pool/contrib/o/openttd/openttd_0.6.2-1_i386.deb
openttd_0.6.2.orig.tar.gz
  to pool/contrib/o/openttd/openttd_0.6.2.orig.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 493714@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Matthijs Kooijman <matthijs@stdin.nl> (supplier of updated openttd package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Fri, 08 Aug 2008 11:07:05 +0200
Source: openttd
Binary: openttd
Architecture: source i386
Version: 0.6.2-1
Distribution: unstable
Urgency: high
Maintainer: Matthijs Kooijman <matthijs@stdin.nl>
Changed-By: Matthijs Kooijman <matthijs@stdin.nl>
Description:
 openttd    - reimplementation of Transport Tycoon Deluxe with enhancements
Closes: [493714](bugreport.cgi?bug=493714)
Changes:
 openttd (0.6.2-1) unstable; urgency=high
 .
   * New upstream release.
     - Fixes remote crash vulnerability [CVE-2008-3547](https://security-tracker.debian.org/tracker/CVE-2008-3547). Closes: #[493714](bugreport.cgi?bug=493714)
Checksums-Sha1:
 a7177c3ac8b54886b9c0ddcc0bb90d3fbe838635 1544 openttd_0.6.2-1.dsc
 04465c64ee43e1af7353b6d3801d79c52cf9ee30 4950519 openttd_0.6.2.orig.tar.gz
 fc0c34e028ec6032f1b8ef4f4f14f01a6d6e540c 8959 openttd_0.6.2-1.diff.gz
 fe2e8642c9fcb96a82f6e82648d18ab8f886794e 2632916 openttd_0.6.2-1_i386.deb
Checksums-Sha256:
 cf59f62c4c257e73bc93dea3007bbd693d315c06d0929f2169e6ad09bf7c9625 1544 openttd_0.6.2-1.dsc
 d53f0eee9f7dc9f2ec51143c6ee6b87b1daa39378ffb77b8fb285bde76191207 4950519 openttd_0.6.2.orig.tar.gz
 5d37d50e5b6b9e517bf3e2a8e891979b53664140c97c94e97f5cdcb483405f43 8959 openttd_0.6.2-1.diff.gz
 a7fc246bff1d5b010fbd2c70a048c2de34da054acf75964ec6e7c57b599df729 2632916 openttd_0.6.2-1_i386.deb
Files:
 182add99a5e0ed4089c09ab0665dbb7d 1544 contrib/games optional openttd_0.6.2-1.dsc
 7e3f577e605e24479ead594259276be9 4950519 contrib/games optional openttd_0.6.2.orig.tar.gz
 148e100075917fcfe2cab4a6a9d3f957 8959 contrib/games optional openttd_0.6.2-1.diff.gz
 f0b1363e58efa2a11b063c388e649a0c 2632916 contrib/games optional openttd_0.6.2-1_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iQEcBAEBAgAGBQJIoqStAAoJEGz0hbPcukPfRk4H/1og0lmNsOl5Z4eHlh4FhfgE
jI0YYXywpjQtFxDhRBKU+DN9+/zm4Tlf8COsZuHYCjRzW86+hVdz5o2f5uFcPSU2
J21qfFozQEHr91qFUayOJq4iKuKwNyBmwjRfOOxUqX+KYEFIcv7JCsZTNzGMGfAK
e6vijqsELYIXvo8TiAwCByDpg5NxL3j1u4JcHATtBmg8iQ3kamML4dJVE8fNWGSc
TcVag1jwjQ9T/Uyy6hNPYXlqcTQ9bZztkYYiVkjf7C9t0jbtHsLMqWo9Or+dApb7
ZULILVxBO9CEX/0RdZk6r9190UFFYtzgrwUgMmk+x3BWFdTw8apcxwEVp7pnGGc=
=2PVg
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 16 Sep 2008 07:26:42 GMT) ([full text](bugreport.cgi?bug=493714;msg=42), [mbox](bugreport.cgi?bug=493714;mbox=yes;msg=42), [link](#41)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=493714).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 07:55:42 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from marc.info_a430f180_20250125_075547.html ===

```
[[prev in list](?l=oss-security&m=121814168405353&w=2)] [[next in list](?l=oss-security&m=121818810904510&w=2)] [[prev in thread](?l=oss-security&m=121797672406282&w=2)] [next in thread]
List:       [oss-security](?l=oss-security&r=1&w=2)
Subject:    [Re: [oss-security] CVE id request: openttd](?t=121787620300005&r=1&w=2)
From:       ["Steven M. Christey" <coley () linus ! mitre ! org>](?a=91888144900001&r=1&w=2)
Date:       [2008-08-07 20:42:47](?l=oss-security&r=1&w=2&b=200808)
Message-ID: [Pine.GSO.4.51.0808071642120.25461 () faron ! mitre ! org](?i=Pine.GSO.4.51.0808071642120.25461%20()%20faron%20!%20mitre%20!%20org)
[Download RAW [message](?l=oss-security&m=121814230706576&q=mbox) or [body](?l=oss-security&m=121814230706576&q=raw)]

On Mon, 4 Aug 2008, Nico Golde wrote:

> "OpenTTD servers of version 0.6.1 and below are susceptible to a remotely
> exploitable buffer overflow when the server is filled with companies and
> clients with names that are (near) the maximum allowed length for names.
> In the worst case OpenTTD will write the following (mostly remotely
> changable bytes) into 1460 bytes of malloc-ed memory:
> up to 11 times (amount of players) 118 bytes
> up to 8 times (amount of companies) 124 bytes
> and 7 "header" bytes
> Resulting in up to 2297 bytes being written in 1460 bytes of malloc-ed
> memory. This makes it possible to remotely crash the game or change the
> gamestate into an unrecoverable state.  "
>
> This is Debian bug #493714.

Use CVE-2008-3547 (to be updated later) for this issue, as reported.

If Secunia wound up reporting a distinct bug, that would need an
additional CVE.

- Steve
[[prev in list](?l=oss-security&m=121814168405353&w=2)] [[next in list](?l=oss-security&m=121818810904510&w=2)] [[prev in thread](?l=oss-security&m=121797672406282&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_9d64cafd_20250125_075545.html ===

```
[[prev in list](?l=oss-security&m=121787579811733&w=2)] [[next in list](?l=oss-security&m=121787622112598&w=2)] [prev in thread] [[next in thread](?l=oss-security&m=121790659421159&w=2)]
List:       [oss-security](?l=oss-security&r=1&w=2)
Subject:    [[oss-security] CVE id request: openttd](?t=121787620300005&r=1&w=2)
From:       [Nico Golde <oss-security+ml () ngolde ! de>](?a=120405081400011&r=1&w=2)
Date:       [2008-08-04 18:53:14](?l=oss-security&r=1&w=2&b=200808)
Message-ID: [20080804185314.GA13412 () ngolde ! de](?i=20080804185314.GA13412%20()%20ngolde%20!%20de)
[Download RAW [message](?l=oss-security&m=121787604812284&q=mbox) or [body](?l=oss-security&m=121787604812284&q=raw)]

Hi,
Can I get a CVE id for the following security issues fixed
in openttd 6.2?

"OpenTTD servers of version 0.6.1 and below are susceptible to a remotely
exploitable buffer overflow when the server is filled with companies and
clients with names that are (near) the maximum allowed length for names.
In the worst case OpenTTD will write the following (mostly remotely
changable bytes) into 1460 bytes of malloc-ed memory:
up to 11 times (amount of players) 118 bytes
up to 8 times (amount of companies) 124 bytes
and 7 "header" bytes
Resulting in up to 2297 bytes being written in 1460 bytes of malloc-ed
memory. This makes it possible to remotely crash the game or change the
gamestate into an unrecoverable state.  "

This is Debian bug #493714.

I didn't yet have the time to check the diff between the versions.

Kind regards
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

[[Attachment #3 (application/pgp-signature)]](?l=oss-security&m=121787604812284&q=p3)

[[prev in list](?l=oss-security&m=121787579811733&w=2)] [[next in list](?l=oss-security&m=121787622112598&w=2)] [prev in thread] [[next in thread](?l=oss-security&m=121790659421159&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from security-tracker.debian.org_545f994a_20250126_072359.html ===

# CVE-2008-3547

| **Name** | CVE-2008-3547 |
| --- | --- |
| **Description** | Buffer overflow in the server in OpenTTD 0.6.1 and earlier allows remote authenticated users to cause a denial of service (persistent game disruption) or possibly execute arbitrary code via vectors involving many long names for "companies and clients." |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2008-3547) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2008-3547); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2008-3547), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2008-3547), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2008-3547), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2008-3547), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2008-3547), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2008-3547), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2008-3547), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2008-3547)/[CVE](https://www.suse.com/security/cve/CVE-2008-3547/), GitHub [advisories](https://github.com/advisories?query=CVE-2008-3547)/[code](https://github.com/search?type=Code&q=%22CVE-2008-3547%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2008-3547%22), [web search](https://duckduckgo.com/html?q=%22CVE-2008-3547%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [493714](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493714) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [openttd](/tracker/source-package/openttd) ([PTS](https://tracker.debian.org/pkg/openttd)) | bullseye | 1.10.3-1 | fixed |
|  | bookworm | 13.0-2 | fixed |
|  | sid | 14.1-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [openttd](/tracker/source-package/openttd) | source | (unstable) | 0.6.2-1 | medium |  | [493714](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493714) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from marc.info_fcf14e12_20250125_075546.html ===

```
[[prev in list](?l=oss-security&m=121796755222658&w=2)] [[next in list](?l=oss-security&m=121803012019929&w=2)] [[prev in thread](?l=oss-security&m=121790659421159&w=2)] [[next in thread](?l=oss-security&m=121814230706576&w=2)]
List:       [oss-security](?l=oss-security&r=1&w=2)
Subject:    [Re: [oss-security] CVE id request: openttd](?t=121787620300005&r=1&w=2)
From:       [Nico Golde <oss-security+ml () ngolde ! de>](?a=120405081400011&r=1&w=2)
Date:       [2008-08-05 22:38:25](?l=oss-security&r=1&w=2&b=200808)
Message-ID: [20080805223825.GA4437 () ngolde ! de](?i=20080805223825.GA4437%20()%20ngolde%20!%20de)
[Download RAW [message](?l=oss-security&m=121797672406282&q=mbox) or [body](?l=oss-security&m=121797672406282&q=raw)]

Hi Robert,
here we go...
* Robert Buchholz <rbu@gentoo.org> [2008-08-05 06:29]:
> On Monday 04 August 2008, Nico Golde wrote:
> > "OpenTTD servers of version 0.6.1 and below are susceptible to a
> > remotely exploitable buffer overflow when the server is filled with
> > companies and clients with names that are (near) the maximum allowed
> > length for names. In the worst case OpenTTD will write the following
> > (mostly remotely changable bytes) into 1460 bytes of malloc-ed
> > memory:
> > up to 11 times (amount of players) 118 bytes
> > up to 8 times (amount of companies) 124 bytes
> > and 7 "header" bytes
> > Resulting in up to 2297 bytes being written in 1460 bytes of
> > malloc-ed memory. This makes it possible to remotely crash the game
> > or change the gamestate into an unrecoverable state.  "
> >
> > This is Debian bug #493714.
> >
> > I didn't yet have the time to check the diff between the versions.
>
> Secunia interpreted [[1]](#1) the "remotely exploitable buffer overflows"
> mentioned in the changelog [[2]](#2) to be a "boundary error within
> the "TruncateString()" function in src/gfx.cpp". This would be the
> following patch [[3]](#3).

This is only used when drawing the data but not for
communicatin between server and clients.

> However, this would overwrite the buffer by max. 2
> bytes, and does not match your bug description too well. Is this maybe
> r13712 [[4]](#4) ?

Not exactly, this is the length enforcement on the client
side. The fix on the server side is
svn diff -c 13713 svn://svn.openttd.org/trunk.
However the problem with this is that it does break network
compatibility between different versions so it might be a
bad idea to backport this. This way you can only proceed
playing with people who also use this backported fix :/

Kind regards
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

[[Attachment #3 (application/pgp-signature)]](?l=oss-security&m=121797672406282&q=p3)

[[prev in list](?l=oss-security&m=121796755222658&w=2)] [[next in list](?l=oss-security&m=121803012019929&w=2)] [[prev in thread](?l=oss-security&m=121790659421159&w=2)] [[next in thread](?l=oss-security&m=121814230706576&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


