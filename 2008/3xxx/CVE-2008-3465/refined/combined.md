=== Content from docs.microsoft.com_12e25b44_20250125_231701.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2008/ms08-071.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 06/08/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS08-071 - Critical

## Vulnerabilities in GDI Could Allow Remote Code Execution (956802)

Published: December 09, 2008 | Updated: December 10, 2008

**Version:** 1.1

### General Information

#### Executive Summary

This security update resolves two privately reported vulnerabilities in GDI. Exploitation of either of these vulnerabilities could allow remote code execution if a user opens a specially crafted WMF image file. An attacker who successfully exploited these vulnerabilities could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

This security update is rated Critical for all supported editions of Microsoft Windows 2000, Windows XP, Windows Server 2003, Windows Vista, and Windows Server 2008. For more information, see the subsection, **Affected and Non-Affected Software**, in this section.

The security update addresses the vulnerabilities by modifying the way GDI validates file size parameters and performs integer calculations to prevent overflow conditions. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, **Vulnerability Information**.

**Recommendation.** Microsoft recommends that customers apply the update immediately.

**Known Issues.** None

#### Affected and Non-Affected Software

The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| Operating System | Maximum Security Impact | Aggregate Severity Rating | Bulletins Replaced by this Update |
| --- | --- | --- | --- |
| [Microsoft Windows 2000 Service Pack 4](https://www.microsoft.com/download/details.aspx?familyid=3b775fb1-1077-455d-af4a-4ccb5237974f) | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows XP Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=2151fbba-c464-4d1e-82d4-5b096e82bed0) | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows XP Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=2151fbba-c464-4d1e-82d4-5b096e82bed0) | Remote Code Execution | Critical | None |
| [Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=2247f6a5-aa33-4c68-9ea8-a63488d126d3) | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=0c396796-0929-4cd2-99e8-3c0f7075a89e) | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=6d5c7d2f-1a82-4cdf-b3f2-b2c2390c6a64) | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems](https://www.microsoft.com/download/details.aspx?familyid=1edb62b4-3d0f-4891-b4b3-8f8bc4e7bdfe) | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows Vista and Windows Vista Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=cddf9cf6-bdeb-4429-823a-879387a428d7) | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows Vista x64 Edition and Windows Vista x64 Edition Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=73dc3775-b6f0-40f1-bd36-6b5fb80eb2fa) | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows Server 2008 for 32-bit Systems](https://www.microsoft.com/download/details.aspx?familyid=bbed9e8b-e75e-44ef-ba1d-fd6f852c1f67)\* | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows Server 2008 for x64-based Systems](https://www.microsoft.com/download/details.aspx?familyid=48aecf4c-1296-490d-ba37-a28e3ec19bd6)\* | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |
| [Windows Server 2008 for Itanium-based Systems](https://www.microsoft.com/download/details.aspx?familyid=9bfe15cd-02ff-45cf-85c8-5ff1e6c1a871) | Remote Code Execution | Critical | [MS08-021](https://go.microsoft.com/fwlink/?linkid=111955) |

**\*Windows Server 2008 server core installation affected.** For supported editions of Windows Server 2008, this update applies, with the same severity rating, whether or not Windows Server 2008 was installed using the Server Core installation option. For more information on this installation option, see [Server Core](https://msdn.microsoft.com/library/ms723891%28vs.85%29.aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008; see [Compare Server Core Installation Options](https://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx).

## Frequently Asked Questions (FAQ) Related to This Security Update

**Where are the file information details?**

The file information details can be found in [Microsoft Knowledge Base Article 956802](https://support.microsoft.com/kb/956802).

**Why does this update address several reported security vulnerabilities?**

This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only.

**I am using an older release of the software discussed in this security bulletin. What should I do?**

The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. To determine the support life cycle for your software release, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. For more information about the Windows Product Lifecycle, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742). For more information about the extended security update support period for these software versions or editions, visit [Microsoft Product Support Services](https://go.microsoft.com/fwlink/?linkid=33328).

Customers who require custom support for older releases must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit [Microsoft Worldwide Information](https://go.microsoft.com/fwlink/?linkid=33329), select the country, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Windows Operating System Product Support Lifecycle FAQ](https://go.microsoft.com/fwlink/?linkid=33330).

### Vulnerability Information

## Severity Ratings and Vulnerability Identifiers

| Affected Software | GDI Integer Overflow Vulnerability - CVE-2008-2249 | GDI Heap Overflow Vulnerability - CVE-2008-3465 | Aggregate Severity Rating |
| --- | --- | --- | --- |
| Microsoft Windows 2000 Service Pack 4 | **Critical**\ Remote Code Execution | **Moderate**\ Remote Code Execution | **Critical** |
| Windows XP Service Pack 2 and Windows XP Service Pack 3 | **Critical**\ Remote Code Execution | **Moderate**\ Remote Code Execution | **Critical** |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 | **Critical**\ Remote Code Execution | **Moderate**\ Remote Code Execution | **Critical** |
| Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2 | **Critical**\ Remote Code Execution | **Moderate**\ Remote Code Execution | **Critical** |
| Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2 | **Critical**\ Remote Code Execution | **Moderate**\ Remote Code Execution | **Critical** |
| Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | **Critical**\ Remote Code Execution | **Moderate**\ Remote Code Execution | **Critical** |
| Windows Vista and Windows Vista Service Pack 1 | **Critical**\ Remote Code Execution | **Low**\ Denial of Service | **Critical** |
| Windows Vista x64 Edition and Windows Vista x64 Edition Service Pack 1 | **Critical**\ Remote Code Execution | **Low**\ Denial of Service | **Critical** |
| Windows Server 2008 for 32-bit Systems\* | **Critical**\ Remote Code Execution | **Low**\ Denial of Service | **Critical** |
| Windows Server 2008 for x64-based Systems\* | **Critical**\ Remote Code Execution | **Low**\ Denial of Service | **Critical** |
| Windows Server 2008 for Itanium-based Systems | **Critical**\ Remote Code Execution | **Low**\ Denial of Service | **Critical** |

**\*Windows Server 2008 server core installation affected.** For supported editions of Windows Server 2008, this update applies, with the same severity rating, whether or not Windows Server 2008 was installed using the Server Core installation option. For more information on this installation option, see [Server Core](https://msdn.microsoft.com/library/ms723891%28vs.85%29.aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008; see [Compare Server Core Installation Options](https://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx).

## GDI Integer Overflow Vulnerability - CVE-2008-2249

A remote code execution vulnerability exists in the way that GDI handles integer calculations. The vulnerability could allow remote code execution if a user opens a specially crafted WMF image file. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2008-2249](https://www.cve.org/CVERecord?id=CVE-2008-2249).

#### Mitigating Factors for GDI Integer Overflow Vulnerability - CVE-2008-2249

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.
* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attackerâs Web site.
* Users who have installed and are using the [Office Document Open Confirmation Tool](https://www.microsoft.com/download/details.aspx?familyid=8b5762d2-077f-4031-9ee6-c9538e9f2a2f) for Office 2000 will be prompted with Open, Save, or Cancel before opening a document. The features of the Office Document Open Confirmation Tool are incorporated in Office XP and later editions of Office.

#### Workarounds for GDI Integer Overflow Vulnerability - CVE-2008-2249

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Turn off metafile processing by modifying the registry**

  Customers who have applied MS07-017 or customers using Windows Vista or Windows Server 2008 can disable metafile processing by modifying the registry. This setting will help protect the affected system from attempts to exploit this vulnerability.

  To modify the key, follow these steps:

  **Note** Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  1. Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.
  2. Locate and then click the following registry subkey:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\GRE\_Initialize
  3. On the **Edit** menu, point to **New**, and then click **DWORD**.
  4. Type **DisableMetaFiles**, and then press ENTER.
  5. On the **Edit** menu, click **Modify** to modify the DisableMetaFiles registry entry.
  6. In the **Value data** box, type **1**, and then click **OK**.
  7. Exit Registry Editor.
  8. Reboot the computer.

  **Impact of workaround.** Turning off processing of metafiles may cause the appearance of the output from software or system components to decrease in quality. Turning off processing of metafiles may also cause software or system components to fail completely. This workaround has been identified to have a potentially significant functionality impact and should be evaluated and tested carefully to determine its applicability.

  Examples include the following:
* You cannot print on the computer.
* Some applications on the computer may be unable to display Clipart.
* Some scenarios that involve OLE rendering may break. This most often occurs when the object server is not active.

  For more information on this setting read [Microsoft Knowledge Base Article 941835](https://support.microsoft.com/kb/941835).

  **How to undo the workaround.**

  1. Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.
  2. Locate and then click the following registry subkey:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\GRE\_Initialize
  3. On the **Edit** menu, click **Modify** to modify the DisableMetaFiles registry entry.
  4. In the **Value** data box, type **0**, and then click **OK**.
  5. Exit Registry Editor.
  6. Reboot the computer.

  You may have to restart your computer for this change to take effect.
* **Read E-mail in Plain Text**

  To help protect yourself from the e-mail attack vector, read e-mail messages in plain text format.

  Microsoft Outlook 2002 users who have applied Office XP Service Pack 1 or a later version and Microsoft Outlook Express 6 users who have applied Internet Explorer 6 Service Pack 1 or a later version can enable this setting and view e-mail messages that are not digitally signed or e-mail messages that are not encrypted in plain text only.

  Digitally signed e-mail messages or encrypted e-mail messages are not affected by the setting and may be read in their original formats. For more information about how to enable this setting in Outlook 2002, see [Microsoft Knowledge Base Article 307594](https://support.microsoft.com/kb/307594).

  For information about this setting in Outlook Express 6, see [Microsoft Knowledge Base Article 291387](https://support.microsoft.com/kb/291387).

  **Impact of workaround:** E-mail messages that are viewed in plain text format will not contain pictures, specialized fonts, animations, or other rich content. Additionally:

  + The changes are applied to the preview pane and to open messages.
  + Pictures become attachments so that they are not lost.
  + Because the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly.

#### FAQ for GDI Integer Overflow Vulnerability - CVE-2008-2249

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

**What causes the vulnerability?**

The vulnerability is caused by a buffer overflow when GDI improperly processes a malformed header in a specially crafted WMF image file.

**What is GDI?**

The Microsoft Windows graphics device interface (GDI) enables applications to use graphics and formatted text on both the video display and the printer. Windows-based applications do not access the graphics hardware directly. Instead, GDI interacts with device drivers on behalf of applications. For more information about GDI, visit the [Windows GDI Start Page](https://msdn.microsoft.com/library/ms536795.aspx).

**What is the Windows Metafile (WMF) image format?**

The WMF image format is a 16-bit metafile format that can contain both vector information and bitmap information. It is optimized for the Windows operating system.

For more information about image types and formats, see [Microsoft Knowledge Base Article 320314](https://support.microsoft.com/kb/320314). Additional information about these file formats is also available at the [MSDN Library Web Site](https://msdn.microsoft.com/library/default.asp?url=/library/gdicpp/gdiplus/aboutgdiplus/imagesbitmapsandmetafiles/metafiles.asp).

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could run arbitrary code. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

**How could an attacker exploit the vulnerability?**

This vulnerability requires that a user view a specially crafted image file.

In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail with a specially-crafted WMF image file embedded in it to the user and convincing the user to view or preview the email. An attacker could also embed a specially-crafted WMF image file in an Office document and convince the user to open the file.

In a Web-based attack scenario, an attacker would have to host a Web site that contains a WMF image file that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's site.

**What systems are primarily at risk from the vulnerability?**

Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this.

**What does the update do?**

The update addresses the vulnerability by modifying the way GDI performs integer calculations to prevent an overflow condition.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure. Microsoft had not received any information to indicate that this vulnerability had been publicly disclosed when this security bulletin was originally issued. This security bulletin addresses the privately disclosed vulnerability as well as additional issues discovered through internal investigations.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

## GDI Heap Overflow Vulnerability - CVE-2008-3465

A remote code execution vulnerability exists in the way that GDI handles file size parameters in WMF files. The vulnerability could allow remote code execution if a third-party application uses a specific Microsoft API to copy a specially crafted WMF image file. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2008-3465](https://www.cve.org/CVERecord?id=CVE-2008-3465).

#### Mitigating Factors for GDI Heap Overflow Vulnerability - CVE-2008-3465

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

#### Workarounds for GDI Heap Overflow Vulnerability - CVE-2008-3465

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Turn off metafile processing by modifying the registry**

  Customers who have applied MS07-017 or customers using Windows Vista or Windows Server 2008 can disable metafile processing by modifying the registry. This setting will help protect the affected system from attempts to exploit this vulnerability.

  To modify the key, follow these steps:

  **Note** Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  1. Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.
  2. Locate and then click the following registry subkey:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\GRE\_Initialize
  3. On the **Edit** menu, point to **New**, and then click **DWORD**.
  4. Type **DisableMetaFiles**, and then press ENTER.
  5. On the **Edit** menu, click **Modify** to modify the DisableMetaFiles registry entry.
  6. In the **Value data** box, type **1**, and then click **OK**.
  7. Exit Registry Editor.
  8. Reboot the computer.

  **Impact of workaround.** Turning off processing of metafiles may cause the appearance of the output from software or system components to decrease in quality. Turning off processing of metafiles may also cause software or system components to fail completely. This workaround has been identified to have a potentially significant functionality impact and should be evaluated and tested carefully to determine its applicability.

  Examples include the following:
* You cannot print on the computer.
* Some applications on the computer may be unable to display Clipart.
* Some scenarios that involve OLE rendering may break. This most often occurs when the object server is not active.

  For more information on this setting read [Microsoft Knowledge Base Article 941835](https://support.microsoft.com/kb/941835).

  **How to undo the workaround.**

  1. Click **Start**, click **Run**, type **Regedit** in the **Open** box, and then click **OK**.
  2. Locate and then click the following registry subkey:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\GRE\_Initialize
  3. On the **Edit** menu, click **Modify** to modify the DisableMetaFiles registry entry.
  4. In the **Value** data box, type **0**, and then click **OK**.
  5. Exit Registry Editor.
  6. Reboot the computer.

  You may have to restart your computer for this change to take effect.

#### FAQ for GDI Heap Overflow Vulnerability - CVE-2008-3465

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

**What causes the vulnerability?**

The vulnerability is caused by a heap overflow when GDI improperly processes a malformed file size parameter in a specially crafted WMF image file.

**What is GDI?**

The Microsoft Windows graphics device interface (GDI) enables applications to use graphics and formatted text on both the video display and the printer. Windows-based applications do not access the graphics hardware directly. Instead, GDI interacts with device drivers on behalf of applications. For more information about GDI, visit the [Windows GDI Start Page](https://msdn.microsoft.com/library/ms536795.aspx).

**What is the Windows Metafile (WMF) image format?**

The WMF image format is a 16-bit metafile format that can contain both vector information and bitmap information. It is optimized for the Windows operating system.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could run arbitrary code. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

On Windows Vista and Windows Server 2008, an attacker who successfully exploited this vulnerability could cause the affected application to become non-responsive. The application would need to be restarted to restore functionality.

**How could an attacker exploit the vulnerability?**

This vulnerability requires a third-party application make a copy of a WMF file through this API. Depending on the behavior of the third-party application, this could lead to remote code execution in the context of the logged on user.

We are not currently aware of any remote avenues for accessing this vulnerability using Microsoft products.

**How do I determine if a third party application is affected?**

Users are encouraged to contact their third-party software vendors whose products process or potentially copy WMF files to determine if they are affected.

**What systems are primarily at risk from the vulnerability?**

All currently supported Windows systems are at risk.

**What does the update do?**

The update addresses the vulnerability by modifying the way GDI handles file size parameters to prevent buffer overflow conditions.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure. Microsoft had not received any information to indicate that this vulnerability had been publicly disclosed when this security bulletin was originally issued. This security bulletin addresses the privately disclosed vulnerability as well as additional issues discovered through internal investigations.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

### Update Information

## Detection and Deployment Tools and Guidance

Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](https://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](https://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products.

Security updates are available from [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747), [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130), and [Office Update](https://go.microsoft.com/fwlink/?linkid=21135). Security updates are also available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for "security update."

Finally, security updates can be downloaded from the [Microsoft Update Catalog](https://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, âMS07-036â), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](https://go.microsoft.com/fwlink/?linkid=97900).

**Detection and Deployment Guidance**

Microsoft has provided detection and deployment guidance for this monthâs security updates. This guidance will also help IT professionals understand how they can use various tools to help deploy the security update, such as Windows Update, Microsoft Update, Office Update, the Microsoft Baseline Security Analyzer (MBSA), the Office Detection Tool, Microsoft Systems Management Server (SMS), and the Extended Security Update Inventory Tool. For more information, see [Microsoft Knowledge Base Article 910723](https://support.microsoft.com/kb/910723).

**Microsoft Baseline Security Analyzer**

Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](https://www.microsoft.com/technet/security/tools/mbsahome.mspx).

The following table provides the MBSA detection summary for this security update.

| Software | MBSA 2.1 |
| --- | --- |
| Microsoft Windows 2000 Service Pack 4 | Yes |
| Windows XP Service Pack 2 and Windows XP Service Pack 3 | Yes |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 | Yes |
| Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2 | Yes |
| Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2 | Yes |
| Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | Yes |
| Windows Vista and Windows Vista Service Pack 1 | Yes |
| Windows Vista x64 Edition and Windows Vista x64 Edition Service Pack 1 | Yes |
| Windows Server 2008 for 32-bit Systems | Yes |
| Windows Server 2008 for x64-based Systems | Yes |
| Windows Server 2008 for Itanium-based Systems | Yes |

For more information about MBSA 2.1, see [MBSA 2.1 Frequently Asked Questions](https://www.microsoft.com/technet/security/tools/mbsa2/qa.mspx).

**Windows Server Update Services**

By using Windows Server Update Services (WSUS), administrators can deploy the latest critical updates and security updates for Windows 2000 operating systems and later, Office XP and later, Exchange Server 2003, and SQL Server 2000. For more information about how to deploy this security update using Windows Server Update Services, visit the [Windows Server Update Services Web site](https://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server**

The following table provides the SMS detection and deployment summary for this security update.

| Software | SMS 2.0 | SMS 2003 with SUSFP | SMS 2003 with ITMU | Configuration Manager 2007 |
| --- | --- | --- | --- | --- |
| Microsoft Windows 2000 Service Pack 4 | Yes | Yes | Yes | Yes |
| Windows XP Service Pack 2 and Windows XP Service Pack 3 | Yes | Yes | Yes | Yes |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 | No | No | Yes | Yes |
| Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2 | Yes | Yes | Yes | Yes |
| Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2 | No | No | Yes | Yes |
| Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | No | No | Yes | Yes |
| Windows Vista and Windows Vista Service Pack 1 | No | No | See **Note for Windows** **Vista** **and Windows Server 2008** below | Yes |
| Windows Vista x64 Edition and Windows Vista x64 Edition Service Pack 1 | No | No | See **Note for Windows** **Vista** **and Windows Server 2008** below | Yes |
| Windows Server 2008 for 32-bit Systems | No | No | See **Note for Windows** **Vista** **and Windows Server 2008** below | Yes |
| Windows Server 2008 for x64-based Systems | No | No | See **Note for Windows** **Vista** **and Windows Server 2008** below | Yes |
| Windows Server 2008 for Itanium-based Systems | No | No | See **Note for Windows** **Vista** **and Windows Server 2008** below | Yes |

For SMS 2.0 and SMS 2003, the SMS SUS Feature Pack (SUSFP), which includes the Security Update Inventory Tool (SUIT), can be used by SMS to detect security updates. See also [Downloads for Systems Management Server 2.0](https://technet.microsoft.com/sms/bb676799.aspx).

For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](https://update.microsoft.com/microsoftupdate) and that are supported by [Windows Server Update Services](https://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](https://technet.microsoft.com/sms/bb676783.aspx). SMS 2003 can also use the Microsoft Office Inventory Tool to detect required updates for Microsoft Office applications. For more information about the Office Inventory Tool and other scanning tools, see [SMS 2003 Software Update Scanning Tools](https://technet.microsoft.com/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](https://technet.microsoft.com/sms/bb676766.aspx).

System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](https://technet.microsoft.com/library/bb735860.aspx).

**Note for Windows** **Vista** **and Windows Server 2008** Microsoft Systems Management Server 2003 with Service Pack 3 includes support for Windows Vista and Windows Server 2008 manageability.

For more information about SMS, visit the [SMS Web site](https://go.microsoft.com/fwlink/?linkid=21158).

For more detailed information, see [Microsoft Knowledge Base Article 910723](https://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles.

**Update Compatibility Evaluator and Application Compatibility Toolkit**

Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](https://technet.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de) components included with [Application Compatibility Toolkit 5.0](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang;=en).

The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment.

## Security Update Deployment

**Affected Software**

For information about the specific security update for your affected software, click the appropriate link:

#### Windows 2000 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue may be included in a future update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | Microsoft Windows 2000 Service Pack 4:\ Windows2000-kb956802-x86-enu /quiet |
| Installing without restarting | Microsoft Windows 2000 Service Pack 4:\ Windows2000-kb956802-x86-enu /norestart |
| Update log file | Microsoft Windows 2000 Service Pack 4:\ kb956802.log |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required? | Yes, you must restart your system after you apply this security update |
| HotPatching | Not applicable |
| **Removal Information** | Microsoft Windows 2000 Service Pack 4:\ Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB956802$\Spuninst folder |
| **File Information** | See [Microsoft Knowledge Base Article 956802](https://support.microsoft.com/kb/956802) |
| **Registry Key Verification** | Microsoft Windows Service Pack 4: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB956802\Filelist |

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options. |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed. |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Displays a dialog box prompting the local user to allow a restart. |
| Special Options |  |
| **/overwriteoem** | Overwrites OEM files without prompting. |
| **/nobackup** | Does not back up files needed for uninstall. |
| **/forceappsclose** | Forces other programs to close when the computer shuts down. |
| **/log:path** | Allows the redirection of installation log files. |
| **/extract[:path]** | Extracts files without starting the Setup program. |
| **/ER** | Enables extended error reporting. |
| **/verbose** | Enables verbose logging. During installation, creates %Windir%\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options. |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed. |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Displays a dialog box prompting the local user to allow a restart. |
| Special Options |  |
| **/forceappsclose** | Forces other programs to close when the computer shuts down. |
| **/log:path** | Allows the redirection of installation log files. |

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, **Detection and Deployment Tools and Guidance**, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.
     **Note** Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.
     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
* **Registry Key Verification**

  You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the **Reference Table** in this section.

  These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.

#### Windows XP (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | Windows XP Service Pack 2 and Windows XP Service Pack 3:\ Windowsxp-kb956802-x86-enu /quiet |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2:\ WindowsServer2003.WindowsXP-kb956802-x64-enu /quiet |  |
| Installing without restarting | Windows XP Service Pack 2 and Windows XP Service Pack 3:\ Windowsxp-kb956802-x86-enu /norestart |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2:\ WindowsServer2003.WindowsXP-kb956802-x64-enu /norestart |  |
| Update log file | KB956802.log |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required? | Yes, you must restart your system after you apply this security update |
| HotPatching | Not applicable |
| **Removal Information** | Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB956802$\Spuninst folder |
| **File Information** | See [Microsoft Knowledge Base Article 956802](https://support.microsoft.com/kb/956802) |
| **Registry Key Verification** | Windows XP Service Pack 2 and Windows XP Service Pack 3:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB956802\Filelist |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP Version 2003\SP3\KB956802\Filelist |  |

**Note** For supported versions of Windows XP Professional x64 Edition, this security update is the same as supported versions of the Windows Server 2003 x64 Edition security update.

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options. |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed. |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Displays a dialog box prompting the local user to allow a restart. |
| Special Options |  |
| **/overwriteoem** | Overwrites OEM files without prompting. |
| **/nobackup** | Does not back up files needed for uninstall. |
| **/forceappsclose** | Forces other programs to close when the computer shuts down. |
| **/log:path** | Allows the redirection of installation log files. |
| **/integrate:path** | Integrates the update into the Windows source files. These files are located at the path that is specified in the switch. |
| **/extract[:path]** | Extracts files without starting the Setup program. |
| **/ER** | Enables extended error reporting. |
| **/verbose** | Enables verbose logging. During installation, creates %Windir%\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options. |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Displays a dialog box prompting the local user to allow a restart. |
| Special Options |  |
| **/forceappsclose** | Forces other programs to close when the computer shuts down. |
| **/log:path** | Allows the redirection of installation log files. |

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, **Detection and Deployment Tools and Guidance**, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.
     **Note** Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.
     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
* **Registry Key Verification**

  You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the **Reference Table** in this section.

  These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.

#### Windows Server 2003 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | For all supported 32-bit editions of Windows Server 2003:\ Windowsserver2003-kb956802-x86-enu /quiet |
| For all supported x64-based editions of Windows Server 2003:\ Windowsserver2003.WindowsXP-KB956802-x64-enu /quiet |  |
| For all supported Itanium-based editions of Windows Server 2003:\ Windowsserver2003-KB956802-ia64-enu /quiet |  |
| Installing without restarting | For all supported 32-bit editions of Windows Server 2003:\ Windowsserver2003-kb956802-x86-enu /norestart |
| For all supported x64-based editions of Windows Server 2003:\ Windowsserver2003.WindowsXP-KB956802-x64-enu /norestart |  |
| For all supported Itanium-based editions of Windows Server 2003:\ Windowsserver2003-KB956802-ia64-enu /norestart |  |
| Update log file | KB956802.log |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required? | Yes, you must restart your system after you apply this security update |
| HotPatching | This security update does not support HotPatching. For more information about HotPatching, see Microsoft Knowledge Base Article 897341. |
| **Removal Information** | Use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB956802$\Spuninst folder |
| **File Information** | See [Microsoft Knowledge Base Article 956802](https://support.microsoft.com/kb/956802) |
| **Registry Key Verification** | HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB956802\Filelist |

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks to see if one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options. |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed. |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Displays a dialog box prompting the local user to allow a restart. |
| Special Options |  |
| **/overwriteoem** | Overwrites OEM files without prompting. |
| **/nobackup** | Does not back up files needed for uninstall. |
| **/forceappsclose** | Forces other programs to close when the computer shuts down. |
| **/log:path** | Allows the redirection of installation log files. |
| **/integrate:path** | Integrates the update into the Windows source files. These files are located at the path that is specified in the switch. |
| **/extract[:path]** | Extracts files without starting the Setup program. |
| **/ER** | Enables extended error reporting. |
| **/verbose** | Enables verbose logging. During installation, creates %Windir%\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options. |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed. |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Displays a dialog box prompting the local user to allow a restart. |
| Special Options |  |
| **/forceappsclose** | Forces other programs to close when the computer shuts down. |
| **/log:path** | Allows the redirection of installation log files. |

**Verifying that the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.
     **Note** Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.
     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
* **Registry Key Verification**

  You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the **Reference Table** in this section.

  These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.

#### Windows Vista (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | For all supported 32-bit editions of Windows Vista:\ Windows6.0-KB956802-x86 /quiet\ \ For all supported x64-based editions of Windows Vista:\ Windows6.0-KB956802-x64 /quiet |
| Installing without restarting | For all supported 32-bit editions of Windows Vista:\ Windows6.0-KB956802-x86 /quiet /norestart\ \ For all supported x64-based editions of Windows Vista:\ Windows6.0-KB956802-x64 /quiet /norestart |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required? | Yes, you must restart your system after you apply this security update |
| HotPatching | Not applicable |
| **Removal Information** | WUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click **Control Panel**, and then click **Security**. Under Windows Update, click **View installed updates** and select from the list of updates. |
| **File Information** | See [Microsoft Knowledge Base Article 956802](https://support.microsoft.com/kb/956802) |
| **Registry Key Verification** | **Note** A registry key does not exist to validate the presence of this update. |

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/?, /h, /help** | Displays help on supported switches. |
| **/quiet** | Suppresses the display of status or error messages. |
| **/norestart** | When combined with **/quiet**, the system will not be restarted after installation even if a restart is required to complete installation. |

**Note** For more information about the wusa.exe installer, see [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307).

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, **Detection and Deployment Tools and Guidance**, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start** and then enter an update file name in **Start Search**.
  2. When the file appears under **Programs**, right-click on the file name and click **Properties**.
  3. Under the **General** tab, compare the file size with the file information tables provided in the bulletin KB article.
  4. You may also click on the **Details** tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.
  5. Finally, you may also click on the **Previous Versions** tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file.

#### Windows Server 2008 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | For all supported 32-bit editions of Windows Server 2008:\ Windows6.0-KB956802-x86 /quiet\ \ For all supported x64-based editions of Windows Server 2008:\ Windows6.0-KB956802-x64 /quiet\ \ For all supported Itanium-based editions of Windows Server 2008:\ Windows6.0-KB956802-ia64 /quiet |
| Installing without restarting | For all supported 32-bit editions of Windows Server 2008:\ Windows6.0-KB956802-x86 /quiet /norestart\ \ For all supported x64-based editions of Windows Server 2008:\ Windows6.0-KB956802-x64 /quiet /norestart\ \ For all supported Itanium-based editions of Windows Server 2008:\ Windows6.0-KB956802-ia64 /quiet /norestart |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required? | Yes, you must restart your system after you apply this security update |
| HotPatching | Not applicable |
| **Removal Information** | WUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click **Control Panel**, and then click **Security**. Under Windows Update, click **View installed updates** and select from the list of updates. |
| **File Information** | See [Microsoft Knowledge Base Article 956802](https://support.microsoft.com/kb/956802) |
| **Registry Key Verification** | **Note** A registry key does not exist to validate the presence of this update. |

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/?, /h, /help** | Displays help on supported switches. |
| **/quiet** | Suppresses the display of status or error messages. |
| **/norestart** | When combined with **/quiet**, the system will not be restarted after installation even if a restart is required to complete installation. |

**Note** For more information about the wusa.exe installer, see [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307).

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, **Detection and Deployment Tools and Guidance**, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start** and then enter an update file name in **Start Search**.
  2. When the file appears under **Programs**, right-click on the file name and click **Properties**.
  3. Under the **General** tab, compare the file size with the file information tables provided in the bulletin KB article.
  4. You may also click on the **Details** tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.
  5. Finally, you may also click on the **Previous Versions** tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file.

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* Jun Mao of [VeriSign iDefense Labs](https://labs.idefense.com/) for reporting the GDI Integer Overflow Vulnerability (CVE-2008-2249)
* Juan Caballero, working with the [Bitblaze group at Carnegie Mellon University and UC Berkeley](https://bitblaze.cs.berkeley.edu/), for reporting the GDI Heap Overflow Vulnerability (CVE-2008-3465)

#### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://www.microsoft.com/security/msrc/mapp/partners.mspx).

#### Support

* Customers in the U.S. and Canada can receive technical support from [Microsoft Product Support Services](https://go.microsoft.com/fwlink/?linkid=21131) at 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates.
* International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the [International Support Web site](https://go.microsoft.com/fwlink/?linkid=21155).

#### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (December 9, 2008): Bulletin published.
* V1.1 (December 10, 2008): Updated the **Severity Ratings and Vulnerability Identifiers** table to list the security impact for GDI Heap Overflow Vulnerability - CVE-2008-3465 as Remote Code Execution for Microsoft Windows 2000 Service Pack 4, Windows XP Service Pack 2 and Windows XP Service Pack 3, Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2, Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2, Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2, and Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from bitblaze.cs.berkeley.edu_28e25a90_20250126_124301.html ===

# BitBlaze: Binary Analysis for Computer Security

[[Research Statement and Overview](#overview)]
[[Software Release](release/index.html)]
[[Current
Projects](#projects)] [[Publications](bitblaze-pub.html)]
[[News and Press](#news)]
[[Members](#members)]
[[Job Openings](#openings)]
[[Contact](#Information)]

---

## Research Statement and Overview

Binary analysis is imperative for protecting COTS (common
off-the-shelf) programs and analyzing and defending against the myriad
of malicious code, where source code is unavailable, and the binary
may even be obfuscated. Also, binary analysis provides the ground
truth about program behavior since computers execute binaries
(executables), not source code. However, binary analysis is
challenging due to the lack of higher-level semantics.
Many higher level
techniques are often inadequate for analyzing even benign binaries,
let alone potentially malicious binaries.
Thus, we need to develop tools and techniques which work at the
binary level, can be used for analyzing COTS software, as well as malicious binaries.

The *BitBlaze* project aims to design and develop a powerful
binary analysis platform and employ the platform in order to (1) analyze and develop novel
COTS protection and diagnostic mechanisms and (2) analyze,
understand, and develop defenses against malicious code. The
BitBlaze project also strives to open new application areas of
binary analysis, which provides sound and effective solutions to
applications beyond software security and malicious code defense,
such as protocol reverse engineering and fingerprint generation.

**The BitBlaze project consists of two central research directions: (1)
the design and development of the underlying BitBlaze Binary Analysis
Platform, and (2) applying the BitBlaze Binary Analysis Platform to
real security problems.** The two research focii drive each other: as
new security problems arise, we develop new analysis
techniques. Similarly, we develop new analysis techniques in order to
better or more efficiently solve known problems. Below, we give an
overview of the two research directions.

**[Here](http://bitblaze.cs.berkeley.edu/papers/bitblaze_iciss08.pdf)** is an overview paper of the BitBlaze project.
Some of our tools are also [available under an open-source license](release/index.html).

---

## The BitBlaze Binary Analysis Platform
The underlying BitBlaze Binary Analysis
Platform features a novel fusion of static and dynamic analysis
techniques, dynamic symbolic execution, and whole-system
emulation and binary instrumentation. The BitBlaze platform has
different components for each task: *Vine*, *TEMU*, and
*Rudder*. The three components in tandem provide the power for
effective analysis of real-world binary programs for various
applications.

* [Vine](vine.html), the static analysis
  component.
  **Open source release [available now](vine.html).**
  Vine provides an an intermediate language for
  assembly (ILA), and an infrastructure for analyzing programs
  written in this language. ILA is a full language in
  which programs can be written, type-checked, then compiled
  down to assembly. We also provide analysis on the
  ILA, such as abstract interpretation, dependency analysis, and
  logical analysis via interfaces with theorem provers.
* [TEMU](temu.html), the dynamic analysis
  component.
  **Open source release [available now](temu.html).**
  TEMU provides a dynamic analysis environment
  through whole-system emulation and dynamic binary
  instrumentation. TEMU is OS-aware (i.e., it understands
  OS-level semantics) and enables various fine-grained
  dynamic analysis to build upon, such as dynamic taint
  analysis and fine-grained behavioral analysis.
* [Rudder](rudder.html), the component for online
  dynamic symbolic execution. Rudder is an engine for
  online dynamic execution on binaries. At a
  high level, with a specified set of input sources of
  interest, Rudder can automatically explore different
  execution paths in a program determined by the input
  sources. It will automatically build logical formulas
  representing the constraints on the chosen input to take the
  followed paths.

**[Release Information](release/index.html)**:
We are now making some key parts of the BitBlaze Binary
Analysis Platform available under open-source licenses.
See a [separate page](release/index.html) for more
information.

In conjunction with our BlackHat 2010 presentation, we have also
made a demonstration binary
[release](release/blackhat-2010.html) of some tools for
trace-based crash analysis.

---

## BitBlaze in Action: Security Applications

Using the BitBlaze Binary Analysis Platform, we have enabled new approaches and solutions to a suite of different security problems. These results demonstrate the utility and effectiveness of the BitBlaze approach and vision---binary analysis enables fundamentally new approaches to a broad spectrum of different security problems, often solving problems at their root cause; the underlying BitBlaze Binary Analysis Platform is extensible and powerful for a broad spectrum of different security applications.

In particular, we show below three classes of security applications: (1)  [vulnerability detection, diagnosis, and defense](#vuldetect); (2) [automatic in-depth malware analysis and defense](#malwareanalysis); (3) [automatic model extraction and analysis](#model).

* ### Vulnerability Detection, Diagnosis, and Defense

  + **Hybrid Information- and Control-Flow Graph (HI-CFG)**

    Many security analysis tasks require understanding the high-level
    structure of a binary program in terms of both its control-flow and
    the data it operates on. To facilitate the automatic reverse
    engineering of such structure, we have introduced a new program
    representation, a [hybrid information- and
    control-flow graph (HI-CFG)](./hicfg/). Our research explores algorithms to
    infer a HI-CFG from an instruction-level trace, without requiring
    source-level information or static analysis.
  + **Identifying Causal Execution Differences for Security Applications**

    A security analyst often needs to understand
    two runs of the same program that exhibit a difference in
    program state or output. This is important, for example, for
    vulnerability analysis, as well as for analyzing a malware
    program that features different behaviors when run in different
    environments.

    **[Differential Slicing](diffslicing.html)** is
    an automatic slicing technique for the analysis of such
    execution differences. The  *causal difference graph*
    it outputs captures the input differences that triggered
    the observed difference and the causal path of differences
    that led from those input differences to the observed difference.
  + **Automatic Defense System against Zero-day Exploits and Worms**

    Worms such as CodeRed and SQL Slammer can compromise
    millions of hosts within hours or even minutes and have
    caused billions of dollars in estimated damage. How can
    we design and develop effective defense mechanisms
    against such fast, large scale worm attacks?

    **[Sting](sting.html)** is an automatic
    worm defense system which proposes a suite of novel
    techniques to automatically detect new exploits, perform
    in-depth diagnosis, and generate effective anti-bodies
    (vulnerability signatures and hardened binaries) to
    protect vulnerable hosts and networks from further
    attacks.
  + **Automatic Patch-based Exploit Generation**

    Security patches are supposed to fix vulnerabilities in
    programs. But what are the security implications of a
    security patch?

    In **[this](apeg.html)** work, we propose new
    techniques and demonstrate that one could automatically
    generate exploits from the patch binary and the original
    vulnerable program binary and sometimes in minutes of time.
  + **Loop-extended Symbolic Execution: Buffer Overflow Diagnosis and Discovery**

    [**Loop-extended symbolic
    execution**](lese.html) (or LESE) is a new technique that
    generalizes the results of previous dynamic symbolic
    execution techniques, which broadens the results with
    effects of loops. LESE is a key enabler for powerful
    automated discovery of security vulnerabilities, especially
    buffer-overflows, which is highly inefficient with pure
    symbolic/concrete execution. It also enables deeper
    diagnosis of known vulnerabilities, which allows automated
    signature generation tools to reason about variable-length
    input or repeated elements in the input.
  + **Measuring Quantitative Influence**

    Dynamic taint analysis is a fundamental tool for detecting
    overwrite attacks, but it is limited to an all-or-nothing
    distinction as to whether values are under the control of an
    attacker, and suffers from both false-positive and
    false-negative errors.

    We propose [**quantitative
    influence**](influence.html) to more precisely characterize the degree of
    control an attacker has over a value. A specialization of
    the concept of channel capacity from information theory, we
    show that quantitative influence can be computed precisely
    using a decision procedure. Quantitative influence
    accurately distinguishes real attacks from false positives
    among warnings generated by a dynamic taint analysis tool on
    vulnerable binary servers.
  + **Statically-Directed Dynamic Automated Test Generation**

    Static analysis, dynamic analysis, and symbolic execution
    have complementary strengths for exploring the space of
    program executions, but on its own each has significant
    limitations. How can we combine them to leverage the best
    features of all three?

    Our work on [**statically-directed
    dynamic automated test generation**](sdse-testgen.html) explores a three-stage
    process. It first performs dynamic analysis to build a
    control-flow model, then performs static analysis to search
    for potential vulnerabilities, and finally uses dynamic
    symbolic execution to prove that warnings are true positives
    by finding concrete test cases for them. In an evaluation on
    a suite of buffer-overflow benchmarks extracted from real
    applications, the results of the first two phases allowed
    symbolic execution to trigger vulnerabilities it otherwise
    could not, including all but one of the benchmarks.* ### Automatic Malware Analysis and Defense

    + **Detection and
      Analysis of Privacy-Breaching Malware**

      A myriad of malware such as keyloggers, Browser-helper
      Objects (BHO) based spyware, rootkits, backdoors, accesses
      and leaks users' sensitive information and breaches
      users' privacy. Can we have a unified approach to
      identify such privacy-breaching malware despite their
      widely-varied appearance?

      **[Panorama](panorama.html)** proposes a
      unified approach to detect privacy-breaching malware
      using whole-system dynamic taint analysis.
    + **Hidden Code Extraction from Packed Executables**

      Code packing is one technique commonly used to hinder malware
      code analysis through reverse engineering. Even though this problem
      has been previously researched, the existing solutions are
      either unable to handle novel samples, or vulnerable to various
      evasion techniques.

      **[Renovo](renovo.html)**
      proposes a fully dynamic approach for hidden code extraction,
      capturing an intrinsic nature of hidden code execution.
    + **Detection and Analysis of Malware Hooking Behaviors**

      One important malware attacking vector is its hooking mechanism. Malicious programs implant hooks for many different purposes. Spyware may implant hooks to get notified of the arrival of new sensitive data. Rootkits may implant
      hooks to intercept and tamper with critical system information to
      conceal their presence in the system. A stealth backdoor may also place hooks on
      the network stack to establish a stealthy communication channel with remote attackers.

      **[HookFinder](hookfinder.html)**
      proposes  *fine-grained impact analysis*  to automatically detect and analyze malware's hooking behaviors. Since this technique captures the intrinsic nature of hooking behaviors, it is well suited for identifying new hooking mechanisms.
    + **Automatic Malware
      Dissection and Trigger-based Behavior
      Analysis**

      Malware often has embedded behavior which is only
      exhibited when certain conditions are met. Such
      trigger-based behavior includes time bombs, logic bombs,
      and botnets programs which reacts to commands. Static
      analysis of malware often provides little utility due to
      code packing and obfuscation. Vanilla dynamic analysis
      can only provides limited view since the trigger
      conditions are usually not met. How can we design
      automatic analysis methods to uncover the trigger
      conditions and trigger-based behavior hidden in malware?

      **[BitScope](bitscope.html)** enables
      automatic exploration of program execution paths in
      malware to uncover trigger conditions (such as the time
      used in time bombs and commands in botnet programs) and
      trigger-based behavior, using dynamic symbolic
      execution. BitScope also provides in-depth analysis of
      the input/output behavior of the malware.* ### Automatic Model Extraction and Analysis

      + **Extracting security-related models from browsers for analysis and vulnerability discovery**

        In **[this](http://webblaze.cs.berkeley.edu/2009/content-sniffing/)** work, we show how to use [string-enhanced white-box exploration](http://www.eecs.berkeley.edu/Pubs/TechRpts/2009/EECS-2009-36.html) techniques to automatically extract security-related models from browsers and to automatically discover cross-site scripting (XSS) vulnerabilities by comparing the extracted models with websites' filters.

        + **Deviation
          Detection in Binaries**

          Many network protocols and services have several
          different implementations. Automatically identifying
          deviations in different implementations of the same
          protocol/service can enable the detection of potential
          implementation errors without protocol specification, and
          can enable automatic generation of fingerprints to
          identify an implementation remotely. How can we
          automatically identify such deviations in binaries
          implementing the same specification?

          **[Deviation Detection](deviation.html)**
          automatically identifies deviations in different
          binaries to detect implementation errors and generate
          fingerprints. It is achieved by building symbolic formulas
          that characterize how each binary processes an input.
        + **Protocol Reverse
          Engineering and Application Dialogue
          Replay**

          Many network protocols are proprietary or have no well
          documented specification. However, many security
          applications require protocol reverse engineering and
          application dialogue (network trace) replay.

          **[Dispatcher, Polygot and
          Replayer](protocol.html)** automatically extract information about
          network protocols and enables application dialogue replay
          using binary analysis.

---

## BitBlaze in the News: Vulnerabilities and Coverage

### FPGate project got Microsoft BlueHat Prize Contest's Special Recognition Award in 2012.

> FPGate stops attacks targeting function pointers by limiting indirect transfers to only those targets that are legal in the original program. When deployed together with other existing lightweight protections, FPGate can provide a level of protection comparable to CFI (Control Flow Integrity), stopping almost all control fow hijacking attacks including ROP. FPGate has two main advantages compared with previous solutions: it can inter-operate well with existing non-hardened libraries, so it can be deployed progressively; we also develop a method to recognize all sources and targets automatically in modern security-sensitive binary executables, thus FPGate can be applied directly on these binary files. The performance overhead of FPGate is only 0.36% in average measured using SPECint 2006. FPGate is a joint work of Lenx with Chao Zhang, Zhaofeng Chen, Lei Duan from Peking University, and Laszlo Szekeres, Stephen McCamant, Dawn Song from UC Berkeley.

### Vulnerabilities Discovered

* [CVE-2011-0904](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0904) Out-of-bounds Memory Access in  Gnome VNC Vino Server

* [CVE-2011-0905](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0905) Out-of-bounds Memory Access in  Gnome VNC Vino Server

* [CVE-2008-3465](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3465) ([MS08-071](http://www.microsoft.com/technet/security/Bulletin/MS08-071.mspx)) Heap-based buffer overflow in gdi32.dll

* [OSVDB-66497](http://osvdb.org/66497) Out-of-bounds memory access in  Cutwail bot

* [OSVDB-66498](http://osvdb.org/66498) Null pointer dereference in  Gheg bot

* [OSVDB-66499](http://osvdb.org/66499) Null pointer dereference in  Zbot trojan

* [OSVDB-66500](http://osvdb.org/66500) Infinite loop in  Zbot trojan

* [OSVDB-66501](http://osvdb.org/66501) Stack-based and heap-based buffer overflow in Zbot trojan

### News Coverage

* [FBI Busts Alleged Mega D Botnet Mastermind](http://www.informationweek.com/news/security/management/showArticle.jhtml?articleID=228500163)
  Russian citizen Oleg Nilolaenko, arrested at a Las Vegas automotive show last month, is charged with operating botnet that in its heyday generated one-third of the world's spam. (InformationWeek, December 2010)
* [BitBlaze tool boosts bug-hunting productivity 10-fold](http://www.computerworld.com/s/article/9179788/BitBlaze_tool_boosts_bug_hunting_productivity_10_fold)
  Noted vulnerability researcher Charlie Miller talks up tool at Black Hat. (Computerworld, July 2010)
* [So Many Bugs, So Little Time](http://www.technologyreview.com/computing/25869/)
  Tools that find serious bugs automatically could lead to safer, more stable software. (Technology Review, July 2010)
* [Breaking the Botnet Code](http://www.technologyreview.com/computing/23924/)
  Software that deciphers botnet communications could help infiltrate criminals' networks. (Technology Review, November 2009)

---

## Job Openings and Volunteer Positions

The BitBlaze project is looking for developers to help extend and
enhance our state-of-the art framework for binary analysis in
security applications.
In particular, we're looking for developers/researchers with skills
and experience including computer security, languages and compilers,
assembly language, low-level operating system work, and decision
procedures.
We have openings for interns (for the summer or another similar
period), staff scientists/staff programmers, postdocs, and
open-source contributors. If interested, send a CV/resume and interest
description to bitblaze.jobs at gmail.com.

---

## Members

* **Faculty:**
  [Dawn Song](http://www.cs.berkeley.edu/~dawnsong/)

- **Visiting Faculty:**
  [Lenx Tao Wei](http://lenx.100871.net/)

- **Postdocs and research staff:**
  * [Mathias Payer](http://www.nebelwelt.net/)
  * Choi Hyunsang
- **Students:**
  * [Kevin Zhijie Chen](http://www.cs.berkeley.edu/~kevinchn/)
  * [Chia Yuan Cho](http://www.cs.berkeley.edu/~chiayuan/)
  * [Noah M. Johnson](http://www.cs.berkeley.edu/~noahj/)
- **Former Members:**

* Postdocs and research staff:
  [Domagoj Babic](http://www.domagoj-babic.com/),
  [Stephen McCamant](http://www.cs.berkeley.edu/~smcc/),
  [Zhenkai Liang](http://www.comp.nus.edu.sg/~liangzk/),
  [Lorenzo Martignoni](http://martignlo.greyhats.it/),
  [Daniel Reynaud](http://indefinitestudies.org/)
* Graduated Ph.D. students:
  [Steve Hanna](http://vividmachines.com/academic/),
  [Pongsin Poosankam](http://www.andrew.cmu.edu/user/ppoosank/),
  [Prateek Saxena](http://www.comp.nus.edu.sg/~prateeks/),
  [Joel Weinberger](http://www.joelweinberger.us/)
[James Newsome](http://jimnewsome.net/www/),
[David Brumley](http://www.ece.cmu.edu/~dbrumley/),
[Juan Caballero](http://www.andrew.cmu.edu/user/juanca/),
[Min Gyung Kang](http://www.ece.cmu.edu/~mingyunk/),
[Heng Yin](http://lcs.syr.edu/faculty/yin/),* Graduated M.S. students: Xeno Kovah, Cody Hartwig
* Staff: [Ivan Jager](http://www.andrew.cmu.edu/user/aij/)
* Graduated Bachelor's students: Eric Li

---

## Contact

For general questions regarding the BitBlaze project, please send email to bitblaze at gmail.com.

To receive announcements about code releases and other bitblaze related updates, please subscribe to the [Bitblaze Announcement List](https://lists.eecs.berkeley.edu/sympa/info/bitblaze-announcements)



=== Content from www.vupen.com_5607f993_20250125_231701.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from www.us-cert.gov_fb28a3c9_20250125_231700.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Equal Employment Opportunity](/eeo)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

  [Reasonable Accommodations & Accessibility](/rap)

  [Special Emphasis Programs](/sep)

  [No FEAR Act Notice & Reports](/no-fear-act)

  [Policies & Plans](/eeo-policies)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [Alert](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A93)

Share:

Alert
# Microsoft Updates for Multiple Vulnerabilities

Last RevisedOctober 19, 2016
Alert CodeTA08-344A

### Systems Affected

Microsoft Windows and related software

### Overview

Sun has released alerts to address multiple vulnerabilities affecting the Sun Java Runtime Environment. The most severe of these vulnerabilities could allow a remote attacker to execute arbitrary code.

As part of the Microsoft Security Bulletin Summary for December 2008, Microsoft released updates to address vulnerabilities that affect Microsoft Windows, Internet Explorer, Word, Excel, SharePoint Server, Visual Basic 6 and other related components.

### Impact

A remote, unauthenticated attacker could gain elevated privileges, execute arbitrary code or cause a vulnerable application to crash.

### Solution

Microsoft has provided updates for these vulnerabilities in the [Microsoft Security Bulletin Summary for December 2008](https://www.microsoft.com/technet/security/bulletin/ms08-dec.mspx). The security bulletin describes any known issues related to the updates. Administrators are encouraged to note these issues and test for any potentially adverse effects. Administrators should consider using an automated update distribution system such as Windows Server Update Services (WSUS).

### References

[Microsoft Security Bulletin Summary for December 2008](https://www.microsoft.com/technet/security/bulletin/ms08-dec.mspx)
[Microsoft Update](https://support.microsoft.com/en-us/kb/3067639)
[Windows Server Update Services](https://technet.microsoft.com/en-us/windowsserver/bb332157)
### Revisions

December 09, 2008: Initial release

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/alerts/2008/12/09/microsoft-updates-multiple-vulnerabilities); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")


