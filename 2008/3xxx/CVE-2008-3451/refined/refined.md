```
Message-ID: <41932.82.67.177.178.1217577378.squirrel@mail.rofes.fr>
Date: Fri, 1 Aug 2008 09:56:18 +0200 (CEST)
From: "Pierre-Yves Rofes" <py@...too.org>
To: oss-security@...ts.openwall.com
Cc: coley@...re.org
Subject: Re: CVE request: phpwebgallery < 1.7.2

On Fri, August 1, 2008 1:49 am, Hanno BÃ¶ck wrote:
> Changelog:
> <http://bugs.phpwebgallery.net/changelog_page.php>
>
> - 0000769: [security] Affichage des adresses email des utilisateurs en
> mode
> adviser (Pat) - closed.
>
> Yeah, it is in french, but nevertheless it's a security issue. (maybe
> someone
> wants to write an english advisory)
>
Hi,

Even if it's probably easy to guess with or without a translator, the
ticket description says:

In advisor mode, users's e-mails are masked with the address
"advisor.mode@...ite"
But if the advisor clicks to edit the user's profile, he can access
his real address.

For those wondering what the "advisor mode" is, since it seems to be
documented only in french
([http://phpwebgallery.net/doc/doku.php/fr:fonctionnalites:conseiller](http://phpwebgallery.net/doc/doku.php/fr%3Afonctionnalites%3Aconseiller)),
this is actually a read-only access to the admin interface, for helping
out a user to configure the gallery. So this issue is basically an
information disclosure.

HTH,

--
Pierre-Yves Rofes
Gentoo Linux Security Team
```

- **Root cause of vulnerability:** In phpwebgallery versions prior to 1.7.2, when an advisor is in "advisor mode," user emails are masked with "advisor.mode@...site". However, if the advisor clicks to edit a user's profile, they can access the user's real email address.
- **Weaknesses/vulnerabilities present:** Information disclosure. The application fails to properly mask or hide sensitive user data when it should be hidden.
- **Impact of exploitation:** An advisor can view the actual email addresses of users by accessing their profile edit page. This could lead to privacy breaches and potential for further targeted attacks against users.
- **Attack vectors:** The vulnerability can be exploited by navigating to the user's profile edit page while in the "advisor mode".
- **Required attacker capabilities/position:** The attacker must have advisor level access to the phpwebgallery admin interface.