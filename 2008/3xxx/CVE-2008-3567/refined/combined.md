=== Content from blog.watchfire.com_7459c82f_20250125_022405.html ===


# [IBM Application Security Insider](https://blog.watchfire.com/wfblog/)

## The IBM Application Security Insider is a blog devoted to dissecting today’s latest industry trends, observations and evolving threats in the growing web application security industry. The IBM AppScan portfolio provides web application security and compliance solutions that pinpoint vulnerabilities and helps manage the process of fixing them.

[« Automated Crawling Security Testing of Flash/Flex Web Applications](https://blog.watchfire.com/wfblog/2008/09/automated-crawl.html) |
[Main](https://blog.watchfire.com/wfblog/)
| [Flash Parameter Injection »](https://blog.watchfire.com/wfblog/2008/10/flash-parameter.html)

## September 22, 2008

### Winamp "NowPlaying" Unspecified Vulnerability: The Details

Hey,

Since no information has yet been published about a vulnerability I recently discovered in Winamp, and the issue has raised some interest, here are the details.

Recently, while listening to some music via Winamp (my favorite media player), I recalled an old [Winamp Buffer-Overflow](http://security.lss.hr/en/index.php?page=details&ID=LSS-2005-07-14) vulnerability found by *Leon Juranic* in 2005.
Leon found that since Winamp didn't expect long inputs in mp3 id3 tags, a buffer-overflow attack was possible by playing specially crafted mp3 files with lengthy tags.

Knowing that Winamp uses an embedded browser in various places, I decided to take a closer look at it and see what could be done... ;)
My aim was to inject JavaScript into the context of the embedded browser, and examine the ramifications. I suspected that the mp3 id3 tags might be a good place to start, and therefore concentrated on the "Now Playing" feature.

Winamp's "Now Playing" feature uses an embedded browser to present information about the currently played media file. When the user plays a media file, some of the file's metadata is embedded into the HTML that the embedded-browser displays.

It turned out that if the metadata (id3 tags) of the mp3 file contained a JavaScript payload, Winamp failed to sanitize it and therefore injected it intact into the embedded browser – a feasible XSS exploitation scenario.

[![Songs Dir](http://blog.watchfire.com/wfblog/WindowsLiveWriter/Songs%20Dir_thumb.jpg)](http://blog.watchfire.com/wfblog/WindowsLiveWriter/Songs%20Dir.jpg)
**A (seemingly) normal mp3 file.

[![InWinamp1](http://blog.watchfire.com/wfblog/WindowsLiveWriter/InWinamp1_thumb.jpg)](http://blog.watchfire.com/wfblog/WindowsLiveWriter/InWinamp1.jpg)
Adding "A song.mp3" to Winamp's playlist

[![InWinampXSS](http://blog.watchfire.com/wfblog/WindowsLiveWriter/InWinampXSS_thumb.jpg)](http://blog.watchfire.com/wfblog/WindowsLiveWriter/InWinampXSS.jpg)
Playing the poisoned mp3 file...
Attacker-controlled JavaScript code is executed.**

Furthermore, due to the integration between the embedded browser and the Winamp application, this script injection vulnerability has some unique characteristics.

In many cases, Desktop applications that utilize IE embedded browsers render the HTML content in a highly privileged zone called "My Computer Zone". This zone allows the programmer to perform a wide range of actions on the computer and thereby to "interact" with the hosting application. The downside of this (fairly common) approach is that if the application is susceptible to XSS, a malicious attacker might be able to exploit it and gain full system control over the victim's system. ([*Aviv Raff*](http://aviv.raffon.net/)did some great work in this field, "[Skype cross-zone scripting vulnerability](http://aviv.raffon.net/2008/01/17/SkypeCrosszoneScriptingVulnerability.aspx)" being a well-known example.)

Winamp's programmers were probably aware to this security threat and therefore chose a different approach. Instead of creating and loading a local file that contains all the relevant data (e.g. data about the song retrieved from the Internet and data originated from the id3 tags of the mp3 file) in a privileged security zone, Winamp loads the embedded browser with a page located in [http://client.winamp.com](http://client.winamp.com/) (Internet URL - non-privileged zone).

At first glance, this seems to make an XSS attack innoxious, because of Same Origin policy. However, in order to implement the required interaction between the Winamp application and its embedded browser, a bridge from the browser to Winamp was created in the form of [window.external](http://msdn.microsoft.com/en-us/library/ms535246%28VS.85%29.aspx). That means that JavaScript code (which is attacker-controlled due to the XSS vulnerability I found) could trigger various internal functionalities of Winamp which were not intended to be invoked by a remote attacker.

The attack could then be taken one step ahead, by trying to identify functions that are susceptible to memory-based attacks or logical attacks (Reading/Writing of information from/to the victim's host and even gaining full system control in the form of executing commands).

Since the attack is almost undetectable (the malicious JavaScript within the id3 tags can be padded with white spaces and therefore rendered invisible to the Winamp user when the malicious mp3 file is played), such a poisoned file could be easily distributed via P2P networks, resulting in a large-scale (and possibly silent) attack against Winamp users.

[![ID3Tags](http://blog.watchfire.com/wfblog/WindowsLiveWriter/ID3Tags_thumb.jpg)](http://blog.watchfire.com/wfblog/WindowsLiveWriter/ID3Tags.jpg)
**The id3 tags editor of Winamp doesn't give indication for the attack (due to white spaces padding)...**

[![Id3TagsEnd](http://blog.watchfire.com/wfblog/WindowsLiveWriter/Id3TagsEnd_thumb.jpg)](http://blog.watchfire.com/wfblog/WindowsLiveWriter/Id3TagsEnd.jpg)
**Going to the end of the Artist text box reveals the (potentially malicious) JavaScript code**

**Acknowledgments:**

I would like to thank Winamp's team for their quick responses and the efficient way in which they handled this security issue.

Posted by [Yair Amit](https://profile.typepad.com/yairam) on September 22, 2008 in [Research](https://blog.watchfire.com/wfblog/research/), [Web Application Security](https://blog.watchfire.com/wfblog/web_application_security/)  | [Permalink](https://blog.watchfire.com/wfblog/2008/09/winamp-nowplayi.html)

 |  |

### Comments

![Leon](https://static.typepad.com/.shared/default-userpics/10-50si.gif)

I was reading some Watchfire blogs, and came across this one :-)... It took me ~2 weeks after initial bug discovery, before I figured how to exploit that Winamp overflow. :)

Posted by:
[Leon](http://www.infigo.hr/en/ "http://www.infigo.hr/en/") |
[September 26, 2008 at 12:35 PM](https://blog.watchfire.com/wfblog/2008/09/winamp-nowplayi.html?cid=132306002#comment-6a00d835130c5153ef010534d6e645970c)

![Yair Amit](https://static.typepad.com/.shared/default-userpics/10-50si.gif)

Hey Leon,

It was a very cool attack! ;)

What are you up to these days?

Posted by:
[Yair Amit](https://profile.typepad.com/yairam "https://profile.typepad.com/yairam") |
[September 28, 2008 at 04:15 PM](https://blog.watchfire.com/wfblog/2008/09/winamp-nowplayi.html?cid=132537837#comment-6a00d835130c5153ef010534d3639b970b)

The comments to this entry are closed.

## Follow us on Twitter

[![IBM Application Security Insider](https://up1.typepad.com/6a00d835130c5153ef016766a511e5970b-50si)](https://www.twitter.com/appsecinsider "IBM Application Security Insider's Profile")

[IBM Application Security Insider](https://www.twitter.com/appsecinsider "IBM Application Security Insider's Profile")

[Follow @AppSecInsider](https://twitter.com/AppSecInsider)

## AppScan Free Trial

[![](http://www-01.ibm.com/software/tivoli/products/SWI00/RationalAppScan_140x65.jpg)](http://www.ibm.com/developerworks/downloads/r/appscan/)

Try IBM Security AppScan software at no charge.

* [Download the free trial](http://www.ibm.com/developerworks/downloads/r/appscan/ "Download the free trial")

## Search

## Recent Posts

* [Building Rich Internet Applications Models: Example of a Better Strategy](https://blog.watchfire.com/wfblog/2013/06/building-rich-internet-applications-models-example-of-a-better-strategy.html)
* [AppScan Enterprise v8.7 performance improvements](https://blog.watchfire.com/wfblog/2013/05/appscan-enterprise-v87-performance-improvements.html)
* [Practical mobile app security scanning tips](https://blog.watchfire.com/wfblog/2013/04/practical-mobile-app-security-scanning-tips.html)
* [Research Awards for Project on Crawling Mobile and Rich Internet Applications](https://blog.watchfire.com/wfblog/2013/01/research-awards-for-project-on-crawling-mobile-and-rich-internet-applications.html)
* [Find Security Vulnerabilities in Android Apps](https://blog.watchfire.com/wfblog/2012/12/scan-android-apps.html)
* [Understanding AppScan Test Policies](https://blog.watchfire.com/wfblog/2012/12/understanding-appscan-test-policies.html)
* [Have you scanned your mobile site for vulnerabilities yet?](https://blog.watchfire.com/wfblog/2012/11/have-you-scanned-your-mobile-site-for-vulnerabilities-yet.html)
* [Top 5 Innovations Transforming Security Scanners](https://blog.watchfire.com/wfblog/2012/11/top-5-innovations-transforming-security-scanners.html)
* [String Analysis in AppScan/JSA](https://blog.watchfire.com/wfblog/2012/11/string-analysis-in-appscanjsa.html)
* [What is String Analysis? A look at one of AppScan's breakthrough technologies](https://blog.watchfire.com/wfblog/2012/11/what-is-string-analysis.html)

## [Archives](https://blog.watchfire.com/wfblog/archives.html)

* [June 2013](http://blog.watchfire.com/wfblog/2013/06/index.html)
* [May 2013](http://blog.watchfire.com/wfblog/2013/05/index.html)
* [April 2013](http://blog.watchfire.com/wfblog/2013/04/index.html)
* [January 2013](http://blog.watchfire.com/wfblog/2013/01/index.html)
* [December 2012](http://blog.watchfire.com/wfblog/2012/12/index.html)
* [November 2012](http://blog.watchfire.com/wfblog/2012/11/index.html)
* [October 2012](http://blog.watchfire.com/wfblog/2012/10/index.html)
* [September 2012](http://blog.watchfire.com/wfblog/2012/09/index.html)
* [August 2012](http://blog.watchfire.com/wfblog/2012/08/index.html)
* [July 2012](http://blog.watchfire.com/wfblog/2012/07/index.html)

## [Categories](https://blog.watchfire.com/wfblog/archives.html)

* [AJAX Security (4)](https://blog.watchfire.com/wfblog/ajax_security/)
* [Books (1)](https://blog.watchfire.com/wfblog/books/)
* [Hypes (2)](https://blog.watchfire.com/wfblog/hypes/)
* [Info Bits (14)](https://blog.watchfire.com/wfblog/info_bits/)
* [Mobile (1)](https://blog.watchfire.com/wfblog/mobile/)
* [Public Site Vulnerability Research (3)](https://blog.watchfire.com/wfblog/public_site_vulnerability_research/)
* [Research (29)](https://blog.watchfire.com/wfblog/research/)
* [Web Application Scanners (15)](https://blog.watchfire.com/wfblog/web_application_scanners/)
* [Web Application Security (26)](https://blog.watchfire.com/wfblog/web_application_security/)
* [Web Application Threat Classification (4)](https://blog.watchfire.com/wfblog/web_application_threat_classification/)
* [Web/Tech (2)](https://blog.watchfire.com/wfblog/webtech/)
* [Weblogs (1)](https://blog.watchfire.com/wfblog/weblogs/)

[See More](https://blog.watchfire.com/wfblog/archives.html)

## Application Security Links

* [AppScan eXtensions Framework](http://www.ibm.com/developerworks/rational/downloads/08/appscan_ext_framework/ "AXF - AppScan eXtensions Framework Portal Site")
* [Download AppScan](http://www.ibm.com/developerworks/downloads/r/appscan/ "Download AppScan")
* [WASC](http://www.webappsec.org "Web Application Security Consortium")
* [OWASP](http://www.owasp.org "Open Web Application Security Project")
* [MITRE CWE](http://cwe.mitre.org "Common Weakness Enumeration")
* [NIST SAMATE](http://samate.nist.gov/index.php/Main_Page "Software Assurance Metrics And Tool Evaluation")
* [CGISecurity](http://www.cgisecurity.com/ "CGISecurity")
* [IBM Security - Secure by Design](http://www.ibm.com/security/)

## Other Blogs We Read

* [Jeremiah Grossman](https://jeremiahgrossman.blogspot.com/ "Jeremiah Grossman")
* [Anurag Agarwal's Blog](https://myappsecurity.blogspot.com/ "Application Security Evangelist")
* [Denim Group Blog](http://denimgroup.typepad.com/denim_group/ "Denim Group Blog")
* [Romain Gaucher's blog (Deep Inside ' OR 1=1--/\*)](http://rgaucher.info/)
* [Application Security Space (IBM developerWorks)](http://www.ibm.com/developerworks/spaces/appsec)
* [Frequency X Blog](http://blogs.iss.net/)
* [Neil MacDonald — A Member of the Gartner Blog Network](http://blogs.gartner.com/neil_macdonald)
* [Securosis Blog](https://securosis.com/blog/)
* [Google Online Security Blog](https://googleonlinesecurity.blogspot.com/)

## Pages

* [About IBM Application Security Insider](https://blog.watchfire.com/wfblog/welcome-to-ibm-application-security-insider.html)

Proud member of [Security Bloggers Network](http://networks.feedburner.com/Security-Bloggers-Network), a FeedBurner Network.

## Become a Fan

Comments or opinions expressed on this Weblog are the opinions of the authors alone. They are not necessarily reviewed in advance by anyone but the individual authors, and neither IBM nor any other party necessarily agrees with them. The views expressed by outside contributors and links to outside websites do not represent the views of IBM, its management or employees. All content on this Weblog has been made available on an “as-is” basis, and IBM shall not be liable for any direct or indirect damages arising out of use of this Weblog.


