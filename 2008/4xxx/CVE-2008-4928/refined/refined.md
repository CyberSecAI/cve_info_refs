```
[
  {
    "Root cause of vulnerability": "Improper sanitization of user input in the `redirect()` function when using an AJAX switch.",
    "Weaknesses/vulnerabilities present": [
      "Cross-Site Scripting (XSS)",
      "Insufficient MIME-sniffing protection",
      "Predictable attachment filenames",
	  "Circumvention of CSRF protection"
    ],
    "Impact of exploitation": "XSS can be leveraged to steal cookies, inject PHP code into templates via the ACP, and achieve Remote Code Execution (RCE). Predictable filenames allow for reading attachments regardless of user permissions. Incomplete MIME-sniffing protection allows for uploading files interpreted as HTML by Internet Explorer.",
    "Attack vectors": "By crafting malicious URLs that include JavaScript code within the `url` parameter when using the AJAX functionality. By guessing attachment names based on timestamp and user ID. By uploading files that can be interpreted as HTML by Internet Explorer.",
    "Required attacker capabilities/position": "Attacker needs to be able to send HTTP requests, which includes crafting URLs with malicious JavaScript to exploit XSS. An active admin session is required for the cookie stealing and RCE attacks. Knowledge or ability to guess the user ID and post time to access attachments. Ability to upload malicious files."
  }
]
```