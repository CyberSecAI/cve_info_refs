=== Content from bugs.gentoo.org_2a43c8e3_20250125_072254.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 235804
sci-biology/mafft: insecure temp file usage
Last modified: 2008-11-07 02:25:24 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=235804&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=235804&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 235804**](show_bug.cgi?id=235804)
- sci-biology/mafft: insecure temp file usage

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
sci-biology/mafft: insecure temp file usage

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | High trivial | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://bugs.debian.org/496366> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | ~3? [noglsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | Duplicates (1): | [245920](show_bug.cgi?id=245920 "RESOLVED DUPLICATE - sci-biology/mafft<=6.240 symlink attack (CVE-2008-4971)")  ([view as bug list](buglist.cgi?bug_id=245920)) | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [debian-tempfile](show_bug.cgi?id=235770 "RESOLVED FIXED - [Tracker] Tempfile issues found in Debian") | |  | Show dependency [tree](showdependencytree.cgi?id=235804&hide_resolved=1) | |  | | Reported: | 2008-08-26 17:24 UTC by Christian Hoffmann (RETIRED) | | --- | --- | | Modified: | 2008-11-07 02:25 UTC ([History](show_activity.cgi?id=235804)) | | CC List: | 2 users (show)  craig sci-biology | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**suggested patch to fix insecure tempfile handling**](attachment.cgi?id=164660 "View the content of the attachment") (mafft-6.240-mktemp.patch,6.34 KB, patch)  [2008-09-05 21:28 UTC](#attach_164660 "Go to the comment associated with the attachment"), Markus Dittrich (RETIRED) | *no flags* | [Details](attachment.cgi?id=164660&action=edit) | [Diff](attachment.cgi?id=164660&action=diff) | | [View All](attachment.cgi?bugid=235804&action=viewall)  [Add an attachment](attachment.cgi?bugid=235804&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=235804&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Christian Hoffmann (RETIRED)   gentoo-dev  2008-08-26 17:24:52 UTC  ``` See $URL and [bug 235770](show_bug.cgi?id=235770 "RESOLVED FIXED - [Tracker] Tempfile issues found in Debian"). ```  [Comment 1](#c1)  Christian Hoffmann (RETIRED)   gentoo-dev  2008-08-26 19:03:48 UTC  ``` Yes, we ship /usr/bin/mafft-homologs.rb and it's vulnerable. I checked version 6.240, the vulnerable code is in line 37 and 38 of the mentioned script. There are way more occurences though. It allows for overwriting arbitrary files with a fixed content in the first cases.  Package has no stable version and is only keyworded for ~x86.  According to $URL, debian has developed a patch, see [1].  [1] <http://svn.debian.org/wsvn/debian-med/trunk/packages/mafft/trunk/debian/patches/Securisation-by-mktemp-usage.patch?op=file&rev=0&sc=0> ```  [Comment 2](#c2)  Donnie Berkholz (RETIRED)   gentoo-dev  2008-08-26 23:32:29 UTC  ``` I'll handle this one. ```  [Comment 3](#c3)  Donnie Berkholz (RETIRED)   gentoo-dev  2008-09-05 05:29:50 UTC  ``` Sorry, it turns out that I just don't have the time right now to fix this, because I just had a baby Monday. Could someone else please handle it? ```  [Comment 4](#c4)  Markus Dittrich (RETIRED)   gentoo-dev  2008-09-05 13:23:14 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=235804#c3)) > Sorry, it turns out that I just don't have the time right now to fix this, > because I just had a baby Monday. Could someone else please handle it? >   Congratulations, Donnie! I'll take care of this one for you.  Best, Markus   ```  [Comment 5](#c5)  Markus Dittrich (RETIRED)   gentoo-dev  2008-09-05 21:28:55 UTC  ``` Created [attachment 164660](attachment.cgi?id=164660 "suggested patch to fix insecure tempfile handling") [[details](attachment.cgi?id=164660&action=edit "suggested patch to fix insecure tempfile handling"), [diff](attachment.cgi?id=164660&action=diff "suggested patch to fix insecure tempfile handling")] suggested patch to fix insecure tempfile handling  I've attached a patch to fix the insecure tempfile issues for further review. It is taken mostly from the fix developed by the debian  folks together with mafft's upstream.  The ruby code uses the Tempfile class which will also take care of removing the generated temporary files upon termination of the script.  Any feedback would be welcome.  Thanks, Markus ```  [Comment 6](#c6)  Robert Buchholz (RETIRED)   gentoo-dev  2008-09-19 16:01:36 UTC  ``` Markus, I didn't review the patch, but feel free to bump if it was coordinated with both upstream and Debian, and you verified it works. ```  [Comment 7](#c7)  Markus Dittrich (RETIRED)   gentoo-dev  2008-09-23 12:42:49 UTC  ``` Hi Robert,  I've added mafft-6.240-r1 to the tree which contains this patch. All vulnerable ebuilds have been removed from the tree.  Best, Markus ```  [Comment 8](#c8)  Christian Hoffmann (RETIRED)   gentoo-dev  2008-09-23 14:18:45 UTC  ``` Thanks. ~arch-only packages are not subject to the GLSA process, closing as such. ```  [Comment 9](#c9)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-11-07 02:25:24 UTC  ``` *** [Bug 245920](show_bug.cgi?id=245920 "RESOLVED DUPLICATE - sci-biology/mafft<=6.240 symlink attack (CVE-2008-4971)") has been marked as a duplicate of this bug. *** ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=235804)
* - [XML](show_bug.cgi?ctype=xml&id=235804)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=235804)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=235804&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=235804&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=235804&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.gentoo.org_89b07509_20250125_072253.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 235770
[Tracker] Tempfile issues found in Debian
Last modified: 2012-09-22 19:34:01 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=235770&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=235770&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 235770**](show_bug.cgi?id=235770)
(debian-tempfile)
- [Tracker] Tempfile issues found in Debian

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
[Tracker] Tempfile issues found in Debian

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | debian-tempfile | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Auditing ([show other bugs](buglist.cgi?component=Auditing&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://thread.gmane.org/gmane.linux.d...](http://thread.gmane.org/gmane.linux.debian.devel.general/130960/) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | Tracker | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [CVE-2008-4982](show_bug.cgi?id=235798 "RESOLVED INVALID - app-forensics/rkhunter: audit wrt insecure temp file usage (CVE-2008-4982)") [CVE-2008-4998](show_bug.cgi?id=235802 "RESOLVED INVALID - www-apps/twiki: audit wrt insecure temp file usage") [235804](show_bug.cgi?id=235804 "RESOLVED FIXED - sci-biology/mafft: insecure temp file usage") [235805](show_bug.cgi?id=235805 "RESOLVED INVALID - app-emulation/xen-tools: audit wrt insecure temp file usage") [CVE-2008-4936](show_bug.cgi?id=235806 "RESOLVED FIXED - net-dialup/mgetty < 1.1.36-r3 insecure temp file usage (CVE-2008-4936)") [CVE-2008-4935](show_bug.cgi?id=235808 "RESOLVED FIXED - media-gfx/aview <1.3.0_rc1-r1 insecure temp file usage (CVE-2008-4935)") [CVE-2008-4956](show_bug.cgi?id=235809 "RESOLVED FIXED - <net-firewall/fwbuilder-3.0.3: audit wrt insecure temp file usage (CVE-2008-4956)") [235811](show_bug.cgi?id=235811 "RESOLVED INVALID - mail-mta/postfix: audit wrt insecure temp file usage") [235812](show_bug.cgi?id=235812 "RESOLVED INVALID - sys-apps/dtc: audit wrt insecure temp file usage") [CVE-2008-3931](show_bug.cgi?id=235822 "RESOLVED FIXED - dev-lang/R < 2.7.1 insecure temp file usage (CVE-2008-3931)") [CVE-2008-4937](show_bug.cgi?id=235824 "RESOLVED FIXED - app-office/openoffice < 3.0.0 insecure temp file usage (CVE-2008-4937)") [235826](show_bug.cgi?id=235826 "RESOLVED INVALID - app-emulation/xen<=3.3.0 symlink attack") [CVE-2008-4985](show_bug.cgi?id=235827 "RESOLVED INVALID - media-video/vdr: audit wrt insecure temp file usage (CVE-2008-4985)") [CVE-2008-5007](show_bug.cgi?id=235828 "RESOLVED FIXED - dev-lang/lazarus-0.99.24 insecure temp file usage (CVE-2008-5007)") [236205](show_bug.cgi?id=236205 "RESOLVED FIXED - <games-server/crossfire-server-1.11.0: Insecure temporary file creation") [CVE-2008-3928](show_bug.cgi?id=237481 "RESOLVED FIXED - net-analyzer/honeyd < 1.5c-r1 test.sh insecure temporary file creation (CVE-2008-3928)") [CVE-2008-3929](show_bug.cgi?id=237483 "RESOLVED FIXED - www-apps/ampache <3.4.3 gather-messages.sh insecure temporary file creation (CVE-2008-3929)") [CVE-2008-4190](show_bug.cgi?id=238574 "RESOLVED FIXED - net-misc/openswan livetest Insecure temporary file creation (CVE-2008-4190)") [CVE-2008-4191](show_bug.cgi?id=238575 "RESOLVED FIXED - app-accessibility/emacspeak <29.0 extract-table.pl Insecure temporary file creation (CVE-2008-4191)") [CVE-2008-4938](show_bug.cgi?id=245760 "RESOLVED FIXED - dev-util/aegis<=4.24 symlink attack (CVE-2008-4938)") [CVE-2008-4952](show_bug.cgi?id=245761 "RESOLVED INVALID - app-emacs/emacs-jabber symlink attack (CVE-2008-4952)") [CVE-2008-4957](show_bug.cgi?id=245765 "RESOLVED FIXED - <dev-cpp/gccxml-0.9.0_pre20090516 symlink attack (CVE-2008-4957)") [CVE-2008-4976](show_bug.cgi?id=245921 "RESOLVED FIXED - <media-video/ogle-0.9.2-r2 symlink attack (CVE-2008-4976)") [CVE-2008-4983](show_bug.cgi?id=245922 "RESOLVED FIXED - sci-mathematics/scilab <4.1.2-r1: insecure temp file usage (CVE-2008-4983)") [CVE-2008-4953](show_bug.cgi?id=246013 "RESOLVED FIXED - <net-firewall/firehol-1.273-r1 symlink attack (CVE-2008-4953)") [CVE-2008-4968](show_bug.cgi?id=246015 "RESOLVED FIXED - app-benchmarks/lmbench<=3 symlink attacks (CVE-2008-4968)") [CVE-2008-4993](show_bug.cgi?id=246068 "RESOLVED DUPLICATE - app-emulation/xen<=3.3.0 symlink attack (CVE-2008-4993)") [CVE-2008-5151](show_bug.cgi?id=247479 "RESOLVED INVALID - sci-visualization/mayavi symlink attack (CVE-2008-5151)") [CVE-2008-5154](show_bug.cgi?id=247481 "RESOLVED INVALID - app-pda/p3nfs<=5.19 symlink attack (CVE-2008-5154)") [CVE-2008-5155](show_bug.cgi?id=247483 "RESOLVED INVALID - app-mobilephone/smsclient-2.0.8z (and others?) symlink attacks (CVE-2008-5155)") [CVE-2008-5137](show_bug.cgi?id=247540 "RESOLVED FIXED - <app-text/tkman-2.2-r1 symlink attack (CVE-2008-5137)") [CVE-2008-5136](show_bug.cgi?id=247985 "RESOLVED FIXED - net-misc/tkusr pgm insecure temporary file creation (CVE-2008-5136)") [CVE-2008-5138](show_bug.cgi?id=247986 "RESOLVED FIXED - sys-auth/pam_mount passwdehd insecure temporary file creation (CVE-2008-5138)") [CVE-2008-5188](show_bug.cgi?id=248058 "RESOLVED FIXED - sys-fs/ecryptfs-utils >=45 <=61 passwords exposure (CVE-2008-5188)") [248750](show_bug.cgi?id=248750 "RESOLVED DUPLICATE - Virtualbox symlink attack (CVE requested)") [CVE-2008-5375](show_bug.cgi?id=250474 "RESOLVED FIXED - <media-sound/cmus-2.2.0-r1 cmus-status-display symlink attack (CVE-2008-5375)") [CVE-2008-5371](show_bug.cgi?id=250476 "RESOLVED FIXED - <app-misc/screenie-1.30.0-r1 symlink attack (CVE-2008-5371)") [250553](show_bug.cgi?id=250553 "RESOLVED INVALID - Symlink attack in net-dialup/ppp-2.4.4-r21 /etc/ppp/ip-up.d/40-dns.sh") [CVE-2008-5368](show_bug.cgi?id=250554 "RESOLVED FIXED - <app-misc/muttprint-0.72d-r1 symlink attack (CVE-2008-5368)") [CVE-2008-4959](show_bug.cgi?id=251279 "RESOLVED FIXED - app-misc/gpsdrive <=2.10_pre5 insecure tempfile usage (CVE-2008-{4959,5380,5703,5704})") [CVE-2008-5377](show_bug.cgi?id=251316 "RESOLVED INVALID - net-print/cups pstopdf symlink attack (CVE-2008-5377)") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=235770&hide_resolved=1) | |  | | Reported: | 2008-08-26 11:58 UTC by Robert Buchholz (RETIRED) | | --- | --- | | Modified: | 2012-09-22 19:34 UTC ([History](show_activity.cgi?id=235770)) | | CC List: | 3 users (show)  gengor gentili n-roeser | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=235770&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=235770&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-26 11:58:03 UTC  ``` Moritz Mühlenhoff writes: as part of the preparation of the upcoming Debian Lenny release  someone checked the whole archive with a script for temp races and found a few. Below is the list of issues identified so far. More are pending, which haven't been checked for validity yet:    - rkhunter 1.3.2-6 (low; <http://bugs.debian.org/496375> )   - scratchbox2 1.99.0.24-2 (low; <http://bugs.debian.org/496409> )   - realtimebattle 1.0.8-8 (low; <http://bugs.debian.org/496385> )   - mgt 2.31-6 (low; <http://bugs.debian.org/496434> )   - twiki 1:4.1.2-4 (low; <http://bugs.debian.org/494648> )   - mafft <unfixed> (low; <http://bugs.debian.org/496366> )   - xen-3 <unfixed> (low; <http://bugs.debian.org/496367> )   - mgetty <unfixed> (low; <http://bugs.debian.org/496403> )   - sympa <unfixed> (low; <http://bugs.debian.org/496405>; bug #494969 )   - sng 1.0.2-6 (low; <http://bugs.debian.org/496407> )   - aview <unfixed> (low; <http://bugs.debian.org/496422> )   - fwbuilder <unfixed> (low; <http://bugs.debian.org/496406> )   - feta 1.4.16+nmu1 (low; <http://bugs.debian.org/496397> )   - postfix <unfixed> (unimportant; <http://bugs.debian.org/496401> )   NOTE: Not enabled by default, needs manual modification of a script   - caudium <unfixed> (low; <http://bugs.debian.org/496404> )   - cdcontrol <unfixed> (low; <http://bugs.debian.org/496438> )   - sgml2x <unfixed> (low; <http://bugs.debian.org/496368> )   - dtc-common <unfixed> (low; <http://bugs.debian.org/496362> )   - liguidsoap <unfixed> (low; <http://bugs.debian.org/496360> )   - xmcd 2.6-21 (low; <http://bugs.debian.org/496416> )   - xcal 4.1-19 (low; <http://bugs.debian.org/496393> )   - r-base 2.7.2-1 (low; <http://bugs.debian.org/496418> )   - r-base-core-ra <unfixed> (low; <http://bugs.debian.org/496363> )   - openoffice.org <unfixed> (low; <http://bugs.debian.org/496361> )   [etch] - openoffice.org <not-affected> (Vulnerable code not present )   NOTE: also not present in 3.0.0, only in 2.4.1. Fix pending upload.   - qemu 0.9.1-6 (low; <http://bugs.debian.org/496394> )   - rancid 2.3.2~a8-2 (low; <http://bugs.debian.org/496426> )   - vdr 1.6.0-6 (low; <http://bugs.debian.org/496421> )   - lazarus 0.9.24-0-11 (low )   - crossfire-maps 1.11.0-2 (low )  For reference, the technique and the script can be found in the relevant  thread on debian-devel: [http://thread.gmane.org/gmane.linux.debian.devel.general/130960/focus=131003](http://thread.gmane.org/gmane.linux.debian.devel.general/130960/focus%3D131003) ```  [Comment 1](#c1)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-26 12:00:06 UTC  ``` We need to audit our tree for those issues which affect Gentoo. Please mark them as blockers of this bug. ```  [Comment 2](#c2)  Christian Hoffmann (RETIRED)   gentoo-dev  2008-08-26 18:45:11 UTC  ``` I filed bugs for the following packages:   * rkhunter -> app-forensics/rkhunter, [bug 235798](show_bug.cgi?id=235798 "RESOLVED INVALID - app-forensics/rkhunter: audit wrt insecure temp file usage (CVE-2008-4982)")   * twiki -> www-apps/twiki, [bug 235802](show_bug.cgi?id=235802 "RESOLVED INVALID - www-apps/twiki: audit wrt insecure temp file usage")   * mafft -> sci-biology/mafft, [bug 235804](show_bug.cgi?id=235804 "RESOLVED FIXED - sci-biology/mafft: insecure temp file usage")   * xen-3 -> app-emulation/xen, [bug 235805](show_bug.cgi?id=235805 "RESOLVED INVALID - app-emulation/xen-tools: audit wrt insecure temp file usage")   * mgetty -> net-dialup/mgetty, [bug 235806](show_bug.cgi?id=235806 "RESOLVED FIXED - net-dialup/mgetty < 1.1.36-r3 insecure temp file usage (CVE-2008-4936)")   * aview -> media-gfx/aview, [bug 235808](show_bug.cgi?id=235808 "RESOLVED FIXED - media-gfx/aview <1.3.0_rc1-r1 insecure temp file usage (CVE-2008-4935)")   * fwbuilder -> net-firewall/fwbuilder, [bug 235809](show_bug.cgi?id=235809 "RESOLVED FIXED - <net-firewall/fwbuilder-3.0.3: audit wrt insecure temp file usage (CVE-2008-4956)")   * postfix -> mail-mta/postfix, [bug 235811](show_bug.cgi?id=235811 "RESOLVED INVALID - mail-mta/postfix: audit wrt insecure temp file usage")   * dtc-common -> sys-apps/dtc, [bug 235812](show_bug.cgi?id=235812 "RESOLVED INVALID - sys-apps/dtc: audit wrt insecure temp file usage")   * r-base -> dev-lang/R, [bug 235822](show_bug.cgi?id=235822 "RESOLVED FIXED - dev-lang/R < 2.7.1 insecure temp file usage (CVE-2008-3931)")   * openoffice.org -> app-office/openoffice, [bug 235824](show_bug.cgi?id=235824 "RESOLVED FIXED - app-office/openoffice < 3.0.0 insecure temp file usage (CVE-2008-4937)")   * qemu -> app-emulation/qemu, [bug 235826](show_bug.cgi?id=235826 "RESOLVED INVALID - app-emulation/xen<=3.3.0 symlink attack")   * vdr -> media-video/vdr, [bug 235827](show_bug.cgi?id=235827 "RESOLVED INVALID - media-video/vdr: audit wrt insecure temp file usage (CVE-2008-4985)")   * lazarus -> dev-lang/lazarus, [bug 235828](show_bug.cgi?id=235828 "RESOLVED FIXED - dev-lang/lazarus-0.99.24 insecure temp file usage (CVE-2008-5007)")  We don't ship these packages:   * scratchbox   * realtimebattle   * mgt   * sympa   * sng   * feta   * caudium   * cdcontrol   * sgml2x   * liguidsoap   * xmcd   * r-base-core-ra   * rancid  To check:   * xcal -> x11-misc/xcalendar?   * crossfire-maps -> games-roguelike/crossfire-client?                       games-server/crossfire-server?  I think this was it... now to audit the individual packages... ```  [Comment 3](#c3)  Christian Hoffmann (RETIRED)   gentoo-dev  2008-08-26 18:49:27 UTC  ``` We all love bugzie... now it killed all blockers of this bug. Re-adding. Sorry for the spam... ```  [Comment 4](#c4)  Arvid Norlander    2008-08-28 10:54:49 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=235770#c2)) > To check: >   * xcal -> x11-misc/xcalendar? >   * crossfire-maps -> games-roguelike/crossfire-client? >                       games-server/crossfire-server? As a crossfire developer I can say that the issue would be part of the server package, however anyone running a server should use the -tmpdir switch to set the server to use a private temporary directory, it is the recommended way to work around it upstream. IIRC however all cases use open() with O_EXCL so there shouldn't be an issue with that in the current version.  ```  [Comment 5](#c5)  Robert Buchholz (RETIRED)   gentoo-dev  2008-08-30 13:17:07 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=235770#c4)) > anyone running a server should use the -tmpdir switch to set > the server to use a private temporary directory, it is the recommended way to > work around it upstream. IIRC however all cases use open() with O_EXCL so there > shouldn't be an issue with that in the current version.  Let's discuss this on [bug 236205](show_bug.cgi?id=236205 "RESOLVED FIXED - <games-server/crossfire-server-1.11.0: Insecure temporary file creation").    ```  [Comment 6](#c6)  Robert Buchholz (RETIRED)   gentoo-dev  2008-10-07 18:01:45 UTC  ``` I got a complete list of bugs from the debian folks, here is an overview:  * aegis CVE: DEBIAN: <http://bugs.debian.org/496402> DEBIAN: <http://bugs.debian.org/496400> GENTOO: #0 FILES: bng_dvlpd.sh, bng_rvwd.sh, awt_dvlp.sh, awt_intgrtn.sh, aegis.cgi CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/aegis> CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/aegis-web> URL: <http://sourceforge.net/tracker/index.php?func=detail&aid=2079025&group_id=224&atid=100224>  * ampache CVE: CVE-2008-3929 DEBIAN: <http://bugs.debian.org/496369> GENTOO: #237483 FILES: gather-messages.sh CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/ampache> NOTE: the script is only used when translating ampache to a new language  * apertium CVE: TODO DEBIAN: <http://bugs.debian.org/496395> GENTOO: #0 FILES: apertium-gen-deformat, apertium-gen-reformat, apertium CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/apertium>  * aptoncd CVE: TODO DEBIAN: <http://bugs.debian.org/496390> GENTOO: #0 FILES: xmlfile.py CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/aptoncd>  * arb-common CVE: TODO DEBIAN: <http://bugs.debian.org/496396> GENTOO: #0 FILES: arb_fastdnaml, dszmconnect.pl CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/arb-common>  * audiolink CVE:  DEBIAN: <http://bugs.debian.org/496433> GENTOO: #0 FILES: audiolink CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/audiolink>  * aview CVE:  DEBIAN: <http://bugs.debian.org/496422> GENTOO: #235808 FILES: asciiview CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/aview>  * bulmages-servers CVE:  DEBIAN: <http://bugs.debian.org/496382> GENTOO: #0 FILES: actualizabulmacont, installbulmages-db, creabulmafact, creabulmacont, actualizabulmafact CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/bulmages-servers>  * caudium CVE: CVE-2008-3883 DEBIAN: <http://bugs.debian.org/496404> GENTOO: #0 FILES: configvar CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/caudium>  * cdcontrol CVE:  DEBIAN: <http://bugs.debian.org/496438> GENTOO: #0 FILES: writtercontrol CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/cdcontrol>  * cdrw-taper CVE:  DEBIAN: <http://bugs.debian.org/496380> GENTOO: #0 FILES: amlabel-cdrw CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/cdrw-taper>  * citadel CVE: CVE-2008-3930 DEBIAN: <http://bugs.debian.org/496359> GENTOO: #0 FILES: migrate_aliases.sh CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/citadel-server>  * cman CVE:  DEBIAN: <http://bugs.debian.org/496410> GENTOO: #0 FILES: fence_egenera CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/cman>  * convirt CVE:  DEBIAN: <http://bugs.debian.org/496419> GENTOO: #0 FILES: provision.sh, provision.sh, provision.sh, provision.sh, provision.sh, provision.sh, provision.sh CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/convirt>  * crossfire CVE:  DEBIAN: <http://bugs.debian.org/496358> GENTOO: #236205 FILES: combine.pl CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/crossfire-maps>  * dhis-server CVE:  DEBIAN: <http://bugs.debian.org/496388> GENTOO: #0 FILES: dhis-dummy-log-engine CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/dhis-server>  * digitaldj CVE:  DEBIAN: <http://bugs.debian.org/496399> GENTOO: #0 FILES: fest.pl CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/digitaldj>  * dist CVE:  DEBIAN: <http://bugs.debian.org/496412> GENTOO: #0 FILES: patcil, patdiff CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/dist>  * dpkg-cross CVE:  DEBIAN: <http://bugs.debian.org/496413> GENTOO: #0 FILES: gccross CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/dpkg-cross>  * dtc CVE:  DEBIAN: <http://bugs.debian.org/496362> GENTOO: #235812 FILES: accesslog.php, sa-wrapper CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/dtc-common>  * emacs-jabber CVE:  DEBIAN: <http://bugs.debian.org/496428> GENTOO: #0 FILES: emacs-jabber CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/emacs-jabber>  * emacspeak CVE: CVE-2008-4191 DEBIAN: <http://bugs.debian.org/496431> GENTOO: #238575 FILES: extract-table.pl CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/emacspeak>  * feta CVE: CVE-2008-4440 DEBIAN: <http://bugs.debian.org/496397> GENTOO: #0 FILES: to-upgrade CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/feta> NOTE: in to-upgrade plugin  * firehol CVE:  DEBIAN: <http://bugs.debian.org/496424> GENTOO: #0 FILES: firehol CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/firehol>  * fml CVE:  DEBIAN: <http://bugs.debian.org/496370> GENTOO: #0 FILES: mead.pl CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/fml>  * freeradius-dialupadmin CVE:  DEBIAN: <http://bugs.debian.org/496389> GENTOO: #0 FILES: backup_radacct, clean_radacct, monthly_tot_stats, tot_stats, truncate_radacct CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/freeradius-dialupadmin>  * freevo CVE:  DEBIAN: <http://bugs.debian.org/496373> GENTOO: #0 FILES: freevo.real CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/freevo> NOTE: disabled in the source  * fwbuilder CVE:  DEBIAN: <http://bugs.debian.org/496406> GENTOO: #235809 FILES: fwb_install CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/fwbuilder>  * gccxml CVE:  DEBIAN: <http://bugs.debian.org/496391> GENTOO: #0 FILES: find_flags CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/gccxml>  * gdrae CVE:  DEBIAN: <http://bugs.debian.org/496378> GENTOO: #0 FILES: gdrae CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/gdrae>  * gpsdrive-scripts CVE:  DEBIAN: <http://bugs.debian.org/496436> GENTOO: #0 FILES: geo-code CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/gpsdrive-scripts>  * honeyd CVE: CVE-2008-3928 DEBIAN: <http://bugs.debian.org/496365> GENTOO: #237481 FILES: test.sh CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/honeyd-common> NOTE:   * ibackup CVE:  DEBIAN: <http://bugs.debian.org/496432> GENTOO: #0 FILES: ibackup CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/ibackup>  * impose+ CVE:  DEBIAN: <http://bugs.debian.org/496435> GENTOO: #0 FILES: impose CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/impose>+  * konwert CVE:  DEBIAN: <http://bugs.debian.org/496379> GENTOO: #0 FILES: any-UTF8 CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/konwert-filters>  * lazarus CVE:  DEBIAN: <http://bugs.debian.org/496377> GENTOO: #235828 FILES: create_lazarus_export_tgz.sh CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/lazarus-src>  * liguidsoap CVE:  DEBIAN: <http://bugs.debian.org/496360> GENTOO: #0 FILES: liguidsoap.py CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/liguidsoap>  * linux-patch-openswan CVE:  DEBIAN: <http://bugs.debian.org/496376> GENTOO: #0 FILES: maysnap, maytest CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/linux-patch-openswan>  * linuxtrade CVE:  DEBIAN: <http://bugs.debian.org/496372> GENTOO: #0 FILES: linuxtrade.bwkvol, linuxtrade.wn, moneyam.helper CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/linuxtrade>  * lmbench CVE:  DEBIAN: <http://bugs.debian.org/496427> GENTOO: #0 FILES: rccs, STUFF CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/lmbench>  * ltp-network-test CVE:  DEBIAN: <http://bugs.debian.org/496411> GENTOO: #0 FILES: ftp_setup_vsftp_conf, nfs_fsstress.sh CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/ltp-network-test>  * lustre CVE:  DEBIAN: <http://bugs.debian.org/496371> GENTOO: #0 FILES: runiozone CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/lustre-tests>  * mafft CVE:  DEBIAN: <http://bugs.debian.org/496366> GENTOO: #235804 FILES: mafft-homologs CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/mafft>  * mgetty CVE:  DEBIAN: <http://bugs.debian.org/496403> GENTOO: #235806 FILES: faxspool CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/mgetty-fax>  * mgt CVE:  DEBIAN: <http://bugs.debian.org/496434> GENTOO: #0 FILES: mailgo CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/mgt>  * mon CVE: [requested] DEBIAN: <http://bugs.debian.org/496398> GENTOO: #0 FILES: test.alert CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/mon>  * myspell CVE:  DEBIAN: <http://bugs.debian.org/496392> GENTOO: #0 FILES: i2myspell CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/myspell-tools>  * netmrg CVE:  DEBIAN: <http://bugs.debian.org/496384> GENTOO: #0 FILES: rrdedit CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/netmrg>  * newsgate CVE:  DEBIAN: <http://bugs.debian.org/496437> GENTOO: #0 FILES: mkmailpost CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/newsgate>  * ogle CVE:  DEBIAN: <http://bugs.debian.org/496425> DEBIAN: <http://bugs.debian.org/496420> GENTOO: #0 FILES: ogle_audio_debug, ogle_cli_debug, ogle_ctrl_debug, ogle_gui_debug, ogle_mpeg_ps_debug, ogle_mpeg_vs_debug, ogle_nav_debug, ogle_vout_debug CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/ogle> CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/ogle-mmx> NOTE: This only affects debugging scripts not present in standard path  * openoffice.org CVE:  DEBIAN: <http://bugs.debian.org/496361> GENTOO: #235824 FILES: senddoc CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/openoffice.org-common> 	[etch] - openoffice.org <not-affected> (Vulnerable code not present) 	NOTE: also not present in 3.0.0, only in 2.4.1. Fix pending upload.  * openswan CVE: CVE-2008-4190 DEBIAN: <http://bugs.debian.org/496374> GENTOO: #238574 FILES: livetest CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/openswan>  * plait CVE: CVE-2008-4085 DEBIAN: <http://bugs.debian.org/496381> GENTOO: #0 FILES: plait, plaiter CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/plait>  * postfix CVE:  DEBIAN: <http://bugs.debian.org/496401> GENTOO: #235811 FILES: postfix_groups.pl CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/postfix> NOTE: Not enabled by default, needs manual modification of a script  * qemu CVE:  DEBIAN: <http://bugs.debian.org/496394> GENTOO: #235826 FILES: qemu-make-debian-root CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/qemu>  * radiance CVE:  DEBIAN: <http://bugs.debian.org/496433> GENTOO: #0 FILES: optics2rad, pdelta, dayfact, raddepend CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/radiance>  * rancid CVE:  DEBIAN: <http://bugs.debian.org/496426> GENTOO: #0 FILES: getipacctg CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/rancid-util>  * R CVE: CVE-2008-3931 DEBIAN: <http://bugs.debian.org/496418> DEBIAN: <http://bugs.debian.org/496363> GENTOO: #235822 FILES: javareconf, javareconf.orig CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/r-base-core> CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/r-base-core-ra>  * rccp CVE:  DEBIAN: <http://bugs.debian.org/496364> GENTOO: #0 FILES: delqueueask CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/rccp>  * realtimebattle CVE:  DEBIAN: <http://bugs.debian.org/496385> GENTOO: #0 FILES: perl.robot CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/realtimebattle-common>  * rkhunter CVE:  DEBIAN: <http://bugs.debian.org/496375> GENTOO: #235798 FILES: rkhunter CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/rkhunter>  * scilab-bin CVE:  DEBIAN: <http://bugs.debian.org/496414> GENTOO: #0 FILES: scilink, scidoc, scidem CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/scilab-bin>  * scratchbox2 CVE:  DEBIAN: <http://bugs.debian.org/496409> GENTOO: #0 FILES: dpkg-checkbuilddeps, sb2-check-pkg-mappings CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/scratchbox2>  * sgml2x CVE:  DEBIAN: <http://bugs.debian.org/496368> GENTOO: #0 FILES: rlatex CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/sgml2x>  * sng CVE:  DEBIAN: <http://bugs.debian.org/496407> GENTOO: #0 FILES: sng_regress CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/sng>  * sympa CVE:  DEBIAN: <http://bugs.debian.org/494969> DEBIAN: <http://bugs.debian.org/496405> GENTOO: #0 FILES: wwsympa.fcgi, sympa.pl CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/sympa>  * tiger CVE: CVE-2008-3927 DEBIAN: <http://bugs.debian.org/496415> GENTOO: #0 FILES: genmsgidx CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/tiger> NOTE: the script is only used during build time   * vdr CVE:  DEBIAN: <http://bugs.debian.org/496421> GENTOO: #235827 FILES: vdrleaktest CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/vdr-dbg>  * wims CVE:  DEBIAN: <http://bugs.debian.org/496387> GENTOO: #0 FILES: coqweb, account.sh CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/wims>  * xastir CVE:  DEBIAN: <http://bugs.debian.org/496383> GENTOO: #0 FILES: get-maptools.sh, get_shapelib.sh CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/xastir>  * xcal CVE:  DEBIAN: <http://bugs.debian.org/496393> GENTOO: #0 FILES: pscal CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/xcal>  * xen CVE:  DEBIAN: <http://bugs.debian.org/496367> GENTOO: #235805 FILES: qemu-dm.debug CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/xen-utils-3.2-1>  * xmcd CVE:  DEBIAN: <http://bugs.debian.org/496416> GENTOO: #0 FILES: ncsarmt, ncsawrap CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/xmcd>     * bk2site CVE:  DEBIAN: <http://bugs.debian.org/496430> GENTOO: #0 FILES: redirect.pl CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/bk2site> NOTE: requires code change, $debug = 1   * initramfs-tools CVE:  DEBIAN: <http://bugs.debian.org/496386> GENTOO: #0 FILES: init CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/initramfs-tools>  * sendmail-base CVE: CVE-2003-0308 DEBIAN: <http://bugs.debian.org/496408> GENTOO: #0 FILES: checksendmail, expn CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/sendmail-base> NOTE: Code path not run  * printfilters-ppd CVE:  DEBIAN: <http://bugs.debian.org/496417> GENTOO: #0 FILES: master-filter CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/printfilters-ppd>  * datafreedom-perl CVE:  DEBIAN: <http://bugs.debian.org/496429> GENTOO: #0 FILES: dfxml-invoice CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/datafreedom-perl>   ```  [Comment 7](#c7)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-10-08 19:51:18 UTC  ``` I found one in sys-cluster/fence-2.02.00-r1 (belongs to cman-2.02.00-r1, but our fence_egenera does not have CVE-2008-4192), see #240576  ```  [Comment 8](#c8)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-11-05 22:17:01 UTC  ``` aegis: CVE-2008-4938 / #245760 emacs-jabber: CVE-2008-4952 / #245761 gccxml: CVE-2008-4957 / #245765 ```  [Comment 9](#c9)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-11-06 09:17:37 UTC  ``` The bug in emacs-jabber (CVE-2008-4952 / #245761) is debian specific and exists only in their installer. ```  [Comment 10](#c10)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-11-07 02:51:47 UTC  ``` ogle: CVE-2008-4976 / #245921 scilab: CVE-2008-4983 / #245922 ```  [Comment 11](#c11)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-11-07 22:19:24 UTC  ``` firehol: CVE-2008-4953 / #246013 lmbench: CVE-2008-4968 / #246015 ```  [Comment 12](#c12)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-11-08 14:49:49 UTC  ``` initramfs-tools: CVE-2008-4996 / we do not ship those twiki: CVE-2008-4998 / #235802  And we have a different symlink bug: app-emulation/xen: CVE-2008-4993 / #246068    ```  [Comment 13](#c13)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-11-09 20:09:56 UTC  ``` freevo:	CVE-2008-4955 ```  [Comment 14](#c14)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-11-11 00:42:21 UTC  ``` dev-lang/lazarus: CVE-2008-5007 / #235828  ```  [Comment 15](#c15)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-11-25 09:57:16 UTC  ``` I added the dependencies: virtualbox: 248750 / CVE requested sys-fs/ecryptfs-utils: 248058 / CVE-2008-5188 app-mobilephone/smsclient: 247483 / CVE-2008-5155 app-pda/p3nfs: 247481 / CVE-2008-5154 sci-visualization/mayavi: 247479 / CVE-2008-5151 ```  [Comment 16](#c16)  Stefan Behte (RETIRED)   gentoo-dev Security  2008-12-10 21:36:50 UTC  ``` net-dialup/ppp-2.4.4-r21 (/etc/ppp/ip-up.d/40-dns.sh) #250553 / this is LIKE CVE-2008-5367, but not the same issue.  app-misc/muttprint<=0.72d #250554 / CVE-2008-5368 ```  [Comment 17](#c17)  stupendoussteve    2008-12-10 22:50:13 UTC  ``` Added blockers: app-misc/screenie-1.30.0: CVE-2008-5371 / #250476  media-sound/cmus-2.2.0: CVE-2008-5375 / #250474  app-text/tkman <= 2.2: CVE-2008-5137 / #247540 - Does not have a maintainer/herd ```  [Comment 18](#c18)  Nico R.    2009-01-21 20:53:55 UTC  ``` Shouldn’t this bug /depend on/ instead of /block/ [bug 247986](show_bug.cgi?id=247986 "RESOLVED FIXED - sys-auth/pam_mount passwdehd insecure temporary file creation (CVE-2008-5138)") and [bug 251316](show_bug.cgi?id=251316 "RESOLVED INVALID - net-print/cups pstopdf symlink attack (CVE-2008-5377)")? ```  [Comment 19](#c19)  Sean Amoss (RETIRED)   gentoo-dev Security  2012-09-22 19:34:01 UTC  ``` All blockers are done.   Closing. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=235770)
* - [XML](show_bug.cgi?ctype=xml&id=235770)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=235770)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=235770&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=235770&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=235770&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.openwall.com_695af41c_20250125_072252.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2008/10/31/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <200810302253.40409.rbu@gentoo.org>
Date: Thu, 30 Oct 2008 22:53:29 +0100
From: Robert Buchholz <rbu@...too.org>
To: oss-security <oss-security@...ts.openwall.com>
Subject: CVE requests: tempfile issues for aview, mgetty, openoffice, crossfire

Hi,

Gentoo could need CVEs for some more of the insecure tempfile issues
found by Debian. For others, we have gathered a list of all the bugs
created at our tracker <https://bugs.gentoo.org/show_bug.cgi?id=235770>

* aview
DEBIAN: <http://bugs.debian.org/496422>
GENTOO: <https://bugs.gentoo.org/235808>
FILES: asciiview
CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/aview>

* mgetty
DEBIAN: <http://bugs.debian.org/496403>
GENTOO: <https://bugs.gentoo.org/235806>
FILES: faxspool
CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/mgetty-fax>

* openoffice.org
DEBIAN: <http://bugs.debian.org/496361>
GENTOO: <https://bugs.gentoo.org/235824>
<http://www.securityfocus.com/bid/30925>
FILES: senddoc
CODE:
<http://dev.gentoo.org/~rbu/security/debiantemp/openoffice.org-common>
   [etch] - openoffice.org <not-affected> (Vulnerable code not present)
   NOTE: also not present in 3.0.0, only in 2.4.1. Fix pending upload.

* crossfire
DEBIAN: <http://bugs.debian.org/496358>
GENTOO: <https://bugs.gentoo.org/236205>
FILES: combine.pl
CODE: <http://dev.gentoo.org/~rbu/security/debiantemp/crossfire-maps>

Robert

Download attachment "[signature.asc](2/1) " of type "application/pgp-signature" (836 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_43638140_20250125_072247.html ===

# Debian Bug report logs - #496366 The possibility of attack with the help of symlinks in some Debian packages

[![version graph](version.cgi?height=2;collapse=1;package=mafft;width=2;absolute=0;fixed=mafft%2F6.240-2)](version.cgi?absolute=0;fixed=mafft%2F6.240-2;info=1;collapse=1;package=mafft)

Package:
[mafft](pkgreport.cgi?package=mafft);
Maintainer for [mafft](pkgreport.cgi?package=mafft) is [Debian Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>](pkgreport.cgi?maint=debian-med-packaging%40lists.alioth.debian.org); Source for [mafft](pkgreport.cgi?package=mafft) is [src:mafft](pkgreport.cgi?src=mafft) ([PTS](https://tracker.debian.org/pkg/mafft), [buildd](https://buildd.debian.org/mafft), [popcon](https://qa.debian.org/popcon.php?package=mafft)).

Reported by: ["Dmitry E. Oboukhov" <dimka@uvw.ru>](pkgreport.cgi?submitter=dimka%40uvw.ru)

Date: Sun, 24 Aug 2008 18:09:16 UTC

Severity: *grave*

Tags: confirmed, patch, security

Fixed in version mafft/6.240-2

**Done:** Charles Plessy <plessy@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=496366;mbox=yes), [status mbox](bugreport.cgi?bug=496366;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=496366;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#496366`; Package `mafft`.
([full text](bugreport.cgi?bug=496366;msg=2), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `"Dmitry E. Oboukhov" <dimka@uvw.ru>`:

New Bug report received and forwarded. Copy sent to `Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=496366;msg=4), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=496366;msg=5), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=dimka%40uvw.ru)
From: "Dmitry E. Oboukhov" <dimka@uvw.ru>
To: submit@bugs.debian.org
Cc: dimka@uvw.ru
Subject: The possibility of attack with the help of symlinks in some Debian packages
Date: Sun, 24 Aug 2008 22:05:28 +0400
```
Package: mafft
Severity: grave

Hi, maintainer!

This message about the error concerns a few packages  at  once.   I've
tested all the packages (for Lenny) on my Debian mirror.  All  scripts
of packages (marked as executable) were tested.

In some packages I've discovered scripts with errors which may be used
by a user for damaging important system files or user's files.

For example if a script uses in its work a temp file which is  created
in /tmp directory, then every user can create symlink  with  the  same
name in this directory in order to  destroy  or  rewrite  some  system
or user file.  Symlink attack may also  lead  not  only  to  the  data
desctruction but to denial of service as well.

Even if you create files or directories with help of function 'RANDOM'
or pid(), then your system is not protected. Attacker can create many
symlinks in order to destroy your data or create 'denial  of  service'
for your package scripts.

Even if you make rm(dir) for files/directories, then  your  system  is
not protected. Attacker can permanently create symlinks.

This list is created with the help of script.  This list is sorted  by
hand. Howewer in some cases mistake is possible.

Please, Be understanding to possible mistakes. :)

I set Severity into grave for this bug. The table of discovered
problems is below.

Discussion of this bug you can see in debian-devel@:
    <http://lists.debian.org/debian-devel/2008/08/msg00271.html>

Binary-package: r-base-core-ra (1.1.1-1)
    file: /usr/lib/Ra/lib/R/bin/javareconf
Binary-package: rccp (0.9-2)
    file: /usr/lib/rccp/delqueueask
Binary-package: mafft (6.240-1)
    file: /usr/bin/mafft-homologs
Binary-package: openoffice.org-common (1:2.4.1-6)
    file: /usr/lib/openoffice/program/senddoc
Binary-package: crossfire-maps (1.11.0-1)
    file: /usr/share/games/crossfire/maps/Info/combine.pl
Binary-package: sgml2x (1.0.0-11.1)
    file: /usr/bin/rlatex
Binary-package: liguidsoap (0.3.6-4)
    file: /var/lib/liguidsoap/liguidsoap.py
Binary-package: citadel-server (7.37-1)
    file: /usr/lib/citadel-server/migrate_aliases.sh
Binary-package: ampache (3.4.1-1)
    file: /usr/share/ampache/www/locale/base/gather-messages.sh
Binary-package: xen-utils-3.2-1 (3.2.1-2)
    file: /usr/lib/xen-3.2-1/bin/qemu-dm.debug
Binary-package: dtc-common (0.29.6-1)
    file: /usr/share/dtc/admin/accesslog.php
    file: /usr/share/dtc/admin/sa-wrapper
Binary-package: honeyd-common (1.5c-3)
    file: /usr/share/honeyd/scripts/test.sh
Binary-package: lustre-tests (1.6.5-1)
    file: /usr/lib/lustre/tests/runiozone
Binary-package: linuxtrade (3.65-8+b4)
    file: /usr/share/linuxtrade/bin/linuxtrade.bwkvol
    file: /usr/share/linuxtrade/bin/linuxtrade.wn
    file: /usr/share/linuxtrade/bin/moneyam.helper
Binary-package: freevo (1.8.1-0)
    file: /usr/bin/freevo.real
Binary-package: fml (4.0.3.dfsg-2)
    file: /usr/share/fml/libexec/mead.pl
Binary-package: rkhunter (1.3.2-3)
    file: /usr/bin/rkhunter
Binary-package: openswan (1:2.4.12+dfsg-1.1)
    file: /usr/lib/ipsec/livetest
Binary-package: linux-patch-openswan (1:2.4.12+dfsg-1.1)
    file: /usr/src/kernel-patches/all/openswan/packaging/utils/maysnap
    file: /usr/src/kernel-patches/all/openswan/packaging/utils/maytest
Binary-package: aptoncd (0.1-1.1)
    file: /usr/share/aptoncd/xmlfile.py
Binary-package: cdcontrol (1.90-1.1)
    file: /usr/lib/cdcontrol/writtercontrol
Binary-package: newsgate (1.6-23)
    file: /usr/bin/mkmailpost
Binary-package: gpsdrive-scripts (2.10~pre4-3)
    file: /usr/bin/geo-code
Binary-package: impose+ (0.2-11)
    file: /usr/bin/impose
Binary-package: mgt (2.31-5)
    file: /usr/games/mailgo
Binary-package: audiolink (0.05-1)
    file: /usr/bin/audiolink
Binary-package: ibackup (2.27-4.1)
    file: /usr/bin/ibackup
Binary-package: emacspeak (26.0-3)
    file: /usr/share/emacs/site-lisp/emacspeak/etc/extract-table.pl
Binary-package: bk2site (1:1.1.9-3.1)
    file: /usr/lib/cgi-bin/bk2site/redirect.pl
Binary-package: datafreedom-perl (0.1.7-1)
    file: /usr/bin/dfxml-invoice
Binary-package: emacs-jabber (0.7.91-1)
    file: /usr/lib/emacsen-common/packages/install/emacs-jabber
Binary-package: lmbench (3.0-a7-1)
    file: /usr/lib/lmbench/scripts/rccs
    file: /usr/lib/lmbench/scripts/STUFF
Binary-package: rancid-util (2.3.2~a8-1)
    file: /var/lib/rancid/getipacctg
Binary-package: ogle (0.9.2-5.2)
    file: /usr/lib/ogle/ogle_audio_debug
    file: /usr/lib/ogle/ogle_cli_debug
    file: /usr/lib/ogle/ogle_ctrl_debug
    file: /usr/lib/ogle/ogle_gui_debug
    file: /usr/lib/ogle/ogle_mpeg_ps_debug
    file: /usr/lib/ogle/ogle_mpeg_vs_debug
    file: /usr/lib/ogle/ogle_nav_debug
    file: /usr/lib/ogle/ogle_vout_debug
Binary-package: firehol (1.256-4)
    file: /sbin/firehol
Binary-package: aview (1.3.0rc1-8)
    file: /usr/bin/asciiview
Binary-package: radiance (3R9+20080530-3)
    file: /usr/bin/optics2rad
    file: /usr/bin/pdelta
    file: /usr/bin/dayfact
    file: /usr/bin/raddepend
Binary-package: vdr-dbg (1.6.0-5)
    file: /usr/bin/vdrleaktest
Binary-package: ogle-mmx (0.9.2-5.2)
    file: /usr/lib/ogle/ogle_audio_debug
    file: /usr/lib/ogle/ogle_cli_debug
    file: /usr/lib/ogle/ogle_ctrl_debug
    file: /usr/lib/ogle/ogle_gui_debug
    file: /usr/lib/ogle/ogle_mpeg_ps_debug
    file: /usr/lib/ogle/ogle_mpeg_vs_debug
    file: /usr/lib/ogle/ogle_nav_debug
    file: /usr/lib/ogle/ogle_vout_debug
Binary-package: convirt (0.8.2-3)
    file: /usr/share/convirt/image_store/_template_/provision.sh
    file: /usr/share/convirt/image_store/Linux_CD_Install/provision.sh
    file: /usr/share/convirt/image_store/Fedora_PV_Install/provision.sh
    file: /usr/share/convirt/image_store/CentOS_PV_Install/provision.sh
    file: /usr/share/convirt/image_store/common/provision.sh
    file: /usr/share/convirt/image_store/example/provision.sh
    file: /usr/share/convirt/image_store/Windows_CD_Install/provision.sh
Binary-package: printfilters-ppd (2.13-9)
    file: /usr/lib/printfilters/master-filter
Binary-package: r-base-core (2.7.1-1)
    file: /usr/lib/R/bin/javareconf
    file: /usr/lib/R/bin/javareconf.orig
Binary-package: xmcd (2.6-19.3)
    file: /usr/share/xmcd/scripts/ncsarmt
    file: /usr/share/xmcd/scripts/ncsawrap
Binary-package: tiger (1:3.2.2-3.1)
    file: /usr/lib/tiger/util/genmsgidx
Binary-package: scilab-bin (4.1.2-5)
    file: /usr/lib/scilab-4.1.2/bin/scilink
    file: /usr/lib/scilab-4.1.2/util/scidoc
    file: /usr/lib/scilab-4.1.2/util/scidem
Binary-package: dpkg-cross (2.3.0)
    file: /usr/share/dpkg-cross/bin/gccross
Binary-package: ltp-network-test (20060918-2.1)
    file: /usr/lib/debian-test/tests/linux/testcases/bin/ftp_setup_vsftp_conf
    file: /usr/lib/debian-test/tests/linux/testcases/bin/nfs_fsstress.sh
Binary-package: cman (2.20080629-1)
    file: /usr/sbin/fence_egenera
Binary-package: scratchbox2 (1.99.0.24-1)
    file: /usr/share/scratchbox2/scripts/dpkg-checkbuilddeps
    file: /usr/share/scratchbox2/scripts/sb2-check-pkg-mappings
Binary-package: sendmail-base (8.14.3-5)
    file: /usr/sbin/checksendmail
    file: /usr/bin/expn
Binary-package: fwbuilder (2.1.19-3)
    file: /usr/bin/fwb_install
Binary-package: sng (1.0.2-5)
    file: /usr/bin/sng_regress
Binary-package: dist (1:3.5-17-1)
    file: /usr/bin/patcil
    file: /usr/bin/patdiff
Binary-package: sympa (5.3.4-5)
    file: /usr/lib/cgi-bin/sympa/wwsympa.fcgi
    file: /usr/lib/sympa/bin/sympa.pl
Binary-package: postfix (2.5.2-2)
    file: /usr/lib/postfix_groups.pl
Binary-package: caudium (3:1.4.12-11)
    file: /usr/share/caudium/configvar
Binary-package: mgetty-fax (1.1.36-1.2)
    file: /usr/bin/faxspool
Binary-package: aegis (4.24-3)
    file: /usr/share/doc/aegis/examples/remind/bng_dvlpd.sh
    file: /usr/share/doc/aegis/examples/remind/bng_rvwd.sh
    file: /usr/share/doc/aegis/examples/remind/awt_dvlp.sh
    file: /usr/share/doc/aegis/examples/remind/awt_intgrtn.sh
Binary-package: aegis-web (4.24-3)
    file: /usr/lib/cgi-bin/aegis.cgi
Binary-package: digitaldj (0.7.5-6+b1)
    file: /usr/share/digitaldj/fest.pl
Binary-package: mon (0.99.2-12)
    file: /usr/lib/mon/alert.d/test.alert
Binary-package: feta (1.4.16)
    file: /usr/share/feta/plugins/to-upgrade
Binary-package: arb-common (0.0.20071207.1-4)
    file: /usr/lib/arb/SH/arb_fastdnaml
    file: /usr/lib/arb/SH/dszmconnect.pl
Binary-package: qemu (0.9.1-5)
    file: /usr/sbin/qemu-make-debian-root
Binary-package: apertium (3.0.7+1-1+b1)
    file: /usr/bin/apertium-gen-deformat
    file: /usr/bin/apertium-gen-reformat
    file: /usr/bin/apertium
Binary-package: xcal (4.1-18.3)
    file: /usr/bin/pscal
Binary-package: myspell-tools (1:3.1-20)
    file: /usr/bin/i2myspell
Binary-package: gccxml (0.9.0+cvs20080525-1)
    file: /usr/share/gccxml-0.9/MIPSpro/find_flags
Binary-package: freeradius-dialupadmin (2.0.4+dfsg-4)
    file: /usr/share/freeradius-dialupadmin/bin/backup_radacct
    file: /usr/share/freeradius-dialupadmin/bin/clean_radacct
    file: /usr/share/freeradius-dialupadmin/bin/monthly_tot_stats
    file: /usr/share/freeradius-dialupadmin/bin/tot_stats
    file: /usr/share/freeradius-dialupadmin/bin/truncate_radacct
Binary-package: dhis-server (5.3-1)
    file: /usr/lib/dhis-server/dhis-dummy-log-engine
Binary-package: wims (3.62-13)
    file: /var/lib/wims/public_html/bin/coqweb
    file: /var/lib/wims/bin/account.sh
Binary-package: initramfs-tools (0.92f)
    file: /usr/share/initramfs-tools/init
Binary-package: realtimebattle-common (1.0.8-7)
    file: /usr/lib/realtimebattle/Robots/perl.robot
Binary-package: netmrg (0.20-1)
    file: /usr/bin/rrdedit
Binary-package: bulmages-servers (0.11.1-2)
    file: /usr/share/bulmages/examples/scripts/actualizabulmacont
    file: /usr/share/bulmages/examples/scripts/installbulmages-db
    file: /usr/share/bulmages/examples/scripts/creabulmafact
    file: /usr/share/bulmages/examples/scripts/creabulmacont
    file: /usr/share/bulmages/examples/scripts/actualizabulmafact
Binary-package: xastir (1.9.2-1)
    file: /usr/lib/xastir/get-maptools.sh
    file: /usr/lib/xastir/get_shapelib.sh
Binary-package: plait (1.5.2-1)
    file: /usr/bin/plaiter
    file: /usr/bin/plait
Binary-package: cdrw-taper (0.4-2)
    file: /usr/sbin/amlabel-cdrw
Binary-package: konwert-filters (1.8-11.1)
    file: /usr/share/konwert/filters/any-UTF8
Binary-package: gdrae (0.1-1)
    file: /usr/bin/gdrae
Binary-package: lazarus-src (0.9.24-0-9)
    file: /usr/lib/lazarus/tools/install/create_lazarus_export_tgz.sh

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#496366`; Package `mafft`.
([full text](bugreport.cgi?bug=496366;msg=7), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `charles@plessy.org`:

Extra info received and forwarded to list. Copy sent to `Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=496366;msg=9), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 496366@bugs.debian.org ([full text](bugreport.cgi?bug=496366;msg=10), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=plessy%40debian.org)
From: Charles Plessy <plessy@debian.org>
To: debian-release@lists.debian.org, debian-security@lists.debian.org
Cc: "Dmitry E. Oboukhov" <dimka@uvw.ru>, 496366@bugs.debian.org,
control@bugs.debian.org
Subject: Re: [Debian-med-packaging] Bug#496366: The possibility of attack
with the help of symlinks in some Debian packages
Date: Mon, 25 Aug 2008 12:56:44 +0900
```
tag 496366 help
thanks

Le Sun, Aug 24, 2008 at 10:05:28PM +0400, Dmitry E. Oboukhov a écrit :
> Package: mafft
> Severity: grave
>
> In some packages I've discovered scripts with errors which may be used
> by a user for damaging important system files or user's files.

Hi all,

I have not followed the discussions on -devel closely. What is the
relevance of this bug for the releasability of the package? Upstream is
already at a much higher version number and I am not able to solve the
prolem by myself.

Since the vulnerabiilty can only be exploited by other local users, and
since mafft is a scientific software either used on personnal computers
or on scientific workstations in trusted environments, can I ignore the
bug for Lenny and work with Upsteam on a fix in the latest release?

Have a nice day,

--
Charles Plessy
Debian Med packaging team,
Tsurumi, Kanagawa, Japan

```

---

**Tags added: help**
Request was from `Charles Plessy <plessy@debian.org>`
to `control@bugs.debian.org`.
(Mon, 25 Aug 2008 04:00:05 GMT) ([full text](bugreport.cgi?bug=496366;msg=12), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#496366`; Package `mafft`.
([full text](bugreport.cgi?bug=496366;msg=14), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent** to `Thijs Kinkhorst <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=496366;msg=16), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 496366@bugs.debian.org ([full text](bugreport.cgi?bug=496366;msg=17), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: Thijs Kinkhorst <thijs@debian.org>
To: 496366@bugs.debian.org
Cc: control@bugs.debian.org
Subject: Re: [Debian-med-packaging] Bug#496366: The possibility of attack with the help of symlinks in some Debian packages
Date: Mon, 25 Aug 2008 09:01:53 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=496366;msg=17) (text/plain, inline)]
```
```
tags 496366 confirmed
thanks

Hi Charles,

> What is the relevance of this bug for the releasability of the package?
> Upstream is already at a much higher version number and I am not able to
> solve the prolem by myself.

I've confirmed that the bug is indeed well-present: the script in question
uses a number of files directly in /tmp with only the PID as a unique factor.

I've checked the latest upstream and that also has the exact same problem, so
I don't think it's really relevant that upstream is many versions ahead. If
they fix it, the fix can be applied to the current mafft package. I don't
know on why you cannot fix the bug yourself, but at least an upstream fix
would be easily backportable.

But applying the fix yourself would not be very invasive either. The script
makes extensive use of the system() call, so you could simply add system
calls to use essential 'mktemp' to create the files safely.

In the attachment is an example patch which solves the first occurrence. As
you can see its very simple.

If you want a pure Ruby solution it would probably be a bit more invasive, but
in that case <http://ruby-stemp.rubyforge.org/> is available.

> Since the vulnerabiilty can only be exploited by other local users, and
> since mafft is a scientific software either used on personnal computers
> or on scientific workstations in trusted environments, can I ignore the
> bug for Lenny and work with Upsteam on a fix in the latest release?

In the security team, issuing a DSA for an issue that has all these properties
is normally not high on the priority list. However, that doesn't mean that
I'm happy with new packages entering stable that have known bugs of this
kind. So yes, I believe this bug should be resolved before lenny, especially
as I don't see the problem in doing so.

Thijs

```
```
[[example.patch](bugreport.cgi?att=1;bug=496366;filename=example.patch;msg=17) (text/x-diff, attachment)]
```
```
[[Message part 3](bugreport.cgi?att=2;bug=496366;msg=17) (application/pgp-signature, inline)]
```

---

**Tags added: confirmed**
Request was from `Thijs Kinkhorst <thijs@debian.org>`
to `control@bugs.debian.org`.
(Mon, 25 Aug 2008 07:03:06 GMT) ([full text](bugreport.cgi?bug=496366;msg=19), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=19), [link](#18)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#496366`; Package `mafft`.
([full text](bugreport.cgi?bug=496366;msg=21), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent** to `Charles Plessy <plessy@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=496366;msg=23), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 496366@bugs.debian.org ([full text](bugreport.cgi?bug=496366;msg=24), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=plessy%40debian.org)
From: Charles Plessy <plessy@debian.org>
To: Thijs Kinkhorst <thijs@debian.org>, 496366@bugs.debian.org,
"Dmitry E. Oboukhov" <dimka@uvw.ru>
Cc: control@bugs.debian.org
Subject: Re: [Debian-med-packaging] Bug#496366: Bug#496366: The possibility
of attack with the help of symlinks in some Debian packages
Date: Mon, 25 Aug 2008 23:52:34 +0900
```
tag 496366 patch
tag 496366 - help
thanks

Le Mon, Aug 25, 2008 at 09:01:53AM +0200, Thijs Kinkhorst a écrit :
>
> In the attachment is an example patch which solves the first occurrence. As
> you can see its very simple.

Many thanks, Thijs.

With your example it was much more simple than I thought. I prepared a
patch that I will forward upstream:

<http://svn.debian.org/wsvn/debian-med/trunk/packages/mafft/trunk/debian/patches/Securisation-by-mktemp-usage.patch?op=file&rev=0&sc=0>

I would appreciate if Dmitry could review it before I send it.

Have a nice day,

--
Charles Plessy
Debian Med packaging team,
Tsurumi, Kanagawa, Japan

```

---

**Tags added: patch**
Request was from `Charles Plessy <plessy@debian.org>`
to `control@bugs.debian.org`.
(Mon, 25 Aug 2008 14:54:06 GMT) ([full text](bugreport.cgi?bug=496366;msg=26), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=26), [link](#25)).

---

**Tags removed: help**
Request was from `Charles Plessy <plessy@debian.org>`
to `control@bugs.debian.org`.
(Mon, 25 Aug 2008 14:54:07 GMT) ([full text](bugreport.cgi?bug=496366;msg=28), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=28), [link](#27)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#496366`; Package `mafft`.
([full text](bugreport.cgi?bug=496366;msg=30), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=30), [link](#29)).

---

**Acknowledgement sent** to `Thijs Kinkhorst <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=496366;msg=32), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=32), [link](#31)).

---

[Message #33](#33) received at 496366@bugs.debian.org ([full text](bugreport.cgi?bug=496366;msg=33), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=33), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: Thijs Kinkhorst <thijs@debian.org>
To: 496366@bugs.debian.org
Subject: Re: [Debian-med-packaging] Bug#496366: Bug#496366: The possibility of attack with the help of symlinks in some Debian packages
Date: Mon, 25 Aug 2008 16:55:27 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=496366;msg=33) (text/plain, inline)]
```
```
On Monday 25 August 2008 16:52, Charles Plessy wrote:
> Many thanks, Thijs.
>
> With your example it was much more simple than I thought. I prepared a
> patch that I will forward upstream:

Looks good!

Thijs

```
```
[[Message part 2](bugreport.cgi?att=1;bug=496366;msg=33) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#496366`; Package `mafft`.
([full text](bugreport.cgi?bug=496366;msg=35), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=35), [link](#34)).

---

**Acknowledgement sent** to `Charles Plessy <plessy@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=496366;msg=37), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 496366@bugs.debian.org ([full text](bugreport.cgi?bug=496366;msg=38), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=plessy%40debian.org)
From: Charles Plessy <plessy@debian.org>
To: 496366@bugs.debian.org, debian-security@lists.debian.org
Cc: control@bugs.debian.org
Subject: Re: [Debian-med-packaging] Bug#496366: Bug#496366: Bug#496366: The
possibility of attack with the help of symlinks in some Debian
packages
Date: Tue, 26 Aug 2008 13:24:10 +0900
```
tag 496366 forwarded Kazutaka Katoh <katoh@bioreg.kyushu-u.ac.jp>
thanks

Hi all,

I forwarded the patch solving the problem to the upstream author. I
would prefer if I could include a note that the patch was accepted
upstream if possible. How long would you recommend to wait before
uploading ?

Have a nice day,

--
Charles Plessy
Debian Med packaging team,
Tsurumi, Kanagawa, Japan

```

---

**Tags added:**
Request was from `Charles Plessy <plessy@debian.org>`
to `control@bugs.debian.org`.
(Tue, 26 Aug 2008 04:27:03 GMT) ([full text](bugreport.cgi?bug=496366;msg=40), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=40), [link](#39)).

---

**Tags added:**
Request was from `"Dmitry E. Oboukhov" <dimka@uvw.ru>`
to `control@bugs.debian.org`.
(Tue, 26 Aug 2008 08:45:11 GMT) ([full text](bugreport.cgi?bug=496366;msg=42), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=42), [link](#41)).

---

**Tags added: security**
Request was from `"Dmitry E. Oboukhov" <dimka@uvw.ru>`
to `control@bugs.debian.org`.
(Tue, 26 Aug 2008 08:57:08 GMT) ([full text](bugreport.cgi?bug=496366;msg=44), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=44), [link](#43)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#496366`; Package `mafft`.
([full text](bugreport.cgi?bug=496366;msg=46), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=46), [link](#45)).

---

**Acknowledgement sent** to `Charles Plessy <plessy@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=496366;msg=48), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=48), [link](#47)).

---

[Message #49](#49) received at 496366@bugs.debian.org ([full text](bugreport.cgi?bug=496366;msg=49), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=49), reply):

![](/cgi-bin/libravatar.cgi?email=plessy%40debian.org)
From: Charles Plessy <plessy@debian.org>
To: debian-release@lists.debian.org, 496366@bugs.debian.org
Subject: Re: Preparing update of 'mafft' to fix #496366 ("grave" security
bug).
Date: Mon, 1 Sep 2008 21:39:44 +0900
```
Le Mon, Aug 25, 2008 at 10:17:02PM -0700, Steve Langasek a écrit :
> On Tue, Aug 26, 2008 at 01:40:01PM +0900, Charles Plessy wrote:
>
> > Would you accept this package in Lenny to fix #496366?
>
> If the diff is in line with this description, yes.

Hi Steve, hi all,

thank you for your patience. I have been in contact with Upstream who
reviewd kindly finished the patching work (I did not manage to produce a
working patch for the Ruby file).

Here is the final changelog:

 mafft (6.240-2) unstable; urgency=high
 .
   [ Charles Plessy ]
   * debian/control:
     - Moved the Homepage: field out from the package's description.
     - Enhances: t-coffee.
   * Updated my email address.
   * Securisation of the temorary files of mafft-homologs:
     - debian/control: build-depend on quilt.
     - debian/rules: modified to use quilt.
     - debian/README.source: signals that the package uses quilt.
     - debian/patches: added a patch to use non-guessable temporary files
       (Closes: #[496366](bugreport.cgi?bug=496366)). Thanks to Dmitry E. Oboukhov for finding the bug,
       Thijs Kinkhorst for preliminary patch and Kazutaka Katoh for the
       final implementation.
     - debian/mafft-homologs.1*, debian/README.Debian: document that the
       program is patched.
 .
   [ David Paleino ]
   * debian/mafft.1, debian/mafft-homologs.1 added - manpages built statically.
   * debian/control:
     - B-D updated (see above)
     - added myself to Uploaders
     - moved XS-Vcs-* fields to Vcs-*
     - Updated to Standards-Version 3.7.3 (no changes needed)
   * debian/rules:
     - reflecting static build of manpages
     - minor changes

Here is the diffstat:

aqwa『build-area』$ diffstat mafft_6.240-1_6.240-2.debdiff
 debian/README.source                              |    8
 debian/mafft-homologs.1                           |  112 ++++++
 debian/mafft.1                                    |  370 ++++++++++++++++++++++
 debian/patches/Securisation-by-mktemp-usage.patch |  211 ++++++++++++
 debian/patches/series                             |    1
 mafft-6.240/debian/README.Debian                  |    7
 mafft-6.240/debian/changelog                      |   31 +
 mafft-6.240/debian/control                        |   20 -
 mafft-6.240/debian/mafft-homologs.1.xml           |    9
 mafft-6.240/debian/mafft.1.xml                    |    9
 mafft-6.240/debian/rules                          |   20 -

I added a paragraph about the patch to the manpages, but as the sources are in
XML and the stylesheets evolved, the diff is big. All the changes unrelated to
the bug are documented in the changelog, except the addition of
DM-Upload-Allowed: yes, that is systematic in our packages anyway, and cosmetic
improvements of the description. The patch itself now affects another file in
which a similar security problem was uncovered by Upstream. Here is the full
debdiff.

Have a nice day,

-- Charles Plessy, Debian Med packaging team, Tsurumi, Kanagawa, Japan

diff -u mafft-6.240/debian/mafft.1.xml mafft-6.240/debian/mafft.1.xml
--- mafft-6.240/debian/mafft.1.xml
+++ mafft-6.240/debian/mafft.1.xml
@@ -12,7 +12,7 @@
   <!ENTITY dhemail     "charles-debian-nospam@plessy.org">
   <!ENTITY dhusername  "&dhfirstname; &dhsurname;">
   <!ENTITY dhrelease   "6.240">
-  <!ENTITY dhdate      "2007-06-09">
+  <!ENTITY dhdate      "2008-09-01">
   <!ENTITY dhtitle     "Mafft Manual">
   <!ENTITY dhucpackage "MAFFT">
   <!ENTITY dhpackage   "mafft">
@@ -739,4 +739,11 @@
     </refsect2>
   </refsect1>
+  <refsect1>
+    <title>DIVERGENCE FROM UPSTREAM</title>
+    <para><command>mafft-homologs</command> has been patched to enhance the
+    security of the temporary files it creates. You can consult the patch in
+    the Debian source package. It has been reviewed and amended by Kazutaka
+    Katoh, the upstream author of MAFFT.</para>
+  </refsect1>
 </refentry>

diff -u mafft-6.240/debian/control mafft-6.240/debian/control
--- mafft-6.240/debian/control
+++ mafft-6.240/debian/control
@@ -2,18 +2,22 @@
 Section: science
 Priority: optional
 Maintainer: Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>
-Uploaders: Charles Plessy <charles-debian-nospam@plessy.org>
-Build-Depends: debhelper (>= 5), xsltproc, docbook-xsl, docbook-xml
-Standards-Version: 3.7.2
-XS-Vcs-Browser: <http://svn.debian.org/wsvn/debian-med/trunk/packages/mafft/trunk/>
-XS-Vcs-Svn: svn://svn.debian.org/svn/debian-med/trunk/packages/mafft
+DM-Upload-Allowed: yes
+Uploaders: Charles Plessy <plessy@debian.org>,
+ David Paleino <d.paleino@gmail.com>
+Build-Depends: debhelper (>= 5), quilt
+Standards-Version: 3.7.3
+Vcs-Browser: <http://svn.debian.org/wsvn/debian-med/trunk/packages/mafft/trunk/?rev=0&sc=0>
+Vcs-Svn: svn://svn.debian.org/svn/debian-med/trunk/packages/mafft/trunk/
+Homepage: <http://align.bmr.kyushu-u.ac.jp/mafft/software/>

 Package: mafft
 Architecture: any
 Depends: ${shlibs:Depends}, ${misc:Depends}
 Suggests: ruby, lynx, blast2
+Enhances: t-coffee
 Description: Multiple alignment program for amino acid or nucleotide sequences
- MAFFT is a multiple sequence alignment program, which offers three
+ MAFFT is a multiple sequence alignment program which offers three
  accuracy-oriented methods:
   * L-INS-i (probably most accurate; recommended for <200 sequences;
     iterative refinement method incorporating local pairwise alignment
@@ -23,7 +27,7 @@
     pairwise alignment information),
   * E-INS-i (suitable for sequences containing large unalignable regions;
     recommended for <200 sequences),
-    and five speed-oriented methods:
+ and five speed-oriented methods:
   * FFT-NS-i (iterative refinement method; two cycles only),
   * FFT-NS-i (iterative refinement method; max. 1000 iterations),
   * FFT-NS-2 (fast; progressive method),
@@ -34,2 +37,0 @@
- .
-  Homepage: <http://align.bmr.kyushu-u.ac.jp/mafft/software/>
diff -u mafft-6.240/debian/README.Debian mafft-6.240/debian/README.Debian
--- mafft-6.240/debian/README.Debian
+++ mafft-6.240/debian/README.Debian
@@ -21 +21,6 @@
- -- Charles Plessy <charles-debian-nospam@plessy.org>  Wed,  7 Feb 2007 21:44:40 +0900
+The programs mafft and mafft-homologs have been patched to enhance the security
+of the temporary files they create. You can consult the patch in the Debian
+source package. It has been reviewed and amended by Kazutaka Katoh, the
+upstream author of MAFFT.
+
+ -- Charles Plessy <charles-debian-nospam@plessy.org>  Mon, 25 Aug 2008 23:29:19 +0900
diff -u mafft-6.240/debian/mafft-homologs.1.xml mafft-6.240/debian/mafft-homologs.1.xml
--- mafft-6.240/debian/mafft-homologs.1.xml
+++ mafft-6.240/debian/mafft-homologs.1.xml
@@ -12,7 +12,7 @@
   <!ENTITY dhemail     "charles-debian-nospam@plessy.org">
   <!ENTITY dhusername  "&dhfirstname; &dhsurname;">
   <!ENTITY dhrelease   "2.1">
-  <!ENTITY dhdate      "2007-06-09">
+  <!ENTITY dhdate      "2008-09-01">
   <!ENTITY dhtitle     "Mafft Manual">
   <!ENTITY dhucpackage "MAFFT-HOMOLOGS">
   <!ENTITY dhpackage   "mafft-homologs">
@@ -193,2 +193,9 @@
 	</refsect1>
+  <refsect1>
+    <title>DIVERGENCE FROM UPSTREAM</title>
+    <para><command>mafft-homologs</command> has been patched to enhance the
+    security of the temporary files it creates. You can consult the patch in
+    the Debian source package. It has been reviewed and amended by Kazutaka
+    Katoh, the upstream author of MAFFT.</para>
+  </refsect1>
 </refentry>
diff -u mafft-6.240/debian/rules mafft-6.240/debian/rules
--- mafft-6.240/debian/rules
+++ mafft-6.240/debian/rules
@@ -5,11 +5,14 @@
 # Uncomment this to turn on verbose mode.
 #export DH_VERBOSE=1

+include /usr/share/quilt/quilt.make
+
 XP=xsltproc  \
       -''-nonet \
       -''-param man.charmap.use.subset "0" \
       -''-param make.year.ranges "1" \
-      -''-param make.single.year.ranges "1"
+      -''-param make.single.year.ranges "1" \
+      -o debian/

 CFLAGS = -Wall -g
@@ -26,11 +29,11 @@
 mafft-homologs.1: debian/mafft-homologs.1.xml
 	$(XP) $<

-build-stamp: build
-build: mafft.1 mafft-homologs.1
+build: patch build-stamp
+build-stamp:
 	dh_testdir
 	$(MAKE) -C src PREFIX=/usr/lib/mafft
-	touch build-stamp
+	touch $@

 MAFFT = MAFFT_BINARIES=$(CURDIR)/binaries scripts/mafft

@@ -42,11 +45,11 @@
 	-$(MAFFT) --localpair			test/sample | diff test/sample.lins1 -
 	-$(MAFFT) --localpair --maxiterate 100	test/sample | diff test/sample.linsi -

-clean:
+clean: unpatch
 	dh_testdir
 	dh_testroot
-	-$(MAKE) -C src clean
-	dh_clean mafft.1 mafft-homologs.1 build-stamp
+	[ ! -f Makefile ] || $(MAKE) -C src clean
+	dh_clean build-stamp

 install: build-stamp test
 	dh_testdir
@@ -57,14 +60,13 @@
 	mv debian/mafft/usr/bin/mafft-homologs.rb debian/mafft/usr/bin/mafft-homologs

 binary-indep: build install
-
 binary-arch: build install
 	dh_testdir
 	dh_testroot
 	dh_installchangelogs
 	dh_installdocs
 	dh_install test usr/share/doc/mafft/
-	dh_installman mafft.1 mafft-homologs.1
+	dh_installman debian/mafft.1 debian/mafft-homologs.1
 	dh_link
 	dh_strip
 	dh_compress
diff -u mafft-6.240/debian/changelog mafft-6.240/debian/changelog
--- mafft-6.240/debian/changelog
+++ mafft-6.240/debian/changelog
@@ -1,3 +1,34 @@
+mafft (6.240-2) unstable; urgency=high
+
+  [ Charles Plessy ]
+  * debian/control:
+    - Moved the Homepage: field out from the package's description.
+    - Enhances: t-coffee.
+  * Updated my email address.
+  * Securisation of the temorary files of mafft-homologs:
+    - debian/control: build-depend on quilt.
+    - debian/rules: modified to use quilt.
+    - debian/README.source: signals that the package uses quilt.
+    - debian/patches: added a patch to use non-guessable temporary files
+      (Closes: #[496366](bugreport.cgi?bug=496366)). Thanks to Dmitry E. Oboukhov for finding the bug,
+      Thijs Kinkhorst for preliminary patch and Kazutaka Katoh for the
+      final implementation.
+    - debian/mafft-homologs.1*, debian/README.Debian: document that the
+      program is patched.
+
+  [ David Paleino ]
+  * debian/mafft.1, debian/mafft-homologs.1 added - manpages built statically.
+  * debian/control:
+    - B-D updated (see above)
+    - added myself to Uploaders
+    - moved XS-Vcs-* fields to Vcs-*
+    - Updated to Standards-Version 3.7.3 (no changes needed)
+  * debian/rules:
+    - reflecting static build of manpages
+    - minor changes
+
+ -- Charles Plessy <plessy@debian.org>  Mon, 25 Aug 2008 23:30:20 +0900
+
 mafft (6.240-1) unstable; urgency=low

   * Initial release (Closes: #[409640](bugreport.cgi?bug=409640))
only in patch2:
unchanged:
--- mafft-6.240.orig/debian/mafft.1
+++ mafft-6.240/debian/mafft.1
@@ -0,0 +1,370 @@
+.\"     Title: MAFFT
+.\"    Author: Kazutaka Katoh <katoh_at_bioreg.kyushu-u.ac.jp.>
+.\" Generator: DocBook XSL Stylesheets v1.73.2 <<http://docbook.sf.net/>>
+.\"      Date: 2008-09-01
+.\"    Manual: Mafft Manual
+.\"    Source: mafft 6.240
+.\"
+.TH "MAFFT" "1" "2008\-09\-01" "mafft 6.240" "Mafft Manual"
+.\" disable hyphenation
+.nh
+.\" disable justification (adjust text to left margin only)
+.ad l
+.SH "NAME"
+mafft \- Multiple alignment program for amino acid or nucleotide sequences
+.SH "SYNOPSIS"
+.HP 6
+\fBmafft\fR [\fBoptions\fR] \fIinput\fR [>\ \fIoutput\fR]
+.HP 6
+\fBlinsi\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 6
+\fBginsi\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 6
+\fBeinsi\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 7
+\fBfftnsi\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 6
+\fBfftns\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 14
+\fBmafft\-profile\fR \fIgroup1\fR \fIgroup2\fR [>\ \fIoutput\fR]
+.SH "DESCRIPTION"
+.PP
+\fBMAFFT\fR
+is a multiple sequence alignment program for unix\-like operating systems\&. It offers a range of multiple alignment methods\&.
+.SS "Accuracy\-oriented methods:"
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'L\-INS\-i (probably most accurate; recommended for <200 sequences; iterative refinement method incorporating local pairwise alignment information):
+.HP 6
+\fBmafft\fR \fB\-\-localpair\fR \fB\-\-maxiterate\fR\ \fI1000\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 6
+\fBlinsi\fR \fIinput\fR [>\ \fIoutput\fR]
+.RE
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'G\-INS\-i (suitable for sequences of similar lengths; recommended for <200 sequences; iterative refinement method incorporating global pairwise alignment information):
+.HP 6
+\fBmafft\fR \fB\-\-globalpair\fR \fB\-\-maxiterate\fR\ \fI1000\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 6
+\fBginsi\fR \fIinput\fR [>\ \fIoutput\fR]
+.RE
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'E\-INS\-i (suitable for sequences containing large unalignable regions; recommended for <200 sequences):
+.HP 6
+\fBmafft\fR \fB\-\-ep\fR\ \fI0\fR \fB\-\-genafpair\fR \fB\-\-maxiterate\fR\ \fI1000\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 6
+\fBeinsi\fR \fIinput\fR [>\ \fIoutput\fR]
+.br
+
+For E\-INS\-i, the
+\fB\-\-ep\fR
+\fI0\fR
+option is recommended to allow large gaps\&.
+.RE
+.SS "Speed\-oriented methods:"
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'FFT\-NS\-i (iterative refinement method; two cycles only):
+.HP 6
+\fBmafft\fR \fB\-\-retree\fR\ \fI2\fR \fB\-\-maxiterate\fR\ \fI2\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 7
+\fBfftnsi\fR \fIinput\fR [>\ \fIoutput\fR]
+.RE
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'FFT\-NS\-i (iterative refinement method; max\&. 1000 iterations):
+.HP 6
+\fBmafft\fR \fB\-\-retree\fR\ \fI2\fR \fB\-\-maxiterate\fR\ \fI1000\fR \fIinput\fR [>\ \fIoutput\fR]
+.RE
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'FFT\-NS\-2 (fast; progressive method):
+.HP 6
+\fBmafft\fR \fB\-\-retree\fR\ \fI2\fR \fB\-\-maxiterate\fR\ \fI0\fR \fIinput\fR [>\ \fIoutput\fR]
+.HP 6
+\fBfftns\fR \fIinput\fR [>\ \fIoutput\fR]
+.RE
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'FFT\-NS\-1 (very fast; recommended for >2000 sequences; progressive method with a rough guide tree):
+.HP 6
+\fBmafft\fR \fB\-\-retree\fR\ \fI1\fR \fB\-\-maxiterate\fR\ \fI0\fR \fIinput\fR [>\ \fIoutput\fR]
+.RE
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'NW\-NS\-PartTree\-1 (recommended for ?50,000 sequences; progressive method with the PartTree algorithm):
+.HP 6
+\fBmafft\fR \fB\-\-retree\fR\ \fI1\fR \fB\-\-maxiterate\fR\ \fI0\fR \fB\-\-parttree\fR \fIinput\fR [>\ \fIoutput\fR]
+.RE
+.SS "Group\-to\-group alignments"
+.HP 14
+\fBmafft\-profile\fR \fIgroup1\fR \fIgroup2\fR [>\ \fIoutput\fR]
+.PP
+or:
+.HP 6
+\fBmafft\fR \fB\-\-maxiterate\fR\ \fI1000\fR \fB\-\-seed\fR\ \fIgroup1\fR \fB\-\-seed\fR\ \fIgroup2\fR /dev/null [>\ \fIoutput\fR]
+.SH "OPTIONS"
+.PP
+\fB\-\-auto\fR
+.RS 4
+.RE
+.PP
+\fB\-\-clustalout\fR
+.RS 4
+.RE
+.PP
+\fB\-\-reorder\fR
+.RS 4
+.RE
+.PP
+\fB\-\-inputorder\fR
+.RS 4
+.RE
+.PP
+\fB\-\-algq\fR
+.RS 4
+.RE
+.PP
+\fB\-\-groupsize\fR
+.RS 4
+.RE
+.PP
+\fB\-\-partsize\fR
+.RS 4
+.RE
+.PP
+\fB\-\-parttree\fR
+.RS 4
+.RE
+.PP
+\fB\-\-dpparttree\fR
+.RS 4
+.RE
+.PP
+\fB\-\-fastaparttree\fR
+.RS 4
+.RE
+.PP
+\fB\-\-treeout\fR
+.RS 4
+.RE
+.PP
+\fB\-\-fastswpair\fR
+.RS 4
+.RE
+.PP
+\fB\-\-fastapair\fR
+.RS 4
+.RE
+.PP
+\fB\-\-noscore\fR
+.RS 4
+.RE
+.PP
+\fB\-\-6merpair\fR
+.RS 4
+.RE
+.PP
+\fB\-\-blastpair\fR
+.RS 4
+.RE
+.PP
+\fB\-\-globalpair\fR
+.RS 4
+.RE
+.PP
+\fB\-\-localpair\fR
+.RS 4
+.RE
+.PP
+\fB\-\-genafpair\fR
+.RS 4
+.RE
+.PP
+\fB\-\-memsave\fR
+.RS 4
+.RE
+.PP
+\fB\-\-nuc\fR
+.RS 4
+.RE
+.PP
+\fB\-\-amino\fR
+.RS 4
+.RE
+.PP
+\fB\-\-fft\fR
+.RS 4
+.RE
+.PP
+\fB\-\-nofft\fR
+.RS 4
+.RE
+.PP
+\fB\-\-quiet\fR
+.RS 4
+.RE
+.PP
+\fB\-\-coreext\fR
+.RS 4
+.RE
+.PP
+\fB\-\-core\fR
+.RS 4
+.RE
+.PP
+\fB\-\-maxiterate\fR
+.RS 4
+.RE
+.PP
+\fB\-\-retree\fR
+.RS 4
+.RE
+.PP
+\fB\-\-aamatrix\fR
+.RS 4
+.RE
+.PP
+\fB\-\-fmodel\fR
+.RS 4
+.RE
+.PP
+\fB\-\-jtt\fR
+.RS 4
+.RE
+.PP
+\fB\-\-tm\fR
+.RS 4
+.RE
+.PP
+\fB\-\-bl\fR
+.RS 4
+.RE
+.PP
+\fB\-\-weighti\fR
+.RS 4
+.RE
+.PP
+\fB\-\-op\fR
+.RS 4
+.RE
+.PP
+\fB\-\-ep\fR
+.RS 4
+.RE
+.PP
+\fB\-\-lop\fR
+.RS 4
+.RE
+.PP
+\fB\-\-LOP\fR
+.RS 4
+.RE
+.PP
+\fB\-\-lep\fR
+.RS 4
+.RE
+.PP
+\fB\-\-lexp\fR
+.RS 4
+.RE
+.PP
+\fB\-\-LEXP\fR
+.RS 4
+.RE
+.PP
+\fB\-\-corethr\fR
+.RS 4
+.RE
+.PP
+\fB\-\-corewin\fR
+.RS 4
+.RE
+.PP
+\fB\-\-seed\fR
+.RS 4
+.RE
+.SH "FILES"
+.PP
+Mafft stores the input sequences and other files in a temporary directory, which by default is located in
+\fI/tmp\fR\&.
+.SH "ENVIONMENT"
+.PP
+\fBMAFFT_BINARIES\fR
+.RS 4
+Indicates the location of the binary files used by mafft\&. By default, they are searched in
+\fI/usr/local/lib/mafft\fR, but on Debian systems, they are searched in
+\fI/usr/lib/mafft\fR\&.
+.RE
+.PP
+\fBFASTA_4_MAFFT\fR
+.RS 4
+This variable can be set to indicate to mafft the location to the fasta34 program if it is not in the PATH\&.
+.RE
+.SH "SEE ALSO"
+.PP
+
+\fBmafft-homologs\fR(1)
+.SH "REFERENCES"
+.SS "In English"
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'Katoh and Toh (Bioinformatics 23:372\-374, 2007) PartTree: an algorithm to build an approximate tree from a large number of unaligned sequences (describes the PartTree algorithm)\&.
+.RE
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'Katoh, Kuma, Toh and Miyata (Nucleic Acids Res\&. 33:511\-518, 2005) MAFFT version 5: improvement in accuracy of multiple sequence alignment (describes [ancestral versions of] the G\-INS\-i, L\-INS\-i and E\-INS\-i strategies)
+.RE
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'Katoh, Misawa, Kuma and Miyata (Nucleic Acids Res\&. 30:3059\-3066, 2002) MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform (describes the FFT\-NS\-1, FFT\-NS\-2 and FFT\-NS\-i strategies)
+.RE
+.SS "In Japanese"
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'Katoh and Misawa (???? 46:312\-317, 2006) Multiple Sequence Alignments: the Next Generation
+.RE
+.sp
+.RS 4
+\h'-04'\(bu\h'+03'Katoh and Kuma (????? 44:102\-108, 2006) Jissen\-teki Multiple Alignment
+.RE
+.SH "DIVERGENCE FROM UPSTREAM"
+.PP
+\fBmafft\-homologs\fR
+has been patched to enhance the security of the temporary files it creates\&. You can consult the patch in the Debian source package\&. It has been reviewed and amended by Kazutaka Katoh, the upstream author of MAFFT\&.
+.SH "AUTHORS"
+.PP
+\fBKazutaka Katoh\fR <\&katoh_at_bioreg\&.kyushu\-u\&.ac\&.jp\&.\&>
+.sp -1n
+.IP "" 4
+Wrote Mafft\&.
+.PP
+\fBCharles Plessy\fR <\&charles\-debian\-nospam@plessy\&.org\&>
+.sp -1n
+.IP "" 4
+Wrote this manpage in DocBook XML for the Debian distribution, using Mafft\'s homepage as a template\&.
+.SH "COPYRIGHT"
+Copyright \(co 2002, 2003, 2004, 2005, 2006, 2007 Kazutaka Katoh (mafft)
+.br
+Copyright \(co 2007 Charles Plessy (this manpage)
+.br
+.PP
+Mafft and its manpage are offered under the following conditions:
+.PP
+Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
+.sp
+.RS 4
+\h'-04' 1.\h'+02'Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer\&.
+.RE
+.sp
+.RS 4
+\h'-04' 2.\h'+02'Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution\&.
+.RE
+.sp
+.RS 4
+\h'-04' 3.\h'+02'The name of the author may not be used to endorse or promote products derived from this software without specific prior written permission\&.
+.RE
+.PP
+THIS SOFTWARE IS PROVIDED BY THE AUTHOR "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED\&. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE\&.
+.sp
only in patch2:
unchanged:
--- mafft-6.240.orig/debian/README.source
+++ mafft-6.240/debian/README.source
@@ -0,0 +1,8 @@
+This package uses quilt to patch the sources. Please refer to
+/usr/share/doc/quilt/README.source for more informations.
+
+This package is maintained by the Debian Med packagign team. Please refer to
+our group policy if you would like to commit to our Subversion repository. All
+Debian developpers have write acces to it.
+
+<http://debian-med.alioth.debian.org/docs/policy.html>
only in patch2:
unchanged:
--- mafft-6.240.orig/debian/mafft-homologs.1
+++ mafft-6.240/debian/mafft-homologs.1
@@ -0,0 +1,112 @@
+.\"     Title: MAFFT-HOMOLOGS
+.\"    Author: Kazutaka Katoh <katoh_at_bioreg.kyushu-u.ac.jp.>
+.\" Generator: DocBook XSL Stylesheets v1.73.2 <<http://docbook.sf.net/>>
+.\"      Date: 2008-09-01
+.\"    Manual: Mafft Manual
+.\"    Source: mafft-homologs 2.1
+.\"
+.TH "MAFFT\-HOMOLOGS" "1" "2008\-09\-01" "mafft-homologs 2.1" "Mafft Manual"
+.\" disable hyphenation
+.nh
+.\" disable justification (adjust text to left margin only)
+.ad l
+.SH "NAME"
+mafft-homologs \- aligns sequences together with homologues automatically collected from SwissProt via NCBI BLAST
+.SH "SYNOPSIS"
+.HP 15
+\fBmafft\-homologs\fR [\fBoptions\fR] \fIinput\fR [>\ \fIoutput\fR]
+.SH "DESCRIPTION"
+.PP
+The accuracy of an alignment of a few distantly related sequences is considerably improved when being aligned together with their close homologs\&. The reason for the improvement is probably the same as that for PSI\-BLAST\&. That is, the positions of highly conserved residues, those with many gaps and other additional information is brought by close homologs\&. According to Katoh et al\&. (2005), the improvement by adding close homologs is 10% or so, which is comparable to the improvement by incorporating structural information of a pair of sequences\&. Mafft\-homologs in a mafft server works like this:
+.sp
+.RS 4
+\h'-04' 1.\h'+02'Collect a number (50 by default) of close homologs (E=1e\-10 by default) of the input sequences\&.
+.RE
+.sp
+.RS 4
+\h'-04' 2.\h'+02'Align the input sequences and homologs all together using the L\-INS\-i strategy\&.
+.RE
+.sp
+.RS 4
+\h'-04' 3.\h'+02'Remove the homologs\&.
+.RE
+.SH "OPTIONS"
+.PP
+\fB\-a\fR \fI\fIn\fR\fR
+.RS 4
+The number of collected sequences (default: 50)\&.
+.RE
+.PP
+\fB\-e\fR \fI\fIn\fR\fR
+.RS 4
+Threshold value (default: 1e\-10)\&.
+.RE
+.PP
+\fB\-o\fR \fI\fIxxx\fR\fR
+.RS 4
+options for mafft (default: " \-\-op 1\&.53 \-\-ep 0\&.123 \-\-maxiterate 1000")\&.
+.RE
+.PP
+\fB\-l\fR
+.RS 4
+Locally carries out blast searches instead of NCBI blast (requires locally installed blast and a database)\&.
+.RE
+.PP
+\fB\-f\fR
+.RS 4
+Outputs collected homologues also (default: off)\&.
+.RE
+.PP
+\fB\-w\fR
+.RS 4
+entire sequences are subjected to BLAST search (default: well\-aligned region only)
+.RE
+.SH "REQUIREMENTS"
+.PP
+Mafft\-homologs requires a version of mafft higher than 5\&.58\&.
+.SH "REFERENCES"
+.PP
+Katoh, Kuma, Toh and Miyata (Nucleic Acids Res\&. 33:511\-518, 2005) MAFFT version 5: improvement in accuracy of multiple sequence alignment\&.
+.SH "SEE ALSO"
+.PP
+
+\fBmafft\fR(1)
+.SH "DIVERGENCE FROM UPSTREAM"
+.PP
+\fBmafft\-homologs\fR
+has been patched to enhance the security of the temporary files it creates\&. You can consult the patch in the Debian source package\&. It has been reviewed and amended by Kazutaka Katoh, the upstream author of MAFFT\&.
+.SH "AUTHORS"
+.PP
+\fBKazutaka Katoh\fR <\&katoh_at_bioreg\&.kyushu\-u\&.ac\&.jp\&.\&>
+.sp -1n
+.IP "" 4
+Wrote Mafft\&.
+.PP
+\fBCharles Plessy\fR <\&charles\-debian\-nospam@plessy\&.org\&>
+.sp -1n
+.IP "" 4
+Wrote this manpage in DocBook XML for the Debian distribution, using Mafft\'s homepage as a template\&.
+.SH "COPYRIGHT"
+Copyright \(co 2002, 2003, 2004, 2005, 2006, 2007 Kazutaka Katoh (mafft)
+.br
+Copyright \(co 2007 Charles Plessy (this manpage)
+.br
+.PP
+Mafft and its manpage are offered under the following conditions:
+.PP
+Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
+.sp
+.RS 4
+\h'-04' 1.\h'+02'Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer\&.
+.RE
+.sp
+.RS 4
+\h'-04' 2.\h'+02'Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution\&.
+.RE
+.sp
+.RS 4
+\h'-04' 3.\h'+02'The name of the author may not be used to endorse or promote products derived from this software without specific prior written permission\&.
+.RE
+.PP
+THIS SOFTWARE IS PROVIDED BY THE AUTHOR "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED\&. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE\&.
+.sp
only in patch2:
unchanged:
--- mafft-6.240.orig/debian/patches/Securisation-by-mktemp-usage.patch
+++ mafft-6.240/debian/patches/Securisation-by-mktemp-usage.patch
@@ -0,0 +1,211 @@
+Author: Kazutaka Katoh and Charles Plessy, with the kind help of Thijs Kinkhorst.
+Description: Securisation of the temporary files of mafft-homologs.
+ Mafft-homologs uses predictable names for its temporary files. This patch
+ replaces the pid-based file names by names constructed with the `mktemp'
+ program.
+ .
+ Quoting its manual page:
+ mktemp is a program to allow shell scripts to safely use temporary files.
+ Traditionally, many shell scripts take the name of the program with the PID
+ as a suffix and use that as a temporary filename.  This kind of naming scheme
+ is predictable and  the race condition  it  creates is  easy for an attacker
+ to win.  A safer, though still inferior approach is to make a temporary
+ directory using the same naming scheme.  While this does allow one to
+ guarantee that a temporary file will not  be  subverted, it still allows a
+ simple denial of service attack.  For these reasons it is suggested that
+ mktemp be used instead.
+Forwarded: Kazutaka Katoh <katoh@bioreg.kyushu-u.ac.jp>
+Reviewed: Kazutaka Katoh
+License: same as MAFFT itself.
+
+Index: mafft-6.240/src/mafft-homologs.tmpl
+===================================================================
+--- mafft-6.240.orig/src/mafft-homologs.tmpl
++++ mafft-6.240/src/mafft-homologs.tmpl
+@@ -31,11 +31,22 @@
+ #   -w        entire sequences are subjected to BLAST search
+ #             (default: well-aligned region only)
+
+-
+ require 'getopts'
++require 'tempfile'
++
++# mktemp
++temp_vf = Tempfile.new("_vf").path
++temp_if = Tempfile.new("_if").path
++temp_pf = Tempfile.new("_pf").path
++temp_af = Tempfile.new("_af").path
++temp_qf = Tempfile.new("_qf").path
++temp_bf = Tempfile.new("_bf").path
++temp_rid = Tempfile.new("_rid").path
++temp_res = Tempfile.new("_res").path
+
+-system( mafftpath + " --help > /tmp/_vf#{$$} 2>&1" )
+-pfp = File.open( "/tmp/_vf#{$$}", 'r' )
++
++system( mafftpath + " --help > #{temp_vf} 2>&1" )
++pfp = File.open( "#{temp_vf}", 'r' )
+ while pfp.gets
+ 	break if $_ =~ /MAFFT v/
+ end
+@@ -114,35 +125,38 @@
+ 	mafftopt += " " + $OPT_o + " "
+ end
+
+-system "cat " + ARGV.to_s + " > /tmp/_if#{$$}"
++system "cat " + ARGV.to_s + " > #{temp_if}"
+ ar = mafftopt.split(" ")
+ nar = ar.length
+ for i in 0..(nar-1)
+ 	if ar[i] == "--seed" then
+-		system "cat #{ar[i+1]} >> /tmp/_if#{$$}"
++		system "cat #{ar[i+1]} >> #{temp_if}"
+ 	end
+ end
+
+ nseq = 0
+-ifp = File.open( "/tmp/_if#{$$}", 'r' )
++ifp = File.open( "#{temp_if}", 'r' )
+ 	while ifp.gets
+ 		nseq += 1 if $_ =~ /^>/
+ 	end
+ ifp.close
+
+-STDERR.puts "Performing preliminary alignment .. "
+-if nseq == 1 then
+-	system( "cp /tmp/_if#{$$}"  + " /tmp/_pf#{$$}" )
++if nseq >= 100 then
++	STDERR.puts "The number of input sequences must be <100."
++	exit
++elsif nseq == 1 then
++	system( "cp #{temp_if}"  + " #{temp_pf}" )
+ else
++	STDERR.puts "Performing preliminary alignment .. "
+ 	if entiresearch == 1 then
+-#		system( mafftpath + " --maxiterate 1000 --localpair /tmp/_if#{$$} > /tmp/_pf#{$$}" )
+-		system( mafftpath + " --maxiterate 0 --retree 2 /tmp/_if#{$$} > /tmp/_pf#{$$}" )
++#		system( mafftpath + " --maxiterate 1000 --localpair #{temp_if} > #{temp_pf}" )
++		system( mafftpath + " --maxiterate 0 --retree 2 #{temp_if} > #{temp_pf}" )
+ 	else
+-		system( mafftpath + " --maxiterate 1000 --localpair --core --coreext --corethr #{corethr.to_s} --corewin #{corewin.to_s} /tmp/_if#{$$} > /tmp/_pf#{$$}" )
++		system( mafftpath + " --maxiterate 1000 --localpair --core --coreext --corethr #{corethr.to_s} --corewin #{corewin.to_s} #{temp_if} > #{temp_pf}" )
+ 	end
+ end
+
+-pfp = File.open( "/tmp/_pf#{$$}", 'r' )
++pfp = File.open( "#{temp_pf}", 'r' )
+ inname = []
+ inseq = []
+ slen = []
+@@ -155,7 +169,7 @@
+ end
+ pfp.close
+
+-pfp = File.open( "/tmp/_if#{$$}", 'r' )
++pfp = File.open( "#{temp_if}", 'r' )
+ orname = []
+ orseq = []
+ nin = 0
+@@ -188,7 +202,7 @@
+ #p act
+
+
+-afp = File.open( "/tmp/_af#{$$}", 'w' )
++afp = File.open( "#{temp_af}", 'w' )
+
+ STDERR.puts "Searching .. \n"
+ ids = []
+@@ -209,10 +223,10 @@
+ 	end
+
+ 	if local == 0 then
+-		command = "lynx -source '<http://www.ncbi.nlm.nih.gov/blast/Blast.cgi?QUERY=>" + inseq[i] + "&DATABASE=swissprot&HITLIST_SIZE=" + nadd.to_s + "&FILTER=L&EXPECT='" + eval.to_s + "'&FORMAT_TYPE=TEXT&PROGRAM=blastp&SERVICE=plain&NCBI_GI=on&PAGE=Proteins&CMD=Put' > /tmp/_rid#{$$}"
++		command = "lynx -source '<http://www.ncbi.nlm.nih.gov/blast/Blast.cgi?QUERY=>" + inseq[i] + "&DATABASE=swissprot&HITLIST_SIZE=" + nadd.to_s + "&FILTER=L&EXPECT='" + eval.to_s + "'&FORMAT_TYPE=TEXT&PROGRAM=blastp&SERVICE=plain&NCBI_GI=on&PAGE=Proteins&CMD=Put' > #{temp_rid}"
+ 		system command
+
+-		ridp = File.open( "/tmp/_rid#{$$}", 'r' )
++		ridp = File.open( "#{temp_rid}", 'r' )
+ 		while ridp.gets
+ 			break if $_ =~ / RID = (.*)/
+ 		end
+@@ -224,9 +238,9 @@
+ 		while 1
+ 			STDERR.printf "."
+ 			sleep 10
+-			command = "lynx -source '<http://www.ncbi.nlm.nih.gov/blast/Blast.cgi?RID=>" + rid + "&DESCRIPTIONS=500&ALIGNMENTS=" + nadd.to_s + "&ALIGNMENT_TYPE=Pairwise&OVERVIEW=no&CMD=Get&FORMAT_TYPE=XML' > /tmp/_res#{$$}"
++			command = "lynx -source '<http://www.ncbi.nlm.nih.gov/blast/Blast.cgi?RID=>" + rid + "&DESCRIPTIONS=500&ALIGNMENTS=" + nadd.to_s + "&ALIGNMENT_TYPE=Pairwise&OVERVIEW=no&CMD=Get&FORMAT_TYPE=XML' > #{temp_res}"
+ 			system command
+-			resp = File.open( "/tmp/_res#{$$}", 'r' )
++			resp = File.open( "#{temp_res}", 'r' )
+ #			resp.gets
+ #			if $_ =~ /WAITING/ then
+ #				resp.close
+@@ -247,17 +261,17 @@
+ 	else
+ #		puts "Not supported"
+ #		exit
+-		qfp = File.open( "/tmp/_q#{$$}", 'w' )
++		qfp = File.open( "#{temp_qf}", 'w' )
+ 			qfp.puts "> "
+ 			qfp.puts inseq[i]
+ 		qfp.close
+-		command = blastpath + "  -p blastp  -e #{eval} -b 1000 -m 7 -i /tmp/_q#{$$} -d #{localdb} > /tmp/_res#{$$}"
++		command = blastpath + "  -p blastp  -e #{eval} -b 1000 -m 7 -i #{temp_qf} -d #{localdb} > #{temp_res}"
+ 		system command
+-		resp = File.open( "/tmp/_res#{$$}", 'r' )
++		resp = File.open( "#{temp_res}", 'r' )
+ 	end
+ 	STDERR.puts " Done.\n\n"
+
+-	resp = File.open( "/tmp/_res#{$$}", 'r' )
++	resp = File.open( "#{temp_res}", 'r' )
+ 	while 1
+ 		while resp.gets
+ 			break if $_ =~ /<Hit_id>(.*)<\/Hit_id>/ || $_ =~ /(<Iteration_stat>)/
+@@ -310,17 +324,15 @@
+ afp.close
+
+ STDERR.puts "Performing alignment .. "
+-system( mafftpath + mafftopt + " /tmp/_af#{$$} > /tmp/_bf#{$$}" )
++system( mafftpath + mafftopt + " #{temp_af} > #{temp_bf}" )
+ STDERR.puts "done."
+
+-bfp = File.open( "/tmp/_bf#{$$}", 'r' )
++bfp = File.open( "#{temp_bf}", 'r' )
+ outseq = []
+ outnam = []
+ readfasta( bfp, outnam, outseq )
+ bfp.close
+
+-
+-
+ outseq2 = []
+ outnam2 = []
+
+@@ -357,4 +369,5 @@
+ 	puts outseq2[i].gsub( /.{1,60}/, "\\0\n" )
+ end
+
+-system( "rm -rf /tmp/_if#{$$} /tmp/_vf#{$$} /tmp/_af#{$$} /tmp/_bf#{$$} /tmp/_pf#{$$} /tmp/_q#{$$} /tmp/_res#{$$} /tmp/_rid#{$$}" )
++
++#system( "rm -rf #{temp_if} #{temp_vf} #{temp_af} #{temp_bf} #{temp_pf} #{temp_qf} #{temp_res} #{temp_rid}" )
+Index: mafft-6.240/src/mafft.tmpl
+===================================================================
+--- mafft-6.240.orig/src/mafft.tmpl
++++ mafft-6.240/src/mafft.tmpl
+@@ -240,11 +240,11 @@
+ 		shift
+ 	done;
+
+-#	TMPFILE=/tmp/`basename $0`.`whoami`.$$.`date +%y%m%d%H%M%S`
+-	TMPFILE=/tmp/$progname.$$
++#	TMPFILE=/tmp/$progname.$$
++	TMPFILE=`mktemp -dt $progname.XXXXXXXXXX`
+ 	umask 077
+-	mkdir  $TMPFILE  || er=1
+-	trap "rm -r $TMPFILE " 0
++#	mkdir  $TMPFILE  || er=1
++	trap "rm -rf $TMPFILE " 0
+ 	if [ $# -eq 1 ]; then
+ 		if [ -r "$1" -o "$1" = - ]; then
+ 			cat "$1" | tr "\r" "\n" > $TMPFILE/infile
only in patch2:
unchanged:
--- mafft-6.240.orig/debian/patches/series
+++ mafft-6.240/debian/patches/series
@@ -0,0 +1 @@
+Securisation-by-mktemp-usage.patch

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`:

`Bug#496366`; Package `mafft`.
([full text](bugreport.cgi?bug=496366;msg=51), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=51), [link](#50)).

---

**Acknowledgement sent** to `Luk Claes <luk@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=496366;msg=53), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=53), [link](#52)).

---

[Message #54](#54) received at 496366@bugs.debian.org ([full text](bugreport.cgi?bug=496366;msg=54), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=54), reply):

![](/cgi-bin/libravatar.cgi?email=luk%40debian.org)
From: Luk Claes <luk@debian.org>
To: Charles Plessy <plessy@debian.org>
Cc: debian-release@lists.debian.org, 496366@bugs.debian.org
Subject: Re: Preparing update of 'mafft' to fix #496366 ("grave" security
bug).
Date: Thu, 04 Sep 2008 07:36:18 +0200
```
Charles Plessy wrote:
> Le Mon, Aug 25, 2008 at 10:17:02PM -0700, Steve Langasek a écrit :
>> On Tue, Aug 26, 2008 at 01:40:01PM +0900, Charles Plessy wrote:
>>
>>> Would you accept this package in Lenny to fix #496366?
>> If the diff is in line with this description, yes.
>
> Hi Steve, hi all,
>
> thank you for your patience. I have been in contact with Upstream who
> reviewd kindly finished the patching work (I did not manage to produce a
> working patch for the Ruby file).

> I added a paragraph about the patch to the manpages, but as the sources are in
> XML and the stylesheets evolved, the diff is big. All the changes unrelated to
> the bug are documented in the changelog, except the addition of
> DM-Upload-Allowed: yes, that is systematic in our packages anyway, and cosmetic
> improvements of the description. The patch itself now affects another file in
> which a similar security problem was uncovered by Upstream. Here is the full
> debdiff.

Please upload.

Cheers

Luk

```

---

**Reply sent** to `Charles Plessy <plessy@debian.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=496366;msg=56), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=56), [link](#55)).

---

**Notification sent** to `"Dmitry E. Oboukhov" <dimka@uvw.ru>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=496366;msg=58), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=58), [link](#57)).

---

[Message #59](#59) received at 496366-close@bugs.debian.org ([full text](bugreport.cgi?bug=496366;msg=59), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=59), reply):

![](/cgi-bin/libravatar.cgi?email=plessy%40debian.org)
From: Charles Plessy <plessy@debian.org>
To: 496366-close@bugs.debian.org
Subject: Bug#496366: fixed in mafft 6.240-2
Date: Thu, 04 Sep 2008 14:32:05 +0000
```
Source: mafft
Source-Version: 6.240-2

We believe that the bug you reported is fixed in the latest version of
mafft, which is due to be installed in the Debian FTP archive:

mafft_6.240-2.diff.gz
  to pool/main/m/mafft/mafft_6.240-2.diff.gz
mafft_6.240-2.dsc
  to pool/main/m/mafft/mafft_6.240-2.dsc
mafft_6.240-2_amd64.deb
  to pool/main/m/mafft/mafft_6.240-2_amd64.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 496366@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Charles Plessy <plessy@debian.org> (supplier of updated mafft package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Mon, 25 Aug 2008 23:30:20 +0900
Source: mafft
Binary: mafft
Architecture: source amd64
Version: 6.240-2
Distribution: unstable
Urgency: high
Maintainer: Debian-Med Packaging Team <debian-med-packaging@lists.alioth.debian.org>
Changed-By: Charles Plessy <plessy@debian.org>
Description:
 mafft      - Multiple alignment program for amino acid or nucleotide sequences
Closes: [496366](bugreport.cgi?bug=496366)
Changes:
 mafft (6.240-2) unstable; urgency=high
 .
   [ Charles Plessy ]
   * debian/control:
     - Moved the Homepage: field out from the package's description.
     - Enhances: t-coffee.
   * Updated my email address.
   * Securisation of the temorary files of mafft-homologs:
     - debian/control: build-depend on quilt.
     - debian/rules: modified to use quilt.
     - debian/README.source: signals that the package uses quilt.
     - debian/patches: added a patch to use non-guessable temporary files
       (Closes: #[496366](bugreport.cgi?bug=496366)). Thanks to Dmitry E. Oboukhov for finding the bug, Thijs
       Kinkhorst for preliminary, Kazutaka Katoh for the final implementation,
       and Michael Schutte for the final review.
     - debian/mafft-homologs.1*, debian/README.Debian: document that the
       program is patched.
 .
   [ David Paleino ]
   * debian/mafft.1, debian/mafft-homologs.1 added - manpages built statically.
   * debian/control:
     - B-D updated (see above)
     - added myself to Uploaders
     - moved XS-Vcs-* fields to Vcs-*
     - Updated to Standards-Version 3.7.3 (no changes needed)
   * debian/rules:
     - reflecting static build of manpages
     - minor changes
Checksums-Sha1:
 10910d283ebe60abd4daa0c23c7176080d92ab66 1301 mafft_6.240-2.dsc
 d005a67f688b17c4f9712477ead2fe73b261ed93 11463 mafft_6.240-2.diff.gz
 dfbbc28ff23a84ac8cf1db185b521eb4809a0446 2141648 mafft_6.240-2_amd64.deb
Checksums-Sha256:
 51fec526aff16ae73c61af5faa21525bf40162fd6558efa4cc308a0040dff79c 1301 mafft_6.240-2.dsc
 5382de083844691b00f64263d49f7465110456d5a069a2dd71b2dfb35d89b7c6 11463 mafft_6.240-2.diff.gz
 6f02cf7128018b671b7f36d45a664e0c75751432610179c2ffa2873224f42911 2141648 mafft_6.240-2_amd64.deb
Files:
 986bd9ca1a5ab63ef4abc1b726cb3854 1301 science optional mafft_6.240-2.dsc
 0c0dd3e97b085852d1cbb6e2168f9d24 11463 science optional mafft_6.240-2.diff.gz
 ebe53fee218af9a465acc3fdfec39f09 2141648 science optional mafft_6.240-2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAki/7XoACgkQdYl1krr+x/K3OQCfc4PvpEL3AHYMPJOBne9+z/31
U0MAn1T01fdzF4HA/sN86jnFyq/FEm6h
=pVmN
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 07 Oct 2008 07:30:56 GMT) ([full text](bugreport.cgi?bug=496366;msg=61), [mbox](bugreport.cgi?bug=496366;mbox=yes;msg=61), [link](#60)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=496366).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 07:22:47 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


