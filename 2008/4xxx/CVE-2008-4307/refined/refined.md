```
{
  "CVE-2008-4307": {
    "Root cause": "A race condition exists in the do_setlk function within the Linux kernel's Network File System (NFS) implementation. When a signal interrupts a lock request, a local POSIX lock might be incorrectly created.",
    "Weaknesses": [
      "Race condition between fcntl and close operations on the same file descriptor",
      "Incomplete or incorrect cleanup of POSIX locks when a signal interrupts a lock request",
        "Improper handling of interrupted system calls when acquiring file locks.",
        "Lack of synchronization primitives when creating POSIX locks"
    ],
    "Impact": "A local, unprivileged user could trigger a kernel panic (BUG()) leading to a denial of service on systems with NFS mounts.",
    "Attack vectors": [
        "Local exploitation via multi-threaded process.",
        "Exploitation through crafted programs using `fcntl` for POSIX locking and `close` calls.",
        "Triggering the race condition requires concurrent operations (lock and close) within the same process."
    ],
     "Required attacker capabilities/position": "Local unprivileged user with the ability to execute code on the target system. An understanding of the Linux kernel's file locking mechanisms and ability to trigger a specific race condition would be needed to reliably exploit the vulnerability."
    ,
      "Additional Information": "The vulnerability also can cause performance issues in addition to the crash.  The race condition can leave an invalid lock, which can degrade performance by causing processes to wait longer when acquiring file locks on NFS filesystems. The issue is triggered within the locks_remove_flock function, when processing POSIX locks."
  }
}
```