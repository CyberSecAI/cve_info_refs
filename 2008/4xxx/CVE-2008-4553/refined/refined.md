```
Message-ID: <Pine.GSO.4.51.0810141449100.1682@faron.mitre.org>
Date: Tue, 14 Oct 2008 14:49:23 -0400 (EDT)
From: "Steven M. Christey" <coley@...us.mitre.org>
To: oss-security <oss-security@...ts.openwall.com>
cc: coley@...re.org
Subject: Re: CVE id request: qemu

On Mon, 13 Oct 2008, Steffen Joeris wrote:

> The qemu-make-debian-root script is prone to a symlink attack.
>
> Debian Bugreport:
> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=496394>

Use CVE-2008-4553, to be filled in later.

- Steve
```
- **Root cause of vulnerability:** The `qemu-make-debian-root` script creates temporary files insecurely.
- **Weaknesses/vulnerabilities present:** Insecure temporary file creation leading to symlink attack.
- **Impact of exploitation:** Local denial of service, potentially allowing an attacker to overwrite or destroy important system or user files.
- **Attack vectors:** A local attacker can create a symlink in `/tmp` with the same name as the temporary file the script is trying to create.
- **Required attacker capabilities/position:** The attacker must have local access to the system and be able to create symlinks in the `/tmp` directory.

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1657-1                  security@debian.org
<http://www.debian.org/security/>                               Steve Kemp
October 20, 2008                      <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : qemu
Vulnerability  : insecure temporary files
Problem type   : local
Debian-specific: no
CVE Id(s)      : CVE-2008-4553
Debian Bug     : 496394

Dmitry E. Oboukhov discovered that the qemu-make-debian-root script in qemu,
fast processor emulator, creates temporary files insecurely, which may lead
to a local denial of service through symlink attacks.
```
- **Root cause of vulnerability:**  The `qemu-make-debian-root` script creates temporary files insecurely.
- **Weaknesses/vulnerabilities present:** Insecure temporary file creation, leading to potential symlink attacks.
- **Impact of exploitation:** A local denial of service via symlink attacks.
- **Attack vectors:** A local user can exploit the insecure temporary file creation.
- **Required attacker capabilities/position:** The attacker needs local access to the system.

```
Package: qemu
Severity: grave

Hi, maintainer!

This message about the error concerns a few packages  at  once.   I've
tested all the packages (for Lenny) on my Debian mirror.  All  scripts
of packages (marked as executable) were tested.

In some packages I've discovered scripts with errors which may be used
by a user for damaging important system files or user's files.

For example if a script uses in its work a temp file which is  created
in /tmp directory, then every user can create symlink  with  the  same
name in this directory in order to  destroy  or  rewrite  some  system
or user file.  Symlink attack may also  lead  not  only  to  the  data
desctruction but to denial of service as well.
...
Binary-package: qemu (0.9.1-5)
    file: /usr/sbin/qemu-make-debian-root
```
- **Root cause of vulnerability:** The `qemu-make-debian-root` script creates temporary files insecurely in the `/tmp` directory.
- **Weaknesses/vulnerabilities present:** Insecure temporary file creation in `/tmp`, making it vulnerable to symlink attacks.
- **Impact of exploitation:** A local user can cause data destruction or denial of service by creating symlinks.
- **Attack vectors:**  A local user can create a symlink in the `/tmp` directory with the same name as the temporary file the script attempts to create.
- **Required attacker capabilities/position:** The attacker needs local access and the ability to create symlinks.