```
 Root cause of vulnerability: Insufficient HTML encoding in the optional fragment of a URL (after the # character) when storing and rendering the browsing history in Opera.
 Weaknesses/vulnerabilities present:
     - Stored Cross-Site Scripting (XSS) vulnerability due to lack of consistent HTML encoding for URLs stored in the history file (md.dat).
     - The browser does not properly encode the optional fragment (after #) of a URL in the history, allowing for script injection.
 Impact of exploitation:
     - Arbitrary JavaScript execution in the user's browser context when the History Search page is accessed.
     - Potential for malicious actions such as stealing cookies and redirecting the user to attacker-controlled sites (Cross-Site Request Forgery).
     - Exposure of user browsing history to the attacker.
 Attack vectors:
     - A user visits a malicious web page containing a link with a crafted URL. The malicious URL contains a script in its fragment part (after #)
     - The Opera browser stores the malicious URL in the history file.
     - When the user visits the opera:historysearch page, the stored malicious script is executed.
 Required attacker capabilities/position:
     - The attacker needs to lure the victim to visit a page containing a malicious link with a crafted URL.
```