```
{
  "vulnerability_details": {
    "root_cause": "The `get-maptools.sh` and `get_shapelib.sh` scripts in Xastir create temporary files in `/tmp` without proper safeguards, leading to a symlink vulnerability.",
    "weaknesses": [
      "Insecure use of temporary files",
      "Symlink vulnerability",
        "Race condition"
    ],
    "impact": "A malicious local user could create a symlink in `/tmp` with the same name as the temporary file used by the scripts. When the script runs, it would operate on the target of the symlink, potentially overwriting or modifying arbitrary files that the user would normally not have permissions to modify. This could lead to data corruption, system compromise, or denial of service.",
    "attack_vectors": [
      "Local Access"
    ],
    "required_capabilities": "The attacker needs local access to the system and the ability to create symlinks in `/tmp`."
  },
  "additional_details": {
    "affected_scripts": [
      "/usr/share/xastir/get-maptools.sh",
      "/usr/share/xastir/get_shapelib.sh"
    ],
      "vulnerable_code_snippets": [
      "get-maptools.sh:\n     168         printf \"Warning: /usr/local/lib not in %s - adding it\\n\" $LDCONF_FILE\n     169         if [ -f $LDCONF_FILE ]\n     170         then\n     171                 cp $LDCONF_FILE /tmp/ldconfig.tmp\n     172                 $SUDO cp $LDCONF_FILE $LDCONF_FILE.orig.$$\n     173         fi\n     174         printf \"/usr/local/lib\\n\" >> /tmp/ldconf.tmp\n     175         $SUDO cp /tmp/ldconf.tmp $LDCONF_FILE",
      "get_shapelib.sh:\n     141     if (! grep /usr/local/lib /etc/ld.so.conf 2>&1 > /dev/null)\n     142     then\n     143         printf \"Warning: /usr/local/lib not in /etc/ld.so.conf - adding it\\n\"\n     144         cp /etc/ld.so.conf /tmp\n     145         printf \"/usr/local/lib\\n\" >> /tmp/ld.so.conf\n     146         $SUDO cp /etc/ld.so.conf /etc/ld.so.conf.save\n     147         $SUDO cp /tmp/ld.so.conf /etc/ld.so.conf\n     148     fi"
    ],
    "affected_versions": "All versions of the xastir package shipped with Fedora releases 8, 9, and 10, and Debian xastir versions before 1.9.2-2.1.",
      "fix_details": "The vulnerability was addressed by using `mktemp -t` to create temporary files, ensuring that the files are created securely and preventing symlink attacks. In some cases the vulnerable scripts were removed completely as they were not required."
  }
}
```