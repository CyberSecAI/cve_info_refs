Based on the provided content, here's a breakdown of the vulnerability described in CVE-2008-4066:

**Root Cause of Vulnerability:**

*   The root cause is a flaw in the HTML parser within Mozilla products (Firefox, SeaMonkey, Thunderbird). The parser was found to ignore certain low surrogate characters when they were HTML-escaped.

**Weaknesses/Vulnerabilities Present:**

*   **Improper Input Handling:** The HTML parser was not correctly handling HTML-escaped low surrogate characters, effectively ignoring them during parsing.
*   **Cross-Site Scripting (XSS):**  This parsing flaw could be exploited to bypass naive script filters, opening the door for XSS attacks.

**Impact of Exploitation:**

*   **Cross-Site Scripting (XSS):** Successful exploitation allows an attacker to inject and execute arbitrary scripts within the context of the user's browser. This can lead to various malicious outcomes like session hijacking, defacement, or redirection to malicious sites.

**Attack Vectors:**

*   **Malicious Web Pages:** An attacker could create a specially crafted web page with HTML-escaped low surrogate characters in a JavaScript context, for example within a URI (like a javascript: link)
*   **User Interaction:** The user has to be tricked into loading this malicious page.

**Required Attacker Capabilities/Position:**

*   **External Attacker:** An attacker can be external and does not require local access to the system.
*   **Crafted Web Content:** The attacker needs to create web content containing HTML-escaped low surrogate characters crafted to bypass script filtering and execute malicious scripts.
*   **Social Engineering:** Some degree of social engineering is necessary to lure users to visit the malicious web page.

**Additional Details:**

*   The vulnerability specifically affects Firefox 2.
*   The vulnerability was addressed by updating the affected products, which included Firefox, SeaMonkey, and Thunderbird.
*   The vulnerability could be present in Thunderbird if javascript is enabled for viewing emails. This is not the default, and users are discouraged from enabling JavaScript in emails.
*   Several sources mention that the fix for this vulnerability was also related to a fix for bug 316394 ([https://bugzilla.mozilla.org/show_bug.cgi?id=316394](https://bugzilla.mozilla.org/show_bug.cgi?id=316394)).