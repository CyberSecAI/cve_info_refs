```
{
  "cve": "CVE-2008-2483",
  "source": "www.exploit-db.com_f4f3d769_20250125_141136.html",
  "vulnerability": {
    "root_cause": "Improper input sanitization and validation in the login mechanism and lack of proper file path validation.",
    "weaknesses": [
      "SQL injection in the login form due to unsanitized input.",
      "Local File Inclusion (LFI) due to lack of proper validation on the 'op' parameter in the URL."
    ],
    "impact": "Successful exploitation allows an attacker to bypass authentication and gain unauthorized access, as well as read arbitrary files from the server's filesystem.",
    "attack_vectors": [
      "SQL injection through the 'email' and 'password' POST parameters.",
      "LFI through the 'op' GET parameter."
    ],
    "required_capabilities": "An attacker needs to send crafted HTTP requests to the vulnerable web application. For the SQL injection, `magic_quotes_gpc` needs to be off on the server.",
      "details": {
        "login_bypass": "The login bypass is achieved through an SQL injection in the `user_email` parameter of the login form. The vulnerability lies in the following SQL query:\n`SELECT user_id FROM users WHERE user_email=\"".$_POST['email']."\"  AND  user_password=\"".md5($_POST['password'])."\" AND user_status=1`\nBy injecting `\" OR user_group=1/*\"` as the email, the attacker can bypass authentication as the condition will always evaluate as true. This vulnerability requires `magic_quotes_gpc` to be off.",
        "lfi": "The LFI vulnerability lies in the handling of the `op` parameter in the URL which is used to include files from the `modules/` folder:\n```php\nif (file_exists('modules/'.$op.'/index.php')) {\n    include('modules/'.$op.'/index.php');\n```\nBy providing a relative path with directory traversal sequences (e.g., `../../../../../../../../../../etc/passwd`) in the `op` parameter, an attacker can include arbitrary files."
      }
  }
}
```