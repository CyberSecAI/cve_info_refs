```
Message-Id: <1213887524.2316.36.camel@iankko.englab.brq.redhat.com>
Date: Thu, 19 Jun 2008 16:58:43 +0200
From: Jan Lieskovsky <jlieskov@...hat.com>
To: oss-security@...ts.openwall.com
Subject: Re: query on a pppol2tp_recvmsg() fix - security
	relevant?

Hello guys,

  the fix as mentioned at:

<http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff;h=6b6707a50c7598a83820077393f8823ab791abf8;hp=2e761e0532a784816e7e822dbaaece8c5d4be14d>

is reasonable. Have investigated this issue in a little deep
detail. Seems it could be a problem in case when the targeted
host would run / have created the L2TP tunnel, would support
the Point to Point protocol with the L2TP plugin enabled
and then local, unprivileged user could potentially
issue an PPP command / request with too long L2TP packet
to force kernel heap corruption (DoS). But as there
is no testcase / exploit available till now I am aware
of, this all is only a presumption. If this would
be a real problem, than hopefully only with low severity
(due the special conditions / requirements that need
to be satisfied to trigger this issue).

Kind regards
Jan iankko Lieskovsky
RH kernel Security Response Team
```
- **Root cause of vulnerability**: The `pppol2tp_recvmsg` function in the Linux kernel's `drivers/net/pppol2tp.c` does not properly validate the length of L2TP packets.
- **Weaknesses/vulnerabilities present**: Kernel heap memory corruption.
- **Impact of exploitation**: A local, unprivileged user could potentially send a PPP command/request with an overly long L2TP packet, leading to kernel heap corruption and a denial of service (DoS).
- **Attack vectors**: A local attacker can exploit the vulnerability by issuing a crafted PPP command/request.
- **Required attacker capabilities/position**: The attacker needs to be a local, unprivileged user on a host running an L2TP tunnel, with support for the Point to Point protocol and the L2TP plugin enabled.

```
The openSUSE 11.0 kernel was updated to 2.6.25.11-0.1.
It fixes following security problems:
CVE-2008-2750: The pppol2tp\_recvmsg function in drivers/net/pppol2tp.c
in the Linux kernel allows remote attackers to cause a denial of
service (kernel heap memory corruption and system crash) and possibly
have unspecified other impact via a crafted PPPOL2TP packet that
results in a large value for a certain length variable.
```
- **Root cause of vulnerability**: The `pppol2tp_recvmsg` function in `drivers/net/pppol2tp.c` of the Linux kernel has a flaw in handling L2TP packets.
- **Weaknesses/vulnerabilities present**: Kernel heap memory corruption due to improper validation of length variable.
- **Impact of exploitation**: A remote attacker can cause a denial of service (system crash) and potentially have unspecified other impacts.
- **Attack vectors**: Sending a crafted PPPOL2TP packet.
- **Required attacker capabilities/position**: The attacker needs to be remote.

```
The PPP over L2TP routines in the kernel did not correctly handle certain
messages. A remote attacker could send a specially crafted packet that
could crash the system or execute arbitrary code. ([CVE-2008-2750](/security/CVE-2008-2750))
```
- **Root cause of vulnerability**: The PPP over L2TP routines in the kernel did not correctly handle certain messages.
- **Weaknesses/vulnerabilities present**: Improper handling of messages within the PPP over L2TP routines.
- **Impact of exploitation**: A remote attacker could crash the system or potentially execute arbitrary code.
- **Attack vectors**: Sending a specially crafted packet
- **Required attacker capabilities/position**: The attacker needs to be remote.