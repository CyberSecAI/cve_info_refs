- **Root cause of vulnerability:** The vulnerability lies in the way XChat handles the `ircs://` URI protocol. When this URI is invoked, the system executes the `xchat.exe` binary with the provided URL as an argument. The vulnerability arises because a double quote character (`"`) can be injected into the URL, which, combined with the `--command` option, allows arbitrary command execution.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability, Improper Input Handling.
- **Impact of exploitation:** Remote code execution, an attacker can execute arbitrary commands on the victim's machine. The example provided launches `calc.exe`, but it can be extended to other malicious payloads.
- **Attack vectors:** The attack vector is through a specially crafted `ircs://` URI, which can be embedded in a website. When a user clicks such a link in a browser (Internet Explorer 6 or 7) on a Windows machine where Xchat is installed, the vulnerable command is executed.
- **Required attacker capabilities/position:** The attacker needs to be able to entice a victim into clicking a malicious link containing the crafted `ircs://` URI using Internet Explorer browser on a Windows system with XChat installed and also that the user is connected to an IRC server.