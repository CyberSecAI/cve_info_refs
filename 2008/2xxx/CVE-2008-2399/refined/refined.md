Based on the provided content, here's an analysis of the vulnerability:

**Root cause of vulnerability:**
- The FireFTP add-on for Firefox does not properly sanitize filenames containing directory traversal sequences (specifically backslashes) received from an FTP server in response to MLSD and LIST commands.

**Weaknesses/vulnerabilities present:**
- **Directory Traversal:** The vulnerability stems from the lack of proper sanitization of filenames, allowing an attacker to inject directory traversal sequences (e.g., `\..\..\..\..\..\..\..\..\..\testfile.txt`) into the filenames returned by the FTP server.
- **Improper Input Handling:** The application fails to validate or sanitize filenames received from the server, leading to the directory traversal issue.

**Impact of exploitation:**
- **Arbitrary File Write:** An attacker can write files to arbitrary locations on the victim's system with the privileges of the user running Firefox.
- **Code Execution:** By writing files to the user's Startup folder, an attacker can achieve arbitrary code execution when the user logs on.

**Attack vectors:**
- **Malicious FTP Server:** The attacker controls an FTP server that responds to MLSD and LIST commands with filenames containing directory traversal sequences.
- **User Interaction:** The attacker must trick the user into connecting to the malicious FTP server and downloading a directory containing the malicious filenames.

**Required attacker capabilities/position:**
- **Control over FTP Server:** The attacker needs a server under their control that can respond to FTP commands.
- **Social Engineering:** The attacker needs to lure the victim into connecting to the malicious FTP server using FireFTP.

**Additional details:**
- The vulnerability affects FireFTP versions 0.97.1 and development version 0.98.20080405.
- The vulnerability can be exploited on Windows systems.
- The vulnerability was fixed in development version 0.98.20080518 and in release version 0.97.2.
- The vulnerability is triggered when the user attempts to download a directory with maliciously crafted file names.