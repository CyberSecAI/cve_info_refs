=== Content from www.bugzilla.org_79fc7b3d_20250126_002332.html ===

[![Bugzilla Logo](/assets/img/logo-header.svg)
Bugzilla](/)
Show Nav Menu

* [About](/about/ "Find out more about Bugzilla.")
  [Project](/about/ "Find out more about Bugzilla.")
  [Features](/about/features.html)
  [Who Uses Bugzilla?](/about/installation-list.html "Hundreds of companies and organizations trust Bugzilla.")
  [Meet the Team](/about/developers "Meet the Bugzilla team.")
  [Zarro Boogs Corporation](/about/zarroboogs.html "Find out about the company managing the Bugzilla Project.")
* [News](/blog/ "Get the low down on what's happening with the project.")
  [Blog](/blog/ "Bugzilla Blog")
  [Release Information](/releases/ "Information on current and previous releases.")
  [Security Advisories](/security/ "Important updates regarding Bugzilla security.")
  [Planet Bugzilla](http://planet.bugzilla.org "View the status of the Bugzilla project.")
* [Download](/download/ "Download Bugzilla")
* [Documentation](/docs/ "Bugzilla Documentation")
* [Support](/support/ "Find out where to get more information and help.")
* [Contribute](/contributing/ "Ways you can help Bugzilla")
  [How to?](/contributing/ "Ways you can help Bugzilla")
  [Report a Bug](/contributing/reporting_bugs "Let us know if there is an error in Bugzilla.")
  [Donate](/donate "Donate to Bugzilla, and see how your money is used.")
  [Wiki](https://wiki.mozilla.org/Bugzilla%3AHome "Collaboratively updated information about Bugzilla.")

Search bugzilla.org

1. [Security Advisories](/security/)
2. 3.0.3, 3.1.3, 2.22.3, and 2.20.5 Security Advisory

# 3.0.3, 3.1.3, 2.22.3, and 2.20.5 Security Advisory

Sunday, May 4th, 2008
```

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* Users without the "canconfirm" privilege could enter a bug as NEW
  or ASSIGNED by using the XML-RPC interface.

* When viewing several bugs at once, there was a Cross-Site Scripting hole.

* The inbound email interface allowed you to set the Reporter via the
  text of the email, instead of just using the From header.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Unauthorized Bug Change
Affected:    3.1.3
Description: Users normally need the "canconfirm" privilege to put bugs
             in the NEW or ASSIGNED state. However, users were being
             allowed to create bugs in the NEW or ASSIGNED state if they
             were creating the bug through the XML-RPC interface.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=415471

Class:       Cross-Site Scripting
Affected:    2.17.2 and higher
Description: When using the "Format for Printing" view of a bug (or
             the "Long Format" of a bug list, which is the same thing),
             there was a cross-site scripting hole--arbitrary text
             from a particular URL parameter could be injected into the
             page without filtering.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=425665

Class:       Account Impersonation (Minor)
Affected:    2.23.4 and higher
Description: By design, email_in.pl always believes the "From" header as
             the user making changes or uses that as the reporter of the
             bug. However, you could also specify the changer/reporter in
             the body of the email and override the "From" header, possibly
             bypassing some security checks set up by administrators
             against the "From" header.
             For most installations this is a minor or inconsequential
             issue, as the documentation of email_in.pl already explains
             that it does not do any user authentication (it just
             believes the "From" header), so installations using it should
             not have been expecting user account security (though they
             may have had checks against the "From" header--that is what
             makes this a security issue).
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=419188

Vulnerability Solutions
=======================

The fix for these issues is included in the
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issues at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  https://www.bugzilla.org/download/

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix this
issue:

Issue 1 Reporter: Frédéric Buclin
Issue 1 Fixed by: Frédéric Buclin, Max Kanat-Alexander

Issue 2 Reporter: Bradley Baetz
Issue 2 Fixed by: Frédéric Buclin, Max Kanat-Alexander, Marc Schumann

Issue 3 Reporter: Frédéric Buclin
Issue 3 Fixed by: Frédéric Buclin, Max Kanat-Alexander, Loren Butler

General information about the Bugzilla bug-tracking system can be found
at:

  https://www.bugzilla.org/

Comments and follow-ups can be directed to the support-bugzilla mailing list.
https://www.bugzilla.org/support/ has directions for accessing this forum.

```

* [GitHub
  GitHub](https://github.com/bugzilla "GitHub")
* [X](https://x.com/%40bugzilla "X")
* [Mastodon
  Mastodon](https://techhub.social/%40bugzilla "Mastodon")
* [Bluesky](https://bsky.app/profile/bugzilla.org "Bluesky")
* [Facebook
  Facebook](https://www.facebook.com/BugzillaProject "Facebook")
* [LinkedIn
  LinkedIn](https://www.linkedin.com/company/bugzilla-project "LinkedIn")
* [IRC
  IRC on Libera.Chat](https://web.libera.chat/#/#bugzilla "IRC on Libera.Chat")
* [Discord
  Discord](https://discord.gg/ZhN6uBA "Discord")
* [Matrix
  Matrix](https://matrix.to/#/#bugzilla:mozilla.org "Matrix")
* [YouTube
  YouTube](https://www.youtube.com/%40bugzillaproject "YouTube")
* [Twitch
  Twitch](https://twitch.tv/bugzillaproject "Twitch")

---

Copyright © 1998-2024 bugzilla.org contributors
Creative Commons Attribution-ShareAlike 2.0[Creative CommonsAttributionShareAlike](https://creativecommons.org/licenses/by-sa/2.0/)



=== Content from www.vupen.com_fa0962cc_20250126_002333.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from bugzilla.mozilla.org_2d0cd2e2_20250126_002334.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/419188)
* [XML](/show_bug.cgi?ctype=xml&id=419188)

Closed
[Bug 419188](/show_bug.cgi?id=419188)

Opened 17 years ago
Closed 17 years ago

# [SECURITY] email\_in.pl lets you set the changer as @reporter instead of only checking the "From" header

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] email\_in.pl lets you set the changer as @reporter instead of only checking the "From" header

## Categories

### (Bugzilla :: Incoming Email, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Incoming%20Email#Incoming%20Email)

Incoming Email
▾

Bugzilla :: Incoming Email
Everything related to bug creation and editing by email, using email\_in.pl (or the contrib/bug\_email scripts in old versions of Bugzilla).
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Incoming%20Email&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Incoming%20Email&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Incoming%20Email)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.23.4

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

blocker

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 3.0

## People

### (Reporter: LpSolit, Assigned: LpSolit)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[425110](/show_bug.cgi?id=425110 "RESOLVED FIXED - Security Advisory for Bugzilla 3.0.4, 3.1.4, 2.22.4, and 2.20.6")

Dependency [tree](/showdependencytree.cgi?id=419188&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=419188)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [ready for 3.x])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[ready for 3.x]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [LpSolit](/user_profile?user_id=120380) | [approval](#c9 "17 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking3.2](#c0 "17 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking3.2 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [approval3.0](#c9 "17 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | approval3.0 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking3.0.4](#c0 "17 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking3.0.4 | + |
| --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [patch, v1](/attachment.cgi?id=305215)  [17 years ago](#c1)  [Frédéric Buclin](/user_profile?user_id=120380)   778 bytes, patch |  | [Details](/attachment.cgi?id=305215&action=edit) | [Diff](/attachment.cgi?id=305215&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=419188&attachment=305215) |
| --- | --- | --- |
| [patch, v2](/attachment.cgi?id=305220)  [17 years ago](#c2)  [Frédéric Buclin](/user_profile?user_id=120380)   1.07 KB, patch | mkanat : [review+](#c5 "17 years ago") | [Details](/attachment.cgi?id=305220&action=edit) | [Diff](/attachment.cgi?id=305220&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=419188&attachment=305220) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=419188#c0)• 17 years ago |
|  | |

email\_in.pl lets you do changes even without altering the email headers. This means that even if you use PGP to sign your emails, or use tokens, it's still trivial to alter bugs as if you were someone else. One useful case would be the ability to CC yourself to bugs you want to see. All you have to do is to add the following line to your email:
@reporter = someone.else@user.account
Where the email address is a valid user account with privs to access security bugs. This trick works with process\_bug.cgi, i.e. with existing bugs, which is why I restricted this bug to the security group.
I know email\_in.pl currently has no way to check the real identity of the sender, but for installations which added some checks to it and turned on incoming emails, they are still fully vulnerable (e.g. Mandriva Bugzilla).
Now technically, the reason this works is because we have:
my $username = $mail\_fields->{'reporter'};
my $user = Bugzilla::User->new({ name => $username })
|| ThrowUserError('invalid\_username', { name => $username });
Bugzilla->set\_user($user);
But $mail\_fields->{'reporter'} comes from:
my ($reporter) = Email::Address->parse($input\_email->header('From'));
$fields{'reporter'} = $reporter->address;
The problem is that later in the code, we have:
if ($line =~ /^@(\S+)\s\*=\s\*(.\*)\s\*/) {
$current\_field = lc($1);
$fields{$current\_field} = $2;
}
So if you have the @reporter line, it will override the one taken from the email header, and so all authenticated emails are vulnerable.
I just tried this trick to CC myself to a bug I'm not allowed to see on a test installation, and this works great. I could do the same on Mandriva!Flags: blocking3.2+Flags: blocking3.0.4+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=419188#c1)• 17 years ago |
|  | |

Attached patch

[patch, v1](attachment.cgi?id=305215&action=diff) (obsolete)
— [Details](attachment.cgi?id=305215&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=419188&attachment=305215)

Disallow to pass the 'reporter' field. This one is now only set based on the "From": field.Assignee: incoming.email → LpSolitStatus: NEW → ASSIGNED
[Attachment #305215](/attachment.cgi?id=305215&action=edit "patch, v1") -
Flags: review?(mkanat)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=419188#c2)• 17 years ago |
|  | |

Attached patch

[patch, v2](attachment.cgi?id=305220&action=diff)
— [Details](attachment.cgi?id=305220&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=419188&attachment=305220)

Even better fix: prevent the attacker to split the reporter field on several lines. To do that, I reset the $current\_field variable.
[Attachment #305215](/attachment.cgi?id=305215&action=edit "patch, v1") -
Attachment is obsolete: true
[Attachment #305220](/attachment.cgi?id=305220&action=edit "patch, v2") -
Flags: review?(mkanat)
[Attachment #305215](/attachment.cgi?id=305215&action=edit "patch, v1") -
Flags: review?(mkanat)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=419188#c3)• 17 years ago |
|  | |

CC'ing the Mandriva Bugzilla maintainer as he should be aware of the issue.

|  | [Vincent Danen](/user_profile?user_id=277899) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=419188#c4)• 17 years ago |
|  | |

Thanks for the heads up on this.
I just applied the v2 patch and verified it works:
You are not authorized to access [bug #38032](/show_bug.cgi?id=38032 "VERIFIED DUPLICATE - linux barber pole bleeds beyond it's boundaries.").
From vdanen@gmail.com Sat Feb 23 19:30:14 2008
Subject: [[Bug 38032](/show_bug.cgi?id=38032 "VERIFIED DUPLICATE - linux barber pole bleeds beyond it's boundaries.")]
Folder: /var/www/html/bugzilla/bugzilla/email\_in.pl 2518
From vdanen@mandriva.com Sat Feb 23 19:32:57 2008
Subject: [[Bug 38032](/show_bug.cgi?id=38032 "VERIFIED DUPLICATE - linux barber pole bleeds beyond it's boundaries.")]
Folder: /var/www/html/bugzilla/bugzilla/email\_in.pl 2509
That's the output from procmail with the patch applied; previously I was able to send a comment with my gmail.com account which has no privs to the bug in question.
So I can verify that the fix works.
Thanks again for the heads up.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=419188#c5)• 17 years ago |
|  | |

Comment on [attachment 305220](/attachment.cgi?id=305220 "patch, v2") [[details]](/attachment.cgi?id=305220&action=edit "patch, v2") [[diff]](/attachment.cgi?id=305220&action=diff "patch, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=419188&attachment=305220)
patch, v2
Cool, that looks good to me.
[Attachment #305220](/attachment.cgi?id=305220&action=edit "patch, v2") -
Flags: review?(mkanat) → review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=419188#c6)• 17 years ago |
|  | |

Now, just to be clear about all this, you could already add yourself to any bug you can't see, by changing the "From" address. The email\_in.pl docs are pretty clear about the safety risks.
In that sense, I don't think this is a security bug in Bugzilla's code itself. It might be a security bug on some particular installation that has customized their code, but that's not our code.
However, I agree that you shouldn't be able to set the reporter field in any situation.
Unless you can show me some security risk that this creates in upstream Bugzilla itself, I think we should remove this from the security group. People using email\_in.pl should be aware of its security risks.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=419188#c7)• 17 years ago |
|  | |

(In reply to [comment #6](/show_bug.cgi?id=419188#c6 "RESOLVED FIXED - [SECURITY] email_in.pl lets you set the changer as @reporter instead of only checking the \"From\" header"))
> I think we should remove this from the security group. People
> using email\_in.pl should be aware of its security risks.
That's paradoxal. Should be aware of what? That using email\_in.pl in 3.0 and 3.2 is like turning off user authentication completely? I don't see how any bug could have more security risk than that.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=419188#a26556_120380)• 17 years ago |

Flags: approval?Flags: approval3.0?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=419188#c8)• 17 years ago |
|  | |

(In reply to [comment #7](/show_bug.cgi?id=419188#c7 "RESOLVED FIXED - [SECURITY] email_in.pl lets you set the changer as @reporter instead of only checking the \"From\" header"))
> Should be aware of what? That using email\_in.pl in 3.0 and
> 3.2 is like turning off user authentication completely?
Yes, because the POD says so:
<http://www.bugzilla.org/docs/3.0/html/api/email_in.html#CAUTION>

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=419188#a200114_73187)• 17 years ago |

Summary: email\_in.pl lets you do changes as if you were someone else → email\_in.pl lets you set the changer as @reporter instead of only checking the "From" header

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=419188#c9)• 17 years ago |
|  | |

Pushing this bug in our radar for 3.x.4. But has to wait for the release to happen before being committed to CVS.Flags: approval?Flags: approval3.0?Flags: approval3.0+Flags: approval+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=419188#a1921084_120380)• 17 years ago |

Blocks: [417505](/show_bug.cgi?id=417505 "RESOLVED FIXED - Release Bugzilla 3.1.4, 3.0.4, 2.22.4 and 2.20.6")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=419188#a2711367_120380)• 17 years ago |

Blocks: [425110](/show_bug.cgi?id=425110 "RESOLVED FIXED - Security Advisory for Bugzilla 3.0.4, 3.1.4, 2.22.4, and 2.20.6")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=419188#a2711444_120380)• 17 years ago |

No longer blocks: [417505](/show_bug.cgi?id=417505 "RESOLVED FIXED - Release Bugzilla 3.1.4, 3.0.4, 2.22.4 and 2.20.6")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=419188#a3786266_120380)• 17 years ago |

Whiteboard: [ready for 3.x]

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=419188#c10)• 17 years ago |
|  | |

This problem is present since email\_in.pl exists, i.e. 2.23.4.Summary: email\_in.pl lets you set the changer as @reporter instead of only checking the "From" header → [SECURITY] email\_in.pl lets you set the changer as @reporter instead of only checking the "From" headerVersion: 3.0.3 → 2.23.4

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=419188#c11)• 17 years ago |
|  | |

tip:
Checking in email\_in.pl;
/cvsroot/mozilla/webtools/bugzilla/email\_in.pl,v <-- email\_in.pl
new revision: 1.18; previous revision: 1.17
done
3.0.3:
Checking in email\_in.pl;
/cvsroot/mozilla/webtools/bugzilla/email\_in.pl,v <-- email\_in.pl
new revision: 1.5.2.11; previous revision: 1.5.2.10
done
Status: ASSIGNED → RESOLVEDClosed: 17 years agoResolution: --- → FIXED

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=419188#c12)• 17 years ago |
|  | |

Security advisory sent, removing bugs from security group.Group: webtools-security
You need to [log in](/show_bug.cgi?id=419188&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frédéric Buclin](/user_profile?user_id=120380)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


