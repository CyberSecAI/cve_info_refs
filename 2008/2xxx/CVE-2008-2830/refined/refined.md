The provided content describes a vulnerability in Mac OS X 10.4 Tiger and 10.5 Leopard that allows root escalation through AppleScript. Here's a breakdown:

**Vulnerability:**

*   **Weakness:** The ARDAgent application, part of Apple Remote Desktop, allows execution of shell scripts with root privileges via AppleScript.
*   **Root Cause:** ARDAgent improperly allows unprivileged users to execute shell commands as root.
*   **Attack Vector:** Executing a specific AppleScript command: `osascript -e 'tell app "ARDAgent" to do shell script "whoami"'`.  This command reveals the current user as root.
*   **Attacker Capability:**
    *   The attacker needs to be logged into a user account on the target machine.  The exploit requires that the user running the command is the user who is graphically logged in (console access either physically or via remote desktop). SSH access alone is not sufficient unless the account is also logged in at the console.
    *   The ARDAgent files must be present on the system (they are by default unless manually deleted).

**Impact:**

*   **Privilege Escalation:** A normal user or even an admin user can gain root privileges.
*   **Complete System Compromise:** With root access, an attacker can perform any action on the system, including installing malware, modifying system files, and accessing sensitive data.
*   **Malware Installation:**  The vulnerability can be integrated into malware to escalate privileges without user interaction.
*   **Bypassing Security Measures**: The vulnerability can bypass the application firewall.

**Mitigation:**

*   **Disable ARDAgent:** Remove the ARDAgent application.
*   **Modify ARDAgent Permissions:** Change the permissions of the ARDAgent executable to remove the setuid bit (`chmod u-s /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/MacOS/ARDAgent`).  However, repair permissions may reset this.
*   **Modify Info.plist:** Add the `NSAppleScriptEnabled` key to ARDAgent's `Info.plist` with the value `YES`. This disables the "do shell script" functionality.