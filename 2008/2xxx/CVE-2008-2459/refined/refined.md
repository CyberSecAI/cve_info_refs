- **Root cause of vulnerability**: The `page.php` script in EntertainmentScript 1.4.0 is vulnerable to Local File Inclusion (LFI) due to insufficient input sanitization of the `page` parameter.
- **Weaknesses/vulnerabilities present**: The primary vulnerability is Local File Inclusion (LFI). The `page` parameter in `page.php` allows the inclusion of arbitrary local files by using directory traversal sequences (e.g., `../../`). Additionally, the vulnerability leverages null byte injection (`%00`) to terminate the file path prematurely, bypassing checks or extensions appended by the application.
- **Impact of exploitation**: An attacker can read sensitive files on the server, potentially including configuration files containing database credentials, system files, or application source code. In combination with log poisoning, the attacker can achieve Remote Code Execution (RCE) by injecting malicious PHP code into server logs, including those used by Apache, and then including those logs using LFI to execute the malicious PHP code.
- **Attack vectors**: The vulnerability is exploited by sending a crafted HTTP GET request to `page.php` with the `page` parameter including directory traversal sequences and a null byte to include an arbitrary file. In the case of RCE, the attacker injects php code into a log file, and then uses the LFI to include it as a php script.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the server hosting the vulnerable application. They do not need to be authenticated. The attacker also needs to know or guess the path to the server logs to inject code or to an arbitrary file to read.