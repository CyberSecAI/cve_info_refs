=== Content from trac.wordpress.org_5ae00f46_20250124_192155.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Core](https://make.wordpress.org/core/)

* [Blog](https://make.wordpress.org/core/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Browse Source](https://core.trac.wordpress.org/browser "Browse Source")
* [Trac Timeline](https://core.trac.wordpress.org/timeline "Trac Timeline")
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket "Create a New Ticket")

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fcore.trac.wordpress.org%2Fchangeset%2F6029)
* [Notifications](https://make.wordpress.org/core/notifications/)

## Context Navigation

* ← [Previous Changeset](/changeset/6028 "Changeset 6028")
* [Next Changeset](/changeset/6030 "Changeset 6030") →

---

# Changeset 6029

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/04/2007 03:21:04 AM
([17 years](/timeline?from=2007-09-04T03%3A21%3A04Z&precision=second "See timeline at 09/04/2007 03:21:04 AM") ago)

Author:
markjaquith
Message:

Better $pagenow determination. fixes [#4748](/ticket/4748 "#4748: defect (bug): Unprivileged users can perform some actions on pages they aren't ... (closed: fixed)")

File:

1 edited

* [trunk/wp-includes/vars.php](/browser/trunk/wp-includes/vars.php?rev=6029 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [trunk/wp-includes/vars.php](/changeset/6029/trunk/wp-includes/vars.php "Show the changeset 6029 restricted to trunk/wp-includes/vars.php")

  | [r5700](/browser/trunk/wp-includes/vars.php?rev=5700#L2 "Show revision 5700 of this file in browser") | [r6029](/browser/trunk/wp-includes/vars.php?rev=6029#L2 "Show revision 6029 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 |  |
  | 3 | 3 | // On which page are we ? |
  | 4 |  | if ( preg\_match('#([^/]+\.php)$#', $PHP\_SELF, $self\_matches) ) { |
  |  | 4 | if ( is\_admin() ) { |
  |  | 5 | // wp-admin pages are checked more carefully |
  |  | 6 | preg\_match('#/wp-admin/?(.\*?)$#i', $PHP\_SELF, $self\_matches); |
  | 5 | 7 | $pagenow = $self\_matches[1]; |
  | 6 |  | } elseif ( strpos($PHP\_SELF, '?') !== false ) { |
  | 7 |  | $pagenow = explode('/', $PHP\_SELF); |
  | 8 |  | $pagenow = trim($pagenow[(sizeof($pagenow)-1)]); |
  | 9 |  | $pagenow = explode('?', $pagenow); |
  | 10 |  | $pagenow = $pagenow[0]; |
  |  | 8 | $pagenow = preg\_replace('#\?.\*?$#', '', $pagenow); |
  |  | 9 | if ( '' === $pagenow || 'index' === $pagenow || 'index.php' === $pagenow ) { |
  |  | 10 | $pagenow = 'index.php'; |
  |  | 11 | } else { |
  |  | 12 | preg\_match('#(.\*?)(/|$)#', $pagenow, $self\_matches); |
  |  | 13 | $pagenow = strtolower($self\_matches[1]); |
  |  | 14 | if ( '.php' !== substr($pagenow, -4, 4) ) |
  |  | 15 | $pagenow .= '.php'; // for Options +Multiviews: /wp-admin/themes/index.php (themes.php is queried) |
  |  | 16 | } |
  | 11 | 17 | } else { |
  | 12 |  | $pagenow = 'index.php'; |
  |  | 18 | if ( preg\_match('#([^/]+\.php)([?/].\*?)?$#i', $PHP\_SELF, $self\_matches) ) |
  |  | 19 | $pagenow = strtolower($self\_matches[1]); |
  |  | 20 | else |
  |  | 21 | $pagenow = 'index.php'; |
  | 13 | 22 | } |
  | 14 | 23 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=6029)
* [Zip Archive](?format=zip&new=6029)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from trac.wordpress.org_eda95ae8_20250124_192157.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Core](https://make.wordpress.org/core/)

* [Blog](https://make.wordpress.org/core/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Browse Source](https://core.trac.wordpress.org/browser "Browse Source")
* [Trac Timeline](https://core.trac.wordpress.org/timeline "Trac Timeline")
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket "Create a New Ticket")

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fcore.trac.wordpress.org%2Fticket%2F4748)
* [Notifications](https://make.wordpress.org/core/notifications/)

## Context Navigation

* ← [Previous Ticket](/ticket/4747 "Ticket #4747")
* [Next Ticket](/ticket/4749 "Ticket #4749") →

---

Opened [17 years ago](/timeline?from=2007-08-14T18%3A45%3A39Z&precision=second "See timeline at 08/14/2007 06:45:39 PM")

Closed [17 years ago](/timeline?from=2007-09-10T14%3A06%3A30Z&precision=second "See timeline at 09/10/2007 02:06:30 PM")

Last modified [7 years ago](/timeline?from=2018-05-22T16%3A26%3A11Z&precision=second "See timeline at 05/22/2018 04:26:11 PM")

## [#4748](/ticket/4748) [closed](/query?status=closed) [defect (bug)](/query?status=!closed&type=defect+(bug)) ([fixed](/query?status=closed&resolution=fixed))

# Unprivileged users can perform some actions on pages they aren't allowed to access

| Reported by: | [xknown's profile](https://profiles.wordpress.org/xknown) [xknown](/query?status=!closed&reporter=xknown) | Owned by: |  |
| --- | --- | --- | --- |
| Milestone: | [2.0.12](/milestone/2.0.12 "Completed 16 years ago (04/21/2009 08:12:56 PM)") | Priority: | [normal](/query?status=!closed&priority=normal) |
| Severity: | [normal](/query?status=!closed&severity=normal) | Version: | [2.2.2](/query?status=!closed&version=2.2.2) |
| Component: | [Security](/query?status=!closed&component=Security) | Keywords: | [has-patch](/query?status=!closed&keywords=~has-patch) [has-fix](/query?status=!closed&keywords=~has-fix) [security](/query?status=!closed&keywords=~security) [privilege-escalation](/query?status=!closed&keywords=~privilege-escalation) |
| Focuses: |  | Cc: |  |

### Description

You control the access to administration pages on menu.php based on the value of `$pagenow`, however this variable can be manipulated via `PATH_INFO`.

```
if ( preg_match('#([^/]+\.php)$#', $PHP_SELF, $self_matches) ) {
	$pagenow = $self_matches[1];
} elseif ( strpos($PHP_SELF, '?') !== false ) {
	$pagenow = explode('/', $PHP_SELF);
	$pagenow = trim($pagenow[(sizeof($pagenow)-1)]);
	$pagenow = explode('?', $pagenow);
	$pagenow = $pagenow[0];
} else {
	$pagenow = 'index.php';
}

```

Proof of Concept:

1. Log in to WP (a subscriber user is okay)
2. Access to `http://vulnerable/wp/wp-admin/themes.php/index.php`
3. Switch the current theme (you need to replace `/wp-admin/themes.php/themes.php?action=...` by `/wp-admin/themes.php/index.php?action=...`)

As you can see, this bug lets unprivileged users to switch current theme, de/activate plugins, etc.

### Attachments (4)

[4748.patch](/attachment/ticket/4748/4748.patch "View attachment")[​](/raw-attachment/ticket/4748/4748.patch "Download") (3.4 KB) - added by hakre [17 years ago](/timeline?from=2007-08-26T08%3A43%3A58Z&precision=second "See timeline at 08/26/2007 08:43:58 AM").

Security Hotfix for [#4748](/ticket/4748 "#4748: defect (bug): Unprivileged users can perform some actions on pages they aren't ... (closed: fixed)") / admin privilege escalation

[4784.diff](/attachment/ticket/4748/4784.diff "View attachment")[​](/raw-attachment/ticket/4748/4784.diff "Download") (32 bytes) - added by hakre [17 years ago](/timeline?from=2007-08-26T08%3A48%3A50Z&precision=second "See timeline at 08/26/2007 08:48:50 AM").

UPLOADED THE WRONG FILE! IGNORE.

[4748.002.diff](/attachment/ticket/4748/4748.002.diff "View attachment")[​](/raw-attachment/ticket/4748/4748.002.diff "Download") (1.3 KB) - added by markjaquith [17 years ago](/timeline?from=2007-09-03T20%3A21%3A52Z&precision=second "See timeline at 09/03/2007 08:21:52 PM").

First try

[4748-branches2.0.diff](/attachment/ticket/4748/4748-branches2.0.diff "View attachment")[​](/raw-attachment/ticket/4748/4748-branches2.0.diff "Download") (1.3 KB) - added by westi [17 years ago](/timeline?from=2007-09-09T09%3A40%3A54Z&precision=second "See timeline at 09/09/2007 09:40:54 AM").

Backport of $pagenow fix to 2.0

Download all attachments as: [.zip](/zip-attachment/ticket/4748/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (15)

### [#1](#comment:1) [@hakre](https://profiles.wordpress.org/hakre) [17 years](/timeline?from=2007-08-26T08%3A38%3A12Z&precision=second "See timeline at 08/26/2007 08:38:12 AM") ago

I made an analysis of CVS source regarding the reported problem and created a fix:

# Analysis:

* noted code above is located in wp-includes/vars.php line line 3 to 14 inside the global php main() function.
* vars.php is included or required in the following position(s):

> > 1.) wp-settings.php line 216

* `$PHP_SELF` is initialized on line 62ff:
  ```
  // Fix empty PHP_SELF
  $PHP_SELF = $_SERVER['PHP_SELF'];
  if ( empty($PHP_SELF) )
  	$_SERVER['PHP_SELF'] = $PHP_SELF = preg_replace("/(\?.*)?$/",'',$_SERVER["REQUEST_URI"]);

  ```
* as stated above the value of `$PHP_SELF` can be manipulated by the user. Since both, the value of `$_SERVER['PHP_SELF']` and `$_SERVER["REQUEST_URI"]` are based on user input, this is true (REF:1). Additionally you should be aware of other code modifying these values (REF:2).
* Because the sourcecode is not documented you can not say at this point which content has to be put into `$PHP_SELF` sothat it can be properly sanitized.
* My suggestion is
  1. To write down a definition what must be in `$PHP_SELF`.
  2. To create a function doing the job and returning the correct value by definition
  3. Until a) and b) has been done to create a fallback in vars.php for the admin
* What you can say for shure is that `$pagenow` only contains the filename of the .php-file not containing the path to it. E.G. not wordpress/index.php just index.php.

## Possible Fallback Strategies:

Some possile Fallback strategies which came into my mind to hotfix this Issue. Most of them need to be discussed anyway:

* Force the useragent to use at least index.php within the Request when inside wp-admin. (Does this contain a hole? Querystrings or similar should at least NOT attached within the redirect here.)
* Make clear that at least the directory wp-admin is followed by one .php file-name only.
* Since the UA is forced into a .php request and we know that there are no further subdirs this can be sanitzed. If it can not be said which file, an empty string should be returned.
* Since there is a specified set of files used within the admin, a whitelist can be created to compare against.
* `$pagenow` is used as a place where to find the result. So this is a nice place to inject the hotfix to without touching the rest of the app.

# Solving…

Because this is a hotfix only, it targets especially the describben problem above only. Any Usage of `$PHP_SELF` and `$_SERVER['PHP_SELF']` is still dangerous and the places within the source should be clearly analyzed AFTER it has been said for once what MUST BE and IS in `$PHP_SELF` / `$_SERVER['PHP_SELF']` (in the meaning of "inside wordpress" not "PHP in general"):

> m.1) The name of the script relative to document root
>
> m.2) The request by the browser
>
> m.3) Specify else

Questions that could be good to be answered in this clarification process:

> q.1) Does `$PHP_SELF` contains stuff of the queryinfo part or not?
>
> q.2) Which parts of a Request are part of `$PHP_SELF`?
>
> q.3) Should `$PHP_SELF` be considered as safe?
>
> q.4) Where is `$PHP_SELF` used within the application sourcecode.
>
> q.5) Is it a good practise to name vars the same like the tainted and known to be insecure variables like `$_SERVER['PHP_SELF']`? Doesn't this irritate developers and doesn't it make things complicated and more error-prone?

# First Hotfix Implementation:

I made this quite short and did not redirect. This could produce sideeffects and create critical holes sothat no-.php-file is transposed into index.php internally only. Everything unmatching is leading into a wp\_die('Request Error. Please contact the Administrator.'). Logical problems will result in an Errorcode which is documented inside the according comments. If you encounter such codes while testing, visit trac and discuss. Do not short-ciruit here. Take care.

**WARNING:** This does only hotfix the describben Issue and will hide the proof of concept. It can not circumvent the existing design errors in wordpress lacking of missing documentation.

## Fix Testing Report:

1. Created a User of Role "Subcriber"
2. Logged in with that User
3. Navigated to `/wp-admin/themes.php/index.php`
4. I read the Message: "You do not have sufficient permissions to access this page."
5. Navigated to `/wp-admin/themes.php/index.php?action=activate&template=classic&stylesheet=classic`
6. I read the Message: "You do not have sufficient permissions to access this page."

All tests performed successfully. Proof of Concept does not work any longer. Please hack deeper now.

# Additional Information:

`$pagenow` is used on multiple places within the source and by both admin and non-admin code as far as I can see. It would make sense to open a further ticket to remove unneeded `$pagenow` declarations because some functions are importing `$pagenow` from the global scope but do not make use of the var then. This can be removed from source to make a further analysis more easy.

# References:

1. [​http://blog.phpdoc.info/archives/13-XSS-Woes.html](http://blog.phpdoc.info/archives/13-XSS-Woes.html)
2. See lines 22-51 inside wp-settings.php regarding $\_SERVERREQUEST\_URI?.

### [@hakre](https://profiles.wordpress.org/hakre) [17 years](/timeline?from=2007-08-26T08%3A43%3A58Z&precision=second "See timeline at 08/26/2007 08:43:58 AM") ago

* **Attachment**
  [*4748.patch*](/attachment/ticket/4748/4748.patch)[​](/raw-attachment/ticket/4748/4748.patch "Download")
  added

Security Hotfix for [#4748](/ticket/4748 "#4748: defect (bug): Unprivileged users can perform some actions on pages they aren't ... (closed: fixed)") / admin privilege escalation

### [@hakre](https://profiles.wordpress.org/hakre) [17 years](/timeline?from=2007-08-26T08%3A48%3A50Z&precision=second "See timeline at 08/26/2007 08:48:50 AM") ago

* **Attachment**
  [*4784.diff*](/attachment/ticket/4748/4784.diff)[​](/raw-attachment/ticket/4748/4784.diff "Download")
  added

UPLOADED THE WRONG FILE! IGNORE.

### [#2](#comment:2) [@hakre](https://profiles.wordpress.org/hakre) [17 years](/timeline?from=2007-08-26T08%3A53%3A15Z&precision=second "See timeline at 08/26/2007 08:53:15 AM") ago

* **Keywords**
  *has-patch* *has-fix* *security* *privilege-escalation* added

### [#3](#comment:3) [@xknown](https://profiles.wordpress.org/xknown) [17 years](/timeline?from=2007-08-26T16%3A33%3A41Z&precision=second "See timeline at 08/26/2007 04:33:41 PM") ago

A more safer approach is to check access rights on the affected files (`can_user_can`), because the current implementation and the patch you propose could be bypassed (i.e. try this on a Windows box `/wp-admin/themes.Php/index.php`).

### [#4](#comment:4) [@foolswisdom](https://profiles.wordpress.org/foolswisdom) [17 years](/timeline?from=2007-08-29T17%3A59%3A19Z&precision=second "See timeline at 08/29/2007 05:59:19 PM") ago

* **Milestone**
  changed from *2.2.3* to *2.3*

### [@markjaquith](https://profiles.wordpress.org/markjaquith) [17 years](/timeline?from=2007-09-03T20%3A21%3A52Z&precision=second "See timeline at 09/03/2007 08:21:52 PM") ago

* **Attachment**
  [*4748.002.diff*](/attachment/ticket/4748/4748.002.diff)[​](/raw-attachment/ticket/4748/4748.002.diff "Download")
  added

First try

### [#5](#comment:5) [@markjaquith](https://profiles.wordpress.org/markjaquith) [17 years](/timeline?from=2007-09-04T03%3A21%3A04Z&precision=second "See timeline at 09/04/2007 03:21:04 AM") ago

* **Resolution**
  set to *fixed*
* **Status**
  changed from *new* to *closed*

(In [[6029]](/changeset/6029 "Better $pagenow determination.  fixes #4748")) Better $pagenow determination. fixes [#4748](/ticket/4748 "#4748: defect (bug): Unprivileged users can perform some actions on pages they aren't ... (closed: fixed)")

### [#6](#comment:6) [@ryan](https://profiles.wordpress.org/ryan) [17 years](/timeline?from=2007-09-07T19%3A19%3A26Z&precision=second "See timeline at 09/07/2007 07:19:26 PM") ago

(In [[6061]](/changeset/6061 "Better  determination. fixes #4748 for 2.2")) Better determination. fixes [#4748](/ticket/4748 "#4748: defect (bug): Unprivileged users can perform some actions on pages they aren't ... (closed: fixed)") for 2.2

### [#7](#comment:7) in reply to: [↑ description](#comment:description) [@snakefoot](https://profiles.wordpress.org/snakefoot) [17 years](/timeline?from=2007-09-09T09%3A07%3A21Z&precision=second "See timeline at 09/09/2007 09:07:21 AM") ago

This security fix should be applied to the 2.0 branch.

### [@westi](https://profiles.wordpress.org/westi) [17 years](/timeline?from=2007-09-09T09%3A40%3A54Z&precision=second "See timeline at 09/09/2007 09:40:54 AM") ago

* **Attachment**
  [*4748-branches2.0.diff*](/attachment/ticket/4748/4748-branches2.0.diff)[​](/raw-attachment/ticket/4748/4748-branches2.0.diff "Download")
  added

Backport of $pagenow fix to 2.0

### [#8](#comment:8) [@westi](https://profiles.wordpress.org/westi) [17 years](/timeline?from=2007-09-09T09%3A41%3A44Z&precision=second "See timeline at 09/09/2007 09:41:44 AM") ago

I have attached a patch to backport the fix to 2.0 - untested.

### [#9](#comment:9) [@foolswisdom](https://profiles.wordpress.org/foolswisdom) [17 years](/timeline?from=2007-09-10T02%3A23%3A02Z&precision=second "See timeline at 09/10/2007 02:23:02 AM") ago

* **Milestone**
  changed from *2.3* to *2.0.12*
* **Resolution**
  *fixed* deleted
* **Status**
  changed from *closed* to *reopened*

### [#10](#comment:10) [@markjaquith](https://profiles.wordpress.org/markjaquith) [17 years](/timeline?from=2007-09-10T14%3A06%3A30Z&precision=second "See timeline at 09/10/2007 02:06:30 PM") ago

* **Resolution**
  set to *fixed*
* **Status**
  changed from *reopened* to *closed*

(In [[6066]](/changeset/6066 "Better $pagenow determination. fixes #4748 for 2.0")) Better $pagenow determination. fixes [#4748](/ticket/4748 "#4748: defect (bug): Unprivileged users can perform some actions on pages they aren't ... (closed: fixed)") for 2.0

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #cli by schlessera. [​View the logs](https://wordpress.slack.com/archives/cli/p1527006370000839).* [7 years](/timeline?from=2018-05-22T16%3A26%3A11Z&precision=second "See timeline at 05/22/2018 04:26:11 PM") ago

**Note:** See
[TracTickets](/wiki/TracTickets) for help on using
tickets.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Comma-delimited Text](/ticket/4748?format=csv)
* [Tab-delimited Text](/ticket/4748?format=tab)
* [RSS Feed](/ticket/4748?format=rss)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from trac.wordpress.org_051e584a_20250124_192156.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Core](https://make.wordpress.org/core/)

* [Blog](https://make.wordpress.org/core/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Browse Source](https://core.trac.wordpress.org/browser "Browse Source")
* [Trac Timeline](https://core.trac.wordpress.org/timeline "Trac Timeline")
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket "Create a New Ticket")

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fcore.trac.wordpress.org%2Fchangeset%3Fnew_path%3Dtags%252F2.2.3%26old%3D6063%26new%3D6063%26old_path%3Dtags%252F2.2.2)
* [Notifications](https://make.wordpress.org/core/notifications/)

## Context Navigation

* [Reverse Diff](/changeset/6063/tags/2.2.2?old=6063&old_path=%2Ftags%2F2.2.3)

---

# Changes from [tags/2.2.2](/browser/tags/2.2.2?rev=6063 "Show entry in browser") at [r6063](/changeset/6063 "Show full changeset") to [tags/2.2.3](/browser/tags/2.2.3?rev=6063 "Show entry in browser") at [r6063](/changeset/6063 "Show full changeset")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[tags/2.2.3](/browser/tags/2.2.3?rev=6063)
Files:

19 edited

* [wp-admin/admin-ajax.php](/browser/branches/2.2/wp-admin/admin-ajax.php?rev=5922 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [wp-admin/admin-functions.php](/browser/branches/2.2/wp-admin/admin-functions.php?rev=6018 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [wp-admin/install-rtl.css](/browser/branches/2.2/wp-admin/install-rtl.css?rev=5864 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [wp-admin/options.php](/browser/branches/2.2/wp-admin/options.php?rev=5915 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [wp-admin/rtl.css](/browser/branches/2.2/wp-admin/rtl.css?rev=5864 "Show entry in browser")
  (modified)
  ([6 diffs](#file4 "Show differences"))
* [wp-admin/widgets-rtl.css](/browser/branches/2.2/wp-admin/widgets-rtl.css?rev=5864 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [wp-includes/default-filters.php](/browser/branches/2.2/wp-includes/default-filters.php?rev=6036 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [wp-includes/feed-rss2-comments.php](/browser/branches/2.2/wp-includes/feed-rss2-comments.php?rev=5882 "Show entry in browser")
  (modified)
  ([2 diffs](#file7 "Show differences"))
* [wp-includes/formatting.php](/browser/branches/2.2/wp-includes/formatting.php?rev=5931 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [wp-includes/pluggable.php](/browser/branches/2.2/wp-includes/pluggable.php?rev=5993 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [wp-includes/plugin.php](/browser/branches/2.2/wp-includes/plugin.php?rev=6014 "Show entry in browser")
  (modified)
  ([4 diffs](#file10 "Show differences"))
* [wp-includes/query.php](/browser/branches/2.2/wp-includes/query.php?rev=6036 "Show entry in browser")
  (modified)
  ([3 diffs](#file11 "Show differences"))
* [wp-includes/rewrite.php](/browser/branches/2.2/wp-includes/rewrite.php?rev=5926 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [wp-includes/rss.php](/browser/branches/2.2/wp-includes/rss.php?rev=5961 "Show entry in browser")
  (modified)
  ([2 diffs](#file13 "Show differences"))
* [wp-includes/vars.php](/browser/branches/2.2/wp-includes/vars.php?rev=6061 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [wp-includes/version.php](/browser/branches/2.2/wp-includes/version.php?rev=6062 "Show entry in browser")
  (modified)
  ([1 diff](#file15 "Show differences"))
* [wp-includes/widgets.php](/browser/branches/2.2/wp-includes/widgets.php?rev=5877 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [wp-mail.php](/browser/branches/2.2/wp-mail.php?rev=5902 "Show entry in browser")
  (modified)
  ([1 diff](#file17 "Show differences"))
* [xmlrpc.php](/browser/branches/2.2/xmlrpc.php?rev=5905 "Show entry in browser")
  (modified)
  ([2 diffs](#file18 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [tags/2.2.3/wp-admin/admin-ajax.php](/changeset/5922/branches/2.2/wp-admin/admin-ajax.php?old=5118&old_path=trunk%2Fwp-admin%2Fadmin-ajax.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-admin/admin-ajax.php")

  | [r6063](/browser/trunk/wp-admin/admin-ajax.php?rev=5118#L287 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-admin/admin-ajax.php?rev=5922#L287 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 287 | 287 | } |
  | 288 | 288 | } |
  | 289 |  | die(~~$\_POST['post\_type']~~); |
  |  | 289 | die('0'); |
  | 290 | 290 | break; |
  | 291 | 291 | default : |
* ## [tags/2.2.3/wp-admin/admin-functions.php](/changeset/6018/branches/2.2/wp-admin/admin-functions.php?old=5839&old_path=branches%2F2.2%2Fwp-admin%2Fadmin-functions.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-admin/admin-functions.php")

  | [r6063](/browser/branches/2.2/wp-admin/admin-functions.php?rev=5839#L106 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-admin/admin-functions.php?rev=6018#L106 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 106 | 106 | $\_POST['post\_date\_gmt'] = get\_gmt\_from\_date( $\_POST['post\_date'] ); |
  | 107 | 107 | } |
  |  | 108 |  |
  |  | 109 | unset($\_POST['no\_filter']); |
  | 108 | 110 |  |
  | 109 | 111 | // Create the post. |
  | […](/browser/branches/2.2/wp-admin/admin-functions.php?rev=5839#L284) | […](/browser/branches/2.2/wp-admin/admin-functions.php?rev=6018#L286) |  |
  | 284 | 286 | } |
  | 285 | 287 |  |
  |  | 288 | unset($\_POST['no\_filter']); |
  |  | 289 |  |
  | 286 | 290 | add\_meta( $post\_ID ); |
  | 287 | 291 |  |
* ## [tags/2.2.3/wp-admin/install-rtl.css](/changeset/5864/branches/2.2/wp-admin/install-rtl.css?old=4421&old_path=trunk%2Fwp-admin%2Finstall-rtl.css "Show the [6063:6063] differences restricted to tags/2.2.3/wp-admin/install-rtl.css")

  | [r6063](/browser/trunk/wp-admin/install-rtl.css?rev=4421#L1 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-admin/install-rtl.css?rev=5864#L1 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | body { font~~-family:~~ Tahoma, Georgia, "Times New Roman", Times, serif; } |
  |  | 1 | body { font: 13px Tahoma, Georgia, "Times New Roman", Times, serif; } |
  | 2 | 2 |  |
  | 3 | 3 | ul, ol { padding: 5px 20px 5px 5px; } |
  | 4 | 4 |  |
  | 5 |  | .step, th { text-align: left; } |
  |  | 5 | h1, h2, h3 { font-family: "Times New Roman", Times, serif; font-weight: 700 } |
  |  | 6 |  |
  |  | 7 | .step, th { text-align: left } |
  |  | 8 |  |
  |  | 9 | input { font-family: "Times New Roman", Times, serif; padding: 1px } |
  |  | 10 |  |
  |  | 11 | #logo { background: url(../wp-content/plugins/WP-Jalali/wp-fa-logo.png) center right no-repeat; text-align: left; } |
  |  | 12 |  |
  |  | 13 | #admin\_email {direction: ltr; text-align: left; } |
  |  | 14 |  |
  |  | 15 | #footer { font-style: normal; } |
* ## [tags/2.2.3/wp-admin/options.php](/changeset/5915/branches/2.2/wp-admin/options.php?old=5833&old_path=branches%2F2.2%2Fwp-admin%2Foptions.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-admin/options.php")

  | [r6063](/browser/branches/2.2/wp-admin/options.php?rev=5833#L10 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-admin/options.php?rev=5915#L10 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | if ( !current\_user\_can('manage\_options') ) |
  | 11 | 11 | wp\_die(\_\_('Cheatin&#8217; uh?')); |
  | 12 |  |  |
  | 13 |  | ~~function sanitize\_option($option, $value) { // Remember to call stripslashes!~~ |
  | 14 |  |  |
  | 15 |  | ~~switch ($option) {~~ |
  | 16 |  | ~~case 'admin\_email':~~ |
  | 17 |  | ~~$value = stripslashes($value);~~ |
  | 18 |  | ~~$value = sanitize\_email($value);~~ |
  | 19 |  | ~~break;~~ |
  | 20 |  |  |
  | 21 |  | ~~case 'default\_post\_edit\_rows':~~ |
  | 22 |  | ~~case 'mailserver\_port':~~ |
  | 23 |  | ~~case 'comment\_max\_links':~~ |
  | 24 |  | ~~$value = stripslashes($value);~~ |
  | 25 |  | ~~$value = abs((int) $value);~~ |
  | 26 |  | ~~break;~~ |
  | 27 |  |  |
  | 28 |  | ~~case 'posts\_per\_page':~~ |
  | 29 |  | ~~case 'posts\_per\_rss':~~ |
  | 30 |  | ~~$value = stripslashes($value);~~ |
  | 31 |  | ~~$value = (int) $value;~~ |
  | 32 |  | ~~if ( empty($value) ) $value = 1;~~ |
  | 33 |  | ~~if ( $value < -1 ) $value = abs($value);~~ |
  | 34 |  | ~~break;~~ |
  | 35 |  |  |
  | 36 |  | ~~case 'default\_ping\_status':~~ |
  | 37 |  | ~~case 'default\_comment\_status':~~ |
  | 38 |  | ~~$value = stripslashes($value);~~ |
  | 39 |  | ~~// Options that if not there have 0 value but need to be something like "closed"~~ |
  | 40 |  | ~~if ( $value == '0' || $value == '')~~ |
  | 41 |  | ~~$value = 'closed';~~ |
  | 42 |  | ~~break;~~ |
  | 43 |  |  |
  | 44 |  | ~~case 'blogdescription':~~ |
  | 45 |  | ~~case 'blogname':~~ |
  | 46 |  | ~~if (current\_user\_can('unfiltered\_html') == false)~~ |
  | 47 |  | ~~$value = wp\_filter\_post\_kses( $value ); // calls stripslashes then addslashes~~ |
  | 48 |  | ~~$value = stripslashes($value);~~ |
  | 49 |  | ~~break;~~ |
  | 50 |  |  |
  | 51 |  | ~~case 'blog\_charset':~~ |
  | 52 |  | ~~$value = preg\_replace('/[^a-zA-Z0-9\_-]/', '', $value); // strips slashes~~ |
  | 53 |  | ~~break;~~ |
  | 54 |  |  |
  | 55 |  | ~~case 'date\_format':~~ |
  | 56 |  | ~~case 'time\_format':~~ |
  | 57 |  | ~~case 'mailserver\_url':~~ |
  | 58 |  | ~~case 'mailserver\_login':~~ |
  | 59 |  | ~~case 'mailserver\_pass':~~ |
  | 60 |  | ~~case 'ping\_sites':~~ |
  | 61 |  | ~~case 'upload\_path':~~ |
  | 62 |  | ~~$value = strip\_tags($value);~~ |
  | 63 |  | ~~$value = wp\_filter\_kses($value); // calls stripslashes then addslashes~~ |
  | 64 |  | ~~$value = stripslashes($value);~~ |
  | 65 |  | ~~break;~~ |
  | 66 |  |  |
  | 67 |  | ~~case 'gmt\_offset':~~ |
  | 68 |  | ~~$value = preg\_replace('/[^0-9:.-]/', '', $value); // strips slashes~~ |
  | 69 |  | ~~break;~~ |
  | 70 |  |  |
  | 71 |  | ~~case 'siteurl':~~ |
  | 72 |  | ~~case 'home':~~ |
  | 73 |  | ~~$value = stripslashes($value);~~ |
  | 74 |  | ~~$value = clean\_url($value);~~ |
  | 75 |  | ~~break;~~ |
  | 76 |  | ~~default :~~ |
  | 77 |  | ~~$value = stripslashes($value);~~ |
  | 78 |  | ~~break;~~ |
  | 79 |  | ~~}~~ |
  | 80 |  |  |
  | 81 |  | ~~return $value;~~ |
  | 82 |  | ~~}~~ |
  | 83 | 12 |  |
  | 84 | 13 | switch($action) { |
* ## [tags/2.2.3/wp-admin/rtl.css](/changeset/5864/branches/2.2/wp-admin/rtl.css?old=5264&old_path=trunk%2Fwp-admin%2Frtl.css "Show the [6063:6063] differences restricted to tags/2.2.3/wp-admin/rtl.css")

  | [r6063](/browser/trunk/wp-admin/rtl.css?rev=5264#L1 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-admin/rtl.css?rev=5864#L1 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | #viewarc, #viewcat, #namediv, #emaildiv, #uridiv, #planetnews li, #login ul li, #your-profile fieldset, |
  | 2 |  | #footer .logo, .alignleft .available-theme { float: right; } |
  | 3 |  |  |
  | 4 |  | #templateside, .alignright { float: left; } |
  | 5 |  |  |
  | 6 |  | #login #send, .readmore, .widefat th { text-align: right; } |
  | 7 |  |  |
  | 8 |  | #postcustomsubmit, form#upload th, .submit, .editform th { text-align: left; } |
  | 9 |  |  |
  | 10 |  | #devnews h4, #wphead h1, #your-profile legend, fieldset.options legend, |
  | 11 |  | #planetnews li .post { font-family: Tahoma, Georgia, "Times New Roman", Times, serif; } |
  | 12 |  |  |
  | 13 |  | #wphead { padding: .8em 2em .8em 19em; } |
  | 14 |  |  |
  | 15 |  | #wphead h1 { font-size: 2.4em; } |
  | 16 |  |  |
  | 17 |  | #postdiv, #titlediv, #guiddiv, #tagdiv { margin: 0 0 0 8px; } |
  | 18 |  |  |
  | 19 |  | #ed\_toolbar input { margin: 3px 0 2px 2px; } |
  | 20 |  |  |
  | 21 |  | #edButtons input, #edButtons input:active { margin: 0px 0 -1px 2px; } |
  | 22 |  |  |
  | 23 |  | body, td { font: 13px Tahoma, "Lucida Grande", "Lucida Sans Unicode", Verdana; } |
  | 24 |  |  |
  | 25 |  | h2 { font: normal 32px/5px serif; } |
  | 26 |  |  |
  | 27 |  | textarea, input, select { font:  13px Tahoma, Verdana, Arial, Helvetica, sans-serif; } |
  | 28 |  |  |
  | 29 |  | .quicktags, .search { font: 12px Tahoma, Georgia, "Times New Roman", Times, serif; } |
  | 30 |  |  |
  | 31 |  | .updated, .confirm { padding: 0 3em 0 1em; } |
  |  | 1 | #viewarc, #viewcat, #namediv, #emaildiv, #uridiv, #planetnews li, #login ul li, #your-profile fieldset, #footer .logo, .alignleft .available-theme { |
  |  | 2 | float: right; |
  |  | 3 | } |
  |  | 4 |  |
  |  | 5 | #templateside, .alignright { |
  |  | 6 | float: left; |
  |  | 7 | } |
  |  | 8 |  |
  |  | 9 | #login #send, .readmore, .widefat th { |
  |  | 10 | text-align: right; |
  |  | 11 | } |
  |  | 12 |  |
  |  | 13 | #postcustomsubmit, form#upload th, .submit, .editform th { |
  |  | 14 | text-align: left; |
  |  | 15 | } |
  |  | 16 |  |
  |  | 17 | #devnews h4, #wphead h1, #your-profile legend, fieldset.options legend, #planetnews li .post { |
  |  | 18 | font-family: Tahoma, Georgia, "Times New Roman", Times, serif; |
  |  | 19 | } |
  |  | 20 |  |
  |  | 21 | #wphead { |
  |  | 22 | padding: .8em 2em .8em 19em; |
  |  | 23 | } |
  |  | 24 |  |
  |  | 25 | #wphead h1 { |
  |  | 26 | font-size: 2.4em; |
  |  | 27 | } |
  |  | 28 |  |
  |  | 29 | #postdiv, #titlediv, #guiddiv, #tagdiv { |
  |  | 30 | margin: 0 0 0 8px; |
  |  | 31 | } |
  |  | 32 |  |
  |  | 33 | #ed\_toolbar input { |
  |  | 34 | margin: 3px 0 2px 2px; |
  |  | 35 | } |
  |  | 36 |  |
  |  | 37 | #edButtons input, #edButtons input:active { |
  |  | 38 | margin: 0px 0 -1px 2px; |
  |  | 39 | } |
  |  | 40 |  |
  |  | 41 | body, td { |
  |  | 42 | font: 13px Tahoma, "Lucida Grande", "Lucida Sans Unicode", Verdana; |
  |  | 43 | } |
  |  | 44 |  |
  |  | 45 | h1, h2, h3, h4, h5 { |
  |  | 46 | font-family: "Times New Roman", Times, serif; |
  |  | 47 | } |
  |  | 48 | h3.dbx-handle { |
  |  | 49 | font-family: tahoma, Verdana, Arial, Helvetica, sans-serif; |
  |  | 50 | } |
  |  | 51 |  |
  |  | 52 | textarea, input, select { |
  |  | 53 | font:  13px Tahoma, Verdana, Arial, Helvetica, sans-serif; |
  |  | 54 | } |
  |  | 55 |  |
  |  | 56 | .quicktags, .search { |
  |  | 57 | font: 12px Tahoma, Georgia, "Times New Roman", Times, serif; |
  |  | 58 | } |
  |  | 59 |  |
  |  | 60 | .updated, .confirm { |
  |  | 61 | padding: 0 3em 0 1em; |
  |  | 62 | } |
  | 32 | 63 |  |
  | 33 | 64 | .submit input, .submit input:focus, .button, .button:focus { |
  | 34 | 65 | border-left-color: #999; |
  | 35 | 66 | border-right-color: #ccc; |
  | 36 |  | } |
  |  | 67 | } |
  | 37 | 68 |  |
  | 38 | 69 | .submit input:active, .button:active { |
  | 39 | 70 | border-left-color: #ccc; |
  | 40 | 71 | border-right-color: #999; |
  | 41 |  | } |
  |  | 72 | } |
  | 42 | 73 |  |
  | 43 | 74 | #adminmenu { |
  | 44 | 75 | padding: .2em 2em .3em .2em; |
  | 45 | 76 | height: 28px; |
  | 46 |  | } |
  | 47 |  |  |
  | 48 |  | #adminmenu li { line-height: 160%; } |
  |  | 77 | } |
  | 49 | 78 |  |
  | 50 | 79 | #adminmenu a { |
  | […](/browser/trunk/wp-admin/rtl.css?rev=5264#L52) | […](/browser/branches/2.2/wp-admin/rtl.css?rev=5864#L81) |  |
  | 52 | 81 | display: block; |
  | 53 | 82 | float: right; |
  | 54 |  | } |
  |  | 83 | font: 700 16px/130% "Times New Roman", Times, serif; |
  |  | 84 | } |
  | 55 | 85 |  |
  | 56 | 86 | #adminmenu a.current { |
  | 57 | 87 | border-right: 0; |
  | 58 | 88 | border-left: 2px solid #4f96c8; |
  | 59 |  | } |
  | 60 |  |  |
  | 61 |  | #submenu, #minisub { padding: 1px 3em 0 2em; } |
  | 62 |  |  |
  | 63 |  | #submenu { height: 28px; } |
  | 64 |  |  |
  | 65 |  | #submenu li { line-height: 160%; } |
  |  | 89 | } |
  |  | 90 |  |
  |  | 91 | #submenu, #minisub { |
  |  | 92 | padding: 1px 3em 0 2em; |
  |  | 93 | } |
  |  | 94 |  |
  |  | 95 | #submenu { |
  |  | 96 | height: 28px; |
  |  | 97 | } |
  | 66 | 98 |  |
  | 67 | 99 | #submenu a { |
  | […](/browser/trunk/wp-admin/rtl.css?rev=5264#L69) | […](/browser/branches/2.2/wp-admin/rtl.css?rev=5864#L101) |  |
  | 69 | 101 | display: block; |
  | 70 | 102 | float: right; |
  | 71 |  | } |
  |  | 103 | line-height: 155%; |
  |  | 104 | } |
  | 72 | 105 |  |
  | 73 | 106 | #submenu .current { |
  | 74 | 107 | border-right: 0; |
  | 75 | 108 | border-left: 2px solid #045290; |
  | 76 |  | } |
  |  | 109 | } |
  | 77 | 110 |  |
  | 78 | 111 | #currenttheme img { |
  | […](/browser/trunk/wp-admin/rtl.css?rev=5264#L80) | […](/browser/branches/2.2/wp-admin/rtl.css?rev=5864#L113) |  |
  | 80 | 113 | margin-right: auto; |
  | 81 | 114 | margin-left: 1em; |
  | 82 |  | } |
  |  | 115 | } |
  | 83 | 116 |  |
  | 84 | 117 | #postdiv #quicktags { |
  | 85 | 118 | padding-right: 0; |
  | 86 | 119 | padding-left: 6px; |
  | 87 |  | } |
  |  | 120 | } |
  | 88 | 121 |  |
  | 89 | 122 | .readmore { |
  | 90 | 123 | margin-right: auto; |
  | 91 | 124 | margin-left: 5em; |
  | 92 |  | } |
  |  | 125 | } |
  | 93 | 126 |  |
  | 94 | 127 | #postexcerpt div, #attachmentlinks div { |
  | 95 | 128 | margin-right: auto; |
  | 96 | 129 | margin-left: 8px; |
  | 97 |  | } |
  |  | 130 | } |
  | 98 | 131 |  |
  | 99 | 132 | \* html #postexcerpt .dbx-toggle-open { |
  | 100 | 133 | padding-right: 0; |
  | 101 | 134 | padding-left: 8px; |
  | 102 |  | } |
  |  | 135 | } |
  | 103 | 136 |  |
  | 104 | 137 | #searchform { |
  | […](/browser/trunk/wp-admin/rtl.css?rev=5264#L106) | […](/browser/branches/2.2/wp-admin/rtl.css?rev=5864#L139) |  |
  | 106 | 139 | margin-right: auto; |
  | 107 | 140 | margin-left: 1em; |
  | 108 |  | } |
  |  | 141 | } |
  | 109 | 142 |  |
  | 110 | 143 | #poststuff { |
  | 111 | 144 | margin-right: auto; |
  | 112 | 145 | margin-left: 16em; |
  | 113 |  | } |
  |  | 146 | } |
  | 114 | 147 |  |
  | 115 | 148 | #template div { |
  | 116 | 149 | margin-right: auto; |
  | 117 | 150 | margin-left: 190px; |
  | 118 |  | } |
  |  | 151 | } |
  | 119 | 152 |  |
  | 120 | 153 | \* html #template div { |
  | 121 | 154 | margin-right: auto; |
  | 122 | 155 | margin-left: 0px; |
  | 123 |  | } |
  |  | 156 | } |
  | 124 | 157 |  |
  | 125 | 158 | #user\_info { |
  | 126 | 159 | right: auto; |
  | 127 | 160 | left: 1em; |
  | 128 |  | } |
  | 129 |  |  |
  |  | 161 | } |
  |  | 162 |  |
  | 130 | 163 | #zeitgeist { |
  | 131 | 164 | float: left; |
  | 132 | 165 | margin-left: auto; |
  | 133 | 166 | margin-right: 1em; |
  | 134 |  | } |
  |  | 167 | } |
  | 135 | 168 |  |
  | 136 | 169 | #zeitgeist ul { |
  | 137 | 170 | margin: 0 .6em .3em 0; |
  | 138 | 171 | padding: 0 .6em 0 0; |
  | 139 |  | } |
  |  | 172 | } |
  |  | 173 |  |
  |  | 174 | .wrap ul { |
  |  | 175 | margin-left: 500px; |
  |  | 176 | } |
  | 140 | 177 |  |
  | 141 | 178 | #categorydiv ul { |
  | 142 | 179 | margin-left: auto; |
  | 143 | 180 | margin-right: 10px; |
  | 144 |  | } |
  | 145 |  |  |
  | 146 |  | #moremeta fieldset div { margin: 2px 0px 0 0; } |
  |  | 181 | } |
  | 147 | 182 |  |
  | 148 | 183 | #moremeta { |
  | 149 |  | margin-right: ~~auto~~; |
  |  | 184 | margin-right: 0; |
  | 150 | 185 | margin-left: 15px; |
  | 151 | 186 | right: auto; |
  | 152 |  | left: ~~5~~%; |
  | 153 |  | } |
  | 154 |  |  |
  |  | 187 | left: 6%; |
  |  | 188 | } |
  |  | 189 |  |
  | 155 | 190 | #moremeta .dbx-content { |
  | 156 | 191 | background: url(images/box-butt.gif) no-repeat bottom left; |
  | 157 |  | padding-right: 0; |
  | 158 |  | padding-left: 2px; |
  | 159 |  | } |
  | 160 |  |  |
  | 161 |  | #moremeta .dbx-handle { background: #2685af url(images/box-head.gif) no-repeat left; } |
  | 162 |  |  |
  | 163 |  | #moremeta .dbx-box { background: url(images/box-bg.gif) repeat-y left; } |
  |  | 192 | padding-right: 10px; |
  |  | 193 | padding-left: 0; |
  |  | 194 | text-align: right; |
  |  | 195 | } |
  |  | 196 |  |
  |  | 197 | #moremeta .dbx-handle { |
  |  | 198 | background: #2685af url(images/box-head.gif) no-repeat left; |
  |  | 199 | margin-top: -2px; |
  |  | 200 | } |
  |  | 201 |  |
  |  | 202 | #moremeta .dbx-box { |
  |  | 203 | background: url(images/box-bg.gif) repeat-y left; |
  |  | 204 | padding-bottom: 0; |
  |  | 205 | } |
  | 164 | 206 |  |
  | 165 | 207 | a.dbx-toggle, a.dbx-toggle:visited { |
  | 166 | 208 | right: auto; |
  | 167 | 209 | left: 2px; |
  | 168 |  | } |
  | 169 |  |  |
  | 170 |  | #advancedstuff a.dbx-toggle, #advancedstuff a.dbx-toggle-open:visited { |
  | 171 |  | right: auto; |
  | 172 |  | left: 5px; |
  | 173 |  | } |
  | 174 |  |  |
  | 175 |  | #advancedstuff a.dbx-toggle-open, #advancedstuff a.dbx-toggle-open:visited { |
  | 176 |  | right: auto; |
  | 177 |  | left: 5px; |
  | 178 |  | } |
  |  | 210 | } |
  |  | 211 |  |
  | 179 | 212 |  |
  | 180 | 213 | #categorychecklist { |
  | 181 | 214 | margin-right: auto; |
  | 182 | 215 | margin-left: 6px; |
  | 183 |  | } |
  |  | 216 | } |
  | 184 | 217 |  |
  | 185 | 218 | #ajax-response.alignleft { |
  | 186 | 219 | margin-left: auto; |
  | 187 | 220 | margin-right: 2em; |
  | 188 |  | } |
  |  | 221 | } |
  | 189 | 222 |  |
  | 190 | 223 | #postdivrich #edButtons { |
  | 191 | 224 | padding-left: 0; |
  | 192 | 225 | padding-right: 3px; |
  | 193 |  | } |
  |  | 226 | } |
  | 194 | 227 |  |
  | 195 | 228 | .page-numbers { |
  | 196 | 229 | margin-right: auto; |
  | 197 | 230 | margin-left: 3px; |
  | 198 |  | } |
  |  | 231 | } |
  | 199 | 232 |  |
  | 200 | 233 | a.view-link { |
  | […](/browser/trunk/wp-admin/rtl.css?rev=5264#L203) | […](/browser/branches/2.2/wp-admin/rtl.css?rev=5864#L236) |  |
  | 203 | 236 | margin-right:0; |
  | 204 | 237 | margin-left:220px; |
  | 205 |  | } |
  |  | 238 | } |
  |  | 239 | #advancedstuff { |
  |  | 240 | direction: ltr; |
  |  | 241 | } |
  |  | 242 | #advancedstuff .dbx-handle { |
  |  | 243 | text-align: right; |
  |  | 244 | } |
  |  | 245 | #advancedstuff .dbx-content \* { |
  |  | 246 | direction: rtl; |
  |  | 247 | } |
* ## [tags/2.2.3/wp-admin/widgets-rtl.css](/changeset/5864/branches/2.2/wp-admin/widgets-rtl.css?old=5332&old_path=branches%2F2.2%2Fwp-admin%2Fwidgets-rtl.css "Show the [6063:6063] differences restricted to tags/2.2.3/wp-admin/widgets-rtl.css")

  | [r6063](/browser/branches/2.2/wp-admin/widgets-rtl.css?rev=5332#L5 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-admin/widgets-rtl.css?rev=5864#L5 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | \* html #palettediv ul { padding: 0 10px 0 0; } |
  | 6 | 6 |  |
  | 7 |  | #palettediv ul { padding: 0 10px 0 0; } |
  |  | 7 | #palettediv ul { padding: 0 10px 0 0; |
  |  | 8 | margin-left: 1px!important;} |
  | 8 | 9 |  |
  | 9 | 10 | \* .handle, #lastmodule span { |
* ## [tags/2.2.3/wp-includes/default-filters.php](/changeset/6036/branches/2.2/wp-includes/default-filters.php?old=5463&old_path=branches%2F2.2%2Fwp-includes%2Fdefault-filters.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/default-filters.php")

  | [r6063](/browser/branches/2.2/wp-includes/default-filters.php?rev=5463#L130 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/default-filters.php?rev=6036#L130 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 130 | 130 | add\_filter('sanitize\_title', 'sanitize\_title\_with\_dashes'); |
  | 131 | 131 |  |
  |  | 132 | add\_filter('wp\_title', 'wp\_specialchars'); |
  |  | 133 |  |
  | 132 | 134 | // RSS filters |
  | 133 | 135 | add\_filter('the\_title\_rss', 'strip\_tags'); |
* ## [tags/2.2.3/wp-includes/feed-rss2-comments.php](/changeset/5882/branches/2.2/wp-includes/feed-rss2-comments.php?old=5391&old_path=branches%2F2.2%2Fwp-includes%2Ffeed-rss2-comments.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/feed-rss2-comments.php")

  | [r6063](/browser/branches/2.2/wp-includes/feed-rss2-comments.php?rev=5391#L6 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/feed-rss2-comments.php?rev=5882#L6 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | <!-- generator="wordpress/<?php echo $wp\_version ?>" --> |
  | 7 | 7 | <rss version="2.0" |
  | 8 |  | xmlns:content="http://purl.org/rss/1.0/modules/content/"> |
  |  | 8 | xmlns:content="http://purl.org/rss/1.0/modules/content/" |
  |  | 9 | xmlns:dc="http://purl.org/dc/elements/1.1/" |
  |  | 10 | > |
  | 9 | 11 | <channel> |
  | 10 | 12 | <title><?php |
  | […](/browser/branches/2.2/wp-includes/feed-rss2-comments.php?rev=5391#L38) | […](/browser/branches/2.2/wp-includes/feed-rss2-comments.php?rev=5882#L40) |  |
  | 38 | 40 | ?></title> |
  | 39 | 41 | <link><?php comment\_link() ?></link> |
  | 40 |  | <~~author><?php echo get\_comment\_author\_rss() ?></auth~~or> |
  |  | 42 | <dc:creator><?php echo get\_comment\_author\_rss() ?></dc:creator> |
  | 41 | 43 | <pubDate><?php echo mysql2date('D, d M Y H:i:s +0000', get\_comment\_time('Y-m-d H:i:s', true), false); ?></pubDate> |
  | 42 | 44 | <guid><?php comment\_link() ?></guid> |
* ## [tags/2.2.3/wp-includes/formatting.php](/changeset/5931/branches/2.2/wp-includes/formatting.php?old=5735&old_path=branches%2F2.2%2Fwp-includes%2Fformatting.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/formatting.php")

  | [r6063](/browser/branches/2.2/wp-includes/formatting.php?rev=5735#L12 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/formatting.php?rev=5931#L12 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | if ( isset($wp\_cockneyreplace) ) { |
  | 13 | 13 | $cockney = array\_keys($wp\_cockneyreplace); |
  | 14 |  | $cockney~~\_~~replace = array\_values($wp\_cockneyreplace); |
  |  | 14 | $cockneyreplace = array\_values($wp\_cockneyreplace); |
  | 15 | 15 | } else { |
  | 16 | 16 | $cockney = array("'tain't","'twere","'twas","'tis","'twill","'til","'bout","'nuff","'round","'cause"); |
  | […](/browser/branches/2.2/wp-includes/formatting.php?rev=5735#L1119) | […](/browser/branches/2.2/wp-includes/formatting.php?rev=5931#L1119) |  |
  | 1119 | 1119 | } |
  | 1120 | 1120 |  |
  |  | 1121 | function sanitize\_option($option, $value) { // Remember to call stripslashes! |
  |  | 1122 |  |
  |  | 1123 | switch ($option) { |
  |  | 1124 | case 'admin\_email': |
  |  | 1125 | $value = sanitize\_email($value); |
  |  | 1126 | break; |
  |  | 1127 |  |
  |  | 1128 | case 'default\_post\_edit\_rows': |
  |  | 1129 | case 'mailserver\_port': |
  |  | 1130 | case 'comment\_max\_links': |
  |  | 1131 | case 'page\_on\_front': |
  |  | 1132 | case 'rss\_excerpt\_length': |
  |  | 1133 | case 'default\_category': |
  |  | 1134 | case 'default\_email\_category': |
  |  | 1135 | case 'default\_link\_category': |
  |  | 1136 | $value = abs((int) $value); |
  |  | 1137 | break; |
  |  | 1138 |  |
  |  | 1139 | case 'posts\_per\_page': |
  |  | 1140 | case 'posts\_per\_rss': |
  |  | 1141 | $value = (int) $value; |
  |  | 1142 | if ( empty($value) ) $value = 1; |
  |  | 1143 | if ( $value < -1 ) $value = abs($value); |
  |  | 1144 | break; |
  |  | 1145 |  |
  |  | 1146 | case 'default\_ping\_status': |
  |  | 1147 | case 'default\_comment\_status': |
  |  | 1148 | // Options that if not there have 0 value but need to be something like "closed" |
  |  | 1149 | if ( $value == '0' || $value == '') |
  |  | 1150 | $value = 'closed'; |
  |  | 1151 | break; |
  |  | 1152 |  |
  |  | 1153 | case 'blogdescription': |
  |  | 1154 | case 'blogname': |
  |  | 1155 | $value = addslashes($value); |
  |  | 1156 | $value = wp\_filter\_post\_kses( $value ); // calls stripslashes then addslashes |
  |  | 1157 | $value = stripslashes($value); |
  |  | 1158 | $value = wp\_specialchars( $value ); |
  |  | 1159 | break; |
  |  | 1160 |  |
  |  | 1161 | case 'blog\_charset': |
  |  | 1162 | $value = preg\_replace('/[^a-zA-Z0-9\_-]/', '', $value); // strips slashes |
  |  | 1163 | break; |
  |  | 1164 |  |
  |  | 1165 | case 'date\_format': |
  |  | 1166 | case 'time\_format': |
  |  | 1167 | case 'mailserver\_url': |
  |  | 1168 | case 'mailserver\_login': |
  |  | 1169 | case 'mailserver\_pass': |
  |  | 1170 | case 'ping\_sites': |
  |  | 1171 | case 'upload\_path': |
  |  | 1172 | $value = strip\_tags($value); |
  |  | 1173 | $value = addslashes($value); |
  |  | 1174 | $value = wp\_filter\_kses($value); // calls stripslashes then addslashes |
  |  | 1175 | $value = stripslashes($value); |
  |  | 1176 | break; |
  |  | 1177 |  |
  |  | 1178 | case 'gmt\_offset': |
  |  | 1179 | $value = preg\_replace('/[^0-9:.-]/', '', $value); // strips slashes |
  |  | 1180 | break; |
  |  | 1181 |  |
  |  | 1182 | case 'siteurl': |
  |  | 1183 | case 'home': |
  |  | 1184 | $value = stripslashes($value); |
  |  | 1185 | $value = clean\_url($value); |
  |  | 1186 | break; |
  |  | 1187 | default : |
  |  | 1188 | break; |
  |  | 1189 | } |
  |  | 1190 |  |
  |  | 1191 | return $value; |
  |  | 1192 | } |
  |  | 1193 |  |
  | 1121 | 1194 | function wp\_parse\_str( $string, &$array ) { |
  | 1122 | 1195 | parse\_str( $string, $array ); |
* ## [tags/2.2.3/wp-includes/pluggable.php](/changeset/5993/branches/2.2/wp-includes/pluggable.php?old=5714&old_path=branches%2F2.2%2Fwp-includes%2Fpluggable.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/pluggable.php")

  | [r6063](/browser/branches/2.2/wp-includes/pluggable.php?rev=5714#L321 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/pluggable.php?rev=5993#L321 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 321 | 321 | $location = wp\_kses\_no\_null($location); |
  | 322 | 322 |  |
  |  | 323 | // remove %0d and %0a from location |
  | 323 | 324 | $strip = array('%0d', '%0a'); |
  | 324 |  | $location = str\_replace($strip, '', $location); |
  |  | 325 | $found = true; |
  |  | 326 | while($found) { |
  |  | 327 | $found = false; |
  |  | 328 | foreach($strip as $val) { |
  |  | 329 | while(strpos($location, $val) !== false) { |
  |  | 330 | $found = true; |
  |  | 331 | $location = str\_replace($val, '', $location); |
  |  | 332 | } |
  |  | 333 | } |
  |  | 334 | } |
  | 325 | 335 |  |
  | 326 | 336 | if ( $is\_IIS ) { |
* ## [tags/2.2.3/wp-includes/plugin.php](/changeset/6014/branches/2.2/wp-includes/plugin.php?old=5412&old_path=branches%2F2.2%2Fwp-includes%2Fplugin.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/plugin.php")

  | [r6063](/browser/branches/2.2/wp-includes/plugin.php?rev=5412#L20 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/plugin.php?rev=6014#L20 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 |  |
  | 21 | 21 | // So the format is wp\_filter['tag']['array of priorities']['array of functions serialized']['array of ['array (functions, accepted\_args)]'] |
  | 22 |  | $wp\_filter[$tag][$priority][~~serialize($function\_to\_add~~)] = array('function' => $function\_to\_add, 'accepted\_args' => $accepted\_args); |
  |  | 22 | $wp\_filter[$tag][$priority][\_wp\_filter\_build\_unique\_id($tag, $function\_to\_add, $priority)] = array('function' => $function\_to\_add, 'accepted\_args' => $accepted\_args); |
  | 23 | 23 | unset( $merged\_filters[ $tag ] ); |
  | 24 | 24 | return true; |
  | […](/browser/branches/2.2/wp-includes/plugin.php?rev=5412#L99) | […](/browser/branches/2.2/wp-includes/plugin.php?rev=6014#L99) |  |
  | 99 | 99 | function remove\_filter($tag, $function\_to\_remove, $priority = 10, $accepted\_args = 1) { |
  | 100 | 100 | global $wp\_filter, $merged\_filters; |
  | 101 |  |  |
  | 102 |  | unset($GLOBALS['wp\_filter'][$tag][$priority][~~serialize($function\_to\_remove~~)]); |
  |  | 101 |  |
  |  | 102 | unset($GLOBALS['wp\_filter'][$tag][$priority][\_wp\_filter\_build\_unique\_id($tag, $function\_to\_remove, $priority)]); |
  | 103 | 103 | unset( $merged\_filters[ $tag ] ); |
  | 104 | 104 |  |
  | […](/browser/branches/2.2/wp-includes/plugin.php?rev=5412#L236) | […](/browser/branches/2.2/wp-includes/plugin.php?rev=6014#L236) |  |
  | 236 | 236 | \*/ |
  | 237 | 237 | function plugin\_basename($file) { |
  | 238 |  | $file = preg\_replace('|\\\\+|', '\\\\', $file); |
  | 239 |  | $file = preg\_replace('/^.\*wp-content[\\\\\/]plugins[\\\\\/]/', '', $file); |
  |  | 238 | $file = str\_replace('\\','/',$file); // sanitize for Win32 installs |
  |  | 239 | $file = preg\_replace('|/+|','/', $file); // remove any duplicate slash |
  |  | 240 | $file = preg\_replace('|^.\*/wp-content/plugins/|','',$file); // get relative path from plugins dir |
  | 240 | 241 | return $file; |
  | 241 | 242 | } |
  | […](/browser/branches/2.2/wp-includes/plugin.php?rev=5412#L279) | […](/browser/branches/2.2/wp-includes/plugin.php?rev=6014#L280) |  |
  | 279 | 280 | } |
  | 280 | 281 |  |
  |  | 282 | function \_wp\_filter\_build\_unique\_id($tag, $function, $priority = 10) |
  |  | 283 | { |
  |  | 284 | global $wp\_filter; |
  |  | 285 |  |
  |  | 286 | // If function then just skip all of the tests and not overwrite the following. |
  |  | 287 | if( is\_string($function) ) |
  |  | 288 | return $function; |
  |  | 289 | // Object Class Calling |
  |  | 290 | else if(is\_object($function[0]) ) |
  |  | 291 | { |
  |  | 292 | $obj\_idx = get\_class($function[0]).$function[1]; |
  |  | 293 | if( is\_null($function[0]->wp\_filter\_id) ) { |
  |  | 294 | $count = count((array)$wp\_filter[$tag][$priority]); |
  |  | 295 | $function[0]->wp\_filter\_id = $count; |
  |  | 296 | $obj\_idx .= $count; |
  |  | 297 | unset($count); |
  |  | 298 | } else |
  |  | 299 | $obj\_idx .= $function[0]->wp\_filter\_id; |
  |  | 300 | return $obj\_idx; |
  |  | 301 | } |
  |  | 302 | // Static Calling |
  |  | 303 | else if( is\_string($function[0]) ) |
  |  | 304 | return $function[0].$function[1]; |
  |  | 305 | } |
  |  | 306 |  |
  | 281 | 307 | ?> |
* ## [tags/2.2.3/wp-includes/query.php](/changeset/6036/branches/2.2/wp-includes/query.php?old=5314&old_path=branches%2F2.2%2Fwp-includes%2Fquery.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/query.php")

  | [r6063](/browser/branches/2.2/wp-includes/query.php?rev=5314#L414 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/query.php?rev=6036#L414 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 414 | 414 | $qv = &$this->query\_vars; |
  | 415 | 415 |  |
  | 416 |  | if ( ! empty($qv['robots']) )~~{~~ |
  |  | 416 | if ( ! empty($qv['robots']) ) |
  | 417 | 417 | $this->is\_robots = true; |
  | 418 |  | ~~return;~~ |
  | 419 |  | ~~}~~ |
  | 420 |  |  |
  | 421 |  | ~~if ('404' == $qv['error']) {~~ |
  | 422 |  | ~~$this->is\_404 = true;~~ |
  | 423 |  | ~~if ( !empty($query) ) {~~ |
  | 424 |  | ~~do\_action\_ref\_array('parse\_query', array(&$this));~~ |
  | 425 |  | ~~}~~ |
  | 426 |  | ~~return;~~ |
  | 427 |  | ~~}~~ |
  | 428 | 418 |  |
  | 429 | 419 | $qv['p'] =  (int) $qv['p']; |
  | […](/browser/branches/2.2/wp-includes/query.php?rev=5314#L607) | […](/browser/branches/2.2/wp-includes/query.php?rev=6036#L597) |  |
  | 607 | 597 | } |
  | 608 | 598 |  |
  |  | 599 | if ( !empty($qv['post\_type']) ) |
  |  | 600 | $qv['post\_type'] = sanitize\_user($qv['post\_type'], true); |
  |  | 601 |  |
  |  | 602 | if ( !empty($qv['post\_status']) ) |
  |  | 603 | $qv['post\_status'] = sanitize\_user($qv['post\_status'], true); |
  |  | 604 |  |
  | 609 | 605 | if ( $this->is\_posts\_page && !$qv['withcomments'] ) |
  | 610 | 606 | $this->is\_comment\_feed = false; |
  | […](/browser/branches/2.2/wp-includes/query.php?rev=5314#L612) | […](/browser/branches/2.2/wp-includes/query.php?rev=6036#L608) |  |
  | 612 | 608 | $this->is\_singular = $this->is\_single || $this->is\_page || $this->is\_attachment; |
  | 613 | 609 | // Done correcting is\_\* for page\_on\_front and page\_for\_posts |
  |  | 610 |  |
  |  | 611 | if ('404' == $qv['error']) |
  |  | 612 | $this->set\_404(); |
  | 614 | 613 |  |
  | 615 | 614 | if ( !empty($query) ) |
* ## [tags/2.2.3/wp-includes/rewrite.php](/changeset/5926/branches/2.2/wp-includes/rewrite.php?old=5289&old_path=branches%2F2.2%2Fwp-includes%2Frewrite.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/rewrite.php")

  | [r6063](/browser/branches/2.2/wp-includes/rewrite.php?rev=5289#L136 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/rewrite.php?rev=5926#L136 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 136 | 136 | // Substitute the substring matches into the query. |
  | 137 | 137 | eval("\$query = \"$query\";"); |
  |  | 138 | // Filter out non-public query vars |
  |  | 139 | global $wp; |
  |  | 140 | parse\_str($query, $query\_vars); |
  |  | 141 | $query = array(); |
  |  | 142 | foreach ( $query\_vars as $key => $value ) { |
  |  | 143 | if ( in\_array($key, $wp->public\_query\_vars) ) |
  |  | 144 | $query[$key] = $value; |
  |  | 145 | } |
  |  | 146 | // Do the query |
  | 138 | 147 | $query = new WP\_Query($query); |
  | 139 | 148 | if ( $query->is\_single || $query->is\_page ) |
* ## [tags/2.2.3/wp-includes/rss.php](/changeset/5961/branches/2.2/wp-includes/rss.php?old=4997&old_path=trunk%2Fwp-includes%2Frss.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/rss.php")

  | [r6063](/browser/trunk/wp-includes/rss.php?rev=4997#L10 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/rss.php?rev=5961#L10 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | define('RSS', 'RSS'); |
  | 11 | 11 | define('ATOM', 'Atom'); |
  | 12 |  | define('MAGPIE\_USER\_AGENT', 'WordPress/' . $~~wp\_version~~); |
  |  | 12 | define('MAGPIE\_USER\_AGENT', 'WordPress/' . $GLOBALS['wp\_version']); |
  | 13 | 13 |  |
  | 14 | 14 | class MagpieRSS { |
  | […](/browser/trunk/wp-includes/rss.php?rev=4997#L592) | […](/browser/branches/2.2/wp-includes/rss.php?rev=5961#L592) |  |
  | 592 | 592 |  |
  | 593 | 593 | if ( !defined('MAGPIE\_USER\_AGENT') ) { |
  | 594 |  | $ua = 'WordPress/' . $~~wp\_version~~; |
  |  | 594 | $ua = 'WordPress/' . $GLOBALS['wp\_version']; |
  | 595 | 595 |  |
  | 596 | 596 | if ( MAGPIE\_CACHE\_ON ) { |
* ## [tags/2.2.3/wp-includes/vars.php](/changeset/6061/branches/2.2/wp-includes/vars.php?old=5063&old_path=trunk%2Fwp-includes%2Fvars.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/vars.php")

  | [r6063](/browser/trunk/wp-includes/vars.php?rev=5063#L2 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/vars.php?rev=6061#L2 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 |  |
  | 3 | 3 | // On which page are we ? |
  | 4 |  | if ( preg\_match('#([^/]+\.php)$#', $PHP\_SELF, $self\_matches) ) { |
  |  | 4 | if ( is\_admin() ) { |
  |  | 5 | // wp-admin pages are checked more carefully |
  |  | 6 | preg\_match('#/wp-admin/?(.\*?)$#i', $PHP\_SELF, $self\_matches); |
  | 5 | 7 | $pagenow = $self\_matches[1]; |
  | 6 |  | } elseif ( strpos($PHP\_SELF, '?') !== false ) { |
  | 7 |  | $pagenow = explode('/', $PHP\_SELF); |
  | 8 |  | $pagenow = trim($pagenow[(sizeof($pagenow)-1)]); |
  | 9 |  | $pagenow = explode('?', $pagenow); |
  | 10 |  | $pagenow = $pagenow[0]; |
  |  | 8 | $pagenow = preg\_replace('#\?.\*?$#', '', $pagenow); |
  |  | 9 | if ( '' === $pagenow || 'index' === $pagenow || 'index.php' === $pagenow ) { |
  |  | 10 | $pagenow = 'index.php'; |
  |  | 11 | } else { |
  |  | 12 | preg\_match('#(.\*?)(/|$)#', $pagenow, $self\_matches); |
  |  | 13 | $pagenow = strtolower($self\_matches[1]); |
  |  | 14 | if ( '.php' !== substr($pagenow, -4, 4) ) |
  |  | 15 | $pagenow .= '.php'; // for Options +Multiviews: /wp-admin/themes/index.php (themes.php is queried) |
  |  | 16 | } |
  | 11 | 17 | } else { |
  | 12 |  | $pagenow = 'index.php'; |
  |  | 18 | if ( preg\_match('#([^/]+\.php)([?/].\*?)?$#i', $PHP\_SELF, $self\_matches) ) |
  |  | 19 | $pagenow = strtolower($self\_matches[1]); |
  |  | 20 | else |
  |  | 21 | $pagenow = 'index.php'; |
  | 13 | 22 | } |
  | 14 | 23 |  |
* ## [tags/2.2.3/wp-includes/version.php](/changeset/6062/branches/2.2/wp-includes/version.php?old=5849&old_path=branches%2F2.2%2Fwp-includes%2Fversion.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/version.php")

  | [r6063](/browser/branches/2.2/wp-includes/version.php?rev=5849#L3 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/version.php?rev=6062#L3 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // This holds the version number in a separate file so we can bump it without cluttering the SVN |
  | 4 | 4 |  |
  | 5 |  | $wp\_version = '2.2.~~2~~'; |
  |  | 5 | $wp\_version = '2.2.3'; |
  | 6 | 6 | $wp\_db\_version = 5183; |
  | 7 | 7 |  |
* ## [tags/2.2.3/wp-includes/widgets.php](/changeset/5877/branches/2.2/wp-includes/widgets.php?old=5824&old_path=branches%2F2.2%2Fwp-includes%2Fwidgets.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-includes/widgets.php")

  | [r6063](/browser/branches/2.2/wp-includes/widgets.php?rev=5824#L333 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-includes/widgets.php?rev=5877#L333 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 333 | 333 | $title = empty( $options['title'] ) ? \_\_( 'Pages' ) : $options['title']; |
  | 334 | 334 | $sortby = empty( $options['sortby'] ) ? 'menu\_order' : $options['sortby']; |
  | 335 |  | $exclude = empty( $options['exclude'] ) ? '' : ~~'&exclude=' .~~ $options['exclude']; |
  |  | 335 | $exclude = empty( $options['exclude'] ) ? '' : $options['exclude']; |
  | 336 | 336 |  |
  | 337 | 337 | if ( $sortby == 'menu\_order' ) { |
  | […](/browser/branches/2.2/wp-includes/widgets.php?rev=5824#L339) | […](/browser/branches/2.2/wp-includes/widgets.php?rev=5877#L339) |  |
  | 339 | 339 | } |
  | 340 | 340 |  |
  | 341 |  | $out = wp\_list\_pages( ~~'title\_li=&echo=0&sort\_column=' . $sortby . $exclude~~ ); |
  |  | 341 | $out = wp\_list\_pages( array('title\_li' => '', 'echo' => 0, 'sort\_column' => $sortby, 'exclude' => $exclude) ); |
  | 342 | 342 |  |
  | 343 | 343 | if ( !empty( $out ) ) { |
* ## [tags/2.2.3/wp-mail.php](/changeset/5902/branches/2.2/wp-mail.php?old=5396&old_path=branches%2F2.2%2Fwp-mail.php "Show the [6063:6063] differences restricted to tags/2.2.3/wp-mail.php")

  | [r6063](/browser/branches/2.2/wp-mail.php?rev=5396#L65 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/wp-mail.php?rev=5902#L65 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 65 | 65 | if (preg\_match('/From: /', $line) | preg\_match('/Reply-To: /', $line))  { |
  | 66 | 66 | $author=trim($line); |
  | 67 |  | if ( ereg("([a-zA-Z0-9\\_\-\.]+@[\a-zA-z0-9\\_\-\.]+)", $author , $regs) ) { |
  | 68 |  | $author = $regs[1]; |
  | 69 |  | echo "Author = {$author} <p>"; |
  | 70 |  | $author = $wpdb->escape($author); |
  | 71 |  | $result = $wpdb->get\_row("SELECT ID FROM $wpdb->users WHERE user\_email='$author' LIMIT 1"); |
  | 72 |  | if (!$result) |
  |  | 67 | if ( ereg("([a-zA-Z0-9\\_\-\.]+@[\a-zA-z0-9\\_\-\.]+)", $author , $regs) ) { |
  |  | 68 | $author = $regs[1]; |
  |  | 69 | echo "Author = {$author} <p>"; |
  |  | 70 | $author = $wpdb->escape($author); |
  |  | 71 | $result = $wpdb->get\_row("SELECT ID FROM $wpdb->users WHERE user\_email='$author' LIMIT 1"); |
  |  | 72 | if (!$result) |
  |  | 73 | $post\_author = 1; |
  |  | 74 | else |
  |  | 75 | $post\_author = $result->ID; |
  |  | 76 | } else |
  | 73 | 77 | $post\_author = 1; |
  | 74 |  | ~~else~~ |
  | 75 |  | ~~$post\_author = $result->ID;~~ |
  | 76 |  | ~~} else~~ |
  | 77 |  | ~~$post\_author = 1;~~ |
  | 78 | 78 | } |
  | 79 | 79 |  |
* ## [tags/2.2.3/xmlrpc.php](/changeset/5905/branches/2.2/xmlrpc.php?old=5730&old_path=branches%2F2.2%2Fxmlrpc.php "Show the [6063:6063] differences restricted to tags/2.2.3/xmlrpc.php")

  | [r6063](/browser/branches/2.2/xmlrpc.php?rev=5730#L1034 "Show revision 6063 of this file in browser") | [r6063](/browser/branches/2.2/xmlrpc.php?rev=5905#L1034 "Show revision 6063 of this file in browser") |  |
  | --- | --- | --- |
  | 1034 | 1034 | if(isset($content\_struct["mt\_allow\_pings"])) { |
  | 1035 | 1035 | if(!is\_numeric($content\_struct["mt\_allow\_pings"])) { |
  | 1036 |  | switch($content["mt\_allow\_pings"]) { |
  |  | 1036 | switch($content\_struct["mt\_allow\_pings"]) { |
  | 1037 | 1037 | case "closed": |
  | 1038 | 1038 | $ping\_status = "closed"; |
  | […](/browser/branches/2.2/xmlrpc.php?rev=5730#L1246) | […](/browser/branches/2.2/xmlrpc.php?rev=5905#L1246) |  |
  | 1246 | 1246 | if(isset($content\_struct["mt\_allow\_pings"])) { |
  | 1247 | 1247 | if(!is\_numeric($content\_struct["mt\_allow\_pings"])) { |
  | 1248 |  | switch($content["mt\_allow\_pings"]) { |
  |  | 1248 | switch($content\_struct["mt\_allow\_pings"]) { |
  | 1249 | 1249 | case "closed": |
  | 1250 | 1250 | $ping\_status = "closed"; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=6063&old=6063&new_path=%2Ftags%2F2.2.3&old_path=%2Ftags%2F2.2.2)
* [Zip Archive](?format=zip&new=6063&old=6063&new_path=%2Ftags%2F2.2.3&old_path=%2Ftags%2F2.2.2)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


