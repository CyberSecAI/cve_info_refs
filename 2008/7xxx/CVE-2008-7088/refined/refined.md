- **Root cause of vulnerability:** The vulnerability stems from a lack of proper file type validation during the upload process. Specifically, the application allows users to upload files with a `.wmv` extension, while still executing them as PHP scripts if the content is PHP code.
- **Weaknesses/vulnerabilities present:** Arbitrary file upload vulnerability due to inadequate file extension validation.
- **Impact of exploitation:** An attacker can upload a malicious PHP script disguised as a `.wmv` file. When accessed, the script will execute on the server, allowing for arbitrary code execution. This gives the attacker full control of the web server, including the ability to perform actions such as data theft or further compromise of the host system.
- **Attack vectors:** The attack vector is through the `upload.php` script within the PhotoPost vBGallery application.
- **Required attacker capabilities/position:**
    - The attacker must be a registered user of the forum or web application to upload files.
    - The attacker needs to know the `$gallery_path` variable to access the upload script.
    - The attacker should craft a malicious PHP script and rename it to `$name.php.wmv`.