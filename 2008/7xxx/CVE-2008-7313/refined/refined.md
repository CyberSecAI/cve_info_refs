```
Message-ID: <201407181730.s6IHUYAa023743@linus.mitre.org>
Date: Fri, 18 Jul 2014 13:30:34 -0400 (EDT)
From: cve-assign@...re.org
To: thoger@...hat.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com, gmollett@...hat.com,
        kseifried@...hat.com
Subject: Re: CVE request - Snoopy incomplete fix for CVE-2008-4796
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
> 2008
> ...
> Followed by a similar fix for headers few days later, which probably
> was not picked up by folks backporting the above commit as the fix for
> this CVE:
> <http://snoopy.cvs.sourceforge.net/viewvc/snoopy/Snoopy/Snoopy.class.php?view=log#rev1.27>
Use CVE-2008-7313 for this vulnerability involving headers. This issue
exists because of an incomplete fix for CVE-2008-4796.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)
iQEcBAEBAgAGBQJTyVl2AAoJEKllVAevmvmsVmgH/i8/r/RQYS5Bu/vzlDVjZbK/
vIjD4rUuUOJ+A75GOR5IjsHg0Ybh5nvx4eTHCTeQhFsNibKUqn8n6SIJlghbtx3C
H2rSGAN4B1+F/xa/3qTU0CAqsear/UqlwCbyD/VvSuS6plYYfk24/UcmDFZ7+N6P
fIf0JAx+0pBWB74s3BdMcSbJNW/19hVMF4vRfsmirTQUn9yjXlB8QyAEVsqw2qSU
T18YscFWBTrB2ifYBD14ku7wK+EFUBNdSsq2/Hykxroka+n2maZVJUpZmpEFSfzZ
jKtciy2Vw/lj/JuCZb02yqL3Lzjph6AYjNWjcbUWtXNPXajiYNMD85PsAtwhkBw=
=hYe5
-----END PGP SIGNATURE-----
```
- **Root cause of vulnerability**: Incomplete fix for CVE-2008-4796 related to header handling in Snoopy's `_httpsrequest()` function.
- **Weaknesses/vulnerabilities present**: Command injection vulnerability due to improper input sanitization when processing HTTP headers.
- **Impact of exploitation**: Arbitrary command execution with the privileges of the application running Snoopy.
- **Attack vectors**: Manipulating HTTP headers, likely via a crafted URL or a malicious server response.
- **Required attacker capabilities/position**: The attacker needs to be able to influence the HTTP headers processed by the Snoopy library through a malicious feed server.

```
PowerKVM is affected by numerous vulnerabilities in nagios. These vulnerabilities are now fixed.
**CVEID:** [CVE-2008-7313](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-7313) **DESCRIPTION:** Snoopy could allow a remote attacker to execute arbitrary commands on the system, caused by an incomplete fix related to the \_httpsrequest() function. An attacker could exploit this vulnerability to execute arbitrary commands on the system.
CVSS Base Score: 6.8
CVSS Temporal Score: See <https://exchange.xforce.ibmcloud.com/vulnerabilities/94737> for the current score
CVSS Environmental Score\*: Undefined
CVSS Vector: (AV:N/AC:M/Au:N/C:P/I:P/A:P)
```
- **Root cause of vulnerability**: An incomplete fix in the `_httpsrequest()` function of the Snoopy library.
- **Weaknesses/vulnerabilities present**: Remote command execution via the Snoopy library.
- **Impact of exploitation**: A remote attacker could execute arbitrary commands on the system.
- **Attack vectors**: Exploiting the vulnerability through network access.
- **Required attacker capabilities/position**: The attacker needs to be able to send a malicious request to the vulnerable component.
```
Security Fix(es):

* Various command-execution flaws were found in the Snoopy library included with Nagios. These flaws allowed remote attackers to execute arbitrary commands by manipulating Nagios HTTP headers. (CVE-2008-7313, CVE-2014-5008, CVE-2014-5009)
```
- **Root cause of vulnerability**: Command execution flaws in the Snoopy library within Nagios.
- **Weaknesses/vulnerabilities present**: Remote command execution through manipulation of HTTP headers.
- **Impact of exploitation**: Arbitrary command execution by a remote attacker.
- **Attack vectors**: Exploiting vulnerable HTTP header processing in Snoopy.
- **Required attacker capabilities/position**: Remote attacker needs to send a manipulated request.
```
# Nagios: Multiple vulnerabilities — GLSA **201702-26**

Multiple vulnerabilities have been found in Nagios, the worst of
which could lead to privilege escalation.

### Affected packages

| Package | **net-analyzer/nagios-core** on all architectures |
| --- | --- |
| Affected versions | < **4.2.4** |
| Unaffected versions | >= **4.2.4** |

Multiple vulnerabilities have been discovered in Nagios. Please review
the CVE identifiers referenced below for details.

### Impact

In addition, a remote attacker could read or write to arbitrary files by
spoofing a crafted response from the Nagios RSS feed server.

### References

* [CVE-2008-4796](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2008-4796)
* [CVE-2008-7313](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2008-7313)
* [CVE-2016-8641](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-8641)
* [CVE-2016-9565](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9565)
* [CVE-2016-9566](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9566)
```
- **Root cause of vulnerability**: Multiple vulnerabilities in Nagios, including incomplete fixes in the Snoopy library.
- **Weaknesses/vulnerabilities present**: Remote code execution and arbitrary file read/write by spoofing responses from the RSS feed server.
- **Impact of exploitation**: Privilege escalation and remote execution.
- **Attack vectors**: By sending a crafted response from the RSS feed server.
- **Required attacker capabilities/position**: Attacker needs to be able to spoof responses of an RSS feed server used by Nagios.
```
[Description](show_bug.cgi?id=1405363#c0)  Adam Mariš    2016-12-16 10:14:14 UTC  ``` MagpieRSS, a component for handling RSS news feeds in Nagios Core control panel / front-end, was found vulnerable to command injection due to insufficient neutralization of special elements in function _httpsrequest(). The vulnerability could potentially enable remote unauthenticated attackers who managed to impersonate the feed server (via DNS poisoning, domain hijacking, ARP spoofing etc.), to provide a malicious response that injects parameters to curl command used by the affected RSS client class and effectively read/write arbitrary files on the vulnerable Nagios server. This could lead to Remote Code Execution in the context of www-data/nagios user on default Nagios installs that follow the official setup guidelines. This issue is due to incomplete fix of [CVE-2008-4796](https://access.redhat.com/security/cve/CVE-2008-4796).
```
- **Root cause of vulnerability**: Insufficient sanitization in the `_httpsrequest()` function of MagpieRSS (which uses Snoopy) within Nagios.
- **Weaknesses/vulnerabilities present**: Command injection vulnerability due to insufficient neutralization of special elements when making HTTP requests.
- **Impact of exploitation**: Remote code execution with the privileges of the `www-data/nagios` user.
- **Attack vectors**: By impersonating the feed server.
- **Required attacker capabilities/position**: The attacker needs to be able to intercept and manipulate responses from the RSS feed server (e.g., by DNS poisoning).
```
[Comment 8](show_bug.cgi?id=1405363#c8)  Tomas Hoger    2016-12-21 22:05:39 UTC  ``` This issue is actually in Snoopy - a PHP class for fetching web pages:  <https://sourceforge.net/projects/snoopy/>  Snoopy is embedded in MagpieRSS, which is embedded in nagios.  The issue was fixed in Snoopy upstream by changing it to use native PHP functions to fetch web pages instead of using curl:  <http://snoopy.cvs.sourceforge.net/viewvc/snoopy/Snoopy/Snoopy.class.php?view=log#rev1.29>  Nagios upstream fixed the problem in version 4.2.2 by removing MagpieRSS and hence Snoopy:  <https://github.com/NagiosEnterprises/nagioscore/commit/f0808f9c2aca777685ba57e71a8cd7b4baa8aa78>  Note that this CVE is actually a dupe of [CVE-2014-5008](https://access.redhat.com/security/cve/CVE-2014-5008) ([bug 1121497](show_bug.cgi?id=1121497 "CLOSED ERRATA - CVE-2008-7313 CVE-2014-5008 CVE-2014-5009 snoopy: incomplete fixes for command execution flaws")).
```
- **Root cause of vulnerability**: The root cause is in the Snoopy library, specifically its method of fetching web pages using `curl`.
- **Weaknesses/vulnerabilities present**: Command injection via the curl command used in Snoopy.
- **Impact of exploitation**: Potential remote code execution by injecting parameters to the `curl` command
- **Attack vectors**: The vulnerability occurs when processing RSS feeds in Nagios via MagpieRSS which utilizes Snoopy to fetch web pages.
- **Required attacker capabilities/position**: An attacker needs to control the responses from the RSS feed to inject malicious code into the curl command being used by Snoopy.
```
[Description](show_bug.cgi?id=1121497#c0)  Murray McAllister    2014-07-21 06:11:00 UTC  ``` [CVE-2008-4796](https://access.redhat.com/security/cve/CVE-2008-4796) describes a command execution flaw in the Snoopy library. A similar fix exists for headers:  <http://snoopy.cvs.sourceforge.net/viewvc/snoopy/Snoopy/Snoopy.class.php?view=log#rev1.27>  The header fix has been assigned [CVE-2008-7313](https://access.redhat.com/security/cve/CVE-2008-7313) (as an incomplete fix for [CVE-2008-4796](https://access.redhat.com/security/cve/CVE-2008-4796)).
```
- **Root cause of vulnerability**: Command execution flaws in the Snoopy library, related to header handling.
- **Weaknesses/vulnerabilities present**: Improper input sanitization for HTTP headers processed by Snoopy.
- **Impact of exploitation**: Remote command execution on the affected system.
- **Attack vectors**: By crafting malicious HTTP header data in an HTTP response.
- **Required attacker capabilities/position**: Attacker needs to be able to control a HTTP server that Snoopy requests.

In summary, CVE-2008-7313 is a command injection vulnerability in the Snoopy library due to improper handling of HTTP headers, which allows a remote attacker to execute arbitrary commands by manipulating these headers. It is related to an incomplete fix of CVE-2008-4796.