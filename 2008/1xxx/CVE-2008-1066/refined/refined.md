```
{
  "vulnerability": {
    "root_cause": "The Smarty template engine's modifier.regex_replace.php plugin does not properly sanitize input related to the ASCII NUL character in a search string.",
    "weaknesses": [
      "Insufficient input sanitization",
      "Arbitrary PHP function calls via template injection"
    ],
    "impact": "A remote attacker could call arbitrary PHP functions via templates, leading to potential compromise of the system or application.",
    "attack_vectors": [
      "Remote exploitation via specially crafted search string in a template"
    ],
    "required_capabilities": "Ability to influence template processing with a malicious search string."
  },
  "affected_components": [
    {
      "name": "Smarty Template Engine",
      "versions": "versions prior to the fix"
    },
        {
      "name": "phpDocumentor",
       "versions": "< 1.4.3-r1"
    },
        {
      "name": "moodle",
        "versions": "versions using vulnerable smarty"
    }
  ],
  "references": [
        "https://security.gentoo.org/glsa/201111-04",
        "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/VJSAKSIAJRUC2D6ISFCI5NAL75JW2UIY/#VJSAKSIAJRUC2D6ISFCI5NAL75JW2UIY",
    "https://www.debian.org/security/2008/dsa-1520"
  ]
}
```