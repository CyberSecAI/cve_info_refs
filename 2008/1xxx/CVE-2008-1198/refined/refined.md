```
{
  "Root cause of vulnerability": "The default IPSec ifup script initializes the racoon configuration to use aggressive IKE mode, and falls back to main IKE mode if that fails. In IKE Aggressive mode the authentication hash based on a preshared key (PSK) is transmitted as response to the initial packet of a vpn client, and this hash is not encrypted.",
  "Weaknesses/vulnerabilities present": "The vulnerability is due to the use of IKE Aggressive mode with preshared key (PSK) authentication, where the PSK hash is sent unencrypted over the network, making it vulnerable to brute-force or dictionary attacks.",
  "Impact of exploitation": "Successful exploitation allows an attacker to recover the PSK, which can then be used to establish a VPN connection and gain access to the protected network.",
  "Attack vectors": "An attacker can capture the network traffic between the VPN client and gateway using a sniffer. The unencrypted PSK hash transmitted in the response can be extracted and subjected to brute-force or dictionary attacks.",
  "Required attacker capabilities/position": "The attacker needs to be able to capture network traffic between the VPN client and gateway and must be able to initiate a VPN connection request to obtain the hash. The VPN gateway must accept connections from the attacker's IP address and the gateway must either be configured to support aggressive mode, or switch to aggressive mode when requested by the client."
}
```