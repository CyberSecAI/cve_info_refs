=== Content from www.vupen.com_b295b898_20250125_232627.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

Â© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from aluigi.altervista.org_531839d6_20250125_232626.html ===
#######################################################################
Luigi Auriemma
Application: HP OpenView Network Node Manager
http://www.openview.hp.com/products/nnm/
Versions: <= 7.53
Platforms: Windows (tested), Solaris, Linux, HP-UX
Bugs: A] CGIs directory traversal
B] Denial of Service in ovalarmsrv
C] NULL pointer in ovalarmsrv
D] process termination in ovtopmd
Exploitation: remote
Date: 11 Apr 2008
Author: Luigi Auriemma
e-mail: aluigi@autistici.org
web: aluigi.org
#######################################################################
1) Introduction
2) Bugs
3) The Code
4) Fix
#######################################################################
===============
1) Introduction
===============
From vendor's website:
OpenView NNM "automates the process of developing a hyper-accurate
topology of your physical network, virtual network services and the
complex relationships between them. It then uses that topology as the
basis for intelligent root cause analysis to enhance network
availability and performance."
#######################################################################
=======
2) Bugs
=======
---------------------------
A] CGIs directory traversal
---------------------------
The CGIs available in NNM use some instructions which filter malicious
chars in the parameters passed by the clients, for example to avoid
directory traversal attacks, XSS and so on.
The path delimiter filtered by these CGIs is the backslash char, so
using the slash will allow an attacker to download the files from the
disk on which is installed NNM.
----------------------------------
B] Denial of Service in ovalarmsrv
----------------------------------
The ovalarmsrv service listening on port 2954 can be easily freezed
with CPU at 100% and without the possibility of handling further
requests on both its ports 2953 and 2954 simply sending an incomplete
multi line request.
In short the last numeric parameters of the requests 25, 45, 46, 47 and
81 is used to specify how much sub-arguments (one per line) will be
sent.
So ovalarmsrv starts a loop which terminates when all the sub arguments
are received; closing the connection or not sending all or part of
these arguments will freeze the entire service.
The following are all the supported requests and their "sscanf" format:
REQUEST\_CONTRIB\_EVENTS (22): "%d %d %s"
REQUEST\_PRINT (25): "%d %d %d %d %s"
REQUEST\_DETAILS (33): "%d %d %s"
REQUEST\_EVENT\_DELETE (35): "%d %d %s"
REQUEST\_EVENT\_ACK (36): "%d %d %s"
REQUEST\_RUN\_ACTION (37): "%d %d %s %s"
REQUEST\_SPECDATA (41):
REQUEST\_EVENT\_UNACK (44): "%d %d %s"
REQUEST\_SAVE (45): "%d %d %d %d %s"
REQUEST\_CAT\_CHANGE (46): "%d %d %d %[^\n]"
REQUEST\_SEV\_CHANGE (47): "%d %d %d %[^\n]"
REQUEST\_CONF\_ACTIONS (48): "%d %d\n"
REQUEST\_RESTORE\_STATE (62): "%d %[^\n]"
REQUEST\_SAVE\_DIR (63):
REQUEST\_LOCALE (66): "%d"
REQUEST\_FORMAT\_PRINT (81): "%d %d %d %d %s"
REQUEST\_CONF\_RUN\_ACTION (??): "%d %d %d %[^\n]"
-----------------------------
C] NULL pointer in ovalarmsrv
-----------------------------
The parameter which specifies the amount of sub-arguments described
above is used to allocate a certain amount of initial dynamic memory
(value \* 2) for storing all the sub-arguments which is then
reallocated wheen needed.
Specifying a too big unallocable amount of sub-arguments results in a
NULL pointer which will crash the service.
---------------------------------
D] process termination in ovtopmd
---------------------------------
The ovtopmd service listening on port 2532 uses a special type of
packet (0x36) for forcing the termination of the process ("Exiting due
to request of ovtopmd -k."), so an attacker can use this packet for
causing a Denial of Service.
#######################################################################
===========
3) The Code
===========
A]
http://SERVER/OvCgi/OpenView5.exe?Target=Main&Action=../../../../../../windows/win.ini
B,C,D]
http://aluigi.org/poc/closedviewx.zip
nc SERVER 2954 -v -v -w 2 < closedviewx1.txt
nc SERVER 2954 -v -v < closedviewx2.txt
nc SERVER 2532 -v -v < closedviewx3.txt
#######################################################################
======
4) Fix
======
HP has been alerted and is working on a fix
#######################################################################

