=== Content from secunia.com_55568c1d_20250125_140503.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...



=== Content from github.com_810cf397_20250125_140549.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjcollie%2Fasterisk%2Fcommit%2Fa8b180875b037b8da26f6a3bcc8e5e98b8c904d2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjcollie%2Fasterisk%2Fcommit%2Fa8b180875b037b8da26f6a3bcc8e5e98b8c904d2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jcollie%2Fasterisk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jan 14, 2020. It is now read-only.

[jcollie](/jcollie)
/
**[asterisk](/jcollie/asterisk)**
Public archive

* [Notifications](/login?return_to=%2Fjcollie%2Fasterisk) You must be signed in to change notification settings
* [Fork
  5](/login?return_to=%2Fjcollie%2Fasterisk)
* [Star
   10](/login?return_to=%2Fjcollie%2Fasterisk)

* [Code](/jcollie/asterisk)
* [Pull requests
  0](/jcollie/asterisk/pulls)
* [Actions](/jcollie/asterisk/actions)
* [Projects
  0](/jcollie/asterisk/projects)
* [Security](/jcollie/asterisk/security)
* [Insights](/jcollie/asterisk/pulse)

Additional navigation options

* [Code](/jcollie/asterisk)
* [Pull requests](/jcollie/asterisk/pulls)
* [Actions](/jcollie/asterisk/actions)
* [Projects](/jcollie/asterisk/projects)
* [Security](/jcollie/asterisk/security)
* [Insights](/jcollie/asterisk/pulse)

## Commit

[Permalink](/jcollie/asterisk/commit/a8b180875b037b8da26f6a3bcc8e5e98b8c904d2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merged revisions 114558 via svnmerge from

[Browse files](/jcollie/asterisk/tree/a8b180875b037b8da26f6a3bcc8e5e98b8c904d2)
Browse the repository at this point in the history

```
<https://origsvn.digium.com/svn/asterisk/branches/1.4>

........
r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22 Apr 2008) | 5 lines

When we receive a full frame that is supposed to contain our call number,
ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)

........

git-svn-id: [http://svn.asterisk.org/svn/asterisk/trunk@114559](http://svn.asterisk.org/svn/asterisk/trunk%40114559) f38db490-d61c-443f-a65b-d21fe96a405b
```

* Loading branch information

[![@russellb](https://avatars.githubusercontent.com/u/309258?s=40&v=4)](/russellb)

[russellb](/jcollie/asterisk/commits?author=russellb "View all commits by russellb")
committed
Apr 22, 2008

1 parent
[7dbf20f](/jcollie/asterisk/commit/7dbf20f3b27a60602ec4c088b4e60e219c075ca2)

commit a8b1808

Showing
**1 changed file**
with
**37 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

58 changes: 37 additions & 21 deletions

58
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/jcollie/asterisk/blob/a8b180875b037b8da26f6a3bcc8e5e98b8c904d2/channels/chan_iax2.c)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1383,13 +1383,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1491,7 +1491,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | \* |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1503,7 +1503,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1513,14 +1513,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1529,15 +1531,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1575,14 +1591,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -7624,7 +7640,7 @@ static int socket\_process\_meta(int packet\_len, struct ast\_iax2\_meta\_hdr \*meta, s |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > packet\_len) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd, 0); |
|  |  | if (!fr->callno) |
|  |  | continue; |
|  |  |  |
| Expand Down  Expand Up | | @@ -7807,7 +7823,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) |
|  |  | return socket\_process\_meta(res, meta, &sin, fd, fr); |
| Expand Down  Expand Up | | @@ -7842,7 +7858,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -9424,7 +9440,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  |  |
|  |  | if (!reg->callno) { |
|  |  | ast\_debug(1, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -9475,7 +9491,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -9631,7 +9647,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -9710,7 +9726,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -11083,7 +11099,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_debug(1, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `a8b1808`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjcollie%2Fasterisk%2Fcommit%2Fa8b180875b037b8da26f6a3bcc8e5e98b8c904d2) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from www.debian.org_19354d92_20250125_140539.html ===


---

[[Date Prev](msg00136.html)][[Date Next](msg00138.html)]
[[Thread Prev](msg00136.html)][[Thread Next](msg00138.html)]
[[Date Index](maillist.html#00137)]
[[Thread Index](threads.html#00137)]

# [SECURITY] [DSA 1563-1] New asterisk packages fix denial of service

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1563-1] New asterisk packages fix denial of service
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 30 Apr 2008 19:41:24 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20080430174124.GA4308%40galadriel.inutil.org)Â [20080430174124.GA4308@galadriel.inutil.org](msg00137.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1563-1                  security@debian.org
<http://www.debian.org/security/>                       Moritz Muehlenhoff
April 30, 2008                        <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : asterisk
Vulnerability  : programming error
Problem type   : remote
Debian-specific: no
CVE Id(s)      : CVE-2008-1897

Joel R. Voss discovered that the IAX2 module of Asterisk, a free
software PBX and telephony toolkit performs insufficient validation of
IAX2 protocol messages, which may lead to denial of service.

For the stable distribution (etch), this problem has been fixed in
version 1.2.13~dfsg-2etch4.

For the unstable distribution (sid), this problem has been fixed
in version 1.4.19.1~dfsg-1.

We recommend that you upgrade your asterisk packages.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian 4.0 (stable)
- -------------------

Stable updates are available for alpha, amd64, arm, hppa, i386, ia64, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk_1.2.13~dfsg-2etch4.dsc>
    Size/MD5 checksum:     1488 5f5e9573d490427c5a69a10aa97f158b
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk_1.2.13~dfsg.orig.tar.gz>
    Size/MD5 checksum:  3835589 f8ee088b2e4feffe2b35d78079f90b69
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk_1.2.13~dfsg-2etch4.diff.gz>
    Size/MD5 checksum:   183285 26bd25ccb154a4ad32980d943b986b77

Architecture independent packages:

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-doc_1.2.13~dfsg-2etch4_all.deb>
    Size/MD5 checksum:  1500302 8bdb0c668d19cfa10a1a21e18b404abf
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-web-vmail_1.2.13~dfsg-2etch4_all.deb>
    Size/MD5 checksum:    73970 b58221f4979cc030855181025a912e88
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-config_1.2.13~dfsg-2etch4_all.deb>
    Size/MD5 checksum:   131882 4e51e2e9df2c8815b7f73de4366d1226
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-sounds-main_1.2.13~dfsg-2etch4_all.deb>
    Size/MD5 checksum:  1504806 aba4a61bee8550ce08491ca99e20daed
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk_1.2.13~dfsg-2etch4_all.deb>
    Size/MD5 checksum:   146714 8b47af29382b0fd93ba9276c6d130a9b
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-dev_1.2.13~dfsg-2etch4_all.deb>
    Size/MD5 checksum:   170154 6db4874707b5e4bcaac7daf6d8f52c2b

alpha architecture (DEC Alpha)

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_alpha.deb>
    Size/MD5 checksum:  1902278 7f85e13bc5fcbe4e97b1c38cda233dac
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_alpha.deb>
    Size/MD5 checksum:   137358 2b182763234ee7c8ad32eb88ab1d7439
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_alpha.deb>
    Size/MD5 checksum:  1938542 0e3d8bcf8c3d417d76dcec6d18c54aa8

amd64 architecture (AMD x86_64 (AMD64))

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_amd64.deb>
    Size/MD5 checksum:   133398 ed20b24f1a2f341bd6d4e028ce59a90c
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_amd64.deb>
    Size/MD5 checksum:  1780430 8ce4d0f0065fbda1b8b6faf452aa8cf1
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_amd64.deb>
    Size/MD5 checksum:  1745772 c7e3f3533bd980e6cf4fae76a7fe53a6

arm architecture (ARM)

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_arm.deb>
    Size/MD5 checksum:  1702038 c21d7d8f2a6a22340c6c532c52297238
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_arm.deb>
    Size/MD5 checksum:   136578 e058fda61addca152ebcef309ed53db0
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_arm.deb>
    Size/MD5 checksum:  1668554 be43593d0db307fff5d9233d99f8683d

hppa architecture (HP PA RISC)

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_hppa.deb>
    Size/MD5 checksum:  1859784 e01288aa37bf6d1021836e4750896192
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_hppa.deb>
    Size/MD5 checksum:  1899426 4dca3a75e206580153fac43f4a16d9ac
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_hppa.deb>
    Size/MD5 checksum:   145500 c349640da06db141cc1bdeae512426a2

i386 architecture (Intel ia32)

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_i386.deb>
    Size/MD5 checksum:  1650280 3de468a3ac7da9765b67a3637eaf0c8b
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_i386.deb>
    Size/MD5 checksum:  1616900 cde58be5158607a6d55ffedf8f5f6b99
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_i386.deb>
    Size/MD5 checksum:   131104 fe4e96f50604b2ce1b5c1ed2e80ee0e2

ia64 architecture (Intel ia64)

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_ia64.deb>
    Size/MD5 checksum:  2349674 6fd62f264d405873e44ba0a08a58b719
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_ia64.deb>
    Size/MD5 checksum:   149858 b9ab483687ffa690c90720ef1dce7a33
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_ia64.deb>
    Size/MD5 checksum:  2395734 cfbb272cc6da385b4b144bd1a2877ec8

mips architecture (MIPS (Big Endian))

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_mips.deb>
    Size/MD5 checksum:   130344 589d8d4e2341901d52cea2c7f7688368
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_mips.deb>
    Size/MD5 checksum:  1688936 26b6d9c89013f575a8e12559fd525a99
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_mips.deb>
    Size/MD5 checksum:  1720586 3a4ece7c7ca3dce1a7449bae6da3b468

mipsel architecture (MIPS (Little Endian))

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_mipsel.deb>
    Size/MD5 checksum:   129852 65fa3add41986df9af5ae6da47ce754b
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_mipsel.deb>
    Size/MD5 checksum:  1664436 06838223a31772f671cc5bd5063c0125
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_mipsel.deb>
    Size/MD5 checksum:  1696490 ce4a77d18c64e90d0803730661b08f8c

powerpc architecture (PowerPC)

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_powerpc.deb>
    Size/MD5 checksum:  1825754 da384bd468577fa5058ff4547e97fb1f
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_powerpc.deb>
    Size/MD5 checksum:   133228 d05176705d1236ca9e039a05fd537f15
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_powerpc.deb>
    Size/MD5 checksum:  1864110 d20124ef308de4354b5ab0d53f5d22a7

s390 architecture (IBM S/390)

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_s390.deb>
    Size/MD5 checksum:  1744918 0ff79d065ecc670dd6a8b36f76654494
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_s390.deb>
    Size/MD5 checksum:   136738 ebc38fa1031636449198da18f2542df7
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_s390.deb>
    Size/MD5 checksum:  1780914 bc075c8673bc6a48d09d3872e9f1a4fd

sparc architecture (Sun SPARC/UltraSPARC)

  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-classic_1.2.13~dfsg-2etch4_sparc.deb>
    Size/MD5 checksum:  1632652 7341c9d19478d655acaa94c3a36c3cd0
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-bristuff_1.2.13~dfsg-2etch4_sparc.deb>
    Size/MD5 checksum:  1664570 6824b18d4424ec863a96763bf90184b9
  <http://security.debian.org/pool/updates/main/a/asterisk/asterisk-h323_1.2.13~dfsg-2etch4_sparc.deb>
    Size/MD5 checksum:   132348 1759eab6abaa0ab551bf722656d9debf

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFIGK8SXm3vHE4uyloRAik3AKCC8MPmuqBfJLpRZbIvp6/i8DC2HgCfWm2W
AE6e8I/eeqoGXgIo/hhu8TQ=
=nW+x
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_db3ac317_20250125_140606.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxrg%2Fasterisk-xrg%2Fcommit%2F51714a24347dc57f9a208a4a8af84115ef407b83)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxrg%2Fasterisk-xrg%2Fcommit%2F51714a24347dc57f9a208a4a8af84115ef407b83)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xrg%2Fasterisk-xrg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xrg](/xrg)
/
**[asterisk-xrg](/xrg/asterisk-xrg)**
Public

* [Notifications](/login?return_to=%2Fxrg%2Fasterisk-xrg) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fxrg%2Fasterisk-xrg)
* [Star
   4](/login?return_to=%2Fxrg%2Fasterisk-xrg)

* [Code](/xrg/asterisk-xrg)
* [Issues
  0](/xrg/asterisk-xrg/issues)
* [Pull requests
  0](/xrg/asterisk-xrg/pulls)
* [Actions](/xrg/asterisk-xrg/actions)
* [Projects
  0](/xrg/asterisk-xrg/projects)
* [Wiki](/xrg/asterisk-xrg/wiki)
* [Security](/xrg/asterisk-xrg/security)
* [Insights](/xrg/asterisk-xrg/pulse)

Additional navigation options

* [Code](/xrg/asterisk-xrg)
* [Issues](/xrg/asterisk-xrg/issues)
* [Pull requests](/xrg/asterisk-xrg/pulls)
* [Actions](/xrg/asterisk-xrg/actions)
* [Projects](/xrg/asterisk-xrg/projects)
* [Wiki](/xrg/asterisk-xrg/wiki)
* [Security](/xrg/asterisk-xrg/security)
* [Insights](/xrg/asterisk-xrg/pulse)

## Commit

[Permalink](/xrg/asterisk-xrg/commit/51714a24347dc57f9a208a4a8af84115ef407b83)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merged revisions 114558 via svnmerge from

[Browse files](/xrg/asterisk-xrg/tree/51714a24347dc57f9a208a4a8af84115ef407b83)
Browse the repository at this point in the history

```
<https://origsvn.digium.com/svn/asterisk/branches/1.4>

........
r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22 Apr 2008) | 5 lines

When we receive a full frame that is supposed to contain our call number,
ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)

........
```

* Loading branch information

russell
committed
Apr 22, 2008

1 parent
[6ecbd78](/xrg/asterisk-xrg/commit/6ecbd7845ea74c14e2447cc62d69c4fdbf379d2a)

commit 51714a2

Showing
**1 changed file**
with
**37 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

58 changes: 37 additions & 21 deletions

58
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/xrg/asterisk-xrg/blob/51714a24347dc57f9a208a4a8af84115ef407b83/channels/chan_iax2.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1383,13 +1383,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1491,7 +1491,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | \* |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1503,7 +1503,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1513,14 +1513,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1529,15 +1531,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1575,14 +1591,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -7624,7 +7640,7 @@ static int socket\_process\_meta(int packet\_len, struct ast\_iax2\_meta\_hdr \*meta, s |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > packet\_len) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd, 0); |
|  |  | if (!fr->callno) |
|  |  | continue; |
|  |  |  |
| Expand Down  Expand Up | | @@ -7807,7 +7823,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) |
|  |  | return socket\_process\_meta(res, meta, &sin, fd, fr); |
| Expand Down  Expand Up | | @@ -7842,7 +7858,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -9424,7 +9440,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  |  |
|  |  | if (!reg->callno) { |
|  |  | ast\_debug(1, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -9475,7 +9491,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -9631,7 +9647,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -9710,7 +9726,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -11083,7 +11099,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_debug(1, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `51714a2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxrg%2Fasterisk-xrg%2Fcommit%2F51714a24347dc57f9a208a4a8af84115ef407b83) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from security.gentoo.org_211076c0_20250125_140507.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Asterisk: Multiple vulnerabilities â€” GLSA **200905-01**

Multiple vulnerabilities have been found in Asterisk allowing for Denial of
Service and username disclosure.

### Affected packages

| Package | **net-misc/asterisk** on all architectures |
| --- | --- |
| Affected versions | < **1.2.32** |
| Unaffected versions | >= **1.2.32** |

### Background

Asterisk is an open source telephony engine and toolkit.

### Description

Multiple vulnerabilities have been discovered in the IAX2 channel
driver when performing the 3-way handshake (CVE-2008-1897), when
handling a large number of POKE requests (CVE-2008-3263), when handling
authentication attempts (CVE-2008-5558) and when handling firmware
download (FWDOWNL) requests (CVE-2008-3264). Asterisk does also not
correctly handle SIP INVITE messages that lack a "From" header
(CVE-2008-2119), and responds differently to a failed login attempt
depending on whether the user account exists (CVE-2008-3903,
CVE-2009-0041).

### Impact

Remote unauthenticated attackers could send specially crafted data to
Asterisk, possibly resulting in a Denial of Service via a daemon crash,
call-number exhaustion, CPU or traffic consumption. Remote
unauthenticated attackers could furthermore enumerate valid usernames
to facilitate brute force login attempts.

### Workaround

There is no known workaround at this time.

### Resolution

All Asterisk users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/asterisk-1.2.32"
```
### References

* [CVE-2008-1897](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1897)
* [CVE-2008-2119](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2119)
* [CVE-2008-3263](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3263)
* [CVE-2008-3264](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3264)
* [CVE-2008-3903](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3903)
* [CVE-2008-5558](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5558)
* [CVE-2009-0041](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0041)

**Release date**

May 02, 2009

**Latest revision**

May 02, 2009: 01

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [218966](https://bugs.gentoo.org/show_bug.cgi?id=218966)
* [224835](https://bugs.gentoo.org/show_bug.cgi?id=224835)
* [232696](https://bugs.gentoo.org/show_bug.cgi?id=232696)
* [232698](https://bugs.gentoo.org/show_bug.cgi?id=232698)
* [237476](https://bugs.gentoo.org/show_bug.cgi?id=237476)
* [250748](https://bugs.gentoo.org/show_bug.cgi?id=250748)
* [254304](https://bugs.gentoo.org/show_bug.cgi?id=254304)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from github.com_3030af04_20250125_140552.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkaoru6%2Fasterisk%2Fcommit%2F1fe14f38dd43dc894d21f85762b51208ba5c8acb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkaoru6%2Fasterisk%2Fcommit%2F1fe14f38dd43dc894d21f85762b51208ba5c8acb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=kaoru6%2Fasterisk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kaoru6](/kaoru6)
/
**[asterisk](/kaoru6/asterisk)**
Public

* [Notifications](/login?return_to=%2Fkaoru6%2Fasterisk) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fkaoru6%2Fasterisk)
* [Star
   0](/login?return_to=%2Fkaoru6%2Fasterisk)

* [Code](/kaoru6/asterisk)
* [Issues
  0](/kaoru6/asterisk/issues)
* [Pull requests
  0](/kaoru6/asterisk/pulls)
* [Actions](/kaoru6/asterisk/actions)
* [Projects
  0](/kaoru6/asterisk/projects)
* [Wiki](/kaoru6/asterisk/wiki)
* [Security](/kaoru6/asterisk/security)
* [Insights](/kaoru6/asterisk/pulse)

Additional navigation options

* [Code](/kaoru6/asterisk)
* [Issues](/kaoru6/asterisk/issues)
* [Pull requests](/kaoru6/asterisk/pulls)
* [Actions](/kaoru6/asterisk/actions)
* [Projects](/kaoru6/asterisk/projects)
* [Wiki](/kaoru6/asterisk/wiki)
* [Security](/kaoru6/asterisk/security)
* [Insights](/kaoru6/asterisk/pulse)

## Commit

[Permalink](/kaoru6/asterisk/commit/1fe14f38dd43dc894d21f85762b51208ba5c8acb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merged revisions 114558 via svnmerge from

[Browse files](/kaoru6/asterisk/tree/1fe14f38dd43dc894d21f85762b51208ba5c8acb)
Browse the repository at this point in the history

```
<https://origsvn.digium.com/svn/asterisk/branches/1.4>

........
r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22 Apr 2008) | 5 lines

When we receive a full frame that is supposed to contain our call number,
ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)

........

git-svn-id: [http://svn.asterisk.org/svn/asterisk/trunk@114559](http://svn.asterisk.org/svn/asterisk/trunk%40114559) f38db490-d61c-443f-a65b-d21fe96a405b
```

* Loading branch information

[![@russellb](https://avatars.githubusercontent.com/u/309258?s=40&v=4)](/russellb)

[russellb](/kaoru6/asterisk/commits?author=russellb "View all commits by russellb")
committed
Apr 22, 2008

1 parent
[fbf8f4a](/kaoru6/asterisk/commit/fbf8f4ac2b3606bf491bbbfca799da74447e5bd6)

commit 1fe14f3

Showing
**1 changed file**
with
**37 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

58 changes: 37 additions & 21 deletions

58
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/kaoru6/asterisk/blob/1fe14f38dd43dc894d21f85762b51208ba5c8acb/channels/chan_iax2.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1383,13 +1383,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1491,7 +1491,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | \* |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1503,7 +1503,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1513,14 +1513,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1529,15 +1531,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1575,14 +1591,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -7624,7 +7640,7 @@ static int socket\_process\_meta(int packet\_len, struct ast\_iax2\_meta\_hdr \*meta, s |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > packet\_len) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd, 0); |
|  |  | if (!fr->callno) |
|  |  | continue; |
|  |  |  |
| Expand Down  Expand Up | | @@ -7807,7 +7823,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) |
|  |  | return socket\_process\_meta(res, meta, &sin, fd, fr); |
| Expand Down  Expand Up | | @@ -7842,7 +7858,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -9424,7 +9440,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  |  |
|  |  | if (!reg->callno) { |
|  |  | ast\_debug(1, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -9475,7 +9491,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -9631,7 +9647,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -9710,7 +9726,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -11083,7 +11099,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_debug(1, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1fe14f3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkaoru6%2Fasterisk%2Fcommit%2F1fe14f38dd43dc894d21f85762b51208ba5c8acb) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from www.vupen.com_50503f0f_20250125_140540.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

Â© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from github.com_0f0120f9_20250125_140543.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjcollie%2Fasterisk%2Fcommit%2F60de4fbbdf3ede49f158e23a9e3b679f2e519c1e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjcollie%2Fasterisk%2Fcommit%2F60de4fbbdf3ede49f158e23a9e3b679f2e519c1e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jcollie%2Fasterisk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jan 14, 2020. It is now read-only.

[jcollie](/jcollie)
/
**[asterisk](/jcollie/asterisk)**
Public archive

* [Notifications](/login?return_to=%2Fjcollie%2Fasterisk) You must be signed in to change notification settings
* [Fork
  5](/login?return_to=%2Fjcollie%2Fasterisk)
* [Star
   10](/login?return_to=%2Fjcollie%2Fasterisk)

* [Code](/jcollie/asterisk)
* [Pull requests
  0](/jcollie/asterisk/pulls)
* [Actions](/jcollie/asterisk/actions)
* [Projects
  0](/jcollie/asterisk/projects)
* [Security](/jcollie/asterisk/security)
* [Insights](/jcollie/asterisk/pulse)

Additional navigation options

* [Code](/jcollie/asterisk)
* [Pull requests](/jcollie/asterisk/pulls)
* [Actions](/jcollie/asterisk/actions)
* [Projects](/jcollie/asterisk/projects)
* [Security](/jcollie/asterisk/security)
* [Insights](/jcollie/asterisk/pulse)

## Commit

[Permalink](/jcollie/asterisk/commit/60de4fbbdf3ede49f158e23a9e3b679f2e519c1e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merged revisions 114558 via svnmerge from

[Browse files](/jcollie/asterisk/tree/60de4fbbdf3ede49f158e23a9e3b679f2e519c1e)
Browse the repository at this point in the history

```
<https://origsvn.digium.com/svn/asterisk/branches/1.4>

........
r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22 Apr 2008) | 5 lines

When we receive a full frame that is supposed to contain our call number,
ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)

........

git-svn-id: [http://svn.asterisk.org/svn/asterisk/trunk@114559](http://svn.asterisk.org/svn/asterisk/trunk%40114559) f38db490-d61c-443f-a65b-d21fe96a405b
```

* Loading branch information

[![@russellb](https://avatars.githubusercontent.com/u/309258?s=40&v=4)](/russellb)

[russellb](/jcollie/asterisk/commits?author=russellb "View all commits by russellb")
committed
Apr 22, 2008

1 parent
[bf5243d](/jcollie/asterisk/commit/bf5243dc31d3e66cc346409a37909f3f4a4467ad)

commit 60de4fb

Showing
**1 changed file**
with
**37 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

58 changes: 37 additions & 21 deletions

58
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/jcollie/asterisk/blob/60de4fbbdf3ede49f158e23a9e3b679f2e519c1e/channels/chan_iax2.c)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1383,13 +1383,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1491,7 +1491,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | \* |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1503,7 +1503,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1513,14 +1513,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1529,15 +1531,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1575,14 +1591,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -7624,7 +7640,7 @@ static int socket\_process\_meta(int packet\_len, struct ast\_iax2\_meta\_hdr \*meta, s |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > packet\_len) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd, 0); |
|  |  | if (!fr->callno) |
|  |  | continue; |
|  |  |  |
| Expand Down  Expand Up | | @@ -7807,7 +7823,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) |
|  |  | return socket\_process\_meta(res, meta, &sin, fd, fr); |
| Expand Down  Expand Up | | @@ -7842,7 +7858,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -9424,7 +9440,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  |  |
|  |  | if (!reg->callno) { |
|  |  | ast\_debug(1, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -9475,7 +9491,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -9631,7 +9647,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -9710,7 +9726,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -11083,7 +11099,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_debug(1, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `60de4fb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjcollie%2Fasterisk%2Fcommit%2F60de4fbbdf3ede49f158e23a9e3b679f2e519c1e) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_f29da3b2_20250125_140602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilentindark%2Fasterisk-1%2Fcommit%2Ffe8b7f31db687f8b9992864b82c93d22833019c7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilentindark%2Fasterisk-1%2Fcommit%2Ffe8b7f31db687f8b9992864b82c93d22833019c7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=silentindark%2Fasterisk-1)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[silentindark](/silentindark)
/
**[asterisk-1](/silentindark/asterisk-1)**
Public

* [Notifications](/login?return_to=%2Fsilentindark%2Fasterisk-1) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fsilentindark%2Fasterisk-1)
* [Star
   0](/login?return_to=%2Fsilentindark%2Fasterisk-1)

* [Code](/silentindark/asterisk-1)
* [Pull requests
  0](/silentindark/asterisk-1/pulls)
* [Actions](/silentindark/asterisk-1/actions)
* [Projects
  0](/silentindark/asterisk-1/projects)
* [Security](/silentindark/asterisk-1/security)
* [Insights](/silentindark/asterisk-1/pulse)

Additional navigation options

* [Code](/silentindark/asterisk-1)
* [Pull requests](/silentindark/asterisk-1/pulls)
* [Actions](/silentindark/asterisk-1/actions)
* [Projects](/silentindark/asterisk-1/projects)
* [Security](/silentindark/asterisk-1/security)
* [Insights](/silentindark/asterisk-1/pulse)

## Commit

[Permalink](/silentindark/asterisk-1/commit/fe8b7f31db687f8b9992864b82c93d22833019c7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merged revisions 114558 via svnmerge from

[Browse files](/silentindark/asterisk-1/tree/fe8b7f31db687f8b9992864b82c93d22833019c7)
Browse the repository at this point in the history

```
<https://origsvn.digium.com/svn/asterisk/branches/1.4>

........
r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22 Apr 2008) | 5 lines

When we receive a full frame that is supposed to contain our call number,
ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)

........

git-svn-id: [https://origsvn.digium.com/svn/asterisk/trunk@114559](https://origsvn.digium.com/svn/asterisk/trunk%40114559) 65c4cc65-6c06-0410-ace0-fbb531ad65f3
```

* Loading branch information

[![@russellb](https://avatars.githubusercontent.com/u/309258?s=40&v=4)](/russellb)

[russellb](/silentindark/asterisk-1/commits?author=russellb "View all commits by russellb")
committed
Apr 22, 2008

1 parent
[76155d6](/silentindark/asterisk-1/commit/76155d60ce52b4a8b039286df3d5ea30f05bc0a3)

commit fe8b7f3

Showing
**1 changed file**
with
**37 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

58 changes: 37 additions & 21 deletions

58
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/silentindark/asterisk-1/blob/fe8b7f31db687f8b9992864b82c93d22833019c7/channels/chan_iax2.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1383,13 +1383,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1491,7 +1491,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | \* |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1503,7 +1503,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1513,14 +1513,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1529,15 +1531,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1575,14 +1591,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -7624,7 +7640,7 @@ static int socket\_process\_meta(int packet\_len, struct ast\_iax2\_meta\_hdr \*meta, s |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > packet\_len) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd, 0); |
|  |  | if (!fr->callno) |
|  |  | continue; |
|  |  |  |
| Expand Down  Expand Up | | @@ -7807,7 +7823,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) |
|  |  | return socket\_process\_meta(res, meta, &sin, fd, fr); |
| Expand Down  Expand Up | | @@ -7842,7 +7858,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -9424,7 +9440,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  |  |
|  |  | if (!reg->callno) { |
|  |  | ast\_debug(1, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -9475,7 +9491,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -9631,7 +9647,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -9710,7 +9726,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -11083,7 +11099,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_debug(1, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `fe8b7f3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsilentindark%2Fasterisk-1%2Fcommit%2Ffe8b7f31db687f8b9992864b82c93d22833019c7) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_1d19e070_20250125_140558.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpruiz%2Fasterisk%2Fcommit%2Fe0ef9bd22810c6969a7f222eec04798f19a7e2d6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpruiz%2Fasterisk%2Fcommit%2Fe0ef9bd22810c6969a7f222eec04798f19a7e2d6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pruiz%2Fasterisk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pruiz](/pruiz)
/
**[asterisk](/pruiz/asterisk)**
Public

* [Notifications](/login?return_to=%2Fpruiz%2Fasterisk) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fpruiz%2Fasterisk)
* [Star
   0](/login?return_to=%2Fpruiz%2Fasterisk)

* [Code](/pruiz/asterisk)
* [Issues
  0](/pruiz/asterisk/issues)
* [Pull requests
  0](/pruiz/asterisk/pulls)
* [Actions](/pruiz/asterisk/actions)
* [Projects
  0](/pruiz/asterisk/projects)
* [Wiki](/pruiz/asterisk/wiki)
* [Security](/pruiz/asterisk/security)
* [Insights](/pruiz/asterisk/pulse)

Additional navigation options

* [Code](/pruiz/asterisk)
* [Issues](/pruiz/asterisk/issues)
* [Pull requests](/pruiz/asterisk/pulls)
* [Actions](/pruiz/asterisk/actions)
* [Projects](/pruiz/asterisk/projects)
* [Wiki](/pruiz/asterisk/wiki)
* [Security](/pruiz/asterisk/security)
* [Insights](/pruiz/asterisk/pulse)

## Commit

[Permalink](/pruiz/asterisk/commit/e0ef9bd22810c6969a7f222eec04798f19a7e2d6)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merged revisions 114558 via svnmerge from

[Browse files](/pruiz/asterisk/tree/e0ef9bd22810c6969a7f222eec04798f19a7e2d6)
Browse the repository at this point in the history

```
<https://origsvn.digium.com/svn/asterisk/branches/1.4>

........
r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22 Apr 2008) | 5 lines

When we receive a full frame that is supposed to contain our call number,
ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)

........

git-svn-id: [http://svn.asterisk.org/svn/asterisk/trunk@114559](http://svn.asterisk.org/svn/asterisk/trunk%40114559) f38db490-d61c-443f-a65b-d21fe96a405b
```

* Loading branch information

russell
committed
Apr 22, 2008

1 parent
[0d93815](/pruiz/asterisk/commit/0d938154b25416508aaaf26fb65715ddb55d9079)

commit e0ef9bd

Showing
**1 changed file**
with
**37 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

58 changes: 37 additions & 21 deletions

58
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/pruiz/asterisk/blob/e0ef9bd22810c6969a7f222eec04798f19a7e2d6/channels/chan_iax2.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1383,13 +1383,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1491,7 +1491,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | \* |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1503,7 +1503,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1513,14 +1513,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1529,15 +1531,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1575,14 +1591,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -7624,7 +7640,7 @@ static int socket\_process\_meta(int packet\_len, struct ast\_iax2\_meta\_hdr \*meta, s |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > packet\_len) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd, 0); |
|  |  | if (!fr->callno) |
|  |  | continue; |
|  |  |  |
| Expand Down  Expand Up | | @@ -7807,7 +7823,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) |
|  |  | return socket\_process\_meta(res, meta, &sin, fd, fr); |
| Expand Down  Expand Up | | @@ -7842,7 +7858,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -9424,7 +9440,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  |  |
|  |  | if (!reg->callno) { |
|  |  | ast\_debug(1, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -9475,7 +9491,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -9631,7 +9647,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -9710,7 +9726,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -11083,7 +11099,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_debug(1, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e0ef9bd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpruiz%2Fasterisk%2Fcommit%2Fe0ef9bd22810c6969a7f222eec04798f19a7e2d6) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_4385f26c_20250125_140556.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmojolingo%2Fasterisk%2Fcommit%2F20ac3662f137dbf7f42d5295590069a7d3b1166b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmojolingo%2Fasterisk%2Fcommit%2F20ac3662f137dbf7f42d5295590069a7d3b1166b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mojolingo%2Fasterisk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mojolingo](/mojolingo)
/
**[asterisk](/mojolingo/asterisk)**
Public

* [Notifications](/login?return_to=%2Fmojolingo%2Fasterisk) You must be signed in to change notification settings
* [Fork
  18](/login?return_to=%2Fmojolingo%2Fasterisk)
* [Star
   7](/login?return_to=%2Fmojolingo%2Fasterisk)

* [Code](/mojolingo/asterisk)
* [Issues
  0](/mojolingo/asterisk/issues)
* [Pull requests
  1](/mojolingo/asterisk/pulls)
* [Actions](/mojolingo/asterisk/actions)
* [Projects
  0](/mojolingo/asterisk/projects)
* [Wiki](/mojolingo/asterisk/wiki)
* [Security](/mojolingo/asterisk/security)
* [Insights](/mojolingo/asterisk/pulse)

Additional navigation options

* [Code](/mojolingo/asterisk)
* [Issues](/mojolingo/asterisk/issues)
* [Pull requests](/mojolingo/asterisk/pulls)
* [Actions](/mojolingo/asterisk/actions)
* [Projects](/mojolingo/asterisk/projects)
* [Wiki](/mojolingo/asterisk/wiki)
* [Security](/mojolingo/asterisk/security)
* [Insights](/mojolingo/asterisk/pulse)

## Commit

[Permalink](/mojolingo/asterisk/commit/20ac3662f137dbf7f42d5295590069a7d3b1166b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merged revisions 114558 via svnmerge from

[Browse files](/mojolingo/asterisk/tree/20ac3662f137dbf7f42d5295590069a7d3b1166b)
Browse the repository at this point in the history

```
<https://origsvn.digium.com/svn/asterisk/branches/1.4>

........
r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22 Apr 2008) | 5 lines

When we receive a full frame that is supposed to contain our call number,
ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)

........

git-svn-id: [http://svn.digium.com/svn/asterisk/trunk@114559](http://svn.digium.com/svn/asterisk/trunk%40114559) f38db490-d61c-443f-a65b-d21fe96a405b
```

* Loading branch information

russell
committed
Apr 22, 2008

1 parent
[cc83014](/mojolingo/asterisk/commit/cc83014ec3e4178680593dde908907afe109aa5c)

commit 20ac366

Showing
**1 changed file**
with
**37 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

58 changes: 37 additions & 21 deletions

58
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/mojolingo/asterisk/blob/20ac3662f137dbf7f42d5295590069a7d3b1166b/channels/chan_iax2.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1383,13 +1383,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1491,7 +1491,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | \* |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1503,7 +1503,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1513,14 +1513,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1529,15 +1531,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1575,14 +1591,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -7624,7 +7640,7 @@ static int socket\_process\_meta(int packet\_len, struct ast\_iax2\_meta\_hdr \*meta, s |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > packet\_len) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd, 0); |
|  |  | if (!fr->callno) |
|  |  | continue; |
|  |  |  |
| Expand Down  Expand Up | | @@ -7807,7 +7823,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) |
|  |  | return socket\_process\_meta(res, meta, &sin, fd, fr); |
| Expand Down  Expand Up | | @@ -7842,7 +7858,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -9424,7 +9440,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  |  |
|  |  | if (!reg->callno) { |
|  |  | ast\_debug(1, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -9475,7 +9491,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -9631,7 +9647,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -9710,7 +9726,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -11083,7 +11099,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_debug(1, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `20ac366`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmojolingo%2Fasterisk%2Fcommit%2F20ac3662f137dbf7f42d5295590069a7d3b1166b) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from downloads.digium.com_ca71e20b_20250125_140501.html ===

# Index of /pub/security/

---

```
<../>
<ASA-2007-010.html>                                  29-Nov-2012 00:03               24158
<ASA-2007-010.pdf>                                   29-Nov-2012 00:03               55018
<ASA-2007-011.html>                                  29-Nov-2012 00:03               12793
<ASA-2007-011.pdf>                                   29-Nov-2012 00:03               42954
<ASA-2007-012.html>                                  29-Nov-2012 00:03               15001
<ASA-2007-012.pdf>                                   29-Nov-2012 00:03               44673
<ASA-2007-013.html>                                  29-Nov-2012 00:03               16835
<ASA-2007-013.pdf>                                   29-Nov-2012 00:03               47176
<ASA-2007-014.html>                                  29-Nov-2012 00:03               15184
<ASA-2007-014.pdf>                                   29-Nov-2012 00:03               46333
<ASA-2007-015.html>                                  29-Nov-2012 00:03               13003
<ASA-2007-015.pdf>                                   29-Nov-2012 00:03               42727
<ASA-2007-016.html>                                  29-Nov-2012 00:03               12890
<ASA-2007-016.pdf>                                   29-Nov-2012 00:03               50781
<ASA-2007-017.html>                                  29-Nov-2012 00:03               12307
<ASA-2007-017.pdf>                                   29-Nov-2012 00:03               41860
<ASA-2007-018.html>                                  29-Nov-2012 00:03               15065
<ASA-2007-018.pdf>                                   29-Nov-2012 00:03               45725
<ASA-2007-019.html>                                  29-Nov-2012 00:03               13219
<ASA-2007-019.pdf>                                   29-Nov-2012 00:03               43880
<ASA-2007-020.html>                                  29-Nov-2012 00:03               13507
<ASA-2007-020.pdf>                                   29-Nov-2012 00:03               44205
<AST-2007-010.html>                                  29-Nov-2012 00:03               24158
<AST-2007-010.pdf>                                   29-Nov-2012 00:03               55018
<AST-2007-011.html>                                  29-Nov-2012 00:03               12793
<AST-2007-011.pdf>                                   29-Nov-2012 00:03               42954
<AST-2007-012.html>                                  29-Nov-2012 00:03               15001
<AST-2007-012.pdf>                                   29-Nov-2012 00:03               44673
<AST-2007-013.html>                                  29-Nov-2012 00:03               16835
<AST-2007-013.pdf>                                   29-Nov-2012 00:03               47176
<AST-2007-014.html>                                  29-Nov-2012 00:03               15184
<AST-2007-014.pdf>                                   29-Nov-2012 00:03               46333
<AST-2007-015.html>                                  29-Nov-2012 00:03               13003
<AST-2007-015.pdf>                                   29-Nov-2012 00:03               42727
<AST-2007-016.html>                                  29-Nov-2012 00:03               12890
<AST-2007-016.pdf>                                   29-Nov-2012 00:03               50781
<AST-2007-017.html>                                  29-Nov-2012 00:03               12307
<AST-2007-017.pdf>                                   29-Nov-2012 00:03               41860
<AST-2007-018.html>                                  29-Nov-2012 00:03               15065
<AST-2007-018.pdf>                                   29-Nov-2012 00:03               45725
<AST-2007-019.html>                                  29-Nov-2012 00:03               13219
<AST-2007-019.pdf>                                   29-Nov-2012 00:03               43880
<AST-2007-020.html>                                  29-Nov-2012 00:03               13507
<AST-2007-020.pdf>                                   29-Nov-2012 00:03               44205
<AST-2007-021.html>                                  29-Nov-2012 00:03               11277
<AST-2007-021.pdf>                                   29-Nov-2012 00:03               46879
<AST-2007-022.html>                                  29-Nov-2012 00:03               12547
<AST-2007-022.pdf>                                   29-Nov-2012 00:03               40933
<AST-2007-023.html>                                  29-Nov-2012 00:03               10964
<AST-2007-023.pdf>                                   29-Nov-2012 00:03               38283
<AST-2007-024.html>                                  29-Nov-2012 00:03               10626
<AST-2007-024.pdf>                                   29-Nov-2012 00:03               39090
<AST-2007-025.html>                                  29-Nov-2012 00:03               11804
<AST-2007-025.pdf>                                   29-Nov-2012 00:03               38715
<AST-2007-026.html>                                  29-Nov-2012 00:03               12039
<AST-2007-026.pdf>                                   29-Nov-2012 00:03               38936
<AST-2007-027.html>                                  29-Nov-2012 00:03               11535
<AST-2007-027.pdf>                                   29-Nov-2012 00:03               38132
<AST-2008-001-1.4.patch>                             29-Nov-2012 00:03                 626
<AST-2008-001.html>                                  29-Nov-2012 00:03               12710
<AST-2008-001.pdf>                                   29-Nov-2012 00:03               38909
<AST-2008-002-1.4.patch>                             29-Nov-2012 00:03                3396
<AST-2008-002-1.6.0.patch>                           29-Nov-2012 00:03                4913
<AST-2008-002.html>                                  29-Nov-2012 00:03               14233
<AST-2008-002.pdf>                                   29-Nov-2012 00:03               39508
<AST-2008-003.html>                                  29-Nov-2012 00:03               12076
<AST-2008-003.pdf>                                   29-Nov-2012 00:03               38507
<AST-2008-004-1.6.0.patch>                           29-Nov-2012 00:03                 820
<AST-2008-004.html>                                  29-Nov-2012 00:03               12183
<AST-2008-004.pdf>                                   29-Nov-2012 00:03               38221
<AST-2008-005-1.4.patch>                             29-Nov-2012 00:03                 713
<AST-2008-005.html>                                  29-Nov-2012 00:03               16845
<AST-2008-005.pdf>                                   29-Nov-2012 00:03               41179
<AST-2008-006-1.2.patch>                             29-Nov-2012 00:03                5853
<AST-2008-006-1.4.patch>                             29-Nov-2012 00:03                6898
<AST-2008-006.html>                                  29-Nov-2012 00:03               14812
<AST-2008-006.pdf>                                   29-Nov-2012 00:03               40270
<AST-2008-007.html>                                  29-Nov-2012 00:03               11957
<AST-2008-007.pdf>                                   29-Nov-2012 00:03               37500
<AST-2008-008-1.2.patch>                             29-Nov-2012 00:03                 908
<AST-2008-008.html>                                  29-Nov-2012 00:03               11675
<AST-2008-008.pdf>                                   29-Nov-2012 00:03               38076
<AST-2008-009.html>                                  29-Nov-2012 00:03               12688
<AST-2008-009.pdf>                                   29-Nov-2012 00:03               38036
<AST-2008-010-1.2.patch>                             29-Nov-2012 00:03                1797
<AST-2008-010-1.4.patch>                             29-Nov-2012 00:03                1895
<AST-2008-010.html>                                  29-Nov-2012 00:03               16501
<AST-2008-010.pdf>                                   29-Nov-2012 00:03               41041
<AST-2008-011-1.2.patch>                             29-Nov-2012 00:03                1412
<AST-2008-011-1.4.patch>                             29-Nov-2012 00:03                1413
<AST-2008-011.html>                                  29-Nov-2012 00:03               14734
<AST-2008-011.pdf>                                   29-Nov-2012 00:03               38965
<AST-2008-012.html>                                  29-Nov-2012 00:03               12861
<AST-2008-012.pdf>                                   29-Nov-2012 00:03               45962
<AST-2009-001-1.2.diff>                              29-Nov-2012 00:03               13394
<AST-2009-001-1.2.patch>                             29-Nov-2012 00:03               13394
<AST-2009-001-1.4.diff>                              29-Nov-2012 00:03                9021
<AST-2009-001-1.4.patch>                             29-Nov-2012 00:03                9021
<AST-2009-001-1.6.0.diff>                            29-Nov-2012 00:03                8715
<AST-2009-001-1.6.0.patch>                           29-Nov-2012 00:03                8715
<AST-2009-001-1.6.1.patch>                           29-Nov-2012 00:03                8959
<AST-2009-001.html>                                  29-Nov-2012 00:03               16753
<AST-2009-001.pdf>                                   29-Nov-2012 00:03               40166
<AST-2009-002-1.4.diff>                              29-Nov-2012 00:03                1693
<AST-2009-002-1.6.0.diff>                            29-Nov-2012 00:03                1694
<AST-2009-002-1.6.1.diff>                            29-Nov-2012 00:03                1695
<AST-2009-002.html>                                  29-Nov-2012 00:03               13578
<AST-2009-002.pdf>                                   29-Nov-2012 00:03               38788
<AST-2009-003-1.2.diff.txt>                          29-Nov-2012 00:03                6546
<AST-2009-003-1.4.diff.txt>                          29-Nov-2012 00:03                8512
<AST-2009-003-1.6.0.diff.txt>                        29-Nov-2012 00:03                8378
<AST-2009-003-1.6.1.diff.txt>                        29-Nov-2012 00:03                8448
<AST-2009-003-1.6.2.diff.txt>                        29-Nov-2012 00:03                8799
<AST-2009-003.html>                                  29-Nov-2012 00:03               15482
<AST-2009-003.pdf>                                   29-Nov-2012 00:03               39250
<AST-2009-004-1.6.1.diff.txt>                        29-Nov-2012 00:03                 396
<AST-2009-004.html>                                  29-Nov-2012 00:03               12700
<AST-2009-004.pdf>                                   29-Nov-2012 00:03               37402
<AST-2009-005-1.2.diff.txt>                          29-Nov-2012 00:03               88900
<AST-2009-005-1.4.diff.txt>                          29-Nov-2012 00:03              125014
<AST-2009-005-1.6.0.diff.txt>                        29-Nov-2012 00:03              183121
<AST-2009-005-1.6.1.diff.txt>                        29-Nov-2012 00:03              170754
<AST-2009-005-1.6.2.diff.txt>                        29-Nov-2012 00:03              163914
<AST-2009-005-trunk.diff.txt>                        29-Nov-2012 00:03              208075
<AST-2009-005.html>                                  29-Nov-2012 00:03               16158
<AST-2009-005.pdf>                                   29-Nov-2012 00:03               38991
<AST-2009-006-1.2.diff.txt>                          29-Nov-2012 00:03              103291
<AST-2009-006-1.4.diff.txt>                          29-Nov-2012 00:03               77098
<AST-2009-006-1.6.0.diff.txt>                        29-Nov-2012 00:03               77446
<AST-2009-006-1.6.1.diff.txt>                        29-Nov-2012 00:03               77500
<AST-2009-006-1.6.2.diff.txt>                        29-Nov-2012 00:03               77645
<AST-2009-006.html>                                  29-Nov-2012 00:03               15996
<AST-2009-006.pdf>                                   29-Nov-2012 00:03               42078
<AST-2009-007-1.6.1.diff.txt>                        29-Nov-2012 00:03                 708
<AST-2009-007.html>                                  29-Nov-2012 00:03               11909
<AST-2009-007.pdf>                                   29-Nov-2012 00:03               36775
<AST-2009-008-1.2.diff.txt>                          29-Nov-2012 00:03                 630
<AST-2009-008-1.4.diff.txt>                          29-Nov-2012 00:03                 583
<AST-2009-008-1.6.0.diff.txt>                        29-Nov-2012 00:03                 585
<AST-2009-008-1.6.1.diff.txt>                        29-Nov-2012 00:03                1584
<AST-2009-008.html>                                  29-Nov-2012 00:03               14535
<AST-2009-008.pdf>                                   29-Nov-2012 00:03               38755
<AST-2009-009-1.4.diff.txt>                          29-Nov-2012 00:03               98870
<AST-2009-009-1.6.0.diff.txt>                        29-Nov-2012 00:03               98870
<AST-2009-009-1.6.1.diff.txt>                        29-Nov-2012 00:03               98870
<AST-2009-009.html>                                  29-Nov-2012 00:03               13396
<AST-2009-009.pdf>                                   29-Nov-2012 00:03               37979
<AST-2009-010-1.2.diff.txt>                          29-Nov-2012 00:03                 351
<AST-2009-010-1.4.diff.txt>                          29-Nov-2012 00:03                 366
<AST-2009-010-1.6.0.diff.txt>                        29-Nov-2012 00:03                 368
<AST-2009-010-1.6.1.diff.txt>                        29-Nov-2012 00:03                 368
<AST-2009-010.html>                                  29-Nov-2012 00:03               12239
<AST-2009-010.pdf>                                   29-Nov-2012 00:03               35775
<AST-2009-010.txt>                                   29-Nov-2012 00:03                8567
<AST-2010-001-1.6.0.diff>                            29-Nov-2012 00:03               15445
<AST-2010-001-1.6.1.diff>                            29-Nov-2012 00:03               15701
<AST-2010-001-1.6.2.diff>                            29-Nov-2012 00:03               15703
<AST-2010-001.html>                                  29-Nov-2012 00:03               10851
<AST-2010-001.pdf>                                   29-Nov-2012 00:03               35458
<AST-2010-001.txt>                                   29-Nov-2012 00:03                7681
<AST-2010-002.html>                                  29-Nov-2012 00:03               15017
<AST-2010-002.pdf>                                   29-Nov-2012 00:03               41763
<AST-2010-002.txt>                                   29-Nov-2012 00:03               12464
<AST-2010-003-1.6.0.diff>                            29-Nov-2012 00:03                 645
<AST-2010-003-1.6.1.diff>                            29-Nov-2012 00:03                 645
<AST-2010-003-1.6.2.diff>                            29-Nov-2012 00:03                 649
<AST-2010-003.html>                                  29-Nov-2012 00:03               12992
<AST-2010-003.pdf>                                   29-Nov-2012 00:03               37550
<AST-2011-001-1.4.diff>                              29-Nov-2012 00:03                1182
<AST-2011-001-1.6.1.diff>                            29-Nov-2012 00:03                1179
<AST-2011-001-1.6.2.diff>                            29-Nov-2012 00:03                3340
<AST-2011-001-1.8.diff>                              29-Nov-2012 00:03                4717
<AST-2011-001.html>                                  29-Nov-2012 00:03               28694
<AST-2011-001.pdf>                                   29-Nov-2012 00:03               38356
<AST-2011-002-1.4.diff>                              29-Nov-2012 00:03                2700
<AST-2011-002-1.6.1.diff>                            29-Nov-2012 00:03                2791
<AST-2011-002-1.6.2.diff>                            29-Nov-2012 00:03                2861
<AST-2011-002-1.8.diff>                              29-Nov-2012 00:03                2861
<AST-2011-002.html>                                  29-Nov-2012 00:03               27213
<AST-2011-002.pdf>                                   29-Nov-2012 00:03               37112
<AST-2011-003-1.6.1.diff>                            29-Nov-2012 00:03                1173
<AST-2011-003-1.6.2.diff>                            29-Nov-2012 00:03                1168
<AST-2011-003-1.8.diff>                              29-Nov-2012 00:03                1377
<AST-2011-003.html>                                  29-Nov-2012 00:03               23789
<AST-2011-003.pdf>                                   29-Nov-2012 00:03               34394
<AST-2011-004-1.6.1.diff>                            29-Nov-2012 00:03                 667
<AST-2011-004-1.6.2.diff>                            29-Nov-2012 00:03                 667
<AST-2011-004-1.8.diff>                              29-Nov-2012 00:03                 667
<AST-2011-004.html>                                  29-Nov-2012 00:03               18872
<AST-2011-004.pdf>                                   29-Nov-2012 00:03               36183
<AST-2011-005-1.4.diff>                              29-Nov-2012 00:03               15142
<AST-2011-005-1.6.1.diff>                            29-Nov-2012 00:03               23891
<AST-2011-005-1.6.2.diff>                            29-Nov-2012 00:03               26163
<AST-2011-005-1.8.diff>                              29-Nov-2012 00:03               26316
<AST-2011-005.html>                                  29-Nov-2012 00:03               25693
<AST-2011-005.pdf>                                   29-Nov-2012 00:03               36192
<AST-2011-006-1.6.1.diff>                            29-Nov-2012 00:03                2464
<AST-2011-006-1.6.2.diff>                            29-Nov-2012 00:03                2436
<AST-2011-006-1.8.diff>                              29-Nov-2012 00:03                2436
<AST-2011-006.html>                                  29-Nov-2012 00:03               23504
<AST-2011-006.pdf>                                   29-Nov-2012 00:03               34461
<AST-2011-007-1.8.diff>                              29-Nov-2012 00:03                 714
<AST-2011-007.html>                                  29-Nov-2012 00:03                8957
<AST-2011-007.pdf>                                   29-Nov-2012 00:03               41924
<AST-2011-008.diff>                                  29-Nov-2012 00:03                 457
<AST-2011-008.html>                                  29-Nov-2012 00:03               17827
<AST-2011-008.pdf>                                   29-Nov-2012 00:03               27932
<AST-2011-009-1.8.diff>                              29-Nov-2012 00:03                1656
<AST-2011-009.html>                                  29-Nov-2012 00:03               16181
<AST-2011-009.pdf>                                   29-Nov-2012 00:03               27495
<AST-2011-010-1.4.diff>                              29-Nov-2012 00:03                2091
<AST-2011-010-1.6.2.diff>                            29-Nov-2012 00:03                2043
<AST-2011-010-1.8.diff>                              29-Nov-2012 00:03                7328
<AST-2011-010.html>                                  29-Nov-2012 00:03               10895
<AST-2011-010.pdf>                                   29-Nov-2012 00:03               50631
<AST-2011-011-1.4.diff>                              29-Nov-2012 00:03                1156
<AST-2011-011-1.6.2.diff>                            29-Nov-2012 00:03                2258
<AST-2011-011-1.8.diff>                              29-Nov-2012 00:03                2274
<AST-2011-011.html>                                  29-Nov-2012 00:03               11254
<AST-2011-011.pdf>                                   29-Nov-2012 00:03               37446
<AST-2011-012-1.8.diff>                              29-Nov-2012 00:03                 898
<AST-2011-012-10.diff>                               29-Nov-2012 00:03                 902
<AST-2011-012.html>                                  29-Nov-2012 00:03               20863
<AST-2011-012.pdf>                                   29-Nov-2012 00:03               44273
<AST-2011-013.html>                                  29-Nov-2012 00:03               17629
<AST-2011-013.pdf>                                   29-Nov-2012 00:03               38276
<AST-2011-014-1.6.2.diff>                            29-Nov-2012 00:03                 798
<AST-2011-014-1.8.diff>                              29-Nov-2012 00:03                 798
<AST-2011-014.html>                                  29-Nov-2012 00:03               20361
<AST-2011-014.pdf>                                   29-Nov-2012 00:03               36448
<AST-2012-001-1.8.diff>                              29-Nov-2012 00:03                 604
<AST-2012-001-10.diff>                               29-Nov-2012 00:03                 604
<AST-2012-001.html>                                  29-Nov-2012 00:03               10237
<AST-2012-001.pdf>                                   29-Nov-2012 00:03               42781
<AST-2012-002-1.4.diff>                              29-Nov-2012 00:03                 591
<AST-2012-002-1.6.2.diff>                            29-Nov-2012 00:03                 948
<AST-2012-002-1.8.diff>                              29-Nov-2012 00:03                5633
<AST-2012-002-10.diff>                               29-Nov-2012 00:03               19473
<AST-2012-002.html>                                  29-Nov-2012 00:03               26936
<AST-2012-002.odt>                                   29-Nov-2012 00:03               16422
<AST-2012-002.pdf>                                   29-Nov-2012 00:03               38877
<AST-2012-002.txt>                                   29-Nov-2012 00:03                6090
<AST-2012-003-1.8.diff>                              29-Nov-2012 00:03                4440
<AST-2012-003-10.diff>                               29-Nov-2012 00:03               23370
<AST-2012-003.html>                                  29-Nov-2012 00:03               21631
<AST-2012-003.odt>                                   29-Nov-2012 00:03               15367
<AST-2012-003.pdf>                                   29-Nov-2012 00:03               36385
<AST-2012-003.txt>                                   29-Nov-2012 00:03                3637
<AST-2012-004-1.6.2.diff>                            29-Nov-2012 00:03                2766
<AST-2012-004-1.8.diff>                              29-Nov-2012 00:03                2871
<AST-2012-004-10.diff>                               29-Nov-2012 00:03                2871
<AST-2012-004.html>                                  29-Nov-2012 00:03               25639
<AST-2012-004.pdf>                                   29-Nov-2012 00:03               45622
<AST-2012-005-1.6.2.diff>                            29-Nov-2012 00:03                 979
<AST-2012-005-1.8.diff>                              29-Nov-2012 00:03                1003
<AST-2012-005-10.diff>                               29-Nov-2012 00:03                1007
<AST-2012-005.html>                                  29-Nov-2012 00:03               23000
<AST-2012-005.pdf>                                   29-Nov-2012 00:03               38453
<AST-2012-006-1.8.diff>                              29-Nov-2012 00:03                 515
<AST-2012-006-10.diff>                               29-Nov-2012 00:03                 517
<AST-2012-006.html>                                  29-Nov-2012 00:03               24082
<AST-2012-006.pdf>                                   29-Nov-2012 00:03               38845
<AST-2012-007-1.8.11-cert.diff>                      29-Nov-2012 00:03                1924
<AST-2012-007-1.8.diff>                              29-Nov-2012 00:03                1927
<AST-2012-007-10.diff>                               29-Nov-2012 00:03                1904
<AST-2012-007.html>                                  29-Nov-2012 00:03               23305
<AST-2012-007.odt>                                   29-Nov-2012 00:03               15827
<AST-2012-007.pdf>                                   29-Nov-2012 00:03               45549
<AST-2012-007.txt>                                   29-Nov-2012 00:03                4672
<AST-2012-008-1.8.11-cert.diff>                      29-Nov-2012 00:03                3030
<AST-2012-008-1.8.diff>                              29-Nov-2012 00:03                3030
<AST-2012-008-10.diff>                               29-Nov-2012 00:03                2073
<AST-2012-008.html>                                  29-Nov-2012 00:03               24146
<AST-2012-008.odt>                                   29-Nov-2012 00:03               16227
<AST-2012-008.pdf>                                   29-Nov-2012 00:03               59973
<AST-2012-008.txt>                                   29-Nov-2012 00:03                4593
<AST-2012-009-10.diff>                               29-Nov-2012 00:03                 937
<AST-2012-009.html>                                  29-Nov-2012 00:03               19889
<AST-2012-009.odt>                                   29-Nov-2012 00:03               16313
<AST-2012-009.pdf>                                   29-Nov-2012 00:03               56306
<AST-2012-009.txt>                                   29-Nov-2012 00:03                3925
<AST-2012-010-1.8.diff>                              29-Nov-2012 00:03                6351
<AST-2012-010-10.diff>                               29-Nov-2012 00:03                6351
<AST-2012-010.html>                                  29-Nov-2012 00:03               26063
<AST-2012-010.odt>                                   29-Nov-2012 00:03               15846
<AST-2012-010.pdf>                                   29-Nov-2012 00:03               57361
<AST-2012-010.txt>                                   29-Nov-2012 00:03                4482
<AST-2012-011-1.8.diff>                              29-Nov-2012 00:03                4124
<AST-2012-011-10.diff>                               29-Nov-2012 00:03                4116
<AST-2012-011.html>                                  29-Nov-2012 00:03               23702
<AST-2012-011.odt>                                   29-Nov-2012 00:03               16090
<AST-2012-011.pdf>                                   29-Nov-2012 00:03               55130
<AST-2012-011.txt>                                   29-Nov-2012 00:03                4107
<AST-2012-012-1.8.diff>                              29-Nov-2012 00:03                 673
<AST-2012-012-10.diff>                               29-Nov-2012 00:03                 673
<AST-2012-012-11.diff>                               29-Nov-2012 00:03                 673
<AST-2012-012.html>                                  29-Nov-2012 00:03               28073
<AST-2012-012.pdf>                                   29-Nov-2012 00:03               42145
<AST-2012-013-1.8.diff>                              29-Nov-2012 00:03                1715
<AST-2012-013-10.diff>                               29-Nov-2012 00:03                1715
<AST-2012-013-11.diff>                               29-Nov-2012 00:03                1511
<AST-2012-013.html>                                  29-Nov-2012 00:03               25943
<AST-2012-013.pdf>                                   29-Nov-2012 00:03               39018
<AST-2012-014-1.8.11.diff>                           02-Jan-2013 21:00               12152
<AST-2012-014-1.8.diff>                              02-Jan-2013 21:00                8383
<AST-2012-014-10.diff>                               02-Jan-2013 21:00               33305
<AST-2012-014-11.diff>                               03-Jan-2013 16:00               23700
<AST-2012-014.html>                                  07-Jan-2013 22:05               13509
<AST-2012-014.pdf>                                   07-Jan-2013 22:05               49442
<AST-2012-015-1.8.11.diff>                           02-Jan-2013 21:00               50620
<AST-2012-015-1.8.diff>                              02-Jan-2013 21:00               40530
<AST-2012-015-10.diff>                               02-Jan-2013 21:00               66413
<AST-2012-015-11.diff>                               03-Jan-2013 16:00               63753
<AST-2012-015.html>                                  03-Jan-2013 16:20               26770
<AST-2012-015.pdf>                                   03-Jan-2013 16:20               40880
<AST-2013-001-11.diff>                               27-Mar-2013 20:10                1631
<AST-2013-001.html>                                  27-Mar-2013 20:10               20182
<AST-2013-001.pdf>                                   27-Mar-2013 20:10               37347
<AST-2013-002-1.8.15-cert.diff>                      27-Mar-2013 20:10                 752
<AST-2013-002-1.8.diff>                              27-Mar-2013 20:10                 752
<AST-2013-002-10.diff>                               27-Mar-2013 20:10                 759
<AST-2013-002-11.diff>                               27-Mar-2013 20:10                 759
<AST-2013-002.html>                                  27-Mar-2013 21:30               28569
<AST-2013-002.pdf>                                   27-Mar-2013 21:30               39165
<AST-2013-003-1.8.15-cert.diff>                      27-Mar-2013 20:10               14519
<AST-2013-003-1.8.diff>                              27-Mar-2013 20:10               13851
<AST-2013-003-10.diff>                               27-Mar-2013 20:10               16728
<AST-2013-003-11.diff>                               27-Mar-2013 20:10               16761
<AST-2013-003-C.3.diff>                              27-Mar-2013 20:10               14491
<AST-2013-003.html>                                  27-Mar-2013 20:10               29765
<AST-2013-003.pdf>                                   27-Mar-2013 20:10               39991
<AST-2013-004-1.8.15-cert.diff>                      27-Aug-2013 22:50                3814
<AST-2013-004-1.8.diff>                              27-Aug-2013 22:50                 452
<AST-2013-004-11.2-cert.diff>                        27-Aug-2013 22:50                1147
<AST-2013-004-11.diff>                               27-Aug-2013 22:50               14969
<AST-2013-004.html>                                  28-Aug-2013 17:35               25251
<AST-2013-004.pdf>                                   28-Aug-2013 17:35               39060
<AST-2013-005-1.8.15.diff>                           27-Aug-2013 22:50                4635
<AST-2013-005-1.8.diff>                              27-Aug-2013 22:50                1259
<AST-2013-005-10-digiumphones.diff>                  27-Aug-2013 22:50               26375
<AST-2013-005-10.diff>                               27-Aug-2013 22:50               26281
<AST-2013-005-11.2.diff>                             27-Aug-2013 22:50                1996
<AST-2013-005-11.diff>                               27-Aug-2013 22:50               15818
<AST-2013-005.html>                                  28-Aug-2013 17:35               29304
<AST-2013-005.pdf>                                   28-Aug-2013 17:35               53156
<AST-2013-006-1.8.15.diff>                           16-Dec-2013 21:55                3946
<AST-2013-006-1.8.diff>                              16-Dec-2013 21:55                 486
<AST-2013-006-10-digiumphones.diff>                  16-Dec-2013 21:55                 486
<AST-2013-006-10.diff>                               16-Dec-2013 21:55               25520
<AST-2013-006-11.2.diff>                             16-Dec-2013 21:55                 486
<AST-2013-006-11.diff>                               16-Dec-2013 21:55                3652
<AST-2013-006.html>                                  17-Dec-2013 15:30               13155
<AST-2013-006.pdf>                                   17-Dec-2013 15:30               39091
<AST-2013-007-1.8.15.diff>                           16-Dec-2013 21:55               32835
<AST-2013-007-1.8.diff>                              16-Dec-2013 21:55               30188
<AST-2013-007-10-digiumphones.diff>                  16-Dec-2013 21:55               54713
<AST-2013-007-10.diff>                               16-Dec-2013 21:55               54727
<AST-2013-007-11.2.diff>                             16-Dec-2013 21:55               30449
<AST-2013-007-11.diff>                               16-Dec-2013 21:55               33248
<AST-2013-007.html>                                  17-Dec-2013 15:30               13849
<AST-2013-007.pdf>                                   17-Dec-2013 15:30               41329
<AST-2014-001-1.8.15.diff>                           10-Mar-2014 20:50                3159
<AST-2014-001-1.8.diff>                              10-Mar-2014 20:45                3022
<AST-2014-001-11.6.diff>                             10-Mar-2014 20:50                3022
<AST-2014-001-11.diff>                               10-Mar-2014 20:45                3022
<AST-2014-001-12.diff>                               10-Mar-2014 20:45                3171
<AST-2014-001.html>                                  10-Mar-2014 20:45               25792
<AST-2014-001.pdf>                                   10-Mar-2014 20:45               38246
<AST-2014-002-1.8.11.diff>                           10-Mar-2014 20:45               11938
<AST-2014-002-1.8.15.diff>                           10-Mar-2014 20:45               11920
<AST-2014-002-1.8.diff>                              10-Mar-2014 20:45               11929
<AST-2014-002-11.6.diff>                             10-Mar-2014 20:45               11976
<AST-2014-002-11.diff>                               10-Mar-2014 20:45               11973
<AST-2014-002-12.diff>                               10-Mar-2014 20:45               11973
<AST-2014-002.html>                                  10-Mar-2014 20:45               30332
<AST-2014-002.pdf>                                   10-Mar-2014 20:45               40299
<AST-2014-003-12.diff>                               10-Mar-2014 20:45                1561
<AST-2014-003.html>                                  10-Mar-2014 20:45               19051
<AST-2014-003.pdf>                                   10-Mar-2014 20:45               35029
<AST-2014-004-12.diff>                               10-Mar-2014 20:55                1425
<AST-2014-004.html>                                  10-Mar-2014 20:55               19293
<AST-2014-004.pdf>                                   10-Mar-2014 20:55               35780
<AST-2014-005-12.diff>                               12-Jun-2014 20:20                1435
<AST-2014-005.html>                                  12-Jun-2014 20:20               19984
<AST-2014-005.pdf>                                   12-Jun-2014 20:20               36467
<AST-2014-006-11.6.diff>                             12-Jun-2014 20:20                1764
<AST-2014-006-11.diff>                               12-Jun-2014 20:20                1657
<AST-2014-006-12.diff>                               12-Jun-2014 20:20                1547
<AST-2014-006.html>                                  12-Jun-2014 20:20               23517
<AST-2014-006.pdf>                                   12-Jun-2014 20:20               36818
<AST-2014-007-1.8.15.diff>                           12-Jun-2014 20:20               33888
<AST-2014-007-1.8.diff>                              12-Jun-2014 20:20               30269
<AST-2014-007-11.6.diff>                             12-Jun-2014 20:20               30465
<AST-2014-007-11.diff>                               12-Jun-2014 20:20               30432
<AST-2014-007-12.diff>                               12-Jun-2014 20:20               30155
<AST-2014-007.html>                                  12-Jun-2014 20:20               26687
<AST-2014-007.pdf>                                   12-Jun-2014 20:20               38659
<AST-2014-008-12.diff>                               12-Jun-2014 20:20                 452
<AST-2014-008.html>                                  12-Jun-2014 20:20               20081
<AST-2014-008.pdf>                                   12-Jun-2014 20:20               35710
<AST-2014-009-12.diff>                               18-Sep-2014 18:45                9657
<AST-2014-009.html>                                  19-Sep-2014 01:20               24217
<AST-2014-009.pdf>                                   19-Sep-2014 01:20               37538
<AST-2014-010-11.6.diff>                             18-Sep-2014 18:45                7428
<AST-2014-010-11.diff>                               18-Sep-2014 18:45                 815
<AST-2014-010-12.diff>                               18-Sep-2014 18:45               12332
<AST-2014-010.html>                                  19-Sep-2014 01:20               25354
<AST-2014-010.pdf>                                   19-Sep-2014 01:20               39267
<AST-2014-011-1.8.28.diff>                           20-Oct-2014 16:15                4165
<AST-2014-011-1.8.diff>                              20-Oct-2014 16:15                3752
<AST-2014-011-11.6.diff>                             20-Oct-2014 16:15               11250
<AST-2014-011-11.diff>                               20-Oct-2014 16:15                4647
<AST-2014-011-12.diff>                               20-Oct-2014 16:15                4528
<AST-2014-011.html>                                  20-Oct-2014 16:15               28506
<AST-2014-011.pdf>                                   20-Oct-2014 16:15               43118
<AST-2014-012-1.8.28.diff>                           20-Nov-2014 22:15                1003
<AST-2014-012-1.8.diff>                              20-Nov-2014 22:15                 543
<AST-2014-012-11.6.diff>                             20-Nov-2014 22:15                7226
<AST-2014-012-11.diff>                               20-Nov-2014 22:15                6995
<AST-2014-012-12.diff>                               20-Nov-2014 22:15               12984
<AST-2014-012-13.diff>                               20-Nov-2014 22:15               11710
<AST-2014-012.html>                                  21-Nov-2014 21:40               28958
<AST-2014-012.pdf>                                   21-Nov-2014 21:40               44199
<AST-2014-013-12.diff>                               20-Nov-2014 22:15                 629
<AST-2014-013-13.diff>                               20-Nov-2014 22:15                 629
<AST-2014-013.html>                                  21-Nov-2014 21:40               21157
<AST-2014-013.pdf>                                   21-Nov-2014 21:40               37126
<AST-2014-014-11.6.diff>                             20-Nov-2014 22:15                1710
<AST-2014-014-11.diff>                               20-Nov-2014 22:15                1710
<AST-2014-014.html>                                  21-Nov-2014 21:40               21842
<AST-2014-014.pdf>                                   21-Nov-2014 21:40               36039
<AST-2014-015-12.diff>                               20-Nov-2014 22:15                1470
<AST-2014-015-13.diff>                               20-Nov-2014 22:15                1472
<AST-2014-015.html>                                  21-Nov-2014 21:40               20996
<AST-2014-015.pdf>                                   21-Nov-2014 21:40               36044
<AST-2014-016-12.diff>                               20-Nov-2014 22:15                1750
<AST-2014-016-13.diff>                               20-Nov-2014 22:15                1750
<AST-2014-016.html>                                  21-Nov-2014 21:40               21150
<AST-2014-016.pdf>                                   21-Nov-2014 21:40               36057
<AST-2014-017-11.6.diff>                             20-Nov-2014 22:15                1328
<AST-2014-017-11.diff>                               20-Nov-2014 22:15                1328
<AST-2014-017-12.diff>                               20-Nov-2014 22:15                1322
<AST-2014-017-13.diff>                               20-Nov-2014 22:15                1322
<AST-2014-017.html>                                  21-Nov-2014 21:40               24754
<AST-2014-017.pdf>                                   21-Nov-2014 21:40               36968
<AST-2014-018-1.8.28.diff>                           20-Nov-2014 22:15                 482
<AST-2014-018-1.8.diff>                              20-Nov-2014 22:15                 482
<AST-2014-018-11.6.diff>                             20-Nov-2014 22:15                 538
<AST-2014-018-11.diff>                               20-Nov-2014 22:15                 538
<AST-2014-018-12.diff>                               20-Nov-2014 22:15                 538
<AST-2014-018-13.diff>                               20-Nov-2014 22:15                 538
<AST-2014-018.html>                                  21-Nov-2014 21:40               27450
<AST-2014-018.pdf>                                   21-Nov-2014 21:40               36737
<AST-2014-019-11.6.diff>                             10-Dec-2014 18:05                2304
<AST-2014-019-11.diff>                               10-Dec-2014 18:05                2554
<AST-2014-019-12.diff>                               10-Dec-2014 18:05                3165
<AST-2014-019-13.diff>                               10-Dec-2014 18:05                3165
<AST-2014-019.html>                                  22-Dec-2014 15:35               26105
<AST-2014-019.pdf>                                   22-Dec-2014 15:35               38627
<AST-2015-001-12.diff>                               28-Jan-2015 22:40                5370
<AST-2015-001-13.diff>                               28-Jan-2015 22:40               17013
<AST-2015-001.html>                                  11-Feb-2015 16:30               25504
<AST-2015-001.pdf>                                   11-Feb-2015 16:30               37092
<AST-2015-002-1.8.28.diff>                           28-Jan-2015 22:40                4213
<AST-2015-002-1.8.diff>                              28-Jan-2015 22:40                3739
<AST-2015-002-11.6.diff>                             28-Jan-2015 22:40               10527
<AST-2015-002-11.diff>                               28-Jan-2015 22:40                3739
<AST-2015-002-12.diff>                               28-Jan-2015 22:40               16313
<AST-2015-002-13.diff>                               28-Jan-2015 22:40               15368
<AST-2015-002.html>                                  28-Jan-2015 22:40               28434
<AST-2015-002.pdf>                                   28-Jan-2015 22:40               38707
<AST-2015-003-1.8.28.diff>                           08-Apr-2015 17:45                 915
<AST-2015-003-1.8.diff>                              08-Apr-2015 17:45                 915
<AST-2015-003-11.6.diff>                             08-Apr-2015 17:45                 868
<AST-2015-003-11.diff>                               08-Apr-2015 17:45                 868
<AST-2015-003-12.diff>                               08-Apr-2015 17:45                 868
<AST-2015-003-13.1.diff>                             08-Apr-2015 17:45                 868
<AST-2015-003-13.diff>                               08-Apr-2015 17:45                 868
<AST-2015-003.html>                                  08-Apr-2015 21:25               30162
<AST-2015-003.pdf>                                   08-Apr-2015 21:25               38958
<AST-2016-001-1.8.28.diff>                           04-Feb-2016 01:30                6800
<AST-2016-001-1.8.diff>                              04-Feb-2016 01:30                6800
<AST-2016-001-11.6.diff>                             04-Feb-2016 01:30                6809
<AST-2016-001-11.diff>                               04-Feb-2016 01:30                6809
<AST-2016-001-12.diff>                               04-Feb-2016 01:30                6801
<AST-2016-001-13.1.diff>                             04-Feb-2016 01:30                6561
<AST-2016-001-13.diff>                               04-Feb-2016 01:30                6561
<AST-2016-001.html>                                  15-Feb-2016 17:50               29422
<AST-2016-001.pdf>                                   15-Feb-2016 17:50               37918
<AST-2016-002-1.8.28.diff>                           04-Feb-2016 01:30                 619
<AST-2016-002-1.8.diff>                              04-Feb-2016 01:30                 619
<AST-2016-002-11.6.diff>                             04-Feb-2016 01:30                 619
<AST-2016-002-11.diff>                               04-Feb-2016 01:30                 619
<AST-2016-002-12.diff>                               04-Feb-2016 01:30                 619
<AST-2016-002-13.1.diff>                             04-Feb-2016 01:30                 619
<AST-2016-002-13.diff>                               04-Feb-2016 01:30                 619
<AST-2016-002.html>                                  15-Feb-2016 17:50               29685
<AST-2016-002.pdf>                                   15-Feb-2016 17:50               37055
<AST-2016-003-1.8.28.diff>                           04-Feb-2016 01:30                 819
<AST-2016-003-1.8.diff>                              04-Feb-2016 01:30                 819
<AST-2016-003-11.6.diff>                             04-Feb-2016 01:30                 819
<AST-2016-003-11.diff>                               04-Feb-2016 01:30                 819
<AST-2016-003-12.diff>                               04-Feb-2016 01:30                 819
<AST-2016-003-13.1.diff>                             04-Feb-2016 01:30                 819
<AST-2016-003-13.diff>                               04-Feb-2016 01:30                 819
<AST-2016-003.html>                                  15-Feb-2016 17:50               29620
<AST-2016-003.pdf>                                   15-Feb-2016 17:50               37277
<AST-2016-004-13.1.diff>                             14-Apr-2016 21:55               24660
<AST-2016-004-13.diff>                               14-Apr-2016 21:55                8337
<AST-2016-004.html>                                  14-Apr-2016 21:55               23213
<AST-2016-004.pdf>                                   14-Apr-2016 21:55               36020
<AST-2016-005-13.1.diff>                             14-Apr-2016 21:55               18797
<AST-2016-005-13.diff>                               14-Apr-2016 21:55               18888
<AST-2016-005.html>                                  14-Apr-2016 21:55               23760
<AST-2016-005.pdf>                                   14-Apr-2016 21:55               39834
<AST-2016-006-13.diff>                               08-Sep-2016 20:05                1289
<AST-2016-006.html>                                  08-Sep-2016 20:05               22675
<AST-2016-006.pdf>                                   08-Sep-2016 20:05               35552
<AST-2016-007-11.6-cert.diff>                        08-Sep-2016 20:05                2323
<AST-2016-007-11.diff>                               08-Sep-2016 20:05                2257
<AST-2016-007-13.8-cert.diff>                        08-Sep-2016 20:05                2281
<AST-2016-007-13.diff>                               08-Sep-2016 20:05                2281
<AST-2016-007.html>                                  25-Oct-2016 18:05               25451
<AST-2016-007.pdf>                                   25-Oct-2016 18:05               37840
<AST-2016-008-13.diff>                               08-Dec-2016 21:30                2378
<AST-2016-008-14.diff>                               08-Dec-2016 21:30                2378
<AST-2016-008.html>                                  13-Dec-2016 17:40               21895
<AST-2016-008.pdf>                                   13-Dec-2016 17:40               36144
<AST-2016-009-11.6-cert16.diff>                      08-Dec-2016 21:30                 973
<AST-2016-009-11.diff>                               08-Dec-2016 21:30                1135
<AST-2016-009-13.8-cert.diff>                        08-Dec-2016 21:30                1135
<AST-2016-009-13.diff>                               08-Dec-2016 21:30                1135
<AST-2016-009-14.diff>                               08-Dec-2016 21:30                1135
<AST-2016-009.html>                                  13-Dec-2016 17:40               25477
<AST-2016-009.pdf>                                   13-Dec-2016 17:40               37923
<AST-2017-001-13.13.diff>                            04-Apr-2017 14:25                1088
<AST-2017-001-13.diff>                               04-Apr-2017 14:25                1112
<AST-2017-001-14.diff>                               04-Apr-2017 14:25                1112
<AST-2017-001.html>                                  14-Apr-2017 15:25               24381
<AST-2017-001.pdf>                                   14-Apr-2017 15:25               36739
<AST-2017-002.html>                                  19-May-2017 21:55               23571
<AST-2017-002.odt>                                   19-May-2017 21:55               57836
<AST-2017-002.pdf>                                   19-May-2017 21:55               37069
<AST-2017-002.txt>                                   19-May-2017 21:55                4363
<AST-2017-003.html>                                  19-May-2017 21:55               24124
<AST-2017-003.odt>                                   19-May-2017 21:55               56290
<AST-2017-003.pdf>                                   19-May-2017 21:55               36695
<AST-2017-003.txt>                                   19-May-2017 21:55                4284
<AST-2017-004.html>                                  19-May-2017 21:55               23907
<AST-2017-004.odt>                                   19-May-2017 21:55               18650
<AST-2017-004.pdf>                                   19-May-2017 21:55               35182
<AST-2017-004.txt>                                   19-May-2017 21:55                3825
<AST-2017-005-11.6.diff>                             31-Aug-2017 18:50                8060
<AST-2017-005-11.diff>                               31-Aug-2017 18:50                8060
<AST-2017-005-13.13.diff>                            31-Aug-2017 18:50                8364
<AST-2017-005-13.diff>                               31-Aug-2017 18:50                8361
<AST-2017-005-14.diff>                               31-Aug-2017 18:50                8361
<AST-2017-005.html>                                  31-Aug-2017 21:40               28403
<AST-2017-005.pdf>                                   31-Aug-2017 21:40               49780
<AST-2017-006-11.6.diff>                             31-Aug-2017 18:50               14504
<AST-2017-006-11.diff>                               31-Aug-2017 18:50               14504
<AST-2017-006-13.13.diff>                            31-Aug-2017 18:50               15163
<AST-2017-006-13.diff>                               31-Aug-2017 18:50               15163
<AST-2017-006-14.diff>                               31-Aug-2017 18:50               15163
<AST-2017-006.html>                                  31-Aug-2017 21:40               30759
<AST-2017-006.pdf>                                   31-Aug-2017 21:40               61303
<AST-2017-007-13.diff>                               31-Aug-2017 18:50                2965
<AST-2017-007-14.diff>                               31-Aug-2017 18:50                2965
<AST-2017-007.html>                                  31-Aug-2017 21:40               26297
<AST-2017-007.pdf>                                   31-Aug-2017 21:40               57663
<AST-2017-008-11.6.diff>                             19-Sep-2017 16:45               28798
<AST-2017-008-11.diff>                               19-Sep-2017 16:45               28814
<AST-2017-008-13.13.diff>                            19-Sep-2017 16:45               28292
<AST-2017-008-13.diff>                               19-Sep-2017 16:45               28133
<AST-2017-008-14.diff>                               19-Sep-2017 16:45               28133
<AST-2017-008.html>                                  20-Sep-2017 09:45               30731
<AST-2017-008.pdf>                                   20-Sep-2017 09:45               47592
<AST-2017-009-13.13.diff>                            08-Nov-2017 18:05               32595
<AST-2017-009-13.diff>                               08-Nov-2017 18:05               34629
<AST-2017-009-14.diff>                               08-Nov-2017 18:05               33154
<AST-2017-009-15.diff>                               08-Nov-2017 18:05               34629
<AST-2017-009.html>                                  08-Nov-2017 18:05               26898
<AST-2017-009.pdf>                                   08-Nov-2017 18:05               35949
<AST-2017-010-13.13.diff>                            08-Nov-2017 18:05                 879
<AST-2017-010-13.diff>                               08-Nov-2017 18:05                 903
<AST-2017-010-14.diff>                               08-Nov-2017 18:05                 903
<AST-2017-010-15.diff>                               08-Nov-2017 18:05                 903
<AST-2017-010.html>                                  10-Nov-2017 16:30               26833
<AST-2017-010.pdf>                                   10-Nov-2017 16:30               37515
<AST-2017-011-13.13.diff>                            08-Nov-2017 18:05                4572
<AST-2017-011-13.diff>                               08-Nov-2017 18:05                4572
<AST-2017-011-14.diff>                               08-Nov-2017 18:05                4572
<AST-2017-011-15.diff>                               08-Nov-2017 18:05                4572
<AST-2017-011.html>                                  10-Nov-2017 16:30               26055
<AST-2017-011.pdf>                                   10-Nov-2017 16:30               36907
<AST-2017-012-13.13.diff>                            13-Dec-2017 13:30                2304
<AST-2017-012-13.diff>                               13-Dec-2017 13:30                2325
<AST-2017-012-14.diff>                               13-Dec-2017 13:30                2325
<AST-2017-012-15.diff>                               13-Dec-2017 13:30                2307
<AST-2017-012.html>                                  13-Dec-2017 13:30               25207
<AST-2017-012.pdf>                                   13-Dec-2017 13:30               37447
<AST-2017-013-13.13.diff>                            01-Dec-2017 20:45                2032
<AST-2017-013-13.diff>                               01-Dec-2017 20:45                2032
<AST-2017-013-14.diff>                               01-Dec-2017 20:45                2032
<AST-2017-013-15.diff>                               01-Dec-2017 20:45                2032
<AST-2017-013.html>                                  04-Dec-2017 16:50               25521
<AST-2017-013.pdf>                                   04-Dec-2017 16:50               36018
<AST-2017-014-13.18.diff>                            22-Dec-2017 23:10                3519
<AST-2017-014-13.diff>                               22-Dec-2017 23:10                3519
<AST-2017-014-14.diff>                               22-Dec-2017 23:10                3520
<AST-2017-014-15.diff>                               22-Dec-2017 23:10                3519
<AST-2017-014.html>                                  22-Dec-2017 23:45               26211
<AST-2017-014.pdf>                                   22-Dec-2017 23:45               47661
<AST-2018-001-15.diff>                               21-Feb-2018 20:45                3027
<AST-2018-001.html>                                  21-Feb-2018 20:45               23804
<AST-2018-001.pdf>                                   21-Feb-2018 20:45               36365
<AST-2018-002-13.18.diff>                            21-Feb-2018 20:45                1702
<AST-2018-002-13.diff>                               21-Feb-2018 20:45                1702
<AST-2018-002-14.diff>                               21-Feb-2018 20:45                1702
<AST-2018-002-15.diff>                               21-Feb-2018 20:45                1702
<AST-2018-002.html>                                  08-Mar-2018 17:15               26188
<AST-2018-002.pdf>                                   08-Mar-2018 17:15               37007
<AST-2018-003-13.18.diff>                            21-Feb-2018 20:45                2017
<AST-2018-003-13.diff>                               21-Feb-2018 20:45                2017
<AST-2018-003-14.diff>                               21-Feb-2018 20:45                2017
<AST-2018-003-15.diff>                               21-Feb-2018 20:45                2017
<AST-2018-003.html>                                  08-Mar-2018 17:15               26144
<AST-2018-003.pdf>                                   08-Mar-2018 17:15               37151
<AST-2018-004-13.18.diff>                            21-Feb-2018 20:45                1647
<AST-2018-004-13.diff>                               21-Feb-2018 20:45                1647
<AST-2018-004-14.diff>                               21-Feb-2018 20:45                1647
<AST-2018-004-15.diff>                               21-Feb-2018 20:45                1647
<AST-2018-004.html>                                  21-Feb-2018 20:45               25619
<AST-2018-004.pdf>                                   21-Feb-2018 20:45               36696
<AST-2018-005-13.18.diff>                            21-Feb-2018 20:45                9158
<AST-2018-005-13.diff>                               21-Feb-2018 20:45                9144
<AST-2018-005-14.diff>                               21-Feb-2018 20:45                9686
<AST-2018-005-15.diff>                               21-Feb-2018 20:45                9550
<AST-2018-005.html>                                  21-Feb-2018 20:45               25620
<AST-2018-005.pdf>                                   21-Feb-2018 20:45               47323
<AST-2018-006-15.diff>                               21-Feb-2018 23:20                1696
<AST-2018-006.html>                                  21-Feb-2018 20:45               20361
<AST-2018-006.pdf>                                   21-Feb-2018 20:45               35303
<AST-2018-007-15.diff>                               11-Jun-2018 21:50                1706
<AST-2018-007.html>                                  12-Jun-2018 14:25               22404
<AST-2018-007.pdf>                                   12-Jun-2018 14:25               35956
<AST-2018-008-13.18.diff>                            11-Jun-2018 21:50                3206
<AST-2018-008-13.21.diff>                            11-Jun-2018 21:50                3206
<AST-2018-008-13.diff>                               11-Jun-2018 21:50                3206
<AST-2018-008-14.diff>                               11-Jun-2018 21:50                3206
<AST-2018-008-15.diff>                               11-Jun-2018 21:50                3206
<AST-2018-008.html>                                  12-Jun-2018 14:25               30347
<AST-2018-008.pdf>                                   12-Jun-2018 14:25               49171
<AST-2018-009-13.21.diff>                            20-Sep-2018 19:50                4255
<AST-2018-009-13.diff>                               20-Sep-2018 19:50                4255
<AST-2018-009-14.diff>                               20-Sep-2018 19:50                4255
<AST-2018-009-15.diff>                               20-Sep-2018 19:50                4255
<AST-2018-009.html>                                  20-Sep-2018 19:50               28008
<AST-2018-009.pdf>                                   20-Sep-2018 19:50               50854
<AST-2018-010-15.diff>                               14-Nov-2018 16:55                3492
<AST-2018-010-16.diff>                               14-Nov-2018 16:55                3492
<AST-2018-010.html>                                  14-Nov-2018 20:10               23825
<AST-2018-010.pdf>                                   14-Nov-2018 20:10               55003
<AST-2019-001-15.diff>                               28-Feb-2019 18:55                1267
<AST-2019-001-16.diff>                               28-Feb-2019 18:55                1267
<AST-2019-001.html>                                  01-Mar-2019 18:05               24963
<AST-2019-001.pdf>                                   01-Mar-2019 18:05               61950
<AST-2019-002-13.21.diff>                            11-Jul-2019 21:35                1499
<AST-2019-002-13.diff>                               11-Jul-2019 21:35                1377
<AST-2019-002-15.diff>                               11-Jul-2019 21:35                1566
<AST-2019-002-16.diff>                               11-Jul-2019 21:35                1566
<AST-2019-002.html>                                  11-Jul-2019 21:35               26091
<AST-2019-002.pdf>                                   11-Jul-2019 21:35               40821
<AST-2019-003-13.21.diff>                            11-Jul-2019 21:35                1655
<AST-2019-003-13.diff>                               11-Jul-2019 21:35                1655
<AST-2019-003-15.diff>                               11-Jul-2019 21:35                1655
<AST-2019-003-16.diff>                               11-Jul-2019 21:35                1655
<AST-2019-003.html>                                  11-Jul-2019 21:35               26602
<AST-2019-003.pdf>                                   11-Jul-2019 21:35               37233
<AST-2019-004-15.diff>                               05-Sep-2019 14:35                8222
<AST-2019-004-16.diff>                               05-Sep-2019 14:35                8222
<AST-2019-004.html>                                  05-Sep-2019 14:35               21908
<AST-2019-004.pdf>                                   05-Sep-2019 14:35               41466
<AST-2019-005-13.diff>                               05-Sep-2019 14:35                1187
<AST-2019-005-16.diff>                               05-Sep-2019 14:35                1187
<AST-2019-005.html>                                  05-Sep-2019 14:35               23067
<AST-2019-005.pdf>                                   05-Sep-2019 14:35               36298
<AST-2019-006-13.21.diff>                            21-Nov-2019 22:35                2956
<AST-2019-006-13.diff>                               21-Nov-2019 22:35                2956
<AST-2019-006-16.diff>                               21-Nov-2019 22:35                2956
<AST-2019-006-17.diff>                               21-Nov-2019 22:35                2956
<AST-2019-006.html>                                  21-Nov-2019 22:35               29926
<AST-2019-006.pdf>                                   21-Nov-2019 22:35               47898
<AST-2019-007-13.21.diff>                            21-Nov-2019 22:35                1776
<AST-2019-007-13.diff>                               21-Nov-2019 22:35                1776
<AST-2019-007-16.diff>                               21-Nov-2019 22:35                1776
<AST-2019-007-17.diff>                               21-Nov-2019 22:35                1776
<AST-2019-007.html>                                  21-Nov-2019 22:35               28381
<AST-2019-007.pdf>                                   21-Nov-2019 22:35               41834
<AST-2019-008-13.21.diff>                            21-Nov-2019 22:35                1229
<AST-2019-008-13.diff>                               21-Nov-2019 22:35                1229
<AST-2019-008.html>                                  21-Nov-2019 22:35               23642
<AST-2019-008.pdf>                                   21-Nov-2019 22:35               37842
<AST-2020-001-13.diff>                               05-Nov-2020 21:35               16078
<AST-2020-001-16.8.diff>                             05-Nov-2020 21:35               16078
<AST-2020-001-16.diff>                               05-Nov-2020 21:35               16868
<AST-2020-001-17.diff>                               05-Nov-2020 21:35               15923
<AST-2020-001-18.diff>                               05-Nov-2020 21:35               16247
<AST-2020-001.html>                                  06-Nov-2020 18:25               33922
<AST-2020-001.pdf>                                   06-Nov-2020 18:25               57023
<AST-2020-002-13.diff>                               05-Nov-2020 21:35                4073
<AST-2020-002-16.8.diff>                             05-Nov-2020 21:35                4148
<AST-2020-002-16.diff>                               05-Nov-2020 21:35                4148
<AST-2020-002-17.diff>                               05-Nov-2020 21:35                4098
<AST-2020-002-18.diff>                               05-Nov-2020 21:35                3940
<AST-2020-002.html>                                  05-Nov-2020 21:35               29945
<AST-2020-002.pdf>                                   05-Nov-2020 21:35               42809
<AST-2020-003-13.diff>                               22-Dec-2020 21:25                1326
<AST-2020-003-16.diff>                               22-Dec-2020 21:25                1326
<AST-2020-003-17.diff>                               22-Dec-2020 21:25                1326
<AST-2020-003-18.diff>                               22-Dec-2020 21:25                1326
<AST-2020-003.html>                                  23-Dec-2020 15:10               27475
<AST-2020-003.pdf>                                   23-Dec-2020 15:10               45118
<AST-2020-004.html>                                  23-Dec-2020 15:10               26990
<AST-2020-004.pdf>                                   23-Dec-2020 15:10               45111
<AST-2021-001-13.diff>                               18-Feb-2021 17:00                4075
<AST-2021-001-16.diff>                               18-Feb-2021 17:00                4075
<AST-2021-001-17.diff>                               18-Feb-2021 17:00                4137
<AST-2021-001-18.diff>                               18-Feb-2021 17:00                4137
<AST-2021-001.html>                                  18-Feb-2021 17:00               30201
<AST-2021-001.pdf>                                   18-Feb-2021 17:00               31892
<AST-2021-002-16.8.diff>                             18-Feb-2021 17:00                2788
<AST-2021-002-16.diff>                               18-Feb-2021 17:00                2820
<AST-2021-002-17.diff>                               18-Feb-2021 17:00                2788
<AST-2021-002-18.diff>                               18-Feb-2021 17:00                2820
<AST-2021-002.html>                                  18-Feb-2021 17:00               26297
<AST-2021-002.pdf>                                   18-Feb-2021 17:00               35508
<AST-2021-003-13.diff>                               18-Feb-2021 17:00                5728
<AST-2021-003-16.8.diff>                             18-Feb-2021 17:00                5756
<AST-2021-003-16.diff>                               18-Feb-2021 17:00                6068
<AST-2021-003-17.diff>                               18-Feb-2021 17:00                6068
<AST-2021-003-18.diff>                               18-Feb-2021 17:00                6068
<AST-2021-003.html>                                  18-Feb-2021 17:40               28632
<AST-2021-003.pdf>                                   18-Feb-2021 17:40               31556
<AST-2021-004-16.8.diff>                             18-Feb-2021 17:00                1051
<AST-2021-004-16.diff>                               18-Feb-2021 17:00                1051
<AST-2021-004-17.diff>                               18-Feb-2021 17:00                1051
<AST-2021-004-18.diff>                               18-Feb-2021 17:00                1051
<AST-2021-004.html>                                  19-Feb-2021 18:50               26864
<AST-2021-004.pdf>                                   19-Feb-2021 18:50               24857
<AST-2021-005-13.diff>                               18-Feb-2021 17:00                2540
<AST-2021-005-16.8.diff>                             18-Feb-2021 17:00                2540
<AST-2021-005-16.diff>                               18-Feb-2021 17:00                2540
<AST-2021-005-17.diff>                               18-Feb-2021 17:00                2540
<AST-2021-005-18.diff>                               18-Feb-2021 17:00                2540
<AST-2021-005.html>                                  18-Feb-2021 17:30               28897
<AST-2021-005.pdf>                                   18-Feb-2021 17:30               43864
<AST-2021-006-16.8.diff>                             04-Mar-2021 18:17                 971
<AST-2021-006-16.diff>                               04-Mar-2021 18:17                 971
<AST-2021-006-17.diff>                               04-Mar-2021 18:17                 971
<AST-2021-006-18.diff>                               04-Mar-2021 18:17                 971
<AST-2021-006.html>                                  04-Mar-2021 22:30               26152
<AST-2021-006.pdf>                                   04-Mar-2021 22:30               36760
<AST-2021-007-16.diff>                               22-Jul-2021 22:41                1430
<AST-2021-007-18.diff>                               22-Jul-2021 22:41                1430
<AST-2021-007.html>                                  22-Jul-2021 22:41               21953
<AST-2021-007.pdf>                                   22-Jul-2021 22:41               39084
<AST-2021-008-13.diff>                               22-Jul-2021 22:41                4353
<AST-2021-008-16.8.diff>                             22-Jul-2021 22:41                4353
<AST-2021-008-16.diff>                               22-Jul-2021 22:41                4353
<AST-2021-008-17.diff>                               22-Jul-2021 22:41                4353
<AST-2021-008-18.diff>                               22-Jul-2021 22:41                4353
<AST-2021-008.html>                                  22-Jul-2021 22:41               28776
<AST-2021-008.pdf>                                   22-Jul-2021 22:41               33290
<AST-2021-009-13.diff>                               22-Jul-2021 22:41               12026
<AST-2021-009-16.8.diff>                             22-Jul-2021 22:41               12007
<AST-2021-009-16.diff>                               22-Jul-2021 22:41               12026
<AST-2021-009-17.diff>                               22-Jul-2021 22:41               12026
<AST-2021-009-18.diff>                               22-Jul-2021 22:41               12026
<AST-2021-009.html>                                  22-Jul-2021 22:41               28055
<AST-2021-009.pdf>                                   22-Jul-2021 22:41               39172
<AST-2022-001-16.diff>                               14-Apr-2022 22:54                9949
<AST-2022-001-18.diff>                               14-Apr-2022 22:54                9949
<AST-2022-001-19.diff>                               14-Apr-2022 22:54                9949
<AST-2022-001.html>                                  14-Apr-2022 22:54               23946
<AST-2022-001.pdf>                                   14-Apr-2022 22:54               35748
<AST-2022-002-16.diff>                               14-Apr-2022 22:54               31119
<AST-2022-002-18.diff>                               14-Apr-2022 22:54               30903
<AST-2022-002-19.diff>                               14-Apr-2022 22:54               30903
<AST-2022-002.html>                                  14-Apr-2022 22:54               24675
<AST-2022-002.pdf>                                   14-Apr-2022 22:54               36857
<AST-2022-003-16.8.diff>                             14-Apr-2022 22:54                4533
<AST-2022-003-16.diff>                               14-Apr-2022 22:54                4533
<AST-2022-003-18.diff>                               14-Apr-2022 22:54                4533
<AST-2022-003-19.diff>                               14-Apr-2022 22:54                4533
<AST-2022-003.html>                                  14-Apr-2022 22:54               26378
<AST-2022-003.pdf>                                   14-Apr-2022 22:54               36411
<AST-2022-004-16.8.diff>                             04-Mar-2022 19:20                1510
<AST-2022-004-16.diff>                               04-Mar-2022 19:20                1510
<AST-2022-004-18.diff>                               04-Mar-2022 19:20                1510
<AST-2022-004-19.diff>                               04-Mar-2022 19:20                1510
<AST-2022-004.html>                                  04-Mar-2022 20:00               26754
<AST-2022-004.pdf>                                   04-Mar-2022 19:20               36100
<AST-2022-005-16.8.diff>                             04-Mar-2022 19:20                4933
<AST-2022-005-16.diff>                               04-Mar-2022 19:20                4933
<AST-2022-005-18.diff>                               04-Mar-2022 19:20                4933
<AST-2022-005-19.diff>                               04-Mar-2022 19:20                4933
<AST-2022-005.html>                                  04-Mar-2022 19:20               26626
<AST-2022-005.pdf>                                   04-Mar-2022 19:20               35917
<AST-2022-006-16.8.diff>                             04-Mar-2022 19:20                1815
<AST-2022-006-16.diff>                               04-Mar-2022 19:20                1815
<AST-2022-006-18.diff>                               04-Mar-2022 19:20                1815
<AST-2022-006-19.diff>                               04-Mar-2022 19:20                1815
<AST-2022-006.html>                                  04-Mar-2022 19:20               26750
<AST-2022-006.pdf>                                   04-Mar-2022 19:20               35631
<AST-2022-007-16.diff>                               01-Dec-2022 20:50                2361
<AST-2022-007-18.9.diff>                             01-Dec-2022 20:50                2361
<AST-2022-007-18.diff>                               01-Dec-2022 20:50                2361
<AST-2022-007-19.diff>                               01-Dec-2022 20:50                2361
<AST-2022-007-20.diff>                               01-Dec-2022 20:50                2361
<AST-2022-007.html>                                  01-Dec-2022 20:50               24771
<AST-2022-007.pdf>                                   01-Dec-2022 20:50               41346
<AST-2022-008-16.diff>                               01-Dec-2022 20:50               26962
<AST-2022-008-18.9.diff>                             01-Dec-2022 20:50               26813
<AST-2022-008-18.diff>                               01-Dec-2022 20:50               26901
<AST-2022-008-19.diff>                               01-Dec-2022 20:50               26901
<AST-2022-008-20.diff>                               01-Dec-2022 20:50               26901
<AST-2022-008.html>                                  01-Dec-2022 20:50               29652
<AST-2022-008.pdf>                                   01-Dec-2022 20:50               46517
<AST-2022-009-16.diff>                               01-Dec-2022 20:50                5586
<AST-2022-009-18.9.diff>                             01-Dec-2022 20:50                5586
<AST-2022-009-18.diff>                               01-Dec-2022 20:50                5586
<AST-2022-009-19.diff>                               01-Dec-2022 20:50                5586
<AST-2022-009-20.diff>                               01-Dec-2022 20:50                5586
<AST-2022-009.html>                                  01-Dec-2022 20:50               26307
<AST-2022-009.pdf>                                   01-Dec-2022 20:50               42285
<ASTERISK-2016-009.html>                             13-Dec-2016 17:40               25477
<ASTERISK-2016-009.pdf>                              13-Dec-2016 17:40               37923
<IAX2-security.html>                                 29-Nov-2012 00:03               27428
<IAX2-security.pdf>                                  29-Nov-2012 00:03              358100

```

---



=== Content from secunia.com_d377cc3f_20250125_140504.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...



=== Content from secunia.com_db47c0e1_20250125_140505.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...



=== Content from github.com_d267e1b9_20250125_140546.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjcollie%2Fasterisk%2Fcommit%2F771b3d8749b34b6eea4e03a2e514380da9582f90)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjcollie%2Fasterisk%2Fcommit%2F771b3d8749b34b6eea4e03a2e514380da9582f90)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jcollie%2Fasterisk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jan 14, 2020. It is now read-only.

[jcollie](/jcollie)
/
**[asterisk](/jcollie/asterisk)**
Public archive

* [Notifications](/login?return_to=%2Fjcollie%2Fasterisk) You must be signed in to change notification settings
* [Fork
  5](/login?return_to=%2Fjcollie%2Fasterisk)
* [Star
   10](/login?return_to=%2Fjcollie%2Fasterisk)

* [Code](/jcollie/asterisk)
* [Pull requests
  0](/jcollie/asterisk/pulls)
* [Actions](/jcollie/asterisk/actions)
* [Projects
  0](/jcollie/asterisk/projects)
* [Security](/jcollie/asterisk/security)
* [Insights](/jcollie/asterisk/pulse)

Additional navigation options

* [Code](/jcollie/asterisk)
* [Pull requests](/jcollie/asterisk/pulls)
* [Actions](/jcollie/asterisk/actions)
* [Projects](/jcollie/asterisk/projects)
* [Security](/jcollie/asterisk/security)
* [Insights](/jcollie/asterisk/pulse)

## Commit

[Permalink](/jcollie/asterisk/commit/771b3d8749b34b6eea4e03a2e514380da9582f90)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merged revisions 114558 via svnmerge from

[Browse files](/jcollie/asterisk/tree/771b3d8749b34b6eea4e03a2e514380da9582f90)
Browse the repository at this point in the history

```
<https://origsvn.digium.com/svn/asterisk/branches/1.4>

........
r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22 Apr 2008) | 5 lines

When we receive a full frame that is supposed to contain our call number,
ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)

........

git-svn-id: [http://svn.asterisk.org/svn/asterisk/trunk@114559](http://svn.asterisk.org/svn/asterisk/trunk%40114559) f38db490-d61c-443f-a65b-d21fe96a405b
```

* Loading branch information

[![@russellb](https://avatars.githubusercontent.com/u/309258?s=40&v=4)](/russellb)

[russellb](/jcollie/asterisk/commits?author=russellb "View all commits by russellb")
committed
Apr 22, 2008

1 parent
[d253583](/jcollie/asterisk/commit/d25358320eaa2b8f26898ccba7df73122a5f64db)

commit 771b3d8

Showing
**1 changed file**
with
**37 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

58 changes: 37 additions & 21 deletions

58
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/jcollie/asterisk/blob/771b3d8749b34b6eea4e03a2e514380da9582f90/channels/chan_iax2.c)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1383,13 +1383,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1491,7 +1491,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | \* |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1503,7 +1503,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1513,14 +1513,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1529,15 +1531,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1575,14 +1591,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -7624,7 +7640,7 @@ static int socket\_process\_meta(int packet\_len, struct ast\_iax2\_meta\_hdr \*meta, s |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > packet\_len) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd, 0); |
|  |  | if (!fr->callno) |
|  |  | continue; |
|  |  |  |
| Expand Down  Expand Up | | @@ -7807,7 +7823,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) |
|  |  | return socket\_process\_meta(res, meta, &sin, fd, fr); |
| Expand Down  Expand Up | | @@ -7842,7 +7858,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -9424,7 +9440,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  |  |
|  |  | if (!reg->callno) { |
|  |  | ast\_debug(1, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -9475,7 +9491,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -9631,7 +9647,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -9710,7 +9726,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -11083,7 +11099,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_debug(1, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `771b3d8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjcollie%2Fasterisk%2Fcommit%2F771b3d8749b34b6eea4e03a2e514380da9582f90) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_6e11e391_20250125_140554.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flyx2014%2FAsterisk%2Fcommit%2F0670e43c30135044e25cca7f80e1833e2c128653)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flyx2014%2FAsterisk%2Fcommit%2F0670e43c30135044e25cca7f80e1833e2c128653)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=lyx2014%2FAsterisk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lyx2014](/lyx2014)
/
**[Asterisk](/lyx2014/Asterisk)**
Public

* [Notifications](/login?return_to=%2Flyx2014%2FAsterisk) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Flyx2014%2FAsterisk)
* [Star
   0](/login?return_to=%2Flyx2014%2FAsterisk)

* [Code](/lyx2014/Asterisk)
* [Issues
  0](/lyx2014/Asterisk/issues)
* [Pull requests
  0](/lyx2014/Asterisk/pulls)
* [Actions](/lyx2014/Asterisk/actions)
* [Projects
  0](/lyx2014/Asterisk/projects)
* [Wiki](/lyx2014/Asterisk/wiki)
* [Security](/lyx2014/Asterisk/security)
* [Insights](/lyx2014/Asterisk/pulse)

Additional navigation options

* [Code](/lyx2014/Asterisk)
* [Issues](/lyx2014/Asterisk/issues)
* [Pull requests](/lyx2014/Asterisk/pulls)
* [Actions](/lyx2014/Asterisk/actions)
* [Projects](/lyx2014/Asterisk/projects)
* [Wiki](/lyx2014/Asterisk/wiki)
* [Security](/lyx2014/Asterisk/security)
* [Insights](/lyx2014/Asterisk/pulse)

## Commit

[Permalink](/lyx2014/Asterisk/commit/0670e43c30135044e25cca7f80e1833e2c128653)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merged revisions 114558 via svnmerge from

[Browse files](/lyx2014/Asterisk/tree/0670e43c30135044e25cca7f80e1833e2c128653)
Browse the repository at this point in the history

```
<https://origsvn.digium.com/svn/asterisk/branches/1.4>

........
r114558 | russell | 2008-04-22 17:15:36 -0500 (Tue, 22 Apr 2008) | 5 lines

When we receive a full frame that is supposed to contain our call number,
ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)

........
```

* Loading branch information

russell
committed
Apr 22, 2008

1 parent
[b68cf7f](/lyx2014/Asterisk/commit/b68cf7fd183ed750fc8a3f936a3198f8d697bd4d)

commit 0670e43

Showing
**1 changed file**
with
**37 additions**
and
**21 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

58 changes: 37 additions & 21 deletions

58
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/lyx2014/Asterisk/blob/0670e43c30135044e25cca7f80e1833e2c128653/channels/chan_iax2.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1383,13 +1383,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, const struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1491,7 +1491,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | \* |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1503,7 +1503,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1513,14 +1513,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1529,15 +1531,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1575,14 +1591,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -7624,7 +7640,7 @@ static int socket\_process\_meta(int packet\_len, struct ast\_iax2\_meta\_hdr \*meta, s |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > packet\_len) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, sin, NEW\_PREVENT, sockfd, 0); |
|  |  | if (!fr->callno) |
|  |  | continue; |
|  |  |  |
| Expand Down  Expand Up | | @@ -7807,7 +7823,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) |
|  |  | return socket\_process\_meta(res, meta, &sin, fd, fr); |
| Expand Down  Expand Up | | @@ -7842,7 +7858,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -9424,7 +9440,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  |  |
|  |  | if (!reg->callno) { |
|  |  | ast\_debug(1, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -9475,7 +9491,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -9631,7 +9647,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -9710,7 +9726,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -11083,7 +11099,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_debug(1, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0670e43`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flyx2014%2FAsterisk%2Fcommit%2F0670e43c30135044e25cca7f80e1833e2c128653) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_b612e80f_20250125_140604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxrg%2Fasterisk-xrg%2Fcommit%2F10da3dab24e8ca08cf2c983f8d0206e383535b5a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxrg%2Fasterisk-xrg%2Fcommit%2F10da3dab24e8ca08cf2c983f8d0206e383535b5a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xrg%2Fasterisk-xrg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xrg](/xrg)
/
**[asterisk-xrg](/xrg/asterisk-xrg)**
Public

* [Notifications](/login?return_to=%2Fxrg%2Fasterisk-xrg) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fxrg%2Fasterisk-xrg)
* [Star
   4](/login?return_to=%2Fxrg%2Fasterisk-xrg)

* [Code](/xrg/asterisk-xrg)
* [Issues
  0](/xrg/asterisk-xrg/issues)
* [Pull requests
  0](/xrg/asterisk-xrg/pulls)
* [Actions](/xrg/asterisk-xrg/actions)
* [Projects
  0](/xrg/asterisk-xrg/projects)
* [Wiki](/xrg/asterisk-xrg/wiki)
* [Security](/xrg/asterisk-xrg/security)
* [Insights](/xrg/asterisk-xrg/pulse)

Additional navigation options

* [Code](/xrg/asterisk-xrg)
* [Issues](/xrg/asterisk-xrg/issues)
* [Pull requests](/xrg/asterisk-xrg/pulls)
* [Actions](/xrg/asterisk-xrg/actions)
* [Projects](/xrg/asterisk-xrg/projects)
* [Wiki](/xrg/asterisk-xrg/wiki)
* [Security](/xrg/asterisk-xrg/security)
* [Insights](/xrg/asterisk-xrg/pulse)

## Commit

[Permalink](/xrg/asterisk-xrg/commit/10da3dab24e8ca08cf2c983f8d0206e383535b5a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

When we receive a full frame that is supposed to contain our call numâ€¦

[Browse files](/xrg/asterisk-xrg/tree/10da3dab24e8ca08cf2c983f8d0206e383535b5a)
Browse the repository at this point in the history

```
â€¦ber,

ensure that it has the correct one.
(closes issue #10078)
(AST-2008-006)
```

* Loading branch information

russell
committed
Apr 22, 2008

1 parent
[bc1db65](/xrg/asterisk-xrg/commit/bc1db655399316ac0e9cd178f1beffedc5037969)

commit 10da3da

Showing
**1 changed file**
with
**38 additions**
and
**22 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

60 changes: 38 additions & 22 deletions

60
[channels/chan\_iax2.c](#diff-9848544abeb820ab244656d28dc9ef90c78c543497c905b0c45f13cad2ce4d3b "channels/chan_iax2.c")

Show comments

[View file](/xrg/asterisk-xrg/blob/10da3dab24e8ca08cf2c983f8d0206e383535b5a/channels/chan_iax2.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1239,13 +1239,13 @@ static struct iax\_frame \*iaxfrdup2(struct iax\_frame \*fr) |
|  |  | #define NEW\_ALLOW 1 |
|  |  | #define NEW\_FORCE 2 |
|  |  |  |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, struct chan\_iax2\_pvt \*cur) |
|  |  | static int match(struct sockaddr\_in \*sin, unsigned short callno, unsigned short dcallno, struct chan\_iax2\_pvt \*cur, int full\_frame) |
|  |  | { |
|  |  | if ((cur->addr.sin\_addr.s\_addr == sin->sin\_addr.s\_addr) && |
|  |  | (cur->addr.sin\_port == sin->sin\_port)) { |
|  |  | /\* This is the main host \*/ |
|  |  | if ((cur->peercallno == callno) || |
|  |  | ((dcallno == cur->callno) && !cur->peercallno)) { |
|  |  | if ( (cur->peercallno == 0 || cur->peercallno == callno) && |
|  |  | (full\_frame ? dcallno == cur->callno : 1) ) { |
|  |  | /\* That's us. Be sure we keep track of the peer call number \*/ |
|  |  | return 1; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1336,7 +1336,7 @@ static int make\_trunk(unsigned short callno, int locked) |
|  |  | /\*! |
|  |  | \* \note Calling this function while holding another pvt lock can cause a deadlock. |
|  |  | \*/ |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked) |
|  |  | static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int return\_locked, int full\_frame) |
|  |  | { |
|  |  | int res = 0; |
|  |  | int x; |
| Expand All | | @@ -1349,7 +1349,7 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1359,14 +1359,16 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (iaxs[x]) { |
|  |  | /\* Look for an exact match \*/ |
|  |  | if (match(sin, callno, dcallno, iaxs[x])) { |
|  |  | if (match(sin, callno, dcallno, iaxs[x], full\_frame)) { |
|  |  | res = x; |
|  |  | } |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  | } |
|  |  | } |
|  |  | if ((res < 1) && (new >= NEW\_ALLOW)) { |
|  |  | int start, found = 0; |
|  |  |  |
|  |  | /\* It may seem odd that we look through the peer list for a name for |
|  |  | \* this \*incoming\* call. Well, it is weird. However, users don't |
|  |  | \* have an IP address/port number that we can match against. So, |
| Expand All | | @@ -1375,15 +1377,29 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | \* correct, but it will be changed if needed after authentication. \*/ |
|  |  | if (!iax2\_getpeername(\*sin, host, sizeof(host))) |
|  |  | snprintf(host, sizeof(host), "%s:%d", ast\_inet\_ntoa(sin->sin\_addr), ntohs(sin->sin\_port)); |
|  |  | gettimeofday(&now, NULL); |
|  |  | for (x=1;x<TRUNK\_CALL\_START;x++) { |
|  |  |  |
|  |  | now = ast\_tvnow(); |
|  |  | start = 1 + (ast\_random() % (TRUNK\_CALL\_START - 1)); |
|  |  | for (x = start; 1; x++) { |
|  |  | if (x == TRUNK\_CALL\_START) { |
|  |  | x = 0; |
|  |  | continue; |
|  |  | } |
|  |  |  |
|  |  | /\* Find first unused call number that hasn't been used in a while \*/ |
|  |  | ast\_mutex\_lock(&iaxsl[x]); |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) break; |
|  |  | if (!iaxs[x] && ((now.tv\_sec - lastused[x].tv\_sec) > MIN\_REUSE\_TIME)) { |
|  |  | found = 1; |
|  |  | break; |
|  |  | } |
|  |  | ast\_mutex\_unlock(&iaxsl[x]); |
|  |  |  |
|  |  | if (x == start - 1) { |
|  |  | break; |
|  |  | } |
|  |  | } |
|  |  | /\* We've still got lock held if we found a spot \*/ |
|  |  | if (x >= TRUNK\_CALL\_START) { |
|  |  | if (x == start - 1 && !found) { |
|  |  | ast\_log(LOG\_WARNING, "No more space\n"); |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1420,14 +1436,14 @@ static int \_\_find\_callno(unsigned short callno, unsigned short dcallno, struct s |
|  |  | return res; |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 0, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd) { |
|  |  | static int find\_callno\_locked(unsigned short callno, unsigned short dcallno, struct sockaddr\_in \*sin, int new, int sockfd, int full\_frame) { |
|  |  |  |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1); |
|  |  | return \_\_find\_callno(callno, dcallno, sin, new, sockfd, 1, full\_frame); |
|  |  | } |
|  |  |  |
|  |  | static void iax2\_frame\_free(struct iax\_frame \*fr) |
| Expand Down  Expand Up | | @@ -6871,7 +6887,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | /\* This is a video frame, get call number \*/ |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(vh->callno) & ~0x8000, dcallno, &sin, new, fd, 0); |
|  |  | minivid = 1; |
|  |  | } else if ((meta->zeros == 0) && !(ntohs(meta->metacmd) & 0x8000)) { |
|  |  | unsigned char metatype; |
| Expand Down  Expand Up | | @@ -6929,7 +6945,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | /\* Stop if we don't have enough data \*/ |
|  |  | if (len > res) |
|  |  | break; |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, &sin, NEW\_PREVENT, fd); |
|  |  | fr->callno = find\_callno\_locked(callno & ~IAX\_FLAG\_FULL, 0, &sin, NEW\_PREVENT, fd, 0); |
|  |  | if (fr->callno) { |
|  |  | /\* If it's a valid call, deliver the contents. If not, we |
|  |  | drop it, since we don't have a scallno to use for an INVAL \*/ |
| Expand Down  Expand Up | | @@ -7015,7 +7031,7 @@ static int socket\_process(struct iax2\_thread \*thread) |
|  |  | } |
|  |  |  |
|  |  | if (!fr->callno) |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd); |
|  |  | fr->callno = find\_callno(ntohs(mh->callno) & ~IAX\_FLAG\_FULL, dcallno, &sin, new, fd, ntohs(mh->callno) & IAX\_FLAG\_FULL); |
|  |  |  |
|  |  | if (fr->callno > 0) |
|  |  | ast\_mutex\_lock(&iaxsl[fr->callno]); |
| Expand Down  Expand Up | | @@ -8510,7 +8526,7 @@ static int iax2\_do\_register(struct iax2\_registry \*reg) |
|  |  | if (!reg->callno) { |
|  |  | if (option\_debug) |
|  |  | ast\_log(LOG\_DEBUG, "Allocate call number\n"); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd); |
|  |  | reg->callno = find\_callno\_locked(0, 0, &reg->addr, NEW\_FORCE, defaultsockfd, 0); |
|  |  | if (reg->callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call for registration\n"); |
|  |  | return -1; |
| Expand Down  Expand Up | | @@ -8571,7 +8587,7 @@ static int iax2\_provision(struct sockaddr\_in \*end, int sockfd, char \*dest, const |
|  |  | memset(&ied, 0, sizeof(ied)); |
|  |  | iax\_ie\_append\_raw(&ied, IAX\_IE\_PROVISIONING, provdata.buf, provdata.pos); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (!callno) |
|  |  | return -1; |
|  |  |  |
| Expand Down  Expand Up | | @@ -8712,7 +8728,7 @@ static int iax2\_poke\_peer(struct iax2\_peer \*peer, int heldcall) |
|  |  | } |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_unlock(&iaxsl[heldcall]); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd); |
|  |  | peer->callno = find\_callno(0, 0, &peer->addr, NEW\_FORCE, peer->sockfd, 0); |
|  |  | if (heldcall) |
|  |  | ast\_mutex\_lock(&iaxsl[heldcall]); |
|  |  | if (peer->callno < 1) { |
| Expand Down  Expand Up | | @@ -8792,7 +8808,7 @@ static struct ast\_channel \*iax2\_request(const char \*type, int format, void \*data |
|  |  | if (pds.port) |
|  |  | sin.sin\_port = htons(atoi(pds.port)); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | \*cause = AST\_CAUSE\_CONGESTION; |
| Expand Down  Expand Up | | @@ -10106,7 +10122,7 @@ static int cache\_get\_callno\_locked(const char \*data) |
|  |  | ast\_log(LOG\_DEBUG, "peer: %s, username: %s, password: %s, context: %s\n", |
|  |  | pds.peer, pds.username, pds.password, pds.context); |
|  |  |  |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd); |
|  |  | callno = find\_callno\_locked(0, 0, &sin, NEW\_FORCE, cai.sockfd, 0); |
|  |  | if (callno < 1) { |
|  |  | ast\_log(LOG\_WARNING, "Unable to create call\n"); |
|  |  | return -1; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `10da3da`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxrg%2Fasterisk-xrg%2Fcommit%2F10da3dab24e8ca08cf2c983f8d0206e383535b5a) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from downloads.asterisk.org_0ab340e6_20250125_140540.html ===


Asterisk
Project Security Advisory - AST-2008-006

| **Product** | Asterisk |
| **Summary** | 3-way handshake in IAX2 incomplete |
| **Nature of Advisory** | Remote amplification attack |
| **Susceptibility** | Remote unauthenticated sessions |
| **Severity** | Critical |
| **Exploits Known** | Yes |
| **Reported On** | April 18, 2008 |
| **Reported By** | Joel R. Voss aka. Javantea < jvoss AT altsci DOT com > |
| **Posted On** | April 22, 2008 |
| **Last Updated On** | December 12, 2008 |
| **Advisory Contact** | Tilghman Lesher < tlesher AT digium DOT com > |
| **CVE Name** | CVE-2008-1897 |

| **Description** | Javantea originally reported an issue in IAX2, whereby an attacker could send a spoofed IAX2 NEW message, and Asterisk would start sending early audio to the target address, without ever receiving an initial response. That original vulnerability was addressed in June 2007, by requiring a response to the initial NEW message before starting to send any audio.    Javantea subsequently found that we were doing insufficent verification of the ACK response and that the ACK response could be spoofed, just like the initial NEW message. We have addressed this failure with two changes. First, we have started to require that the ACK response contains the unique source call number that we send in our reply to the NEW message. Any ACK response that does not contain the source call number that we have created will be silently thrown away. Second, we have made the generation of our source call number a little more difficult to predict, by randomly selecting a source call number, instead of allocating them sequentially. |

| **Workaround** | Disable remote unauthenticated IAX2 sessions, by disallowing guest access. |

| **Resolution** | Upgrade your Asterisk installation to revision 114561 or later, or install one of the releases shown below. |

| **Commentary** | We would like to thank Javantea for notifying us of this problem; however, we note that he posted exploit code prior to that notification, which is considered irresponsible behavior in the whitehat security industry. In the future, advance notice of any such release would be appreciated. |

| **Affected Versions** | | |
| **Product** | **Release Series** |  |
| Asterisk Open Source | 1.0.x | All versions |
| Asterisk Open Source | 1.2.x | All versions prior to 1.2.28 |
| Asterisk Open Source | 1.4.x | All versions prior to 1.4.19.1 |
| Asterisk Business Edition | A.x.x | All versions |
| Asterisk Business Edition | B.x.x | All versions prior to B.2.5.2 |
| Asterisk Business Edition | C.x.x | All versions prior to C.1.8.1 |
| AsteriskNOW | 1.0.x | All versions prior to 1.0.3 |
| Asterisk Appliance Developer Kit | 0.x.x | All versions |
| s800i (Asterisk Appliance) | 1.0.x | All versions prior to 1.1.0.3 |

| **Corrected In** | |
| **Product** | **Release** |
| Asterisk Open Source | 1.2.28 |
| Asterisk Open Source | 1.4.19.1 |
| Asterisk Business Edition | B.2.5.2 |
| Asterisk Business Edition | C.1.8.1 |
| AsteriskNOW | 1.0.3 |
| s800i (Asterisk Appliance) | 1.1.0.3 |

| **Patches** | |
| **URL** | **Version** |
| http://downloads.digium.com/pub/security/AST-2008-006-1.2.patch | 1.2 |
| http://downloads.digium.com/pub/security/AST-2008-006-1.4.patch | 1.4 |

| **Links** | https://www.altsci.com/concepts/page.php?s=asteri&p=2 |

| Asterisk Project Security Advisories are posted at <http://www.asterisk.org/security>  This document may be superseded by later versions; if so, the latest version will be posted at http://downloads.digium.com/pub/security/AST-2008-006.pdf and http://downloads.digium.com/pub/security/AST-2008-006.html |

| **Revision History** | | |
| **Date** | **Editor** | **Revisions Made** |
| April 22, 2008 | Tilghman Lesher | Initial release |
| April 22, 2008 | Tilghman Lesher | Corrected 1.4 version where fix was released. |
| December 12, 2008 | Tilghman Lesher | Added patches |

Asterisk
Project Security Advisory - AST-2008-006
Copyright
Â© 2008
Digium, Inc. All Rights Reserved.
Permission is hereby granted
to distribute and publish this advisory in its original, unaltered
form.



=== Content from secunia.com_20e1a64b_20250125_140506.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...


