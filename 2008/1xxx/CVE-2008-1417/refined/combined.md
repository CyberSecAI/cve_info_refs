=== Content from bugs.debian.org_d2e5c836_20250124_214945.html ===

# Debian Bug report logs - #471227 axyl: CVE-2008-1417 insecure tmp file handline in prerm script

[![version graph](version.cgi?collapse=1;found=axyl%2F2.1.7;absolute=0;width=2;package=axyl;height=2;fixed=axyl%2F2.2.0)](version.cgi?collapse=1;found=axyl%2F2.1.7;info=1;package=axyl;absolute=0;fixed=axyl%2F2.2.0)

Package:
[axyl](pkgreport.cgi?package=axyl);
Maintainer for [axyl](pkgreport.cgi?package=axyl) is [(unknown)](pkgreport.cgi?maint=);

Reported by: [Christian Perrier <bubulle@debian.org>](pkgreport.cgi?submitter=bubulle%40debian.org)

Date: Sun, 16 Mar 2008 18:45:01 UTC

Severity: important

Tags: security

Found in version axyl/2.1.7

Fixed in version axyl/2.2.0

**Done:** Paul Waite <paul@waite.net.nz>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=471227;mbox=yes), [status mbox](bugreport.cgi?bug=471227;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=471227;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Debian Security Team <team@security.debian.org>, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=2), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Christian Perrier <bubulle@debian.org>`:

New Bug report received and forwarded. Copy sent to `Debian Security Team <team@security.debian.org>, Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=4), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=5), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=bubulle%40debian.org)
From: Christian Perrier <bubulle@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: axyl: Insecure temporary file handling in prerm and postrm
Date: Sun, 16 Mar 2008 19:42:46 +0100
```
Package: axyl
Version: 2.1.7
Severity: grave
Tags: security
Justification: user security hole

The prerm script creates /tmp/axyl.conf by copying /etc/axyl/axyl.conf over
it.

The postrm script sources that file.

That opens opportunities to someone with a local account to trigger
execution of malicious code by crafting /tmp/axyl.conf (it probably requires
to ensure that the "cp" action in prerm fails to avoid the crafter file to
be overwritten).

Even if the exploit possibilities may be small, this is still pretty
dangerous to keep.

An easy and not too much invasive fix would be to copy the file in /root
instead of /tmp.

PS: the severity may be overflated and I don't feel like I have enough
security experience to really decide whether this is release critical and
also if it deserves an update to stable and oldstable. I will fix this in a
soon-to-come NMU (meant for l10n purposes) with the above quick and dirty
fix (thanks to Nico Golde for the suggestion).

-- System Information:
Debian Release: lenny/sid
  APT prefers unstable
  APT policy: (500, 'unstable')
Architecture: i386 (i686)

Kernel: Linux 2.6.24-1-686 (SMP w/1 CPU core)
Locale: LANG=fr_FR.UTF-8, LC_CTYPE=fr_FR.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

```

---

**Severity set to `important' from `grave'**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Sun, 16 Mar 2008 18:54:03 GMT) ([full text](bugreport.cgi?bug=471227;msg=7), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=7), [link](#6)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=9), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=9), [link](#8)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=11), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=11), [link](#10)).

---

[Message #12](#12) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=12), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=12), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 471227@bugs.debian.org
Subject: Re: axyl: Insecure temporary file handling in prerm and postrm
Date: Sun, 16 Mar 2008 19:58:03 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=471227;msg=12) (text/plain, inline)]
```
```
Hi,
Christian noticed that this file actually get overwritten in
the prerm script. This still means that the prerm script is
vulnerable to a symlink attack. An attacker creating a
symlink from /someimportantfile to /tmp/axyl.conf would
overwrite the content of someimportantfile on a removal of
axyl. CVE id requested.

Cheers
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=471227;msg=12) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=14), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent** to `Paul <paul@waite.net.nz>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=16), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=17), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=paul%40waite.net.nz)
From: Paul <paul@waite.net.nz>
To: Christian Perrier <bubulle@debian.org>, 471227@bugs.debian.org
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and
postrm
Date: Mon, 17 Mar 2008 08:09:07 +1300
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi Christian,

> Package: axyl
> Version: 2.1.7
> Severity: grave
> Tags: security
> Justification: user security hole
>
> The prerm script creates /tmp/axyl.conf by copying /etc/axyl/axyl.conf over
> it.
>
> The postrm script sources that file.
>
> That opens opportunities to someone with a local account to trigger
> execution of malicious code by crafting /tmp/axyl.conf (it probably requires
> to ensure that the "cp" action in prerm fails to avoid the crafter file to
> be overwritten).
>
> Even if the exploit possibilities may be small, this is still pretty
> dangerous to keep.
>
> An easy and not too much invasive fix would be to copy the file in /root
> instead of /tmp.

Thanks for this suggestion. I'll do that.

> PS: the severity may be overflated and I don't feel like I have enough
> security experience to really decide whether this is release critical and
> also if it deserves an update to stable and oldstable. I will fix this in a
> soon-to-come NMU (meant for l10n purposes) with the above quick and dirty
> fix (thanks to Nico Golde for the suggestion).
>
>
>
>
> -- System Information:
> Debian Release: lenny/sid
>   APT prefers unstable
>   APT policy: (500, 'unstable')
> Architecture: i386 (i686)
>
> Kernel: Linux 2.6.24-1-686 (SMP w/1 CPU core)
> Locale: LANG=fr_FR.UTF-8, LC_CTYPE=fr_FR.UTF-8 (charmap=UTF-8)
> Shell: /bin/sh linked to /bin/dash
>
>

Cheers,
Paul.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org>

iD8DBQFH3XBTtfkpAgkMOyMRAki8AJ45AKKXT3ywq93kT+ZGLllRFsd7OACeJnMO
4BHlkLKCAkT1n8iNWQLnkOg=
=Y4ws
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=19), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=19), [link](#18)).

---

**Acknowledgement sent** to `Christian Perrier <bubulle@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=21), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=22), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=bubulle%40debian.org)
From: Christian Perrier <bubulle@debian.org>
To: Paul <paul@waite.net.nz>
Cc: 471227@bugs.debian.org
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm
and postrm
Date: Sun, 16 Mar 2008 20:18:14 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=471227;msg=22) (text/plain, inline)]
```
```
Quoting Paul (paul@waite.net.nz):

> > An easy and not too much invasive fix would be to copy the file in /root
> > instead of /tmp.
>
> Thanks for this suggestion. I'll do that.

Please note that I found this while preparing an l10n NMU (just like I
wanted to do for axyl-lucene, but suspended when you mentioned you
will take care of fixing l10n bugs).

So, I suggest you deal with the issue as you're the package maintainer
but, please also fix pending l10n bugs.

My prepared NMU had the following changelog:

  * Debconf translations:
    - Portuguese. Closes: #[415510](bugreport.cgi?bug=415510)
    - German. Closes: #[425763](bugreport.cgi?bug=425763)
    - French. Closes: #[441090](bugreport.cgi?bug=441090)
    - Spanish. Closes: #[467027](bugreport.cgi?bug=467027)
    - Finnish. Closes: #[470638](bugreport.cgi?bug=470638)
  * [Lintian] Move the axyl-doc package to section doc

So, as you see, the five pending debconf l10n bugs plus a small fix to
put axy-doc in the "doc" section.

```
```
[[signature.asc](bugreport.cgi?att=1;bug=471227;filename=signature.asc;msg=22) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=24), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=26), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=27), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: Christian Perrier <bubulle@debian.org>
Cc: 471227@bugs.debian.org
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and postrm
Date: Sun, 16 Mar 2008 22:39:16 +0100
```
* Christian Perrier:

> An easy and not too much invasive fix would be to copy the file in /root
> instead of /tmp.

Isn't this a policy violation?

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=29), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=29), [link](#28)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=31), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=32), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 471227@bugs.debian.org
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and postrm
Date: Sun, 16 Mar 2008 22:58:29 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=471227;msg=32) (text/plain, inline)]
```
```
Hi Florian,
* Florian Weimer <fw@deneb.enyo.de> [2008-03-16 22:45]:
> * Christian Perrier:
>
> > An easy and not too much invasive fix would be to copy the file in /root
> > instead of /tmp.
>
> Isn't this a policy violation?

I am not sure about this either. However I see no real way
besides this to fix this. If you use mktemp or something
similar you can't pass the name to postrm :/
Paul, is this code really needed anyway?

Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=471227;msg=32) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=34), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=34), [link](#33)).

---

**Acknowledgement sent** to `Paul Waite <paulwaite@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=36), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=36), [link](#35)).

---

[Message #37](#37) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=37), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=37), reply):

![](/cgi-bin/libravatar.cgi?email=paulwaite%40debian.org)
From: Paul Waite <paulwaite@debian.org>
To: Florian Weimer <fw@deneb.enyo.de>, 471227@bugs.debian.org
Cc: Christian Perrier <bubulle@debian.org>
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and
postrm
Date: Mon, 17 Mar 2008 10:59:49 +1300
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Florian Weimer wrote:
> * Christian Perrier:
>
>> An easy and not too much invasive fix would be to copy the file in /root
>> instead of /tmp.
>
> Isn't this a policy violation?

It would be good to get clarification on this point.

Just to be sure everyone understands what is happening here (and maybe suggest a better way).

The requirement is to purge Axyl fully (apt-get remove --purge). For that the postrm script needs to
know the current locations of home, data and logs which the user may have changed since
installation. These are defined in /etc/axyl/axyl.conf but this file is removed by the time postrm runs.

Hence I currently copy it to a temporary location in prerm for the short time that the purge runs,
then source it from that temporary location in postrm, use the settings to purge the home, data and
log areas for Axyl-owned content, and then finally remove the temporary conf file.

Root is doing this, and I imagined (perhaps erroneously) that using /root for this brief staging of
the conf file would have been ok.

If not then what is a better way to carry the conf settings from prerm --> postrm? Would the debconf
db do the trick, or is that purged by then too?

Any help very much appreciated.;-)

Cheers,
Paul.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org>

iD8DBQFH3ZhVtfkpAgkMOyMRAt62AKDA+v3wxDETSztN+laC7XZvvCkItgCgrVq1
GAkdkHrLf3GOCrzg/YPEM7U=
=gqMk
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=39), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=39), [link](#38)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=41), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=41), [link](#40)).

---

[Message #42](#42) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=42), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=42), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: Paul Waite <paulwaite@debian.org>
Cc: 471227@bugs.debian.org, Christian Perrier <bubulle@debian.org>
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and postrm
Date: Sun, 16 Mar 2008 23:06:29 +0100
```
* Paul Waite:

> The requirement is to purge Axyl fully (apt-get remove --purge). For
> that the postrm script needs to know the current locations of home,
> data and logs which the user may have changed since
> installation. These are defined in /etc/axyl/axyl.conf but this file
> is removed by the time postrm runs.

I guess you should only purge the default location, following the
principle of least surprise.  Certainly I wouldn't expect a package to
change the file system outside the package just because I listed some
directories in the configuration file.

I couldn't find a policy rule for this case, but I suspect there is one.

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=44), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=44), [link](#43)).

---

**Acknowledgement sent** to `Paul Waite <paulwaite@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=46), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=46), [link](#45)).

---

[Message #47](#47) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=47), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=47), reply):

![](/cgi-bin/libravatar.cgi?email=paulwaite%40debian.org)
From: Paul Waite <paulwaite@debian.org>
To: Florian Weimer <fw@deneb.enyo.de>
Cc: 471227@bugs.debian.org, Christian Perrier <bubulle@debian.org>
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and
postrm
Date: Mon, 17 Mar 2008 11:28:40 +1300
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Florian Weimer wrote:
> * Paul Waite:
>
>> The requirement is to purge Axyl fully (apt-get remove --purge). For
>> that the postrm script needs to know the current locations of home,
>> data and logs which the user may have changed since
>> installation. These are defined in /etc/axyl/axyl.conf but this file
>> is removed by the time postrm runs.
>
> I guess you should only purge the default location, following the
> principle of least surprise.  Certainly I wouldn't expect a package to
> change the file system outside the package just because I listed some
> directories in the configuration file.
>
> I couldn't find a policy rule for this case, but I suspect there is one.

Well it used to do something like that, but then whilst fixing bug #431710 in axyl-lucene, and
testing this by running piuparts, I discovered that I had piuparts errors complaining that I hadn't
removed all package content on purge. I assumed that this was new policy to keep systems clean of
cruft (I could see the reasoning), and so changed my packages accordingly.

It should be noted that, having looked just now, I can't actually find official policy on this
concept of purging absolutely *everything* in this way, so I'm not sure what the piuparts errors
were based on.

If full purge isn't official policy, then the quick fix would be to remove this functionality
entirely for now, and I'd be quite happy to do that.

Cheers,
Paul.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org>

iD8DBQFH3Z8XtfkpAgkMOyMRAsvsAKCnWFdFQ/uP3+uHpV5ImivO9ZjzBwCglWtS
MMyKc2WbPh156GCExE426jQ=
=SV8o
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=49), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=49), [link](#48)).

---

**Acknowledgement sent** to `Christian Perrier <bubulle@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=51), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=51), [link](#50)).

---

[Message #52](#52) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=52), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=52), reply):

![](/cgi-bin/libravatar.cgi?email=bubulle%40debian.org)
From: Christian Perrier <bubulle@debian.org>
To: Paul Waite <paulwaite@debian.org>, 471227@bugs.debian.org
Cc: Florian Weimer <fw@deneb.enyo.de>
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm
and postrm
Date: Mon, 17 Mar 2008 07:46:35 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=471227;msg=52) (text/plain, inline)]
```
```
Quoting Paul Waite (paulwaite@debian.org):

> If full purge isn't official policy, then the quick fix would be to remove this functionality
> entirely for now, and I'd be quite happy to do that.

I'm pretty sure that nothing in the policy *or common practice*
requires package maintainers to clean out data in cases where they
were stored in the non default locations for the package.

So, if that's the only rationale for the /tmp/axyl.conf stuff, I'd
suggest to remove this mechanism.

```
```
[[signature.asc](bugreport.cgi?att=1;bug=471227;filename=signature.asc;msg=52) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=54), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=54), [link](#53)).

---

**Acknowledgement sent** to `Thijs Kinkhorst <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=56), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=56), [link](#55)).

---

[Message #57](#57) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=57), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=57), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: Thijs Kinkhorst <thijs@debian.org>
To: Christian Perrier <bubulle@debian.org>,
471227@bugs.debian.org
Cc: Nico Golde <nion@debian.org>,
Florian Weimer <fw@deneb.enyo.de>
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and postrm
Date: Mon, 17 Mar 2008 16:07:25 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=471227;msg=57) (text/plain, inline)]
```
```
On Sunday 16 March 2008 19:42, Christian Perrier wrote:
> An easy and not too much invasive fix would be to copy the file in /root
> instead of /tmp.

I'm quite unsure that writing to /root upon purge is a good idea.

If you really need to retain those settings to purge, better do it this way:
1) In prerm, copy /etc/axyl/axyl.conf to /etc/axyl/axyl.conf.backup
2) In postrm, source that file.
3) In postrm, rm /etc/axyl/axyl.conf.backup && rmdir /etc/axyl/

But I doubt that it's useful to retain those settings at postrm as has been
indicated by others in this bug already. As you source the file, what happens
in a scenario where the admin has a syntax error in axyl.conf and then purges
it? The purge will fail with an error, also not so nice.

> It should be noted that, having looked just now, I can't actually find
> official policy on this concept of purging absolutely *everything* in this
> way, so I'm not sure what the piuparts errors were based on.

It's rather undefined in policy what exactly should be purged, unfortunately.

> If full purge isn't official policy, then the quick fix would be to remove
> this functionality entirely for now, and I'd be quite happy to do that.

I propose to just remove every dir we installed and let the admin take care of
whatever extra dirs he added. That seems in spirit of Debian policy: clean up
what we install, and don't touch things outside of it.

That would also mean that piuparts would not complain, since that does not add
dirs to axyl.conf itself, does it?

Thijs

```
```
[[Message part 2](bugreport.cgi?att=1;bug=471227;msg=57) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=59), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=59), [link](#58)).

---

**Acknowledgement sent** to `Thijs Kinkhorst <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=61), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=61), [link](#60)).

---

[Message #62](#62) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=62), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=62), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: Thijs Kinkhorst <thijs@debian.org>
To: 471227@bugs.debian.org
Cc: Christian Perrier <bubulle@debian.org>,
Nico Golde <nion@debian.org>,
Florian Weimer <fw@deneb.enyo.de>
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and postrm
Date: Mon, 17 Mar 2008 16:17:28 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=471227;msg=62) (text/plain, inline)]
```
```
Hi Paul,

> If full purge isn't official policy, then the quick fix would be to remove
> this functionality, entirely for now, and I'd be quite happy to do that.

Upon a second look at the code, I can find a few more occurences of tempfile
usage that are at least suspicious. Just try a grep for "/tmp" on the axyl
source package to see what I mean. Are these all safe?

Thijs

```
```
[[Message part 2](bugreport.cgi?att=1;bug=471227;msg=62) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=64), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=64), [link](#63)).

---

**Acknowledgement sent** to `Paul <paul@waite.net.nz>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=66), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=66), [link](#65)).

---

[Message #67](#67) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=67), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=67), reply):

![](/cgi-bin/libravatar.cgi?email=paul%40waite.net.nz)
From: Paul <paul@waite.net.nz>
To: Thijs Kinkhorst <thijs@debian.org>, 471227@bugs.debian.org
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and
postrm
Date: Tue, 18 Mar 2008 08:26:31 +1300
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Thijs Kinkhorst wrote:
> On Sunday 16 March 2008 19:42, Christian Perrier wrote:
>> An easy and not too much invasive fix would be to copy the file in /root
>> instead of /tmp.
>
> I'm quite unsure that writing to /root upon purge is a good idea.
>
> If you really need to retain those settings to purge, better do it this way:
> 1) In prerm, copy /etc/axyl/axyl.conf to /etc/axyl/axyl.conf.backup
> 2) In postrm, source that file.
> 3) In postrm, rm /etc/axyl/axyl.conf.backup && rmdir /etc/axyl/
>
> But I doubt that it's useful to retain those settings at postrm as has been
> indicated by others in this bug already. As you source the file, what happens
> in a scenario where the admin has a syntax error in axyl.conf and then purges
> it? The purge will fail with an error, also not so nice.
>
>> It should be noted that, having looked just now, I can't actually find
>> official policy on this concept of purging absolutely *everything* in this
>> way, so I'm not sure what the piuparts errors were based on.
>
> It's rather undefined in policy what exactly should be purged, unfortunately.
>
>> If full purge isn't official policy, then the quick fix would be to remove
>> this functionality entirely for now, and I'd be quite happy to do that.
>
> I propose to just remove every dir we installed and let the admin take care of
> whatever extra dirs he added. That seems in spirit of Debian policy: clean up
> what we install, and don't touch things outside of it.
>
> That would also mean that piuparts would not complain, since that does not add
> dirs to axyl.conf itself, does it?

That's correct. In the tests it uses the default locations. My purge was
designed to just get rid of Axyl home, data, logs wherever the admin had
decided to put them in the debconf config (or perhaps moved them
manually afterwards).

But I will now be implementing the proposition above, which will remove
the need to save axyl.conf across prerm --> postrm.

Thanks for all the great ideas and feedback.

Cheers,
Paul.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org>

iD8DBQFH3sXntfkpAgkMOyMRAtmbAJ9QBYal2Q5k9YB89Z25F+mB45diLgCfU+uL
3ypfEITzBrVVvwf/mf/oO+s=
=D/uX
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=69), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=69), [link](#68)).

---

**Acknowledgement sent** to `Paul Waite <paulwaite@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=71), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=71), [link](#70)).

---

[Message #72](#72) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=72), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=72), reply):

![](/cgi-bin/libravatar.cgi?email=paulwaite%40debian.org)
From: Paul Waite <paulwaite@debian.org>
To: Thijs Kinkhorst <thijs@debian.org>, 471227@bugs.debian.org
Cc: Christian Perrier <bubulle@debian.org>, Nico Golde <nion@debian.org>,
Florian Weimer <fw@deneb.enyo.de>
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and
postrm
Date: Tue, 18 Mar 2008 09:11:36 +1300
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi Thijs,

>> If full purge isn't official policy, then the quick fix would be to remove
>> this functionality, entirely for now, and I'd be quite happy to do that.
>
> Upon a second look at the code, I can find a few more occurences of tempfile
> usage that are at least suspicious. Just try a grep for "/tmp" on the axyl
> source package to see what I mean. Are these all safe?

Some of the matches appear to be in docs, some in Xinha (an included
javascript Wysiwyg editor). However there are a couple I missed in Axyl
which I will fix for this coming upload.

Cheers,
Paul.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <http://enigmail.mozdev.org>

iD8DBQFH3tB4tfkpAgkMOyMRAtjPAKCpEi+hMJn9XsvC5BilxtBdSeyovACffb7r
ZNXjbsvziuDj3Z8q4GR2+t4=
=kff1
-----END PGP SIGNATURE-----

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=74), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=74), [link](#73)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=76), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=76), [link](#75)).

---

[Message #77](#77) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=77), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=77), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: Paul Waite <paulwaite@debian.org>
Cc: Thijs Kinkhorst <thijs@debian.org>, 471227@bugs.debian.org, Christian Perrier <bubulle@debian.org>, Nico Golde <nion@debian.org>
Subject: Re: Bug#471227: axyl: Insecure temporary file handling in prerm and postrm
Date: Mon, 17 Mar 2008 21:14:00 +0100
```
* Paul Waite:

> Some of the matches appear to be in docs, some in Xinha (an included
> javascript Wysiwyg editor). However there are a couple I missed in Axyl
> which I will fix for this coming upload.

Do we need to apply these changes to stable and oldstable as well?

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Paul Waite <paul@waite.net.nz>`:

`Bug#471227`; Package `axyl`.
([full text](bugreport.cgi?bug=471227;msg=79), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=79), [link](#78)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Paul Waite <paul@waite.net.nz>`.
([full text](bugreport.cgi?bug=471227;msg=81), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=81), [link](#80)).

---

[Message #82](#82) received at 471227@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=82), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=82), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 471227@bugs.debian.org
Cc: control@bugs.debian.org
Subject: got cve id
Date: Thu, 20 Mar 2008 18:16:23 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=471227;msg=82) (text/plain, inline)]
```
```
retitle 471227 axyl: [CVE-2008-1417](https://security-tracker.debian.org/tracker/CVE-2008-1417) insecure tmp file handline in prerm script
thanks

Hi,
[CVE-2008-1417](https://security-tracker.debian.org/tracker/CVE-2008-1417) was assigned to this.

Kind regards
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=471227;msg=82) (application/pgp-signature, inline)]
```

---

**Changed Bug title to `axyl: CVE-2008-1417 insecure tmp file handline in prerm script' from `axyl: Insecure temporary file handling in prerm and postrm'.**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Thu, 20 Mar 2008 17:18:25 GMT) ([full text](bugreport.cgi?bug=471227;msg=84), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=84), [link](#83)).

---

**Reply sent** to `Paul Waite <paul@waite.net.nz>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=471227;msg=86), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=86), [link](#85)).

---

**Notification sent** to `Christian Perrier <bubulle@debian.org>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=471227;msg=88), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=88), [link](#87)).

---

[Message #89](#89) received at 471227-close@bugs.debian.org ([full text](bugreport.cgi?bug=471227;msg=89), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=89), reply):

![](/cgi-bin/libravatar.cgi?email=paul%40waite.net.nz)
From: Paul Waite <paul@waite.net.nz>
To: 471227-close@bugs.debian.org
Subject: Bug#471227: fixed in axyl 2.2.0
Date: Sun, 23 Mar 2008 01:02:04 +0000
```
Source: axyl
Source-Version: 2.2.0

We believe that the bug you reported is fixed in the latest version of
axyl, which is due to be installed in the Debian FTP archive:

axyl-doc_2.2.0_all.deb
  to pool/main/a/axyl/axyl-doc_2.2.0_all.deb
axyl_2.2.0.dsc
  to pool/main/a/axyl/axyl_2.2.0.dsc
axyl_2.2.0.tar.gz
  to pool/main/a/axyl/axyl_2.2.0.tar.gz
axyl_2.2.0_all.deb
  to pool/main/a/axyl/axyl_2.2.0_all.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 471227@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Paul Waite <paul@waite.net.nz> (supplier of updated axyl package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Sun, 23 Mar 2008 13:36:00 +1300
Source: axyl
Binary: axyl-doc axyl
Architecture: source all
Version: 2.2.0
Distribution: unstable
Urgency: low
Maintainer: Paul Waite <paul@waite.net.nz>
Changed-By: Paul Waite <paul@waite.net.nz>
Description:
 axyl       - The Axyl web development platform
 axyl-doc   - The Axyl documentation
Closes: [415510](bugreport.cgi?bug=415510) [425763](bugreport.cgi?bug=425763) [441090](bugreport.cgi?bug=441090) [467027](bugreport.cgi?bug=467027) [470638](bugreport.cgi?bug=470638) [471227](bugreport.cgi?bug=471227)
Changes:
 axyl (2.2.0) unstable; urgency=low
 .
   * Added 'axyl' command shell. Makes create/remove of websites
     that much easier. Should have been done much earlier (duh).
   * Removed /tmp usage(s) for security reasons. This also changes
     package purge behaviour from deleting all home, data and log
     content, to only deleting it if it is located in the default
     locations. (closes: #[471227](bugreport.cgi?bug=471227))
   * Moved to debra-controlled releases, using major/minor nos.
   * Changed/enhanced some of the detection and install scripts used
     in postinst, site creates and db upgrading.
   * Further Php4/Php5 compatibility work. Create clone() function only
     defined for Php4, and used this where object copies are required.
     Should be no change to functionality.
   * Removed HTMLarea. Xinha is now used instead.
   * Debconf - Spanish template. (closes: #[467027](bugreport.cgi?bug=467027))
   * Debconf - Finnish template. (closes: #[470638](bugreport.cgi?bug=470638))
   * Debconf - German template. (closes: #[425763](bugreport.cgi?bug=425763))
   * Debconf - French template. (closes: #[441090](bugreport.cgi?bug=441090))
   * Debconf - Portugese template. (closes: #[415510](bugreport.cgi?bug=415510))
   * [Lintian] Move the axyl-doc package to section doc.
Files:
 b5b46c528e3fc44a633c36286f76ba58 621 web optional axyl_2.2.0.dsc
 f0ea272edb27851f1cdae691d880adea 5985937 web optional axyl_2.2.0.tar.gz
 b71ed5222a910993f8f6b77cceed4b64 2734648 web optional axyl_2.2.0_all.deb
 1dddd410737832293b7581815eccee10 3250708 doc optional axyl-doc_2.2.0_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFH5amAtfkpAgkMOyMRApZyAJ0SBv9SBca4UpzAoolAZbPCl7WaAgCgvGKf
vmZhXBI/VNguQbEhY3ARAz0=
=z2QL
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 26 Apr 2008 07:30:03 GMT) ([full text](bugreport.cgi?bug=471227;msg=91), [mbox](bugreport.cgi?bug=471227;mbox=yes;msg=91), [link](#90)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=471227).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 21:49:45 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security-tracker.debian.org_343af542_20250126_034520.html ===

# CVE-2008-1417

| **Name** | CVE-2008-1417 |
| --- | --- |
| **Description** | The prerm script in axyl 2.1.7 allows local users to overwrite arbitrary files via a symlink attack on the axyl.conf temporary file. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2008-1417) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2008-1417); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2008-1417), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2008-1417), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2008-1417), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2008-1417), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2008-1417), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2008-1417), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2008-1417), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2008-1417)/[CVE](https://www.suse.com/security/cve/CVE-2008-1417/), GitHub [advisories](https://github.com/advisories?query=CVE-2008-1417)/[code](https://github.com/search?type=Code&q=%22CVE-2008-1417%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2008-1417%22), [web search](https://duckduckgo.com/html?q=%22CVE-2008-1417%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [471227](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=471227) |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [axyl](/tracker/source-package/axyl) | source | sarge | (not affected) |  |  |  |
| [axyl](/tracker/source-package/axyl) | source | etch | (not affected) |  |  |  |
| [axyl](/tracker/source-package/axyl) | source | (unstable) | 2.2.0 | low |  | [471227](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=471227) |

## Notes

```
[sarge] - axyl <not-affected> (Vulnerable code not present)
[etch] - axyl <not-affected> (Vulnerable code not present)

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


