```
Message-ID: <20081219191637.6f5f0bc1@redhat.com>
Date: Fri, 19 Dec 2008 19:16:37 +0100
From: Tomas Hoger <thoger@...hat.com>
To: OSS Security <oss-security@...ts.openwall.com>
Cc: coley@...re.org
Subject: CVE request - pdfjam

Hi!

Insecure temporary file handling flaw was reported for pdfjam:

<https://bugzilla.novell.com/show_bug.cgi?id=459031>

Issue affects all 3 scripts shipped in pdfjam: pdf90, pdfjoin and pdfnup

They create various temporary files in tempfileDir (/var/tmp), process
id ($$) is used for file name uniqueness.

--
Tomas Hoger / Red Hat Security Response Team
```

- **Root cause of vulnerability**: Insecure temporary file handling.
- **Weaknesses/vulnerabilities present**: The pdfjam scripts (pdf90, pdfjoin, and pdfnup) create temporary files in `/var/tmp` using the process ID ($$) for filename uniqueness. This is insufficient to prevent predictable filenames, leading to potential symlink attacks or other time-of-check to time-of-use (TOCTOU) vulnerabilities.
- **Impact of exploitation**: An attacker could potentially overwrite arbitrary files or perform other malicious actions by predicting the temporary file names and creating symlinks or other files before the script creates its files.
- **Attack vectors**: Local, through manipulation of the filesystem and predicting temporary file names.
- **Required attacker capabilities/position**: Local user with the ability to execute the pdfjam scripts, as well as create symlinks or files in /var/tmp.