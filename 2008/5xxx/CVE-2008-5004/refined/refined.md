- **Root cause of vulnerability:** Insecure cookie handling. The application uses the client's IP address to generate a cookie name via `md5($user_ip)`, and then uses the cookie value directly in a SQL query without sanitization.
- **Weaknesses/vulnerabilities present:** SQL injection.
- **Impact of exploitation:** An attacker can inject arbitrary SQL code by manipulating the cookie value. This can lead to data exfiltration, modification, or potentially complete database takeover.
- **Attack vectors:** By setting a crafted cookie with malicious SQL code, the attacker can exploit the vulnerability.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests with modified cookies. No other special capabilities are needed.