```
Message-ID: <49131C7E.8050105@op5.se>
Date: Thu, 06 Nov 2008 17:34:06 +0100
From: Andreas Ericsson <ae@....se>
To: oss-security@...ts.openwall.com
CC: Johannes Dagemark <jd@....se>, Ethan Galstad <egalstad@...ios.org>,
 "Steven M. Christey" <coley@...us.mitre.org>
Subject: CVE request: Nagios (two issues)

We need two CVE id's for the Nagios project.

******

1.
Low-privileged users can create a custom form (or use a browser
addon) to bypass authorization and submit commands to the nagios
process that causes other programs to be run with the privileges
of the Nagios process.
Fixed in Nagios 3.0.5.

******

2.
Cross-Site Request Forgery allows remote attackers to submit
commands to the nagios process, thereby causing programs to run
on the Nagios server with the privileges of the Nagios process.
Patch available at
<http://git.op5.org/git/?p=nagios.git;a=commit;h=814d8d4d1a73f7151eeed187c0667585d79fea18>

******

TIA.

--
Andreas Ericsson                   andreas.ericsson@....se
OP5 AB                             www.op5.se
Tel: +46 8-230225                  Fax: +46 8-230231
```

```
# Nagios: Execution of arbitrary code â€” GLSA **200907-15**

Multiple vulnerabilities in Nagios may lead to the execution of arbitrary
code.

### Affected packages

| Package | **net-analyzer/nagios-core** on all architectures |
| --- | --- |
| Affected versions | < **3.0.6-r2** |
| Unaffected versions | >= **3.0.6-r2** |

### Description

Multiple vulnerabilities have been reported in Nagios:

* Andreas Ericsson reported that Nagios does not perform validity checks
  to verify HTTP requests, leading to Cross-Site Request Forgery
  (CVE-2008-5028).

### Impact

A remote unauthenticated attacker may exploit these
vulnerabilities to execute arbitrary commands or elevate privileges.
```

```
# USN-698-3: Nagios vulnerabilities

23 December 2008

Nagios vulnerabilities

## Details

It was discovered that Nagios was vulnerable to a Cross-site request forgery

(CSRF) vulnerability. If an authenticated nagios user were tricked into

clicking a link on a specially crafted web page, an attacker could trigger

commands to be processed by Nagios and execute arbitrary programs. This

update alters Nagios behaviour by disabling submission of CMD\_CHANGE commands.

([CVE-2008-5028](/security/CVE-2008-5028))
```
```
HPSBMA02419 SSRT090060 rev.1 - Insight Control Suite For Linux (ICE-LX) Multiple \
Remote Vulnerabilities In Nagios

Potential security vulnerabilities have been identified with Insight Control suite \
for Linux (ICE-LX) running Nagios. The vulnerabilities could be remotely exploited \
via cross-site request forgery (CSRF).

References: CVE-2008-5028
```
- **Root cause of vulnerability**: Nagios does not properly validate HTTP requests.
- **Weaknesses/vulnerabilities present**: Cross-Site Request Forgery (CSRF).
- **Impact of exploitation**: Remote attacker can submit commands to the nagios process, thereby causing programs to run on the Nagios server with the privileges of the Nagios process. This can lead to arbitrary code execution.
- **Attack vectors**: Attacker tricks an authenticated Nagios user into clicking a specially crafted link on a webpage or using a malicious form or browser add-on.
- **Required attacker capabilities/position**: The attacker needs to be able to convince a logged-in Nagios user to click a malicious link. No direct access to the Nagios server or network is required.