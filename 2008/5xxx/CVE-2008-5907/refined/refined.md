```
Message-ID: <1893206460.1156981231526184017.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Fri, 9 Jan 2009 13:36:24 -0500 (EST)
From: Josh Bressers <bressers@...hat.com>
To: oss-security <oss-security@...ts.openwall.com>
Subject: libpng non issue

I figured I'd put this out in the open before it gets picked up and causes
confusion.

The libpng main page (<http://libpng.sourceforge.net/index.html>) currently contains
this:

UPDATE 18 December 2008: The latest released versions are libpng-1.0.42 and
libpng-1.2.34. They fix a vulnerability to a possible double-free in
png_check_keyword() while writing various chunk types.

This isn't a double free, nor would I consider it a security bug.  Our libpng
maintainer Tom Lane helped out with this analysis.

As best as I can tell, this is the bug in question:
<http://sourceforge.net/mailarchive/forum.php?thread_name=4B6F0239C13D0245820603C036D180BC79FBAA%40CABOTUKEXCH01.cabot.local&forum_name=png-mng-implement>

which results in writing a NULL byte to an arbitrary location in memory.

Here is what Tom Lane said about this:

    Some poking around shows that png_check_keyword is called in subroutines
    that *write* PNG chunks, not ones that read them. So the problem could
    only manifest in programs that were creating new PNG files and trying
    to put illegal-per-spec content in them. Also, in typical usage the
    keywords being checked would be constant strings in the app, thus even
    less likely to trigger the overlength error. (It seems likely that this
    code has actually never been executed anywhere, explaining why the bug
    went undetected.)

So unless someone sees a flaw in this analysis, Red Hat has no plans to consider this a security flaw.

Thanks.

--
    JB
```
- **Root cause of vulnerability**: The `png_check_keyword` function in libpng, when writing PNG chunks, could write a NULL byte to an arbitrary memory location due to a lack of length checks on the keyword.
- **Weaknesses/vulnerabilities present**: Arbitrary memory write of a NULL byte.
- **Impact of exploitation**: Although the vulnerability exists, it is unlikely to be exploited in typical usage scenarios and is not considered a security flaw. It requires an application that is creating new PNG files with overlength keywords.
- **Attack vectors**: The vulnerability is triggered when writing PNG files, specifically when including overlength keywords.
- **Required attacker capabilities/position**: The attacker needs the ability to control the content of the keywords used when creating PNG files.

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
_______________________________________________________________________
SUSE Security Summary Report
Announcement ID: SUSE-SR:2009:003
Date: Mon, 02 Feb 2009 16:30:00 +0000
Cross-References: CVE-2008-1149, CVE-2008-1567, CVE-2008-1924
CVE-2008-2383, CVE-2008-2960, CVE-2008-3197
CVE-2008-4096, CVE-2008-4309, CVE-2008-4326
CVE-2008-5081, CVE-2008-5432, CVE-2008-5621
CVE-2008-5622, CVE-2008-5824, CVE-2008-5902
CVE-2008-5903, CVE-2008-5904, CVE-2008-5907
CVE-2009-0125, CVE-2009-0126, CVE-2009-0135
CVE-2009-0136
Content of this advisory:
1) Solved Security Vulnerabilities:
...
- libpng
This update of libpng fixes the function png\_check\_keyword() that
allowed setting arbitrary bytes in the process memory to 0.
(CVE-2008-5907)
Affected products: openSUSE 10.3-11.1, OES, SLES9, NLD9, SLES 10,
SLED10
...
-----END PGP SIGNATURE-----
```
- **Root cause of vulnerability:** The `png_check_keyword()` function in libpng allows setting arbitrary bytes in the process memory to 0.
- **Weaknesses/vulnerabilities present**: Arbitrary memory write of a NULL byte.
- **Impact of exploitation:**  Setting arbitrary bytes in process memory to 0.
- **Attack vectors**: Unspecified.
- **Required attacker capabilities/position**: Unspecified.

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1750-1                  security@debian.org
<http://www.debian.org/security/>                           Florian Weimer
March 22, 2009                        <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : libpng
Vulnerability  : several
Problem type   : local (remote)
Debian-specific: no
CVE Id(s)      : CVE-2007-2445 CVE-2007-5269 CVE-2008-1382 CVE-2008-5907 CVE-2008-6218 CVE-2009-0040
Debian Bug     : 446308 476669 516256 512665

Several vulnerabilities have been discovered in libpng, a library for
reading and writing PNG files. The Common Vulnerabilities and
Exposures project identifies the following problems:
...
The png_check_keyword might allow context-dependent attackers to set the
value of an arbitrary memory location to zero via vectors involving
creation of crafted PNG files with keywords. (CVE-2008-5907)
...
For the stable distribution (lenny), these problems have been fixed in
version 1.2.27-2+lenny2.  (Only CVE-2008-5907, CVE-2008-5907 and
CVE-2009-0040 affect the stable distribution.)
...
-----BEGIN PGP SIGNATURE-----
```
- **Root cause of vulnerability:** The `png_check_keyword` function allows setting the value of an arbitrary memory location to zero.
- **Weaknesses/vulnerabilities present**: Arbitrary memory write of a NULL byte.
- **Impact of exploitation:** Setting an arbitrary memory location to zero.
- **Attack vectors**: Creation of crafted PNG files with keywords.
- **Required attacker capabilities/position**: Context-dependent.
```
# libpng: Multiple vulnerabilities â€” GLSA **200903-28**

Multiple vulnerabilities were found in libpng, which might result in the
execution of arbitrary code

### Affected packages

| Package | **media-libs/libpng** on all architectures |
| --- | --- |
| Affected versions | < **1.2.35** |
| Unaffected versions | >= **1.2.35** |

...
* A memory
  overwrite bug was reported by Jon Foster in png\_check\_keyword(), caused
  by writing overlong keywords to a PNG file (CVE-2008-5907).
...
### Impact
... An attacker may also exploit the
png\_check\_keyword() error to set arbitrary memory locations to 0, if
the application allows overlong, user-controlled keywords when writing
PNG files.
...
### Resolution
```
- **Root cause of vulnerability**: The `png_check_keyword()` function allows setting arbitrary memory locations to 0 due to writing overlong keywords to a PNG file.
- **Weaknesses/vulnerabilities present**: Arbitrary memory write of a NULL byte.
- **Impact of exploitation**: Setting arbitrary memory locations to 0.
- **Attack vectors**: Overlong user-controlled keywords when writing PNG files.
- **Required attacker capabilities/position**: The attacker needs to be able to control overlong keywords used when the application is writing PNG files.

```
## External Links
...
# Secunia Research
...
Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence.
...
```
This content is an overview of Secunia Research and does not contain any specific vulnerability information related to CVE-2008-5907.

```
## External Links
...
# Secunia Research
...
Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence.
...
```
This content is an overview of Secunia Research and does not contain any specific vulnerability information related to CVE-2008-5907.

```
* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
...
# [Mandriva](/mandriva/)
...
```
This is a general website for Mandriva and does not contain any vulnerability information related to CVE-2008-5907.

Based on the provided content, here's a summary of CVE-2008-5907:

- **Root cause of vulnerability**: The `png_check_keyword` function in libpng lacks proper bounds checking, allowing an attacker to write a NULL byte to an arbitrary memory location by providing an overlong keyword.
- **Weaknesses/vulnerabilities present**: Arbitrary memory write of a NULL byte.
- **Impact of exploitation**: The impact is generally considered low, as it only allows setting a memory location to 0, which may not be easily exploitable, although it could lead to unexpected behavior, depending on the targeted location.
- **Attack vectors**: The vulnerability is triggered by creating specially crafted PNG files that contain overly long keywords.
- **Required attacker capabilities/position**: The attacker needs to control the input used when creating a new PNG file, specifically the keywords included in the image metadata.