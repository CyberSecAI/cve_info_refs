```
Message-Id: <200901281248.29576.rbu@gentoo.org>
Date: Wed, 28 Jan 2009 12:48:17 +0100
From: Robert Buchholz <rbu@...too.org>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request -- Python < 2.6 PySys_SetArgv issues (epiphany, csound, dia, eog, gedit, xchat, vim, nautilus-python, Gnumeric)
```

- **Root cause of vulnerability**: The `PySys_SetArgv` function in Python versions prior to 2.6 prepends an empty string to `sys.path` if the `argv[0]` argument does not contain a path separator. This leads to the current working directory being added to the python module search path.
- **Weaknesses/vulnerabilities present**: An untrusted search path vulnerability is present due to the way Python sets up the module search path when `argv[0]` doesn't contain a path separator.
- **Impact of exploitation**: A local attacker with write access to the current working directory can place a malicious Python file in the CWD and, when a vulnerable application is run from that directory, have it loaded instead of the intended module.
- **Attack vectors**: The attack vector is local and involves tricking a user to execute an application that uses an embedded Python interpreter from an untrusted working directory.
- **Required attacker capabilities/position**: The attacker needs to have write access to a directory from which a vulnerable application is launched and needs to be able to create files in that directory.

```
Message-Id: <1233320185.3423.49.camel@dhcp-lab-164.englab.brq.redhat.com>
Date: Fri, 30 Jan 2009 13:56:25 +0100
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>,
        Robert Buchholz <rbu@...too.org>
Cc: oss-security <oss-security@...ts.openwall.com>
Subject: Re: CVE request -- Python < 2.6 PySys_SetArgv
	issues (epiphany, csound, dia, eog, gedit, xchat, vim, nautilus-python,
	Gnumeric)
```
- This message clarifies that the issue is present in Python 2.6 as well despite the introduction of absolute imports. It confirms that the vulnerability involves prepending an empty string to `sys.path`.

```
Red Hat Bugzilla – Bug 482814
(CVE-2008-5983)
```
-  The bug report confirms the CVE ID for this issue and provides a description that matches with the one in the above mail.
-  It also clarifies that the vulnerability resides in the `PySys_SetArgv` API function.
- It notes that the affected Python versions are before 2.6, and this function prepends an empty string to sys.path when `argv[0]` does not have a path separator. This can lead to arbitrary code execution by local users due to a trojan python file in the CWD.
- The bug report links to relevant references and other bug reports.
- The bug report contains comments discussing a proposed fix of moving the argv arguments to the end of sys.path, and another involving sanitizing sys.path via the Debian patch.

```
Your submission was sent successfully!
USN-1596-1: Python 2.6 vulnerabilities
4 October 2012
```
- This Ubuntu Security Notice confirms the issue as a vulnerability in Python that prepends an empty string to `sys.path` under certain circumstances.
- The notice specifies that a local attacker with write access to the CWD can exploit it to execute arbitrary code.

```
launchpad.net_fb9c438f_20250126_073523.html
```
- This Launchpad changelog entry for the Python2.6 package mentions the security update for CVE-2008-5983.
- It specifies the fix is to "optionally disallow setting sys.path when setting sys.argv" by adding a new C API function, PySys_SetArgvEx.

```
USN-1613-2: Python 2.4 vulnerabilities
17 October 2012
```
- This Ubuntu Security Notice confirms the issue as a vulnerability in Python 2.4 that prepends an empty string to `sys.path` under certain circumstances, which a local attacker can use to execute arbitrary code.

```
security.gentoo.org_a3c09a44_20250125_084045.html
```
- This Gentoo Security Advisory details the untrusted search path vulnerability in gedit and that it is related to CVE-2008-5983.
- The advisory notes that local attackers can execute arbitrary code by getting a user to open gedit in a specially crafted directory, with the same privileges of the user running the app.

```
USN-1613-1: Python 2.5 vulnerabilities
17 October 2012
```
- This Ubuntu Security Notice confirms the issue as a vulnerability in Python 2.5 that prepends an empty string to `sys.path` under certain circumstances.
- The notice specifies that a local attacker with write access to the CWD can exploit it to execute arbitrary code.

```
launchpad.net_94d2324e_20250126_073526.html
```
- This Launchpad entry for Python 3.1 details a security update for CVE-2008-5983.
- It mentions the addition of `PySys_SetArgvEx`, which allows for optionally disallowing modifications to the sys.path when setting the arguments for python.

```
www.mail-archive.com_43c660b7_20250125_084049.html
```
- This message thread on a debian mailing list further confirms the details of the vulnerability. Specifically, if the argv[0] argument has no path separator, Python prepends an empty string to sys.path. This allows a trojan module to be imported from the current working directory.
- The thread also shows that the fix is to filter out the empty strings from sys.path.

```
security.gentoo.org_e513ad68_20250125_084045.html
```
- This Gentoo security advisory describes the untrusted search path vulnerability in Eye of GNOME that is related to CVE-2008-5983.
- The advisory notes that local users can execute arbitrary code if eog is launched from a directory that contains a specially crafted python module.

```
secunia.com_85c820c9_20250125_084043.html
secunia.com_bc52a1ed_20250125_084042.html
secunia.com_69250709_20250125_084044.html
secunia.com_3c5d0de4_20250125_084044.html
secunia.com_2817c1ac_20250125_084042.html
```
- These pages are unrelated marketing pages from secunia.

```
Message-Id: <1232979990.3231.38.camel@dhcp-lab-164.englab.brq.redhat.com>
Date: Mon, 26 Jan 2009 15:26:30 +0100
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>
Cc: oss-security@...ts.openwall.com
Subject: CVE request -- Python < 2.6 PySys_SetArgv issues (epiphany,
	csound, dia, eog, gedit, xchat, vim, nautilus-python, Gnumeric)
```
- This message requests CVE IDs for multiple applications that are vulnerable due to the `PySys_SetArgv` issue. It also mentions that the vulnerability can't be fixed on the python side as it might break other packages.

**Summary**
The vulnerability stems from Python's behavior in how it sets up module search paths when calling PySys_SetArgv where argv[0] lacks a path separator, which leads to an empty string prepended to sys.path. This can lead to arbitrary code execution when untrusted Python modules are present in the CWD. This issue affects multiple Python versions up to at least 2.6 and numerous applications that embed Python interpreters. The vulnerability can be exploited by local users with write access to the directory from which the vulnerable application is executed. The fix involves either sanitizing the python path, moving the args provided to the python script to the last argument of sys.path, or, as a python fix, introducing a new api function PySys_SetArgvEx that prevents the addition of the current working directory to the search path.