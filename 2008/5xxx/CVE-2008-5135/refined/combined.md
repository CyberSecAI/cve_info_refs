=== Content from lists.debian.org_6208b1ae_20250125_024902.html ===


---

[[Date Prev](msg00295.html)][[Date Next](msg00297.html)]
[[Thread Prev](msg00285.html)][[Thread Next](msg00306.html)]
[[Date Index](maillist.html#00296)]
[[Thread Index](threads.html#00296)]

# Re: Possible mass bug filing: The possibility of attack with the help of symlinks in some Debian packages

---

* *To*: "Dmitry E. Oboukhov" <unera@debian.org>
* *Cc*: debian-devel@lists.debian.org
* *Subject*: Re: Possible mass bug filing: The possibility of attack with the help of symlinks in some Debian packages
* *From*: Joey Hess <joeyh@debian.org>
* *Date*: Mon, 11 Aug 2008 13:45:25 -0400
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20080811174525.GA2675%40kodama.kitenet.net)Â [20080811174525.GA2675@kodama.kitenet.net](msg00296.html)>
* *Mail-followup-to*: "Dmitry E. Oboukhov" <unera@debian.org>, debian-devel@lists.debian.org
* *In-reply-to*: <[[ðŸ”Ž]](/msgid-search/20080811131048.GR1912%40work.uvw.ru)Â [20080811131048.GR1912@work.uvw.ru](msg00285.html)>
* *References*: <[[ðŸ”Ž]](/msgid-search/E1KSRLo-0005hY-Fe%40apache.rbscorp.ru)Â [E1KSRLo-0005hY-Fe@apache.rbscorp.ru](msg00271.html)> <[[ðŸ”Ž]](/msgid-search/20080811122421.GM1912%40work.uvw.ru)Â [20080811122421.GM1912@work.uvw.ru](msg00282.html)> <[[ðŸ”Ž]](/msgid-search/20080811131048.GR1912%40work.uvw.ru)Â [20080811131048.GR1912@work.uvw.ru](msg00285.html)>

---

```
Dmitry E. Oboukhov wrote:
>  os-prober_1.17                  os-prober                       /tmp/mounted-map (pipe)
>                                                                  /tmp/raided-map  (pipe)

os-prober writer to $OS_PROBER_TMP/{mounted-map.raided-map,etc}, which is created by:

  if [ -z "$OS_PROBER_TMP" ]; then
    if type mktemp >/dev/null 2>&1; then
      export OS_PROBER_TMP="$(mktemp -d /tmp/os-prober.XXXXXX)"
      trap "rm -rf $OS_PROBER_TMP" EXIT HUP INT QUIT TERM
    else
      export OS_PROBER_TMP=/tmp
    fi
  fi

This use of mktemp -d should be secure.

mktemp is a required package, so the insecure code path should only ever run inside
a d-i environment, which has no non-root users.

--
see shy jo

```

**Attachment:
[signature.asc](pgpomo8m4W04c.pgp)**

*Description:* Digital signature

---



=== Content from lists.debian.org_f05383de_20250125_024902.html ===


---

[[Date Prev](msg00284.html)][[Date Next](msg00286.html)]
[[Thread Prev](msg00282.html)][[Thread Next](msg00296.html)]
[[Date Index](maillist.html#00285)]
[[Thread Index](threads.html#00285)]

# Re: Possible mass bug filing: The possibility of attack with the help of symlinks in some Debian packages

---

* *To*: debian-devel@lists.debian.org
* *Subject*: Re: Possible mass bug filing: The possibility of attack with the help of symlinks in some Debian packages
* *From*: "Dmitry E. Oboukhov" <unera@debian.org>
* *Date*: Mon, 11 Aug 2008 17:10:48 +0400
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20080811131048.GR1912%40work.uvw.ru)Â [20080811131048.GR1912@work.uvw.ru](msg00285.html)>
* *In-reply-to*: <[[ðŸ”Ž]](/msgid-search/20080811122421.GM1912%40work.uvw.ru)Â [20080811122421.GM1912@work.uvw.ru](msg00282.html)>
* *References*: <[[ðŸ”Ž]](/msgid-search/E1KSRLo-0005hY-Fe%40apache.rbscorp.ru)Â [E1KSRLo-0005hY-Fe@apache.rbscorp.ru](msg00271.html)> <[[ðŸ”Ž]](/msgid-search/20080811122421.GM1912%40work.uvw.ru)Â [20080811122421.GM1912@work.uvw.ru](msg00282.html)>

---

```
DEO> Package: mplayer nws ppp twiki
DEO> Severity: grave
DEO> Tags: security

DEO> This message about the error concerns a few packages  at  once.   I've
DEO> tested all the packages on my Debian mirror.  (post|pre)(inst|rm)  and
DEO> config scripts were tested.

DEO> In some packages I've discovered scripts with errors which may be used
DEO> by a user for damaging important system files.

DEO> For example if a script uses in its work a temp file which is  created
DEO> in /tmp directory, then every user can create symlink  with  the  same
DEO> name in this directory in order to  destroy  or  rewrite  some	system
DEO> file.

DEO> I set Severity into grave for  this  bug.   The  table	of  discovered
DEO> problems is below.

DEO> +------------------+-----------------+----------------------------------
DEO> |    package       |  script         | file for attack
DEO> +------------------+-----------------+----------------------------------
DEO> | mplayer-1.0~rc2  |  config         | /tmp/HACK (pipe)
DEO> |                  |                 |
DEO> | nws-2.13         |  postinst       | /tmp/nws.debug (cp)
DEO> |                  |                 |
mplayer & nws - mistake, sorry

DEO> | ppp-2.4.4rel     |  postinst       | /tmp/probe-finished (rm -f, pipe)
DEO> |                  |  postinst       | /tmp/ppp-errors (rm -f, pipe)
DEO> |   ppp-udeb       |  /etc/ppp/ip-up | /tmp/resolv.conf.tmp (cp)
DEO> |                  |                 |
DEO> | twiki-4.1.2      |  postinst       | /tmp/twiki  (chmod 1777, chown)
DEO> +------------------+-----------------+----------------------------------

I could make few mistakes, sorry if :)

 additional table:

 package                 script in usr/bin   file for attack
 or etc
 or /usr/sbin

 arb_0.0.20071207.1-4            arb-kill                        /tmp/arb_pids_${USER}_*
                                                                 /tmp/arb_pids_*_* (rm -f)

 newsgate_1.6-23                 mkmailpost                      /tmp/mmp$$ (pipe, rm -f)

 libalps-bin_1.2.2-1             changestylesheet                /tmp/tmp$$ (pipe)
                                 convert2html                    /tmp/input$$ (pipe)
                                 convert2text                    /tmp/input$$ (pipe)
                                 extractgp                       /tmp/archive2plot$$.xsl (pipe)
                                                                 /tmp/archive$$ (pipe)
                                                                 /tmp/plot$$ (pipe)
                                 extracthtml                     /tmp/archive2plot$$.xsl (pipe)
                                                                 /tmp/plot$$ (pipe)
                                                                 /tmp/archive$$ (pipe)
                                 extracttext                     /tmp/archive$$ (pipe)
                                                                 /tmp/archive2plot$$.xsl (pipe)
                                                                 /tmp/plot$$ (pipe)
                                 transformall                    /tmp/archive$$ (pipe)
                                                                 /tmp/plot$$ (pipe)

 netdisco-mibs-installer_1.0     netdisco-mibs-install           /tmp/netdisco-mibs-0.6.tar.gz (unpack)
                                 netdisco-mibs-download          /tmp/netdisco-mibs-0.6.tar.gz (write)

 cman_2.20080801-1               fence_apc_snmp                  /tmp/apclog (append)

 nvidia-cg-toolkit_2.0.0015      nvidia-cg-toolkit-installer     /tmp/nvidia-cg-toolkit-manifest (w)

 osdsh_0.7.0-9                   osdshconfig                     /tmp/osdsh.$uid (fifo)

 os-prober_1.17                  os-prober                       /tmp/mounted-map (pipe)
                                                                 /tmp/raided-map  (pipe)
 netmrg_0.20-1                   rrdedit                         /tmp/$1.xml      (pipe)

 xcal_4.1-18                     pscal                           /tmp/pscal$$    (pipe, rm -f)

 tkusr_0.82                      tkusr                           /tmp/tkusr.pgm  (w)

 tkman_2.2-3                     tkman                           /tmp/ll (pipe)
                                                                 /tmp/tkman$$

 mysql-client-5.1                mysqlbug                        /tmp/failed-mysql-bugreport (mv)

 libpam-mount_0.43-1             passwdehd                       /tmp/passwdehd.$$ (pipe, mv)

 libmyspell-dev_3.1-18           i2myspell                       /tmp/i2my$$.1 (pipe)

 jailer_0.4-9                    updatejail                      /tmp/$$.updatejail (pipe, append)

 ltp_20060918-2.1                ltpmenu                         /tmp/runltp.mainmenu.$$ (pipe)

 mafft_6.240-1                   mafft-homologs                  /tmp/_vf$$ (pipe)

 mailscanner_4.55.10-3           trend-autoupdate.new            /tmp/opr.ini.$$ (write)
                                                                 /tmp/lpt$NEWVER.zip (write, move to /etc/iscan)

 gpsdrive_2.09-2.1               geo-code                        /tmp/geo$$ (tempfile)
 (gpsdrive-scripts)                                              /tmp/geo.yahoo (pipe)
                                                                 /tmp/geo.coords (cp)
                                 geo-nearest                     /tmp/geocaching.loc (cp)
                                                                 /tmp/geo$$.* | /tmp/geo.* (pipe, write..)

 flamethrower_0.1.8-1            flamethrower                    /tmp/multicast.tar.$$ (write, rm)

 dist_3.70-31                    patcil                          /tmp/cil$$ (pipe)
                                 paddiff                         /tmp/pdo$$ (cp)
                                                                 /tmp/pdn$$ (cp)

 crip_3.7-3                      editcomment                     /tmp/$1.tag.tmp (pipe, mv)

 freebsd-sendpr_3.113+5.3        sendbug                         /tmp/pr.$$ (mv)

 apertium_3.0.7+1-1              apertium                        /tmp/$$odtsalida.zip (write)

 aview_1.3.0rc1-8                asciiview                       /tmp/aview$$.pgm (mkfifo, pipe)

 fwbuilder_2.1.19-3              fwb_install                     /tmp/ssh-agent.$$ (pipe)

 mgetty-fax_1.1.36-1.2           faxspool                        /tmp/faxsp.$$ (pipe)

 mindi_2.20-2                    mindi                           /tmp/spongebob.squarepants.txt (pipe)
                                                                 /tmp/parted2fdisk.log (touch)
                                                                 /tmp/mke2fs.$$ (pipe)
                                                                 /tmp/$$.mk (pipe)
                                                                 /tmp/*.img, /tmp/*.mpt..

 multi-gnome-terminal_1.6.2      mgt-helper                      /tmp/$WHOAMI.debug (pipe)
                                                                 /tmp/$WHOAMI.env (pipe)
--
... mpd is off

. ''`. Dmitry E. Oboukhov
: :â€™  : unera@debian.org
`. `~â€™ GPGKey: 1024D / F8E26537 2006-11-21
  `- 1B23 D4F8 8EC0 D902 0555  E438 AB8C 00CF F8E2 6537

```

**Attachment:
[signature.asc](pgpmfs0QczbRR.pgp)**

*Description:* Digital signature

---


