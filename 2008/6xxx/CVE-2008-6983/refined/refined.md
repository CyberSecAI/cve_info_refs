- **Root cause of vulnerability**: The vulnerability stems from a combination of a file inclusion weakness and a lack of proper input sanitization within the `hitcounter.php` module of Devalcms 1.4a. Specifically, the `gv_folder_data` parameter is vulnerable to a null byte injection, which allows attackers to manipulate the included file path and inject malicious PHP code.
- **Weaknesses/vulnerabilities present**:
    - **Remote Code Execution (RCE)**: By injecting malicious PHP code into the `url2header.php` file, an attacker can achieve remote code execution on the server.
    - **Cross-Site Scripting (XSS)**: The `currentpath` parameter in `index.php` is vulnerable to XSS, allowing attackers to inject malicious scripts into the webpage.
    - **File Inclusion**: The `gv_folder_data` parameter in `hitcounter.php` is susceptible to a file inclusion vulnerability due to lack of input validation.
    - **Null Byte Injection**: The exploit utilizes a null byte (%00) to truncate the file path and include an arbitrary file (`url2header.php`).
- **Impact of exploitation**:
    - **RCE**: Successful exploitation allows the attacker to execute arbitrary code on the server, potentially leading to complete system compromise.
    - **XSS**: The injected XSS code can be used to steal user cookies, redirect users to malicious sites, or deface the website.
- **Attack vectors**:
    - **RCE**: The attack vector for RCE involves sending a specially crafted HTTP GET request to `hitcounter.php` with a manipulated `gv_folder_data` parameter and a malicious PHP code in the Referer header.
    - **XSS**: The XSS attack is performed by crafting a URL that contains malicious Javascript in the `currentpath` parameter in `index.php`.
- **Required attacker capabilities/position**:
    - **RCE**: The attacker needs to be able to send HTTP requests to the vulnerable server and have knowledge of the vulnerable path.
    - **XSS**: The attacker needs to be able to craft a URL with malicious JavaScript and have the victim click on it.