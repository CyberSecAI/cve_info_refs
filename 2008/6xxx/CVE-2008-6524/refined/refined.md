Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:** The vulnerability stems from insecure cookie handling and flawed admin panel validation within OpenInvoice 0.9 beta (and prior versions). By manipulating cookies, an attacker can bypass authentication and access the password reset functionality for any user except the first admin.

**Weaknesses/Vulnerabilities Present:**
*   **Insecure Cookies:** The application's reliance on easily manipulable cookies for authentication.
*   **Insufficient Validation:** Lack of proper validation in the admin panel and related functionalities allowing for unauthorized access and modification of user passwords.

**Impact of Exploitation:**
*   **Arbitrary Password Change:** An attacker can change the password of any user, except the first administrator account, potentially leading to account takeover and unauthorized access to sensitive data within the application.

**Attack Vectors:**
*   **HTTP Request Manipulation:** The attacker crafts a specific HTTP POST request to the `resetpass.php` script after setting a cookie that spoofs an authenticated session.
*   **Cookie Spoofing:** The attacker manipulates the "oiauth" cookie value to bypass authentication checks.

**Required Attacker Capabilities/Position:**
*   The attacker needs to know the URL of the vulnerable OpenInvoice installation.
*   The attacker needs to know the User ID (UID) of the target user whose password they want to change.
*   The attacker does not need to be authenticated to exploit this vulnerability.

**Additional Notes:**

*   The exploit script provided is written in Perl.
*   The exploit specifically targets `resetpass.php` to change passwords.
*   The exploit sets a specific cookie named "oiauth" with a value of "1".
*   The exploit does not work against the first admin user with a UID of 1, likely due to a specific check implemented in the application, though it's not specified in the exploit details.
*   The vendor was not notified at the time of the exploit's discovery.
*   The vulnerability affects OpenInvoice 0.9 beta and prior versions.