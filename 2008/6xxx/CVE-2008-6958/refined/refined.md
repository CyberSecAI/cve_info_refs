```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from a flaw in the way Discuz! handles the `creditsformula` parameter during style switching in the WAP interface. Specifically, the application fails to properly sanitize or validate user-supplied input within this parameter.",
    "weaknesses": [
      "Improper input validation",
       "Remote Code Execution via crafted input in the creditsformula parameter",
      "Unrestricted file write access in the cache directory"
    ],
    "impact": "Successful exploitation of this vulnerability allows a remote attacker to execute arbitrary PHP code on the server, leading to complete system compromise.",
    "attack_vectors": [
      "HTTP POST request to `/wap/index.php` with a crafted payload in the `creditsformula` parameter.",
       "WAP interface of Discuz! is used for the attack."
    ],
    "required_capabilities": [
      "Attacker must be able to send HTTP POST requests to the target server.",
      "Target server must have WAP registration enabled."
    ],
        "additional_details": "The exploit leverages the ability to register a new user through the wap interface. It then abuses the `stylejump` feature, injecting code in the `creditsformula` parameter via a crafted POST request. This payload creates a new PHP file in the cache directory with arbitrary PHP code, which can later be accessed to execute code by the attacker. The exploit code provided creates a simple webshell, suggesting the attacker can use it to execute commands."
  }
}
```