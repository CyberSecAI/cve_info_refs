=== Content from bugzilla.mozilla.org_d67ed644_20250125_131408.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/458883)
* [XML](/show_bug.cgi?ctype=xml&id=458883)

Closed
[Bug 458883](/show_bug.cgi?id=458883)

Opened 16 years ago
Closed 16 years ago

# Make Document.documentURI and .textContent noAccess in mailnews

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Make Document.documentURI and .textContent noAccess in mailnews

## Categories

### (MailNews Core :: Security, defect)

[Product:](/describecomponents.cgi?product=MailNews%20Core)

MailNews Core
▾

MailNews Core
Mail and news components common to Thunderbird and SeaMonkey
[See Open Bugs in This Product](/buglist.cgi?product=MailNews%20Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=MailNews%20Core)
Watch This Product

[Component:](/describecomponents.cgi?product=MailNews%20Core&component=Security#Security)

Security
▾

MailNews Core :: Security
This component covers all bugs that relate to use of cryptography, S/MIME, and SSL issues for MailNews. Or, use this
component if you have a MailNews security bug.
[See Open Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=MailNews%20Core&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

major

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| relnote-thunderbird |  | --- |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: bzbarsky, Assigned: philor)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2b6c1ba0915a97a81d59ca1e101e6d74?d=mm&size=40)  [philor](/user_profile?user_id=135518)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [bzbarsky](/user_profile?user_id=20209)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[453928](/show_bug.cgi?id=453928 "RESOLVED FIXED - Reevaluate MailNews use of CAPS")

Dependency [tree](/showdependencytree.cgi?id=458883&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=458883)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: verified1.8.1.18, verified1.9.0.4, Whiteboard: [sg:high])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[verified1.8.1.18](/buglist.cgi?keywords=verified1.8.1.18&resolution=---),
[verified1.9.0.4](/buglist.cgi?keywords=verified1.9.0.4&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:high]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [blocking1.9.0.4](#a183763_1689 "16 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.9.0.4 | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [blocking1.8.1.18](#a183763_1689 "16 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.8.1.18 | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [wanted1.8.1.x](#a183763_1689 "16 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | wanted1.8.1.x | + |
| --- | --- | --- |
| [asac](/user_profile?user_id=113760) | [blocking1.8.0.next](#a7805556_113760 "16 years ago") | + |
| --- | --- | --- |
| [asac](/user_profile?user_id=113760) | blocking1.8.0.next | + |
| --- | --- | --- |
|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [test mbox](/attachment.cgi?id=342202)  [16 years ago](#c6)  [Phil Ringnalda (:philor)](/user_profile?user_id=135518)   1.37 KB, text/plain |  | [Details](/attachment.cgi?id=342202&action=edit) |
| --- | --- | --- |
| [Whack-some-moles, v.1](/attachment.cgi?id=342203)  [16 years ago](#c7)  [Phil Ringnalda (:philor)](/user_profile?user_id=135518)   2.79 KB, patch | bzbarsky : [review+](#a85804_20209 "16 years ago")  bzbarsky : [superreview+](#a85804_20209 "16 years ago")  dveditz : [approval1.8.1.18-](#c10 "16 years ago")  dveditz : [approval1.9.0.4-](#c10 "16 years ago") | [Details](/attachment.cgi?id=342203&action=edit) | [Diff](/attachment.cgi?id=342203&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342203) |
| [For checkin, 1.8 branch](/attachment.cgi?id=342539)  [16 years ago](#c11)  [Phil Ringnalda (:philor)](/user_profile?user_id=135518)   2.79 KB, patch | dveditz : [approval1.8.1.18+](#c14 "16 years ago")  asac : [approval1.8.0.next+](#c0 "16 years ago") | [Details](/attachment.cgi?id=342539&action=edit) | [Diff](/attachment.cgi?id=342539&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342539) |
| [For checkin, 1.9.0 branch](/attachment.cgi?id=342540)  [16 years ago](#c12)  [Phil Ringnalda (:philor)](/user_profile?user_id=135518)   2.77 KB, patch | dveditz : [approval1.9.0.4+](#c15 "16 years ago") | [Details](/attachment.cgi?id=342540&action=edit) | [Diff](/attachment.cgi?id=342540&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342540) |
| [For checkin, mozilla-central trunk](/attachment.cgi?id=342542)  [16 years ago](#c13)  [Phil Ringnalda (:philor)](/user_profile?user_id=135518)   2.58 KB, patch |  | [Details](/attachment.cgi?id=342542&action=edit) | [Diff](/attachment.cgi?id=342542&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342542) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=458883#c0)• 16 years ago |
|  | |

See [bug 453928 comment 5](/show_bug.cgi?id=453928#c5 "RESOLVED FIXED - Reevaluate MailNews use of CAPS").
We need to fix this on the 1.8 branch and 1.9.0 branch no matter what we're doing on trunk.Flags: blocking1.9.0.4?Flags: blocking1.8.1.18?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=458883#a76_20209)• 16 years ago |

Group: core-security

|  | [Samuel Sidler (old account; do not CC)](/user_profile?user_id=190622) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=458883#c1)• 16 years ago |
|  | |

Boris, there are no shipping mailnews products from 1.9.0. Are you sure we need to fix it there?
CCing dmose to look at this (or assign it).

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=458883#c2)• 16 years ago |
|  | |

No idea. I just flagged this as blocking? for all stable branches where this would be a problem. If you don't ever plan to ship Thunderbird or Seamonkey from 1.9.0.x, then no need to worry about it there too much, but it might be better to just fix and not worry than try to guess. It's a one-liner...
Oh, I'll happily r+sr the fix, of course. ;)

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=458883#c3)• 16 years ago |
|  | |

It's actually a two-liner, since I realized this afternoon that we never blocked .textContent either, which means that we only stopped [bug 66938](/show_bug.cgi?id=66938 "VERIFIED FIXED - Eavesdropping on mail messages using innerHTML (wiretap)") for a bit under two years, and have been completely open to it since June 2003.
And we want to take it for 1.9.0 because even though \*we\* aren't shipping from it, we don't actually know that, for instance, kreeger isn't going to ship a Correo from 1.9.0, or that someone we don't even know is already shipping from it. What's that thing mscott's been doing, and what Gecko does it ship?Assignee: nobody → philringnaldaOS: Mac OS X → AllHardware: PC → All

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=458883#c4)• 16 years ago |
|  | |

Ah, I'd assumed we prevented innerHTML because of getting resolved URIs or something.
If we're preventing textContent we probably also need to kill nsIDOM3Text.wholeText.
Times like this I really wish we had brendan's tainting stuff working...

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=458883#c5)• 16 years ago |
|  | |

And we prevent \*.attributes.get, \*.getAttribute, and \*.getAttributeNS, but not getAttributeNode or getAttributeNodeNS, as long as we're tightening stuff up here.

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=458883#c6)• 16 years ago |
|  | |

Attached file
[test mbox](attachment.cgi?id=342202)
— [Details](attachment.cgi?id=342202&action=edit)

Be nice if we had Mochitest-alike infrastructure (well, and had it on 1.8, since we're not doing script on the trunk right now), but at least this makes ad-hoc testing a little easier: drop it in Mail/Local Folders in a Tb2.x profile and view the message with javascript.allow.mailnews enabled, and it'll alert the documentURI (including the path to your profile, for easier attacking), then the textContent of the body to demonstrate that [bug 66938](/show_bug.cgi?id=66938 "VERIFIED FIXED - Eavesdropping on mail messages using innerHTML (wiretap)") has been wide open again since 2003.
(I do have a nice automatic wiretap message, that will send my web server everything that the first recipient says to the person they forward it to, along with the path to both their profiles, but I figured nobody would really want to test with that.)

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=458883#c7)• 16 years ago |
|  | |

Attached patch

[Whack-some-moles, v.1](attachment.cgi?id=342203&action=diff) (obsolete)
— [Details](attachment.cgi?id=342203&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342203)

Against 1.8, since that's what worries me most, this is what I want to land on mozilla-central, 1.9.0, and 1.8.
With wholeText being 1.9.1-only, and 1.9.1 not having any content JS in mailnews at the moment, I'll get it separately (hopefully along with a reordering that will make it clear what we're actually doing, so things like the missing getAttributeNode(NS) will stand out better).
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: superreview?(bzbarsky)
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=458883#a85804_20209)• 16 years ago |

[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: superreview?(bzbarsky)
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: superreview+
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: review?(bzbarsky)
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: review+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=458883#c8)• 16 years ago |
|  | |

Comment on [attachment 342203](/attachment.cgi?id=342203 "Whack-some-moles, v.1") [[details]](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") [[diff]](/attachment.cgi?id=342203&action=diff "Whack-some-moles, v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342203)
Whack-some-moles, v.1
That should probably be \*.documentURI, not HTMLDocument.documentURI. Otherwise if we somehow enable creation of XML documents with the current URI the caller will be able to extract it.

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=458883#c9)• 16 years ago |
|  | |

Comment on [attachment 342203](/attachment.cgi?id=342203 "Whack-some-moles, v.1") [[details]](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") [[diff]](/attachment.cgi?id=342203&action=diff "Whack-some-moles, v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342203)
Whack-some-moles, v.1
\* it is, then - I wasn't sure how expensive they are.
Drivers: sorry, no place other than 1.8.1 it \*can\* bake.
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: approval1.9.0.4?
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: approval1.8.1.18?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=458883#a183763_1689)• 16 years ago |

Flags: wanted1.8.1.x+Flags: blocking1.9.0.4?Flags: blocking1.9.0.4+Flags: blocking1.8.1.18?Flags: blocking1.8.1.18+Whiteboard: [sg:high]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=458883#c10)• 16 years ago |
|  | |

Comment on [attachment 342203](/attachment.cgi?id=342203 "Whack-some-moles, v.1") [[details]](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") [[diff]](/attachment.cgi?id=342203&action=diff "Whack-some-moles, v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342203)
Whack-some-moles, v.1
>+pref("capability.policy.mailnews.HTMLDocument.documentURI", "noAccess");
Sorry to nitpick but can we get a patch with the "\*" as you intend to check it in? Often times downstream vendors work from the bug patch rather than bonsai so it's important to approve what's actually being checked in on the old branches.
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: approval1.9.0.4?
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: approval1.9.0.4-
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: approval1.8.1.18?
[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Flags: approval1.8.1.18-

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=458883#c11)• 16 years ago |
|  | |

Attached patch

[For checkin, 1.8 branch](attachment.cgi?id=342539&action=diff)
— [Details](attachment.cgi?id=342539&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342539)

[Attachment #342203](/attachment.cgi?id=342203&action=edit "Whack-some-moles, v.1") -
Attachment is obsolete: true
[Attachment #342539](/attachment.cgi?id=342539&action=edit "For checkin, 1.8 branch") -
Flags: approval1.8.1.18?

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=458883#c12)• 16 years ago |
|  | |

Attached patch

[For checkin, 1.9.0 branch](attachment.cgi?id=342540&action=diff)
— [Details](attachment.cgi?id=342540&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342540)

Second verse, same as the first (other than 31 lines of offset, but to me you are describing possible users of it as both psychotic and utterly random, so maybe avoiding the offset is a good thing).
[Attachment #342540](/attachment.cgi?id=342540&action=edit "For checkin, 1.9.0 branch") -
Flags: approval1.9.0.4?

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=458883#a224643_135518)• 16 years ago |

[Attachment #342540](/attachment.cgi?id=342540&action=edit "For checkin, 1.9.0 branch") -
Attachment is patch: true
[Attachment #342540](/attachment.cgi?id=342540&action=edit "For checkin, 1.9.0 branch") -
Attachment mime type: application/octet-stream → text/plain

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=458883#c13)• 16 years ago |
|  | |

Attached patch

[For checkin, mozilla-central trunk](attachment.cgi?id=342542&action=diff)
— [Details](attachment.cgi?id=342542&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342542)

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=458883#a225143_135518)• 16 years ago |

Summary: Make Document.documentURI noAccess in mailnews → Make Document.documentURI and .textContent noAccess in mailnews

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=458883#c14)• 16 years ago |
|  | |

Comment on [attachment 342539](/attachment.cgi?id=342539 "For checkin, 1.8 branch") [[details]](/attachment.cgi?id=342539&action=edit "For checkin, 1.8 branch") [[diff]](/attachment.cgi?id=342539&action=diff "For checkin, 1.8 branch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342539)
For checkin, 1.8 branch
Approved for 1.8.1.18, a=dveditz for release-drivers
[Attachment #342539](/attachment.cgi?id=342539&action=edit "For checkin, 1.8 branch") -
Flags: approval1.8.1.18? → approval1.8.1.18+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=458883#c15)• 16 years ago |
|  | |

Comment on [attachment 342540](/attachment.cgi?id=342540 "For checkin, 1.9.0 branch") [[details]](/attachment.cgi?id=342540&action=edit "For checkin, 1.9.0 branch") [[diff]](/attachment.cgi?id=342540&action=diff "For checkin, 1.9.0 branch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342540)
For checkin, 1.9.0 branch
Approved for 1.9.0.4, a=dveditz for release-drivers
[Attachment #342540](/attachment.cgi?id=342540&action=edit "For checkin, 1.9.0 branch") -
Flags: approval1.9.0.4? → approval1.9.0.4+

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=458883#a461640_135518)• 16 years ago |

Status: NEW → RESOLVEDClosed: 16 years agoKeywords: [fixed1.8.1.18](/buglist.cgi?keywords=fixed1.8.1.18&resolution=---),
[fixed1.9.0.4](/buglist.cgi?keywords=fixed1.9.0.4&resolution=---)Resolution: --- → FIXED

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=458883#c16)• 16 years ago |
|  | |

Any suggestions on how QA can verify this fix?

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=458883#c17)• 16 years ago |
|  | |

[Comment 6](/show_bug.cgi?id=458883#c6 "VERIFIED FIXED - Make Document.documentURI and .textContent noAccess in mailnews") - feel free to email me if you need more explicit directions.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=458883#c18)• 16 years ago |
|  | |

Ah, right, I was skimming too quickly and didn't process your comment (obviously). This should be fine for verification.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=458883#c19)• 16 years ago |
|  | |

Verified for 1.8.1.18 with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.18pre) Gecko/2008110403 Thunderbird/2.0.0.18pre. I reproduced the bug in 1.8.1.17 using Phil's test mbox.Keywords: [fixed1.8.1.18](/buglist.cgi?keywords=fixed1.8.1.18&resolution=---) → [verified1.8.1.18](/buglist.cgi?keywords=verified1.8.1.18&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=458883#c20)• 16 years ago |
|  | |

Verified for 1.9.0.4 with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1b2pre) Gecko/20081104 Shredder/3.0b1pre.Status: RESOLVED → VERIFIEDKeywords: [fixed1.9.0.4](/buglist.cgi?keywords=fixed1.9.0.4&resolution=---) → [verified1.9.0.4](/buglist.cgi?keywords=verified1.9.0.4&resolution=---)

|  | [Alexander Sack](/user_profile?user_id=113760) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=458883#c21)• 16 years ago |
|  | |

Comment on [attachment 342539](/attachment.cgi?id=342539 "For checkin, 1.8 branch") [[details]](/attachment.cgi?id=342539&action=edit "For checkin, 1.8 branch") [[diff]](/attachment.cgi?id=342539&action=diff "For checkin, 1.8 branch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=458883&attachment=342539)
For checkin, 1.8 branch
a=asac for 1.8.0 (needs a bit context adjusting to apply cleanly)
[Attachment #342539](/attachment.cgi?id=342539&action=edit "For checkin, 1.8 branch") -
Flags: approval1.8.0.15+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=458883#a3739329_1689)• 16 years ago |

Group: core-security

|  | [Alexander Sack](/user_profile?user_id=113760) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=458883#a7805556_113760)• 16 years ago |

Flags: blocking1.8.0.next+
You need to [log in](/show_bug.cgi?id=458883&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Phil Ringnalda (:philor)](/user_profile?user_id=135518)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_daaaddc0_20250125_131406.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2008-59

## Script access to .documentURI and .textContent in mail

Announced
November 19, 2008
Reporter
Boris Zbarsky
Impact
Low
Products
SeaMonkey, Thunderbird
Fixed in

* SeaMonkey 1.1.13
* Thunderbird 2.0.0.18

### Description

Mozilla developer **Boris Zbarsky** reported that a
malicious mail message might be able to glean personal information
about the recipient from the mailbox URI (such as computer account
name) if the mail recipient has enabled JavaScript in mail. If a
malicious mail is forwarded "in-line" to a recipient who has enabled
JavaScript, then comments added by the forwarder could be accessed by
scripts in the message and potentially revealed to the original
malicious author if that message has also been allowed to load remote
content.

Scripts in mail messages no longer have access to the DOM properties
`.documentURI` and `.textContent`.

Thunderbird is only vulnerable to this issue if
JavaScript is enabled in mail. This is not the default setting and we
strongly discourage users from running JavaScript in mail.

### Workaround

Disable JavaScript until a version containing these fixes can be
installed.

### References

* <https://bugzilla.mozilla.org/show_bug.cgi?id=458883>

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


