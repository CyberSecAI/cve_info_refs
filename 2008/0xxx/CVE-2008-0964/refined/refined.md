Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2008-0964

**Root Cause of Vulnerability:**
- The vulnerability lies within the `snoop(1M)` utility in Solaris, specifically when it displays Server Message Block (SMB) traffic. The vulnerability is triggered when `snoop` parses a crafted SMB packet. This parsing process leads to an exploitable condition.

**Weaknesses/Vulnerabilities Present:**
- A buffer overflow vulnerability is present in `snoop`. It seems the parsing of SMB packets with a specific SMB command code (0x72) allows an attacker to overwrite memory locations.
- Specifically, the crafted packet contains a command string, and the vulnerability is likely present within the routine handling this command, which leads to a call to `system()`.

**Impact of Exploitation:**
- Successful exploitation allows an attacker to execute arbitrary commands on the vulnerable system with the privileges of the user running `snoop`. This is a remote command execution vulnerability.
- The provided exploit code uses a specially crafted SMB packet to overwrite the return address with the address of `system()`, which then executes a shell command specified by the attacker.

**Attack Vectors:**
- The attack vector is network-based. An attacker sends a crafted SMB packet to a system running a vulnerable version of Solaris with `snoop` running.
- The `snoop` command needs to be actively monitoring traffic.
- The exploit specifically targets the SMB protocol (port 445) to trigger the vulnerability.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send network packets to the target system.
- The attacker needs to know the architecture and operating system version of the target system to select the correct offset to the address of the `system()` function.
- The attacker does not need prior authentication.

**Additional Technical Details:**

- The provided exploit code `hoagie_snoop.c` shows how to craft an SMB packet with command code `0x72` and a malicious command string that, when parsed by `snoop`, causes a buffer overflow, overwriting the return address to point to the `system()` function.
- The exploit code provides different offsets for the system() address for different Solaris versions and architectures.
- The exploit modifies the SMB dialect to include the attacker-specified command.

**Affected Products:**
- Solaris 8, 9 and 10 operating systems are vulnerable.

**Note:** This content provides more detail than the official CVE description, including specific exploit details.