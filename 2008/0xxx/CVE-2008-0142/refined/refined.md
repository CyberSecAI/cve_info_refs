- **Root cause of vulnerability:** The vulnerability lies in the `actions.php` file of WebPortal CMS. Specifically, the password reset functionality (`action=lostpass`) generates a new password based on the current server time (minutes and seconds) and part of the username. This new password is then used to update the user's password in the database. The new password is not sufficiently random.
- **Weaknesses/vulnerabilities present:**
    - Predictable Password Generation: The newly generated password is based on the server's time (minutes and seconds), making it predictable.
    - Lack of proper sanitization and use of `$_POST` parameters in the update query without proper sanitization can cause SQL injection when `magic_quotes` is off (though this is not the focus of the exploit).
- **Impact of exploitation:** An attacker can reset a user's password by sending a crafted POST request to `actions.php` with `action=lostpass` and the victim's username. Subsequently, the attacker can login to the user account if they know or are able to guess the generated password. This allows for complete account takeover, including administrator accounts.
- **Attack vectors:**
    - The attacker sends a POST request to `/webportal-0.6-beta/actions.php?action=lostpass` with the username of the target account.
    - The attacker then uses a brute force attack by guessing the password, which is based on server time in minutes and seconds, and part of the username.
- **Required attacker capabilities/position:**
    - The attacker needs network access to the vulnerable WebPortal CMS instance.
    - The attacker needs to know or guess the username of the targeted user.
    - The attacker should know the time of the vulnerable server, or be able to quickly iterate through possible password combinations.