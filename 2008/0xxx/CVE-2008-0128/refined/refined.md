```
{
  "cve": "CVE-2008-0128",
  "description": "The SingleSignOn Valve in Apache Tomcat versions before 5.5.21 does not set the 'secure' flag on the JSESSIONIDSSO cookie when accessed over HTTPS. This allows the cookie to be transmitted over HTTP, potentially exposing it to unauthorized access.",
  "vulnerability_details": {
    "root_cause": "The SingleSignOn Valve (org.apache.catalina.authenticator.SingleSignOn) does not set the 'secure' attribute on the JSESSIONIDSSO cookie when accessed over HTTPS.",
    "weaknesses": [
      "The 'secure' flag for cookies is not set when using HTTPS, leading to potential exposure over HTTP."
    ],
    "impact": "Exposure of the SSO cookie, potentially leading to unauthorized access to user sessions in different contexts (both HTTPS and HTTP).",
    "attack_vectors": [
      "Man-in-the-middle attack on an HTTP connection."
    ],
     "required_attacker_capabilities": [
        "The attacker needs to intercept HTTP traffic. This would likely involve a man-in-the-middle attack."
      ],
    "attacker_position": "The attacker must be positioned to eavesdrop on network traffic between the user and the server."
  },
  "affected_versions": [
    "Apache Tomcat versions before 5.5.21"
  ],
    "additional_details": "The vulnerability exists because the 'secure' flag is not explicitly set on the SSO cookie. When a cookie is set with the 'secure' flag, it will only be sent over HTTPS. Without this flag, the browser might send the cookie over HTTP, potentially exposing sensitive session data. The fix involves setting the 'secure' flag on the cookie when accessed via HTTPS, ensuring that the cookie is only ever sent over encrypted connections."
}
```