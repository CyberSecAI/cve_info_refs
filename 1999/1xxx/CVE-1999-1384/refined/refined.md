- **Root cause of vulnerability:** The `RemoveSystemTour` program, which is setuid root, calls `versions remove`, which in turn calls `inst`. The `inst` program is highly configurable and allows users to specify logfiles, directories, and exit operation scripts. This configuration can be manipulated to execute arbitrary commands as root.
- **Weaknesses/vulnerabilities present:**
    - The `RemoveSystemTour` program runs with setuid root privileges, but does not properly sanitize or restrict the parameters passed to the `inst` program.
    - The `inst` program allows user-controlled environment variables, logfiles, directories, and exit operation scripts which are not properly validated.
    - `inst` has a race condition on the file `/tmp/shPID0`.
    - `inst` will overwrite logfiles specified in the `.swmgrrc` file and create the shell script over anything.
- **Impact of exploitation:** A malicious user can gain root privileges, cause a denial of service, or execute arbitrary code by manipulating the configuration of `inst` through the `RemoveSystemTour` program.
- **Attack vectors:**
    - A local user can set up a malicious environment, including modifying environment variables, specifying a custom `.swmgrrc` configuration file with a malicious exitops script, to be executed by `inst`.
    - The `RemoveSystemTour` program calls `inst` via `versions remove`, allowing an attacker to exploit `inst`s misconfiguration.
- **Required attacker capabilities/position:** An attacker needs a user account on the SGI system with the `systour` package installed. The attacker also needs the ability to create and modify files in their home directory.