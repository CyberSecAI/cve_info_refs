- **Root cause of vulnerability**: The `login` program in Slackware doesn't check the return value of the `setup_uid_gid` function. This function, in turn, calls `initgroups`. If `initgroups` fails (e.g. when `/etc/group` does not exist), `setup_uid_gid` returns an error, but login continues execution without setting the correct user and group IDs.
- **Weaknesses/vulnerabilities present**: Lack of proper error checking in the `login` program after calling `setup_uid_gid`. The `setup_uid_gid` function does not set the correct user/group id when it encounters an error.
- **Impact of exploitation**: If an attacker can somehow remove the `/etc/group` file, any user logging in will be granted root privileges, since `setuid` and `setgid` are not called when `initgroups` fails.
- **Attack vectors**: An attacker would need to find a way to delete or render inaccessible the `/etc/group` file before a user logs in.
- **Required attacker capabilities/position**: The attacker needs a method to remove `/etc/group`, which would likely require elevated privileges prior to the attack.