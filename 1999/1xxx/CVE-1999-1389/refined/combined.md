=== Content from marc.info_d7f8df77_20250125_151257.html ===

```
[[prev in list](?l=bugtraq&m=90221101925915&w=2)] [[next in list](?l=bugtraq&m=90221101925917&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    3Com/USR Total Control Chassis dialup port access filters
From:       [Jason Downs <downsj () DOWNSJ ! COM>](?a=90366695400015&r=1&w=2)
Date:       [1998-05-11 20:57:44](?l=bugtraq&r=1&w=2&b=199805)
[Download RAW [message](?l=bugtraq&m=90221101925916&q=mbox) or [body](?l=bugtraq&m=90221101925916&q=raw)]

Total Control Chassis' are fairly common terminal servers; when someone
dials into an ISP that's offering X2, they're most likely dialing into one.

Any such system that answers with a 'host:' or similar prompt and is running
the specified version of the OS is vulnerable.  Likely without the ISP even
knowing it.  This bug is being actively exploited.

Equipment: US Robotics/3Com Total Control Chassis
Card: Netserver PRI
OS: Total Control (tm) NETServer Card V.34/ISDN with Frame Relay V3.7.24

Details:

When a port is set to "set host prompt" the access filters are ignored
even though the specific port's ifilter is set. Access filters look like
this:

> sho filter allowed_hosts
 1 permit XXX.XXX.XXX.12/24 XXX.XXX.XXX.161/32 tcp dst eq 539
 2 permit XXX.XXX.XXX.12/24 XXX.XXX.XXX.165/32 tcp dst eq 23
 3 permit XXX.XXX.XXX.12/24 XXX.XXX.XXX.106/32 tcp dst eq 23
 4 permit XXX.XXX.XXX.12/24 XXX.XXX.XXX.168/32 tcp dst eq 540
 5 permit XXX.XXX.XXX.12/24 XXX.XXX.XXX.168/32 tcp dst eq 23
 6 permit XXX.XXX.XXX.12/24 XXX.XXX.XXX.109/32 tcp dst eq 3030
 7 permit XXX.XXX.XXX.12/24 XXX.XXX.XXX.109/32 tcp dst eq 3031
 8 permit XXX.XXX.XXX.12/24 XXX.XXX.XXX.109/32 tcp dst eq 513
 9 deny   0.0.0.0/0 0.0.0.0/0 ip

Filter is set with "set all ifilter allowed_hosts"

Dialup users are able to type a host name twice at the "host:" prompt which
will in turn open a telnet session to the host the user typed twice.
The results for a user doing this will show up as follows.

> sho ses

S19   woodnet.wce.wwu woodnet.wce.wwu. Login   In  ESTABLISHED     4:30

Use of this will show up in the syslogs as:

May 11 08:58:39 XXXXXX remote_access: Packet filter does not exist. User woodne
t.wce.wwu.edu access denied.

Contrary to the statement, access is not denied.

This problem does not exist on earlier versions, specifically we have tried
Total Control (tm) NETServer Card V.34/ISDN with Frame Relay V3.6.22

Credit for providing the technical examples in this post goes to Doug Palin,
<doug@pacifier.com>.

--
Jason Downs
downsj@downsj.com

[[prev in list](?l=bugtraq&m=90221101925915&w=2)] [[next in list](?l=bugtraq&m=90221101925917&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


