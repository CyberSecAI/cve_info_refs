- **Root cause of vulnerability:** The `rcp` program fails to properly drop privileges when executed by user `nobody` with UID 65535. The `setuid()` function returns an error (-1) for this specific UID, causing `rcp` to continue running with root privileges.
- **Weaknesses/vulnerabilities present:**
    - `rcp` does not handle setuid() errors for UID 65535 correctly.
    - The `phf` cgi-bin script allows execution of arbitrary programs by injecting a newline character, which can be exploited to run `rcp`.
- **Impact of exploitation:** An attacker can gain root privileges by exploiting the `rcp` vulnerability through a vulnerable CGI script running as user `nobody`. This can lead to complete system compromise.
- **Attack vectors:**
    - The primary attack vector is through a CGI script (like `phf`) running as user `nobody` which then executes `rcp`.
    - A remote attacker can exploit the `phf` CGI vulnerability via a web request to trigger the `rcp` execution, escalating privileges to root.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to send a request to a web server that executes a vulnerable CGI script (like `phf`) as user `nobody`.
    - The attacker must be able to inject commands in a way that the CGI script will execute rcp (e.g., through newline injection).
    - They need to have a method to execute commands remotely after getting root (e.g. with rsh or similar)