=== Content from marc.info_68dc299c_20250125_172038.html ===

```
[[prev in list](?l=ntbugtraq&m=93076337220850&w=2)] [[next in list](?l=ntbugtraq&m=93127894831204&w=2)] [prev in thread] [next in thread]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    Update: NT runs explorer.exe, etc...
From:       [Martin Wolf <martinw () INFOSUPPORT ! COM>](?a=93069434500001&r=1&w=2)
Date:       [1999-06-30 22:19:10](?l=ntbugtraq&r=1&w=2&b=199906)
[Download RAW [message](?l=ntbugtraq&m=93127894731200&q=mbox) or [body](?l=ntbugtraq&m=93127894731200&q=raw)]

Hello everyone,

in my previous e-mail, I noted that NT would sometimes run explorer.exe and
other executables from the root directory rather than from \winnt\system32.
Actually, it turns out that NT will look in the user's home directory, as
configured with User Manager. The root directory is simply the default
working directory that will be used when no home directory has been set for
a user.

To recap: when a user's home directory (which is the root directory by
default) contains a file named explorer.exe, nddeagnt.exe, taskmgr.exe or
userinit.exe, those executables will be launched by NT instead of the ones
in the \winnt\system32 directory.

Hope this helps. Thanks to the people who responded to my first message.

Kind regards,

Martin Wolf
martinw@infosupport.com

[[prev in list](?l=ntbugtraq&m=93076337220850&w=2)] [[next in list](?l=ntbugtraq&m=93127894831204&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_8dd2a4d3_20250125_172035.html ===

```
[[prev in list](?l=ntbugtraq&m=93053493719892&w=2)] [[next in list](?l=ntbugtraq&m=93069455701264&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=93127291424765&w=2)]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    [NT runs Explorer.exe, Taskmgr.exe etc. from wrong location](?t=93069434900001&r=1&w=2)
From:       [Martin Wolf <martinw () INFOSUPPORT ! COM>](?a=93069434500001&r=1&w=2)
Date:       [1999-06-28 19:06:39](?l=ntbugtraq&r=1&w=2&b=199906)
[Download RAW [message](?l=ntbugtraq&m=93069418400856&q=mbox) or [body](?l=ntbugtraq&m=93069418400856&q=raw)]

Hi everyone,

we have discovered what seems to be a bug in Windows NT, with
possible security consequences. Specifically, it would allow
any user with local access to a machine, as long as they have
write access to the root directory of the boot partition, to install
a Trojan horse which is then executed whenever someone
logs on locally.

The problem is that when this partition (the one containing
%systemroot%) contains a file such as NDDEAGNT.EXE,
EXPLORER.EXE, USERINIT.EXE or TASKMGR.EXE, that file
will be executed instead of the one in the %systemroot% or
%systemroot%\system32 directory. This can be easily
demonstrated:

1. Copy an executable file (CALC.EXE will do) to the rootdir.
2. Rename the file to NDDEAGNT.EXE.
3. Log off, and log on again as the same or a different user.
The Calculator program will now start immediately, using the
security privileges of the logged-on user (OK, bad example..).

This behaviour seems to occur on any out-of-the-box NT4 installation,
even with SP4, although obviously it can only be exploited by someone
with write access to the specified location.
It also works with TASKMGR.EXE, but only when the task manager is
started using Ctrl-Alt-Del, not when it is started from the taskbar. This
suggests the problem lies with Winlogon or the LSASS subsystem.

I have reported this to secure@microsoft.com; their response was that
the system should be configured so that ordinary users do not have
write access to the root directory. This is obviously true; however, it
still seems to be a bug, as in "deviates from expected behaviour". Also,
it does not work on all machines even when the attacker does have write
access to the system boot partition, but I am not yet sure exactly where
the problem lies.

Kind regards,

Martin Wolf
martinw@infosupport.com

[[prev in list](?l=ntbugtraq&m=93053493719892&w=2)] [[next in list](?l=ntbugtraq&m=93069455701264&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=93127291424765&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


