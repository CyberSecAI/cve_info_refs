- **Root cause of vulnerability:** Insufficient input sanitization in the `rpc-nlog.pl` CGI script. Specifically, the script filters out certain characters (`\n`, `` ` ``, `'`, `|`, `"`, `<`, `>`) from the user-supplied IP address but fails to filter out command separators like `;` and `/`. This allows an attacker to inject arbitrary commands.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability due to inadequate filtering of user input. The script directly incorporates user-provided data into a shell command, enabling arbitrary command execution.
- **Impact of exploitation:** An attacker can execute arbitrary commands on the server by injecting them into the `ipaddr` parameter through the `QUERY_STRING`.
- **Attack vectors:** The attack vector is through a web interface via the `QUERY_STRING`. An attacker can craft a URL with malicious commands embedded in the `ipaddr` parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the vulnerable CGI script. No specific capabilities are described, but the attacker needs to be able to construct a malicious URL.