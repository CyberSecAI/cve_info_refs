=== Content from marc.info_ba04ecc3_20250125_004943.html ===

```
[[prev in list](?l=bugtraq&m=90221104525882&w=2)] [[next in list](?l=bugtraq&m=90221104525886&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=90221104525894&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [ePerl: bad handling of ISINDEX queries](?t=90221121200010&r=1&w=2)
From:       [Tiago Luz Pinto <tiago () EPS ! UFSC ! BR>](?a=90367196100013&r=1&w=2)
Date:       [1998-07-07 1:39:24](?l=bugtraq&r=1&w=2&b=199807)
[Download RAW [message](?l=bugtraq&m=90221104525890&q=mbox) or [body](?l=bugtraq&m=90221104525890&q=raw)]

    (ePerl is an embedded Perl Interpreter for HTTP servers)

* Description:
    Incorrect Handling of ISINDEX queries (command line argument)
when ePerl runs as a nph-cgi/cgi.

* Cause:
    According with the CGI/1.1 specification, the HTTP
server executes CGI's passing the ISINDEX field as a command
line argument. When ePerl runs and gets this argument
(argc > 1), it fails to set MODE_CGI, then tries to
open the argument for parsing/executing.

    This can lead to arbitrary Perl code being executed on
the server.

* Example:
<http://foo.com/some/dir/doit.phtml?/home/ftp/incoming/executemycode.phtml>

+----------------------------------------------------------------------+
|  Tiago Luz Pinto                                 tiago@eps.ufsc.br   |
|                                                                      |
|  Network Administrator  -      Department of Production Engineering  |
|  Federal University of Santa Catarina -                      Brazil  |
+----------------------------------------------------------------------+

[[prev in list](?l=bugtraq&m=90221104525882&w=2)] [[next in list](?l=bugtraq&m=90221104525886&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=90221104525894&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_4f9236a9_20250125_004944.html ===

```
[[prev in list](?l=bugtraq&m=90221104525953&w=2)] [[next in list](?l=bugtraq&m=90221104525919&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    ePerl Security Update Available
From:       ["Ralf S. Engelschall" <rse () engelschall ! com>](?a=90367013300012&r=1&w=2)
Date:       [1998-07-10 8:49:44](?l=bugtraq&r=1&w=2&b=199807)
[Download RAW [message](?l=bugtraq&m=90221104525927&q=mbox) or [body](?l=bugtraq&m=90221104525927&q=raw)]

ePerl Security Update Available
===============================

A security bug report from Tiago Luz Pinto <tiago@EPS.UFSC.BR> about ePerl
2.2.12 occured on BugTraq at 06-Jul-1998 which showed ePerl was incorrectly
handling ISINDEX queries (passed as command line argument by the webserver)
when ePerl runs as a (NPH-)CGI script for *.phtml pages.

In summary the problem is that under ePerl 2.2.12 a request to

   <http://foo/dir/bar.phtml?/absolute/path/to/quux.phtml>

(i.e. a request for bar.phtml with a QUERY_STRING containing an absolute path
to quux.phtml - both are ePerl pages) leads not to the evaluation of
bar.phtml. Instead quux.phtml was evaluated because ePerl 2.2.12 incorrectly
determined the source from the command line instead of PATH_TRANSLATED when
QUERY_STRING was present.

This is some sort of a security hole and at least a bug because this way one
can evaluate ePerl pages through different URLs. But the statement ``This can
lead to _arbitrary_ Perl code being executed on the server.'' from the
original security report is not quite correct. Because the quux.phtml is still
treated as a text file which is just bristled with ePerl blocks. And those
files usually exists for the same reason: Evaluation as HTML pages on the web
with embedded Perl code.

Nevertheless its a nasty bug and I've now again (I've still fixed such
QUERY_STRING related bugs in the past) compared the different run-time
environments for ePerl (notice that ePerl is more than just a CGI-program, it
can be used in a lot of modes and so the determination is really _NOT_
trivial; look inside eperl_main.c if you don't doubt me) and rewrote the mode
determination. Now it isn't anymore confused by a command line arguments under
the CGI environment when QUERY_STRING is present.

Users of ePerl 2.2.12 I encourage to upgrade to ePerl 2.2.13.
The distribution eperl-2.2.13.tar.gz is available under

   <http://www.engelschall.com/sw/eperl/>   and
   ftp://ftp.engelschall.com/sw/eperl/

Thanks for supporting ePerl and the Perl community.

Greetings,
                                       Ralf S. Engelschall
                                       rse@engelschall.com
                                       [www.engelschall.com](http://www.engelschall.com)

[[prev in list](?l=bugtraq&m=90221104525953&w=2)] [[next in list](?l=bugtraq&m=90221104525919&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


