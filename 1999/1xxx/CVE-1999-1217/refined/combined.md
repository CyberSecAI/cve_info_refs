=== Content from marc.info_1f63ffc5_20250125_041811.html ===

```
[[prev in list](?l=ntbugtraq&m=87602726319424&w=2)] [[next in list](?l=ntbugtraq&m=87602726319427&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=87602726319427&w=2)]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    [NT security - why bother?](?t=87603281300015&r=1&w=2)
From:       [Paul Ashton <paul () ARGO ! DEMON ! CO ! UK>](?a=90366062000044&r=1&w=2)
Date:       [1997-07-23 22:34:20](?l=ntbugtraq&r=1&w=2&b=199707)
[Download RAW [message](?l=ntbugtraq&m=87602726319426&q=mbox) or [body](?l=ntbugtraq&m=87602726319426&q=raw)]

According to <http://www.microsoft.com/kb/articles/q169/3/87.htm> , after
you install office97 you must grant full read write access to c:\,
c:\winnt, c:\winnt\system32 plus the office directories plus others. The
product will not function if you make those directories read-only.

It's good having an NT security framework that allows us to secure
any object, but how are we supposed to do it if this is the sort
of support that we get from the vendor? Why would any other application
developers bother to support secure configurations if this is what
they see coming out of Redmond?

This question has been addressed at length on c.o.msw.nt.a.security,
so to prevent any rehash of the issues, I will try to summarise the
conclusions:

The best that could be done to secure such a setup would be to
set read only access to all files within the directories except
the ones explicitly quoted as requiring r/w access, followed
by setting auditing on write to those directories.

Even if this is considered acceptable, there are still some
considerations that need stating:-

PATH search issue - by default, the PATH contains the current
directory (whether specified or not), \winnt\system32, and then
\winnt. Therefore, from a cmd prompt, any attempt to
execute files in \winnt or the current directory provide an
opportunity to create files of the same name in directories
earlier in the path.

Extension search issue - from a cmd prompt, there is an additional
search path through files of the same name but with different
extensions. i.e. an attempt to execute command foo will search
through exe com bat pif exe in some order or other. Therefore
there must also be a mechanism to protect against trojans in
this case.

Case distinction - this has previously been mentioned as a
POSIX issue, but files with the same name and different case
can be created by calling the WIN32 function CreateFile()
with the flag FILE_FLAG_POSIX_SEMANTICS specified, whether
the POSIX subsystem is installed or not.

Viruses - If we can't protect the templates directory,
viruses will be given an unacceptable free reign.

Paul

[[prev in list](?l=ntbugtraq&m=87602726319424&w=2)] [[next in list](?l=ntbugtraq&m=87602726319427&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=87602726319427&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_4e4108da_20250125_041812.html ===

```
[[prev in list](?l=ntbugtraq&m=87602726319432&w=2)] [[next in list](?l=ntbugtraq&m=87602726319436&w=2)] [[prev in thread](?l=ntbugtraq&m=87602726319433&w=2)] [[next in thread](?l=ntbugtraq&m=87602726319440&w=2)]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    [Re: NT security - why bother?](?t=87603281300015&r=1&w=2)
From:       [Jeremy Allison <jallison () WHISTLE ! COM>](?a=90366238600017&r=1&w=2)
Date:       [1997-07-25 12:35:42](?l=ntbugtraq&r=1&w=2&b=199707)
[Download RAW [message](?l=ntbugtraq&m=87602726319435&q=mbox) or [body](?l=ntbugtraq&m=87602726319435&q=raw)]

Paul Ashton wrote:

> Use a different command shell. I use bash from cygwin. Do other
> things other than cmd.exe observe PATH?

It's worse than that. From the documentation of CreateProcess().

-----------start excerpt-----------------------
If the filename does not contain a directory path, Windows searches for
the
executable file in the following sequence:
        1.      The directory from which the application loaded.
        2.      The current directory for the parent process.
        3.      Windows 95: The Windows system directory. Use the
                GetSystemDirectory function to get the path of this
directory.
                Windows NT: The 32-bit Windows system directory. Use the
                GetSystemDirectory function to get the path of this
directory.
                The name of this directory is SYSTEM32.
        4.      Windows NT: The 16-bit Windows system directory. There
is no
                Win32 function that obtains the path of this directory,
but
                it is searched. The name of this directory is SYSTEM.
        5.      The Windows directory. Use the GetWindowsDirectory
function
                to get the path of this directory.
        6.      The directories that are listed in the PATH environment
                variable.
-------------end excerpt-----------------------------

This means :

1). '.\' is *always* in your PATH.
2). The PATH is only searched as a last resort.

The SYSTEM32 directory and others are *hard coded* into the OS API
specification.

Good luck fixing that :-(.

Jeremy Allison,
Whistle Communications.

[[prev in list](?l=ntbugtraq&m=87602726319432&w=2)] [[next in list](?l=ntbugtraq&m=87602726319436&w=2)] [[prev in thread](?l=ntbugtraq&m=87602726319433&w=2)] [[next in thread](?l=ntbugtraq&m=87602726319440&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


