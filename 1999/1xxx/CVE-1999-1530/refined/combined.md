=== Content from marc.info_7dfe4ecc_20250125_063846.html ===

```
[[prev in list](?l=bugtraq&m=94218618329838&w=2)] [[next in list](?l=bugtraq&m=94484576107016&w=2)] [prev in thread] [[next in thread](?l=cobalt-developers&m=94219749208574&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [[Cobalt] Security Advisory - cgiwrap](?t=94219759400002&r=1&w=2)
From:       [Jeff Bilicki <jeffb () COBALT ! COM>](?a=94225651900001&r=1&w=2)
Date:       [1999-11-09 23:09:39](?l=bugtraq&r=1&w=2&b=199911)
[Download RAW [message](?l=bugtraq&m=94225629200045&q=mbox) or [body](?l=bugtraq&m=94225629200045&q=raw)]

Cobalt Networks -- Security Advisory -- 11.09.1999

Problem:
The current version of cgiwrap that runs on RaQ 2 and RaQ 3i, runs under
incorrect effective permissions, which could let a malicious site-admin
view or modify data in another virtual site on the same unit.

Description:
Thanks to Chris Adams <cmadams@hiwaay.net>

Chris Adams wrote:
>There is a problem (actually several) with the "cgiwrap" program on
>Cobalt RaQ2 servers.  It is supposed to run CGI programs as the proper
>user instead of "nobody" to make CGIs a little more secure.
[SNIP]
>The bigger problem is that cgiwrap apparently interprets top level
>directories of the site /web directory as users.  So if you have a CGI
>in a directory like /home/sites/site1/web/test/test.cgi and attempt to
>go to it at <http://www.site1.com/test/test.cgi> AND there is a user on
>the system named "test", cgiwrap thinks it should run the script as user
>"test".  It then actually attempts to run a script in /web directory of
>the user "test".
[SNIP]

Cobalt Networks is dedicated to providing secure platforms.
Accordingly, we have just completed a fix for this bug that is available
in RPM format, which can be found at the following locations:

RaQ 3i (x86)
RPM:
ftp://ftp.cobaltnet.com/pub/experimental/secuirty/rpms/cgiwrap-pacifica-3.6.4.C5.i386.rpm
SRPM:
ftp://ftp.cobaltnet.com/pub/experimental/secuirty/srpms/cgiwrap-pacifica-3.6.4.C5.src.rpm

RaQ 2 (MIPS)
RPM:
ftp://ftp.cobaltnet.com/pub/experimental/secuirty/rpms/cgiwrap-raq2-3.6.4.C5.mips.rpm
SRPM:
ftp://ftp.cobaltnet.com/pub/experimental/secuirty/srpms/cgiwrap-raq2-3.6.4.C5.src.rpm

MD5 sum                          Package Name
--------------------------------------------------------------------------
701b43ba607edee44c684ac2d428e710 cgiwrap-pacifica-3.6.4.C5.i386.rpm
41b7277afefb199c01a212dc86dab05b cgiwrap-pacifica-3.6.4.C5.src.rpm
0484a11647a3700fa0b9afe431c55d19 cgiwrap-raq2-3.6.4.C5.mips.rpm
5f3b483c352d25b3b11d266811e8b933 cgiwrap-raq2-3.6.4.C5.src.rpm

You can verify each rpm using the following command:
rpm --checksig  [package]

To install, use the following command, while logged in as root:
rpm -U [package]

The package file format (pkg) for this fix is currently in testing, and
will be available in the very near future.

Jeff Bilicki
Software Engineer
Cobalt Networks
jeffb@cobalt.com

[[prev in list](?l=bugtraq&m=94218618329838&w=2)] [[next in list](?l=bugtraq&m=94484576107016&w=2)] [prev in thread] [[next in thread](?l=cobalt-developers&m=94219749208574&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_6e73eada_20250125_063846.html ===

```
[[prev in list](?l=bugtraq&m=94216375100538&w=2)] [[next in list](?l=bugtraq&m=94209156523059&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=94217327312861&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Security flaw in Cobalt RaQ2 cgiwrap](?t=94209982600001&r=1&w=2)
From:       [Chris Adams <cmadams () HIWAAY ! NET>](?a=94209956400003&r=1&w=2)
Date:       [1999-11-08 17:41:02](?l=bugtraq&r=1&w=2&b=199911)
[Download RAW [message](?l=bugtraq&m=94209954200450&q=mbox) or [body](?l=bugtraq&m=94209954200450&q=raw)]

There is a problem (actually several) with the "cgiwrap" program on
Cobalt RaQ2 servers.  It is supposed to run CGI programs as the proper
user instead of "nobody" to make CGIs a little more secure.

The Cobalt directory structure is as follows:

/home/sites/site1/ - top level directory of the site (site1, site2, ...)
/home/sites/site1/web - top level directory of the web site
/home/sites/site1/users/*/web - top level directory of web sites for
                                individual users (like ~user/public_html)

CGI scripts in the site /web directory should run as the user that owns
the script and the site1 group (each site has its own group).  Instead,
they run as user "nobody" group "nobody".

The bigger problem is that cgiwrap apparently interprets top level
directories of the site /web directory as users.  So if you have a CGI
in a directory like /home/sites/site1/web/test/test.cgi and attempt to
go to it at <http://www.site1.com/test/test.cgi> AND there is a user on
the system named "test", cgiwrap thinks it should run the script as user
"test".  It then actually attempts to run a script in /web directory of
the user "test".

This can be used to break other sites on a RaQ2 in several ways.  First
of all, if there is are two sites on the system, and one has CGI scripts
(say for example "submit.cgi") in a subdirectory of their site /web
directory called "scripts", the admin(s) of the second site can keep any
scripts in that directory from running by creating a user named
"scripts" (cgiwrap will give a "file not found" error).  Second (and
more serious for e-commerce type sites), if the second admin then
creates programs with the same name in the users/scripts/web directory,
they will be run when requests for the first site are made.

When someone calls <http://www.site1.com/scripts/submit.cgi>,
<http://www.site2.com/users/scripts/submit.cgi> will be run
(transparently).  First, that will break site1, but it also can lead to
private information being submitted to site1 being submitted to site2
instead.  This is the biggest security problem.

I notified Cobalt about this several weeks ago now, and they've said
they are working on it, but that is it.  They haven't released any kind
of notice or update as of yet either.
--
Chris Adams <cmadams@hiwaay.net>
Systems and Network Administrator - HiWAAY Information Services
I don't speak for anybody but myself - that's enough trouble.

[[prev in list](?l=bugtraq&m=94216375100538&w=2)] [[next in list](?l=bugtraq&m=94209156523059&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=94217327312861&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


