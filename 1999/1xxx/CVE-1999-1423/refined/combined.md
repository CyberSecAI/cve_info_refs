=== Content from marc.info_28afc89d_20250125_052001.html ===

```
[[prev in list](?l=bugtraq&m=87602248518480&w=2)] [[next in list](?l=bugtraq&m=87608204825932&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Solaris Ping Bug and other [bc] oddities
From:       [<owner-bugtraq () NETSPACE ! ORG>](?a=90366197100020&r=1&w=2)
Date:       [1997-10-05 0:26:53](?l=bugtraq&r=1&w=2&b=199710)
[Download RAW [message](?l=bugtraq&m=87602558319180&q=mbox) or [body](?l=bugtraq&m=87602558319180&q=raw)]

Greets,

Just finished reading through the 'Summary' of Solaris Ping bud (DoS)'
email and figured I would empart a bit of ?wisdom? with people.

First, let me say this isn't a slam on Dan Bell. Now that that's out of
the way.

For those thinking about following Dan Bell's <dbell@blaze.cs.jhu.edu>
lead:

>The only solution I've got (as I lack working code for ping), has
>actually
>been to use my ancient SunOS version in binary compatibility mode. It's a
>disgusting thing to do, but the old version doesn't have this bug. I've
>only applied this kludge on undergraduate machines, where I know they'll
>crash them just for the hell of it :).

Not only is is a disgusting solution but a very insecure one. This relies
upon libbc (if memory serves), which ostensibly stands for Binary
Compatibility. In fact we know this to really stand for lib Before Christ.

It's your choice should you take this route and not the others - let the
user crash the machine... or give them route through the binary
compatibility routines (buffer overflows, popen's etc. etc.). I highly
recommend people pulling binaries from SunOS machines and trussing them on
Solaris. Guranteed to cheer up even the most manic depressive.

.mudge

[[prev in list](?l=bugtraq&m=87602248518480&w=2)] [[next in list](?l=bugtraq&m=87608204825932&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_a80173fc_20250125_052000.html ===

```
[[prev in list](?l=bugtraq&m=87602558319182&w=2)] [[next in list](?l=bugtraq&m=87602558319183&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    SUMMARY: Solaris Ping bug (DoS)
From:       [Gnuchev Fedor <qwe () HT ! EIMB ! RSSI ! RU>](?a=90366197100011&r=1&w=2)
Date:       [1997-06-27 18:37:47](?l=bugtraq&r=1&w=2&b=199706)
[Download RAW [message](?l=bugtraq&m=87602558319171&q=mbox) or [body](?l=bugtraq&m=87602558319171&q=raw)]

Good morning Aleph,

I hope that following summary will stop ping discussion.
I'd just removed extra water from responces.
-------snip-snip-------
Making a summary from recieved solutions I guess prize goes to

 Mark Henderson <mch@squirrel.com>

for the reason of closing the hole that ping 'pinged':

From: Mark Henderson <mch@squirrel.com>
try
/usr/sbin/ndd -set /dev/ip ip_respond_to_echo_broadcast 0

 // should be added to /etc/init.d/inetinit to be permanent.
-----------
From: John Mizzi <jmizzi@premenos.com>
From: Frank DENIS -Jedi/Sector One- <j@donald.fr>
From: Dan Bell <dbell@blaze.cs.jhu.edu>
From: George Turner <grturner@netcom.com>
From: "Matthew R. Potter" <mpotter@intr.net>
From: Mark Henderson <mch@squirrel.com>
From: Andrew <radak@yo.fuh-q.org>
From: Joao Miguel Neves <jmne@rnl.ist.utl.pt>

other solutions:
- use wrapper
- use traceroute
- compile BSD ping
are included in no particular order:
From: John Mizzi <jmizzi@premenos.com>

Yes, I can confirm this on Solaris 2.5.1
From: Frank DENIS -Jedi/Sector One- <j@donald.fr>
> Disabling ping??! Hope someone will devise more chewable solution :-)
  Let your users use traceroute instead...
From: George Turner <grturner@netcom.com>
> Disabling ping??! Hope someone will devise more chewable solution :-)

I'm doing the following for now:

chmod 500 /usr/sin/ping
mv /usr/sbin/ping /usr/sbin/ping.bug
gcc -o ping wping.c
chmod 4555 ping
mv ping /usr/sbin

--------------------------------wping.c---------------------------
#include <stdio.h>
#include <unistd.h>
char host[[75]](#75);
main(int argc, char **argv)
{
switch (argc)
        {
        case 2:
                memset(host, '\0', sizeof(host));
                strncpy(host, argv[[1]](#1), sizeof(host)-1);
                execl("/usr/sbin/ping.bug", "ping", host, (char *)NULL);
                break;
        default:
          fprintf(stderr, "Options are currently disabled for non-root user.\n");
        }
}
From: George Turner <grturner@netcom.com>
Subject: Re: Solaris Ping bug (DoS)

Yeah, it's just stopgap, but most of my users do like to be able to ping
places and almost never use any of the ping options.

George

From: "Matthew R. Potter" <mpotter@intr.net>

What about fixing the actuall kernel code, I assume it's the multicast
stuff, or just disable it. Can u disable it on boot?

From: Mark Henderson <mch@squirrel.com>
try
/usr/sbin/ndd -set /dev/ip ip_respond_to_echo_broadcast 0
(only tested on a single 2.5.1 machine)
qwe: Well, it does closes the hole on all 2.x I could reach - 2.4, 2.5, 2.5.1

From: Dan Bell <dbell@blaze.cs.jhu.edu>

> Disabling ping??! Hope someone will devise more chewable solution :-)

The only solution I've got (as I lack working code for ping), has actually
been to use my ancient SunOS version in binary compatibility mode. It's a
disgusting thing to do, but the old version doesn't have this bug. I've
only applied this kludge on undergraduate machines, where I know they'll
crash them just for the hell of it :).

From: Andrew <radak@yo.fuh-q.org>

I took the standard AUSCERT overflow wrapper and changed line 178 from:
        if (strlen(argv[i]) > MAXARGLEN)
to:
        if (strcmp(argv[i],"-i") == 0)

And thusly wrapped ping.  I don't know if this is actually a 100% 'patch'
(someone with better knowledge of C care to comment?), but it'll at least
prevent the exploit as printed.  (I figure non-root users shouldn't need
to be able to specify interface anyway.)

-Andrew

From: Joao Miguel Neves <jmne@rnl.ist.utl.pt>

You can always do like me. I compiled the BSD ping and disabled the other.

                                                          Joao Miguel Neves
                                                           jmne@poboxes.com
-----------------------

With best regards

Fedor Gnuchev
 mailto:qwe@ht.eimb.rssi.ru

[[prev in list](?l=bugtraq&m=87602558319182&w=2)] [[next in list](?l=bugtraq&m=87602558319183&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_0fd5c711_20250125_052001.html ===

```
[[prev in list](?l=bugtraq&m=87602558319176&w=2)] [[next in list](?l=bugtraq&m=87602558319185&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Solaris Ping bug(inetsvc)
From:       ["Renteria Tabares J." <renteria () TUMI ! DGSCA ! UNAM ! MX>](?a=90366197100021&r=1&w=2)
Date:       [1997-06-27 13:54:48](?l=bugtraq&r=1&w=2&b=199706)
[Download RAW [message](?l=bugtraq&m=87602558319181&q=mbox) or [body](?l=bugtraq&m=87602558319181&q=raw)]

>
> For those with access, Sun seems to have Bug Id: 1226919 open on the issue.
>
>   1: You do not require multicast support, and
>   2: Have the opportunity to reboot your machine.
>
> Just comment out the "route add 224.0.0.0 ..." in /etc/init.d/inetsvc and
> reboot.  Even just doing the 'route delete 224.0.0.0 ...' still allowed the
> panic.

        im comment the lines and reboot the server:
#
# Add a static route for multicast packets out our default interface.
# The default interface is the interface that corresponds to the node
name.
#
#echo "Setting default interface for multicast: \c"
#/usr/sbin/route add "224.0.0.0" "`uname -n`" 0

        the problem stills remain, the server down now,
        (the server is Solaris 2.5.1), this is not the solution

        .---.       .-----------  Renteria Tabares Juan
       /     \  _  /   ------    Administracion de Servidores
      / /     \/^\/   -----      DCD - DGSCA - UNAM
     //////   '   `  ---
    //// / // : R : ---         Tel. (915) 622 80 14
   // /   /  /`   '--           Fax. (915) 622 85 57
  //DCD-DGSCA //.\\  UNAM                renteria@tumi.dgsca.unam.mx
=============UU====UU=======================================================
             '//||\\`        DIRECCION DE COMPUTO PARA LA DOCENCIA

[[prev in list](?l=bugtraq&m=87602558319176&w=2)] [[next in list](?l=bugtraq&m=87602558319185&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_e299aa89_20250125_052000.html ===

```
[[prev in list](?l=bugtraq&m=87602558319158&w=2)] [[next in list](?l=bugtraq&m=87602558319163&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=87602558319169&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Solaris Ping bug (DoS)](?t=87602899700015&r=1&w=2)
From:       [Adam Caldwell <adam () ATL ! ENI ! NET>](?a=90366197100010&r=1&w=2)
Date:       [1997-06-26 0:08:29](?l=bugtraq&r=1&w=2&b=199706)
[Download RAW [message](?l=bugtraq&m=87602558319160&q=mbox) or [body](?l=bugtraq&m=87602558319160&q=raw)]

I briefly searched the bugtraq archives and didn't see this one, so here's a
way to reboot a Solaris box, and is exploitable by anyone with an account on
the system since ping is setuid root.

ping -sv -i 127.0.0.1 224.0.0.1

On solaris 2.5, causes the machine to reboot (personal experience).  I've
had independent reports of it crashing 2.5.1, and 2.5 (x86).  It probably works
on all versions of Solaris.

To "fix" the denial of service:
chmod go-x /usr/sbin/ping
if you don't mind disabling Ping on your system.

-Adam

[[prev in list](?l=bugtraq&m=87602558319158&w=2)] [[next in list](?l=bugtraq&m=87602558319163&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=87602558319169&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


