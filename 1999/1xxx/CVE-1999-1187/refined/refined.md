- **Root cause of vulnerability**: The PINE email client creates lockfiles in `/tmp/` with predictable names based on the user and with mode 666 permissions. The lockfile name is static for each user.
- **Weaknesses/vulnerabilities present**:
    - Predictable lockfile names: The lockfile name is easily guessable and predictable.
    - Insecure permissions on lockfiles: Lockfiles are created with mode 666 permissions, allowing any user to read and write to them.
    - Lack of symbolic link checking: PINE does not check if the lockfile is a symbolic link before creating the lock, allowing an attacker to redirect the lockfile creation.
- **Impact of exploitation**: An attacker can create a symbolic link in `/tmp/` with the lockfile name pointing to a sensitive file in the victim's home directory, such as `.rhosts`. When PINE tries to create the lockfile, it will instead create a file with mode 666, overwriting the targeted sensitive file with PINE's process id as its contents. This could be used to gain unauthorized access via rlogin/rsh if the .rhosts file is abused.
- **Attack vectors**: The attacker needs local access to the system and the ability to monitor the process table to determine when a user is running PINE and has new mail.
- **Required attacker capabilities/position**:
    - Local access to the system.
    - Ability to monitor the process table (e.g., using `ps`).
    - Ability to create files and symbolic links in `/tmp/`.
    - Basic understanding of Linux file systems and permissions.