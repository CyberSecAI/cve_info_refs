=== Content from github.com_8c1d5862_20250125_130804.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbminor%2Fglibc%2Fcommit%2F2864e767053317538feafa815046fff89e5a16be)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbminor%2Fglibc%2Fcommit%2F2864e767053317538feafa815046fff89e5a16be)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=bminor%2Fglibc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bminor](/bminor)
/
**[glibc](/bminor/glibc)**
Public

* [Notifications](/login?return_to=%2Fbminor%2Fglibc) You must be signed in to change notification settings
* [Fork
  407](/login?return_to=%2Fbminor%2Fglibc)
* [Star
   1.5k](/login?return_to=%2Fbminor%2Fglibc)

* [Code](/bminor/glibc)
* [Pull requests
  0](/bminor/glibc/pulls)
* [Projects
  0](/bminor/glibc/projects)
* [Security](/bminor/glibc/security)
* [Insights](/bminor/glibc/pulse)

Additional navigation options

* [Code](/bminor/glibc)
* [Pull requests](/bminor/glibc/pulls)
* [Projects](/bminor/glibc/projects)
* [Security](/bminor/glibc/security)
* [Insights](/bminor/glibc/pulse)

## Commit

[Permalink](/bminor/glibc/commit/2864e767053317538feafa815046fff89e5a16be)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Update.

[Browse files](/bminor/glibc/tree/2864e767053317538feafa815046fff89e5a16be)
Browse the repository at this point in the history

```
1999-11-09  Ulrich Drepper  <drepper@cygnus.com>

	* elf/dl-load.c (_dl_dst_count): Allow $ORIGIN to point to
	directory with the reference since this is as secure as using the
	object with the dependency.
	(_dl_dst_substitute): Likewise.

	* elf/dl-load.c (_dl_dst_count): Change strings in first two
	strncmp calls to allow reuse.
	(_dl_dst_substitute): Likewise.

1999-11-01  Arnold D. Robbins  <arnold@skeeve.com>

	* posix/regex.c (init_syntax_once): move below definition of
	ISALNUM etc., then use ISALNUM to init the table, so that
	the word ops will work if i18n'ed.
	(SYNTAX): And subscript with 0xFF for 8bit character sets.

1999-11-09  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/getlogin_r.c (getlogin_r): Sync with getlogin
	implementation for ttyname_r call; fix inverted condition; return
	ut_user.  Closes PR libc/1438.

1999-11-09  Ulrich Drepper  <drepper@cygnus.com>

	* timezone/checktab.awk: Update from tzcode1999h.
	* timezone/africa: Update from tzdata1999i.
	* timezone/asia: Likewise.
	* timezone/australasia: Likewise.
	* timezone/backward: Likewise.
	* timezone/europe: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/southamerica: Likewise.
	* timezone/iso3166.tab: Likewise.
	* timezone/zone.tab: Likewise.

	* sysdeps/unix/sysv/linux/bits/resource.h: Define values also as
	macros.  Patch by brg@csua.berkeley.edu [PR libc/1439].

1999-11-09  Andreas Jaeger  <aj@suse.de>

	* posix/Makefile (tests): Added tst-getlogin.

	* posix/tst-getlogin.c: New file, contains simple tests for
	getlogin and getlogin_r.

1999-11-09  Andreas Schwab  <schwab@suse.de>

	* misc/syslog.c: For LOG_PERROR only append a newline if
	necessary.
```

* Loading branch information

Ulrich Drepper
committed
Nov 10, 1999

1 parent
[f2b9733](/bminor/glibc/commit/f2b9733fd6af9cd7e2aac553db4b30c96b83f66c)

commit 2864e76

 Show file tree

 Hide file tree

Showing
**19 changed files**
with
**450 additions**
and
**326 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* ChangeLog
  [ChangeLog](#diff-91c5b46dc84a94604a4e4d0caed9bf85590a2eddbb12d2e8dc80badf324a9dfb)
* elf

  + elf/dl-load.c
    [dl-load.c](#diff-70c1d4052e9de7ad76e1437a17f00b70a9ea6732a3667041ccfb8dbb0caccae4)
* manual

  + manual/search.texi
    [search.texi](#diff-20cdc4e044d65c37895f4db466c6eae7a78bade25a3c162f62b1bc5c6d5fc4aa)
* misc

  + misc/syslog.c
    [syslog.c](#diff-eae20dcebd8555bdad02097c7636d2d2320134741d25cb08d1f36583beda8086)
* posix

  + posix/Makefile
    [Makefile](#diff-0fd083393b5b25f89d961d6f429026a9c899b30e945658db92a373f91531f193)
  + posix/regex.c
    [regex.c](#diff-d5aec7c00674457b55d53321fc414c8a16b014fa8cf17d29fe028322f128d572)
  + posix/tst-getlogin.c
    [tst-getlogin.c](#diff-3501f5fe0af92d362c79ff89802e2e9492e6c7ad41cce14f038e981e241bfa9a)
* sysdeps/unix

  + sysdeps/unix/getlogin\_r.c
    [getlogin\_r.c](#diff-6e051984e174316c7c4a5e9dd2e34c9bf950f16062f9b957d69498a956632ff9)
  + sysv/linux/bits

    - sysdeps/unix/sysv/linux/bits/resource.h
      [resource.h](#diff-60d6d3153e02502141c0906c5e41884e77bc5f26d99338a720123332bd0ac2db)
* timezone

  + timezone/africa
    [africa](#diff-b7912cd112132e636fcee6acb0147824052a4eefb1a7c6c5bd5d41593df20eef)
  + timezone/asia
    [asia](#diff-ec5023ea53716bc9a0e31c6dccfa60afbcbec54179f77779cd9f7a0fe4e61fc6)
  + timezone/australasia
    [australasia](#diff-3689e83270dabf1ab9e66be2e0e22b0211d60e82758e1e525c80ef6c419e9136)
  + timezone/backward
    [backward](#diff-01fbac1b73251f07b5ef949c208646f5c7d739414511f691071b913caf0f5f2e)
  + timezone/checktab.awk
    [checktab.awk](#diff-87b4b6a403d7a2d1ec1d8d45d14712cd82821415d2032cbd866acdfe34173eec)
  + timezone/europe
    [europe](#diff-6f616a3232d3f0aa56060fdd96fa904e76e00e2a87a6f3f45870c93493ed341e)
  + timezone/iso3166.tab
    [iso3166.tab](#diff-74306c061f1b969c831b81fbe95ab54d1251434d313edef4e3b80b84b978f1a8)
  + timezone/northamerica
    [northamerica](#diff-d99433eec99291fb5814c8b9aabb427033c4c78fc2363192de190f2c9b883345)
  + timezone/southamerica
    [southamerica](#diff-9f47a0333792c6d685f91b73a59c22840b435e4d5a55c631c25824d0f5838056)
  + timezone/zone.tab
    [zone.tab](#diff-8e910a0fe21c9a782b64032d65eba2d4960156e89d4d769da33a0de163236e80)

## There are no files selected for viewing

52 changes: 52 additions & 0 deletions

52
[ChangeLog](#diff-91c5b46dc84a94604a4e4d0caed9bf85590a2eddbb12d2e8dc80badf324a9dfb "ChangeLog")

Show comments

[View file](/bminor/glibc/blob/2864e767053317538feafa815046fff89e5a16be/ChangeLog)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,55 @@ |
|  |  | 1999-11-09 Ulrich Drepper <drepper@cygnus.com> |
|  |  |  |
|  |  | \* elf/dl-load.c (\_dl\_dst\_count): Allow $ORIGIN to point to |
|  |  | directory with the reference since this is as secure as using the |
|  |  | object with the dependency. |
|  |  | (\_dl\_dst\_substitute): Likewise. |
|  |  |  |
|  |  | \* elf/dl-load.c (\_dl\_dst\_count): Change strings in first two |
|  |  | strncmp calls to allow reuse. |
|  |  | (\_dl\_dst\_substitute): Likewise. |
|  |  |  |
|  |  | 1999-11-01 Arnold D. Robbins <arnold@skeeve.com> |
|  |  |  |
|  |  | \* posix/regex.c (init\_syntax\_once): move below definition of |
|  |  | ISALNUM etc., then use ISALNUM to init the table, so that |
|  |  | the word ops will work if i18n'ed. |
|  |  | (SYNTAX): And subscript with 0xFF for 8bit character sets. |
|  |  |  |
|  |  | 1999-11-09 Andreas Jaeger <aj@suse.de> |
|  |  |  |
|  |  | \* sysdeps/unix/getlogin\_r.c (getlogin\_r): Sync with getlogin |
|  |  | implementation for ttyname\_r call; fix inverted condition; return |
|  |  | ut\_user. Closes PR libc/1438. |
|  |  |  |
|  |  | 1999-11-09 Ulrich Drepper <drepper@cygnus.com> |
|  |  |  |
|  |  | \* timezone/checktab.awk: Update from tzcode1999h. |
|  |  | \* timezone/africa: Update from tzdata1999i. |
|  |  | \* timezone/asia: Likewise. |
|  |  | \* timezone/australasia: Likewise. |
|  |  | \* timezone/backward: Likewise. |
|  |  | \* timezone/europe: Likewise. |
|  |  | \* timezone/northamerica: Likewise. |
|  |  | \* timezone/southamerica: Likewise. |
|  |  | \* timezone/iso3166.tab: Likewise. |
|  |  | \* timezone/zone.tab: Likewise. |
|  |  |  |
|  |  | \* sysdeps/unix/sysv/linux/bits/resource.h: Define values also as |
|  |  | macros. Patch by brg@csua.berkeley.edu [PR libc/1439]. |
|  |  |  |
|  |  | 1999-11-09 Andreas Jaeger <aj@suse.de> |
|  |  |  |
|  |  | \* posix/Makefile (tests): Added tst-getlogin. |
|  |  |  |
|  |  | \* posix/tst-getlogin.c: New file, contains simple tests for |
|  |  | getlogin and getlogin\_r. |
|  |  |  |
|  |  | 1999-11-09 Andreas Schwab <schwab@suse.de> |
|  |  |  |
|  |  | \* misc/syslog.c: For LOG\_PERROR only append a newline if |
|  |  | necessary. |
|  |  |  |
|  |  | 1999-11-08 Ulrich Drepper <drepper@cygnus.com> |
|  |  |  |
|  |  | \* elf/elf.h: Add STT\_REGISTER, STT\_HP\_OPAQUE, and STT\_ST\_STUB |
| Expand Down | |  |

38 changes: 28 additions & 10 deletions

38
[elf/dl-load.c](#diff-70c1d4052e9de7ad76e1437a17f00b70a9ea6732a3667041ccfb8dbb0caccae4 "elf/dl-load.c")

Show comments

[View file](/bminor/glibc/blob/2864e767053317538feafa815046fff89e5a16be/elf/dl-load.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -149,21 +149,31 @@ local\_strdup (const char \*s) |
|  |  | size\_t |
|  |  | \_dl\_dst\_count (const char \*name, int is\_path) |
|  |  | { |
|  |  | const char \*const start = name; |
|  |  | size\_t cnt = 0; |
|  |  |  |
|  |  | do |
|  |  | { |
|  |  | size\_t len = 1; |
|  |  |  |
|  |  | /\* $ORIGIN is not expanded for SUID/GUID programs. \*/ |
|  |  | if ((((!\_\_libc\_enable\_secure |
|  |  | && strncmp (&name[1], "ORIGIN", 6) == 0 && (len = 7) != 0) |
|  |  | || (strncmp (&name[1], "PLATFORM", 8) == 0 && (len = 9) != 0)) |
|  |  | /\* $ORIGIN is not expanded for SUID/GUID programs. |
|  |  |  |
|  |  | Note that it is no bug that the strings in the first two `strncmp' |
|  |  | calls are longer than the sequence which is actually tested. \*/ |
|  |  | if ((((strncmp (&name[1], "ORIGIN}", 6) == 0 |
|  |  | && (!\_\_libc\_enable\_secure |
|  |  | || ((name[7] == '\0' || (is\_path && name[7] == ':')) |
|  |  | && (name == start || (is\_path && name[-1] == ':')))) |
|  |  | && (len = 7) != 0) |
|  |  | || (strncmp (&name[1], "PLATFORM}", 8) == 0 && (len = 9) != 0)) |
|  |  | && (name[len] == '\0' || name[len] == '/' |
|  |  | || (is\_path && name[len] == ':'))) |
|  |  | || (name[1] == '{' |
|  |  | && ((!\_\_libc\_enable\_secure |
|  |  | && strncmp (&name[2], "ORIGIN}", 7) == 0 && (len = 9) != 0) |
|  |  | && ((strncmp (&name[2], "ORIGIN}", 7) == 0 |
|  |  | && (!\_\_libc\_enable\_secure |
|  |  | || ((name[9] == '\0' || (is\_path && name[9] == ':')) |
|  |  | && (name == start || (is\_path && name[-1] == ':')))) |
|  |  | && (len = 9) != 0) |
|  |  | || (strncmp (&name[2], "PLATFORM}", 9) == 0 |
|  |  | && (len = 11) != 0)))) |
|  |  | ++cnt; |
| Expand All | | @@ -180,6 +190,7 @@ char \* |
|  |  | \_dl\_dst\_substitute (struct link\_map \*l, const char \*name, char \*result, |
|  |  | int is\_path) |
|  |  | { |
|  |  | const char \*const start = name; |
|  |  | char \*last\_elem, \*wp; |
|  |  |  |
|  |  | /\* Now fill the result path. While copying over the string we keep |
| Expand All | | @@ -195,8 +206,10 @@ \_dl\_dst\_substitute (struct link\_map \*l, const char \*name, char \*result, |
|  |  | const char \*repl; |
|  |  | size\_t len; |
|  |  |  |
|  |  | if ((((strncmp (&name[1], "ORIGIN", 6) == 0 && (len = 7) != 0) |
|  |  | || (strncmp (&name[1], "PLATFORM", 8) == 0 && (len = 9) != 0)) |
|  |  | /\* Note that it is no bug that the strings in the first two `strncmp' |
|  |  | calls are longer than the sequence which is actually tested. \*/ |
|  |  | if ((((strncmp (&name[1], "ORIGIN}", 6) == 0 && (len = 7) != 0) |
|  |  | || (strncmp (&name[1], "PLATFORM}", 8) == 0 && (len = 9) != 0)) |
|  |  | && (name[len] == '\0' || name[len] == '/' |
|  |  | || (is\_path && name[len] == ':'))) |
|  |  | || (name[1] == '{' |
| Expand All | | @@ -205,7 +218,12 @@ \_dl\_dst\_substitute (struct link\_map \*l, const char \*name, char \*result, |
|  |  | && (len = 11) != 0)))) |
|  |  | { |
|  |  | repl = ((len == 7 || name[2] == 'O') |
|  |  | ? (\_\_libc\_enable\_secure ? NULL : l->l\_origin) |
|  |  | ? (\_\_libc\_enable\_secure |
|  |  | && ((name[len] != '\0' |
|  |  | && (!is\_path || name[len] != ':')) |
|  |  | || (name != start |
|  |  | && (!is\_path || name[-1] != ':'))) |
|  |  | ? NULL : l->l\_origin) |
|  |  | : \_dl\_platform); |
|  |  |  |
|  |  | if (repl != NULL && repl != (const char \*) -1) |
| Expand Down  Expand Up | | @@ -259,7 +277,7 @@ expand\_dynamic\_string\_token (struct link\_map \*l, const char \*s) |
|  |  | size\_t total; |
|  |  | char \*result; |
|  |  |  |
|  |  | /\* Determine the nubmer of DST elements. \*/ |
|  |  | /\* Determine the number of DST elements. \*/ |
|  |  | cnt = DL\_DST\_COUNT (s, 1); |
|  |  |  |
|  |  | /\* If we do not have to replace anything simply copy the string. \*/ |
| Expand Down | |  |

8 changes: 5 additions & 3 deletions

8
[manual/search.texi](#diff-20cdc4e044d65c37895f4db466c6eae7a78bade25a3c162f62b1bc5c6d5fc4aa "manual/search.texi")

Show comments

[View file](/bminor/glibc/blob/2864e767053317538feafa815046fff89e5a16be/manual/search.texi)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -475,9 +475,11 @@ elements. |
|  |  | To remove a specific element matching @var{key} from the tree |
|  |  | @code{tdelete} can be used. It locates the matching element using the |
|  |  | same method as @code{tfind}. The corresponding element is then removed |
|  |  | and the data if this tree node is returned by the function. If there is |
|  |  | no matching entry in the tree nothing can be deleted and the function |
|  |  | returns @code{NULL}. |
|  |  | and a pointer to the parent of the deleted node is returned by the |
|  |  | function. If there is no matching entry in the tree nothing can be |
|  |  | deleted and the function returns @code{NULL}. If the root of the tree |
|  |  | is deleted @code{tdelete} returns some unspecified value not equal to |
|  |  | @code{NULL}. |
|  |  | @end deftypefun |
|  |  |  |
|  |  | @comment search.h |
| Expand Down | |  |

12 changes: 8 additions & 4 deletions

12
[misc/syslog.c](#diff-eae20dcebd8555bdad02097c7636d2d2320134741d25cb08d1f36583beda8086 "misc/syslog.c")

Show comments

[View file](/bminor/glibc/blob/2864e767053317538feafa815046fff89e5a16be/misc/syslog.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -177,10 +177,14 @@ vsyslog(pri, fmt, ap) |
|  |  |  |
|  |  | v->iov\_base = buf + msgoff; |
|  |  | v->iov\_len = bufsize - msgoff; |
|  |  | ++v; |
|  |  | v->iov\_base = (char \*) "\n"; |
|  |  | v->iov\_len = 1; |
|  |  | (void)\_\_writev(STDERR\_FILENO, iov, 2); |
|  |  | /\* Append a newline if necessary. \*/ |
|  |  | if (buf[bufsize - 1] != '\n') |
|  |  | { |
|  |  | ++v; |
|  |  | v->iov\_base = (char \*) "\n"; |
|  |  | v->iov\_len = 1; |
|  |  | } |
|  |  | (void)\_\_writev(STDERR\_FILENO, iov, v - iov + 1); |
|  |  | } |
|  |  |  |
|  |  | /\* Prepare for multiple users. We have to take care: open and |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[posix/Makefile](#diff-0fd083393b5b25f89d961d6f429026a9c899b30e945658db92a373f91531f193 "posix/Makefile")

Show comments

[View file](/bminor/glibc/blob/2864e767053317538feafa815046fff89e5a16be/posix/Makefile)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -57,7 +57,7 @@ include ../Makeconfig |
|  |  |  |
|  |  | aux := init-posix environ |
|  |  | tests := tstgetopt testfnm runtests runptests \ |
|  |  | tst-preadwrite test-vfork regexbug1 |
|  |  | tst-preadwrite test-vfork regexbug1 tst-getlogin |
|  |  | ifeq (yes,$(build-shared)) |
|  |  | test-srcs := globtest |
|  |  | tests += wordexp-test |
| Expand Down | |  |

77 changes: 37 additions & 40 deletions

77
[posix/regex.c](#diff-d5aec7c00674457b55d53321fc414c8a16b014fa8cf17d29fe028322f128d572 "posix/regex.c")

Show comments

[View file](/bminor/glibc/blob/2864e767053317538feafa815046fff89e5a16be/posix/regex.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -164,46 +164,6 @@ char \*realloc (); |
|  |  | # define SWITCH\_ENUM\_CAST(x) (x) |
|  |  | # endif |
|  |  |  |
|  |  | /\* How many characters in the character set. \*/ |
|  |  | # define CHAR\_SET\_SIZE 256 |
|  |  |  |
|  |  | # ifdef SYNTAX\_TABLE |
|  |  |  |
|  |  | extern char \*re\_syntax\_table; |
|  |  |  |
|  |  | # else /\* not SYNTAX\_TABLE \*/ |
|  |  |  |
|  |  | static char re\_syntax\_table[CHAR\_SET\_SIZE]; |
|  |  |  |
|  |  | static void |
|  |  | init\_syntax\_once () |
|  |  | { |
|  |  | register int c; |
|  |  | static int done; |
|  |  |  |
|  |  | if (done) |
|  |  | return; |
|  |  |  |
|  |  | bzero (re\_syntax\_table, sizeof re\_syntax\_table); |
|  |  |  |
|  |  | for (c = 'a'; c <= 'z'; c++) |
|  |  | re\_syntax\_table[c] = Sword; |
|  |  |  |
|  |  | for (c = 'A'; c <= 'Z'; c++) |
|  |  | re\_syntax\_table[c] = Sword; |
|  |  |  |
|  |  | for (c = '0'; c <= '9'; c++) |
|  |  | re\_syntax\_table[c] = Sword; |
|  |  |  |
|  |  | re\_syntax\_table['\_'] = Sword; |
|  |  |  |
|  |  | done = 1; |
|  |  | } |
|  |  |  |
|  |  | # endif /\* not SYNTAX\_TABLE \*/ |
|  |  |  |
|  |  | # define SYNTAX(c) re\_syntax\_table[c] |
|  |  |  |
|  |  | #endif /\* not emacs \*/ |
|  |  |  |
|  |  | /\* Get the interface, including the syntax bits. \*/ |
| Expand Down  Expand Up | | @@ -276,6 +236,43 @@ init\_syntax\_once () |
|  |  | # define SIGN\_EXTEND\_CHAR(c) ((((unsigned char) (c)) ^ 128) - 128) |
|  |  | #endif |
|  |  |  |
|  |  | #ifndef emacs |
|  |  | /\* How many characters in the character set. \*/ |
|  |  | # define CHAR\_SET\_SIZE 256 |
|  |  |  |
|  |  | # ifdef SYNTAX\_TABLE |
|  |  |  |
|  |  | extern char \*re\_syntax\_table; |
|  |  |  |
|  |  | # else /\* not SYNTAX\_TABLE \*/ |
|  |  |  |
|  |  | static char re\_syntax\_table[CHAR\_SET\_SIZE]; |
|  |  |  |
|  |  | static void |
|  |  | init\_syntax\_once () |
|  |  | { |
|  |  | register int c; |
|  |  | static int done = 0; |
|  |  |  |
|  |  | if (done) |
|  |  | return; |
|  |  | bzero (re\_syntax\_table, sizeof re\_syntax\_table); |
|  |  |  |
|  |  | for (c = 0; c < CHAR\_SET\_SIZE; ++c) |
|  |  | if (ISALNUM (c)) |
|  |  | re\_syntax\_table[c] = Sword; |
|  |  |  |
|  |  | re\_syntax\_table['\_'] = Sword; |
|  |  |  |
|  |  | done = 1; |
|  |  | } |
|  |  |  |
|  |  | # endif /\* not SYNTAX\_TABLE \*/ |
|  |  |  |
|  |  | # define SYNTAX(c) re\_syntax\_table[((c) & 0xFF)] |
|  |  |  |
|  |  | #endif /\* emacs \*/ |
|  |  |  |
|  |  | /\* Should we use malloc or alloca? If REGEX\_MALLOC is not defined, we |
|  |  | use `alloca' instead of `malloc'. This is because using malloc in |
|  |  | re\_search\* or re\_match\* could cause memory leaks when C-g is used in |
| Expand Down | |  |

58 changes: 58 additions & 0 deletions

58
[posix/tst-getlogin.c](#diff-3501f5fe0af92d362c79ff89802e2e9492e6c7ad41cce14f038e981e241bfa9a "posix/tst-getlogin.c")

Show comments

[View file](/bminor/glibc/blob/2864e767053317538feafa815046fff89e5a16be/posix/tst-getlogin.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,58 @@ |
|  |  | /\* Copyright (C) 1999 Free Software Foundation, Inc. |
|  |  | This file is part of the GNU C Library. |
|  |  |  |
|  |  | The GNU C Library is free software; you can redistribute it and/or |
|  |  | modify it under the terms of the GNU Library General Public License as |
|  |  | published by the Free Software Foundation; either version 2 of the |
|  |  | License, or (at your option) any later version. |
|  |  |  |
|  |  | The GNU C Library is distributed in the hope that it will be useful, |
|  |  | but WITHOUT ANY WARRANTY; without even the implied warranty of |
|  |  | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU |
|  |  | Library General Public License for more details. |
|  |  |  |
|  |  | You should have received a copy of the GNU Library General Public |
|  |  | License along with the GNU C Library; see the file COPYING.LIB. If not, |
|  |  | write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, |
|  |  | Boston, MA 02111-1307, USA. \*/ |
|  |  |  |
|  |  | #include <unistd.h> |
|  |  | #include <stdio.h> |
|  |  | #include <string.h> |
|  |  |  |
|  |  | int |
|  |  | main (void) |
|  |  | { |
|  |  | char \*login; |
|  |  | int errors = 0; |
|  |  |  |
|  |  | login = getlogin (); |
|  |  | if (login == NULL) |
|  |  | puts ("getlogin returned NULL, no further tests"); |
|  |  | else |
|  |  | { |
|  |  | char name[1024]; |
|  |  | int ret; |
|  |  |  |
|  |  | printf ("getlogin returned: `%s'\n", login); |
|  |  |  |
|  |  | ret = getlogin\_r (name, sizeof (name)); |
|  |  | if (ret == 0) |
|  |  | { |
|  |  | printf ("getlogin\_r returned: `%s'\n", name); |
|  |  | if (strcmp (name, login) != 0) |
|  |  | { |
|  |  | puts ("Error: getlogin and getlogin\_r returned different names"); |
|  |  | ++errors; |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | printf ("Error: getlogin\_r returned: %d (%s)\n", |
|  |  | ret, strerror (ret)); |
|  |  | ++errors; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return errors != 0; |
|  |  | } |

32 changes: 16 additions & 16 deletions

32
[sysdeps/unix/getlogin\_r.c](#diff-6e051984e174316c7c4a5e9dd2e34c9bf950f16062f9b957d69498a956632ff9 "sysdeps/unix/getlogin_r.c")

Show comments

[View file](/bminor/glibc/blob/2864e767053317538feafa815046fff89e5a16be/sysdeps/unix/getlogin_r.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -40,20 +40,20 @@ getlogin\_r (name, name\_len) |
|  |  | int result = 0; |
|  |  | struct utmp \*ut, line, buffer; |
|  |  |  |
|  |  | { |
|  |  | int d = \_\_open ("/dev/tty", 0); |
|  |  | if (d < 0) |
|  |  | return errno; |
|  |  | /\* Get name of tty connected to fd 0. Return if not a tty or |
|  |  | if fd 0 isn't open. Note that a lot of documentation says that |
|  |  | getlogin() is based on the controlling terminal---what they |
|  |  | really mean is "the terminal connected to standard input". The |
|  |  | getlogin() implementation of DEC Unix, SunOS, Solaris, HP-UX all |
|  |  | return NULL if fd 0 has been closed, so this is the compatible |
|  |  | thing to do. Note that ttyname(open("/dev/tty")) on those |
|  |  | systems returns /dev/tty, so that is not a possible solution for |
|  |  | getlogin(). \*/ |
|  |  |  |
|  |  | result = \_\_ttyname\_r (d, real\_tty\_path, sizeof (tty\_pathname)); |
|  |  | (void) \_\_close (d); |
|  |  |  |
|  |  | if (result != 0) |
|  |  | { |
|  |  | \_\_set\_errno (result); |
|  |  | return result; |
|  |  | } |
|  |  | } |
|  |  | result = \_\_ttyname\_r (0, real\_tty\_path, sizeof (tty\_pathname)); |
|  |  |  |
|  |  | if (result != 0) |
|  |  | return result; |
|  |  |  |
|  |  | real\_tty\_path += 5; /\* Remove "/dev/". \*/ |
|  |  |  |
| Expand All | | @@ -69,16 +69,16 @@ getlogin\_r (name, name\_len) |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | size\_t needed = strlen (ut->ut\_line) + 1; |
|  |  | size\_t needed = strlen (ut->ut\_user) + 1; |
|  |  |  |
|  |  | if (needed < name\_len) |
|  |  | if (needed > name\_len) |
|  |  | { |
|  |  | \_\_set\_errno (ERANGE); |
|  |  | result = ERANGE; |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | memcpy (name, ut->ut\_line, needed); |
|  |  | memcpy (name, ut->ut\_user, needed); |
|  |  | result = 0; |
|  |  | } |
|  |  | } |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[sysdeps/unix/sysv/linux/bits/resource.h](#diff-60d6d3153e02502141c0906c5e41884e77bc5f26d99338a720123332bd0ac2db "sysdeps/unix/sysv/linux/bits/resource.h")

Show comments

[View file](/bminor/glibc/blob/2864e767053317538feafa815046fff89e5a16be/sysdeps/unix/sysv/linux/bits/resource.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -219,6 +219,9 @@ struct rusage |
|  |  | enum \_\_priority\_which |
|  |  | { |
|  |  | PRIO\_PROCESS = 0, /\* WHO is a process ID. \*/ |
|  |  | #define PRIO\_PROCESS PRIO\_PROCESS |
|  |  | PRIO\_PGRP = 1, /\* WHO is a process group ID. \*/ |
|  |  | #define PRIO\_PGRP PRIO\_PGRP |
|  |  | PRIO\_USER = 2 /\* WHO is a user ID. \*/ |
|  |  | #define PRIO\_USER PRIO\_USER |
|  |  | }; |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2864e76`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbminor%2Fglibc%2Fcommit%2F2864e767053317538feafa815046fff89e5a16be) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


