=== Content from marc.info_e07a14cc_20250125_012907.html ===

```
[[prev in list](?l=ntbugtraq&m=92110582505903&w=2)] [[next in list](?l=ntbugtraq&m=92110582005894&w=2)] [prev in thread] [next in thread]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    SLmail 3.2 Build 3113 (Web Administration Security Fix)
From:       [Lee Thompson <lt () seattlelab ! com>](?a=90367600600018&r=1&w=2)
Date:       [1999-03-10 20:04:00](?l=ntbugtraq&r=1&w=2&b=199903)
[Download RAW [message](?l=ntbugtraq&m=92110501504997&q=mbox) or [body](?l=ntbugtraq&m=92110501504997&q=raw)]

I have just posted SLmail 3.2 Build 3113 which contains the following fix:

(from the Release Notes)

17. Changed/Improved the Web Administration security model.

REV F - 03/10/99 - BUILD 3113

This is phase 1 of our new Web Administration model.

This fix specifically changes the logon authentication from 'any allowed NT
user with directory permissions' to 'only let the following names onto SLmail
admin' [still validated by NT].

This information is stored in HKLM\SOFTWARE\Seattle Lab\SLhttp\LogonName.
(Multiple logon IDs may be separated with a semi-colon.)    No passwords are
stored in this key.

Our next phase (in progress) is to impersonate the user during web
administration.

_
Lee Thompson                       lt@seattlelab.com
Seattle Lab Inc.           <http://www.seattlelab.com>
Product Manager

[[prev in list](?l=ntbugtraq&m=92110582505903&w=2)] [[next in list](?l=ntbugtraq&m=92110582005894&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_bd4f58a0_20250125_012836.html ===

```
[[prev in list](?l=bugtraq&m=92000897522289&w=2)] [[next in list](?l=bugtraq&m=91996469825139&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=91999015212415&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [ALERT: SLMail 3.2 (and 3.1) with the Remote Administration Service](?t=91996439200001&r=1&w=2)
From:       [mnemonix <mnemonix () GLOBALNET ! CO ! UK>](?a=90455992200001&r=1&w=2)
Date:       [1999-02-25 6:36:31](?l=bugtraq&r=1&w=2&b=199902)
[Download RAW [message](?l=bugtraq&m=91996412724720&q=mbox) or [body](?l=bugtraq&m=91996412724720&q=raw)]

Introduction
This advisory if for those running SLMail version 3.2 or 3.1 with the Remote
Administration Service enabled. Due to certain short comings of this service
any user with an account on the NT machine running SLMail can by-pass all
NTFS file system permissions to read any file on the system that hasn't
already been locked by another process (such as the
c:\winnt\system32\config\sam file). Added to this, this file can then be
read by anyone on the Internet.

Details
The Remote Administration Service in SLMail allows changes to mail services
to be performed using the HTTP protocol over TCP port 180, by default. NTLM
authentication can be enabled so that only users with an account and
corresponding password may access this service. Once authenticated however,
they do not need to be an Administrator to make changes to the mail services
and user account information. This happens because the service does not
impersonate the logged on user and every change made is performed under the
SYSTEM account.

Once authenticated they can then set a user's  Finger File (Plan - for the
UNIX people) to any arbritary file on the system. They must know the path to
the file they wish to access. Once these changes have been set they can then
"finger" the user and the file's contents are returned. This works because
the finger service, which is controlled by the slmail.exe process is running
as SYSTEM which has full control to all files on the machine by default.
Needless to say if the machine is accessible via the finger port (TCP port
79) from the Internet then anybody will be able to read this file. (In some
cases where there are non-standard alpha-numerics in the file or x00 values
or similar the returned data will be truncated.

If the Finger service, which is controlled by the slmail.exe process has
been disabled by the administrator, it can be re-enabled from the Remote
Administration web pages.

Added to this problem many variations of service denial attacks can be
launched, such as changing passwords, stopping services, overwriting files
etc etc.

Solution
Because of this Remote Administration should be DISABLED. If this is not
viable then the only way to prevent an unauthorized users (those with
accounts) is to remove the "Access this computer from the Network" user
right from the "Everybody" group and give this privilege to Administrators
only.

Cheers,
David Litchfield

[[prev in list](?l=bugtraq&m=92000897522289&w=2)] [[next in list](?l=bugtraq&m=91996469825139&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=91999015212415&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_96eb16f7_20250125_012907.html ===

```
[[prev in list](?l=ntbugtraq&m=91994672609142&w=2)] [[next in list](?l=ntbugtraq&m=91999016312422&w=2)] [[prev in thread](?l=bugtraq&m=91996412724720&w=2)] [[next in thread](?l=ntbugtraq&m=92006416928093&w=2)]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    [ALERT: SLMail 3.2 (and 3.1) with the Remote Administration Service](?t=91996439200001&r=1&w=2)
From:       [mnemonix <mnemonix () GLOBALNET ! CO ! UK>](?a=90455992200001&r=1&w=2)
Date:       [1999-02-25 6:36:31](?l=ntbugtraq&r=1&w=2&b=199902)
[Download RAW [message](?l=ntbugtraq&m=91999015212415&q=mbox) or [body](?l=ntbugtraq&m=91999015212415&q=raw)]

Introduction
This advisory if for those running SLMail version 3.2 or 3.1 with the Remote
Administration Service enabled. Due to certain short comings of this service
any user with an account on the NT machine running SLMail can by-pass all
NTFS file system permissions to read any file on the system that hasn't
already been locked by another process (such as the
c:\winnt\system32\config\sam file). Added to this, this file can then be
read by anyone on the Internet.

Details
The Remote Administration Service in SLMail allows changes to mail services
to be performed using the HTTP protocol over TCP port 180, by default. NTLM
authentication can be enabled so that only users with an account and
corresponding password may access this service. Once authenticated however,
they do not need to be an Administrator to make changes to the mail services
and user account information. This happens because the service does not
impersonate the logged on user and every change made is performed under the
SYSTEM account.

Once authenticated they can then set a user's  Finger File (Plan - for the
UNIX people) to any arbritary file on the system. They must know the path to
the file they wish to access. Once these changes have been set they can then
"finger" the user and the file's contents are returned. This works because
the finger service, which is controlled by the slmail.exe process is running
as SYSTEM which has full control to all files on the machine by default.
Needless to say if the machine is accessible via the finger port (TCP port
79) from the Internet then anybody will be able to read this file. (In some
cases where there are non-standard alpha-numerics in the file or x00 values
or similar the returned data will be truncated.

If the Finger service, which is controlled by the slmail.exe process has
been disabled by the administrator, it can be re-enabled from the Remote
Administration web pages.

Added to this problem many variations of service denial attacks can be
launched, such as changing passwords, stopping services, overwriting files
etc etc.

Solution
Because of this Remote Administration should be DISABLED. If this is not
viable then the only way to prevent an unauthorized users (those with
accounts) is to remove the "Access this computer from the Network" user
right from the "Everybody" group and give this privilege to Administrators
only.

Cheers,
David Litchfield

[[prev in list](?l=ntbugtraq&m=91994672609142&w=2)] [[next in list](?l=ntbugtraq&m=91999016312422&w=2)] [[prev in thread](?l=bugtraq&m=91996412724720&w=2)] [[next in thread](?l=ntbugtraq&m=92006416928093&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


