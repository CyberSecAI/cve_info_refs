```
Message-ID: <CAOSRhROOAg33GnudkF910gx+a3Ee=VY3Z=qKOVJ3HngwUK_0Ww@mail.gmail.com>
Date: Tue, 8 Nov 2011 08:03:45 -0500
From: Dan Rosenberg <dan.j.rosenberg@...il.com>
To: oss-security@...ts.openwall.com
Subject: CVE request: Android: vold stack buffer overflow

A local user with group "log" on Android may send a malformed message
to vold ("volume daemon"), causing a stack buffer overflow.  This has
been demonstrated to be exploitable to escalate privileges to root on
all Froyo (2.2.x) and Gingerbread (2.4.x)  devices via freeing an
arbitrary heap object and triggering a use-after-free condition [1].
It appears the bug was silently patched in Honeycomb (3.x), but note
that since Honeycomb is not open source, it does not fall within the
scope of this list.  Bug discovered and exploited by the Revolutionary
team [2].

-Dan

[1] <https://github.com/revolutionary/zergRush/blob/master/zergRush.c>
[2] <http://revolutionary.io/>
```
- **Root cause of vulnerability**: A stack buffer overflow vulnerability exists in the `vold` (volume daemon) service.
- **Weaknesses/vulnerabilities present**: The vulnerability is a stack buffer overflow. Additionally, a use-after-free condition can be triggered.
- **Impact of exploitation**: Successful exploitation leads to privilege escalation to root.
- **Attack vectors**: A local user belonging to the "log" group can exploit this vulnerability by sending a malformed message to the `vold` service.
- **Required attacker capabilities/position**: The attacker must have local access to the device and belong to the "log" group.

```
Message-ID: <CAOSRhROHk-cYEuNJ--UCN7vC3M9nCu1+egiQ4xETApW_XBkf5w@mail.gmail.com>
Date: Tue, 8 Nov 2011 08:08:35 -0500
From: Dan Rosenberg <dan.j.rosenberg@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: Android: vold stack buffer overflow

On Tue, Nov 8, 2011 at 8:03 AM, Dan Rosenberg <dan.j.rosenberg@...il.com> wrote:
> A local user with group "log" on Android may send a malformed message
> to vold ("volume daemon"), causing a stack buffer overflow.  This has
> been demonstrated to be exploitable to escalate privileges to root on
> all Froyo (2.2.x) and Gingerbread (2.4.x)  devices via freeing an
> arbitrary heap object and triggering a use-after-free condition [1].
> It appears the bug was silently patched in Honeycomb (3.x), but note
> that since Honeycomb is not open source, it does not fall within the
> scope of this list.  Bug discovered and exploited by the Revolutionary
> team [2].
>

Oops, a few minor corrections.

Typo: Gingerbread is 2.3.x.  Also, the vulnerability actually lives in
the libsysutils library, and was demonstrated to be exploitable via
vold, which makes use of the affected library function.  Sorry for the
noise.

> -Dan
>
> [1] <https://github.com/revolutionary/zergRush/blob/master/zergRush.c>
> [2] <http://revolutionary.io/>
>
```
- **Root cause of vulnerability**: A stack buffer overflow exists in the libsysutils library, which is utilized by the `vold` service.
- **Weaknesses/vulnerabilities present**: The vulnerability is a stack buffer overflow in the libsysutils library function called by `vold`, which can lead to a use-after-free condition.
- **Impact of exploitation**: Successful exploitation leads to privilege escalation to root.
- **Attack vectors**:  A local user with group "log" can send a malformed message to the `vold` daemon to trigger the vulnerable code in the libsysutils library.
- **Required attacker capabilities/position**: The attacker must have local access and belong to the "log" group.

```
Message-ID: <CAFJ0LnE0AMi4x8rSdNjp-Ja7YRap-7qUgSYUiJRFk-GKY=vL=g@mail.gmail.com>
Date: Wed, 9 Nov 2011 15:03:38 -0800
From: Nick Kralevich <nnk@...gle.com>
To: oss-security@...ts.openwall.com, kseifried@...hat.com
Cc: dan.j.rosenberg@...il.com
Subject: Re: Re: CVE request: Android: vold stack buffer overflow

Hi Kurt / Dan,

Nick Kralevich here from the Android security team.

Google is a CNA (CVE Numbering Authority), and we've already assigned
this vulnerability CVE-2011-3874. To avoid confusion, I would
appreciate it if CVE-2011-3874 would be considered the authoritative
CVE for this vulnerability, and CVE-2011-4123 should be marked as a
duplicate. More information on the vold vulnerability, including a
patch, can be found at
<http://code.google.com/p/android/issues/detail?id=21681>

For the record, Google maintains several security contact mailing
lists.  In general, you can reach Google security by e-mailing
security@...gle.com or visiting
<http://www.google.com/about/corporate/company/security.html>

For Android specific security issues, the preferred e-mail address is
security@...roid.com, or you can visit
<http://developer.android.com/resources/faq/security.html#issue>

For Chrome specific security issues, the preferred e-mail address is
security@...omium.org, or you can visit
<http://dev.chromium.org/Home/chromium-security/reporting-security-bugs>

In general, e-mailing security@...gle.com will eventually get to
Chrome or Android, although it's faster to contact the product
specific security alias first.

Because Google is a CNA, we maintain our own pool of CVEs from Mitre.
Any of the addresses above can issue CVEs for Google related
vulnerabilities.

Thanks!
-- Nick Kralevich
   Android Security Team
```
- This content confirms that CVE-2011-3874 is the correct CVE ID for this vulnerability. It also points to the location of the patch and more information.

```
# zergRush.c

/\* zergRush \* android 2.2/2.3 libsysutils root exploit use-after-free \* Copyright (c) 2011, The Revolutionary development team. \*
...
```
- This is the exploit code for CVE-2011-3874. It confirms the stack overflow and use-after-free condition. It also details that a crafted message can overwrite a function pointer to gain code execution.
- **Root cause of vulnerability**:  The vulnerability is a stack buffer overflow in a function within the libsysutils library.
- **Weaknesses/vulnerabilities present**: The code confirms a stack buffer overflow in a function within libsysutils. The vulnerability can lead to a use-after-free when a crafted message is sent to `vold`. This allows the overwrite of the `runCommand` pointer in a `FrameworkCommand` object on the heap.
- **Impact of exploitation**: Successful exploitation leads to arbitrary code execution as root.
- **Attack vectors**: A local user belonging to the "log" group can send a specially crafted message to the `vold` daemon which will overflow the buffer and allow the exploit to overwrite the function pointer to gain control of execution.
- **Required attacker capabilities/position**: The attacker must have local access and be part of the `log` group to communicate with `vold` socket.

Based on the provided content, this CVE involves a stack buffer overflow in the libsysutils library used by the vold service, which can be exploited by a local user belonging to the "log" group to achieve root privilege escalation by overwriting function pointers and triggering a use-after-free condition.