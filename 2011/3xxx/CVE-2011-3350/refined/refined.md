```
{
  "cveId": "CVE-2011-3350",
  "description": "masqmail 0.2.21 through 0.2.30 improperly calls seteuid() in src/log.c and src/masqmail.c that results in improper privilege dropping.",
  "vulnerabilityDetails": [
    {
      "rootCause": "The `seteuid()` function was misused in `src/log.c` and `src/masqmail.c`. Instead of saving the previous EUID, the code was saving the return value of `seteuid()`, which is 0 on success or -1 on failure.",
      "weaknesses": [
        "Improper privilege management due to incorrect use of `seteuid()`."
      ],
      "impact": "When masqmail writes to a log or performs operations in `src/masqmail.c` that call these functions, the effective user ID (EUID) is incorrectly reset to root, undoing the intended privilege dropping. This can lead to unexpected and potentially harmful behavior, where the process operates with root privileges when it should not.",
      "attackVectors": "The vulnerability can be triggered by any operation that involves logging in `src/log.c` or the flawed privilege dropping logic in `src/masqmail.c`, which includes regular operation of the masqmail daemon.",
      "requiredCapabilities": "No specific attacker capabilities or positions are required. The vulnerability is present in the code itself. Any user or process that invokes masqmail's logging or the affected functionality in masqmail.c can trigger it."
    }
  ],
    "affectedSoftware": [
    {
      "name": "masqmail",
      "versions": [
        "0.2.21",
        "0.2.22",
        "0.2.23",
        "0.2.24",
        "0.2.25",
        "0.2.26",
        "0.2.27",
        "0.2.28",
        "0.2.29",
        "0.2.30"
      ]
    }
  ],
  "fixedVersions": [
    {
      "name": "masqmail",
      "versions": [
        "0.2.30-1",
        "0.2.27-1.1+squeeze1"
      ]
    }
  ]
}
```