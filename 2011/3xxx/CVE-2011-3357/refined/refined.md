```
{
  "CVE-2011-3357": {
    "description": "High-Tech Bridge Security Research Lab reported an issue against MantisBT 1.2.7 whereby an attacker could include local system files via a directory traversal/local file inclusion vulnerability in bug_actiongroup_ext_page.php.\nWeb server and/or PHP and/or operating system configuration will dictate whether this vulnerability can be exploited. MantisBT will prepend \"bug_actiongroup_\" prior to the attacker-supplied path. A suffix is appended, but can be stripped off using a null character (%00). Some environments (at least nginx and php-fpm 5.3) do not allow directory traversal from a file or invalid path/file. Other environments do allow directory traversal from file names (even invalid ones), for instance: \"bug_actiongroup_page.php/../private_file\" or \"bug_actiongroup_/../private_file\".\nThis vulnerability can also allow an attacker to perform an XSS attack (no login/session required with the MantisBT attacker) if PHP is configured to display error messages. The error message from the require_once() call is not sanitised by PHP prior to displaying it to the user. Best (and therefore common) practice is to not display PHP error messages to the end user, severely limiting the applicability of this attack.",
    "root_cause": "The `bug_actiongroup_ext_page.php` file does not properly sanitize the 'action' GET parameter before using it in a `require_once` call, leading to local file inclusion.",
    "vulnerabilities": [
      "Local File Inclusion (LFI)",
      "Cross-Site Scripting (XSS)"
    ],
    "impact": "An attacker can include arbitrary local files, potentially leading to remote code execution if combined with the ability to upload malicious files. The LFI can also result in XSS if PHP error messages are displayed to the user.",
      "attack_vectors": [
        "Manipulating the 'action' GET parameter in `bug_actiongroup_ext_page.php` using directory traversal sequences and null bytes"
    ],
    "required_capabilities": "The attacker needs to be able to send HTTP requests to the vulnerable MantisBT instance.  Exploitation is dependent on the webserver and PHP configuration. The LFI vulnerability requires the use of the DISK option for storing file attachments and the ability to upload files. The XSS vulnerability requires PHP error messages to be displayed. No authentication or user login is required to exploit the vulnerability."
  }
}
```