=== Content from www.debian.org_207df417_20250125_153323.html ===


---

[[Date Prev](msg00009.html)][[Date Next](msg00011.html)]
[[Thread Prev](msg00009.html)][[Thread Next](msg00011.html)]
[[Date Index](maillist.html#00010)]
[[Thread Index](threads.html#00010)]

# [SECURITY] [DSA 2386-1] openttd security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2386-1] openttd security update
* *From*: Luk Claes <luk@debian.org>
* *Date*: Wed, 11 Jan 2012 21:57:32 +0100
* *Message-id*: <[[🔎]](/msgid-search/87ty420xfn.fsf%40mid.deneb.enyo.de) [87ty420xfn.fsf@mid.deneb.enyo.de](msg00010.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2386-1                   security@debian.org
<http://www.debian.org/security/>
January 10, 2012                       <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : openttd
Vulnerability  : several
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2011-3341 CVE-2011-3342 CVE-2011-3343

Several vulnerabilities have been discovered in openttd, a transport
business simulation game. Multiple buffer overflows and off-by-one
errors allow remote attackers to cause denial of service.

For the oldstable distribution (lenny), this problem has been fixed in
version 0.6.2-1+lenny4.

For the stable distribution (squeeze), this problem has been fixed in
version 1.0.4-4.

For the unstable distribution (sid), this problem has been fixed in
version 1.1.4-1.

We recommend that you upgrade your openttd packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iQEcBAEBAgAGBQJPDd6sAAoJEL97/wQC1SS+yJEIAJ3yq/lj8/HAcG3hD8A9Ax5K
oi5mpb69q2EggUBWy81wew3uQwen25rraNKZ1qmaxbWZfcd1AGetjT1wigVYpSuv
jufb0Z9AyLCTFxKuf+XYv7wGzWOfFT4V4Aa3Ubw56sXsQMI511vfAHh929Y4iDQJ
lUkmJM9sngvFzuBfgcXpxMwfsb1gCGSgO8PMMD1Ucyvu7P0egmTWDGeK/JrwG9df
xf63FnOAeidA+7tfC7a4TFfsMbGtppaz8SuvLPValvbS8SI4D9a1U5sVmcIodiIk
a5NSo5GIcwa5Lg7U38XSfJOBEVsheQYJsTl2/n4zV6cK8Y8+DiLfXeTZQi2HqJ0=
=qKb+
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_9045523e_20250126_095646.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenTTD%2FOpenTTD%2Fissues%2F4745)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenTTD%2FOpenTTD%2Fissues%2F4745)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=OpenTTD%2FOpenTTD)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenTTD](/OpenTTD)
/
**[OpenTTD](/OpenTTD/OpenTTD)**
Public

* [Notifications](/login?return_to=%2FOpenTTD%2FOpenTTD) You must be signed in to change notification settings
* [Fork
  930](/login?return_to=%2FOpenTTD%2FOpenTTD)
* [Star
   6.6k](/login?return_to=%2FOpenTTD%2FOpenTTD)

* [Code](/OpenTTD/OpenTTD)
* [Issues
  181](/OpenTTD/OpenTTD/issues)
* [Pull requests
  146](/OpenTTD/OpenTTD/pulls)
* [Discussions](/OpenTTD/OpenTTD/discussions)
* [Actions](/OpenTTD/OpenTTD/actions)
* [Security](/OpenTTD/OpenTTD/security)
* [Insights](/OpenTTD/OpenTTD/pulse)

Additional navigation options

* [Code](/OpenTTD/OpenTTD)
* [Issues](/OpenTTD/OpenTTD/issues)
* [Pull requests](/OpenTTD/OpenTTD/pulls)
* [Discussions](/OpenTTD/OpenTTD/discussions)
* [Actions](/OpenTTD/OpenTTD/actions)
* [Security](/OpenTTD/OpenTTD/security)
* [Insights](/OpenTTD/OpenTTD/pulse)

# Fix command handlers, and the command packet handler #4745

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Fix command handlers, and the command packet handler](#top)#4745Copy linkLabels[flysprayThis issue is imported from FlySpray (https://bugs.openttd.org/)](https://github.com/OpenTTD/OpenTTD/issues?q=state%3Aopen%20label%3A%22flyspray%22)This issue is imported from FlySpray (https://bugs.openttd.org/)[patch from FlySprayThis issue is in fact a Patch, but imported from FlySrpay](https://github.com/OpenTTD/OpenTTD/issues?q=state%3Aopen%20label%3A%22patch%20from%20FlySpray%22)This issue is in fact a Patch, but imported from FlySrpay[![@DorpsGek](https://avatars.githubusercontent.com/u/16524860?u=bc99de718bbd1eca702f44f4fba5c55a342458a8&v=4&size=80)](/DorpsGek)
## Description

[![@DorpsGek](https://avatars.githubusercontent.com/u/16524860?u=bc99de718bbd1eca702f44f4fba5c55a342458a8&v=4&size=48)](/DorpsGek)[DorpsGek](https://github.com/DorpsGek)opened [on Aug 25, 2011](https://github.com/OpenTTD/OpenTTD/issues/4745#issue-312182859)

***monoid* opened the ticket and wrote:**

> This patch fixes issues in a few command handlers:
>
> \* CMD\_SET\_AUTOREPLACE: A group not owned by the current company can be added to the current company's autoreplace lists. This doesn't have any bad consequences, but is still an oversight in verification of the command parameters.
>
> \* CMD\_INSERT\_ORDER: Conditional orders' variables and comparators have an off-by-one error in their verifications. This allows invalid orders to be inserted, leading to a NOT\_REACHED in ProcessConditionalOrder. This is definitely exploitable.
>
> \* CMD\_DEPOT\_SELL\_ALL\_VEHICLES: The sell\_command is retrieved using GetCmdSellVeh on the user-provided vehicle\_type before vehicle\_type itself is verified. No real bad consequences, but this verification should be moved to before this.
>
> It also fixes an off-by-one error in the verification of the callback parameter in command packets. This doesn't have any bad consequences, as the usage of the parameter in looking up the \_callback\_table should not be entirely out-of-bounds, nor does the value retrieved get used by the server or any clients in a exploitable fashion.

**Attachments**

* [fixcmds.diff](https://bugs.openttd.org/task/4745/getfile/7707/fixcmds.diff) (2.69 KiB)

**Reported version**: *trunk*

**Operating system**: *All*

---

###### *This issue was imported from FlySpray: <https://bugs.openttd.org/task/4745>*

## Metadata

### Assignees

No one assigned

### Labels

[flysprayThis issue is imported from FlySpray (https://bugs.openttd.org/)](https://github.com/OpenTTD/OpenTTD/issues?q=state%3Aopen%20label%3A%22flyspray%22)This issue is imported from FlySpray (https://bugs.openttd.org/)[patch from FlySprayThis issue is in fact a Patch, but imported from FlySrpay](https://github.com/OpenTTD/OpenTTD/issues?q=state%3Aopen%20label%3A%22patch%20from%20FlySpray%22)This issue is in fact a Patch, but imported from FlySrpay
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b4d3842a_20250126_095648.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenTTD%2FOpenTTD%2Fcommit%2F4836a6e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenTTD%2FOpenTTD%2Fcommit%2F4836a6e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=OpenTTD%2FOpenTTD)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenTTD](/OpenTTD)
/
**[OpenTTD](/OpenTTD/OpenTTD)**
Public

* [Notifications](/login?return_to=%2FOpenTTD%2FOpenTTD) You must be signed in to change notification settings
* [Fork
  930](/login?return_to=%2FOpenTTD%2FOpenTTD)
* [Star
   6.6k](/login?return_to=%2FOpenTTD%2FOpenTTD)

* [Code](/OpenTTD/OpenTTD)
* [Issues
  181](/OpenTTD/OpenTTD/issues)
* [Pull requests
  146](/OpenTTD/OpenTTD/pulls)
* [Discussions](/OpenTTD/OpenTTD/discussions)
* [Actions](/OpenTTD/OpenTTD/actions)
* [Security](/OpenTTD/OpenTTD/security)
* [Insights](/OpenTTD/OpenTTD/pulse)

Additional navigation options

* [Code](/OpenTTD/OpenTTD)
* [Issues](/OpenTTD/OpenTTD/issues)
* [Pull requests](/OpenTTD/OpenTTD/pulls)
* [Discussions](/OpenTTD/OpenTTD/discussions)
* [Actions](/OpenTTD/OpenTTD/actions)
* [Security](/OpenTTD/OpenTTD/security)
* [Insights](/OpenTTD/OpenTTD/pulse)

## Commit

[Permalink](/OpenTTD/OpenTTD/commit/4836a6e50e94978e2f363d586838cea2bdb9c26e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

(svn r22845) -Fix [FS#4745]: perform stricter checks on some commands…

[Browse files](/OpenTTD/OpenTTD/tree/4836a6e50e94978e2f363d586838cea2bdb9c26e)
Browse the repository at this point in the history

```
… (monoid)
```

* Loading branch information

[![@rubidium42](https://avatars.githubusercontent.com/u/13785744?s=40&v=4)](/rubidium42)

[rubidium42](/OpenTTD/OpenTTD/commits?author=rubidium42 "View all commits by rubidium42")
committed
Aug 26, 2011

1 parent
[9975f30](/OpenTTD/OpenTTD/commit/9975f30eb76025ba911323f75e06b5f7d6e2e4a5)

commit 4836a6e

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**6 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/autoreplace\_cmd.cpp
    [autoreplace\_cmd.cpp](#diff-985b44f86cc95a88e5c8407339abded8131494f725a9680cb8f7450ce76f01df)
  + network

    - src/network/network\_command.cpp
      [network\_command.cpp](#diff-3696cd1b18fb48b7b29ce38ebe3d9d956140f3613186d8a056fdbebd38d66900)
  + src/order\_cmd.cpp
    [order\_cmd.cpp](#diff-380d4603b56ad2da06966f31208648ab85be2f6729594c2b703482e3ce66ac97)
  + src/vehicle\_cmd.cpp
    [vehicle\_cmd.cpp](#diff-bc9cddc00e8fc4a5743f7aa66e0bb0cff02c4853cc203b0d4be7389d45fae795)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[src/autoreplace\_cmd.cpp](#diff-985b44f86cc95a88e5c8407339abded8131494f725a9680cb8f7450ce76f01df "src/autoreplace_cmd.cpp")

Show comments

[View file](/OpenTTD/OpenTTD/blob/4836a6e50e94978e2f363d586838cea2bdb9c26e/src/autoreplace_cmd.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -731,7 +731,7 @@ CommandCost CmdSetAutoReplace(TileIndex tile, DoCommandFlag flags, uint32 p1, ui |
|  |  | GroupID id\_g = GB(p1, 16, 16); |
|  |  | CommandCost cost; |
|  |  |  |
|  |  | if (!Group::IsValidID(id\_g) && !IsAllGroupID(id\_g) && !IsDefaultGroupID(id\_g)) return CMD\_ERROR; |
|  |  | if (Group::IsValidID(id\_g) ? Group::Get(id\_g)->owner != \_current\_company : !IsAllGroupID(id\_g) && !IsDefaultGroupID(id\_g)) return CMD\_ERROR; |
|  |  | if (!Engine::IsValidID(old\_engine\_type)) return CMD\_ERROR; |
|  |  |  |
|  |  | if (new\_engine\_type != INVALID\_ENGINE) { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/network/network\_command.cpp](#diff-3696cd1b18fb48b7b29ce38ebe3d9d956140f3613186d8a056fdbebd38d66900 "src/network/network_command.cpp")

Show comments

[View file](/OpenTTD/OpenTTD/blob/4836a6e50e94978e2f363d586838cea2bdb9c26e/src/network/network_command.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -308,7 +308,7 @@ const char \*NetworkGameSocketHandler::ReceiveCommand(Packet \*p, CommandPacket \*c |
|  |  | if (!IsValidCommand(cp->cmd)) return "invalid command"; |
|  |  | if (GetCommandFlags(cp->cmd) & CMD\_OFFLINE) return "offline only command"; |
|  |  | if ((cp->cmd & CMD\_FLAGS\_MASK) != 0) return "invalid command flag"; |
|  |  | if (callback > lengthof(\_callback\_table))  return "invalid callback"; |
|  |  | if (callback >= lengthof(\_callback\_table)) return "invalid callback"; |
|  |  |  |
|  |  | cp->callback = \_callback\_table[callback]; |
|  |  | return NULL; |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/order\_cmd.cpp](#diff-380d4603b56ad2da06966f31208648ab85be2f6729594c2b703482e3ce66ac97 "src/order_cmd.cpp")

Show comments

[View file](/OpenTTD/OpenTTD/blob/4836a6e50e94978e2f363d586838cea2bdb9c26e/src/order_cmd.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -727,10 +727,10 @@ CommandCost CmdInsertOrder(TileIndex tile, DoCommandFlag flags, uint32 p1, uint3 |
|  |  | case OT\_CONDITIONAL: { |
|  |  | VehicleOrderID skip\_to = new\_order.GetConditionSkipToOrder(); |
|  |  | if (skip\_to != 0 && skip\_to >= v->GetNumOrders()) return CMD\_ERROR; // Always allow jumping to the first (even when there is no order). |
|  |  | if (new\_order.GetConditionVariable() > OCV\_END) return CMD\_ERROR; |
|  |  | if (new\_order.GetConditionVariable() >= OCV\_END) return CMD\_ERROR; |
|  |  |  |
|  |  | OrderConditionComparator occ = new\_order.GetConditionComparator(); |
|  |  | if (occ > OCC\_END) return CMD\_ERROR; |
|  |  | if (occ >= OCC\_END) return CMD\_ERROR; |
|  |  | switch (new\_order.GetConditionVariable()) { |
|  |  | case OCV\_REQUIRES\_SERVICE: |
|  |  | if (occ != OCC\_IS\_TRUE && occ != OCC\_IS\_FALSE) return CMD\_ERROR; |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[src/vehicle\_cmd.cpp](#diff-bc9cddc00e8fc4a5743f7aa66e0bb0cff02c4853cc203b0d4be7389d45fae795 "src/vehicle_cmd.cpp")

Show comments

[View file](/OpenTTD/OpenTTD/blob/4836a6e50e94978e2f363d586838cea2bdb9c26e/src/vehicle_cmd.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -524,10 +524,11 @@ CommandCost CmdDepotSellAllVehicles(TileIndex tile, DoCommandFlag flags, uint32 |
|  |  |  |
|  |  | CommandCost cost(EXPENSES\_NEW\_VEHICLES); |
|  |  | VehicleType vehicle\_type = Extract<VehicleType, 0, 3>(p1); |
|  |  | uint sell\_command = GetCmdSellVeh(vehicle\_type); |
|  |  |  |
|  |  | if (!IsCompanyBuildableVehicleType(vehicle\_type)) return CMD\_ERROR; |
|  |  |  |
|  |  | uint sell\_command = GetCmdSellVeh(vehicle\_type); |
|  |  |  |
|  |  | /\* Get the list of vehicles in the depot \*/ |
|  |  | BuildDepotVehicleList(vehicle\_type, tile, &list, &list); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4836a6e`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenTTD%2FOpenTTD%2Fcommit%2F4836a6e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from openwall.com_989a28e0_20250125_153321.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[thread-next>]](../../../2011/09/06/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4E6144D2.4070905@icosahedron.de>
Date: Fri, 02 Sep 2011 23:04:18 +0200
From: Michael Lutz <michi+openttd@...sahedron.de>
To: oss-security@...ts.openwall.com
CC: rubidium@...nttd.org
Subject: CVE request for OpenTTD

Hello folks,

the OpenTTD team and contributors have discovered several security
vulnerabilities in OpenTTD. Please be so kind to allocate a CVE id for
each of the issues detailed below:

1.) Denial of service via improperly validated commands

In multiple places in-game commands are not properly validated that allow
remote attackers to cause a denial of service (crash) and possibly execute
arbitrary code via unspecified vectors.

Vulnerability is present since 0.3.5 and will be fixed in the upcoming
1.1.3 release. Issue report at <http://bugs.openttd.org/task/4745>

2.) Buffer overflows in savegame loading

In multiple places indices in savegames are not properly validated that
allow (remote) attackers to cause a denial of service (crash) and possibly
execute arbitrary code via unspecified vectors.

Vulnerability is present since 0.1.0 and will be fixed in the upcoming
1.1.3 release. Issue reports at <http://bugs.openttd.org/task/4717> and
<http://bugs.openttd.org/task/4748>

3.) Multiple buffer overflows in validation of external data

In multiple places external data from the local file system isn't properly
checked before allocating memory, which could lead to buffer overflows and
arbitrary code execution.

Vulnerability is present since 0.3.4 and will be fixed in the upcoming
1.1.3 release. Issue reports at <http://bugs.openttd.org/task/4746> and
<http://bugs.openttd.org/task/4747>

Once the CVE ids are allocated, each issue will be fully documented at
<http://security.openttd.org/en/CVE-2011-xxxx>

Thanks,
Michael Lutz

[Please CC me, I'm not subscribed.]

Download attachment "[signature.asc](4/1)" of type "application/pgp-signature" (261 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_8dc33d91_20250125_153321.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2011/09/02/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1401696469.859521.1315341953859.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Tue, 6 Sep 2011 16:45:53 -0400 (EDT)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: rubidium@...nttd.org, Michael Lutz <michi+openttd@...sahedron.de>,
        coley <coley@...re.org>
Subject: Re: CVE request for OpenTTD

----- Original Message -----
> Hello folks,
>
> the OpenTTD team and contributors have discovered several security
> vulnerabilities in OpenTTD. Please be so kind to allocate a CVE id for
> each of the issues detailed below:
>
> 1.) Denial of service via improperly validated commands
>
> In multiple places in-game commands are not properly validated that allow
> remote attackers to cause a denial of service (crash) and possibly
> execute arbitrary code via unspecified vectors.
>
> Vulnerability is present since 0.3.5 and will be fixed in the upcoming
> 1.1.3 release. Issue report at <http://bugs.openttd.org/task/4745>

Use CVE-2011-3341 for the above.

>
> 2.) Buffer overflows in savegame loading
>
> In multiple places indices in savegames are not properly validated that
> allow (remote) attackers to cause a denial of service (crash) and
> possibly execute arbitrary code via unspecified vectors.
>
> Vulnerability is present since 0.1.0 and will be fixed in the upcoming
> 1.1.3 release. Issue reports at <http://bugs.openttd.org/task/4717> and
> <http://bugs.openttd.org/task/4748>

Use CVE-2011-3342 for the above.

>
> 3.) Multiple buffer overflows in validation of external data
>
> In multiple places external data from the local file system isn't
> properly checked before allocating memory, which could lead to buffer
> overflows and arbitrary code execution.
>
> Vulnerability is present since 0.3.4 and will be fixed in the upcoming
> 1.1.3 release. Issue reports at <http://bugs.openttd.org/task/4746> and
> <http://bugs.openttd.org/task/4747>
>

Use CVE-2011-3343 for the above.

Thanks.

--
    JB

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.openttd.org_29844785_20250125_153322.html ===


* [Download stable (14.1)](/downloads/openttd-releases/latest.html)
* [Download testing (15.0-beta1)](/downloads/openttd-releases/testing.html)
* [Download nightly (20250125)](/downloads/openttd-nightlies/latest.html)

[![OpenTTD](/static/img/layout/openttd-logo.png)](/)

* [Security tracker](/security.html)

### CVE-2011-3341 (vulnerable 0.3.5 - fixed 1.1.3)

Short description: Denial of service via improperly validated commands

[Official CVE-2011-3341 entry at cve.mitre.org.](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3341)

Related bug reports:

* [GitHub Issue #4745](https://github.com/OpenTTD/OpenTTD/issues/4745)

Related commits:

* [4836a6e](https://github.com/OpenTTD/OpenTTD/commit/4836a6e)

Patches: (sometimes more fuzz is needed to apply them)

* [For version 1.1.0 up to including 1.1.2](/security/CVE-2011-3341/1.1.0%20-%201.1.2.patch)
* [For version 1.0.1 up to including 1.0.5](/security/CVE-2011-3341/1.0.1%20-%201.0.5.patch)
* [For version 1.0.0 up to including 1.0.0](/security/CVE-2011-3341/1.0.0%20-%201.0.0.patch)
* [For version 0.7.0 up to including 0.7.5](/security/CVE-2011-3341/0.7.0%20-%200.7.5.patch)
* [For version 0.6.0 up to including 0.6.3](/security/CVE-2011-3341/0.6.0%20-%200.6.3.patch)
* [For version 0.3.5 up to including 0.5.3](/security/CVE-2011-3341/0.3.5%20-%200.5.3.patch)

In multiple places in-game commands are not properly validated that allow remote
attackers to cause a denial of service (crash) and possibly execute arbitrary
code via unspecified vectors.

The bug is exploitable only in-game so the attacker must have access to the
server: his IP must not be banned, he must know the password if it has been set
and the server must not be full.

The major cause of these bugs are off-by-one errors in the validation of the
sent commands from the clients to the server, and from the server to the client.
One could therefore, in theory, affect both the server and the clients of that
server.

Two of the cases (since 0.7.0) are known to make the game state invalid, which
causes an eventual crash of the application via an “abort()”. Two cases cause a
read beyond the boundaries of a (static) table (resp. since 0.3.5 and 1.0.0).
The last case allows changes to the game state of others that might trigger
invalid reads for other players if they had the autoreplace window opened (since
0.6.0).

* [Privacy Policy](/policy.html)
* [Content Creation Guidelines](/content-creators.html)
* [Contact](/contact.html)

Copyright © 2005-2025 OpenTTD Team



=== Content from bugs.openttd.org_f40f7445_20250125_153314.html ===
Index: src/autoreplace\_cmd.cpp
===================================================================
--- src/autoreplace\_cmd.cpp (revision 22836)
+++ src/autoreplace\_cmd.cpp (working copy)
@@ -731,7 +731,7 @@
GroupID id\_g = GB(p1, 16, 16);
CommandCost cost;
- if (!Group::IsValidID(id\_g) && !IsAllGroupID(id\_g) && !IsDefaultGroupID(id\_g)) return CMD\_ERROR;
+ if (Group::IsValidID(id\_g) ? Group::Get(id\_g)->owner != \_current\_company : !IsAllGroupID(id\_g) && !IsDefaultGroupID(id\_g)) return CMD\_ERROR;
if (!Engine::IsValidID(old\_engine\_type)) return CMD\_ERROR;
if (new\_engine\_type != INVALID\_ENGINE) {
Index: src/network/network\_command.cpp
===================================================================
--- src/network/network\_command.cpp (revision 22836)
+++ src/network/network\_command.cpp (working copy)
@@ -308,7 +308,7 @@
if (!IsValidCommand(cp->cmd)) return "invalid command";
if (GetCommandFlags(cp->cmd) & CMD\_OFFLINE) return "offline only command";
if ((cp->cmd & CMD\_FLAGS\_MASK) != 0) return "invalid command flag";
- if (callback > lengthof(\_callback\_table)) return "invalid callback";
+ if (callback >= lengthof(\_callback\_table)) return "invalid callback";
cp->callback = \_callback\_table[callback];
return NULL;
Index: src/order\_cmd.cpp
===================================================================
--- src/order\_cmd.cpp (revision 22836)
+++ src/order\_cmd.cpp (working copy)
@@ -727,10 +727,10 @@
case OT\_CONDITIONAL: {
VehicleOrderID skip\_to = new\_order.GetConditionSkipToOrder();
if (skip\_to != 0 && skip\_to >= v->GetNumOrders()) return CMD\_ERROR; // Always allow jumping to the first (even when there is no order).
- if (new\_order.GetConditionVariable() > OCV\_END) return CMD\_ERROR;
+ if (new\_order.GetConditionVariable() >= OCV\_END) return CMD\_ERROR;
OrderConditionComparator occ = new\_order.GetConditionComparator();
- if (occ > OCC\_END) return CMD\_ERROR;
+ if (occ >= OCC\_END) return CMD\_ERROR;
switch (new\_order.GetConditionVariable()) {
case OCV\_REQUIRES\_SERVICE:
if (occ != OCC\_IS\_TRUE && occ != OCC\_IS\_FALSE) return CMD\_ERROR;
Index: src/vehicle\_cmd.cpp
===================================================================
--- src/vehicle\_cmd.cpp (revision 22836)
+++ src/vehicle\_cmd.cpp (working copy)
@@ -524,10 +524,11 @@
CommandCost cost(EXPENSES\_NEW\_VEHICLES);
VehicleType vehicle\_type = Extract(p1);
- uint sell\_command = GetCmdSellVeh(vehicle\_type);
if (!IsCompanyBuildableVehicleType(vehicle\_type)) return CMD\_ERROR;
+ uint sell\_command = GetCmdSellVeh(vehicle\_type);
+
/\* Get the list of vehicles in the depot \*/
BuildDepotVehicleList(vehicle\_type, tile, &list, &list);


=== Content from bugs.openttd.org_bf29da2b_20250125_153311.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenTTD%2FOpenTTD%2Fissues%2F4745)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenTTD%2FOpenTTD%2Fissues%2F4745)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=OpenTTD%2FOpenTTD)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenTTD](/OpenTTD)
/
**[OpenTTD](/OpenTTD/OpenTTD)**
Public

* [Notifications](/login?return_to=%2FOpenTTD%2FOpenTTD) You must be signed in to change notification settings
* [Fork
  930](/login?return_to=%2FOpenTTD%2FOpenTTD)
* [Star
   6.6k](/login?return_to=%2FOpenTTD%2FOpenTTD)

* [Code](/OpenTTD/OpenTTD)
* [Issues
  181](/OpenTTD/OpenTTD/issues)
* [Pull requests
  145](/OpenTTD/OpenTTD/pulls)
* [Discussions](/OpenTTD/OpenTTD/discussions)
* [Actions](/OpenTTD/OpenTTD/actions)
* [Security](/OpenTTD/OpenTTD/security)
* [Insights](/OpenTTD/OpenTTD/pulse)

Additional navigation options

* [Code](/OpenTTD/OpenTTD)
* [Issues](/OpenTTD/OpenTTD/issues)
* [Pull requests](/OpenTTD/OpenTTD/pulls)
* [Discussions](/OpenTTD/OpenTTD/discussions)
* [Actions](/OpenTTD/OpenTTD/actions)
* [Security](/OpenTTD/OpenTTD/security)
* [Insights](/OpenTTD/OpenTTD/pulse)

# Fix command handlers, and the command packet handler #4745

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Fix command handlers, and the command packet handler](#top)#4745Copy linkLabels[flysprayThis issue is imported from FlySpray (https://bugs.openttd.org/)](https://github.com/OpenTTD/OpenTTD/issues?q=state%3Aopen%20label%3A%22flyspray%22)This issue is imported from FlySpray (https://bugs.openttd.org/)[patch from FlySprayThis issue is in fact a Patch, but imported from FlySrpay](https://github.com/OpenTTD/OpenTTD/issues?q=state%3Aopen%20label%3A%22patch%20from%20FlySpray%22)This issue is in fact a Patch, but imported from FlySrpay[![@DorpsGek](https://avatars.githubusercontent.com/u/16524860?u=bc99de718bbd1eca702f44f4fba5c55a342458a8&v=4&size=80)](/DorpsGek)
## Description

[![@DorpsGek](https://avatars.githubusercontent.com/u/16524860?u=bc99de718bbd1eca702f44f4fba5c55a342458a8&v=4&size=48)](/DorpsGek)[DorpsGek](https://github.com/DorpsGek)opened [on Aug 25, 2011](https://github.com/OpenTTD/OpenTTD/issues/4745#issue-312182859)

***monoid* opened the ticket and wrote:**

> This patch fixes issues in a few command handlers:
>
> \* CMD\_SET\_AUTOREPLACE: A group not owned by the current company can be added to the current company's autoreplace lists. This doesn't have any bad consequences, but is still an oversight in verification of the command parameters.
>
> \* CMD\_INSERT\_ORDER: Conditional orders' variables and comparators have an off-by-one error in their verifications. This allows invalid orders to be inserted, leading to a NOT\_REACHED in ProcessConditionalOrder. This is definitely exploitable.
>
> \* CMD\_DEPOT\_SELL\_ALL\_VEHICLES: The sell\_command is retrieved using GetCmdSellVeh on the user-provided vehicle\_type before vehicle\_type itself is verified. No real bad consequences, but this verification should be moved to before this.
>
> It also fixes an off-by-one error in the verification of the callback parameter in command packets. This doesn't have any bad consequences, as the usage of the parameter in looking up the \_callback\_table should not be entirely out-of-bounds, nor does the value retrieved get used by the server or any clients in a exploitable fashion.

**Attachments**

* [fixcmds.diff](https://bugs.openttd.org/task/4745/getfile/7707/fixcmds.diff) (2.69 KiB)

**Reported version**: *trunk*

**Operating system**: *All*

---

###### *This issue was imported from FlySpray: <https://bugs.openttd.org/task/4745>*

## Metadata

### Assignees

No one assigned

### Labels

[flysprayThis issue is imported from FlySpray (https://bugs.openttd.org/)](https://github.com/OpenTTD/OpenTTD/issues?q=state%3Aopen%20label%3A%22flyspray%22)This issue is imported from FlySpray (https://bugs.openttd.org/)[patch from FlySprayThis issue is in fact a Patch, but imported from FlySrpay](https://github.com/OpenTTD/OpenTTD/issues?q=state%3Aopen%20label%3A%22patch%20from%20FlySpray%22)This issue is in fact a Patch, but imported from FlySrpay
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


