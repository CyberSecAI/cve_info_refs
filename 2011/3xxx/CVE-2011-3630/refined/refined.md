```
{
  "cve": "CVE-2011-3630",
  "description": "Multiple stack-based buffer overflow flaws were found in the way hardlink, the tool for consolidation of duplicate files via hardlinks, processed directory trees with deeply nested directories. A remote attacker could provide a specially-crafted directory tree, and trick the local user into consolidating it, leading to hardlink executable crash, or, potentially arbitrary code execution with the privileges of the user running the hardlink executable.",
  "affected_components": [
    "hardlink"
  ],
  "root_cause": "The vulnerability is caused by fixed-size buffers (nambuf1 and nambuf2) used when processing directory trees with deeply nested directories and long file/directory names. The `strcat` function used to build the full path of the files and directories does not perform any bounds check leading to buffer overflows.",
  "vulnerabilities": [
    "Stack-based buffer overflow",
    "BSS-buffer overflow"
  ],
  "impact": "A remote attacker can provide a specially crafted directory tree, tricking a local user into consolidating it, which leads to a crash of the `hardlink` executable and potentially arbitrary code execution with the privileges of the user running the `hardlink` executable.",
  "attack_vector": "The attack vector is network-based, where a remote attacker provides a specially crafted directory tree.",
  "attacker_capabilities": "The attacker requires the ability to create a directory tree and the ability to trick a local user into running the `hardlink` tool on it.",
  "notes": "The overflow is detected by GCC's Object Size Checking Builtins, specifically `__builtin___strcat_chk`. The overflow is in the BSS buffer. Additionally, the `lstat()` system call may fail with `ENAMETOOLONG` after the overflow occurs, which can lead to an application crash. In Red Hat Enterprise Linux 5 and 6, `FORTIFY_SOURCE` protection, along with the kernel's ability to return an error when an exceedingly long path is passed to `lstat()`, limits the impact to just an application crash, but other systems might be vulnerable to code execution."
}
```