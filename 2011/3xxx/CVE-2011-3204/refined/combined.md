=== Content from launchpad.net_e2c31d4b_20250124_161655.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/hammerhead/%2Bbug/826679/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[hammerhead package](https://launchpad.net/ubuntu/%2Bsource/hammerhead)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/hammerhead)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/hammerhead)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/hammerhead)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/hammerhead)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/hammerhead)

# insecure temporary file use

Bug #826679 reported by
[David](https://launchpad.net/~d--)
on 2011-08-15

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [hammerhead (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/hammerhead "No current release for this source package in Ubuntu") | Won't Fix | Low | Unassigned |  |

### Bug Description

hammerhead blindly writes to to /tmp/hammer.log without prior checks. It is possible to put a symbolic link at /tmp/hammer.log pointing at another file - that hammerhead will then end up appending data into.

(it appears that hammerhead uses the file location as specified in /etc/hammerhead/hh.conf - which in debian/ubuntu is /tmp/hammer.log).

See [original description](comments/0)

## CVE References

* [2011-3204](/bugs/cve/2011-3204 "hammerhead.cc in Hammerhead 2.1.4 all...")

[David (d--)](https://launchpad.net/~d--)
on 2011-08-15

| **description**: | updated |
| --- | --- |

[Jamie Strandboge (jdstrand)](https://launchpad.net/~jdstrand)
on 2011-08-26

| **visibility**: | private → public |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jamie Strandboge (jdstrand)](https://launchpad.net/~jdstrand) wrote on 2011-08-26: |  |  | [#1](/ubuntu/%2Bsource/hammerhead/%2Bbug/826679/comments/1) |
| --- | --- | --- | --- |

Thanks for taking the time to report this bug and helping to make Ubuntu better. Since the package referred to in this bug is in universe or multiverse, it is community maintained. If you are able, I suggest posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: <https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures>

Thanks for taking the time to report this bug and helping to make Ubuntu better. Since the package referred to in this bug is in universe or multiverse, it is community maintained. If you are able, I suggest posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures

| Changed in hammerhead (Ubuntu): | |
| --- | --- |
| **importance**: | Undecided → Low |
| **status**: | New → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jamie Strandboge (jdstrand)](https://launchpad.net/~jdstrand) wrote on 2011-08-26: |  |  | [#2](/ubuntu/%2Bsource/hammerhead/%2Bbug/826679/comments/2) |
| --- | --- | --- | --- |

I have sent an email to upstream and CC'd <email address hidden> regarding this issue.

I have sent an email to upstream and CC'd oss-security@lists.openwall.com regarding this issue.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jamie Strandboge (jdstrand)](https://launchpad.net/~jdstrand) wrote on 2011-08-31: |  |  | [#3](/ubuntu/%2Bsource/hammerhead/%2Bbug/826679/comments/3) |
| --- | --- | --- | --- |

This was brought up in <http://www.openwall.com/lists/oss-security/2011/08/26/9>.

This was brought up in http://www.openwall.com/lists/oss-security/2011/08/26/9.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Colin Watson (cjwatson)](https://launchpad.net/~cjwatson) wrote on 2012-04-23: |  |  | [#4](/ubuntu/%2Bsource/hammerhead/%2Bbug/826679/comments/4) |
| --- | --- | --- | --- |

I've removed this from the archive, following a Debian removal due to this security bug.

2012-04-23 10:49:49 INFO Creating lockfile: /var/lock/launchpad-lp-remove-package.lock

2012-04-23 10:49:58 INFO Removing candidates:

2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise

2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise amd64

2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise armel

2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise armhf

2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise i386

2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise powerpc

2012-04-23 10:49:58 INFO Removed-by: Colin Watson

2012-04-23 10:49:58 INFO Comment: (From Debian) RoQA; unfixed security bug, unmaintained; Debian [bug #664552](/bugs/664552)

2012-04-23 10:49:59 INFO 6 packages successfully removed.

Confirm this transaction? [yes, no] yes

2012-04-23 10:50:29 INFO Transaction committed.

2012-04-23 10:50:29 INFO The archive will be updated in the next publishing cycle.

I've removed this from the archive, following a Debian removal due to this security bug.
2012-04-23 10:49:49 INFO Creating lockfile: /var/lock/launchpad-lp-remove-package.lock
2012-04-23 10:49:58 INFO Removing candidates:
2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise
2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise amd64
2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise armel
2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise armhf
2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise i386
2012-04-23 10:49:58 INFO hammerhead 2.1.3-9.2 in precise powerpc
2012-04-23 10:49:58 INFO Removed-by: Colin Watson
2012-04-23 10:49:58 INFO Comment: (From Debian) RoQA; unfixed security bug, unmaintained; Debian bug #664552
2012-04-23 10:49:59 INFO 6 packages successfully removed.
Confirm this transaction? [yes, no] yes
2012-04-23 10:50:29 INFO Transaction committed.
2012-04-23 10:50:29 INFO The archive will be updated in the next publishing cycle.

| Changed in hammerhead (Ubuntu): | |
| --- | --- |
| **status**: | Triaged → Won't Fix |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/hammerhead/%2Bbug/826679/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/hammerhead/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/hammerhead/%2Bbug/826679/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/hammerhead/%2Bbug/826679/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/hammerhead/%2Bbug/826679/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.openwall.com_77bce197_20250124_161654.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2011/08/26/9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1260331906.531698.1314732529761.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Tue, 30 Aug 2011 15:28:49 -0400 (EDT)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: security@...ntu.com, geoff@...ttered.org, dwyer@...lab.ee.mu.oz.au,
        jgifford@...ksmart.net, coley <coley@...re.org>
Subject: Re: Security issue in hammerhead

Please use CVE-2011-3204 for this.

Thanks.

--
    JB

----- Original Message -----
> A security bug was reported against hammerhead in Ubuntu. You are
> being
> emailed as the upstream contact. Please keep
> oss-security@...ts.openwall.com[1] CC'd for any updates on this issue.
>
> This issue should be considered public and has not yet been assigned a
> CVE.
>
> Details from the public bug follow:
> <https://launchpad.net/bugs/826679>
>
> ----
> From the reporter:
>
> "hammerhead blindly writes to to /tmp/hammer.log without prior checks.
> It is possible to put a symbolic link at /tmp/hammer.log pointing at
> another file - that hammerhead will then end up appending data into.
> (it appears that hammerhead uses the file location as specified
> in /etc/hammerhead/hh.conf - which in debian/ubuntu
> is /tmp/hammer.log)."
> ----
>
> A quick check shows that HH_LOG and REPORT_LOG are indeed being
> unconditionally opened with 'fopen(..., "a+")' in src/hammerhead.cc.
>
> Thanks in advance for your cooperation in coordinating a fix for this
> issue,
>
> Jamie Strandboge
>
> [1] oss-security@...ts.openwall.com is a public mailing list for
> people to collaborate on security vulnerabilities and coordinate
> security updates.
>
> PS - I couldn't find a security contact for hammerhead, so emailed to
> those I could find in AUTHORS.
>
> --
> Jamie Strandboge | <http://www.canonical.com>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_5416e708_20250124_161654.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](../../../2011/08/29/1) [[thread-next>]](../../../2011/08/30/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1314389676.10232.22.camel@localhost>
Date: Fri, 26 Aug 2011 15:14:33 -0500
From: Jamie Strandboge <jamie@...onical.com>
To: geoff@...ttered.org, dwyer@...lab.ee.mu.oz.au, jgifford@...ksmart.net
Cc: oss-security@...ts.openwall.com, security@...ntu.com
Subject: Security issue in hammerhead

A security bug was reported against hammerhead in Ubuntu. You are being
emailed as the upstream contact. Please keep
oss-security@...ts.openwall.com[1] CC'd for any updates on this issue.

This issue should be considered public and has not yet been assigned a CVE.

Details from the public bug follow:
<https://launchpad.net/bugs/826679>

----
From the reporter:

"hammerhead blindly writes to to /tmp/hammer.log without prior checks.
It is possible to put a symbolic link at /tmp/hammer.log pointing at
another file - that hammerhead will then end up appending data into.
(it appears that hammerhead uses the file location as specified
in /etc/hammerhead/hh.conf - which in debian/ubuntu
is /tmp/hammer.log)."
----

A quick check shows that HH_LOG and REPORT_LOG are indeed being
unconditionally opened with 'fopen(..., "a+")' in src/hammerhead.cc.

Thanks in advance for your cooperation in coordinating a fix for this
issue,

Jamie Strandboge

[1] oss-security@...ts.openwall.com is a public mailing list for
    people to collaborate on security vulnerabilities and coordinate
    security updates.

PS - I couldn't find a security contact for hammerhead, so emailed to
those I could find in AUTHORS.

--
Jamie Strandboge             | <http://www.canonical.com>

Download attachment "[signature.asc](9/1)" of type "application/pgp-signature" (837 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


