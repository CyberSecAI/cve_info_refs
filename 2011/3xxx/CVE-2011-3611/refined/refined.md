```
Message-ID: <3cd7f49e-5ae6-4b39-acfc-84d6f830791a@zmail01.collab.prod.int.phx2.redhat.com>
Date: Mon, 10 Oct 2011 14:26:13 -0400 (EDT)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: CSRF and file inclusion in usebb before 1.0.12

----- Original Message -----
> <http://www.usebb.net/community/topic-2571.html>
>
> Vulnerability "HTB22914: Local File Inclusion in UseBB"
>
> Recently, High-Tech Bridge SA discovered a possible issue in UseBB 1.0.11
> and earlier. The issue exists in the fact that admin.php may possibly
> include PHP files not used for the UseBB admin control panel (ACP).
>
> The faulty code in question is only executed for logged in administrator
> accounts, and can only include non-relevant PHP files if a directory
> "sources/admin_" exists, which is not the case in UseBB 1.  Therefore,
> the issue does not pose a direct threat to an existing UseBB set-up, but
> is classified a security issue anyway and has been fixed in UseBB 1.0.12.

Use CVE-2011-3611 for the above.

>
> Vulnerability "HTB22913: Multiple CSRF (Cross-Site Request Forgery) in
> UseBB"
>
> High-Tech Bridge SA also discovered possibilities of executing CSRF
> attacks in UseBB 1.0.11 and earlier. This way, when a user is given a
> malicious URL or visits a web page containing such URL or JavaScript,
> requests may be executed that add, edit or delete data on the forum,
> including topics, posts, account information and settings in the ACP (if
> the user has logged in into the ACP).
>
> As a solution, UseBB 1.0.12 has implemented URL and form tokens for
> sensitive actions. Accessing or executing above URLs or scripts now
> doesn't have an effect on the data.
>

Use CVE-2011-3612 for the above.

Thanks.

--
    JB
```

```
| **Advisory ID:** | HTB22913 |
| --- | --- |
| **Product:** | UseBB |
| **Vendor:** | UseBB |
| **Vulnerable Versions:** | 1.0.11 and Probably Prior Versions |
| **Tested Version:** | 1.0.11 |
| **Advisory Publication:** | March 22, 2011 [without technical details] |
| **Vendor Notification:** | March 22, 2011 |
| **Public Disclosure:** | April 5, 2011 |
| **Latest Update:** | April 14, 2011 |
| **Vulnerability Type:** | [Cross-Site Request Forgery [CWE-352]](/vulnerability/cross-site-request-forgery.html) [PHP File Inclusion [CWE-98]](/vulnerability/php-file-inclusion.html) |
| **Risk Level:** | High |
|  |  |
| **CVSSv2 Base Scores:** | 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P) 7.1 (AV:N/AC:H/Au:S/C:C/I:C/A:C) |
| **Solution Status:** | Fixed by Vendor |
| **Discovered and Provided:** | High-Tech Bridge Security Research Lab |
| **Advisory Details:** | |
| High-Tech Bridge SA Security Research Lab has discovered multiple vulnerabilities in UseBB which could be exploited to perform cross-site request forgery attacks. | |
| How to Detect Cross-Site Request Forgery Vulnerabilities   Website Security Test  * GDPR & PCI DSS Test * Website CMS Security Test * CSP & HTTP Headers Check * WordPress & Drupal Scanning  [Try For Free](/websec/)      **Solution:** | |
| Upgrade to UseBB 1.0.12. | |
|  | |
```
Based on the provided information, here's an analysis of CVE-2011-3611:

**Root Cause of Vulnerability:**
The vulnerability is due to a flaw in `admin.php` which may include arbitrary PHP files. The vulnerable code is executed only for logged-in administrator accounts. The vulnerability can be triggered if a directory named `sources/admin_` exists which is not the case in default UseBB 1.x setup.

**Weaknesses/Vulnerabilities Present:**
- Local File Inclusion (LFI): The `admin.php` script is vulnerable to LFI, allowing the inclusion of PHP files outside the intended scope if the specific directory exists.

**Impact of Exploitation:**
- The primary impact of exploiting the LFI vulnerability could lead to arbitrary code execution if the attacker could create the `sources/admin_` directory containing malicious php files. The exploit is only possible if the directory exists, which is not the default setup.

**Attack Vectors:**
- The attack vector involves a logged-in administrator triggering the vulnerable code in `admin.php`, which allows for local file inclusion.

**Required Attacker Capabilities/Position:**
- The attacker must be a logged-in administrator on the UseBB forum.
- The attacker requires the `sources/admin_` directory to exist.

**Additional Details:**
- The vulnerability was discovered by High-Tech Bridge SA.
- The vulnerability was fixed in UseBB version 1.0.12.
- The vulnerability is classified as a security issue despite not posing a direct threat to a default UseBB setup.
- CVSSv2 base score for this vulnerability is 7.1 (AV:N/AC:H/Au:S/C:C/I:C/A:C) when triggered as administrator

The advisory from Immuniweb lists this as part of a set of multiple vulnerabilities (HTB22913), one being the LFI. It also mentions that the LFI is classified under CWE-98.