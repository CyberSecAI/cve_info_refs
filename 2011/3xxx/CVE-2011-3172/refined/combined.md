=== Content from build.opensuse.org_7723c4e3_20250125_152725.html ===

[![](https://build.opensuse.org/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBCZz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--aa5cb6f11b842d915c34968e0a4de823d259dcc0/openSUSEBuildService.png)](/)

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

Log In

[![](/assets/favicon-eb1d8ba2a269175c910cae3ae95a5d0dca90274b90db45c8efe0988ec9efd85d.svg)](/)Log In

---

or

[Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")

* Collapse sidebar

1. Request 80346

##### Overview

### Request 80346 accepted

- unix2\_chkpwd should call pam\_acct\_mgmt (bnc#707645, CVE-2011-3172)

- unix2\_chkpwd should only sleep 5 sec on failed logins

- add compat mode options to deal with crypt\_blowfish signedness bug

 (bnc#700876)

- use crypt\_gensalt\_rn from glibc instead of built-in code

* Created by
  [mcalmer](/users/mcalmer)
  over 13 years ago
* In state
  [accepted](/request/show/80346#request-history)

* [Submit pam-modules](#Submit_pam-modules64108)

Loading...

* [Comments for request 80346
  0](#comments)

*No comments available*

##### Request History

![Michael Calmer's avatar](https://www.gravatar.com/avatar/30da36b5da3d1d0a1586630fb52d8e3c?s=38&d=robohash "Michael Calmer")

[mcalmer](/users/mcalmer)
created request
[over 13 years ago](#request-creation "2011-08-31 12:04 UTC")

- unix2\_chkpwd should call pam\_acct\_mgmt (bnc#707645, CVE-2011-3172)

- unix2\_chkpwd should only sleep 5 sec on failed logins

- add compat mode options to deal with crypt\_blowfish signedness bug

 (bnc#700876)

- use crypt\_gensalt\_rn from glibc instead of built-in code

---

![Stephan Kulow's avatar](https://www.gravatar.com/avatar/18139e5a547ef2ffb3d017f8f8d9713a?s=38&d=robohash "Stephan Kulow")

[coolo](/users/coolo)
approved review
[over 13 years ago](#status-history-553897 "2011-08-31 12:04 UTC")

Builds for repo openSUSE\_Factory

Output of check script (non-fatal):

 - package has baselibs.conf: (unchanged)

 - package has get\_version\_number.sh: (unchanged)

---

![Sascha Peilicke's avatar](https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=38&d=robohash "Sascha Peilicke")

[saschpe](/users/saschpe)
accepted request
[over 13 years ago](#status-history-80146 "2011-09-01 15:34 UTC")

Accepted submit request 80346 from user coolo

---

![Saul Goodman's avatar](https://www.gravatar.com/avatar/ffc053e2eedefdebcd8cbbc514d9dc11?s=38&d=robohash "Saul Goodman")

[licensedigger](/users/licensedigger)
accepted review
[about 12 years ago](#status-history-334173 "2012-11-08 11:32 UTC")

{"approve": "license and version number unchanged: 11.5"}

---

![Stephan Kulow's avatar](https://www.gravatar.com/avatar/18139e5a547ef2ffb3d017f8f8d9713a?s=38&d=robohash "Stephan Kulow")

[coolo](/users/coolo)
accepted review
[about 12 years ago](#status-history-334174 "2012-11-08 11:32 UTC")

Builds for repo openSUSE\_Factory

Output of check script (non-fatal):

 - package has baselibs.conf: (unchanged)

 - package has get\_version\_number.sh: (unchanged)

##### Package Maintainers

OK

**Locations**

* [Projects](/project)
* [Search](/search)
* [Status Monitor](/monitor)

**Help**

* [OpenBuildService.org](https://openbuildservice.org/)
* [Documentation](https://openbuildservice.org/help/manuals/)
* [API Documentation](/apidocs/index)
* [Code of Conduct](/code_of_conduct)

**Contact**

* [Support](https://openbuildservice.org/support/)
* [@OBShq](https://fosstodon.org/%40obshq)
* [Terms](https://en.opensuse.org/Terms_of_site)

openSUSE Build Service is sponsored by
[![](/assets/icons/sponsor_suse-92006bbd693f5f675ccab53afe3e9c858aada01882b490fa784d8cc8a9f4f080.png)](http://www.suse.com "Enterprise Linux you can rely on.")

[![](/assets/icons/sponsor_amd-5ec958d97e60089cad23346048c0b79d2144408deda3d0495fe023bf29ec0d7b.png)](http://www.amd.com/ "Enabling today. Inspiring tomorrow.")

[![](/assets/icons/sponsor_b1-systems-a5bc5a49e7fc7854f9a688f873b074330a68bf7d286c4fda6bd0dd2e592752da.png)](http://www.b1-systems.de/en/homepage/ "Linux / Open Source Consulting, Training, Development & Support")

[![](/assets/icons/sponsor_heinlein-dc9ce64ab5cb25a15c4fd9a1b743f7886867932283f1dace07f0599a663a222a.png)](https://www.heinlein-support.de/ "We provide Knowledge and Experience")

[![](/assets/icons/sponsor_apm-1a5a654e5e7ed3df9d4717a1d68f6c4593096304173961c8b486a3ff3bddde75.png)](https://www.apm.com "Build the future of ARMv8 on Applied Micro")

The Open Build Service is an
[openSUSE project](https://www.opensuse.org).

* [Sign Up](https://idp-portal.suse.com/univention/self-service/#page=createaccount)
* Log In
* Places

##### Places

* [All Projects](/project "All Projects")
* [Status Monitor](/monitor "Status Monitor")



=== Content from bugzilla.suse.com_378a9c51_20250125_152723.html ===


| Bugzilla – Bug 707645 | VUL-1: CVE-2011-3172: pam: unix2\_chkpwd do not check for a valid account | Last modified: 2020-04-27 15:36:37 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D707645)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 707645**](show_bug.cgi?id=707645)
(CVE-2011-3172)
- VUL-1: CVE-2011-3172: pam: unix2\_chkpwd do not check for a valid account

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-1: CVE-2011-3172: pam: unix2\_chkpwd do not check for a valid account

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2011-3172 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Major | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/72739/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv2:NVD:CVE-2011-3172:10.0:(AV:N/... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2011-07-22 10:18 UTC by Michael Calmer | | --- | --- | | Modified: | 2020-04-27 15:36 UTC ([History](show_activity.cgi?id=707645)) | | CC List: | 5 users (show)  atoptsoglou johannes.hahn kukuk lnussel meissner | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Development | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=707645) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**proposed fixed version of unix2\_chkpwd**](attachment.cgi?id=441720 "View the content of the attachment") (5.81 KB, text/plain)  [2011-07-22 10:39 UTC](#attach_441720 "Go to the comment associated with the attachment"), Michael Calmer | [Details](attachment.cgi?id=441720&action=edit) | | [View All](attachment.cgi?bugid=707645&action=viewall)  [Add an attachment](attachment.cgi?bugid=707645&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=707645&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=707645#c0)  Michael Calmer   2011-07-22 10:18:26 UTC  ``` unix2_chkpwd do not call pam_acct_mgmt which means that it does not verify  if the users account is valid.  pam_acct_mgmt checks for authentication token and account expiration and verifies access restrictions. ``` [Comment 1](show_bug.cgi?id=707645#c1)  Michael Calmer   2011-07-22 10:38:07 UTC  ``` Additionally unix2_chkpwd should only call sleep(5) if authentication failed. ``` [Comment 2](show_bug.cgi?id=707645#c2)  Michael Calmer   2011-07-22 10:39:16 UTC  ``` Created [attachment 441720](attachment.cgi?id=441720 "proposed fixed version of unix2_chkpwd") [[details]](attachment.cgi?id=441720&action=edit "proposed fixed version of unix2_chkpwd") proposed fixed version of unix2_chkpwd ``` [Comment 3](show_bug.cgi?id=707645#c3)  Michael Calmer   2011-07-22 10:58:32 UTC  ``` Ludwig: please review. ``` [Comment 4](show_bug.cgi?id=707645#c4)  Michael Calmer   2011-07-22 11:35:37 UTC  ``` How to test:  Create a disable user: $> useradd -m userdisabled $> passwd userdisabled New Password: system Enter new password again: system $> chage -d 2011-05-01 -M 30 userdisabled $> chage -l userdisabled Minimum:        0 Maximum:        30 Warning:        7 Inactive:       -1 Last Change:            May 01, 2011 Password Expires:       May 31, 2011 Password Inactive:      Never Account Expires:        Never  Verify the bug, by calling: $> echo -n "system" | /sbin/unix2_chkpwd smtp userdisabled && echo "success" || echo "failed"  The answer is "success" which is wrong  After installing the update, repeat the command. The answer should be "failed". In /var/log/messages you can see an error like: unix2_chkpwd[11483]: pam_acct_mgmt(smtp, userdisabled): Authentication token is no longer valid; new one required ``` [Comment 5](show_bug.cgi?id=707645#c5)  Ludwig Nussel   2011-07-22 14:22:08 UTC  ``` looks good but I wonder if it won't break screensavers. What happens e.g. if the password expires while I'm logged in with locked screen (e.g over the weekend or holidays)? Normally a pam app would call pam_chauthtok() but unix2_chkpwd can't. So you may need to ignore PAM_NEW_AUTHTOK_REQD even that's not allowed normally. ``` [Comment 6](show_bug.cgi?id=707645#c6)  Michael Calmer   2011-07-27 15:25:27 UTC  ``` good question. Let's see what Thorsten think. ``` [Comment 8](show_bug.cgi?id=707645#c8)  Thorsten Kukuk   2011-08-01 07:10:42 UTC  ``` (In reply to [comment #5](show_bug.cgi?id=707645#c5)) > looks good but I wonder if it won't break screensavers. What happens e.g. if > the password expires while I'm logged in with locked screen (e.g over the > weekend or holidays)?  The same as of today if the sysadmins disables your account: you cannot unlock the screensaver anymore and you have to go to your sysadmin. ``` [Comment 9](show_bug.cgi?id=707645#c9)  Michael Calmer   2011-08-29 14:51:55 UTC  ``` So it seems everybody agreed on this patch.   Ludwig: is there still an update for pam-modules in the queue? ``` [Comment 10](show_bug.cgi?id=707645#c10)  Ludwig Nussel   2011-08-29 15:03:52 UTC  ``` nope ``` [Comment 11](show_bug.cgi?id=707645#c11)  Michael Calmer   2011-08-29 15:36:56 UTC  ``` Maintenance: I would like to have a swampid for this issue. ``` [Comment 14](show_bug.cgi?id=707645#c14)  Ludwig Nussel   2011-08-31 08:35:34 UTC  ``` CVE-2011-3172 ``` [Comment 15](show_bug.cgi?id=707645#c15)  Bernhard Wiedemann   2011-08-31 10:00:27 UTC  ``` This is an autogenerated message for OBS integration: This bug (707645) was mentioned in <https://build.opensuse.org/request/show/80346> Factory / pam-modules ``` [Comment 16](show_bug.cgi?id=707645#c16)  Michael Calmer   2014-10-15 07:14:06 UTC  ``` No answer, so let's forget about this. ``` [Comment 20](show_bug.cgi?id=707645#c20)  Swamp Workflow Management   2018-06-20 13:08:36 UTC  ``` SUSE-SU-2018:1760-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 707645 CVE References: CVE-2011-3172 Sources used: SUSE Linux Enterprise Server 11-SP4 (src):    pam-modules-11-1.27.3.1 SUSE Linux Enterprise Debuginfo 11-SP4 (src):    pam-modules-11-1.27.3.1 ``` [Comment 21](show_bug.cgi?id=707645#c21)  Alexandros Toptsoglou   2020-04-27 15:36:37 UTC  ``` Done ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=707645)
* - [XML](show_bug.cgi?ctype=xml&id=707645)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=707645)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D707645)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from idp-portal.suse.com_6b95d262_20250126_095338.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.


