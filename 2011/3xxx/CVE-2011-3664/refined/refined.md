Based on the provided information, here's an analysis of CVE-2011-3664:

**Root Cause of Vulnerability:**

- The vulnerability occurs in how Firefox handles NPAPI plugins on macOS.
- Specifically, a crash happens when a plugin deletes its containing DOM frame during a call from that frame.
- This is due to a missing check for frame destruction after calling NPP_SetWindow (via `nsPluginInstanceOwner::FixUpPluginWindow`) on macOS.
- The issue is triggered when the plugin executes Javascript that removes the frame that is calling the plugin.
- Because the plugin is removing the frame, the reference to the frame is no longer valid when the browser tries to access it, leading to a null dereference.

**Weaknesses/Vulnerabilities Present:**

- **Null dereference:** The core vulnerability is a null pointer dereference due to accessing a destroyed object.
- **Race Condition:** There is a race condition between the plugin's actions (removing the frame) and the browser's internal operations, leading to the crash.
- **Lack of Proper Checks:** The browser lacks necessary checks to ensure the frame is still valid before accessing its members.

**Impact of Exploitation:**

- **Crash:** The immediate impact is a browser crash.
- **Potential for Arbitrary Code Execution:** While the observed symptom is a null dereference, there is a possibility that a scriptable plugin (like Flash) could potentially manipulate the dereferenced address to achieve more than just a crash. This opens a door to potential arbitrary code execution, though not explicitly demonstrated in provided reports.

**Attack Vectors:**

- **Malicious Plugin:** A malicious plugin, or a vulnerable plugin that is compromised, could trigger this by calling `document.removeChild()` on the frame calling it.
- **Crafted Webpage:** A crafted webpage with a vulnerable plugin could force this scenario through Javascript interactions with the plugin.
- **Flash (Potentially):** It is speculated that Flash could potentially be used to trigger this vulnerability.

**Required Attacker Capabilities/Position:**

- **Ability to load a vulnerable plugin**: An attacker would need the ability to load a vulnerable plugin.
- **Javascript execution:** Javascript execution in the context of the plugin is needed to trigger the exploit.
- **Mac OS X Specific:** The vulnerability specifically affects macOS.
- **64-bit process**: The issue was present when 64-bit IPC was enabled.

**Additional details:**

- The vulnerability was reported by Richard Bateman, a FireBreath developer.
- The crash signature is `nsPluginInstanceOwner::GetPluginPortFromWidget`.
- The vulnerability was present in Firefox 5, 6, 7 and 8.
- It was fixed in Firefox 9 and later.
- The fix involved adding a check for frame destruction in `nsPluginInstanceOwner::FixUpPluginWindow`.
- The bug was also tracked as alias CVE-2011-3664 in Bugzilla.

In summary, CVE-2011-3664 is a vulnerability in Firefox's plugin handling on macOS that could lead to a crash and potentially arbitrary code execution. It occurs due to a race condition and missing checks during plugin frame manipulation.