=== Content from bugs.debian.org_59fe3d7d_20250125_103117.html ===

# Debian Bug report logs - #637477 possibly allows shell injection

[![version graph](version.cgi?collapse=1;fixed=dtc%2F0.34.1-1;fixed=dtc%2F0.29.18-1%2Blenny2;width=2;absolute=0;package=src%3Adtc;found=dtc%2F0.29.17-1;height=2)](version.cgi?collapse=1;fixed=dtc%2F0.34.1-1;fixed=dtc%2F0.29.18-1%2Blenny2;absolute=0;info=1;package=src%3Adtc;found=dtc%2F0.29.17-1)

Package:
[src:dtc](pkgreport.cgi?src=dtc);
Maintainer for [src:dtc](pkgreport.cgi?src=dtc) is [Thomas Goirand <zigo@debian.org>](pkgreport.cgi?maint=zigo%40debian.org);

Reported by: [Ansgar Burchardt <ansgar@debian.org>](pkgreport.cgi?submitter=ansgar%40debian.org)

Date: Thu, 11 Aug 2011 21:39:01 UTC

Severity: *critical*

Tags: security, upstream

Found in version dtc/0.29.17-1

Fixed in versions dtc/0.34.1-1, dtc/0.29.18-1+lenny2

**Done:** Thomas Goirand <zigo@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=637477;mbox=yes), [status mbox](bugreport.cgi?bug=637477;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=637477;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Thomas Goirand <zigo@debian.org>`:

`Bug#637477`; Package `src:dtc`.
(Thu, 11 Aug 2011 21:39:04 GMT) ([full text](bugreport.cgi?bug=637477;msg=2), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Ansgar Burchardt <ansgar@debian.org>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Thomas Goirand <zigo@debian.org>`.
(Thu, 11 Aug 2011 21:39:04 GMT) ([full text](bugreport.cgi?bug=637477;msg=4), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=637477;msg=5), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=ansgar%40debian.org)
From: Ansgar Burchardt <ansgar@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: possibly allows shell injection
Date: Thu, 11 Aug 2011 23:36:42 +0200
```
Package: src:dtc
Version: 0.29.17-1
Severity: critical
Tags: security

Hi,

shared/inc/sql/lists.php includes code like

  if ($_REQUEST[$tunable_name]!=""){
          //i write in the file
          $write_line = "echo ".$_REQUEST[$tunable_name]." > ".$option_file;
          exec($write_line);
  }else{ //i remove the file

and does not seem to check the contents of $_REQUEST for sanity as far as I can
see.

(I did not try actually using it as I do not have dtc setup.)

Regards,
Ansgar

```

---

**Added tag(s) upstream.**
Request was from `Jonathan Wiltshire <jmw@debian.org>`
to `control@bugs.debian.org`.
(Fri, 12 Aug 2011 18:15:08 GMT) ([full text](bugreport.cgi?bug=637477;msg=7), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=7), [link](#6)).

---

**Reply sent**
to `Thomas Goirand <zigo@debian.org>`:

You have taken responsibility.
(Sat, 20 Aug 2011 11:50:03 GMT) ([full text](bugreport.cgi?bug=637477;msg=9), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=9), [link](#8)).

---

**Notification sent**
to `Ansgar Burchardt <ansgar@debian.org>`:

Bug acknowledged by developer.
(Sat, 20 Aug 2011 11:50:11 GMT) ([full text](bugreport.cgi?bug=637477;msg=11), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=11), [link](#10)).

---

[Message #12](#12) received at 637477-close@bugs.debian.org ([full text](bugreport.cgi?bug=637477;msg=12), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=12), reply):

![](/cgi-bin/libravatar.cgi?email=zigo%40debian.org)
From: Thomas Goirand <zigo@debian.org>
To: 637477-close@bugs.debian.org
Subject: Bug#637477: fixed in dtc 0.34.1-1
Date: Sat, 20 Aug 2011 11:47:17 +0000
```
Source: dtc
Source-Version: 0.34.1-1

We believe that the bug you reported is fixed in the latest version of
dtc, which is due to be installed in the Debian FTP archive:

dtc-autodeploy_0.34.1-1_all.deb
  to main/d/dtc/dtc-autodeploy_0.34.1-1_all.deb
dtc-common_0.34.1-1_all.deb
  to main/d/dtc/dtc-common_0.34.1-1_all.deb
dtc-core_0.34.1-1_all.deb
  to main/d/dtc/dtc-core_0.34.1-1_all.deb
dtc-cyrus_0.34.1-1_all.deb
  to main/d/dtc/dtc-cyrus_0.34.1-1_all.deb
dtc-dos-firewall_0.34.1-1_all.deb
  to main/d/dtc/dtc-dos-firewall_0.34.1-1_all.deb
dtc-postfix-courier_0.34.1-1_all.deb
  to main/d/dtc/dtc-postfix-courier_0.34.1-1_all.deb
dtc-postfix-dovecot_0.34.1-1_all.deb
  to main/d/dtc/dtc-postfix-dovecot_0.34.1-1_all.deb
dtc-stats-daemon_0.34.1-1_all.deb
  to main/d/dtc/dtc-stats-daemon_0.34.1-1_all.deb
dtc-toaster_0.34.1-1_all.deb
  to main/d/dtc/dtc-toaster_0.34.1-1_all.deb
dtc_0.34.1-1.diff.gz
  to main/d/dtc/dtc_0.34.1-1.diff.gz
dtc_0.34.1-1.dsc
  to main/d/dtc/dtc_0.34.1-1.dsc
dtc_0.34.1.orig.tar.gz
  to main/d/dtc/dtc_0.34.1.orig.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 637477@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Thomas Goirand <zigo@debian.org> (supplier of updated dtc package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Fri, 12 Aug 2011 09:04:11 +0800
Source: dtc
Binary: dtc-common dtc-dos-firewall dtc-postfix-dovecot dtc-core dtc-cyrus dtc-postfix-courier dtc-stats-daemon dtc-toaster dtc-autodeploy
Architecture: source all
Version: 0.34.1-1
Distribution: unstable
Urgency: high
Maintainer: Thomas Goirand <zigo@debian.org>
Changed-By: Thomas Goirand <zigo@debian.org>
Description:
 dtc-autodeploy - Autodeploy the DTC in a single non-interactive debconf command
 dtc-common - web control panel for admin and accounting hosting services (comm
 dtc-core   - web control panel for admin and accounting hosting services (fewe
 dtc-cyrus  - web control panel for admin and accounting hosting services (cyru
 dtc-dos-firewall - small anti-DoS firewall script for your web, ftp and mail servers
 dtc-postfix-courier - web control panel for admin and accounting hosting services (more
 dtc-postfix-dovecot - meta package to setup a minimal DTC server with Dovecot
 dtc-stats-daemon - dtc-xen VM statistics for the dtc web control panel
 dtc-toaster - web control panel for admin and accounting hosting services (meta
Closes: [566654](bugreport.cgi?bug=566654) [599087](bugreport.cgi?bug=599087) [633617](bugreport.cgi?bug=633617) [637469](bugreport.cgi?bug=637469) [637477](bugreport.cgi?bug=637477) [637485](bugreport.cgi?bug=637485) [637487](bugreport.cgi?bug=637487) [637498](bugreport.cgi?bug=637498) [637505](bugreport.cgi?bug=637505) [637537](bugreport.cgi?bug=637537) [637584](bugreport.cgi?bug=637584) [637617](bugreport.cgi?bug=637617) [637618](bugreport.cgi?bug=637618) [637629](bugreport.cgi?bug=637629)
Changes:
 dtc (0.34.1-1) unstable; urgency=high
 .
   * New upstream version with lots of security fixes:
     - Passwords are now hashed (Closes: #[566654](bugreport.cgi?bug=566654)).
     - The addrlink is now checked properly, thanks to Ansgar Burchardt
     <ansgar@debian.org> for reporting it (Closes: #[637487](bugreport.cgi?bug=637487)).
     - Mailing lists tunables options are now correcly escaped before the files
     are being written with an echo, thanks to Ansgar Burchardt
     <ansgar@debian.org> for reporting it (Closes: #[637477](bugreport.cgi?bug=637477)).
     - Removed sourceless built of OSX mod_log_sql, removed unwanted iglobalwall
     useless files, thanks to Ansgar Burchardt <ansgar@debian.org> for reporting
     it (Closes: #[637469](bugreport.cgi?bug=637469)).
     - Fixes logPushlet input checking, thanks to Mike O'Connor <stew@vireo.org>
     for reporting it (Closes: #[637498](bugreport.cgi?bug=637498)).
     - Removes grayboard skin as it is missing some js scripts, thanks to Mike
     O'Connor <stew@vireo.org> for reporting it (Closes: #[637505](bugreport.cgi?bug=637505)).
     - Sets apache2.conf not to be world readable because it contains the
     password for accessing the dtcdaemon database (Closes: #[637485](bugreport.cgi?bug=637485)).
     - Adds output escaping in the DNS & MX form (Closes: #[637584](bugreport.cgi?bug=637584)).
     - Install now does chmod 640 /var/log/dtc.log chown root:adm
     /var/log/dtc.log (Closes: #[637617](bugreport.cgi?bug=637617)).
     - Checks for validity of package name in the package installer before
     installing a package (Closes: #[637629](bugreport.cgi?bug=637629)).
     - Now using a dtc-chroot-wrapper to avoid giving a too permissive access
     to chrootuid, which was giving root access to apache (Closes: #[637618](bugreport.cgi?bug=637618)).
     - Don't use htpasswd -b, since it's showing the password on a ps. Using
     crypt() and fwrite() now. (Closes: #[637537](bugreport.cgi?bug=637537)).
   * Added ja.po debconf translation thanks to Hideki Yamane
     <henrich@debian.org> (Closes: #[599087](bugreport.cgi?bug=599087)).
   * Changed reference to mysql-server-5.0 to mysql-server-5.1, thanks to
     Mike O'Connor <stew@vireo.org> for reporting it (Closes: #[633617](bugreport.cgi?bug=633617)).
Checksums-Sha1:
 075e5523539dc632549c4cc114cbad273fbc3f3f 1243 dtc_0.34.1-1.dsc
 7f2d9cddb5373a97b769e6c431b9e28dc1e85fa8 8195790 dtc_0.34.1.orig.tar.gz
 b2ace6b766203848c5ab234aa1179c3b160eb416 91084 dtc_0.34.1-1.diff.gz
 9598121571e4d6d757ab2d3fd6dbe78f28cd9912 2428700 dtc-common_0.34.1-1_all.deb
 9aee43c855853d457e15fac2c5a263443e78190f 32538 dtc-dos-firewall_0.34.1-1_all.deb
 efee999fd6f867faea7bf61066859bdd10a69878 30940 dtc-postfix-dovecot_0.34.1-1_all.deb
 5995f91a319fec8ba75857731b0d3daba1923379 30994 dtc-core_0.34.1-1_all.deb
 387594afed847e167fa86c8cf8369d0d56c88e0c 31080 dtc-cyrus_0.34.1-1_all.deb
 c2ff3fb9406274a4a8e25b7fecb43edb21b4d35a 31098 dtc-postfix-courier_0.34.1-1_all.deb
 626e4325bf7481c1bd2e3a9f802c30b5047946b9 37470 dtc-stats-daemon_0.34.1-1_all.deb
 5d6387aa198b5e4f4614385d163c14f50e0bdace 30972 dtc-toaster_0.34.1-1_all.deb
 0adef915d634fa50a2ce58e446347635058a548b 34310 dtc-autodeploy_0.34.1-1_all.deb
Checksums-Sha256:
 b752a496b2a5ea2b3b44a53eb89377bdfb02bc0d87eb9b5913cc755516bab7d3 1243 dtc_0.34.1-1.dsc
 5e7822c0e61f297bcdfa5f854a66955e612287117c2733b1394b50ac50846626 8195790 dtc_0.34.1.orig.tar.gz
 6e44a929931ad58f022a3c2fe3726d175e28b8fd85576970f3c8e3cc1167c0a6 91084 dtc_0.34.1-1.diff.gz
 09057caf79af0ba5c9d58b6fcd5e2e83ca931dd3e6cc1e1ac7c36476ddd1197f 2428700 dtc-common_0.34.1-1_all.deb
 b0d327ae55a23b4d395b6c764668282508d6ceefc9ebc5f447efa1b265a86338 32538 dtc-dos-firewall_0.34.1-1_all.deb
 4a3cf4cb4fb2568a0ec1bd7d9ea9fbd58c11138af924b16851933ace6e19decf 30940 dtc-postfix-dovecot_0.34.1-1_all.deb
 d5e23b6ddb212a80782d321fc67e5901c2b5bc8f8029874115035096aa09eb12 30994 dtc-core_0.34.1-1_all.deb
 3b6894142368cd982f1aa3ec108d4ce9e9f76c8f30cb02910f56f0605e9ac482 31080 dtc-cyrus_0.34.1-1_all.deb
 3317ccc9b6346c1899c138dffa6783451a68023b3cf8304a3f830003645bb1de 31098 dtc-postfix-courier_0.34.1-1_all.deb
 5666404a689f3af50acbafcf028de5f97ddcd70bd237d13d79272887a4c0af4a 37470 dtc-stats-daemon_0.34.1-1_all.deb
 7fce77b35fb440f8675dfcbd8b1f0074e1e05d662c4c19f4186fc2541e372e3a 30972 dtc-toaster_0.34.1-1_all.deb
 181ef8bd2dc281dd4fe38075c8115c1c8e74cc91d4d599c7ac36427bb5e0e0bc 34310 dtc-autodeploy_0.34.1-1_all.deb
Files:
 4693b32cfd5cd3872f2d1de8d3382d08 1243 admin extra dtc_0.34.1-1.dsc
 c4c1ec026296f2e75a5054dc845fe77b 8195790 admin extra dtc_0.34.1.orig.tar.gz
 d9eeb3f8ba4f77faa95997adaace882b 91084 admin extra dtc_0.34.1-1.diff.gz
 7452c7bb25e33d7a70c06c013a16a9dd 2428700 admin extra dtc-common_0.34.1-1_all.deb
 08b4211e2a003580b97d0316aa6277c4 32538 admin extra dtc-dos-firewall_0.34.1-1_all.deb
 9fe0890ff9d6b66a3cda70dee3ef7d61 30940 admin extra dtc-postfix-dovecot_0.34.1-1_all.deb
 8cb49a88dc37819242b10efce2b147d2 30994 admin extra dtc-core_0.34.1-1_all.deb
 3a91932a4f9f4529cb2911f28ade222e 31080 admin extra dtc-cyrus_0.34.1-1_all.deb
 29deb66619c5f9bb4476b99f927309f8 31098 admin extra dtc-postfix-courier_0.34.1-1_all.deb
 0a741750e67e056b5565b71b1bf60de5 37470 admin extra dtc-stats-daemon_0.34.1-1_all.deb
 e634ee96a0ae0c1a35a7a0e6c1472732 30972 admin extra dtc-toaster_0.34.1-1_all.deb
 31f043aff445dec66e910d3c9644cdbe 34310 admin extra dtc-autodeploy_0.34.1-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iEYEARECAAYFAk5P4UYACgkQl4M9yZjvmkkinACfRS4V970BAItweGiSVGPZIMlI
rNAAnReg8FAJjkPuNSaa/Y3zOXicz0c3
=bu2M
-----END PGP SIGNATURE-----

```

---

**Bug No longer marked as fixed in versions dtc/0.34.1-1 and reopened.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 20 Aug 2011 16:24:05 GMT) ([full text](bugreport.cgi?bug=637477;msg=14), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=14), [link](#13)).

---

**Bug Marked as fixed in versions dtc/0.34.1-1.**
Request was from `Thomas Goirand <thomas@goirand.fr>`
to `control@bugs.debian.org`.
(Sat, 20 Aug 2011 16:24:06 GMT) ([full text](bugreport.cgi?bug=637477;msg=16), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=16), [link](#15)).

---

**Reply sent**
to `Thomas Goirand <thomas@goirand.fr>`:

You have taken responsibility.
(Mon, 19 Dec 2011 02:57:04 GMT) ([full text](bugreport.cgi?bug=637477;msg=18), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=18), [link](#17)).

---

**Notification sent**
to `Ansgar Burchardt <ansgar@debian.org>`:

Bug acknowledged by developer.
(Mon, 19 Dec 2011 02:57:04 GMT) ([full text](bugreport.cgi?bug=637477;msg=20), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=20), [link](#19)).

---

[Message #21](#21) received at 637477-done@bugs.debian.org ([full text](bugreport.cgi?bug=637477;msg=21), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=21), reply):

![](/cgi-bin/libravatar.cgi?email=thomas%40goirand.fr)
From: Thomas Goirand <thomas@goirand.fr>
To: 637477-done@bugs.debian.org
Subject: Also fixed in Lenny
Date: Mon, 19 Dec 2011 10:54:21 +0800
```

```

---

**Reply sent**
to `Thomas Goirand <zigo@debian.org>`:

You have taken responsibility.
(Mon, 19 Dec 2011 20:06:12 GMT) ([full text](bugreport.cgi?bug=637477;msg=23), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=23), [link](#22)).

---

**Notification sent**
to `Ansgar Burchardt <ansgar@debian.org>`:

Bug acknowledged by developer.
(Mon, 19 Dec 2011 20:06:12 GMT) ([full text](bugreport.cgi?bug=637477;msg=25), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=25), [link](#24)).

---

[Message #26](#26) received at 637477-close@bugs.debian.org ([full text](bugreport.cgi?bug=637477;msg=26), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=26), reply):

![](/cgi-bin/libravatar.cgi?email=zigo%40debian.org)
From: Thomas Goirand <zigo@debian.org>
To: 637477-close@bugs.debian.org
Subject: Bug#637477: fixed in dtc 0.29.18-1+lenny2
Date: Mon, 19 Dec 2011 20:04:28 +0000
```
Source: dtc
Source-Version: 0.29.18-1+lenny2

We believe that the bug you reported is fixed in the latest version of
dtc, which is due to be installed in the Debian FTP archive:

dtc-common_0.29.18-1+lenny2_all.deb
  to main/d/dtc/dtc-common_0.29.18-1+lenny2_all.deb
dtc-core_0.29.18-1+lenny2_all.deb
  to main/d/dtc/dtc-core_0.29.18-1+lenny2_all.deb
dtc-cyrus_0.29.18-1+lenny2_all.deb
  to main/d/dtc/dtc-cyrus_0.29.18-1+lenny2_all.deb
dtc-postfix-courier_0.29.18-1+lenny2_all.deb
  to main/d/dtc/dtc-postfix-courier_0.29.18-1+lenny2_all.deb
dtc-stats-daemon_0.29.18-1+lenny2_all.deb
  to main/d/dtc/dtc-stats-daemon_0.29.18-1+lenny2_all.deb
dtc-toaster_0.29.18-1+lenny2_all.deb
  to main/d/dtc/dtc-toaster_0.29.18-1+lenny2_all.deb
dtc_0.29.18-1+lenny2.diff.gz
  to main/d/dtc/dtc_0.29.18-1+lenny2.diff.gz
dtc_0.29.18-1+lenny2.dsc
  to main/d/dtc/dtc_0.29.18-1+lenny2.dsc
dtc_0.29.18.orig.tar.gz
  to main/d/dtc/dtc_0.29.18.orig.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 637477@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Thomas Goirand <zigo@debian.org> (supplier of updated dtc package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: RIPEMD160

Format: 1.8
Date: Sun, 11 Sep 2011 05:15:26 +0000
Source: dtc
Binary: dtc-common dtc-core dtc-cyrus dtc-postfix-courier dtc-stats-daemon dtc-toaster
Architecture: source all
Version: 0.29.18-1+lenny2
Distribution: lenny-security
Urgency: low
Maintainer: Thomas Goirand <zigo@debian.org>
Changed-By: Thomas Goirand <zigo@debian.org>
Description:
 dtc-common - web control panel for admin and accounting hosting services (comm
 dtc-core   - web control panel for admin and accounting hosting services (fewe
 dtc-cyrus  - web control panel for admin and accounting hosting services (cyru
 dtc-postfix-courier - web control panel for admin and accounting hosting services (more
 dtc-stats-daemon - dtc-xen VM statistics for the dtc web control panel
 dtc-toaster - web control panel for admin and accounting hosting services (meta
Closes: [637469](bugreport.cgi?bug=637469) [637477](bugreport.cgi?bug=637477) [637485](bugreport.cgi?bug=637485) [637487](bugreport.cgi?bug=637487) [637537](bugreport.cgi?bug=637537) [637584](bugreport.cgi?bug=637584) [637618](bugreport.cgi?bug=637618) [637629](bugreport.cgi?bug=637629) [637630](bugreport.cgi?bug=637630) [637632](bugreport.cgi?bug=637632) [637669](bugreport.cgi?bug=637669)
Changes:
 dtc (0.29.18-1+lenny2) lenny-security; urgency=low
 .
   * QA upload fixing:
     - Removed old iGlobalWall folder which included unwanted information.
     - Removed sourceless OSX mod_log_sql.so files (Closes: #[637469](bugreport.cgi?bug=637469)).
     - Fixes lists shell injection issue (Closes: #[637477](bugreport.cgi?bug=637477)).
     - Sets unix rights to non-world readable for the apache2.conf file,
     since it contains SQL access password (Closes: #[637485](bugreport.cgi?bug=637485)).
     - Now htmlspecialchars() the output of DNS & MX, preventing a possible
     HTML injection issue (Closes: #[637584](bugreport.cgi?bug=637584)).
     - Fixes "package installer includes php files in untrusted directories"
     if some package install packages are installed (Closes: #[637629](bugreport.cgi?bug=637629), #[637630](bugreport.cgi?bug=637630)).
     - Adds htmlspecialchars() in the ticket display.
     - Fixes sudo access to chrootuid is giving access to root using the new
     dtc-chroot-wrapper (Closes: #[637618](bugreport.cgi?bug=637618)).
     - Not using htpasswd -b to create .htpasswd files (Closes: #[637537](bugreport.cgi?bug=637537)).
     - Checks $_SERVER["addrlink"] input correctly, since it could lead to very
     bad SQL insertion (Closes: #[637487](bugreport.cgi?bug=637487) ).
     - Fixes an SQL injection in package installer (Closes: #[637632](bugreport.cgi?bug=637632)).
     - Fixes an SQL injection in the draw_user_admin.php (Closes: #[637669](bugreport.cgi?bug=637669)).
Checksums-Sha1:
 9e7675783f6ac3070dc332da98febc2af28894b6 1250 dtc_0.29.18-1+lenny2.dsc
 bdf1bef7c5d7e9d61892bc3875925503363354f5 7301006 dtc_0.29.18.orig.tar.gz
 b5e77fbbae9e27735c82751abc1ac0077146a002 78746 dtc_0.29.18-1+lenny2.diff.gz
 4445b341c0a0566e1f93325712fbd807bed799ab 1912204 dtc-common_0.29.18-1+lenny2_all.deb
 79612b46702ccd4823e1d8060eea8497cbe83d72 70510 dtc-core_0.29.18-1+lenny2_all.deb
 7456c345f99006e82795eb718e5d249606e8ddcd 70626 dtc-cyrus_0.29.18-1+lenny2_all.deb
 9edf5d6c9463161b49431da1a9ea8a65fd146cf0 72150 dtc-postfix-courier_0.29.18-1+lenny2_all.deb
 e145c361efd75c81675bdbd92c98eee47b2365af 31420 dtc-stats-daemon_0.29.18-1+lenny2_all.deb
 6f4e57a97ea09e1c647225199c0c2b6fa693a965 25814 dtc-toaster_0.29.18-1+lenny2_all.deb
Checksums-Sha256:
 0205a5938ae0faee16d2d3d8df2d6fa9b311aae37c906c854ef585a981b8d3af 1250 dtc_0.29.18-1+lenny2.dsc
 4c6c116a378641114310bfa4c0595945f8077e222292577d060f0d7f32be37b9 7301006 dtc_0.29.18.orig.tar.gz
 e6741fced0c57c63d3b64dfc86c4b78361bd28c0b21c47b739fa8e478612dcca 78746 dtc_0.29.18-1+lenny2.diff.gz
 aad9db66e62d2f24c3b56d35a6c46d553f52a6361d82db873aecfaed65dcf124 1912204 dtc-common_0.29.18-1+lenny2_all.deb
 6574b290ee7ef3a68487bc6adf9be43ef10cf753bbbec0eea4ee6c0e2dfc2414 70510 dtc-core_0.29.18-1+lenny2_all.deb
 ae3ce5943e2b9cec34fa1b6c6f77cd1e035992e844ed890432a34338fc15091d 70626 dtc-cyrus_0.29.18-1+lenny2_all.deb
 a0988321c1edca4e4f68ecce6250cd404e84286f430007e90a94c3928acf9293 72150 dtc-postfix-courier_0.29.18-1+lenny2_all.deb
 2b5e79c3bf8972499b1640e905068efdee6a67edbd713d2b5f8f95949d8c1c0a 31420 dtc-stats-daemon_0.29.18-1+lenny2_all.deb
 e88ef80dedf21e996b36328a27a5be300c3b4fdeaedfe5781dc3d4ac17b3e617 25814 dtc-toaster_0.29.18-1+lenny2_all.deb
Files:
 a3f3e14f6ea3d0cdceec1c80727160e8 1250 admin extra dtc_0.29.18-1+lenny2.dsc
 a974267096479c55720c8d7e3c00ae6d 7301006 admin extra dtc_0.29.18.orig.tar.gz
 79129db9e54025fe4a08f590249caf3c 78746 admin extra dtc_0.29.18-1+lenny2.diff.gz
 351c2f7d94f8fa02cc6fc85f7ecdc3a9 1912204 admin extra dtc-common_0.29.18-1+lenny2_all.deb
 eaaa9dfc160479f3a8cb4662087cf4dc 70510 admin extra dtc-core_0.29.18-1+lenny2_all.deb
 517eedc29e40d13333d713245e0435aa 70626 admin extra dtc-cyrus_0.29.18-1+lenny2_all.deb
 b46683262492c05b7096e4f81322fb56 72150 admin extra dtc-postfix-courier_0.29.18-1+lenny2_all.deb
 30edcbb544f59beb9e0949c6836a0380 31420 admin extra dtc-stats-daemon_0.29.18-1+lenny2_all.deb
 0434325a71c5fa9f6e174ac89f2085b8 25814 admin extra dtc-toaster_0.29.18-1+lenny2_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEAREDAAYFAk5sVVUACgkQl4M9yZjvmkkv1QCffTfT59yeRRJPOunBaCKGLLpT
MowAnR2XE3OKrUWUAuwvJm/6kyhuwPxJ
=J5w+
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 17 Jan 2012 07:40:57 GMT) ([full text](bugreport.cgi?bug=637477;msg=28), [mbox](bugreport.cgi?bug=637477;mbox=yes;msg=28), [link](#27)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=637477).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 10:31:16 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.debian.org_6e55ecdd_20250125_103114.html ===


---

[[Date Prev](msg00242.html)][[Date Next](msg00244.html)]
[[Thread Prev](msg00242.html)][[Thread Next](msg00244.html)]
[[Date Index](maillist.html#00243)]
[[Thread Index](threads.html#00243)]

# [SECURITY] [DSA 2365-1] dtc security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2365-1] dtc security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 18 Dec 2011 21:31:53 +0100
* *Message-id*: <[[🔎]](/msgid-search/20111218203153.GA6069%40pisco.westfalen.local) [20111218203153.GA6069@pisco.westfalen.local](msg00243.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2365-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
December 18, 2011                      <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dtc
Vulnerability  : several
Problem type   : local/remote
Debian-specific: no
CVE ID         : CVE-2011-3195 CVE-2011-3196 CVE-2011-3197 CVE-2011-3198
                 CVE-2011-3199
Debian Bug     : 637469 637477 637485 637584 637629 637630 637618 637537 637487 637632 637669

Ansgar Burchardt, Mike O'Connor and Philipp Kern discovered multiple
vulnerabilities in DTC, a web control panel for admin and accounting
hosting services:

CVE-2011-3195

    A possible shell insertion has been found in the mailing list
    handling.

CVE-2011-3196

    Unix rights for the apache2.conf were set incorrectly (world
    readable).

CVE-2011-3197

    Incorrect input sanitising for the $_SERVER["addrlink"] parameter
    could lead to SQL insertion.

CVE-2011-3198

    DTC was using the -b option of htpasswd, possibly revealing
    password in clear text using ps or reading /proc.

CVE-2011-3199

    A possible HTML/javascript insertion vulnerability has been found
    in the DNS & MX section of the user panel.

This update also fixes several vulnerabilities, for which no CVE ID
has been assigned:

It has been discovered that DTC performs insufficient input sanitising
in the package installer, leading to possible unwanted destination
directory for installed packages if some DTC application packages
are installed (note that these aren't available in Debian main).

DTC was setting-up /etc/sudoers with permissive sudo rights to
chrootuid.

Incorrect input sanitizing in the package installer could lead to
SQL insertion.

A malicious user could enter a specially crafted support ticket
subject leading to an SQL injection in the draw_user_admin.php.

For the oldstable distribution (lenny), this problem has been fixed in
version 0.29.18-1+lenny2

The stable distribution (squeeze) doesn't include dtc.

For the unstable distribution (sid), this problem has been fixed in
version 0.34.1-1.

We recommend that you upgrade your dtc packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iEYEARECAAYFAk7uTYgACgkQXm3vHE4uylr/JACgl1mPf6jUuSjsmOR4XAAd7IfG
f+sAoKnzBNiOQmdsL+tuB3mbJW7Gtx2f
=dODf
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_493a6cdd_20250125_103115.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2011/08/12/11) [[next>]](2) [[<thread-prev]](../../../2011/08/12/9) [[thread-next>]](../../../2011/08/24/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4E45D873.2000901@goirand.fr>
Date: Sat, 13 Aug 2011 09:50:43 +0800
From: Thomas Goirand <thomas@...rand.fr>
To: Jonathan Wiltshire <jmw@...ian.org>
CC: oss-security@...ts.openwall.com,
 Debian Security Team <team@...urity.debian.org>
Subject: Re: CVE request: multiple vulnerabilities in dtc

We are discussing the issues with Philippe Kern. While there are issues
that were discovered, I am claiming that some of what you see below
shouldn't be in the list.

On 08/13/2011 05:26 AM, Jonathan Wiltshire wrote:
> #566654
> dtc saves the administrator password in plain text in
> /var/lib/dtc/saved_install_config under the variable name conf_adm_pass.
> It remains there even after initial configuration.

That's not more a security vulnerability than /etc/mysql/debian.cnf
(both file are readable by root only). This has been in the BTS for a
long time, and it makes no sense to assign a CVE now.

> #611680
> dtc-xen includes several command executions as root that use unchecked
> user input in dtc-soap-server.

That's not relevant and isn't a vulnerability. I have closed the bug a
long time ago, writing that I wont fix it, and explaining why. Please
see the BTS entry for it. dtc-xen isn't supposed to run stand-alone, and
the only client for dtc-xen is dtc itself. If you gain access to it,
then there is an issue somewhere else, and "fixing" things here wont
make things better.

> #614304
> dtc stores user passwords and passwords for various services in unencrypted
> form in the database.

This is fixed in the Git, and has already been discussed. While it's a
serious issue (which has been carefully worked on), it didn't deserve a
CVE 6 months ago, and it shouldn't right now.

> #637477
> Insufficient input checking in /shared/inc/sql/lists.php
>
> #637485
> The setup script for dtc writes the password for the MySQL user in the
> world-readable file /etc/apache2/apache2.conf.
>
> #637487
> Insufficient input checking leads to a SQL injection vulnerability in
> shared/inc/forms/domain_info.php.
>
> #637498
> A SQL injection vulnerability in logPushlet.php can overwrite arbitrary
> files as the MySQL system user.
>
> #637537
> dtc passes passwords to htpasswd using command line arguments, which can be
> read by a local user.
>
> #637584
> dtc does not escape variables in HTML output in many places; for example
> in the "Domain root TXT record:" field on the "DNS and MX" page where
> JavaScript can be injected.

The above should be fixed and are real issues, but what I commented
don't deserve a CVE.

> Note that these descriptions are mostly taken from the bug reports and may
> not be suitable for direct publication without editing. I have checked as
> far as possible that none of these were previously assigned CVEs but they
> could be duplicates. There are often mitigating factors such as
> user or administrator authentication.

Absolutely all of them need a user to be logged indeed.

Thomas

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_9bba242d_20250125_103115.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](../../../2011/08/25/1) [[<thread-prev]](9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <183364929.302425.1314218070898.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Wed, 24 Aug 2011 16:34:30 -0400 (EDT)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: Debian Security Team <team@...urity.debian.org>,
        Jonathan Wiltshire <jmw@...ian.org>, coley <coley@...re.org>
Subject: Re: Re: CVE request: multiple vulnerabilities in dtc

----- Original Message -----
>
> > #637477
> > Insufficient input checking in /shared/inc/sql/lists.php

CVE-2011-3195

> > #637485
> > The setup script for dtc writes the password for the MySQL user in the
> > world-readable file /etc/apache2/apache2.conf.

CVE-2011-3196

> > #637487
> > Insufficient input checking leads to a SQL injection vulnerability in
> > shared/inc/forms/domain_info.php.
> >
> > #637498
> > A SQL injection vulnerability in logPushlet.php can overwrite arbitrary
> > files as the MySQL system user.

I'm grouping the above two together.
CVE-2011-3197

> > #637537
> > dtc passes passwords to htpasswd using command line arguments, which
> > can be read by a local user.

CVE-2011-3198

> > #637584
> > dtc does not escape variables in HTML output in many places; for
> > example in the "Domain root TXT record:" field on the "DNS and MX" page
> > where JavaScript can be injected.

Let's call this "multiple XSS flaws"
CVE-2011-3199

Thanks for sorting the original list.

--
    JB

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


