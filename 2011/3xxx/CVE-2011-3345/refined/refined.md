Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause of Vulnerability:**
The vulnerability stems from incorrect handling of statistics within the `ib_sdp` module of the Open Fabrics OFED InfiniBand driver stack, specifically when reading `/proc/net/sdpstats`. The code incorrectly treated some single variables as arrays during the printing process. Additionally, a macro `__sdpstats_seq_hist_pcpu` allocated a large array on the stack, which could lead to stack exhaustion.

**Weaknesses/Vulnerabilities Present:**
1.  **Incorrect Array Handling:** The code treated single variables as arrays when printing statistics to `/proc/net/sdpstats`, causing memory corruption.
2.  **Stack Overflow:** The `__sdpstats_seq_hist_pcpu` macro allocated a large array (`u32 h[NR_CPUS]`) on the stack. When `NR_CPUS` was large (e.g., 4096 on RHEL6), this caused a stack overflow when trying to access `/proc/net/sdpstats`.

**Impact of Exploitation:**
*   **Local Denial of Service (DoS):** By reading `/proc/net/sdpstats`, a local user could trigger a stack overflow, causing the process to crash and potentially leading to a kernel crash or system instability.
*   **Memory Corruption:** Incorrect handling of variables as arrays could lead to memory corruption.

**Attack Vectors:**
*   **Local Access:** A local user on a system with the vulnerable `ib_sdp` module loaded could trigger the vulnerability by reading the `/proc/net/sdpstats` file, typically with a command like `cat /proc/net/sdpstats`.

**Required Attacker Capabilities/Position:**
*   **Local User:** The attacker must have local user access on the system.
*   **InfiniBand Stack:** The system must have the Open Fabrics OFED InfiniBand driver stack with the vulnerable `ib_sdp` module loaded.

**Additional Notes:**

*   The vulnerability is present in OFED version 1.5.2 and potentially older versions (at least 1.4.2 is not affected).
*   OFED version 1.5.3.2 and later are not affected, as they use a different method for printing stats, where the large array is allocated using vmalloc.
*   The patch addresses the issue by removing the incorrect array handling and the problematic macro.