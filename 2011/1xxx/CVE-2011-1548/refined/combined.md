=== Content from openwall.com_91a83144_20250125_042538.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](../../../2011/03/24/1) [[<thread-prev]](../../../2011/03/14/26) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201103231725.35626.ludwig.nussel@suse.de>
Date: Wed, 23 Mar 2011 17:25:35 +0100
From: Ludwig Nussel <ludwig.nussel@...e.de>
To: oss-security@...ts.openwall.com
Subject: Re: CVE Request -- logrotate -- nine issues

Ludwig Nussel wrote:
> Josh Bressers wrote:
> > We then will need to assign IDs for various broken uses of /var/log (If
> > someone has a list of the currently known ones, please pass it along)
>
> AFAICS on openSUSE Factory we have
> cobbler

The cobbler daemon actually runs as root so having
/var/log/cobbler/* owned by the web service user is likely not only a
problem for logrote but also for cobbler itself when it opens files
there.

cu
Ludwig

--
 (o_   Ludwig Nussel
 //\
 V_/_  <http://www.suse.de/>
SUSE LINUX Products GmbH, GF: Markus Rex, HRB 16746 (AG Nuernberg)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_8a08b65c_20250125_042537.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2011/03/10/7) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110311141748.GA14348@openwall.com>
Date: Fri, 11 Mar 2011 17:17:48 +0300
From: Solar Designer <solar@...nwall.com>
To: Florian Zumbiehl <florz@...rz.de>
Cc: oss-security@...ts.openwall.com, Josh Bressers <bressers@...hat.com>,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>, Jan Kalu??a <jkaluza@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

On Thu, Mar 10, 2011 at 10:32:43PM +0100, Florian Zumbiehl wrote:
> > > | However, I think that still #6 (shell injection) and #7 (logrotate
> > > | DoS with strange characters in file names) should be considered
> > > | vulnerabilities in logrotate: ...
[...]
> I was thinking more in the direction of an existing config that includes
> a wildcard and software that uses user input to construct file names
> that would be matched by that wildcard. An example of such software
> would be samba, which tends to create per-client-host log files named
> after those hosts. I don't have a clue whether samba could be made to
> include any shell meta characters (does it even do reverse lookups for
> that?), but I guess you get the idea.

This makes sense, and I agree that it's a reason for logrotate to treat
log filenames as potentially untrusted input.  It's probably also a
reason to get CVE ids assigned.

Thank you for explaining the attack vector here!

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_42249587_20250125_042538.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](25) [[next>]](27) [[<thread-prev]](../../../2011/03/11/5) [[thread-next>]](../../../2011/03/23/11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1198312966.88302.1300136762128.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Mon, 14 Mar 2011 17:06:02 -0400 (EDT)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
        Florian Zumbiehl <florz@...rz.de>, Paul Martin <pm@...ian.org>,
        Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>,
        "Steven M. Christey" <coley@...us.mitre.org>
Subject: Re: CVE Request -- logrotate -- nine issues

>
> 6) Issue #6: logrotate: Shell command injection by using the shred
> configuration directive
>
> A shell command injection flaw was found in the way the logrotate utility
> handled shred configuration directive (intended to ensure the log files
> are not readable after their scheduled deletion). A local attacker could
> use this flaw to execute arbitrary system commands (if the logrotate was
> run under privileged system user account, root) when the logrotate
> utility was run on a log file, within attacker controllable directory.
>
> References:
> [10] <https://bugzilla.redhat.com/show_bug.cgi?id=680796>
>
> Proposed patch:
> [11] <https://bugzilla.redhat.com/show_bug.cgi?id=680796#c5>
>
> Note: Sixth CVE required. The shred option has been introduced in
> logrotate v3.7.5.

Please use CVE-2011-1154 for the above issue

> ----------
>
> 7) Issue #7: logrotate: DoS due improper escaping of file names
> within 'write state' action
>
> A denial of service flaw was found in the way the logrotate utility
> performed arguments sanitization, when performing the 'write state'
> action.  A local attacker could use this flaw to cause abort in
> subsequent logrotate runs via a specially-crafted log file name.
>
> References:
> [12] <https://bugzilla.redhat.com/show_bug.cgi?id=680797>
>
> Proposed patch:
> [13] <https://bugzilla.redhat.com/show_bug.cgi?id=680797#c3>
>

Please use CVE-2011-1155 for the above issue

Thanks.

--
    JB

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_78f1cc59_20250125_042534.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](3) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110306105427.GO24629@florz.florz.dyndns.org>
Date: Sun, 6 Mar 2011 11:54:27 +0100
From: Florian Zumbiehl <florz@...rz.de>
To: Solar Designer <solar@...nwall.com>
Cc: oss-security@...ts.openwall.com,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Paul Martin <pm@...ian.org>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi,

> If a log file directory is writable by the service pseudo-user, and you
> make both the service and patched logrotate work with it safely, there's
> still the problem of how the sysadmin can access those logs safely.

I always suspected logfiles weren't there just to be rotated ...

> The admin could "su" to the service pseudo-user, but that allows the
> compromised service to attack the admin's terminal, accessing the fd via
> /proc or ptrace of a process such as "less" running under the "su"

/proc/<pid>/fd/? I think that doesn't work. I don't know the exact
semantics, but from experience there seem to be some more checks in place
than in a "remote-dup()". That doesn't change anything about ptrace()
of course ...

> session.  Only "su" itself is immune from such attacks (since it has its
> "dumpable" flag cleared); its child processes are not.  The attacker
> would be able to print control characters directly to the terminal fd,
> and to issue ioctl's on it, changing the terminal mode.  This might have
> a security impact worse than DoS.  Sebastian - you could want to comment
> on this (I recall your research).

DoS is obvious, worse than that I'd be highly interested in details.

> A more reliable solution (in terms of being safe from the attacks being
> discussed here even when the sysadmins don't specifically try to access
> log files safely) is simply to have services create log files before
> they drop root (and indeed to have the directory only writable by root).
> This is the case for all services that we currently have in Owl.  By the
> way, our syslogd runs as non-root, but it starts up as root and it
> creates its log files in /var/log if necessary - before dropping to the
> syslogd pseudo-user.  In my opinion, that's how it should be done.

That could be problematic with services that either generally create
log files dynamically or that implement some dynamic config reload that
is intended to retain current processing state/connections/whatever.
The latter could be solved by pre-creating log files before initiating
the reload, of course.

> If a service starts up as non-root right away (such as via "su" in its
> startup script), then there's also a problem with its pidfile.  It has
> to write the pidfile as non-root, and thus into a directory writable by
> the service pseudo-user (well, or rewrite a file in-place, which has
> its own issues).  However, the pidfile is likely to be accessed by other
> parts of the system - such as by startup scripts that use
> /etc/init.d/functions and by programs invoked from there (such as
> start-stop-daemon).  Such accesses are likely to be made as root, and
> the file contents are parsed by scripts/programs running as root.  If
> such parsing is not robust when faced with incorrectly formatted input,
> we may have a local root vulnerability.  And we almost certainly have
> DoS potential via spoofed PIDs (have another service killed) and via
> links to device files, like what I described above.

Well, _actually_ pid files should just be deprecated, given that PIDs
are only really usable for anything in the parent process ... ;-)

> On Fri, Mar 04, 2011 at 06:58:17PM +0100, Florian Zumbiehl wrote:
> [...]
> > it is planned to add a new config directive that allows to specify
> > the credentials to be used for manipulating specific sets of log files,
> > thus obviating the need for separate logrotate invocations but still
> > letting the kernel take care of separating privileges.
>
> This sounds good to me, but it does not solve other problems I pointed
> out above.  Would you also add a similar option to start-stop-daemon and
> to the daemon() function in /etc/init.d/functions (or whatever a given

You mean for pid file accesses?

> As to services that a non-root user may want to run on their own, the
> user would not be able to use the new user-switching feature of logrotate
> anyway (no root access).  So the user will run an instance of logrotate
> under their account, which is already possible.

A similar problem could exist there with group-writable log directories
when multiple users are in the group.

> > I guess I don't really have much of an opinion on that. The vulnerabilities
> > should be fixed, and probably in a way that breaks existing setups as
> > little as possible, I don't really care which side is declared defective
> > and subsequently fixed in order to achieve that ;-)
>
> I care because, in this case, I think that "which side is declared
> defective" affects whether the vulnerabilities are fixed for real or
> not.  Thus, one side (service packages) needs vulnerability fixes and
> the other (logrotate) may use some hardening (but that's tricky).

Yep, I see your point and thus now am of the opinion that the affected
service packages should be fixed.

However, I think that still #6 (shell injection) and #7 (logrotate
DoS with strange characters in file names) should be considered
vulnerabilities in logrotate: It would be reasonable to assume that you
can use user input that's a valid (slash-less) filename as a (part of a)
log file name (assuming that the program is running as the same user that
inspects and rotates the logs, so the log directory being writable by
the program would not be insecure per-se) without that file name being
interpreted by a shell or causing logrotate to stop functioning,
respectively.

> Maybe logrotate should simply refuse to run when the target directory is
> writable by other than the user running logrotate (typically root), with
> an option to accept the risk and force logrotate to run anyway.  Sure,
> this would break existing security-broken setups, but it would also
> force package maintainers to fix their packages in this respect. ;-)

Precisely for the latter reason it should be done ;-)

> I am sorry for the length of this message, yet I hope it helps.

Yes, thanks a lot--without it I'd probably have ignored the fact that
people do occasionally actually want to look at log files ;-)

Florian

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_36a47d33_20250125_042531.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](25) [[next>]](27) [[<thread-prev]](25) [[thread-next>]](27) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Pine.GSO.4.64.1103041208100.3265@faron.mitre.org>
Date: Fri, 4 Mar 2011 12:22:34 -0500 (EST)
From: "Steven M. Christey" <coley@...-smtp.mitre.org>
To: Solar Designer <solar@...nwall.com>
cc: oss-security@...ts.openwall.com,
        "Steven M. Christey" <coley@...-smtp.mitre.org>,
        Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
        Florian Zumbiehl <florz@...rz.de>, Paul Martin <pm@...ian.org>,
        Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

On Fri, 4 Mar 2011, Solar Designer wrote:

> Again, as I wrote to Florian, maybe the expectations here are changing
> over the years.

In general, that's what happens in CVE.  Part of this may be that as the
more obvious/severe issues get eliminated, less-severe issues are then
given more attention.  I try to watch out for edge cases that may
"snowball" into large numbers of CVEs of limited utility - and you brought
up one such example of a snowball issue with the recognition of
technically-unsafe-but-commonly-accepted file behaviors of various Unix
commands.  However, there is no clearly-defined line (software is too
complex and dynamic for that) and risk tolerance differs widely between
individuals.  The PHP interpreted gets hit with various issues related to
sandbox escaping (or an application attacking itself), but in a hosting
scenario (fairly common these days), it's a concern to some consumers.

As remote code execution vectors dry up (for certain classes of software),
people look elsewhere.  As obvious remote vuln types get resolved, people
look for other issues of uncertain exploitability that cause a crash.
Alexander, you've had a bit of experience in suddenly turning "bugs" into
"vulnerabilities" ;-)  The target is shifting over time and, by its
nature, spreading a wider net.  As long as prioritization metrics like
CVSS follow suit (e.g. more severities of 4 and 5, less 10's), this is a
reasonable shift.

For CVE, there is no implied requirement for vendors to post advisories
for evey issue that has a CVE assigned.  Vendors decide which issues are
severe enough to directly notify their consumers about.  Granted, as the
scope of CVE widens, this may increase the vendor workload.

Interesting discussion...

- Steve

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_567dc1f3_20250125_042533.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](4) [[thread-next>]](8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110305204807.GC31605@openwall.com>
Date: Sat, 5 Mar 2011 23:48:07 +0300
From: Solar Designer <solar@...nwall.com>
To: Florian Zumbiehl <florz@...rz.de>
Cc: oss-security@...ts.openwall.com,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Paul Martin <pm@...ian.org>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi Florian and all,

I'm sorry I ran out of time for this discussion yesterday.

Here's a thought that I did not convey yet:

If a log file directory is writable by the service pseudo-user, and you
make both the service and patched logrotate work with it safely, there's
still the problem of how the sysadmin can access those logs safely.

Normally, the admin would run a command like "less -n" on one of the log
files, as root.  However, this may allow for DoS attacks via symlinks or
hard links to device files.  Say, the compromised service may replace
its log file with a link to a tape device (rewinds tape on open) or to
/dev/port (locks up some machines on read).

The admin could "su" to the service pseudo-user, but that allows the
compromised service to attack the admin's terminal, accessing the fd via
/proc or ptrace of a process such as "less" running under the "su"
session.  Only "su" itself is immune from such attacks (since it has its
"dumpable" flag cleared); its child processes are not.  The attacker
would be able to print control characters directly to the terminal fd,
and to issue ioctl's on it, changing the terminal mode.  This might have
a security impact worse than DoS.  Sebastian - you could want to comment
on this (I recall your research).

A solution could be to use group read permissions, and to view logs as
neither root nor the service pseudo-user.  This is good, but we can
hardly expect almost all sysadmins to do it in almost all cases,
although having the group pre-created and group read permissions
pre-configured in a distro would be of some help.

A more reliable solution (in terms of being safe from the attacks being
discussed here even when the sysadmins don't specifically try to access
log files safely) is simply to have services create log files before
they drop root (and indeed to have the directory only writable by root).
This is the case for all services that we currently have in Owl.  By the
way, our syslogd runs as non-root, but it starts up as root and it
creates its log files in /var/log if necessary - before dropping to the
syslogd pseudo-user.  In my opinion, that's how it should be done.

If a service starts up as non-root right away (such as via "su" in its
startup script), then there's also a problem with its pidfile.  It has
to write the pidfile as non-root, and thus into a directory writable by
the service pseudo-user (well, or rewrite a file in-place, which has
its own issues).  However, the pidfile is likely to be accessed by other
parts of the system - such as by startup scripts that use
/etc/init.d/functions and by programs invoked from there (such as
start-stop-daemon).  Such accesses are likely to be made as root, and
the file contents are parsed by scripts/programs running as root.  If
such parsing is not robust when faced with incorrectly formatted input,
we may have a local root vulnerability.  And we almost certainly have
DoS potential via spoofed PIDs (have another service killed) and via
links to device files, like what I described above.

Our policy so far has been to ensure that all pidfiles are only writable
by root, and are in a directory only writable by root.  This implies
that services are being started as root, create their pidfiles, and only
then switch to their proper pseudo-users.

On Fri, Mar 04, 2011 at 06:58:17PM +0100, Florian Zumbiehl wrote:
[...]
> it is planned to add a new config directive that allows to specify
> the credentials to be used for manipulating specific sets of log files,
> thus obviating the need for separate logrotate invocations but still
> letting the kernel take care of separating privileges.

This sounds good to me, but it does not solve other problems I pointed
out above.  Would you also add a similar option to start-stop-daemon and
to the daemon() function in /etc/init.d/functions (or whatever a given
distro uses)?  Maybe.  But even if so, the problem with admin's read
access to the logs remains.  Pre-create a log view group and pre-set
permissions to 640?  Makes sense.  Yet this is still not as good as
simply having the service start as root (and deal with log files and
pidfile as root), whenever possible at all, which I think it is possible
for system services provided in a distro.

As to services that a non-root user may want to run on their own, the
user would not be able to use the new user-switching feature of logrotate
anyway (no root access).  So the user will run an instance of logrotate
under their account, which is already possible.

Don't get me wrong, I don't really object to logrotate being enhanced.
I just want to point out a few things (some of this is my opinion rather
than "the absolute truth"):

1. Other service packages need to be fixed anyway.  Having logs and
pidfiles in service pseudo-user writable directories is problematic in
more ways.  Those packages are the vulnerable/guilty ones.

2. Such an enhancement to logrotate is not as useful as it might appear
at first.

3. The current behavior of logrotate is not exactly a vulnerability in
logrotate.  Lacking a potentially desirable security-relevant feature,
sure.  Vulnerability in logrotate, no.

> Now, I guess the major motivation for such an approach over executing
> logrotate as the unprivileged user directly is backwards compatibility
> and how much of a nightmare the transition will be, somehow implicitly
> assuming that the similarity with the old mode of operation should
> provide for an easier change.

If you compare these two approaches - having logrotate switch
credentials vs. starting multiple instances of logrotate with proper
credentials right away - then I agree that the former approach might
be cleaner (same config file for all, etc.)  However, neither solves
other issues (admin's access to log files, and system scripts/programs'
access to and parsing of pidfiles).

> However, this implicit assumption may actually be just that and nothing
> more. Namely, there are some ideas how logrotate could guess the
> credentials for some common setups when none have been specified in the
> config file so as to avoid having to security-patch dozens of packages,
> at least as a transitional mechanism. But it's rather unclear whether
> any of that will actually work to a sufficient degree to be useful (and
> the security of the heuristics to be used is what most of the remaining
> contention as to how to fix is about).

Oh, you do need to patch those dozens of packages for other reasons as
well.  So a possible change to logrotate is just a hardening measure.
This may be fine if it's not used as an excuse not to fix those other
packages at all.  But if we say that we're fixing vulnerabilities in
logrotate, we're sort of making such an excuse.  It's better to say that
we're hardening logrotate to be safer when faced with broken service
packages, which are then to be fixed one by one.

Yet another issue/risk I did not mention/explain explicitly so far:

I've seen packages where the maintainer made the mistake of making the
log files directory writable by the service pseudo-user even though the
service did not depend on that in any way.  That is, the service created
its log files before dropping root, as it should.  This was the case for
the nginx package I mentioned in this thread.  A possible logrotate
"fix" would not solve the problem to a significant degree: similar
attacks would remain possible against service startup (replace the log
file with a link, wait for service restart, enjoy the link target being
written to by the service).  The fix, of course, is to change the log
files directory ownership in the package.  Not to patch logrotate, which
is only a workaround for some of the attack vectors.

Package maintainers commonly make other mistakes of this nature as well,
making the service pseudo-user the owner of any/all of the following:
directory the service chroot's to, program binaries, config files, and
indeed pidfiles as mentioned above.  Obviously, none of these are
fixable in logrotate.  In my opinion, log file directories are just a
special case of this problem, and this special case does not move
responsibility from service packages to logrotate.

> If that doesn't work out and you have to patch dozens of packages in
> order to change their logrotate configs, you probably may just as well
> patch packages to switch to using their own logrotate instance. Or to a
> different strategy for logfile handling altogether.

Right.  The latter.

> In particular so,
> given that quite a few of the affected packages in the case of debian
> (and I guess it's similar for other distros) do a chown -R on the log
> dir in their postinst scripts and thus will need a security patch for
> that anyhow.

Right.  They should simply keep that directory owned by root and have
the service support that (if not already supported or even assumed,
which is often/usually the case).

> I guess I don't really have much of an opinion on that. The vulnerabilities
> should be fixed, and probably in a way that breaks existing setups as
> little as possible, I don't really care which side is declared defective
> and subsequently fixed in order to achieve that ;-)

I care because, in this case, I think that "which side is declared
defective" affects whether the vulnerabilities are fixed for real or
not.  Thus, one side (service packages) needs vulnerability fixes and
the other (logrotate) may use some hardening (but that's tricky).

Maybe logrotate should simply refuse to run when the target directory is
writable by other than the user running logrotate (typically root), with
an option to accept the risk and force logrotate to run anyway.  Sure,
this would break existing security-broken setups, but it would also
force package maintainers to fix their packages in this respect. ;-)

I am sorry for the length of this message, yet I hope it helps.

Thanks,

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_4961b779_20250125_042537.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](3) [[thread-next>]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110310210338.GA11962@openwall.com>
Date: Fri, 11 Mar 2011 00:03:38 +0300
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com, Florian Zumbiehl <florz@...rz.de>
Cc: Josh Bressers <bressers@...hat.com>,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>, Jan Kalu??a <jkaluza@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

Florian, all -

I'm sorry I failed to find time to comment on many postings in this
thread, and also in the thread about a possible vendor-sec alternative.

On Thu, Mar 10, 2011 at 07:08:38PM +0100, Florian Zumbiehl wrote:
> What about these?:
>
> | However, I think that still #6 (shell injection) and #7 (logrotate
> | DoS with strange characters in file names) should be considered
> | vulnerabilities in logrotate: It would be reasonable to assume that you
> | can use user input that's a valid (slash-less) filename as a (part of a)
> | log file name (assuming that the program is running as the same user that
> | inspects and rotates the logs, so the log directory being writable by
> | the program would not be insecure per-se) without that file name being
> | interpreted by a shell or causing logrotate to stop functioning,
> | respectively.

Based on the description above only (I have not looked at the code), it
appears that on one hand the program might behave unexpectedly, but on
the other no privilege boundary is crossed.

My understanding is that these issues would need to be treated as
vulnerabilities (and assigned CVE ids) only if they can be demonstrated
to have security impact (as in: someone manages to do more than they
were supposed to be able to) in an otherwise sane setup.

I guess this could be the case if logrotate config files, including log
filename patterns, are generated based on input from another user
(different than the service pseudo-user and not root) - e.g., via a
web-based administration interface with its own access control.
However, even if so (which already feels somewhat unrealistic) I have
difficulty imagining a web-based admin user who would be permitted to
configure log rotation (including filename patterns) yet would not
otherwise have access to the service pseudo-user account (perhaps the
person would be the server admin, including full root access).

To summarize, it feels like in theory a privilege boundary could exist
here and be crossed on certain systems with extra software, but in
practice this is unlikely and it would indicate poor design of another
piece of software or/and false sense of security put into that privilege
boundary.  I don't know what this means for CVE id assignment per the
current "rules".

Once again, I am relying on the description posted in here only (and
moreover on my interpretation of it), so maybe the actual situation is
different.

I usually don't care much about CVE ids being assigned or not.  I cared
about that for the majority of these logrotate issues because it felt
like it could affect whether other packages will be fixed or not.  This
concern does not apply in the case of these two issues.  Thus, I have no
objections to CVE ids being assigned for them, even though we're not
going to treat them as vulnerabilities (based on info available so far).

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_d290b555_20250125_042535.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[<thread-prev]](10) [[thread-next>]](../../../2011/03/08/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1805319507.426828.1299529858053.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Mon, 7 Mar 2011 15:30:58 -0500 (EST)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: Solar Designer <solar@...nwall.com>,
        "Steven M. Christey" <coley@...us.mitre.org>,
        Stefan Fritsch <sf@...itsch.de>, Florian Zumbiehl <florz@...rz.de>,
        Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>,
        Jan Kaluža <jkaluza@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

----- Original Message -----
> On Mon, Mar 07, 2011 at 01:21:05PM +0100, Jan Kaluža wrote:
>
> > I think logrotate should skip rotation of files in unsafe
> > directories and show error message instead. Logrotate should also
> > contain something like "--force" switch (this name is already used,
> > so we have to find better one, but I don't have anything better in
> > mind just now). With this switch logrotate should *not* skip unsafe
> > directories and rotate them as it currently does, but show the error
> > message. Basically it allows backward compatibility.
>
> "--override-unsafe-directory-check" perhaps? Make it a long option,
> so that there is no doubt that the user is doing something that's
> potentially dangerous.
>
> (I am following this discussion with great interest.)
>

It seems there is now a consensus on this (at least that's how I'm reading
it). Here is what I plan to do with CVE ids unless someone speaks up.

As best as I can tell, logrotate only needs a CVE id for this:

    8) Issue #8: logrotate: TOCTOU race condition by creation of new files
       (between opening the file and moment, final permissions have been
       applied) [information disclosure]

        It was found that logrotate utility used insecure default
        permissions, when creating of new files (time-of-check,
        time-of-use, TOCTOU race condition).  In some specific
        configurations, a local attacker could use this flaw to open the
        new file before the final permissions have been applied, leading to
        disclosure of sensitive information. A different vulnerability
        than:
        [1] <https://bugzilla.redhat.com/show_bug.cgi?id=680787> (Issue #1)

        References:
        [14] <https://bugzilla.redhat.com/show_bug.cgi?id=680798>

        Source code background (issue reason):
        [15] <https://bugzilla.redhat.com/show_bug.cgi?id=680798#c3>

We then will need to assign IDs for various broken uses of /var/log (If
someone has a list of the currently known ones, please pass it along)

What does everyone think?

Thanks.

--
    JB

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_87934c30_20250125_042537.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](../../../2011/03/11/1) [[<thread-prev]](6) [[thread-next>]](../../../2011/03/11/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110310213243.GA3051@florz.florz.dyndns.org>
Date: Thu, 10 Mar 2011 22:32:43 +0100
From: Florian Zumbiehl <florz@...rz.de>
To: Solar Designer <solar@...nwall.com>
Cc: oss-security@...ts.openwall.com, Josh Bressers <bressers@...hat.com>,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>, Jan Kalu??a <jkaluza@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi,

> On Thu, Mar 10, 2011 at 07:08:38PM +0100, Florian Zumbiehl wrote:
> > What about these?:
> >
> > | However, I think that still #6 (shell injection) and #7 (logrotate
> > | DoS with strange characters in file names) should be considered
> > | vulnerabilities in logrotate: It would be reasonable to assume that you
> > | can use user input that's a valid (slash-less) filename as a (part of a)
> > | log file name (assuming that the program is running as the same user that
> > | inspects and rotates the logs, so the log directory being writable by
> > | the program would not be insecure per-se) without that file name being
> > | interpreted by a shell or causing logrotate to stop functioning,
> > | respectively.
[...]
> To summarize, it feels like in theory a privilege boundary could exist
> here and be crossed on certain systems with extra software, but in
> practice this is unlikely and it would indicate poor design of another
> piece of software or/and false sense of security put into that privilege
> boundary.  I don't know what this means for CVE id assignment per the
> current "rules".

I was thinking more in the direction of an existing config that includes
a wildcard and software that uses user input to construct file names
that would be matched by that wildcard. An example of such software
would be samba, which tends to create per-client-host log files named
after those hosts. I don't have a clue whether samba could be made to
include any shell meta characters (does it even do reverse lookups for
that?), but I guess you get the idea.

Florian

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_f5865e21_20250125_042535.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](../../../2011/03/06/6) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4D74CDB1.2060503@redhat.com>
Date: Mon, 07 Mar 2011 13:21:05 +0100
From: Jan Kaluža <jkaluza@...hat.com>
To: Solar Designer <solar@...nwall.com>
CC: oss-security@...ts.openwall.com,
        "Steven M. Christey" <coley@...us.mitre.org>,
        Stefan Fritsch <sf@...itsch.de>, Florian Zumbiehl <florz@...rz.de>,
        Paul Martin <pm@...ian.org>, Petr Uzel <petr.uzel@...e.cz>,
        Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi all,

sorry for not replying earlier, but I hadn't Internet access during weekend.

On 03/05/2011 10:35 PM, Solar Designer wrote:
> On Fri, Mar 04, 2011 at 07:51:02PM +0100, Jan Lieskovsky wrote:
>> I got your point. But still think there is a difference between the
>> case privileged system user would use 'cp' by accident in untrusted
>> directory and corrupt the system and case, when some utility is
>> running under privileged user account on regular basis and not
>> taking 'untrusted directories' into account / not having a policy,
>> how to behave while processing them.
>
> Definitely.  I fully agree that there's a vulnerability in the system if
> it has a non-root writable log directory yet runs logrotate on that
> directory as root.  The question is what part of the system the
> vulnerability lies in.  I say that it's in the directory permissions,
> which usually come from the service package.  We could harden logrotate
> to deal with such misconfigurations in a safer way (once we figure out
> how), but not blame it.

I fully agree. As it has been already said in this thread, we have
thought about some ways how to "fix" it only on logrotate's side, but it
has been proved it's practically impossible and after reading this
thread I think (and agree with you) it's really more global problem.

I also think the fix in affected packages is needed to fix this problem
(We have tried to get around this, but I don't believe it's possible).

What I would suggest as logrotate improvement is to create new config
directive (Florian already described this strategy in this thread) which
could be used by admin to set proper user/group for particular rotation.
This doesn't fix the global problem, but improves handling of it by
logrotate. I already have patch, but I'll wait for end of this discussion.

I think logrotate should skip rotation of files in unsafe directories
and show error message instead. Logrotate should also contain something
like "--force" switch (this name is already used, so we have to find
better one, but I don't have anything better in mind just now). With
this switch logrotate should *not* skip unsafe directories and rotate
them as it currently does, but show the error message. Basically it
allows backward compatibility.

>> For example CVE-2010-2055 has been assigned to Ghostscript's reading
>> of initialization files from $CWD. CVE-2010-3349, 3350, 3355, 3369 and
>> many others have been assigned to insecure library loading vulnerabilities.
>>
>> In comparison with the above, how running of logrotate utlity on untrusted
>> directory differs? Even when it is often run regularly and under root
>> user account.
>
> Reading files from cwd, unless very explicitly documented, may
> reasonably be an unexpected risk for a knowledgeable user.  In contrast,
> logrotate is being explicitly told to access a certain directory.  It's
> more similar to cp'ing a file, where you give the filename explicitly.
> So neither cp nor logrotate are to blame.
>
>> How many system users check the directory permissions prior running
>> the utility? How many administrators check them regularly?
>
> If properly configured initially, log directory permissions are not to
> change on their own.  Otherwise, your argument could be extended onto
> any other part of the system - "how many administrators check the
> permissions on /, on /bin/sh, and on /etc/passwd regularly?"  This
> becomes a system integrity checking question, which applies or does
> not apply regardless of logrotate.

Agree.

>> Agree, the majority of these issue would disappear when logrotate
>> would just refuse to process such a directory. But currently it
>> doesn't. That CVE request is just attempt to pinpoint the need
>> of change.
>
> OK, the need of change.  Would that change be, as you say, to have
> logrotate refuse to process an unsafe directory?  If so, I support this
> (although calling the lack of this hardening measure a vulnerability in
> logrotate is a stretch).  However, I am concerned that another change
> may go in (fine by itself) and it would be used as an excuse not to fix
> the service packages (not fine).  I am commenting in this thread mostly
> to avoid responsibility being taken off those flawed service packages.
> I really don't mind having logrotate hardened in one way or another as
> long as the service packages are to be fixed as well.

That's what my first reaction in this mail is about. We haven't found
any solution which would fix current situation properly just by patching
logrotate without breaking backward compatibility (and if you break
backward compatibility, then packages has to be fixed anyway).

>>> Almost all other commands and programs are unsafe on untrusted
>>> directories.  In my opinion, that's the only correct assumption for a
>>> sysadmin to make, and any other assumption is naive.
>>
>> Agree here. But as stated above, how many sysadmins perform this task
>> prior running the tool? How many do it regularly?
> [...]
>> See above. Ghostscript vs logrotate. How untrusted directory for GS
>> differs from untrusted directory for logrotate?
>
> I think I've addressed these same questions above, so I am not repeating
> the answers here.
>
>>> No software is perfect, and almost any piece of software can be improved
>>> endlessly.  But that's mere rhetoric.
>>
>> Sure. Just wanted to differentiate the 'unsupported functionality'
>> from undocumented functionality, which may be harmful.
>
> Understood and agreed.  But in this case we're dealing with
> "undocumented functionality" that is expected by anyone familiar
> with Unix.  Much like it is expected that "cp" in an untrusted directory
> may happen to follow a link.  This is different from some program
> checking cwd for its config file, which could not be inferred from
> general Unix experience.
>
>>> I don't mind logrotate being hardened against these issues.  We do a lot
>>> of hardening in other areas, so why not here.  I just don't blame
>>> logrotate for the issues.
>>
>> See above -- absence of policy how to deal with untrusted directories.
>
> Yes, but that's the case for almost all other Unix programs, with very
> few exceptions.  So a person familiar with Unix should assume that if no
> policy is stated, the program is unsafe to use on untrusted directories.
>
>> How many users check content of their $CWD prior launching gs?
>
> I agree with you that undocumented reading from cwd is a vulnerability.
> (Also, even if users checked their cwd, there would be a race.)
>
> This is just different from the issue at hand.  I've tried to explain
> (in several paragraphs above) why/how I see it different.
>
>> Same from my side. Thanks for the thoughts, which initiated (partial)
>> discussion.
>
> A "full" discussion of the issues involved can be very time-consuming,
> as evidenced by the length of these messages...  So I think we'll have
> to wrap up soon. ;-)
>
> Thanks,
>
> Alexander

Regards,
Jan Kaluza

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_bac2e8fa_20250125_042532.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](27) [[next>]](29) [[<thread-prev]](27) [[thread-next>]](29) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110304175214.GA26198@openwall.com>
Date: Fri, 4 Mar 2011 20:52:14 +0300
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Cc: Florian Zumbiehl <florz@...rz.de>,
	"Steven M. Christey" <coley@...-smtp.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Paul Martin <pm@...ian.org>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>, Jan Lieskovsky <jlieskov@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

On Fri, Mar 04, 2011 at 12:05:02PM -0500, Steven M. Christey wrote:
>
> If there's a common usage scenario that doesn't stem from blatant
> administrator negligence, then a CVE is probably still appropriate.
> ("blatant admin negligence" might be, say, if an admin arbitrarily makes a
> script setuid, or modifies the perms for an executable or config file to
> be world-writable.)

I think that "chmod 777 /var/log" is "blatant admin negligence".  As to,
say, "chown nginx /var/log/nginx", it could be negligence or it could be
lack of familiarity with the risks involved.  So I am willing to admit
that it's not necessarily negligence that turns those issues into
vulnerabilities on specific systems.

> We will sometimes write the CVE description more as an "adminisrator
> practice" than as "fault of the software."

Oh, this is something I did not realize.  A lot of people assume that
CVEs "blame" the software and its authors for having made an error.

It felt wrong, say, to blame a text editor for being unsafe to use on
files in untrusted directories when such unsafety was the typical and
expected situation for text editors in general.

Thank you for your responses!

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_f5ab76fe_20250125_042532.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](28) [[next>]](30) [[<thread-prev]](28) [[thread-next>]](30) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Pine.GSO.4.64.1103041254480.3265@faron.mitre.org>
Date: Fri, 4 Mar 2011 13:02:38 -0500 (EST)
From: "Steven M. Christey" <coley@...-smtp.mitre.org>
To: oss-security@...ts.openwall.com
cc: Florian Zumbiehl <florz@...rz.de>,
        "Steven M. Christey" <coley@...-smtp.mitre.org>,
        Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
        Paul Martin <pm@...ian.org>, Petr Uzel <petr.uzel@...e.cz>,
        Thomas Biege <thomas@...e.de>, Jan Lieskovsky <jlieskov@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

On Fri, 4 Mar 2011, Solar Designer wrote:

> On Fri, Mar 04, 2011 at 12:05:02PM -0500, Steven M. Christey wrote:
>>
>> We will sometimes write the CVE description more as an "adminisrator
>> practice" than as "fault of the software."
>
> Oh, this is something I did not realize.  A lot of people assume that
> CVEs "blame" the software and its authors for having made an error.

We do this *if* we are aware of the subtleties.  But this often requires
an understanding of the expected software behavior, and CVE covers
thousands of different applications each year.  Unfortunately, we can't
have that level of understanding about each app.

> It felt wrong, say, to blame a text editor for being unsafe to use on
> files in untrusted directories when such unsafety was the typical and
> expected situation for text editors in general.

Some items can be assigned a CVE without deep thought about the larger
context.  This may happen due to volume, time constraints, or an
under-specified attack scenario by the requester.  That may be the case
with the case you're talking about here, but I don't remember it.

- Steve

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_91cc482c_20250125_042534.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2011/03/05/8) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4D735188.6060300@gmail.com>
Date: Sun, 06 Mar 2011 16:19:04 +0700
From: Pavel Labushev <p.labushev@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE Request -- logrotate -- nine issues

06.03.2011 02:21, Solar Designer пишет:

>> At least in Gentoo there are packages
>> (ebuilds and eclasses) that create user/group-writable directories in
>> /var/log and enable logrotate to handle the log files there.
>
> Is this something you can get fixed?

I hope it will be fixed soon. Would be nice to have CVEs assigned for these
issues anyway, just to make people aware. If even package maintainers got it
wrong, I bet there's a legion of users who also did.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_9f06125f_20250125_042533.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[<thread-prev]](6) [[thread-next>]](../../../2011/03/06/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110305213552.GA32000@openwall.com>
Date: Sun, 6 Mar 2011 00:35:52 +0300
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Florian Zumbiehl <florz@...rz.de>, Paul Martin <pm@...ian.org>,
	Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

On Fri, Mar 04, 2011 at 07:51:02PM +0100, Jan Lieskovsky wrote:
> I got your point. But still think there is a difference between the
> case privileged system user would use 'cp' by accident in untrusted
> directory and corrupt the system and case, when some utility is
> running under privileged user account on regular basis and not
> taking 'untrusted directories' into account / not having a policy,
> how to behave while processing them.

Definitely.  I fully agree that there's a vulnerability in the system if
it has a non-root writable log directory yet runs logrotate on that
directory as root.  The question is what part of the system the
vulnerability lies in.  I say that it's in the directory permissions,
which usually come from the service package.  We could harden logrotate
to deal with such misconfigurations in a safer way (once we figure out
how), but not blame it.

> For example CVE-2010-2055 has been assigned to Ghostscript's reading
> of initialization files from $CWD. CVE-2010-3349, 3350, 3355, 3369 and
> many others have been assigned to insecure library loading vulnerabilities.
>
> In comparison with the above, how running of logrotate utlity on untrusted
> directory differs? Even when it is often run regularly and under root
> user account.

Reading files from cwd, unless very explicitly documented, may
reasonably be an unexpected risk for a knowledgeable user.  In contrast,
logrotate is being explicitly told to access a certain directory.  It's
more similar to cp'ing a file, where you give the filename explicitly.
So neither cp nor logrotate are to blame.

> How many system users check the directory permissions prior running
> the utility? How many administrators check them regularly?

If properly configured initially, log directory permissions are not to
change on their own.  Otherwise, your argument could be extended onto
any other part of the system - "how many administrators check the
permissions on /, on /bin/sh, and on /etc/passwd regularly?"  This
becomes a system integrity checking question, which applies or does
not apply regardless of logrotate.

> Agree, the majority of these issue would disappear when logrotate
> would just refuse to process such a directory. But currently it
> doesn't. That CVE request is just attempt to pinpoint the need
> of change.

OK, the need of change.  Would that change be, as you say, to have
logrotate refuse to process an unsafe directory?  If so, I support this
(although calling the lack of this hardening measure a vulnerability in
logrotate is a stretch).  However, I am concerned that another change
may go in (fine by itself) and it would be used as an excuse not to fix
the service packages (not fine).  I am commenting in this thread mostly
to avoid responsibility being taken off those flawed service packages.
I really don't mind having logrotate hardened in one way or another as
long as the service packages are to be fixed as well.

> >Almost all other commands and programs are unsafe on untrusted
> >directories.  In my opinion, that's the only correct assumption for a
> >sysadmin to make, and any other assumption is naive.
>
> Agree here. But as stated above, how many sysadmins perform this task
> prior running the tool? How many do it regularly?
[...]
> See above. Ghostscript vs logrotate. How untrusted directory for GS
> differs from untrusted directory for logrotate?

I think I've addressed these same questions above, so I am not repeating
the answers here.

> >No software is perfect, and almost any piece of software can be improved
> >endlessly.  But that's mere rhetoric.
>
> Sure. Just wanted to differentiate the 'unsupported functionality'
> from undocumented functionality, which may be harmful.

Understood and agreed.  But in this case we're dealing with
"undocumented functionality" that is expected by anyone familiar
with Unix.  Much like it is expected that "cp" in an untrusted directory
may happen to follow a link.  This is different from some program
checking cwd for its config file, which could not be inferred from
general Unix experience.

> >I don't mind logrotate being hardened against these issues.  We do a lot
> >of hardening in other areas, so why not here.  I just don't blame
> >logrotate for the issues.
>
> See above -- absence of policy how to deal with untrusted directories.

Yes, but that's the case for almost all other Unix programs, with very
few exceptions.  So a person familiar with Unix should assume that if no
policy is stated, the program is unsafe to use on untrusted directories.

> How many users check content of their $CWD prior launching gs?

I agree with you that undocumented reading from cwd is a vulnerability.
(Also, even if users checked their cwd, there would be a race.)

This is just different from the issue at hand.  I've tried to explain
(in several paragraphs above) why/how I see it different.

> Same from my side. Thanks for the thoughts, which initiated (partial)
> discussion.

A "full" discussion of the issues involved can be very time-consuming,
as evidenced by the length of these messages...  So I think we'll have
to wrap up soon. ;-)

Thanks,

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_8178c3dc_20250125_042531.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](26) [[next>]](28) [[<thread-prev]](26) [[thread-next>]](28) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110304172749.GA26083@openwall.com>
Date: Fri, 4 Mar 2011 20:27:49 +0300
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Florian Zumbiehl <florz@...rz.de>, Paul Martin <pm@...ian.org>,
	Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

Jan,

I think I misread/misunderstood a portion of what you wrote
(specifically, what you referred to by "the disclination") when I
replied with the below.  Please disregard this piece.  The rest of my
response still stands.

On Fri, Mar 04, 2011 at 08:05:03PM +0300, Solar Designer wrote:
> On Fri, Mar 04, 2011 at 04:35:03PM +0100, Jan Lieskovsky wrote:
> > just saying the disclination like the above doesn't help anyone.
>
> I think it does.  But I am willing to shut up. ;-)  I sure am not going
> to post stuff that people don't want to receive/read. ;-)

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_43bc960a_20250125_042531.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](24) [[next>]](26) [[<thread-prev]](24) [[thread-next>]](26) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Pine.GSO.4.64.1103041200201.3265@faron.mitre.org>
Date: Fri, 4 Mar 2011 12:05:02 -0500 (EST)
From: "Steven M. Christey" <coley@...-smtp.mitre.org>
To: Solar Designer <solar@...nwall.com>
cc: Florian Zumbiehl <florz@...rz.de>, oss-security@...ts.openwall.com,
        "Steven M. Christey" <coley@...-smtp.mitre.org>,
        Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
        Paul Martin <pm@...ian.org>, Petr Uzel <petr.uzel@...e.cz>,
        Thomas Biege <thomas@...e.de>, Jan Lieskovsky <jlieskov@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

If there's a common usage scenario that doesn't stem from blatant
administrator negligence, then a CVE is probably still appropriate.
("blatant admin negligence" might be, say, if an admin arbitrarily makes a
script setuid, or modifies the perms for an executable or config file to
be world-writable.)

We will sometimes write the CVE description more as an "adminisrator
practice" than as "fault of the software."

For example, default passwords are fair game; arguably, if the admin
didn't read page 24 of the documentation that said "change the default
password," this is more the admin's fault than the software's fault... BUT
the issue has to be dealt with, either way, so a CVE becomes a "signal"
for that action to take place, whether it came from the software or from
the user.

Not everything is that clean and straightforward of course, but that's the
general thinking.

- Steve

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_fc89a575_20250125_042535.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](5) [[thread-next>]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110307125419.GA12931@nowster.org.uk>
Date: Mon, 7 Mar 2011 12:54:19 +0000
From: Paul Martin <pm@...ian.org>
To: Jan Kaluža <jkaluza@...hat.com>
Cc: Solar Designer <solar@...nwall.com>, oss-security@...ts.openwall.com,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Florian Zumbiehl <florz@...rz.de>,
	Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

On Mon, Mar 07, 2011 at 01:21:05PM +0100, Jan Kaluža wrote:

> I think logrotate should skip rotation of files in unsafe
> directories and show error message instead. Logrotate should also
> contain something like "--force" switch (this name is already used,
> so we have to find better one, but I don't have anything better in
> mind just now). With this switch logrotate should *not* skip unsafe
> directories and rotate them as it currently does, but show the error
> message. Basically it allows backward compatibility.

"--override-unsafe-directory-check" perhaps?  Make it a long option,
so that there is no doubt that the user is doing something that's
potentially dangerous.

(I am following this discussion with great interest.)

--
Paul Martin <pm@...ian.org>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_cd082803_20250125_042529.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](15) [[next>]](17) [[thread-next>]](17) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4D70F25F.6030603@redhat.com>
Date: Fri, 04 Mar 2011 15:08:31 +0100
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>
CC: oss-security <oss-security@...ts.openwall.com>,
        Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
        Florian Zumbiehl <florz@...rz.de>, Paul Martin <pm@...ian.org>,
        Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>
Subject: CVE Request -- logrotate -- nine issues

Hello Josh, Steve, vendors,

   we have been contacted by Stefan Fritsch of Debian Security Team
about presence of nine security flaws in the logrotate utility
(the list is provided below).

These issues have been discovered by Florian Zumbiehl, some by
Paul Martin (the Debian logrotate maintainer) and Stefan Fritsch
in the subsequent discussion.

Could you allocate CVE ids for these issues?

Note: We would appreciate if it would be possible to allocate nine
       CVE ids (even the request amount being high) because later
       merge os some issues into one could bring yet more confusion,
       what are the issues and what would the the corresponding patches
      (thus potentially even more CVEs needed later due incomplete
       patches etc). This way the flaws are separated by impact /
       relevant code affected part.

Thanks && Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

P.S.: Apologize for such a long post, but there wasn't other way
       how to share all the information at once.

===============================================================================

1) Issue #1: logrotate: TOCTOU race condition by creating the compressed
              or copied log file (information disclosure)

       A file access race condition (time-of-check, time-of-use, TOCTOU
race condition) was found in the way logrotate determines the permissions
to newly created files when compression or copying of a log file has been
requested. If the logrotate utility was run on a log file contained within
an attacker controllable directory, a local attacker could use this flaw
to trick the logrotate utility into creating the compressed or copied file
with user selected permissions, potentially leading to disclosure of
sensitive information.

References:
[1] <https://bugzilla.redhat.com/show_bug.cgi?id=680787>

Source code background (issue reason):
[2] <https://bugzilla.redhat.com/show_bug.cgi?id=680787#c4>

Note: First CVE required.

-----------

2) Issue #2: logrotate: Race condition by creation of new files after
              renaming the previous version if compression or copy
              creation requested (arbitrary system file integrity corruption)

       A race condition was found in the way the logrotate utility created
new files after renaming the previous version if compression or creation
of a copy was requested in the configuration file. If the logrotate utility
was run on a log file contained within an attacker controllable directory,
a local attacker could use this flaw to trick the logrotate utility into
replacing arbitrary system files (if logrotate was run under privileged
user account, root) with the copied or compressed contents of a log file.

References:
[3] <https://bugzilla.redhat.com/show_bug.cgi?id=680789>

Source code background (issue reason):
[4] <https://bugzilla.redhat.com/show_bug.cgi?id=680789#c7>

Proposed patch:
[5] <https://bugzilla.redhat.com/show_bug.cgi?id=680789#c3>

Note: Second CVE required.

----------

3) Issue #3: logrotate: TOCTOU race condition by creation of log files after
              rotation (ability to change file owner / mode on arbitrary system
              files)

       A file access race condition (time-of-check, time-of-use, TOCTOU
race condition) was found in the way logrotate utility created the log
files after rotation, when their immediate creation ("create"
configuration option) was requested. A local attacker could use this
flaw to change file owner or mode on arbitrary system files to the file
owner and mode specified in logrotate's configuration. (if the logrotate
utility was run under privileged user, root, and logrotate was run on an
attacker controllable directory).

References:
[6] <https://bugzilla.redhat.com/show_bug.cgi?id=680790>

Source code background (issue reason):
[7] <https://bugzilla.redhat.com/show_bug.cgi?id=680790#c3>

Note: Third CVE required.

----------

4) Issue #4: logrotate: Incorrect flags used for truncating of original log
              file in copytruncate mode (arbitrary file system truncation via
              symlink / hardlink attacks)

       It was found that logrotate utility used incorrect flags for truncation
of the original log file in place after creating a copy (copytruncate mode).
A local attacker could use this flaw to truncate arbitrary system file (if
the logrotate utility was run under privileged user account, root) by
performing symlink or hardlink attacks.

References:
[8] <https://bugzilla.redhat.com/show_bug.cgi?id=680792>

Note: Fourth CVE required.

------------

5) Issue #5: logrotate: Information disclosure by performing email
              notifications

       An information disclosure flaw was found in the way the logrotate
utility performed email notifications about rotating of out of existence
log files. A local attacker could use this flaw to conduct symlink or
hardlink attacks and send arbitrary system files (if the logrotate utility
was run under privileged system user, root) to the selected email recipient.

References:
[9] <https://bugzilla.redhat.com/show_bug.cgi?id=680795>

Note: Fifth CVE required.

----------

6) Issue #6: logrotate: Shell command injection by using the shred
              configuration directive

       A shell command injection flaw was found in the way the logrotate
utility handled shred configuration directive (intended to ensure the log
files are not readable after their scheduled deletion). A local attacker
could use this flaw to execute arbitrary system commands (if the logrotate
was run under privileged system user account, root) when the logrotate
utility was run on a log file, within attacker controllable directory.

References:
[10] <https://bugzilla.redhat.com/show_bug.cgi?id=680796>

Proposed patch:
[11] <https://bugzilla.redhat.com/show_bug.cgi?id=680796#c5>

Note: Sixth CVE required. The shred option has been introduced in logrotate
       v3.7.5.

----------

7) Issue #7:  logrotate: DoS due improper escaping of file names
               within 'write state' action

       A denial of service flaw was found in the way the logrotate utility
performed arguments sanitization, when performing the 'write state' action.
A local attacker could use this flaw to cause abort in subsequent logrotate
runs via a specially-crafted log file name.

References:
[12] <https://bugzilla.redhat.com/show_bug.cgi?id=680797>

Proposed patch:
[13] <https://bugzilla.redhat.com/show_bug.cgi?id=680797#c3>

Note: Seventh CVE required.

----------

8) Issue #8: logrotate: TOCTOU race condition by creation of new files (between
              opening the file and moment, final permissions have been applied)
              [information disclosure]

       It was found that logrotate utility used insecure default permissions,
when creating of new files (time-of-check, time-of-use, TOCTOU race condition).
In some specific configurations, a local attacker could use this flaw to open
the new file before the final permissions have been applied, leading to
disclosure of sensitive information. A different vulnerability than:
[1] <https://bugzilla.redhat.com/show_bug.cgi?id=680787> (Issue #1)

References:
[14] <https://bugzilla.redhat.com/show_bug.cgi?id=680798>

Source code background (issue reason):
[15] <https://bugzilla.redhat.com/show_bug.cgi?id=680798#c3>

Note: Eight-th CVE required.

----------

9) Issue #9: logrotate: Improper administration of log files located in
              world-writable directories

       A security flaw was found in the way the logrotate utility performed
administration of log files, located in group / world writable directories.
A local attacker could use this flaw to disclose sensitive information,
execute arbitrary code or cause a denial of service, via unintended /
unprivileged later modifications of log file directory in question.

Different vulnerability than:
[1] <https://bugzilla.redhat.com/show_bug.cgi?id=680787> (Issue #1),
[2] <https://bugzilla.redhat.com/show_bug.cgi?id=680789> (Issue #2),
[3] <https://bugzilla.redhat.com/show_bug.cgi?id=680790> (Issue #3),
[4] <https://bugzilla.redhat.com/show_bug.cgi?id=680792> (Issue #4),
[5] <https://bugzilla.redhat.com/show_bug.cgi?id=680795> (Issue #5),
[6] <https://bugzilla.redhat.com/show_bug.cgi?id=680796> (Issue #6),
[7] <https://bugzilla.redhat.com/show_bug.cgi?id=680797> (Issue #7), and
[8] <https://bugzilla.redhat.com/show_bug.cgi?id=680798> (Issue #8).

References:
[16] <https://bugzilla.redhat.com/show_bug.cgi?id=680799>

Note: Nineth CVE required.

===============================================================================

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_a0c4feeb_20250125_042534.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](4) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110306122606.GA892@openwall.com>
Date: Sun, 6 Mar 2011 15:26:06 +0300
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE Request -- logrotate -- nine issues

Pavel,

On Sun, Mar 06, 2011 at 04:19:04PM +0700, Pavel Labushev wrote:
> 06.03.2011 02:21, Solar Designer пишет:
>
> >> At least in Gentoo there are packages
> >> (ebuilds and eclasses) that create user/group-writable directories in
> >> /var/log and enable logrotate to handle the log files there.
> >
> > Is this something you can get fixed?
>
> I hope it will be fixed soon. Would be nice to have CVEs assigned for these
> issues anyway, just to make people aware. If even package maintainers got it
> wrong, I bet there's a legion of users who also did.

For this to happen, you need to post info on the specific issues and
request CVEs for them.  Will you do this, please?  (Perhaps start a new
thread, or even a thread per package - that's up to you.)

Thanks!

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_89294968_20250125_042532.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](32) [[next>]](../../../2011/03/05/1) [[<thread-prev]](32) [[thread-next>]](../../../2011/03/05/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4D7148F5.2090205@gmail.com>
Date: Sat, 05 Mar 2011 03:17:57 +0700
From: Pavel Labushev <p.labushev@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE Request -- logrotate -- nine issues

04.03.2011 21:52, Solar Designer пишет:

> I've just skimmed over the list, and I only see one issue that I'd call
> a vulnerability in logrotate, issue #8.  And we need more info on #5.
>
> The rest, as described, appear to rely on sysadmin error and to assume

Or on package maintainer error. At least in Gentoo there are packages
(ebuilds and eclasses) that create user/group-writable directories in
/var/log and enable logrotate to handle the log files there.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_aa1fb54e_20250125_042537.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](2) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110310180838.GB19262@florz.florz.dyndns.org>
Date: Thu, 10 Mar 2011 19:08:38 +0100
From: Florian Zumbiehl <florz@...rz.de>
To: Josh Bressers <bressers@...hat.com>
Cc: oss-security@...ts.openwall.com,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>, Jan Kalu??a <jkaluza@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi,

> > >     8) Issue #8: logrotate: TOCTOU race condition by creation of new
> > >     files (between opening the file and moment, final permissions have
> > >     been applied) [information disclosure]
> > >
> >
>
> Let' use CVE-2011-1098 for this.

What about these?:

| However, I think that still #6 (shell injection) and #7 (logrotate
| DoS with strange characters in file names) should be considered
| vulnerabilities in logrotate: It would be reasonable to assume that you
| can use user input that's a valid (slash-less) filename as a (part of a)
| log file name (assuming that the program is running as the same user that
| inspects and rotates the logs, so the log directory being writable by
| the program would not be insecure per-se) without that file name being
| interpreted by a shell or causing logrotate to stop functioning,
| respectively.

Florian

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_59700ab8_20250125_042529.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](16) [[next>]](18) [[<thread-prev]](16) [[thread-next>]](18) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110304145232.GA25390@openwall.com>
Date: Fri, 4 Mar 2011 17:52:32 +0300
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Florian Zumbiehl <florz@...rz.de>, Paul Martin <pm@...ian.org>,
	Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

On Fri, Mar 04, 2011 at 03:08:31PM +0100, Jan Lieskovsky wrote:
>   we have been contacted by Stefan Fritsch of Debian Security Team
> about presence of nine security flaws in the logrotate utility
> (the list is provided below).

I've just skimmed over the list, and I only see one issue that I'd call
a vulnerability in logrotate, issue #8.  And we need more info on #5.

The rest, as described, appear to rely on sysadmin error and to assume
security properties that logrotate never advertised it had.  Specifically,
logrotate was never declared to be safe to use on untrusted directories,
and it was an error for a sysadmin to make such an assumption.

I don't mind logrotate being enhanced/hardened in this respect, but to
call these vulnerabilities sounds like a stretch.  Also, even if
logrotate is hardened, it should not be declared to be safe to use on
untrusted directories.  It'd be better to explicitly state that it is
not, to avoid this sort of confusion.

> 5) Issue #5: logrotate: Information disclosure by performing email
>              notifications
...
> 8) Issue #8: logrotate: TOCTOU race condition by creation of new files
> (between
>              opening the file and moment, final permissions have been
>              applied)
>              [information disclosure]

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_63be20b9_20250125_042532.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](29) [[next>]](31) [[<thread-prev]](29) [[thread-next>]](31) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110304175817.GL24629@florz.florz.dyndns.org>
Date: Fri, 4 Mar 2011 18:58:17 +0100
From: Florian Zumbiehl <florz@...rz.de>
To: Solar Designer <solar@...nwall.com>
Cc: oss-security@...ts.openwall.com,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Paul Martin <pm@...ian.org>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>, Jan Lieskovsky <jlieskov@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi,

> On Fri, Mar 04, 2011 at 04:14:00PM +0100, Florian Zumbiehl wrote:
> > In which scenarios exactly logrotate is supposed to be safe to use is
> > mostly undefined.
>
> Maybe.  We just need to (hopefully) agree on what is common, expected,
> correct - and this may be changing over the years.  Apply our common
> sense and experience.

Well, yeah, what other choice do we have? =:-)

> > (so they can create missing log files, for example).
>
> I think that services should either do that before they drop root at
> startup, or they should not do it at all (leave it to logrotate).

Well, not doing it at all leaves a race condition where the service may
not be able to start or at least to log, lacking a log file, when
started while logrotate is running. At least given how logrotate currently
handles the creation of new log files (rename old file and create new one
afterwards, potentially even with temporarily restricted permissions,
which could also prevent an unprivileged process from opening the newly
created file) ...

Other than that, that doesn't sound unreasonable to me as a design
principle.

> However, if it's somehow desired that a service running as non-root be
> able to create log files (other than just at startup?), then the correct
> approach would be to run a dedicated instance of logrotate for that
> service under the service pseudo-user.  Don't mix the pseudo-user and
> root for the same task (dealing with log files of the same service),
> which creates unnecessary risks.

Which is essentially how I think the fix should work (and it seems
like all parties involved in the discussion so far have agreed on that
in principle, even if not necessarily embracing it fully), though the
current plan is to implement this as a part of logrotate, basically
accepting the expectation that logrotate can be operated securely in
a manner similar to what's currently the case. Practically, that means
that it is planned to add a new config directive that allows to specify
the credentials to be used for manipulating specific sets of log files,
thus obviating the need for separate logrotate invocations but still
letting the kernel take care of separating privileges.

Now, I guess the major motivation for such an approach over executing
logrotate as the unprivileged user directly is backwards compatibility
and how much of a nightmare the transition will be, somehow implicitly
assuming that the similarity with the old mode of operation should
provide for an easier change.

However, this implicit assumption may actually be just that and nothing
more. Namely, there are some ideas how logrotate could guess the
credentials for some common setups when none have been specified in the
config file so as to avoid having to security-patch dozens of packages,
at least as a transitional mechanism. But it's rather unclear whether
any of that will actually work to a sufficient degree to be useful (and
the security of the heuristics to be used is what most of the remaining
contention as to how to fix is about).

If that doesn't work out and you have to patch dozens of packages in
order to change their logrotate configs, you probably may just as well
patch packages to switch to using their own logrotate instance. Or to a
different strategy for logfile handling altogether. In particular so,
given that quite a few of the affected packages in the case of debian
(and I guess it's similar for other distros) do a chown -R on the log
dir in their postinst scripts and thus will need a security patch for
that anyhow.

> > In such setups, the service user can elevate its privileges to root
> > or corrupt root-owned files using the various bugs.
>
> Indeed.  A vulnerability in the service package, in my opinion.  Now
> that would require CVE id assignment and a fix to the package, whereas
> logrotate could merely use some hardening with no CVE ids (except for
> issue #8, which was different).
>
> What do you say?

I guess I don't really have much of an opinion on that. The vulnerabilities
should be fixed, and probably in a way that breaks existing setups as
little as possible, I don't really care which side is declared defective
and subsequently fixed in order to achieve that ;-)

Florian

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_ce396d93_20250125_042533.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](../../../2011/03/04/33) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110305192106.GB31605@openwall.com>
Date: Sat, 5 Mar 2011 22:21:06 +0300
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE Request -- logrotate -- nine issues

On Sat, Mar 05, 2011 at 03:17:57AM +0700, Pavel Labushev wrote:
> 04.03.2011 21:52, Solar Designer пишет:
>
> > I've just skimmed over the list, and I only see one issue that I'd call
> > a vulnerability in logrotate, issue #8.  And we need more info on #5.
> >
> > The rest, as described, appear to rely on sysadmin error and to assume
>
> Or on package maintainer error.

Right.

> At least in Gentoo there are packages
> (ebuilds and eclasses) that create user/group-writable directories in
> /var/log and enable logrotate to handle the log files there.

Is this something you can get fixed?

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_0b2d0775_20250125_042529.html ===

# Debian Bug report logs - #606544 postgresql-common: affected by privilege escalation vulnerability in logrotate

[![version graph](version.cgi?found=3.7.1.5;found=logrotate%2F3.7-5;collapse=1;package=logrotate;fixed=logrotate%2F3.7.8-2;fixed=logrotate%2F3.7.8-4;fixed=aolserver4%2F4.5.1-15;height=2;width=2;absolute=0)](version.cgi?absolute=0;package=logrotate;collapse=1;found=3.7.1.5;found=logrotate%2F3.7-5;info=1;fixed=logrotate%2F3.7.8-2;fixed=logrotate%2F3.7.8-4;fixed=aolserver4%2F4.5.1-15)

Package:
[logrotate](pkgreport.cgi?package=logrotate);
Maintainer for [logrotate](pkgreport.cgi?package=logrotate) is [Christian Göttsche <cgzones@googlemail.com>](pkgreport.cgi?maint=cgzones%40googlemail.com); Source for [logrotate](pkgreport.cgi?package=logrotate) is [src:logrotate](pkgreport.cgi?src=logrotate) ([PTS](https://tracker.debian.org/pkg/logrotate), [buildd](https://buildd.debian.org/logrotate), [popcon](https://qa.debian.org/popcon.php?package=logrotate)).

Reported by: [Florian Zumbiehl <florz@florz.de>](pkgreport.cgi?submitter=florz%40florz.de)

Date: Fri, 10 Dec 2010 02:48:05 UTC

Severity: important

Tags: lenny, security

Merged with [388608](bugreport.cgi?bug=388608),
[606541](bugreport.cgi?bug=606541),
[606543](bugreport.cgi?bug=606543),
[606545](bugreport.cgi?bug=606545),
[606547](bugreport.cgi?bug=606547),
[606548](bugreport.cgi?bug=606548),
[606549](bugreport.cgi?bug=606549),
[606551](bugreport.cgi?bug=606551),
[606552](bugreport.cgi?bug=606552),
[606553](bugreport.cgi?bug=606553),
[606554](bugreport.cgi?bug=606554),
[606555](bugreport.cgi?bug=606555),
[606560](bugreport.cgi?bug=606560),
[606561](bugreport.cgi?bug=606561),
[606562](bugreport.cgi?bug=606562),
[606563](bugreport.cgi?bug=606563),
[606566](bugreport.cgi?bug=606566),
[606567](bugreport.cgi?bug=606567),
[606568](bugreport.cgi?bug=606568),
[606569](bugreport.cgi?bug=606569),
[606570](bugreport.cgi?bug=606570),
[606571](bugreport.cgi?bug=606571),
[606572](bugreport.cgi?bug=606572),
[606573](bugreport.cgi?bug=606573),
[606580](bugreport.cgi?bug=606580),
[606581](bugreport.cgi?bug=606581),
[606582](bugreport.cgi?bug=606582),
[606583](bugreport.cgi?bug=606583),
[606584](bugreport.cgi?bug=606584),
[606585](bugreport.cgi?bug=606585),
[606586](bugreport.cgi?bug=606586),
[606587](bugreport.cgi?bug=606587),
[606595](bugreport.cgi?bug=606595),
[606596](bugreport.cgi?bug=606596),
[606597](bugreport.cgi?bug=606597),
[606598](bugreport.cgi?bug=606598),
[606599](bugreport.cgi?bug=606599),
[606600](bugreport.cgi?bug=606600),
[606601](bugreport.cgi?bug=606601),
[606602](bugreport.cgi?bug=606602),
[606608](bugreport.cgi?bug=606608),
[606609](bugreport.cgi?bug=606609)

Found in versions 3.7.1.5, logrotate/3.7-5

Fixed in versions logrotate/3.7.8-2, logrotate/3.7.8-4, aolserver4/4.5.1-15

**Done:** Francesco Paolo Lovergine <frankie@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=606544;mbox=yes), [status mbox](bugreport.cgi?bug=606544;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=606544;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `Martin Pitt <mpitt@debian.org>`:

`Bug#606544`; Package `postgresql-common`.
(Fri, 10 Dec 2010 02:48:07 GMT) ([full text](bugreport.cgi?bug=606544;msg=2), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Florian Zumbiehl <florz@florz.de>`:

New Bug report received and forwarded. Copy sent to `Martin Pitt <mpitt@debian.org>`.
(Fri, 10 Dec 2010 02:48:07 GMT) ([full text](bugreport.cgi?bug=606544;msg=4), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at maintonly@bugs.debian.org ([full text](bugreport.cgi?bug=606544;msg=5), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=florz%40florz.de)
From: Florian Zumbiehl <florz@florz.de>
To: maintonly@bugs.debian.org
Subject: postgresql-common: affected by privilege escalation vulnerability
in logrotate
Date: Fri, 10 Dec 2010 03:10:39 +0100
```
Package: postgresql-common
Version: 100
Severity: grave
Justification: privilege escalation vulnerability
Tags: security

There was a privilege escalation vulnerability in logrotate that I reported
about four years ago and which finally got fixed in testing rouhgly one
year ago (see bug #388608). In lenny this vulnerability still exists and
logrotate's maintainer doesn't seem to be interested in fixing it,
given that nothing of substance has happened since when I last notified him
of the problem about two weeks ago.

As a proof of concept, I did successfully use it to elevate my privileges
from the postgres user to root. As it affects packages where the log
directory is writable for the package's system user, I based this mass
filing on a rough analysis of maintainer scripts, avoiding the effort
of actually installing and testing each individual package.

These lines from this package's maintainer scripts suggest that it likely
is affected by the vulnerability:

---------------------------------------------------------------------------
chmod 1775 /var/log/postgresql
chown root:postgres /var/log/postgresql
---------------------------------------------------------------------------

Please note that the analysis this mass filing is based on also is
roughly a year old, and anyhow I don't recall which debian suite I based
it on at that time--as such, this report may be against the wrong version
and otherwise outdated in some details. Given how much effort I have
already needlessly put into this, I hope you have some understanding
for me not polishing this bug report.

Primarily I am filing this bug in order to allow the maintainers of
packages using logrotate to work around logrotate if they deem that
necessary.

Also, you should note that the security fix in testing introduces a
regression that may also affect this package which could cause data loss
in situations where this couldn't happen before. A fix for this regression
is available to logrotate's maintainer, also still unapplied for over a
year. A mass filing against packages affected by that regression may
follow later.

For some further details please see my announcement of this mass
filing on debian-qa:

<http://lists.debian.org/debian-qa/2010/11/msg00024.html>

I would also suggest to use that thread for any further discussion that
is not specific to this package and possibly for coordination between
maintainers of affected packages in order to avoid duplicated efforts
where possible.

```

---

**Bug reassigned from package '[postgresql-common](pkgreport.cgi?package=postgresql-common)' to '[logrotate](pkgreport.cgi?package=logrotate)'.**
Request was from `Holger Levsen <holger@layer-acht.org>`
to `control@bugs.debian.org`.
(Fri, 10 Dec 2010 11:00:08 GMT) ([full text](bugreport.cgi?bug=606544;msg=7), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=7), [link](#6)).

---

**Bug No longer marked as found in versions postgresql-common/100.**
Request was from `Holger Levsen <holger@layer-acht.org>`
to `control@bugs.debian.org`.
(Fri, 10 Dec 2010 11:00:09 GMT) ([full text](bugreport.cgi?bug=606544;msg=9), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=9), [link](#8)).

---

**Forcibly Merged [388608](bugreport.cgi?bug=388608) [606541](bugreport.cgi?bug=606541) [606543](bugreport.cgi?bug=606543) [606544](bugreport.cgi?bug=606544) [606545](bugreport.cgi?bug=606545) [606547](bugreport.cgi?bug=606547) [606548](bugreport.cgi?bug=606548) [606549](bugreport.cgi?bug=606549) [606600](bugreport.cgi?bug=606600).**
Request was from `Holger Levsen <holger@layer-acht.org>`
to `control@bugs.debian.org`.
(Fri, 10 Dec 2010 11:12:08 GMT) ([full text](bugreport.cgi?bug=606544;msg=11), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=11), [link](#10)).

---

**Forcibly Merged [388608](bugreport.cgi?bug=388608) [606541](bugreport.cgi?bug=606541) [606543](bugreport.cgi?bug=606543) [606544](bugreport.cgi?bug=606544) [606545](bugreport.cgi?bug=606545) [606547](bugreport.cgi?bug=606547) [606548](bugreport.cgi?bug=606548) [606549](bugreport.cgi?bug=606549) [606551](bugreport.cgi?bug=606551) [606552](bugreport.cgi?bug=606552) [606553](bugreport.cgi?bug=606553) [606554](bugreport.cgi?bug=606554) [606555](bugreport.cgi?bug=606555) [606560](bugreport.cgi?bug=606560) [606561](bugreport.cgi?bug=606561) [606600](bugreport.cgi?bug=606600).**
Request was from `Holger Levsen <holger@layer-acht.org>`
to `control@bugs.debian.org`.
(Fri, 10 Dec 2010 11:12:14 GMT) ([full text](bugreport.cgi?bug=606544;msg=13), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=13), [link](#12)).

---

**Forcibly Merged [388608](bugreport.cgi?bug=388608) [606541](bugreport.cgi?bug=606541) [606543](bugreport.cgi?bug=606543) [606544](bugreport.cgi?bug=606544) [606545](bugreport.cgi?bug=606545) [606547](bugreport.cgi?bug=606547) [606548](bugreport.cgi?bug=606548) [606549](bugreport.cgi?bug=606549) [606551](bugreport.cgi?bug=606551) [606552](bugreport.cgi?bug=606552) [606553](bugreport.cgi?bug=606553) [606554](bugreport.cgi?bug=606554) [606555](bugreport.cgi?bug=606555) [606560](bugreport.cgi?bug=606560) [606561](bugreport.cgi?bug=606561) [606563](bugreport.cgi?bug=606563) [606566](bugreport.cgi?bug=606566) [606567](bugreport.cgi?bug=606567) [606568](bugreport.cgi?bug=606568) [606569](bugreport.cgi?bug=606569) [606570](bugreport.cgi?bug=606570) [606571](bugreport.cgi?bug=606571) [606600](bugreport.cgi?bug=606600).**
Request was from `Holger Levsen <holger@layer-acht.org>`
to `control@bugs.debian.org`.
(Fri, 10 Dec 2010 11:12:25 GMT) ([full text](bugreport.cgi?bug=606544;msg=15), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=15), [link](#14)).

---

**Forcibly Merged [388608](bugreport.cgi?bug=388608) [606541](bugreport.cgi?bug=606541) [606543](bugreport.cgi?bug=606543) [606544](bugreport.cgi?bug=606544) [606545](bugreport.cgi?bug=606545) [606547](bugreport.cgi?bug=606547) [606548](bugreport.cgi?bug=606548) [606549](bugreport.cgi?bug=606549) [606551](bugreport.cgi?bug=606551) [606552](bugreport.cgi?bug=606552) [606553](bugreport.cgi?bug=606553) [606554](bugreport.cgi?bug=606554) [606555](bugreport.cgi?bug=606555) [606560](bugreport.cgi?bug=606560) [606561](bugreport.cgi?bug=606561) [606563](bugreport.cgi?bug=606563) [606566](bugreport.cgi?bug=606566) [606567](bugreport.cgi?bug=606567) [606568](bugreport.cgi?bug=606568) [606569](bugreport.cgi?bug=606569) [606570](bugreport.cgi?bug=606570) [606571](bugreport.cgi?bug=606571) [606573](bugreport.cgi?bug=606573) [606580](bugreport.cgi?bug=606580) [606581](bugreport.cgi?bug=606581) [606582](bugreport.cgi?bug=606582) [606583](bugreport.cgi?bug=606583) [606584](bugreport.cgi?bug=606584) [606585](bugreport.cgi?bug=606585) [606600](bugreport.cgi?bug=606600).**
Request was from `Holger Levsen <holger@layer-acht.org>`
to `control@bugs.debian.org`.
(Fri, 10 Dec 2010 11:12:41 GMT) ([full text](bugreport.cgi?bug=606544;msg=17), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=17), [link](#16)).

---

**Forcibly Merged [388608](bugreport.cgi?bug=388608) [606541](bugreport.cgi?bug=606541) [606543](bugreport.cgi?bug=606543) [606544](bugreport.cgi?bug=606544) [606545](bugreport.cgi?bug=606545) [606547](bugreport.cgi?bug=606547) [606548](bugreport.cgi?bug=606548) [606549](bugreport.cgi?bug=606549) [606551](bugreport.cgi?bug=606551) [606552](bugreport.cgi?bug=606552) [606553](bugreport.cgi?bug=606553) [606554](bugreport.cgi?bug=606554) [606555](bugreport.cgi?bug=606555) [606560](bugreport.cgi?bug=606560) [606561](bugreport.cgi?bug=606561) [606562](bugreport.cgi?bug=606562) [606563](bugreport.cgi?bug=606563) [606566](bugreport.cgi?bug=606566) [606567](bugreport.cgi?bug=606567) [606568](bugreport.cgi?bug=606568) [606569](bugreport.cgi?bug=606569) [606570](bugreport.cgi?bug=606570) [606571](bugreport.cgi?bug=606571) [606572](bugreport.cgi?bug=606572) [606573](bugreport.cgi?bug=606573) [606580](bugreport.cgi?bug=606580) [606581](bugreport.cgi?bug=606581) [606582](bugreport.cgi?bug=606582) [606583](bugreport.cgi?bug=606583) [606584](bugreport.cgi?bug=606584) [606585](bugreport.cgi?bug=606585) [606586](bugreport.cgi?bug=606586) [606587](bugreport.cgi?bug=606587) [606600](bugreport.cgi?bug=606600).**
Request was from `Holger Levsen <holger@layer-acht.org>`
to `control@bugs.debian.org`.
(Fri, 10 Dec 2010 11:13:01 GMT) ([full text](bugreport.cgi?bug=606544;msg=19), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=19), [link](#18)).

---

**Forcibly Merged [388608](bugreport.cgi?bug=388608) [606541](bugreport.cgi?bug=606541) [606543](bugreport.cgi?bug=606543) [606544](bugreport.cgi?bug=606544) [606545](bugreport.cgi?bug=606545) [606547](bugreport.cgi?bug=606547) [606548](bugreport.cgi?bug=606548) [606549](bugreport.cgi?bug=606549) [606551](bugreport.cgi?bug=606551) [606552](bugreport.cgi?bug=606552) [606553](bugreport.cgi?bug=606553) [606554](bugreport.cgi?bug=606554) [606555](bugreport.cgi?bug=606555) [606560](bugreport.cgi?bug=606560) [606561](bugreport.cgi?bug=606561) [606562](bugreport.cgi?bug=606562) [606563](bugreport.cgi?bug=606563) [606566](bugreport.cgi?bug=606566) [606567](bugreport.cgi?bug=606567) [606568](bugreport.cgi?bug=606568) [606569](bugreport.cgi?bug=606569) [606570](bugreport.cgi?bug=606570) [606571](bugreport.cgi?bug=606571) [606572](bugreport.cgi?bug=606572) [606573](bugreport.cgi?bug=606573) [606580](bugreport.cgi?bug=606580) [606581](bugreport.cgi?bug=606581) [606582](bugreport.cgi?bug=606582) [606583](bugreport.cgi?bug=606583) [606584](bugreport.cgi?bug=606584) [606585](bugreport.cgi?bug=606585) [606586](bugreport.cgi?bug=606586) [606587](bugreport.cgi?bug=606587) [606595](bugreport.cgi?bug=606595) [606596](bugreport.cgi?bug=606596) [606597](bugreport.cgi?bug=606597) [606598](bugreport.cgi?bug=606598) [606599](bugreport.cgi?bug=606599) [606600](bugreport.cgi?bug=606600) [606601](bugreport.cgi?bug=606601) [606602](bugreport.cgi?bug=606602) [606608](bugreport.cgi?bug=606608) [606609](bugreport.cgi?bug=606609).**
Request was from `Sven Joachim <svenjoac@gmx.de>`
to `control@bugs.debian.org`.
(Fri, 10 Dec 2010 13:00:09 GMT) ([full text](bugreport.cgi?bug=606544;msg=21), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=21), [link](#20)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 07 Sep 2011 07:33:06 GMT) ([full text](bugreport.cgi?bug=606544;msg=23), [mbox](bugreport.cgi?bug=606544;mbox=yes;msg=23), [link](#22)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=606544).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 04:25:28 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from openwall.com_c373af4d_20250125_042535.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](5) [[thread-next>]](../../../2011/03/07/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4D739ABD.9040508@gmail.com>
Date: Sun, 06 Mar 2011 21:31:25 +0700
From: Pavel Labushev <p.labushev@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE Request -- logrotate -- nine issues

06.03.2011 19:26, Solar Designer пишет:

> For this to happen, you need to post info on the specific issues and
> request CVEs for them.  Will you do this, please?  (Perhaps start a new
> thread, or even a thread per package - that's up to you.)

I mean we shouldn't sweep the logrotate issues under the carpet, even if
logrotate wasn't suppose to handle such use cases initially. I have an
impression that's what you suggest. I mean this:

> The rest, as described, appear to rely on sysadmin error and to assume
> security properties that logrotate never advertised it had.

and

> Indeed.  A vulnerability in the service package, in my opinion.  Now
> that would require CVE id assignment and a fix to the package, whereas
> logrotate could merely use some hardening with no CVE ids (except for
> issue #8, which was different).

So I think all the logrotate issues should get their CVEs with an advise to
work around misuse cases by chowning the log directories root:root.

The Gentoo issues, I think they don't need CVEs and will be fixed by the
Gentoo security team (they are aware). The point was to show the misuse
cases are common.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_66a8bab3_20250125_042538.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](3) [[thread-next>]](../../../2011/03/14/26) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201103111537.56413.ludwig.nussel@suse.de>
Date: Fri, 11 Mar 2011 15:37:56 +0100
From: Ludwig Nussel <ludwig.nussel@...e.de>
To: oss-security@...ts.openwall.com
Subject: Re: CVE Request -- logrotate -- nine issues

Florian Zumbiehl wrote:
> > On Thu, Mar 10, 2011 at 07:08:38PM +0100, Florian Zumbiehl wrote:
> > > What about these?:
> > >
> > > | However, I think that still #6 (shell injection) and #7 (logrotate
> > > | DoS with strange characters in file names) should be considered
> > > | vulnerabilities in logrotate: It would be reasonable to assume that you
> > > | can use user input that's a valid (slash-less) filename as a (part of a)
> > > | log file name (assuming that the program is running as the same user that
> > > | inspects and rotates the logs, so the log directory being writable by
> > > | the program would not be insecure per-se) without that file name being
> > > | interpreted by a shell or causing logrotate to stop functioning,
> > > | respectively.
> [...]
> > To summarize, it feels like in theory a privilege boundary could exist
> > here and be crossed on certain systems with extra software, but in
> > practice this is unlikely and it would indicate poor design of another
> > piece of software or/and false sense of security put into that privilege
> > boundary.  I don't know what this means for CVE id assignment per the
> > current "rules".
>
> I was thinking more in the direction of an existing config that includes
> a wildcard and software that uses user input to construct file names
> that would be matched by that wildcard. An example of such software
> would be samba, which tends to create per-client-host log files named
> after those hosts. I don't have a clue whether samba could be made to
> include any shell meta characters (does it even do reverse lookups for
> that?), but I guess you get the idea.

libvirt constructs log file names from user input (log file name =
VM name). The user needs to have the org.libvirt.unix.manage
privilege which bascially already is full root though.

cu
Ludwig

--
 (o_   Ludwig Nussel
 //\
 V_/_  <http://www.suse.de/>
SUSE LINUX Products GmbH, GF: Markus Rex, HRB 16746 (AG Nuernberg)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_76d6b857_20250125_042529.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](17) [[next>]](19) [[<thread-prev]](17) [[thread-next>]](19) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110304151400.GJ24629@florz.florz.dyndns.org>
Date: Fri, 4 Mar 2011 16:14:00 +0100
From: Florian Zumbiehl <florz@...rz.de>
To: Solar Designer <solar@...nwall.com>
Cc: oss-security@...ts.openwall.com,
	"Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Paul Martin <pm@...ian.org>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi,

> The rest, as described, appear to rely on sysadmin error and to assume
> security properties that logrotate never advertised it had.  Specifically,
> logrotate was never declared to be safe to use on untrusted directories,
> and it was an error for a sysadmin to make such an assumption.
>
> I don't mind logrotate being enhanced/hardened in this respect, but to
> call these vulnerabilities sounds like a stretch.  Also, even if
> logrotate is hardened, it should not be declared to be safe to use on
> untrusted directories.  It'd be better to explicitly state that it is
> not, to avoid this sort of confusion.

In which scenarios exactly logrotate is supposed to be safe to use is
mostly undefined.

However, it is currently a common setup (as in: what distributions do out
of the box) to have a daily logrotate cron job run as root that rotates
the logs of all the services and to have log directories owned by service
users (so they can create missing log files, for example).

In such setups, the service user can elevate its privileges to root
or corrupt root-owned files using the various bugs.

Florian

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_9aa24203_20250125_042530.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](18) [[next>]](20) [[<thread-prev]](18) [[thread-next>]](22) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4D7106A7.907@redhat.com>
Date: Fri, 04 Mar 2011 16:35:03 +0100
From: Jan Lieskovsky <jlieskov@...hat.com>
To: oss-security@...ts.openwall.com
CC: "Steven M. Christey" <coley@...us.mitre.org>,
        Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
        Florian Zumbiehl <florz@...rz.de>, Paul Martin <pm@...ian.org>,
        Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi Solar,

   thank you for your reaction.

Solar Designer wrote:
> On Fri, Mar 04, 2011 at 03:08:31PM +0100, Jan Lieskovsky wrote:
>>   we have been contacted by Stefan Fritsch of Debian Security Team
>> about presence of nine security flaws in the logrotate utility
>> (the list is provided below).
>
> I've just skimmed over the list, and I only see one issue that I'd call
> a vulnerability in logrotate, issue #8.  And we need more info on #5.

For issue #5:

If the mail configuration directive is used, an attacker can trick
logrotate into sending arbitrary files by mail, by creating
appropriate hard or soft links.

Hope that's enough, let me know if not.

For the second part:

>
> The rest, as described, appear to rely on sysadmin error and to assume
> security properties that logrotate never advertised it had.  Specifically,
> logrotate was never declared to be safe to use on untrusted directories,
> and it was an error for a sysadmin to make such an assumption.

We don't mind documenting of this behavior in appropriate places.

Wouldn't like to condescend further into particulars, what is and what
is not a security issue (as this is beyond this post), but according
to our opinion even non-documented incorrect behavior, allowing
malicious actions to be performed on the system, should be considered
a security flaw (regardless if it's advertised or not). Because by applying
your above approach, most of the open source project could just say
'this software is not intended to be run like that.'

Not trying to argue, just saying the disclination like the above
doesn't help anyone.

Either the software has the issues, and they should be fixed,
or it has the issues, and they can't be fixed. Then the software
should not be used and an alternative one should be found.

This is not you would shoot yourself into the foot by accident
(by performing some action). This is about local users', aware
of the deficiencies, ability to conduct such actions on the system,
so they would reach some higher privilege, damage or different
kind of benefit for them.

Hope this helps.

Thanks && Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

>
> I don't mind logrotate being enhanced/hardened in this respect, but to
> call these vulnerabilities sounds like a stretch.  Also, even if
> logrotate is hardened, it should not be declared to be safe to use on
> untrusted directories.  It'd be better to explicitly state that it is
> not, to avoid this sort of confusion.
>
>> 5) Issue #5: logrotate: Information disclosure by performing email
>>              notifications
> ...
>> 8) Issue #8: logrotate: TOCTOU race condition by creation of new files
>> (between
>>              opening the file and moment, final permissions have been
>>              applied)
>>              [information disclosure]
>
> Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_9a6f5d0b_20250125_042532.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](31) [[next>]](33) [[<thread-prev]](31) [[thread-next>]](33) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4D713496.9050708@redhat.com>
Date: Fri, 04 Mar 2011 19:51:02 +0100
From: Jan Lieskovsky <jlieskov@...hat.com>
To: oss-security@...ts.openwall.com
CC: "Steven M. Christey" <coley@...us.mitre.org>,
        Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
        Florian Zumbiehl <florz@...rz.de>, Paul Martin <pm@...ian.org>,
        Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi Solar,

Solar Designer wrote:
> On Fri, Mar 04, 2011 at 04:35:03PM +0100, Jan Lieskovsky wrote:
>> For issue #5:
>>
>> If the mail configuration directive is used, an attacker can trick
>> logrotate into sending arbitrary files by mail, by creating
>> appropriate hard or soft links.
>>
>> Hope that's enough, let me know if not.
>
> I can definitely figure this out by looking at the code, but the
> description alone looks insufficient to me.  It does not say what
> directory those links would need to be created in.  If it's the log
> files' directory, which I suspect is the case,

This should describe the case of log directories, writable also
by other (unprivileged) users and not just by root.

  then this issue falls in
> the same controversial category as most of the rest.  If it's /tmp, then
> this is in fact a vulnerability in logrotate, without a doubt.
>
>>> The rest, as described, appear to rely on sysadmin error and to assume
>>> security properties that logrotate never advertised it had.  Specifically,
>>> logrotate was never declared to be safe to use on untrusted directories,
>>> and it was an error for a sysadmin to make such an assumption.
>> We don't mind documenting of this behavior in appropriate places.
>
> Do you mean the fact that logrotate is not meant for use on untrusted
> directories?

Yes, have meant this. The majority of the reported issues exist
because logrotate does not have (at least I don't know of, maybe wrong)
a policy, how to behave when rotating log files in such directories.

Another problem is (as Florian already pointed out) logrotate often
being run under privileged (root) user account as part of (daily) cron
job.

  Or, on the contrary, claim that it is safe for that after
> the hardening changes to be made now?  I prefer the former.
>
>> Wouldn't like to condescend further into particulars, what is and what
>> is not a security issue (as this is beyond this post), but according
>> to our opinion even non-documented incorrect behavior, allowing
>> malicious actions to be performed on the system, should be considered
>> a security flaw (regardless if it's advertised or not). Because by applying
>> your above approach, most of the open source project could just say
>> 'this software is not intended to be run like that.'
>
> Like I wrote in my reply to Florian, this is about expectations.  You
> say "incorrect behavior", which makes sense to me.

This is about absence of 'default user account other than root' to
run the tasks under, when processing attacker controllable directory.

You already proposed 'another user, less privilege user account' to
run the tasks under in reply to Florian.

   For example, "cp"
> is also unsafe in untrusted directories, but its behavior is
> nevertheless "correct" (because it is documented), so you would not call
> it a security flaw for that reason.  Fair enough.

I got your point. But still think there is a difference between the
case privileged system user would use 'cp' by accident in untrusted
directory and corrupt the system and case, when some utility is
running under privileged user account on regular basis and not
taking 'untrusted directories' into account / not having a policy,
how to behave while processing them.

>
> However, then there are things such as text editors, which are also
> unsafe for use on files in untrusted directories.  Is it "incorrect
> behavior" that they are?  To me, this has always been the historically
> expected unsafety.  However, Dan Rosenberg managed to get a CVE id for
> such an issue in an editor.  I was surprised.  The issue did not affect
> us (we were not packaging the editor), but if it did we would not call
> it a vulnerability.  Just wrong/flawed expectations by the user.

For example CVE-2010-2055 has been assigned to Ghostscript's reading
of initialization files from $CWD. CVE-2010-3349, 3350, 3355, 3369 and
many others have been assigned to insecure library loading vulnerabilities.

In comparison with the above, how running of logrotate utlity on untrusted
directory differs? Even when it is often run regularly and under root
user account.

How many system users check the directory permissions prior running
the utility? How many administrators check them regularly?

Agree, the majority of these issue would disappear when logrotate
would just refuse to process such a directory. But currently it
doesn't. That CVE request is just attempt to pinpoint the need
of change.

>
> Again, as I wrote to Florian, maybe the expectations here are changing
> over the years.  However, if so, wouldn't it be right to have hardening
> introduced into the relevant programs first, the expectations
> "officially" changed (although I'd rather not do that), and only if/when
> that hardening is later determined to be insufficient start saying
> "vulnerability" and assigning CVE ids?

Maybe you are correct. And maybe this discussion should happen
on completely different mailing list. When I was asking Florian,
when the issues went public, the answer was: "Those are known
for a long time already and logrotate is known to have such kind
of defects." This post is nothing else, just to start thinking
about the change. Enumerate the issues and perform the steps towards
the change.

>
> Speaking of issues where a more or differently privileged process
> accesses files in a directory writable by another process, these are
> surprisingly difficult to "fully" deal with, and the majority of
> programs are "affected".  Of the common Unix commands, only a handful
> are safe to use in untrusted directories (with possible impact of
> attacks being a mere DoS against the command itself) - such as "ln".
> Yes, I actually use "ln" like this:
>
> # su - user1
> $ cp some/dir/file . # hopefully the ~/file name was not taken
> $ exit
> # ln ~user1/file .
> # ls -ld file # sanity check that we were not raced
> # chown user2: file
> # ln file ~user2/
> # rm file
> # su - user2
> $ mv file target/dir/
> $ exit
> # su - user1
> $ rm file

Agree. But would still mention the difference between binary, which
is intended to be run by privileged user (aware of the consequences)
and common tool, dedicated to processing of *.log files everywhere
(and run under root account).

>
> when I need to copy a file from one untrusted user to another.  Yes,
> this is complicated and it has limitations (same fs).  Maybe we need a
> special tool for this task (I had some ideas on this - "give" and "take"
> commands).  But that's the current situation.

To be honest, we didn't come to solution how to solve this in logrotate
yet. One of the proposals was logrotate to refuse process *.log files
in such directories. The CVE request was an attempt to speak publicly
such issues are there and we need to start thinking about their solution.

>
> Almost all other commands and programs are unsafe on untrusted
> directories.  In my opinion, that's the only correct assumption for a
> sysadmin to make, and any other assumption is naive.

Agree here. But as stated above, how many sysadmins perform this task
prior running the tool? How many do it regularly?

   Unfortunately,
> most sysadmins don't fully realize this (in my experience), but that
> does not make those programs any safer, nor does it prompt us to assign
> CVE ids against almost all Unix programs.

See above. Ghostscript vs logrotate. How untrusted directory for GS
differs from untrusted directory for logrotate?

>
>> Not trying to argue,
>
> I also primarily mean to share some info/understanding/reasoning rather
> than to argue.
>
>> just saying the disclination like the above doesn't help anyone.
>
> I think it does.  But I am willing to shut up. ;-)  I sure am not going
> to post stuff that people don't want to receive/read. ;-)

In final consequence thinking your post initiated what was intended --
the communication about those issues.

>
>> Either the software has the issues, and they should be fixed,
>> or it has the issues, and they can't be fixed. Then the software
>> should not be used and an alternative one should be found.
>
> No software is perfect, and almost any piece of software can be improved
> endlessly.  But that's mere rhetoric.

Sure. Just wanted to differentiate the 'unsupported functionality'
from undocumented functionality, which may be harmful.

>
> I don't mind logrotate being hardened against these issues.  We do a lot
> of hardening in other areas, so why not here.  I just don't blame
> logrotate for the issues.

See above -- absence of policy how to deal with untrusted directories.
Absence of privilege delegation.

  I blame improper service packages and
> insufficient sysadmin education

Agree.

.  Hardening logrotate and not fixing
> those other truly broken packages sounds plain wrong to me.

How many users check content of their $CWD prior launching gs?

   The latter
> part of it (not fixing), not the former.  As to CVE ids against
> logrotate, I don't care much; it's just that we're not going to say our
> logrotate update fixes 9 vulnerabilities.  We may say it fixes one (the
> #8 issue).

Ok.

>
>> This is not you would shoot yourself into the foot by accident
>> (by performing some action). This is about local users', aware
>> of the deficiencies, ability to conduct such actions on the system,
>> so they would reach some higher privilege, damage or different
>> kind of benefit for them.
>
> Sorry, your desired meaning of the above escapes me...  Nevermind.

The purpose of the last paragraph was to distinguish 'admin negligence',
Steve mentions earlier and actions, which may be performed in the background,
actions, which logrotate allows (changes to log files in untrusted / writable
directories) and actions, which users using the utility may not even notice
until something really bad happens.

>
> Thank you for your response!

Same from my side. Thanks for the thoughts, which initiated (partial)
discussion.

Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

>
> Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_00d2ef42_20250125_042530.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](21) [[next>]](23) [[<thread-prev]](19) [[thread-next>]](24) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110304161640.GA25667@openwall.com>
Date: Fri, 4 Mar 2011 19:16:40 +0300
From: Solar Designer <solar@...nwall.com>
To: Florian Zumbiehl <florz@...rz.de>, oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Paul Martin <pm@...ian.org>, Petr Uzel <petr.uzel@...e.cz>,
	Thomas Biege <thomas@...e.de>, Jan Lieskovsky <jlieskov@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

Hi Florian -

Thank you for explaining your rationale behind this.  Here's my take on it:

On Fri, Mar 04, 2011 at 04:14:00PM +0100, Florian Zumbiehl wrote:
> In which scenarios exactly logrotate is supposed to be safe to use is
> mostly undefined.

Maybe.  We just need to (hopefully) agree on what is common, expected,
correct - and this may be changing over the years.  Apply our common
sense and experience.

> However, it is currently a common setup (as in: what distributions do out
> of the box) to have a daily logrotate cron job run as root that rotates
> the logs of all the services and to have log directories owned by service
> users

Arguably, these are bugs in those service packages, which I'd call
vulnerabilities.  At least that's the policy for Owl (our Linux distro)
so far.  We don't have any service-writable log file directories.

I reported one of those issues against nginx-0.6.39-2.el5 (a Red Hat
distro package) to the package maintainer a year ago, and was told
the issue was fixed in response to my report (by chown'ing the nginx
logs directory).  IMO, such a fix was the only right thing to do.

> (so they can create missing log files, for example).

I think that services should either do that before they drop root at
startup, or they should not do it at all (leave it to logrotate).

However, if it's somehow desired that a service running as non-root be
able to create log files (other than just at startup?), then the correct
approach would be to run a dedicated instance of logrotate for that
service under the service pseudo-user.  Don't mix the pseudo-user and
root for the same task (dealing with log files of the same service),
which creates unnecessary risks.

> In such setups, the service user can elevate its privileges to root
> or corrupt root-owned files using the various bugs.

Indeed.  A vulnerability in the service package, in my opinion.  Now
that would require CVE id assignment and a fix to the package, whereas
logrotate could merely use some hardening with no CVE ids (except for
issue #8, which was different).

What do you say?

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_358863bc_20250125_042536.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2011/03/08/5) [[thread-next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <803908496.24193.1299763793117.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Thu, 10 Mar 2011 08:29:53 -0500 (EST)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>,
        Stefan Fritsch <sf@...itsch.de>, Florian Zumbiehl <florz@...rz.de>,
        Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>,
        Jan Kaluža <jkaluza@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

----- Original Message -----
> Josh Bressers wrote:
> >
> > As best as I can tell, logrotate only needs a CVE id for this:
> >
> >     8) Issue #8: logrotate: TOCTOU race condition by creation of new
> >     files (between opening the file and moment, final permissions have
> >     been applied) [information disclosure]
> >
>

Let' use CVE-2011-1098 for this.

Thanks.

--
    JB

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_c663ed80_20250125_042531.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](23) [[next>]](25) [[<thread-prev]](22) [[thread-next>]](25) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110304170503.GA25874@openwall.com>
Date: Fri, 4 Mar 2011 20:05:03 +0300
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>,
	Florian Zumbiehl <florz@...rz.de>, Paul Martin <pm@...ian.org>,
	Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>
Subject: Re: CVE Request -- logrotate -- nine issues

On Fri, Mar 04, 2011 at 04:35:03PM +0100, Jan Lieskovsky wrote:
> For issue #5:
>
> If the mail configuration directive is used, an attacker can trick
> logrotate into sending arbitrary files by mail, by creating
> appropriate hard or soft links.
>
> Hope that's enough, let me know if not.

I can definitely figure this out by looking at the code, but the
description alone looks insufficient to me.  It does not say what
directory those links would need to be created in.  If it's the log
files' directory, which I suspect is the case, then this issue falls in
the same controversial category as most of the rest.  If it's /tmp, then
this is in fact a vulnerability in logrotate, without a doubt.

> >The rest, as described, appear to rely on sysadmin error and to assume
> >security properties that logrotate never advertised it had.  Specifically,
> >logrotate was never declared to be safe to use on untrusted directories,
> >and it was an error for a sysadmin to make such an assumption.
>
> We don't mind documenting of this behavior in appropriate places.

Do you mean the fact that logrotate is not meant for use on untrusted
directories?  Or, on the contrary, claim that it is safe for that after
the hardening changes to be made now?  I prefer the former.

> Wouldn't like to condescend further into particulars, what is and what
> is not a security issue (as this is beyond this post), but according
> to our opinion even non-documented incorrect behavior, allowing
> malicious actions to be performed on the system, should be considered
> a security flaw (regardless if it's advertised or not). Because by applying
> your above approach, most of the open source project could just say
> 'this software is not intended to be run like that.'

Like I wrote in my reply to Florian, this is about expectations.  You
say "incorrect behavior", which makes sense to me.  For example, "cp"
is also unsafe in untrusted directories, but its behavior is
nevertheless "correct" (because it is documented), so you would not call
it a security flaw for that reason.  Fair enough.

However, then there are things such as text editors, which are also
unsafe for use on files in untrusted directories.  Is it "incorrect
behavior" that they are?  To me, this has always been the historically
expected unsafety.  However, Dan Rosenberg managed to get a CVE id for
such an issue in an editor.  I was surprised.  The issue did not affect
us (we were not packaging the editor), but if it did we would not call
it a vulnerability.  Just wrong/flawed expectations by the user.

Again, as I wrote to Florian, maybe the expectations here are changing
over the years.  However, if so, wouldn't it be right to have hardening
introduced into the relevant programs first, the expectations
"officially" changed (although I'd rather not do that), and only if/when
that hardening is later determined to be insufficient start saying
"vulnerability" and assigning CVE ids?

Speaking of issues where a more or differently privileged process
accesses files in a directory writable by another process, these are
surprisingly difficult to "fully" deal with, and the majority of
programs are "affected".  Of the common Unix commands, only a handful
are safe to use in untrusted directories (with possible impact of
attacks being a mere DoS against the command itself) - such as "ln".
Yes, I actually use "ln" like this:

# su - user1
$ cp some/dir/file . # hopefully the ~/file name was not taken
$ exit
# ln ~user1/file .
# ls -ld file # sanity check that we were not raced
# chown user2: file
# ln file ~user2/
# rm file
# su - user2
$ mv file target/dir/
$ exit
# su - user1
$ rm file

when I need to copy a file from one untrusted user to another.  Yes,
this is complicated and it has limitations (same fs).  Maybe we need a
special tool for this task (I had some ideas on this - "give" and "take"
commands).  But that's the current situation.

Almost all other commands and programs are unsafe on untrusted
directories.  In my opinion, that's the only correct assumption for a
sysadmin to make, and any other assumption is naive.  Unfortunately,
most sysadmins don't fully realize this (in my experience), but that
does not make those programs any safer, nor does it prompt us to assign
CVE ids against almost all Unix programs.

> Not trying to argue,

I also primarily mean to share some info/understanding/reasoning rather
than to argue.

> just saying the disclination like the above doesn't help anyone.

I think it does.  But I am willing to shut up. ;-)  I sure am not going
to post stuff that people don't want to receive/read. ;-)

> Either the software has the issues, and they should be fixed,
> or it has the issues, and they can't be fixed. Then the software
> should not be used and an alternative one should be found.

No software is perfect, and almost any piece of software can be improved
endlessly.  But that's mere rhetoric.

I don't mind logrotate being hardened against these issues.  We do a lot
of hardening in other areas, so why not here.  I just don't blame
logrotate for the issues.  I blame improper service packages and
insufficient sysadmin education.  Hardening logrotate and not fixing
those other truly broken packages sounds plain wrong to me.  The latter
part of it (not fixing), not the former.  As to CVE ids against
logrotate, I don't care much; it's just that we're not going to say our
logrotate update fixes 9 vulnerabilities.  We may say it fixes one (the
#8 issue).

> This is not you would shoot yourself into the foot by accident
> (by performing some action). This is about local users', aware
> of the deficiencies, ability to conduct such actions on the system,
> so they would reach some higher privilege, damage or different
> kind of benefit for them.

Sorry, your desired meaning of the above escapes me...  Nevermind.

Thank you for your response!

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_3d855b94_20250125_042532.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](30) [[next>]](32) [[<thread-prev]](30) [[thread-next>]](32) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <AANLkTikLhWzy7Zoi-qg8OQCY2RD-W8nnHJagcAgVKbJA@mail.gmail.com>
Date: Fri, 4 Mar 2011 13:14:51 -0500
From: Dan Rosenberg <dan.j.rosenberg@...il.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...-smtp.mitre.org>, Florian Zumbiehl <florz@...rz.de>,
	Stefan Fritsch <sf@...itsch.de>, Jan Kaluza <jkaluza@...hat.com>, Paul Martin <pm@...ian.org>,
	Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>, Jan Lieskovsky <jlieskov@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

>
>> It felt wrong, say, to blame a text editor for being unsafe to use on
>> files in untrusted directories when such unsafety was the typical and
>> expected situation for text editors in general.
>
> Some items can be assigned a CVE without deep thought about the larger
> context.  This may happen due to volume, time constraints, or an
> under-specified attack scenario by the requester.  That may be the case with
> the case you're talking about here, but I don't remember it.
>

Just to chime in here about parallels to the GNU nano case you're
referring to.  I agree with you that a CVE for those issues may have
been unnecessary, but it depends on your expectations of what
guarantees a text editor provides.  If I try to open an untrusted file
with a text editor, and an attacker replaces that file before I open
it, resulting in me making edits to the wrong file, then of course
that's not a security issue, because the text editor did exactly what
it was told to do: open the file, which happened to be different by
the time it got around to opening it.  There would also be visual
feedback in the text editor to alert the user as to which file was
being edited.  However, if I open a file to edit, and someone changes
that file out from under me while I'm making edits, and a resulting
save overwrites the new underlying file, including following symlinks,
that's slightly different, since one might argue that some feedback or
warning from the editor would be expected (this is the case with
almost all other text editors).  But this is subtle, and I understand
both sides of the argument - personally, I don't think it's a serious
enough attack vector to warrant splitting hairs over.

The logrotate case is even more subtle, since it's even less clear
what constitute reasonable expectations with regards to the security
guarantees of the application.

-Dan

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_dbc6e29d_20250125_042536.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](../../../2011/03/07/11) [[thread-next>]](../../../2011/03/10/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201103080859.03319.ludwig.nussel@suse.de>
Date: Tue, 8 Mar 2011 08:59:03 +0100
From: Ludwig Nussel <ludwig.nussel@...e.de>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>,
	Stefan Fritsch <sf@...itsch.de>, Florian Zumbiehl <florz@...rz.de>,
	Petr Uzel <petr.uzel@...e.cz>, Thomas Biege <thomas@...e.de>,
	Jan Kaluža <jkaluza@...hat.com>
Subject: Re: CVE Request -- logrotate -- nine issues

Josh Bressers wrote:
> [...]
> It seems there is now a consensus on this (at least that's how I'm reading
> it). Here is what I plan to do with CVE ids unless someone speaks up.
>
> As best as I can tell, logrotate only needs a CVE id for this:
>
>     8) Issue #8: logrotate: TOCTOU race condition by creation of new files
>        (between opening the file and moment, final permissions have been
>        applied) [information disclosure]
>

Ack.

> We then will need to assign IDs for various broken uses of /var/log (If
> someone has a list of the currently known ones, please pass it along)

AFAICS on openSUSE Factory we have
cobbler
inn
safte-monitor
uucp

service owned log dirs without logrotate:
cups
horde

cu
Ludwig

--
 (o_   Ludwig Nussel
 //\
 V_/_  <http://www.suse.de/>
SUSE LINUX Products GmbH, GF: Markus Rex, HRB 16746 (AG Nuernberg)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


