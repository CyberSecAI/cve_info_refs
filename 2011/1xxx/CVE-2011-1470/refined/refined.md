```
{
  "cve": "CVE-2011-1470",
  "description": "The PHP stream_get_contents function, as used in PHP 5.3.4, does not properly handle ziparchive streams, which allows context-dependent attackers to cause a denial of service (segmentation fault) via a crafted application that uses the stream_get_contents function to access a ziparchive stream.",
  "affected_versions": {
    "php": [
      "5.3.4"
    ]
  },
  "vulnerability": {
    "root_cause": "A null pointer dereference vulnerability exists in the php_zip_ops_stat function due to improper handling of ziparchive streams when used with the stream_get_contents() function.",
    "weaknesses": [
      "Null pointer dereference"
    ],
    "impact": "A segmentation fault, leading to a denial of service, occurs due to the null pointer dereference.",
    "attack_vectors": {
      "attacker_capabilities": "The attacker requires the ability to execute PHP code on the server.",
      "attacker_position": "The attacker can be remote."
    },
   "details": "The vulnerability occurs in the php_zip_ops_stat function, specifically in /root/php-5.3.4/ext/zip/zip_stream.c:111, when called from _php_stream_copy_to_mem within the stream_get_contents function. The issue is triggered when a crafted stream from a zip archive is passed to stream_get_contents, resulting in the use of an optimized-out value in the php_zip_ops_stat function which causes a segmentation fault."
  }
}
```