Based on the provided information, here's a breakdown of the vulnerability described in CVE-2011-1187:

**Root Cause of Vulnerability:**

The root cause lies in how JavaScript exceptions handle script filenames, particularly after HTTP redirects. When a script is loaded via `<script src="...">`, the `nsScriptLoader::EvaluateScript` function passes the final URL (after any redirects) as the script's filename. This filename is then included in the data exposed by JavaScript exceptions.

**Weaknesses/Vulnerabilities Present:**

*   **Information Disclosure:** The vulnerability allows an attacker to extract the final URL of a script after redirects by overriding the `name` getter on the `SyntaxError` or `ReferenceError` prototype. This leaks potentially sensitive information about where the script was loaded from.
*   **Cross-Origin Data Access:**  While not directly arbitrary data extraction, the filename leak can expose the content of remote sites by triggering a JavaScript error, the exception data includes the URL of the redirected script and the initial bareword.
*   **Same-Origin Policy Bypass:** By using the leaked filename, an attacker could potentially bypass same-origin policy restrictions.

**Impact of Exploitation:**

*   **Information Exposure:** Attackers could discover internal server structures or URLs not intended to be publicly known.
*   **Further Attacks:**  The leaked information could be used as a stepping stone for more complex attacks, although the information leaked is somewhat limited.
*   **Redirection Leakage:** This vulnerability means that redirects should not be used to pass security-sensitive tokens.

**Attack Vectors:**

1.  **Malicious Script Tag:** An attacker injects a script tag that includes a URL that will redirect.
2.  **Overriding Exception Getters:** A script on a page overrides the default getter of the `name` property of the `SyntaxError` or `ReferenceError` prototypes.
3.  **Triggering an Error:** The attacker causes a JavaScript error in the remotely loaded (redirected) script.
4.  **Extracting the URL:** The overridden getter extracts and logs/leaks the `fileName` property, which includes the post-redirect URL.

**Required Attacker Capabilities/Position:**

*   **Ability to inject HTML:** The attacker needs to be able to inject a script tag into a page.
*   **JavaScript execution:** The attacker needs to execute JavaScript within the context of the vulnerable page.
*   **Network access:**  The attacker needs access to the network to load remote scripts and trigger redirects, although the script could theoretically also be on the same origin.

**Technical Details:**

*   `nsScriptLoader::EvaluateScript` passes the post-redirect URI as the script filename.
*   JavaScript exceptions expose this filename, allowing an attacker to access it through overridden getter functions on the error object prototypes.
*   The fix involves adding an "origin principals" field to scripts. This enables the DOM to set the script's `filename` to the pre-redirect URI while using the `origin principals` for security checks (like those done in `onerror` handlers.)
*   The fix also involves making `JSErrorReport` include the origin principals.
*   The vulnerability is cross-browser and also affects Opera, Safari, and Chrome and Internet Explorer through `window.onerror`.

**Additional Notes:**

*   The bug was initially classified as `sg:high` (security-high) but was later lowered to `sg:moderate` to match Chrome's severity rating.
*   The fix was implemented in multiple parts:
    *   JS engine API to add originPrincipals to the script.
    *   Passing the origin principal to the JS engine when evaluating scripts using `nsIScriptContext::EvaluateString`.
    *   Using the pre-redirect filename and the channel principal when doing cross-origin checks.

This information provides a thorough understanding of the vulnerability, its impact, and the technical details of how it was addressed.