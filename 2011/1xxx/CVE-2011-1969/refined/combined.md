=== Content from www.sec-consult.com_e88bbcc3_20250126_101634.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/ "German")
Search

* Compliance & Regulations
  + [NIS2](/compliance-regulations/nis2/)
  + [Digital Operational Resilience Act (DORA)](/compliance-regulations/dora/)
* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)![EU Flags](/fileadmin/_processed_/0/a/csm_sec-consult_website-banner_EU-stars_5e5c1c8cf8.png "Digital Operational Resilience Act (DORA)")
# Digital Operational Resilience Act (DORA)

Stay compliant and resilient with DORA: Our customized cybersecurity solutions protect your business. Partner with us to navigate regulatory changes with confidence.

[Read more](/compliance-regulations/dora/)[Your global cyber security partnerGet in touch with your local experts and make a personal appointment.](/contact/)[Victim of a cyber attack?The SEC Defence-Team is there for your company 24/7. Contact us now!](/incident-response/sec-defence/)[Latest advisoriesClick here to check out the latest advisories from our leading researchers.](/vulnerability-lab/)[![](/fileadmin/_processed_/f/1/csm_image-nutshell_start-page_Feb2022_ff21ec9111.png)](/fileadmin/_processed_/f/1/csm_image-nutshell_start-page_Feb2022_ca7e0d3b42.png)
### Concerned about your cyber security status?

Contact us now and get advice from our experts.
[Contact us](/contact/)
## Latest Advisories

### [Reflected Cross-Site Scripting in Numerix License Server Administration System Login](/vulnerability-lab/advisory/reflected-cross-site-scripting-in-numerix-license-server-administration-system-login/ "Reflected Cross-Site Scripting in Numerix License Server Administration System Login")

11. Dec 2024
### [Multiple Critical Vulnerabilities in Image Access Scan2Net](/vulnerability-lab/advisory/multiple-critical-vulnerabilities-in-image-access-scan2net/ "Multiple Critical Vulnerabilities in Image Access Scan2Net")

04. Dec 2024
### [Stored Cross-Site Scripting in Omada Identity](/vulnerability-lab/advisory/stored-cross-site-scripting-in-omada-identity/ "Stored Cross-Site Scripting in Omada Identity")

27. Nov 2024

---

## SEC Consult Blog

### [Ransomhub Ransomware: Double-Extortion Attack and How to Defend](/blog/detail/ransomhub-ransomware-gang/ "Ransomhub Ransomware: Double-Extortion Attack and How to Defend")

[![A cybersecurity-themed image featuring an encrypted digital environment.](/fileadmin/_processed_/a/d/csm_AdobeStock_295359425_d4efa62057.jpeg)](/blog/detail/ransomhub-ransomware-gang/ "Ransomhub Ransomware: Double-Extortion Attack and How to Defend")
15.01.2025
defence

Cyberattacks are constantly evolving, and ransomware remains a critical threat. We recently encountered the RansomHub ransomware group, which…

[Read more](/blog/detail/ransomhub-ransomware-gang/ "Ransomhub Ransomware: Double-Extortion Attack and How to Defend")
### [Cyber Threats to EV Charging Infrastructure: Risks and Protection through Penetration Testing](/blog/detail/cyber-threats-to-ev-charging-infrastructure-risks-and-protection-through-penetration-testing/ "Cyber Threats to EV Charging Infrastructure: Risks and Protection through Penetration Testing ")

[![Power supply for electric car charging](/fileadmin/_processed_/e/4/csm_sec-consult-h-ev-charging_a34295ce26.jpeg)](/blog/detail/cyber-threats-to-ev-charging-infrastructure-risks-and-protection-through-penetration-testing/ "Cyber Threats to EV Charging Infrastructure: Risks and Protection through Penetration Testing ")
15.01.2025
news

Attacks on the charging infrastructure for electric vehicles (EVs) are increasing, endangering the reputation and security of e-mobility. How…

[Read more](/blog/detail/cyber-threats-to-ev-charging-infrastructure-risks-and-protection-through-penetration-testing/ "Cyber Threats to EV Charging Infrastructure: Risks and Protection through Penetration Testing ")
### [TLPT in the Financial Sector Under DORA: Assessing the Current Status of TIBER](/blog/detail/tlpt-in-the-financial-sector-under-dora-assessing-the-current-status-of-tiber/ "TLPT in the Financial Sector Under DORA: Assessing the Current Status of TIBER")

[![Financial Background](/fileadmin/_processed_/3/e/csm_sec-consult-h-DORA-TIBER-TLPT_8b93376395.jpeg)](/blog/detail/tlpt-in-the-financial-sector-under-dora-assessing-the-current-status-of-tiber/ "TLPT in the Financial Sector Under DORA: Assessing the Current Status of TIBER")
17.12.2024
DORA

This blog post addresses the need to integrate Threat Led Penetration Testing (TLTP) into the ICT risk management framework and Digital Operational…

[Read more](/blog/detail/tlpt-in-the-financial-sector-under-dora-assessing-the-current-status-of-tiber/ "TLPT in the Financial Sector Under DORA: Assessing the Current Status of TIBER")

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), NIS security audits, [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from docs.microsoft.com_5562eceb_20250125_162820.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2011/ms11-079.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS11-079 - Important

## Vulnerabilities in Microsoft Forefront Unified Access Gateway Could Cause Remote Code Execution (2544641)

Published: October 11, 2011

**Version:** 1.0

### General Information

#### **Executive Summary**

This security update resolves five privately reported vulnerabilities in Microsoft Forefront Unified Access Gateway (UAG). The most severe of these vulnerabilities could allow remote code execution if a user visits an affected Web site using a specially crafted URL. However, an attacker would have no way to force users to visit such a Web site. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.

This security update is rated Important for all supported versions of Microsoft Forefront Unified Access Gateway 2010. For more information, see the subsection, **Affected and Non-Affected Software**, in this section.

The security update addresses the vulnerabilities by modifying the way that UAG handles specially crafted requests, modifying the MicrosoftClient.JAR file, and adding exception handling around the null value of the UAG Web server. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, **Vulnerability Information**.

**Recommendation.** Microsoft recommends that customers apply the update at the earliest opportunity.

**Known Issues.** [Microsoft Knowledge Base Article 2544641](https://support.microsoft.com/kb/2544641) documents the currently known issues that customers may experience when installing this security update. The article also documents recommended solutions for these issues.

#### **Affected and Non-Affected Software**

The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| Operating System | Maximum Security Impact | Aggregate Severity Rating | Bulletins Replaced by this Update |
| --- | --- | --- | --- |
| [Microsoft Forefront Unified Access Gateway 2010](https://www.microsoft.com/download/details.aspx?familyid=770ad8ba-4d9a-404e-9515-6ed1e41682df)[1]\ (KB2522482) | Remote Code Execution | Important | None |
| [Microsoft Forefront Unified Access Gateway 2010 Update 1](https://www.microsoft.com/download/details.aspx?familyid=b0de8d20-9c25-41c0-9c02-d263b9ed22fa)[1]\ (KB2522483) | Remote Code Execution | Important | None |
| [Microsoft Forefront Unified Access Gateway 2010 Update 2](https://www.microsoft.com/download/details.aspx?familyid=166bdfcb-5088-4471-9d51-a3071ac13b73)[1]\ (KB2522484) | Remote Code Execution | Important | None |
| [Microsoft Forefront Unified Access Gateway 2010 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=8b6ad2ae-e168-45d9-bd3f-5590e0cbd2b5)[1]\ (KB2522485) | Remote Code Execution | Important | None |

[1]This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**.

## Frequently Asked Questions (FAQ) Related to This Security Update

**Why are the updates only available from the Microsoft Download Center?**

Microsoft is releasing these updates to the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible.

**Where are the file information details?**

Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details.

**Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?**

Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](https://go.microsoft.com/fwlink/?linkid=21155).

**Do administrators need to perform any additional actions after installing this update?**

Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin.

**Why does this update address several reported security vulnerabilities?**

This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only.

### **Vulnerability Information**

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](https://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](https://technet.microsoft.com/security/cc998259.aspx).

| Affected Software | ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 | ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 | Default Reflected XSS Vulnerability - CVE-2011-1897 | Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 | Null Session Cookie Crash - CVE-2011-2012 | Aggregate Severity Rating |
| --- | --- | --- | --- | --- | --- | --- |
| Microsoft Forefront Unified Access Gateway 2010 | **Important** \ Elevation of Privilege | **Important** \ Elevation of Privilege | **Important** \ Elevation of Privilege | **Important** \ Remote Code Execution | **Important** \ Denial of Service | **Important** |
| Microsoft Forefront Unified Access Gateway 2010 Update 1 | **Important** \ Elevation of Privilege | **Important** \ Elevation of Privilege | **Important** \ Elevation of Privilege | **Important** \ Remote Code Execution | **Important** \ Denial of Service | **Important** |
| Microsoft Forefront Unified Access Gateway 2010 Update 2 | **Important** \ Elevation of Privilege | **Important** \ Elevation of Privilege | **Important** \ Elevation of Privilege | **Important** \ Remote Code Execution | **Important** \ Denial of Service | **Important** |
| Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 | **Important** \ Elevation of Privilege | **Important** \ Elevation of Privilege | **Important** \ Elevation of Privilege | **Important** \ Remote Code Execution | **Important** \ Denial of Service | **Important** |

## ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895

An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](https://www.cve.org/CVERecord?id=CVE-2011-1895).

#### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.

#### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895

Microsoft has not identified any workarounds for this vulnerability.

#### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895

**What is the scope of the vulnerability?**

This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure.

**What causes the vulnerability?**

This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim.

**How could an attacker exploit the** **vulnerability?**

For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser.

In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL.

In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL.

**What systems are primarily at risk from the vulnerability?**

Users with access to a UAG server are at risk of exploitation of this vulnerability.

**What does the update do?**

This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued.

## ExcelTable Reflected XSS Vulnerability - CVE-2011-1896

An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](https://www.cve.org/CVERecord?id=CVE-2011-1896).

#### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.

#### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896

Microsoft has not identified any workarounds for this vulnerability.

#### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896

**What is the scope of the vulnerability?**

This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure.

**What causes the vulnerability?**

This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim.

**How could an attacker exploit the** **vulnerability?**

For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser.

In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL.

In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL.

**What systems are primarily at risk from the vulnerability?**

Users with access to a UAG server are at risk of exploitation of this vulnerability.

**What does the update do?**

This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued.

## Default Reflected XSS Vulnerability - CVE-2011-1897

An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](https://www.cve.org/CVERecord?id=CVE-2011-1897).

#### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.

#### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897

Microsoft has not identified any workarounds for this vulnerability.

#### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897

**What is the scope of the vulnerability?**

This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure.

**What causes the vulnerability?**

This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim.

**How could an attacker exploit the** **vulnerability?**

For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser.

In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL.

In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL.

**What systems are primarily at risk from the vulnerability?**

Users with access to a UAG server are at risk of exploitation of this vulnerability.

**What does the update do?**

This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued.

## Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969

Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](https://www.cve.org/CVERecord?id=CVE-2011-1969).

#### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

#### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Blacklist the MicrosoftClient.Jar file**

  Add the entry for the following file:

  Java\jre6\lib\security\blacklist

  ```
  # UAG Client MicrosoftClient.jar
  SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=

  ```

  **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.

  **How to undo the workaround.**

  Remove the entry for the following file:

  Java\jre6\lib\security\blacklist

  ```
  # UAG Client MicrosoftClient.jar
  SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=

  ```

#### FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**What causes the vulnerability?**

This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server.

**What might an attacker use the vulnerability to do?**

An attacker could use this vulnerability to exploit clients that use UAG.

**How could an attacker exploit the** **vulnerability?**

A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

**What systems are primarily at risk from the vulnerability?**

Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server.

**What does the update do?**

This update modifies the vulnerable .jar file.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued.

## Null Session Cookie Crash - CVE-2011-2012

A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2012](https://www.cve.org/CVERecord?id=CVE-2011-2012).

#### Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012

Microsoft has not identified any mitigating factors for this vulnerability.

#### Workarounds for Null Session Cookie Crash - CVE-2011-2012

Microsoft has not identified any workarounds for this vulnerability.

#### FAQ for Null Session Cookie Crash - CVE-2011-2012

**What is the scope of the vulnerability?**

This is a denial of service vulnerability.

**What causes the vulnerability?**

This vulnerability is caused by improper validation of a NULL value contained within the session cookie.

**What might an attacker use the vulnerability to do?**

An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine.

**How could an attacker exploit the** **vulnerability?**

An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server.

**What systems are primarily at risk from the vulnerability?**

Systems running UAG Web server.

**What does the update do?**

This update adds exception handling around the null value of the UAG Web server.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued.

### Update Information

## Detection and Deployment Tools and Guidance

Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](https://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](https://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products.

Security updates are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for "security update." These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels.

## Security Update Deployment

**Affected Software**

For information about the specific security update for your affected software, click the appropriate link:

#### Forefront Unified Access Gateway 2010 (all versions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | For Forefront Unified Access Gateway 2010 (KB2522482):\ UAG\_HF\_KB2522482\_0\_0\_8.msp /quiet |
| For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\ UAG-KB2522483-v4.0.1152.163-ENU.msp /quiet |  |
| For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\ UAG-KB2522484-v4.0.1269.284-ENU.msp /quiet |  |
| For Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\ UAG-KB2522485-v4.0.1752.10073-ENU.msp /quiet |  |
| Installing without restarting | For Forefront Unified Access Gateway 2010 (KB2522482):\ UAG\_HF\_KB2522482\_0\_0\_8.msp /norestart |
| For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\ UAG-KB2522483-v4.0.1152.163-ENU.msp /norestart |  |
| For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\ UAG-KB2522484-v4.0.1269.284-ENU.msp /norestart |  |
| For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\ UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestart |  |
| Update log file | For Forefront Unified Access Gateway 2010 (KB2522482):\ MSI2522482.log |
| For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\ MSI2522483.log |  |
| For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\ MSI2522484.log |  |
| For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\ MSI2522485.log |  |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance** |
| **Restart Requirement** |  |
| Restart required? | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| HotPatching | Not applicable |
| **Removal Information** | Use the **Installed Updates** window as build-in Administrator or run **msiexec** from an elevated command line. |
| **File Information** | For Forefront Unified Access Gateway 2010 (KB2522482):\ See [Microsoft Knowledge Base Article 2522482](https://support.microsoft.com/kb/2522482) |
| For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\ See [Microsoft Knowledge Base Article 2522483](https://support.microsoft.com/kb/2522483) |  |
| For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\ See [Microsoft Knowledge Base Article 2522484](https://support.microsoft.com/kb/2522484) |  |
| For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\ See [Microsoft Knowledge Base Article 2522485](https://support.microsoft.com/kb/2522485) |  |
| **Registry Key Verification** | For Forefront Unified Access Gateway 2010 (KB2522482):\ \HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\1F535B6CD0A46D11CA9800102002AF58\E85EC0B9221C4BC4081C15D414260CC7\54EBBA62-C7BB-4006-91D2-EFEB0738F93A |
| For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\ \HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\1F535B6CD0A46D11CA9800102002AF58\E85EC0B9221C4BC4081C15D414260CC7\038FB8C4-F12D-428B-83F5-A964C34B6F2E |  |
| For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\ \HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\1F535B6CD0A46D11CA9800102002AF58\E85EC0B9221C4BC4081C15D414260CC7\95244A26-7896-47D2-A49D-1FF43BC1C53C |  |
| For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\ \HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\1F535B6CD0A46D11CA9800102002AF58\E85EC0B9221C4BC4081C15D414260CC7\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 |  |

#### Deployment Information

**Installing the Update**

When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix.

If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see [Microsoft Knowledge Base Article 824994](https://support.microsoft.com/kb/824994).

For more information about the installer, see [Microsoft Knowledge Base Article 832475](https://support.microsoft.com/kb/832475).

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options. |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed. |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Displays a dialog box prompting the local user to allow a restart. |
| Special Options |  |
| **/overwriteoem** | Overwrites OEM files without prompting. |
| **/nobackup** | Does not back up files needed for uninstall. |
| **/forceappsclose** | Forces other programs to close when the computer shuts down. |
| **/log:path** | Allows the redirection of installation log files. |
| **/integrate:path** | Integrates the update into the Windows source files. These files are located at the path that is specified in the switch. |
| **/extract[:path]** | Extracts files without starting the Setup program. |
| **/ER** | Enables extended error reporting. |
| **/verbose** | Enables verbose logging. During installation, creates %Windir%\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Note for this update** However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in [Microsoft Knowledge Base Article 2316074](https://support.microsoft.com/kb/2316074).

**Removing the Update**

This security update supports the following setup switches.

| Switch | Description |
| --- | --- |
| **/help** | Displays the command-line options. |
| Setup Modes |  |
| **/passive** | Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds. |
| **/quiet** | Quiet mode. This is the same as unattended mode, but no status or error messages are displayed. |
| Restart Options |  |
| **/norestart** | Does not restart when installation has completed |
| **/forcerestart** | Restarts the computer after installation and force other applications to close at shutdown without saving open files first. |
| **/warnrestart[:x]** | Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch. |
| **/promptrestart** | Displays a dialog box prompting the local user to allow a restart. |
| Special Options |  |
| **/forceappsclose** | Forces other programs to close when the computer shuts down. |
| **/log:path** | Allows the redirection of installation log files. |

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, **Detection and Deployment Tools and Guidance**, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All** **files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.

     **Note** Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.

     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.
* **Registry Key Verification**

  You may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the **Reference Table** in this section.

  These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files.

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* [Tenable Network Security](https://www.tenable.com/) for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)
* [Tenable Network Security](https://www.tenable.com/) for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)
* [Tenable Network Security](https://www.tenable.com/) for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)
* Elisabeth Demeter of [SEC Consult Unternehmensberatung GmbH](https://www.sec-consult.com/) for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969)

#### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

#### Support

* Customers in the U.S. and Canada can receive technical support from [Security Support](https://go.microsoft.com/fwlink/?linkid=21131) or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see [Microsoft Help and Support](https://support.microsoft.com/).
* International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the [International Support Web site](https://go.microsoft.com/fwlink/?linkid=21155).

#### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (October 11, 2011): Bulletin published.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


