Based on the provided content, here's an analysis of CVE-2011-1870:

**Root Cause of Vulnerability:**

*   The vulnerability is caused by an integer overflow condition within the Windows Client/Server Run-time Subsystem (CSRSS). This occurs specifically when handling the `SrvWriteConsoleOutputString` function.

**Weaknesses/Vulnerabilities Present:**

*   **Integer Overflow:** The primary vulnerability is an integer overflow.  This can lead to memory corruption because the size calculation for memory allocation or access becomes incorrect.

**Impact of Exploitation:**

*   **Elevation of Privilege:** Successful exploitation allows an attacker to run arbitrary code in kernel mode.
*   **Complete System Control:** This level of access allows the attacker to install programs, view, change, or delete data, or create new accounts with full user rights.

**Attack Vectors:**

*   **Local Access:** An attacker must have valid logon credentials and be able to log on locally to the system.
*   **Specially Crafted Application:** The attacker needs to run a specially crafted application to trigger the integer overflow vulnerability.

**Required Attacker Capabilities/Position:**

*   **Local User Account:** Requires a valid user account on the target system.
*   **Ability to Execute Code:** The attacker must be able to run a custom program on the system.

**Additional Notes:**

*   The vulnerability exists in the way CSRSS assigns memory for specific user transactions.
*   The specific function `SrvWriteConsoleOutputString` is implicated in the vulnerability.
*   The fix involves modifying bounds checking to prevent memory corruption caused by the integer overflow.
*   The vulnerability was privately reported and not publicly known before the release of the security update.

This information is consistent with the CVE description, and the provided content from Microsoft provides detailed information about the root cause, impact, and affected systems.