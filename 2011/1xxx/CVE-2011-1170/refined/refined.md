Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2011-1170:

**Root Cause of Vulnerability:**

*   The vulnerability lies in the `arp_tables` module of the Linux kernel's netfilter subsystem. Specifically, structures like `ipt_replace`, `compat_ipt_replace`, and `xt_get_revision`, which are copied from userspace, contain fields that are treated as zero-terminated strings. These fields are not checked for proper null termination before being used as arguments in format strings within `request_module()`.

**Weaknesses/Vulnerabilities Present:**

*   **Improper Input Validation:** The kernel fails to validate that the zero-terminated string fields from userspace are indeed properly terminated.
*   **Format String Vulnerability:** The unchecked strings are then passed as arguments to format strings within the `request_module()` function, which can lead to an information leak.

**Impact of Exploitation:**

*   **Information Leak:** Sensitive kernel information can be leaked to userspace by injecting malicious, unterminated strings which, during the format string processing, result in the `modprobe` process being launched with arguments containing kernel data from the affected memory region.

**Attack Vectors:**

*   A local attacker with the `CAP_NET_ADMIN` capability can trigger this vulnerability.
*   By crafting specific, malicious userspace data, an attacker can cause the kernel to leak sensitive information via a spawned modprobe process.

**Required Attacker Capabilities/Position:**

*   **CAP_NET_ADMIN Capability:** The attacker must have the `CAP_NET_ADMIN` capability on the system, which generally implies having administrative-level control over the network configuration, and in most cases root access.
*   **Local Access:** The attacker needs to have local access to the system in order to control the userspace data passed to the kernel.

**Additional Technical Details:**

*   The vulnerability is triggered within the `do_replace`, `compat_do_replace`, and `do_arpt_get_ctl` functions of the kernel module.
*   The vulnerable code involves copying structures from userspace and then utilizing unchecked string fields within those structures as arguments to `request_module` in format strings that use "%s", ultimately leading to the information leak.
*   The fix involves ensuring that the user provided strings are null terminated before being used in `request_module`.

**CVE Specific Details:**
*   CVE-2011-1170 refers specifically to the vulnerability within the `arp_tables` module. Similar vulnerabilities were found in `ip_tables`, and `ip6_tables` modules which are addressed by CVE-2011-1171 and CVE-2011-1172, respectively.
*   The issue was reported by Vasiliy Kulikov of Openwall.
*   Patches were created and fixes were released in various Red Hat Enterprise Linux versions.