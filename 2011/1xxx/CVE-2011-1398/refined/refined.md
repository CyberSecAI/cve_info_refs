Based on the provided content, here's an analysis of CVE-2011-1398:

**Description of Vulnerability:**

*   **Vulnerability:** HTTP Response Splitting
*   **Root Cause:** The `sapi_header_op` function in PHP before 5.3.11 and 5.4.x before 5.4.0RC2 does not properly handle `%0D` sequences (carriage return characters). This allows attackers to bypass HTTP response-splitting protection mechanisms.
*   **Weakness:** Improper input validation of carriage return characters in the `header()` function.
*   **Attack Vector:** A crafted URL containing `%0D` sequences.
*   **Impact:** Remote attackers can bypass HTTP response splitting protection mechanisms, potentially leading to various attacks like cross-site scripting (XSS) or cache poisoning.
*   **Affected Software:** PHP versions before 5.3.11 and 5.4.x before 5.4.0RC2.
*   **Exploitation:** The vulnerability is triggered by improper interaction between the PHP `header` function and certain browsers like Internet Explorer and Google Chrome, which recognize carriage returns as line endings.

**Mitigation:**

*   The vulnerability is resolved in PHP 5.3.11 and later and 5.4.0RC2 and later by properly handling or checking for %0D sequences in the `sapi_header_op` function.

**Affected Systems (Identified in content):**

*   Red Hat Enterprise Linux 5 and 6
*   SUSE Linux Enterprise Desktop 11 SP2 and SP4
*   SUSE Linux Enterprise Server 11 SP2, SP3 and SP4
*   Ubuntu (various versions)

**Additional Notes:**

*   The vulnerability was originally reported by `rui_hirokawa.jp` to the PHP project.
*   The fix involved forbidding carriage returns and newlines after null characters, allowing CRLF followed by HT or SP, and forbidding null characters.
*   There was an incorrect fix in PHP 5.4.0RC2 through 5.4.0 that was later corrected. This incorrect fix is tracked as CVE-2012-4388.