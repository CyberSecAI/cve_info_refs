```
{
  "Root cause of vulnerability": "The vulnerability is caused by the switch from plaintext to TLS being implemented below the application's I/O buffering layer.",
  "Weaknesses/vulnerabilities present": "STARTTLS implementations do not properly purge the application's I/O buffer when switching to TLS, allowing for command injection.",
  "Impact of exploitation": "A remote attacker with the ability to perform a man-in-the-middle attack can inject commands during the plaintext protocol phase that will then be executed during the ciphertext protocol phase. This could allow the attacker to execute arbitrary commands on the server, depending on the protocol used (e.g., SMTP, POP3).",
  "Attack vectors": "Man-in-the-middle attack.",
  "Required attacker capabilities/position": "The attacker needs to be in a position to intercept and modify network traffic between the client and server."
}
```