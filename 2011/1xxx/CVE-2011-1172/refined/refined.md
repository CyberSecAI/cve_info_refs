```
{
  "CVE-2011-1172": {
    "related_content": [
      {
        "source": "downloads.avaya.com_64669458_20250125_071608.html",
        "Description": "The content mentions CVE-2011-1172 as one of multiple vulnerabilities fixed in a kernel security update. Specifically, it states: \"Missing validations of null-terminated string data structure elements in the do_replace(), compat_do_replace(), do_ipt_get_ctl(), do_ip6t_get_ctl(), and do_arpt_get_ctl() functions could allow a local user who has the CAP_NET_ADMIN capability to cause an information leak. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the names [CVE-2011-1170](https://www.redhat.com/security/data/cve/CVE-2011-1170.html), [CVE-2011-1171](https://www.redhat.com/security/data/cve/CVE-2011-1171.html) and [CVE-2011-1172](https://www.redhat.com/security/data/cve/CVE-2011-1172.html) to these issues.\"\nIt is further explained in the mitigating factors section that the risk is low because exploitation requires local user access and could only result in information leakage. Avaya Aura products are listed as potentially affected."
      },
      {
        "source": "www.openwall.com_17f90f27_20250125_071610.html",
        "Description": "This content is a message from Vasiliy Kulikov to the oss-security mailing list, requesting a CVE for multiple kernel vulnerabilities, including one that is assigned CVE-2011-1172. The message describes the vulnerability as follows: \"Structures ip6t_replace, compat_ip6t_replace, and xt_get_revision are copied from userspace. Fields of these structs that are zero-terminated strings are not checked. When they are used as argument to a format string containing \"%s\" in request_module(), some sensitive information is leaked to userspace via argument of spawned modprobe process. The first bug was introduced before the git epoch; the second was introduced in 3bc3fe5e (v2.6.25-rc1); the third is introduced by 6b7d31fc (v2.6.15-rc1). To trigger the bug one should have CAP_NET_ADMIN.\""
      },
       {
        "source": "bugzilla.redhat.com_606f2292_20250126_070854.html",
        "Description": "This is a Red Hat Bugzilla entry for CVE-2011-1172, detailing the vulnerability as an information leak in the Linux kernel's IPv6 netfilter component. It confirms that the issue involves the lack of null-termination checks in strings copied from userspace. Specifically, it states: \"Structures ip6t_replace, compat_ip6t_replace, and xt_get_revision are copied from userspace. Fields of these structs that are zero-terminated strings are not checked. When they are used as argument to a format string containing \"%s\" in request_module(), some sensitive information is leaked to userspace via argument of spawned modprobe process.\" It also specifies that the vulnerability requires CAP_NET_ADMIN privileges to trigger and references the upstream commit which fixes the issue. Additionally, the bug entry includes links to Red Hat Product Errata that address this issue in different versions of Red Hat Enterprise Linux and MRG."
      },
      {
        "source": "rhn.redhat.com_782ae148_20250125_071608.html",
        "Description": "This content is a Red Hat Security Advisory (RHSA-2011:0833) that includes CVE-2011-1172 as a fix. The description says: \"Missing validations of null-terminated string data structure elements in the do_replace(), compat_do_replace(), do_ipt_get_ctl(), do_ip6t_get_ctl(), and do_arpt_get_ctl() functions could allow a local user who has the CAP_NET_ADMIN capability to cause an information leak.\". It also mentions Vasiliy Kulikov for reporting the vulnerability."
      },
      {
        "source": "www.openwall.com_674326d9_20250125_071611.html",
        "Description": "This content is from a mailing list where Eugene Teo from Red Hat responded to the initial CVE request for CVE-2011-1172, specifically describing it as:\"[PATCH] ipv6: netfilter: ip6_tables: fix infoleak to userspace CVE-2011-1172\" and links to the associated bugzilla and patch."
      },
       {
        "source": "bugzilla.redhat.com_00949bcf_20250126_070848.html",
        "Description":"This is a Red Hat Bugzilla entry for CVE-2011-1172. It details the vulnerability as an information leak in the Linux kernel's IPv6 netfilter component, arising from the lack of null-termination checks in strings copied from userspace. The description states that 'Structures ip6t_replace, compat_ip6t_replace, and xt_get_revision are copied from userspace. Fields of these structs that are zero-terminated strings are not checked. When they are used as argument to a format string containing \"%s\" in request_module(), some sensitive information is leaked to userspace via argument of spawned modprobe process.' It also highlights that CAP_NET_ADMIN privileges are required for exploitation and references the upstream commit for the fix. The bug entry also links to Red Hat Product Errata addressing this issue."
      },
       {
        "source": "bugzilla.redhat.com_73f35e35_20250125_071612.html",
        "Description": "This Red Hat Bugzilla entry for CVE-2011-1172 describes the vulnerability as an information leak in the Linux kernel's IPv6 netfilter component. The description states: 'Structures ip6t_replace, compat_ip6t_replace, and xt_get_revision are copied from userspace. Fields of these structs that are zero-terminated strings are not checked. When they are used as argument to a format string containing \"%s\" in request_module(), some sensitive information is leaked to userspace via argument of spawned modprobe process.' It notes that the issue requires CAP_NET_ADMIN privileges to exploit and references the fix commit. The bug entry also links to associated Red Hat Product Errata."
      },
      {
        "source": "www.openwall.com_a0e20703_20250125_071610.html",
        "Description":"This content is from a mailing list, where Eugene Teo from Red Hat provides a summary and patch info for various CVEs including CVE-2011-1172:  \"[PATCH] ipv6: netfilter: ip6_tables: fix infoleak to userspace CVE-2011-1172\", referring to the lack of null-termination checks for user-supplied strings being the root cause. This communication also clarifies the CAP_NET_ADMIN capability as a requirement to exploit."
      }
    ],
    "Root cause": "The root cause is the missing validation of null-terminated strings copied from userspace in the `ip6t_replace`, `compat_ip6t_replace`, and `xt_get_revision` structures. When these unchecked strings are used in a format string with `%s` within the `request_module()` function, they can cause a sensitive information leak via the spawned modprobe process's arguments.",
    "Weaknesses": [
      "Missing null-termination validation of user-supplied strings",
      "Use of user-controlled strings in format strings",
      "Lack of proper input sanitization"
     ],
    "Impact": "The impact is an information leak, potentially exposing sensitive kernel or system data to a local user.",
    "Attack vectors": "The attack vector is local, involving a user with CAP_NET_ADMIN privileges who can manipulate the content of the string. The attacker would cause the kernel to use user-supplied data as the formatting string.",
    "Required attacker capabilities": [
      "Local user access",
      "CAP_NET_ADMIN capability",
      "Ability to manipulate string data structures provided to the netfilter functionality"
    ]
  }
}
```