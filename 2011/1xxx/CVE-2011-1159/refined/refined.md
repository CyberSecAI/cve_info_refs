```
{
  "cve": "CVE-2011-1159",
  "description": "The acpid daemon, when writing to a UNIX socket in blocking mode, could hang if an unprivileged client stops reading from the socket, leading to a denial of service. This is due to the socket queue filling up, which blocks the acpid daemon until the client reads data or exits.",
  "vulnerability_details": {
    "root_cause": "The acpid daemon uses a UNIX socket in blocking mode to communicate with unprivileged clients about ACPI events. If a client stops reading from the socket, the socket's queue fills up.",
    "weaknesses": [
      "The use of a blocking socket for communication with unprivileged clients.",
      "Lack of proper handling for full socket queues when writing data."
    ],
    "impact": "The acpid daemon will hang, leading to a denial of service, as it will stop processing new events or requests until the blocking socket is cleared by the client.",
    "attack_vectors": "An unprivileged process connects to the acpid UNIX socket and intentionally stops reading from the socket.",
     "attacker_capabilities": "An attacker needs to be able to run an unprivileged process on the same system as acpid and have the ability to connect to the acpid UNIX socket (typically /var/run/acpid.socket)."
  },
   "affected_component": "acpid",
    "fix_details": "The vulnerability is fixed by changing the socket to non-blocking mode, which prevents the acpid daemon from hanging due to a full queue. The patch provided sets the `O_NONBLOCK` flag on the client socket using `fcntl`."
}
```