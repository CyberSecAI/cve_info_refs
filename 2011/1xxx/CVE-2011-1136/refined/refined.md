```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": [
    {
      "content_type": "relevant",
      "content": "CVE-2011-1136\n\n| **Name** | CVE-2011-1136 |\n| --- | --- |\n| **Description** | In tesseract 2.03 and 2.04, an attacker can rewrite an arbitrary user file by guessing the PID and creating a link to the user's file. |\n| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2011-1136) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2011-1136); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2011-1136), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2011-1136), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2011-1136), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2011-1136), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2011-1136), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2011-1136), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2011-1136), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2011-1136)/[CVE](https://www.suse.com/security/cve/CVE-2011-1136/), GitHub [advisories](https://github.com/advisories?query=CVE-2011-1136)/[code](https://github.com/search?type=Code&q=%22CVE-2011-1136%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2011-1136%22), [web search](https://duckduckgo.com/html?q=%22CVE-2011-1136%22), [more](https://oss-security.openwall.org/wiki/vendors)) |\n| **Debian Bugs** | [612032](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=612032) |\n\n## Vulnerable and fixed packages\n\nThe table below lists information on source packages.\n\n| Source Package | Release | Version | Status |\n| --- | --- | --- | --- |\n| [tesseract](/tracker/source-package/tesseract) ([PTS](https://tracker.debian.org/pkg/tesseract)) | bullseye | 4.1.1-2.1 | fixed |\n|  | bookworm | 5.3.0-2 | fixed |\n|  | sid, trixie | 5.3.4-1.4 | fixed |\n\nThe information below is based on the following data on fixed versions.\n\n| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |\n| --- | --- | --- | --- | --- | --- | --- |\n| [tesseract](/tracker/source-package/tesseract) | source | lenny | 2.03-2+lenny1 |  |  | [612032](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=612032) |\n| [tesseract](/tracker/source-package/tesseract) | source | squeeze | 2.04-2+squeeze1 |  |  |  |\n| [tesseract](/tracker/source-package/tesseract) | source | (unstable) | 2.04-2.1 | low |  | [612032](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=612032) |\n",
      "vulnerability_details": {
        "root_cause": "The vulnerability stems from a debug feature in tesseract where a temporary file is created in /tmp/ based on the process ID (PID).",
        "weaknesses": [
          "The program creates a temporary file in a predictable location based on the process ID (PID).",
          "An attacker can exploit the vulnerability by creating a symbolic link to a file that the user has write access to, thus gaining the ability to overwrite that file."
        ],
        "impact": "An attacker can rewrite an arbitrary user file by exploiting the predictable temporary file name.",
        "attack_vectors": [
          "Local Access"
        ],
        "attacker_capabilities": "The attacker needs to guess or determine the PID of the tesseract process and have local access to create a symlink to a user writable file."
      }
    },
    {
      "content_type": "relevant",
      "content": "# Debian Bug report logs - #612032 vulnerability: rewrite arbitrary user file\n\nPackage:\n[tesseract](pkgreport.cgi?package=tesseract);\nMaintainer for [tesseract](pkgreport.cgi?package=tesseract) is [Alexander Pozdnyakov <almipo@mail.ru>](pkgreport.cgi?maint=almipo%40mail.ru);\n\nReported by: [Kees Cook <kees@debian.org>](pkgreport.cgi?submitter=kees%40debian.org)\n\nDate: Sat, 5 Feb 2011 00:57:01 UTC\n\nSeverity: *grave*\n\nTags: patch, security\n\nFound in versions 2.03-2, 2.04-2\n\nFixed in versions tesseract/2.04-2.1, tesseract/2.03-2+lenny1, tesseract/2.04-2+squeeze1\n\n... \n\n[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=612032;msg=5), [mbox](bugreport.cgi?bug=612032;mbox=yes;msg=5), reply):\n\n![](/cgi-bin/libravatar.cgi?email=kees%40debian.org)\nFrom: Kees Cook <kees@debian.org>\nTo: Debian Bug Tracking System <submit@bugs.debian.org>\nSubject: vulnerability: rewrite arbitrary user file\nDate: Fri, 04 Feb 2011 16:52:17 -0800\n```\nPackage: tesseract\nVersion: 2.04-2\nSeverity: grave\nTags: security\nJustification: user security hole\nUser: ubuntu-devel@lists.ubuntu.com\nUsertags: origin-ubuntu natty\n\nThis bug report was also filed in Ubuntu and can be found at\n<http://launchpad.net/bugs/607297>\nThe description, from segooon, follows:\n\nHi, I've just discovered that tesseract-ocr is vulnerable to rewriting any user file:\n\nDEBUG_WIN::DEBUG_WIN(                    //constructor\n....\n  length +=\n    sprintf (command + length,\n    \\\"stty opost; tty >/tmp/debug%d; while [ -s /tmp/debug%d ]\\ndo\\nsleep 1\\ndone\\\" &\\n\",\n    pid, pid);\n\nHere attacker can create link to any file in the system that user may write to. The only he has to know - the pid of process. As it is (last PID + 1) by default, it is not difficult to guess.\n\nThanks.\n\n-- System Information:\nDebian Release: squeeze/sid\n  APT prefers natty\n  APT policy: (500, 'natty')\nArchitecture: amd64 (x86_64)\n\nKernel: Linux 2.6.37-12-generic (SMP w/4 CPU cores)\nLocale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)\nShell: /bin/sh linked to /bin/dash\n\n```",
      "vulnerability_details": {
        "root_cause": "The vulnerability stems from a debug feature within the tesseract-ocr software. It uses a `sprintf` command to create a shell command that redirects the output of the tty command to a temporary file in /tmp, with the file name derived from the process ID (PID). This method makes the temporary file location predictable.",
         "weaknesses": [
          "The program constructs a shell command using `sprintf` where the filename of a temporary file depends on the process ID.",
          "It uses a predictable temporary file name, allowing an attacker to create a symbolic link to a different file."
          ],
        "impact": "An attacker can overwrite an arbitrary file that the user has write access to, by creating a symbolic link to the target file before the program creates the temporary file.",
        "attack_vectors": [
          "Local access"
        ],
        "attacker_capabilities": "The attacker needs to have local access to the system to create the symbolic link and either know or guess the process ID of the tesseract-ocr process."
      }
    },
    {
      "content_type": "relevant",
      "content": "Hi, I've just discovered that tesseract-ocr is vulnerable to rewriting any user file:\n\nDEBUG_WIN::DEBUG_WIN( //constructor\n\n...\n\n  length +=\n\n    sprintf (command + length,\n\n    \\\"stty opost; tty >/tmp/debug%d; while [ -s /tmp/debug%d ]\\ndo\\nsleep 1\\ndone\\\" &\\n\",\n\n    pid, pid);\n\nHere attacker can create link to any file in the system that user may write to. The only he has to know - the pid of process. As it is (last PID + 1) by default, it is not difficult to guess.",
      "vulnerability_details": {
        "root_cause": "The root cause is the usage of `sprintf` to construct a shell command for debugging purposes that redirects output to a predictable file path based on the process ID (PID) in the `/tmp/` directory. This temporary file creation is part of the debug window functionality.",
        "weaknesses": [
          "The program creates a temporary file with a predictable name, derived from the process ID.",
           "The creation of this temporary file is not protected against symbolic link attacks.",
           "The debug feature uses a shell command with a hardcoded path (/tmp/), making it susceptible to exploitation."
        ],
        "impact": "An attacker can rewrite any file that the user has write access to by creating a symbolic link at the location where the program attempts to create the temporary debug file. This allows for arbitrary file overwrite.",
        "attack_vectors": [
          "Local Access"
         ],
        "attacker_capabilities": "The attacker needs local access to the system to create symbolic links. They must either know or be able to guess the process ID of the tesseract-ocr process."
      }
    },
    {
      "content_type": "relevant",
       "content": "[In tesseract 2.03 and 2.04, an attacker can rewrite an arbitrary user file by guessing the PID...](/advisories/GHSA-mr6c-m5m7-mvxj)\nModerate\n\nUnreviewed\n\nCVE-2011-1136\n\nwas published\nApr 22, 2022",
        "vulnerability_details": {
        "root_cause": "The vulnerability is in the debug functionality of tesseract versions 2.03 and 2.04. It involves creating a temporary file in `/tmp` with a predictable name derived from the process ID (PID).",
        "weaknesses": [
          "The program uses a predictable path and filename based on the PID for the temporary debug file.",
          "The program does not validate or check if a symbolic link already exists before writing to the temporary file."
        ],
        "impact": "An attacker can create a symbolic link with the same name as the temporary debug file, causing the program to overwrite a target file that the user has write access to.",
        "attack_vectors": [
          "Local access"
        ],
         "attacker_capabilities": "The attacker needs local access to create symbolic links, and knowledge or the ability to guess the PID of the running tesseract process."
      }
    },
    {
      "content_type": "relevant",
      "content": "In tesseract 2.03 and 2.04, an attacker can rewrite an arbitrary user file\nby guessing the PID and creating a link to the user's file.",
       "vulnerability_details": {
          "root_cause": "The root cause is the use of the process ID (PID) to create a temporary file name within the /tmp directory during debug operations.",
          "weaknesses": [
            "Use of a predictable filename based on PID for the temporary file.",
             "Lack of checks to prevent symlink attacks, allowing an attacker to redirect the file creation to a user-writable target."
           ],
          "impact": "An attacker can overwrite an arbitrary file that the user has write access to.",
          "attack_vectors": [
            "Local Access"
           ],
          "attacker_capabilities": "The attacker needs to have local access to create a symbolic link, and needs to know or be able to guess the PID of the tesseract process."
         }
    },
      {
      "content_type": "relevant",
      "content": "This bug was fixed in the package tesseract - 2.04-2.1\n\n---------------\n\ntesseract (2.04-2.1) unstable; urgency=low\n\n\* Non-maintainer upload.\n\n  \* Bump build-dependency on quilt to >= 0.46-7~.\n\n  \* Disable xterm-based debug windows (closes: #612032, LP: [#607297](/bugs/607297)). Thanks\n\n    to Kees Cook for the bug report.\n\n -- Bhavani Shankar <email address hidden> Thu, 10 Feb 2011 16:35:45 +0100",
       "vulnerability_details": {
        "root_cause": "The vulnerability lies in the xterm-based debug window feature of tesseract which uses process ID to generate temporary file names.",
        "weaknesses": [
          "The program creates a temporary file with a predictable name based on the process ID, making it susceptible to symlink attacks.",
           "The debug feature is enabled by default, increasing the attack surface."
           ],
        "impact": "The impact is the ability for an attacker to overwrite any user file by creating a symbolic link to the target file before the program writes to the temporary file.",
        "attack_vectors": [
          "Local Access"
           ],
        "attacker_capabilities": "The attacker needs local access to create symbolic links and must know or guess the process ID of the tesseract process."
      }
     }
  ]
}
```