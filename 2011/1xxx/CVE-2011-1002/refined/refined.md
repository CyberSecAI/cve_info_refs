Here's a breakdown of the information related to CVE-2011-1002 from the provided content:

**Vulnerability:** CVE-2011-1002

**Description:** A remote denial-of-service vulnerability in Avahi, an implementation of the zeroconf protocol.

**Root Cause:**
- The vulnerability arises from an incorrect fix for a previous issue ([CVE-2010-2244](https://access.redhat.com/security/cve/CVE-2010-2244)).
- The `avahi_recv_dns_packet_ipv4` routine in `avahi-core/socket.c` did not properly handle NULL UDP packets.
- Specifically, when a NULL UDP packet was received, the routine would check for its size, and if zero, would proceed to the fail label without clearing the message from the socket.
- Due to that, when the routine returned, a NULL packet would remain on the socket, causing an infinite loop and high CPU usage.

**Weaknesses/Vulnerabilities Present:**
- Improper handling of NULL UDP packets
- Incomplete fix for a previous vulnerability ([CVE-2010-2244](https://access.redhat.com/security/cve/CVE-2010-2244))
- Lack of clearing the socket on corrupted packets in processing routines.
- Infinite loop when processing NULL packets due to the incomplete fix.

**Impact of Exploitation:**
- Denial of Service (DoS) on the affected system.
- High CPU usage due to the infinite loop.
- Avahi daemon becomes unresponsive.

**Attack Vectors:**
- Sending a specially crafted (NULL) UDP packet to the Avahi daemon's listening port (5353).
- Remote exploitation.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send UDP packets to the Avahi daemon's listening port on the target system.
- No authentication or prior knowledge of the system is required, other than the open port.

**Technical Details:**
- The vulnerability is located within the `avahi_recv_dns_packet_ipv4` (for IPv4) and `avahi_recv_dns_packet_ipv6` (for IPv6) routines.
- The fix consists of moving the corrupted packet check after the packet retrieval. This ensures that corrupted packets are cleared, avoiding the infinite loop.
- The relevant code change is in the following commit:  `http://git.0pointer.de/?p=avahi.git;a=commitdiff;h=46109dfec75534fe270c0ab902576f685d5ab3a6`

**Affected Versions:**
- All versions of Avahi greater than 0.6.24 are vulnerable.

**Fix:**
- The fix involves moving the corrupted packet check after packet retrieval to ensure that if the packet is NULL, it is discarded correctly instead of looping.

**Additional Notes:**
- Red Hat Bugzilla bug ID for this issue is [667187](https://bugzilla.redhat.com/show_bug.cgi?id=667187)
- The vulnerability was initially reported with a different CVE ID: CVE-2011-0634, which was subsequently rejected as a duplicate of CVE-2011-1002
- Multiple distributions, including Debian, Ubuntu, and openSUSE, released security updates to address this vulnerability.