```
{
  "vulnerability_details": {
    "root_cause": "The `rt_sigqueueinfo()` system call, introduced in Linux 2.2, allows userland to specify the `siginfo_t` structure, normally written by the kernel upon signal delivery. A check was in place to prevent spoofing of signals with `SI_KERNEL` or `SI_USER` codes. However, when `tgkill()` and `tkill()` were added, this check wasn't updated to prevent spoofing `SI_TKILL` codes. As a result, the origin of a `SI_TKILL` signal could not be trusted.",
    "weaknesses": [
      "The kernel interface `rt_sigqueueinfo()` incorrectly allowed userland to specify a `SI_TKILL` si_code, leading to signal spoofing. The kernel failed to properly restrict the `si_code` value passed via `rt_sigqueueinfo()` and `rt_tgsigqueueinfo()` system calls, allowing the impersonation of signals with a `SI_TKILL` code.",
        "Glibc silently patched `SI_TKILL` to `SI_USER` in `sigwaitinfo` and `sigtimedwait` functions, thus causing userland apps trusting only `SI_USER` signals to also be vulnerable."
    ],
    "impact": "Userland applications cannot trust the pid and uid information of a `SI_TKILL` signal, thus allowing for potential privilege escalation or denial of service. A malicious process can send spoofed signals using a `SI_TKILL` code to another process, potentially causing it to misbehave or make incorrect decisions based on the signal's perceived origin. This is particularly concerning as this affects the startup code of setuid binaries which are commonly used in system security. Glibc's silent patch amplifies the risk, affecting a wide range of applications assuming the signal source is trustworthy.",
    "attack_vectors": "A local, unprivileged user can use the `rt_sigqueueinfo()` or `rt_tgsigqueueinfo()` system calls to send a signal to another process with a spoofed `SI_TKILL` `si_code`, and with arbitrary process and user IDs. This allows a local attacker to spoof the origin of signals sent to other processes.",
    "attacker_capabilities": "The attacker needs to have the ability to execute code locally on the target system. They also require the ability to invoke the affected system calls, which is usually available to unprivileged users.",
    "affected_components": [
        "Linux Kernel",
        "glibc"
    ],
     "fixed_versions": [
        "Red Hat Enterprise Linux 5 (RHSA-2011:0927)",
        "Red Hat Enterprise Linux 6.0.Z (RHSA-2011:0883)",
        "Red Hat Enterprise Linux 6 (RHSA-2011:1189)"
    ]
  }
}
```