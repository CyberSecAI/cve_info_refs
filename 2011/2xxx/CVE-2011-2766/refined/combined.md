=== Content from www.openwall.com_4ae3385f_20250125_020029.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2011/09/07/7) [[next>]](2) [[thread-next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4E687DAF.6000904@redhat.com>
Date: Thu, 08 Sep 2011 10:32:47 +0200
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>
CC: oss-security@...ts.openwall.com, Ferdinand <debbug@...tplaza.com>,
        Russ Allbery <rra@...ian.org>, Sven Verdoolaege <skimo@...net.org>,
        Chris Weyl <cweyl@...mni.drew.edu>
Subject: CVE Request -- libfcgi-perl / perl-FCGI: Certain environment variables
 shared between first and subsequent HTTP requests

Hello Josh, Steve, vendors,

   it was found that the perl Fast CGI module did not properly clean up
certain environment variables, related to a particular HTTP request,
between subsequent incoming requests. Any environment variable set in
the first pass through the code by processing the first request, that
wasn't set in some subsequent request, has been added to the hash
containing environment variables for that subsequent request. A remote
attacker could use this flaw to bypass the authentication process and
obtain access to resources, which would be otherwise protected by
authentication.

References:
[1] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=607479>
[2] <https://bugzilla.redhat.com/show_bug.cgi?id=736604>

Russ Allbery of Debian (Cc-ed) provides further elaborated analysis
of the reasons of the issue:
[3] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=607479#10>

Cc-ed also Sven Verdoolaege, the perl FCGI module author (as noted
on CPAN) for his opinion too.

Could you allocate a CVE id for this issue?

Thank you && Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

P.S.: Though the issue has been reported Sat, 18 Dec 2010 22:13:40 +0100
       already, only Russ's analysis (Wed, 07 Sep 2011 20:24:00 -0700)
       unveiled the full security implications of this issue. So I
       assume, the CVE-2011-* identifier would be sufficient to cover
       this issue. But feel free to correct me if I am wrong here.
       Thanks, Jan.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.mandriva.com_364b5d99_20250125_020028.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from www.openwall.com_afc1c358_20250125_020030.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20110908122534.GA2939@inutil.org>
Date: Thu, 8 Sep 2011 14:25:34 +0200
From: Moritz Muehlenhoff <jmm@...ian.org>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>,
	Ferdinand <debbug@...tplaza.com>, Russ Allbery <rra@...ian.org>,
	Sven Verdoolaege <skimo@...net.org>,
	Chris Weyl <cweyl@...mni.drew.edu>
Subject: Re: CVE Request -- libfcgi-perl / perl-FCGI:
	Certain environment variables shared between first and subsequent
	HTTP requests

On Thu, Sep 08, 2011 at 10:32:47AM +0200, Jan Lieskovsky wrote:
> Hello Josh, Steve, vendors,
>
>   it was found that the perl Fast CGI module did not properly clean up
> certain environment variables, related to a particular HTTP request,
> between subsequent incoming requests. Any environment variable set in
> the first pass through the code by processing the first request, that
> wasn't set in some subsequent request, has been added to the hash
> containing environment variables for that subsequent request. A remote
> attacker could use this flaw to bypass the authentication process and
> obtain access to resources, which would be otherwise protected by
> authentication.
>
> References:
> [1] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=607479>
> [2] <https://bugzilla.redhat.com/show_bug.cgi?id=736604>
>
> Russ Allbery of Debian (Cc-ed) provides further elaborated analysis
> of the reasons of the issue:
> [3] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=607479#10>
>
> Cc-ed also Sven Verdoolaege, the perl FCGI module author (as noted
> on CPAN) for his opinion too.
>
> Could you allocate a CVE id for this issue?
>
> Thank you && Regards, Jan.
> --
> Jan iankko Lieskovsky / Red Hat Security Response Team
>
> P.S.: Though the issue has been reported Sat, 18 Dec 2010 22:13:40 +0100
>       already, only Russ's analysis (Wed, 07 Sep 2011 20:24:00 -0700)
>       unveiled the full security implications of this issue. So I
>       assume, the CVE-2011-* identifier would be sufficient to cover
>       this issue. But feel free to correct me if I am wrong here.
>       Thanks, Jan.

FYI: Debian already allocated CVE-2011-2766 to this.
<http://bugs.debian.org/cgi-bin/bugreport.cgi?msg=19;bug=607479>

Cheers,
        Moritz

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security-tracker.debian.org_f59489c9_20250126_051257.html ===

# CVE-2011-2766

| **Name** | CVE-2011-2766 |
| --- | --- |
| **Description** | The FCGI (aka Fast CGI) module 0.70 through 0.73 for Perl, as used by CGI::Fast, uses environment variable values from one request during processing of a later request, which allows remote attackers to bypass authentication via crafted HTTP headers. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2011-2766) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2011-2766); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2011-2766), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2011-2766), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2011-2766), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2011-2766), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2011-2766), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2011-2766), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2011-2766), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2011-2766)/[CVE](https://www.suse.com/security/cve/CVE-2011-2766/), GitHub [advisories](https://github.com/advisories?query=CVE-2011-2766)/[code](https://github.com/search?type=Code&q=%22CVE-2011-2766%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2011-2766%22), [web search](https://duckduckgo.com/html?q=%22CVE-2011-2766%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2327-1](/tracker/DSA-2327-1) |
| **Debian Bugs** | [607479](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=607479) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [libfcgi-perl](/tracker/source-package/libfcgi-perl) ([PTS](https://tracker.debian.org/pkg/libfcgi-perl)) | bullseye | 0.79+ds-2 | fixed |
|  | bookworm | 0.82+ds-2 | fixed |
|  | sid, trixie | 0.82+ds-3 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [libfcgi-perl](/tracker/source-package/libfcgi-perl) | source | lenny | (not affected) |  |  |  |
| [libfcgi-perl](/tracker/source-package/libfcgi-perl) | source | squeeze | 0.71-1+squeeze1 |  | [DSA-2327-1](/tracker/DSA-2327-1) |  |
| [libfcgi-perl](/tracker/source-package/libfcgi-perl) | source | (unstable) | 0.73-2 |  |  | [607479](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=607479) |

## Notes

```
[lenny] - libfcgi-perl <not-affected> (Introduced in 0.70)

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from rt.cpan.org_9242350c_20250126_051258.html ===


# JavaScript is disabled

In order to continue, we need to verify that you're not a robot.
This requires JavaScript. Enable JavaScript and then reload the page.



=== Content from access.redhat.com_ffb08557_20250126_051256.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.debian.org_f9308ff4_20250125_020026.html ===


---

[[Date Prev](msg00202.html)][[Date Next](msg00204.html)]
[[Thread Prev](msg00202.html)][[Thread Next](msg00204.html)]
[[Date Index](maillist.html#00203)]
[[Thread Index](threads.html#00203)]

# [SECURITY] [DSA 2327-1] libfcgi-perl security-update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2327-1] libfcgi-perl security-update
* *From*: Nico Golde <nion@debian.org>
* *Date*: Mon, 24 Oct 2011 20:16:30 +0200
* *Message-id*: <[[🔎]](/msgid-search/20111024181630.GA23902%40ngolde.de) [20111024181630.GA23902@ngolde.de](msg00203.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA-2327-1                    security@debian.org
<http://www.debian.org/security/>                                 Nico Golde
Oct 24th, 2011                          <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : libfcgi-perl
Vulnerability  : authentication bypass
Problem type   : remote
Debian-specific: no
Debian bug     : 607479
CVE IDs        : CVE-2011-2766

Ferdinand Smit discovered that libfcgi-perl, a Perl module for writing
FastCGI applications, is incorrectly restoring environment variables of
a prior request in subsequent requests.  In some cases this may lead
to authentication bypasses or worse.

The oldstable distribution (lenny) is not affected by this problem.

For the stable distribution (squeeze), this problem has been fixed in
version 0.71-1+squeeze1.

For the testing distribution (wheezy), this problem has been fixed in
version 0.73-2.

For the unstable distribution (sid), this problem has been fixed in
version 0.73-2.

We recommend that you upgrade your libfcgi-perl packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iEYEARECAAYFAk6lq34ACgkQHYflSXNkfP89PACffGjDkG63EMaUzQopBGp2w5nk
NyQAn1GE45ffdISzrvv2QGRwmSsdYrTH
=/1RH
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.redhat.com_9a7edb50_20250125_020031.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D736604)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D736604)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D736604)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 736604

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 736604**](show_bug.cgi?id=736604)
(CVE-2011-2766)
- [CVE-2011-2766](https://access.redhat.com/security/cve/CVE-2011-2766) perl-FCGI, fcgi: Certain environment variables shared between first and subsequent HTTP requests

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2011-2766 perl-FCGI, fcgi: Certain environment variables shared between f...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2011-2766 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [736608](show_bug.cgi?id=736608 "CLOSED ERRATA - CVE-2011-2766 perl-FCGI, fcgi: Certain environment variables shared between first and subsequent HTTP requests [fedora-all]") [736609](show_bug.cgi?id=736609 "CLOSED ERRATA - CVE-2011-2766 perl-FCGI, fcgi: Certain environment variables shared between first and subsequent HTTP requests [epel-6]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=736604&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=736604&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2011-09-08 08:23 UTC by Jan Lieskovsky | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 12:47 UTC ([History](show_activity.cgi?id=736604)) | | [CC List:](page.cgi?id=fields.html#cclist) | 5 users (show)  cweyl iarnell opensource perl-devel tremble | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2011-10-10 07:58:48 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | CPAN | [68380](https://rt.cpan.org/Public/Bug/Display.html?id=68380) | 0 | None | None | None | Never | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=736604#c0)  Jan Lieskovsky    2011-09-08 08:23:17 UTC  ``` It was found that the perl Fast CGI module did not properly clean up certain environment variables, related to a particular HTTP request, between subsequent incoming requests. Any environment variable set in the first pass through the code by processing the first request, that wasn't set in some subsequent request, has been added to the hash containing environment variables for that subsequent request. A remote attacker could use this flaw to bypass the authentication process and obtain access to resources, which would be otherwise protected by authentication.  References: [1] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=607479>   ```  [Comment 1](show_bug.cgi?id=736604#c1)  Jan Lieskovsky    2011-09-08 08:37:08 UTC  ``` This issue affects the versions of the perl-FCGI package, as shipped with Fedora release of 14 and 15. Please schedule an update once final upstream patch known.  --  This issue affects the version of the perl-FCGI package, as present within EPEL-6 repository. Please schedule an update once final upstream patch known.  --  This issue did NOT affect the versions of the fcgi package, as shipped with Fedora release of 14 and 15. Though the fcgi package in those releases contains embedded copy of the perl-FCGI package, the code in question does not contain the regression in FCGI's accept() routine yet.  --  This issue did NOT affect the versions of the fcgi package, as present within EPEL-5 and EPEL-6 repositories. Though the fcgi package in those releases contains embedded copy of the perl-FCGI package, the code in question does not contain the regression in FCGI's accept() routine yet.   ```  [Comment 2](show_bug.cgi?id=736604#c2)  Jan Lieskovsky    2011-09-08 08:39:02 UTC  ``` CVE Request: [2] <http://www.openwall.com/lists/oss-security/2011/09/08/1>   ```  [Comment 3](show_bug.cgi?id=736604#c3)  Jan Lieskovsky    2011-09-08 08:40:09 UTC  ``` Created perl-FCGI tracking bugs for this issue  Affects: fedora-all [[bug 736608](show_bug.cgi?id=736608 "CLOSED ERRATA - CVE-2011-2766 perl-FCGI, fcgi: Certain environment variables shared between first and subsequent HTTP requests [fedora-all]")] Affects: epel-6 [[bug 736609](show_bug.cgi?id=736609 "CLOSED ERRATA - CVE-2011-2766 perl-FCGI, fcgi: Certain environment variables shared between first and subsequent HTTP requests [epel-6]")]   ```  [Comment 4](show_bug.cgi?id=736604#c4)  Jan Lieskovsky    2011-09-08 08:48:37 UTC  ``` Sample code snippet (from Debian bug report [1]) to demonstrate the deficiency:  <quote>  #! /usr/bin/perl -w  use CGI::Fast qw(:standard :cgi-lib); use Data::Dumper; use strict;  while ( my $cgi = getRequest() ) {      print $cgi->header();      print "<pre>========= ID:$$ =========\n";     while (my ($key,$value) = each %ENV) {        print "$key=$value\n";     }     print "========= VARS =========\n";     print Dumper($cgi->Vars());     print "========= COOKIE =========\n";     print Dumper($cgi->cookie());     print ".</pre>";      #%ENV = undef; }  sub getRequest {     %ENV = () if $main::clearENV; # Clear the ENV     $main::clearENV = 1;          # Do not clear the ENV the first time otherwise the Fast::CGI "slow mode" will not work anymore     return new CGI::Fast; }   I used 2 wget together to examine it: (posted to the proxy server to disable caching)  $ http_proxy=<http://proxy:8080> watch -d 'wget -qO - --post-data='xxx' --header "Cookie: usernaam=test" <http://www.myserver.nl/env.fcgi>' $ watch -d 'wget -qO - <http://www.myserver.nl/env.fcgi>'  </quote>   ```  [Comment 5](show_bug.cgi?id=736604#c5)  Jan Lieskovsky    2011-09-08 13:42:35 UTC  ``` The CVE identifier of [CVE-2011-2766](https://access.redhat.com/security/cve/CVE-2011-2766) has been assigned to this issue: <http://www.openwall.com/lists/oss-security/2011/09/08/2>   ```  [Comment 6](show_bug.cgi?id=736604#c6)  Till Maas    2011-09-09 15:40:15 UTC  ``` Is fcgi-perl from EPEL5 affected by this bug as well?   ```  [Comment 7](show_bug.cgi?id=736604#c7)  Jan Lieskovsky    2011-09-09 17:00:11 UTC  ``` (In reply to [comment #6](show_bug.cgi?id=736604#c6)) > Is fcgi-perl from EPEL5 affected by this bug as well?  No, fcgi in EPEL-5 contains CPAN v0.67 version of the FCGI module (thus is not yet affected by this).   ```  [Comment 8](show_bug.cgi?id=736604#c8)  Fedora Update System    2011-10-09 21:02:08 UTC  ``` perl-FCGI-0.71-4.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=736604#c9)  Jan Lieskovsky    2011-10-10 07:58:48 UTC  ``` This issue has been addressed in the following updates: 1) perl-FCGI-0.74-1.fc16, 2) perl-FCGI-0.74-1.fc15, 3) perl-FCGI-0.74-1.fc14, 4) perl-FCGI-0.71-4.el6.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=736604&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_ff0141a7_20250126_051256.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

# blists - web interface to mailing list archives

blists is a web interface to mailing list archives that works off indexed mbox files.
There are two programs: *bindex* and *bit*.
*bindex* generates or updates the index file (yes, incremental updates are supported).
*bit* is a CGI/SSI program that generates web pages on the fly.
Both programs are written in C and are very fast.

You can view the latest <README> file,
which describes blists in more detail and provides installation instructions.
It is also included in the archive below.

Download ([release notes](/lists/announce/2017/11/19/1)):

* [blists 2.0](blists-2.0.tar.gz) and
  its [signature](blists-2.0.tar.gz.sign)* [blists 1.0](blists-1.0.tar.gz) and
    its [signature](blists-1.0.tar.gz.sign)

These files are also
[available from the Openwall file archive](https://download.openwall.net/pub/projects/blists/).
The source code of blists can be browsed on
[GitHub](https://github.com/openwall/blists) or via
[CVSweb](https://cvsweb.openwall.com/blists).

Follow [this link](/signatures/) for information on verifying the signatures.

To see blists in action, check out our
[Open Source and information security mailing list archives](https://lists.openwall.net).

blists is a registered project with
[Open Hub](https://www.openhub.net/p/blists).

Quick Comment:

413360



=== Content from bugs.debian.org_073630bf_20250125_020025.html ===

# Debian Bug report logs - #607479 libfcgi-perl: [CVE-2011-2766] After reloading some environment vars become constants, that will be used if not overruled by the headers of new requests.

[![version graph](version.cgi?fixed=0.73-2;fixed=libfcgi-perl%2F0.71-1%2Bsqueeze1;height=2;width=2;collapse=1;absolute=0;found=libfcgi-perl%2F0.71-1;found=libfcgi-perl%2F0.73-1;package=libfcgi-perl)](version.cgi?found=libfcgi-perl%2F0.71-1;found=libfcgi-perl%2F0.73-1;absolute=0;collapse=1;fixed=0.73-2;fixed=libfcgi-perl%2F0.71-1%2Bsqueeze1;info=1;package=libfcgi-perl)

Package:
[libfcgi-perl](pkgreport.cgi?package=libfcgi-perl);
Maintainer for [libfcgi-perl](pkgreport.cgi?package=libfcgi-perl) is [Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>](pkgreport.cgi?maint=pkg-perl-maintainers%40lists.alioth.debian.org); Source for [libfcgi-perl](pkgreport.cgi?package=libfcgi-perl) is [src:libfcgi-perl](pkgreport.cgi?src=libfcgi-perl) ([PTS](https://tracker.debian.org/pkg/libfcgi-perl), [buildd](https://buildd.debian.org/libfcgi-perl), [popcon](https://qa.debian.org/popcon.php?package=libfcgi-perl)).

Reported by: [Ferdinand <debbug@smitplaza.com>](pkgreport.cgi?submitter=debbug%40smitplaza.com)

Date: Sat, 18 Dec 2010 21:33:01 UTC

Severity: *grave*

Tags: fixed-upstream, security

Found in versions libfcgi-perl/0.71-1, libfcgi-perl/0.73-1

Fixed in versions 0.73-2, libfcgi-perl/0.71-1+squeeze1

**Done:** Damyan Ivanov <dmn@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <https://rt.cpan.org/Public/Bug/Display.html?id=68380>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=607479;mbox=yes), [status mbox](bugreport.cgi?bug=607479;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=607479;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Sat, 18 Dec 2010 21:33:04 GMT) ([full text](bugreport.cgi?bug=607479;msg=2), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Ferdinand <debbug@smitplaza.com>`:

New Bug report received and forwarded. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Sat, 18 Dec 2010 21:33:04 GMT) ([full text](bugreport.cgi?bug=607479;msg=4), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=5), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=debbug%40smitplaza.com)
From: Ferdinand <debbug@smitplaza.com>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: libfcgi-perl: After reloading some environment vars become constants,
that will be used if not overruled by the headers of new requests.
Date: Sat, 18 Dec 2010 22:13:40 +0100
```
Package: libfcgi-perl
Version: 0.71-1
Severity: normal

Hi,

I had some strange problems with cookies, it seems that sometimes username cookies were highjacked, but not always, even by search bots.
I am using the Fast::CGI (libcgi-fast-perl 5.10.1-16) wrapper, but i think the problem lies in the FCGI code. I use apache (apache2 2.2.16-4) as webserver.

This is wat hapens:

I create a simple fpl file to show environment vars, and request that from 2 different locations (one with a proxy).
Every request is handled fine, i do not have any problems with environment vars. But after i change the file,
or simply touch it, the new version is compiled when a new request hapens, but some environment vars seems to get
a default value from the request that triggers the recompile. So if that request has some cookies, all request
without cookies will according to Fast::CGI module have the same cookies as the "recompile request".
I did not check all the env vars, but X_FORWARDED_FOR had the same problem. The problem vanished when i clear the %ENV just before i ask for the CGI object.

Example code (with ENV cleaning):

#! /usr/bin/perl -w

use CGI::Fast qw(:standard :cgi-lib);
use Data::Dumper;
use strict;

while ( my $cgi = getRequest() ) {

    print $cgi->header();

    print "<pre>========= ID:$$ =========\n";
    while (my ($key,$value) = each %ENV) {
       print "$key=$value\n";
    }
    print "========= VARS =========\n";
    print Dumper($cgi->Vars());
    print "========= COOKIE =========\n";
    print Dumper($cgi->cookie());
    print ".</pre>";

    #%ENV = undef;
}

sub getRequest {
    %ENV = () if $main::clearENV; # Clear the ENV
    $main::clearENV = 1;          # Do not clear the ENV the first time otherwise the Fast::CGI "slow mode" will not work anymore
    return new CGI::Fast;
}

I used 2 wget together to examine it:
(posted to the proxy server to disable caching)

$ http_proxy=<http://proxy:8080> watch -d 'wget -qO - --post-data='xxx' --header "Cookie: usernaam=test" <http://www.myserver.nl/env.fcgi>'
$ watch -d 'wget -qO - <http://www.myserver.nl/env.fcgi>'

After a apache restart, both requests will output only there own env vars, but after a touch of the scriptfile,
you get a 50% chance both request will show the same cookie, postdata and x_forwarded_for headers. A restart fixes that allways.

I tried to look at the FCGI library, found out that they do some stuff with the %ENV, but could not figure out what exectly
caused the problem.

Regards,
Ferdinand

-- System Information:
Debian Release: squeeze/sid
  APT prefers testing
  APT policy: (500, 'testing')
Architecture: i386 (i686)

Kernel: Linux 2.6.26-2-vserver-686 (SMP w/4 CPU cores)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8) (ignored: LC_ALL set to en_US.UTF-8)
Shell: /bin/sh linked to /bin/dash

Versions of packages libfcgi-perl depends on:
ii  libc6                         2.11.2-7   Embedded GNU C Library: Shared lib
ii  perl                          5.10.1-16  Larry Wall's Practical Extraction
ii  perl-base [perlapi-5.10.1]    5.10.1-16  minimal Perl system

libfcgi-perl recommends no packages.

libfcgi-perl suggests no packages.

-- no debconf information

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Thu, 08 Sep 2011 03:27:04 GMT) ([full text](bugreport.cgi?bug=607479;msg=7), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Russ Allbery <rra@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Thu, 08 Sep 2011 03:27:04 GMT) ([full text](bugreport.cgi?bug=607479;msg=9), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=10), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=rra%40debian.org)
From: Russ Allbery <rra@debian.org>
To: Debian Bug Tracking System <607479@bugs.debian.org>
Subject: libfcgi-perl: Serious FCGI information leak
Date: Wed, 07 Sep 2011 20:24:00 -0700
```
Package: libfcgi-perl
Version: 0.73-1
Followup-For: Bug #607479

This bug just caused a serious security incident for us, and I was able
to work through the cause and the reason why not everyone sees it.  The
problem was introduced in 0.70 and is still present in 0.73.

The following change was added in 0.70:

 sub accept() {
     warn "accept called as a method; you probably wanted to call Accept" if @_;
-    if (defined %FCGI::ENV) {
-       %ENV = %FCGI::ENV;
+    if (%FCGI::ENV) {
+        %ENV = %FCGI::ENV;
     } else {
-       %FCGI::ENV = %ENV;
+        %FCGI::ENV = %ENV;
     }

The goal of this code is to save the original environment the first time
into accept() and then restore the environment to the original environment
each time before calling accept() again.  It uses %FCGI::ENV to hold a
copy of the original environment.

The problem is the change to remove defined().  defined() on a hash
returned true if the hash had ever been set, so it could be used as a
sentinel to figure out whether the environment had already been saved.
However, this is deprecated in Perl, so the module was patched to just
check the truth value of the hash.

The problem is that the truth value of the hash is false if the hash has
never been set *or* if the hash has no members, which is not the same
as defined, which was returning true if the assignment from %ENV had
happened, even if it was empty.  So if the environment was completely
empty when accept() was first called, which is the case by default for
an Apache-spawned FCGI process (at least with mod_fastcgi), then the
environment in place the *second* time accept() is called will be saved as
the default environment.  This is the environment produced by the first
request to the server.

Then, later, accept() does:

     for (keys %FCGI::ENV) {
        $ENV{$_} = $FCGI::ENV{$_} unless exists $ENV{$_};
     }

so any keys in the environment that are not set in the new incoming
request will be copied over into the new request environment.

The practical effect of this is that any environment variable set in the
first pass through the code by the first processed request that isn't set
in some subsequent request will be added to that subsequent request.
Most notably, this includes the HTTP_COOKIE variable.  This can (and did
for us) constitute a serious security breach, since the HTTP_COOKIE header
may be carrying authentication credentials and the absence of that header
may indicate an unauthenticated access.  The practical effect is that
any unauthenticated user would receive the authentication credentials of
the first user processed after spawning the script.

Thankfully, there is a trivial workaround: set any environment variable
before the first call to accept(), and you will not see this bug.  So
any method of spawning FastCGI processes that doesn't clear the environment
will also not manifest this bug.

I can probably provide a patch in a day or two, but the fix is fairly
obvious: the code needs to stop using the truth value of %FCGI::ENV as
a proxy for whether this is the first or subsequent pass through
accept and instead set a separate scalar variable to true once the
initial environment has been saved into %FCGI::ENV.

-- System Information:
Debian Release: wheezy/sid
  APT prefers testing
  APT policy: (990, 'testing'), (500, 'unstable'), (1, 'experimental')
Architecture: i386 (i686)

Kernel: Linux 2.6.39-2-686-pae (SMP w/4 CPU cores)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

Versions of packages libfcgi-perl depends on:
ii  libc6                         2.13-16    Embedded GNU C Library: Shared lib
ii  perl                          5.12.4-4   Larry Wall's Practical Extraction
ii  perl-base [perlapi-5.12.3]    5.12.4-4   minimal Perl system

libfcgi-perl recommends no packages.

libfcgi-perl suggests no packages.

-- no debconf information

```

---

**Added tag(s) security.**
Request was from `Russ Allbery <rra@debian.org>`
to `control@bugs.debian.org`.
(Thu, 08 Sep 2011 03:27:06 GMT) ([full text](bugreport.cgi?bug=607479;msg=12), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=12), [link](#11)).

---

**Severity set to 'grave' from 'normal'**
Request was from `Russ Allbery <rra@debian.org>`
to `control@bugs.debian.org`.
(Thu, 08 Sep 2011 03:27:06 GMT) ([full text](bugreport.cgi?bug=607479;msg=14), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=14), [link](#13)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Thu, 08 Sep 2011 12:10:25 GMT) ([full text](bugreport.cgi?bug=607479;msg=16), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=16), [link](#15)).

---

**Acknowledgement sent**
to `"Thijs Kinkhorst" <thijs@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Thu, 08 Sep 2011 12:11:17 GMT) ([full text](bugreport.cgi?bug=607479;msg=18), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=18), [link](#17)).

---

[Message #19](#19) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=19), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=19), reply):

![](/cgi-bin/libravatar.cgi?email=thijs%40debian.org)
From: "Thijs Kinkhorst" <thijs@debian.org>
To: "Russ Allbery" <rra@debian.org>
Cc: team@security.debian.org,
607479@bugs.debian.org
Subject: Re: tagging 607479, severity of 607479 is grave
Date: Thu, 8 Sep 2011 14:05:54 +0200
```
> This bug just caused a serious security incident for us, and I was able
> to work through the cause and the reason why not everyone sees it.  The
> problem was introduced in 0.70 and is still present in 0.73.

>The following change was added in 0.70:

> sub accept() {
>     warn "accept called as a method; you probably wanted to call Accept"
if @_;
> -    if (defined %FCGI::ENV) {
> -       %ENV = %FCGI::ENV;
> +    if (%FCGI::ENV) {
> +        %ENV = %FCGI::ENV;
>      } else {
> -        %FCGI::ENV = %ENV;
> +        %FCGI::ENV = %ENV;
>     }

Please use [CVE-2011-2766](https://security-tracker.debian.org/tracker/CVE-2011-2766) to refer to this issue.

Thanks,
Thijs

```

---

**Set Bug forwarded-to-address to '<https://rt.cpan.org/Public/Bug/Display.html?id=68380>'.**
Request was from `Damyan Ivanov <dmn@debian.org>`
to `control@bugs.debian.org`.
(Thu, 08 Sep 2011 14:36:13 GMT) ([full text](bugreport.cgi?bug=607479;msg=21), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=21), [link](#20)).

---

**Changed Bug title to 'libfcgi-perl: [CVE-2011-2766] After reloading some environment vars become constants, that will be used if not overruled by the headers of new requests.' from 'libfcgi-perl: After reloading some environment vars become constants, that will be used if not overruled by the headers of new requests.'**
Request was from `Ansgar Burchardt <ansgar@debian.org>`
to `control@bugs.debian.org`.
(Sat, 10 Sep 2011 13:57:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=23), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=23), [link](#22)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Sat, 17 Sep 2011 19:04:13 GMT) ([full text](bugreport.cgi?bug=607479;msg=25), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=25), [link](#24)).

---

[Message #26](#26) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=26), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=26), reply):

![](/cgi-bin/libravatar.cgi?email=pkg-perl-maintainers%40lists.alioth.debian.org)
From: pkg-perl-maintainers@lists.alioth.debian.org
To: 607479@bugs.debian.org, 607479-submitter@bugs.debian.org
Subject: Pending fixes for bugs in the libfcgi-perl package
Date: Sat, 17 Sep 2011 19:01:23 +0000
```
tag 607479 + pending
thanks

Some bugs in the libfcgi-perl package are closed in revision
491e5d141a11c750d1213a947a8c2ecf424145ee in branch 'master' by Damyan
Ivanov

The full diff can be seen at
<http://anonscm.debian.org/gitweb/?p=pkg-perl/packages/libfcgi-perl.git;a=commitdiff;h=491e5d1>

Commit message:

    Add patch from upstream bug tracker fixing [CVE-2011-2766](https://security-tracker.debian.org/tracker/CVE-2011-2766)

    Closes: #[607479](bugreport.cgi?bug=607479)
    Thaks to Ferdinand for reporting, Russ Allbery for the analysis and chansen for
    the patch.

```

---

**Added tag(s) pending.**
Request was from `pkg-perl-maintainers@lists.alioth.debian.org`
to `control@bugs.debian.org`.
(Sat, 17 Sep 2011 19:04:14 GMT) ([full text](bugreport.cgi?bug=607479;msg=28), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=28), [link](#27)).

---

**Message sent on**
to `Ferdinand <debbug@smitplaza.com>`:

Bug#607479.
(Sat, 17 Sep 2011 19:04:17 GMT) ([full text](bugreport.cgi?bug=607479;msg=30), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=30), [link](#29)).

---

**Reply sent**
to `Damyan Ivanov <dmn@debian.org>`:

You have taken responsibility.
(Sat, 17 Sep 2011 19:21:05 GMT) ([full text](bugreport.cgi?bug=607479;msg=33), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=33), [link](#32)).

---

**Notification sent**
to `Ferdinand <debbug@smitplaza.com>`:

Bug acknowledged by developer.
(Sat, 17 Sep 2011 19:21:05 GMT) ([full text](bugreport.cgi?bug=607479;msg=35), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 607479-close@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=36), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=dmn%40debian.org)
From: Damyan Ivanov <dmn@debian.org>
To: 607479-close@bugs.debian.org
Subject: Bug#607479: fixed in libfcgi-perl 0.73-2
Date: Sat, 17 Sep 2011 19:19:10 +0000
```
Source: libfcgi-perl
Source-Version: 0.73-2

We believe that the bug you reported is fixed in the latest version of
libfcgi-perl, which is due to be installed in the Debian FTP archive:

libfcgi-perl_0.73-2.debian.tar.gz
  to main/libf/libfcgi-perl/libfcgi-perl_0.73-2.debian.tar.gz
libfcgi-perl_0.73-2.dsc
  to main/libf/libfcgi-perl/libfcgi-perl_0.73-2.dsc
libfcgi-perl_0.73-2_amd64.deb
  to main/libf/libfcgi-perl/libfcgi-perl_0.73-2_amd64.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 607479@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Damyan Ivanov <dmn@debian.org> (supplier of updated libfcgi-perl package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sat, 17 Sep 2011 22:09:53 +0300
Source: libfcgi-perl
Binary: libfcgi-perl
Architecture: source amd64
Version: 0.73-2
Distribution: unstable
Urgency: high
Maintainer: Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>
Changed-By: Damyan Ivanov <dmn@debian.org>
Description:
 libfcgi-perl - helper module for FastCGI
Closes: [607479](bugreport.cgi?bug=607479)
Changes:
 libfcgi-perl (0.73-2) unstable; urgency=high
 .
   * Team upload
    + High urgency for fixing a security bug
 .
   [ Ansgar Burchardt ]
   * debian/control: Convert Vcs-* fields to Git.
 .
   [ Salvatore Bonaccorso ]
   * debian/copyright: Replace DEP5 Format-Specification URL from
     svn.debian.org to anonscm.debian.org URL.
 .
   [ Damyan Ivanov ]
   * Add patch from upstream bug tracker fixing [CVE-2011-2766](https://security-tracker.debian.org/tracker/CVE-2011-2766)
     Closes: #[607479](bugreport.cgi?bug=607479). Thaks to Ferdinand for reporting, Russ Allbery for the
     analysis and chansen for the patch.
Checksums-Sha1:
 95339ec9d86d68352f76810ee6fe85ccfbefd23d 2035 libfcgi-perl_0.73-2.dsc
 6750e0b7c2c374fa5dae56449206e41640ea15f2 5355 libfcgi-perl_0.73-2.debian.tar.gz
 05b5ddb5f142c269f72241f8b77f399aa42f3688 45584 libfcgi-perl_0.73-2_amd64.deb
Checksums-Sha256:
 ae3e1a41863d3cd273515227ea4d552e9d384586b42af4e9fb60570f60971572 2035 libfcgi-perl_0.73-2.dsc
 c2227ad05e59c03db04943e7164680f975e900f0a93aaa8c393ee1fd2f0211f6 5355 libfcgi-perl_0.73-2.debian.tar.gz
 085055adb606ddbc8a6129cb9da229194dab0dae04d9f2412a6f354a8265e1e0 45584 libfcgi-perl_0.73-2_amd64.deb
Files:
 4dc35b7f035a3f0929b464305ba83d1d 2035 perl optional libfcgi-perl_0.73-2.dsc
 35cb368a4da78e4f3f76a145b4fc551d 5355 perl optional libfcgi-perl_0.73-2.debian.tar.gz
 6a64fa3351c25d7c42f24747dd0b8a40 45584 perl optional libfcgi-perl_0.73-2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iQIcBAEBCAAGBQJOdPDzAAoJENu+nU2Z0qAE0usP/2Ui6Ju/NT7gYNgKVdRiJxuq
YBN7lz4y81x1e3FwCCHK8mHun+xMEPreHNBvHrCeRvbnhyyobtOzYoF+tPCk2X+o
CXudy16F0TEKizzWxr01nNZyxk7AhESx676w86EXkJdzTkKck8zOSljqitF603MB
h7hJBtzOL208QIx2sylAI6xJKkR7H7IBGQiTjfalq+ympJguxTKOGPuXkmFtKX5G
Y3+P6MMXVelsrufI37S9ux40axyyu2LNRhSxDeknR6opF5lR2bqu2gdjOJzzf6DD
P6VsY8sZgTXh2MN3PcFaWd+hDvK2BXk8Yuhk6pk9BMv9iADL8XfmattJAJHovwqg
prl+raNTvarOw7jJSfNI7J3HjgVsdWQYvBHG1Q51brxxnrvAYz1s3zUtcP3e1Oae
vn70k+PA6ieJQx84In+mHZLe7pqXyJxVm2Qumna8WlgZbeiRw1EMwl+lzqzGW6gY
IoGHKL9ZbO64FE09SWcekYUJGRRhYmiMUnWmIf94Ihfa2b95eo90noJg4783s8vN
e2y8qW6GkRZngskbscCIb6XVdyiHYHZqG3+P4zMp6qcKT/BoU/u5L1PHVGlm8Ccc
9OTmIXS3xPKrEpuQK/b976MSxiFVNkzuDHSzMdQCaVD+8mVvwY9aeWjPOkO4FKtq
n3zIDxZM5CpQzVZyegww
=+365
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Fri, 30 Sep 2011 17:30:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=38), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=38), [link](#37)).

---

**Acknowledgement sent**
to `Dominic Hargreaves <dom@earth.li>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Fri, 30 Sep 2011 17:30:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=40), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=40), [link](#39)).

---

[Message #41](#41) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=41), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=41), reply):

![](/cgi-bin/libravatar.cgi?email=dom%40earth.li)
From: Dominic Hargreaves <dom@earth.li>
To: 607479@bugs.debian.org, team@security.debian.org
Cc: control@bugs.debian.org
Subject: Bug#607479/CVE-2011-2766 authentication bypass
Date: Fri, 30 Sep 2011 18:26:41 +0100
```
reopen 607479
thanks

On Sat, Sep 17, 2011 at 07:01:23PM +0000, pkg-perl-maintainers@lists.alioth.debian.org wrote:
> Some bugs in the libfcgi-perl package are closed in revision
> 491e5d141a11c750d1213a947a8c2ecf424145ee in branch 'master' by Damyan
> Ivanov
>
> The full diff can be seen at
> <http://anonscm.debian.org/gitweb/?p=pkg-perl/packages/libfcgi-perl.git;a=commitdiff;h=491e5d1>
>
> Commit message:
>
>     Add patch from upstream bug tracker fixing [CVE-2011-2766](https://security-tracker.debian.org/tracker/CVE-2011-2766)
>
>     Closes: #[607479](bugreport.cgi?bug=607479)
>     Thaks to Ferdinand for reporting, Russ Allbery for the analysis and chansen for
>     the patch.

Damyan, thanks for fixing this in unstable. I'm reopening the bug,
because I believe this fix applies to squeeze, and should be fixed there.

Has anyone yet contacted the security team about this/is anyone working
on packages for squeeze?

Dominic.

--
Dominic Hargreaves | <http://www.larted.org.uk/~dom/>
PGP key 5178E2A5 from the.earth.li (keyserver,web,email)

```

---

**Bug No longer marked as fixed in versions libfcgi-perl/0.73-2 and reopened.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 30 Sep 2011 17:30:05 GMT) ([full text](bugreport.cgi?bug=607479;msg=43), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=43), [link](#42)).

---

**Bug Marked as fixed in versions 0.73-2.**
Request was from `Dominic Hargreaves <dom@earth.li>`
to `control@bugs.debian.org`.
(Fri, 30 Sep 2011 17:33:06 GMT) ([full text](bugreport.cgi?bug=607479;msg=45), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=45), [link](#44)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Sat, 01 Oct 2011 05:15:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=47), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=47), [link](#46)).

---

[Message #48](#48) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=48), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=48), reply):

![](/cgi-bin/libravatar.cgi?email=dmn%40debian.org)
From: Damyan Ivanov <dmn@debian.org>
To: Dominic Hargreaves <dom@earth.li>, 607479@bugs.debian.org
Cc: team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Sat, 1 Oct 2011 08:12:18 +0300
```
[[Message part 1](bugreport.cgi?att=0;bug=607479;msg=48) (text/plain, inline)]
```
```
-=| Dominic Hargreaves, 30.09.2011 18:26:41 +0100 |=-
> I'm reopening the bug, because I believe this fix applies to
> squeeze, and should be fixed there.

Agreed.

> Has anyone yet contacted the security team about this/is anyone
> working on packages for squeeze?

I don't think so.

Porting the patch (for some reason it doesn't apply cleanly) is
trivial. Attached is a patch that does exactly that (to be git
apply'ed to the debian/0.71-1 tag, which is the squeeze version).

HTH,
    dam

```
```
[[0001-Add-patch-from-upstream-bug-tracker-fixing-CVE-2011-.patch](bugreport.cgi?att=1;bug=607479;filename=0001-Add-patch-from-upstream-bug-tracker-fixing-CVE-2011-.patch;msg=48) (text/x-diff, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=607479;filename=signature.asc;msg=48) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Sat, 01 Oct 2011 10:45:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=50), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=50), [link](#49)).

---

**Acknowledgement sent**
to `Moritz Mühlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Sat, 01 Oct 2011 10:45:08 GMT) ([full text](bugreport.cgi?bug=607479;msg=52), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=52), [link](#51)).

---

[Message #53](#53) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=53), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=53), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Mühlenhoff <jmm@inutil.org>
To: Damyan Ivanov <dmn@debian.org>, Dominic Hargreaves <dom@earth.li>,
607479@bugs.debian.org, team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Sat, 1 Oct 2011 12:44:33 +0200
```
On Sat, Oct 01, 2011 at 08:12:18AM +0300, Damyan Ivanov wrote:
> -=| Dominic Hargreaves, 30.09.2011 18:26:41 +0100 |=-
> > I'm reopening the bug, because I believe this fix applies to
> > squeeze, and should be fixed there.
>
> Agreed.
>
> > Has anyone yet contacted the security team about this/is anyone
> > working on packages for squeeze?
>
> I don't think so.
>
> Porting the patch (for some reason it doesn't apply cleanly) is
> trivial. Attached is a patch that does exactly that (to be git
> apply'ed to the debian/0.71-1 tag, which is the squeeze version).

Did update this receive testing?

distribution needs to point to stable-security, not unstable. And
while you're at it, please modify 0.71-1+squeeze.1 to 0.71-1+squeeze1
for consistency.

Cheers,
        Moritz

```

---

**Added tag(s) fixed-upstream.**
Request was from `bts-link-upstream@lists.alioth.debian.org`
to `control@bugs.debian.org`.
(Mon, 03 Oct 2011 16:39:15 GMT) ([full text](bugreport.cgi?bug=607479;msg=55), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=55), [link](#54)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Wed, 05 Oct 2011 18:06:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=57), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=57), [link](#56)).

---

**Acknowledgement sent**
to `Dominic Hargreaves <dom@earth.li>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Wed, 05 Oct 2011 18:06:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=59), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=60), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=dom%40earth.li)
From: Dominic Hargreaves <dom@earth.li>
To: Damyan Ivanov <dmn@debian.org>, 607479@bugs.debian.org,
team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Wed, 5 Oct 2011 19:02:47 +0100
```
On Sat, Oct 01, 2011 at 08:12:18AM +0300, Damyan Ivanov wrote:
> -=| Dominic Hargreaves, 30.09.2011 18:26:41 +0100 |=-
> > I'm reopening the bug, because I believe this fix applies to
> > squeeze, and should be fixed there.
>
> Agreed.
>
> > Has anyone yet contacted the security team about this/is anyone
> > working on packages for squeeze?
>
> I don't think so.
>
> Porting the patch (for some reason it doesn't apply cleanly) is
> trivial. Attached is a patch that does exactly that (to be git
> apply'ed to the debian/0.71-1 tag, which is the squeeze version).

As now publicly announced, this affects Request Tracker on squeeze:

<<http://lists.bestpractical.com/pipermail/rt-announce/2011-October/000196.html>>.

--
Dominic Hargreaves | <http://www.larted.org.uk/~dom/>
PGP key 5178E2A5 from the.earth.li (keyserver,web,email)

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Wed, 05 Oct 2011 18:18:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=62), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=62), [link](#61)).

---

**Acknowledgement sent**
to `Dominic Hargreaves <dom@earth.li>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Wed, 05 Oct 2011 18:18:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=64), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=65), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=dom%40earth.li)
From: Dominic Hargreaves <dom@earth.li>
To: Moritz Mühlenhoff <jmm@inutil.org>
Cc: Damyan Ivanov <dmn@debian.org>, 607479@bugs.debian.org,
team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Wed, 5 Oct 2011 19:14:33 +0100
```
On Sat, Oct 01, 2011 at 12:44:33PM +0200, Moritz Mühlenhoff wrote:
> On Sat, Oct 01, 2011 at 08:12:18AM +0300, Damyan Ivanov wrote:

> > Porting the patch (for some reason it doesn't apply cleanly) is
> > trivial. Attached is a patch that does exactly that (to be git
> > apply'ed to the debian/0.71-1 tag, which is the squeeze version).
>
> Did update this receive testing?

I've just tested RT 3.8 + squeeze + mod_fcgid, and I can't spot any
breakage.

> distribution needs to point to stable-security, not unstable. And
> while you're at it, please modify 0.71-1+squeeze.1 to 0.71-1+squeeze1
> for consistency.

--
Dominic Hargreaves | <http://www.larted.org.uk/~dom/>
PGP key 5178E2A5 from the.earth.li (keyserver,web,email)

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Tue, 11 Oct 2011 13:36:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=67), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=67), [link](#66)).

---

**Acknowledgement sent**
to `Dominic Hargreaves <dom@earth.li>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Tue, 11 Oct 2011 13:36:30 GMT) ([full text](bugreport.cgi?bug=607479;msg=69), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=69), [link](#68)).

---

[Message #70](#70) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=70), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=70), reply):

![](/cgi-bin/libravatar.cgi?email=dom%40earth.li)
From: Dominic Hargreaves <dom@earth.li>
To: Moritz Mühlenhoff <jmm@inutil.org>,
607479@bugs.debian.org
Cc: Damyan Ivanov <dmn@debian.org>, team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Tue, 11 Oct 2011 14:33:42 +0100
```
On Sat, Oct 01, 2011 at 12:44:33PM +0200, Moritz Mühlenhoff wrote:
> On Sat, Oct 01, 2011 at 08:12:18AM +0300, Damyan Ivanov wrote:
> > -=| Dominic Hargreaves, 30.09.2011 18:26:41 +0100 |=-
> > > I'm reopening the bug, because I believe this fix applies to
> > > squeeze, and should be fixed there.
> >
> > Agreed.
> >
> > > Has anyone yet contacted the security team about this/is anyone
> > > working on packages for squeeze?
> >
> > I don't think so.
> >
> > Porting the patch (for some reason it doesn't apply cleanly) is
> > trivial. Attached is a patch that does exactly that (to be git
> > apply'ed to the debian/0.71-1 tag, which is the squeeze version).
>
> Did update this receive testing?
>
> distribution needs to point to stable-security, not unstable. And
> while you're at it, please modify 0.71-1+squeeze.1 to 0.71-1+squeeze1
> for consistency.

Hello Damyan, are you planning to do this or do you need someone else
to take over? IMO this one warrants a DSA.

Dominic.

--
Dominic Hargreaves | <http://www.larted.org.uk/~dom/>
PGP key 5178E2A5 from the.earth.li (keyserver,web,email)

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Wed, 12 Oct 2011 09:06:10 GMT) ([full text](bugreport.cgi?bug=607479;msg=72), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=72), [link](#71)).

---

[Message #73](#73) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=73), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=73), reply):

![](/cgi-bin/libravatar.cgi?email=dmn%40debian.org)
From: Damyan Ivanov <dmn@debian.org>
To: Dominic Hargreaves <dom@earth.li>
Cc: Moritz Mühlenhoff <jmm@inutil.org>,
607479@bugs.debian.org, team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Wed, 12 Oct 2011 12:03:50 +0300
```
[[Message part 1](bugreport.cgi?att=0;bug=607479;msg=73) (text/plain, inline)]
```
```
-=| Dominic Hargreaves, 11.10.2011 14:33:42 +0100 |=-
> On Sat, Oct 01, 2011 at 12:44:33PM +0200, Moritz Mühlenhoff wrote:
> > Did update this receive testing?

The changes look sane "in theory". They address all mentions of
FCGI::ENV in the source.

The RT testing by Dominic seems sufficient additional assurance to me.

> > distribution needs to point to stable-security, not unstable. And
> > while you're at it, please modify 0.71-1+squeeze.1 to 0.71-1+squeeze1
> > for consistency.

Right. Thanks!

> Hello Damyan, are you planning to do this or do you need someone
> else to take over? IMO this one warrants a DSA.

Thanks for the nudge. I have pushed the squeeze branch of
<http://anonscm.debian.org/gitweb/?p=pkg-perl/packages/libfcgi-perl.git;a=summary>
with the changes so others can take over for the actual uploading if I am away.

The squeeze version still has Vcs-Svn in its control file. Would it be
acceptable to change that too?

Current changelog:

libfcgi-perl (0.71-1+squeezei1) stable-security; urgency=high

  * Add patch from upstream bug tracker fixing [CVE-2011-2766](https://security-tracker.debian.org/tracker/CVE-2011-2766)
    Closes: #[607479](bugreport.cgi?bug=607479). Thaks to Ferdinand for reporting, Russ Allbery for the
    analysis and chansen for the patch.

 -- Damyan Ivanov <dmn@debian.org>  Wed, 12 Oct 2011 11:50:21 +0300

```
```
[[signature.asc](bugreport.cgi?att=1;bug=607479;filename=signature.asc;msg=73) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Wed, 12 Oct 2011 09:33:02 GMT) ([full text](bugreport.cgi?bug=607479;msg=75), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=75), [link](#74)).

---

**Acknowledgement sent**
to `Dominic Hargreaves <dom@earth.li>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Wed, 12 Oct 2011 09:33:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=77), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=77), [link](#76)).

---

[Message #78](#78) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=78), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=78), reply):

![](/cgi-bin/libravatar.cgi?email=dom%40earth.li)
From: Dominic Hargreaves <dom@earth.li>
To: rra@debian.org
Cc: Damyan Ivanov <dmn@debian.org>,
Moritz Mühlenhoff <jmm@inutil.org>,
607479@bugs.debian.org, team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Wed, 12 Oct 2011 10:30:51 +0100
```
On Wed, Oct 12, 2011 at 12:03:50PM +0300, Damyan Ivanov wrote:
> -=| Dominic Hargreaves, 11.10.2011 14:33:42 +0100 |=-
> > On Sat, Oct 01, 2011 at 12:44:33PM +0200, Moritz Mühlenhoff wrote:
> > > Did update this receive testing?
>
> The changes look sane "in theory". They address all mentions of
> FCGI::ENV in the source.
>
> The RT testing by Dominic seems sufficient additional assurance to me.

Russ, I guess you've been involved in fixing this locally; are you able
to make any comments on the soundness of the patch at

<<http://anonscm.debian.org/gitweb/?p=pkg-perl/packages/libfcgi-perl.git;a=blob;f=debian/patches/cve-2011-2766.patch;h=62ca4ac0aff279faba37ce2168fccd248e5c45a6;hb=48b6294e73f73323310250fde667b2a2b7032df2>> ?

Cheers,
Dominic.

--
Dominic Hargreaves | <http://www.larted.org.uk/~dom/>
PGP key 5178E2A5 from the.earth.li (keyserver,web,email)

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Wed, 12 Oct 2011 20:15:10 GMT) ([full text](bugreport.cgi?bug=607479;msg=80), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=80), [link](#79)).

---

**Acknowledgement sent**
to `Russ Allbery <rra@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Wed, 12 Oct 2011 20:15:10 GMT) ([full text](bugreport.cgi?bug=607479;msg=82), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=82), [link](#81)).

---

[Message #83](#83) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=83), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=83), reply):

![](/cgi-bin/libravatar.cgi?email=rra%40debian.org)
From: Russ Allbery <rra@debian.org>
To: Dominic Hargreaves <dom@earth.li>
Cc: Damyan Ivanov <dmn@debian.org>, Moritz Mühlenhoff
<jmm@inutil.org>, 607479@bugs.debian.org, team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Wed, 12 Oct 2011 13:13:17 -0700
```
Dominic Hargreaves <dom@earth.li> writes:
> On Wed, Oct 12, 2011 at 12:03:50PM +0300, Damyan Ivanov wrote:

>> The changes look sane "in theory". They address all mentions of
>> FCGI::ENV in the source.

>> The RT testing by Dominic seems sufficient additional assurance to me.

> Russ, I guess you've been involved in fixing this locally; are you able
> to make any comments on the soundness of the patch at

> <<http://anonscm.debian.org/gitweb/?p=pkg-perl/packages/libfcgi-perl.git;a=blob;f=debian/patches/cve-2011-2766.patch;h=62ca4ac0aff279faba37ce2168fccd248e5c45a6;hb=48b6294e73f73323310250fde667b2a2b7032df2>> ?

Yeah, that should be fine.  Personally, I would have just added a second
variable that's set to true if the environment was stored, since I think
it's easier to read and more comprehensible, but this is equivalent.

I haven't actually tested it since we worked around the problem in our
application instead (by ensuring that some environment variable was always
set), but I'm pretty sure that will work.

--
Russ Allbery (rra@debian.org)               <<http://www.eyrie.org/~eagle/>>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Fri, 14 Oct 2011 15:57:07 GMT) ([full text](bugreport.cgi?bug=607479;msg=85), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=85), [link](#84)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Fri, 14 Oct 2011 15:57:07 GMT) ([full text](bugreport.cgi?bug=607479;msg=87), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=87), [link](#86)).

---

[Message #88](#88) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=88), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=88), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Damyan Ivanov <dmn@debian.org>
Cc: Dominic Hargreaves <dom@earth.li>, 607479@bugs.debian.org,
team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Fri, 14 Oct 2011 17:54:44 +0200
```
On Wed, Oct 12, 2011 at 12:03:50PM +0300, Damyan Ivanov wrote:

> > Hello Damyan, are you planning to do this or do you need someone
> > else to take over? IMO this one warrants a DSA.
>
> Thanks for the nudge. I have pushed the squeeze branch of
> <http://anonscm.debian.org/gitweb/?p=pkg-perl/packages/libfcgi-perl.git;a=summary>
> with the changes so others can take over for the actual uploading if I am away.
>
> The squeeze version still has Vcs-Svn in its control file. Would it be
> acceptable to change that too?

Yes. Please upload to security-master. Note that it needs to be build
with "-sa", since libfcgi-perl is new in stable-security.

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Thu, 20 Oct 2011 20:24:05 GMT) ([full text](bugreport.cgi?bug=607479;msg=90), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=90), [link](#89)).

---

**Acknowledgement sent**
to `Moritz Mühlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`.
(Thu, 20 Oct 2011 20:24:05 GMT) ([full text](bugreport.cgi?bug=607479;msg=92), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=92), [link](#91)).

---

[Message #93](#93) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=93), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=93), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Mühlenhoff <jmm@inutil.org>
To: Moritz Muehlenhoff <jmm@inutil.org>
Cc: Damyan Ivanov <dmn@debian.org>, Dominic Hargreaves <dom@earth.li>,
607479@bugs.debian.org, team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Thu, 20 Oct 2011 22:22:41 +0200
```
On Fri, Oct 14, 2011 at 05:54:44PM +0200, Moritz Muehlenhoff wrote:
> On Wed, Oct 12, 2011 at 12:03:50PM +0300, Damyan Ivanov wrote:
>
> > > Hello Damyan, are you planning to do this or do you need someone
> > > else to take over? IMO this one warrants a DSA.
> >
> > Thanks for the nudge. I have pushed the squeeze branch of
> > <http://anonscm.debian.org/gitweb/?p=pkg-perl/packages/libfcgi-perl.git;a=summary>
> > with the changes so others can take over for the actual uploading if I am away.
> >
> > The squeeze version still has Vcs-Svn in its control file. Would it be
> > acceptable to change that too?
>
> Yes. Please upload to security-master. Note that it needs to be build
> with "-sa", since libfcgi-perl is new in stable-security.

*ping*

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>`:

`Bug#607479`; Package `libfcgi-perl`.
(Mon, 24 Oct 2011 10:27:10 GMT) ([full text](bugreport.cgi?bug=607479;msg=95), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=95), [link](#94)).

---

[Message #96](#96) received at 607479@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=96), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=96), reply):

![](/cgi-bin/libravatar.cgi?email=dmn%40debian.org)
From: Damyan Ivanov <dmn@debian.org>
To: Moritz Muehlenhoff <jmm@inutil.org>
Cc: 607479@bugs.debian.org, team@security.debian.org
Subject: Re: Bug#607479: libfcgi-perl/CVE-2011-2766 authentication bypass
Date: Mon, 24 Oct 2011 13:23:59 +0300
```
[[Message part 1](bugreport.cgi?att=0;bug=607479;msg=96) (text/plain, inline)]
```
```
-=| Moritz Muehlenhoff, 14.10.2011 17:54:44 +0200 |=-
> On Wed, Oct 12, 2011 at 12:03:50PM +0300, Damyan Ivanov wrote:
>
> > > Hello Damyan, are you planning to do this or do you need someone
> > > else to take over? IMO this one warrants a DSA.
> >
> > Thanks for the nudge. I have pushed the squeeze branch of
> > <http://anonscm.debian.org/gitweb/?p=pkg-perl/packages/libfcgi-perl.git;a=summary>
> > with the changes so others can take over for the actual uploading if I am away.
> >
> > The squeeze version still has Vcs-Svn in its control file. Would it be
> > acceptable to change that too?
>
> Yes. Please upload to security-master. Note that it needs to be build
> with "-sa", since libfcgi-perl is new in stable-security.

Done. Sorry about the delay. Interdiff and debdiff follow:

========== interdiff ============
diff -Nru libfcgi-perl-0.71/debian/changelog libfcgi-perl-0.71/debian/changelog
--- libfcgi-perl-0.71/debian/changelog	2010-04-01 20:30:50.000000000 +0300
+++ libfcgi-perl-0.71/debian/changelog	2011-10-24 13:06:30.000000000 +0300
@@ -1,3 +1,14 @@
+libfcgi-perl (0.71-1+squeeze1) stable-security; urgency=high
+
+  * Team upload
+
+  * Add patch from upstream bug tracker fixing [CVE-2011-2766](https://security-tracker.debian.org/tracker/CVE-2011-2766)
+    Closes: #[607479](bugreport.cgi?bug=607479). Thaks to Ferdinand for reporting, Russ Allbery for the
+    analysis and chansen for the patch.
+  * control: update Vcs-* fields to point to Git
+
+ -- Damyan Ivanov <dmn@debian.org>  Mon, 24 Oct 2011 13:06:17 +0300
+
 libfcgi-perl (0.71-1) unstable; urgency=low

   * New upstream release.
diff -Nru libfcgi-perl-0.71/debian/control libfcgi-perl-0.71/debian/control
--- libfcgi-perl-0.71/debian/control	2010-04-01 20:30:50.000000000 +0300
+++ libfcgi-perl-0.71/debian/control	2011-10-24 12:59:14.000000000 +0300
@@ -8,8 +8,8 @@
  Krzysztof Krzyżaniak (eloy) <eloy@debian.org>
 Standards-Version: 3.8.4
 Homepage: <http://search.cpan.org/dist/FCGI/>
-Vcs-Svn: svn://svn.debian.org/pkg-perl/trunk/libfcgi-perl/
-Vcs-Browser: <http://svn.debian.org/viewsvn/pkg-perl/trunk/libfcgi-perl/>
+Vcs-Git: git://git.debian.org/pkg-perl/packages/libfcgi-perl.git
+Vcs-Browser: <http://anonscm.debian.org/gitweb/?p=pkg-perl/packages/libfcgi-perl.git>

 Package: libfcgi-perl
 Architecture: any
diff -Nru libfcgi-perl-0.71/debian/patches/cve-2011-2766.patch libfcgi-perl-0.71/debian/patches/cve-2011-2766.patch
--- libfcgi-perl-0.71/debian/patches/cve-2011-2766.patch	1970-01-01 02:00:00.000000000 +0200
+++ libfcgi-perl-0.71/debian/patches/cve-2011-2766.patch	2011-10-24 13:02:33.000000000 +0300
@@ -0,0 +1,42 @@
+Description: replace testing of hash value with hash reference
+ %hash is false if the hash hasn't been assigned to, *or* if the hash is simply
+ empty. This causes the environment from the *second* request (that is, the
+ environment produced by the first request) to be saved as default if the first
+ request had empty environment. This way, request after the first can get
+ access to credentials set up by the first request. badbadbad
+ This is [CVE-2011-2766](https://security-tracker.debian.org/tracker/CVE-2011-2766).
+Author: chansen@cpan.org
+Bug: <https://rt.cpan.org/Public/Bug/Display.html?id=68380>
+Bug-Debian: <http://bugs.debian.org/607479>
+
+--- a/FCGI.PL
++++ b/FCGI.PL
+@@ -294,14 +294,14 @@ sub Request(;***$*$) {
+
+ sub accept() {
+     warn "accept called as a method; you probably wanted to call Accept" if @_;
+-    if (%FCGI::ENV) {
+-	%ENV = %FCGI::ENV;
++    if ( defined($FCGI::ENV) ) {
++	%ENV = %$FCGI::ENV;
+     } else {
+-	%FCGI::ENV = %ENV;
++	$FCGI::ENV = {%ENV};
+     }
+     my $rc = Accept($global_request);
+-    for (keys %FCGI::ENV) {
+-	$ENV{$_} = $FCGI::ENV{$_} unless exists $ENV{$_};
++    for (keys %$FCGI::ENV) {
++	$ENV{$_} = $FCGI::ENV->{$_} unless exists $ENV{$_};
+     }
+
+     # not SFIO
+@@ -313,7 +313,7 @@ sub accept() {
+
+ sub finish() {
+     warn "finish called as a method; you probably wanted to call Finish" if @_;
+-    %ENV = %FCGI::ENV if %FCGI::ENV;
++    %ENV = %$FCGI::ENV if defined($FCGI::ENV);
+
+     # not SFIO
+     if (tied (*STDIN)) {
diff -Nru libfcgi-perl-0.71/debian/patches/series libfcgi-perl-0.71/debian/patches/series
--- libfcgi-perl-0.71/debian/patches/series	2010-01-15 23:05:14.000000000 +0200
+++ libfcgi-perl-0.71/debian/patches/series	2011-10-12 11:49:36.000000000 +0300
@@ -1 +1,2 @@
 fix-pod-spelling.patch
+cve-2011-2766.patch

========== debdiff =========
$ debdiff libfcgi-perl_0.71-1_amd64.deb libfcgi-perl_0.71-1+squeeze1_amd64.deb
File lists identical (after any substitutions)

Control files: lines which differ (wdiff format)
------------------------------------------------
Depends: perl (>= [-5.10.1-11),-] {+5.10.1-17squeeze2),+} perlapi-5.10.1, libc6 (>= 2.4)
Version: [-0.71-1-] {+0.71-1+squeeze1+}

```
```
[[signature.asc](bugreport.cgi?att=1;bug=607479;filename=signature.asc;msg=96) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Damyan Ivanov <dmn@debian.org>`:

You have taken responsibility.
(Tue, 25 Oct 2011 13:57:03 GMT) ([full text](bugreport.cgi?bug=607479;msg=98), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=98), [link](#97)).

---

**Notification sent**
to `Ferdinand <debbug@smitplaza.com>`:

Bug acknowledged by developer.
(Tue, 25 Oct 2011 13:57:04 GMT) ([full text](bugreport.cgi?bug=607479;msg=100), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=100), [link](#99)).

---

[Message #101](#101) received at 607479-close@bugs.debian.org ([full text](bugreport.cgi?bug=607479;msg=101), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=101), reply):

![](/cgi-bin/libravatar.cgi?email=dmn%40debian.org)
From: Damyan Ivanov <dmn@debian.org>
To: 607479-close@bugs.debian.org
Subject: Bug#607479: fixed in libfcgi-perl 0.71-1+squeeze1
Date: Tue, 25 Oct 2011 13:55:07 +0000
```
Source: libfcgi-perl
Source-Version: 0.71-1+squeeze1

We believe that the bug you reported is fixed in the latest version of
libfcgi-perl, which is due to be installed in the Debian FTP archive:

libfcgi-perl_0.71-1+squeeze1.debian.tar.gz
  to main/libf/libfcgi-perl/libfcgi-perl_0.71-1+squeeze1.debian.tar.gz
libfcgi-perl_0.71-1+squeeze1.dsc
  to main/libf/libfcgi-perl/libfcgi-perl_0.71-1+squeeze1.dsc
libfcgi-perl_0.71-1+squeeze1_amd64.deb
  to main/libf/libfcgi-perl/libfcgi-perl_0.71-1+squeeze1_amd64.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 607479@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Damyan Ivanov <dmn@debian.org> (supplier of updated libfcgi-perl package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Mon, 24 Oct 2011 13:06:17 +0300
Source: libfcgi-perl
Binary: libfcgi-perl
Architecture: source amd64
Version: 0.71-1+squeeze1
Distribution: stable-security
Urgency: high
Maintainer: Debian Perl Group <pkg-perl-maintainers@lists.alioth.debian.org>
Changed-By: Damyan Ivanov <dmn@debian.org>
Description:
 libfcgi-perl - helper module for FastCGI
Closes: [607479](bugreport.cgi?bug=607479)
Changes:
 libfcgi-perl (0.71-1+squeeze1) stable-security; urgency=high
 .
   * Team upload
 .
   * Add patch from upstream bug tracker fixing [CVE-2011-2766](https://security-tracker.debian.org/tracker/CVE-2011-2766)
     Closes: #[607479](bugreport.cgi?bug=607479). Thaks to Ferdinand for reporting, Russ Allbery for the
     analysis and chansen for the patch.
   * control: update Vcs-* fields to point to Git
Checksums-Sha1:
 5ee03927c922c89960e56447bfc6d86d1ba338e2 2033 libfcgi-perl_0.71-1+squeeze1.dsc
 bac067b4a5e7880f4bb336d8a647a6cafd26c2ba 93995 libfcgi-perl_0.71.orig.tar.gz
 3a6210345d361805003b63fd4bf544dae8471c8a 5243 libfcgi-perl_0.71-1+squeeze1.debian.tar.gz
 101318fe03e9d6e918dc465126cceed255d25a9d 42324 libfcgi-perl_0.71-1+squeeze1_amd64.deb
Checksums-Sha256:
 a985b58f4ea7c0cf4c06676a80a625b9078e3e4568e93c2a1a67a3756b8e6236 2033 libfcgi-perl_0.71-1+squeeze1.dsc
 9b5b8c1ab62da938c82405cddd0ee4173b257597bf9d567fb81c0dfcc060c64e 93995 libfcgi-perl_0.71.orig.tar.gz
 0ff2f13d4ae9a3094508b3bd8c5185c8676aa2d3c0756b1575ac566fd9ecac39 5243 libfcgi-perl_0.71-1+squeeze1.debian.tar.gz
 45b98eec0ae50bde0b46478f57fcd7cfccc4d79df8c864b1308cfefb0225cd7b 42324 libfcgi-perl_0.71-1+squeeze1_amd64.deb
Files:
 2918bbe9ca20208f719a2eeaf6e29172 2033 perl optional libfcgi-perl_0.71-1+squeeze1.dsc
 26bc4ea53ccc9c9c16695e88e46a1cfb 93995 perl optional libfcgi-perl_0.71.orig.tar.gz
 39b0f3a6e5173b7afa337b9a5beec27e 5243 perl optional libfcgi-perl_0.71-1+squeeze1.debian.tar.gz
 ff0171df5e84fd2b9a802aa6dca7dea9 42324 perl optional libfcgi-perl_0.71-1+squeeze1_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)

iQIcBAEBCAAGBQJOpTuBAAoJENu+nU2Z0qAESiAP/j0t7R7CYD4u69mwesJ6JnHD
8xYDEFB+D6IOwkPRbMw/9mfVX3Y/AGAowyCa9T0Pfrau/KEkAtpe1jCp7huqj+vF
oYgCDwaXiiQHkNt4XS1skz6UNEGX/apNoP+KbvZzJF6zILS26AVnSeIaVZUwwFHI
x5y1bnUjhX3tcKQNYZC79uKoACjY1ittVLOS8xao/Pea5PVVX+MYltfUJivx3ijn
18/2dnSlA89BGc6FFpR+AwyRTe9LXcW6lgn66YbjVKWKaSvTwXqPROMr1qBGJTe3
HpfB/p6lcUgfGLFfi0s2wm3vi119n7awiHZOnC/U2iDnPHH29QDIkv4IMf6unUbO
UbiTBRZIiMXz89V+VRaYlq+hLq9RAs4PyDRMV89GJeJqiRjOlmfpvwH/owZWswaV
KG+//dIBE7C1mFhTv+iuJV2AWNtx+yWSeCVP9GUcgD1Iq0dGdvzNM49mNB9pMZ8H
uCIZDxHru03C8DGsXmzortvp+nwUn9rHAzmqPw1j9CsS8rMP0od4kUSsRxYH3Fym
bLOLrMEBIiwm/b4jM/6z7vcB8LxAKrFXc5GtxsfTXL6yMvEh1GLzoMcQqyr1K0tv
OIYMKCEESoq3MXtRPm4p1rDin/Q45P2SKKRHXqMlGPn9fot2Po8TXplnEAbv1u5p
CKT/jV/kbg4jFumLACNY
=WRVC
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 29 Jan 2012 07:38:26 GMT) ([full text](bugreport.cgi?bug=607479;msg=103), [mbox](bugreport.cgi?bug=607479;mbox=yes;msg=103), [link](#102)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=607479).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 02:00:25 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


