Based on the provided documents, here's a breakdown of the vulnerability described in CVE-2011-2704:

**Root cause of vulnerability:**
- Missing length checks in the processing of OGC (Open Geospatial Consortium) filter encoding.

**Weaknesses/vulnerabilities present:**
- Stack-based buffer overflow.

**Impact of exploitation:**
- Execution of arbitrary code.
- Potential denial of service (application crash) (mentioned in relation to other CVEs)

**Attack vectors:**
- Processing of OGC filter encoding (in WMS, WFS, and SOS filters).
- Specifically, an attacker could exploit the lack of length checks by providing overly long input via the OGC filter.

**Required attacker capabilities/position:**
- The attacker needs to be able to send crafted requests with malicious OGC filter encoding to the vulnerable MapServer application.

**Additional notes:**
- The vulnerability exists in versions of MapServer prior to the fixes detailed in the provided documents.
- The vulnerability is triggered during the processing of OGC filter encoding, which is used in support of WMS, WFS, and SOS specifications.
- The vulnerability is considered a "significant potentially exploitable buffer overflow."
- Patches were made available across multiple versions of MapServer.