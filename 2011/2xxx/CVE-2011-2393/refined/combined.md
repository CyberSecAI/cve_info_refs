=== Content from seclists.org_b23f76ec_20250125_185748.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](85)
[By Date](date.html#86)
[![Next](/images/right-icon-16x16.png)](87)

[![Previous](/images/left-icon-16x16.png)](85)
[By Thread](index.html#86)
[![Next](/images/right-icon-16x16.png)](89)

![](/shared/images/nst-icons.svg#search)

# ICMPv6 Router Announcement flooding denial of service affecting multiple systems

---

*From*: Marc Heuse <mh () mh-sec de>

*Date*: Tue, 05 Apr 2011 17:50:55 +0200

---

```

This security advisory is released because Microsoft doesnt want to fix
the issue. Cisco did for its IOS and ASA within 3 months.

________________________________________________________________________

Title: ICMPv6 Router Announcement flooding denial of service affecting
multiple systems
Date:  05 April 2011
URL:   <http://www.mh-sec.de/downloads/mh-RA_flooding_CVE-2010-multiple.txt>

________________________________________________________________________

Vendors:               Cisco, Juniper, Microsoft, FreeBSD
Affected Products:     All Cisco IOS ASA with firmware < November 2010
                       All Netscreen versions
                       All Windows versions
                       All FreeBSD version
Vulnerability:         ICMPv6 Router Announcement flooding denial of service
Severity:              7.8 (CVE CVSS Score), local network
CVEs:                  CVE-2010-4670, CVE-2010-4671, CVE-2010-4669

________________________________________________________________________

Update Section:

 05 April 2011
      Initial release

________________________________________________________________________

Overview:

  When flooding the local network with random router advertisements,
  hosts and routers update the network information, consuming all
  available CPU resources, making the systems unusable and unresponsive.
  As IPv6 and autoconfiguration are enabled by default, all are
  affected in their default configuration.
  For Windows, a personal firewall or similar security product does not
  protect against this attack.

  Note: Microsoft does not want to fix this security issue for their
        products.

Impact:

  Updating the routing tables and configuring IPv6 addresses take up
  all available CPU resources.
  Routers and firewalls do not forward traffic.

  The denial of service is in affect until the flooding is terminated.

  The exact impact differs from the affected system type:
  Cisco: 100% traffic loss with autconfiguration active, 80% without.
  Netscreen: Only affected when the interface is configured as host, traffic
    is forwarded until the neighbor information times out, then the traffic
    is lost
  Windows: 100% CPU, 100% RAM
  FreeBSD: 100% CPU, additionally IPv6 support can be lost until reboot
    occasionally.
  Old Linux kernels are also affected, detailed version information unknown.

Description:

  On IPv6 networks, hosts automatically find out about available
  routers via ICMPv6 router announcements which are sent by the
  routers. Additionally, router announcemens are used to replace
  DHCP by the so called autoconfiguration feature.

  Windows and FreeBSD - like all modern operating systems - enable
  IPv6 and autoconfiguration by default and are thereby vulnerable.
  A personal firewall will not protect against this attack.

  If a system receives a router announcement of a new router, it
  updates its routing table with the new router, and if the
  autoconfiguration flag is set on the announcement (and the host
  is configured to configure its IPv6 address by this mechanism),
  the host chooses an IPv6 address from the announced network space.

  If a network is flooded with random router announcements, systems
  scramble to update their routing tables  and configure IPv6
  addresses.

Exploit:

  Flood the network with router advertisements coming from different
  routers and announcing different network prefixes.

  A tool to test for this vulnerability is included in the thc-ipv6
  package, called flood_router6.

Solution:

  Cisco: IOS fix CSCti24526 , ASA fix CSCti33534
  Linux: fixed prior 2010
  Netscreen: Juniper waiting for IETF results for how to fix the issue
  FreeBSD: unknown
  Windows: Microsoft made clear that they do not plan to issue a
           fix for this security issue.

Workaround:

  The procession of router announcements must be disabled.
  Please consult your system manual on how to this for your
  affected platform.
  Alternatively, disable IPv6.

________________________________________________________________________

Vendor communication:

  10 July 2010        Microsoft informed

  10 July 2010        Cisco informed

  01 August 2010      Cisco confirms problem, announces fix for October

  12 August 2010      Microsoft confirms vulnerability, states no fix
                      will be supplied.

  22 November 2010    Cisco confirms fixes are available and started to
                      be deployed in current firmwares

  28 December 2010    vendor-sec informed (among other issues)

  05 February 2011    FreeBSD informed (made aware via vendor-sec 5 weeks
                      before)

  20 February 2011    Juniper informed

  09 March 2011       Juniper confirms problem

  01 April 2011       Juniper informs that they work with the IETF to
                      develop a standard method to cope with this and
                      similar attacks.

________________________________________________________________________

Contact:

Marc Heuse
mh () mh-sec de
<http://www.mh-sec.de>

________________________________________________________________________

The information provided is released "as is" without warranty of
any kind. The publisher disclaims all warranties, either express or
implied, including all warranties of merchantability.
No responsibility is taken for the correctness of this information.
In no event shall the publisher be liable for any damages whatsoever
including direct, indirect, incidental, consequential, loss of
business profits or special damages, even if the publisher has been
advised of the possibility of such damages.

The contents of this advisory is copyright (c) 2010,2011 by Marc Heuse
and may be distributed freely provided that no fee is charged for
the distribution and proper credit is given.

________________________________________________________________________

--
Marc Heuse
www.mh-sec.de

PGP: FEDD 5B50 C087 F8DF 5CB9  876F 7FDD E533 BF4F 891A

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>

```

---

[![Previous](/images/left-icon-16x16.png)](85)
[By Date](date.html#86)
[![Next](/images/right-icon-16x16.png)](87)

[![Previous](/images/left-icon-16x16.png)](85)
[By Thread](index.html#86)
[![Next](/images/right-icon-16x16.png)](89)

### Current thread:

* **ICMPv6 Router Announcement flooding denial of service affecting multiple systems** *Marc Heuse (Apr 06)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.mh-sec.de_4b626313_20250125_185749.html ===
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Title: ICMPv6 Router Announcement flooding denial of service affecting multiple systems
Date: 15 April 2011
URL: http://www.mh-sec.de/downloads/mh-RA\_flooding\_CVE-2010-multiple.txt
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Vendors: Cisco, Juniper, Microsoft, FreeBSD, NetBSD
Affected Products: All Cisco IOS ASA with firmware < November 2010
All Netscreen versions supporting IPv6
Windows 2008, 7, 2003, 2000, XP
All FreeBSD versions
All NetBSD versions
Vulnerability: ICMPv6 Router Announcement flooding denial of service
Severity: 7.8 (CVE CVSS Score), local network
CVEs: CVE-2010-4670, CVE-2010-4671, CVE-2010-4669, CVE-2011-2393
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Update Section:
30 May 2011
NetBSD is vulnerable too, fix is in progress
15 April 2011
Juniper states they are not fixing until the IETF workgroup has
a proposal on how to fix this issue. (So better buy Cisco)
Clarify that FreeBSD does not have IPv6 enabled by default.
Some better wording.
05 April 2011
Initial release
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Overview:
When flooding the local network with random router advertisements,
hosts and routers update the network information, consuming all
available CPU resources, making the systems unusable and unresponsive.
As IPv6 and autoconfiguration are enabled by default (except on FreeBSD,
Windows XP/2000/2003), all are affected in their default configuration.
For Windows, a personal firewall or similar security product does not
protect against this attack, as the default filter rules allow these
packets through.
Note: Microsoft does not want to fix this security issue for their
products.
Impact:
Updating the routing tables and configuring IPv6 addresses take up
all available CPU resources.
Routers and firewalls do not forward traffic.
The denial of service is in affect until the flooding is terminated.
The exact impact differs from the affected system type:
Cisco: 100% traffic loss with autconfiguration active, 80% without.
Netscreen: Only affected when the interface is configured as host, traffic
is forwarded until the neighbor information times out, then the traffic
is lost
Windows: 100% CPU, 100% RAM
FreeBSD: 100% CPU, additionally IPv6 support can be lost until reboot
occasionally.
Old Linux kernels are also affected, detailed version information unknown.
Description:
On IPv6 networks, hosts automatically find out about available
routers via ICMPv6 router announcements which are sent by the
routers. Additionally, router announcemens are used to replace
DHCP by the so called autoconfiguration feature.
Windows and FreeBSD - like all modern operating systems - enable
IPv6 and autoconfiguration by default and are thereby vulnerable.
A personal firewall will not protect against this attack.
If a system receives a router announcement of a new router, it
updates its routing table with the new router, and if the
autoconfiguration flag is set on the announcement (and the host
is configured to configure its IPv6 address by this mechanism),
the host chooses an IPv6 address from the announced network space.
If a network is flooded with random router announcements, systems
scramble to update their routing tables and configure IPv6
addresses.
Exploit:
Flood the network with router advertisements coming from different
routers and announcing different network prefixes.
A tool to test for this vulnerability is included in the thc-ipv6
package, called flood\_router6.
Solution:
Cisco: IOS fix CSCti24526 , ASA fix CSCti33534
Linux: fixed prior 2010
Netscreen: Juniper waiting for IETF results for how to fix the issue
FreeBSD: unknown
Windows: Microsoft made clear that they do not plan to issue a
fix for this security issue.
Workaround:
The procession of router announcements must be disabled.
Please consult your system manual on how to this for your
affected platform.
Alternatively, disable IPv6.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Vendor communication:
10 July 2010 Microsoft informed
10 July 2010 Cisco informed
01 August 2010 Cisco confirms problem, announces fix for October
12 August 2010 Microsoft confirms vulnerability, states no fix
will be supplied.
22 November 2010 Cisco confirms fixes are available and started to
be deployed in current firmwares
28 December 2010 vendor-sec informed (among other issues)
05 February 2011 FreeBSD informed (made aware via vendor-sec 5 weeks
before)
20 February 2011 Juniper informed
09 March 2011 Juniper confirms problem
01 April 2011 Juniper informs that they work with the IETF to
develop a standard method to cope with this and
similar attacks and will not fix the issue until
then.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Contact:
Marc Heuse
mh@mh-sec.de
http://www.mh-sec.de
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
The information provided is released "as is" without warranty of
any kind. The publisher disclaims all warranties, either express or
implied, including all warranties of merchantability.
No responsibility is taken for the correctness of this information.
In no event shall the publisher be liable for any damages whatsoever
including direct, indirect, incidental, consequential, loss of
business profits or special damages, even if the publisher has been
advised of the possibility of such damages.
The contents of this advisory is copyright (c) 2010,2011 by Marc Heuse
and may be distributed freely provided that no fee is charged for
the distribution and proper credit is given.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

