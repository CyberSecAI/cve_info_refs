=== Content from trac.webkit.org_8f4d0f16_20250125_234507.html ===


[![WebKit Trac](/chrome/site/favicon.png)](http://www.webkit.org/)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [Browse Source](/browser)
* [Search](/search)

## Context Navigation

* ← [Previous Changeset](/changeset/80154/webkit "Changeset 80154")
* [Next Changeset](/changeset/80156/webkit "Changeset 80156") →

---

# Changeset 80155 in webkit

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
Mar 2, 2011, 11:56:10 AM
([14 years](/timeline?from=2011-03-02T11%3A56%3A10-08%3A00&precision=second "See timeline at Mar 2, 2011, 11:56:10 AM") ago)
Author:
mihaip@chromium.org
Message:

2011-03-02 Mihai Parparita <​mihaip@chromium.org>

> Reviewed by Dimitri Glazkov.

> Add CRASH() for CSSSelector double frees
>
> [​https://bugs.webkit.org/show\_bug.cgi?id=55596](https://bugs.webkit.org/show_bug.cgi?id=55596)

> To help track down bug 53045, add a CRASH call when the CSSSelector
>
> destructor is invoked more than once.

> Just a check, no new tests necessary.

* css/CSSSelector.h:
  (WebCore::CSSSelector::CSSSelector):
  (WebCore::CSSSelector::~CSSSelector):

Location:
[trunk/Source/WebCore](/browser/webkit/trunk/Source/WebCore?rev=80155)
Files:

2 edited

* [ChangeLog](/browser/webkit/trunk/Source/WebCore/ChangeLog?rev=80155 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [css/CSSSelector.h](/browser/webkit/trunk/Source/WebCore/css/CSSSelector.h?rev=80155 "Show entry in browser")
  (modified)
  ([4 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [trunk/Source/WebCore/ChangeLog](/changeset/80155/webkit/trunk/Source/WebCore/ChangeLog "Show the changeset 80155 restricted to trunk/Source/WebCore/ChangeLog")

  | [r80151](/browser/webkit/trunk/Source/WebCore/ChangeLog?rev=80151#L1 "Show revision 80151 of this file in browser") | [r80155](/browser/webkit/trunk/Source/WebCore/ChangeLog?rev=80155#L1 "Show revision 80155 of this file in browser") |  |
  | --- | --- | --- |
  |  | 1 | 2011-03-02  Mihai Parparita  <mihaip@chromium.org> |
  |  | 2 |  |
  |  | 3 | Reviewed by Dimitri Glazkov. |
  |  | 4 |  |
  |  | 5 | Add CRASH() for CSSSelector double frees |
  |  | 6 | https://bugs.webkit.org/show\_bug.cgi?id=55596 |
  |  | 7 |  |
  |  | 8 | To help track down bug 53045, add a CRASH call when the CSSSelector |
  |  | 9 | destructor is invoked more than once. |
  |  | 10 |  |
  |  | 11 | Just a check, no new tests necessary. |
  |  | 12 |  |
  |  | 13 | \* css/CSSSelector.h: |
  |  | 14 | (WebCore::CSSSelector::CSSSelector): |
  |  | 15 | (WebCore::CSSSelector::~CSSSelector): |
  |  | 16 |  |
  | 1 | 17 | 2011-03-02  Carol Szabo  <carol.szabo@nokia.com> |
  | 2 | 18 |  |
* ## [trunk/Source/WebCore/css/CSSSelector.h](/changeset/80155/webkit/trunk/Source/WebCore/css/CSSSelector.h "Show the changeset 80155 restricted to trunk/Source/WebCore/css/CSSSelector.h")

  | [r77954](/browser/webkit/trunk/Source/WebCore/css/CSSSelector.h?rev=77954#L44 "Show revision 77954 of this file in browser") | [r80155](/browser/webkit/trunk/Source/WebCore/css/CSSSelector.h?rev=80155#L44 "Show revision 80155 of this file in browser") |  |
  | --- | --- | --- |
  | 44 | 44 | , m\_hasRareData(false) |
  | 45 | 45 | , m\_isForPage(false) |
  |  | 46 | , m\_deleted(false) |
  | 46 | 47 | , m\_tag(anyQName()) |
  | 47 | 48 | { |
  | […](/browser/webkit/trunk/Source/WebCore/css/CSSSelector.h?rev=77954#L57) | […](/browser/webkit/trunk/Source/WebCore/css/CSSSelector.h?rev=80155#L58) |  |
  | 57 | 58 | , m\_hasRareData(false) |
  | 58 | 59 | , m\_isForPage(false) |
  |  | 60 | , m\_deleted(false) |
  | 59 | 61 | , m\_tag(qName) |
  | 60 | 62 | { |
  | […](/browser/webkit/trunk/Source/WebCore/css/CSSSelector.h?rev=77954#L63) | […](/browser/webkit/trunk/Source/WebCore/css/CSSSelector.h?rev=80155#L65) |  |
  | 63 | 65 | ~CSSSelector() |
  | 64 | 66 | { |
  |  | 67 | if (m\_deleted) |
  |  | 68 | CRASH(); |
  |  | 69 | m\_deleted = true; |
  | 65 | 70 | if (m\_hasRareData) |
  | 66 | 71 | delete m\_data.m\_rareData; |
  | […](/browser/webkit/trunk/Source/WebCore/css/CSSSelector.h?rev=77954#L280) | […](/browser/webkit/trunk/Source/WebCore/css/CSSSelector.h?rev=80155#L285) |  |
  | 280 | 285 | bool m\_hasRareData            : 1; |
  | 281 | 286 | bool m\_isForPage              : 1; |
  |  | 287 | // FIXME: Remove once http://webkit.org/b/53045 is fixed. |
  |  | 288 | bool m\_deleted                : 1; |
  | 282 | 289 |  |
  | 283 | 290 | unsigned specificityForOneSelector() const; |
**Note:**
See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

### Download in other formats:

* [Unified Diff](?format=diff&new=80155)
* [Zip Archive](?format=zip&new=80155)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.5.4**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Hosted by [Apple](http://www.apple.com/)



=== Content from bugs.chromium.org_b4b7e4ce_20250125_234455.html ===


