Based on the provided information, here's an analysis of CVE-2011-2978:

**Root cause of vulnerability:**

The vulnerability stems from Bugzilla trusting a user-modifiable field ('old_login') to obtain the current email address when a user attempts to change their email in their account preferences.

**Weaknesses/vulnerabilities present:**

- **Insecure Direct Object Reference:** The application directly uses a user-supplied value to identify the user's old email address, instead of securely retrieving it from the user's session or database record.
- **Insufficient Input Validation:** The application doesn't validate or sanitize the 'old_login' field, allowing an attacker to inject arbitrary values.

**Impact of exploitation:**

- **Account Hijacking:** By modifying the 'old_login' field, an attacker could redirect the email confirmation message (used to verify email changes) to an address controlled by them. This prevents the legitimate user from receiving notification that their email was changed, giving the attacker a chance to take control of the account using the changed email address.
- **Privilege Escalation (Indirect):** By gaining access to another user's account, an attacker could potentially access other sensitive information or perform actions on behalf of that user.

**Attack vectors:**

- **Man-in-the-Middle/Session Hijacking:** An attacker needs access to the session of the targeted user. This could be through various methods like:
   - Session hijacking (e.g., stealing session cookies)
   - Social engineering
   - Exploiting other vulnerabilities to gain access to the user's session
   - The user leaving their browser open in a public place.
- **Form Manipulation:** The attacker would then need to modify the hidden 'old_login' field within the user's account preference form to redirect the email confirmation message.

**Required attacker capabilities/position:**

- **Active Session:** The attacker needs an active and valid session of the targeted user.
- **Knowledge of the Vulnerability:** The attacker needs to know about the presence and mechanics of the vulnerable 'old_login' field.
- **Ability to Modify HTTP Request:** The attacker needs to be able to manipulate form data, which can be done through browser developer tools or by intercepting the HTTP request.

**Additional Details**
- The vulnerability exists because the old email address was being pulled from a user-modifiable field instead of from the user object.
- The issue existed since Bugzilla 2.16rc1 when the email changing functionality was introduced.
- The fix involved making the Bugzilla::Token::IssueEmailChangeToken() function take only ($user, $new_email) arguments and fetching the $old_email from $user->login internally.
- The issue was fixed in Bugzilla versions 3.4, 3.6, 4.0 and trunk/4.2
- A related bug, [bug 670669](https://bugzilla.mozilla.org/show_bug.cgi?id=670669), exacerbated the issue as it allowed changing the email address without needing the current password.
- A backport was needed for 3.4.11 too, to fix the issue when users clear `Bugzilla_login` in the browser.
- The `old_login` field exists to allow users who do not use cookies to still log in without entering their password twice on the account preferences page.