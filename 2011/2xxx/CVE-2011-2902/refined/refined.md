```
{
  "vulnerability": {
    "root_cause": "The zxpdf script in xpdf uses the filename of the input .pdf.gz file to construct the name of the temporary file it creates. This allows an attacker to craft a malicious .pdf.gz filename that includes shell metacharacters, which are then interpreted by the shell when the temporary file is created and deleted.",
    "weaknesses": [
      "Insecure use of `tempfile`",
      "Improper input sanitization",
      "Command injection"
    ],
    "impact": "An attacker can delete arbitrary files on the system or execute shell commands with the privileges of the user running `zxpdf`.",
    "attack_vectors": "A user can be tricked into opening a specially crafted .pdf.gz file, either by downloading it from a malicious website or by receiving it as an email attachment. The `zxpdf` script will then process this file, resulting in the deletion of unintended files or execution of shell commands.",
    "required_attacker_capabilities": "The attacker needs to be able to craft a .pdf.gz filename containing shell metacharacters and convince a user to open it with `zxpdf`."
  },
  "additional_details": "The vulnerability is located in the `/usr/bin/xpdf` script. The original vulnerability was caused by the use of `tempfile -p "$(basename "$file")" -s .pdf`. This line used the basename of the input file as part of the temporary file name, leading to command injection if the filename contained shell metacharacters. The fix was to remove the `-p` option. Additionally, the use of  `rm -f \"$tmp\"` was also a vulnerability, and was fixed by using `rm -f -- \"$tmp\"` to prevent `tmp` variable expansion by the shell."
}
```