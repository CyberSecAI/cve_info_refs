=== Content from www.kb.cert.org_60a504f6_20250124_182110.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#903934

## Hash table implementations vulnerable to algorithmic complexity attacks

#### Vulnerability Note VU#903934

Original Release Date: 2011-12-28 | Last Revised: 2016-02-15

---

### Overview

Some programming language implementations do not sufficiently randomize their hash functions or provide means to limit key collision attacks, which can be leveraged by an unauthenticated attacker to cause a denial-of-service (DoS) condition.

### Description

| Many applications, including common web framework implementations, use hash tables to map key values to associated entries. If the hash table contains entries for different keys that map to the same hash value, a hash collision occurs and additional processing is required to determine which entry is appropriate for the key. If an attacker can generate many requests containing colliding key values, an application performing the hash table lookup may enter a denial of service condition.  Hash collision denial-of-service attacks were first [detailed](http://www.cs.rice.edu/~scrosby/hash/CrosbyWallach_UsenixSec2003.pdf) in 2003, but [recent research](http://www.nruns.com/_downloads/advisory28122011.pdf) details how these attacks apply to modern language hash table implementations. |
| --- |

### Impact

| An application can be forced into a denial-of-service condition. In the case of some web application servers, specially-crafted POST form data may result in a denial-of-service. |
| --- |

### Solution

| **Apply an update**Please review the Vendor Information section of this document for vendor-specific patch and workaround details. |
| --- |

| **Limit CPU time**Limiting the processing time for a single request can help minimize the impact of malicious requests.**Limit maximum POST size**Limiting the maximum POST request size can reduce the number of possible predictable collisions, thus reducing the impact of an attack. **Limit maximum request parameters**Some servers offer the option to limit the number of parameters per request, which can also minimize impact. |
| --- |

### Vendor Information

903934
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23903934/) to view vendors.**
### [Apache Tomcat](#DWAN-8PYMUS) Affected

Updated:  December 28, 2011

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

According to the n.runs AG advisory:
"Tomcat has released updates (7.0.23, 6.0.35) for this issue which limit the number of request parameters using a configuration parameter. The default value of 10.000 should provide sufficient protection."

### Vendor References

* <http://tomcat.apache.org/tomcat-7.0-doc/changelog.html>

### [Microsoft Corporation](#MAPG-8N7Q7G) Affected

Notified:  November 01, 2011  Updated: December 29, 2011

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Microsoft has released an update to the .NET Framework with [Microsoft Security Bulletin MS11-100](http://technet.microsoft.com/en-us/security/bulletin/ms11-100.mspx), which addresses this issue.

### Vendor References

* <http://technet.microsoft.com/en-us/security/bulletin/ms11-100.mspx>
* <http://technet.microsoft.com/en-us/security/advisory/2659883>
* <http://blogs.technet.com/b/srd/archive/2011/12/27/more-information-about-the-december-2011-asp-net-vulnerability.aspx>

### [Oracle Corporation](#MAPG-8N7Q7K) Affected

Notified:  November 01, 2011  Updated: February 15, 2016

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Addendum

New information regarding this vulnerability in Java 8 was provided in Februrary 2016, which was sent to Oracle for review.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Ruby](#MAPG-8N7Q7N) Affected

Notified:  November 01, 2011  Updated: December 28, 2011

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

According to the n.runs AG advisory:
"CRuby and JRuby provide updates for this issue with a randomized hash function (CRuby 1.8.7-p357, JRuby 1.6.5.1, CVE-2011-4815)."

### Vendor References

* <http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/391606>

### [The PHP Group](#DWAN-8PYMFT) Affected

Updated:  December 28, 2011

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

According to the n.runs AG advisory:
"PHP 5 uses the DJBX33A (Dan Bernstein's times 33, addition) hash function and parses POST form data into the $\_POST hash table. Because of the structure of the hash function, it is vulnerable to an equivalent substring attack."

From the Workarounds section:
"The easiest way to reduce the impact of such an attack is to reduce the CPU time that a request is allowed to take. For PHP, this can be configured using the max\_input\_time parameter."

PHP 5.4.0 RC4 has been released which adds a max\_input\_vars directive to help mitigate hash collision attacks. Please note that this is a release candidate, not a stable release.

### Vendor References

* <http://www.php.net/archive/2011.php#id2011-12-25-1>

### [Adobe](#MAPG-8N7Q7A) Unknown

Notified:  November 01, 2011  Updated: November 01, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [IBM Corporation](#MAPG-8N7Q7D) Unknown

Notified:  November 01, 2011  Updated: November 01, 2011

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 0 | AV:--/AC:--/Au:--/C:--/I:--/A:-- |
| Temporal | 0 | E:ND/RL:ND/RC:ND |
| Environmental | 0 | CDP:ND/TD:ND/CR:ND/IR:ND/AR:ND |

### References

* <http://www.ocert.org/advisories/ocert-2011-003.html>
* <http://www.nruns.com/_downloads/advisory28122011.pdf>
* <http://www.cs.rice.edu/~scrosby/hash/CrosbyWallach_UsenixSec2003.pdf>
* <http://technet.microsoft.com/en-us/security/bulletin/ms11-100.mspx>
### Acknowledgements

Thanks to Alexander Klink and Julian Wälde for reporting these vulnerabilities.

This document was written by Jared Allar and David Warren.

### Other Information

| **CVE IDs:** | [CVE-2011-4815](http://web.nvd.nist.gov/vuln/detail/CVE-2011-4815), [CVE-2011-3414](http://web.nvd.nist.gov/vuln/detail/CVE-2011-3414), [CVE-2011-4838](http://web.nvd.nist.gov/vuln/detail/CVE-2011-4838), [CVE-2011-4885](http://web.nvd.nist.gov/vuln/detail/CVE-2011-4885) |
| --- | --- |
| **Severity Metric:** | 10.80 |
| **Date Public:** | 2011-12-28 |
| **Date First Published:** | 2011-12-28 |
| **Date Last Updated:** | 2016-02-15 20:05 UTC |
| **Document Revision:** | 41 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.ocert.org_98101000_20250124_182111.html ===


**oCERT-2011-003 multiple implementations denial-of-service via hash algorithm collision**

**Description**:

A variety of programming languages suffer from a denial-of-service (DoS)
condition against storage functions of key/value pairs in hash data structures,
the condition can be leveraged by exploiting predictable collisions in the
underlying hashing algorithms.

The issue finds particular exposure in web server applications and/or
frameworks. In particular, the lack of sufficient limits for the number of
parameters in POST requests in conjunction with the predictable collision
properties in the hashing functions of the underlying languages can render web
applications vulnerable to the DoS condition. The attacker, using specially
crafted HTTP requests, can lead to a 100% of CPU usage which can last up to
several hours depending on the targeted application and server performance, the
amplification effect is considerable and requires little bandwidth and time on
the attacker side.

The condition for predictable collisions in the hashing functions has
been reported for the following language implementations:
[Java](http://www.java.com),
[JRuby](http://jruby.org/),
[PHP](http://www.php.net/),
[Python](http://python.org/),
[Rubinius](http://rubini.us/),
[Ruby](http://www.ruby-lang.org/).
In the case of the Ruby language, the 1.9.x branch is not affected
by the predictable collision condition since this version includes a
randomization of the hashing function.

The vulnerability outlined in this advisory is practically identical to the one
reported in 2003 and described in the paper
[Denial of Service via Algorithmic Complexity Attacks](http://www.cs.rice.edu/~scrosby/hash/CrosbyWallach_UsenixSec2003.pdf)
which affected the Perl language.

The reporters own advisory can be found at <http://www.nruns.com/_downloads/advisory28122011.pdf>

**Affected version**:

[Java](http://www.java.com), all versions

[JRuby](http://jruby.org/) <= 1.6.5

[PHP](http://www.php.net/) <= 5.3.8, <= 5.4.0RC3

[Python](http://python.org/) <= 2.6.7, <= 2.7.3, <= 3.1.4, <= 3.2.2

[Rubinius](http://rubini.us/), all versions

[Ruby](http://www.ruby-lang.org/) <= 1.8.7-p356

[Apache Geronimo](http://geronimo.apache.org/), all versions

[Apache Tomcat](http://tomcat.apache.org/) <= 5.5.34, <= 6.0.34, <= 7.0.22

[Oracle Glassfish](http://glassfish.java.net/) <= 3.1.1

[Jetty](http://www.eclipse.org/jetty/) <= 7.5.4

[Plone](http://plone.org/), all versions

[Rack](http://rack.rubyforge.org/) <= 1.3.5, <= 1.2.4, <= 1.1.2

[V8 JavaScript Engine](http://code.google.com/p/v8/), all versions

**Fixed version**:

[Java](http://www.java.com), N/A

[JRuby](http://jruby.org/) >= 1.6.5.1

[PHP](http://www.php.net/) >= 5.3.9, >= 5.4.0RC4

[Python](http://python.org/) >= 2.6.8, >= 2.7.3, >= 3.1.5, >= 3.2.3 (hash randomization disabled by default, use -R flag to enable it)

[Rubinius](http://rubini.us/), N/A

[Ruby](http://www.ruby-lang.org/) >= 1.8.7-p357, 1.9.x

[Apache Geronimo](http://geronimo.apache.org/), N/A

[Apache Tomcat](http://tomcat.apache.org/) >= 5.5.35, >= 6.0.35, >= 7.0.23

[Oracle Glassfish](http://glassfish.java.net/), N/A (addressed in Oracle Critical Patch Update - January 2012)

[Jetty](http://www.eclipse.org/jetty/) >= 7.6.0.RC3

[Plone](http://plone.org/), N/A

[Rack](http://rack.rubyforge.org/) >= 1.4.0, >= 1.3.6, >= 1.2.5, >= 1.1.3

[V8 JavaScript Engine](http://code.google.com/p/v8/), N/A

**Credit**: vulnerability report and PoC code received from Alexander Klink <alexander.klink AT nruns.com>
and Julian Waelde <jwaelde AT cdc.informatik.tu-darmstadt.de>.

**CVE**: [CVE-2011-5034](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-5034) (Apache Geronimo),
[CVE-2011-5035](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-5035) (Oracle Glassfish),
[CVE-2011-4461](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4461) (Jetty),
[CVE-2011-4838](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4838) (JRuby),
[CVE-2011-4885](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4885) (PHP),
[CVE-2011-4462](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4462) (Plone),
[CVE-2011-5036](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-5036) (Rack),
[CVE-2011-4815](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4815) (Ruby),
[CVE-2011-4858](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4858) (Apache Tomcat),
[CVE-2011-5037](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-5037) (V8 JavaScript Engine)

**Timeline**:

2011-09-25: vulnerability report received, reporters set embargo date to December 27th

2011-10-18: contacted maintainers of Apache Tomcat, Apache Geronimo, Jetty, Java, Plone, Zope, V8

2011-11-01: contacted maintainers of Ruby on Rails, Ruby, Python, PHP

2011-11-01: contacted affected distributions

2011-11-02: contacted JRuby maintainer

2011-12-13: contacted Ruby Installer maintainer

2011-12-14: assigned CVE for Ruby

2011-12-15: assigned CVE for JRuby

2011-12-13: contacted Rack maintainer

2011-12-16: assigned CVE for Apache Tomcat

2011-12-21: assigned CVE for PHP

2011-12-28: advisory release

2011-12-29: updated information about Rack affected/fixed versions

2011-12-30: assigned CVEs for Apache Geronimo, Oracle Glassfish, Rack, V8 JavaScript Engine

2012-01-03: corrected Apache Tomcat CVE reference

2012-01-17: updated information about Jetty affected/fixed versions

2012-01-17: updated information about Oracle Glassfish fixed versions

2012-02-27: updated information about Python fixed versions

**References**:

<http://www.nruns.com/_downloads/advisory28122011.pdf>

<http://www.cs.rice.edu/~scrosby/hash/CrosbyWallach_UsenixSec2003.pdf>

<http://svn.php.net/viewvc?view=revision&revision=321003> (unstable, not final)

<http://svn.php.net/viewvc?view=revision&revision=321040> (unstable, not final)

<https://gist.github.com/52bbc6b9cc19ce330829>


