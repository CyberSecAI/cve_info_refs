The provided content is related to CVE-2011-5097.

**Root cause of vulnerability:**
The vulnerability stems from the lack of proper access control in the Chef server API, specifically regarding cookbook uploads and deletions. Non-admin users were able to upload and delete cookbooks, which they should not have been allowed to do.

**Weaknesses/vulnerabilities present:**
- Inadequate access control.
- Privilege escalation (non-admin users performing admin-level actions).

**Impact of exploitation:**
- Unauthorized modification of system configurations.
- Potential for denial of service.
- Compromise of server integrity by non-administrative users.

**Attack vectors:**
- Network access to the Chef server API.
- Malicious non-admin user.

**Required attacker capabilities/position:**
- Must be a valid non-admin user.
- Must have network access to the Chef server API.

**Technical Details:**
The commit introduces access control checks in `chef-server-api/app/controllers/cookbooks.rb` to restrict cookbook updates and deletes to admin users only. It also updates feature tests in `features/api/cookbooks/` to test this change:
- `cookbooks.rb`:  The line `before :is_admin, :only => [ :update, :destroy ]` is added, which means the `:is_admin` authentication check is now performed before the `update` and `destroy` actions on cookbooks are performed.
- `delete_cookbooks.feature`: Tests were added to ensure non-admin users receive a "403 Forbidden" error when attempting to delete a cookbook.
- `upload_cookbooks.feature`: Tests were added to ensure non-admin users receive a "403 Forbidden" error when attempting to upload/create a cookbook.
- `env.rb`: The script to upload the fixture cookbooks was updated to use the webui client to mimic the tests and reduce errors.