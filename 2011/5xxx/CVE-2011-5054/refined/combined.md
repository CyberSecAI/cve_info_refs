=== Content from openwall.com_f667b638_20250124_134620.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4EDF77A4.50600@kde.org>
Date: Wed, 07 Dec 2011 09:26:44 -0500
From: Jeff Mitchell <mitchell@....org>
To: oss-security@...ts.openwall.com
CC: cve@...re.org
Subject: Disputing CVE-2011-4122

Hello,

I've been asked by the kcheckpass maintainer to lodge a dispute of
CVE-2011-4122.

As explained in the blog entry linked from the CVE[1], the problem is
that neither kcheckpass nor OpenPAM validate the 'service_name' input
argument of pam_start(). This hole can be used to make PAM load
arbitrary shared libraries, which can be used to execute arbitrary code
as root, as kcheckpass is setuid root.

One could assume that kcheckpass should do the validation. However, the
PAM documentation makes no mention of what a service name is supposed to
look like, and consequently it must be treated as opaque by the
application code. Therefore all validation must be expected to be done
by the library, and failure to do so must be seen as a bug in the
library exclusively.

As a result, it is correct to list kcheckpass as an affected
application, but not as the origin of the vulnerability. The linked
advisories from ISS and Secunia are clearer about that.

Thanks,
Jeff

[1]: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4122>

Download attachment "[signature.asc](3/1)" of type "application/pgp-signature" (260 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_7e61bed9_20250124_134621.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[<thread-prev]](../../../2011/12/28/5) [[thread-next>]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20120102121523.GA17440@ugly.local>
Date: Mon, 2 Jan 2012 13:15:23 +0100
From: Oswald Buddenhagen <ossi@....org>
To: Solar Designer <solar@...nwall.com>
Cc: Jeff Mitchell <mitchell@....org>, oss-security@...ts.openwall.com,
	cve@...re.org
Subject: Re: Disputing CVE-2011-4122

On Wed, Dec 28, 2011 at 03:25:09AM +0400, Solar Designer wrote:
> On Mon, Dec 26, 2011 at 11:39:55PM -0500, Jeff Mitchell wrote:
> > So kcheckpass, at least for the moment, punts all of this down to
> > OpenPAM. Is it *nice*? No. Is it *valid*? Yes, unless OpenPAM changes
> > its programming guide to require sanity checking of inputs at a higher
> > level (and then it should still do its own checking anyways).
>
> Sure, but is it valid and not a vulnerability when installing a package
> (containing kcheckpass) unexpectedly (for a sysadmin) lets any user on
> the system
> invoke any of the configured PAM stacks, some of which may have
> side-effects?
>
i pondered this possibility when i initially added the override
parameter to kcheckpass, but i couldn't come up with anything usefully
exploitable - it would have to be some right which is granted to the
user *only* by this particular service - but not full logins. this seems
a bit far-fetched. so while you have a valid point in principle, it
doesn't seem particularly relevant for desktop systems.

fwiw, linux-pam's pam_unix has an own setuid helper for shadow pw
verification for some time now. most services don't actually need root
for authentication at all. consequently, it is usually not useful to
install kcheckpass setuid root at all, which makes this whole discussion
somewhat irrelevant in the first place (except that the upstream
makefiles will still try to install with setuid root).

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_c86e47ec_20250124_134621.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2011/12/28/1) [[<thread-prev]](1) [[thread-next>]](../../../2011/12/28/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20111227232509.GA832@openwall.com>
Date: Wed, 28 Dec 2011 03:25:09 +0400
From: Solar Designer <solar@...nwall.com>
To: Jeff Mitchell <mitchell@....org>
Cc: oss-security@...ts.openwall.com, cve@...re.org, ossi@....org
Subject: Re: Disputing CVE-2011-4122

On Mon, Dec 26, 2011 at 11:39:55PM -0500, Jeff Mitchell wrote:
> So kcheckpass, at least for the moment, punts all of this down to
> OpenPAM. Is it *nice*? No. Is it *valid*? Yes, unless OpenPAM changes
> its programming guide to require sanity checking of inputs at a higher
> level (and then it should still do its own checking anyways).

Sure, but is it valid and not a vulnerability when installing a package
(containing kcheckpass) unexpectedly (for a sysadmin) lets any user on
the system invoke any of the configured PAM stacks, some of which may
have side-effects?

I think it is not valid, and I think it is a vulnerability on its own,
albeit a relatively minor one, regardless of PAM's pam_start() service
name directory traversal possibility or lack thereof.

In other words, I say that kcheckpass is vulnerable (in this different
way) even on systems that don't use OpenPAM (or that use fixed OpenPAM).

> That's the basis for the maintainer wanting to challenge this CVE. Even
> if everyone agrees that kcheckpass should do some kind of filtering of
> service names, the fact remains that OpenPAM should have been doing its
> own sanity checking anyways (since it should never simply trust user
> input), and OpenPAM wasn't. If it wasn't kcheckpass that exposed this
> problem, it would eventually have been something else.

Like I said before, this definitely makes some sense to me.  The service
name was not supposed to be user input, though.  Normally, the same
application provides the service name and cares about the authentication
result, so it would not reasonably let the user choose the service name
arbitrarily (as that would also let the user affect the authentication
result in possibly unintended ways).  We have a rare exception here,
where the authentication result actually does not matter to kcheckpass
itself, but matters to another application - one in control of the
supplied service name.  OK, that's a peculiar exception and a somewhat
valid use case, and I fully support the OpenPAM hardening change that
this prompted.

> I'll happily pass your comments along to the kcheckpass maintainer, and
> he indicated to me during our discussions that some level of filtering
> would probably be appropriate, but this CVE is due to OpenPAM's lack of
> sanity checking and blaming the program that exposes it via valid (if
> ugly) usage scenarios is misguided.

We need two CVE ids then - one for OpenPAM, the other for the kcheckpass
issue (namely, letting a user run arbitrary PAM stacks, including those
that a sysadmin may never have intended for the user to be able to run).

Makes sense?

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_45cc31b8_20250124_134621.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[<thread-prev]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20120102181157.GA24173@openwall.com>
Date: Mon, 2 Jan 2012 22:11:57 +0400
From: Solar Designer <solar@...nwall.com>
To: Oswald Buddenhagen <ossi@....org>
Cc: Jeff Mitchell <mitchell@....org>, oss-security@...ts.openwall.com,
	cve@...re.org
Subject: Re: Disputing CVE-2011-4122

On Mon, Jan 02, 2012 at 01:15:23PM +0100, Oswald Buddenhagen wrote:
> On Wed, Dec 28, 2011 at 03:25:09AM +0400, Solar Designer wrote:
> > ... is it valid and not a vulnerability when installing a package
> > (containing kcheckpass) unexpectedly (for a sysadmin) lets any user on
> > the system invoke any of the configured PAM stacks, some of which may
> > have side-effects?
>
> i pondered this possibility when i initially added the override
> parameter to kcheckpass, but i couldn't come up with anything usefully
> exploitable - it would have to be some right which is granted to the
> user *only* by this particular service - but not full logins.

The side-effects don't necessarily have to involve a right being granted
to the user.  They may be, for example, connections made to external
authentication servers (increasing load on those, etc.), log file
records being made, notifications being sent to external servers or to
sysadmins, a resource being consumed (e.g., successful authentication
for a certain heavy service may count towards a configured maximum
number of concurrent uses).  Then, a certain PAM module may trust, say,
an environment variable assuming that the corresponding PAM stacks are
never used from SUID/SGID programs - an assumption that you break.

> this seems
> a bit far-fetched. so while you have a valid point in principle,

Yes, a bit far-fetched.  Yet for an upstream piece of software, you have
to consider issues like that.

> it doesn't seem particularly relevant for desktop systems.

Just because a piece of software is intended for desktop systems doesn't
mean it will only be installed on such.  It is not too uncommon to have
extra/unneeded packages installed on servers.  This indicates a sloppy
sysadmin practice, yet as an upstream author you need to ensure that
your own software doesn't make things worse if installed on a server.
Also, some servers actually have GUI desktops as well on purpose (e.g.,
to accommodate GUI installers and configuration tools of applications
that are actually needed on the server).

> fwiw, linux-pam's pam_unix has an own setuid helper for shadow pw
> verification for some time now. most services don't actually need root
> for authentication at all. consequently, it is usually not useful to
> install kcheckpass setuid root at all, which makes this whole discussion
> somewhat irrelevant in the first place (except that the upstream
> makefiles will still try to install with setuid root).

Yes, but this exception you mention (the upstream Makefiles installing
the program SUID root) is a sufficient reason to have this discussion.

Thanks,

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from c-skills.blogspot.com_95992c66_20250124_134620.html ===


[skip to main](#main)  |
[skip to sidebar](#sidebar)

# [C-skills](https://c-skills.blogspot.com/)

## Tuesday, November 8, 2011

### openpam trickery

While reviewing an entirely different server side component

of some code, I came across a funny vulnerability inside

**OpenPAM** (note that this is different from Linux-PAM)

as used in **FreeBSD** or **Solaris**. Yet, I only tested it on

a *FreeBSD 8.1* machine. The bug is that a program,

namely *kcheckpass*, which is suid to root, is calling

*pam\_start()*with a user provided argument which makes

the PAM stack parse user owned

config files which ends in loading of user

provided DSO's. WTF?!

Interestingly, **OpenPAM** recently introduced a filter for

the service name via

<http://trac.des.no/openpam/changeset/478/trunk/lib/openpam_configure.c>

commit but I dont think that any BSD or so vendor is

aware of it.

A really trivial PoC exploit can be found [here.](http://stealth.openwall.net/xSports/pamslam)

[Update:] **Solaris** is not using **OpenPAM** (at least the **OpenSolaris**

version I checked), but I could not find code that strips

off certain character sequences. As the PAM setup is different

from the */etc/pam.d* we know it is possible that there are no

consequences if the service argument is not filtered.

However a lot of BSD derivates

use **OpenPAM** and **OSX** as well. The question is whether one can

find a vector different than the *kcheckpass* which is usually

found with all **KDE3** and **KDE4** installs.

If you can confirm vulnerability on any **Solaris** or non-**FreeBSD**

machine, please let me know. Also if you found out how **OSX**

can be exploited this way.

Posted by

[Sebastian](https://www.blogger.com/profile/11886596387140041622 "author profile")

at

[7:51 AM](https://c-skills.blogspot.com/2011/11/openpam-trickery.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/3606809368389861108/2842417537336983899 "Email Post")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=3606809368389861108&postID=2842417537336983899&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=3606809368389861108&postID=2842417537336983899&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=3606809368389861108&postID=2842417537336983899&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=3606809368389861108&postID=2842417537336983899&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=3606809368389861108&postID=2842417537336983899&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=3606809368389861108&postID=2842417537336983899&target=pinterest "Share to Pinterest")

#### 4 comments:

[Unknown](https://www.blogger.com/profile/17498929698193865496)
said...

The bug is in kcheckpass, not in OpenPAM. It should not allow the user to specify which policy to use.

BTW, I'm pretty sure FreeBSD's libpam maintainer is aware of recent changes in OpenPAM, but he has a policy of only importing official releases unless there is a critical bug that needs fixing.

[November 19, 2011 at 5:21 PM](https://c-skills.blogspot.com/2011/11/openpam-trickery.html?showComment=1321752092707#c1145514649341066691 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3606809368389861108&postID=1145514649341066691 "Delete Comment")

[Sebastian](https://www.blogger.com/profile/11886596387140041622)
said...

Hi DES,

Indeed thats a point. Actually
such vulnerabilities exist because
its unclear who is responsible
for input cleaning.
FWIW, The same bug exists in squid and
squid3 package.

[November 20, 2011 at 11:59 PM](https://c-skills.blogspot.com/2011/11/openpam-trickery.html?showComment=1321862354827#c4311161476893487888 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3606809368389861108&postID=4311161476893487888 "Delete Comment")

[Unknown](https://www.blogger.com/profile/17498929698193865496)
said...

BTW, I'd like your opinion on [this patch](http://trac.des.no/openpam/changeset/493), which should alleviate the issue. I'm considering introducing similar restrictions on policy files.

[November 21, 2011 at 12:02 AM](https://c-skills.blogspot.com/2011/11/openpam-trickery.html?showComment=1321862536482#c1914982638430731955 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3606809368389861108&postID=1914982638430731955 "Delete Comment")

[Unknown](https://www.blogger.com/profile/17498929698193865496)
said...

Changesets [496 and 497](http://trac.des.no/openpam/changeset?old_path=%2Ftrunk&old=495&new_path=%2Ftrunk&new=497) should further improve matters.

[November 21, 2011 at 8:31 AM](https://c-skills.blogspot.com/2011/11/openpam-trickery.html?showComment=1321893111220#c1456369850876624352 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=3606809368389861108&postID=1456369850876624352 "Delete Comment")

[Post a Comment](https://www.blogger.com/comment/fullpage/post/3606809368389861108/2842417537336983899)

[Newer Post](https://c-skills.blogspot.com/2011/11/censorship.html "Newer Post")

[Older Post](https://c-skills.blogspot.com/2011/11/fun-with-git-upload-pack.html "Older Post")

[Home](https://c-skills.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://c-skills.blogspot.com/feeds/2842417537336983899/comments/default)

## Where ya from

## Subscribe To

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fc-skills.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fc-skills.blogspot.com%2Ffeeds%2Fposts%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://c-skills.blogspot.com/feeds/posts/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Posts

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

[![](https://resources.blogblog.com/img/widgets/subscribe-netvibes.png)](https://www.netvibes.com/subscribe.php?url=https%3A%2F%2Fc-skills.blogspot.com%2Ffeeds%2F2842417537336983899%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/widgets/subscribe-yahoo.png)](https://add.my.yahoo.com/content?url=https%3A%2F%2Fc-skills.blogspot.com%2Ffeeds%2F2842417537336983899%2Fcomments%2Fdefault)
[![](https://resources.blogblog.com/img/icon_feed12.png)
Atom](https://c-skills.blogspot.com/feeds/2842417537336983899/comments/default)

![](https://resources.blogblog.com/img/widgets/arrow_dropdown.gif)
![](https://resources.blogblog.com/img/icon_feed12.png)
Comments

## Like c-skills' projects?

![](https://www.paypalobjects.com/de_DE/i/scr/pixel.gif)

## Links/Rechts

* [this](http://c-skills.blogspot.com/)
* [my github](http://github.com/stealth)
* [follow me on twitter](http://twitter.com/steaith)
* [MTU Ninja blog](https://vincent.bernat.ch/en/blog)
* [Geoff Hustons network blog](https://www.potaroo.net/)
* [bits please](https://bits-please.blogspot.de/)
* [my aimful life](http://blog.cr4.sh/)
* [GDR crypto archive](http://scz.bplaced.net)
* [communists computers](https://eser-ddr.de)
* [Top Level Telcos](https://electrospaces.blogspot.com)
* [Kees' codeblog](http://www.outflux.net/blog/)
* [jeffrey carr on cyberwar](https://jeffreycarr.blogspot.com)
* [Nion's blog](https://nion.modprobe.de/blog/)
* [packet foo](https://blog.packet-foo.com/)
* [grugq's hacker opsec](https://grugq.github.io/)
* [c++ blog](https://isocpp.org/blog)
* [frama-C blog](http://blog.frama-c.com/)
* [lcamtuf's](https://lcamtuf.coredump.cx/)
* [Harld Welte's blog](https://laforge.gnumonks.org/weblog/)
* [openbts chronicles](https://openbts.blogspot.de/)
* [google security blog](https://security.googleblog.com)
* [nerdling sapple](https://blog.zx2c4.com/)
* [home.regit.org](https://home.regit.org/)
* [root labs rdist](https://rdist.root.org/)
* [xorl %eax, %eax](https://xorl.wordpress.com/)
* [Trail of Bits](https://trailofbits.com/)
* [Julien's blog](https://blog.cr0.org/)
* [ithilgore's blog](https://sock-raw.org/blog/)
* [Openwall Project](https://openwall.com/)
* [trapkit](https://trapkit.de/)
* [pagetable.com](https://pagetable.com/)
* [grsecurity](https://grsecurity.net/)
* [recurity lablog](https://blog.recurity-labs.com/)
* [Halvars blog](https://addxorrol.blogspot.com/)
* [OSS Security Wiki](https://oss-security.openwall.org/wiki/)
* [Modern C++ stories](https://www.cppstories.com/p/start-here/)
* [C++ Core Guidelines](https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines)
* [phoronix news](https://www.phoronix.com/)
* [coindesk](https://www.coindesk.com/)
* [distrowatch](https://distrowatch.com/)
* [Fefe's blog](https://blog.fefe.de)

## Blog Archive

* ►
  [2024](https://c-skills.blogspot.com/2024/)
  (3)
  + ►
    [September](https://c-skills.blogspot.com/2024/09/)
    (1)
  + ►
    [March](https://c-skills.blogspot.com/2024/03/)
    (2)

* ►
  [2023](https://c-skills.blogspot.com/2023/)
  (6)
  + ►
    [December](https://c-skills.blogspot.com/2023/12/)
    (1)
  + ►
    [November](https://c-skills.blogspot.com/2023/11/)
    (1)
  + ►
    [September](https://c-skills.blogspot.com/2023/09/)
    (1)
  + ►
    [July](https://c-skills.blogspot.com/2023/07/)
    (1)
  + ►
    [March](https://c-skills.blogspot.com/2023/03/)
    (1)
  + ►
    [January](https://c-skills.blogspot.com/2023/01/)
    (1)

* ►
  [2022](https://c-skills.blogspot.com/2022/)
  (5)
  + ►
    [December](https://c-skills.blogspot.com/2022/12/)
    (1)
  + ►
    [November](https://c-skills.blogspot.com/2022/11/)
    (1)
  + ►
    [July](https://c-skills.blogspot.com/2022/07/)
    (1)
  + ►
    [May](https://c-skills.blogspot.com/2022/05/)
    (1)
  + ►
    [February](https://c-skills.blogspot.com/2022/02/)
    (1)

* ►
  [2021](https://c-skills.blogspot.com/2021/)
  (13)
  + ►
    [December](https://c-skills.blogspot.com/2021/12/)
    (1)
  + ►
    [October](https://c-skills.blogspot.com/2021/10/)
    (1)
  + ►
    [August](https://c-skills.blogspot.com/2021/08/)
    (1)
  + ►
    [July](https://c-skills.blogspot.com/2021/07/)
    (1)
  + ►
    [June](https://c-skills.blogspot.com/2021/06/)
    (1)
  + ►
    [May](https://c-skills.blogspot.com/2021/05/)
    (3)
  + ►
    [April](https://c-skills.blogspot.com/2021/04/)
    (1)
  + ►
    [March](https://c-skills.blogspot.com/2021/03/)
    (2)
  + ►
    [January](https://c-skills.blogspot.com/2021/01/)
    (2)

* ►
  [2020](https://c-skills.blogspot.com/2020/)
  (5)
  + ►
    [November](https://c-skills.blogspot.com/2020/11/)
    (2)
  + ►
    [September](https://c-skills.blogspot.com/2020/09/)
    (2)
  + ►
    [January](https://c-skills.blogspot.com/2020/01/)
    (1)

* ►
  [2019](https://c-skills.blogspot.com/2019/)
  (6)
  + ►
    [November](https://c-skills.blogspot.com/2019/11/)
    (1)
  + ►
    [October](https://c-skills.blogspot.com/2019/10/)
    (1)
  + ►
    [July](https://c-skills.blogspot.com/2019/07/)
    (1)
  + ►
    [April](https://c-skills.blogspot.com/2019/04/)
    (1)
  + ►
    [February](https://c-skills.blogspot.com/2019/02/)
    (1)
  + ►
    [January](https://c-skills.blogspot.com/2019/01/)
    (1)

* ►
  [2018](https://c-skills.blogspot.com/2018/)
  (2)
  + ►
    [January](https://c-skills.blogspot.com/2018/01/)
    (2)

* ►
  [2017](https://c-skills.blogspot.com/2017/)
  (9)
  + ►
    [September](https://c-skills.blogspot.com/2017/09/)
    (1)
  + ►
    [June](https://c-skills.blogspot.com/2017/06/)
    (2)
  + ►
    [May](https://c-skills.blogspot.com/2017/05/)
    (2)
  + ►
    [April](https://c-skills.blogspot.com/2017/04/)
    (1)
  + ►
    [March](https://c-skills.blogspot.com/2017/03/)
    (1)
  + ►
    [February](https://c-skills.blogspot.com/2017/02/)
    (2)

* ►
  [2016](https://c-skills.blogspot.com/2016/)
  (8)
  + ►
    [December](https://c-skills.blogspot.com/2016/12/)
    (1)
  + ►
    [August](https://c-skills.blogspot.com/2016/08/)
    (1)
  + ►
    [July](https://c-skills.blogspot.com/2016/07/)
    (1)
  + ►
    [June](https://c-skills.blogspot.com/2016/06/)
    (1)
  + ►
    [May](https://c-skills.blogspot.com/2016/05/)
    (1)
  + ►
    [April](https://c-skills.blogspot.com/2016/04/)
    (1)
  + ►
    [March](https://c-skills.blogspot.com/2016/03/)
    (1)
  + ►
    [January](https://c-skills.blogspot.com/2016/01/)
    (1)

* ►
  [2015](https://c-skills.blogspot.com/2015/)
  (15)
  + ►
    [December](https://c-skills.blogspot.com/2015/12/)
    (3)
  + ►
    [November](https://c-skills.blogspot.com/2015/11/)
    (1)
  + ►
    [October](https://c-skills.blogspot.com/2015/10/)
    (1)
  + ►
    [September](https://c-skills.blogspot.com/2015/09/)
    (3)
  + ►
    [July](https://c-skills.blogspot.com/2015/07/)
    (1)
  + ►
    [June](https://c-skills.blogspot.com/2015/06/)
    (1)
  + ►
    [May](https://c-skills.blogspot.com/2015/05/)
    (2)
  + ►
    [April](https://c-skills.blogspot.com/2015/04/)
    (1)
  + ►
    [March](https://c-skills.blogspot.com/2015/03/)
    (1)
  + ►
    [January](https://c-skills.blogspot.com/2015/01/)
    (1)

* ►
  [2014](https://c-skills.blogspot.com/2014/)
  (12)
  + ►
    [December](https://c-skills.blogspot.com/2014/12/)
    (2)
  + ►
    [October](https://c-skills.blogspot.com/2014/10/)
    (2)
  + ►
    [August](https://c-skills.blogspot.com/2014/08/)
    (1)
  + ►
    [July](https://c-skills.blogspot.com/2014/07/)
    (1)
  + ►
    [May](https://c-skills.blogspot.com/2014/05/)
    (2)
  + ►
    [March](https://c-skills.blogspot.com/2014/03/)
    (2)
  + ►
    [February](https://c-skills.blogspot.com/2014/02/)
    (1)
  + ►
    [January](https://c-skills.blogspot.com/2014/01/)
    (1)

* ►
  [2013](https://c-skills.blogspot.com/2013/)
  (12)
  + ►
    [November](https://c-skills.blogspot.com/2013/11/)
    (1)
  + ►
    [October](https://c-skills.blogspot.com/2013/10/)
    (1)
  + ►
    [September](https://c-skills.blogspot.com/2013/09/)
    (1)
  + ►
    [August](https://c-skills.blogspot.com/2013/08/)
    (1)
  + ►
    [July](https://c-skills.blogspot.com/2013/07/)
    (1)
  + ►
    [June](https://c-skills.blogspot.com/2013/06/)
    (1)
  + ►
    [April](https://c-skills.blogspot.com/2013/04/)
    (2)
  + ►
    [March](https://c-skills.blogspot.com/2013/03/)
    (2)
  + ►
    [February](https://c-skills.blogspot.com/2013/02/)
    (2)

* ►
  [2012](https://c-skills.blogspot.com/2012/)
  (18)
  + ►
    [December](https://c-skills.blogspot.com/2012/12/)
    (1)
  + ►
    [October](https://c-skills.blogspot.com/2012/10/)
    (1)
  + ►
    [September](https://c-skills.blogspot.com/2012/09/)
    (2)
  + ►
    [August](https://c-skills.blogspot.com/2012/08/)
    (1)
  + ►
    [July](https://c-skills.blogspot.com/2012/07/)
    (1)
  + ►
    [June](https://c-skills.blogspot.com/2012/06/)
    (2)
  + ►
    [April](https://c-skills.blogspot.com/2012/04/)
    (2)
  + ►
    [March](https://c-skills.blogspot.com/2012/03/)
    (5)
  + ►
    [February](https://c-skills.blogspot.com/2012/02/)
    (3)

* ▼
  [2011](https://c-skills.blogspot.com/2011/)
  (21)
  + ►
    [December](https://c-skills.blogspot.com/2011/12/)
    (2)
  + ▼
    [November](https://c-skills.blogspot.com/2011/11/)
    (4)
    - [me hubbing and gitting on github](https://c-skills.blogspot.com/2011/11/me-hubbing-and-gitting-on-github.html)
    - [Censorship](https://c-skills.blogspot.com/2011/11/censorship.html)
    - [openpam trickery](https://c-skills.blogspot.com/2011/11/openpam-trickery.html)
    - [Fun with git-upload-pack](https://c-skills.blogspot.com/2011/11/fun-with-git-upload-pack.html)
  + ►
    [October](https://c-skills.blogspot.com/2011/10/)
    (1)
  + ►
    [August](https://c-skills.blogspot.com/2011/08/)
    (3)
  + ►
    [July](https://c-skills.blogspot.com/2011/07/)
    (1)
  + ►
    [June](https://c-skills.blogspot.com/2011/06/)
    (1)
  + ►
    [May](https://c-skills.blogspot.com/2011/05/)
    (1)
  + ►
    [April](https://c-skills.blogspot.com/2011/04/)
    (2)
  + ►
    [March](https://c-skills.blogspot.com/2011/03/)
    (1)
  + ►
    [February](https://c-skills.blogspot.com/2011/02/)
    (3)
  + ►
    [January](https://c-skills.blogspot.com/2011/01/)
    (2)

* ►
  [2010](https://c-skills.blogspot.com/2010/)
  (27)
  + ►
    [December](https://c-skills.blogspot.com/2010/12/)
    (3)
  + ►
    [November](https://c-skills.blogspot.com/2010/11/)
    (2)
  + ►
    [October](https://c-skills.blogspot.com/2010/10/)
    (4)
  + ►
    [September](https://c-skills.blogspot.com/2010/09/)
    (2)
  + ►
    [August](https://c-skills.blogspot.com/2010/08/)
    (2)
  + ►
    [July](https://c-skills.blogspot.com/2010/07/)
    (3)
  + ►
    [June](https://c-skills.blogspot.com/2010/06/)
    (3)
  + ►
    [May](https://c-skills.blogspot.com/2010/05/)
    (2)
  + ►
    [April](https://c-skills.blogspot.com/2010/04/)
    (3)
  + ►
    [March](https://c-skills.blogspot.com/2010/03/)
    (1)
  + ►
    [February](https://c-skills.blogspot.com/2010/02/)
    (2)

* ►
  [2009](https://c-skills.blogspot.com/2009/)
  (29)
  + ►
    [December](https://c-skills.blogspot.com/2009/12/)
    (1)
  + ►
    [November](https://c-skills.blogspot.com/2009/11/)
    (3)
  + ►
    [October](https://c-skills.blogspot.com/2009/10/)
    (2)
  + ►
    [September](https://c-skills.blogspot.com/2009/09/)
    (6)
  + ►
    [August](https://c-skills.blogspot.com/2009/08/)
    (4)
  + ►
    [July](https://c-skills.blogspot.com/2009/07/)
    (3)
  + ►
    [May](https://c-skills.blogspot.com/2009/05/)
    (1)
  + ►
    [April](https://c-skills.blogspot.com/2009/04/)
    (2)
  + ►
    [March](https://c-skills.blogspot.com/2009/03/)
    (3)
  + ►
    [February](https://c-skills.blogspot.com/2009/02/)
    (2)
  + ►
    [January](https://c-skills.blogspot.com/2009/01/)
    (2)

* ►
  [2008](https://c-skills.blogspot.com/2008/)
  (14)
  + ►
    [December](https://c-skills.blogspot.com/2008/12/)
    (1)
  + ►
    [October](https://c-skills.blogspot.com/2008/10/)
    (2)
  + ►
    [August](https://c-skills.blogspot.com/2008/08/)
    (2)
  + ►
    [July](https://c-skills.blogspot.com/2008/07/)
    (1)
  + ►
    [April](https://c-skills.blogspot.com/2008/04/)
    (1)
  + ►
    [March](https://c-skills.blogspot.com/2008/03/)
    (1)
  + ►
    [February](https://c-skills.blogspot.com/2008/02/)
    (2)
  + ►
    [January](https://c-skills.blogspot.com/2008/01/)
    (4)

* ►
  [2007](https://c-skills.blogspot.com/2007/)
  (14)
  + ►
    [November](https://c-skills.blogspot.com/2007/11/)
    (3)
  + ►
    [October](https://c-skills.blogspot.com/2007/10/)
    (2)
  + ►
    [September](https://c-skills.blogspot.com/2007/09/)
    (1)
  + ►
    [August](https://c-skills.blogspot.com/2007/08/)
    (1)
  + ►
    [July](https://c-skills.blogspot.com/2007/07/)
    (2)
  + ►
    [May](https://c-skills.blogspot.com/2007/05/)
    (2)
  + ►
    [April](https://c-skills.blogspot.com/2007/04/)
    (1)
  + ►
    [January](https://c-skills.blogspot.com/2007/01/)
    (2)

## About Me

[![My photo](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgB42G4wRz-qT4NU4cvBE2EmbeWrv5mMoR1zu9EgBcV2WYEP1GB4ilLoqYVF8_moVjsfinmhjO6pmpxp3WUwf22VQ1-Tio1qDzaFcevsFq93OSamvKfE5V3eAveSWadrw/s220/tux-root.png)](https://www.blogger.com/profile/11886596387140041622)
[Sebastian](https://www.blogger.com/profile/11886596387140041622)

Disclaimer: This is my personal and private weblog.
The views expressed
on this website/weblog are mine alone and do not necessarily reflect the views of my employer.

[View my complete profile](https://www.blogger.com/profile/11886596387140041622)

[Impressum/imprint](http://c-skills.blogspot.com/2007/01/good-side-of-spam.html)



=== Content from openwall.com_32941ce0_20250124_134621.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](../../../2011/12/09/1) [[<thread-prev]](8) [[thread-next>]](../../../2011/12/23/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4EE14163.80109@kde.org>
Date: Thu, 08 Dec 2011 17:59:47 -0500
From: Jeff Mitchell <mitchell@....org>
To: oss-security@...ts.openwall.com
CC: Kurt Seifried <kseifried@...hat.com>
Subject: Re: Disputing CVE-2011-4122

On 12/8/2011 4:53 PM, Kurt Seifried wrote:
>
>>
>> The documentation you linked to above is for LinuxPAM, not OpenPAM.
>> They're different systems and the bug only affects OpenPAM.
>>
>> --Jeff
>>
> Right, my thought/comment is more around the point that this isn't
> defined in general very well anywhere (that I can find, and I assume
> OpenPAM and Linux PAM are going to implement things in a roughly similar
> manner) and that it probably should be defined better. In the meantime
> though it is likely that restrictions/filtering can be implemented but
> it needs to be done carefully since there is the potential for weirdness.

Sorry, misunderstood what you were getting at  :-)

Yes, agreed. It should be defined better, and as you pointed out apps
trying to filter or restrict things can be prone to mistakes. Which I
think exactly points out why this CVE is invalid; the lack of real
specification means that an application cannot successfully guess what
is valid, nor is it specified that an application should even try to
make such guesses. Given the current situation, OpenPAM is culpable
here, both for not checking the data it's receiving, and for having a
specification that makes it impossible for upstream apps to properly try
to help out.

--Jeff

Download attachment "[signature.asc](9/1)" of type "application/pgp-signature" (261 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_c5151b3b_20250124_134621.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](../../../2011/12/27/3) [[thread-next>]](../../../2012/01/02/10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20111228084433.GA16259@suse.de>
Date: Wed, 28 Dec 2011 09:44:33 +0100
From: Sebastian Krahmer <krahmer@...e.de>
To: oss-security@...ts.openwall.com
Cc: Jeff Mitchell <mitchell@....org>, ossi@....org
Subject: Re: Disputing CVE-2011-4122

FWIW, one could have also used the pam helper from squid or squid3
which calls pam_start() in the same way.
It is wrong from OpenPAM to blindly trust the service parameter
and append it to /etc/pam.d. In particular since PAM's primary reason
is to bring security, so it should be security-aware.
But its also wrong from applications to pass everything they get
from *users* to pam_start() w/o filtering. That likely hurts the system
policy _at least_. Defensive programming, anyone? :)

regards,
Sebastian

On Wed, Dec 28, 2011 at 03:25:09AM +0400, Solar Designer wrote:
> On Mon, Dec 26, 2011 at 11:39:55PM -0500, Jeff Mitchell wrote:
> > So kcheckpass, at least for the moment, punts all of this down to
> > OpenPAM. Is it *nice*? No. Is it *valid*? Yes, unless OpenPAM changes
> > its programming guide to require sanity checking of inputs at a higher
> > level (and then it should still do its own checking anyways).
>
> Sure, but is it valid and not a vulnerability when installing a package
> (containing kcheckpass) unexpectedly (for a sysadmin) lets any user on
> the system invoke any of the configured PAM stacks, some of which may
> have side-effects?
>
> I think it is not valid, and I think it is a vulnerability on its own,
> albeit a relatively minor one, regardless of PAM's pam_start() service
> name directory traversal possibility or lack thereof.
>
> In other words, I say that kcheckpass is vulnerable (in this different
> way) even on systems that don't use OpenPAM (or that use fixed OpenPAM).
>
> > That's the basis for the maintainer wanting to challenge this CVE. Even
> > if everyone agrees that kcheckpass should do some kind of filtering of
> > service names, the fact remains that OpenPAM should have been doing its
> > own sanity checking anyways (since it should never simply trust user
> > input), and OpenPAM wasn't. If it wasn't kcheckpass that exposed this
> > problem, it would eventually have been something else.
>
> Like I said before, this definitely makes some sense to me.  The service
> name was not supposed to be user input, though.  Normally, the same
> application provides the service name and cares about the authentication
> result, so it would not reasonably let the user choose the service name
> arbitrarily (as that would also let the user affect the authentication
> result in possibly unintended ways).  We have a rare exception here,
> where the authentication result actually does not matter to kcheckpass
> itself, but matters to another application - one in control of the
> supplied service name.  OK, that's a peculiar exception and a somewhat
> valid use case, and I fully support the OpenPAM hardening change that
> this prompted.
>
> > I'll happily pass your comments along to the kcheckpass maintainer, and
> > he indicated to me during our discussions that some level of filtering
> > would probably be appropriate, but this CVE is due to OpenPAM's lack of
> > sanity checking and blaming the program that exposes it via valid (if
> > ugly) usage scenarios is misguided.
>
> We need two CVE ids then - one for OpenPAM, the other for the kcheckpass
> issue (namely, letting a user run arbitrary PAM stacks, including those
> that a sysadmin may never have intended for the user to be able to run).
>
> Makes sense?
>
> Alexander

--

~ perl self.pl
~ $_='print"\$_=\47$_\47;eval"';eval
~ krahmer@...e.de - SuSE Security Team

---
SUSE LINUX Products GmbH,
GF: Jeff Hawn, Jennifer Guild, Felix Imendörffer, HRB 16746 (AG Nürnberg)
Maxfeldstraße 5
90409 Nürnberg
Germany

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_8ef91e3f_20250124_134621.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2011/12/26/3) [[next>]](2) [[<thread-prev]](../../../2011/12/23/8) [[thread-next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4EF94C1B.3070608@kde.org>
Date: Mon, 26 Dec 2011 23:39:55 -0500
From: Jeff Mitchell <mitchell@....org>
To: Solar Designer <solar@...nwall.com>
CC: oss-security@...ts.openwall.com, cve@...re.org, ossi@....org
Subject: Re: Disputing CVE-2011-4122

On 12/23/2011 06:22 PM, Solar Designer wrote:
> On Wed, Dec 07, 2011 at 09:26:44AM -0500, Jeff Mitchell wrote:
>> I've been asked by the kcheckpass maintainer to lodge a dispute of
>> CVE-2011-4122.
>>
>> As explained in the blog entry linked from the CVE[1], the problem is
>> that neither kcheckpass nor OpenPAM validate the 'service_name' input
>> argument of pam_start(). This hole can be used to make PAM load
>> arbitrary shared libraries, which can be used to execute arbitrary code
>> as root, as kcheckpass is setuid root.
>
> Besides loading of arbitrary shared libraries due to the OpenPAM
> peculiarity, doesn't this kcheckpass feature allow a user to specify an
> arbitrary PAM service name that is actually valid on the system, not
> limited to PAM services intended for use by KDE?  Isn't that a
> vulnerability of itself?  While kcheckpass itself doesn't grant access
> to any resource, an alternate PAM stack (maybe only intended for use by
> a specific service) might have modules with side-effects.
>
> To me, kcheckpass looks poorly designed in letting the invoking user
> specify an arbitrary PAM service name.  Instead, the service name should
> either be obtained from a trusted place or it should be checked against
> a trusted whitelist.
>
> For example, passwd(1) from SimplePAMApps does the latter: it has a
> command-line option to specify a PAM service name suffix (which it'd
> append to "passwd"), but the suffix must be whitelisted in
> /etc/security/passwd.conf.

<snip>

My understanding -- and I'm not the maintainer, so I'm typing this based
on my own understanding of the program and this problem from my talks
with the maintainer, whom I've CCed -- is that at a simple level it can
be used for normal PAM user authentication, but that it's also designed
to provide a simple interface to do arbitrary kinds of PAM
authentication depending on user/application needs. For instance, you
when invoking kcheckpass you can not only specify the PAM service name
but can also choose whether to use a stdin-based interface or a file
descriptor handle to communicate with it. So you get access to
authenticate with PAM for PAM services that use passwords but without
having to interface directly with PAM libraries.

This kind of behavior is not restricted within OpenPAM itself, and there
is nothing in the documentation that indicates that such external
accessor programs need to perform any sort of input sanitation on the
service name field. Sure -- ideally you want such programs performing
some kind of sanitation, but then you have to decide, rather than the
application developer using your accessor program, what is appropriate
and what isn't. There are some obvious candidates but a lot of choices
that would be harder.

So kcheckpass, at least for the moment, punts all of this down to
OpenPAM. Is it *nice*? No. Is it *valid*? Yes, unless OpenPAM changes
its programming guide to require sanity checking of inputs at a higher
level (and then it should still do its own checking anyways).

That's the basis for the maintainer wanting to challenge this CVE. Even
if everyone agrees that kcheckpass should do some kind of filtering of
service names, the fact remains that OpenPAM should have been doing its
own sanity checking anyways (since it should never simply trust user
input), and OpenPAM wasn't. If it wasn't kcheckpass that exposed this
problem, it would eventually have been something else.

I'll happily pass your comments along to the kcheckpass maintainer, and
he indicated to me during our discussions that some level of filtering
would probably be appropriate, but this CVE is due to OpenPAM's lack of
sanity checking and blaming the program that exposes it via valid (if
ugly) usage scenarios is misguided.

Thanks,
Jeff

Download attachment "[signature.asc](1/1)" of type "application/pgp-signature" (260 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from openwall.com_77add034_20250124_134621.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](../../../2011/12/24/1) [[<thread-prev]](../../../2011/12/08/9) [[thread-next>]](../../../2011/12/27/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20111223232211.GA20465@openwall.com>
Date: Sat, 24 Dec 2011 03:22:11 +0400
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Cc: Jeff Mitchell <mitchell@....org>, cve@...re.org
Subject: Re: Disputing CVE-2011-4122

On Wed, Dec 07, 2011 at 09:26:44AM -0500, Jeff Mitchell wrote:
> I've been asked by the kcheckpass maintainer to lodge a dispute of
> CVE-2011-4122.
>
> As explained in the blog entry linked from the CVE[1], the problem is
> that neither kcheckpass nor OpenPAM validate the 'service_name' input
> argument of pam_start(). This hole can be used to make PAM load
> arbitrary shared libraries, which can be used to execute arbitrary code
> as root, as kcheckpass is setuid root.

Besides loading of arbitrary shared libraries due to the OpenPAM
peculiarity, doesn't this kcheckpass feature allow a user to specify an
arbitrary PAM service name that is actually valid on the system, not
limited to PAM services intended for use by KDE?  Isn't that a
vulnerability of itself?  While kcheckpass itself doesn't grant access
to any resource, an alternate PAM stack (maybe only intended for use by
a specific service) might have modules with side-effects.

To me, kcheckpass looks poorly designed in letting the invoking user
specify an arbitrary PAM service name.  Instead, the service name should
either be obtained from a trusted place or it should be checked against
a trusted whitelist.

For example, passwd(1) from SimplePAMApps does the latter: it has a
command-line option to specify a PAM service name suffix (which it'd
append to "passwd"), but the suffix must be whitelisted in
/etc/security/passwd.conf.

> One could assume that kcheckpass should do the validation. However, the
> PAM documentation makes no mention of what a service name is supposed to
> look like, and consequently it must be treated as opaque by the
> application code. Therefore all validation must be expected to be done
> by the library, and failure to do so must be seen as a bug in the
> library exclusively.

These are some valid points, but on the other hand giving an untrusted
user full control over the PAM service name is so ridiculous that I
can't blame a PAM library exclusively for not sanitizing this input.

I think we'd set a bad precedent by saying that kcheckpass did
everything right and only OpenPAM was at fault.  I think that both need
to be corrected.  OpenPAM is already patched by now; is kcheckpass
corrected in some way as well?

[http://security.freebsd.org/advisories/FreeBSD-SA-11:10.pam.asc](http://security.freebsd.org/advisories/FreeBSD-SA-11%3A10.pam.asc)

> As a result, it is correct to list kcheckpass as an affected
> application, but not as the origin of the vulnerability.

My opinion is that the vulnerability originates in both places, or we
can say that there's more than one vulnerability here.  If I had to
choose just one, I'd say that kcheckpass is more at fault than OpenPAM,
and that OpenPAM's fix is a hardening measure, whereas kcheckpass needs
to have its vulnerability fixed.

I am not affiliated with either project; in fact, I am not even using
KDE and OpenPAM normally.

I am of a similar opinion regarding other cases where poorly written or
misconfigured applications expose library interfaces that were never
meant to be used on untrusted input.  For example, the "glibc: timezone
integer overflow" issue that was brought to this list earlier this month
is in my opinion less of an issue than FTP server misconfiguration that
makes the issue exploitable.  That is, I'd rather assign CVE ids to FTP
servers supporting chroot'ing into users' home directories without
warning the server admins of the added root compromise risk inherent to
such chroot'ing.  Patching one attack vector in glibc does not eliminate
that risk.

<http://www.openwall.com/lists/oss-security/2011/12/05/1>

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


