=== Content from www.redhat.com_6bc00218_20250126_021733.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from downloads.avaya.com_0c64ec78_20250124_163909.html ===


---

firefox security and bug fix update (RHSA-2011-0310)

Original Release Date: April 11, 2011

Last Revised: February 5, 2013

Number: ASA-2011-093

Risk Level: Low

Advisory Version: 2.0

Advisory Status: Final

---

## 1. Overview:

Mozilla Firefox is an open source web browser. XULRunner provides the XUL
Runtime environment for Mozilla Firefox.

A flaw was found in the way Firefox sanitized HTML content in extensions.
If an extension loaded or rendered malicious content using the
ParanoidFragmentSink class, it could fail to safely display the content,
causing Firefox to execute arbitrary JavaScript with the privileges of the
user running Firefox.
The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
[CVE-2010-1585](https://www.redhat.com/security/data/cve/CVE-2010-1585.html) to this issue.

A flaw was found in the way Firefox handled dialog boxes. An attacker could
use this flaw to create a malicious web page that would present a blank
dialog box that has non-functioning buttons. If a user closes the dialog
box window, it could unexpectedly grant the malicious web page elevated
privileges.
The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
[CVE-2011-0051](https://www.redhat.com/security/data/cve/CVE-2011-0051.html) to this issue.

Several flaws were found in the processing of malformed web content. A web
page containing malicious content could cause Firefox to crash or,
potentially, execute arbitrary code with the privileges of the user running
Firefox.
The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the names
[CVE-2011-0053](https://www.redhat.com/security/data/cve/CVE-2011-0053.html),
[CVE-2011-0055](https://www.redhat.com/security/data/cve/CVE-2011-0055.html),
[CVE-2011-0058](https://www.redhat.com/security/data/cve/CVE-2011-0058.html) and
[CVE-2011-0062](https://www.redhat.com/security/data/cve/CVE-2011-0062.html) to these issues.

Several flaws were found in the way Firefox handled malformed JavaScript. A
website containing malicious JavaScript could cause Firefox to execute that
JavaScript with the privileges of the user running Firefox.
The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the names
[CVE-2011-0054](https://www.redhat.com/security/data/cve/CVE-2011-0054.html),
[CVE-2011-0056](https://www.redhat.com/security/data/cve/CVE-2011-0056.html) and
[CVE-2011-0057](https://www.redhat.com/security/data/cve/CVE-2011-0057.html) to these issues.

A flaw was found in the way Firefox handled malformed JPEG images. A
website containing a malicious JPEG image could cause Firefox to crash or,
potentially, execute arbitrary code with the privileges of the user running
Firefox.
The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
[CVE-2011-0061](https://www.redhat.com/security/data/cve/CVE-2011-0061.html) to this issue.

A flaw was found in the way Firefox handled plug-ins that perform HTTP
requests. If a plug-in performed an HTTP request, and the server sent a 307
redirect response, the plug-in was not notified, and the HTTP request was
forwarded. The forwarded request could contain custom headers, which could
result in a Cross Site Request Forgery attack.
The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
[CVE-2011-0059](https://www.redhat.com/security/data/cve/CVE-2011-0059.html) to this issue.

More information about these vulnerabilities can be found in the security advisory issued by Red Hat:

* <https://rhn.redhat.com/errata/RHSA-2011-0310.html>

## 2. Avaya System Products using a modified version of RHEL with affected components/packages installed: | Product: | Affected Version(s): | Risk Level: | Actions: | | --- | --- | --- | --- | | Avaya Communication Server 1000: * CS1000E * CS1000M * CS1000E/CS1000M Signaling Server | 7.0 and 7.5 | None | See mitigating factors. | | Avaya IQ | 4.0.x through 5.1.x | None | See mitigating factors. | | Avaya Message Networking | 3.1, 5.2 thru 5.2.3 | Low | Upgrade to 5.2.4 or later. | | Avaya Messaging Storage Server | 3.1, 5.2 thru 5.2.9 | Low | Upgrade to 5.2.10 or later. | | Avaya Aura™ Presence Services | 6.0, 6.1, 6.1.1 | Low | Upgrade to 6.1.2 or later. | | Avaya Aura™ Session Manager | 1.1, 5.2.x, 6.0.x, 6.1 thru 6.1.2 | Low | Upgrade to 6.1.3 or later. | | Avaya Aura™ System Manager | 5.2.x, 6.0.x, 6.1.x | Low | Upgrade to 6.2 or later. |

**Recommended Actions for System Products:**
Avaya strongly recommends that customers follow
networking and security best practices by implementing
firewalls, ACLs, physical security or other appropriate
access restrictions. Though Avaya believes such
restrictions should always be in place, risk to Avaya
products and the surrounding network from this potential
vulnerability may be mitigated by ensuring these
practices are implemented until such time as an Avaya provided
product update or the recommended Avaya action is applied.
Further restrictions as deemed necessary based on the
customer's security policies may be required during this
interim period, but customers should not modify the System Product
operating system or application unless the change is approved by Avaya.
Making changes that are not approved may void the Avaya product service contract.

### Mitigating Factors:

When determining risk, Avaya takes into account many factors as
outlined by Avaya's
[Security Vulnerability Classification Policy](https://support.avaya.com/css/P8/documents/100066674).
The following table describes factors that mitigate the risk of specific
vulnerabilities for affected Avaya products:

| Vulnerability | Mitigating Factors |
| --- | --- |
| CVE-2010-1585 CVE-2011-0051 CVE-2011-0053 CVE-2011-0054 CVE-2011-0055 CVE-2011-0056 CVE-2011-0057 CVE-2011-0058 CVE-2011-0059 CVE-2011-0061 CVE-2011-0062 | These are a Low for MN, MSS, PS, SM and SMGR as it would require non-standrard direct user interaction. There is no risk to IQ and CS1000 as firefox is not installed, only xulrunner. |

## 3. Avaya Software-Only Products:

Avaya software-only products operate on general-purpose operating systems.
Occasionally vulnerabilities may be discovered in the underlying operating system or
applications that come with the operating system. These vulnerabilities often do not
impact the software-only product directly but may threaten the integrity of the
underlying platform.

In the case of this advisory Avaya software-only products are not affected by the
vulnerability directly but the underlying Linux platform may be. Customers should
determine on which Linux operating system the product was installed and then follow
that vendor's guidance.

| Product: | Actions: |
| --- | --- |
| Avaya Aura™ Application Enablement Services 4.x/5.x | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the AES application. |
| CVLAN | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the CVLAN application. |
| Avaya Integrated Management Suite (IMS) | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the IMS application. |
| Avaya Aura™ Presence Services | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the PS application. |
| Avaya Aura™ System Manager 1.0 | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the SMGR application. |
| Voice Portal | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the Voice Portal application. |

**Recommended Actions for Software-Only Products:**
In the event that the affected package is installed, Avaya recommends that customers follow recommended actions supplied by Red Hat regarding their Enterprise Linux.

## 4. Additional Information:

Additional information may also be available via the Avaya support
[website](http://support.avaya.com) and through your Avaya
account representative. Please contact your Avaya product support
representative, or dial 1-800-242-2121, with any questions.

## 5. Disclaimer:

ALL INFORMATION IS BELIEVED TO BE CORRECT AT THE TIME OF PUBLICATION
AND IS PROVIDED "AS IS". AVAYA INC., ON BEHALF ITSELF AND ITS
SUBSIDIARIES AND AFFILIATES (HEREINAFTER COLLECTIVELY REFERRED TO AS
"AVAYA"), DISCLAIMS ALL WARRANTIES, EITHER EXPRESS OR IMPLIED,
INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE AND FURTHERMORE, AVAYA MAKES NO REPRESENTATIONS
OR WARRANTIES THAT THE STEPS RECOMMENDED WILL ELIMINATE SECURITY OR VIRUS
THREATS TO CUSTOMERS' SYSTEMS. IN NO EVENT SHALL AVAYA BE LIABLE FOR ANY
DAMAGES WHATSOEVER ARISING OUT OF OR IN CONNECTION WITH THE INFORMATION OR
RECOMMENDED ACTIONS PROVIDED HEREIN, INCLUDING DIRECT, INDIRECT, INCIDENTAL,
STATUTORY, CONSEQUENTIAL DAMAGES, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES,
EVEN IF AVAYA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

THE INFORMATION PROVIDED HERE DOES NOT AFFECT THE SUPPORT AGREEMENTS
IN PLACE FOR AVAYA PRODUCTS. SUPPORT FOR AVAYA PRODUCTS CONTINUES TO BE
EXECUTED AS PER EXISTING AGREEMENTS WITH AVAYA.

## 6. Revision History:

V 1.0 - April 11, 2011 - Initial Statement issued.

V 2.0 - February 5, 2013 - Updated affected versions and actions for MN, MSS, SM and SMGR. Changed CS1000 and IQ to no risk and advisory to final.

Send information regarding any discovered security problems with Avaya
products to either the contact noted in the product's documentation or
securityalerts@avaya.com.

Linux® is the registered trademark of Linus Torvalds in the U.S. and other countries.

© 2011 Avaya Inc. All Rights Reserved. All trademarks identifying Avaya products by the ® or ™ are registered trademarks or trademarks, respectively, of Avaya Inc. All other trademarks are the property of their respective owners.



=== Content from bugzilla.mozilla.org_ad47e9d8_20250124_163925.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/596232)
* [XML](/show_bug.cgi?ctype=xml&id=596232)

Closed
[Bug 596232](/show_bug.cgi?id=596232)

Opened 14 years ago
Closed 14 years ago

# nsXULTemplateBuilder/nsXULTemplateQueryProcessorXML load new data sources at unsafe time

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

nsXULTemplateBuilder/nsXULTemplateQueryProcessorXML load new data sources at unsafe time

## Categories

### (Core :: XUL, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XUL#XUL)

XUL
▾

Core :: XUL

For bugs in the [XUL
language](http://www.mozilla.org/xpfe/xptoolkit/xulintro.html). (XUL is an XML-based language which specifies Mozilla's user interface.)

If you're not actually writing XUL code, this is probably not the right place for your bug.

Examples of appropriate bugs: Duplicate window ID causes infinite loop; or Scrollbars disappear after loading XUL document

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XUL&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XUL&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XUL)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [-](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=-) |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | - |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: smaug, Assigned: enndeakin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9e62c36c6c16218485bdb90fe88d63e?d=mm&size=40)  [enndeakin](/user_profile?user_id=6102)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/c9e62c36c6c16218485bdb90fe88d63e?d=mm&size=40)  [enndeakin](/user_profile?user_id=6102)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[608687](/show_bug.cgi?id=608687 "VERIFIED FIXED - <rule>-generated toolbar items are cloned when leaving toolbar customize")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=596232&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=596232)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [sg:critical?] for 1.9.2 and earlier)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?] for 1.9.2 and earlier

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [add checks](/attachment.cgi?id=479407)  [14 years ago](#c3)  [Neil Deakin](/user_profile?user_id=6102)   3.68 KB, patch | smaug : [review+](#a1299659_39966 "14 years ago")  christian : [approval1.9.2.14+](#c17 "14 years ago") | [Details](/attachment.cgi?id=479407&action=edit) | [Diff](/attachment.cgi?id=479407&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=479407) |
| --- | --- | --- |
| [trunk version](/attachment.cgi?id=485290)  [14 years ago](#c10)  [Neil Deakin](/user_profile?user_id=6102)   4.62 KB, patch | smaug : [review+](#a3546898_39966 "14 years ago") | [Details](/attachment.cgi?id=485290&action=edit) | [Diff](/attachment.cgi?id=485290&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=485290) |
| [1.9.1 with extra include](/attachment.cgi?id=505815)  [14 years ago](#c19)  [Neil Deakin](/user_profile?user_id=6102)   4.18 KB, patch | christian : [approval1.9.1.17+](#c20 "14 years ago") | [Details](/attachment.cgi?id=505815&action=edit) | [Diff](/attachment.cgi?id=505815&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=505815) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=596232#c0)• 14 years ago |
|  | |

nsEventDispatcher::Dispatch [content/events/src/nsEventDispatcher.cpp:515]
nsEventDispatcher::DispatchDOMEvent [content/events/src/nsEventDispatcher.cpp:691]
nsDOMEventTargetHelper::DispatchDOMEvent [content/events/src/nsDOMEventTargetHelper.cpp:230]
nsXMLHttpRequest::ChangeState [content/base/src/nsXMLHttpRequest.cpp:3000]
nsXMLHttpRequest::OpenRequest [content/base/src/nsXMLHttpRequest.cpp:1793]
nsXULTemplateQueryProcessorXML::GetDatasource [content/xul/templates/src/nsXULTemplateQueryProcessorXML.cpp:221]
nsXULTemplateBuilder::LoadDataSourceUrls [content/xul/templates/src/nsXULTemplateBuilder.cpp:1365]
nsXULTemplateBuilder::LoadDataSources [content/xul/templates/src/nsXULTemplateBuilder.cpp:1263]
nsXULTemplateBuilder::AttributeChanged [content/xul/templates/src/nsXULTemplateBuilder.cpp:1140]
nsXULContentBuilder::AttributeChanged [content/xul/templates/src/nsXULContentBuilder.cpp:1591]
nsNodeUtils::AttributeChanged [content/base/src/nsNodeUtils.cpp:127]
nsGenericElement::SetAttrAndNotify [content/base/src/nsGenericElement.cpp:4688]
nsGenericElement::SetAttr [content/base/src/nsGenericElement.cpp:4622]
nsGenericElement::SetAttribute [content/base/src/nsGenericElement.cpp:2400]
nsXULElement::SetAttribute [content/xul/content/src/nsXULElement.h:561]
nsIDOMElement\_SetAttribute [dom\_quickstubs.cpp:4918]
This bug is basically a clone of [bug 553808](/show_bug.cgi?id=553808 "VERIFIED FIXED - mochitest-chrome: test_tmpl_errors.xul causes 3 \"ASSERTION: This is unsafe! Fix the caller!: 'Error', file .../nsEventDispatcher.cpp, line 514\" in a row").

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=596232#c1)• 14 years ago |
|  | |

Not sure if web content can access this code on trunk, but on branches
it should be able to.
The following methods may have security problems
nsXULTemplateBuilder::AttributeChanged
nsXULTemplateBuilder::ContentRemoved
nsXULTemplateBuilder::NodeWillBeDestroyed

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a311_39966)• 14 years ago |

blocking1.9.1: --- → ?blocking1.9.2: --- → ?blocking2.0: --- → ?

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a13243_11608)• 14 years ago |

Whiteboard: [sg:critical?] for 1.9.2 and earlier

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a205385_7044)• 14 years ago |

blocking2.0: ? → -

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a268128_1689)• 14 years ago |

blocking1.9.1: ? → neededblocking1.9.2: ? → needed
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=596232#c2)• 14 years ago |
|  | |

[Bug 553808](/show_bug.cgi?id=553808 "VERIFIED FIXED - mochitest-chrome: test_tmpl_errors.xul causes 3 \"ASSERTION: This is unsafe! Fix the caller!: 'Error', file .../nsEventDispatcher.cpp, line 514\" in a row") was assigned to you Neil. Might be safer to fix it here.
Sorry that I haven't fixed that bug, but the original tbox log hasif y long gone
and there were no new reports about it for awhile.
Anyway, Neil, you know this code a lot better than I do.
But just say if you don't have time. I could try to look at this too.
(But you'd have to review the patch carefully ;) )

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a624719_1689)• 14 years ago |

Assignee: nobody → enndeakin

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=596232#c3)• 14 years ago |
|  | |

Attached patch

[add checks](attachment.cgi?id=479407&action=diff)
— [Details](attachment.cgi?id=479407&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=479407)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a1297560_6102)• 14 years ago |

[Attachment #479407](/attachment.cgi?id=479407&action=edit "add checks") -
Flags: review?(Olli.Pettay)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a1299659_39966)• 14 years ago |

[Attachment #479407](/attachment.cgi?id=479407&action=edit "add checks") -
Flags: review?(Olli.Pettay) → review+

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a1302834_6102)• 14 years ago |

[Attachment #479407](/attachment.cgi?id=479407&action=edit "add checks") -
Flags: approval1.9.2.11?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=596232#c4)• 14 years ago |
|  | |

Comment on [attachment 479407](/attachment.cgi?id=479407 "add checks") [[details]](/attachment.cgi?id=479407&action=edit "add checks") [[diff]](/attachment.cgi?id=479407&action=diff "add checks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=479407)
add checks
1.9.2.11 is past code-freeze, moving request to next release.
[Attachment #479407](/attachment.cgi?id=479407&action=edit "add checks") -
Flags: approval1.9.2.11? → approval1.9.2.12?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=596232#c5)• 14 years ago |
|  | |

Comment on [attachment 479407](/attachment.cgi?id=479407 "add checks") [[details]](/attachment.cgi?id=479407&action=edit "add checks") [[diff]](/attachment.cgi?id=479407&action=diff "add checks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=479407)
add checks
Approved for 1.9.2.12, a=dveditz for release-drivers
[Attachment #479407](/attachment.cgi?id=479407&action=edit "add checks") -
Flags: approval1.9.2.12? → approval1.9.2.12+

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=596232#c6)• 14 years ago |
|  | |

So, this just needs to be landed and tested/confirmed.

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a2469496_6102)• 14 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=596232#c7)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/c7a429d62c81>

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=596232#c8)• 14 years ago |
|  | |

Can we close this?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=596232#c9)• 14 years ago |
|  | |

Do we want to fix this problem on trunk as well? It may no longer be a security worry, but presumably we--or an addon--could stumble across this as a stability problem.
Does this patch work for trunk? Do we need a different patch for 1.9.1?
Marking status1.9.2 as .12-fixed per [comment 7](/show_bug.cgi?id=596232#c7 "RESOLVED FIXED - nsXULTemplateBuilder/nsXULTemplateQueryProcessorXML load new data sources at unsafe time")
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.12-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.12-fixed)

|  | [Karl Tomlinson (:karlt)](/user_profile?user_id=274246) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a3234433_274246)• 14 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=596232#c10)• 14 years ago |
|  | |

Attached patch

[trunk version](attachment.cgi?id=485290&action=diff)
— [Details](attachment.cgi?id=485290&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=485290)

[Attachment #485290](/attachment.cgi?id=485290&action=edit "trunk version") -
Flags: review?(Olli.Pettay)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a3546898_39966)• 14 years ago |

[Attachment #485290](/attachment.cgi?id=485290&action=edit "trunk version") -
Flags: review?(Olli.Pettay) → review+

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=596232#c11)• 14 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/3e08f8844f87>Status: NEW → RESOLVEDClosed: 14 years agoResolution: --- → FIXED

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=596232#c12)• 14 years ago |
|  | |

Olli, is there anything for QA to do to verify this fix on 1.9.2?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=596232#c13)• 14 years ago |
|  | |

You could ensure that loading test\_tmpl\_errors.xul in a debug build doesn't
cause any assertions.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=596232#c14)• 14 years ago |
|  | |

trunk has a regression 608687 which got attached to the clone [bug 553808](/show_bug.cgi?id=553808 "VERIFIED FIXED - mochitest-chrome: test_tmpl_errors.xul causes 3 \"ASSERTION: This is unsafe! Fix the caller!: 'Error', file .../nsEventDispatcher.cpp, line 514\" in a row") rather than here.Depends on: [608687](/show_bug.cgi?id=608687 "VERIFIED FIXED - <rule>-generated toolbar items are cloned when leaving toolbar customize")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=596232#c15)• 14 years ago |
|  | |

Comment on [attachment 479407](/attachment.cgi?id=479407 "add checks") [[details]](/attachment.cgi?id=479407&action=edit "add checks") [[diff]](/attachment.cgi?id=479407&action=diff "add checks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=479407)
add checks
>+ nsCOMPtr<nsIDocument> doc = mRoot ? mRoot->GetDocument() : nsnull;
Patch applies fine to 1.9.1 branch but fails to compile. The above results in
../../../../dist/include/xpcom/nsCOMPtr.h: In constructor ‘nsCOMPtr<T>::nsCOMPtr(T\*) [with T = nsIDocument]’:
/Users/daniel/dev/ffcentral/moz191/content/xul/templates/src/nsXULTemplateBuilder.h:159: instantiated from here
../../../../dist/include/xpcom/nsCOMPtr.h:554: error: invalid use of undefined type ‘struct nsIDocument’
../../../../dist/include/content/nsNodeInfoManager.h:50: error: forward declaration of ‘struct nsIDocument’
../../../../dist/include/xpcom/nsCOMPtr.h:555: error: invalid static\_cast from type ‘nsIDocument\*’ to type ‘nsISupports\*’
../../../../dist/include/xpcom/nsCOMPtr.h: In destructor ‘nsCOMPtr<T>::~nsCOMPtr() [with T = nsIDocument]’:
/Users/daniel/dev/ffcentral/moz191/content/xul/templates/src/nsXULTemplateBuilder.h:159: instantiated from here
../../../../dist/include/xpcom/nsCOMPtr.h:508: error: invalid static\_cast from type ‘nsIDocument\*’ to type ‘nsISupports\*’
../../../../dist/include/xpcom/nsCOMPtr.h:510: error: invalid use of undefined type ‘struct nsIDocument’
../../../../dist/include/content/nsNodeInfoManager.h:50: error: forward declaration of ‘struct nsIDocument’
../../../../dist/include/xpcom/nsCOMPtr.h: In copy constructor ‘nsCOMPtr<T>::nsCOMPtr(const nsCOMPtr<T>&) [with T = nsIDocument]’:
/Users/daniel/dev/ffcentral/moz191/content/xul/templates/src/nsXULTemplateBuilder.h:159: instantiated from here
../../../../dist/include/xpcom/nsCOMPtr.h:545: error: invalid use of undefined type ‘struct nsIDocument’
../../../../dist/include/content/nsNodeInfoManager.h:50: error: forward declaration of ‘struct nsIDocument’
../../../../dist/include/xpcom/nsCOMPtr.h:546: error: invalid static\_cast from type ‘nsIDocument\* const’ to type ‘nsISupports\*’
../../../../dist/include/xpcom/nsCOMPtr.h: In member function ‘void nsCOMPtr<T>::Assert\_NoQueryNeeded() [with T = nsIDocument]’:
../../../../dist/include/xpcom/nsCOMPtr.h:556: instantiated from ‘nsCOMPtr<T>::nsCOMPtr(T\*) [with T = nsIDocument]’
/Users/daniel/dev/ffcentral/moz191/content/xul/templates/src/nsXULTemplateBuilder.h:159: instantiated from here
../../../../dist/include/xpcom/nsCOMPtr.h:520: error: no matching function for call to ‘do\_QueryInterface(nsIDocument\*&)’
../../../../dist/include/xpcom/nsCOMPtr.h:303: note: candidates are: nsQueryInterface do\_QueryInterface(nsISupports\*)
../../../../dist/include/xpcom/nsCOMPtr.h:310: note: nsQueryInterfaceWithError do\_QueryInterface(nsISupports\*, nsresult\*)
make[7]: \*\*\* [nsXULTemplateQueryProcessorStorage.o] Error 1

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=596232#c16)• 14 years ago |
|  | |

Gavin backed this out from the 1.9.2 branch due to regression [bug 608687](/show_bug.cgi?id=608687 "VERIFIED FIXED - <rule>-generated toolbar items are cloned when leaving toolbar customize")
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/d647705a2cf1> (relbranch)
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/8a23f17697a7>
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[.13-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.13-fixed) → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a7528521_1689)• 14 years ago |

blocking1.9.1: needed → .17+blocking1.9.2: needed → .14+

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a10903270_6102)• 14 years ago |

[Attachment #479407](/attachment.cgi?id=479407&action=edit "add checks") -
Flags: approval1.9.2.14?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=596232#c17)• 14 years ago |
|  | |

Comment on [attachment 479407](/attachment.cgi?id=479407 "add checks") [[details]](/attachment.cgi?id=479407&action=edit "add checks") [[diff]](/attachment.cgi?id=479407&action=diff "add checks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=479407)
add checks
a=LegNeato for 1.9.2.14
[Attachment #479407](/attachment.cgi?id=479407&action=edit "add checks") -
Flags: approval1.9.2.14?
[Attachment #479407](/attachment.cgi?id=479407&action=edit "add checks") -
Flags: approval1.9.2.14+
[Attachment #479407](/attachment.cgi?id=479407&action=edit "add checks") -
Flags: approval1.9.2.13+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=596232#c18)• 14 years ago |
|  | |

We'll also need the fix for 1.9.1 as well...

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a10913667_6102)• 14 years ago |

[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=596232#c19)• 14 years ago |
|  | |

Attached patch

[1.9.1 with extra include](attachment.cgi?id=505815&action=diff)
— [Details](attachment.cgi?id=505815&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=505815)

[Attachment #505815](/attachment.cgi?id=505815&action=edit "1.9.1 with extra include") -
Flags: approval1.9.1.17?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=596232#c20)• 14 years ago |
|  | |

Comment on [attachment 505815](/attachment.cgi?id=505815 "1.9.1 with extra include") [[details]](/attachment.cgi?id=505815&action=edit "1.9.1 with extra include") [[diff]](/attachment.cgi?id=505815&action=diff "1.9.1 with extra include") [[review]](/page.cgi?id=splinter.html&ignore=&bug=596232&attachment=505815)
1.9.1 with extra include
Approved for 1.9.1.17. Please land this as early as possible today so it makes the next release
[Attachment #505815](/attachment.cgi?id=505815&action=edit "1.9.1 with extra include") -
Flags: approval1.9.1.17? → approval1.9.1.17+

|  | [Neil Deakin](/user_profile?user_id=6102)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=596232#c21)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/6d4894752304>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=596232#c22)• 14 years ago |
|  | |

from Jan 18:
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/bc5bc0290118>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=596232#a16973588_1689)• 14 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=596232&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Neil Deakin](/user_profile?user_id=6102)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_384034d7_20250124_163928.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/600853)
* [XML](/show_bug.cgi?ctype=xml&id=600853)

Closed
[Bug 600853](/show_bug.cgi?id=600853)

Opened 14 years ago
Closed 14 years ago

# last ditch GC and OOM reporting with title lock held

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

last ditch GC and OOM reporting with title lock held

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [-](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=-) |
| status2.0 | --- | [unaffected](/buglist.cgi?f1=cf_status_20&o1=equals&v1=unaffected) |
| blocking1.9.2 | --- | [needed](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=needed) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [needed](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=needed) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | - |
| status2.0 |  | unaffected |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | needed |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: igor, Assigned: igor)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/78556976aa7c7e7980d6865f27df11b8?d=mm&size=40)  [igor](/user_profile?user_id=50763)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/78556976aa7c7e7980d6865f27df11b8?d=mm&size=40)  [igor](/user_profile?user_id=50763)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[633869](/show_bug.cgi?id=633869 "RESOLVED FIXED - Investigate 3.6.14 startup crashes in [@ js_Enumerate], possible regression")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[477627](/show_bug.cgi?id=477627 "RESOLVED FIXED - Deadlock in ClaimTitle with nested contexts and requests")

Dependency [tree](/showdependencytree.cgi?id=600853&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=600853)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [sg:critical])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 2 obsolete files)

| [v1](/attachment.cgi?id=481920)  [14 years ago](#c2)  [Igor Bukanov](/user_profile?user_id=50763)   28.43 KB, patch |  | [Details](/attachment.cgi?id=481920&action=edit) | [Diff](/attachment.cgi?id=481920&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=481920) |
| --- | --- | --- |
| [v2](/attachment.cgi?id=482832)  [14 years ago](#c5)  [Igor Bukanov](/user_profile?user_id=50763)   24.59 KB, patch |  | [Details](/attachment.cgi?id=482832&action=edit) | [Diff](/attachment.cgi?id=482832&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=482832) |
| [patch for 192 v1](/attachment.cgi?id=495512)  [14 years ago](#c13)  [Igor Bukanov](/user_profile?user_id=50763)   12.55 KB, patch | brendan : [review+](#c15 "14 years ago")  dveditz : [approval1.9.2.14+](#c19 "14 years ago") | [Details](/attachment.cgi?id=495512&action=edit) | [Diff](/attachment.cgi?id=495512&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=495512) |
| [patch for 191](/attachment.cgi?id=497823)  [14 years ago](#c18)  [Igor Bukanov](/user_profile?user_id=50763)   13.14 KB, patch | igor : [review+](#c18 "14 years ago")  dveditz : [approval1.9.1.17+](#c20 "14 years ago") | [Details](/attachment.cgi?id=497823&action=edit) | [Diff](/attachment.cgi?id=497823&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=497823) |
| [regression fix](/attachment.cgi?id=504450)  [14 years ago](#c27)  [Igor Bukanov](/user_profile?user_id=50763)   654 bytes, patch | brendan : [review+](#c29 "14 years ago")  christian : [approval1.9.2.14+](#c31 "14 years ago")  christian : [approval1.9.1.17+](#c31 "14 years ago") | [Details](/attachment.cgi?id=504450&action=edit) | [Diff](/attachment.cgi?id=504450&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=504450) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=600853#c0)• 14 years ago |
|  | |

obj\_toSource contains:
ok = obj->lookupProperty(cx, id, &obj2, &prop);
...
idstr = js\_ValueToString(cx, IdToValue(id));
...
JS\_UNLOCK\_OBJ(cx, obj2);
Here js\_ValueToString allocates a string when id is an integer. This implies that the last-ditch GC and OOM reporting will run with title lock held.
Similarly JS\_SetWatchPoint contains:
if (!js\_LookupProperty(cx, obj, propid, &pobj, &prop))
...
watcher = js\_WrapWatchedSetter(cx, propid, shape->attributes(), shape->setter());
...
JS\_UNLOCK\_OBJ(cx, obj);
Here js\_WrapWatchedSetter allocates at least new Function leading to the same bug.
Marking as security-sensitive as this is related to the [bug 569162](/show_bug.cgi?id=569162 "RESOLVED FIXED - GC hazard with lookupProperty callers with scripted proxy handlers") and in case other places contains the similar pattern but when an arbitrary JS code can run.

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600853#a451618_180188)• 14 years ago |

blocking2.0: --- → beta8+Whiteboard: [sg:critical]

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=600853#c1)• 14 years ago |
|  | |

The bugs in the [comment 0](/show_bug.cgi?id=600853#c0 "RESOLVED FIXED - last ditch GC and OOM reporting with title lock held") are a real hazards if the corresponding code is run against thread-shared objects. If another thread is waiting for the current thread to share the objects, then, as a consequence of changes in the big 477627, the last-ditch GC shares the object. That allows that thread to run until it suspends its the request. That other thread can then delete the shapes and let the GC to collect them before the first thread accesses them.Blocks: [477627](/show_bug.cgi?id=477627 "RESOLVED FIXED - Deadlock in ClaimTitle with nested contexts and requests")

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=600853#c2)• 14 years ago |
|  | |

Attached patch

[v1](attachment.cgi?id=481920&action=diff) (obsolete)
— [Details](attachment.cgi?id=481920&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=481920)

There are a lot of places where the the GC allocation happens when the object is locked. It is rather non-trivial and often very error-prone to change the corresponding code. So the patch takes simpler approach of just disabling the last-ditch GC when the current thread has any titles to share.

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=600853#c3)• 14 years ago |
|  | |

is this ready for review?

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=600853#c4)• 14 years ago |
|  | |

(In reply to [comment #3](/show_bug.cgi?id=600853#c3 "RESOLVED FIXED - last ditch GC and OOM reporting with title lock held"))
> is this ready for review?
It seems the try server gives more orange than usual for this patch. I am investigating that.

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=600853#c5)• 14 years ago |
|  | |

Attached patch

[v2](attachment.cgi?id=482832&action=diff) (obsolete)
— [Details](attachment.cgi?id=482832&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=482832)

here is a rebased patch. It passes the tryserver and the oranges that I have seen comes from unrelated patch.
To allow for simpler detection of waiting titles for the current thread the patch moves the title sharing list into JSThread.
[Attachment #481920](/attachment.cgi?id=481920&action=edit "v1") -
Attachment is obsolete: true
[Attachment #482832](/attachment.cgi?id=482832&action=edit "v2") -
Flags: review?(brendan)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=600853#c6)• 14 years ago |
|  | |

Brendan, this is a beta8 blocker and a security bug, can you do this review?

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=600853#c7)• 14 years ago |
|  | |

We killed titles within the last two weeks, so is this even a bug any more?

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=600853#c8)• 14 years ago |
|  | |

(In reply to [comment #7](/show_bug.cgi?id=600853#c7 "RESOLVED FIXED - last ditch GC and OOM reporting with title lock held"))
> We killed titles within the last two weeks, so is this even a bug any more?
For the branches.
/be

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600853#a3481734_1214)• 14 years ago |

blocking2.0: beta8+ → ---

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600853#a3562775_103593)• 14 years ago |

blocking1.9.1: --- → ?blocking1.9.2: --- → ?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600853#a3724831_1689)• 14 years ago |

blocking1.9.1: ? → neededblocking1.9.2: ? → needed
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=600853#c9)• 14 years ago |
|  | |

Igor, is the attached patch good for older branches as well? If not, please upload a branch version.

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=600853#c10)• 14 years ago |
|  | |

Igor, ping?

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=600853#c11)• 14 years ago |
|  | |

(In reply to [comment #10](/show_bug.cgi?id=600853#c10 "RESOLVED FIXED - last ditch GC and OOM reporting with title lock held"))
> Igor, ping?
We need a new patch. I should have it this week.

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=600853#c12)• 14 years ago |
|  | |

Excellent, thanks Igor!

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=600853#c13)• 14 years ago |
|  | |

Attached patch

[patch for 192 v1](attachment.cgi?id=495512&action=diff)
— [Details](attachment.cgi?id=495512&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=495512)

Here is a minimal patch. It makes sure that the GC allocation paths do not invoke the last ditch GC if the current thread has titles to share. I will ask for a review after more testing.
[Attachment #482832](/attachment.cgi?id=482832&action=edit "v2") -
Attachment is obsolete: true
[Attachment #482832](/attachment.cgi?id=482832&action=edit "v2") -
Flags: review?(brendan)

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=600853#c14)• 14 years ago |
|  | |

Comment on [attachment 495512](/attachment.cgi?id=495512 "patch for 192 v1") [[details]](/attachment.cgi?id=495512&action=edit "patch for 192 v1") [[diff]](/attachment.cgi?id=495512&action=diff "patch for 192 v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=495512)
patch for 192 v1
The patch passes testing.
[Attachment #495512](/attachment.cgi?id=495512&action=edit "patch for 192 v1") -
Flags: review?(brendan)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=600853#c15)• 14 years ago |
|  | |

Comment on [attachment 495512](/attachment.cgi?id=495512 "patch for 192 v1") [[details]](/attachment.cgi?id=495512&action=edit "patch for 192 v1") [[diff]](/attachment.cgi?id=495512&action=diff "patch for 192 v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=495512)
patch for 192 v1
Looks good -- any reason not to make HAS\_TITLES\_TO\_SHARE be an inline hasTitlesToShare method?
/be
[Attachment #495512](/attachment.cgi?id=495512&action=edit "patch for 192 v1") -
Flags: review?(brendan) → review+

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=600853#c16)• 14 years ago |
|  | |

(In reply to [comment #15](/show_bug.cgi?id=600853#c15 "RESOLVED FIXED - last ditch GC and OOM reporting with title lock held"))
> any reason not to make HAS\_TITLES\_TO\_SHARE be an inline
> hasTitlesToShare method?
The reason is the patch minimality to avoid extra #ifdef C++ as LiveConnect is alive and kicking on 1.9.2.

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=600853#c17)• 14 years ago |
|  | |

Agh, you reminded me of the nameless horror that was L\*\*\*C\*\*\*\*\*t!
/be

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600853#a6385032_50763)• 14 years ago |

[Attachment #495512](/attachment.cgi?id=495512&action=edit "patch for 192 v1") -
Flags: approval1.9.2.14?

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=600853#c18)• 14 years ago |
|  | |

Attached patch

[patch for 191](attachment.cgi?id=497823&action=diff)
— [Details](attachment.cgi?id=497823&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=497823)

191 version required a minimal backporting from 192. Here is a plain diff between 192 and 191 patches:
> @@ -1807,8 +1809,9 @@ IsGCThresholdReached(JSRuntime \*rt)
129c122
< - rt->gcBytes >= rt->gcTriggerBytes;
---
> - rt->gcBytes / rt->gcTriggerFactor >= rt->gcLastBytes / 100;
131c124,125
< + rt->gcBytes >= rt->gcTriggerBytes) && !HAS\_TITLES\_TO\_SHARE(cx);
---
> + rt->gcBytes / rt->gcTriggerFactor >= rt->gcLastBytes / 100) &&
> + !HAS\_TITLES\_TO\_SHARE(cx);
134,135c128,129
< template <class T> static JS\_INLINE T\*
< @@ -1840,7 +1842,7 @@ NewGCThing(JSContext \*cx, uintN flags)
---
> @@ -2298,9 +2301,10 @@ js\_AddAsGCBytes(JSContext \*cx, size\_t sz
> JSRuntime \*rt;
>
> rt = cx->runtime;
> - if (rt->gcBytes >= rt->gcMaxBytes ||
> - sz > (size\_t) (rt->gcMaxBytes - rt->gcBytes) ||
> - IsGCThresholdReached(rt)) {
> + if ((rt->gcBytes >= rt->gcMaxBytes ||
> + sz > (size\_t) (rt->gcMaxBytes - rt->gcBytes) ||
> + IsGCThresholdReached(cx)) &&
> + !HAS\_TITLES\_TO\_SHARE(cx)) {
> if (JS\_ON\_TRACE(cx)) {
> /\*
> \* If we can't leave the trace, signal OOM condition, otherwise
Here 1.9.1-only js\_AddAsGCBytes required an extra change to disable GC when HAS\_TITLES\_TO\_SHARE is true.
[Attachment #497823](/attachment.cgi?id=497823&action=edit "patch for 191") -
Flags: review+
[Attachment #497823](/attachment.cgi?id=497823&action=edit "patch for 191") -
Flags: approval1.9.1.17?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=600853#c19)• 14 years ago |
|  | |

Comment on [attachment 495512](/attachment.cgi?id=495512 "patch for 192 v1") [[details]](/attachment.cgi?id=495512&action=edit "patch for 192 v1") [[diff]](/attachment.cgi?id=495512&action=diff "patch for 192 v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=495512)
patch for 192 v1
Approved for 1.9.2.14, a=dveditz for release-drivers
[Attachment #495512](/attachment.cgi?id=495512&action=edit "patch for 192 v1") -
Flags: approval1.9.2.14? → approval1.9.2.14+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=600853#c20)• 14 years ago |
|  | |

Comment on [attachment 497823](/attachment.cgi?id=497823 "patch for 191") [[details]](/attachment.cgi?id=497823&action=edit "patch for 191") [[diff]](/attachment.cgi?id=497823&action=diff "patch for 191") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=497823)
patch for 191
Approved for 1.9.1.17, a=dveditz for release-drivers
[Attachment #497823](/attachment.cgi?id=497823&action=edit "patch for 191") -
Flags: approval1.9.1.17? → approval1.9.1.17+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600853#a7009267_482154)• 14 years ago |

[status2.0](/buglist.cgi?f1=cf_status_20&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_20&o1=equals&v1=unaffected)

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600853#a8410059_180188)• 14 years ago |

blocking2.0: --- → -

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=600853#c21)• 14 years ago |
|  | |

Igor, could you land this on the branch?

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=600853#c22)• 14 years ago |
|  | |

landed on branches:
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/3b97e967b6cc>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/81e4317eb7f8>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=600853#c23)• 14 years ago |
|  | |

(In reply to [comment #22](/show_bug.cgi?id=600853#c22 "RESOLVED FIXED - last ditch GC and OOM reporting with title lock held"))
> <http://hg.mozilla.org/releases/mozilla-1.9.1/rev/81e4317eb7f8>
FYI, I think this is related to an ./shell.js:701 out of memory error (jit, shell only) I started seeing with 2 tests on 1.9.1 linux 32bit with 4G (the only jstests I still run regularly). It seems this would be expected behavior from this patch in some cases and probably is not of concern. I thought I would mention it though. The tests in question are:
js1\_5/extensions/regress-350531.js and js1\_6/extensions/regress-456826.js

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=600853#c24)• 14 years ago |
|  | |

(In reply to [comment #23](/show_bug.cgi?id=600853#c23 "RESOLVED FIXED - last ditch GC and OOM reporting with title lock held"))
э> FYI, I think this is related to an ./shell.js:701 out of memory error (jit,
> shell only) I started seeing with 2 tests on 1.9.1 linux 32bit with 4G (the
> only jstests I still run regularly).
Is this only n 1.9.1 or 1.9.2 is also affected?

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=600853#c25)• 14 years ago |
|  | |

1.9.1 only.

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=600853#c26)• 14 years ago |
|  | |

The failing test cases revealed a bug in landed patches. So I clear the status the status and will post the regression fixes soon.
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) → ---
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) → ---

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=600853#c27)• 14 years ago |
|  | |

Attached patch

[regression fix](attachment.cgi?id=504450&action=diff)
— [Details](attachment.cgi?id=504450&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=504450)

When NewArena returns NULL, it signals to to the GC if possible or report OOM. The essence of the landed patch was to prevent that GC form happening when the current thread has titles to share. So the idea was to ignore the heap size limit in NewArena with to-be-shared-titles and report OOM when when when NewArena failed to get new GC arenas via mmap.
Needless to say, the landed patch did exactly the opposite - it would ignore the limit when there were no waiting titles and would enforce the limit where there are titles. This patch fixes the typo. It applies to both ranches as-is.
[Attachment #504450](/attachment.cgi?id=504450&action=edit "regression fix") -
Flags: review?(brendan)

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=600853#c28)• 14 years ago |
|  | |

Brendan - do you have time to look to the regression fix today? If not I will have to back out the landed patches.

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=600853#c29)• 14 years ago |
|  | |

Comment on [attachment 504450](/attachment.cgi?id=504450 "regression fix") [[details]](/attachment.cgi?id=504450&action=edit "regression fix") [[diff]](/attachment.cgi?id=504450&action=diff "regression fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=504450)
regression fix
Sorry for the tardy r+ -- obvious fix now that you point it out.
/be
[Attachment #504450](/attachment.cgi?id=504450&action=edit "regression fix") -
Flags: review?(brendan) → review+

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=600853#c30)• 14 years ago |
|  | |

Comment on [attachment 504450](/attachment.cgi?id=504450 "regression fix") [[details]](/attachment.cgi?id=504450&action=edit "regression fix") [[diff]](/attachment.cgi?id=504450&action=diff "regression fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=504450)
regression fix
asking for regression fix approval
[Attachment #504450](/attachment.cgi?id=504450&action=edit "regression fix") -
Flags: approval1.9.2.14?
[Attachment #504450](/attachment.cgi?id=504450&action=edit "regression fix") -
Flags: approval1.9.1.17?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=600853#c31)• 14 years ago |
|  | |

Comment on [attachment 504450](/attachment.cgi?id=504450 "regression fix") [[details]](/attachment.cgi?id=504450&action=edit "regression fix") [[diff]](/attachment.cgi?id=504450&action=diff "regression fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600853&attachment=504450)
regression fix
Approving regression fix
[Attachment #504450](/attachment.cgi?id=504450&action=edit "regression fix") -
Flags: approval1.9.2.14?
[Attachment #504450](/attachment.cgi?id=504450&action=edit "regression fix") -
Flags: approval1.9.2.14+
[Attachment #504450](/attachment.cgi?id=504450&action=edit "regression fix") -
Flags: approval1.9.1.17?
[Attachment #504450](/attachment.cgi?id=504450&action=edit "regression fix") -
Flags: approval1.9.1.17+

|  | [Igor Bukanov](/user_profile?user_id=50763)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=600853#c32)• 14 years ago |
|  | |

I landed regression fixes:
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/e19b68b68daf>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/237c9fe03984>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=600853#c33)• 14 years ago |
|  | |

Since 2.0 is marked "unaffected" and the branches are patched this bug is FIXED, right?Status: NEW → RESOLVEDClosed: 14 years agoResolution: --- → FIXED

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=600853#c34)• 14 years ago |
|  | |

I backed this out of 1.9.2 (default and 1.9.2.14 relbranch):
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/844ae0377afa>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/a50a49f952c0>
(see [bug 633869](/show_bug.cgi?id=633869 "RESOLVED FIXED - Investigate 3.6.14 startup crashes in [@ js_Enumerate], possible regression"))Depends on: [633869](/show_bug.cgi?id=633869 "RESOLVED FIXED - Investigate 3.6.14 startup crashes in [@ js_Enumerate], possible regression")

|  | [Ludovic Hirlimann [:Usul]](/user_profile?user_id=99100) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=600853#c35)• 14 years ago |
|  | |

Shall this be reopened then ?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600853#a15590940_1689)• 14 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=600853&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Igor Bukanov](/user_profile?user_id=50763)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_e252f319_20250124_163918.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/558633)
* [XML](/show_bug.cgi?ctype=xml&id=558633)

Closed
[Bug 558633](/show_bug.cgi?id=558633)

Opened 15 years ago
Closed 15 years ago

# TM: (64-bit) "Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

TM: (64-bit) "Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp"

## Categories

### (Core :: JavaScript Engine, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla1.9.3a5

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [final+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=final%2B) |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | final+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: brendan)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c936d5fc7ef09504480b9d8aafb7e8a0?d=mm&size=40)  [brendan](/user_profile?user_id=1214)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: assertion, regression, testcase, Whiteboard: [sg:critical] fixed-in-tracemonkey [critsmash:patch] [qa-examined-191] [qa-examined-192])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical] fixed-in-tracemonkey [critsmash:patch] [qa-examined-191] [qa-examined-192]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [decoder](/user_profile?user_id=395101) | [in-testsuite](#c35 "15 years ago") | - |
| --- | --- | --- |
| [decoder](/user_profile?user_id=395101) | in-testsuite | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 3 obsolete files)

| [TMFLAGS=readlir output on first testcase in comment 2](/attachment.cgi?id=441239)  [15 years ago](#c7)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   5.29 KB, text/plain |  | [Details](/attachment.cgi?id=441239&action=edit) |
| --- | --- | --- |
| [TMFLAGS=readlir output on second testcase in comment 5](/attachment.cgi?id=441240)  [15 years ago](#c8)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   9.57 KB, text/plain |  | [Details](/attachment.cgi?id=441240&action=edit) |
| [LIR output](/attachment.cgi?id=441261)  [15 years ago](#c10)  [Nicholas Nethercote [inactive]](/user_profile?user_id=334849)   5.56 KB, text/plain |  | [Details](/attachment.cgi?id=441261&action=edit) |
| [fix](/attachment.cgi?id=446110)  [15 years ago](#c19)  [Brendan Eich [:brendan]](/user_profile?user_id=1214)   831 bytes, patch |  | [Details](/attachment.cgi?id=446110&action=edit) | [Diff](/attachment.cgi?id=446110&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=446110) |
| [fix](/attachment.cgi?id=446168)  [15 years ago](#c24)  [Brendan Eich [:brendan]](/user_profile?user_id=1214)   851 bytes, patch | mrbkap : [review+](#a3333118_69426 "15 years ago") | [Details](/attachment.cgi?id=446168&action=edit) | [Diff](/attachment.cgi?id=446168&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=446168) |
| [191 patch](/attachment.cgi?id=505585)  [14 years ago](#c28)  [Jeff Walden [:Waldo]](/user_profile?user_id=83595)   874 bytes, patch | dveditz : [approval1.9.1.17+](#c30 "14 years ago") | [Details](/attachment.cgi?id=505585&action=edit) | [Diff](/attachment.cgi?id=505585&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=505585) |
| [192 patch](/attachment.cgi?id=505589)  [14 years ago](#c29)  [Jeff Walden [:Waldo]](/user_profile?user_id=83595)   874 bytes, patch | dveditz : [approval1.9.2.14+](#c31 "14 years ago") | [Details](/attachment.cgi?id=505589&action=edit) | [Diff](/attachment.cgi?id=505589&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=505589) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=558633#c0)• 15 years ago |
|  | |

Console output:
$ cat 2interesting/1testcase.js
\_\_defineSetter\_\_("x", eval)
\_\_defineSetter\_\_("a", /a/)
o = (function () {
for (l in [0, 0, 0]) {
for (var [, x] = /x/ in this) print(x)
}
})()
$ jsfunfuzz-dbg-64-tm-40659-4932aaad4962/js-dbg-64-tm-darwin -j -e maxRunTime=5000 2interesting/1testcase.js
undefined
undefined
undefined
undefined
a
undefined
undefined
undefined
Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'imml' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp:2634)
Abort trap
asserts js debug shell on TM tip with -j and with "-e maxRunTime=5000" at Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'imml' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp:2634)
I wonder why it requires "-e maxRunTime=5000", though the value "5000" can be any numerical value that I've tested.
autoBisect shows this is probably related to [bug 547314](/show_bug.cgi?id=547314 "RESOLVED FIXED - Introduce ObjectOps for typeof"):
The first bad revision is:
changeset: 38505:65eeef03da7c
user: Andreas Gal
date: Mon Feb 22 16:30:22 2010 -0800
summary: Introduce ObjectOps for typeOf and make trace a mandatory ObjectOp (547314, r=brendan).

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=558633#c1)• 15 years ago |
|  | |

And oh, this seems 64-bit only, on both Mac and Linux.Summary: TM: "Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'imml' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp" → TM: (64-bit) "Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'imml' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp"

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=558633#c2)• 15 years ago |
|  | |

Standalone testcase (only requires -j; thanks to Jesse for this tip):
maxRunTime=0
\_\_defineSetter\_\_("x", eval)
\_\_defineSetter\_\_("a", /a/)
o = (function () {
for (l in [0, 0, 0]) {
for (var [, x] = /x/ in this) print(x)
}
})()

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=558633#c3)• 15 years ago |
|  | |

undefined
undefined
undefined
undefined
a
undefined
undefined
undefined
Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp:2635)
Program received signal SIGABRT, Aborted.
0x00007ffff6ebfa75 in \*\_\_GI\_raise (sig=<value optimized out>) at ../nptl/sysdeps/unix/sysv/linux/raise.c:64
64 ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.
in ../nptl/sysdeps/unix/sysv/linux/raise.c
(gdb) bt
#0 0x00007ffff6ebfa75 in \*\_\_GI\_raise (sig=<value optimized out>) at ../nptl/sysdeps/unix/sysv/linux/raise.c:64
#1 0x00007ffff6ec35c0 in \*\_\_GI\_abort () at abort.c:92
#2 0x000000000059f8e2 in avmplus::AvmAssertFail () at ../nanojit/avmplus.cpp:65
#3 0x000000000059b086 in nanojit::ValidateWriter::typeCheckArgs (this=0x8c3598, op=nanojit::LIR\_orq, nArgs=2, formals=0x7fffffffd690, args=0x7fffffffd680) at ../nanojit/LIR.cpp:2630
#4 0x000000000059bbe1 in nanojit::ValidateWriter::ins2 (this=0x8c3598, op=nanojit::LIR\_orq, a=0x8bece0, b=0x8beb28) at ../nanojit/LIR.cpp:2960
#5 0x000000000055d450 in js::TraceRecorder::box\_jsval (this=0x8bdcc0, v=8769092, v\_ins=0x8bece0) at ../jstracer.cpp:9396
#6 0x0000000000564115 in js::TraceRecorder::callNative (this=0x8bdcc0, argc=1, mode=JSOP\_CALL) at ../jstracer.cpp:10891
#7 0x0000000000564ba6 in js::TraceRecorder::functionCall (this=0x8bdcc0, argc=1, mode=JSOP\_CALL) at ../jstracer.cpp:11034
#8 0x000000000056b9e2 in js::TraceRecorder::record\_JSOP\_CALL (this=0x8bdcc0) at ../jstracer.cpp:12576
#9 0x0000000000554c8f in js::TraceRecorder::monitorRecording (this=0x8bdcc0, op=JSOP\_CALL) at ../jsopcode.tbl:179
#10 0x00000000005b17ed in js\_Interpret (cx=0x8a53f0) at ../jsops.cpp:78
#11 0x0000000000485ca2 in js\_Execute (cx=0x8a53f0, chain=0x7ffff6c02000, script=0x8af750, down=0x0, flags=0, result=0x0) at ../jsinterp.cpp:1103
#12 0x000000000042598b in JS\_ExecuteScript (cx=0x8a53f0, obj=0x7ffff6c02000, script=0x8af750, rval=0x0) at ../jsapi.cpp:4827
#13 0x0000000000403970 in Process (cx=0x8a53f0, obj=0x7ffff6c02000, filename=0x7fffffffe620 "1testcase.js", forceTTY=0) at ../../shell/js.cpp:449
#14 0x0000000000404786 in ProcessArgs (cx=0x8a53f0, obj=0x7ffff6c02000, argv=0x7fffffffe320, argc=2) at ../../shell/js.cpp:863
#15 0x000000000040c783 in main (argc=2, argv=0x7fffffffe320, envp=0x7fffffffe338) at ../../shell/js.cpp:5038
(gdb)

|  | [Andreas Gal :gal](/user_profile?user_id=310943) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=558633#c4)• 15 years ago |
|  | |

Kinda scary. I think bisecting might be pointing to a red herring.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=558633#c5)• 15 years ago |
|  | |

Note that the original assertion was:
Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'imml' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp
and now it's morphed to:
Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp:2635)
-> 'imml' changed to 'immi'
Here's another testcase that shows the latter assertion:
x = this
for (let z = 0; z < 3; z++) {
for (var [c] = 3 in x) {
print(c)
}
}

|  | [Nicholas Nethercote [inactive]](/user_profile?user_id=334849) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=558633#c6)• 15 years ago |
|  | |

(In reply to [comment #5](/show_bug.cgi?id=558633#c5 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\""))
>
> -> 'imml' changed to 'immi'
That opcode changed name very recently :) [Bug 555633](/show_bug.cgi?id=555633 "RESOLVED FIXED - nanojit: rename opcodes in LIRopcode.tbl"). So it hasn't really changed.
LIR type errors are really bad, this needs to be fixed. It's Saturday morning in Melbourne so I don't have time to look in detail, but I suggest someone looks in TraceRecorder::box\_jsval(), which has the only occurrences of LIR\_pior in jstracer.cpp. (Nb: LIR\_pior ends up as LIR\_orq on 64-bit, it's a bit confusing because we're halfway through the opcode renaming.)
Something that can help with diagnosing type errors is to change the NanoAssertMsgf() call in ValidateWriter::typeCheckArgs to a printf(); that way it doesn't stop on the error. Combine that with TMFLAGS=readlir and it shouldn't be too hard to find the bad LIR instruction.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=558633#c7)• 15 years ago |
|  | |

Attached file
[TMFLAGS=readlir output on first testcase in comment 2](attachment.cgi?id=441239) (obsolete)
— [Details](attachment.cgi?id=441239&action=edit)

> Something that can help with diagnosing type errors is to change the
> NanoAssertMsgf() call in ValidateWriter::typeCheckArgs to a printf(); that way
> it doesn't stop on the error. Combine that with TMFLAGS=readlir and it
> shouldn't be too hard to find the bad LIR instruction.
Area of code near where orq is located:
31: js\_String\_getelem1 = callq. #js\_String\_getelem ( cx $stack8 1 )
32: eqq4 = eqq js\_String\_getelem1, NULL
33: xt2: xt eqq4 -> pc=0x1a4a7a4 imacpc=(nil) sp+56 rp+0 (GuardID=003)
34: stq.s sp[40] = js\_String\_getelem1
35: obj = immq 7F77:96E02000
36: stq.s sp[48] = obj
37: ATOM\_TO\_STRING(atom) = immq 0:85D120
38: stq.s sp[56] = ATOM\_TO\_STRING(atom)
39: JSVAL\_STRING = immq 0:4
40: orq2 = orq js\_String\_getelem1, JSVAL\_STRING

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=558633#c8)• 15 years ago |
|  | |

Attached file
[TMFLAGS=readlir output on second testcase in comment 5](attachment.cgi?id=441240) (obsolete)
— [Details](attachment.cgi?id=441240&action=edit)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a1107243_132034)• 15 years ago |

Summary: TM: (64-bit) "Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'imml' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp" → TM: (64-bit) "Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp"

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=558633#c9)• 15 years ago |
|  | |

(In reply to [comment #6](/show_bug.cgi?id=558633#c6 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\""))
> LIR type errors are really bad, this needs to be fixed.
Setting s-s first just to be safe.Group: core-security

|  | [Nicholas Nethercote [inactive]](/user_profile?user_id=334849) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=558633#c10)• 15 years ago |
|  | |

Attached file
[LIR output](attachment.cgi?id=441261)
— [Details](attachment.cgi?id=441261&action=edit)

The problem is in instruction 66 (marked with '\*') in this attachment:
\* 66: orq1 = orq JSVAL\_TO\_SPECIAL(JSVAL\_VOID), JSVAL\_STRING
JSVAL\_TO\_SPECIAL(JSVAL\_VOID) is a 32-bit immediate. It must come from one of the INS\_VOID() calls in jstracer.cpp.
I'm pretty sure the 'orq' is generated by this line at the end of box\_jsval():
return lir->ins2(LIR\_pior, v\_ins, INS\_CONSTWORD(JSVAL\_STRING));
I don't know much beyond that, as I don't understand what this code is doing... maybe we need a pointer-sized alternative to INS\_VOID()?
[Attachment #441239](/attachment.cgi?id=441239&action=edit "TMFLAGS=readlir output on first testcase in comment 2") -
Attachment is obsolete: true
[Attachment #441240](/attachment.cgi?id=441240&action=edit "TMFLAGS=readlir output on second testcase in comment 5") -
Attachment is obsolete: true

|  | [Andreas Gal :gal](/user_profile?user_id=310943) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a1359215_310943)• 15 years ago |

Status: NEW → RESOLVEDClosed: 15 years agoResolution: --- → DUPLICATE

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=558633#c12)• 15 years ago |
|  | |

Explanation and whatnot coming in [bug 546611](/show_bug.cgi?id=546611 "VERIFIED FIXED - TM: \"Assertion failure: isNumber(*p) == (t == TT_DOUBLE), at ../jstracer.cpp\" or \"Assertion failure: isInt32(*p), at ../jstracer.cpp\""), of which this is a dupe.
[comment #5](/show_bug.cgi?id=558633#c5 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\"") and [comment #10](/show_bug.cgi?id=558633#c10 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\"") show this is clearly and easily exploitable. Once you can tag an integer as an object/string, game over.

|  | [Nicholas Nethercote [inactive]](/user_profile?user_id=334849) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=558633#c13)• 15 years ago |
|  | |

dvander, can you CC me on [bug 546611](/show_bug.cgi?id=546611 "VERIFIED FIXED - TM: \"Assertion failure: isNumber(*p) == (t == TT_DOUBLE), at ../jstracer.cpp\" or \"Assertion failure: isInt32(*p), at ../jstracer.cpp\"")? Thanks.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=558633#c14)• 15 years ago |
|  | |

qawanted:
Is this really a dupe of [bug 546611](/show_bug.cgi?id=546611 "VERIFIED FIXED - TM: \"Assertion failure: isNumber(*p) == (t == TT_DOUBLE), at ../jstracer.cpp\" or \"Assertion failure: isInt32(*p), at ../jstracer.cpp\"")? Gary thought that one regressed Dec 11 due to [bug 515749](/show_bug.cgi?id=515749 "RESOLVED FIXED - TM: lazily load stack slots and global values") and this one Feb 22 due to [bug 547314](/show_bug.cgi?id=547314 "RESOLVED FIXED - Introduce ObjectOps for typeof"). Gary: it would be great if you could verify that this bug is really fixed on trunk and 3.6.4Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---)Whiteboard: [sg:dupe 546611]

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=558633#c15)• 15 years ago |
|  | |

Dan's right; this isn't a dupe (I tested using the testcase in [comment 2](/show_bug.cgi?id=558633#c2 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\"")). Switching back to [sg:investigate].
I couldn't get the [comment 2](/show_bug.cgi?id=558633#c2 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\"") testcase to assert in 1.9.2 shell builds though. Nor could I get the [comment 5](/show_bug.cgi?id=558633#c5 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\"") testcase to assert in any of the shells.
TM:
$ ~/Desktop/jsfunfuzz-dbg-64-tm-41833-d9ef93881da0/js-dbg-64-tm-linux -j
js> maxRunTime=0
0
js> \_\_defineSetter\_\_("x", eval)
js> \_\_defineSetter\_\_("a", /a/)
js> o = (function () {
for (l in [0, 0, 0]) {
for (var [, x] = /x/ in this) print(x)
}
})()
undefined
undefined
undefined
undefined
a
undefined
undefined
undefined
Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp:2640)
Aborted
m-c:
$ ~/Desktop/jsfunfuzz-dbg-64-mc-42011-b6726b0fa230/js-dbg-64-mc-linux -j
js> maxRunTime=0
0
js> \_\_defineSetter\_\_("x", eval)
js> \_\_defineSetter\_\_("a", /a/)
js> o = (function () {
for (l in [0, 0, 0]) {
for (var [, x] = /x/ in this) print(x)
}
})()
undefined
undefined
undefined
undefined
a
undefined
undefined
undefined
Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp:2640)
AbortedStatus: RESOLVED → REOPENEDblocking2.0: --- → ?Flags: in-testsuite?Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---)Resolution: DUPLICATE → ---Whiteboard: [sg:dupe 546611] → [sg:investigate]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=558633#c16)• 15 years ago |
|  | |

clearing the deprecated [sg:investigate] so it gets covered in the weekly mtg.Whiteboard: [sg:investigate]

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a3237562_269330)• 15 years ago |

Whiteboard: [sg:critical?][critsmash:investigating]

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=558633#c17)• 15 years ago |
|  | |

This looks like an assert failure in nanojit, which would suggest that this is
not exploitable, unless this was seen in a debug build and asserts are no-ops
in release builds of nonojit. Can someone shed some light on whether this is
exploitable or not?

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=558633#c18)• 15 years ago |
|  | |

Nanojit assertions suggest that we're generating code wrong. I'll look into the test case in [comment #15](/show_bug.cgi?id=558633#c15 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\"").

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=558633#c19)• 15 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=446110&action=diff) (obsolete)
— [Details](attachment.cgi?id=446110&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=446110)

David, could you verify this fixes all tracing and JM bugs (if any)? Thanks,
/beAssignee: general → brendanStatus: REOPENED → ASSIGNED
[Attachment #446110](/attachment.cgi?id=446110&action=edit "fix") -
Flags: review?(mrbkap)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a3255181_1214)• 15 years ago |

[Attachment #446110](/attachment.cgi?id=446110&action=edit "fix") -
Attachment is obsolete: true
[Attachment #446110](/attachment.cgi?id=446110&action=edit "fix") -
Flags: review?(mrbkap)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=558633#c20)• 15 years ago |
|  | |

Comment on [attachment 446110](/attachment.cgi?id=446110 "fix") [[details]](/attachment.cgi?id=446110&action=edit "fix") [[diff]](/attachment.cgi?id=446110&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=446110)
fix
Grr, not right.
/be

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=558633#c21)• 15 years ago |
|  | |

Just for posterity, here's the explanation of what's going wrong.
o = (function () {
for (l in [0, 0, 0]) {
for (var [, x] = /x/ in this) print(x)
}
The destructuring assignment is not being recognized as a local slot, despite |var|. That's only half the bug. The real scary part (and why this asserts in the tracer) is that indirect eval calls js\_GetCallObject for lightweight functions. This creates an intervening property on the call object, which the tracer does not see because of assumptions in BINDNAME.

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=558633#c22)• 15 years ago |
|  | |

The indirect eval is a global eval, but it gratuitously (left-over code) calls js\_GetCallObject early on. David, Blake: can this be filed and fixed separately? It is not a security bug.
/be

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=558633#c23)• 15 years ago |
|  | |

Okay, so just to make sure I'm understanding this correctly. The call object imports locals, and this script has a local "x" defined. But the wrong opcode is emitted, breaking assumptions in BINDNAME. The interpreter binds to the local slot, the tracer to the global.
That's the security bug, so will file the the obj\_eval one open. Thanks!

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a3258885_309316)• 15 years ago |

No longer blocks: [547314](/show_bug.cgi?id=547314 "RESOLVED FIXED - Introduce ObjectOps for typeof")Whiteboard: [sg:critical?][critsmash:investigating] → [sg:critical]

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=558633#c24)• 15 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=446168&action=diff)
— [Details](attachment.cgi?id=446168&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=446168)

[Attachment #446168](/attachment.cgi?id=446168&action=edit "fix") -
Flags: review?(mrbkap)

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a3277261_1214)• 15 years ago |

OS: Mac OS X → AllPriority: -- → P1Hardware: x86 → AllTarget Milestone: --- → mozilla1.9.3a5

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=558633#c25)• 15 years ago |
|  | |

The indirect-eval-gets-Call-object bug is [bug 566773](/show_bug.cgi?id=566773 "RESOLVED FIXED - indirect eval calls js_GetCallObject").
/be

|  | [Blake Kaplan (:mrbkap) (inactive)](/user_profile?user_id=69426) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a3333118_69426)• 15 years ago |

[Attachment #446168](/attachment.cgi?id=446168&action=edit "fix") -
Flags: review?(mrbkap) → review+

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=558633#c26)• 15 years ago |
|  | |

<http://hg.mozilla.org/tracemonkey/rev/0bed5abf1764>
/beWhiteboard: [sg:critical] → [sg:critical] fixed-in-tracemonkey

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a3407076_269330)• 15 years ago |

blocking2.0: ? → final+Whiteboard: [sg:critical] fixed-in-tracemonkey → [sg:critical] fixed-in-tracemonkey [critsmash:patch]

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=558633#c27)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/0bed5abf1764>Status: ASSIGNED → RESOLVEDClosed: 15 years ago → 15 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a23475774_1689)• 14 years ago |

blocking1.9.1: --- → ?blocking1.9.2: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a23707866_1689)• 14 years ago |

blocking1.9.1: ? → .17+blocking1.9.2: ? → .14+

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=558633#c28)• 14 years ago |
|  | |

Attached patch

[191 patch](attachment.cgi?id=505585&action=diff)
— [Details](attachment.cgi?id=505585&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=505585)

Port to branch was pretty pedestrian, nothing tricky about it.
[Attachment #505585](/attachment.cgi?id=505585&action=edit "191 patch") -
Flags: approval1.9.2.14?

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a24591955_83595)• 14 years ago |

[Attachment #505585](/attachment.cgi?id=505585&action=edit "191 patch") -
Flags: approval1.9.2.14? → approval1.9.1.17?

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=558633#c29)• 14 years ago |
|  | |

Attached patch

[192 patch](attachment.cgi?id=505589&action=diff)
— [Details](attachment.cgi?id=505589&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=505589)

...likewise trivial.
[Attachment #505589](/attachment.cgi?id=505589&action=edit "192 patch") -
Flags: approval1.9.2.14?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=558633#c30)• 14 years ago |
|  | |

Comment on [attachment 505585](/attachment.cgi?id=505585 "191 patch") [[details]](/attachment.cgi?id=505585&action=edit "191 patch") [[diff]](/attachment.cgi?id=505585&action=diff "191 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=505585)
191 patch
Approved for 1.9.1.17, a=dveditz for release-drivers
[Attachment #505585](/attachment.cgi?id=505585&action=edit "191 patch") -
Flags: approval1.9.1.17? → approval1.9.1.17+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=558633#c31)• 14 years ago |
|  | |

Comment on [attachment 505589](/attachment.cgi?id=505589 "192 patch") [[details]](/attachment.cgi?id=505589&action=edit "192 patch") [[diff]](/attachment.cgi?id=505589&action=diff "192 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=558633&attachment=505589)
192 patch
Approved for 1.9.2.14, a=dveditz for release-drivers
Needs to land by 13:00 PST, can you do that today?
[Attachment #505589](/attachment.cgi?id=505589&action=edit "192 patch") -
Flags: approval1.9.2.14? → approval1.9.2.14+

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=558633#c32)• 14 years ago |
|  | |

Aye aye, cap'n!
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/6e7c740fdcb5>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/7a28315a5aec>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=558633#c33)• 14 years ago |
|  | |

Based on [comment 15](/show_bug.cgi?id=558633#c15 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\""), what is the best way to verify this fix for 1.9.1 and 1.9.2?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a25020572_280903)• 14 years ago |

Whiteboard: [sg:critical] fixed-in-tracemonkey [critsmash:patch] → [sg:critical] fixed-in-tracemonkey [critsmash:patch] [qa-examined-191] [qa-examined-192]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558633#a30475998_1689)• 14 years ago |

Group: core-security

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=558633#c34)• 13 years ago |
|  | |

Tracer has been long gone on trunk, marking verified.Status: RESOLVED → VERIFIED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=558633#c35)• 12 years ago |
|  | |

Filter on qa-project-auto-change:
Bug in removed tracer code, setting in-testsuite- flag.Flags: in-testsuite? → in-testsuite-
You need to [log in](/show_bug.cgi?id=558633&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_66f60614_20250124_163933.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/605672)
* [XML](/show_bug.cgi?ctype=xml&id=605672)

Closed
[Bug 605672](/show_bug.cgi?id=605672)

Opened 14 years ago
Closed 14 years ago

# "ASSERTION: Incorrect scope passed"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"ASSERTION: Incorrect scope passed"

## Categories

### (Core :: XPConnect, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XPConnect#XPConnect)

XPConnect
▾

Core :: XPConnect
Facilitates calling between JavaScript and XPCOM components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XPConnect&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XPConnect&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XPConnect)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [final+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=final%2B) |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | final+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: peterv)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/21a031df69f8c0549475a8cdc06f53f5?d=mm&size=40)  [peterv](/user_profile?user_id=24295)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[622456](/show_bug.cgi?id=622456 "RESOLVED FIXED - mz's fuzzer triggers crash marking wrapped natives crashes @ WrappedNativeMarker , WrappedNativeTearoffSweeper , XPCWrappedNativeProto::Mark() , js::gc::MarkChildren , js::gc::MarkKind etc...")

Dependency [tree](/showdependencytree.cgi?id=605672&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=605672)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [sg:critical?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---),
[verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jruderman](/user_profile?user_id=11608) | [in-testsuite](#c30 "14 years ago") | + |
| --- | --- | --- |
| [jruderman](/user_profile?user_id=11608) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (8 files)

| [testcase](/attachment.cgi?id=484551)  [14 years ago](#c0)  [Jesse Ruderman](/user_profile?user_id=11608)   505 bytes, image/svg+xml |  | [Details](/attachment.cgi?id=484551&action=edit) |
| --- | --- | --- |
| [stack trace](/attachment.cgi?id=484552)  [14 years ago](#c1)  [Jesse Ruderman](/user_profile?user_id=11608)   3.55 KB, text/plain |  | [Details](/attachment.cgi?id=484552&action=edit) |
| [crash testcase](/attachment.cgi?id=485707)  [14 years ago](#c3)  [moz\_bug\_r\_a4](/user_profile?user_id=194398)   703 bytes, text/html |  | [Details](/attachment.cgi?id=485707&action=edit) |
| [crash stack trace](/attachment.cgi?id=485754)  [14 years ago](#c4)  [Jesse Ruderman](/user_profile?user_id=11608)   11.78 KB, text/plain |  | [Details](/attachment.cgi?id=485754&action=edit) |
| [v1](/attachment.cgi?id=490219)  [14 years ago](#c7)  [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)   8.36 KB, patch | jst : [review+](#c9 "14 years ago") | [Details](/attachment.cgi?id=490219&action=edit) | [Diff](/attachment.cgi?id=490219&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=490219) |
| [v1 followup](/attachment.cgi?id=494984)  [14 years ago](#c14)  [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)   11.36 KB, patch | jst : [review+](#c15 "14 years ago") | [Details](/attachment.cgi?id=494984&action=edit) | [Diff](/attachment.cgi?id=494984&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=494984) |
| [191 branch patch](/attachment.cgi?id=505151)  [14 years ago](#c26)  [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)   23.39 KB, patch | christian : [approval1.9.1.17+](#a7946016_482154 "14 years ago") | [Details](/attachment.cgi?id=505151&action=edit) | [Diff](/attachment.cgi?id=505151&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=505151) |
| [192 branch patch](/attachment.cgi?id=505231)  [14 years ago](#c27)  [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)   22.71 KB, patch | christian : [approval1.9.2.14+](#a7946027_482154 "14 years ago") | [Details](/attachment.cgi?id=505231&action=edit) | [Diff](/attachment.cgi?id=505231&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=505231) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=605672#c0)• 14 years ago |
|  | |

Attached image
[testcase](attachment.cgi?id=484551)
— [Details](attachment.cgi?id=484551&action=edit)

###!!! ASSERTION: Incorrect scope passed: 'wrapper->GetScope() == aOldScope', file js/src/xpconnect/src/xpcwrappednative.cpp, line 1506

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=605672#c1)• 14 years ago |
|  | |

Attached file
[stack trace](attachment.cgi?id=484552)
— [Details](attachment.cgi?id=484552&action=edit)

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=605672#a462328_11608)• 14 years ago |

blocking2.0: --- → ?

|  | [moz\_bug\_r\_a4](/user_profile?user_id=194398) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=605672#c2)• 14 years ago |
|  | |

<http://mxr.mozilla.org/mozilla-central/source/content/base/src/nsDOMDocumentType.cpp#271>
271 nsCOMPtr<nsIDocument> oldOwnerDoc =
272 do\_QueryInterface(nsContentUtils::GetDocumentFromContext());
It seems that we use an unrelated document as oldOwnerDoc.
I'll attach a crash testcase.

|  | [moz\_bug\_r\_a4](/user_profile?user_id=194398) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=605672#c3)• 14 years ago |
|  | |

Attached file
[crash testcase](attachment.cgi?id=485707)
— [Details](attachment.cgi?id=485707&action=edit)

Trunk, 1.9.2 and 1.9.1 are affected.

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=605672#a491418_11608)• 14 years ago |

Whiteboard: [sg:critical?]

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=605672#c4)• 14 years ago |
|  | |

Attached file
[crash stack trace](attachment.cgi?id=485754)
— [Details](attachment.cgi?id=485754&action=edit)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=605672#c5)• 14 years ago |
|  | |

Peter, you've dealt with bugs like this before :)Assignee: nobody → petervblocking2.0: ? → final+

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=605672#c6)• 14 years ago |
|  | |

I'm seeing cases where this assertion is followed by additional assertions, which is distracting and scary.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=605672#c7)• 14 years ago |
|  | |

Attached patch

[v1](attachment.cgi?id=490219&action=diff)
— [Details](attachment.cgi?id=490219&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=490219)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=605672#c8)• 14 years ago |
|  | |

Peter, is this patch ready for review?

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=605672#a3603141_24295)• 14 years ago |

[Attachment #490219](/attachment.cgi?id=490219&action=edit "v1") -
Flags: review?(jst)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=605672#c9)• 14 years ago |
|  | |

Comment on [attachment 490219](/attachment.cgi?id=490219 "v1") [[details]](/attachment.cgi?id=490219&action=edit "v1") [[diff]](/attachment.cgi?id=490219&action=diff "v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=490219)
v1
r=jst
[Attachment #490219](/attachment.cgi?id=490219&action=edit "v1") -
Flags: review?(jst) → review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=605672#c10)• 14 years ago |
|  | |

Landed:
<http://hg.mozilla.org/mozilla-central/rev/78df45be19d1>Status: NEW → RESOLVEDClosed: 14 years agoResolution: --- → FIXED

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=605672#c11)• 14 years ago |
|  | |

This ended up actually causing test failures, except the test failures were hidden because of cross compartment adoptNode throwing. Once the fix for [bug 601803](/show_bug.cgi?id=601803 "RESOLVED FIXED - Support adopting a node cross-compartment") landed the assertions that this patch introduced showed up. Now I'm not 100% sure that backing this out instead of backing out the fix for [bug 601803](/show_bug.cgi?id=601803 "RESOLVED FIXED - Support adopting a node cross-compartment") was the right thing to do, but given that [bug 601803](/show_bug.cgi?id=601803 "RESOLVED FIXED - Support adopting a node cross-compartment") is a beta blocker, and this is not, I decided to back this out instead. And [bug 615763](/show_bug.cgi?id=615763 "RESOLVED FIXED - \"ASSERTION: Incorrect scope passed\" with simple adoptNode testcase") was filed after this landed as well, which seems to suggest that something really wasn't right with this change.Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=605672#c12)• 14 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/e243ef4f1e0e> (backout)
<http://hg.mozilla.org/mozilla-central/rev/0ff6d5984287> (merge)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=605672#c13)• 14 years ago |
|  | |

The failures caused by the combination of this and the adoptNode fix was these:
REFTEST TEST-UNEXPECTED-FAIL | file:///home/cltbld/talos-slave/mozilla-central\_fedora-debug\_test-crashtest/build/reftest/tests/editor/libeditor/html/crashtests/382778-1.html | assertion count 1 is more than expected 0 assertions
REFTEST TEST-UNEXPECTED-FAIL | file:///home/cltbld/talos-slave/mozilla-central\_fedora-debug\_test-crashtest/build/reftest/tests/editor/libeditor/base/crashtests/382527-1.html | assertion count 1 is more than expected 0 assertions
REFTEST TEST-UNEXPECTED-FAIL | file:///home/cltbld/talos-slave/mozilla-central\_fedora-debug\_test-crashtest/build/reftest/tests/js/src/xpconnect/crashtests/346512-1.xhtml | assertion count 1 is more than expected 0 assertions

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=605672#c14)• 14 years ago |
|  | |

Attached patch

[v1 followup](attachment.cgi?id=494984&action=diff)
— [Details](attachment.cgi?id=494984&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=494984)

This should fix the orange. The problem only happened when adopting nodes with children. We were using the toplevel node's wrapper as the scope, but because adopting traverses the tree downwards that wrapper was the first to be reparented and moved to the new scope. Using it as the scope for all the descendants was wrong. I ended up removing the aOldScope argument altogether, we should just use the existing wrapper of every node when reparenting it.
[Attachment #494984](/attachment.cgi?id=494984&action=edit "v1 followup") -
Flags: review?(jst)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=605672#c15)• 14 years ago |
|  | |

Comment on [attachment 494984](/attachment.cgi?id=494984 "v1 followup") [[details]](/attachment.cgi?id=494984&action=edit "v1 followup") [[diff]](/attachment.cgi?id=494984&action=diff "v1 followup") [[review]](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=494984)
v1 followup
Thanks peterv! r=jst
[Attachment #494984](/attachment.cgi?id=494984&action=edit "v1 followup") -
Flags: review?(jst) → review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=605672#c16)• 14 years ago |
|  | |

Re-landed v1 and also landed the followup fix.
<http://hg.mozilla.org/mozilla-central/rev/3b2d178f7299>
<http://hg.mozilla.org/mozilla-central/rev/e52f4987ec94>Status: REOPENED → RESOLVEDClosed: 14 years ago → 14 years agoResolution: --- → FIXED

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=605672#c17)• 14 years ago |
|  | |

I backed this out to investigate whether it caused [bug 617048](/show_bug.cgi?id=617048 "RESOLVED FIXED - Firefox 4.0b8pre crash in [@ nsXBLService::GetBinding(nsIContent*, nsIURI*, int, nsIPrincipal*, int*, nsXBLBinding**, nsTArray<nsIURI*, nsTArrayDefaultAllocator>&) ] [@ nsCOMPtr_base::assign_from_qi(nsQueryInterface, nsID const&) | xul.dll@0xbf3fb3 ]"):
<http://hg.mozilla.org/mozilla-central/pushloghtml?changeset=c7b784648b02>Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=605672#c18)• 14 years ago |
|  | |

So based on the backout, either this or [bug 588873](/show_bug.cgi?id=588873 "RESOLVED WORKSFORME - Firefox 4.0b Crash [@ NS_AccumulateFastLoadChecksum(unsigned int*, unsigned char const*, unsigned int, int) ]") caused [bug 617048](/show_bug.cgi?id=617048 "RESOLVED FIXED - Firefox 4.0b8pre crash in [@ nsXBLService::GetBinding(nsIContent*, nsIURI*, int, nsIPrincipal*, int*, nsXBLBinding**, nsTArray<nsIURI*, nsTArrayDefaultAllocator>&) ] [@ nsCOMPtr_base::assign_from_qi(nsQueryInterface, nsID const&) | xul.dll@0xbf3fb3 ]"). (I think my money is on [bug 588873](/show_bug.cgi?id=588873 "RESOLVED WORKSFORME - Firefox 4.0b Crash [@ NS_AccumulateFastLoadChecksum(unsigned int*, unsigned char const*, unsigned int, int) ]").)
I think it's ok to reland this after beta8 ships, but make sure it doesn't reland the same day as [bug 588873](/show_bug.cgi?id=588873 "RESOLVED WORKSFORME - Firefox 4.0b Crash [@ NS_AccumulateFastLoadChecksum(unsigned int*, unsigned char const*, unsigned int, int) ]").

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=605672#c19)• 14 years ago |
|  | |

I relanded this, I'll be monitoring crash-stats.
<http://hg.mozilla.org/mozilla-central/rev/83cb5ea3fe30>
<http://hg.mozilla.org/mozilla-central/rev/ad8da8012e3a>Status: REOPENED → RESOLVEDClosed: 14 years ago → 14 years agoResolution: --- → FIXED

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=605672#c20)• 14 years ago |
|  | |

I think this needs to be backported, it's most likely what is causing cross\_fuzz bugs on 3.6 and 3.5.

|  | [Ben Turner (not reading bugmail, use the needinfo flag!)](/user_profile?user_id=200444) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=605672#c22)• 14 years ago |
|  | |

Given that [bug 622456](/show_bug.cgi?id=622456 "RESOLVED FIXED - mz's fuzzer triggers crash marking wrapped natives crashes @ WrappedNativeMarker , WrappedNativeTearoffSweeper , XPCWrappedNativeProto::Mark() , js::gc::MarkChildren , js::gc::MarkKind etc...") is a dupe I think this should block the next stable releases.blocking1.9.1: --- → ?blocking1.9.2: --- → ?

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=605672#c23)• 14 years ago |
|  | |

The patches need small changes, I'm working on merging.

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=605672#a7928690_482154)• 14 years ago |

blocking1.9.1: ? → .17+blocking1.9.2: ? → .14+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=605672#c24)• 14 years ago |
|  | |

We would like to get these patches into the branches today, as the fuzzer is public (and we are now past code freeze). Is that possible? This should take priority over FF4 work FWIW.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=605672#a7928867_1689)• 14 years ago |

Blocks: [622456](/show_bug.cgi?id=622456 "RESOLVED FIXED - mz's fuzzer triggers crash marking wrapped natives crashes @ WrappedNativeMarker , WrappedNativeTearoffSweeper , XPCWrappedNativeProto::Mark() , js::gc::MarkChildren , js::gc::MarkKind etc...")

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=605672#c25)• 14 years ago |
|  | |

I'm trying to get them done. I have patches that build but am currently running mochitests since the patches are a bit different and I want to make sure I didn't break anything while merging.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=605672#c26)• 14 years ago |
|  | |

Attached patch

[191 branch patch](attachment.cgi?id=505151&action=diff)
— [Details](attachment.cgi?id=505151&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=505151)

Passes mochitest.
[Attachment #505151](/attachment.cgi?id=505151&action=edit "191 branch patch") -
Flags: approval1.9.1.17?

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=605672#c27)• 14 years ago |
|  | |

Attached patch

[192 branch patch](attachment.cgi?id=505231&action=diff)
— [Details](attachment.cgi?id=505231&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=605672&attachment=505231)

Passes mochitest.
[Attachment #505231](/attachment.cgi?id=505231&action=edit "192 branch patch") -
Flags: approval1.9.2.14?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=605672#a7946016_482154)• 14 years ago |

[Attachment #505151](/attachment.cgi?id=505151&action=edit "191 branch patch") -
Flags: approval1.9.1.17? → approval1.9.1.17+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=605672#a7946027_482154)• 14 years ago |

[Attachment #505231](/attachment.cgi?id=505231&action=edit "192 branch patch") -
Flags: approval1.9.2.14? → approval1.9.2.14+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=605672#c28)• 14 years ago |
|  | |

Landed on branches:
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/8465508094bc>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/d7c24aa07c30>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=605672#c29)• 14 years ago |
|  | |

Verified crash in 1.9.1.16 with crashtest and fix in 1.9.1.17 with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.17) Gecko/20110121 Firefox/3.5.17 ( .NET CLR 3.5.30729).
Verified crash in 1.9.2.13 with crashtest and fix in 1.9.2.14 with Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.14) Gecko/20110121 Firefox/3.6.14 ( .NET CLR 3.5.30729).Keywords: [verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=605672#a13919412_1689)• 14 years ago |

Group: core-security

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=605672#c30)• 14 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/90c1ab45b6c5>Flags: in-testsuite+
You need to [log in](/show_bug.cgi?id=605672&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_04b0cdf5_20250124_163936.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/614499)
* [XML](/show_bug.cgi?ctype=xml&id=614499)

Closed
[Bug 614499](/show_bug.cgi?id=614499)

Opened 14 years ago
Closed 14 years ago

# Crash [@ nsSHTransaction::GetPrev ]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ nsSHTransaction::GetPrev ]

## Categories

### (Core :: DOM: Navigation, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Navigation#DOM%3A%20Navigation)

DOM: Navigation
▾

Core :: DOM: Navigation
For bugs with HTML’s [navigate](https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate) algorithm and browsing contexts.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Navigation&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Navigation&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Navigation)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Windows 7

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [final+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=final%2B) |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | final+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: smaug)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[612881](/show_bug.cgi?id=612881 "RESOLVED FIXED - crash [@ ns_if_addref<nsIDOMHTMLCanvasElement*>(nsIDOMHTMLCanvasElement*) ] [@ ns_if_addref<nsIRequest*>(nsIRequest*) ] [@ ns_if_addref<nsPresContext*>(nsPresContext*) ] [@ ns_if_addref<nsICancelable*>(nsICancelable*) ]"), [612887](/show_bug.cgi?id=612887 "RESOLVED FIXED - crash [@ nsSHistory::RemoveEntries(nsTArray<unsigned __int64, nsTArrayDefaultAllocator>&, int) ]")

Dependency [tree](/showdependencytree.cgi?id=614499&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=614499)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, testcase, Whiteboard: [sg:critical] testcase doesn't affect < FF4 [qa-needs-STR])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical] testcase doesn't affect < FF4 [qa-needs-STR]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jruderman](/user_profile?user_id=11608) | [in-testsuite](#c26 "14 years ago") | + |
| --- | --- | --- |
| [jruderman](/user_profile?user_id=11608) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ nsSHTransaction::GetPrev ]](https://crash-stats.mozilla.org/signature/?signature=nsSHTransaction%3A%3AGetPrev)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [testcase (crashes Firefox when loaded)](/attachment.cgi?id=492931)  [14 years ago](#c0)  [Jesse Ruderman](/user_profile?user_id=11608)   341 bytes, text/html |  | [Details](/attachment.cgi?id=492931&action=edit) |
| --- | --- | --- |
| [stack trace](/attachment.cgi?id=492932)  [14 years ago](#c1)  [Jesse Ruderman](/user_profile?user_id=11608)   12.57 KB, text/plain |  | [Details](/attachment.cgi?id=492932&action=edit) |
| [patch, clear the pointers when modifying mListRoot](/attachment.cgi?id=492984)  [14 years ago](#c7)  [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)   888 bytes, patch | bzbarsky : [review+](#c11 "14 years ago")  christian : [approval1.9.2.14-](#a3839244_482154 "14 years ago")  christian : [approval1.9.1.17-](#a3839244_482154 "14 years ago") | [Details](/attachment.cgi?id=492984&action=edit) | [Diff](/attachment.cgi?id=492984&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=614499&attachment=492984) |
| [null check aNext](/attachment.cgi?id=500990)  [14 years ago](#c19)  [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)   1.62 KB, patch | bzbarsky : [review+](#c20 "14 years ago")  christian : [approval1.9.2.14+](#c21 "14 years ago")  christian : [approval1.9.1.17+](#c21 "14 years ago") | [Details](/attachment.cgi?id=500990&action=edit) | [Diff](/attachment.cgi?id=500990&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=614499&attachment=500990) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=614499#c0)• 14 years ago |
|  | |

Attached file
[testcase (crashes Firefox when loaded)](attachment.cgi?id=492931)
— [Details](attachment.cgi?id=492931&action=edit)

This might be the same bug as topcrash [bug 612881](/show_bug.cgi?id=612881 "RESOLVED FIXED - crash [@ ns_if_addref<nsIDOMHTMLCanvasElement*>(nsIDOMHTMLCanvasElement*) ] [@ ns_if_addref<nsIRequest*>(nsIRequest*) ] [@ ns_if_addref<nsPresContext*>(nsPresContext*) ] [@ ns_if_addref<nsICancelable*>(nsICancelable*) ]") / [bug 612887](/show_bug.cgi?id=612887 "RESOLVED FIXED - crash [@ nsSHistory::RemoveEntries(nsTArray<unsigned __int64, nsTArrayDefaultAllocator>&, int) ]").

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=614499#c1)• 14 years ago |
|  | |

Attached file
[stack trace](attachment.cgi?id=492932)
— [Details](attachment.cgi?id=492932&action=edit)

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=614499#c2)• 14 years ago |
|  | |

The top frame of the stack is random, so this could be anywhere between topcrash #1 and topcrash #11. Fixing it in beta8 would be nice.blocking2.0: --- → ?

|  | [Justin Lebar (not reading bugmail)](/user_profile?user_id=303454) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=614499#c3)• 14 years ago |
|  | |

Is this win7 only? It doesn't crash my Linux x64 box.
Will definitely look at this tomorrow.

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=614499#c4)• 14 years ago |
|  | |

Debug builds crash on Windows, Mac, and Linux. Opt builds crash on at least Windows and Mac.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a9742_39966)• 14 years ago |

Assignee: nobody → Olli.Pettay

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=614499#c5)• 14 years ago |
|  | |

Justin, I took this before noticing your comment.
I assume this might be a regression from my changes.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=614499#c6)• 14 years ago |
|  | |

Ah, the code causing this has been there for ages, at least from year 2001.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=614499#c7)• 14 years ago |
|  | |

Attached patch

[patch, clear the pointers when modifying mListRoot](attachment.cgi?id=492984&action=diff) (obsolete)
— [Details](attachment.cgi?id=492984&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=614499&attachment=492984)

[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: review?(bzbarsky)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=614499#c8)• 14 years ago |
|  | |

Paul, does session restore get nsISHTransaction.prev anywhere in the branches?
C++ does seem to call ::GetPrev in 1.9.1 nor 1.9.2.

|  | [Paul O'Shannessy [:zpao] (not bugmail, email directly)](/user_profile?user_id=301919) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=614499#c9)• 14 years ago |
|  | |

(In reply to [comment #8](/show_bug.cgi?id=614499#c8 "RESOLVED FIXED - Crash [@ nsSHTransaction::GetPrev ]"))
> Paul, does session restore get nsISHTransaction.prev anywhere in the branches?
> C++ does seem to call ::GetPrev in 1.9.1 nor 1.9.2.
I didn't find any calls from sessionstore. I don't think it's ever used nsISHTransaction.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=614499#c10)• 14 years ago |
|  | |

Ok, thanks. I think in that case it isn't absolutely critical to
take this to branches. But for trunk we really need this.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=614499#c11)• 14 years ago |
|  | |

Comment on [attachment 492984](/attachment.cgi?id=492984 "patch, clear the pointers when modifying mListRoot") [[details]](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") [[diff]](/attachment.cgi?id=492984&action=diff "patch, clear the pointers when modifying mListRoot") [[review]](/page.cgi?id=splinter.html&ignore=&bug=614499&attachment=492984)
patch, clear the pointers when modifying mListRoot
r=me
[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: review?(bzbarsky) → review+

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a86703_39966)• 14 years ago |

[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: approval2.0?

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a131164_5038)• 14 years ago |

blocking2.0: ? → final+

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a131265_39966)• 14 years ago |

[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: approval2.0?

|  | [Scoobidiver (away)](/user_profile?user_id=386758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a170913_386758)• 14 years ago |

Summary: Crash [@ nsSHTransaction::GetPrev] → Crash [@ nsSHTransaction::GetPrev ]

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=614499#c12)• 14 years ago |
|  | |

The patch applies cleanly to branches.
I'm not sure whether we really need it there, but should be safe.blocking1.9.1: --- → ?blocking1.9.2: --- → ?

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=614499#c13)• 14 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/92facbe5957e>Status: NEW → RESOLVEDClosed: 14 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a469531_1689)• 14 years ago |

blocking1.9.1: ? → ---blocking1.9.2: ? → ---
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=614499#c14)• 14 years ago |
|  | |

Comment on [attachment 492984](/attachment.cgi?id=492984 "patch, clear the pointers when modifying mListRoot") [[details]](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") [[diff]](/attachment.cgi?id=492984&action=diff "patch, clear the pointers when modifying mListRoot") [[review]](/page.cgi?id=splinter.html&ignore=&bug=614499&attachment=492984)
patch, clear the pointers when modifying mListRoot
Approved for 1.9.2.14 and 1.9.1.17, a=dveditz for release-drivers
[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: approval1.9.2.14+
[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: approval1.9.1.17+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a469673_1689)• 14 years ago |

Whiteboard: [sg:critical] → [sg:critical] testcase doesn't affect < FF4

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a2132878_1689)• 14 years ago |

blocking1.9.1: --- → neededblocking1.9.2: --- → needed

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a3493833_1689)• 14 years ago |

blocking1.9.1: needed → .17+blocking1.9.2: needed → .14+

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=614499#c15)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/36da01644e41>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/12d4747b0a6a>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=614499#c16)• 14 years ago |
|  | |

Backed out from branches, since there we some strange errors.
Not sure whether those were caused by the patch or by something else.
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) → [?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) → [?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=614499#c17)• 14 years ago |
|  | |

Seems like a valid problem. Investigating.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=614499#c18)• 14 years ago |
|  | |

Ok, need to take one null check from [Bug 534178](/show_bug.cgi?id=534178 "RESOLVED FIXED - When loading Plugin Check page, browser back does not work & unexpected same URL entries are generated in navigation history.") to branches.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=614499#c19)• 14 years ago |
|  | |

Attached patch

[null check aNext](attachment.cgi?id=500990&action=diff)
— [Details](attachment.cgi?id=500990&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=614499&attachment=500990)

[Attachment #500990](/attachment.cgi?id=500990&action=edit "null check aNext") -
Flags: review?(bzbarsky)
[Attachment #500990](/attachment.cgi?id=500990&action=edit "null check aNext") -
Flags: approval1.9.2.14?
[Attachment #500990](/attachment.cgi?id=500990&action=edit "null check aNext") -
Flags: approval1.9.1.17?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a3597291_482154)• 14 years ago |

No longer blocks: [612881](/show_bug.cgi?id=612881 "RESOLVED FIXED - crash [@ ns_if_addref<nsIDOMHTMLCanvasElement*>(nsIDOMHTMLCanvasElement*) ] [@ ns_if_addref<nsIRequest*>(nsIRequest*) ] [@ ns_if_addref<nsPresContext*>(nsPresContext*) ] [@ ns_if_addref<nsICancelable*>(nsICancelable*) ]")

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a3609696_482154)• 14 years ago |

Blocks: [612881](/show_bug.cgi?id=612881 "RESOLVED FIXED - crash [@ ns_if_addref<nsIDOMHTMLCanvasElement*>(nsIDOMHTMLCanvasElement*) ] [@ ns_if_addref<nsIRequest*>(nsIRequest*) ] [@ ns_if_addref<nsPresContext*>(nsPresContext*) ] [@ ns_if_addref<nsICancelable*>(nsICancelable*) ]")

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=614499#c20)• 14 years ago |
|  | |

Comment on [attachment 500990](/attachment.cgi?id=500990 "null check aNext") [[details]](/attachment.cgi?id=500990&action=edit "null check aNext") [[diff]](/attachment.cgi?id=500990&action=diff "null check aNext") [[review]](/page.cgi?id=splinter.html&ignore=&bug=614499&attachment=500990)
null check aNext
r=me
[Attachment #500990](/attachment.cgi?id=500990&action=edit "null check aNext") -
Flags: review?(bzbarsky) → review+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=614499#c21)• 14 years ago |
|  | |

Comment on [attachment 500990](/attachment.cgi?id=500990 "null check aNext") [[details]](/attachment.cgi?id=500990&action=edit "null check aNext") [[diff]](/attachment.cgi?id=500990&action=diff "null check aNext") [[review]](/page.cgi?id=splinter.html&ignore=&bug=614499&attachment=500990)
null check aNext
Approving updated patch
[Attachment #500990](/attachment.cgi?id=500990&action=edit "null check aNext") -
Flags: approval1.9.2.14?
[Attachment #500990](/attachment.cgi?id=500990&action=edit "null check aNext") -
Flags: approval1.9.2.14+
[Attachment #500990](/attachment.cgi?id=500990&action=edit "null check aNext") -
Flags: approval1.9.1.17?
[Attachment #500990](/attachment.cgi?id=500990&action=edit "null check aNext") -
Flags: approval1.9.1.17+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a3839244_482154)• 14 years ago |

[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: approval1.9.2.14-
[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: approval1.9.2.14+
[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: approval1.9.1.17-
[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Flags: approval1.9.1.17+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a3839291_482154)• 14 years ago |

[Attachment #492984](/attachment.cgi?id=492984&action=edit "patch, clear the pointers when modifying mListRoot") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=614499#c22)• 14 years ago |
|  | |

(In reply to [comment #16](/show_bug.cgi?id=614499#c16 "RESOLVED FIXED - Crash [@ nsSHTransaction::GetPrev ]"))
> Backed out from branches, since there we some strange errors.
> Not sure whether those were caused by the patch or by something else.
This caused a huge crash spike, not something else
<http://crash-stats.mozilla.com/products/Firefox/versions/3.6.14pre>
[http://crash-stats.mozilla.com/report/list?range\_value=2&range\_unit=weeks&signature=nsSHTransaction%3A%3ASetNext%28nsISHTransaction\*%29&version=Firefox%3A3.6.14pre](http://crash-stats.mozilla.com/report/list?range_value=2&range_unit=weeks&signature=nsSHTransaction%3A%3ASetNext%28nsISHTransaction*%29&version=Firefox%3A3.6.14pre)
We definitely need the second patch with the null check.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=614499#c23)• 14 years ago |
|  | |

Yeah. I'll push the null check patch this weekend.

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=614499#c24)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/5873543f363c>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/34157257960e>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=614499#c25)• 14 years ago |
|  | |

Are there any STR for branches? I see that it is noted that the testcase doesn't work there.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a5412835_280903)• 14 years ago |

Whiteboard: [sg:critical] testcase doesn't affect < FF4 → [sg:critical] testcase doesn't affect < FF4 [qa-needs-STR]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a10865818_1689)• 14 years ago |

Group: core-security

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=614499#a17397928_1)• 14 years ago |

Crash Signature: [@ nsSHTransaction::GetPrev ]

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=614499#c26)• 14 years ago |
|  | |

Crashtest: <http://hg.mozilla.org/mozilla-central/rev/bed7a9570b40>Flags: in-testsuite+
You need to [log in](/show_bug.cgi?id=614499&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_a557a13b_20250126_021732.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sat Jan 25 2025 18:17:32 PST

* **Bug ID:**
  558531,
  558541,
  558633,
  563243,
  576649,
  596232,
  600853,
  600974,
  602115,
  605672,
  613376,
  614499,
  563618

---

13 bugs found.

| [ID](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [558531](/show_bug.cgi?id=558531 "RESOLVED FIXED - Typo in JS_ResolveStandardClass causes built-in prototypes to be overwritten") |  | [Typo in JS\_ResolveStandardClass causes built-in prototypes to be overwritten](/show_bug.cgi?id=558531) | Core | JavaScript Engine | dmandelin | RESO | FIXE | 2013-03-20 |
| [596232](/show_bug.cgi?id=596232 "RESOLVED FIXED - nsXULTemplateBuilder/nsXULTemplateQueryProcessorXML load new data sources at unsafe time") |  | [nsXULTemplateBuilder/nsXULTemplateQueryProcessorXML load new data sources at unsafe time](/show_bug.cgi?id=596232) | Core | XUL | enndeakin | RESO | FIXE | 2011-03-29 |
| [600853](/show_bug.cgi?id=600853 "RESOLVED FIXED - last ditch GC and OOM reporting with title lock held") |  | [last ditch GC and OOM reporting with title lock held](/show_bug.cgi?id=600853) | Core | JavaScript Engine | igor | RESO | FIXE | 2011-03-29 |
| [602115](/show_bug.cgi?id=602115 "RESOLVED FIXED - Crash [@ txExecutionState::popTemplateRule]") |  | [Crash [@ txExecutionState::popTemplateRule]](/show_bug.cgi?id=602115) | Core | XSLT | jonas | RESO | FIXE | 2011-06-13 |
| [558541](/show_bug.cgi?id=558541 "RESOLVED FIXED - js_SetPropertyHelper doesn't notify tracer when setting a non-writable property with strict option on or \"Assertion failure: s0->isQuad(), at ../jstracer.cpp\" or \"Assertion failure: v_ins->isF64(), at ../jstracer.cpp\"") |  | [js\_SetPropertyHelper doesn't notify tracer when setting a non-writable property with strict option on or "Assertion failure: s0->isQuad(), at ../jstracer.cpp" or "Assertion failure: v\_ins->isF64(), at ../jstracer.cpp"](/show_bug.cgi?id=558541) | Core | JavaScript Engine | jwalden | RESO | FIXE | 2011-03-29 |
| [576649](/show_bug.cgi?id=576649 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing") |  | ["ASSERTION: Invalid offset" and more with -moz-column, abs pos, huge letter-spacing](/show_bug.cgi?id=576649) | Core | Layout | MatsPalmgren\_bugz | RESO | FIXE | 2011-06-20 |
| [563243](/show_bug.cgi?id=563243 "RESOLVED FIXED - (64-bit) Invalid read / write when testcase is run in valgrind") |  | [(64-bit) Invalid read / write when testcase is run in valgrind](/show_bug.cgi?id=563243) | Core | JavaScript Engine | mrbkap | RESO | FIXE | 2013-03-20 |
| [605672](/show_bug.cgi?id=605672 "RESOLVED FIXED - \"ASSERTION: Incorrect scope passed\"") |  | ["ASSERTION: Incorrect scope passed"](/show_bug.cgi?id=605672) | Core | XPConnect | peterv | RESO | FIXE | 2011-06-20 |
| [614499](/show_bug.cgi?id=614499 "RESOLVED FIXED - Crash [@ nsSHTransaction::GetPrev ]") |  | [Crash [@ nsSHTransaction::GetPrev ]](/show_bug.cgi?id=614499) | Core | DOM: Navigation | smaug | RESO | FIXE | 2011-06-20 |
| [613376](/show_bug.cgi?id=613376 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin") |  | [[Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin](/show_bug.cgi?id=613376) | Core Graveyard | Plug-ins | smichaud | RESO | FIXE | 2022-05-16 |
| [563618](/show_bug.cgi?id=563618 "RESOLVED FIXED - Crash due to writing past the end of buffer [@ nsEUCJPToUnicodeV2::Convert]") |  | [Crash due to writing past the end of buffer [@ nsEUCJPToUnicodeV2::Convert]](/show_bug.cgi?id=563618) | Core | Internationalization | smontagu | RESO | FIXE | 2011-05-18 |
| [600974](/show_bug.cgi?id=600974 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite") |  | [crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite](/show_bug.cgi?id=600974) | Core | Internationalization | smontagu | RESO | FIXE | 2011-05-18 |
| [558633](/show_bug.cgi?id=558633 "VERIFIED FIXED - TM: (64-bit) \"Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp\"") |  | [TM: (64-bit) "Assertion failed: LIR type error (start of writer pipeline): arg 1 of 'orq' is 'immi' which has type int32 (expected int64): 0 (../nanojit/LIR.cpp"](/show_bug.cgi?id=558633) | Core | JavaScript Engine | brendan | VERI | FIXE | 2013-03-11 |

13 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=558531%2C558541%2C558633%2C563243%2C576649%2C596232%2C600853%2C600974%2C602115%2C605672%2C613376%2C614499%2C563618&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |



=== Content from www.redhat.com_f61283e2_20250124_163912.html ===

[Skip to content](#rhb-main-content)
## Featured links

* [![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)](https://www.redhat.com/en/summit)
* [Support](https://access.redhat.com/)
* [Documentation](https://docs.redhat.com/en)
* [Console](https://cloud.redhat.com/)
* [Developers](https://developers.redhat.com/)
* [Start a trial](/en/products/trials)
* All Red Hat
  + For customers
    - [Customer support](https://access.redhat.com/)
    - [Subscription management](https://access.redhat.com/management)
    - [Support cases](https://access.redhat.com/support/cases)
    - [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
    - [Find a partner](https://catalog.redhat.com/partners)
  + For partners
    - [Partner portal](https://connect.redhat.com/partner-admin/dashboard)
    - [Partner support](https://connect.redhat.com/en/support)
    - [Become a partner](https://connect.redhat.com/)
  + Try, buy, & sell
    - [Red Hat Marketplace](https://marketplace.redhat.com/en-us)
    - [Red Hat Store](https://www.redhat.com/en/store)
    - [Contact sales](/en/contact)
    - [Start a trial](/en/products/trials)
  + Learning resources
    - [Documentation](https://docs.redhat.com/en)
    - [Training and certification](/en/services/training-and-certification)
    - [Hybrid cloud learning hub](https://cloud.redhat.com/learn)
    - [Interactive labs](/en/interactive-labs)
    - [Learning community](https://learn.redhat.com/)
    - [Red Hat TV](https://tv.redhat.com)
  + Open source communities
    - [Global advocacy](https://access.redhat.com/accelerators)
    - [How we contribute](/en/about/our-community-contributions)
[Red Hat](/en)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* Explore more
### Platform products

* [Red Hat Enterprise LinuxA flexible, stable operating system to support hybrid cloud innovation.](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShiftA container platform to build, modernize, and deploy applications at scale.](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation PlatformNew versionA foundation for implementing enterprise-wide automation.](/en/technologies/management/ansible)
### Try & buy

* [Start a trialAssess a product with a no-cost trial.](/en/products/trials)
* [Buy onlineBuy select products and services in the Red Hat Store.](https://www.redhat.com/en/store)
* [Integrate with major cloud providersBuy Red Hat solutions using committed spend from providers, including:
  ![Cloud providers: Amazon Web Services, Microsoft Azure, and Google Cloud](https://www.redhat.com/rhdc/managed-files/cloud-providers-2x.png)](/en/partners/certified-cloud-and-service-providers)
### Featured

* [Red Hat Enterprise Linux AI](/en/technologies/linux-platforms/enterprise-linux/ai)
* [Red Hat OpenShift AI](/en/technologies/cloud-computing/openshift/openshift-ai)
* [Red Hat OpenShift Virtualization](/en/technologies/cloud-computing/openshift/virtualization)
* [Red Hat OpenShift Service on AWS](/en/technologies/cloud-computing/openshift/aws)
* [Microsoft Azure Red Hat OpenShift](/en/technologies/cloud-computing/openshift/azure)
[See all products](/en/technologies/all-products)

* [Application platformSimplify the way you build, deploy, manage, and secure apps across the hybrid cloud.](/en/solutions/application-platform)
* [Artificial intelligenceBuild, deploy, and monitor AI models and apps with Red Hat's open source platforms.](/en/solutions/ai)
* [Edge computingDeploy workloads closer to the source with security-focused edge technology.](/en/products/edge)

* [IT automationUnite disparate tech, teams, and environments with 1 comprehensive automation platform.](/en/solutions/it-automation)
* [Linux standardizationGet consistency across operating environments with an open, flexible infrastructure.](/en/solutions/linux-standardization)

* [SecurityDeliver software using trusted platforms and real-time security scanning and remediation.](/en/solutions/trusted-software-supply-chain)
* [VirtualizationModernize operations using a single platform for virtualized and containerized workloads.](/en/solutions/virtualization)
### By industry

* [Automotive](/en/solutions/automotive)
* [Financial services](/en/solutions/financial-services)
* [Healthcare](/en/solutions/healthcare)
* [Industrial sector](/en/solutions/industrial-sector)
* [Media and entertainment](/en/solutions/media-entertainment)
* [Public sector](/en/solutions/public-sector)
* [Telecommunications](/en/solutions/telecommunications)
[Explore solutions](/en/solutions)
### [Services](/en/services)

* [Consulting](/en/services/consulting)
* [Services for AI](/en/services/consulting/red-hat-consulting-for-ai)
* [Technical Account Management](/en/services/support/technical-account-management)
### [Training & certification](/en/services/training-and-certification)

* [All courses and exams](/en/services/training/all-courses-exams)
* [All certifications](/en/services/certifications)
* [Verify a certification](https://www.redhat.com/rhtapps/services/verify/)
* [Skills assessment](https://skills.ole.redhat.com)
* [Learning subscription](/en/services/training/learning-subscription)
* [Learning community](https://learn.redhat.com/)
* [Red Hat Academy](/en/services/training/red-hat-academy)
* [FAQs](/en/services/training-and-certification/faq)
* [Connect with learning experts](/en/services/training-and-certification/contact-us)
### Featured

* [Ansible Basics: Automation Technical Overview (No cost)](/en/services/training/do007-ansible-essentials-simplicity-automation-technical-overview)
* [Containers, Kubernetes and Red Hat OpenShift Technical Overview (No cost)](/en/services/training/do080-deploying-containerized-applications-technical-overview)
* [Red Hat Enterprise Linux Technical Overview (No cost)](/en/services/training/rh024-red-hat-linux-technical-overview)
* [Red Hat Certified System Administrator exam](/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam)
* [Red Hat System Administration I](/en/services/training/rh124-red-hat-system-administration-i)
[Explore services](/en/services)
### Topics

* [AI](/en/topics/ai)
* [Application modernization](/en/topics/application-modernization)
* [Automation](/en/topics/automation)
* [Cloud computing](/en/topics/cloud-computing)
* [Cloud-native applications](/en/topics/cloud-native-apps)
* [Containers](/en/topics/containers)
* [DevOps](/en/topics/devops)
* [Edge computing](/en/topics/edge-computing)
* [Linux](/en/topics/linux)
* [Virtualization](/en/topics/virtualization)
* [See all topics](/en/topics)
### Articles

* [What is InstructLab?](/en/topics/ai/what-is-instructlab)
* [What are cloud services?](/en/topics/cloud-computing/what-are-cloud-services)
* [What is edge computing?](/en/topics/edge-computing/what-is-edge-computing)
* [What is hybrid cloud?](/en/topics/cloud-computing/what-is-hybrid-cloud)
* [Why build a Red Hat cloud?](/en/topics/cloud-computing/why-choose-red-hat-cloud)
* [Cloud vs. edge](/en/topics/cloud-computing/cloud-vs-edge)
* [Red Hat OpenShift vs. Kubernetes](/en/technologies/cloud-computing/openshift/red-hat-openshift-kubernetes)
* [Learning Ansible basics](/en/topics/automation/learning-ansible-tutorial)
* [What is Linux?](/en/topics/linux/what-is-linux)
### More to explore

* [Blog](/en/blog)
* [Customer success stories](/en/success-stories)
* [Events and webinars](/en/events)
* [Newsroom](/en/about/newsroom)
* [Podcasts and video series](/en/red-hat-original-series)
* [Documentation](https://docs.redhat.com/en)
* [Resource library](/en/resources)
* [Training and certification](/en/services/training-and-certification)
[Explore resources](/en/resources)
### For customers

* [Our partners](/en/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
### For partners

* [Partner Connect](https://connect.redhat.com)
* [Become a partner](https://connect.redhat.com/en/benefits-of-being-a-partner)
* [Training](https://connect.redhat.com/en/training)
* [Support](https://connect.redhat.com/en/support)
* [Access the partner portal](https://connect.redhat.com/partner-admin/dashboard)
### About us

* [Our company](/en/about/company)
* [How we work](/en/about/our-culture)
* [Our social impact](/en/about/community-social-responsibility)
* [Development model](/en/about/development-model)
* [Subscription model](/en/about/value-of-Red-Hat)
* [Product support](/en/services/support)
### Open source

* [Open source commitments](/en/about/open-source)
* [How we contribute](/en/about/our-community-contributions)
* [Red Hat on GitHub](https://github.com/RedHatOfficial)
### Company details

* [Analyst relations](/en/about/analysts)
* [Blog](/en/blog)
* [Locations](/en/about/office-locations)
* [Newsroom](/en/about/newsroom)
[Explore Red Hat](/en/about)[Contact us](/en/contact)For customers

* [Customer support](https://access.redhat.com/)* [Subscription management](https://access.redhat.com/management)* [Support cases](https://access.redhat.com/support/cases)* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)* [Find a partner](https://catalog.redhat.com/partners)
For partners

* [Partner portal](https://connect.redhat.com/partner-admin/dashboard)* [Partner support](https://connect.redhat.com/en/support)* [Become a partner](https://connect.redhat.com/)
Try, buy, & sell

* [Red Hat Marketplace](https://marketplace.redhat.com/en-us)* [Red Hat Store](https://www.redhat.com/en/store)* [Contact sales](/en/contact)* [Start a trial](/en/products/trials)
Learning resources

* [Documentation](https://docs.redhat.com/en)* [Training and certification](/en/services/training-and-certification) * [Hybrid cloud learning hub](https://cloud.redhat.com/learn)* [Interactive labs](/en/interactive-labs)* [Learning community](https://learn.redhat.com/)* [Red Hat TV](https://tv.redhat.com)
Open source communities

* [Global advocacy](https://access.redhat.com/accelerators)* [How we contribute](/en/about/our-community-contributions)
For you
New
### Recommendations

As you browse redhat.com, we'll recommend resources you may like. For now, try these.

---

* [All Red Hat products](/en/technologies/all-products)
* [Tech topics](/en/topics)
* [Red Hat resources](/en/resources)
![close](https://static.redhat.com/libs/redhat/rh-iconfont/latest/svg/web-icon-close.svg)[![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)Red Hat Summit](https://www.redhat.com/en/summit)[Support](https://access.redhat.com/)[Documentation](https://docs.redhat.com/en)[Console](https://cloud.redhat.com/)[Developers](https://developers.redhat.com/)[Start a trial](/en/products/trials)[Contact](/en/contact)Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol[Contact us](/en/contact)
English
### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol![](/themes/custom/rh_base_ui/dist/img/talk-bubble.svg)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* [Contact us](/en/contact)

### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)

# Red Hat Support

## Go beyond support by engaging with our experts

Our teams collaborate with you to ensure you accomplish your goals with Red Hat solutions. The relationship we build with you is designed to provide you with the tools and resources you need to find success on your IT journey.

![](/rhdc/managed-files/support-header.svg)

## Configured for your success

We develop a holistic understanding of your experience as a customer by ensuring our support and engineering teams work together.

Our support team works hand in hand with the best engineers in the industry to quickly turn customer feedback into product improvements. This direct line of communication allows us to hone in on proactive fixes that can impact your bottom line.

### Quick links

* Search our [Knowledgebase](https://access.redhat.com/search/#/?q=&p=1&sort=relevant&scoped&documentKind=Knowledgebase)
* Find [product documentation](https://access.redhat.com/documentation/en-us/)
* Access the [product security center](https://access.redhat.com/security/)
* Connect with [our support team](https://access.redhat.com/support)
* Team up with a [technical account manager](/en/services/support/technical-account-management "Technical account management")
* Take advantage of [partner support](https://connect.redhat.com/en/support)

## Find the right level of support

We have different tiers of support designed to meet your unique needs.

|  | Self-support | Standard | Premium |
| --- | --- | --- | --- |
| Access to Red Hat products | checkmark | checkmark | checkmark |
| Access to our knowledgebase and tools in our award-winning Customer Portal | checkmark | checkmark | checkmark |
| Access to support engineers during standard business hours |  | checkmark | checkmark |
| Access to support engineers 24x7 for high-severity issues |  |  | checkmark |

We also feature specialized support options that can be tailored to the unique needs of companies of all sizes and industries. The Red Hat® [Enhanced Solution Support](/en/resources/enhanced-solution-support-datasheet "Red Hat Enhanced Solution Support: 24x7 engineering support") offering reduces downtime and boosts confidence through access to senior level engineers, as well as resolution and restoration SLAs—helping you stay up and running as you innovate, scale, and deploy. Our engineers help restore your operations quickly and accelerate the path to final resolution, identifying the root cause which helps protect against recurrences in the future. Enhanced Solution Support engineers, who are already familiar with your environment, will be there to assist with critical issues in production environments so that you can consistently deliver the cloud services your customers demand. This offering is available for Red Hat OpenShift® and Red Hat OpenStack® Platform customers.

### Personalized support

Connect with a technical adviser for collaborative planning and specialized guidance. Our Technical Account Managers help you streamline deployments, resolve issues, and shape your technology strategy to meet your toughest business challenges.

[Explore Technical Account Management](/en/services/support/technical-account-management)

## Award winners since 2011

We’ve evolved the traditional software subscription model, combining the best elements of our services to exceed customer expectations. The Association of Support Professionals has honored Red Hat’s Customer Portal as one of “The Top Ten Best Support Websites” for 13 years running.

[See why the Customer Portal keeps earning industry recognition](https://access.redhat.com/)

![Gold and green star with text ASP best support websites of 2023](/rhdc/managed-files/ASP-Award-Design.jpg)

## What they're saying

![BSE logo](/rhdc/managed-files/bse-logo-2.png)

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> We have found the support from Red Hat to be exemplary. Whenever we need anything from them, they have given it … Red Hat is now our backbone. Our business cannot run if Red Hat is not there.
>
> Ashishkumar Chauhan
>
> CEO, BSE

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> I like the fact that they really dig into things and then provide answers. As the single Linux guy, I kind of need that second admin next to me sometimes to say, "Hey, what about this?" and I am able to do that through the portal. I get my questions answered and trouble tickets resolved.
>
> Erik Widholm
>
> Sr. Enterprise Engineer

[Read more user reviews](/en/technologies/linux-platforms/enterprise-linux/user-reviews)

## Have questions?

[Contact Support team](https://access.redhat.com/support)

[Visit the Customer Portal](https://access.redhat.com/)

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](/en)[LinkedIn](https://www.linkedin.com/company/red-hat)[YouTube](https://www.youtube.com/user/RedHatVideos)[Facebook](https://www.facebook.com/redhatinc)[X](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](/en/technologies/management/ansible)
* [Cloud services](/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](/en/technologies/all-products)

### Tools

* [Training and certification](/en/services/training-and-certification)
* [My account](https://www.redhat.com/wapps/ugc/protected/personalInfo.html)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Red Hat value calculator](/en/solutions/value-calculator)
* [Documentation](https://docs.redhat.com/en)

### Try, buy, & sell

* [Product trial center](/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Buy online (Japan)](https://www.redhat.com/en/about/japan-buy)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact sales](/en/contact/sales)
* [Contact customer service](/en/contact/customer-service)
* [Contact training](/en/services/training-and-certification/contact-us)
* [Social](/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Select a language

![](https://static.redhat.com/libs/redhat/rh-iconfont/4/svg/web-icon-globe.svg)

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
### Red Hat legal and privacy links

* [About Red Hat](/en/about/company)
* [Jobs](/en/jobs)
* [Events](/en/events)
* [Locations](/en/about/office-locations)
* [Contact Red Hat](/en/contact)
* [Red Hat Blog](/en/blog)
* [Diversity, equity, and inclusion](/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](/en/about/privacy-policy)
* [Terms of use](/en/about/terms-use)
* [All policies and guidelines](/en/about/all-policies-guidelines)
* [Digital accessibility](/en/about/digital-accessibility)



=== Content from www.mozilla.org_a7bc6f2e_20250124_163912.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2011-01

## Miscellaneous memory safety hazards (rv:1.9.2.14/ 1.9.1.17)

Announced
March 1, 2011
Reporter
Mozilla developers and community
Impact
Critical
Products
Firefox, SeaMonkey, Thunderbird
Fixed in

* Firefox 3.5.17
* Firefox 3.6.14
* SeaMonkey 2.0.12
* Thunderbird 3.1.8

### Description

Mozilla developers identified and fixed several memory safety bugs
in the browser engine used in Firefox and other Mozilla-based
products. Some of these bugs showed evidence of memory corruption
under certain circumstances, and we presume that with enough effort at
least some of these could be exploited to run arbitrary code.

### References

Jesse Ruderman, Igor Bukanov, Olli Pettay, Gary Kwong, Jeff Walden,
Henry Sivonen, Martijn Wargers, David Baron and Marcia Knous reported
memory safety problems that affected Firefox 3.6 and Firefox 3.5.

* [Memory safety bugs - Firefox 3.6, Firefox 3.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=558531,558541,558633,563243,576649,596232,600853,600974,602115,605672,613376,614499,563618)
* [CVE-2011-0053](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0053)

Igor Bukanov and Gary Kwong reported memory safety problems that
affected Firefox 3.6 only.

* [Memory safety bugs - Firefox 3.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=599610,569384)
* [CVE-2011-0062](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0062)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.redhat.com_a2da1b5f_20250124_163913.html ===

[Skip to content](#rhb-main-content)
## Featured links

* [![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)](https://www.redhat.com/en/summit)
* [Support](https://access.redhat.com/)
* [Documentation](https://docs.redhat.com/en)
* [Console](https://cloud.redhat.com/)
* [Developers](https://developers.redhat.com/)
* [Start a trial](/en/products/trials)
* All Red Hat
  + For customers
    - [Customer support](https://access.redhat.com/)
    - [Subscription management](https://access.redhat.com/management)
    - [Support cases](https://access.redhat.com/support/cases)
    - [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
    - [Find a partner](https://catalog.redhat.com/partners)
  + For partners
    - [Partner portal](https://connect.redhat.com/partner-admin/dashboard)
    - [Partner support](https://connect.redhat.com/en/support)
    - [Become a partner](https://connect.redhat.com/)
  + Try, buy, & sell
    - [Red Hat Marketplace](https://marketplace.redhat.com/en-us)
    - [Red Hat Store](https://www.redhat.com/en/store)
    - [Contact sales](/en/contact)
    - [Start a trial](/en/products/trials)
  + Learning resources
    - [Documentation](https://docs.redhat.com/en)
    - [Training and certification](/en/services/training-and-certification)
    - [Hybrid cloud learning hub](https://cloud.redhat.com/learn)
    - [Interactive labs](/en/interactive-labs)
    - [Learning community](https://learn.redhat.com/)
    - [Red Hat TV](https://tv.redhat.com)
  + Open source communities
    - [Global advocacy](https://access.redhat.com/accelerators)
    - [How we contribute](/en/about/our-community-contributions)
[Red Hat](/en)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* Explore more
### Platform products

* [Red Hat Enterprise LinuxA flexible, stable operating system to support hybrid cloud innovation.](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShiftA container platform to build, modernize, and deploy applications at scale.](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation PlatformNew versionA foundation for implementing enterprise-wide automation.](/en/technologies/management/ansible)
### Try & buy

* [Start a trialAssess a product with a no-cost trial.](/en/products/trials)
* [Buy onlineBuy select products and services in the Red Hat Store.](https://www.redhat.com/en/store)
* [Integrate with major cloud providersBuy Red Hat solutions using committed spend from providers, including:
  ![Cloud providers: Amazon Web Services, Microsoft Azure, and Google Cloud](https://www.redhat.com/rhdc/managed-files/cloud-providers-2x.png)](/en/partners/certified-cloud-and-service-providers)
### Featured

* [Red Hat Enterprise Linux AI](/en/technologies/linux-platforms/enterprise-linux/ai)
* [Red Hat OpenShift AI](/en/technologies/cloud-computing/openshift/openshift-ai)
* [Red Hat OpenShift Virtualization](/en/technologies/cloud-computing/openshift/virtualization)
* [Red Hat OpenShift Service on AWS](/en/technologies/cloud-computing/openshift/aws)
* [Microsoft Azure Red Hat OpenShift](/en/technologies/cloud-computing/openshift/azure)
[See all products](/en/technologies/all-products)

* [Application platformSimplify the way you build, deploy, manage, and secure apps across the hybrid cloud.](/en/solutions/application-platform)
* [Artificial intelligenceBuild, deploy, and monitor AI models and apps with Red Hat's open source platforms.](/en/solutions/ai)
* [Edge computingDeploy workloads closer to the source with security-focused edge technology.](/en/products/edge)

* [IT automationUnite disparate tech, teams, and environments with 1 comprehensive automation platform.](/en/solutions/it-automation)
* [Linux standardizationGet consistency across operating environments with an open, flexible infrastructure.](/en/solutions/linux-standardization)

* [SecurityDeliver software using trusted platforms and real-time security scanning and remediation.](/en/solutions/trusted-software-supply-chain)
* [VirtualizationModernize operations using a single platform for virtualized and containerized workloads.](/en/solutions/virtualization)
### By industry

* [Automotive](/en/solutions/automotive)
* [Financial services](/en/solutions/financial-services)
* [Healthcare](/en/solutions/healthcare)
* [Industrial sector](/en/solutions/industrial-sector)
* [Media and entertainment](/en/solutions/media-entertainment)
* [Public sector](/en/solutions/public-sector)
* [Telecommunications](/en/solutions/telecommunications)
[Explore solutions](/en/solutions)
### [Services](/en/services)

* [Consulting](/en/services/consulting)
* [Services for AI](/en/services/consulting/red-hat-consulting-for-ai)
* [Technical Account Management](/en/services/support/technical-account-management)
### [Training & certification](/en/services/training-and-certification)

* [All courses and exams](/en/services/training/all-courses-exams)
* [All certifications](/en/services/certifications)
* [Verify a certification](https://www.redhat.com/rhtapps/services/verify/)
* [Skills assessment](https://skills.ole.redhat.com)
* [Learning subscription](/en/services/training/learning-subscription)
* [Learning community](https://learn.redhat.com/)
* [Red Hat Academy](/en/services/training/red-hat-academy)
* [FAQs](/en/services/training-and-certification/faq)
* [Connect with learning experts](/en/services/training-and-certification/contact-us)
### Featured

* [Ansible Basics: Automation Technical Overview (No cost)](/en/services/training/do007-ansible-essentials-simplicity-automation-technical-overview)
* [Containers, Kubernetes and Red Hat OpenShift Technical Overview (No cost)](/en/services/training/do080-deploying-containerized-applications-technical-overview)
* [Red Hat Enterprise Linux Technical Overview (No cost)](/en/services/training/rh024-red-hat-linux-technical-overview)
* [Red Hat Certified System Administrator exam](/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam)
* [Red Hat System Administration I](/en/services/training/rh124-red-hat-system-administration-i)
[Explore services](/en/services)
### Topics

* [AI](/en/topics/ai)
* [Application modernization](/en/topics/application-modernization)
* [Automation](/en/topics/automation)
* [Cloud computing](/en/topics/cloud-computing)
* [Cloud-native applications](/en/topics/cloud-native-apps)
* [Containers](/en/topics/containers)
* [DevOps](/en/topics/devops)
* [Edge computing](/en/topics/edge-computing)
* [Linux](/en/topics/linux)
* [Virtualization](/en/topics/virtualization)
* [See all topics](/en/topics)
### Articles

* [What is InstructLab?](/en/topics/ai/what-is-instructlab)
* [What are cloud services?](/en/topics/cloud-computing/what-are-cloud-services)
* [What is edge computing?](/en/topics/edge-computing/what-is-edge-computing)
* [What is hybrid cloud?](/en/topics/cloud-computing/what-is-hybrid-cloud)
* [Why build a Red Hat cloud?](/en/topics/cloud-computing/why-choose-red-hat-cloud)
* [Cloud vs. edge](/en/topics/cloud-computing/cloud-vs-edge)
* [Red Hat OpenShift vs. Kubernetes](/en/technologies/cloud-computing/openshift/red-hat-openshift-kubernetes)
* [Learning Ansible basics](/en/topics/automation/learning-ansible-tutorial)
* [What is Linux?](/en/topics/linux/what-is-linux)
### More to explore

* [Blog](/en/blog)
* [Customer success stories](/en/success-stories)
* [Events and webinars](/en/events)
* [Newsroom](/en/about/newsroom)
* [Podcasts and video series](/en/red-hat-original-series)
* [Documentation](https://docs.redhat.com/en)
* [Resource library](/en/resources)
* [Training and certification](/en/services/training-and-certification)
[Explore resources](/en/resources)
### For customers

* [Our partners](/en/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
### For partners

* [Partner Connect](https://connect.redhat.com)
* [Become a partner](https://connect.redhat.com/en/benefits-of-being-a-partner)
* [Training](https://connect.redhat.com/en/training)
* [Support](https://connect.redhat.com/en/support)
* [Access the partner portal](https://connect.redhat.com/partner-admin/dashboard)
### About us

* [Our company](/en/about/company)
* [How we work](/en/about/our-culture)
* [Our social impact](/en/about/community-social-responsibility)
* [Development model](/en/about/development-model)
* [Subscription model](/en/about/value-of-Red-Hat)
* [Product support](/en/services/support)
### Open source

* [Open source commitments](/en/about/open-source)
* [How we contribute](/en/about/our-community-contributions)
* [Red Hat on GitHub](https://github.com/RedHatOfficial)
### Company details

* [Analyst relations](/en/about/analysts)
* [Blog](/en/blog)
* [Locations](/en/about/office-locations)
* [Newsroom](/en/about/newsroom)
[Explore Red Hat](/en/about)[Contact us](/en/contact)For customers

* [Customer support](https://access.redhat.com/)* [Subscription management](https://access.redhat.com/management)* [Support cases](https://access.redhat.com/support/cases)* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)* [Find a partner](https://catalog.redhat.com/partners)
For partners

* [Partner portal](https://connect.redhat.com/partner-admin/dashboard)* [Partner support](https://connect.redhat.com/en/support)* [Become a partner](https://connect.redhat.com/)
Try, buy, & sell

* [Red Hat Marketplace](https://marketplace.redhat.com/en-us)* [Red Hat Store](https://www.redhat.com/en/store)* [Contact sales](/en/contact)* [Start a trial](/en/products/trials)
Learning resources

* [Documentation](https://docs.redhat.com/en)* [Training and certification](/en/services/training-and-certification) * [Hybrid cloud learning hub](https://cloud.redhat.com/learn)* [Interactive labs](/en/interactive-labs)* [Learning community](https://learn.redhat.com/)* [Red Hat TV](https://tv.redhat.com)
Open source communities

* [Global advocacy](https://access.redhat.com/accelerators)* [How we contribute](/en/about/our-community-contributions)
For you
New
### Recommendations

As you browse redhat.com, we'll recommend resources you may like. For now, try these.

---

* [All Red Hat products](/en/technologies/all-products)
* [Tech topics](/en/topics)
* [Red Hat resources](/en/resources)
![close](https://static.redhat.com/libs/redhat/rh-iconfont/latest/svg/web-icon-close.svg)[![Red Hat Summit](/themes/custom/rh_base_ui/dist/img/red-hat-summit-logo.svg)Red Hat Summit](https://www.redhat.com/en/summit)[Support](https://access.redhat.com/)[Documentation](https://docs.redhat.com/en)[Console](https://cloud.redhat.com/)[Developers](https://developers.redhat.com/)[Start a trial](/en/products/trials)[Contact](/en/contact)Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol[Contact us](/en/contact)
English
### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol![](/themes/custom/rh_base_ui/dist/img/talk-bubble.svg)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* [Contact us](/en/contact)

### Select a language

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)

# Red Hat Support

## Go beyond support by engaging with our experts

Our teams collaborate with you to ensure you accomplish your goals with Red Hat solutions. The relationship we build with you is designed to provide you with the tools and resources you need to find success on your IT journey.

![](/rhdc/managed-files/support-header.svg)

## Configured for your success

We develop a holistic understanding of your experience as a customer by ensuring our support and engineering teams work together.

Our support team works hand in hand with the best engineers in the industry to quickly turn customer feedback into product improvements. This direct line of communication allows us to hone in on proactive fixes that can impact your bottom line.

### Quick links

* Search our [Knowledgebase](https://access.redhat.com/search/#/?q=&p=1&sort=relevant&scoped&documentKind=Knowledgebase)
* Find [product documentation](https://access.redhat.com/documentation/en-us/)
* Access the [product security center](https://access.redhat.com/security/)
* Connect with [our support team](https://access.redhat.com/support)
* Team up with a [technical account manager](/en/services/support/technical-account-management "Technical account management")
* Take advantage of [partner support](https://connect.redhat.com/en/support)

## Find the right level of support

We have different tiers of support designed to meet your unique needs.

|  | Self-support | Standard | Premium |
| --- | --- | --- | --- |
| Access to Red Hat products | checkmark | checkmark | checkmark |
| Access to our knowledgebase and tools in our award-winning Customer Portal | checkmark | checkmark | checkmark |
| Access to support engineers during standard business hours |  | checkmark | checkmark |
| Access to support engineers 24x7 for high-severity issues |  |  | checkmark |

We also feature specialized support options that can be tailored to the unique needs of companies of all sizes and industries. The Red Hat® [Enhanced Solution Support](/en/resources/enhanced-solution-support-datasheet "Red Hat Enhanced Solution Support: 24x7 engineering support") offering reduces downtime and boosts confidence through access to senior level engineers, as well as resolution and restoration SLAs—helping you stay up and running as you innovate, scale, and deploy. Our engineers help restore your operations quickly and accelerate the path to final resolution, identifying the root cause which helps protect against recurrences in the future. Enhanced Solution Support engineers, who are already familiar with your environment, will be there to assist with critical issues in production environments so that you can consistently deliver the cloud services your customers demand. This offering is available for Red Hat OpenShift® and Red Hat OpenStack® Platform customers.

### Personalized support

Connect with a technical adviser for collaborative planning and specialized guidance. Our Technical Account Managers help you streamline deployments, resolve issues, and shape your technology strategy to meet your toughest business challenges.

[Explore Technical Account Management](/en/services/support/technical-account-management)

## Award winners since 2011

We’ve evolved the traditional software subscription model, combining the best elements of our services to exceed customer expectations. The Association of Support Professionals has honored Red Hat’s Customer Portal as one of “The Top Ten Best Support Websites” for 13 years running.

[See why the Customer Portal keeps earning industry recognition](https://access.redhat.com/)

![Gold and green star with text ASP best support websites of 2023](/rhdc/managed-files/ASP-Award-Design.jpg)

## What they're saying

![BSE logo](/rhdc/managed-files/bse-logo-2.png)

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> We have found the support from Red Hat to be exemplary. Whenever we need anything from them, they have given it … Red Hat is now our backbone. Our business cannot run if Red Hat is not there.
>
> Ashishkumar Chauhan
>
> CEO, BSE

> Icon-Red\_Hat-Media\_and\_documents-Quotemark\_Open-B-Red-RGB
>
> I like the fact that they really dig into things and then provide answers. As the single Linux guy, I kind of need that second admin next to me sometimes to say, "Hey, what about this?" and I am able to do that through the portal. I get my questions answered and trouble tickets resolved.
>
> Erik Widholm
>
> Sr. Enterprise Engineer

[Read more user reviews](/en/technologies/linux-platforms/enterprise-linux/user-reviews)

## Have questions?

[Contact Support team](https://access.redhat.com/support)

[Visit the Customer Portal](https://access.redhat.com/)

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](/en)[LinkedIn](https://www.linkedin.com/company/red-hat)[YouTube](https://www.youtube.com/user/RedHatVideos)[Facebook](https://www.facebook.com/redhatinc)[X](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](/en/technologies/management/ansible)
* [Cloud services](/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](/en/technologies/all-products)

### Tools

* [Training and certification](/en/services/training-and-certification)
* [My account](https://www.redhat.com/wapps/ugc/protected/personalInfo.html)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Red Hat value calculator](/en/solutions/value-calculator)
* [Documentation](https://docs.redhat.com/en)

### Try, buy, & sell

* [Product trial center](/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Buy online (Japan)](https://www.redhat.com/en/about/japan-buy)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact sales](/en/contact/sales)
* [Contact customer service](/en/contact/customer-service)
* [Contact training](/en/services/training-and-certification/contact-us)
* [Social](/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Select a language

![](https://static.redhat.com/libs/redhat/rh-iconfont/4/svg/web-icon-globe.svg)

* [简体中文](/zh/services/support)
* [English](/en/services/support)
* [Français](/fr/services/support)
* [Deutsch](/de/services/support)
* [Italiano](/it/services/support)
* [日本語](/ja/services/support)
* [한국어](/ko/services/support)
* [Português](/pt-br/services/support)
* [Español](/es/services/support)
### Red Hat legal and privacy links

* [About Red Hat](/en/about/company)
* [Jobs](/en/jobs)
* [Events](/en/events)
* [Locations](/en/about/office-locations)
* [Contact Red Hat](/en/contact)
* [Red Hat Blog](/en/blog)
* [Diversity, equity, and inclusion](/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](/en/about/privacy-policy)
* [Terms of use](/en/about/terms-use)
* [All policies and guidelines](/en/about/all-policies-guidelines)
* [Digital accessibility](/en/about/digital-accessibility)



=== Content from bugzilla.mozilla.org_6689bc62_20250124_163931.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/602115)
* [XML](/show_bug.cgi?ctype=xml&id=602115)

Closed
[Bug 602115](/show_bug.cgi?id=602115)

Opened 14 years ago
Closed 14 years ago

# Crash [@ txExecutionState::popTemplateRule]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ txExecutionState::popTemplateRule]

## Categories

### (Core :: XSLT, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XSLT#XSLT)

XSLT
▾

Core :: XSLT
For bugs on Mozilla's XSLT support. See the [project
page](http://www.mozilla.org/projects/xslt) for tips on testcases and commonly encountered legacy problems.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XSLT&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XSLT&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XSLT)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [final+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=final%2B) |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | final+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: sicking)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/12de552ffa2a81f8a03733071b70caaa?d=mm&size=40)  [sicking](/user_profile?user_id=9186)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[637226](/show_bug.cgi?id=637226 "RESOLVED DUPLICATE - [CRASH] Malformed XML + DOM, Garbage Collector crash")

Dependency [tree](/showdependencytree.cgi?id=602115&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=602115)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[637226](/show_bug.cgi?id=637226 "RESOLVED DUPLICATE - [CRASH] Malformed XML + DOM, Garbage Collector crash")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [sg:critical?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---),
[verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ txExecutionState::popTemplateRule ]](https://crash-stats.mozilla.org/signature/?signature=txExecutionState%3A%3ApopTemplateRule)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 1 obsolete file)

| [testcase (crashes Firefox when loaded)](/attachment.cgi?id=481111)  [14 years ago](#c0)  [Jesse Ruderman](/user_profile?user_id=11608)   265 bytes, text/html |  | [Details](/attachment.cgi?id=481111&action=edit) |
| --- | --- | --- |
| [stack trace](/attachment.cgi?id=481112)  [14 years ago](#c1)  [Jesse Ruderman](/user_profile?user_id=11608)   9.37 KB, text/plain |  | [Details](/attachment.cgi?id=481112&action=edit) |
| [Patch to fix](/attachment.cgi?id=492934)  [14 years ago](#c7)  [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)   8.72 KB, patch | peterv : [review+](#c8 "14 years ago") | [Details](/attachment.cgi?id=492934&action=edit) | [Diff](/attachment.cgi?id=492934&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=492934) |
| [branch patch](/attachment.cgi?id=505007)  [14 years ago](#c14)  [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)   8.70 KB, patch |  | [Details](/attachment.cgi?id=505007&action=edit) | [Diff](/attachment.cgi?id=505007&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=505007) |
| [branch patch](/attachment.cgi?id=505009)  [14 years ago](#c15)  [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)   8.70 KB, patch | dveditz : [approval1.9.2.14+](#c16 "14 years ago")  dveditz : [approval1.9.1.17+](#c16 "14 years ago") | [Details](/attachment.cgi?id=505009&action=edit) | [Diff](/attachment.cgi?id=505009&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=505009) |
| [1.8 version](/attachment.cgi?id=507857)  [14 years ago](#c20)  [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117)   3.26 KB, patch |  | [Details](/attachment.cgi?id=507857&action=edit) | [Diff](/attachment.cgi?id=507857&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=507857) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=602115#c0)• 14 years ago |
|  | |

Attached file
[testcase (crashes Firefox when loaded)](attachment.cgi?id=481111)
— [Details](attachment.cgi?id=481111&action=edit)

*No description provided.*

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=602115#a107_11608)• 14 years ago |

Group: core-security

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=602115#c1)• 14 years ago |
|  | |

Attached file
[stack trace](attachment.cgi?id=481112)
— [Details](attachment.cgi?id=481112&action=edit)

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=602115#c2)• 14 years ago |
|  | |

Crash address 0xfffffffffffffff8 is kinda scary.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=602115#c3)• 14 years ago |
|  | |

439 NS\_IF\_RELEASE(mTemplateRules[mTemplateRuleCount].mModeLocalName);
mTemplateRuleCount is -1.
The popTemplateRule call is coming from end()... but we never called pushTemplateRule, because we bailed out from init() like so:
169 NS\_ENSURE\_TRUE(document, NS\_ERROR\_FAILURE);
and the caller in txMozillaXSLTProcessor::TransformToDoc didn't check the rv and pressed on.

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=602115#a12695_9186)• 14 years ago |

Whiteboard: [sg:critical?]

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=602115#a592132_9186)• 14 years ago |

Assignee: nobody → jonasblocking2.0: --- → final+

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=602115#c4)• 14 years ago |
|  | |

Jonas, progress here?

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=602115#c5)• 14 years ago |
|  | |

Jonas?

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=602115#c6)• 14 years ago |
|  | |

I'll start looking at this today

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=602115#c7)• 14 years ago |
|  | |

Attached patch

[Patch to fix](attachment.cgi?id=492934&action=diff)
— [Details](attachment.cgi?id=492934&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=492934)

Our error handling here is way busted. We even ignore errors generated from txExecutionState.init.
This patch makes us honor that error, and skips the template rule cleanup when the transformation failed for any reason. Instead template rules are properly owned by an nsTArray which simplifies things a lot.
[Attachment #492934](/attachment.cgi?id=492934&action=edit "Patch to fix") -
Flags: review?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=602115#c8)• 14 years ago |
|  | |

Comment on [attachment 492934](/attachment.cgi?id=492934 "Patch to fix") [[details]](/attachment.cgi?id=492934&action=edit "Patch to fix") [[diff]](/attachment.cgi?id=492934&action=diff "Patch to fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=492934)
Patch to fix
>+ var docType = document.implementation.createDocumentType(undefined, '', '');
>+ var doc = document.implementation.createDocument('', '', null);
>+ var xp = new XSLTProcessor;
>+ xp.importStylesheet(doc);
>+ xp.transformToDocument(docType);
>+}
>+catch (ex) {}
>+
>+try {
>+ var docType = document.implementation.createDocumentType(undefined, '', '');
>+ var doc = document.implementation.createDocument('', '', null);
>+ var xp = new XSLTProcessor;
Don't think you need the |var|s again here.
> nsresult
This should be void now, it only returns NS\_OK.
> txExecutionState::pushTemplateRule(txStylesheet::ImportFrame\* aFrame,
[Attachment #492934](/attachment.cgi?id=492934&action=edit "Patch to fix") -
Flags: review?(peterv) → review+

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=602115#c9)• 14 years ago |
|  | |

Checked in <http://hg.mozilla.org/mozilla-central/rev/7127fb5bc918>Status: NEW → RESOLVEDClosed: 14 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=602115#c10)• 14 years ago |
|  | |

This crashes 3.6.x tooblocking1.9.1: --- → ?blocking1.9.2: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=602115#a8097512_1689)• 14 years ago |

blocking1.9.1: ? → .17+blocking1.9.2: ? → .14+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=602115#c11)• 14 years ago |
|  | |

Blocking branch releases, please work up a back-ported patch if necessary

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=602115#a9093610_9186)• 14 years ago |

[Attachment #492934](/attachment.cgi?id=492934&action=edit "Patch to fix") -
Flags: approval1.9.2.14?
[Attachment #492934](/attachment.cgi?id=492934&action=edit "Patch to fix") -
Flags: approval1.9.1.17?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=602115#c12)• 14 years ago |
|  | |

Comment on [attachment 492934](/attachment.cgi?id=492934 "Patch to fix") [[details]](/attachment.cgi?id=492934&action=edit "Patch to fix") [[diff]](/attachment.cgi?id=492934&action=diff "Patch to fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=492934)
Patch to fix
>- TemplateRule\* mTemplateRules;
>- PRInt32 mTemplateRulesBufferSize;
>- PRInt32 mTemplateRuleCount;
>+ AutoInfallibleTArray<TemplateRule, 10> mTemplateRules;
Neither branch has AutoInfallibleTArray. Did this compile in your tree?

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=602115#c13)• 14 years ago |
|  | |

No, that was the only change I had to make (which also meant returning OOM as needed)

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=602115#c14)• 14 years ago |
|  | |

Attached patch

[branch patch](attachment.cgi?id=505007&action=diff) (obsolete)
— [Details](attachment.cgi?id=505007&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=505007)

[Attachment #505007](/attachment.cgi?id=505007&action=edit "branch patch") -
Flags: approval1.9.2.14?
[Attachment #505007](/attachment.cgi?id=505007&action=edit "branch patch") -
Flags: approval1.9.1.17?

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=602115#a9098666_9186)• 14 years ago |

[Attachment #492934](/attachment.cgi?id=492934&action=edit "Patch to fix") -
Flags: approval1.9.2.14?
[Attachment #492934](/attachment.cgi?id=492934&action=edit "Patch to fix") -
Flags: approval1.9.1.17?

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=602115#c15)• 14 years ago |
|  | |

Attached patch

[branch patch](attachment.cgi?id=505009&action=diff)
— [Details](attachment.cgi?id=505009&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=505009)

forgot to refresh
[Attachment #505007](/attachment.cgi?id=505007&action=edit "branch patch") -
Attachment is obsolete: true
[Attachment #505009](/attachment.cgi?id=505009&action=edit "branch patch") -
Flags: approval1.9.2.14?
[Attachment #505009](/attachment.cgi?id=505009&action=edit "branch patch") -
Flags: approval1.9.1.17?
[Attachment #505007](/attachment.cgi?id=505007&action=edit "branch patch") -
Flags: approval1.9.2.14?
[Attachment #505007](/attachment.cgi?id=505007&action=edit "branch patch") -
Flags: approval1.9.1.17?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=602115#c16)• 14 years ago |
|  | |

Comment on [attachment 505009](/attachment.cgi?id=505009 "branch patch") [[details]](/attachment.cgi?id=505009&action=edit "branch patch") [[diff]](/attachment.cgi?id=505009&action=diff "branch patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=505009)
branch patch
Approved for 1.9.2.14 and 1.9.1.17, a=dveditz
[Attachment #505009](/attachment.cgi?id=505009&action=edit "branch patch") -
Flags: approval1.9.2.14?
[Attachment #505009](/attachment.cgi?id=505009&action=edit "branch patch") -
Flags: approval1.9.2.14+
[Attachment #505009](/attachment.cgi?id=505009&action=edit "branch patch") -
Flags: approval1.9.1.17?
[Attachment #505009](/attachment.cgi?id=505009&action=edit "branch patch") -
Flags: approval1.9.1.17+

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=602115#c17)• 14 years ago |
|  | |

Checked in on branches:
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/4693aab773ec>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/fc69b66e9a32>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=602115#c18)• 14 years ago |
|  | |

Somehow missed part of the patch when moving it to the 1.9.1 branch. Followup landed (this is in the approved patch above):
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/7f3448d65808>

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=602115#c19)• 14 years ago |
|  | |

Verified fixed for 1.9.2 with Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.14pre) Gecko/20110120 Namoroka/3.6.14pre. Verified crash in 1.9.2.13.
Verified fixed for 1.9.1 with Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.1.17pre) Gecko/20110120 Shiretoko/3.5.17pre. Verified crash in 1.9.1.16.Keywords: [verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=602115#c20)• 14 years ago |
|  | |

Attached patch

[1.8 version](attachment.cgi?id=507857&action=diff)
— [Details](attachment.cgi?id=507857&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=602115&attachment=507857)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=602115#a15125760_1689)• 14 years ago |

Group: core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=602115#a15276582_1689)• 14 years ago |

Blocks: [637226](/show_bug.cgi?id=637226 "RESOLVED DUPLICATE - [CRASH] Malformed XML + DOM, Garbage Collector crash")

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=602115#a21658093_1)• 14 years ago |

Crash Signature: [@ txExecutionState::popTemplateRule]
You need to [log in](/show_bug.cgi?id=602115&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mandriva.com_e74e83a0_20250124_163911.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from bugzilla.mozilla.org_7b60bf7e_20250124_163921.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/563618)
* [XML](/show_bug.cgi?ctype=xml&id=563618)

Closed
[Bug 563618](/show_bug.cgi?id=563618)

Opened 15 years ago
Closed 15 years ago

# Crash due to writing past the end of buffer [@ nsEUCJPToUnicodeV2::Convert]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash due to writing past the end of buffer [@ nsEUCJPToUnicodeV2::Convert]

## Categories

### (Core :: Internationalization, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Internationalization#Internationalization)

Internationalization
▾

Core :: Internationalization
Internationalization is the process of designing and developing a software product to function in multiple locales. This process involves identifying the locales that must be supported, designing features which support those locales, and writing the code needed.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Internationalization&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Internationalization&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Internationalization)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla2.0

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: hsivonen, Assigned: smontagu)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0e30ca39ed75c9efeb4369d80a83b15a?d=mm&size=40)  [smontagu](/user_profile?user_id=11171)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0030426a5e04e85c33fe02480bc4ca81?d=mm&size=40)  [hsivonen](/user_profile?user_id=5490)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1875645d5594d36bca29657d51d24ed6?d=mm&size=40)  [m\_kato](/user_profile?user_id=8636)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

### ( [URL](http://crash-stats.mozilla.com/report/index/ae6368f5-a6f8-4b7c-8f33-ef9102100429 "http://crash-stats.mozilla.com/report/index/ae6368f5-a6f8-4b7c-8f33-ef9102100429") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[crash-stats.mozilla.com/report/index/...](http://crash-stats.mozilla.com/report/index/ae6368f5-a6f8-4b7c-8f33-ef9102100429 "http://crash-stats.mozilla.com/report/index/ae6368f5-a6f8-4b7c-8f33-ef9102100429")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [sg:critical?][critsmash:resolved] [qa-examined-192] [qa-examined-191] [qa-needs-STR])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?][critsmash:resolved] [qa-examined-192] [qa-examined-191] [qa-needs-STR]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [smontagu](/user_profile?user_id=11171) | [in-testsuite](#a619312_11171 "15 years ago") | + |
| --- | --- | --- |
| [smontagu](/user_profile?user_id=11171) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [testcase](/attachment.cgi?id=443380)  [15 years ago](#c5)  [Simon Montagu :smontagu](/user_profile?user_id=11171)   1.02 KB, text/html; charset=euc-jp |  | [Details](/attachment.cgi?id=443380&action=edit) |
| --- | --- | --- |
| [Patch](/attachment.cgi?id=443713)  [15 years ago](#c6)  [Simon Montagu :smontagu](/user_profile?user_id=11171)   1.86 KB, patch | emk : [review+](#a452791_5842 "15 years ago")  christian : [approval1.9.2.14+](#c11 "14 years ago")  christian : [approval1.9.1.17+](#c11 "14 years ago") | [Details](/attachment.cgi?id=443713&action=edit) | [Diff](/attachment.cgi?id=443713&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563618&attachment=443713) |
| [Tests](/attachment.cgi?id=443714)  [15 years ago](#c7)  [Simon Montagu :smontagu](/user_profile?user_id=11171)   5.57 KB, patch |  | [Details](/attachment.cgi?id=443714&action=edit) | [Diff](/attachment.cgi?id=443714&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563618&attachment=443714) |
| [1.8 version](/attachment.cgi?id=507854)  [14 years ago](#c18)  [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117)   1.31 KB, patch |  | [Details](/attachment.cgi?id=507854&action=edit) | [Diff](/attachment.cgi?id=507854&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563618&attachment=507854) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=563618#c0)• 15 years ago |
|  | |

No steps to reproduce; filed based on a crash stack.
nsJapaneseToUnicode.cpp has these lines:
367 \*dest++ = 0xFFFD;
368 // if 0x8e is not followed by a valid JIS X 0201 byte
369 // but by a valid US-ASCII, save it instead of eating it up.
370 if ( (PRUint8)\*src < (PRUint8)0x7f )
371 \*dest++ = (PRUnichar) \*src;
The destination pointer is incremented on line 367 and then written to again on line 371 without first checking if the increment reached the end of the buffer. When the increment on line 367 reaches the end of the buffer, line 371 crashes.
Even though this was already discussed on #developers, I'm marking this is as security sensitive in case the write past the buffer could be used to deliberately write something to the heap.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=563618#c1)• 15 years ago |
|  | |

<http://crash-stats.mozilla.com/report/index/ae6368f5-a6f8-4b7c-8f33-ef9102100429>URL: [http://crash-stats.mozilla.com/report...](http://crash-stats.mozilla.com/report/index/ae6368f5-a6f8-4b7c-8f33-ef9102100429)

|  | [Martijn Wargers (dead)](/user_profile?user_id=55600) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=563618#c2)• 15 years ago |
|  | |

This was a one-time only crash for me, I couldn't reproduce it.
Iirc, I changed the charset a lot with the testcase.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=563618#c3)• 15 years ago |
|  | |

So the input when it crashed was probably not actual EUC-JP?

|  | [Martijn Wargers (dead)](/user_profile?user_id=55600) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=563618#c4)• 15 years ago |
|  | |

Probably not, no. This was a crash occuring during fuzzing, which I couldn't reproduce.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=563618#c5)• 15 years ago |
|  | |

Attached file
[testcase](attachment.cgi?id=443380)
— [Details](attachment.cgi?id=443380&action=edit)

This test case doesn't reliably crash for me, but it does assert:
###!!! ASSERTION: The Unicode decoder wrote too much data.: 'mLastBuffer->getEnd() <= NS\_HTML5\_STREAM\_PARSER\_READ\_BUFFER\_SIZE', file /Users/simon/mozwork/hgtree/mozilla/parser/html/nsHtml5StreamParser.cpp, line 493

|  | [Brandon Sterne (:bsterne)](/user_profile?user_id=296777) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a34227_296777)• 15 years ago |

Whiteboard: [sg:critical?]

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a36227_269330)• 15 years ago |

Whiteboard: [sg:critical?] → [sg:critical?][critsmash:patch]

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=563618#c6)• 15 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=443713&action=diff)
— [Details](attachment.cgi?id=443713&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563618&attachment=443713)

[Attachment #443713](/attachment.cgi?id=443713&action=edit "Patch") -
Flags: review?

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=563618#c7)• 15 years ago |
|  | |

Attached patch

[Tests](attachment.cgi?id=443714&action=diff)
— [Details](attachment.cgi?id=443714&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563618&attachment=443714)

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=563618#c8)• 15 years ago |
|  | |

Comment on [attachment 443713](/attachment.cgi?id=443713 "Patch") [[details]](/attachment.cgi?id=443713&action=edit "Patch") [[diff]](/attachment.cgi?id=443713&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=563618&attachment=443713)
Patch
The change
>- if ( ! (\*src & 0xc0) )
>+ if ( (PRUint8)\*src < (PRUint8)0x7f )
isn't related to the crash, but I think the original is wrong, maybe caused by copy-pasting code in the patch to [bug 25037](/show_bug.cgi?id=25037 "VERIFIED FIXED - illegal 0xA0 code point in Multibyte charset break parser").

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a122543_11171)• 15 years ago |

[Attachment #443713](/attachment.cgi?id=443713&action=edit "Patch") -
Flags: review? → review?(VYV03354)

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a452791_5842)• 15 years ago |

[Attachment #443713](/attachment.cgi?id=443713&action=edit "Patch") -
Flags: review?(VYV03354) → review+

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=563618#c9)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/0841ec7eec87>
<http://hg.mozilla.org/mozilla-central/rev/93874cf6d6ba>

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a619312_11171)• 15 years ago |

Status: NEW → RESOLVEDClosed: 15 years agoFlags: in-testsuite+Resolution: --- → FIXED

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a1412722_269330)• 15 years ago |

Whiteboard: [sg:critical?][critsmash:patch] → [sg:critical?][critsmash:resolved]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a19772119_1689)• 14 years ago |

blocking1.9.1: --- → ?blocking1.9.2: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=563618#c10)• 14 years ago |
|  | |

We'd like to get this fix in for 1.9.2.14 and 1.9.1.17blocking1.9.1: ? → .17+blocking1.9.2: ? → .14+

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a19899775_11171)• 14 years ago |

[Attachment #443713](/attachment.cgi?id=443713&action=edit "Patch") -
Flags: approval1.9.2.14?
[Attachment #443713](/attachment.cgi?id=443713&action=edit "Patch") -
Flags: approval1.9.1.17?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=563618#c11)• 14 years ago |
|  | |

Comment on [attachment 443713](/attachment.cgi?id=443713 "Patch") [[details]](/attachment.cgi?id=443713&action=edit "Patch") [[diff]](/attachment.cgi?id=443713&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=563618&attachment=443713)
Patch
a=LegNeato for 1.9.2.14 and 1.9.1.17
[Attachment #443713](/attachment.cgi?id=443713&action=edit "Patch") -
Flags: approval1.9.2.14?
[Attachment #443713](/attachment.cgi?id=443713&action=edit "Patch") -
Flags: approval1.9.2.14+
[Attachment #443713](/attachment.cgi?id=443713&action=edit "Patch") -
Flags: approval1.9.1.17?
[Attachment #443713](/attachment.cgi?id=443713&action=edit "Patch") -
Flags: approval1.9.1.17+

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=563618#c12)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/a5a94cd7b310>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/a2ae8b0e65ee>
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=563618#c13)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/b576ae79792e>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/ee5ea05fcd81>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=563618#c14)• 14 years ago |
|  | |

The crashtest passes for 1.9.1 and 1.9.2 on all platforms.
Is there a reason that crashtests for a security bug were checked in prior to release, though? We normally hold those until after the release goes out.Keywords: [verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=563618#c15)• 14 years ago |
|  | |

The crashtests don't currently crash or assert on branch, so I think it's OK in this case.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=563618#c16)• 14 years ago |
|  | |

(even without the patch, I mean)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=563618#c17)• 14 years ago |
|  | |

Is there any way to verify the bug fix for branches?Keywords: [verified1.9.1](/buglist.cgi?keywords=verified1.9.1&resolution=---),
[verified1.9.2](/buglist.cgi?keywords=verified1.9.2&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a21215951_280903)• 14 years ago |

Whiteboard: [sg:critical?][critsmash:resolved] → [sg:critical?][critsmash:resolved] [qa-examined-192] [qa-examined-191] [qa-needs-STR]

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=563618#c18)• 14 years ago |
|  | |

Attached patch

[1.8 version](attachment.cgi?id=507854&action=diff)
— [Details](attachment.cgi?id=507854&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563618&attachment=507854)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a28483028_1689)• 14 years ago |

Group: core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563618#a32798195_1689)• 14 years ago |

Target Milestone: --- → mozilla2.0
You need to [log in](/show_bug.cgi?id=563618&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Simon Montagu :smontagu](/user_profile?user_id=11171)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.redhat.com_5fe397a6_20250126_021731.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.mozilla.org_e2ff3457_20250124_163929.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/600974)
* [XML](/show_bug.cgi?ctype=xml&id=600974)

Closed
[Bug 600974](/show_bug.cgi?id=600974)

Opened 14 years ago
Closed 14 years ago

# crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite

## Categories

### (Core :: Internationalization, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Internationalization#Internationalization)

Internationalization
▾

Core :: Internationalization
Internationalization is the process of designing and developing a software product to function in multiple locales. This process involves identifying the locales that must be supported, designing features which support those locales, and writing the code needed.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Internationalization&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Internationalization&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Internationalization)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla2.0

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [final+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=final%2B) |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | final+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: dbaron, Assigned: smontagu)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0e30ca39ed75c9efeb4369d80a83b15a?d=mm&size=40)  [smontagu](/user_profile?user_id=11171)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0a32391d55cfa63276f87eb9819dfbd0?d=mm&size=40)  [dbaron](/user_profile?user_id=3881)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1875645d5594d36bca29657d51d24ed6?d=mm&size=40)  [m\_kato](/user_profile?user_id=8636)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

### ( [URL](http://test.csswg.org/suites/css2.1/20100917/html4/first-letter-punct-before-036.htm "http://test.csswg.org/suites/css2.1/20100917/html4/first-letter-punct-before-036.htm") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[597849](/show_bug.cgi?id=597849 "RESOLVED DUPLICATE - crash [@ arena_dalloc_small | arena_dalloc | free | DefaultFreeEntry ]"), [599600](/show_bug.cgi?id=599600 "RESOLVED DUPLICATE - crash [@ js::mjit::ic::PurgePICs(JSContext*, JSScript*) ]"), [603525](/show_bug.cgi?id=603525 "RESOLVED DUPLICATE - Reproducable 4.0b6 Crash [@ small_free_list_remove_ptr | small_malloc_from_free_list | szone_malloc ]")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[test.csswg.org/suites/css2.1/20100917...](http://test.csswg.org/suites/css2.1/20100917/html4/first-letter-punct-before-036.htm "http://test.csswg.org/suites/css2.1/20100917/html4/first-letter-punct-before-036.htm")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, css2, Whiteboard: [sg:critical?] [qa-examined-191] [qa-examined-192] [qa-needs-STR] private until 634257 is unhidden)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[css2](/buglist.cgi?keywords=css2&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?] [qa-examined-191] [qa-examined-192] [qa-needs-STR] private until 634257 is unhidden

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [smontagu](/user_profile?user_id=11171) | [in-testsuite](#c40 "14 years ago") | + |
| --- | --- | --- |
| [smontagu](/user_profile?user_id=11171) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 2 obsolete files)

| [patch](/attachment.cgi?id=479926)  [14 years ago](#c4)  [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)   3.59 KB, patch |  | [Details](/attachment.cgi?id=479926&action=edit) | [Diff](/attachment.cgi?id=479926&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=479926) |
| --- | --- | --- |
| [patch](/attachment.cgi?id=479989)  [14 years ago](#c6)  [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)   4.39 KB, patch | smontagu : [review-](#c15 "14 years ago") | [Details](/attachment.cgi?id=479989&action=edit) | [Diff](/attachment.cgi?id=479989&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=479989) |
| [Patch](/attachment.cgi?id=482587)  [14 years ago](#c21)  [Simon Montagu :smontagu](/user_profile?user_id=11171)   3.48 KB, patch | emk : [review+](#c26 "14 years ago")  dbaron : [review+](#c25 "14 years ago")  dveditz : [approval1.9.2.14+](#c42 "14 years ago")  dveditz : [approval1.9.1.17+](#c42 "14 years ago") | [Details](/attachment.cgi?id=482587&action=edit) | [Diff](/attachment.cgi?id=482587&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=482587) |
| [Test](/attachment.cgi?id=482589)  [14 years ago](#c22)  [Simon Montagu :smontagu](/user_profile?user_id=11171)   32.74 KB, patch |  | [Details](/attachment.cgi?id=482589&action=edit) | [Diff](/attachment.cgi?id=482589&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=482589) |
| [UTF-32 testcase](/attachment.cgi?id=483185)  [14 years ago](#c31)  [Simon Montagu :smontagu](/user_profile?user_id=11171)   12.00 KB, text/html; charset=UTF-32BE |  | [Details](/attachment.cgi?id=483185&action=edit) |
| [Patch for GB18030 and UTF-16](/attachment.cgi?id=484264)  [14 years ago](#c35)  [Simon Montagu :smontagu](/user_profile?user_id=11171)   9.21 KB, patch | emk : [review+](#c37 "14 years ago")  dveditz : [approval1.9.2.14+](#c43 "14 years ago")  dveditz : [approval1.9.1.17+](#c43 "14 years ago") | [Details](/attachment.cgi?id=484264&action=edit) | [Diff](/attachment.cgi?id=484264&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=484264) |
| [Tests for GB18030 and UTF-16](/attachment.cgi?id=484265)  [14 years ago](#c36)  [Simon Montagu :smontagu](/user_profile?user_id=11171)   40.54 KB, patch |  | [Details](/attachment.cgi?id=484265&action=edit) | [Diff](/attachment.cgi?id=484265&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=484265) |
| [1.8 version](/attachment.cgi?id=507856)  [14 years ago](#c47)  [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117)   10.18 KB, patch |  | [Details](/attachment.cgi?id=507856&action=edit) | [Diff](/attachment.cgi?id=507856&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=507856) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=600974#c0)• 14 years ago |
|  | |

Loading the following test in the CSS 2.1 test suite (which is derived from a test I wrote):
crashes Firefox intermittently.
Steps to reproduce:
1. load <http://test.csswg.org/suites/css2.1/20100917/html4/first-letter-punct-before-036.htm>
2. reload the page a few times
Actual results: crash, generally after less than 10 reloads
I've tested that this occurs on both 4.0b6 and on the 2010-09-30-03-mozilla-central nightly, in both cases on 64-bit Linux.
In a debug build, loading the page reliably triggers the assertions:
###!!! ASSERTION: The Unicode decoder wrote too much data.: 'end <= NS\_HTML5\_STREAM\_PARSER\_READ\_BUFFER\_SIZE', file /home/dbaron/builds/mozilla-central/mozilla/parser/html/nsHtml5StreamParser.cpp, line 495
A buffer overrun causing a crash may well be exploitable (it's harder, but still possible, if it's a heap buffer overrun), so marking security-sensitive.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a25_3881)• 14 years ago |

blocking2.0: --- → ?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=600974#c1)• 14 years ago |
|  | |

I suspect this is related to incorrect handling of characters that are represented in UTF-16 as surrogate pairs, i.e., non-BMP characters.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=600974#c2)• 14 years ago |
|  | |

Actually, the bug may well be that nsUTF8ToUnicode::Convert will happily write one PRUnichar past the end of the buffer when it's outputting a surrogate pair.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=600974#c3)• 14 years ago |
|  | |

These steps to reproduce are specific to the HTML5 parser, which isn't on old branches, but the bug is on those old branches and it's likely possible to exploit it there.
I think it only allows overrunning the buffer by only two bytes, though.blocking1.9.1: --- → ?blocking1.9.2: --- → ?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a2159_3881)• 14 years ago |

Assignee: nobody → dbaronComponent: HTML: Parser → InternationalizationOS: Linux → AllQA Contact: parser → i18nHardware: x86\_64 → All

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=600974#c4)• 14 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=479926&action=diff) (obsolete)
— [Details](attachment.cgi?id=479926&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=479926)

I think this is probably the safest approach to fixing it.
I started to write a different approach on the assumption that nobody would be silly enough to repeatedly call convert with a 1 char output buffer... but then (a) again, it's possible that somebody could be and (b) fixing it by backing up introduces significant complexity that I wasn't confident I could get right.
This patch should apply all the way back to 1.9.0, with fuzz. (I actually accidentally wrote it in my 1.9.0 tree while looking to see how far back the bug went.)
[Attachment #479926](/attachment.cgi?id=479926&action=edit "patch") -
Flags: review?(smontagu)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a2901_3881)• 14 years ago |

Summary: crash (Unicode decoder overruns HTML5 parser's buffer?) on :first-letter punctuation test in CSS 2.1 test suite → crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=600974#c5)• 14 years ago |
|  | |

I should probably also add a comment here:
+ if (out >= outend) {
+ mRemainingSurrogate = lowSurr;
noting that out >= outend means this is our last iteration through the loop, but we don't want to |break| because we need the assignments below.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=600974#c6)• 14 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=479989&action=diff) (obsolete)
— [Details](attachment.cgi?id=479989&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=479989)

[Attachment #479926](/attachment.cgi?id=479926&action=edit "patch") -
Attachment is obsolete: true
[Attachment #479989](/attachment.cgi?id=479989&action=edit "patch") -
Flags: review?(smontagu)
[Attachment #479926](/attachment.cgi?id=479926&action=edit "patch") -
Flags: review?(smontagu)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=600974#c7)• 14 years ago |
|  | |

Actually, maybe this isn't the best approach, since it seems like the other decoders don't split surrogate pairs across output blocks.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a24633_11171)• 14 years ago |

[Attachment #479989](/attachment.cgi?id=479989&action=edit "patch") -
Flags: review?(smontagu) → review+

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=600974#c8)• 14 years ago |
|  | |

Crashtest?

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=600974#c9)• 14 years ago |
|  | |

(In reply to [comment #7](/show_bug.cgi?id=600974#c7 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> Actually, maybe this isn't the best approach, since it seems like the other
> decoders don't split surrogate pairs across output blocks.
I was wondering about that too. Do you think splitting the surrogate pair will cause problems?

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=600974#c10)• 14 years ago |
|  | |

FWIW, nsUTF32ToUnicode and nsGBKToUnicode seem to have the same bug.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=600974#c11)• 14 years ago |
|  | |

nsUTF32ToUnicode doesn't look like it overruns the buffer; it just drops a character on the floor, I think.
ucvlatin/nsUCS2BEToUnicode.cpp also has correctness bug when a surrogate pair
ought to cross a block boundary in the destination buffer (it outputs a replacement char instead of the surrogates it ought to)
nsGBKToUnicode::ConvertNoBuff does indeed look broken; I hadn't yet gotten to any of the ConvertNoBuff implementations, or for that matter even figured out how nsBufferDecoderSupport::Convert worked or who derived from it.
We probably ought to have a more general audit here...
(In reply to [comment #9](/show_bug.cgi?id=600974#c9 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> I was wondering about that too. Do you think splitting the surrogate pair will
> cause problems?
It depends what the callers do with the result. If they're just pasting the chunks back together then they should be fine. But if they look into them before doing so, there could be problems.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=600974#c12)• 14 years ago |
|  | |

(In reply to [comment #9](/show_bug.cgi?id=600974#c9 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> (In reply to [comment #7](/show_bug.cgi?id=600974#c7 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> > Actually, maybe this isn't the best approach, since it seems like the other
> > decoders don't split surrogate pairs across output blocks.
>
> I was wondering about that too. Do you think splitting the surrogate pair will
> cause problems?
The decode loop in the HTML5 parser assumes that if the result is NS\_PARTIAL\_MORE\_OUTPUT the decoder hasn't consumed all input bytes. This is wrong, of course, if the decoder consumed a 4-byte sequence but had room to write only the first surrogate.
<http://mxr.mozilla.org/mozilla-central/source/parser/html/nsHtml5StreamParser.cpp#536>
My bad. :-(
In any case, the decoder interface contract should be documented to cover this case so that users of the API know what to do.
If the decode loop in the HTML5 parser were fixed to take into account the case mentioned above, the worst that could happen with the high and low surrogates going into different output buffers would be a discretionary flush happening in the middle of a surrogate pair and the first surrogate got notified to layout before the second is available. However, if the decoder doesn't emit the high surrogate until it has consumed the entire 4-bytes UTF-8 sequence, AFAICT, there's no way for a discretionary flush to take place in the middle of a surrogate pair.
So the HTML5 parser should be OK once the decode loop itself has been fixed--assuming that the new API contract makes it possible to grab the second surrogate out of the decoder without pushing new bytes to it so that the parser can always obtain the complete surrogate pair inside the same runnable task that pushed the 4-byte sequence into the decoder.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a72046_1689)• 14 years ago |

blocking1.9.1: ? → ---blocking1.9.2: ? → ---
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=600974#c13)• 14 years ago |
|  | |

Comment on [attachment 479989](/attachment.cgi?id=479989 "patch") [[details]](/attachment.cgi?id=479989&action=edit "patch") [[diff]](/attachment.cgi?id=479989&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=479989)
patch
From the comments sounds like we don't need a separate branch patch. We'll wait for trunk landing (or at least blocking) first.
[Attachment #479989](/attachment.cgi?id=479989&action=edit "patch") -
Flags: approval1.9.2.12?
[Attachment #479989](/attachment.cgi?id=479989&action=edit "patch") -
Flags: approval1.9.1.15?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=600974#c14)• 14 years ago |
|  | |

(In reply to [comment #12](/show_bug.cgi?id=600974#c12 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> If the decode loop in the HTML5 parser were fixed to take into account the case
> mentioned above, the worst that could happen with the high and low surrogates
> going into different output buffers would be a discretionary flush happening in
> the middle of a surrogate pair and the first surrogate got notified to layout
> before the second is available.
I think we don't want that to happen.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=600974#c15)• 14 years ago |
|  | |

Comment on [attachment 479989](/attachment.cgi?id=479989 "patch") [[details]](/attachment.cgi?id=479989&action=edit "patch") [[diff]](/attachment.cgi?id=479989&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=479989)
patch
So the consensus seems to be that we don't want to do it this way. David, do you want to make a new patch, or would you rather punt to me (in view of what you said in [comment 4](/show_bug.cgi?id=600974#c4 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))?
[Attachment #479989](/attachment.cgi?id=479989&action=edit "patch") -
Flags: review-
[Attachment #479989](/attachment.cgi?id=479989&action=edit "patch") -
Flags: review+
[Attachment #479989](/attachment.cgi?id=479989&action=edit "patch") -
Flags: approval1.9.2.12?
[Attachment #479989](/attachment.cgi?id=479989&action=edit "patch") -
Flags: approval1.9.1.15?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=600974#c16)• 14 years ago |
|  | |

I'd be happy if you wrote the new patch.

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a500819_7044)• 14 years ago |

Assignee: dbaron → smontagublocking2.0: ? → final+

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=600974#c17)• 14 years ago |
|  | |

There are a bunch of other bugs ([bug 597849](/show_bug.cgi?id=597849 "RESOLVED DUPLICATE - crash [@ arena_dalloc_small | arena_dalloc | free | DefaultFreeEntry ]"), [bug 596874](/show_bug.cgi?id=596874 "RESOLVED INCOMPLETE - crash [@ JSCompartment::purge]"), [bug 599600](/show_bug.cgi?id=599600 "RESOLVED DUPLICATE - crash [@ js::mjit::ic::PurgePICs(JSContext*, JSScript*) ]")) at least some of the occurrences of which are probably this bug... and they're public.
Do you know when you'll have a chance to work on this? Should I take it back?

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=600974#c19)• 14 years ago |
|  | |

There are also public comments in [bug 564008](/show_bug.cgi?id=564008 "RESOLVED WORKSFORME - Crash in [@ nsPurpleBuffer::SelectPointers(GCGraphBuilder&) ] [@ @0x0 | nsPurpleBuffer::SelectPointers(GCGraphBuilder&) ]").

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=600974#c20)• 14 years ago |
|  | |

This is about 90% done, but I got distracted by other bugs.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=600974#c21)• 14 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=482587&action=diff)
— [Details](attachment.cgi?id=482587&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=482587)

[Attachment #479989](/attachment.cgi?id=479989&action=edit "patch") -
Attachment is obsolete: true
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: review?

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=600974#c22)• 14 years ago |
|  | |

Attached patch

[Test](attachment.cgi?id=482589&action=diff)
— [Details](attachment.cgi?id=482589&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=482589)

Reftest rather than crashtest in order to test for correct decoding.

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=600974#c23)• 14 years ago |
|  | |

Did you forget to request a reviewer? This needs to get on someones review queue.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a1059927_11171)• 14 years ago |

[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: review?(dbaron)
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: review?(VYV03354)
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: review?

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=600974#c24)• 14 years ago |
|  | |

(In reply to [comment #23](/show_bug.cgi?id=600974#c23 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> Did you forget to request a reviewer? This needs to get on someones review
> queue.
[Bug 372539](/show_bug.cgi?id=372539 "NEW - Unempowered requestee is silently discarded") must die!

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=600974#c25)• 14 years ago |
|  | |

Comment on [attachment 482587](/attachment.cgi?id=482587 "Patch") [[details]](/attachment.cgi?id=482587&action=edit "Patch") [[diff]](/attachment.cgi?id=482587&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=482587)
Patch
r=dbaron
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: review?(dbaron) → review+

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=600974#c26)• 14 years ago |
|  | |

Comment on [attachment 482587](/attachment.cgi?id=482587 "Patch") [[details]](/attachment.cgi?id=482587&action=edit "Patch") [[diff]](/attachment.cgi?id=482587&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=482587)
Patch
I couldn't run reftests (even without patches), but the patch looks fine.
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: review?(VYV03354) → review+

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=600974#c27)• 14 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/4c146ed860b3>
<http://hg.mozilla.org/mozilla-central/rev/3a24c22ddd4f>
Keeping open for other decoders per [comment 10](/show_bug.cgi?id=600974#c10 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite") and 11.
I'm not so convinced that we need this on branches without STR, and if we do take it we should probably take fixes for other buffer overruns that were exposed by the HTML5 parser. I remember [bug 563618](/show_bug.cgi?id=563618 "RESOLVED FIXED - Crash due to writing past the end of buffer [@ nsEUCJPToUnicodeV2::Convert]"), and I think there were others.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=600974#c28)• 14 years ago |
|  | |

Both UTF-32 and GB18030 trigger the assertions. Since HTML5 recommends against supporting UTF-32, maybe the time has come to remove it rather than invest time in fixing it. I opened [bug 604317](/show_bug.cgi?id=604317 "RESOLVED FIXED - Remove support for UTF-32 per HTML5 spec.") on that.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=600974#c29)• 14 years ago |
|  | |

(In reply to [comment #12](/show_bug.cgi?id=600974#c12 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> The decode loop in the HTML5 parser assumes that if the result is
> NS\_PARTIAL\_MORE\_OUTPUT the decoder hasn't consumed all input bytes. This is
> wrong, of course, if the decoder consumed a 4-byte sequence but had room to
> write only the first surrogate.
> <http://mxr.mozilla.org/mozilla-central/source/parser/html/nsHtml5StreamParser.cpp#536>
> My bad. :-(
>
> In any case, the decoder interface contract should be documented to cover this
> case so that users of the API know what to do.
What's the new API contract? How should I change nsHtml5StreamParser.cpp?

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=600974#c30)• 14 years ago |
|  | |

Sayre, we need to fix the UTF-32 decoder unless we remove the encoder itself.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=600974#c31)• 14 years ago |
|  | |

Attached file
[UTF-32 testcase](attachment.cgi?id=483185)
— [Details](attachment.cgi?id=483185&action=edit)

UTF-32 testcase (asserts and crashes)

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a1192013_11171)• 14 years ago |

[Attachment #483185](/attachment.cgi?id=483185&action=edit "UTF-32 testcase") -
Attachment mime type: text/html → text/html; charset-UTF-32BE

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a1192091_11171)• 14 years ago |

[Attachment #483185](/attachment.cgi?id=483185&action=edit "UTF-32 testcase") -
Attachment mime type: text/html; charset-UTF-32BE → text/html; charset=UTF-32BE

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=600974#c32)• 14 years ago |
|  | |

umm, actually the UTF-32 testcase has different assertions and doesn't seem to crash, so maybe it's not such high priority after all.
###!!! ASSERTION: The Unicode decoder consumed the wrong number of bytes.: 'totalByteCount == (PRInt32)aCount', file /home/smontagu/mozwork/hgtree/mozilla/parser/html/nsHtml5StreamParser.cpp, line 540
###!!! ASSERTION: Wrong number of stream bytes written/sniffed.: 'writeCount == aLength', file /home/smontagu/mozwork/hgtree/mozilla/parser/html/nsHtml5StreamParser.cpp, line 682

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=600974#c33)• 14 years ago |
|  | |

(In reply to [comment #29](/show_bug.cgi?id=600974#c29 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> What's the new API contract? How should I change nsHtml5StreamParser.cpp?
I don't think there's any change, except for the assertion that you linked to before.
\* Unless there is not enough output space, this method must consume all the
\* available input data!
This doesn't necessarily imply the converse, i.e. that where there isn't enough output space, not all input data will be consumed. I'll add a sentence to clarify that.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=600974#c34)• 14 years ago |
|  | |

(In reply to [comment #29](/show_bug.cgi?id=600974#c29 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> What's the new API contract? How should I change nsHtml5StreamParser.cpp?
The assertion
NS\_ASSERTION(byteCount > 0 || NS\_FAILED(convResult),
"The decoder consumed too few bytes but did not signal an error.");
will also need to change to cover the case where the decoder returns NS\_PARTIAL\_MORE\_OUTPUT at the very end of the input, and the caller has to call Convert() again with no input.

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=600974#c35)• 14 years ago |
|  | |

Attached patch

[Patch for GB18030 and UTF-16](attachment.cgi?id=484264&action=diff)
— [Details](attachment.cgi?id=484264&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=484264)

[Attachment #484264](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") -
Flags: review?(VYV03354)

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=600974#c36)• 14 years ago |
|  | |

Attached patch

[Tests for GB18030 and UTF-16](attachment.cgi?id=484265&action=diff)
— [Details](attachment.cgi?id=484265&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=484265)

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=600974#c37)• 14 years ago |
|  | |

Comment on [attachment 484264](/attachment.cgi?id=484264 "Patch for GB18030 and UTF-16") [[details]](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") [[diff]](/attachment.cgi?id=484264&action=diff "Patch for GB18030 and UTF-16") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=484264)
Patch for GB18030 and UTF-16
Please set a language and a font-family to the <html> element explicitly. Otherwise reftests will fail on non-English locales because those locales may select a non-Western or sans-serif font for UTF-8 documents. At least the tests don't pass on Japanese locale unless I add lang="en" style="font-family: serif" to the <html> element of 600974-1.html and 600974-3.html.
Otherwise looks good.
[Attachment #484264](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") -
Flags: review?(VYV03354) → review+

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=600974#c38)• 14 years ago |
|  | |

(In reply to [comment #37](/show_bug.cgi?id=600974#c37 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> At least the tests
> don't pass on Japanese locale unless I add lang="en" style="font-family: serif"
> to the <html> element of 600974-1.html and 600974-3.html.
I originally did this in 600974-2.html, because it didn't pass on en-US locale, but even with the language specified it still fails. I couldn't find a solution, so I ended up giving up and making 2 reference versions, 600974-1-ref.html and 600974-2-ref.html, which are identical except for the charset. Do you have any idea how to avoid this? I'm not sure if it's a bug in font selection or expected behaviour.

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=600974#c39)• 14 years ago |
|  | |

Did you also specify font-family: serif? On Japanese and Chinese locale, the default font-family is sans-serif which seems to affect a font selection for comma characters (U+002C). I could match 600974-2-ref.html rednering to 600974-1-ref.html by adding style="font-family: serif".

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=600974#c40)• 14 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/7c6637b28e51>
<http://hg.mozilla.org/mozilla-central/rev/a7f4a58793c0>
font-family: serif wasn't enough, but with font-size as well I was able to remove the duplicate reference rendering.Status: NEW → RESOLVEDClosed: 14 years agoFlags: in-testsuite+Resolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a6838125_1689)• 14 years ago |

blocking1.9.1: --- → ?blocking1.9.2: --- → ?

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=600974#c41)• 14 years ago |
|  | |

wrt branches, see [comment 27](/show_bug.cgi?id=600974#c27 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite").

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a6987818_11171)• 14 years ago |

[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: approval1.9.2.14?
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: approval1.9.1.17?

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a6987845_11171)• 14 years ago |

[Attachment #484264](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") -
Flags: approval1.9.2.14?
[Attachment #484264](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") -
Flags: approval1.9.1.17?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=600974#c42)• 14 years ago |
|  | |

Comment on [attachment 482587](/attachment.cgi?id=482587 "Patch") [[details]](/attachment.cgi?id=482587&action=edit "Patch") [[diff]](/attachment.cgi?id=482587&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=482587)
Patch
Approved for 1.9.2.14 and 1.9.1.17, a=dveditz for release-drivers
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: approval1.9.2.14?
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: approval1.9.2.14+
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: approval1.9.1.17?
[Attachment #482587](/attachment.cgi?id=482587&action=edit "Patch") -
Flags: approval1.9.1.17+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=600974#c43)• 14 years ago |
|  | |

Comment on [attachment 484264](/attachment.cgi?id=484264 "Patch for GB18030 and UTF-16") [[details]](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") [[diff]](/attachment.cgi?id=484264&action=diff "Patch for GB18030 and UTF-16") [[review]](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=484264)
Patch for GB18030 and UTF-16
Approved for 1.9.2.14 and 1.9.1.17, a=dveditz for release-drivers
[Attachment #484264](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") -
Flags: approval1.9.2.14?
[Attachment #484264](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") -
Flags: approval1.9.2.14+
[Attachment #484264](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") -
Flags: approval1.9.1.17?
[Attachment #484264](/attachment.cgi?id=484264&action=edit "Patch for GB18030 and UTF-16") -
Flags: approval1.9.1.17+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a6989594_1689)• 14 years ago |

blocking1.9.1: ? → .17+blocking1.9.2: ? → .14+

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=600974#c44)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/e7fe73c04be2>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/e27a7abd54e2>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/1f9aed09ee37>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/270a9fcb9711>
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Simon Montagu :smontagu](/user_profile?user_id=11171)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=600974#c45)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/5ec393c57c79>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/e0f5ccd3934f>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/cf9f758ef187>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/d4f4337cbe8f>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=600974#c46)• 14 years ago |
|  | |

Have we seen this crash on 1.9.2 or 1.9.1? Using 1.9.2.13 and 1.9.1.16 released builds on XP with either the original URL or the testcase attached, I don't get any crashes.Whiteboard: [sg:critical?] → [sg:critical?] [qa-examined-191] [qa-examined-192] [qa-needs-STR]

|  | [Martin Stránský [:stransky] (ni? me)](/user_profile?user_id=263117) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=600974#c47)• 14 years ago |
|  | |

Attached patch

[1.8 version](attachment.cgi?id=507856&action=diff)
— [Details](attachment.cgi?id=507856&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=600974&attachment=507856)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=600974#c48)• 14 years ago |
|  | |

(In reply to [comment #34](/show_bug.cgi?id=600974#c34 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> (In reply to [comment #29](/show_bug.cgi?id=600974#c29 "RESOLVED FIXED - crash (nsUTF8ToUnicode overruns buffer by 2 bytes outputting surrogate pair) on :first-letter punctuation test in CSS 2.1 test suite"))
> > What's the new API contract? How should I change nsHtml5StreamParser.cpp?
>
> The assertion
> NS\_ASSERTION(byteCount > 0 || NS\_FAILED(convResult),
> "The decoder consumed too few bytes but did not signal an error.");
> will also need to change to cover the case where the decoder returns
> NS\_PARTIAL\_MORE\_OUTPUT at the very end of the input, and the caller has to call
> Convert() again with no input.
Filed [bug 634262](/show_bug.cgi?id=634262 "RESOLVED FIXED - Ensure that nsHtml5StreamParser::WriteStreamBytes is correct given the Unicode decoder interface") as a follow-up.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a15473243_1689)• 14 years ago |

Whiteboard: [sg:critical?] [qa-examined-191] [qa-examined-192] [qa-needs-STR] → [sg:critical?] [qa-examined-191] [qa-examined-192] [qa-needs-STR] private until 634257 is unhidden

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a19885612_1689)• 14 years ago |

Group: core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=600974#a19885660_1689)• 14 years ago |

Target Milestone: --- → mozilla2.0
You need to [log in](/show_bug.cgi?id=600974&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_55636e5a_20250126_021733.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sat Jan 25 2025 18:17:33 PST

* **Bug ID:**
  599610,
  569384

---

| [ID](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [599610](/show_bug.cgi?id=599610 "RESOLVED FIXED - PurgeScriptFragments may not purge all fragments") |  | [PurgeScriptFragments may not purge all fragments](/show_bug.cgi?id=599610) | Core | JavaScript Engine | igor | RESO | FIXE | 2015-10-16 |
| [569384](/show_bug.cgi?id=569384 "VERIFIED FIXED - TM: Crash [@ JSObject::dropProperty] or [@ js::TraceRecorder::record_JSOP_IN] or \"Assertion failure: status == ARECORD_ERROR,\"") |  | [TM: Crash [@ JSObject::dropProperty] or [@ js::TraceRecorder::record\_JSOP\_IN] or "Assertion failure: status == ARECORD\_ERROR,"](/show_bug.cgi?id=569384) | Core | JavaScript Engine | gal | VERI | FIXE | 2015-10-16 |

2 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=599610%2C569384 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=599610%2C569384&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=599610%2C569384&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=599610%2C569384&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Core" product](/enter_bug.cgi?product=Core)



=== Content from www.redhat.com_a013b3ec_20250126_021730.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.mozilla.org_9297f659_20250124_163919.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/563243)
* [XML](/show_bug.cgi?ctype=xml&id=563243)

Closed
[Bug 563243](/show_bug.cgi?id=563243)

Opened 15 years ago
Closed 15 years ago

# (64-bit) Invalid read / write when testcase is run in valgrind

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

(64-bit) Invalid read / write when testcase is run in valgrind

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: mrbkap)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/89d2149736265010bfe669ce8c3075c0?d=mm&size=40)  [mrbkap](/user_profile?user_id=69426)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[563133](/show_bug.cgi?id=563133 "RESOLVED DUPLICATE - Crash [@ js_CallGCMarker] with gczeal")

[412296](/show_bug.cgi?id=412296 "RESOLVED FIXED - Consider removal of minargs support for fast natives")

Dependency [tree](/showdependencytree.cgi?id=563243&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=563243)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[563133](/show_bug.cgi?id=563133 "RESOLVED DUPLICATE - Crash [@ js_CallGCMarker] with gczeal")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [sg:critical?][critsmash:resolved] fixed-in-tracemonkey)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---),
[valgrind](/buglist.cgi?keywords=valgrind&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?][critsmash:resolved] fixed-in-tracemonkey

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [decoder](/user_profile?user_id=395101) | [in-testsuite](#a90973344_395101 "12 years ago") | + |
| --- | --- | --- |
| [decoder](/user_profile?user_id=395101) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [valgrind log](/attachment.cgi?id=442997)  [15 years ago](#c0)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   5.79 KB, text/plain |  | [Details](/attachment.cgi?id=442997&action=edit) |
| --- | --- | --- |
| [gdb info for an opt 1.9.2 shell build](/attachment.cgi?id=442998)  [15 years ago](#c3)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   7.43 KB, text/plain |  | [Details](/attachment.cgi?id=442998&action=edit) |
| [Proposed fix](/attachment.cgi?id=443173)  [15 years ago](#c4)  [Blake Kaplan (:mrbkap) (inactive)](/user_profile?user_id=69426)   4.09 KB, patch | jorendorff : [review+](#a102320_281791 "15 years ago") | [Details](/attachment.cgi?id=443173&action=edit) | [Diff](/attachment.cgi?id=443173&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563243&attachment=443173) |
| [fix for 192](/attachment.cgi?id=505425)  [14 years ago](#c13)  [Igor Bukanov](/user_profile?user_id=50763)   32.22 KB, patch |  | [Details](/attachment.cgi?id=505425&action=edit) | [Diff](/attachment.cgi?id=505425&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563243&attachment=505425) |
| [fix for 192 анд 191](/attachment.cgi?id=505426)  [14 years ago](#c14)  [Igor Bukanov](/user_profile?user_id=50763)   4.14 KB, patch | christian : [approval1.9.2.14+](#c16 "14 years ago")  christian : [approval1.9.1.17+](#c16 "14 years ago") | [Details](/attachment.cgi?id=505426&action=edit) | [Diff](/attachment.cgi?id=505426&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563243&attachment=505426) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=563243#c0)• 15 years ago |
|  | |

Attached file
[valgrind log](attachment.cgi?id=442997)
— [Details](attachment.cgi?id=442997&action=edit)

(function () {
for (a in (function () {
yield Array.reduce()
})()) function () {}
})()
causes invalid reads and writes when run in a 1.9.2 64-bit Linux shell without -j on 1.9.2 tip. (Pass into 1.9.2 shell as a CLI argument, e.g. ./js a.js)
A valgrind log is attached. This does not seem to occur with TM tip. Setting s-s because I'm not sure how bad this is.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=563243#c1)• 15 years ago |
|  | |

This shows up as a crash when jsfunfuzz is being run.Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a66_132034)• 15 years ago |

Group: core-security

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=563243#c2)• 15 years ago |
|  | |

Tested on Ubuntu Linux 10.04 AMD64 on this 1.9.2 changeset:
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/d1aab61eb130>

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=563243#c3)• 15 years ago |
|  | |

Attached file
[gdb info for an opt 1.9.2 shell build](attachment.cgi?id=442998)
— [Details](attachment.cgi?id=442998&action=edit)

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a7251_11608)• 15 years ago |

Whiteboard: [sg:critical?]

|  | [Blake Kaplan (:mrbkap) (inactive)](/user_profile?user_id=69426)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=563243#c4)• 15 years ago |
|  | |

Attached patch

[Proposed fix](attachment.cgi?id=443173&action=diff)
— [Details](attachment.cgi?id=443173&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563243&attachment=443173)

We haven't been able to assume anything about vp[2 + n] for n >= argc since 2006 or so... We don't actually fill missing args for fast natives.Assignee: general → mrbkapStatus: NEW → ASSIGNED
[Attachment #443173](/attachment.cgi?id=443173&action=edit "Proposed fix") -
Flags: review?(jorendorff)

|  | [Blake Kaplan (:mrbkap) (inactive)](/user_profile?user_id=69426)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=563243#c5)• 15 years ago |
|  | |

Note: the changes to the slow version weren't necessary, but the two versions should probably match each other in behavior.

|  | [Jason Orendorff [:jorendorff]](/user_profile?user_id=281791) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a102320_281791)• 15 years ago |

[Attachment #443173](/attachment.cgi?id=443173&action=edit "Proposed fix") -
Flags: review?(jorendorff) → review+

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a183820_11608)• 15 years ago |

Keywords: [valgrind](/buglist.cgi?keywords=valgrind&resolution=---)

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a184716_269330)• 15 years ago |

Whiteboard: [sg:critical?] → [sg:critical?][critsmash:patch]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=563243#c6)• 15 years ago |
|  | |

When did this regress? Does it affect any of our shipping branches?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a184830_1689)• 15 years ago |

[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F)Keywords: [regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---)

|  | [Blake Kaplan (:mrbkap) (inactive)](/user_profile?user_id=69426)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=563243#c7)• 15 years ago |
|  | |

This is a regression from [bug 412296](/show_bug.cgi?id=412296 "RESOLVED FIXED - Consider removal of minargs support for fast natives"). It affects all active branches (note: it does \*not\* affect 1.9.0).Blocks: [412296](/show_bug.cgi?id=412296 "RESOLVED FIXED - Consider removal of minargs support for fast natives")

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=563243#c8)• 15 years ago |
|  | |

(In reply to [comment #7](/show_bug.cgi?id=563243#c7 "RESOLVED FIXED - (64-bit) Invalid read / write when testcase is run in valgrind"))
> This is a regression from [bug 412296](/show_bug.cgi?id=412296 "RESOLVED FIXED - Consider removal of minargs support for fast natives"). It affects all active branches (note: it
> does \*not\* affect 1.9.0).
Strange - might just be me, but I couldn't seem to reproduce on TM tip, as per [comment 0](/show_bug.cgi?id=563243#c0 "RESOLVED FIXED - (64-bit) Invalid read / write when testcase is run in valgrind").Keywords: [regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---)

|  | [Blake Kaplan (:mrbkap) (inactive)](/user_profile?user_id=69426)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=563243#c9)• 15 years ago |
|  | |

<http://hg.mozilla.org/tracemonkey/rev/0f5867192284>
Yeah, I saw that, but I've definitely reproduced it on all branches. Not sure what you're seeing.Whiteboard: [sg:critical?][critsmash:patch] → [sg:critical?][critsmash:patch] fixed-in-tracemonkey

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=563243#c10)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/0f5867192284>Status: ASSIGNED → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a1561964_269330)• 15 years ago |

Whiteboard: [sg:critical?][critsmash:patch] fixed-in-tracemonkey → [sg:critical?][critsmash:resolved] fixed-in-tracemonkey

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a21630227_1689)• 14 years ago |

blocking1.9.1: --- → ?blocking1.9.2: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F) → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F) → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a21637361_1689)• 14 years ago |

Blocks: [563133](/show_bug.cgi?id=563133 "RESOLVED DUPLICATE - Crash [@ js_CallGCMarker] with gczeal")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=563243#c11)• 14 years ago |
|  | |

Fixes [bug 563133](/show_bug.cgi?id=563133 "RESOLVED DUPLICATE - Crash [@ js_CallGCMarker] with gczeal") for branchesblocking1.9.1: ? → .17+blocking1.9.2: ? → .14+

|  | [Igor Bukanov](/user_profile?user_id=50763) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=563243#c13)• 14 years ago |
|  | |

Attached patch

[fix for 192](attachment.cgi?id=505425&action=diff) (obsolete)
— [Details](attachment.cgi?id=505425&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563243&attachment=505425)

The patch is a trivial backport of the tm patch. Here is a plain diff between tm and this patch to confirm this:
24c24
< if (!js\_ComputeThis(cx, vp + 2))
---
> if (!js\_ComputeThis(cx, JS\_FALSE, vp + 2))
59,60c59,60
< @@ -4333,15 +4325,8 @@ js\_generic\_native\_method\_dispatcher(JSCo
< js\_GetTopStackFrame(cx)->thisv = argv[-1];
---
> @@ -4463,15 +4455,8 @@ js\_generic\_native\_method\_dispatcher(JSCo
> js\_GetTopStackFrame(cx)->thisp = JSVAL\_TO\_OBJECT(argv[-1]);
[Attachment #505425](/attachment.cgi?id=505425&action=edit "fix for 192") -
Flags: approval1.9.2.14?

|  | [Igor Bukanov](/user_profile?user_id=50763) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=563243#c14)• 14 years ago |
|  | |

Attached patch

[fix for 192 анд 191](attachment.cgi?id=505426&action=diff)
— [Details](attachment.cgi?id=505426&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=563243&attachment=505426)

The previous attachment had an unrelated diff.
[Attachment #505425](/attachment.cgi?id=505425&action=edit "fix for 192") -
Attachment is obsolete: true
[Attachment #505425](/attachment.cgi?id=505425&action=edit "fix for 192") -
Flags: approval1.9.2.14?

|  | [Igor Bukanov](/user_profile?user_id=50763) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a22721870_50763)• 14 years ago |

[Attachment #505426](/attachment.cgi?id=505426&action=edit "fix for 192 анд 191") -
Flags: approval1.9.2.14?

|  | [Igor Bukanov](/user_profile?user_id=50763) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=563243#c15)• 14 years ago |
|  | |

Comment on [attachment 505426](/attachment.cgi?id=505426 "fix for 192 анд 191") [[details]](/attachment.cgi?id=505426&action=edit "fix for 192 анд 191") [[diff]](/attachment.cgi?id=505426&action=diff "fix for 192 анд 191") [[review]](/page.cgi?id=splinter.html&ignore=&bug=563243&attachment=505426)
fix for 192 анд 191
The patch applies to 191 as-is
[Attachment #505426](/attachment.cgi?id=505426&action=edit "fix for 192 анд 191") -
Attachment description: fix for 192 for real → fix for 192 анд 191
[Attachment #505426](/attachment.cgi?id=505426&action=edit "fix for 192 анд 191") -
Flags: approval1.9.1.17?

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=563243#c16)• 14 years ago |
|  | |

Comment on [attachment 505426](/attachment.cgi?id=505426 "fix for 192 анд 191") [[details]](/attachment.cgi?id=505426&action=edit "fix for 192 анд 191") [[diff]](/attachment.cgi?id=505426&action=diff "fix for 192 анд 191") [[review]](/page.cgi?id=splinter.html&ignore=&bug=563243&attachment=505426)
fix for 192 анд 191
Approved for 1.9.2.14 and 1.9.1.17. Please land this as soon as possible!
[Attachment #505426](/attachment.cgi?id=505426&action=edit "fix for 192 анд 191") -
Flags: approval1.9.2.14?
[Attachment #505426](/attachment.cgi?id=505426&action=edit "fix for 192 анд 191") -
Flags: approval1.9.2.14+
[Attachment #505426](/attachment.cgi?id=505426&action=edit "fix for 192 анд 191") -
Flags: approval1.9.1.17?
[Attachment #505426](/attachment.cgi?id=505426&action=edit "fix for 192 анд 191") -
Flags: approval1.9.1.17+

|  | [Igor Bukanov](/user_profile?user_id=50763) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=563243#c17)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/84f9dd0ecf14>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/223a9cfef4d8>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a28631496_1689)• 14 years ago |

Group: core-security

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=563243#c18)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/08dff7a8e784>

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=563243#a90973344_395101)• 12 years ago |

Flags: in-testsuite+
You need to [log in](/show_bug.cgi?id=563243&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_8cfe7c40_20250124_163923.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/576649)
* [XML](/show_bug.cgi?ctype=xml&id=576649)

Closed
[Bug 576649](/show_bug.cgi?id=576649)

Opened 15 years ago
Closed 14 years ago

# "ASSERTION: Invalid offset" and more with -moz-column, abs pos, huge letter-spacing

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"ASSERTION: Invalid offset" and more with -moz-column, abs pos, huge letter-spacing

## Categories

### (Core :: Layout, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Layout#Layout)

Layout
▾

Core :: Layout

Issues in Layout that do not fit into any other Layout component or which span multiple Layout components.

Bugs related to the top level presentation objects (pres shell, pres context, and document viewer), the frame constructor, and the base frame classes, as well as general issues with alignment and sizing, all belong here.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Layout&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Layout&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Layout)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla2.0b4

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [final+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=final%2B) |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | final+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: MatsPalmgren\_bugz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=40)  [dholbert](/user_profile?user_id=278074)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[587484](/show_bug.cgi?id=587484 "RESOLVED FIXED - warning: suggest parentheses around assignment used as truth value in while (... = GetNextContinuation())")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[randomstyles](/show_bug.cgi?id=306939 "RESOLVED INACTIVE - [meta] Bugs found by Random Styles (adding random style properties to DOM elements)")

Dependency [tree](/showdependencytree.cgi?id=576649&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=576649)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: assertion, testcase, Whiteboard: [sg:critical?][critsmash:patch])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?][critsmash:patch]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jruderman](/user_profile?user_id=11608) | [in-testsuite](#c37 "14 years ago") | + |
| --- | --- | --- |
| [jruderman](/user_profile?user_id=11608) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files, 2 obsolete files)

| [testcase](/attachment.cgi?id=455778)  [15 years ago](#c0)  [Jesse Ruderman](/user_profile?user_id=11608)   257 bytes, text/html |  | [Details](/attachment.cgi?id=455778&action=edit) |
| --- | --- | --- |
| [framedump + stack](/attachment.cgi?id=455921)  [15 years ago](#c1)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   19.67 KB, text/html |  | [Details](/attachment.cgi?id=455921&action=edit) |
| [wip1 (diff -w)](/attachment.cgi?id=455922)  [15 years ago](#c2)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   2.63 KB, patch | bzbarsky : [review+](#c11 "14 years ago") | [Details](/attachment.cgi?id=455922&action=edit) | [Diff](/attachment.cgi?id=455922&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=455922) |
| [wip2 (diff -w) for 1.9.2](/attachment.cgi?id=461741)  [14 years ago](#c7)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   2.54 KB, patch |  | [Details](/attachment.cgi?id=461741&action=edit) | [Diff](/attachment.cgi?id=461741&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=461741) |
| [wip2 (diff -w)](/attachment.cgi?id=463035)  [14 years ago](#c12)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   5.30 KB, patch | bzbarsky : [review+](#c13 "14 years ago") | [Details](/attachment.cgi?id=463035&action=edit) | [Diff](/attachment.cgi?id=463035&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=463035) |
| [[checked-in] wip2 (for trunk checkin)](/attachment.cgi?id=464583)  [14 years ago](#c15)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   5.69 KB, patch |  | [Details](/attachment.cgi?id=464583&action=edit) | [Diff](/attachment.cgi?id=464583&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=464583) |
| [fix for 1.9.2 (diff -w)](/attachment.cgi?id=465948)  [14 years ago](#c18)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   5.12 KB, patch | fantasai.bugs : [review-](#c20 "14 years ago")  dbaron : [review+](#c35 "14 years ago") | [Details](/attachment.cgi?id=465948&action=edit) | [Diff](/attachment.cgi?id=465948&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=465948) |
| [fix for 1.9.2](/attachment.cgi?id=465949)  [14 years ago](#c19)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   5.39 KB, patch |  | [Details](/attachment.cgi?id=465949&action=edit) | [Diff](/attachment.cgi?id=465949&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=465949) |
| [additional check I think we should remove now](/attachment.cgi?id=493787)  [14 years ago](#c28)  [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881)   1.14 KB, patch | roc : [review+](#c31 "14 years ago") | [Details](/attachment.cgi?id=493787&action=edit) | [Diff](/attachment.cgi?id=493787&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=493787) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=576649#c0)• 15 years ago |
|  | |

Attached file
[testcase](attachment.cgi?id=455778)
— [Details](attachment.cgi?id=455778&action=edit)

###!!! ASSERTION: Invalid offset: 'aOffset <= mSkipChars->mCharCount', file /builds/slave/mozilla-central-macosx-debug/build/gfx/thebes/gfxSkipChars.cpp, line 92
###!!! ASSERTION: Text run does not map enough text for our reflow: 'gfxSkipCharsIterator(iter).ConvertOriginalToSkipped(offset + length) <= mTextRun->GetLength()', file /builds/slave/mozilla-central-macosx-debug/build/layout/generic/nsTextFrameThebes.cpp, line 6278

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=576649#c1)• 15 years ago |
|  | |

Attached file
[framedump + stack](attachment.cgi?id=455921)
— [Details](attachment.cgi?id=455921&action=edit)

There's something wrong with the style contexts in the
abs.pos. continuations (and their descendants).
BuildTextRunsScanner::ContinueTextRunAcrossFrames returns false
due to a difference in the font style so we end the text run
prematurely - which leads up to the assertions in Reflow.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=576649#c2)• 15 years ago |
|  | |

Attached patch

[wip1 (diff -w)](attachment.cgi?id=455922&action=diff) (obsolete)
— [Details](attachment.cgi?id=455922&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=455922)

I think we need to do something like this to take care of
the continuations in overflow containers.

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=576649#c3)• 15 years ago |
|  | |

is the sg: severity right?Assignee: nobody → matspalWhiteboard: [sg:critical?]

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a1549433_269330)• 15 years ago |

Whiteboard: [sg:critical?] → [sg:critical?][critsmash:patch]

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=576649#c4)• 14 years ago |
|  | |

I think I've seen a bug in the past where the assertions in [comment 0](/show_bug.cgi?id=576649#c0 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing")
led to an out-of-bounds error of some sort.
I don't see anything like that for this particular testcase, and valgrind
is silent too, but that doesn't prove anything of course.OS: Mac OS X → AllHardware: x86 → All

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=576649#c5)• 14 years ago |
|  | |

I tracked down the changeset where these assertions first started:
<http://hg.mozilla.org/mozilla-central/rev/eb19d94d35ef>
That change is not on 1.9.2 (despite [bug 508325](/show_bug.cgi?id=508325 "RESOLVED FIXED - \"ABORT: negative scaling factors must be handled manually\"") having milestone 1.9.2a1).
Applying it makes the assertions appear also on 1.9.2, so I suspect the
underlying bug is present also on 1.9.2 with a slightly different testcase.
Applying the "wip1" patch on top of that makes the nasty assertions go away.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a2434738_5168)• 14 years ago |

[Attachment #455922](/attachment.cgi?id=455922&action=edit "wip1 (diff -w)") -
Flags: review?(fantasai.bugs)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=576649#c6)• 14 years ago |
|  | |

For 1.9.2 we might need a slightly different patch since we still have
placeholder continuations there, which should take care of the out-of-flow
next-in-flows except for overflow containers.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=576649#c7)• 14 years ago |
|  | |

Attached patch

[wip2 (diff -w) for 1.9.2](attachment.cgi?id=461741&action=diff) (obsolete)
— [Details](attachment.cgi?id=461741&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=461741)

[Attachment #461741](/attachment.cgi?id=461741&action=edit "wip2 (diff -w) for 1.9.2") -
Flags: review?(fantasai.bugs)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=576649#c8)• 14 years ago |
|  | |

Comment on [attachment 455922](/attachment.cgi?id=455922 "wip1 (diff -w)") [[details]](/attachment.cgi?id=455922&action=edit "wip1 (diff -w)") [[diff]](/attachment.cgi?id=455922&action=diff "wip1 (diff -w)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=455922)
wip1 (diff -w)
Seems like more of a Boris thing --- style system.
[Attachment #455922](/attachment.cgi?id=455922&action=edit "wip1 (diff -w)") -
Flags: review?(fantasai.bugs) → review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=576649#c9)• 14 years ago |
|  | |

The reparenting part looks fine.
The reresolving part, I'm not sure about in terms of dynamic changes being handled properly; in particular, if we get a repaint hint, will we apply it correctly? Or does ApplyRenderingChangeToTree also need to walk the continuations of the out-of-flow?
Speaking of which, do we want GetNextInFlow(), or GetNextContinuation()?

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=576649#c10)• 14 years ago |
|  | |

(In reply to [comment #9](/show_bug.cgi?id=576649#c9 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing"))
> The reresolving part, I'm not sure about in terms of dynamic changes being
> handled properly; in particular, if we get a repaint hint, will we apply it
> correctly? Or does ApplyRenderingChangeToTree also need to walk the
> continuations of the out-of-flow?
I think it does.
> Speaking of which, do we want GetNextInFlow(), or GetNextContinuation()?
GetNextContinuation probably, although it doesn't matter since fixed-continuations are never out of flow.

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a2758835_269330)• 14 years ago |

blocking2.0: --- → final+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=576649#c11)• 14 years ago |
|  | |

Comment on [attachment 455922](/attachment.cgi?id=455922 "wip1 (diff -w)") [[details]](/attachment.cgi?id=455922&action=edit "wip1 (diff -w)") [[diff]](/attachment.cgi?id=455922&action=diff "wip1 (diff -w)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=455922)
wip1 (diff -w)
OK, r=me with the changes from [comment 10](/show_bug.cgi?id=576649#c10 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing").
[Attachment #455922](/attachment.cgi?id=455922&action=edit "wip1 (diff -w)") -
Flags: review?(bzbarsky) → review+

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a2866321_5168)• 14 years ago |

[Attachment #461741](/attachment.cgi?id=461741&action=edit "wip2 (diff -w) for 1.9.2") -
Attachment is obsolete: true
[Attachment #461741](/attachment.cgi?id=461741&action=edit "wip2 (diff -w) for 1.9.2") -
Flags: review?(fantasai.bugs)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=576649#c12)• 14 years ago |
|  | |

Attached patch

[wip2 (diff -w)](attachment.cgi?id=463035&action=diff)
— [Details](attachment.cgi?id=463035&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=463035)

Updated according to review comments.
[Attachment #455922](/attachment.cgi?id=455922&action=edit "wip1 (diff -w)") -
Attachment is obsolete: true
[Attachment #463035](/attachment.cgi?id=463035&action=edit "wip2 (diff -w)") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=576649#c13)• 14 years ago |
|  | |

Comment on [attachment 463035](/attachment.cgi?id=463035 "wip2 (diff -w)") [[details]](/attachment.cgi?id=463035&action=edit "wip2 (diff -w)") [[diff]](/attachment.cgi?id=463035&action=diff "wip2 (diff -w)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=463035)
wip2 (diff -w)
r=me
[Attachment #463035](/attachment.cgi?id=463035&action=edit "wip2 (diff -w)") -
Flags: review?(bzbarsky) → review+

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=576649#c14)• 14 years ago |
|  | |

I guess this is ready to land.Whiteboard: [sg:critical?][critsmash:patch] → [sg:critical?][critsmash:patch][needs landing]

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=576649#c15)• 14 years ago |
|  | |

Attached patch

[[checked-in] wip2 (for trunk checkin)](attachment.cgi?id=464583&action=diff)
— [Details](attachment.cgi?id=464583&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=464583)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a3367856_5168)• 14 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=576649#c16)• 14 years ago |
|  | |

Comment on [attachment 464583](/attachment.cgi?id=464583 "[checked-in] wip2 (for trunk checkin)") [[details]](/attachment.cgi?id=464583&action=edit "[checked-in] wip2 (for trunk checkin)") [[diff]](/attachment.cgi?id=464583&action=diff "[checked-in] wip2 (for trunk checkin)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=464583)
[checked-in] wip2 (for trunk checkin)
<http://hg.mozilla.org/mozilla-central/rev/735ff84db7b1>
[Attachment #464583](/attachment.cgi?id=464583&action=edit "[checked-in] wip2 (for trunk checkin)") -
Attachment description: wip2 (for trunk checkin) → [checked-in] wip2 (for trunk checkin)
[Attachment #464583](/attachment.cgi?id=464583&action=edit "[checked-in] wip2 (for trunk checkin)") -
Attachment is private: true

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=576649#c17)• 14 years ago |
|  | |

Comment on [attachment 464583](/attachment.cgi?id=464583 "[checked-in] wip2 (for trunk checkin)") [[details]](/attachment.cgi?id=464583&action=edit "[checked-in] wip2 (for trunk checkin)") [[diff]](/attachment.cgi?id=464583&action=diff "[checked-in] wip2 (for trunk checkin)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=464583)
[checked-in] wip2 (for trunk checkin)
<http://hg.mozilla.org/mozilla-central/rev/735ff84db7b1>
[Attachment #464583](/attachment.cgi?id=464583&action=edit "[checked-in] wip2 (for trunk checkin)") -
Attachment is private: false

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a3369901_249294)• 14 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Rob Campbell [:rc] (:robcee)](/user_profile?user_id=249294) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a3369913_249294)• 14 years ago |

Status: NEW → RESOLVEDClosed: 14 years agoResolution: --- → FIXED

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a3370527_5168)• 14 years ago |

Whiteboard: [sg:critical?][critsmash:patch][needs landing] → [sg:critical?][critsmash:patch][landed on trunk, needs updated branch patch]

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=576649#c18)• 14 years ago |
|  | |

Attached patch

[fix for 1.9.2 (diff -w)](attachment.cgi?id=465948&action=diff)
— [Details](attachment.cgi?id=465948&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=465948)

Same as the trunk patch, with the following additional loop condition:
(outOfFlowFrame->GetStateBits() & NS\_FRAME\_IS\_OVERFLOW\_CONTAINER)
since on branches we have placeholder continuations for out-of-flow
continuations, except for overflow containers, right?
[Attachment #465948](/attachment.cgi?id=465948&action=edit "fix for 1.9.2 (diff -w)") -
Flags: review?(fantasai.bugs)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=576649#c19)• 14 years ago |
|  | |

Attached patch

[fix for 1.9.2](attachment.cgi?id=465949&action=diff)
— [Details](attachment.cgi?id=465949&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=465949)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a3654365_5168)• 14 years ago |

[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F)Whiteboard: [sg:critical?][critsmash:patch][landed on trunk, needs updated branch patch] → [sg:critical?][critsmash:patch][landed on trunk]Target Milestone: --- → mozilla2.0b4

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a3789246_15223)• 14 years ago |

Depends on: [587484](/show_bug.cgi?id=587484 "RESOLVED FIXED - warning: suggest parentheses around assignment used as truth value in while (... = GetNextContinuation())")

|  | [fantasai](/user_profile?user_id=9018) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=576649#c20)• 14 years ago |
|  | |

Comment on [attachment 465948](/attachment.cgi?id=465948 "fix for 1.9.2 (diff -w)") [[details]](/attachment.cgi?id=465948&action=edit "fix for 1.9.2 (diff -w)") [[diff]](/attachment.cgi?id=465948&action=diff "fix for 1.9.2 (diff -w)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=465948)
fix for 1.9.2 (diff -w)
Ok, I don't understand this patch at all.
1. UpdateViewsForTree
Why is this grabbing out-of-flow frames at all? If I have a placeholder for a fixedpos frame (or simply an abspos frame whose containing block is outside this tree), am I really wanting to pop out and DoApplyRenderingChangeToTree to the fixedpos frame?
2. ReparentStyleContext
AFAICT, both your code and the existing code looks wrong. It seems to me that
a) In 1.9.2, the top level (non-recursive) call to ReparentStyleContext
should be skipping placeholder continuations.
b) In 1.9.2, whenever ReparentStyleContext is called on a placeholder, it
should reparent all its continuations as well.
b) In both trees, whenever ReparentStyleContext is called on a placeholder,
it should reparent the out-of-flow and all its continuations.
c) In both trees, the top level (non-recursive) call to ReparentStylecontet
should be skipping all out-of-flow continuations.
d) No other continuations should be reparented by ReparentStyleContext.
Specifically, there should be no exceptions for true overflow containers.
So for a) and c), maybe have an aIsTopLevelCall argument that defaults to True, and pass False from all calls within ReparentStyleContext. Then return immediately if isTopLevelCall is true and aFrame is either {a placeholder or an out-of-flow} with a prev-continuation.
3. I don't really understand how ReResolveStyleContext is supposed to work.
I think you might need someone else to review this--probably either dbaron or bzbarsky.
[Attachment #465948](/attachment.cgi?id=465948&action=edit "fix for 1.9.2 (diff -w)") -
Flags: review?(fantasai.bugs) → review-

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=576649#c21)• 14 years ago |
|  | |

Reopening to investigate the code in light of the last comment.Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=576649#c22)• 14 years ago |
|  | |

Does the checked-in patch fix the testcase? if so maybe this bug should stay fixed and [comment 20](/show_bug.cgi?id=576649#c20 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing") should be a new bug. The status of this bug is unclear.

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a7590580_251051)• 14 years ago |

Whiteboard: [sg:critical?][critsmash:patch][landed on trunk] → [sg:critical?][critsmash:patch][pushed to trunk]

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a7596889_269330)• 14 years ago |

[Attachment #465948](/attachment.cgi?id=465948&action=edit "fix for 1.9.2 (diff -w)") -
Flags: review?(dbaron)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=576649#c23)• 14 years ago |
|  | |

(In reply to [comment #20](/show_bug.cgi?id=576649#c20 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing"))
> 1. UpdateViewsForTree
>
> Why is this grabbing out-of-flow frames at all? If I have a placeholder for a
> fixedpos frame (or simply an abspos frame whose containing block is outside
> this tree), am I really wanting to pop out and DoApplyRenderingChangeToTree to
> the fixedpos frame?
Going into out-of-flow frames is correct here.
UpdateViewsForTree and DoApplyRenderingChangeToTree are mutually recursive functions that are both called only from ApplyRenderingChangeToTree, whose purpose is handling "repaint" style changes. (Its only caller is nsCSSFrameConstructor::ProcessRestyledFrames .) The way we handle style changes optimizes away style changes of the same type on descendants: if we have a reflow style change on A, we don't report a reflow style change on any descendants of A, etc.
This isn't quite sufficient for out-of-flows, so we need to do a little extra work for out-of-flows for both reflow and repaint. For repaint, that extra work is in these mutually recursive functions. For reflow, the extra work happens in PresShell::FrameNeedsReflow.
An example of a style change where we need this code is this markup:
<span id="a" style="color:red"><span style="float:left">text</span></span>
and this script:
document.getElementById("a").style.color="green"
When we change the style on the span, we report a style change only on the span, not on its descendants. Then ApplyRenderingChangeToTree goes through and looks for appropriate descendants.
Mats's change to this function seems correct to me, although I don't see how it actually fixes any bugs that are currently present. (I see plenty of easily observable bugs that would be present if we re-enabled splitting of floats in columns, though; just put the example above in a situation where the float splits (and, preferably, the span doesn't).)
That said, i still need to understand what the overflow containers checks are doing (and whey they're different between the m-c patch and the 1.9.2 patch).

|  | [Damon Sicore (:damons)](/user_profile?user_id=269330) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=576649#c24)• 14 years ago |
|  | |

Mats, progress here?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=576649#c25)• 14 years ago |
|  | |

David's comment seems to suggest that the trunk patch (still in the tree)
is correct, although redundant since we don't split frames in a way that
creates the crash condition anymore. If so, we should decide if we want
to leave it in or back it out. (I haven't looked at the details regarding
fantasai's comment myself yet. I'm working on [bug 571995](/show_bug.cgi?id=571995 "RESOLVED FIXED - Crash [@ BuildTextRunsScanner::BreakSink::SetBreaks(unsigned int, unsigned int, unsigned char*)] with crazy -moz-column testcase") now, then I'll
get to this bug.)
David, regarding the difference between m-c and 1.9.2 patches:
on 1.9.2 we have placeholder continuations to the out-of-flow
continuations so they should be reachable that way, except for frames
on the overflow-container lists which don't have a placeholder so we
need to process those (they should be the tail end of that continuation
chain).

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a11230955_1689)• 14 years ago |

blocking1.9.1: --- → ?blocking1.9.2: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F) → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F) → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=576649#c26)• 14 years ago |
|  | |

So write after writing [comment 23](/show_bug.cgi?id=576649#c23 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing") I started writing this additional review, but then was distracted by other work; I'll try to get back to it, but this information may be useful:
nsCSSFrameConstructor.cpp:
So, looking at the original patch
( <http://hg.mozilla.org/mozilla-central/rev/735ff84db7b1> ), I don't
understand why the NS\_FRAME\_IS\_OVERFLOW\_CONTAINER check is present
(where it's ||ed with the ! NS\_FRAME\_OUT\_OF\_FLOW check), right above the
code you modified in nsCSSFrameConstructor.cpp. It was added in
<http://hg.mozilla.org/mozilla-central/rev/854d0d479141> , but it seems
like it might be a workaround for part of the bug that you fixed (i.e.,
not looking at next-in-flows). I don't know if fantasai remembers why
that was added; it seems to have first appeared in the patch in bug
154892 [comment 205](/show_bug.cgi?id=576649#c205 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing"), which I think suggests that may be correct, but it's
not clear.
I think that check should have been removed on mozilla-central. I'm not
yet sure about 1.9.2.
As to the differences between the m-c patch and the 1.9.2 patch, I'm
still trying to understand and verify [comment 18](/show_bug.cgi?id=576649#c18 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing").

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=576649#c27)• 14 years ago |
|  | |

FIXED seems a better resolution -- things got checked in, remain checked in, and made the assertions go away. If there's more investigation to do it can be done as part of the branch back-port, or maybe a new bug for it that's make the remaining work more clear.
As long as things are taking it seems unrealistic to resolve by next Thursday's branch code-freeze: punting to next release.Status: REOPENED → RESOLVEDblocking1.9.1: ? → neededblocking1.9.2: ? → neededClosed: 14 years ago → 14 years agoResolution: --- → FIXED

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=576649#c28)• 14 years ago |
|  | |

Attached patch

[additional check I think we should remove now](attachment.cgi?id=493787&action=diff)
— [Details](attachment.cgi?id=493787&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=493787)

[Attachment #493787](/attachment.cgi?id=493787&action=edit "additional check I think we should remove now") -
Flags: review?(bzbarsky)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=576649#c29)• 14 years ago |
|  | |

See [comment 26](/show_bug.cgi?id=576649#c26 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing") for an explanation of the patch in [comment 28](/show_bug.cgi?id=576649#c28 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing").

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=576649#c30)• 14 years ago |
|  | |

Comment on [attachment 493787](/attachment.cgi?id=493787 "additional check I think we should remove now") [[details]](/attachment.cgi?id=493787&action=edit "additional check I think we should remove now") [[diff]](/attachment.cgi?id=493787&action=diff "additional check I think we should remove now") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=493787)
additional check I think we should remove now
I think this needs review from roc or fantasai...
[Attachment #493787](/attachment.cgi?id=493787&action=edit "additional check I think we should remove now") -
Flags: review?(bzbarsky) → review?(roc)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=576649#c31)• 14 years ago |
|  | |

Comment on [attachment 493787](/attachment.cgi?id=493787 "additional check I think we should remove now") [[details]](/attachment.cgi?id=493787&action=edit "additional check I think we should remove now") [[diff]](/attachment.cgi?id=493787&action=diff "additional check I think we should remove now") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=493787)
additional check I think we should remove now
I agree.
[Attachment #493787](/attachment.cgi?id=493787&action=edit "additional check I think we should remove now") -
Flags: review?(roc) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=576649#c32)• 14 years ago |
|  | |

Did [attachment 493787](/attachment.cgi?id=493787 "additional check I think we should remove now") [[details]](/attachment.cgi?id=493787&action=edit "additional check I think we should remove now") [[diff]](/attachment.cgi?id=493787&action=diff "additional check I think we should remove now") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=493787) ever land? Do we need a separate bug to track that?blocking1.9.1: needed → .17+blocking1.9.2: needed → .14+

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=576649#c33)• 14 years ago |
|  | |

(In reply to [comment #28](/show_bug.cgi?id=576649#c28 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing"))
> additional check I think we should remove now
I agree, we should reach those traversing next-continuation...
Also, since we test !OUT\_OF\_FLOW, we can skip lists that only
contains OOFs. I think we could probably skip this test in
nsFrameManager too in a couple of places where we traverse
next-continuations...
(In reply to [comment #32](/show_bug.cgi?id=576649#c32 "RESOLVED FIXED - \"ASSERTION: Invalid offset\" and more with -moz-column, abs pos, huge letter-spacing"))
> Did [attachment 493787](/attachment.cgi?id=493787 "additional check I think we should remove now") [[details]](/attachment.cgi?id=493787&action=edit "additional check I think we should remove now") [[diff]](/attachment.cgi?id=493787&action=diff "additional check I think we should remove now") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=493787) ever land?
Not yet
> Do we need a separate bug to track that?
I spawned it off as [bug 618949](/show_bug.cgi?id=618949 "NEW - Skip child lists that only contain out-of-flows for loops that only process in-flow frames") to get separate tracking.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=576649#c34)• 14 years ago |
|  | |

Followup landed:
<http://hg.mozilla.org/mozilla-central/rev/d0e5fb03bae2>

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a17278426_5168)• 14 years ago |

Whiteboard: [sg:critical?][critsmash:patch][pushed to trunk] → [sg:critical?][critsmash:patch][pushed to trunk][branch patch needs review dbaron]

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=576649#c35)• 14 years ago |
|  | |

Comment on [attachment 465948](/attachment.cgi?id=465948 "fix for 1.9.2 (diff -w)") [[details]](/attachment.cgi?id=465948&action=edit "fix for 1.9.2 (diff -w)") [[diff]](/attachment.cgi?id=465948&action=diff "fix for 1.9.2 (diff -w)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=576649&attachment=465948)
fix for 1.9.2 (diff -w)
r=dbaron
[Attachment #465948](/attachment.cgi?id=465948&action=edit "fix for 1.9.2 (diff -w)") -
Flags: review?(dbaron) → review+

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=576649#c36)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/3e38f463af2a>
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/7ee6d0744ad9>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)Flags: in-testsuite?Whiteboard: [sg:critical?][critsmash:patch][pushed to trunk][branch patch needs review dbaron] → [sg:critical?][critsmash:patch]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=576649#a23343810_1689)• 14 years ago |

Group: core-security

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=576649#c37)• 14 years ago |
|  | |

Crashtest: <http://hg.mozilla.org/mozilla-central/rev/83185e96e3c3>Flags: in-testsuite? → in-testsuite+
You need to [log in](/show_bug.cgi?id=576649&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jesse Ruderman](/user_profile?user_id=11608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_d1a3ccb9_20250124_163935.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/613376)
* [XML](/show_bug.cgi?ctype=xml&id=613376)

Closed
[Bug 613376](/show_bug.cgi?id=613376)

Opened 14 years ago
Closed 14 years ago

# [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin

## Categories

### (Core Graveyard :: Plug-ins, defect)

[Product:](/describecomponents.cgi?product=Core%20Graveyard)

Core Graveyard
▾

Core Graveyard
Old, retired Core components
[See Open Bugs in This Product](/buglist.cgi?product=Core%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Core%20Graveyard&component=Plug-ins#Plug-ins)

Plug-ins
▾

Core Graveyard :: Plug-ins
Bugs in core Mozilla code that supports registering and using plug-ins. For bugs in specific plugins, please file those bugs under External Software Affecting Firefox.
[See Open Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Plug-ins&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Plug-ins&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core%20Graveyard&component=Plug-ins)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

## Tracking

### (blocking2.0 beta8+, blocking1.9.2 .14+, status1.9.2 .14-fixed, blocking1.9.1 .17+, status1.9.1 .17-fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [beta8+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=beta8%2B) |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | beta8+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| status1.9.1 |  | .17-fixed |

## People

### (Reporter: marcia, Assigned: smichaud)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f4932c37bcceaf71fd2472886282a3cb?d=mm&size=40)  [smichaud](/user_profile?user_id=67806)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/cf7a6485ad75c35d66da0af6c88515d5?d=mm&size=40)  [marcia](/user_profile?user_id=8519)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

### ( [URL](http://www.bug.hr/forum/newpost/?replyto=1466246&quote=1&return=%2fforum%2ftopic%2fvijesti-by-forumasi%2ft-com-ponovno-problemima%2f77411.aspx "http://www.bug.hr/forum/newpost/?replyto=1466246&quote=1&return=%2fforum%2ftopic%2fvijesti-by-forumasi%2ft-com-ponovno-problemima%2f77411.aspx") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2011-0059](/show_bug.cgi?id=573873 "RESOLVED FIXED - CSRF from 307 redirects")

Dependency [tree](/showdependencytree.cgi?id=613376&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=613376)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[bug.hr/forum/newpost/?replyto=1466246...](http://www.bug.hr/forum/newpost/?replyto=1466246&quote=1&return=%2fforum%2ftopic%2fvijesti-by-forumasi%2ft-com-ponovno-problemima%2f77411.aspx "http://www.bug.hr/forum/newpost/?replyto=1466246&quote=1&return=%2fforum%2ftopic%2fvijesti-by-forumasi%2ft-com-ponovno-problemima%2f77411.aspx")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, Whiteboard: [sg:critical? on trunk][qa-ntd-192] [qa-ntd-191])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical? on trunk][qa-ntd-192] [qa-ntd-191]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ nsNPAPIPluginInstance::GetOwner ]](https://crash-stats.mozilla.org/signature/?signature=nsNPAPIPluginInstance%3A%3AGetOwner)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [Fix](/attachment.cgi?id=492551)  [14 years ago](#c10)  [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)   1.17 KB, patch |  | [Details](/attachment.cgi?id=492551&action=edit) | [Diff](/attachment.cgi?id=492551&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492551) |
| --- | --- | --- |
| [Fix rev1 (restore assertion and change its message)](/attachment.cgi?id=492564)  [14 years ago](#c11)  [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)   1.26 KB, patch | jaas : [review+](#c13 "14 years ago") | [Details](/attachment.cgi?id=492564&action=edit) | [Diff](/attachment.cgi?id=492564&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492564) |
| [Additional trunk patch to deal with nsDummyJavaPluginOwner](/attachment.cgi?id=492707)  [14 years ago](#c18)  [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)   808 bytes, patch | jaas : [review+](#a414474_18821 "14 years ago") | [Details](/attachment.cgi?id=492707&action=edit) | [Diff](/attachment.cgi?id=492707&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492707) |
| [1.9.2-branch patch](/attachment.cgi?id=492770)  [14 years ago](#c20)  [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)   2.05 KB, patch | jaas : [review+](#a445640_18821 "14 years ago")  dveditz : [approval1.9.2.14+](#c29 "14 years ago") | [Details](/attachment.cgi?id=492770&action=edit) | [Diff](/attachment.cgi?id=492770&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492770) |
| [1.9.1-branch patch](/attachment.cgi?id=492785)  [14 years ago](#c21)  [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)   2.49 KB, patch | jaas : [review+](#a445886_18821 "14 years ago")  christian : [approval1.9.1.17+](#a1206869_482154 "14 years ago") | [Details](/attachment.cgi?id=492785&action=edit) | [Diff](/attachment.cgi?id=492785&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492785) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Marcia Knous [:marcia]](/user_profile?user_id=8519)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=613376#c0)• 14 years ago |
|  | |

Seen while reviewing trunk crash stats and new to the D 20101118063017 build. <http://tinyurl.com/2f56b6g> to the crashes which are all Mac.
Frame Module Signature [Expand] Source
0 XUL nsNPAPIPluginInstance::GetOwner nsISupportsUtils.h:94
1 XUL nsPluginStreamListenerPeer::GetInterfaceGlobal modules/plugin/base/src/nsPluginStreamListenerPeer.cpp:1259
2 XUL nsHttpChannel::OnTransportStatus nsNetUtil.h:1287
3 XUL nsTransportStatusEvent::Run netwerk/base/src/nsTransportUtils.cpp:112
4 XUL nsThread::ProcessNextEvent xpcom/threads/nsThread.cpp:610
5 XUL NS\_ProcessPendingEvents\_P nsThreadUtils.cpp:200
6 XUL nsBaseAppShell::NativeEventCallback widget/src/xpwidgets/nsBaseAppShell.cpp:131
7 XUL nsAppShell::ProcessGeckoEvents widget/src/cocoa/nsAppShell.mm:399
8 CoreFoundation CoreFoundation@0x4e400
9 CoreFoundation CoreFoundation@0x4c5f8
10 XUL PopupAllowedForEvent nsTSubstring.h:113
11 XUL XUL@0x12eaabf
12 XUL nsEventListenerManager::HandleEventInternal dom/base/nsPIDOMWindow.h:657
13 @0x77
14 libSystem.B.dylib libSystem.B.dylib@0x4ee9
15 XUL nsGenericElement::AddRef nsISupportsImpl.h:161
16 XUL nsCOMPtr\_base::assign\_with\_AddRef nsCOMPtr.cpp:88
17 XUL nsDOMEvent::DuplicatePrivateData nsAutoPtr.h:957
18 @0x7fff7118962f
19 CoreFoundation CoreFoundation@0x1b1ef
20 XUL nsGenericElement::Release nsISupportsImpl.h:210
21 XUL nsEventDispatcher::Dispatch nsCOMPtr.h:492
22 @0x13ddfc07f
23 libSystem.B.dylib libSystem.B.dylib@0x6bf9
24 libSystem.B.dylib libSystem.B.dylib@0x527f
25 libSystem.B.dylib libSystem.B.dylib@0x9a03
26 libSystem.B.dylib libSystem.B.dylib@0x3b73a
27 CoreFoundation CoreFoundation@0x609e3
28 libSystem.B.dylib libSystem.B.dylib@0x823b
29 CarbonCore CarbonCore@0x22d8d
30 CarbonCore CarbonCore@0x22c9c
31 HIToolbox HIToolbox@0x54fe5
32 HIToolbox HIToolbox@0x30031
33 HIToolbox HIToolbox@0x2ff7c
34 libSystem.B.dylib libSystem.B.dylib@0x46ae
35 HIToolbox HIToolbox@0x2fbaf
36 CoreFoundation CoreFoundation@0x505a2
37 XUL nsHttpConnection::OnOutputStreamReady netwerk/protocol/http/nsHttpConnection.cpp:802
38 @0x7fff5fbfe45f
39 HIToolbox HIToolbox@0x2f9ff
40 libSystem.B.dylib libSystem.B.dylib@0x66b3
41 CoreFoundation CoreFoundation@0xbaaf
42 CoreFoundation CoreFoundation@0x60b1f
43 CoreFoundation CoreFoundation@0x70f0f
44 libSystem.B.dylib libSystem.B.dylib@0x66b3
45 CoreFoundation CoreFoundation@0x70c62
46 CoreFoundation CoreFoundation@0x709c7
47 CoreFoundation CoreFoundation@0x4bdbe
48 XUL -[ChildView keyUp:] nsTSubstring.h:113
49 CoreFoundation CoreFoundation@0x1052b
50 CoreFoundation CoreFoundation@0x2232a
51 CoreFoundation CoreFoundation@0x1052b
52 libSystem.B.dylib libSystem.B.dylib@0x66b3
53 CoreFoundation CoreFoundation@0x65f1
54 CoreFoundation CoreFoundation@0xfcd6
55 CoreFoundation CoreFoundation@0xfb2e
56 CoreFoundation CoreFoundation@0x2b91b
57 CoreFoundation CoreFoundation@0x6378b
58 AppKit AppKit@0x45166
59 AppKit AppKit@0x436f1
60 CoreFoundation CoreFoundation@0x104c7
61 AppKit AppKit@0x7413e7
62 AppKit AppKit@0x72ed8
63 AppKit AppKit@0x437a8
64 libSystem.B.dylib libSystem.B.dylib@0xa2d8
65 CoreFoundation CoreFoundation@0x104c7
66 CoreFoundation CoreFoundation@0x24d5b
67 XUL js\_InitReflectClass js/src/jsobjinlines.h:944
68 @0x18f
69 CoreFoundation CoreFoundation@0x249d2
70 CoreFoundation CoreFoundation@0x54929
71 CoreFoundation CoreFoundation@0x24a68
72 libSystem.B.dylib libSystem.B.dylib@0x66c7
73 CoreFoundation CoreFoundation@0x3527b
74 AppKit AppKit@0x77e03f
75 libSystem.B.dylib libSystem.B.dylib@0x66c7
76 Foundation Foundation@0x2eed
77 CoreFoundation CoreFoundation@0x2a883
78 libSystem.B.dylib libSystem.B.dylib@0x66c7
79 AppKit AppKit@0x77e03f
80 AppKit AppKit@0x948a
81 XUL nsAppShell::Run widget/src/cocoa/nsAppShell.mm:746
82 XUL nsAppStartup::Run toolkit/components/startup/src/nsAppStartup.cpp:191
83 XUL XRE\_main toolkit/xre/nsAppRunner.cpp:3682
84 firefox-bin main browser/app/nsBrowserApp.cpp:158
85 firefox-bin firefox-bin@0x1953

|  | [Marcia Knous [:marcia]](/user_profile?user_id=8519)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=613376#c1)• 14 years ago |
|  | |

Adding Josh since this looks similar to something mentioned earlier today.

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=613376#c2)• 14 years ago |
|  | |

Regression from beta 7, blocking beta8+.Assignee: nobody → joshmozblocking2.0: --- → beta8+

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a6334_18821)• 14 years ago |

Group: core-securityblocking1.9.2: --- → ?

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a6347_18821)• 14 years ago |

Blocks: [CVE-2011-0059](/show_bug.cgi?id=573873 "RESOLVED FIXED - CSRF from 307 redirects")

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=613376#c3)• 14 years ago |
|  | |

This is really easy to repro thanks to a comment someone put in their crash report. Just visit this URL and the browser will crash:
<http://blogs.msdn.com/b/ie/>

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=613376#c4)• 14 years ago |
|  | |

(In reply to [comment #3](/show_bug.cgi?id=613376#c3 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin"))
> This is really easy to repro thanks to a comment someone put in their crash
> report. Just visit this URL and the browser will crash:
>
> <http://blogs.msdn.com/b/ie/>
This does not reproduce on the 1.9.2 branch so hopefully it isn't a problem at all there. This crash might be caused by the async redirect API on trunk, which would explain why I can't repro on 1.9.2.

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=613376#c5)• 14 years ago |
|  | |

I haven't been able to reproduce the crash going to the IE blog in a debug build. Only happens in a trunk nightly (opt) build for me.

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=613376#c6)• 14 years ago |
|  | |

As Josh has already noted, these crashes started with the 2010-11-18-06-mozilla-central nightly (on OS X), and thus presumably with Josh's patch for [bug 573873](/show_bug.cgi?id=573873 "RESOLVED FIXED - CSRF from 307 redirects").

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=613376#c7)• 14 years ago |
|  | |

Judging by the comments, it's possible these crashes only happen with
the Silverlight plugin. Unfortunately, correlation data no longer
contains data for modules/plugins that run in child processes, so it's
impossible to be sure.
I don't really expect this to turn out to be a Silverlight bug,
though.
I'm not able to reproduce any crashes with <http://blogs.msdn.com/b/ie/>
on OS X 10.5.8. And on OS X 10.6.5, they only happen in 64-bit mode
(not in 32-bit mode) -- so this bug is OOPP-only.

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a334507_67806)• 14 years ago |

Summary: [Mac] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ] → [Mac] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=613376#c8)• 14 years ago |
|  | |

Looking through all topcrashers (on all platforms) for Firefox 4.0b8pre for the two days prior to 2011-11-20, I can't find any that might be the Windows or Linux counterparts of this bug's crash (judging by build ids).
<http://crash-stats.mozilla.com/query/query?product=Firefox&version=Firefox%3A4.0b8pre&range_value=2&range_unit=days&date=11%2F20%2F2010&query_search=signature&query_type=exact&query=&build_id=&process_type=any&hang_type=any&do_query=1>
So this bug really does appear to be OS-X-only.

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a335540_67806)• 14 years ago |

Summary: [Mac] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin → [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=613376#c9)• 14 years ago |
|  | |

As best I can tell, all these crashes take place at the following line, on an attempt to AddRef() a deleted nsNPAPIPluginInstance::mOwner object:
<http://hg.mozilla.org/mozilla-central/annotate/0e9ba7c029e3/modules/plugin/base/src/nsNPAPIPluginInstance.cpp#l1203>
Puzzling that these crashes are sometimes listed as null-dereferences ... but I can't think of any other way to interpret the data.

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=613376#c10)• 14 years ago |
|  | |

Attached patch

[Fix](attachment.cgi?id=492551&action=diff) (obsolete)
— [Details](attachment.cgi?id=492551&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492551)

Turns out this bug has an easy fix.
The proximate cause is as follows:
nsIPluginInstanceOwner::SetInstance is called on the following line
(from nsPluginHost::TrySetUpPluginInstance()):
<http://hg.mozilla.org/mozilla-central/annotate/2f9f6cb3a0ef/modules/plugin/base/src/nsPluginHost.cpp#l1362>
Then in the next line (1367) nsIPluginInstance::Initialize() is
called. But for some reason this call fails and
nsIPluginInstanceOwner::SetInstance() gets called again with aInstance
set to nsnull:
<http://hg.mozilla.org/mozilla-central/annotate/2f9f6cb3a0ef/modules/plugin/base/src/nsPluginHost.cpp#l1369>
Then (inside the call to nsPluginInstanceOwner::SetInstance())
nsPluginInstanceOwner::mInstance gets nulled out:
<http://hg.mozilla.org/mozilla-central/annotate/2f9f6cb3a0ef/layout/generic/nsObjectFrame.cpp#l2917>
Which in turn causes nsIPluginInstance::InvalidateOwner() to fail to
be called from the following line in the nsPluginInstanceOwner
destructor:
<http://hg.mozilla.org/mozilla-central/annotate/2f9f6cb3a0ef/layout/generic/nsObjectFrame.cpp#l2886>
Which means that nsNPAPIPluginInstance::mOwner doesn't get nulled out
when the object to which mOwner is a weak link gets destroyed. Which
leads directly to this bug's crash.
The fix is to also call nsIPluginInstance::InvalidateOwner() from
nsPluginInstanceOwner::SetInstance() when the value of mInstance
changes from non-null to null.
I got rid of the assertion -- since what happens in
nsPluginHost::TrySetupPluginInstance() is a case of
nsPluginInstanceOwner::SetInstance() legitimately getting called twice
on the same object.
Note that with this fix, the Silverlight plugin at
<http://blogs.msdn.com/b/ie/> usually fails to load -- but that's
another bug (and the consequence of nsIPluginInstance::Initialize()
doing an error return).Assignee: joshmoz → smichaudStatus: NEW → ASSIGNED
[Attachment #492551](/attachment.cgi?id=492551&action=edit "Fix") -
Flags: review?(joshmoz)

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=613376#c11)• 14 years ago |
|  | |

Attached patch

[Fix rev1 (restore assertion and change its message)](attachment.cgi?id=492564&action=diff)
— [Details](attachment.cgi?id=492564&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492564)

> I got rid of the assertion -- since what happens in
> nsPluginHost::TrySetupPluginInstance() is a case of
> nsPluginInstanceOwner::SetInstance() legitimately getting called
> twice on the same object.
Actually the assertion makes sense, but its message needs to be changed.
[Attachment #492551](/attachment.cgi?id=492551&action=edit "Fix") -
Attachment is obsolete: true
[Attachment #492564](/attachment.cgi?id=492564&action=edit "Fix rev1 (restore assertion and change its message)") -
Flags: review?(joshmoz)
[Attachment #492551](/attachment.cgi?id=492551&action=edit "Fix") -
Flags: review?(joshmoz)

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=613376#c12)• 14 years ago |
|  | |

(In reply to [comment #10](/show_bug.cgi?id=613376#c10 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin"))
> Then in the next line (1367) nsIPluginInstance::Initialize() is
> called. But for some reason this call fails and
> nsIPluginInstanceOwner::SetInstance() gets called again with aInstance
> set to nsnull:
Silverlight is not compatible with our 64-bit builds on Mac OS X 10.6 because it can only use Carbon NPAPI. See [bug 598223](/show_bug.cgi?id=598223 "RESOLVED FIXED - more gracefully handle Carbon plugins that are forced out of process") about making such plugins fail to initialize. Perhaps this is the reason "nsIPluginInstance::Initialize" is failing.

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=613376#c13)• 14 years ago |
|  | |

Comment on [attachment 492564](/attachment.cgi?id=492564 "Fix rev1 (restore assertion and change its message)") [[details]](/attachment.cgi?id=492564&action=edit "Fix rev1 (restore assertion and change its message)") [[diff]](/attachment.cgi?id=492564&action=diff "Fix rev1 (restore assertion and change its message)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492564)
Fix rev1 (restore assertion and change its message)
Looks good, thanks! I don't think the assertion is particularly helpful, maybe just drop it altogether.
We don't have the Silverlight cause for this crash on the branches, but do we have this same owner invalidation issue?
[Attachment #492564](/attachment.cgi?id=492564&action=edit "Fix rev1 (restore assertion and change its message)") -
Flags: review?(joshmoz) → review+

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=613376#c14)• 14 years ago |
|  | |

Landed on trunk:
<http://hg.mozilla.org/mozilla-central/rev/832e6220498a>
> Looks good, thanks!
You're welcome.
> I don't think the assertion is particularly helpful, maybe just drop
> it altogether.
I decided to keep it. I'm not a big fan of assertions (or of debug
builds). But if someone takes it into their head to call
nsPluginInstanceOwner::SetInstance(nsIPluginInstance \*aInstance) with
aInstance and the existing mInstance both non-null, this bug's crashes
will start happening again. The assertion at least helps to ward this
off.Status: ASSIGNED → RESOLVEDClosed: 14 years agoResolution: --- → FIXED

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=613376#c15)• 14 years ago |
|  | |

(In reply to [comment #13](/show_bug.cgi?id=613376#c13 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin"))
> We don't have the Silverlight cause for this crash on the branches,
> but do we have this same owner invalidation issue?
Yes, we do:
<http://hg.mozilla.org/releases/mozilla-1.9.2/annotate/aa9371c6c23f/modules/plugin/base/src/nsPluginHost.cpp#l3610>
<http://hg.mozilla.org/releases/mozilla-1.9.1/annotate/a0e34daf1661/modules/plugin/base/src/nsPluginHostImpl.cpp#l3869>
I'll prepare patches for both branches.

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=613376#c16)• 14 years ago |
|  | |

Another problem:
nsDummyJavaPluginOwner::SetInstance() (in dom/base/nsGlobalWindow.cpp)
seems to need the same change as nsPluginInstanceOwner::SetInstance()
(in layout/generic/nsObjectFrame.cpp).
I'll prepare another trunk patch for that, and add it to my branch
patches.

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=613376#c17)• 14 years ago |
|  | |

(In reply to [comment #12](/show_bug.cgi?id=613376#c12 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin"))
> Silverlight is not compatible with our 64-bit builds on Mac OS X
> 10.6 because it can only use Carbon NPAPI.
Oops, I'd forgotten about that.
> See [bug 598223](/show_bug.cgi?id=598223 "RESOLVED FIXED - more gracefully handle Carbon plugins that are forced out of process") about making such plugins fail to initialize. Perhaps
> this is the reason "nsIPluginInstance::Initialize" is failing.
Yes. The call to nsNPAPIPluginInstance::Initialize() calls
InitializePlugin(), which fails at the following line (when
PluginModuleParent::NPP\_New() makes an error return):
<http://hg.mozilla.org/mozilla-central/annotate/29323301bb17/modules/plugin/base/src/nsNPAPIPluginInstance.cpp#l415>
This must be because of the following code added by your patch for bug
598223:
<http://hg.mozilla.org/mozilla-central/annotate/29323301bb17/dom/plugins/PluginModuleChild.cpp#l1774>

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=613376#c18)• 14 years ago |
|  | |

Attached patch

[Additional trunk patch to deal with nsDummyJavaPluginOwner](attachment.cgi?id=492707&action=diff)
— [Details](attachment.cgi?id=492707&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492707)

[Attachment #492707](/attachment.cgi?id=492707&action=edit "Additional trunk patch to deal with nsDummyJavaPluginOwner") -
Flags: review?(joshmoz)

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a414474_18821)• 14 years ago |

[Attachment #492707](/attachment.cgi?id=492707&action=edit "Additional trunk patch to deal with nsDummyJavaPluginOwner") -
Flags: review?(joshmoz) → review+

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=613376#c19)• 14 years ago |
|  | |

Comment on [attachment 492707](/attachment.cgi?id=492707 "Additional trunk patch to deal with nsDummyJavaPluginOwner") [[details]](/attachment.cgi?id=492707&action=edit "Additional trunk patch to deal with nsDummyJavaPluginOwner") [[diff]](/attachment.cgi?id=492707&action=diff "Additional trunk patch to deal with nsDummyJavaPluginOwner") [[review]](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492707)
Additional trunk patch to deal with nsDummyJavaPluginOwner
Landed on trunk:
<http://hg.mozilla.org/mozilla-central/rev/43a10e7fbef3>

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=613376#c20)• 14 years ago |
|  | |

Attached patch

[1.9.2-branch patch](attachment.cgi?id=492770&action=diff)
— [Details](attachment.cgi?id=492770&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492770)

[Attachment #492770](/attachment.cgi?id=492770&action=edit "1.9.2-branch patch") -
Flags: review?(joshmoz)

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=613376#c21)• 14 years ago |
|  | |

Attached patch

[1.9.1-branch patch](attachment.cgi?id=492785&action=diff)
— [Details](attachment.cgi?id=492785&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492785)

[Attachment #492785](/attachment.cgi?id=492785&action=edit "1.9.1-branch patch") -
Flags: review?(joshmoz)

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a445640_18821)• 14 years ago |

[Attachment #492770](/attachment.cgi?id=492770&action=edit "1.9.2-branch patch") -
Flags: review?(joshmoz) → review+

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a445886_18821)• 14 years ago |

[Attachment #492785](/attachment.cgi?id=492785&action=edit "1.9.1-branch patch") -
Flags: review?(joshmoz) → review+

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a511881_251051)• 14 years ago |

URL: [http://www.bug.hr/forum/newpost/?repl...](http://www.bug.hr/forum/newpost/?replyto=1466246&quote=1&return=%2fforum%2ftopic%2fvijesti-by-forumasi%2ft-com-ponovno-problemima%2f77411.aspx)

|  | [Stephen Donner [:stephend] Not actively reading bugmail](/user_profile?user_id=79002) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=613376#c23)• 14 years ago |
|  | |

(Another is to load <http://wwwns.akamai.com/hdnetwork/demo/flash/default.html> and let Flash initialize, then click on the Silverlight logo to the right of the mobile phone.)

|  | [Stephen Donner [:stephend] Not actively reading bugmail](/user_profile?user_id=79002) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=613376#c24)• 14 years ago |
|  | |

Did this bug cause 614812?

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=613376#c25)• 14 years ago |
|  | |

> Did this bug cause 614812?
No.
Before this bug's patch landed, the STR at [bug 614812](/show_bug.cgi?id=614812 "VERIFIED DUPLICATE - Silverlight plugin fails to load") would have
caused this bug's crash. Now the Silverlight plugin just fails to
load, thanks to what Josh pointed out in [comment #12](/show_bug.cgi?id=613376#c12 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin"):
> Silverlight is not compatible with our 64-bit builds on Mac OS X
> 10.6 because it can only use Carbon NPAPI. See [bug 598223](/show_bug.cgi?id=598223 "RESOLVED FIXED - more gracefully handle Carbon plugins that are forced out of process") about
> making such plugins fail to initialize.
Silverlight plugins should work in 32-bit mode, though.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=613376#c26)• 14 years ago |
|  | |

Is there a branch testcase? If we take this patch on the branches how would QA verify the fix?

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=613376#c27)• 14 years ago |
|  | |

> Is there a branch testcase?
No.
> If we take this patch on the branches how would QA verify the fix?
Not that I'm aware of.
But the patch is very simple and straightforward. And [comment #15](/show_bug.cgi?id=613376#c15 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin")
shows that it's clearly needed on the branches.

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=613376#c28)• 14 years ago |
|  | |

>> If we take this patch on the branches how would QA verify the fix?
>
> Not that I'm aware of.
I'm not aware of any way QA could verify the fix on the branches.
> But the patch is very simple and straightforward. And [comment #15](/show_bug.cgi?id=613376#c15 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin")
> shows that it's clearly needed on the branches.
[Comment #15](/show_bug.cgi?id=613376#c15 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin") shows that, on both branches,
nsIPluginInstanceOwner::SetInstance() can be called twice on the same
object, first with aInstance set to a non-null value, and then with
aInstance set to nsnull.
Without my patch, doing this will cause this bug's crash, even on the
branches.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a1102517_1689)• 14 years ago |

blocking1.9.1: --- → neededblocking1.9.2: ? → needed
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=613376#c29)• 14 years ago |
|  | |

Comment on [attachment 492770](/attachment.cgi?id=492770 "1.9.2-branch patch") [[details]](/attachment.cgi?id=492770&action=edit "1.9.2-branch patch") [[diff]](/attachment.cgi?id=492770&action=diff "1.9.2-branch patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492770)
1.9.2-branch patch
Approved for 1.9.2.14, a=dveditz for release-drivers
[Attachment #492770](/attachment.cgi?id=492770&action=edit "1.9.2-branch patch") -
Flags: approval1.9.2.14+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=613376#c30)• 14 years ago |
|  | |

Comment on [attachment 492785](/attachment.cgi?id=492785 "1.9.1-branch patch") [[details]](/attachment.cgi?id=492785&action=edit "1.9.1-branch patch") [[diff]](/attachment.cgi?id=492785&action=diff "1.9.1-branch patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492785)
1.9.1-branch patch
Approved for 1.9.1.16, a=dveditz for release-drivers
[Attachment #492785](/attachment.cgi?id=492785&action=edit "1.9.1-branch patch") -
Flags: approval1.9.1.16+

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=613376#c31)• 14 years ago |
|  | |

We wouldn't block a security release on this, so marking it as wanted rather
than blocking and approving the patches.

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a1104554_482154)• 14 years ago |

blocking1.9.1: needed → ---blocking1.9.2: needed → ---

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=613376#c32)• 14 years ago |
|  | |

Comment on [attachment 492770](/attachment.cgi?id=492770 "1.9.2-branch patch") [[details]](/attachment.cgi?id=492770&action=edit "1.9.2-branch patch") [[diff]](/attachment.cgi?id=492770&action=diff "1.9.2-branch patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492770)
1.9.2-branch patch
Landed on the 1.9.2 branch:
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/0e09c9543abe>

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a1185825_67806)• 14 years ago |

[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=613376#c33)• 14 years ago |
|  | |

Comment on [attachment 492785](/attachment.cgi?id=492785 "1.9.1-branch patch") [[details]](/attachment.cgi?id=492785&action=edit "1.9.1-branch patch") [[diff]](/attachment.cgi?id=492785&action=diff "1.9.1-branch patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=613376&attachment=492785)
1.9.1-branch patch
Landed on the 1.9.1 branch:
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/fa3bf9f20cf5>
This was approved for the 1.9.1.16 branch ... but was that a mistake? Should it have been approved for the 1.9.1.17 branch instead? If not, do I also need to land it on the GECKO19116\_20101122\_RELBRANCH?

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a1186282_67806)• 14 years ago |

[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=613376#c34)• 14 years ago |
|  | |

Sorry, it should have been .17. Simple typo, everything is in the correct place. I'll fix the flag.

|  | [LegNeato](/user_profile?user_id=482154) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a1206869_482154)• 14 years ago |

[Attachment #492785](/attachment.cgi?id=492785&action=edit "1.9.1-branch patch") -
Flags: approval1.9.1.16+ → approval1.9.1.17+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=613376#c35)• 14 years ago |
|  | |

I can't reproduce this on OS X 10.6 using 1.9.2.13 or 1.9.1.16 with the urls in [comment 22](/show_bug.cgi?id=613376#c22 "RESOLVED FIXED - [Mac, OOPP] Firefox 4.0b8pre crash in [@ nsNPAPIPluginInstance::GetOwner ], possibly only with Silverlight plugin") and 23 (or the IE Blog). We've seen this reproduce on 1.9.2 and 1.9.1?Whiteboard: [qa-examined-191] [qa-examined-192] [qa-needs-STR]

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=613376#c36)• 14 years ago |
|  | |

This bug's crash wasn't reproducible on the branches (only on the trunk). The reason is that we don't try to run the Silverlight plugin out-of-process except on the trunk, and then only in 64-bit mode.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=613376#c37)• 14 years ago |
|  | |

Marking this as nothing to do (NTD) for QA then since we cannot verify.Whiteboard: [qa-examined-191] [qa-examined-192] [qa-needs-STR] → [qa-ntd-192] [qa-ntd-191]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a6566082_1689)• 14 years ago |

Whiteboard: [qa-ntd-192] [qa-ntd-191] → [sg:critical? on trunk][qa-ntd-192] [qa-ntd-191]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a6566095_1689)• 14 years ago |

blocking1.9.1: --- → .17+blocking1.9.2: --- → .14+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a11327898_1689)• 14 years ago |

Group: core-security

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a17859645_1)• 14 years ago |

Crash Signature: [@ nsNPAPIPluginInstance::GetOwner ]

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=613376#a362605804_546015)• 3 years ago |

Product: Core → Core Graveyard
You need to [log in](/show_bug.cgi?id=613376&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from support.avaya.com_ef2ee7f3_20250124_163909.html ===


---

seamonkey security update (RHSA-2011-0313)

Original Release Date: March 2, 2011

Last Revised: March 2, 2011

Number: ASA-2011-064

Risk Level: Low

Advisory Version: 1.0

Advisory Status: Final

---

## 1. Overview:

SeaMonkey is an open source web browser, email and newsgroup client, IRC
chat client, and HTML editor.

A flaw was found in the way SeaMonkey handled dialog boxes. An attacker
could use this flaw to create a malicious web page that would present a
blank dialog box that has non-functioning buttons. If a user closes the
dialog box window, it could unexpectedly grant the malicious web page
elevated privileges. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
[CVE-2011-0051](https://www.redhat.com/security/data/cve/CVE-2011-0051.html) to this issue.

Several flaws were found in the processing of malformed web content. A web
page containing malicious content could cause SeaMonkey to crash or,
potentially, execute arbitrary code with the privileges of the user running
SeaMonkey. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
[CVE-2011-0053](https://www.redhat.com/security/data/cve/CVE-2011-0053.html) to this issue.

A flaw was found in the way SeaMonkey handled plug-ins that perform HTTP
requests. If a plug-in performed an HTTP request, and the server sent a 307
redirect response, the plug-in was not notified, and the HTTP request was
forwarded. The forwarded request could contain custom headers, which could
result in a Cross Site Request Forgery attack. The Common Vulnerabilities and Exposures project (cve.mitre.org) has assigned the name
[CVE-2011-0059](https://www.redhat.com/security/data/cve/CVE-2011-0059.html) to this issue.

More information about these vulnerabilities can be found in the security advisory issued by Red Hat:

* <https://rhn.redhat.com/errata/RHSA-2011-0313.html>

## 2. Avaya System Products using a modified version of RHEL4 with affected components/packages installed:

| Product: | Affected Version(s): | Risk Level: | Actions: |
| --- | --- | --- | --- |
| Avaya Message Networking | 3.1 | Low | Upgrade to MN 5.2 or later. |

### Mitigating Factors:

When determining risk, Avaya takes into account many factors as
outlined by Avaya's
[Security Vulnerability Classification Policy](https://support.avaya.com/css/P8/documents/100066674).
The following table describes factors that mitigate the risk of specific
vulnerabilities for affected Avaya products:

| Vulnerability | Mitigating Factors |
| --- | --- |
| CVE-2011-0051 CVE-2011-0053 CVE-2011-0059 | This is a Low as no critical system processess or applications would be affected. |

## 3. Avaya Software-Only Products:

Avaya software-only products operate on general-purpose operating systems.
Occasionally vulnerabilities may be discovered in the underlying operating system or
applications that come with the operating system. These vulnerabilities often do not
impact the software-only product directly but may threaten the integrity of the
underlying platform.

In the case of this advisory Avaya software-only products are not affected by the
vulnerability directly but the underlying Linux platform may be. Customers should
determine on which Linux operating system the product was installed and then follow
that vendor's guidance.

| Product: | Actions: |
| --- | --- |
| Avaya Aura™ Application Enablement Services 4.x/5.x | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the AES application. |
| CVLAN | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the CVLAN application. |
| Avaya Integrated Management Suite (IMS) | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the IMS application. |
| Avaya Aura™ Presence Services | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the PS application. |
| Avaya Aura™ System Manager 1.0 | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the SMGR application. |
| Voice Portal | Depending on the Operating System provided by customers, the affected package may be installed on the underlying Operating System supporting the Voice Portal application. |

**Recommended Actions for Software-Only Products:**
In the event that the affected package is installed, Avaya recommends that customers follow recommended actions supplied by Red Hat regarding their Enterprise Linux.

## 4. Additional Information:

Additional information may also be available via the Avaya support
[website](http://support.avaya.com) and through your Avaya
account representative. Please contact your Avaya product support
representative, or dial 1-800-242-2121, with any questions.

## 5. Disclaimer:

ALL INFORMATION IS BELIEVED TO BE CORRECT AT THE TIME OF PUBLICATION
AND IS PROVIDED "AS IS". AVAYA INC., ON BEHALF ITSELF AND ITS
SUBSIDIARIES AND AFFILIATES (HEREINAFTER COLLECTIVELY REFERRED TO AS
"AVAYA"), DISCLAIMS ALL WARRANTIES, EITHER EXPRESS OR IMPLIED,
INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE AND FURTHERMORE, AVAYA MAKES NO REPRESENTATIONS
OR WARRANTIES THAT THE STEPS RECOMMENDED WILL ELIMINATE SECURITY OR VIRUS
THREATS TO CUSTOMERS' SYSTEMS. IN NO EVENT SHALL AVAYA BE LIABLE FOR ANY
DAMAGES WHATSOEVER ARISING OUT OF OR IN CONNECTION WITH THE INFORMATION OR
RECOMMENDED ACTIONS PROVIDED HEREIN, INCLUDING DIRECT, INDIRECT, INCIDENTAL,
STATUTORY, CONSEQUENTIAL DAMAGES, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES,
EVEN IF AVAYA HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

THE INFORMATION PROVIDED HERE DOES NOT AFFECT THE SUPPORT AGREEMENTS
IN PLACE FOR AVAYA PRODUCTS. SUPPORT FOR AVAYA PRODUCTS CONTINUES TO BE
EXECUTED AS PER EXISTING AGREEMENTS WITH AVAYA.

## 6. Revision History:

V 1.0 - March 2, 2011 - Initial Statement issued.

Send information regarding any discovered security problems with Avaya
products to either the contact noted in the product's documentation or
securityalerts@avaya.com.

Linux® is the registered trademark of Linus Torvalds in the U.S. and other countries.

© 2011 Avaya Inc. All Rights Reserved. All trademarks identifying Avaya products by the ® or ™ are registered trademarks or trademarks, respectively, of Avaya Inc. All other trademarks are the property of their respective owners.



=== Content from bugzilla.mozilla.org_983b0c8f_20250124_163915.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/558531)
* [XML](/show_bug.cgi?ctype=xml&id=558531)

Closed
[Bug 558531](/show_bug.cgi?id=558531)

Opened 15 years ago
Closed 15 years ago

# Typo in JS\_ResolveStandardClass causes built-in prototypes to be overwritten

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Typo in JS\_ResolveStandardClass causes built-in prototypes to be overwritten

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: dmandelin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/a86fae4b06c1570a6c1a1bc1c5a6c1f6?d=mm&size=40)  [dmandelin](/user_profile?user_id=294323)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[geniter](/show_bug.cgi?id=326466 "RESOLVED FIXED - Implement Pythonic generators and iteration protocol support for JS1.7"), [JaegerFuzz](/show_bug.cgi?id=549412 "RESOLVED FIXED - [meta] JaegerMonkey fuzz bugs")

Dependency [tree](/showdependencytree.cgi?id=558531&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=558531)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, regression, testcase, Whiteboard: [sg:critical?]fixed-in-tracemonkey [qa-ntd-191] [qa-ntd-192])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?]fixed-in-tracemonkey [qa-ntd-191] [qa-ntd-192]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [decoder](/user_profile?user_id=395101) | [in-testsuite](#a92908587_395101 "12 years ago") | + |
| --- | --- | --- |
| [decoder](/user_profile?user_id=395101) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Patch](/attachment.cgi?id=440080)  [15 years ago](#c5)  [David Mandelin [:dmandelin]](/user_profile?user_id=294323)   820 bytes, patch | Waldo : [review+](#c6 "15 years ago") | [Details](/attachment.cgi?id=440080&action=edit) | [Diff](/attachment.cgi?id=440080&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558531&attachment=440080) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=558531#c0)• 15 years ago |
|  | |

function f2(c) {
return {
g: c.match(/:/) & c.match(/:/) & c.match(/f/) & c.m & c.a & c.match(/f/) &
c.match(/c/) & c.match(/a/) & (/s/) & c.match(/e/) & c.match(/s/) &
(c.match(/./) & c.i) & (c.match(/\\*/)) & (c.match(/n/)),
y: c.a & c.a & c.match(/\)/) & c.match(/\)/) & c.match(/\)/)
& c.match(/\\/),
c: c.match(/f/)
}
}
function f1(c) {
t = f2(c.replace(/s/))
try {
eval(c)
} catch(e) {}
f4();
if (c.indexOf("<") == -1 || c.indexOf())
try {} catch(e) {}
try {
try {
l
} catch(e) {}
if ("unwatch" in this) {}
g
} catch(e) {}
try {} catch(p) {}
}
function f4() {
try {} catch(e) {} {
try {
eval(s + "")
} catch(e) {}
}
} [{}]
s = [{},{}];
(function(){}())
s[{},{},{}] = [function(){}]
a = [{},{},{}].concat([{},{}])
f1("")
f1("")
f1("n")
f1("")
f1("(\_\_proto\_\_=null)")
f1("for(var z=0;z<1;z++){gc()(\*::\*)}")
f1("gc()")
f1("<")
crashes js debug shell on JM changeset 0b7f385f3f59 with -m at 0xdadadade with js::methodjit::JaegerShot near the top of the stack. I tested this on 32-bit Mac debug build off changeset 0b7f385f3f59 because tip didn't compile for me. :(
(Not exactly the smallest) regression window:
<http://hg.mozilla.org/users/danderson_mozilla.com/jaegermonkey/pushloghtml?fromchange=0075ab7ae8fe&tochange=0b7f385f3f59>
Stack:
Exception Type: EXC\_BAD\_ACCESS (SIGSEGV)
Exception Codes: KERN\_INVALID\_ADDRESS at 0x00000000dadadade
Crashed Thread: 0 Dispatch queue: com.apple.main-thread
Thread 0 Crashed: Dispatch queue: com.apple.main-thread
0 ??? 0x003ec4b9 0 + 4113593
1 js-dbg-32-jm-darwin 0x001e2e82 js::methodjit::JaegerShot(JSContext\*) + 408
2 js-dbg-32-jm-darwin 0x000a0f04 js\_RunScript + 158
3 js-dbg-32-jm-darwin 0x000a1453 js\_Execute + 1253
4 js-dbg-32-jm-darwin 0x00012255 JS\_ExecuteScript + 54
5 js-dbg-32-jm-darwin 0x0000aaf5 Process(JSContext\*, JSObject\*, char\*, int) + 458 (js.cpp:450)
6 js-dbg-32-jm-darwin 0x0000b862 ProcessArgs(JSContext\*, JSObject\*, char\*\*, int) + 2326 (js.cpp:870)
7 js-dbg-32-jm-darwin 0x0000bc2f main + 953 (js.cpp:4975)
8 js-dbg-32-jm-darwin 0x00002881 \_start + 208
9 js-dbg-32-jm-darwin 0x000027b0 start + 40

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=558531#c1)• 15 years ago |
|  | |

Reproducible with JM tip.

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558531#a211956_294323)• 15 years ago |

Assignee: general → dmandelin

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=558531#c2)• 15 years ago |
|  | |

The cause: For the |indexOf| operations on line 17, we bake in the identity of the String class prototype. Then, GC apparently collects it and we start navigating through an invalid object the next time we use the PIC on line 17.
This could be solved by invalidating any primitive-string PICs on every GC. That's painful, though. It seems like it would be better to bake in the pointer to the string method, and then have some guard or invalidation to detect monkey-patching of String.prototype over standard methods.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=558531#c3)• 15 years ago |
|  | |

This seems to causing most of the current js::methodjit::JaegerShot crashes in JM now, when running jsfunfuzz. :(

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=558531#c4)• 15 years ago |
|  | |

OK, I'll bump up the priority on this. I do want to finish an investigation of the micro-level perf of the PICs first.

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=558531#c5)• 15 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=440080&action=diff)
— [Details](attachment.cgi?id=440080&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558531&attachment=440080)

The bug is in jsapi.cpp, so I want to land the fix on TM. It's pretty clear the bug is just a typo.
My earlier guess that |String.prototype| was getting GC'd was correct. The detailed cause is this:
1. At some point, String.prototype is initialized and stored in slot 12 of the global object, which is its normal home.
2. Evaluating |"unwatch" in this| calls the global resolver hook. This in turn calls JS\_ResolveStandardClass. JS\_ResolveStandardClass finds the right entry, but due to a typo it reads out the wrong name element, which causes it to call the init function for the string standard class. This overwrites the global slot where String.prototype is stored.
3. A GC gets run, and the old String.prototype gets collected.
4. A JM PIC stub that assumes that String.prototype cannot change (per ECMA-262 5e, 15.5.3.1) crashes.
[Attachment #440080](/attachment.cgi?id=440080&action=edit "Patch") -
Flags: review?(jwalden+bmo)

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558531#a881931_15223)• 15 years ago |

Blocks: [geniter](/show_bug.cgi?id=326466 "RESOLVED FIXED - Implement Pythonic generators and iteration protocol support for JS1.7")

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558531#a897532_83595)• 15 years ago |

Group: core-securityWhiteboard: [sg:critical?]

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=558531#c6)• 15 years ago |
|  | |

Comment on [attachment 440080](/attachment.cgi?id=440080 "Patch") [[details]](/attachment.cgi?id=440080&action=edit "Patch") [[diff]](/attachment.cgi?id=440080&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=558531&attachment=440080)
Patch
Goes back to 2006 at least, definitely in stable releases with TM, guessing probably triggerable somehow...should be fixed on branches too.
[Attachment #440080](/attachment.cgi?id=440080&action=edit "Patch") -
Flags: review?(jwalden+bmo) → review+

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=558531#c7)• 15 years ago |
|  | |

<http://bonsai.mozilla.org/cvsblame.cgi?file=mozilla/js/src/jsapi.c&rev=3.453>
<http://bonsai.mozilla.org/cvsview2.cgi?diff_mode=context&whitespace_mode=show&root=/cvsroot&subdir=mozilla/js/src&command=DIFF_FRAMESET&file=jsapi.c&rev2=3.266&rev1=3.265>

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=558531#c8)• 15 years ago |
|  | |

<http://hg.mozilla.org/tracemonkey?pushloghtml>Summary: JM: Crash [@ 0xdadadade] → Typo in JS\_ResolveStandardClass causes built-in prototypes to be overwrittenWhiteboard: [sg:critical?] → [sg:critical?]fixed-in-tracemonkey

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=558531#c9)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/d0e7da895292>Status: NEW → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=558531#c10)• 14 years ago |
|  | |

Nominating for branches based on [comment 6](/show_bug.cgi?id=558531#c6 "RESOLVED FIXED - Typo in JS_ResolveStandardClass causes built-in prototypes to be overwritten"). Can't reproduce the crash using the given testcase but the code has the same problem.blocking1.9.1: --- → ?blocking1.9.2: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558531#a23798293_1689)• 14 years ago |

blocking1.9.1: ? → .17+blocking1.9.2: ? → .14+

|  | [David Mandelin [:dmandelin]](/user_profile?user_id=294323)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=558531#c11)• 14 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/d1179bed506f>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/cc28ca4d7ca2>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=558531#c12)• 14 years ago |
|  | |

(In reply to [comment #10](/show_bug.cgi?id=558531#c10 "RESOLVED FIXED - Typo in JS_ResolveStandardClass causes built-in prototypes to be overwritten"))
> Nominating for branches based on [comment 6](/show_bug.cgi?id=558531#c6 "RESOLVED FIXED - Typo in JS_ResolveStandardClass causes built-in prototypes to be overwritten"). Can't reproduce the crash using the
> given testcase but the code has the same problem.
No way for QA to verify this fix in the branch releases.Whiteboard: [sg:critical?]fixed-in-tracemonkey → [sg:critical?]fixed-in-tracemonkey [qa-ntd-191] [qa-ntd-192]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558531#a30566629_1689)• 14 years ago |

Group: core-security

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=558531#c13)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/e8db09a9c66c>

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558531#a92908587_395101)• 12 years ago |

Flags: in-testsuite+
You need to [log in](/show_bug.cgi?id=558531&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [David Mandelin [:dmandelin]](/user_profile?user_id=294323)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_9332a12f_20250124_163916.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/558541)
* [XML](/show_bug.cgi?ctype=xml&id=558541)

Closed
[Bug 558541](/show_bug.cgi?id=558541)

Opened 15 years ago
Closed 15 years ago

# js\_SetPropertyHelper doesn't notify tracer when setting a non-writable property with strict option on or "Assertion failure: s0->isQuad(), at ../jstracer.cpp" or "Assertion failure: v\_ins->isF64(), at ../jstracer.cpp"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

js\_SetPropertyHelper doesn't notify tracer when setting a non-writable property with strict option on or "Assertion failure: s0->isQuad(), at ../jstracer.cpp" or "Assertion failure: v\_ins->isF64(), at ../jstracer.cpp"

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 | --- | [beta1+](/buglist.cgi?f1=cf_blocking_20&o1=equals&v1=beta1%2B) |
| blocking1.9.2 | --- | [.14+](/buglist.cgi?f1=cf_blocking_192&o1=equals&v1=.14%2B) |
| status1.9.2 | --- | [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed) |
| blocking1.9.1 | --- | [.17+](/buglist.cgi?f1=cf_blocking_191&o1=equals&v1=.17%2B) |
| status1.9.1 | --- | [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| blocking2.0 |  | beta1+ |
| blocking1.9.2 |  |  |
| status1.9.2 |  | .14-fixed |
| blocking1.9.1 |  | .17+ |
| relnote-firefox |  | --- |
| status1.9.1 |  | .17-fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: Waldo, Assigned: Waldo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d26a0ca7ae1134e0e1dbdddf82e28929?d=mm&size=40)  [Waldo](/user_profile?user_id=83595)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d26a0ca7ae1134e0e1dbdddf82e28929?d=mm&size=40)  [Waldo](/user_profile?user_id=83595)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[490666](/show_bug.cgi?id=490666 "RESOLVED FIXED - We don't cache access to shared properties in the property cache")

Dependency [tree](/showdependencytree.cgi?id=558541&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=558541)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: assertion, regression, testcase, Whiteboard: [sg:critical?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [Waldo](/user_profile?user_id=83595) | [in-testsuite](#c14 "14 years ago") | + |
| --- | --- | --- |
| [Waldo](/user_profile?user_id=83595) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [Patch](/attachment.cgi?id=438835)  [15 years ago](#c5)  [Jeff Walden [:Waldo]](/user_profile?user_id=83595)   2.09 KB, patch | jorendorff : [review+](#a544301_281791 "15 years ago") | [Details](/attachment.cgi?id=438835&action=edit) | [Diff](/attachment.cgi?id=438835&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=438835) |
| --- | --- | --- |
| [Potential 192 patch](/attachment.cgi?id=504878)  [14 years ago](#c9)  [Jeff Walden [:Waldo]](/user_profile?user_id=83595)   1.86 KB, patch |  | [Details](/attachment.cgi?id=504878&action=edit) | [Diff](/attachment.cgi?id=504878&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=504878) |
| [Potential 191 patch](/attachment.cgi?id=504884)  [14 years ago](#c10)  [Jeff Walden [:Waldo]](/user_profile?user_id=83595)   1.86 KB, patch |  | [Details](/attachment.cgi?id=504884&action=edit) | [Diff](/attachment.cgi?id=504884&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=504884) |
| [191 patch](/attachment.cgi?id=504896)  [14 years ago](#c11)  [Jeff Walden [:Waldo]](/user_profile?user_id=83595)   1.86 KB, patch |  | [Details](/attachment.cgi?id=504896&action=edit) | [Diff](/attachment.cgi?id=504896&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=504896) |
| [192 patch](/attachment.cgi?id=504897)  [14 years ago](#c12)  [Jeff Walden [:Waldo]](/user_profile?user_id=83595)   1.88 KB, patch |  | [Details](/attachment.cgi?id=504897&action=edit) | [Diff](/attachment.cgi?id=504897&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=504897) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=558541#c0)• 15 years ago |
|  | |

Shell testcase, crashes with gnarly low-level assertion:
options("strict");
for (var i = 0; i < 5; i++)
Boolean.prototype = 42;
Unlike [bug 558249](/show_bug.cgi?id=558249 "RESOLVED FIXED - TM: Crash [@ js_DeflateString]") (fallout from [bug 550402](/show_bug.cgi?id=550402 "RESOLVED FIXED - Property readonly bit interferes with setter functions in properties")), this goes back a ways -- I can reproduce the problem with a 3.6 tree. Strangely, I have trouble causing a failure inside the browser with javascript.options.strict set to true; not sure what's up there, but the shell behavior is more than enough to make me worry about the browser as well.
I noticed this while working on the fix for [bug 558249](/show_bug.cgi?id=558249 "RESOLVED FIXED - TM: Crash [@ js_DeflateString]"), but since it's applicable a ways back it seems better to separate it out into this bug -- let that one take care of the shorter-term regression.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=558541#c1)• 15 years ago |
|  | |

autoBisect shows this is probably related to [bug 490666](/show_bug.cgi?id=490666 "RESOLVED FIXED - We don't cache access to shared properties in the property cache"):
The first bad revision is:
changeset: 27505:3519ddacbe2e
user: Andreas Gal
date: Thu Apr 30 15:52:13 2009 -0700
summary: We don't cache access to shared properties in the property cache (490666, r=igor,brendan).
I had to follow this method: (cat | js -j -i or by direct typing/copy+paste) to get the testcase to crash as per [bug 558249 comment 3](/show_bug.cgi?id=558249#c3 "RESOLVED FIXED - TM: Crash [@ js_DeflateString]"). This might be a reason why jsfunfuzz didn't find it beforehand, though I might be wrong.Blocks: [490666](/show_bug.cgi?id=490666 "RESOLVED FIXED - We don't cache access to shared properties in the property cache")

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=558541#c2)• 15 years ago |
|  | |

This used to assert at:
Assertion failure: s0->isQuad(), at ../jstracer.cpp
but now seems to assert at:
Assertion failure: v\_ins->isF64(), at ../jstracer.cpp:9347Keywords: [assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)Summary: js\_SetPropertyHelper doesn't notify tracer when setting a non-writable property with strict option on → js\_SetPropertyHelper doesn't notify tracer when setting a non-writable property with strict option on or "Assertion failure: s0->isQuad(), at ../jstracer.cpp" or "Assertion failure: v\_ins->isF64(), at ../jstracer.cpp"

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=558541#c3)• 15 years ago |
|  | |

can we get an ETA?

|  | [Brendan Eich [:brendan]](/user_profile?user_id=1214) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=558541#c4)• 15 years ago |
|  | |

I saw the patch fly by recently... [bug 558249](/show_bug.cgi?id=558249 "RESOLVED FIXED - TM: Crash [@ js_DeflateString]") has it. Is this a dup?
/be

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=558541#c5)• 15 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=438835&action=diff)
— [Details](attachment.cgi?id=438835&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=438835)

The test has the same problem as the test in the bug Brendan just mentioned (this isn't a dup, btw).
It's basically hopeless to attempt to obfuscate the intent of this patch. Maybe a diversionary bug of some sort might work, conceivably. Not sure what would be a good diversion that doesn't spill the beans completely -- ideas welcome.
[Attachment #438835](/attachment.cgi?id=438835&action=edit "Patch") -
Flags: review?(jorendorff)

|  | [Jason Orendorff [:jorendorff]](/user_profile?user_id=281791) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558541#a544301_281791)• 15 years ago |

[Attachment #438835](/attachment.cgi?id=438835&action=edit "Patch") -
Flags: review?(jorendorff) → review+

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=558541#c6)• 15 years ago |
|  | |

Patch landed, backed out for much orange -- to be investigated.

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558541#a1038597_180188)• 15 years ago |

blocking2.0: --- → beta1+

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=558541#c7)• 15 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/b15881062862>Status: ASSIGNED → RESOLVEDClosed: 15 years agoResolution: --- → FIXED

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=558541#c8)• 15 years ago |
|  | |

This made its way into TM successfully, then got ported to m-c in the changeset in [comment 7](/show_bug.cgi?id=558541#c7 "RESOLVED FIXED - js_SetPropertyHelper doesn't notify tracer when setting a non-writable property with strict option on or \"Assertion failure: s0->isQuad(), at ../jstracer.cpp\" or \"Assertion failure: v_ins->isF64(), at ../jstracer.cpp\"").
Still needs backporting to 192 and 191... :-\
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558541#a23548377_1689)• 14 years ago |

blocking1.9.1: --- → ?blocking1.9.2: --- → ?
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_191&o1=equals&v1=%3F) → [wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_192&o1=equals&v1=%3F) → [wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558541#a23781690_1689)• 14 years ago |

blocking1.9.1: ? → .17+blocking1.9.2: ? → .14+

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=558541#c9)• 14 years ago |
|  | |

Attached patch

[Potential 192 patch](attachment.cgi?id=504878&action=diff)
— [Details](attachment.cgi?id=504878&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=504878)

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=558541#c10)• 14 years ago |
|  | |

Attached patch

[Potential 191 patch](attachment.cgi?id=504884&action=diff) (obsolete)
— [Details](attachment.cgi?id=504884&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=504884)

So, I tweaked the patch to apply to branches -- they're what I just uploaded. Porting was fairly easy, I think, although the code through there had changed somewhat (but not too much, if my transformation was correct -- see below).
I tried to rerun the original testcase and verify failure before, pass after. Neither patch fails before and passes after. I don't know how to explain this. And, because I've been awake since 5:20 EST and it's now 15:55 PST (18:55 EST) due to a BOS->SFO flight today (and I didn't get a full night's sleep last night), I am not at my most lucid right now, nor do I believe I could really do this full justice if I were to investigate. And being confident enough to push? It just ain't gonna happen today, at least not for me personally. But the freeze is today, so something needs to be done. I'll see if I can hunt anyone down who can help me out here.

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=558541#c11)• 14 years ago |
|  | |

Attached patch

[191 patch](attachment.cgi?id=504896&action=diff)
— [Details](attachment.cgi?id=504896&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=504896)

Okay, I had dmandelin look at this, and on \*his\* system the test was spewing the wrong number of warnings pre-patch and the right number post, so on that basis he thinks it's good. So I think this is good to go.
[Attachment #504884](/attachment.cgi?id=504884&action=edit "Potential 191 patch") -
Attachment is obsolete: true

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=558541#c12)• 14 years ago |
|  | |

Attached patch

[192 patch](attachment.cgi?id=504897&action=diff)
— [Details](attachment.cgi?id=504897&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=558541&attachment=504897)

...and the 192 patch.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=558541#c13)• 14 years ago |
|  | |

Pushed:
<http://hg.mozilla.org/releases/mozilla-1.9.1/rev/afa46961ec10>
<http://hg.mozilla.org/releases/mozilla-1.9.2/rev/222a08821603>
[status1.9.1](/buglist.cgi?f1=cf_status_191&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_191&o1=equals&v1=wanted) → [.17-fixed](/buglist.cgi?f1=cf_status_191&o1=equals&v1=.17-fixed)
[status1.9.2](/buglist.cgi?f1=cf_status_192&o1=isnotempty):
[wanted](/buglist.cgi?f1=cf_status_192&o1=equals&v1=wanted) → [.14-fixed](/buglist.cgi?f1=cf_status_192&o1=equals&v1=.14-fixed)

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=558541#c14)• 14 years ago |
|  | |

Tests landed in TM, since this is fixed in branches now:
<http://hg.mozilla.org/tracemonkey/rev/2d196b5a4224>Flags: in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=558541#a30550426_1689)• 14 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=558541&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jeff Walden [:Waldo]](/user_profile?user_id=83595)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


