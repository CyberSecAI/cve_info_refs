=== Content from lists.balabit.com_15457148_20250124_221746.html ===

# [syslog-ng-announce] syslog-ng Premium Edition 3.0.6a has been released

**devel at balabit.hu**
devel at balabit.hu

*Mon Jan 10 16:42:13 CET 2011*

* Next message: [[syslog-ng-announce] syslog-ng Premium Edition 3.2.1a has been released](000102.html)
* **Messages sorted by:**
  [[ date ]](date.html#101)
  [[ thread ]](thread.html#101)
  [[ subject ]](subject.html#101)
  [[ author ]](author.html#101)

---

```
------------------------------------------------------------------------------
PACKAGE             : syslog-ng Premium Edition
VERSION             : 3.0.6a
SUMMARY             : new stable release
DATE                : Jan 7, 2011
------------------------------------------------------------------------------

DESCRIPTION:

  A new stable version of syslog-ng Premium Edition (3.0.6a) has been
  released. For latest fixes in the 3.0.x branch you are recommended to
  upgrade to this version.

CHANGES:

3.0.6a

	Security updates:
	CVE-2009-0590, CVE-2009-2409, CVE-2009-3245,
	CVE-2010-0433, CVE-2010-0740, CVE-2010-0742,
	CVE-2010-3864, CVE-2011-0343

DOWNLOAD:

  Download the latest binaries from:

  <http://www.balabit.com/network-security/syslog-ng/central-syslog-server/upgrades/>

  Note that to download the binaries, you have to login into your MyBalaBit
  account.

  The documentation of the syslog-ng application is available in
  The syslog-ng 3.0 Administrator Guide at:
  <http://www.balabit.com/support/documentation/?product=syslog-ng&type=all&language[en]=en&>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 199 bytes
Desc: not available
Url : <http://lists.balabit.hu/pipermail/syslog-ng-announce/attachments/20110110/50dee64f/attachment.pgp>

```

---

* Next message: [[syslog-ng-announce] syslog-ng Premium Edition 3.2.1a has been released](000102.html)
* **Messages sorted by:**
  [[ date ]](date.html#101)
  [[ thread ]](thread.html#101)
  [[ subject ]](subject.html#101)
  [[ author ]](author.html#101)

---

[More information about the syslog-ng-announce
mailing list](https://lists.balabit.hu/mailman/listinfo/syslog-ng-announce)



=== Content from bugs.debian.org_8791c941_20250124_221746.html ===

# Debian Bug report logs - #608491 syslog-ng: log file permissions dangerous on kfreebsd-i386

[![version graph](version.cgi?collapse=1;package=syslog-ng;found=syslog-ng%2F3.1.3-1;height=2;width=2;fixed=syslog-ng%2F3.1.3-2;absolute=0)](version.cgi?info=1;fixed=syslog-ng%2F3.1.3-2;absolute=0;collapse=1;found=syslog-ng%2F3.1.3-1;package=syslog-ng)

Package:
[syslog-ng](pkgreport.cgi?package=syslog-ng);
Maintainer for [syslog-ng](pkgreport.cgi?package=syslog-ng) is [syslog-ng maintainers <syslog-ng-maintainers@alioth-lists.debian.net>](pkgreport.cgi?maint=syslog-ng-maintainers%40alioth-lists.debian.net); Source for [syslog-ng](pkgreport.cgi?package=syslog-ng) is [src:syslog-ng](pkgreport.cgi?src=syslog-ng) ([PTS](https://tracker.debian.org/pkg/syslog-ng), [buildd](https://buildd.debian.org/syslog-ng), [popcon](https://qa.debian.org/popcon.php?package=syslog-ng)).

Reported by: [Steven Chamberlain <steven@pyro.eu.org>](pkgreport.cgi?submitter=steven%40pyro.eu.org)

Date: Fri, 31 Dec 2010 12:33:02 UTC

Severity: *grave*

Tags: confirmed, patch, security

Found in version syslog-ng/3.1.3-1

Fixed in version syslog-ng/3.1.3-2

**Done:** Laszlo Boszormenyi (GCS) <gcs@debian.hu>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=608491;mbox=yes), [status mbox](bugreport.cgi?bug=608491;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=608491;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Fri, 31 Dec 2010 12:33:05 GMT) ([full text](bugreport.cgi?bug=608491;msg=2), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Steven Chamberlain <steven@pyro.eu.org>`:

New Bug report received and forwarded. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Fri, 31 Dec 2010 12:33:05 GMT) ([full text](bugreport.cgi?bug=608491;msg=4), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=5), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=steven%40pyro.eu.org)
From: Steven Chamberlain <steven@pyro.eu.org>
To: submit@bugs.debian.org
Subject: syslog-ng: log file permissions dangerous on kfreebsd-i386
Date: Fri, 31 Dec 2010 12:29:16 +0000
```
Package: syslog-ng
Version: 3.1.3-1
Severity: grave
Tags: security

Hello,

On kfreebsd-i386, installing the syslog-ng package with its default
configuration files, sets the permissions of system log files including
/var/log/messages, daemon.log, auth.log and perhaps others to
-rwsrwsrwt.  This happens whether the files previously existed or not.

This makes these log files world-readable, despite the perm(0640)
setting in syslog-ng.conf.  Non-privileged users can also truncate or
append to these files, but doing so seems to remove the setuid/setgid bits.

There may be a potential for root privilege escalation if a user can
cause syslog-ng to write executable commands to one of these log files.
 The files are not normally executable (text file busy) whilst syslog-ng
has them open for writing, but upon the next run of logrotate, the file
permissions including setuid/setgid bits are preserved.

-- typescript
root@kfreebsd-i386:/var/log# ls -al
total 4
drwxr-xr-x  2 root root 1024 Dec 31 12:00 .
drwxr-xr-x 13 root root  512 Dec 26 21:08 ..
root@kfreebsd-i386:/var/log# apt-get --yes install syslog-ng
Reading package lists... Done
Building dependency tree
Reading state information... Done
Suggested packages:
  libdbd-mysql libdbd-pgsql libdbd-sqlite3
The following NEW packages will be installed:
  syslog-ng
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 0 B/315 kB of archives.
After this operation, 629 kB of additional disk space will be used.
Selecting previously deselected package syslog-ng.
(Reading database ... 21539 files and directories currently installed.)
Unpacking syslog-ng (from .../syslog-ng_3.1.3-1_kfreebsd-i386.deb) ...
Processing triggers for man-db ...
Setting up syslog-ng (3.1.3-1) ...
Starting system logging: syslog-ng.
localepurge: Disk space freed in /usr/share/locale: 0 KiB
localepurge: Disk space freed in /usr/share/man: 0 KiB

Total disk space freed by localepurge: 0 KiB

root@kfreebsd-i386:/var/log# ls -al
total 12
drwxr-xr-x  3 root root  512 Dec 31 12:00 .
drwxr-xr-x 13 root root  512 Dec 26 21:08 ..
drwxr-xr-x  2 root root  512 Dec 31 12:00 apt
-rw-r--r--  1 root root 1197 Dec 31 12:00 dpkg.log
-rwsrwsrwt  1 root adm   206 Dec 31 12:00 messages
-rwsrwsrwt  1 root adm   206 Dec 31 12:00 syslog

-- System Information:
Debian Release: squeeze/sid
  APT prefers testing
  APT policy: (500, 'testing')
Architecture: kfreebsd-i386 (i686)

Kernel: kFreeBSD 8.1-1-686
Locale: LANG=en_GB.UTF-8, LC_CTYPE=en_GB.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

Versions of packages syslog-ng depends on:
ii  libc0.1                 2.11.2-7         Embedded GNU C Library:
Shared lib
ii  libdbi0                 0.8.2-3          Database Independent
Abstraction L
ii  libevtlog0              0.2.8~1-2        Syslog event logger library
ii  libglib2.0-0            2.24.2-1         The GLib library of C routines
ii  libnet1                 1.1.4-2          library for the
construction and h
ii  libpcre3                8.02-1.1         Perl 5 Compatible Regular
Expressi
ii  libssl0.9.8             0.9.8o-4         SSL shared libraries
ii  libwrap0                7.6.q-19         Wietse Venema's TCP
wrappers libra
ii  lsb-base                3.2-23.1         Linux Standard Base 3.2
init scrip
ii  zlib1g                  1:1.2.3.4.dfsg-3 compression library - runtime

Versions of packages syslog-ng recommends:
ii  logrotate                     3.7.8-6    Log rotation utility

Versions of packages syslog-ng suggests:
pn  libdbd-mysql                  <none>     (no description available)
pn  libdbd-pgsql                  <none>     (no description available)
pn  libdbd-sqlite3                <none>     (no description available)

-- no debconf information

Thanks,
Regards,
--
Steven Chamberlain
steven@pyro.eu.org

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Fri, 31 Dec 2010 13:51:10 GMT) ([full text](bugreport.cgi?bug=608491;msg=7), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Laszlo Boszormenyi <gcs@debian.hu>`:

Extra info received and forwarded to list. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Fri, 31 Dec 2010 13:51:10 GMT) ([full text](bugreport.cgi?bug=608491;msg=9), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 608491@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=10), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=gcs%40debian.hu)
From: Laszlo Boszormenyi <gcs@debian.hu>
To: Steven Chamberlain <steven@pyro.eu.org>, 608491@bugs.debian.org,
control@bugs.debian.org
Cc: Peter Czanik <peter.czanik@balabit.com>, Clint Byrum <clint@ubuntu.com>
Subject: Re: Bug#608491: syslog-ng: log file permissions dangerous on
kfreebsd-i386
Date: Fri, 31 Dec 2010 14:46:13 +0100
```
package syslog-ng
tags 608491 + confirmed
thanks

On Fri, 2010-12-31 at 12:29 +0000, Steven Chamberlain wrote:
> Package: syslog-ng
> Version: 3.1.3-1
> Severity: grave
> Tags: security

> On kfreebsd-i386, installing the syslog-ng package with its default
> configuration files, sets the permissions of system log files including
> /var/log/messages, daemon.log, auth.log and perhaps others to
> -rwsrwsrwt.  This happens whether the files previously existed or not.
 I can confirm this, not sure yet what's cause this. Upstream already
informed and hope it'll be fixed soon.
But an important note, for me it's slightly different. "Only" messages
and syslog are changed to chmod 7777; auth.log and daemon.log are not.

Regards,
Laszlo/GCS

```

---

**Added tag(s) confirmed.**
Request was from `Laszlo Boszormenyi <gcs@debian.hu>`
to `control@bugs.debian.org`.
(Fri, 31 Dec 2010 13:51:12 GMT) ([full text](bugreport.cgi?bug=608491;msg=12), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Fri, 31 Dec 2010 15:33:03 GMT) ([full text](bugreport.cgi?bug=608491;msg=14), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent**
to `Laszlo Boszormenyi <gcs@debian.hu>`:

Extra info received and forwarded to list. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Fri, 31 Dec 2010 15:33:03 GMT) ([full text](bugreport.cgi?bug=608491;msg=16), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 608491@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=17), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=gcs%40debian.hu)
From: Laszlo Boszormenyi <gcs@debian.hu>
To: Steven Chamberlain <steven@pyro.eu.org>, 608491@bugs.debian.org
Cc: Peter Czanik <peter.czanik@balabit.com>, Clint Byrum <clint@ubuntu.com>
Subject: Re: Bug#608491: syslog-ng: log file permissions dangerous on
kfreebsd-i386
Date: Fri, 31 Dec 2010 16:28:23 +0100
```
On Fri, 2010-12-31 at 12:29 +0000, Steven Chamberlain wrote:
> On kfreebsd-i386, installing the syslog-ng package with its default
> configuration files, sets the permissions of system log files including
> /var/log/messages, daemon.log, auth.log and perhaps others to
> -rwsrwsrwt.  This happens whether the files previously existed or not.
 While I don't know syslog-ng internals, I made some debug. It seems
syslog-ng uses chmod and derivatives only on three locations. During
install, only one of it is fired. It's src/afunix.c in afunix_sd_init():
it chmods /var/run/log to 0666.
Even ktrace didn't help me. The only chmod that can be suspicious in its
output:
chmod(0x679aa0,<invalid>438)
But it may refer to the error message printed on the screen:
mknod `/dev/console': Operation not supported

Laszlo/GCS

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Fri, 31 Dec 2010 15:57:05 GMT) ([full text](bugreport.cgi?bug=608491;msg=19), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=19), [link](#18)).

---

**Acknowledgement sent**
to `Steven Chamberlain <steven@pyro.eu.org>`:

Extra info received and forwarded to list. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Fri, 31 Dec 2010 15:57:05 GMT) ([full text](bugreport.cgi?bug=608491;msg=21), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 608491@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=22), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=steven%40pyro.eu.org)
From: Steven Chamberlain <steven@pyro.eu.org>
To: Laszlo Boszormenyi <gcs@debian.hu>
Cc: 608491@bugs.debian.org, control@bugs.debian.org,
Peter Czanik <peter.czanik@balabit.com>,
Clint Byrum <clint@ubuntu.com>
Subject: Re: Bug#608491: syslog-ng: log file permissions dangerous on kfreebsd-i386
Date: Fri, 31 Dec 2010 15:55:53 +0000
```
On 31/12/10 13:46, Laszlo Boszormenyi wrote:
> But an important note, for me it's slightly different. "Only" messages
> and syslog are changed to chmod 7777; auth.log and daemon.log are not.

Hi Laszlo,

I think syslog-ng must wait for some data to be logged before it opens
those files for writing, and that must be when permissions are changed.
 If anything new has been written to your auth.log or daemon.log since
you checked, I think the permissions will have changed now.

Maybe that helps to narrow down where in the code this is happening?

Regards,
--
Steven Chamberlain
steven@pyro.eu.org

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Fri, 31 Dec 2010 16:48:05 GMT) ([full text](bugreport.cgi?bug=608491;msg=24), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent**
to `Steven Chamberlain <steven@pyro.eu.org>`:

Extra info received and forwarded to list. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Fri, 31 Dec 2010 16:48:05 GMT) ([full text](bugreport.cgi?bug=608491;msg=26), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 608491@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=27), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=steven%40pyro.eu.org)
From: Steven Chamberlain <steven@pyro.eu.org>
To: Laszlo Boszormenyi <gcs@debian.hu>
Cc: 608491@bugs.debian.org, Peter Czanik <peter.czanik@balabit.com>,
Clint Byrum <clint@ubuntu.com>
Subject: Re: Bug#608491: syslog-ng: log file permissions dangerous on kfreebsd-i386
Date: Fri, 31 Dec 2010 16:45:21 +0000
```
Hi again,

I think I've managed to find the responsible system call using ktrace.
To begin with I set all of my log files as chmod 640, and then:

# ktrace -f ktrace.log -d /usr/sbin/syslog-ng -- -F -p
/var/run/syslog-ng.pid

Ctrl-C or kill that after about a second or so, then:

# kdump -f ktrace.log -m 4096 -n

This happens for each log file when first written to -- it is opened for
writing (requesting mode 0xffff if the file doesn't exist), then
chown'd/chgrp'd, and fchmod is called to ensure mode 0xffff:

  1384 syslog-ng CALL  open(0x80b1ae8,0x8205,0xffff)
  1384 syslog-ng NAMI  "/var/log/syslog"
  1384 syslog-ng RET   open 0x7
  1384 syslog-ng CALL  fcntl(0x7,0x1,0)
  1384 syslog-ng RET   fcntl 0
  1384 syslog-ng CALL  fcntl(0x7,0x2,0x1)
  1384 syslog-ng RET   fcntl 0
  1384 syslog-ng CALL  fchown(0x7,0,0xffffffff)
  1384 syslog-ng RET   fchown 0
  1384 syslog-ng CALL  fchown(0x7,0xffffffff,0x4)
  1384 syslog-ng RET   fchown 0
  1384 syslog-ng CALL  fchmod(0x7,0xffff)
  1384 syslog-ng RET   fchmod 0

Wherever affile_open_file is called, it seems the mode parameter is
initialised to -1 unless changed somewhere else in the code.  Then it's
tested in affile_open_file to see if it's >= 0.  Could the size or
signedness of mode_t be different on FreeBSD to Linux, resulting in the
0xffff?

Regards,
--
Steven Chamberlain
steven@pyro.eu.org

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Fri, 31 Dec 2010 17:27:08 GMT) ([full text](bugreport.cgi?bug=608491;msg=29), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=29), [link](#28)).

---

**Acknowledgement sent**
to `Gergely Nagy <algernon@balabit.hu>`:

Extra info received and forwarded to list. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Fri, 31 Dec 2010 17:27:08 GMT) ([full text](bugreport.cgi?bug=608491;msg=31), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 608491@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=32), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=algernon%40balabit.hu)
From: Gergely Nagy <algernon@balabit.hu>
To: 608491@bugs.debian.org
Cc: Laszlo Boszormenyi <gcs@debian.hu>
Subject: Problem & Fix (was: Bug#608491: syslog-ng: log file permissions
dangerous on kfreebsd-i386)
Date: Fri, 31 Dec 2010 18:24:52 +0100
```
The problem is that chwon(fn, -1) works differently on Linux than on
FreeBSD.

Linux doesn't change the permissions if mode is -1, FreeBSD does. The
workaround would be to test for -1 in syslog-ng and not call chmod in
those cases.

For the record, affile_open_file gets the same arguments even on Linux,
yet, permissions are eventually set right there. Thus, the problem is
entirely doe to chmod(fn, -1) behaving differently on the two systems.

A patch should be easy to cook up, one should be incoming soon, just
need to test it.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Fri, 31 Dec 2010 17:30:05 GMT) ([full text](bugreport.cgi?bug=608491;msg=34), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=34), [link](#33)).

---

**Acknowledgement sent**
to `Steven Chamberlain <steven@pyro.eu.org>`:

Extra info received and forwarded to list. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Fri, 31 Dec 2010 17:30:05 GMT) ([full text](bugreport.cgi?bug=608491;msg=36), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=36), [link](#35)).

---

[Message #37](#37) received at 608491@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=37), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=37), reply):

![](/cgi-bin/libravatar.cgi?email=steven%40pyro.eu.org)
From: Steven Chamberlain <steven@pyro.eu.org>
To: Laszlo Boszormenyi <gcs@debian.hu>
Cc: 608491@bugs.debian.org, Peter Czanik <peter.czanik@balabit.com>,
Clint Byrum <clint@ubuntu.com>
Subject: Re: Bug#608491: syslog-ng: log file permissions dangerous on kfreebsd-i386
Date: Fri, 31 Dec 2010 17:26:41 +0000
```
[[Message part 1](bugreport.cgi?att=0;bug=608491;msg=37) (text/plain, inline)]
```
```
Hi,

bits/typesizes.h reveals that mode_t is u16 on kFreeBSD, rather than u32
on Linux.  So the dummy/rogue value of '-1' that file_perm or dir_perm
are initialised to, would be treated as a valid mode 0xffff.

u16 doesn't allow room for a dummy value any more, so I thought the
cleanest fix would be to define a DEFAULT_FILE_PERM and
DEFAULT_DIR_PERM, and initialise to those instead of -1.  Since the
'mode' variable will always contain something valid, it is no longer
necessary to check that when calling to open() and fchmod().

This is demonstrated in my attached patch, which I've only managed to
build on amd64 yet and not kFreeBSD, so it hasn't been properly tested.

Fortunately the uid/gid types are still u32 on kFreeBSD so there is no
issue with those.

Regards,
--
Steven Chamberlain
steven@pyro.eu.org

```
```
[[untested-bugfix-608491.patch](bugreport.cgi?att=1;bug=608491;filename=untested-bugfix-608491.patch;msg=37) (text/x-patch, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Fri, 31 Dec 2010 17:33:02 GMT) ([full text](bugreport.cgi?bug=608491;msg=39), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=39), [link](#38)).

---

**Acknowledgement sent**
to `Gergely Nagy <algernon@balabit.hu>`:

Extra info received and forwarded to list. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Fri, 31 Dec 2010 17:33:02 GMT) ([full text](bugreport.cgi?bug=608491;msg=41), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=41), [link](#40)).

---

[Message #42](#42) received at 608491@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=42), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=42), reply):

![](/cgi-bin/libravatar.cgi?email=algernon%40balabit.hu)
From: Gergely Nagy <algernon@balabit.hu>
To: 608491@bugs.debian.org
Subject: A little more info
Date: Fri, 31 Dec 2010 18:03:28 +0100
```
The problem - at a first guess - will be somewhere in the config file
parsing code or thereabouts. By the time syslog-ng gets to call
fchown(), the file mode is set to a horribly wrong value:

> #1  0x0000000000434d66 in affile_open_file (name=0x68e030 "/var/log/syslog", flags=33285, uid=0, gid=4, mode=65535, dir_uid=0, dir_gid=0, dir_mode=65535, create_dirs=0, privileged=0, is_pipe=0,
>     fd=0x7fffffffddbc) at affile.c:101
> 101             fchmod(*fd, (mode_t) mode);
> Current language:  auto
> The current source language is "auto; currently c".

If one looks at the parameters passed to affile_open_file, one can
notice that both mode and dir_mode are wrong. They're actually
(int16_t)-1.

This is on kfreebsd-amd64, so it looks like it's kfreebsd specific, and
the arch doesn't matter.

I will know more once I dived deeper in. With a bit of luck, I'll have a
fix sometime tomorrow, unless someone beats me to it.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Fri, 31 Dec 2010 18:21:06 GMT) ([full text](bugreport.cgi?bug=608491;msg=44), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=44), [link](#43)).

---

**Acknowledgement sent**
to `Steven Chamberlain <steven@pyro.eu.org>`:

Extra info received and forwarded to list. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Fri, 31 Dec 2010 18:21:06 GMT) ([full text](bugreport.cgi?bug=608491;msg=46), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=46), [link](#45)).

---

[Message #47](#47) received at 608491@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=47), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=47), reply):

![](/cgi-bin/libravatar.cgi?email=steven%40pyro.eu.org)
From: Steven Chamberlain <steven@pyro.eu.org>
To: Laszlo Boszormenyi <gcs@debian.hu>
Cc: 608491@bugs.debian.org, Peter Czanik <peter.czanik@balabit.com>,
Clint Byrum <clint@ubuntu.com>,
control@bugs.debian.org
Subject: Re: Bug#608491: syslog-ng: log file permissions dangerous on kfreebsd-i386
Date: Fri, 31 Dec 2010 18:15:50 +0000
```
tag 608491 + patch
done

Hi again,

I've managed to rebuild syslog-ng on kfreebsd-i386 with my previous
patch applied to properly test it.  syslog-ng now sets file permissions
on log files appropriately to the configuration setting of perm(), or
otherwise 0600 if it wasn't defined.  The patched version is still
working as expected on Linux amd64.

The new mode is used when a log file is created or has new data written
to it;  files that were mistakenly set mode 0xffff will be fixed by
upgrading.  But if any files don't have new data written to them, or
were already moved out of the way by logrotate, those will unavoidably
keep the buggy 0xffff setuid+setgid mode.

If using create_dirs(yes) in syslog-ng.conf (disabled by default in
Debian), the same bug was causing newly-created directories to have mode
0xffff.  My patch fixed this too, now using the configuration setting of
dir_perm(), or otherwise 0700 if it wasn't defined.  Directories that
have already been created by syslog-ng are never chmod'd again, so won't
be automatically fixed by this patch.

Regards,
--
Steven Chamberlain
steven@pyro.eu.org

```

---

**Added tag(s) patch.**
Request was from `Steven Chamberlain <steven@pyro.eu.org>`
to `control@bugs.debian.org`.
(Fri, 31 Dec 2010 18:21:08 GMT) ([full text](bugreport.cgi?bug=608491;msg=49), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=49), [link](#48)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

`Bug#608491`; Package `syslog-ng`.
(Sat, 01 Jan 2011 20:15:08 GMT) ([full text](bugreport.cgi?bug=608491;msg=51), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=51), [link](#50)).

---

**Acknowledgement sent**
to `Gergely Nagy <algernon@balabit.hu>`:

Extra info received and forwarded to list. Copy sent to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`.
(Sat, 01 Jan 2011 20:15:08 GMT) ([full text](bugreport.cgi?bug=608491;msg=53), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=53), [link](#52)).

---

[Message #54](#54) received at 608491@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=54), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=54), reply):

![](/cgi-bin/libravatar.cgi?email=algernon%40balabit.hu)
From: Gergely Nagy <algernon@balabit.hu>
To: 608491@bugs.debian.org
Subject: Fixed in upstream git
Date: Sat, 01 Jan 2011 21:12:21 +0100
```
The issue is fixed in upstream git, differently than how Steven
proposed:

<http://git.balabit.hu/?p=bazsi/syslog-ng-3.1.git;a=commitdiff;h=cbcea8c95c3f07ed9eaa4d12f124db8f8ca2f74b;hp=61181dca938d2cdd8233df2a07d6e0c76f049e6f>

Bazsi's solution is to use gint instead of mode_t, so that syslog-ng can
continue using -1 as a special value. The actual chmod calls will only
be made if the permissions are correct, though.

I tested his patch on both Linux and kFreeBSD, and both behave after the
patch as expected.

--
|8]

```

---

**Reply sent**
to `Laszlo Boszormenyi (GCS) <gcs@debian.hu>`:

You have taken responsibility.
(Sat, 01 Jan 2011 23:33:08 GMT) ([full text](bugreport.cgi?bug=608491;msg=56), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=56), [link](#55)).

---

**Notification sent**
to `Steven Chamberlain <steven@pyro.eu.org>`:

Bug acknowledged by developer.
(Sat, 01 Jan 2011 23:33:08 GMT) ([full text](bugreport.cgi?bug=608491;msg=58), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=58), [link](#57)).

---

[Message #59](#59) received at 608491-close@bugs.debian.org ([full text](bugreport.cgi?bug=608491;msg=59), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=59), reply):

![](/cgi-bin/libravatar.cgi?email=gcs%40debian.hu)
From: Laszlo Boszormenyi (GCS) <gcs@debian.hu>
To: 608491-close@bugs.debian.org
Subject: Bug#608491: fixed in syslog-ng 3.1.3-2
Date: Sat, 01 Jan 2011 23:32:41 +0000
```
Source: syslog-ng
Source-Version: 3.1.3-2

We believe that the bug you reported is fixed in the latest version of
syslog-ng, which is due to be installed in the Debian FTP archive:

syslog-ng_3.1.3-2.debian.tar.gz
  to main/s/syslog-ng/syslog-ng_3.1.3-2.debian.tar.gz
syslog-ng_3.1.3-2.dsc
  to main/s/syslog-ng/syslog-ng_3.1.3-2.dsc
syslog-ng_3.1.3-2_amd64.deb
  to main/s/syslog-ng/syslog-ng_3.1.3-2_amd64.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 608491@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Laszlo Boszormenyi (GCS) <gcs@debian.hu> (supplier of updated syslog-ng package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Sat, 01 Jan 2011 21:46:47 +0100
Source: syslog-ng
Binary: syslog-ng
Architecture: source amd64
Version: 3.1.3-2
Distribution: unstable
Urgency: high
Maintainer: Laszlo Boszormenyi (GCS) <gcs@debian.hu>
Changed-By: Laszlo Boszormenyi (GCS) <gcs@debian.hu>
Description:
 syslog-ng  - Next generation logging daemon
Closes: [608491](bugreport.cgi?bug=608491)
Changes:
 syslog-ng (3.1.3-2) unstable; urgency=high
 .
   * Security fix on kFreeBSD archs, don't set 7777 rigths on logfiles
     (closes: #[608491](bugreport.cgi?bug=608491)).
Checksums-Sha1:
 06141cd34801b88449a09b4441fbb899aef2c83c 1274 syslog-ng_3.1.3-2.dsc
 a01c2df06eb399f37701c85c316b1581d8fc821e 19147 syslog-ng_3.1.3-2.debian.tar.gz
 459a4a4b6ea4ed791633ff48f67919f7b45f925f 344162 syslog-ng_3.1.3-2_amd64.deb
Checksums-Sha256:
 404e5cb468deceb024c3a503aae227e6c6827659cc5f8ec9597606453594f75b 1274 syslog-ng_3.1.3-2.dsc
 e3bb42de70c83a615cfad3dd5ae1e315a04f7542576976f7635f242d9d352ad9 19147 syslog-ng_3.1.3-2.debian.tar.gz
 3199717c96afa501b042e5af0a7107f121fdce604945c7ae5906a18e34bc6a30 344162 syslog-ng_3.1.3-2_amd64.deb
Files:
 f299b891cd0fdecc8f0e35a9e1dc27d3 1274 admin extra syslog-ng_3.1.3-2.dsc
 a387a949e180c6289bda0bdcf31eac28 19147 admin extra syslog-ng_3.1.3-2.debian.tar.gz
 f6470c4b99275acf4e6e74c9ee94a768 344162 admin extra syslog-ng_3.1.3-2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAk0ftTYACgkQMDatjqUaT90BjwCghTgjrcRk9e0QpLxc/ugHzg31
hkgAoKhlm20VaPd70XGCx/NWdwdPWMk+
=w0Q/
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 06 Feb 2011 07:36:47 GMT) ([full text](bugreport.cgi?bug=608491;msg=61), [mbox](bugreport.cgi?bug=608491;mbox=yes;msg=61), [link](#60)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=608491).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 22:17:46 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from lists.balabit.com_ce53179f_20250124_221746.html ===

# [syslog-ng-announce] syslog-ng Premium Edition 3.2.1a has been released

**devel at balabit.hu**
devel at balabit.hu

*Mon Jan 10 16:42:14 CET 2011*

* Previous message: [[syslog-ng-announce] syslog-ng Premium Edition 3.0.6a has been released](000101.html)
* Next message: [[syslog-ng-announce] syslog-ng 3.1.4 has been released](000104.html)
* **Messages sorted by:**
  [[ date ]](date.html#102)
  [[ thread ]](thread.html#102)
  [[ subject ]](subject.html#102)
  [[ author ]](author.html#102)

---

```
------------------------------------------------------------------------------
PACKAGE             : syslog-ng Premium Edition
VERSION             : 3.2.1a
SUMMARY             : new feature release
DATE                : Jan 7, 2011
------------------------------------------------------------------------------

DESCRIPTION:

  A new feature version of syslog-ng Premium Edition (3.2.1a) has been
  released. For a full description on stable and feature releases,
  see Section 2.16. Stable and feature releases of syslog-ng PE in The syslog-ng
  Premium Edition 3.2.1a Administrator Guide.

CHANGES:

3.2.1a

	Security updates:
	CVE-2009-0590, CVE-2009-2409, CVE-2009-3245,
	CVE-2010-0433, CVE-2010-0740, CVE-2010-0742,
	CVE-2010-3864, CVE-2011-0343

DOWNLOAD:

  Download the latest binaries from:

  <http://www.balabit.com/network-security/syslog-ng/central-syslog-server/upgrades/>

  Note that to download the binaries, you have to login into your MyBalaBit
  account.

  The documentation of the syslog-ng application is available in
  The syslog-ng Premium Edition 3.2.1a Administrator Guide at:
  <http://www.balabit.com/support/documentation/>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 199 bytes
Desc: not available
Url : <http://lists.balabit.hu/pipermail/syslog-ng-announce/attachments/20110110/84418571/attachment.pgp>

```

---

* Previous message: [[syslog-ng-announce] syslog-ng Premium Edition 3.0.6a has been released](000101.html)
* Next message: [[syslog-ng-announce] syslog-ng 3.1.4 has been released](000104.html)
* **Messages sorted by:**
  [[ date ]](date.html#102)
  [[ thread ]](thread.html#102)
  [[ subject ]](subject.html#102)
  [[ author ]](author.html#102)

---

[More information about the syslog-ng-announce
mailing list](https://lists.balabit.hu/mailman/listinfo/syslog-ng-announce)


