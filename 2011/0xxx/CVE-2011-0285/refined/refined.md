```
{
  "cveId": "CVE-2011-0285",
  "related": true,
  "content": "The provided content from web.mit.edu directly addresses CVE-2011-0285.\n\n- **Root cause of vulnerability**: The password-changing capability in the MIT krb5 administration daemon (kadmind) has a bug where, under certain error conditions, it attempts to `free()` an invalid pointer. This occurs because the dispatch() function allocates an uninitialized `krb5_data` structure for the response packet, expecting `process_chpw_request()` to fill it in. However, specific error paths in `process_chpw_request()` can return without initializing the data pointer in this structure, leading to the attempt to free an invalid pointer in `process_tcp_connection()` via `kill_tcp_or_rpc_connection()`.\n\n- **Weaknesses/vulnerabilities present**: The vulnerability lies in improper handling of error conditions in `process_chpw_request()`, specifically concerning the initialization of the response packet's data pointer. This leads to an invalid memory free operation.\n\n- **Impact of exploitation**: An unauthenticated remote attacker can cause kadmind to terminate (denial of service). There is also a theoretical risk of remote code execution, although this is considered difficult due to platform-specific memory protection mechanisms that can prevent arbitrary code execution.\n\n- **Attack vectors**: A remote attacker can send a malformed password change request via TCP to the kadmind daemon, triggering the error condition leading to the invalid `free()`. UDP requests are not vulnerable.\n\n- **Required attacker capabilities/position**: The attacker needs network access to the kadmind service and the ability to send a specially crafted password change request.\n\nThe provided content from bugs.debian.org confirms this vulnerability and shows its impact as a denial-of-service. The bug report indicates that a simple `nmap -sV` scan against the kerberos server is enough to crash the `kadmind` daemon due to malformed data being sent.\n\nThe provided patch shows how a length check was added before further processing of data and if the length check failed, a return was initiated before accessing the response packet to `free()` memory."
}
```