=== Content from forum.elxis.org_7afb2b0b_20250125_212039.html ===

[![elxis forum](https://forum.elxis.org/Themes/inverted/images/id/elxis_forum_logo.png)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc& "Elxis forum")

Welcome, **Guest**.
 Please [login](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=login) or [register](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=register).

Did you miss your [activation email](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=activate)?
**News:** Convert **Wordpress to Elxis** with [Elxis importer](https://www.elxis.net/edc/content/146.html)!

* [Home](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&)
* [Help](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=help)
* [Login](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=login)
* [Register](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=register)

* [Elxis CMS Forum](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&) »
* [General](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&#c1) »
* [News and announcements](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&board=1.0) »
* [Bug reports and fixes](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.0)

[« previous](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.0;prev_next=prev#new) [next »](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.0;prev_next=next#new)

* [Print](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=printpage;topic=5144.0)

Pages: [**1**]

### Author Topic: Bug reports and fixes  (Read 98637 times)

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/exclamation.gif)
##### [Bug reports and fixes](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg34825#msg34825)

«  **on:** September 01, 2010, 19:06:20 »

**Bug report:** August 29, 2010 by **psiloscc**  on [this post](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5124.msg34797#msg34797).

**Affects:** For sure Elxis 2009.2, and maybe 2009.1 and prior versions.

**Description of the bug:** The "save" button does not get pressed in order to the set the access level of a content item.

**Why this happens:** The drop down select box has 2 ID attributes, the first one is wrong and should be deleted.

**Solution:** Open file *includes/Core/elxis.php*
Go to line 1364 (Elxis 2009.2)
Change this:
        if (!preg\_match('/id\=/i', $x)) {
To this:
        if (!preg\_match('/id\=/i', $tag\_attribs)) {
Save the file, done!

*Note: this fix has been applied on Elxis 2009.3*

« *Last Edit: September 20, 2010, 19:03:22 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/xx.gif)
##### [Re: Bug reports and fixes](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg34827#msg34827)

« **Reply #1 on:** September 01, 2010, 19:24:32 »

**Bug report:** August 29, 2010 by **psiloscc**  on [this post](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5124.msg34703#msg34703).

**Affects:** For sure Elxis 2009.2, 2009.1, 2009.0 and maybe 2008.x versions too.

**Description of the bug:** The navigation does not work properly on the view banner clients page in Elxis administration.

**Why this happens:** The value for the form's "task" parameter is empty.

**Solution:** Open file *administrator/components/com\_banners/admin.banners.html.php*
Go to line 357 (Elxis 2009.2)
Change this:
<input type="hidden" name="task" value="" />
To this:
<input type="hidden" name="task" value="listclients" />
Save the file, done!

*Note: this fix has been applied on Elxis 2009.3*

« *Last Edit: September 20, 2010, 19:03:11 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/xx.gif)
##### [HTB22613 - SQL injection vulnerability in Elxis 2009.2](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg35079#msg35079)

« **Reply #2 on:** September 20, 2010, 18:53:46 »

**Vulnerability report**: September 20, 2010 by **High-Tech Bridge** on [this page](http://www.htbridge.ch/advisory/sql_injection_vulnerability_in_elxis_cms.html).

**Affects:** Elxis 2009.2 electra rev2631 and probably prior versions

**Description of the vulnerability:** SQL injection vulnerability in Elxis CMS

**Why this happens:** sanitize user-supplied input in "id" variable

**Solution:**
Note: In order for the SQL injection to be successful the attacker must first gain access to the administration console. So an SQL injection like that from an non logged-in user could never be successful. Besides this here is how to fix this issue. This fix has already been applied to the upcoming version 2009.3.

file: *administrator/components/com\_content/admin.content.php*
Change lines 25 and 26 from this:
$sectionid =mosGetParam( $\_REQUEST, 'sectionid', 0 );
$id = mosGetParam($\_REQUEST, 'id', '');
To this:
$sectionid = (int)mosGetParam( $\_REQUEST, 'sectionid', 0 );
$id = (int)mosGetParam($\_REQUEST, 'id', 0);

« *Last Edit: September 20, 2010, 19:17:12 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/exclamation.gif)
##### [HTB22614 - XSS vulnerability in Elxis 2009.2](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg35080#msg35080)

« **Reply #3 on:** September 20, 2010, 19:47:04 »

**Vulnerability report**: September 20, 2010 by **High-Tech Bridge** on [this page](http://www.htbridge.ch/advisory/xss_vulnerability_in_elxis_cms.html).

**Affects:** Elxis 2009.2 electra rev2631 and probably prior versions

**Description of the vulnerability:** XSS vulnerability in Elxis 2009.2

**Why this happens:** sanitize user-supplied input in "search" variable

**Solution:**
Note: In order for the XSS attack to be successful the site administrator must visit an external phishing web page while he is logged in in Elxis administration.
Advisory: never visit external pages and especially those that might contain harmful code (javascript) while you are logged-in in sensitive pages.

file: *administrator/components/com\_users/admin.users.php*
Change lines 111 to 118 from this:
$filter\_type   = $mainframe->getUserStateFromRequest("filter\_type{$option}", 'filter\_type', 0 );
$filter\_logged   = $mainframe->getUserStateFromRequest("filter\_logged{$option}", 'filter\_logged', 0 );
$filter\_enabled   = intval($mainframe->getUserStateFromRequest("filter\_enabled{$option}", 'filter\_enabled', -1));
$filter\_expired   = intval($mainframe->getUserStateFromRequest("filter\_expired{$option}", 'filter\_expired', -1));
$limit       = $mainframe->getUserStateFromRequest("viewlistlimit", 'limit', $mainframe->getCfg('list\_limit'));
$limitstart    = $mainframe->getUserStateFromRequest("view{$option}limitstart", 'limitstart', 0 );
$search       = $mainframe->getUserStateFromRequest("search{$option}", 'search', '' );
$search       = $database->getEscaped( eUTF::utf8\_trim( eUTF::utf8\_strtolower( $search ) ) );
To this:
$filter\_type   =  $mainframe->makesafe(strip\_tags($mainframe->getUserStateFromRequest("filter\_type{$option}", 'filter\_type', 0)));
$filter\_logged   = intval($mainframe->getUserStateFromRequest("filter\_logged{$option}", 'filter\_logged', 0));
$filter\_enabled   = intval($mainframe->getUserStateFromRequest("filter\_enabled{$option}", 'filter\_enabled', -1));
$filter\_expired   = intval($mainframe->getUserStateFromRequest("filter\_expired{$option}", 'filter\_expired', -1));
$limit          = intval($mainframe->getUserStateFromRequest("viewlistlimit", 'limit', $mainframe->getCfg('list\_limit')));
$limitstart    = intval($mainframe->getUserStateFromRequest("view{$option}limitstart", 'limitstart', 0));
$search       = $mainframe->makesafe(strip\_tags($mainframe->getUserStateFromRequest("search{$option}", 'search', '')));
$search       = $database->getEscaped(eUTF::utf8\_trim(eUTF::utf8\_strtolower($search)));

*Note: This fix has been applied on Elxis 2009.3*

« *Last Edit: September 20, 2010, 20:47:13 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/exclamation.gif)
##### [HTB22615 - XSS vulnerability in Elxis CMS (contacts)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg35082#msg35082)

« **Reply #4 on:** September 20, 2010, 20:39:33 »

**Vulnerability report**: September 20, 2010 by **High-Tech Bridge** on [this page](http://www.htbridge.ch/advisory/xss_vulnerability_in_elxis_cms_contacts.html).

**Affects:** Elxis 2009.2 electra rev2631 and probably prior versions

**Description of the vulnerability:** XSS vulnerability in Elxis 2009.2 (component contacts)

**Why this happens:** sanitize user-supplied input in "misc" variable

**Solution:**
Note: In order for the XSS attack to be successful the site administrator must visit an external phishing web page while he is logged in in Elxis administration.
Advisory: never visit external pages and especially those that might contain harmful code (javascript) while you are logged-in in sensitive pages.

Apply the patch attached to this post.

*Note: This fix has been applied on Elxis 2009.3*

[attachment deleted by admin]

« *Last Edit: September 20, 2010, 20:47:04 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/exclamation.gif)
##### [HTB22616 - XSS vulnerability in Elxis CMS (component modules)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg35083#msg35083)

« **Reply #5 on:** September 20, 2010, 22:12:38 »

**Vulnerability report**: September 20, 2010 by **High-Tech Bridge** on [this page](http://www.htbridge.ch/advisory/xss_vulnerability_in_elxis_cms_polls_module.html).

**Affects:** Elxis 2009.2 electra rev2631 and probably prior versions

**Description of the vulnerability:** XSS vulnerability in Elxis 2009.2 (component modules)

**Why this happens:** sanitize user-supplied input in "title" variable

**Solution:**
Note: In order for the XSS attack to be successful the site administrator must visit an external phishing web page while he is logged in in Elxis administration.
Advisory: never visit external pages and especially those that might contain harmful code (javascript) while you are logged-in in sensitive pages.

Apply the patch attached to this post.

*Note: This fix has been applied on Elxis 2009.3*

[attachment deleted by admin]

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/xx.gif)
##### [Saving user submitted content](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg35104#msg35104)

« **Reply #6 on:** September 21, 2010, 23:47:12 »

**Bug report:** September 21, 2010 by **psiloscc** on [this post](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5185.0).

**Affects:** Elxis 2009.2 and maybe prior versions too.

**Description of the bug:** You can not save the user submitted content items.

**Why this happens:** The table name has false written as *elx\_section* instead of the correct one *elx\_sections*.

**Solution:** Open file *administrator/components/com\_content/admin.content.php*
Go to line 995 (Elxis 2009.2)
Change this:
$database->setQuery( "SELECT title FROM #\_\_section WHERE ......
To this:
$database->setQuery( "SELECT title FROM #\_\_sections WHERE ......
Save the file, done!

*Note: this fix has been applied on Elxis 2009.3*

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/exclamation.gif)
##### [HTB22699 - SQL Injection in Elxis CMS (component polls)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg36392#msg36392)

« **Reply #7 on:** November 16, 2010, 19:38:26 »

**Vulnerability report:** November 16, 2010 by High-Tech Bridge on [this page](http://www.htbridge.ch/advisory/sql_injection_in_elxis_cms.html).

**Affects:** Elxis 2009.2, 2009.1 and probably prior versions

**Description of the vulnerability:** SQL injection vulnerability in Elxis 2009.2 (component polls)

**Why this happens:** sanitize HTTP\_X\_FORWARDED\_FOR (can be spoofed)

**Solution:**
Update to Elxis 2009.3 or do the following:
Open file components/com\_poll/poll.php
Find line 98:
   } else {
      $ipaddress = '';
   }

Add bellow:

if ($ipaddress != '') {
   if (preg\_match("/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/", $ipaddress)) {
      $parts = preg\_split('/\./',$ipaddress);
      foreach($parts as $ip\_part) {
         if (intval($ip\_part) > 255 || intval($ip\_part) < 0) { $ipaddress = ''; break; }
      }
   } else {
      $ipaddress = '';
   }
}

« *Last Edit: November 16, 2010, 19:51:41 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/exclamation.gif)
##### [HTB22700 - SQL injection in Elxis CMS (core)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg36395#msg36395)

« **Reply #8 on:** November 16, 2010, 20:01:27 »

**Vulnerability report:** November 16, 2010 by High-Tech Bridge on [this page](http://www.htbridge.ch/advisory/sql_injection_in_elxis_cms_1.html).

**Affects:** Elxis 2009.2, 2009.1 and probably prior versions

**Description of the vulnerability:** SQL injection vulnerability in Elxis 2009.2 (core)

**Why this happens:** sanitize passoword cookie

**Solution:**
Update to Elxis 2009.3 or do the following:
Open file *includes/Core/elxis.php*
Find line 619:
$username = $this->\_db->getEscaped($username);
Add bellow:
$passwd = $this->\_db->getEscaped($passwd);

« *Last Edit: November 16, 2010, 20:05:21 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/xx.gif)
##### [eForum v1.1 - Arbitary File Upload vulnerability](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg39714#msg39714)

« **Reply #9 on:** April 07, 2011, 21:17:06 »

I received a vulnerability alert by QSecure and Demetris Papapetrou about **eForum** v1.1 but **it was proved false**. Besides this I modified eForum to strengthen its security even more. Since April 7, 2011 [eForum listing on EDC](http://www.elxis-downloads.com/downloads/forums/255.html) is updated with this fix.

**Vulnerability report**: April 7, 2011 by [QSecure](http://www.qsecure.com.cy).

**Affects**: Eforum v1.1 downloaded before April 6 2011

**Description of the vulnerability**: eForum fails to properly filter dangerous file extensions during file upload (attachments to posts). An attacker can upload a file such as phtml and execute it later on.

**Why this happens:** eForum rejects some file extensions (php, dll, exe, etc) but not all. QSecure said that someone could upload a phtml file and execute it later. I replied them that this is wrong as eForum sets permissions 666 on uploaded files and so the uploaded files do not have permissions to be executed. So, this alert is totally wrong and eForum is secure without any patch.

**Solution:**
You don't need to do anything. If it makes you feel more secure re-download eForum and patch your existing installation by replacing the existing eforum.php file with the new downloaded one (file: components/com\_eforum/eforum.php). In the newer version I reversed the file extension check. eForum now accepts only certain file types (jpg, jpeg, png, gif, wmv, avi, mov, flv, doc, docx, csv, xml, css, js, xls, rtf, ppt, odt, ods, txt, pdf, zip, tar, gz)

« *Last Edit: April 07, 2011, 21:30:17 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/exclamation.gif)
##### [XSS vulnerability report](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg43327#msg43327)

« **Reply #10 on:** November 23, 2011, 22:00:47 »

**Vulnerability report**: November 23, 2011 by [DcLabs](http://www.dclabs.com.br/en/).

**Affects:** Elxis 2009.3 rev2681, 2009.2 and probably prior versions

**Description of the vulnerability:** Cross-Site Scripting (XSS)

**Why this happens:** Insufficient sanitization of REQUEST

**Solution:** Download an apply the attached patch package (suitable for both 2009.2/2009.3).
Note that Elxis 2009.3 Aphrodite was patched against this type of attack and you can download the updated package [here](http://www.elxis-downloads.com/downloads/elxis-cms/325.html).
The new Elxis 2009.3 Aphrodite revision is 2684.
If you downloaded Elxis 2009.3 after November 23, 2011 you don't need to apply this patch.

[attachment deleted by admin]

« *Last Edit: November 23, 2011, 22:17:56 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

#### Offline [datahell](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1 "View the profile of datahell")

* Elxis Team
* Hero Member
* ![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)![*](https://forum.elxis.org/Themes/inverted/images/staradmin.gif)
* [![](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=dlattach;attach=930;type=avatar)](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=profile;u=1)
* Posts: 10376
* + [![Elxis CMS](https://forum.elxis.org/Themes/inverted/images/www_sm.gif)](https://www.elxis.org "Elxis CMS")

![](https://forum.elxis.org/Themes/inverted/images/post/exclamation.gif)
##### [SQL injection vulnerability report](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.msg45896#msg45896)

« **Reply #11 on:** July 14, 2012, 11:08:09 »

**Vulnerability report:** July 14, 2012 by **Jon Hounsell**.

**Severity:** High

**Affects:** Elxis 2009.2, Elxis 2009.3 released before July 14 2012 (revision smaller than 2691), and most probably older Elxis versions 2009.1 and 2009.0

**Description of the vulnerability:** SQL injection vulnerability on Search Engines Friendly URLs analyse (file: includes/sef.php)

**Why this happens:** Insufficient sanitization of REQUEST\_URI

**Solution:** Replace existing file **includes/sef.php** with the attached one.
Elxis release at [elxis-downloads.com](http://www.elxis-downloads.com) was updated with this patch. **Elxis 2009.3 Aphrodite rev2691** is safe against this threat.
*Note:* if you have custom rewrite rules on your own sef.php file you must also add them in the attached file. Else the SEF URLs restoration wont work for your custom components.

**EDIT 16.07.2012:** Due to a PHP bug on CLI the previous fix did not worked correctly on some servers. I updated the attached patch and the Elxis release with a fix which by-passes this problem.

« *Last Edit: July 16, 2012, 20:10:02 by datahell* »

![](https://forum.elxis.org/Themes/inverted/images/ip.gif)
Logged

[Elxis Team](https://www.elxis.org) | [Is Open Source](https://www.isopensource.com) | [IOS Rentals | IOS AERO](https://www.isopensource.com/shop/software/)

---

* [Print](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=printpage;topic=5144.0)

Pages: [**1**]
[« previous](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.0;prev_next=prev#new) [next »](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.0;prev_next=next#new)

* [Elxis CMS Forum](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&) »
* [General](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&#c1) »
* [News and announcements](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&board=1.0) »
* [Bug reports and fixes](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&topic=5144.0)

* [Elxis CMS](http://www.elxis.org "Elxis CMS") |
  [Elxis Downloads Centre](http://www.elxis.net "Elxis Downloads Centre") |
  [Elxis Documentation](http://www.elxis.net/docs/ "Elxis Documentation")
* [XHTML](http://validator.w3.org/check?uri=referer "Valid XHTML 1.0!")
* [RSS](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&action=.xml;type=rss)
* [WAP2](https://forum.elxis.org/index.php?PHPSESSID=v9i7kgmmb2554ldmlcmbj32ugjd0ngpc&wap2)

Inverted by Crip



=== Content from www.openwall.com_4351de30_20250125_212040.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2011/12/30/2) [[thread-next>]](../../../2012/01/01/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4EFF7C81.3050308@redhat.com>
Date: Sat, 31 Dec 2011 14:20:01 -0700
From: Kurt Seifried <kseifrie@...hat.com>
To: oss-security@...ts.openwall.com
CC: Henri Salo <henri@...v.fi>
Subject: Re: CVE-request: Elxis CMS two XSS-vulnerabilities

On 12/30/2011 04:49 AM, Henri Salo wrote:
> 1) Input passed to the "task" parameter in index.php (when "option" is set to "com_content") is not properly sanitised before being returned to the user. This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site.
> <http://osvdb.org/show/osvdb/77563>
>
> 2) Input passed via the URL to administrator/index.php is not properly sanitised before being returned to the user. This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site.
> <http://osvdb.org/show/osvdb/77564>
Merging these two issues as per ADT4:

At this stage, X and Y are the same bug type, affect the same versions,
and affect the same products.

Do X and Y have any of the following characteristics?

  * X appears in a different DLL, library, or program than Y (e.g. X
    affects LIB1.DLL and Y affects LIB2.DLL)
  * X has more serious impact than Y (e.g. code execution as root versus
    leak of system pathname)
  * X takes a different input parameter/argument than Y (e.g. SQL
    injection in both the "user" and "password" parameters)
  * X is exploitable locally, but Y is not.
  * X requires stronger authentication than Y.
  * X can be exploited by a certain user that Y can not (e.g. a guest
    user vs. an admin)

*Yes:* *MERGE

*Please use CVE-2011-4918 for these two issues
*
*
>
> <http://secunia.com/advisories/47073/>
>
> Fixed in same version "2009.3 Aphrodite rev2684" so one CVE-identifier might be enough.
>
> - Henri Salo
Does anyone have a contact name for Secunia with respect to
co-ordinating CVE assignments better?

--

-- Kurt Seifried / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


