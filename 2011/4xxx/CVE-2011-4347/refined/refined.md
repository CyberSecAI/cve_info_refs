Based on the provided information, here's an analysis of CVE-2011-4347:

**Root Cause of Vulnerability:**
The `kvm_vm_ioctl_assign_device` function in the Linux kernel's KVM (Kernel-based Virtual Machine) module did not properly check if the user requesting device assignment had the necessary privileges. This oversight, combined with the default permissions of `/dev/kvm` (666), allowed unprivileged users to assign PCI devices.

**Weaknesses/Vulnerabilities Present:**
*   **Insufficient Access Control:** The core vulnerability is a lack of privilege checks in the device assignment ioctl.
*   **Insecure Default Permissions:** The `666` permissions on `/dev/kvm` made it accessible to all local users, exacerbating the issue.

**Impact of Exploitation:**
*   **Denial of Service (DoS):** An unprivileged local user could exploit this vulnerability to cause a system crash by assigning and potentially misconfiguring PCI devices.
*   **Device Hijacking**: By assigning devices that were already in use or whose resources were not claimed correctly, an attacker could potentially disrupt normal system operations.

**Attack Vectors:**
*   **Local Access:** The attack requires the attacker to have local access to the system.
*   **Use of /dev/kvm:**  The vulnerability is triggered through the `kvm_vm_ioctl_assign_device` ioctl, accessed via `/dev/kvm`.

**Required Attacker Capabilities/Position:**
*   **Unprivileged User:** An attacker only needs to be a local user on the system, not requiring any special privileges like root.
*   **Basic knowledge of KVM:** Although not explicitly stated, some basic understanding of KVM device assignment would be necessary to carry out the attack.

**Additional Details:**
*   The vulnerability does not allow for direct DMA (Direct Memory Access) reprogramming because access to sysfs files is still needed for this, which is typically restricted to privileged users.
*   The fix involved adding checks to the `kvm_vm_ioctl_assign_device` function to ensure that the user has the necessary permissions to access PCI sysfs resource files.
*   The patch also restricts device assignments to devices that are not bridges, have BAR resources and the user has the correct permissions.
*   The issue was fixed in Red Hat Enterprise Linux 5 and 6 via errata updates (RHSA-2012:0149, RHSA-2012:0350, RHSA-2012:1042).

This vulnerability was identified by Sasha Levin and reported by Petr Matousek, with a CVE ID of CVE-2011-4347.