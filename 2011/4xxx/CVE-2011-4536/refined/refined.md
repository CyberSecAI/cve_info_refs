- **Root cause of vulnerability**: Heap overflow due to insufficient validation of packet size and element count when processing packets with opcode 3 in `nettransdll.dll`.
- **Weaknesses/vulnerabilities present**: The service allocates memory based on the 10th and 11th bytes of the packet, which specify the element count. Then, packet data is copied into the allocated buffer based on the first two bytes of the packet (packet size). These values can be manipulated to create a heap overflow.
- **Impact of exploitation**: Remote attackers can execute arbitrary code with the privileges of the `HistoryServer.exe` service (Local System).
- **Attack vectors**: Sending a specially crafted packet with op-code 3 to the service listening on port 777.
- **Required attacker capabilities/position**: The attacker can be remote and does not need authentication to exploit the vulnerability.