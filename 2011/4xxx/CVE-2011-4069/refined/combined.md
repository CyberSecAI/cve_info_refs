=== Content from packetfence.org_28e12c2c_20250125_115923.html ===

![PacketFence](/img/packetfence-logo.png)Bug Tracking System

| Anonymous | [Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D1293) | 2025-01-25 06:59 EST | [RSS](https://www.packetfence.org/bugs/issues_rss.php) |
| --- | --- | --- |

| [Main](/bugs/main_page.php) | [My View](/bugs/my_view_page.php) | [View Issues](/bugs/view_all_bug_page.php) | [Change Log](/bugs/changelog_page.php) | [Roadmap](/bugs/roadmap_page.php) |  |
| --- | --- |

| View Issue Details [ [Jump to Notes](#bugnotes) ] | | | | [ [Issue History](view.php?id=1293&history=1#history) ] [ [Print](print_bug_page.php?bug_id=1293) ] | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| 0001293 | PacketFence | security | public | 2011-10-03 11:42 | 2011-10-24 20:17 |
|  | | | | | |
| Reporter | mattd |  | | | |
| Assigned To | obilodeau |  | | | |
| Priority | normal | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Platform |  | OS |  | OS Version |  |
| Product Version | devel |  | | | |
| Target Version | 3.0.2 | Fixed in Version | 3.0.2 |  | |
|  | | | | | |
| Summary | 0001293: Issues with LDAP-based authentication in web administration interface (login.php) | | | | |
| Description | There are two issues with LDAP-based authentication in the web administration interface (in script html/admin/login.php), which may allow an attacker access under certain system setups:  The user-supplied username is not escaped before being interpolated into the LDAP search filter used for authentication, leading to weaker security. For example, a username with a "\*" character could be used to perform a substring- or presence-based match on the username LDAP attribute, instead of equality-based. This could help an attacker use a valid username without needing to know of one beforehand.  The user-supplied password is not checked to see if it is nonempty; the isset function used in check\_password will still return true on an empty password. This leads to the ability to perform unauthenticated binds (if they are enabled on the LDAP server), allowing an attacker to 'authenticate' into the web administration interface without needing a valid password. | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
| fixed in git revision |  | | | | |
| fixed in mtn revision | 040493ea147330b41fd2b19d1c3cc1cf8c8d6929 | | | | |
|  | | | | | |
| Attached Files | [patch file icon](file_download.php?file_id=109&type=bug) [security-fix-1293-ldap-anonymous-bind.patch](file_download.php?file_id=109&type=bug) [[^](file_download.php?file_id=109&type=bug)] (939 bytes) 2011-10-12 11:00 [Show Content] [Hide Content] ``` # # Security fix for LDAP anonymous bind bypassing authentication (#1293) # Licensed under the GPLv2 # Olivier Bilodeau <obilodeau@inverse.ca> # # old_revision [54c13c3b3b2d4c2f4035d84fe8f3ced73bb882e0] # # patch "pf/html/admin/login.php" #  from [437daaaf2a52b935008754acd28d6b71d1d33220] #    to [3091155d3aee619c63b0ac5aa32708fbd5c8903d] # ============================================================ --- pf/html/admin/login.php	437daaaf2a52b935008754acd28d6b71d1d33220 +++ pf/html/admin/login.php	3091155d3aee619c63b0ac5aa32708fbd5c8903d @@ -39,9 +39,9 @@ function check_input($input){    }  }    -# rejecting NULLs because they end-up doing an anonymous LDAP bind +# rejecting NULLs or empty strings because they end-up doing an anonymous LDAP bind  function check_password($input){ -  if (isset($input)) { +  if (isset($input) && !is_null($input) && !empty($input)) {      return true;    } else {      print "Invalid password<br>";  ```   [patch file icon](file_download.php?file_id=110&type=bug) [security-fix-1293-ldap-injection.patch](file_download.php?file_id=110&type=bug) [[^](file_download.php?file_id=110&type=bug)] (799 bytes) 2011-10-12 15:01 [Show Content] [Hide Content] ``` # # Security fix for LDAP injection (#1293) # Licensed under the GPLv2 # Olivier Bilodeau <obilodeau@inverse.ca> # # old_revision [d0aba756a3e8ff9002c0dd9be1885ea6d38ea0ff] # # patch "pf/html/admin/login.php" #  from [5a1ccaad2d60f3ff17308787bc48e58b5b7fc161] #    to [52a09fcc6fa308e31f25088f3fa1e283b7a18b77] # ============================================================ --- pf/html/admin/login.php	5a1ccaad2d60f3ff17308787bc48e58b5b7fc161 +++ pf/html/admin/login.php	52a09fcc6fa308e31f25088f3fa1e283b7a18b77 @@ -30,7 +30,7 @@ function check_input($input){  }    function check_input($input){ -  if(preg_match("/^[\@a-zA-Z0-9_\:\,\(\)]/", $input) && strlen($input) <= 15){ +  if(preg_match("/^[\@a-zA-Z0-9_\:\,\(\)]+$/", $input) && strlen($input) <= 15){      return true;     }            else{  ```   [patch file icon](file_download.php?file_id=115&type=bug) [security-fix-1293-anonymous-bind-pf19.patch](file_download.php?file_id=115&type=bug) [[^](file_download.php?file_id=115&type=bug)] (1,777 bytes) 2011-10-24 11:27 [Show Content] [Hide Content] ``` *** login.php	2011-10-21 09:25:39.000000000 -0400 --- login_1.php	2011-10-21 09:22:25.000000000 -0400 *************** *** 8,14 ****   }      function check_input($input){ !   if(preg_match("/^[\@a-zA-Z0-9_\:\,\(\)]/", $input) && strlen($input) <= 15){       return true;      }             else{ --- 29,35 ----   }      function check_input($input){ !   if(preg_match("/^[\@a-zA-Z0-9_\:\,\(\)]+$/", $input) && strlen($input) <= 15){         return true;      }             else{ *************** *** 17,22 **** --- 38,54 ----     }   }     + # rejecting NULLs or empty strings because they end-up doing an anonymous LDAP bind + function legal_password($input){ +   global $logger; +   if (isset($input) && !is_null($input) && !empty($input)) { +     return true; +   } else { +     $logger->info("Empty passwords are explicitly rejected"); +     return false; +   } + } +    //TODO are we being too difficult on what we accept as a password? ie: pass starting with ; is invalid   function check_sensitive_input($input){     if(preg_match("/^[\@a-zA-Z0-9_\:\,\(\)]/", $input) && strlen($input) <= 15){ *************** *** 165,171 ****       }     }    !   if (isset($_POST['username'], $_POST['password']) && check_input($_POST['username']) && check_sensitive_input($_POST['password'])) {       $hash = validate_user($_POST['username'], $_POST['password']);       if(!$hash || !isset($_COOKIE['test'])){         $failed = true; --- 227,233 ----       }     }    !    if (isset($_POST['username'], $_POST['password']) && check_input($_POST['username']) && legal_password($_POST['password']) && check_sensitive_input($_POST['password'])) {         $hash = validate_user($_POST['username'], $_POST['password']);       if(!$hash || !isset($_COOKIE['test'])){         $failed = true;  ``` | | | | |
| |  |  |  | | --- | --- | --- | | | | | | |

| - Relationships | |
| --- | --- |
| | related to | [0001209](view.php?id=1209) | closed | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | problematic password validation | | --- | --- | --- | --- | --- | | |

| + Relationships |
| --- |

| -  Notes | |
| --- | --- |
| ([0002337)](view.php?id=1293#c2337 "Direct link to note") [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) (reporter)  2011-10-12 14:31 | Fixed the auth bypass with empty password. The patch is a simpler version of the real fix, since I wanted error reporting not to break layout.  I feel very bad about this one, especially since we knew about the possibility and thought we were defended against it. Turns out we misinterpreted this:  "If bind\_rdn and bind\_password are not specified, an anonymous bind is attempted." from <http://www.php.net/manual/en/function.ldap-bind.php> [[^](http://www.php.net/manual/en/function.ldap-bind.php)]  By thinking that if we were passing an empty string this would could as being specified. Yes! I am blaming it on the manual! ;)  This first fix is committed in revno: d0aba756a3e8ff9002c0dd9be1885ea6d38ea0ff |
|  | |
| ([0002338)](view.php?id=1293#c2338 "Direct link to note") [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) (reporter)  2011-10-12 15:07 | Fixed LDAP injection issue. Applying strict rules on what type of usernames are allowed.  Fix will be released in 3.0.2 shortly.  Those you can't wait or who won't upgrade in a timely fashion should apply the attached patch. It should apply cleanly on 2.2.0+. Patches for earlier versions can be provided on request. |
|  | |
| ([0002364)](view.php?id=1293#c2364 "Direct link to note") [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) (reporter)  2011-10-17 10:39 | LDAP Authentication bypass has been assigned CVE-2011-4068.  LDAP Injection has been assigned CVE-2011-4069. |
|  | |
| ([0002377)](view.php?id=1293#c2377 "Direct link to note") [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) (reporter)  2011-10-24 13:08 | Additional change \*not\* in the attached patch but in upcoming 3.0.2: allowing dot (.) in username.  Just change regexp to: ```    if(preg_match("/^[\@a-zA-Z0-9_\:\,\(\)\.]+$/", $input) && strlen($input) <= 15){   ``` |
|  | |
| ([0002385)](view.php?id=1293#c2385 "Direct link to note") [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) (reporter)  2011-10-24 20:15 | fix released in 3.0.2 |
|  | |

| +  Notes | |
| --- | --- |

| - Issue History | | | |
| --- | --- | --- | --- |
| Date Modified | Username | Field | Change |
| 2011-10-03 11:42 | [mattd](https://www.packetfence.org/bugs/view_user_page.php?id=235) | New Issue |  |
| 2011-10-06 11:46 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Status | new => assigned |
| 2011-10-06 11:46 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Assigned To | => obilodeau |
| 2011-10-12 11:00 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | File Added: security-fix-1293-ldap-anonymous-bind.patch |  |
| 2011-10-12 14:31 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Note Added: 0002337 |  |
| 2011-10-12 15:01 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | File Added: security-fix-1293-ldap-injection.patch |  |
| 2011-10-12 15:07 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | mtn revision | => 040493ea147330b41fd2b19d1c3cc1cf8c8d6929 |
| 2011-10-12 15:07 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Note Added: 0002338 |  |
| 2011-10-12 15:07 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Status | assigned => resolved |
| 2011-10-12 15:07 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Fixed in Version | => +1 |
| 2011-10-12 15:07 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Resolution | open => fixed |
| 2011-10-12 15:07 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Relationship added | related to 0001209 |
| 2011-10-17 10:39 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Note Added: 0002364 |  |
| 2011-10-24 11:27 | [dwuelfrath](https://www.packetfence.org/bugs/view_user_page.php?id=228) | File Added: security-fix-1293-anonymous-bind-pf19.patch |  |
| 2011-10-24 13:08 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Note Added: 0002377 |  |
| 2011-10-24 16:45 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | View Status | private => public |
| 2011-10-24 20:15 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Target Version | => 3.0.2 |
| 2011-10-24 20:15 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Note Added: 0002385 |  |
| 2011-10-24 20:16 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Status | resolved => closed |
| 2011-10-24 20:17 | [obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148) | Fixed in Version | +1 => 3.0.2 |

| + Issue History | | | |
| --- | --- | --- | --- |

---

| Copyright © 2000 - 2012 MantisBT Group | [Powered by Mantis Bugtracker](http://www.mantisbt.org "Free Web Based Bug Tracker") |
| --- | --- |



=== Content from www.packetfence.org_5cd7d6d6_20250126_082030.html ===

![PacketFence](/img/packetfence-logo.png)Bug Tracking System

| Anonymous | [Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D148) | 2025-01-26 03:20 EST | [RSS](https://www.packetfence.org/bugs/issues_rss.php?project_id=0) |
| --- | --- | --- |

| [Main](/bugs/main_page.php) | [My View](/bugs/my_view_page.php) | [View Issues](/bugs/view_all_bug_page.php) | [Change Log](/bugs/changelog_page.php) | [Roadmap](/bugs/roadmap_page.php) |  |
| --- | --- |

| User Information |
| Username | obilodeau |
| E-mail | Access Denied. |
| Real Name | Access Denied. |

---

| Copyright © 2000 - 2012 MantisBT Group | [Powered by Mantis Bugtracker](http://www.mantisbt.org "Free Web Based Bug Tracker") |
| --- | --- |



=== Content from packetfence.org_9bcf8e82_20250125_115922.html ===

![PacketFence](/img/packetfence-logo.png)Bug Tracking System

| Anonymous | [Login](/bugs/login_page.php?return=%2Fbugs%2Fchangelog_page.php%3Fversion_id%3D35) | 2025-01-25 06:59 EST | [RSS](https://www.packetfence.org/bugs/issues_rss.php?project_id=0) |
| --- | --- | --- |

| [Main](/bugs/main_page.php) | [My View](/bugs/my_view_page.php) | [View Issues](/bugs/view_all_bug_page.php) | [Change Log](/bugs/changelog_page.php) | [Roadmap](/bugs/roadmap_page.php) |  |
| --- | --- |

PacketFence - Change Log

[PacketFence](changelog_page.php?project_id=4) - [3.0.2](changelog_page.php?version_id=35) (Released 2011-10-24) [ [View Issues](view_all_set.php?type=1&temporary=y&project_id=4&fixed_in_version=3.0.2) ]
=========================================
- [0001312](/bugs/view.php?id=1312 "[closed] Newer versions of net-appliance-session are problematic"): **[upstream]** Newer versions of net-appliance-session are problematic ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0000763](/bugs/view.php?id=763 "[closed] Unsanitized user input in web_node_register"): **[security]** Unsanitized user input in web\_node\_register ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0000989](/bugs/view.php?id=989 "[closed] allow authentication module to update person or node"): **[captive portal]** allow authentication module to update person or node ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001285](/bugs/view.php?id=1285 "[closed] add trigger or cascade to delete node_useragent when deleting a node"): **[core]** add trigger or cascade to delete node\_useragent when deleting a node ([dwuelfrath](https://www.packetfence.org/bugs/view_user_page.php?id=228)) - closed.
- [0001351](/bugs/view.php?id=1351 "[closed] i can't change email_activation_timeout"): **[configuration]** i can't change email\_activation\_timeout - closed.
- [0001298](/bugs/view.php?id=1298 "[closed] nodes are not unregistered on unregdate unless an expire mode is activated"): **[core]** nodes are not unregistered on unregdate unless an expire mode is activated ([dwuelfrath](https://www.packetfence.org/bugs/view_user_page.php?id=228)) - closed.
- [0001316](/bugs/view.php?id=1316 "[closed] iptables default config doesn't accept broadcasts"): **[configuration]** iptables default config doesn't accept broadcasts ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001315](/bugs/view.php?id=1315 "[closed] false error on de-registration"): **[core]** false error on de-registration ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001234](/bugs/view.php?id=1234 "[closed] OS report is not visible when there are a lot of different OSes on the network"): **[web admin]** OS report is not visible when there are a lot of different OSes on the network (fgaudreault) - closed.
- [0001309](/bugs/view.php?id=1309 "[closed] Phone provider not kept in guest form"): **[captive portal]** Phone provider not kept in guest form ([francis](https://www.packetfence.org/bugs/view_user_page.php?id=130)) - closed.
- [0001308](/bugs/view.php?id=1308 "[closed] guest access by sms doesn't record firstname, lastname"): **[captive portal]** guest access by sms doesn't record firstname, lastname ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001301](/bugs/view.php?id=1301 "[closed] Pre-registered guest unregdate not there"): **[web admin]** Pre-registered guest unregdate not there ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001273](/bugs/view.php?id=1273 "[closed] enforcement calls should be executed by root"): **[core]** enforcement calls should be executed by root ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001296](/bugs/view.php?id=1296 "[closed] XSS in captive portal web interface (several files)"): **[security]** XSS in captive portal web interface (several files) ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001295](/bugs/view.php?id=1295 "[closed] Command injection in guest management and captive portal web interfaces"): **[security]** Command injection in guest management and captive portal web interfaces ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001242](/bugs/view.php?id=1242 "[closed] Doubled allow network subnets in generated captive-portal-common.conf"): **[configuration]** Doubled allow network subnets in generated captive-portal-common.conf (fgaudreault) - closed.
- [0001293](/bugs/view.php?id=1293 "[closed] Issues with LDAP-based authentication in web administration interface (login.php)"): **[security]** Issues with LDAP-based authentication in web administration interface (login.php) ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001292](/bugs/view.php?id=1292 "[closed] XSS in web adminstration interface (login.php)"): **[security]** XSS in web adminstration interface (login.php) ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
- [0001289](/bugs/view.php?id=1289 "[closed] Dashboard won't give SQL stats if MySQL is running on another machine"): **[web admin]** Dashboard won't give SQL stats if MySQL is running on another machine (fgaudreault) - closed.
- [0001287](/bugs/view.php?id=1287 "[closed] Unreliable encoding behavior messes up with translations"): **[captive portal]** Unreliable encoding behavior messes up with translations ([francis](https://www.packetfence.org/bugs/view_user_page.php?id=130)) - closed.
- [0001294](/bugs/view.php?id=1294 "[closed] Session state shared between captive portal and guest management web interfaces"): **[security]** Session state shared between captive portal and guest management web interfaces ([obilodeau](https://www.packetfence.org/bugs/view_user_page.php?id=148)) - closed.
[21 issues]

---

| Copyright © 2000 - 2012 MantisBT Group | [Powered by Mantis Bugtracker](http://www.mantisbt.org "Free Web Based Bug Tracker") |
| --- | --- |


