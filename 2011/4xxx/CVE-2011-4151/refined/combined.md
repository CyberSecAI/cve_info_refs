=== Content from bugs.launchpad.net_c8e8e8c2_20250126_100123.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[krb5 package](https://launchpad.net/ubuntu/%2Bsource/krb5)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/krb5)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/krb5)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/krb5)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/krb5)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/krb5)

# krb5-kdc-ldap plugin crashes krb5-kdc sometimes when password policy is set

Bug #715579 reported by
[Mark Deneen](https://launchpad.net/~mdeneen)
on 2011-02-09

[8](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [krb5 (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/krb5 "Latest release: 1.21.3-4, uploaded to main on 2025-01-16 22:34:05.090775+00:00 by Sam Hartman (hartmans), maintained by Sam Hartman (hartmans)") | Fix Released | Medium | Unassigned |  |

### Bug Description

Binary package hint: krb5-kdc

I have a krb5kdc server running, using openldap as a data store. This works great and, for most clients, it is fine. I have a password policy set as follows:

krbMaxPwdLife: 3628800

krbMinPwdLife: 0

krbPwdMinDiffChars: 1

krbPwdMinLength: 6

krbPwdHistoryLength: 3

krbPwdMaxFailure: 20

krbPwdFailureCountInterval: 0

krbPwdLockoutDuration: 8

I have a zimbra server running, configured to use kerberos5 for authentication. This appears to be working. I left a mail client (Thunderbird) running, periodically checking for new messages. After a few hours, krb5kdc crashed. I ran it through strace and found the following:

krb5kdc: ../../../../../ src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:161: krb5\_ldap\_lockout\_audit: Assertion '!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed..

I took a peek at the code, but the assertion line didn't mean that much to me. It did point me to the krbPwdLockoutDuration setting. Looking at it now, I sure hope that it represents minutes.

Regardless, it shouldn't be possible to crash the KDC and I can now do it very reliably. Any idea what the assertion is checking for and what I can do to prevent this from happening?

ProblemType: Bug

DistroRelease: Ubuntu 10.04

Package: krb5-kdc-ldap 1.8.1+dfsg-2ubuntu0.4

ProcVersionSignature: Ubuntu 2.6.32-23.37-server 2.6.32.15+drm33.5

Uname: Linux 2.6.32-23-server x86\_64

Architecture: amd64

Date: Tue Feb 8 22:53:43 2011

InstallationMedia: Ubuntu-Server 10.04 LTS "Lucid Lynx" - Release amd64 (20100427)

ProcEnviron:

 PATH=(custom, no user)

 LANG=en\_US.UTF-8

 SHELL=/bin/bash

SourcePackage: krb5

Tags:

[amd64](/ubuntu/%2Bsource/krb5/%2Bbugs?field.tag=amd64)
[apport-bug](/ubuntu/%2Bsource/krb5/%2Bbugs?field.tag=apport-bug)
[lucid](/ubuntu/%2Bsource/krb5/%2Bbugs?field.tag=lucid)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Deneen (mdeneen)](https://launchpad.net/~mdeneen) wrote on 2011-02-09: |  |  | [#1](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/1) |
| --- | --- | --- | --- |

* [Dependencies.txt](https://bugs.launchpad.net/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Battachment/1839175/%2Bfiles/Dependencies.txt)
  [Edit](/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Battachment/1839175)
  (1.5 KiB,
  text/plain; charset="utf-8")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Deneen (mdeneen)](https://launchpad.net/~mdeneen) wrote on 2011-02-09: |  |  | [#2](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/2) |
| --- | --- | --- | --- |

If this allows an attacker to cause a DoS by crashing the kdc, should I have checked on the "Security issue" checkbox?

If this allows an attacker to cause a DoS by crashing the kdc, should I have checked on the "Security issue" checkbox?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Deneen (mdeneen)](https://launchpad.net/~mdeneen) wrote on 2011-02-09: |  |  | [#3](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/3) |
| --- | --- | --- | --- |

I built 1.8.3 from the natty source package, but the problem still exists in that version.

I built 1.8.3 from the natty source package, but the problem still exists in that version.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Deneen (mdeneen)](https://launchpad.net/~mdeneen) wrote on 2011-02-09: |  |  | [#4](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/4) |
| --- | --- | --- | --- |

I built 1.9.0 with the debian package diff from the Debian experimental repository. The problem exists there as well.

I built 1.9.0 with the debian package diff from the Debian experimental repository. The problem exists there as well.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sam Hartman (hartmans)](https://launchpad.net/~hartmans) wrote on 2011-02-09:  [**Re: [Bug 715579] Re: krb5-kdc-ldap plugin crashes krb5-kdc sometimes when password policy is set**](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/5) |  |  | [#5](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/5) |
| --- | --- | --- | --- |

>>>>> "Mark" == Mark Deneen <email address hidden> writes:

Mark> I built 1.8.3 from the natty source package, but the problem

    Mark> still exists in that version.

If you're comfortable trying a package out of my PPA (I'm the Debian

krb5 maintainer and a member of the upstream core team)

Take a look at the 1.9 packages in

[https://launchpad.net/~hartmans/+archive/krb5](https://launchpad.net/~hartmans/%2Barchive/krb5)

I think there are some upstream changes in 1.9 in this area to improve

similar issues.

--Sam

>>>>> "Mark" == Mark Deneen <715579@bugs.launchpad.net> writes:
Mark> I built 1.8.3 from the natty source package, but the problem
Mark> still exists in that version.
If you're comfortable trying a package out of my PPA (I'm the Debian
krb5 maintainer and a member of the upstream core team)
Take a look at the 1.9 packages in
https://launchpad.net/~hartmans/+archive/krb5
I think there are some upstream changes in 1.9 in this area to improve
similar issues.
--Sam

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Deneen (mdeneen)](https://launchpad.net/~mdeneen) wrote on 2011-02-09: |  |  | [#6](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/6) |
| --- | --- | --- | --- |

Sam, I'll give it a shot.

Sam, I'll give it a shot.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Deneen (mdeneen)](https://launchpad.net/~mdeneen) wrote on 2011-02-09: |  |  | [#7](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/7) |
| --- | --- | --- | --- |

Sam,

Same result:

<pre>

 | 00000 6b 72 62 35 6b 64 63 3a 20 2e 2e 2f 2e 2e 2f 2e krb5kdc: ../../. |

 | 00010 2e 2f 2e 2e 2f 2e 2e 2f 73 72 63 2f 70 6c 75 67 ./../../ src/plug |

 | 00020 69 6e 73 2f 6b 64 62 2f 6c 64 61 70 2f 6c 69 62 ins/kdb/ ldap/lib |

 | 00030 6b 64 62 5f 6c 64 61 70 2f 6c 6f 63 6b 6f 75 74 kdb\_ldap /lockout |

 | 00040 2e 63 3a 31 37 38 3a 20 6b 72 62 35 5f 6c 64 61 .c:178: krb5\_lda |

 | 00050 70 5f 6c 6f 63 6b 6f 75 74 5f 61 75 64 69 74 3a p\_lockou t\_audit: |

 | 00060 20 41 73 73 65 72 74 69 6f 6e 20 60 21 6c 6f 63 Asserti on `!loc |

 | 00070 6b 65 64 5f 63 68 65 63 6b 5f 70 28 63 6f 6e 74 ked\_chec k\_p(cont |

 | 00080 65 78 74 2c 20 73 74 61 6d 70 2c 20 6d 61 78 5f ext, sta mp, max\_ |

 | 00090 66 61 69 6c 2c 20 6c 6f 63 6b 6f 75 74 5f 64 75 fail, lo ckout\_du |

 | 000a0 72 61 74 69 6f 6e 2c 20 65 6e 74 72 79 29 27 20 ration, entry)' |

 | 000b0 66 61 69 6c 65 64 2e 0a failed.. |

</pre>

(I don't know if launchpad supports html formatting, so let's see what I get)

Do you know what this assertion is trying to prevent? Perhaps it is a configuration problem on my end.

Sam,
Same result:
<pre>
| 00000 6b 72 62 35 6b 64 63 3a 20 2e 2e 2f 2e 2e 2f 2e krb5kdc: ../../. |
| 00010 2e 2f 2e 2e 2f 2e 2e 2f 73 72 63 2f 70 6c 75 67 ./../../ src/plug |
| 00020 69 6e 73 2f 6b 64 62 2f 6c 64 61 70 2f 6c 69 62 ins/kdb/ ldap/lib |
| 00030 6b 64 62 5f 6c 64 61 70 2f 6c 6f 63 6b 6f 75 74 kdb\_ldap /lockout |
| 00040 2e 63 3a 31 37 38 3a 20 6b 72 62 35 5f 6c 64 61 .c:178: krb5\_lda |
| 00050 70 5f 6c 6f 63 6b 6f 75 74 5f 61 75 64 69 74 3a p\_lockou t\_audit: |
| 00060 20 41 73 73 65 72 74 69 6f 6e 20 60 21 6c 6f 63 Asserti on `!loc |
| 00070 6b 65 64 5f 63 68 65 63 6b 5f 70 28 63 6f 6e 74 ked\_chec k\_p(cont |
| 00080 65 78 74 2c 20 73 74 61 6d 70 2c 20 6d 61 78 5f ext, sta mp, max\_ |
| 00090 66 61 69 6c 2c 20 6c 6f 63 6b 6f 75 74 5f 64 75 fail, lo ckout\_du |
| 000a0 72 61 74 69 6f 6e 2c 20 65 6e 74 72 79 29 27 20 ration, entry)' |
| 000b0 66 61 69 6c 65 64 2e 0a failed.. |
</pre>
(I don't know if launchpad supports html formatting, so let's see what I get)
Do you know what this assertion is trying to prevent? Perhaps it is a configuration problem on my end.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sam Hartman (hartmans)](https://launchpad.net/~hartmans) wrote on 2011-02-09: |  |  | [#8](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/8) |
| --- | --- | --- | --- |

>>>>> "Mark" == Mark Deneen <email address hidden> writes:

Mark> Sam, I'll give it a shot. -- You received this bug

    Mark> notification because you are subscribed to krb5 in ubuntu.

    Mark> <https://bugs.launchpad.net/bugs/715579>

I'm sorry I asked you to do this.

I didn't see your note that you had already tried 1.9.

OK, so this is presumably an upstream issue.

I know that several of the upstream developers monitor the Ubuntu bugs.

I will not have time to look into it a fire while, but hopefully others

will.

>>>>> "Mark" == Mark Deneen <715579@bugs.launchpad.net> writes:
Mark> Sam, I'll give it a shot. -- You received this bug
Mark> notification because you are subscribed to krb5 in ubuntu.
Mark> https://bugs.launchpad.net/bugs/715579
I'm sorry I asked you to do this.
I didn't see your note that you had already tried 1.9.
OK, so this is presumably an upstream issue.
I know that several of the upstream developers monitor the Ubuntu bugs.
I will not have time to look into it a fire while, but hopefully others
will.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Deneen (mdeneen)](https://launchpad.net/~mdeneen) wrote on 2011-02-09: |  |  | [#9](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/9) |
| --- | --- | --- | --- |

Sam,

I destroyed my thunderbird profile and recreated it. The KDC is no longer crashing, so that's good, but it shouldn't be possible for any application to remotely cause the KDC to quit.

I'll let thunderbird run for a bit and see if I experience the same problem.

Thanks again.

-M

Sam,
I destroyed my thunderbird profile and recreated it. The KDC is no longer crashing, so that's good, but it shouldn't be possible for any application to remotely cause the KDC to quit.
I'll let thunderbird run for a bit and see if I experience the same problem.
Thanks again.
-M

[Scott Moser (smoser)](https://launchpad.net/~smoser)
on 2011-03-10

| Changed in krb5 (Ubuntu): | |
| --- | --- |
| **importance**: | Undecided → Medium |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Deneen (mdeneen)](https://launchpad.net/~mdeneen) wrote on 2011-05-27: |  |  | [#10](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/10) |
| --- | --- | --- | --- |

I just wanted to note that in my environment, this is happening many times a day. I run the kdc through runit, so things get restarted immediately, but something is clearly wrong:

2011-05-27\_11:21:32.11310 krb5kdc: starting...

2011-05-27\_11:22:01.99218 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_11:22:02.01489 krb5kdc: starting...

2011-05-27\_11:22:34.82072 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_11:22:34.84385 krb5kdc: starting...

2011-05-27\_11:23:04.85051 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_11:23:04.87166 krb5kdc: starting...

2011-05-27\_13:41:47.11749 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_13:41:47.13390 krb5kdc: starting...

2011-05-27\_13:42:15.83151 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_13:42:15.84522 krb5kdc: starting...

2011-05-27\_13:42:17.12465 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_13:42:17.14709 krb5kdc: starting...

2011-05-27\_13:42:47.15550 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_13:42:47.16933 krb5kdc: starting...

2011-05-27\_13:42:59.14972 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_13:42:59.17231 krb5kdc: starting...

2011-05-27\_13:43:21.32805 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_13:43:21.33698 krb5kdc: starting...

2011-05-27\_13:43:29.18399 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_13:43:29.20055 krb5kdc: starting...

2011-05-27\_13:43:51.35396 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.

2011-05-27\_13:43:51.38001 krb5kdc: starting...

Any idea what the assertion is trying to prevent? Should I contact the upstream developers?

I just wanted to note that in my environment, this is happening many times a day. I run the kdc through runit, so things get restarted immediately, but something is clearly wrong:
2011-05-27\_11:21:32.11310 krb5kdc: starting...
2011-05-27\_11:22:01.99218 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_11:22:02.01489 krb5kdc: starting...
2011-05-27\_11:22:34.82072 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_11:22:34.84385 krb5kdc: starting...
2011-05-27\_11:23:04.85051 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_11:23:04.87166 krb5kdc: starting...
2011-05-27\_13:41:47.11749 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_13:41:47.13390 krb5kdc: starting...
2011-05-27\_13:42:15.83151 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_13:42:15.84522 krb5kdc: starting...
2011-05-27\_13:42:17.12465 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_13:42:17.14709 krb5kdc: starting...
2011-05-27\_13:42:47.15550 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_13:42:47.16933 krb5kdc: starting...
2011-05-27\_13:42:59.14972 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_13:42:59.17231 krb5kdc: starting...
2011-05-27\_13:43:21.32805 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_13:43:21.33698 krb5kdc: starting...
2011-05-27\_13:43:29.18399 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_13:43:29.20055 krb5kdc: starting...
2011-05-27\_13:43:51.35396 krb5kdc: ../../../../../src/plugins/kdb/ldap/libkdb\_ldap/lockout.c:178: krb5\_ldap\_lockout\_audit: Assertion `!locked\_check\_p(context, stamp, max\_fail, lockout\_duration, entry)' failed.
2011-05-27\_13:43:51.38001 krb5kdc: starting...
Any idea what the assertion is trying to prevent? Should I contact the upstream developers?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jamie Strandboge (jdstrand)](https://launchpad.net/~jdstrand) wrote on 2011-10-21: |  |  | [#11](/ubuntu/%2Bsource/krb5/%2Bbug/715579/comments/11) |
| --- | --- | --- | --- |

This should be fixed with <http://www.ubuntu.com/usn/usn-1233-1/>

This should be fixed with http://www.ubuntu.com/usn/usn-1233-1/

| Changed in krb5 (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/krb5/%2Bfilebug)

This report contains
**Public**
information

Everyone can see this information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [Dependencies.txt](https://bugs.launchpad.net/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Battachment/1839175/%2Bfiles/Dependencies.txt)
  [Edit](/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Battachment/1839175 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/krb5/%2Bbug/715579/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from web.mit.edu_181af435_20250125_154604.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2011-006
MIT krb5 Security Advisory 2011-006
Original release: 2011-10-18
Last update: 2011-10-20
Topic: KDC denial of service vulnerabilities
CVE-2011-1527: null pointer dereference in KDC LDAP back end
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:H/RL:OF/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.8
Exploitability: High
Remediation Level: Official Fix
Report Confidence: Confirmed
CVE-2011-1528: assertion failure in KDC LDAP back end
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
CVSSv2 Temporal Score: 6.1
CVE-2011-1529: null pointer dereference in multiple KDC back ends
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
CVSSv2 Temporal Score: 6.1
CVE-2011-4151: assertion failure in KDC db2 back end
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
CVSSv2 Temporal Score: 6.1
SUMMARY
=======
CVE-2011-1527: In releases krb5-1.9 and later, the KDC can crash due
to a null pointer dereference if configured to use the LDAP back end.
A trigger condition is publicly known.
CVE-2011-1528: In releases krb5-1.8 and later, the KDC can crash due
to an assertion failure if configured to use the LDAP back end. No
exploit is known to exist, but there is public evidence that the
unidentified trigger condition occurs in the field.
CVE-2011-1529: In releases krb5-1.8 and later, the KDC can crash due
to a null pointer dereference. No exploit is known to exist.
CVE-2011-4151: In releases krb5-1.8 through krb5-1.8.4, the KDC can
crash due to an assertion failure if configured to use the Berkeley DB
("db2") back end.
IMPACT
======
CVE-2011-1527: An unauthenticated remote attacker can crash a KDC
daemon via null pointer dereference if the KDC is configured to use
the LDAP back end. (This is not the default configuration.)
CVE-2011-1528: An unauthenticated remote attacker can crash a KDC
daemon via assertion failure if the KDC is configured to use
the LDAP back end. (This is not the default configuration.).
CVE-2011-1529: An unauthenticated remote attacker can crash a KDC
daemon via null pointer dereference.
CVE-2011-4151: An unauthenticated remote attacker can crash a KDC
daemon via assertion failure if the KDC is configured to use the
Berkeley DB ("db2") back end.
AFFECTED SOFTWARE
=================
\* The KDC in krb5-1.9 and later is vulnerable to CVE-2011-1527 when
configured with the LDAP back end. Earlier releases had different
code that masked this bug and did not crash under these conditions.
\* The KDC in krb5-1.8 and later is vulnerable to CVE-2011-1528 when
configured with the LDAP back end.
\* The KDC in krb5-1.8 and later is vulnerable to CVE-2011-1529 when
configured with either the Berkeley DB ("db2") or the LDAP back end.
\* The KDC in krb5-1.8 through krb5-1.8.4 is vulnerable to
CVE-2011-4151 when configured with the Berkeley DB ("db2") back end.
Releases krb5-1.9 and later no longer have the assertion in the db2
back and are not vulnerable.
FIXES
=====
\* Workaround: restart the KDC when it crashes, possibly using an
automated monitoring process.
\* An upcoming release in the krb5-1.9.x series will fix CVE-2011-1527.
\* Upcoming releases in the krb5-1.8.x and krb5-1.9.x series will fix
CVE-2011-1528 and CVE-2011-1529.
\* An upcoming release in the krb5-1.8.x series will fix CVE-2011-4151.
\* The patch for krb5-1.9.x is available at
http://web.mit.edu/kerberos/advisories/2011-006-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-006-patch.txt.asc
\* The patch for krb5-1.8.x is available at
http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-006.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2011-1527
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1527
CVE: CVE-2011-1528
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1528
CVE: CVE-2011-1529
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1529
CVE: CVE-2011-4151
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4151
Debian bug #629558:
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=629558
Ubuntu bug #715579:
https://bugs.launchpad.net/ubuntu/+source/krb5/+bug/715579
Red Hat Bug #744125
https://bugzilla.redhat.com/show\_bug.cgi?id=744125
ACKNOWLEDGMENTS
===============
CVE-2011-1527: Nalin Dahyabhai and Andrej Ota independently reported
this vulnerability. Kyle Moffett independently reported this bug to
Debian.
CVE-2011-1528: Mark Deneen reported this vulnerability to Ubuntu.
CONTACT
=======
The MIT Kerberos Team security contact address is
. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/56CD8F76 2010-12-29 [expires: 2012-02-01]
uid MIT Kerberos Team Security Contact
DETAILS
=======
CVE-2011-1527: null pointer dereference in KDC LDAP back end
Under certain error conditions, krb5\_ldap\_get\_principal() in the KDC
LDAP back end can return success yet leave the client principal entry
as a null pointer. Subsequently executed code attempts to dereference
this null pointer.
CVE-2011-1528: assertion failure in KDC LDAP back end
In the KDC LDAP back end in releases krb5-1.8 and later,
krb5\_ldap\_lockout\_audit() calls assert() with an expression that could
be false under as-yet unidentified conditions. There is a report that
the assertion failure occurs in the field, but there is insufficient
information to identify the actual vector. The related vulnerability
in the db2 back end is CVE-2011-4151.
CVE-2011-1529: null pointer dereference in multiple KDC back ends
In releases krb5-1.8 and later, lookup\_lockout\_policy() in both the
Berkeley DB ("db2") and LDAP KDC back ends fails to check that the
principal entry pointer is non-null prior to dereferencing it. This
can happen if an error condition such as KRB5KDC\_ERR\_PREAUTH\_FAILED or
KRB5KRB\_AP\_ERR\_BAD\_INTEGRITY occurs in process\_as\_req() before it
retrieves the principal database entry for the requested client.
CVE-2011-4151: assertion failure in KDC db2 back end
In the KDC Berkeley DB ("db2") back end in releases krb5-1.8 through
krb5-1.8.4, krb5\_db2\_lockout\_audit() calls assert() with an expression
that could be false under as-yet unidentified conditions. The db2
back end no longer has this assertion in releases krb5-1.9 and later,
and is therefore not vulnerable. The related vulnerability in the
LDAP back end is CVE-2011-1528.
REVISION HISTORY
================
2011-10-22 update for CVE-2011-4151 split
2011-10-20 add Red Hat bug reference
2011-10-18 original release
Copyright (C) 2011 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAk6jj84ACgkQSO8fWy4vZo4eZwCcDVRrv3Lygj2FZkg09uXt6X7K
sKIAoIJZzSofw0eCrhI+6UzIRRX1/0mx
=tO0e
-----END PGP SIGNATURE-----


=== Content from www.kb.cert.org_abd6d8fa_20250125_154605.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#659251

## Multiple MIT KRB5 KDC daemon vulnerabilities

#### Vulnerability Note VU#659251

Original Release Date: 2011-10-24 | Last Revised: 2011-10-24

---

### Overview

MIT's KRB5 KDC version 1.8 and 1.9 contain multiple vulnerabilities.

### Description

| The MIT krb5 [Security Advisory 2011-006](http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-006.txt) states:  *CVE-2011-1527: In releases krb5-1.9 and later, the KDC can crash due to a null pointer dereference if configured to use the LDAP back end. A trigger condition is publicly known but not known to be widely circulated.CVE-2011-1528: In releases krb5-1.8 and later, the KDC can crash due to an assertion failure. No exploit is known to exist, but there is public evidence that the unidentified trigger condition occurs in the field.CVE-2011-1529: In releases krb5-1.8 and later, the KDC can crash due to a null pointer dereference. No exploit is known to exist.**CVE-2011-4151: In releases krb5-1.8 through krb5-1.8.4, the KDC can crash due to an assertion failure if configured to use the Berkeley DB ("db2") back end.* |
| --- |

### Impact

| The MIT krb5 [Security Advisory 2011-006](http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-006.txt) states:*CVE-2011-1527: An unauthenticated remote attacker can crash a KDC daemon via null pointer dereference if the KDC is configured to use the LDAP back end. (This is not the default configuration.)CVE-2011-1528: An unauthenticated remote attacker can crash a KDC daemon via assertion failure.CVE-2011-1529: An unauthenticated remote attacker can crash a KDC daemon via null pointer dereference.**CVE-2011-4151: An unauthenticated remote attacker can crash a KDC daemon via assertion failure if the KDC is configured to use the Berkeley DB ("db2") back end.* |
| --- |

### Solution

| The MIT krb5 [Security Advisory 2011-006](http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-006.txt) states:     + *The patch for krb5-1.9.x is available at:* [*http://web.mit.edu/kerberos/advisories/2011-006-patch.txt*](http://web.mit.edu/kerberos/advisories/2011-006-patch.txt)*A PGP-signed patch is available at:* [*http://web.mit.edu/kerberos/advisories/2011-006-patch.txt.asc*](http://web.mit.edu/kerberos/advisories/2011-006-patch.txt.asc) + *The patch for krb5-1.8.x is available at:* [*http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt*](http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt)*A PGP-signed patch is available at:* [*http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt.asc*](http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt.asc) |
| --- |

### Vendor Information

659251
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23659251/) to view vendors.**
### [MIT Kerberos Development Team](#MORO-8MXHPZ) Affected

Updated:  October 24, 2011

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-006.txt>
* <http://web.mit.edu/kerberos/advisories/2011-006-patch.txt>
* <http://web.mit.edu/kerberos/advisories/2011-006-patch.txt.asc>
* <http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt>
* <http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt.asc>

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-006.txt>
* <http://web.mit.edu/kerberos/advisories/2011-006-patch.txt>
* <http://web.mit.edu/kerberos/advisories/2011-006-patch.txt.asc>
* <http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt>
* <http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt.asc>
### Acknowledgements

This document was written by Michael Orlando.

### Other Information

| **CVE IDs:** | [CVE-2011-1527](http://web.nvd.nist.gov/vuln/detail/CVE-2011-1527), [CVE-2011-1528](http://web.nvd.nist.gov/vuln/detail/CVE-2011-1528), [CVE-2011-1529](http://web.nvd.nist.gov/vuln/detail/CVE-2011-1529), [CVE-2011-4151](http://web.nvd.nist.gov/vuln/detail/CVE-2011-4151) |
| --- | --- |
| **Severity Metric:** | 8.29 |
| **Date Public:** | 2011-10-18 |
| **Date First Published:** | 2011-10-24 |
| **Date Last Updated:** | 2011-10-24 13:27 UTC |
| **Document Revision:** | 11 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


