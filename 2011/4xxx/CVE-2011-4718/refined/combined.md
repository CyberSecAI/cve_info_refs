=== Content from github.com_1222dd3b_20250126_120326.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2F82b0e8be99065b61b622df2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2F82b0e8be99065b61b622df2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=php%2Fphp-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[php](/php)
/
**[php-src](/php/php-src)**
Public

* [Notifications](/login?return_to=%2Fphp%2Fphp-src) You must be signed in to change notification settings
* [Fork
  7.8k](/login?return_to=%2Fphp%2Fphp-src)
* [Star
   38.6k](/login?return_to=%2Fphp%2Fphp-src)

* [Code](/php/php-src)
* [Issues
  751](/php/php-src/issues)
* [Pull requests
  568](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

Additional navigation options

* [Code](/php/php-src)
* [Issues](/php/php-src/issues)
* [Pull requests](/php/php-src/pulls)
* [Actions](/php/php-src/actions)
* [Security](/php/php-src/security)
* [Insights](/php/php-src/pulse)

## Commit

[Permalink](/php/php-src/commit/82b0e8be99065b61b622df21bbc7494d2fbca3cd)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Strict session. Detect session id collision

[Browse files](/php/php-src/tree/82b0e8be99065b61b622df21bbc7494d2fbca3cd)
Browse the repository at this point in the history

* Loading branch information

[![@smalyshev](https://avatars.githubusercontent.com/u/155000?s=40&v=4)](/smalyshev)

Yasuo Ohgaki
authored and
[smalyshev](/php/php-src/commits?author=smalyshev "View all commits by smalyshev")
committed
Aug 4, 2013

1 parent
[25e8fcc](/php/php-src/commit/25e8fcc88fa20dc9d4c47184471003f436927cde)

commit 82b0e8b

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**28 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* ext/session

  + ext/session/mod\_files.c
    [mod\_files.c](#diff-c617a93d28a388206a0c96af739269d8c6a6a39fca0b0858e9fac2b3e69e373a)
  + ext/session/mod\_mm.c
    [mod\_mm.c](#diff-3bce553cb25dbbd5f6684fab9702723f0385fdaa0a78955b1b8df2471d3ba41c)

## There are no files selected for viewing

15 changes: 14 additions & 1 deletion

15
[ext/session/mod\_files.c](#diff-c617a93d28a388206a0c96af739269d8c6a6a39fca0b0858e9fac2b3e69e373a "ext/session/mod_files.c")

Show comments

[View file](/php/php-src/blob/82b0e8be99065b61b622df21bbc7494d2fbca3cd/ext/session/mod_files.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -459,9 +459,22 @@ PS\_GC\_FUNC(files) |
|  |  | PS\_CREATE\_SID\_FUNC(files) |
|  |  | { |
|  |  | char \*sid; |
|  |  | int maxfail = 3; |
|  |  | PS\_FILES\_DATA; |
|  |  |  |
|  |  | sid = php\_session\_create\_id((void \*\*)&data, newlen TSRMLS\_CC); |
|  |  | do { |
|  |  | sid = php\_session\_create\_id((void \*\*)&data, newlen TSRMLS\_CC); |
|  |  | /\* Check collision \*/ |
|  |  | if (ps\_files\_key\_exists(data, sid TSRMLS\_CC) == SUCCESS) { |
|  |  | if (sid) { |
|  |  | efree(sid); |
|  |  | sid = NULL; |
|  |  | } |
|  |  | if (!(maxfail--)) { |
|  |  | return NULL; |
|  |  | } |
|  |  | } |
|  |  | } while(!sid); |
|  |  |  |
|  |  | return sid; |
|  |  | } |
| Expand Down | |  |

15 changes: 14 additions & 1 deletion

15
[ext/session/mod\_mm.c](#diff-3bce553cb25dbbd5f6684fab9702723f0385fdaa0a78955b1b8df2471d3ba41c "ext/session/mod_mm.c")

Show comments

[View file](/php/php-src/blob/82b0e8be99065b61b622df21bbc7494d2fbca3cd/ext/session/mod_mm.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -479,9 +479,22 @@ PS\_GC\_FUNC(mm) |
|  |  | PS\_CREATE\_SID\_FUNC(mm) |
|  |  | { |
|  |  | char \*sid; |
|  |  | int maxfail = 3; |
|  |  | PS\_MM\_DATA; |
|  |  |  |
|  |  | sid = php\_session\_create\_id((void \*\*)&data, newlen TSRMLS\_CC); |
|  |  | do { |
|  |  | sid = php\_session\_create\_id((void \*\*)&data, newlen TSRMLS\_CC); |
|  |  | /\* Check collision \*/ |
|  |  | if (ps\_mm\_key\_exists(data, sid TSRMLS\_CC) == SUCCESS) { |
|  |  | if (sid) { |
|  |  | efree(sid); |
|  |  | sid = NULL; |
|  |  | } |
|  |  | if (!(maxfail--)) { |
|  |  | return NULL; |
|  |  | } |
|  |  | } |
|  |  | } while(!sid); |
|  |  |  |
|  |  | return sid; |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `82b0e8b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fphp%2Fphp-src%2Fcommit%2F82b0e8be99065b61b622df2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from wiki.php.net_33454a83_20250126_120327.html ===


[![php](//php.net/images/logo.php?)](/)

* [Login](?do=login)
* [Register](?do=register)

You are here: [start](/start "start") › [rfc](/rfc "rfc") › [strict\_sessions](/rfc/strict_sessions "rfc:strict_sessions")

rfc:strict\_sessions
# Request for Comments: Strict Sessions

* Version: 1.1
* Date: 2011-12-02
* Author: Yasuo Ohgaki yohgaki@ohgaki.net
* Status: Applied to 5.5.2
* First Published at: [https://wiki.php.net/rfc/strict\_sessions](https://wiki.php.net/rfc/strict_sessions "https://wiki.php.net/rfc/strict_sessions")
## Introduction

Session management safety is core of web application security. However, PHP's Session module is known to
vulnerable to session adoption that enables session fixation for years.

When cookie is used for session, current session module does not validate session ID and accepts uninitialized one.
This happens due to nature of web browsers that overrides cookie if multiple cookies are set for a request.
Use of session\_regenerate\_id() **CANNOT** prevent session adoption/fixation.

There is user land solution that validates session data, but this method is not widely adopted. Even if the user
land solution is adopted widely, there are risks that users do not use or users failed to implement it correctly.

Therefore, implementing strict session in PHP core is required for better Web application security.

## Proposed Patch

[https://gist.github.com/1379668](https://gist.github.com/1379668 "https://gist.github.com/1379668")

This patch adds

* validate\_sid() to ps\_modules (Save handlers)
* session.use\_strict\_mode to php.ini (On by default, off for old behavior)
* display that save handler supports strict session or not via phpinfo() (So that user could know behavior)
* update PHP\_SESSION\_API version (So that save handler authors could write portable code)
* warning error for session\_id() when use\_strice\_mode=1

Compatibility issues are

* save handlers that are currently working should also work with this patch, except ps modules using PS\_MOD\_SID and PS\_MOD\_FUNCS\_SID macro. These ps modules should implement validate\_sid(). Modules that are using PS\_MOD/PS\_FUNCS are not affected, they just marked as “adaptive” module. (e.g. pecl sqlite's ps module. You can see it via phpinfo()) NOTE: PS\_MOD\_SID() and PS\_MOD\_FUNCS\_SID() are already defined, but it was the same as PS\_MOD()/PS\_MOD\_FUNCS(). If old ps\_module that uses PS\_MOD\_SID()/PS\_MOD\_FUNCS\_SID() does not compile, implement validate\_id().
* session ID string is checked so that chars are alphanumeric + ',','-' when session.use\_strict\_mode=On. (mod\_file.c checks session ID this way w/o this patch to prevent

problems. Using restrictive session ID string is better for other ps modules. IMHO)

* session read failure is not rescued to eliminate possible infinite loops. Bundled ps modules were not using this at least.

You will see some tests are failing since they depend on adaptive
session. By looking into failing test results, you can see this patch
is generating new session ID if it's not a already initialized
session. I'll modify these tests (set session.use\_strict\_mode=Off) and add
some tests for new feature (new validate\_sid() function for user and
use\_class save handler) after commit.

It removes session read failure retry code from
php\_session\_initialize() . The retry code may cause infinite loop
depending on save handler implementation. Some session save handlers
may be using this to prevent adoption(?), but they should implement
validate\_sid() to prevent adoption from now on. With new code, there
will never be infinite loops. Currently bundled save handlers are not
using this feature.

## Extra feature to be added

This patch eliminates session adoption/fixation, but introduces targeted DoS attack.
To disable DoS, deletion of possible offending cookies is needed.

Deletion method

* When setting new session ID cookie, send empty cookies for all possible path and domain.

Limitation

* If attacker is able to put read only cookie data into browser, DoS is still possible.
* Old browser sent all cookies to server, but recent browsers only send outstanding cookie. Therefore, there is no way to detect if there are malicious cookies or not.
## Compatibility and Limitation

### Limitation

This patch adds validate\_id() function to ps\_modules (session save handler) that can check
if the session ID is already initialized one or not. Bundled ps\_modules are now have validate
function and will never accept uninitialized session ID regardless cookie based or URL rewriter.

However, it is still possible users and ps\_module writers may write improper save handlers, but
it is user's responsibility that writes proper save handler that prevents session adoption.

There are cases that PHP cannot set cookie for sessions. If this happens, targeted DoS is possible.
DoS is much better than stolen session, so users should accept this risk.

### Compatibility

#### Strict Mode

At user land, there will be no compatibility issues by disabling session.use\_strict\_mode. (i.e. session.use\_strict\_mode=0)

When strict mode is enabled, uninitialized session ID will be discarded. Therefore, applications that use adoptive session
nature may not work. If malicious cookie that prevents new session ID is set, session module will keep trying to generate
new session ID and session will not be usable.

#### DoS Prevention

session.safe\_session\_cookie=1 deletes possible malicious cookies that prevent new session ID.
With this option, session modules send empty cookies for all possible domain and path.

This option may cause problems. For instance, when a user is using default session settings
(i.e. using PHPSESSID for session name), it may delete legitimate cookies set by other applications.
For this reason, this setting will be off by default.

#### Module Developers

There may be compatibility problem for internal session modules, if and only if it uses PS\_MOD\_SID()/PS\_MOD\_FUNCS\_SID()
for ps\_module definition.

Module writers may use PHP\_SESSION\_API version ID to write portable ps\_modules.
New ps\_module writers MUST use PS\_MODE\_SID()/PS\_MOD\_FUCS\_SID() to support strict session.

## Background

Session is one of the most important feature to secure Web applications.
However, current PHP session module is weak to session ID adoption, thus it
is weak to session fixation.

### Current Solution

Programmer can make adoptive session with user land code as follows.

Login code fragment: Code that adds session ID as validation key.

```
session_destory();
session_regenerate_id();
$_SESSION['valid_id'] = session_id();
```

Validation code: Code other than login. Check if session is properly initilized.

```
if ($_SESSION['valid_id'] !== session_id()) {
  die('Invalid use of session ID');
}
```

Alternatively, programmers may try to delete all possible cookies by sending empty
session ID cookie.

Users who are using “user” save handlers can use open function to validate session
ID is initialized one. If not, user can use session\_regenerate\_id() to create new ID.

### Reason why the validation key is required

Cookie that is used for session allows multiple cookies for a single request.
When multiple cookies are set, browsers send multiple cookies WITHOUT domain and path
information. Browser just send cookie header and there is no way to know which cookie is for
which domain or path.

In addtion, there are no standards for sending multiple cookies. For example, IE has different
order preference for sending cookies than Chrome/Firefox.

This behavior prevents use of session\_regenerate\_id()'s new cookie in some cases. PHP may
use invalid session ID to initialize session. Session ID can be fixed (i.e. session fixation)
without the validation code.

Session fixation can be used to take over session and compromise Web application security.

### Example Cookie headers

These are cases that adaptive session can be harmful. For all tests, all possible cookies for domain and path are set.

IE8: [http://www.test.co.jp/path1/path2/](http://www.test.co.jp/path1/path2/ "http://www.test.co.jp/path1/path2/")

```
Cookie: C=%2Fwww%2Fdefault%2Fpublic; C=test.co.jp
```

* First cookie(C=%2Fwww%2Fdefault%2Fpublic) is cookie set without domain and the default path '/'.
* Second cookie(C=test.co.jp) is cookie set with domain.
* In this case, PHP initialize $\_COOKIE['C'] == 'test.co.jp'. Session is also initialized with second cookie regardless of cookie set for path.
* Cookies are set for all combinations with different values (domain name and full path dir). (i.e. all domain and path)
* To make this happen, it seems order of setting cookies was significant. Set path first, then domain.

IE9: [http://www.test.co.jp/path1/path2/](http://www.test.co.jp/path1/path2/ "http://www.test.co.jp/path1/path2/")

```
Cookie: C=test.co.jp
```

* It seems MS decided just to send the outstanding cookie for domain and path.
* It still harmful, since most PHP applications just sets path for session cookie.

IE9&Chrome: [http://co.jp/path1/path2/](http://co.jp/path1/path2/ "http://co.jp/path1/path2/")

```
Cookie: C=co.jp
```

* This is a test case for invalid domain. co.jp is ccTLD so browser should not set cookie for it. However, browser seems set cookie if it has IP.
* This is very handy if someone wants to steal him/her colleague session. Just edit hosts and set long life cookie for the domain. It will remain unless cookie is expired or explicitly deleted.

Most obvious case is setting cookie for sub path and “/”. Many applications sets cookie path according to application base directory. Setting cookie to “/” enables session fixation for many applications and installations.

## Acknowledgement

* Original patch was written by Stefan Esser for PHP 5.1. PS\_MOD\_SID()/PS\_MOD\_FUNCS\_SID()/create\_id() feature that has already been implemented is part of Stefan's patch.
* Proposed patch was maintained and modified by Yasuo Ohgaki (I'm not sure but Shuhosin supposed to have the identical patch)
## Related Discussions

* [http://www.mail-archive.com/internals@lists.php.net/msg54147.html](http://www.mail-archive.com/internals%40lists.php.net/msg54147.html "http://www.mail-archive.com/internals@lists.php.net/msg54147.html")
* [http://www.mail-archive.com/internals@lists.php.net/msg54761.html](http://www.mail-archive.com/internals%40lists.php.net/msg54761.html "http://www.mail-archive.com/internals@lists.php.net/msg54761.html")
## Implementation

* [https://github.com/php/php-src/commit/25e8fcc88fa20dc9d4c47184471003f43](https://github.com/php/php-src/commit/25e8fcc88fa20dc9d4c47184471003f43 "https://github.com/php/php-src/commit/25e8fcc88fa20dc9d4c47184471003f43")
* [https://github.com/php/php-src/commit/82b0e8be99065b61b622df2](https://github.com/php/php-src/commit/82b0e8be99065b61b622df2 "https://github.com/php/php-src/commit/82b0e8be99065b61b622df2")
## Other

CVE ID is assigned for this

* CVE-2011-4718

CWE

* [CWE-384: Session Fixation](http://cwe.mitre.org/data/definitions/384.html "http://cwe.mitre.org/data/definitions/384.html")

CAPEC

* [CAPEC-61: Session Fixation](http://capec.mitre.org/data/definitions/61.html "http://capec.mitre.org/data/definitions/61.html")

Bug ID is #60491

* [https://bugs.php.net/bug.php?id=60491](https://bugs.php.net/bug.php?id=60491 "https://bugs.php.net/bug.php?id=60491")
## Changelog

2011-11-23 - 0.1 - just dumping the info from the original mail.

2011-11-24 - 0.2 - Correct “Reason why the validation key is required” description to be more accurate. Browser sends cookies, not cookie headers. Added example cookie headers to illustrate what's the problem.

2011-11-29 - 0.3 - Add DoS prevention.

2011-11-29 - 0.9 - Reorganize sections. Prepare for removing draft status.

2011-11-30 - 1.0 - Remove draft status.

2011-12-02 - 1.1 - Fix description for ps\_module developers. Add session\_id() warning.

2011-12-10 - 1.1 - Added CVE-ID

rfc/strict\_sessions.txt · Last modified: 2017/09/22 13:28 by 127.0.0.1

---

### Page Tools

* [Show pagesource](/rfc/strict_sessions?do=edit "Show pagesource [V]")
* [Old revisions](/rfc/strict_sessions?do=revisions "Old revisions [O]")
* [Backlinks](/rfc/strict_sessions?do=backlink "Backlinks")
* [Back to top](#dokuwiki__top "Back to top [T]")

![](/lib/exe/taskrunner.php?id=rfc%3Astrict_sessions&1737893007)

﻿

### Table of Contents

* [Request for Comments: Strict Sessions](#request_for_commentsstrict_sessions)
  + [Introduction](#introduction)
  + [Proposed Patch](#proposed_patch)
  + [Extra feature to be added](#extra_feature_to_be_added)
  + [Compatibility and Limitation](#compatibility_and_limitation)
    - [Limitation](#limitation)
    - [Compatibility](#compatibility)
  + [Background](#background)
    - [Current Solution](#current_solution)
    - [Reason why the validation key is required](#reason_why_the_validation_key_is_required)
    - [Example Cookie headers](#example_cookie_headers)
  + [Acknowledgement](#acknowledgement)
  + [Related Discussions](#related_discussions)
  + [Implementation](#implementation)
  + [Other](#other)
  + [Changelog](#changelog)

* [Copyright © 2001-2025 The PHP Group](//php.net/copyright)
* [Other PHP.net sites](//php.net/sites)
* [Privacy policy](//php.net/privacy)



=== Content from bugs.php.net_1f23374a_20250125_212340.html ===


| [Bugs](/) | [php.net](https://php.net/) |  [support](https://php.net/support.php) |  [documentation](https://php.net/docs.php) |  [report a bug](report.php) |  [advanced search](search.php) |  [search howto](search-howto.php) |  [statistics](stats.php) |  [random bug](random) |  [login](login.php) |
| --- | --- |
| go to bug id or search bugs for | |

| | [Request](bug.php?id=60491) #60491 | Session module is adoptive | | | | | | --- | --- | --- | --- | --- | --- | | Submitted: | 2011-12-10 00:52 UTC | Modified: | 2015-01-08 06:40 UTC |  | | From: | yohgaki@php.net | Assigned: | [yohgaki](search.php?cmd=display&assign=yohgaki) ([profile](https://people.php.net/yohgaki)) | | Status: | Closed | Package: | [Session related](search.php?cmd=display&package_name[]=Session+related) | | PHP Version: | Irrelevant | OS: | All | | Private report: | No | CVE-ID: | [2011-4718](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4718) |   View [Developer](bug.php?id=60491&edit=1) [Edit](bug.php?id=60491&edit=2)   **[2011-12-10 00:52 UTC] [yohgaki@php.net](//people.php.net/yohgaki)** ``` Description: ------------ Session module is adoptive, so there are chances for session fixation due to  adoption.  CVE ID: CVE-2011-4718  <https://wiki.php.net/rfc/strict_sessions>    ``` PatchesPull RequestsHistoryAllCommentsChangesGit/SVN commitsRelated reports  **[2014-02-12 17:15 UTC] [tyrael@php.net](//people.php.net/tyrael)** -CVE-ID: +CVE-ID: 2011-4718 **[2014-02-12 17:15 UTC] [tyrael@php.net](//people.php.net/tyrael)** ``` this should be closed, as it is fixed since 5.5.2 with the addition of the strict sessions, right?  ``` **[2014-02-25 01:24 UTC] [johannes@php.net](//people.php.net/johannes)** -Assigned To: +Assigned To: yohgaki **[2014-02-25 01:24 UTC] [johannes@php.net](//people.php.net/johannes)** ``` yasuo-san, please confirm this can be closed (and marked public).  ``` **[2014-02-25 05:00 UTC] [yohgaki@php.net](//people.php.net/yohgaki)** -Status: Assigned +Status: Closed **[2014-02-25 05:00 UTC] [yohgaki@php.net](//people.php.net/yohgaki)** ``` This is closed. Use use_strict_mode=on.  ``` **[2014-02-25 10:40 UTC] [johannes@php.net](//people.php.net/johannes)** -Type: Security +Type: Feature/Change Request **[2014-12-30 02:05 UTC] yqbjtu at 163 dot com** ``` is PHP5.4 affected by this CVE-2011-4718?  I see it is fixed in 5.5.2.  but how about the php 5.4 serials, such as the latest php 5.4.36?  Thank you!  ``` **[2015-01-07 00:48 UTC] [yohgaki@php.net](//people.php.net/yohgaki)** ``` For the record, this issue can be avoided by calling session_regenerate_id() properly. e.g. Regenerate session ID upon login/when item is put in cart at first time, etc.   With use_strict_mode=On, programmer does not have to care for adoptive session manager. When use_strict_mode=Off, programmer must care for adoptive session manager.  ``` **[2015-01-08 02:51 UTC] liutj at cn dot ibm dot com** ``` Does it means if we never used the method session_regenerate_id(), our product will not be affected by CVE-2011-4718  ``` **[2015-01-08 06:40 UTC] [yohgaki@php.net](//people.php.net/yohgaki)** ``` ＠liutj  Yes, you are.  If you are using tran_sid, impact is severe. If you are using only cookie, impact is moderate as typical attack needs JavaScript vulnerability. Note that your colleague may able to set cookie locally by manipulating browser's cookie database directly. It does not require JavaScript vulnerability with this method. If you are using http only cookie, risk is relatively low since JavaScript injection cannot modify session cookie. However, IE had strange cookie priority when I checked it years ago. HTTP only cookie may not help with IE.  ``` |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|  | |
| --- | --- |
| [PHP](https://php.net/) [Copyright © 2001-2025 The PHP Group](https://php.net/copyright.php) All rights reserved. | Last updated: Sat Jan 25 21:01:30 2025 UTC |


