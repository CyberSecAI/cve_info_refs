Based on the provided content, here's the breakdown of CVE-2011-4105:

**Root Cause of Vulnerability:**

- The vulnerability stems from LightDM incorrectly handling symbolic links when adjusting permissions on `~/.Xauthority` files.
- Specifically, when `~/.Xauthority` was a symbolic link, LightDM would use `chown` to change the ownership, rather than `lchown`. `chown` changes the ownership of the target of the symlink, not the link itself.

**Weaknesses/Vulnerabilities Present:**

- **Symbolic Link Following:** The core weakness is that LightDM was following the symbolic link and modifying the ownership of the target file instead of the link itself. This allows a malicious local user to point the `~/.Xauthority` symlink to a sensitive file.
- **Incorrect File Ownership Handling:** LightDM used `chown` instead of `lchown` when dealing with `~/.Xauthority`, resulting in changes to the target rather than the link.

**Impact of Exploitation:**

- **Arbitrary File Access/Modification:** By creating a symlink from `~/.Xauthority` to another file, a local attacker could trick LightDM into changing the ownership of that target file to the user that is logging in.
- **Potential Privilege Escalation:** While the Ubuntu USN mentions that default Ubuntu installations would prevent privilege escalation due to Yama link restrictions, the vulnerability still allows for arbitrary file access and modification. If the targeted file was a user configuration, the attacker could gain some unauthorized access or modify existing file content.

**Attack Vectors:**

- **Local Attack:** The attack vector is local, requiring the attacker to have a user account on the system.
- **Symbolic Link Manipulation:** The attacker would need to create a symbolic link at `~/.Xauthority` that points to the target file to exploit the vulnerability.

**Required Attacker Capabilities/Position:**

- A local user account on the target system.
- Ability to create a symbolic link in their home directory.
- Knowledge of the vulnerable behavior of LightDM.

**Additional Notes:**

- The fix for this vulnerability was to use `lchown` instead of `chown` when dealing with `~/.Xauthority`. `lchown` changes the ownership of the symbolic link itself and not its target.
- The Ubuntu Security Notice (USN-1262-1) mentions the vulnerability alongside CVE-2011-3153 and clarifies that the Yama link restrictions can mitigate privilege escalation but not the arbitrary file access.
- The vulnerability affects LightDM versions 1.0.4 and 1.0.5, and users of these versions are advised to upgrade to 1.0.6 or later.