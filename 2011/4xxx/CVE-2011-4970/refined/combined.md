=== Content from site.pi3.com.pl_f483d8cf_20250125_210629.html ===
Name: Multiple SQL Injection vulnerabilities in
Disk Pool Manager (DPM)
Author: Adam Zabrocki ()
Date: November 27, 2009 (Yes, it's very old bug ;P)
Description:
LCG Disk Pool Manager (DPM) has been developed as part of the LCG
project to provide a light-weight implementation of an SRM compliant
Storage Element (SE). Since gLite 3.0 it is a standard gLite component,
distributed and maintained as part of the gLite release. It has been
developed at European Organization for Nuclear Research (CERN).
DPM is a disk only SE, instead of a disk + MSS implementation like
dCache or Castor. It may act as a replacement for the deprecated classic
SE with the following advantages :
- SRM interface (both v1.1 and v2.2)
- Better scalability : DPM is allow to manage 100+ TB distributing the
load over several servers
- High performances
- Light-weight management
DPM is commonly used in most of the GRID projects including CERN WLCG,
EGEE, ..., etc.
Details:
A multiple SQL Injection vulnerability has been found in Disk Pool
Manager (DPM). Please read following details:
"./srmv2.2/srmv2\_xferreq.c"
int
ns1\_\_srmGetRequestSummary (struct soap \*soap,
struct ns1\_\_srmGetRequestSummaryRequest \*req,
struct ns1\_\_srmGetRequestSummaryResponse\_ \*rep)
{
...
char \*r\_token;
...
...
...
for (i = 0; i < nbtokens; i++) {
...
r\_token = req->arrayOfRequestTokens->stringArray[i];
if (strlen (r\_token) > CA\_MAXDPMTOKENLEN) {
reptokenp->status->statusCode =
SRM\_USCOREINVALID\_USCOREREQUEST;
reptokenp->status->explanation =
soap\_strdup (soap, "Invalid request token");
nb\_errors++;
continue;
}
if (dpm\_getonereqsummary (thip, r\_token, &r\_type, &r\_status,
&nbreqfiles, &nb\_queued, &nb\_progress, &nb\_failed) < 0) {
...
...
}
...
...
}
...
...
}
This function is responsible fo reading and parsing requests. If length of "r\_token"
variable is not greather than CA\_MAXDPMTOKENLEN function dpm\_getonereqsummary() is called:
"dpm/dpm\_procsubr.c"
dpm\_getonereqsummary (thip, r\_token, r\_type, r\_status, nbreqfiles,
nb\_queued, nb\_progress, nb\_failed)
struct dpm\_srv\_thread\_info \*thip;
char \*r\_token;
char \*r\_type;
int \*r\_status;
int \*nbreqfiles;
int \*nb\_queued;
int \*nb\_progress;
int \*nb\_failed;
{
...
...
if (dpm\_get\_pending\_req\_by\_token (&thip->dbfd, r\_token, &dpm\_req, 0, NULL) < 0 &&
dpm\_get\_req\_by\_token (&thip->dbfd, r\_token, &dpm\_req, 0, NULL) < 0)
return (-1);
...
...
}
... and:
"dpm/dpm\_mysql\_ifce.c"
dpm\_get\_pending\_req\_by\_token(dbfd, r\_token, dpm\_req, lock, rec\_addr)
struct dpm\_dbfd \*dbfd;
char \*r\_token;
struct dpm\_req \*dpm\_req;
int lock;
dpm\_dbrec\_addr \*rec\_addr;
{
char func[29];
static char query[] =
"SELECT \
R\_ORDINAL, R\_TOKEN, R\_UID, \
R\_GID, CLIENT\_DN, CLIENTHOST, \
R\_TYPE, U\_TOKEN, \
FLAGS, RETRYTIME, NBREQFILES, \
CTIME, STIME, ETIME, \
STATUS, ERRSTRING, GROUPS \
FROM dpm\_pending\_req \
WHERE r\_token = '%s'";
static char query4upd[] =
"SELECT ROWID, \
R\_ORDINAL, R\_TOKEN, R\_UID, \
R\_GID, CLIENT\_DN, CLIENTHOST, \
R\_TYPE, U\_TOKEN, \
FLAGS, RETRYTIME, NBREQFILES, \
CTIME, STIME, ETIME, \
STATUS, ERRSTRING, GROUPS \
FROM dpm\_pending\_req \
WHERE r\_token = '%s' \
FOR UPDATE";
MYSQL\_RES \*res;
MYSQL\_ROW row;
char sql\_stmt[1024];
MYSQL\_RES \*res;
MYSQL\_ROW row;
char sql\_stmt[1024];
strcpy (func, "dpm\_get\_pending\_req\_by\_token");
sprintf (sql\_stmt, lock ? query4upd : query, r\_token);
if (dpm\_exec\_query (func, dbfd, sql\_stmt, &res))
return (-1);
...
...
}
This function creates a query to the MySQL Database - DPM supports three
different databases: MySQL, PostgreSQL and Oracle. In this advisory
I'm focused on MySQL database. This vulnerability may be in all
supported databases. I haven't analyzed all the code.
Variable 'r\_token' isn't verified at all so SQL Injection attack is
possible. Anyone with a certificate from a recognised CA can access
the SRM interface so it is a serious vulnerability.
SQL Injection exists not only in dpm\_get\_pending\_req\_by\_token() function.
Please read following list of functions which don't check inputs too:
Function dpm\_get\_cpr\_by\_fullid() doesn't check 'r\_token'
Function dpm\_get\_cpr\_by\_surl() doesn't check 'r\_token', 'surl'
Function dpm\_get\_cpr\_by\_surls() doesn't check 'r\_token', 'to\_surl'
Function dpm\_get\_gfr\_by\_fullid() doesn't check 'r\_token'
Function dpm\_get\_gfr\_by\_surl() doesn't check 'r\_token'
Function dpm\_get\_pending\_req\_by\_token() doesn't check 'r\_token'
Function dpm\_get\_pending\_reqs\_by\_u\_desc() doesn't check 'u\_token'
Function dpm\_get\_pfr\_by\_fullid() doesn't check 'r\_token'
Function dpm\_get\_pfr\_by\_surl() doesn't check 'r\_token'
Function dpm\_get\_pool\_entry() doesn't check 'poolname' variable but
admin required so it isn't important.
Function dpm\_get\_req\_by\_token() doesn't check 'r\_token'
Function dpm\_get\_reqs\_by\_u\_desc() doesn't check 'u\_token'
Function dpm\_get\_spcmd\_by\_token() doesn't check 's\_token'
Function dpm\_get\_spcmd\_by\_u\_desc() doesn't check 'u\_token'
Function dpm\_insert\_cpr\_entry() doesn't check variable 's\_token',
'r\_token'.
Function dpm\_insert\_fs\_entry() doesn't check 'poolname' variable but
admin required so it isn't important.
Function dpm\_insert\_gfr\_entry() doesn't check variable 's\_token',
'r\_token'.
Function dpm\_insert\_pending\_entry() doesn't check variable 'u\_token',
'r\_token'.
Function dpm\_insert\_pfr\_entry() doesn't check variable 's\_token',
'r\_token'.
Function dpm\_insert\_pool\_entry() doesn't check 'poolname' variable but
admin required so it isn't important.
Function dpm\_insert\_spcmd\_entry() doesn't check variable 's\_token',
'u\_token' and (not important)
'poolname' - admin required.
Functino dpm\_insert\_xferreq\_entry() doesn't check variable 'u\_token',
'r\_token'.
Function dpm\_list\_cpr\_entry() doesn't check 'r\_token'
Functino dpm\_list\_fs\_entry() doesn't check 'poolname' variable but
admin required so it isn't important.
Function dpm\_list\_gfr\_entry() doesn't check 'r\_token'
Function dpm\_list\_pfr\_entry() doesn't check 'r\_token'
Function dpm\_update\_cpr\_entry() doesn't check 's\_token'
Function dpm\_update\_gfr\_entry() doesn't check 's\_token'
Function dpm\_update\_pfr\_entry() doesn't check 's\_token'
Function dpm\_update\_spcmd\_entry() doesn't check 'poolname' variable but
admin required so it isn't important.
Proof of concept
$ ./srm2\_testGetRequestStatus srm://vmgdda0013.cern.ch:8446/ \'
request status SRM\_FAILURE
request state 1
explanation: Failed for all tokens
request summaryArray 1
======= Begin Request ========
Request token: '
state[0]: 14 SRM\_INTERNAL\_ERROR
$
Please read following dump of SRM log file:
07/23 18:01:50.330 9720,0 dpm\_get\_pending\_req\_by\_token: mysql\_query
error: You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use
near ''''' at line 1
07/23 18:01:50.330 9720,0 dpm\_get\_req\_by\_token: mysql\_query error: You
have an error in your SQL syntax; check the manual that corresponds to
your MySQL server version for the right syntax to use near ''''' at line
1
07/23 18:01:50.330 9720,0 GetRequestSummary: returns 0,
statusCode=SRM\_FAILURE
Here is strace output from the SRMv2.2 process:
poll([{fd=7, events=POLLIN|POLLPRI}], 1, 0) = 0 (Timeout)
write(7, "\335\0\0\0\3SELECT \t\t R\_ORDINAL, R\_TOKEN, R\_UID, \t\t R\_GID,
CLIENT\_DN, CLIENTHOST, \t\t R\_TYPE, U\_TOKEN, \t\t FLAGS, RETRYTIME,
NBREQFILES, \t\t CTIME, STIME, ETIME, \t\t STATUS, ERRSTRING, GROUPS
\t\tFROM dpm\_pending\_req \t\tWHERE r\_token = '''", 225) = 225
read(7, "\236\0\0\1\377(\4#42000You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server version for the
right syntax to use near ''''' at line 1", 16384) = 162
gettimeofday({1311434508, 295920}, NULL) = 0
open("/var/log/srmv2.2/log", O\_WRONLY|O\_CREAT|O\_APPEND, 0664) = 8
write(8, "07/23 17:21:48.295 9720,0 dpm\_get\_pending\_req\_by\_token:
mysql\_query error: You have an error in your SQL syntax; check the
manual that corresponds to your MySQL server version for the right
syntax to use near ''''' at line 1\n", 226) = 226
close(8) = 0
poll([{fd=7, events=POLLIN|POLLPRI}], 1, 0) = 0 (Timeout)
write(7, "\325\0\0\0\3SELECT \t\t R\_ORDINAL, R\_TOKEN, R\_UID, \t\t R\_GID,
CLIENT\_DN, CLIENTHOST, \t\t R\_TYPE, U\_TOKEN, \t\t FLAGS, RETRYTIME,
NBREQFILES, \t\t CTIME, STIME, ETIME, \t\t STATUS, ERRSTRING, GROUPS
\t\tFROM dpm\_req \t\tWHERE r\_token = '''", 217) = 217
read(7, "\236\0\0\1\377(\4#42000You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server version for the
right syntax to use near ''''' at line 1", 16384) = 162
gettimeofday({1311434508, 296597}, NULL) = 0
open("/var/log/srmv2.2/log", O\_WRONLY|O\_CREAT|O\_APPEND, 0664) = 8
write(8, "07/23 17:21:48.296 9720,0 dpm\_get\_req\_by\_token: mysql\_query
error: You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use
nea r ''''' at line 1\n", 218) = 218
close(8) = 0
gettimeofday({1311434508, 296942}, NULL) = 0
open("/var/log/srmv2.2/log", O\_WRONLY|O\_CREAT|O\_APPEND, 0664) = 8
write(8, "07/23 17:21:48.296 9720,0 GetRequestSummary: returns 0,
statusCode=SRM\_FAILURE\n", 80) = 80
close(8) = 0
And here is strace from the MySQL process:
read(31, "\3SELECT \t\t R\_ORDINAL, R\_TOKEN, R\_UID, \t\t R\_GID, CLIENT\_DN
, CLIENTHOST, \t\t R\_TYPE, U\_TOKEN, \t\t FLAGS, RETRYTIME, NBREQFILES,
\t\t CTIME, STIME, ETIME, \t\t STATUS, ERRSTRING, GROUPS \t\tFROM
dpm\_pending\_req \t\tWHERE r\_token = '''", 221) = 221
rt\_sigprocmask(SIG\_BLOCK, ~[RTMIN RT\_1], [HUP INT QUIT PIPE ALRM TERM
TSTP], 8) = 0
rt\_sigprocmask(SIG\_SETMASK, [HUP INT QUIT PIPE ALRM TERM TSTP], NULL, 8)
= 0
fcntl(31, F\_SETFL, O\_RDWR|O\_NONBLOCK) = 0
time([1311436910]) = 1311436910
sched\_setscheduler(15280, SCHED\_OTHER, { 6 }) = -1 EINVAL (Invalid
argument)
sched\_setscheduler(15280, SCHED\_OTHER, { 8 }) = -1 EINVAL (Invalid
argument)
write(31, "\236\0\0\1\377(\4#42000You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server version for the
right syntax to use near ''''' at line 1", 162) = 162
time([1311436910]) = 1311436910
read(31, 0x1f7ae9b0, 4) = -1 EAGAIN (Resource
temporarily unavailable)
time(NULL) = 1311436910
rt\_sigprocmask(SIG\_BLOCK, ~[RTMIN RT\_1], [HUP INT QUIT PIPE ALRM TERM
TSTP], 8) = 0
rt\_sigprocmask(SIG\_SETMASK, [HUP INT QUIT PIPE ALRM TERM TSTP], NULL, 8)
= 0
fcntl(31, F\_SETFL, O\_RDWR) = 0
read(31, "\325\0\0\0", 4) = 4
read(31, "\3SELECT \t\t R\_ORDINAL, R\_TOKEN, R\_UID, \t\t R\_GID, CLIENT\_DN
, CLIENTHOST, \t\t R\_TYPE, U\_TOKEN, \t\t FLAGS, RETRYTIME, NBREQFILES,
\t\t CTIME, STIME, ETIME, \t\t STATUS, ERRSTRING, GROUPS \t\tFROM
dpm\_req \t\tWHERE r\_token = '''", 213) = 213
rt\_sigprocmask(SIG\_BLOCK, ~[RTMIN RT\_1], [HUP INT QUIT PIPE ALRM TERM
TSTP], 8) = 0
rt\_sigprocmask(SIG\_SETMASK, [HUP INT QUIT PIPE ALRM TERM TSTP], NULL, 8)
= 0
fcntl(31, F\_SETFL, O\_RDWR|O\_NONBLOCK) = 0
time([1311436910]) = 1311436910
sched\_setscheduler(15280, SCHED\_OTHER, { 6 }) = -1 EINVAL (Invalid
argument)
sched\_setscheduler(15280, SCHED\_OTHER, { 8 }) = -1 EINVAL (Invalid
argument)
write(31, "\236\0\0\1\377(\4#42000You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server version for the
right syntax to use near ''''' at line 1", 162) = 162
time([1311436910]) = 1311436910
read(31, 0x1f7ae9b0, 4) = -1 EAGAIN (Resource
temporarily unavailable)
Affected Software:
All versions of Disk Pool Manager (DPM) below 1.8.6 version are affected.
1.8.6 was released 19th of February 2013.
Greets
+) David Smith - for testing infrastructures and other helps not only
at this topic.
References
1) https://wiki.egi.eu/wiki/SVG:Advisory-SVG-2012-2683
2) http://site.pi3.com.pl/adv/disk\_pool\_manager\_1.txt
3) http://blog.pi3.com.pl/?p=402
Timeline
2009-11-27 - Found vulnerability.
2011-08-03 - Vulnerability officialy reported.
2013-02-19 - Updated packages available in the EGI UMD-1 and EGI UMD-2.
2013-03-05 - Public disclosure on vendor's wiki, after allowing sites to
upgrade (https://wiki.egi.eu/wiki/SVG:Advisory-SVG-2012-2683)
2013-03-10 - Release of this advisory.
Best regards,
Adam Zabrocki
--
http://pi3.com.pl


=== Content from wiki.egi.eu_6623f36a_20250125_210630.html ===


[Log in](https://confluence.egi.eu/login.action?os_destination=%2F)
Linked ApplicationsLoading...[![EGI Confluence](/download/attachments/327682/atl.site.logo?version=3&modificationDate=1724227284562&api=v2)EGI Confluence](/)

* [Spaces](/spacedirectory/view.action "Spaces")

* Hit enter to search
* Help
  + [Online Help](https://docs.atlassian.com/confluence/docs-89/ "Visit the Confluence documentation home")
  + Keyboard Shortcuts
  + [Feed Builder](/dashboard/configurerssfeed.action "Create your custom RSS feed.")
  + [What‚Äôs new](https://confluence.atlassian.com/display/DOC/Confluence%2B8.9%2BRelease%2BNotes)
  + Available Gadgets
  + [About Confluence](/aboutconfluencepage.action "Get more information about Confluence")
* * [Log in](/login.action?os_destination=%2F)

[![EGI](/download/attachments/327685/EGI?version=1&modificationDate=1453803708912&api=v2)](/display/EGI/Welcome%2Bto%2BEGI%2Bcollaboration%2Bspace "EGI")[EGI](/display/EGI/Welcome%2Bto%2BEGI%2Bcollaboration%2Bspace "EGI")Edit space details

* [Pages](/collector/pages.action?key=EGI)
## Page tree

Browse pagesConfigureSpace tools

* + [Attachments (2)](/pages/viewpageattachments.action?pageId=327684 "View Attachments")
  + [Page History](/pages/viewpreviousversions.action?pageId=327684)
  + [Page Information](/pages/viewinfo.action?pageId=327684)
  + Resolved comments
  + [View in Hierarchy](/pages/reorderpages.action?key=EGI&openId=327684#selectedPageInHierarchy)
  + [View Source](/plugins/viewsource/viewpagesrc.action?pageId=327684)
  + [Export to PDF](/spaces/flyingpdf/pdfpageexport.action?pageId=327684&atl_token=cc900b4046cb54b62d5296b8fe12407af68e5303)
  + [Export to Word](/exportword?pageId=327684)

1. [Pages](/collector/pages.action?key=EGI)

* Jira links
# [Welcome to EGI collaboration space](/display/EGI/Welcome%2Bto%2BEGI%2Bcollaboration%2Bspace)

* Created by  Anonymous, last modified by  [Malgorzata Krakowian](/display/~krakow) on [2024 Aug 30](/pages/diffpagesbyversion.action?pageId=327684&selectedPageVersions=57&selectedPageVersions=58 "Show changes")

# EGI collaborative documentation

This service is part of [EGI Collaboration tools service](https://www.egi.eu/internal-services/collaboration-tools/) provided to facilitate access to existing knowledge, easy distribution of communication to interested parties and for easy management of community and projects.

This wiki service hosts various spaces, for collaborative edition of public and private documentation, relating to many different topics, as documented below. Content has been migrated and aggregated from various places, including the former MediaWiki.

Important

Documentation for users and service providers covering the **setup and usage of EGI services** is available at <https://docs.egi.eu>.Should you need any support for this server, you can contact¬†EGI IT Support.
## EGI Federation public spaces

* [EGI Policies and Procedures](/display/EGIPP)
* [EGI Boards and Groups](/display/EGIBG)
* [EGI Glossary](/display/EGIG/EGI%2BGlossary%2BHome)

## EGI restricted spaces

* EGI Integrated Management System (IMS) - access restricted to EGI Foundation
  + Owner: [Damla Rowlandson](/display/~damla)
* [EGI Executive Board - Confidential Home](/pages/viewpage.action?pageId=136086318) - EGI Executive Board (access restricted to Executive Board)
  + Owner: [Tiziana Ferrari](/display/~tferrari)
* [EGI Council - Confidential - Home](/pages/viewpage.action?pageId=2654234) - EGI Council¬† (access restricted to EGI Council)
  + Owner:¬†[Tiziana Ferrari](/display/~tferrari)
* [EGI Strategic and Innovation Fund](/pages/viewpage.action?pageId=18973632) -¬†(Access restricted to EGI Foundation, EGI Council and EGI Executive board)
  + Owner:¬†[Sergio Andreozzi](/display/~sergio)
* [EGI SVG](/pages/viewpage.action?pageId=37456961) - Software vulnerabilities group space (Access restricted to SVG members)
  + Owner: [Linda Cornwall](/display/~cornwall)
* [EGI Federating Core Bidding](/pages/viewpage.action?pageId=52595659) - Space collects all the calls that EGI opened for the NGIs to find providers for certain capabilities (Access restricted to EGI Foundation and bidding partners)
  + Owner:¬†[Matthew Viljoen](/display/~mviljoen)
* EGIE - Space shared with EGI Community Managers and User Community representatives
  + Owner:¬†[Giuseppe La Rocca](/display/~larocca)

## Project spaces

### iMagine

* IMP - iMagine project collaboration space

### interTwin

* [interTwin](/pages/viewpage.action?pageId=132188984) ¬†- interTwin project collaboration space
  + **Access:**

    To get access to internal pages, please create an EGI SSO account¬†<https://www.egi.eu/sso>,¬†and contact¬†interTwin-po@mailman.egi.eu,¬†providing your login, with WP leader in CC

### ENVRI-Hub Next

* ENVRIHUBNEXT
  + **Access:**

    To get access to internal pages, please create an EGI SSO account¬†<https://www.egi.eu/sso>,¬†and contact¬†envri-hub-next-po@mailman.egi.eu,¬†providing your login, with WP leader in CC

### EOSC Beyond

* EOSCBeyond
  + **Access:**

    To get access to internal pages, please create an EGI SSO account¬†<https://www.egi.eu/sso>,¬†and contact¬†eosc-beyond-po@mailman.egi.eu,¬†providing your login, with WP leader in CC

### Spectrum

* SPECTRUM
  + **Access:**

    To get access to internal pages, please create an EGI SSO account¬†<https://www.egi.eu/sso>,¬†and contact¬†spectrum-po@mailman.egi.eu,¬†providing your login, with WP leader in CC

## Archived projects spaces

### **EGI-ACE**

* [EGI-ACE](/pages/viewpage.action?pageId=78318997)¬† - EGI-ACE project collaboration space

* No labels

Overview
Content Tools

Powered by a free **Atlassian Confluence Community License** granted to Stichting EGI. [Evaluate Confluence today](https://www.atlassian.com/software/views/community-license-request).

* Powered by [Atlassian Confluence](https://www.atlassian.com/software/confluence) 8.9.8
* Printed by Atlassian Confluence 8.9.8
* [Report a bug](https://support.atlassian.com/confluence-server/)
* [Atlassian News](https://www.atlassian.com/company)

[Atlassian](https://www.atlassian.com/)

{"serverDuration": 75, "requestCorrelationId": "f225c5e973dba7f9"}


=== Content from blog.pi3.com.pl_43b6199a_20250125_210628.html ===


# pi3 blog

bug bugs bughunt exploit exploiting research vulnerabilities

* [Home](http://blog.pi3.com.pl/ "A link to home page")
* [About](http://blog.pi3.com.pl/?page_id=2)

‚ÄúHe who fights with monsters should be careful lest he thereby become a
monster. And if thou gaze long into an abyss, the abyss will also gaze into thee.‚Äù

~Friedrich Nietzsche

* Subscribe

  [![rss](http://blog.pi3.com.pl/wp-content/themes/gods-and-monsters/images/rss.png)](http://blog.pi3.com.pl/?feed=rss2)

Search

* ## Categories

  + [Bughunt](http://blog.pi3.com.pl/?cat=4) (28)
  + [Exploiting](http://blog.pi3.com.pl/?cat=5) (36)
  + [Ideas](http://blog.pi3.com.pl/?cat=6) (28)
  + [LKRG](http://blog.pi3.com.pl/?cat=7) (10)
  + [Meeting](http://blog.pi3.com.pl/?cat=3) (6)
  + [O wszystkim i o niczym](http://blog.pi3.com.pl/?cat=1) (34)
* ## Recent Posts

  + [RISC-V: Vice Chair of the J-extension Task Group](http://blog.pi3.com.pl/?p=1008)
  + [CVE-2023-34367](http://blog.pi3.com.pl/?p=1003)
  + [Bug bounties are broken ‚Äì the story of ‚Äúi915‚Äù bug, ChromeOS + Intel bounty programs, and beyond](http://blog.pi3.com.pl/?p=931)
  + [My talks @ BlackHat 2021 and DefCon29](http://blog.pi3.com.pl/?p=894)
  + [LKRG 0.9.0 has been released!](http://blog.pi3.com.pl/?p=890)
* ## Archives

  + [November 2023](http://blog.pi3.com.pl/?m=202311)
  + [June 2023](http://blog.pi3.com.pl/?m=202306)
  + [May 2023](http://blog.pi3.com.pl/?m=202305)
  + [July 2021](http://blog.pi3.com.pl/?m=202107)
  + [April 2021](http://blog.pi3.com.pl/?m=202104)
  + [January 2021](http://blog.pi3.com.pl/?m=202101)
  + [December 2020](http://blog.pi3.com.pl/?m=202012)
  + [October 2020](http://blog.pi3.com.pl/?m=202010)
  + [September 2020](http://blog.pi3.com.pl/?m=202009)
  + [June 2020](http://blog.pi3.com.pl/?m=202006)
  + [May 2020](http://blog.pi3.com.pl/?m=202005)
  + [March 2020](http://blog.pi3.com.pl/?m=202003)
  + [October 2019](http://blog.pi3.com.pl/?m=201910)
  + [July 2019](http://blog.pi3.com.pl/?m=201907)
  + [May 2019](http://blog.pi3.com.pl/?m=201905)
  + [April 2019](http://blog.pi3.com.pl/?m=201904)
  + [February 2019](http://blog.pi3.com.pl/?m=201902)
  + [August 2018](http://blog.pi3.com.pl/?m=201808)
  + [July 2018](http://blog.pi3.com.pl/?m=201807)
  + [March 2018](http://blog.pi3.com.pl/?m=201803)
  + [February 2018](http://blog.pi3.com.pl/?m=201802)
  + [January 2018](http://blog.pi3.com.pl/?m=201801)
  + [April 2017](http://blog.pi3.com.pl/?m=201704)
  + [September 2016](http://blog.pi3.com.pl/?m=201609)
  + [July 2015](http://blog.pi3.com.pl/?m=201507)
  + [February 2015](http://blog.pi3.com.pl/?m=201502)
  + [March 2014](http://blog.pi3.com.pl/?m=201403)
  + [August 2013](http://blog.pi3.com.pl/?m=201308)
  + [July 2013](http://blog.pi3.com.pl/?m=201307)
  + [May 2013](http://blog.pi3.com.pl/?m=201305)
  + [April 2013](http://blog.pi3.com.pl/?m=201304)
  + [March 2013](http://blog.pi3.com.pl/?m=201303)
  + [February 2013](http://blog.pi3.com.pl/?m=201302)
  + [October 2012](http://blog.pi3.com.pl/?m=201210)
  + [May 2012](http://blog.pi3.com.pl/?m=201205)
  + [April 2012](http://blog.pi3.com.pl/?m=201204)
  + [December 2011](http://blog.pi3.com.pl/?m=201112)
  + [September 2011](http://blog.pi3.com.pl/?m=201109)
  + [August 2011](http://blog.pi3.com.pl/?m=201108)
  + [July 2011](http://blog.pi3.com.pl/?m=201107)
  + [March 2011](http://blog.pi3.com.pl/?m=201103)
  + [November 2010](http://blog.pi3.com.pl/?m=201011)
  + [October 2010](http://blog.pi3.com.pl/?m=201010)
  + [July 2010](http://blog.pi3.com.pl/?m=201007)
  + [May 2010](http://blog.pi3.com.pl/?m=201005)
  + [March 2010](http://blog.pi3.com.pl/?m=201003)
  + [February 2010](http://blog.pi3.com.pl/?m=201002)
  + [January 2010](http://blog.pi3.com.pl/?m=201001)
  + [December 2009](http://blog.pi3.com.pl/?m=200912)
  + [November 2009](http://blog.pi3.com.pl/?m=200911)
  + [October 2009](http://blog.pi3.com.pl/?m=200910)
  + [September 2009](http://blog.pi3.com.pl/?m=200909)
* ## Friends

  + [Bothunters ‚Äì Borys ≈ÅƒÖcki](http://bothunters.pl)
  + [Gynvael Coldwind](http://gynvael.coldwind.pl)
  + [Icewall](http://www.icewall.pl)
  + [j00ru](http://j00ru.vexillium.org)
  + [Piotr Bania](http://piotrbania.com/)
* ## Pages

  + [About](http://blog.pi3.com.pl/?page_id=2)

10

Mar

# [Multiple SQL Injection vulnerabilities in Disk Pool Manager (DPM)](http://blog.pi3.com.pl/?p=402)

by pi3

In the second half of 2009 I was working in European Organization for Nuclear Research (CERN). For some time I was part of GRID development team. One of our product was/is DPM server. What is DPM? LCG Disk Pool Manager (DPM) has been developed as part of the LCG project to provide a light-weight implementation of an SRM compliant Storage Element (SE). Since gLite 3.0 it is a standard gLite component, distributed and maintained as part of the gLite release.

DPM is a disk only SE, instead of a disk + MSS implementation like dCache or Castor. It may act as a replacement for the deprecated classic SE with the following advantages :

* SRM interface (both v1.1 and v2.2)
* Better scalability : DPM is allow to manage 100+ TB distributing the load over several servers
* High performances
* Light-weight management

Not everyone is familiar with GRID technology and terms used in their community. If you want to get more knowledge please navigate to the following resources [here](https://www.gridpp.ac.uk/wiki/Disk_Pool_Manager) and also [here](http://en.wikipedia.org/wiki/GLite).

At this time I found serious multiple SQL Injection vulnerabilities in this specific software. I wrote extra layer of protection for DPM which secure software from any similar attack and this layer was responsible for doing extra security checks. Unfortunately because of our internal reorganization patch wasn‚Äôt integrated with official release of DPM.

On March 2013 (2013-03-05) SVG team ([The EGI Software Vulnerability Group (SVG)](https://wiki.egi.eu/wiki/SVG)) published official advisory about my vulnerabilities and of course DPM software is now secured üôÇ

In the following list you can find related references:

1. My official advisory is available [here](http://site.pi3.com.pl/adv/disk_pool_manager_1.txt).
2. SVG official advisory is available [here](https://wiki.egi.eu/wiki/SVG%3AAdvisory-SVG-2012-2683).
3. This blog post is available [here](http://blog.pi3.com.pl/?p=402) üôÇ

I would like to thanks David Smith whose allowed me to work on DPM and provided necessary infrastructure and knowledge not only at this topic üôÇ

Best regards,

Adam

Filed Under [O wszystkim i o niczym](http://blog.pi3.com.pl/?cat=1)

Comments

1. ![](http://0.gravatar.com/avatar/915b241235a5bddf902357d255b669d0?s=48&d=mm&r=g)

   Jakub on
   03.11.2013

   No bez kitu dobry tajmlajn üòâ
2. ![](http://2.gravatar.com/avatar/8e99683ba802047c37dcd601a6f36f84?s=48&d=mm&r=g)

   [admin](http://pi3.com.pl) on
   03.11.2013

   @Jakub: Hehe‚Ä¶ nie da sie ukryc üòâ
3. ![](http://0.gravatar.com/avatar/6b717aa59aa0b29b75517f11af1145c3?s=48&d=mm&r=g)

   Uthay Suthakar on
   10.08.2013

   Hello Adam,

   That‚Äôs indeed a great discovery and congratulations! I‚Äôm trying create a network with people who have dealt with DPM, in order to get more clear picture of the project. I would like to discuss with you about the DPM and my research. Please get in touch with me via email.

   Many thanks.

   Kind regards,

   Uthay.
4. ![](http://2.gravatar.com/avatar/8e99683ba802047c37dcd601a6f36f84?s=48&d=mm&r=g)

   [pi3](http://pi3.com.pl) on
   10.09.2013

   Unfortunately I do not play anymore with DPM. Please ping official DPM support list‚Ä¶
5. ![](http://0.gravatar.com/avatar/6b717aa59aa0b29b75517f11af1145c3?s=48&d=mm&r=g)

   US on
   10.09.2013

   Many thanks for your prompt response. I‚Äôll try to get in touch with the Support team. I just have a quick question, Is there any way we could change the config of DPM to listen to a different databse, for example from MySQL to PostgreSQL, on the fly? I couldn‚Äôt see any config would do that but I just wanted to confirm with you, please only respond if you remember.

   Many thanks
6. ![](http://2.gravatar.com/avatar/8e99683ba802047c37dcd601a6f36f84?s=48&d=mm&r=g)

   [pi3](http://pi3.com.pl) on
   10.10.2013

   DPM supports MySQL, PostgreSQL and Oracle as well. You should have enabled (compiled) these functionality if you want to use it and then play with config. Supporting list contacts you can find here:

   <https://twiki.cern.ch/twiki/bin/view/LCG/SupportContacts>
7. ![](http://0.gravatar.com/avatar/6b717aa59aa0b29b75517f11af1145c3?s=48&d=mm&r=g)

   US on
   10.10.2013

   Many thanks Adam for your swift replies.

Leave a Reply

Name (Required)

Email Address (Required)

Website

Œî

CAPTCHA \*
Time limit is exhausted. Please reload the CAPTCHA.
¬†‚àí
![image](data:image/png;base64...)
¬†=
0

Copyright ¬© 2025 [pi3 blog](http://blog.pi3.com.pl).

[Gods & Monsters](http://www.arsgrafik.com/) Theme | Powered by [WordPress](http://wordpress.org/)



=== Content from www.openwall.com_6c99d968_20250125_210629.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2013/03/09/1) [[next>]](2) [[thread-next>]](../../../2013/03/12/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1362899838.4508.9.camel@pi3-darkstar>
Date: Sun, 10 Mar 2013 08:17:17 +0100
From: Adam Zabrocki <pi3@....com.pl>
To: full-disclosure@...ts.grok.org.uk, oss-security@...ts.openwall.com
Cc: secalert <secalert@...urityreason.pl>
Subject: Multiple SQL Injection vulnerabilities in Disk Pool Manager (DPM)

Name:                 Multiple SQL Injection vulnerabilities in
                      Disk Pool Manager (DPM)
Author:               Adam Zabrocki (<pi3@....com.pl>)
Date:                 November 27, 2009 (Yes, it's very old bug ;P)

   Description:

        LCG Disk Pool Manager (DPM) has been developed as part of the
LCG
project to provide a light-weight implementation of an SRM compliant
Storage Element (SE). Since gLite 3.0 it is a standard gLite component,
distributed and maintained as part of the gLite release. It has been
developed at European Organization for Nuclear Research (CERN).

DPM is a disk only SE, instead of a disk + MSS implementation like
dCache or Castor. It may act as a replacement for the deprecated classic
SE with the following advantages :

- SRM interface (both v1.1 and v2.2)
- Better scalability : DPM is allow to manage 100+ TB distributing the
  load over several servers
- High performances
- Light-weight management

DPM is commonly used in most of the GRID projects including CERN WLCG,
EGEE, ..., etc.

   Details:

        A multiple SQL Injection vulnerability has been found in Disk
Pool
Manager (DPM). Please read following details:

"./srmv2.2/srmv2_xferreq.c"
int
ns1__srmGetRequestSummary (struct soap *soap,
                         struct ns1__srmGetRequestSummaryRequest *req,
                         struct ns1__srmGetRequestSummaryResponse_ *rep)
{
        ...
        char *r_token;
        ...

        ...
        ...
        for (i = 0; i < nbtokens; i++) {
                ...
                r_token = req->arrayOfRequestTokens->stringArray[i];
                if (strlen (r_token) > CA_MAXDPMTOKENLEN) {
                        reptokenp->status->statusCode =
                                       SRM_USCOREINVALID_USCOREREQUEST;
                        reptokenp->status->explanation =
                            soap_strdup (soap, "Invalid request token");
                        nb_errors++;
                        continue;
                }
                if (dpm_getonereqsummary (thip, r_token, &r_type,
&r_status,
                    &nbreqfiles, &nb_queued, &nb_progress, &nb_failed) <
0) {
                        ...
                        ...
                }
                ...
                ...
        }
        ...
        ...
}

This function is responsible fo reading and parsing requests. If length
of "r_token"
variable is not greather than CA_MAXDPMTOKENLEN function
dpm_getonereqsummary() is called:

"dpm/dpm_procsubr.c"
dpm_getonereqsummary (thip, r_token, r_type, r_status, nbreqfiles,
                                    nb_queued, nb_progress, nb_failed)
struct dpm_srv_thread_info *thip;
char *r_token;
char *r_type;
int *r_status;
int *nbreqfiles;
int *nb_queued;
int *nb_progress;
int *nb_failed;
{
        ...
        ...

        if (dpm_get_pending_req_by_token (&thip->dbfd, r_token,
&dpm_req, 0, NULL) < 0 &&
            dpm_get_req_by_token (&thip->dbfd, r_token, &dpm_req, 0,
NULL) < 0)
                return (-1);

        ...
        ...
}

... and:

"dpm/dpm_mysql_ifce.c"
dpm_get_pending_req_by_token(dbfd, r_token, dpm_req, lock, rec_addr)
struct dpm_dbfd *dbfd;
char *r_token;
struct dpm_req *dpm_req;
int lock;
dpm_dbrec_addr *rec_addr;
{
        char func[29];
        static char query[] =
                "SELECT \
                 R_ORDINAL, R_TOKEN, R_UID, \
                 R_GID, CLIENT_DN, CLIENTHOST, \
                 R_TYPE, U_TOKEN, \
                 FLAGS, RETRYTIME, NBREQFILES, \
                 CTIME, STIME, ETIME, \
                 STATUS, ERRSTRING, GROUPS \
                FROM dpm_pending_req \
                WHERE r_token = '%s'";
        static char query4upd[] =
                "SELECT ROWID, \
                 R_ORDINAL, R_TOKEN, R_UID, \
                 R_GID, CLIENT_DN, CLIENTHOST, \
                 R_TYPE, U_TOKEN, \
                 FLAGS, RETRYTIME, NBREQFILES, \
                 CTIME, STIME, ETIME, \
                 STATUS, ERRSTRING, GROUPS \
                FROM dpm_pending_req \
                WHERE r_token = '%s' \
                FOR UPDATE";
        MYSQL_RES *res;
        MYSQL_ROW row;
        char sql_stmt[1024];
        MYSQL_RES *res;
        MYSQL_ROW row;
        char sql_stmt[1024];

        strcpy (func, "dpm_get_pending_req_by_token");
        sprintf (sql_stmt, lock ? query4upd : query, r_token);
        if (dpm_exec_query (func, dbfd, sql_stmt, &res))
                return (-1);
        ...
        ...
}

This function creates a query to the MySQL Database - DPM supports three
different databases: MySQL, PostgreSQL and Oracle. In this advisory
I'm focused on MySQL database. This vulnerability may be in all
supported databases. I haven't analyzed all the code.

Variable 'r_token' isn't verified at all so SQL Injection attack is
possible. Anyone with a certificate from a recognised CA can access
the SRM interface so it is a serious vulnerability.

SQL Injection exists not only in dpm_get_pending_req_by_token()
function.
Please read following list of functions which don't check inputs too:

Function dpm_get_cpr_by_fullid() doesn't check 'r_token'
Function dpm_get_cpr_by_surl() doesn't check 'r_token', 'surl'
Function dpm_get_cpr_by_surls() doesn't check 'r_token', 'to_surl'
Function dpm_get_gfr_by_fullid() doesn't check 'r_token'
Function dpm_get_gfr_by_surl()   doesn't check 'r_token'
Function dpm_get_pending_req_by_token() doesn't check 'r_token'
Function dpm_get_pending_reqs_by_u_desc() doesn't check 'u_token'
Function dpm_get_pfr_by_fullid() doesn't check 'r_token'
Function dpm_get_pfr_by_surl()   doesn't check 'r_token'
Function dpm_get_pool_entry()    doesn't check 'poolname' variable but
                                 admin required so it isn't important.
Function dpm_get_req_by_token()  doesn't check 'r_token'
Function dpm_get_reqs_by_u_desc() doesn't check 'u_token'
Function dpm_get_spcmd_by_token() doesn't check 's_token'
Function dpm_get_spcmd_by_u_desc() doesn't check 'u_token'
Function dpm_insert_cpr_entry()   doesn't check variable 's_token',
                                                             'r_token'.
Function dpm_insert_fs_entry()   doesn't check 'poolname' variable but
                                 admin required so it isn't important.
Function dpm_insert_gfr_entry()  doesn't check variable 's_token',
                                                            'r_token'.
Function dpm_insert_pending_entry() doesn't check variable 'u_token',
                                                            'r_token'.
Function dpm_insert_pfr_entry()  doesn't check variable 's_token',
                                                            'r_token'.
Function dpm_insert_pool_entry() doesn't check 'poolname' variable but
                                 admin required so it isn't important.
Function dpm_insert_spcmd_entry() doesn't check variable 's_token',
                                  'u_token' and (not important)
                                  'poolname' - admin required.
Functino dpm_insert_xferreq_entry() doesn't check variable 'u_token',
                                                             'r_token'.
Function dpm_list_cpr_entry()   doesn't check 'r_token'
Functino dpm_list_fs_entry()    doesn't check 'poolname' variable but
                                admin required so it isn't important.
Function dpm_list_gfr_entry()   doesn't check 'r_token'
Function dpm_list_pfr_entry()   doesn't check 'r_token'
Function dpm_update_cpr_entry() doesn't check 's_token'
Function dpm_update_gfr_entry() doesn't check 's_token'
Function dpm_update_pfr_entry() doesn't check 's_token'
Function dpm_update_spcmd_entry() doesn't check 'poolname' variable but
                                  admin required so it isn't important.

   Proof of concept

$ ./srm2_testGetRequestStatus srm://vmgdda0013.cern.ch:8446/ \'
request status SRM_FAILURE
request state 1
explanation: Failed for all tokens
request summaryArray 1
======= Begin Request ========
Request    token: '
state[0]: 14 SRM_INTERNAL_ERROR
$

Please read following dump of SRM log file:

07/23 18:01:50.330  9720,0 dpm_get_pending_req_by_token: mysql_query
error: You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use
near ''''' at line 1
07/23 18:01:50.330  9720,0 dpm_get_req_by_token: mysql_query error: You
have an error in your SQL syntax; check the manual that corresponds to
your MySQL server version for the right syntax to use near ''''' at line
1
07/23 18:01:50.330  9720,0 GetRequestSummary: returns 0,
statusCode=SRM_FAILURE

Here is strace output from the SRMv2.2 process:

poll([{fd=7, events=POLLIN|POLLPRI}], 1, 0) = 0 (Timeout)
write(7, "\335\0\0\0\3SELECT \t\t R_ORDINAL, R_TOKEN, R_UID, \t\t R_GID,
 CLIENT_DN, CLIENTHOST, \t\t R_TYPE, U_TOKEN, \t\t FLAGS, RETRYTIME,
 NBREQFILES, \t\t CTIME, STIME, ETIME, \t\t STATUS, ERRSTRING, GROUPS
\t\tFROM dpm_pending_req \t\tWHERE r_token = '''", 225) = 225
read(7, "\236\0\0\1\377(\4#42000You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server version for the
right syntax to use near ''''' at line 1", 16384) = 162
gettimeofday({1311434508, 295920}, NULL) = 0
open("/var/log/srmv2.2/log", O_WRONLY|O_CREAT|O_APPEND, 0664) = 8
write(8, "07/23 17:21:48.295  9720,0 dpm_get_pending_req_by_token:
mysql_query error: You have an error in your SQL syntax; check the
manual that corresponds to your MySQL server version for the right
syntax to  use near ''''' at line 1\n", 226) = 226
close(8)                                = 0
poll([{fd=7, events=POLLIN|POLLPRI}], 1, 0) = 0 (Timeout)
write(7, "\325\0\0\0\3SELECT \t\t R_ORDINAL, R_TOKEN, R_UID, \t\t R_GID,
 CLIENT_DN, CLIENTHOST, \t\t R_TYPE, U_TOKEN, \t\t FLAGS, RETRYTIME,
 NBREQFILES, \t\t CTIME, STIME, ETIME, \t\t STATUS, ERRSTRING, GROUPS
\t\tFROM dpm_req \t\tWHERE r_token = '''", 217) = 217
read(7, "\236\0\0\1\377(\4#42000You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server version for the
right syntax to use near ''''' at line 1", 16384) = 162
gettimeofday({1311434508, 296597}, NULL) = 0
open("/var/log/srmv2.2/log", O_WRONLY|O_CREAT|O_APPEND, 0664) = 8
write(8, "07/23 17:21:48.296  9720,0 dpm_get_req_by_token: mysql_query
error: You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use
nea r ''''' at line 1\n", 218) = 218
close(8)                                = 0
gettimeofday({1311434508, 296942}, NULL) = 0
open("/var/log/srmv2.2/log", O_WRONLY|O_CREAT|O_APPEND, 0664) = 8
write(8, "07/23 17:21:48.296  9720,0 GetRequestSummary: returns 0,
statusCode=SRM_FAILURE\n", 80) = 80
close(8)                                = 0

And here is strace from the MySQL process:

read(31, "\3SELECT \t\t R_ORDINAL, R_TOKEN, R_UID, \t\t R_GID, CLIENT_DN
, CLIENTHOST, \t\t R_TYPE, U_TOKEN, \t\t FLAGS, RETRYTIME, NBREQFILES,
\t\t CTIME, STIME, ETIME, \t\t STATUS, ERRSTRING, GROUPS \t\tFROM
dpm_pending_req \t\tWHERE r_token = '''", 221) = 221
rt_sigprocmask(SIG_BLOCK, ~[RTMIN RT_1], [HUP INT QUIT PIPE ALRM TERM
TSTP], 8) = 0
rt_sigprocmask(SIG_SETMASK, [HUP INT QUIT PIPE ALRM TERM TSTP], NULL, 8)
 = 0
fcntl(31, F_SETFL, O_RDWR|O_NONBLOCK)   = 0
time([1311436910])                      = 1311436910
sched_setscheduler(15280, SCHED_OTHER, { 6 }) = -1 EINVAL (Invalid
argument)
sched_setscheduler(15280, SCHED_OTHER, { 8 }) = -1 EINVAL (Invalid
argument)
write(31, "\236\0\0\1\377(\4#42000You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server version for the
right syntax to use near ''''' at line 1", 162) = 162
time([1311436910])                      = 1311436910
read(31, 0x1f7ae9b0, 4)                 = -1 EAGAIN (Resource
temporarily unavailable)
time(NULL)                              = 1311436910
rt_sigprocmask(SIG_BLOCK, ~[RTMIN RT_1], [HUP INT QUIT PIPE ALRM TERM
TSTP], 8) = 0
rt_sigprocmask(SIG_SETMASK, [HUP INT QUIT PIPE ALRM TERM TSTP], NULL, 8)
 = 0
fcntl(31, F_SETFL, O_RDWR)              = 0
read(31, "\325\0\0\0", 4)               = 4
read(31, "\3SELECT \t\t R_ORDINAL, R_TOKEN, R_UID, \t\t R_GID, CLIENT_DN
, CLIENTHOST, \t\t R_TYPE, U_TOKEN, \t\t FLAGS, RETRYTIME, NBREQFILES,
\t\t CTIME, STIME, ETIME, \t\t STATUS, ERRSTRING, GROUPS \t\tFROM
dpm_req \t\tWHERE r_token = '''", 213) = 213
rt_sigprocmask(SIG_BLOCK, ~[RTMIN RT_1], [HUP INT QUIT PIPE ALRM TERM
TSTP], 8) = 0
rt_sigprocmask(SIG_SETMASK, [HUP INT QUIT PIPE ALRM TERM TSTP], NULL, 8)
 = 0
fcntl(31, F_SETFL, O_RDWR|O_NONBLOCK)   = 0
time([1311436910])                      = 1311436910
sched_setscheduler(15280, SCHED_OTHER, { 6 }) = -1 EINVAL (Invalid
argument)
sched_setscheduler(15280, SCHED_OTHER, { 8 }) = -1 EINVAL (Invalid
argument)
write(31, "\236\0\0\1\377(\4#42000You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server version for the
right syntax to use near ''''' at line 1", 162) = 162
time([1311436910])                      = 1311436910
read(31, 0x1f7ae9b0, 4)                 = -1 EAGAIN (Resource
temporarily unavailable)

   Affected Software:

All versions of Disk Pool Manager (DPM) below 1.8.6 version are
affected.
1.8.6 was released 19th of February 2013.

   Greets

+) David Smith - for testing infrastructures and other helps not only
                 at this topic.

   References

1) [https://wiki.egi.eu/wiki/SVG:Advisory-SVG-2012-2683](https://wiki.egi.eu/wiki/SVG%3AAdvisory-SVG-2012-2683)
2) <http://site.pi3.com.pl/adv/disk_pool_manager_1.txt>
3) <http://blog.pi3.com.pl/?p=402>

   Timeline

2009-11-27 - Found vulnerability.
2011-08-03 - Vulnerability officialy reported.
2013-02-19 - Updated packages available in the EGI UMD-1 and EGI UMD-2.
2013-03-05 - Public disclosure on vendor's wiki, after allowing sites to
             upgrade
([https://wiki.egi.eu/wiki/SVG:Advisory-SVG-2012-2683](https://wiki.egi.eu/wiki/SVG%3AAdvisory-SVG-2012-2683))
2013-03-10 - Release of this advisory.

Best regards,
Adam Zabrocki

--
<http://pi3.com.pl>

Download attachment "[signature.asc](1/1)" of type "application/pgp-signature" (837 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_97f12e5c_20250125_210629.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2013/03/11/9) [[next>]](2) [[<thread-prev]](../../../2013/03/10/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <513E95E1.2080304@redhat.com>
Date: Mon, 11 Mar 2013 20:41:37 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Adam Zabrocki <pi3@....com.pl>, full-disclosure@...ts.grok.org.uk,
        secalert <secalert@...urityreason.pl>
Subject: Re: Multiple SQL Injection vulnerabilities in Disk
 Pool Manager (DPM)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 03/10/2013 12:17 AM, Adam Zabrocki wrote:
> Name:                 Multiple SQL Injection vulnerabilities in
> Disk Pool Manager (DPM) Author:               Adam Zabrocki
> (<pi3@....com.pl>) Date:                 November 27, 2009 (Yes,
> it's very old bug ;P)
>
> Timeline
>
> 2009-11-27 - Found vulnerability. 2011-08-03 - Vulnerability
> officialy reported. 2013-02-19 - Updated packages available in the
> EGI UMD-1 and EGI UMD-2. 2013-03-05 - Public disclosure on vendor's
> wiki, after allowing sites to upgrade
> ([https://wiki.egi.eu/wiki/SVG:Advisory-SVG-2012-2683](https://wiki.egi.eu/wiki/SVG%3AAdvisory-SVG-2012-2683)) 2013-03-10 -
> Release of this advisory.
>
>
>
> Best regards, Adam Zabrocki
>
> -- <http://pi3.com.pl>

I'm curious as to why the 2 year delay? I'm going to go with the date
reported as that is also mentioned in the public advisory, I can't
confirm the 2009 date.

Please use CVE-2011-4970 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRPpXhAAoJEBYNRVNeJnmTWM4QAIXbXji8kHSgx0HRpLSuOORM
EQvjEnKiu65WQxNnDsvde1PIqLMjblG+aKL1ui8lXzqqA1qWmgAKbamQ69BaSzMN
XF1mPsmb7xz+piwUfWUOCJZz/PbOmLBXyp6TRmxOvbne42DC6CBO5mRWmboYLC9k
an1qK3ymSMyf1WHmJGG+6b68WqfhtcH2Q/fKchn7KvpPHgU4+a4zmlmb587q1cf1
UVrMCwr6VWX2Jt/hLs3YP9Phb9DEGKQN/QorieNN9pPe1l5KM5/dB0HWtmD632t3
q44zY4J9cPNHsUcUgrD7iw0q0pYK5Jah72YZjEjPeK29hiBH6BsOtRWcrF5zfUKq
iVifcrNPsaQ2iDn+eU3BYbw/g4EUD3hlqhJ4gYfWUeZQXWfaxBM1wHOupHDQcLUo
GJZZgbpd3nE8rN0Wtc3ZbF0Ht8iv5JiI3ZC6ZXA/R7ff6KfQjeP5ncqkfehPLOYR
sH0arO/Nc/3ek4dtFDYiDCeO1gWNrzx4rZK+ajgtoqMN1zk8I4R5u/3dgmiDirsa
ZHhgcu8XLjBYx/4mmOO09H+ovNZZELGZnHg43HAdcjbG5piUUSB5DhUXYoBMN5QX
LEzBHmppsceuOe3LgbEtjbNX93+nk7Ch8JV8nj03AJo490HFpOUS670PF9nCPGfO
ZKSznOcQlQmvvqUILsaG
=SR7C
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


