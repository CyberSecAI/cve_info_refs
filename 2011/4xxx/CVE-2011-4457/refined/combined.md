=== Content from code.google.com_a46accaa_20250125_125805.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowasp%2Fjava-html-sanitizer)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowasp%2Fjava-html-sanitizer)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=OWASP%2Fjava-html-sanitizer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OWASP](/OWASP)
/
**[java-html-sanitizer](/OWASP/java-html-sanitizer)**
Public

* [Notifications](/login?return_to=%2FOWASP%2Fjava-html-sanitizer) You must be signed in to change notification settings
* [Fork
  218](/login?return_to=%2FOWASP%2Fjava-html-sanitizer)
* [Star
   868](/login?return_to=%2FOWASP%2Fjava-html-sanitizer)

Takes third-party HTML and produces HTML that is safe to embed in your web application. Fast and easy to configure.

### License

[View license](/OWASP/java-html-sanitizer/blob/main/COPYING)

[868
stars](/OWASP/java-html-sanitizer/stargazers) [218
forks](/OWASP/java-html-sanitizer/forks) [Branches](/OWASP/java-html-sanitizer/branches) [Tags](/OWASP/java-html-sanitizer/tags) [Activity](/OWASP/java-html-sanitizer/activity)
 [Star](/login?return_to=%2FOWASP%2Fjava-html-sanitizer)

 [Notifications](/login?return_to=%2FOWASP%2Fjava-html-sanitizer) You must be signed in to change notification settings

* [Code](/OWASP/java-html-sanitizer)
* [Issues
  112](/OWASP/java-html-sanitizer/issues)
* [Pull requests
  21](/OWASP/java-html-sanitizer/pulls)
* [Actions](/OWASP/java-html-sanitizer/actions)
* [Projects
  0](/OWASP/java-html-sanitizer/projects)
* [Security](/OWASP/java-html-sanitizer/security)
* [Insights](/OWASP/java-html-sanitizer/pulse)

Additional navigation options

* [Code](/OWASP/java-html-sanitizer)
* [Issues](/OWASP/java-html-sanitizer/issues)
* [Pull requests](/OWASP/java-html-sanitizer/pulls)
* [Actions](/OWASP/java-html-sanitizer/actions)
* [Projects](/OWASP/java-html-sanitizer/projects)
* [Security](/OWASP/java-html-sanitizer/security)
* [Insights](/OWASP/java-html-sanitizer/pulse)

# OWASP/java-html-sanitizer

    main[Branches](/OWASP/java-html-sanitizer/branches)[Tags](/OWASP/java-html-sanitizer/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[549 Commits](/OWASP/java-html-sanitizer/commits/main/) | | |
| [.github](/OWASP/java-html-sanitizer/tree/main/.github ".github") | | [.github](/OWASP/java-html-sanitizer/tree/main/.github ".github") |  |  |
| [aggregate](/OWASP/java-html-sanitizer/tree/main/aggregate "aggregate") | | [aggregate](/OWASP/java-html-sanitizer/tree/main/aggregate "aggregate") |  |  |
| [docs](/OWASP/java-html-sanitizer/tree/main/docs "docs") | | [docs](/OWASP/java-html-sanitizer/tree/main/docs "docs") |  |  |
| [empiricism](/OWASP/java-html-sanitizer/tree/main/empiricism "empiricism") | | [empiricism](/OWASP/java-html-sanitizer/tree/main/empiricism "empiricism") |  |  |
| [java10-shim](/OWASP/java-html-sanitizer/tree/main/java10-shim "java10-shim") | | [java10-shim](/OWASP/java-html-sanitizer/tree/main/java10-shim "java10-shim") |  |  |
| [java8-shim](/OWASP/java-html-sanitizer/tree/main/java8-shim "java8-shim") | | [java8-shim](/OWASP/java-html-sanitizer/tree/main/java8-shim "java8-shim") |  |  |
| [owasp-java-html-sanitizer](/OWASP/java-html-sanitizer/tree/main/owasp-java-html-sanitizer "owasp-java-html-sanitizer") | | [owasp-java-html-sanitizer](/OWASP/java-html-sanitizer/tree/main/owasp-java-html-sanitizer "owasp-java-html-sanitizer") |  |  |
| [scripts](/OWASP/java-html-sanitizer/tree/main/scripts "scripts") | | [scripts](/OWASP/java-html-sanitizer/tree/main/scripts "scripts") |  |  |
| [.gitattributes](/OWASP/java-html-sanitizer/blob/main/.gitattributes ".gitattributes") | | [.gitattributes](/OWASP/java-html-sanitizer/blob/main/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/OWASP/java-html-sanitizer/blob/main/.gitignore ".gitignore") | | [.gitignore](/OWASP/java-html-sanitizer/blob/main/.gitignore ".gitignore") |  |  |
| [COPYING](/OWASP/java-html-sanitizer/blob/main/COPYING "COPYING") | | [COPYING](/OWASP/java-html-sanitizer/blob/main/COPYING "COPYING") |  |  |
| [README.md](/OWASP/java-html-sanitizer/blob/main/README.md "README.md") | | [README.md](/OWASP/java-html-sanitizer/blob/main/README.md "README.md") |  |  |
| [RELEASE-checklist.sh](/OWASP/java-html-sanitizer/blob/main/RELEASE-checklist.sh "RELEASE-checklist.sh") | | [RELEASE-checklist.sh](/OWASP/java-html-sanitizer/blob/main/RELEASE-checklist.sh "RELEASE-checklist.sh") |  |  |
| [SECURITY.md](/OWASP/java-html-sanitizer/blob/main/SECURITY.md "SECURITY.md") | | [SECURITY.md](/OWASP/java-html-sanitizer/blob/main/SECURITY.md "SECURITY.md") |  |  |
| [change\_log.md](/OWASP/java-html-sanitizer/blob/main/change_log.md "change_log.md") | | [change\_log.md](/OWASP/java-html-sanitizer/blob/main/change_log.md "change_log.md") |  |  |
| [pom.xml](/OWASP/java-html-sanitizer/blob/main/pom.xml "pom.xml") | | [pom.xml](/OWASP/java-html-sanitizer/blob/main/pom.xml "pom.xml") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
* Security
# OWASP Java HTML Sanitizer

[![Java CI with Maven](https://github.com/OWASP/java-html-sanitizer/actions/workflows/maven.yml/badge.svg)](https://github.com/OWASP/java-html-sanitizer/actions/workflows/maven.yml) [![Coverage Status](https://camo.githubusercontent.com/9b0dcb6e0ee06e7a7f41d2917a67f19d2e1e946955dc6191770aed23bac08172/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f4f574153502f6a6176612d68746d6c2d73616e6974697a65722f62616467652e7376673f6272616e63683d6d61696e)](https://coveralls.io/github/OWASP/java-html-sanitizer?branch=main) [![CII Best Practices](https://camo.githubusercontent.com/23dc3536b519af8a11896fba536d903548631a0399c7e0c25da020e4495c7d93/68747470733a2f2f626573747072616374696365732e636f7265696e6672617374727563747572652e6f72672f70726f6a656374732f323630322f6261646765)](https://bestpractices.coreinfrastructure.org/projects/2602) [![Maven Central](https://camo.githubusercontent.com/b89e8e04216023763765403c37da39d55800ad0b86f26b27dab01b8523afda51/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f636f6d2e676f6f676c65636f64652e6f776173702d6a6176612d68746d6c2d73616e6974697a65722f6f776173702d6a6176612d68746d6c2d73616e6974697a65722f62616467652e706e673f7374796c653d706c6173746963)](https://search.maven.org/artifact/com.googlecode.owasp-java-html-sanitizer/owasp-java-html-sanitizer)

A fast and easy to configure HTML Sanitizer written in Java which lets
you include HTML authored by third-parties in your web application while
protecting against XSS.

The existing dependency is on JSR 305. The other jars
are only needed by the test suite. The JSR 305 dependency is a
compile-only dependency, only needed for annotations.

This code was written with security best practices in mind, has an
extensive test suite, and has undergone
[adversarial security review](/OWASP/java-html-sanitizer/blob/main/docs/attack_review_ground_rules.md).

## Table Of Contents

* [Getting Started](#getting-started)
* [Prepackaged Policies](#prepackaged-policies)
* [Crafting a policy](#crafting-a-policy)
* [Custom policies](#custom-policies)
* [Preprocessors](#preprocessors)
* [Telemetry](#telemetry)
* [Questions?](#questions)
* [Contributing](#contributing)
* [Credits](#credits)

## Getting Started

[Getting Started](/OWASP/java-html-sanitizer/blob/main/docs/getting_started.md) includes instructions on
how to get started with or without Maven.

## Prepackaged Policies

You can use
[prepackaged policies](https://static.javadoc.io/com.googlecode.owasp-java-html-sanitizer/owasp-java-html-sanitizer/20240325.1/org/owasp/html/Sanitizers.html):

```
PolicyFactory policy = Sanitizers.FORMATTING.and(Sanitizers.LINKS);
String safeHTML = policy.sanitize(untrustedHTML);
```

## Crafting a policy

The
[tests](https://github.com/OWASP/java-html-sanitizer/blob/main/src/test/java/org/owasp/html/HtmlPolicyBuilderTest.java)
show how to configure your own
[policy](https://static.javadoc.io/com.googlecode.owasp-java-html-sanitizer/owasp-java-html-sanitizer/20240325.1/org/owasp/html/HtmlPolicyBuilder.html):

```
PolicyFactory policy = new HtmlPolicyBuilder()
    .allowElements("a")
    .allowUrlProtocols("https")
    .allowAttributes("href").onElements("a")
    .requireRelNofollowOnLinks()
    .toFactory();
String safeHTML = policy.sanitize(untrustedHTML);
```

## Custom Policies

You can write
[custom policies](https://static.javadoc.io/com.googlecode.owasp-java-html-sanitizer/owasp-java-html-sanitizer/20240325.1/org/owasp/html/ElementPolicy.html)
to do things like changing `h1`s to `div`s with a certain class:

```
PolicyFactory policy = new HtmlPolicyBuilder()
    .allowElements("p")
    .allowElements(
        (String elementName, List<String> attrs) -> {
          // Add a class attribute.
          attrs.add("class");
          attrs.add("header-" + elementName);
          // Return elementName to include, null to drop.
          return "div";
        }, "h1", "h2", "h3", "h4", "h5", "h6")
    .toFactory();
String safeHTML = policy.sanitize(untrustedHTML);
```

Please note that the elements "a", "font", "img", "input" and "span"
need to be explicitly whitelisted using the `allowWithoutAttributes()`
method if you want them to be allowed through the filter when these
elements do not include any attributes.

[Attribute policies](https://static.javadoc.io/com.googlecode.owasp-java-html-sanitizer/owasp-java-html-sanitizer/20240325.1/org/owasp/html/AttributePolicy.html) allow running custom code too. Adding an attribute policy will not water down any default policy like `style` or URL attribute checks.

```
new HtmlPolicyBuilder = new HtmlPolicyBuilder()
    .allowElement("div", "span")
    .allowAttributes("data-foo")
        .matching(
            (String elementName, String attributeName, String value) -> {
              // Return value for the attribute or null to drop.
            })
        .onElements("div", "span")
    .build()
```

## Preprocessors

Preprocessors allow inserting text and large scale structural changes.

```
new HtmlPolicyBuilder = new HtmlPolicyBuilder()
    // Use a preprocessor to be backwards compatible with the
    // <plaintext> element which
    .withPreprocessor(
        (HtmlStreamEventReceiver r) -> {
          // Provide user with info about links before they click.
          // Before:                       <a href="https://example.com/...">
          // After:  (https://example.com) <a href="https://example.com/...">
          return new HtmlStreamEventReceiverWrapper(r) {
            @Override public void openTag(String elementName, List<String> attrs) {
              if ("a".equals(elementName)) {
                for (int i = 0, n = attrs.size(); i < n; i += 2) {
                  if ("href".equals(attrs.get(i)) {
                    String url = attrs.get(i + 1);
                    String origin;
                    try {
                      URI uri = new URI(url);
                      String scheme = uri.getScheme();
                      String authority = uri.getRawAuthority();
                      if (scheme == null && authority == null) {
                        origin = null;
                      } else {
                        origin = (scheme != null ? scheme + ":" : "")
                               + (authority != null ? "//" + authority : "");
                      }
                    } catch (URISyntaxException ex) {
                      origin = "about:invalid";
                    }
                    if (origin != null) {
                      text(" (" + origin + ") ");
                    }
                  }
                }
              }
              super.openTag(elementName, attrs);
            }
          };
        }
    .allowElement("a")
    ...
    .build()
```

Preprocessing happens before a policy is applied, so cannot affect the security
of the output.

## Telemetry

When a policy rejects an element or attribute it notifies an [HtmlChangeListener](https://static.javadoc.io/com.googlecode.owasp-java-html-sanitizer/owasp-java-html-sanitizer/20240325.1/org/owasp/html/HtmlChangeListener.html).

You can use this to keep track of policy violation trends and find out when someone
is making an effort to breach your security.

```
PolicyFactory myPolicyFactory = ...;
// If you need to associate reports with some context, you can do so.
MyContextClass myContext = ...;

String sanitizedHtml = myPolicyFactory.sanitize(
    unsanitizedHtml,
    new HtmlChangeListener<MyContextClass>() {
      @Override
      public void discardedTag(MyContextClass context, String elementName) {
        // ...
      }
      @Override
      public void discardedAttributes(
          MyContextClass context, String elementName, String... attributeNames) {
        // ...
      }
    },
    myContext);
```

**Note**: If a string sanitizes with no change notifications, it is not the case
that the input string is necessarily safe to use. Only use the output of the sanitizer.

The sanitizer ensures that the output is in a sub-set of HTML that commonly
used HTML parsers will agree on the meaning of, but the absence of
notifications does not mean that the input is in such a sub-set,
only that it does not contain elements or attributes that were removed.

See ["Why sanitize when you can validate"](https://github.com/OWASP/java-html-sanitizer/blob/main/docs/html-validation.md) for more on this topic.

## Questions?

If you wish to report a vulnerability, please see
[AttackReviewGroundRules](/OWASP/java-html-sanitizer/blob/main/docs/attack_review_ground_rules.md).

Subscribe to the
[mailing list](http://groups.google.com/group/owasp-java-html-sanitizer-support)
to be notified of known [Vulnerabilities](/OWASP/java-html-sanitizer/blob/main/docs/vulnerabilities.md) and important updates.

## Contributing

If you would like to contribute, please ping [@mvsamuel](https://twitter.com/mvsamuel) or [@manicode](https://twitter.com/manicode).

We welcome [issue reports](https://github.com/OWASP/java-html-sanitizer/issues) and PRs.
PRs that change behavior or that add functionality should include both positive and
[negative tests](https://www.guru99.com/negative-testing.html).

Please be aware that contributions fall under the [Apache 2.0 License](https://github.com/OWASP/java-html-sanitizer/blob/main/COPYING).

## Credits

[Thanks to everyone who has helped with criticism and code](/OWASP/java-html-sanitizer/blob/main/docs/credits.md)

## About

Takes third-party HTML and produces HTML that is safe to embed in your web application. Fast and easy to configure.

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/OWASP/java-html-sanitizer/activity)
[Custom properties](/OWASP/java-html-sanitizer/custom-properties)
### Stars

[**868**
stars](/OWASP/java-html-sanitizer/stargazers)
### Watchers

[**34**
watching](/OWASP/java-html-sanitizer/watchers)
### Forks

[**218**
forks](/OWASP/java-html-sanitizer/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FOWASP%2Fjava-html-sanitizer&report=OWASP+%28user%29)

## [Releases 7](/OWASP/java-html-sanitizer/releases)

[Release 20240325.1
Latest

Mar 25, 2024](/OWASP/java-html-sanitizer/releases/tag/release-20240325.1)
[+ 6 releases](/OWASP/java-html-sanitizer/releases)

## [Packages 0](/orgs/OWASP/packages?repo_name=java-html-sanitizer)

No packages published

## [Contributors 23](/OWASP/java-html-sanitizer/graphs/contributors)

[+ 9 contributors](/OWASP/java-html-sanitizer/graphs/contributors)

## Languages

* [Java
  51.4%](/OWASP/java-html-sanitizer/search?l=java)
* [JavaScript
  34.8%](/OWASP/java-html-sanitizer/search?l=javascript)
* [HTML
  13.5%](/OWASP/java-html-sanitizer/search?l=html)
* [Shell
  0.3%](/OWASP/java-html-sanitizer/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


