Based on the provided information, here's an analysis of CVE-2011-4349:

**Root Cause of Vulnerability:**

*   The `colord` daemon did not properly sanitize user-supplied strings when constructing SQL queries. Specifically, it failed to use `sqlite3_mprintf()` with `%q` which is designed for properly quoting input to avoid SQL injection.

**Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The lack of proper sanitization allowed for SQL injection vulnerabilities in `colord`'s database routines. This affected how `colord` processed color device mappings and devices.

**Impact of Exploitation:**

*   **Database Corruption:** A local attacker could exploit the SQL injection flaws to corrupt the `colord` database.
*   **Potential System-Wide Impact:** If `colord` was running as root, an attacker could potentially leverage the vulnerability to modify other system SQLite3 based databases. This included the polkit daemon's database.

**Attack Vectors:**

*   **Local Attack:** The attack vector is local. An attacker needs to have local access to the system.
*   **User-Supplied Input:** Exploitation involved injecting malicious SQL commands through user-supplied strings, specifically when creating new devices.

**Required Attacker Capabilities/Position:**

*   **Local User:** The attacker needs to be a local user on the system.
*   **Create Devices Permission:** The attacker needs to be allowed to create new devices within the `colord` context.
*   **Root Privileges for colord**: The `colord` daemon needed to be running with root privileges for the attacker to leverage the vulnerability to impact other databases.

**Additional Details:**

*   The vulnerability was found in `cd-device-db.c` and `cd-mapping-db.c` files of `colord`
*   Patches addressed the issue by using `sqlite3_mprintf()` with `%q`.
*   The vulnerability affected Fedora 15 and 16.
*   Ubuntu 11.10 was also affected.
*   Upstream patches were identified at the following links:
    *   [http://gitorious.org/colord/master/commit/1fadd90afcb4bbc47513466ee9bb1e4a8632ac3b](http://gitorious.org/colord/master/commit/1fadd90afcb4bbc47513466ee9bb1e4a8632ac3b)
    *   [http://gitorious.org/colord/master/commit/36549e0ed255e7dfa7852d08a75dd5f00cbd270e](http://gitorious.org/colord/master/commit/36549e0ed255e7dfa7852d08a75dd5f00cbd270e)
*   The bug was reported on freedesktop.org as bug #42904.
*   The fix was included in `colord-0.1.15-1.fc16` for Fedora and `0.1.12-1ubuntu2.1` for Ubuntu 11.10.

This detailed information provides a comprehensive understanding of the vulnerability described by CVE-2011-4349.