=== Content from penturalabs.wordpress.com_8f75a8d8_20250125_234059.html ===

[Skip to content](#content)
Follow:
[RSS](https://penturalabs.wordpress.com/feed/)

[Pentura Labs's Blog](https://penturalabs.wordpress.com/)

A security research blog at Pentura

* [Home](https://penturalabs.wordpress.com/)
* [About](https://penturalabs.wordpress.com/about/)
* [Downloads](https://penturalabs.wordpress.com/downloads/)

# Advisory: CRLF Injection Vulnerability in Moodle.

by [dusty](https://penturalabs.wordpress.com/author/0xdusty/ "View all posts by dusty") on December 13, 2011

Hello All,

I was on a web application penetration test, the client was running a course management system called Moodle. I ran through my normal methodology however as this was a piece of open source software I decided to download the source code and review it for bugs.

I hit jackpot and found a vulnerable redirect() function which made a call to the header() function, to do a redirect. However the $url variable passed to the header() function was not being sanitized prior to it’s use. Therefore allowing an attacker to inject artibitary headers and control the way the application functions.

As this was an unreleased bug (0day) I had to come up with a fix for the client, I therefore went down the route of responsible disclosure and disclosed the bug to Moodle security team, who later fixed it rather promptly might I add. During this time I also contacted Mitre to see if I can assign it a CVE. In order for me to do that I had to drop an advisory and so here it is…

Topic: CRLF Injection (HTTP Response Splitting) vulnerability in Moodle.

Severity: Critical

Releases affected: 1.9.14, 2.0.5, 2.1.2, 2.2

Patched Releases: 1.9.15, 2.0.6, 2.1.3

Affected Components: Calendar

Reported and coordinated by: Mike Evans (mike.evans@pentura.com)

Issue Number: MDL-24808

CVE Number: [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4203](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4203 "CVE-2011-4203")

Description:

Moodle 1.9.14 through to 2.2 is vulnerable to a CRLF Injection Attack that affects: /calendar/set.php and other parts

of the Course Management System that utilise the redirect() function. The problem arises from the lack of sanitization on the $url variable

prior to being used in the following snippet of code:

@header(‘Location: ‘.$url);

This allows for an attacker to inject his own CRLF sequence into an HTTP communication, which gives the attacker the ability to control the way the web application

functions. The amount of attacks that can be leverage from the vulnerability are huge, some of them include; cross site scripting, cross-user defacement, hijacking

of web pages and positioning of the clients web cache. Moodle have been contacted and have fixed this issue.

Solution:

Upgrade to any of the following releases: 1.9.15, 2.0.6, 2.1.3

### Rate this:

### Share this:

* Email
* [Facebook](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/?share=facebook "Click to share on Facebook")
* [Twitter](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/?share=twitter "Click to share on Twitter")
Like Loading...

From → [pentura](https://penturalabs.wordpress.com/category/pentura/)

7 Comments

1. ![](https://i0.wp.com/a1.twimg.com/profile_images/1631368101/logo_web_normal.jpg?resize=40%2C40&ssl=1)
   [A Gent (@gentlemanhacker)](http://twitter.com/gentlemanhacker) [permalink](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/#comment-73)

   Great Job Mikey!

   [Reply](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/?replytocom=73#respond)
3. ![](https://1.gravatar.com/avatar/d1ff6adca38cb2c4dc8b46cb40e779449b1add82cec6551466e0d89971aad0d6?s=40&d=identicon&r=G)
   shizzler [permalink](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/#comment-85)

   Dude, if I’m not mistaken the header() function doesn’t allow newline characters.

   This has already been securely fixed a long-long time ago, in a galaxy far far away.

   See: <http://php.net/releases/5_1_2.php>

   Any thought? Am I wrong?

   Cheers.

   [Reply](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/?replytocom=85#respond)
5. ![](https://2.gravatar.com/avatar/5f30e71970bca5bb5ffc4159c1ad006833672e10dda58280b7cb0f373e9ea31f?s=40&d=identicon&r=G)
   Anonymous [permalink](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/#comment-89)

   hello,

   i’ve seen this today and moodle seems to be in the 2.2.2 version, is that version vulnerable.. and from where did you get to /calendar/set.php??

   Thanks!

   [Reply](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/?replytocom=89#respond)
7. ![](https://2.gravatar.com/avatar/59db931a8bcf92b4e3e6c288da60be9ac9155d620c8a1ba7e8e1e5a76bb401d7?s=40&d=identicon&r=G)
   dusty [permalink](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/#comment-90)

   Hello,

   Thanks for you’re comments.

   The problem was with the sanitizing of the $url variable in the function redirect(), it was not being sanitized correctly before using in:

   @header(‘Location: ‘.$url);

   Also, if you look at the bug tracker and Moodle advisory you will see when this was reported and when it was fixed. So please have a look at the following URL:

   <http://tracker.moodle.org/browse/MDL-29925>

   – Dusty

   [Reply](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/?replytocom=90#respond)
9. ![](https://0.gravatar.com/avatar/6d94b4feddc7d87a0989e4667304ad51d5e9dc63415f19c458a40ea7ef49274b?s=40&d=identicon&r=G)
   xtrm0 [permalink](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/#comment-94)

   How can this exploit be used in moodle 1.9.5?

   [Reply](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/?replytocom=94#respond)
   * ![](https://2.gravatar.com/avatar/e843c61b038fd7e6f191411dc29f38f4c27a7e26df4d5cdbd16c558740ed9597?s=40&d=identicon&r=G)
     [dangerf](http://gravatar.com/dangerf) [permalink](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/#comment-125)

     Where i need to put the sql command? In event description or title?

     [Reply](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/?replytocom=125#respond)
11. ![](https://2.gravatar.com/avatar/59db931a8bcf92b4e3e6c288da60be9ac9155d620c8a1ba7e8e1e5a76bb401d7?s=40&d=identicon&r=G)
    dusty [permalink](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/#comment-126)

    @xtrm0: You would have to check the code base for Moodle 1.9.5 to see if the vulnerability exists.

    @dangerf: This is not an SQL Injection vulnerability.

    [Reply](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/?replytocom=126#respond)

### Leave a comment [Cancel reply](/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/#respond)

Δ

« [Introduction to Pen-testing Android Applications Part 1…](https://penturalabs.wordpress.com/2012/06/07/introduction-to-pen-testing-android-applications-part-1/)
[Quick check of possible malware](https://penturalabs.wordpress.com/2011/07/29/quick-check-of-possible-malware/) »

* ## Subscribe to Pentura Labs

  [![](https://i0.wp.com/www.feedburner.com/fb/images/pub/feed-icon32x32.png)](http://feeds.feedburner.com/PenturaLabs "Subscribe to my feed")[Subscribe in a reader](http://feeds.feedburner.com/PenturaLabs "Subscribe to my feed")
* ## Recent Posts

  + [SNMPPLUX](https://penturalabs.wordpress.com/2016/04/01/snmpplux/)
  + [Finding and Exploiting Same Origin Method Execution vulnerabilities](https://penturalabs.wordpress.com/2015/12/30/finding-and-exploiting-same-origin-method-execution-vulnerabilities/)
  + [[IRCCloud] History and Another XSS Bug Bounty](https://penturalabs.wordpress.com/2015/10/14/irccloud-history-and-another-xss-bug-bounty/)
  + [[IRCCloud] Inadequate input validation on API endpoint leading to self denial of service and increased system load](https://penturalabs.wordpress.com/2015/10/13/fuzzing-for-fun-and-profit/)
  + [Most businesses do not understand data breach risks](https://penturalabs.wordpress.com/2014/11/07/most-businesses-do-not-understand-data-breach-risks/)
* ## Categories

  [13.56MHz](https://penturalabs.wordpress.com/tag/13-56mhz/)
  [125kHz](https://penturalabs.wordpress.com/tag/125khz/)
  [Adafruit](https://penturalabs.wordpress.com/tag/adafruit/)
  [Android](https://penturalabs.wordpress.com/tag/android/)
  [apache](https://penturalabs.wordpress.com/tag/apache/)
  [arduino](https://penturalabs.wordpress.com/tag/arduino-2/)
  [Bluetooth](https://penturalabs.wordpress.com/tag/bluetooth/)
  [breach](https://penturalabs.wordpress.com/tag/breach/)
  [clone](https://penturalabs.wordpress.com/tag/clone/)
  [cookies](https://penturalabs.wordpress.com/tag/cookies/)
  [Cross Site Scripting](https://penturalabs.wordpress.com/tag/cross-site-scripting/)
  [data](https://penturalabs.wordpress.com/tag/data/)
  [default files](https://penturalabs.wordpress.com/tag/default-files/)
  [DLP](https://penturalabs.wordpress.com/tag/dlp/)
  [Ducky](https://penturalabs.wordpress.com/tag/ducky/)
  [electronics](https://penturalabs.wordpress.com/tag/electronics-2/)
  [Encryption](https://penturalabs.wordpress.com/tag/encryption/)
  [exploit](https://penturalabs.wordpress.com/tag/exploit/)
  [exploitation](https://penturalabs.wordpress.com/tag/exploitation/)
  [firefox](https://penturalabs.wordpress.com/tag/firefox/)
  [flash](https://penturalabs.wordpress.com/tag/flash/)
  [flex](https://penturalabs.wordpress.com/tag/flex/)
  [fuzzing](https://penturalabs.wordpress.com/tag/fuzzing/)
  [Hak5](https://penturalabs.wordpress.com/tag/hak5/)
  [HF](https://penturalabs.wordpress.com/tag/hf/)
  [HID](https://penturalabs.wordpress.com/tag/hid/)
  [IPad](https://penturalabs.wordpress.com/tag/ipad/)
  [java](https://penturalabs.wordpress.com/tag/java/)
  [javascript](https://penturalabs.wordpress.com/tag/javascript/)
  [LF](https://penturalabs.wordpress.com/tag/lf/)
  [Linux](https://penturalabs.wordpress.com/tag/linux/)
  [metasploit](https://penturalabs.wordpress.com/tag/metasploit/)
  [Microsoft Windows](https://penturalabs.wordpress.com/tag/microsoft-windows/)
  [MIFARE](https://penturalabs.wordpress.com/tag/mifare/)
  [Open Source](https://penturalabs.wordpress.com/tag/open-source/)
  [OpenWrt](https://penturalabs.wordpress.com/tag/openwrt/)
  [opinion](https://penturalabs.wordpress.com/tag/opinion/)
  [pentesting](https://penturalabs.wordpress.com/tag/pentesting/)
  [pentura](https://penturalabs.wordpress.com/tag/pentura/)
  [PHP](https://penturalabs.wordpress.com/tag/php/)
  [Pi](https://penturalabs.wordpress.com/tag/pi/)
  [Pineapple](https://penturalabs.wordpress.com/tag/pineapple/)
  [Pololu](https://penturalabs.wordpress.com/tag/pololu/)
  [privacy](https://penturalabs.wordpress.com/tag/privacy/)
  [privilege escalation](https://penturalabs.wordpress.com/tag/privilege-escalation/)
  [Programming](https://penturalabs.wordpress.com/tag/programming/)
  [proxmark](https://penturalabs.wordpress.com/tag/proxmark/)
  [Proxmark3](https://penturalabs.wordpress.com/tag/proxmark3/)
  [Radio](https://penturalabs.wordpress.com/tag/radio/)
  [Raspberry Pi](https://penturalabs.wordpress.com/tag/raspberry-pi/)
  [rdggeek](https://penturalabs.wordpress.com/tag/rdggeek/)
  [RFID](https://penturalabs.wordpress.com/tag/rfid/)
  [robotics](https://penturalabs.wordpress.com/tag/robotics/)
  [robotics week](https://penturalabs.wordpress.com/tag/robotics-week/)
  [rootedcon](https://penturalabs.wordpress.com/tag/rootedcon/)
  [RTL-SDR](https://penturalabs.wordpress.com/tag/rtl-sdr/)
  [SDR](https://penturalabs.wordpress.com/tag/sdr/)
  [security](https://penturalabs.wordpress.com/tag/security/)
  [server audit](https://penturalabs.wordpress.com/tag/server-audit/)
  [snmp](https://penturalabs.wordpress.com/tag/snmp/)
  [social engineering](https://penturalabs.wordpress.com/tag/social-engineering-2/)
  [ssl](https://penturalabs.wordpress.com/tag/ssl-2/)
  [talks](https://penturalabs.wordpress.com/tag/talks/)
  [Telephony](https://penturalabs.wordpress.com/tag/telephony/)
  [twitter](https://penturalabs.wordpress.com/tag/twitter/)
  [USB](https://penturalabs.wordpress.com/tag/usb/)
  [USB Rubber Ducky](https://penturalabs.wordpress.com/tag/usb-rubber-ducky/)
  [web](https://penturalabs.wordpress.com/tag/web/)
  [web security](https://penturalabs.wordpress.com/tag/web-security/)
  [Wi-Fi](https://penturalabs.wordpress.com/tag/wi-fi/)
  [WiFi](https://penturalabs.wordpress.com/tag/wifi/)
  [Windows](https://penturalabs.wordpress.com/tag/windows/)
  [Windows Security](https://penturalabs.wordpress.com/tag/windows-security/)
  [xss](https://penturalabs.wordpress.com/tag/xss/)
  [Zumo](https://penturalabs.wordpress.com/tag/zumo/)

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Comment](https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Pentura Labs's Blog](https://penturalabs.wordpress.com)

  Join 43 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fpenturalabs.wordpress.com%2F2011%2F12%2F13%2Fadvisory-crlf-injection-vulnerability-in-moodle%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Pentura Labs's Blog](https://penturalabs.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fpenturalabs.wordpress.com%2F2011%2F12%2F13%2Fadvisory-crlf-injection-vulnerability-in-moodle%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p11ywI-7K)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://penturalabs.wordpress.com/2011/12/13/advisory-crlf-injection-vulnerability-in-moodle/)
  + [View post in Reader](https://wordpress.com/read/blogs/15147388/posts/480)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from tracker.moodle.org_39f52c75_20250125_234101.html ===

[Log in](/login.jsp?os_destination=%2Fbrowse%2FMDL-24808)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![](/s/-76bxlv/9120016/q6dbaf/_/jira-logo-scaled.png)Moodle Tracker](https://tracker.moodle.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")
* [Capture](/secure/SessionNavigator.jspa "Capture")
  + [Getting started](/secure/BonfireGettingStarted.jspa)

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FMDL-24808)
  + [Mobility for Jira](/plugins/servlet/jiraconnect/MyGetStarted)

# Welcome to Moodle Tracker

You must log in to access this page.

If you think you shouldn't get this message, please contact your Jira administrators.

Username

Password

Remember my login on this computer

Not a member? [Sign up](/secure/Signup%21default.jspa) for an account.

Log In

[Can't access your account?](/secure/ForgotLoginDetails.jspa "Press Alt+` to cancel")

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for Moodle Pty Ltd. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


