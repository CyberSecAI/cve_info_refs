=== Content from www.attrition.org_67d129ec_20250125_012035.html ===

# [VIM] PunBB - more

**Steven M. Christey**
coley at linus.mitre.org

*Tue Sep 26 17:18:57 EDT 2006*

* Previous message: [[VIM] PunBB - more](001052.html)
* Next message: [[VIM] Kietu 3.2 - Local file inclusion](001053.html)
* **Messages sorted by:**
  [[ date ]](date.html#1055)
  [[ thread ]](thread.html#1055)
  [[ subject ]](subject.html#1055)
  [[ author ]](author.html#1055)

---

```

I contacted 3APA3A, who contacted the original researcher, and an exploit
is now in the developer's hands.  I did some cursory analysis and 3APA3A
did some more extensive followup that suggests there is a real issue, but
I'll wait to post details until we hear back from the developer.

- Steve

```

---

* Previous message: [[VIM] PunBB - more](001052.html)
* Next message: [[VIM] Kietu 3.2 - Local file inclusion](001053.html)
* **Messages sorted by:**
  [[ date ]](date.html#1055)
  [[ thread ]](thread.html#1055)
  [[ subject ]](subject.html#1055)
  [[ author ]](author.html#1055)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from www.attrition.org_47fbf5d4_20250125_012034.html ===

# [VIM] PunBB - more

**Steven M. Christey**
coley at mitre.org

*Mon Sep 25 20:22:12 EDT 2006*

* Previous message: [[VIM] Vendor dispute - CVE-2006-4759 (punBB)](001051.html)
* Next message: [[VIM] PunBB - more](001055.html)
* **Messages sorted by:**
  [[ date ]](date.html#1052)
  [[ thread ]](thread.html#1052)
  [[ subject ]](subject.html#1052)
  [[ author ]](author.html#1052)

---

```

ugh.  We mucked this up at CVE.  We didn't notice that the original
exploit was only for phpBB (rather, I think I didn't notice it...)

See the followup analysis in the CVE desc.  I've since sent an email
to 3APA3A asking for specific vectors for punBB.  The ShAnKaR name
rings a bell, but I don't know about his/her reliability.

- Steve

======================================================
Name: CVE-2006-4759
Status: Candidate
URL: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4759>
Reference: BUGTRAQ:20060911 ShAnKaR: multiple PHP application poison NULL byte vulnerability
Reference: URL:<http://www.securityfocus.com/archive/1/archive/1/445788/100/0/threaded>
Reference: BUGTRAQ:20060919 Re: ShAnKaR: multiple PHP application poison NULL byte vulnerability
Reference: URL:<http://www.securityfocus.com/archive/1/archive/1/446420/100/0/threaded>
Reference: MISC:<http://www.security.nnov.ru/Odocument221.html>
Reference: MLIST:[VIM] 20060919 Dispute - CVE-2006-4759 - PunBB
Reference: URL:<http://www.attrition.org/pipermail/vim/2006-September/001041.html>
Reference: XF:phpbb-nullbyte-file-upload(28884)
Reference: URL:<http://xforce.iss.net/xforce/xfdb/28884>

** DISPUTED **

PunBB 1.2.12 does not properly handle pathnames ending in %00, which
allows remote authenticated administrative users to execute arbitrary
code by modifying the name of a previously-uploaded avatar image file
to contain a .php extension.  NOTE: on 20060925, the vendor disputed
the issue to CVE, saying "PunBB doesn't contain a directory called
admin or a script called admin_board.php. The author of the original
report probably thought PunBB was a fork of phpBB (which it is not)."
The original disclosure is from a reliable known party, although the
original researcher is not as well known.  The original disclosure
included an exploit for phpBB but not punBB, so the specific exploit
vectors for punBB are not known.  As of 20060925, CVE is not aware of
any followup by the researcher/discloser and has no position regarding
the dispute.

```

---

* Previous message: [[VIM] Vendor dispute - CVE-2006-4759 (punBB)](001051.html)
* Next message: [[VIM] PunBB - more](001055.html)
* **Messages sorted by:**
  [[ date ]](date.html#1052)
  [[ thread ]](thread.html#1052)
  [[ subject ]](subject.html#1052)
  [[ author ]](author.html#1052)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from www.attrition.org_c8666817_20250125_012033.html ===

# [VIM] Dispute - CVE-2006-4759 - PunBB

**Steven M. Christey**
coley at linus.mitre.org

*Tue Sep 19 20:59:35 EDT 2006*

* Previous message: [[VIM] "new" PowerPoint vuln apparently old](001039.html)
* Next message: [[VIM] clarification: Limbo - Lite Mambo CMS Multiple](001042.html)
* **Messages sorted by:**
  [[ date ]](date.html#1041)
  [[ thread ]](thread.html#1041)
  [[ subject ]](subject.html#1041)
  [[ author ]](author.html#1041)

---

```

See the CVE analysis below.  The original post was by 3APA3A, so I'm
inclined to believe that something's there.  However, the original CVE
description was incorrect with respect to the Bugtraq post, which might be
a partial explanation for the dispute.  I'll forward the response.

I'm not sure at this instant whether Smartys is the developer or a
power-user/power-admin.

- Steve

---------- Forwarded message ----------
Date: Tue, 19 Sep 2006 20:13:12 -0400
From: Smartys
To: [cve at mitre.org](http://www.attrition.org/mailman/listinfo/vim)
Subject: CVE-2006-4759

To whom it may concern,
I'm writing about the vulnerability identified as CVE-2006-4759 because
the specified vulnerability does not exist. PunBB does not ever use the
given filenames of uploaded files, opting instead to use the user's ID
from the database, which is known to be safe. Thus, adding a null byte
to the name of an avatar to be uploaded would not allow for the
uploading of arbitrary files as claimed by the report.

Thanks,
Smartys

======================================================
Name: CVE-2006-4759
Status: Candidate
URL: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4759>
Acknowledged: unknown
Announced: 20060911
Flaw: other
Reference: BUGTRAQ:20060911 ShAnKaR: multiple PHP application poison NULL byte vulnerability
Reference: URL:<http://www.securityfocus.com/archive/1/archive/1/445788/100/0/threaded>
Reference: MISC:<http://www.security.nnov.ru/Odocument221.html>
Reference: XF:phpbb-nullbyte-file-upload(28884)
Reference: URL:<http://xforce.iss.net/xforce/xfdb/28884>

** DISPUTED **

admin/admin_board.php in PunBB 1.2.12 does not properly handle
pathnames ending in %00, which allows remote authenticated
administrative users to execute arbitrary code by modifying the name
of a previously-uploaded avatar image file to contain a .php
extension.  NOTE: on 20060919, this issue was disputed to CVE, saying
"PunBB does not ever use the given filenames of uploaded files, opting
instead to use the user's ID from the database, which is known to be
safe."  The original researcher is known to be reliable.  The dispute
might be based on the original CVE description, which erroneously
claimed that the attack occured in a filename as it was being
uploaded.

Analysis:
ACCURACY: It is "administrative users" because the researcher's phpBB
exploit refers to an admin user and admin operations, and it is
expected that the researcher would have noted that PunBB exploitation
were accessible to ordinary or unauthenticated users.

ACCURACY: the researcher says that the issue arises when the
administrator changes the location of the avatar file.  This assumes
that the avatar file has been uploaded.  The demonstration exploit
uses admin/admin_board.php to rename the avatar to "shell.php"
followed by a null byte, which probably bypasses any regular
expression checks that occur on the filename.  Because some EXIF data
is freeform, the original avatar can pass a check for a valid image
format, but contain PHP code that can be executed once the file has
been renamed.

ABSTRACTION: Nothing was found suggesting a shared codebase with
phpBB. PunBB (the newer of the two) is apparently not a fork of phpBB.
The PunBB About page says "The idea of PunBB was first born when I
needed a discussion board ... [it] was nowhere to be found. Thus, I
started working on PunBB."

```

---

* Previous message: [[VIM] "new" PowerPoint vuln apparently old](001039.html)
* Next message: [[VIM] clarification: Limbo - Lite Mambo CMS Multiple](001042.html)
* **Messages sorted by:**
  [[ date ]](date.html#1041)
  [[ thread ]](thread.html#1041)
  [[ subject ]](subject.html#1041)
  [[ author ]](author.html#1041)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)


