```
{
  "cve": "CVE-2006-4548",
  "description": "The e107 exploit described allows remote command execution due to a GLOBALS[] overwrite vulnerability and a Zend_Hash_Del_Key_Or_Index vulnerability. The vulnerability exists in class2.php and e107_handlers/tiny_mce/plugins/ibrowser/ibrowser.php of e107 <= 0.75 versions.",
  "vulnerability_details": {
    "root_cause": "The vulnerability arises from two issues:\n\n1.  **GLOBALS[] overwrite**: The code in `class2.php` attempts to unset global variables using a loop and `unset($$global)`. However, it fails to properly sanitize the `$global` variable, allowing an attacker to overwrite the `$GLOBALS` array by sending a crafted request with `GLOBALS` as a key in a multipart/form-data request.\n2.  **Zend_Hash_Del_Key_Or_Index**: The code in `e107_handlers/tiny_mce/plugins/ibrowser/ibrowser.php` includes a file specified by `$tinyMCE_imglib_include` variable without proper sanitization. Combined with the GLOBALS overwrite, an attacker can set a custom path in `$tinyMCE_imglib_include` through the crafted multipart/form-data request and then trigger the inclusion leading to command execution.",
    "weaknesses": [
      "Improper sanitization of global variables in `class2.php` leading to GLOBALS overwrite.",
      "Unsafe inclusion of file specified by `$tinyMCE_imglib_include` in `ibrowser.php`.",
      "Use of `unset($$global)` without proper sanitization allows for variable overwrite.",
      "Vulnerable to `Zend_Hash_Del_Key_Or_Index` vulnerability, allowing setting a controlled path for inclusion"
    ],
        "impact": "Successful exploitation allows an attacker to execute arbitrary commands on the server hosting the vulnerable e107 installation.",
        "attack_vectors": {
        "attack_vector": "The attacker sends a specially crafted multipart/form-data POST request to the vulnerable ibrowser.php script, including the `GLOBALS` key and `tinyMCE_imglib_include`. The value of `tinyMCE_imglib_include` points to a temporary file containing php code for command execution. The script will then include the file with malicious code, achieving remote command execution."
    },
        "attacker_capabilities": {
      "required_capabilities": "The attacker needs to be able to send HTTP POST requests to the target web server.",
      "required_position": "The attacker can be remote."
    }
  }
}
```