=== Content from www.attrition.org_0a109476_20250124_155347.html ===

# [VIM] Jetbox CMS file include - CVE dispute

**Heinbockel, Bill**
heinbockel at mitre.org

*Tue Aug 29 14:07:16 EDT 2006*

* Previous message: [[VIM] Jupiter CMS file include - CVE dispute](000996.html)
* Next message: [[VIM] Jetbox CMS file include - CVE dispute](001003.html)
* **Messages sorted by:**
  [[ date ]](date.html#997)
  [[ thread ]](thread.html#997)
  [[ subject ]](subject.html#997)
  [[ author ]](author.html#997)

---

```
Since this has appeared on BUGTRAQ from two different researchers
over the span of the past couple of days:

Researcher: D3nGeR
BUGTRAQ:20060825 Jetbox CMS search_function.php Remote File
<http://www.securityfocus.com/archive/1/archive/1/444422/100/0/threaded>

Researcher: CarcaBot
BUGTRAQ:20060828 JetBox cms (search_function.php) Remote File Include
<http://www.securityfocus.com/archive/1/archive/1/444527/100/0/threaded>

Source code analysis of includes/phpdig/libs/search_function.php in
Jetbox CMS 2.1.SR1 shows the line(s) being referenced
> Line 423:   <?php include
$relative_script_path.'/libs/htmlheader.php' ?>
> Line 426:   <?php include $relative_script_path.'/libs/htmlmetas.php'
?>

However, these lines are included within the following function,
declared
at the top of the file: (Lines 18-21)
>	function phpdigSearch($id_connect, $query_string,
$option='start', $refine=0,
>		$refine_url='', $lim_start=0, $limite=10, $browse=0,
>		$site=0, $path='', $relative_script_path = '.',
$template='',
>		$template_links='')

This function is called from line 46 in search.php, with the
$relative_script_path
variable, which is statically declared on line 26:
>  $relative_script_path='includes/phpdig';

We see no way to exploit this, so CVE is marking as DISPUTED.

William Heinbockel
Infosec Engineer
The MITRE Corporation
202 Burlington Rd. MS S145
Bedford, MA 01730
[heinbockel at mitre.org](http://www.attrition.org/mailman/listinfo/vim)
781-271-2615

```

---

* Previous message: [[VIM] Jupiter CMS file include - CVE dispute](000996.html)
* Next message: [[VIM] Jetbox CMS file include - CVE dispute](001003.html)
* **Messages sorted by:**
  [[ date ]](date.html#997)
  [[ thread ]](thread.html#997)
  [[ subject ]](subject.html#997)
  [[ author ]](author.html#997)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from www.attrition.org_28bfdccf_20250124_155347.html ===

# [VIM] Jetbox CMS file include - CVE dispute

**Steven M. Christey**
coley at linus.mitre.org

*Tue Aug 29 19:57:37 EDT 2006*

* Previous message: [[VIM] Jetbox CMS file include - CVE dispute](000997.html)
* Next message: [[VIM] Jetbox CMS file include - CVE dispute](001004.html)
* **Messages sorted by:**
  [[ date ]](date.html#1003)
  [[ thread ]](thread.html#1003)
  [[ subject ]](subject.html#1003)
  [[ author ]](author.html#1003)

---

```

I have to put up a retraction - the issue looks real.

Bill said:

> > Line 423:   <?php include
> $relative_script_path.'/libs/htmlheader.php' ?>
> > Line 426:   <?php include $relative_script_path.'/libs/htmlmetas.php'
> ?>
>
> However, these lines are included within the following function,
> declared
> at the top of the file: (Lines 18-21)

FYI, someone else disputed this, too.

I don't know how I wound up down this rabbit hole after Bill analyzed it,
but I think we missed something.

1) if there's a "<?php" in the function definition, then that means there
are nested <?php tags - not sure if that's even allowed.  My PHP 4.x gives
a parse error.

2) So - maybe, despite appearances, this is being done *outside* the
function definition, in which case the <?php> is executed as soon as it's
parsed, which means there's a vuln.

  And in fact, we have this:

    else {
    ?>
    <?php include $relative_script_path.'/libs/htmlheader.php' ?>

So, I think that's what's going on.

3) Note - the path to the search_function.php suggested a third party
   product, phpdig.  I downloaded the source code for phpdig, and 1.8.8
   has the "search_function.php" file, and the most recent version renamed
   this to "search_functions.php".

- Steve

```

---

* Previous message: [[VIM] Jetbox CMS file include - CVE dispute](000997.html)
* Next message: [[VIM] Jetbox CMS file include - CVE dispute](001004.html)
* **Messages sorted by:**
  [[ date ]](date.html#1003)
  [[ thread ]](thread.html#1003)
  [[ subject ]](subject.html#1003)
  [[ author ]](author.html#1003)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)


