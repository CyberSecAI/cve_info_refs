=== Content from bugs.debian.org_9c4cbd15_20250124_191116.html ===

# Debian Bug report logs - #349528 various unfixed security bugs

[![version graph](version.cgi?fixed=2.6.1%2Br1638-1;package=elog;absolute=0;collapse=1;found=elog%2F2.6.0beta2%2Br1716-1;height=2;width=2)](version.cgi?package=elog;absolute=0;fixed=2.6.1%2Br1638-1;found=elog%2F2.6.0beta2%2Br1716-1;collapse=1;info=1)

Package:
[elog](pkgreport.cgi?package=elog);
Maintainer for [elog](pkgreport.cgi?package=elog) is [(unknown)](pkgreport.cgi?maint=);

Reported by: [Florian Weimer <fw@deneb.enyo.de>](pkgreport.cgi?submitter=fw%40deneb.enyo.de)

Date: Mon, 23 Jan 2006 15:48:16 UTC

Severity: *grave*

Tags: fixed, fixed-upstream, security, upstream

Found in version elog/2.6.0beta2+r1716-1

Fixed in version 2.6.1+r1638-1

**Done:** "Adam D. Barratt" <debian-bts@adam-barratt.org.uk>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=349528;mbox=yes), [status mbox](bugreport.cgi?bug=349528;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=349528;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=2), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

New Bug report received and forwarded. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=4), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=5), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: submit@bugs.debian.org
Subject: various unfixed security bugs
Date: Mon, 23 Jan 2006 16:42:16 +0100
```
Package: elog
Version: 2.6.0beta2+r1716-1
Tags: security upstream fixed-upstream
Severity: grave

First a little version cross-reference, based on the src/elog{,d}.c
files.

  Debian              CVS (elogd.c)    Subversion
  2.6.0beta2+r1716-1  1.717*           r1445
  2.5.7+r1558-3       1.558 + 1.648    r1202 + r1347

* Part of the upstream are contained in the .diff.gz file, so the
  embedded version number is not quite correct.

The following issues are unfixed upstream:

  - [CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439): buffer overflow through long URL parameters
    <<http://marc.theaimsgroup.com/?m=113498708213563>>

  - If host names are resolved, no forward lookup is performed to
    verify the PTR RR.  (This does not affect the sarge version
    because it unconditionally uses addresses, not host names.)

  - There are still some format string issues when things are written
    to the logfile.

Apparently, upstream is not aware of those three issues.

The following potential security issues have been fixed upstream, but
not in the sid version (there are some more issues apparently, but
those bugs were introduced past the sid version AFAICS):

------------------------------------------------------------------------
r1529 | ritt | 2005-10-25 20:26:34 +0200 (Tue, 25 Oct 2005) | 1 line
Changed paths:
   M /trunk/src/elogd.c

Fixed bug with fprintf and buffer containing "%"

------------------------------------------------------------------------
r1472 | ritt | 2005-08-04 22:26:35 +0200 (Thu, 04 Aug 2005) | 2 lines
Changed paths:
   M /trunk/src/elog.c
   M /trunk/src/elogd.c

Do not distinguish between invalid user name and invalid password for security reasons

On top of that, the following issues affect the sarge version only:

------------------------------------------------------------------------
r1335 | ritt | 2005-04-27 12:43:43 +0200 (Wed, 27 Apr 2005) | 2 lines
Changed paths:
   M /trunk/src/elogd.c

Applied patch from Emiliano to fix possible buffer overflow

------------------------------------------------------------------------
r1333 | ritt | 2005-04-22 15:41:18 +0200 (Fri, 22 Apr 2005) | 2 lines
Changed paths:
   M /trunk/src/elogd.c

Fixed crashes with very long (revisions) attributes

I've back-ported all four issues to the sarge version, but they
haven't received any testing yet.  If anybody has got a sarge elog
installation, please speak up.

I'm going to ask upstream about the following issue:

------------------------------------------------------------------------
r1487 | ritt | 2005-09-09 22:59:46 +0200 (Fri, 09 Sep 2005) | 2 lines
Changed paths:
   M /trunk/src/elogd.c

Fixed infinite redirection with ?fail=1

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=7), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Recai Oktaş <roktas@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=9), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=10), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=roktas%40debian.org)
From: Recai Oktaş <roktas@debian.org>
To: Florian Weimer <fw@deneb.enyo.de>, 349528@bugs.debian.org
Cc: Stefan Ritt <stefan.ritt@psi.ch>
Subject: Re: Bug#349528: various unfixed security bugs
Date: Tue, 24 Jan 2006 00:39:00 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=349528;msg=10) (text/plain, inline)]
```
```
First of all thanks for the detailed analysis!  I haven't been able to work
on elog much, due to heavy work load these days.

* Florian Weimer [2006-01-23 16:42:16+0100]
> Package: elog
> Version: 2.6.0beta2+r1716-1
> Tags: security upstream fixed-upstream
> Severity: grave
>
> First a little version cross-reference, based on the src/elog{,d}.c
> files.
>
>   Debian              CVS (elogd.c)    Subversion
>   2.6.0beta2+r1716-1  1.717*           r1445
>   2.5.7+r1558-3       1.558 + 1.648    r1202 + r1347
>
> * Part of the upstream are contained in the .diff.gz file, so the
>   embedded version number is not quite correct.
>
> The following issues are unfixed upstream:
>
>   - [CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439): buffer overflow through long URL parameters
>     <<http://marc.theaimsgroup.com/?m=113498708213563>>
>
>   - If host names are resolved, no forward lookup is performed to
>     verify the PTR RR.  (This does not affect the sarge version
>     because it unconditionally uses addresses, not host names.)
>
>   - There are still some format string issues when things are written
>     to the logfile.
>
> Apparently, upstream is not aware of those three issues.
>
> The following potential security issues have been fixed upstream, but
> not in the sid version (there are some more issues apparently, but
> those bugs were introduced past the sid version AFAICS):

I'm going to prepare an urgent sid upload for those bugs.

>
> ------------------------------------------------------------------------
> r1529 | ritt | 2005-10-25 20:26:34 +0200 (Tue, 25 Oct 2005) | 1 line
> Changed paths:
>    M /trunk/src/elogd.c
>
> Fixed bug with fprintf and buffer containing "%"
>
> ------------------------------------------------------------------------
> r1472 | ritt | 2005-08-04 22:26:35 +0200 (Thu, 04 Aug 2005) | 2 lines
> Changed paths:
>    M /trunk/src/elog.c
>    M /trunk/src/elogd.c
>
> Do not distinguish between invalid user name and invalid password for security reasons
>
>
>
> On top of that, the following issues affect the sarge version only:
>
> ------------------------------------------------------------------------
> r1335 | ritt | 2005-04-27 12:43:43 +0200 (Wed, 27 Apr 2005) | 2 lines
> Changed paths:
>    M /trunk/src/elogd.c
>
> Applied patch from Emiliano to fix possible buffer overflow
>
> ------------------------------------------------------------------------
> r1333 | ritt | 2005-04-22 15:41:18 +0200 (Fri, 22 Apr 2005) | 2 lines
> Changed paths:
>    M /trunk/src/elogd.c
>
> Fixed crashes with very long (revisions) attributes
>
>
> I've back-ported all four issues to the sarge version, but they
> haven't received any testing yet.  If anybody has got a sarge elog
> installation, please speak up.

Thanks for the backport, unfortunately I don't have a Sarge box at the
moment, but will try to find one.  Could you please supply the url of
backported patch so that I can also work on it?

> I'm going to ask upstream about the following issue:
>
> ------------------------------------------------------------------------
> r1487 | ritt | 2005-09-09 22:59:46 +0200 (Fri, 09 Sep 2005) | 2 lines
> Changed paths:
>    M /trunk/src/elogd.c
>
> Fixed infinite redirection with ?fail=1

CCing to Stefan.

[Stefan: Please keep the discussion CCed to the bug report]

Regards,

--
roktas

```
```
[[signature.asc](bugreport.cgi?att=1;bug=349528;filename=signature.asc;msg=10) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=12), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=14), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=15), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: Recai Oktaş <roktas@debian.org>
Cc: 349528@bugs.debian.org, Stefan Ritt <stefan.ritt@psi.ch>
Subject: Re: Bug#349528: various unfixed security bugs
Date: Tue, 24 Jan 2006 00:07:35 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=349528;msg=15) (text/plain, inline)]
```
```
* Recai Oktaş:

> Thanks for the backport, unfortunately I don't have a Sarge box at the
> moment, but will try to find one.

A sarge chroot is probably good enough for this kind of package.

>> The following potential security issues have been fixed upstream, but
>> not in the sid version (there are some more issues apparently, but
>> those bugs were introduced past the sid version AFAICS):
>
> I'm going to prepare an urgent sid upload for those bugs.

I'm not sure if it is worth the effort, until we have all other issues
sorted out.

> Thanks for the backport, unfortunately I don't have a Sarge box at the
> moment, but will try to find one.  Could you please supply the url of
> backported patch so that I can also work on it?

Okay, the four patches for sarge I've got so far are included below.
Patch five and six address a few issues I spotted while backporting.
Everything is completely untested.

```
```
[[0001-r1333-Fixed-crashes-with-very-long-revisions-attributes.txt](bugreport.cgi?att=1;bug=349528;filename=0001-r1333-Fixed-crashes-with-very-long-revisions-attributes.txt;msg=15) (text/plain, attachment)]
```
```
[[0002-r1335-Applied-patch-from-Emiliano-to-fix-possible-buffer-overflow.txt](bugreport.cgi?att=2;bug=349528;filename=0002-r1335-Applied-patch-from-Emiliano-to-fix-possible-buffer-overflow.txt;msg=15) (text/plain, attachment)]
```
```
[[0003-r1472-Do-not-distinguish-between-invalid-user-name-and-invalid-password.txt](bugreport.cgi?att=3;bug=349528;filename=0003-r1472-Do-not-distinguish-between-invalid-user-name-and-invalid-password.txt;msg=15) (text/plain, attachment)]
```
```
[[0004-r1529-Fixed-bug-with-fprintf-and-buffer-containing.txt](bugreport.cgi?att=4;bug=349528;filename=0004-r1529-Fixed-bug-with-fprintf-and-buffer-containing.txt;msg=15) (text/plain, attachment)]
```
```
[[0005-Fix-potential-format-string-issues-when-calling-write_logfile.txt](bugreport.cgi?att=5;bug=349528;filename=0005-Fix-potential-format-string-issues-when-calling-write_logfile.txt;msg=15) (text/plain, attachment)]
```
```
[[0006-Fix-potential-buffer-overflow-in-write_logfile.txt](bugreport.cgi?att=6;bug=349528;filename=0006-Fix-potential-buffer-overflow-in-write_logfile.txt;msg=15) (text/plain, attachment)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=17), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent** to `Stefan Ritt <stefan.ritt@psi.ch>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=19), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=20), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=stefan.ritt%40psi.ch)
From: Stefan Ritt <stefan.ritt@psi.ch>
To: Recai Oktaş <roktas@debian.org>
Cc: Florian Weimer <fw@deneb.enyo.de>, 349528@bugs.debian.org
Subject: Re: Bug#349528: various unfixed security bugs
Date: Tue, 24 Jan 2006 08:23:39 +0100
```
Dear all,

thanks for reporting these issues. I was completely unaware of them
until today. I will fix all things in the next days and let you know.

Best regards,

  Stefan

Recai Oktaş wrote:
> First of all thanks for the detailed analysis!  I haven't been able to work
> on elog much, due to heavy work load these days.
>
> * Florian Weimer [2006-01-23 16:42:16+0100]
>> Package: elog
>> Version: 2.6.0beta2+r1716-1
>> Tags: security upstream fixed-upstream
>> Severity: grave
>>
>> First a little version cross-reference, based on the src/elog{,d}.c
>> files.
>>
>>   Debian              CVS (elogd.c)    Subversion
>>   2.6.0beta2+r1716-1  1.717*           r1445
>>   2.5.7+r1558-3       1.558 + 1.648    r1202 + r1347
>>
>> * Part of the upstream are contained in the .diff.gz file, so the
>>   embedded version number is not quite correct.
>>
>> The following issues are unfixed upstream:
>>
>>   - [CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439): buffer overflow through long URL parameters
>>     <<http://marc.theaimsgroup.com/?m=113498708213563>>
>>
>>   - If host names are resolved, no forward lookup is performed to
>>     verify the PTR RR.  (This does not affect the sarge version
>>     because it unconditionally uses addresses, not host names.)
>>
>>   - There are still some format string issues when things are written
>>     to the logfile.
>>
>> Apparently, upstream is not aware of those three issues.
>>
>> The following potential security issues have been fixed upstream, but
>> not in the sid version (there are some more issues apparently, but
>> those bugs were introduced past the sid version AFAICS):
>
> I'm going to prepare an urgent sid upload for those bugs.
>
>> ------------------------------------------------------------------------
>> r1529 | ritt | 2005-10-25 20:26:34 +0200 (Tue, 25 Oct 2005) | 1 line
>> Changed paths:
>>    M /trunk/src/elogd.c
>>
>> Fixed bug with fprintf and buffer containing "%"
>>
>> ------------------------------------------------------------------------
>> r1472 | ritt | 2005-08-04 22:26:35 +0200 (Thu, 04 Aug 2005) | 2 lines
>> Changed paths:
>>    M /trunk/src/elog.c
>>    M /trunk/src/elogd.c
>>
>> Do not distinguish between invalid user name and invalid password for security reasons
>>
>>
>>
>> On top of that, the following issues affect the sarge version only:
>>
>> ------------------------------------------------------------------------
>> r1335 | ritt | 2005-04-27 12:43:43 +0200 (Wed, 27 Apr 2005) | 2 lines
>> Changed paths:
>>    M /trunk/src/elogd.c
>>
>> Applied patch from Emiliano to fix possible buffer overflow
>>
>> ------------------------------------------------------------------------
>> r1333 | ritt | 2005-04-22 15:41:18 +0200 (Fri, 22 Apr 2005) | 2 lines
>> Changed paths:
>>    M /trunk/src/elogd.c
>>
>> Fixed crashes with very long (revisions) attributes
>>
>>
>> I've back-ported all four issues to the sarge version, but they
>> haven't received any testing yet.  If anybody has got a sarge elog
>> installation, please speak up.
>
> Thanks for the backport, unfortunately I don't have a Sarge box at the
> moment, but will try to find one.  Could you please supply the url of
> backported patch so that I can also work on it?
>
>> I'm going to ask upstream about the following issue:
>>
>> ------------------------------------------------------------------------
>> r1487 | ritt | 2005-09-09 22:59:46 +0200 (Fri, 09 Sep 2005) | 2 lines
>> Changed paths:
>>    M /trunk/src/elogd.c
>>
>> Fixed infinite redirection with ?fail=1
>
> CCing to Stefan.
>
> [Stefan: Please keep the discussion CCed to the bug report]
>
> Regards,
>

--
Dr. Stefan Ritt           Phone: +41 56 310 3728
Paul Scherrer Institute   FAX: +41 56 310 2199
OLGA/021                  mailto:stefan.ritt@psi.ch
CH-5232 Villigen PSI      <http://midas.psi.ch/~stefan>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=22), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent** to `Recai Oktaş <roktas@omu.edu.tr>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=349528;msg=24), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=25), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=roktas%40omu.edu.tr)
From: Recai Oktaş <roktas@omu.edu.tr>
To: Florian Weimer <fw@deneb.enyo.de>
Cc: 349528@bugs.debian.org
Subject: Re: Bug#349528: various unfixed security bugs
Date: Tue, 24 Jan 2006 09:25:21 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=349528;msg=25) (text/plain, inline)]
```
```
Hi,

* Florian Weimer [2006-01-24 00:07:35+0100]
> * Recai Oktaş:
>
> > I'm going to prepare an urgent sid upload for those bugs.
>
> I'm not sure if it is worth the effort, until we have all other issues
> sorted out.

Agreed.  I would be glad if you add yourself in "Uploaders" field.  You're
totally free to make any upload.

--
roktas

```
```
[[signature.asc](bugreport.cgi?att=1;bug=349528;filename=signature.asc;msg=25) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=27), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=29), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=30), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: Recai Oktaş <roktas@omu.edu.tr>
Cc: 349528@bugs.debian.org
Subject: Re: Bug#349528: various unfixed security bugs
Date: Tue, 24 Jan 2006 12:56:03 +0100
```
* Recai Oktaş:

>> I'm not sure if it is worth the effort, until we have all other issues
>> sorted out.
>
> Agreed.  I would be glad if you add yourself in "Uploaders" field.
> You're totally free to make any upload.

Uhm, I don't use elog myself and have zero interest in that package
beyond that there are several unfixed high-severity security bugs in
it.

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=32), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=32), [link](#31)).

---

**Acknowledgement sent** to `Stefan Ritt <stefan.ritt@psi.ch>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=34), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=35), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=stefan.ritt%40psi.ch)
From: Stefan Ritt <stefan.ritt@psi.ch>
To: Florian Weimer <fw@deneb.enyo.de>, roktas@debian.org,
349528@bugs.debian.org
Subject: Re: Security bugs in elog
Date: Tue, 24 Jan 2006 21:26:20 +0100
```
Hi,

I fixed the issues reported in
<http://marc.theaimsgroup.com/?m=113498708213563> in ELOG revision r1635.
I encourage you to update as soon as possible.

>   - If host names are resolved, no forward lookup is performed to
>     verify the PTR RR.  (This does not affect the sarge version
>     because it unconditionally uses addresses, not host names.)

Can you specify what you mean by that exactly?

>   - There are still some format string issues when things are written
>     to the logfile.

I thought I have fixed these things already some time ago. Can you
recheck revison 1635?

> Apart from that, I discovered the following recent security fixes in
> the subversion repository:
>
> r1529: Fixed bug with fprintf and buffer containing "%"
> r1472: Do not distinguish between invalid user name and invalid password
> r1335: Applied patch from Emiliano to fix possible buffer overflow
> r1333: Fixed crashes with very long (revisions) attributes

I believe so.

> Is this list complete as far as fixes past r1202 are concerned?  What
> about r1487, is it a significant DoS condition?

Yes.

Best regards,

  Stefan

--
Dr. Stefan Ritt           Phone: +41 56 310 3728
Paul Scherrer Institute   FAX: +41 56 310 2199
OLGA/021                  mailto:stefan.ritt@psi.ch
CH-5232 Villigen PSI      <http://midas.psi.ch/~stefan>

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=37), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=37), [link](#36)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=39), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=39), [link](#38)).

---

[Message #40](#40) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=40), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=40), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: Stefan Ritt <stefan.ritt@psi.ch>
Cc: roktas@debian.org, 349528@bugs.debian.org
Subject: Re: Security bugs in elog
Date: Tue, 24 Jan 2006 21:51:00 +0100
```
* Stefan Ritt:

>>   - If host names are resolved, no forward lookup is performed to
>>     verify the PTR RR.  (This does not affect the sarge version
>>     because it unconditionally uses addresses, not host names.)
>
> Can you specify what you mean by that exactly?

If I read the code correctly, it just requests the PTR record from
DNS, and logs the host name that is returned.

Suppose that I added

171.189.9.212.in-addr.arpa. 172800 IN PTR    deneb.debian.org.

to the 189.9.212.in-addr.arpa zone (which I technically control
because it's IP address space).  Now deneb.debian.org does not belong
to me, so this is forgery.  In order to detect such things, you have
to perform a forward lookup as well (which would fail in this case
because deneb.debian.org is not an official host name used by Debian)
and check that the returned IP addresses, if any, include the IP
address you started with.  Since DNS is quite dynamic, it's also a
good idea to include IP address information in the log file in all
cases, even if a proper host name was found in DNS.

>>   - There are still some format string issues when things are written
>>     to the logfile.
>
> I thought I have fixed these things already some time ago. Can you
> recheck revison 1635?

There are still many lines that read:

   write_logfile(lbs, str);

However, the second argument of write_logfile is passed to vsprintf
(which should be turned into vsnprintf, by the way), so it should be a
real format string, and not some user input.  The 0005 patch I sent
tries to address that (but for the version in Debian stable).

>> Is this list complete as far as fixes past r1202 are concerned?  What
>> about r1487, is it a significant DoS condition?
>
> Yes.

Okay, this patch shouldn't be too hard to extract.  Recai, could you
backport that one and the fixes from r1635 to stable?

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=42), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=42), [link](#41)).

---

**Acknowledgement sent** to `Recai Oktaş <roktas@omu.edu.tr>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=349528;msg=44), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=44), [link](#43)).

---

[Message #45](#45) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=45), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=45), reply):

![](/cgi-bin/libravatar.cgi?email=roktas%40omu.edu.tr)
From: Recai Oktaş <roktas@omu.edu.tr>
To: Florian Weimer <fw@deneb.enyo.de>
Cc: 349528@bugs.debian.org
Subject: Re: Security bugs in elog
Date: Wed, 25 Jan 2006 09:34:15 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=349528;msg=45) (text/plain, inline)]
```
```
* Florian Weimer [2006-01-24 21:51:00+0100]
> * Stefan Ritt:
> >> Is this list complete as far as fixes past r1202 are concerned?  What
> >> about r1487, is it a significant DoS condition?
> >
> > Yes.
>
> Okay, this patch shouldn't be too hard to extract.  Recai, could you
> backport that one and the fixes from r1635 to stable?

OK.  I'm sending three separate patches attached for your review:

    * 0007-r1635-Fix-CVE-2005-4439.txt
      Backport r1635: targets to fix [CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439)

    * 0008-r1487-Fix-DoS-condition.txt
      Backport r1487: fixes infinite redirection

    * 0009-r1636-Add-IP-address-to-logfile.txt [optional]
      Backport r1636: adds IP address to log file

All three patches + your previous six patches were applied and compiled
successfully.  I've also tested the fixed package in my system without any
glitches.  Now, I'm going to build and test it in a Sarge chroot jail.

Hope I haven't missed anything.

Regards,

--
roktas

```
```
[[0007-r1635-Fix-CVE-2005-4439.txt](bugreport.cgi?att=1;bug=349528;filename=0007-r1635-Fix-CVE-2005-4439.txt;msg=45) (text/plain, attachment)]
```
```
[[0008-r1487-Fix-DoS-condition.txt](bugreport.cgi?att=2;bug=349528;filename=0008-r1487-Fix-DoS-condition.txt;msg=45) (text/plain, attachment)]
```
```
[[0009-r1636-Add-IP-address-to-logfile.txt](bugreport.cgi?att=3;bug=349528;filename=0009-r1636-Add-IP-address-to-logfile.txt;msg=45) (text/plain, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=4;bug=349528;filename=signature.asc;msg=45) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=47), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=47), [link](#46)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=49), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=49), [link](#48)).

---

[Message #50](#50) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=50), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=50), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: Stefan Ritt <stefan.ritt@psi.ch>
Cc: 349528@bugs.debian.org
Subject: Re: Security bugs in elog
Date: Wed, 25 Jan 2006 11:55:59 +0100
```
* Stefan Ritt:

> Florian Weimer wrote:
>> address you started with.  Since DNS is quite dynamic, it's also a
>> good idea to include IP address information in the log file in all
>> cases, even if a proper host name was found in DNS.
>
> So I put the IP address there in any case, committed in revision 1636.

Thanks.

>> However, the second argument of write_logfile is passed to vsprintf
>> (which should be turned into vsnprintf, by the way), so it should be a
>> real format string, and not some user input.  The 0005 patch I sent
>> tries to address that (but for the version in Debian stable).
>
> That's not true anymore. Inside write_logfile, I do not use vsprintf any
> more, instead I use strlcat() which should be safe.

Okay, the current version in your Subversion repository should be safe
indeed.  I missed the strlcat change, as I looked mostly at the Debian
versions.

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=52), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=52), [link](#51)).

---

**Acknowledgement sent** to `Recai Oktaş <roktas@omu.edu.tr>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=349528;msg=54), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=54), [link](#53)).

---

[Message #55](#55) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=55), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=55), reply):

![](/cgi-bin/libravatar.cgi?email=roktas%40omu.edu.tr)
From: Recai Oktaş <roktas@omu.edu.tr>
To: 349528@bugs.debian.org
Cc: Florian Weimer <fw@deneb.enyo.de>, Stefan Ritt <stefan.ritt@psi.ch>
Subject: Re: Security bugs in elog
Date: Thu, 26 Jan 2006 11:00:39 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=349528;msg=55) (text/plain, inline)]
```
```
* Recai Oktaş [2006-01-25 09:34:15+0200]
> All three patches + your previous six patches were applied and compiled
> successfully.  I've also tested the fixed package in my system without any
> glitches.  Now, I'm going to build and test it in a Sarge chroot jail.

I've just tested the _pbuilded_ Sarge package against the [CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439)
vulnerability and confirmed that elogd behaved normally (no core dump).

Florian: If you haven't any objections, I'll upload to stable-security
(with some final cosmetic touches).  Also, the new upstream package will
follow (for sid).

Stefan: Thank you very much for the urgent fix.

Regards,

--
roktas

```
```
[[signature.asc](bugreport.cgi?att=1;bug=349528;filename=signature.asc;msg=55) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=57), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=57), [link](#56)).

---

**Acknowledgement sent** to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=59), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=60), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: Recai Oktaş <roktas@omu.edu.tr>
Cc: 349528@bugs.debian.org, Stefan Ritt <stefan.ritt@psi.ch>
Subject: Re: Bug#349528: Security bugs in elog
Date: Thu, 26 Jan 2006 13:41:53 +0100
```
* Recai Oktaş:

> * Recai Oktaş [2006-01-25 09:34:15+0200]
> Florian: If you haven't any objections, I'll upload to stable-security

You need to coordinate this with the stable-security team.  If you
could upload a new upstream version to unstable, this would be fine,
though.

So far, the patch for [CVE-2006-0347](https://security-tracker.debian.org/tracker/CVE-2006-0347) was missing. A tentative backport
of the upstream fix is included below.  I dropped the hunk which dealt
with "scripts" support because this functionality is not present in
the sarge version.

The changelog entry should look like this:

  Backport revision 1620 from upstream Subversion repository:
  "Prohibit '..' in URLs" [[CVE-2006-0347](https://security-tracker.debian.org/tracker/CVE-2006-0347)]

diff --git a/src/elogd.c b/src/elogd.c
index a24f27e..dbf2101 100755
--- a/src/elogd.c
+++ b/src/elogd.c
@@ -20872,6 +20872,25 @@ void server_loop(void)
             setcfg_topgroup("");

             p = strchr(net_buffer, '/') + 1;
+
+            /* check for ../.. to avoid serving of files on top of the elog directory */
+            for (i = 0; p[i] && p[i] != ' ' && p[i] != '?'; i++)
+               url[i] = p[i];
+            url[i] = 0;
+
+            if (strstr(url, "../..")) {
+               sprintf(str, "Invalid URL: %s", url);
+               show_error(str);
+               send(_sock, return_buffer, strlen_retbuf + 1, 0);
+               keep_alive = 0;
+               if (verbose) {
+                  eprintf("==== Return ================================\n");
+                  eputs(return_buffer);
+                  eprintf("\n\n");
+               }
+               goto finished;
+            }
+
             logbook[0] = 0;
             for (i = 0; *p && *p != '/' && *p != '?' && *p != ' '; i++)
                logbook[i] = *p++;
@@ -20935,6 +20954,21 @@ void server_loop(void)
                 strstr(logbook, ".jpg") || strstr(logbook, ".png") ||
                 strstr(logbook, ".ico") || strstr(logbook, ".htm")
                 || strstr(logbook, ".css")) {
+
+               /* do not allow '..' in file name */
+               if (strstr(logbook, "..")) {
+                  sprintf(str, "Invalid URL: %s", logbook);
+                  show_error(str);
+                  send(_sock, return_buffer, strlen_retbuf + 1, 0);
+                  keep_alive = 0;
+                  if (verbose) {
+                     eprintf("==== Return ================================\n");
+                     eputs(return_buffer);
+                     eprintf("\n\n");
+                  }
+                  goto finished;
+               }
+
                /* check if file in resource directory */
                strlcpy(str, resource_dir, sizeof(str));
                strlcat(str, logbook, sizeof(str));

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=62), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=62), [link](#61)).

---

**Acknowledgement sent** to `Recai Oktaş <roktas@omu.edu.tr>`:

Extra info received and forwarded to list.

Your message did not contain a Subject field. They are recommended and
useful because the title of a Bug is determined using this field.
Please remember to include a Subject field in your messages in future.

([full text](bugreport.cgi?bug=349528;msg=64), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=65), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=roktas%40omu.edu.tr)
From: Recai Oktaş <roktas@omu.edu.tr>
To: Moritz Muehlenhoff <jmm@inutil.org>
Cc: team@security.debian.org, 349528@bugs.debian.org,
Florian Weimer <fw@deneb.enyo.de>
Date: Thu, 26 Jan 2006 20:44:14 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=349528;msg=65) (text/plain, inline)]
```
```
[sorry for the delay, my internet connection is sketchy these days]

* Moritz Muehlenhoff [2006-01-26 10:57:53+0100]
> Florian, thanks a lot for sorting this out!
> I'll prepare the DSA; Recai, what cosmetic fixes do you intent
> to do? A security upload's changes you be strictly limited to the
> security issues.

Only changes in debian/changelog (adopt my changelog style).

> Can you send me the debdiff between the Sarge version and your proposed
> upload to the security queue or the proposed update itself?

Debdiff is attached.  You can reach the proposed update at the following
uri:

    [http://people.debian.org/~roktas/packages/elog_2.5.7+r1558-4+sarge1.diff.gz](http://people.debian.org/~roktas/packages/elog_2.5.7%2Br1558-4%2Bsarge1.diff.gz)
    [http://people.debian.org/~roktas/packages/elog_2.5.7+r1558-4+sarge1.dsc](http://people.debian.org/~roktas/packages/elog_2.5.7%2Br1558-4%2Bsarge1.dsc)
    [http://people.debian.org/~roktas/packages/elog_2.5.7+r1558-4+sarge1_i386.deb](http://people.debian.org/~roktas/packages/elog_2.5.7%2Br1558-4%2Bsarge1_i386.deb)

And here is the relevant changelog entry for your inspection:

  elog (2.5.7+r1558-4+sarge1) stable-security; urgency=high

    * Major security update (big thanks to Florian Weimer)
      + Backport r1333 from upstream's Subversion repository:
        "Fixed crashes with very long (revisions) attributes"
      + Backport r1335 from upstream's Subversion repository:
        "Applied patch from Emiliano to fix possible buffer overflow"
      + Backport r1472 from upstream's Subversion repository:
        "Do not distinguish between invalid user name and invalid password
         for security reasons"
      + Backport r1487 from upstream's Subversion repository:
        "Fixed infinite redirection with ?fail=1"
      + Backport r1529 from upstream's Subversion repository:
        "Fixed bug with fprintf and buffer containing "%""
        [Our patch just eliminates the format string vulnerability.]
      + Backport r1620 from upstream's Subversion repository:
        "Prohibit '..' in URLs" [[CVE-2006-0347](https://security-tracker.debian.org/tracker/CVE-2006-0347)]
      + Backport r1635 from upstream's Subversion repository:
        "Fixed potential buffer overflows" [[CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439)]
      + Backport r1636 from upstream's Subversion repository:
        "Added IP address to log file"

* Florian Weimer [2006-01-26 13:41:53+0100]
> So far, the patch for [CVE-2006-0347](https://security-tracker.debian.org/tracker/CVE-2006-0347) was missing. A tentative backport
> of the upstream fix is included below.  I dropped the hunk which dealt
> with "scripts" support because this functionality is not present in
> the sarge version.
>
> The changelog entry should look like this:
>
>   Backport revision 1620 from upstream Subversion repository:
>   "Prohibit '..' in URLs" [[CVE-2006-0347](https://security-tracker.debian.org/tracker/CVE-2006-0347)]

Hmm, I should have checked the CVE database for other issues.  Thanks for
doing it on behalf of me.  I have applied the above patch and tested it for
a failure case explained in Elog forums:

    <http://midas.psi.ch/elogs/Forum/1615>

It seems fine here (Elog returns an "Invalid URL" message).

Regards,

--
roktas

```
```
[[elog_2.5.7+r1558-3_2.5.7+r1558-4+sarge1.debdiff.gz](bugreport.cgi?att=1;bug=349528;filename=elog_2.5.7%2Br1558-3_2.5.7%2Br1558-4%2Bsarge1.debdiff.gz;msg=65) (application/octet-stream, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=349528;filename=signature.asc;msg=65) (application/pgp-signature, inline)]
```

---

**Tags added: fixed**
Request was from `Recai Oktaş <roktas@debian.org>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=349528;msg=67), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=67), [link](#66)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@omu.edu.tr>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=69), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=69), [link](#68)).

---

**Acknowledgement sent** to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@omu.edu.tr>`.
([full text](bugreport.cgi?bug=349528;msg=71), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=71), [link](#70)).

---

[Message #72](#72) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=72), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=72), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Recai Okta? <roktas@omu.edu.tr>
Cc: team@security.debian.org, 349528@bugs.debian.org,
Florian Weimer <fw@deneb.enyo.de>
Subject: Re: your mail
Date: Fri, 27 Jan 2006 15:28:00 +0100
```
Recai Okta? wrote:
>   elog (2.5.7+r1558-4+sarge1) stable-security; urgency=high
>
>     * Major security update (big thanks to Florian Weimer)
>       + Backport r1333 from upstream's Subversion repository:
>         "Fixed crashes with very long (revisions) attributes"
>       + Backport r1335 from upstream's Subversion repository:
>         "Applied patch from Emiliano to fix possible buffer overflow"
>       + Backport r1472 from upstream's Subversion repository:
>         "Do not distinguish between invalid user name and invalid password
>          for security reasons"
>       + Backport r1487 from upstream's Subversion repository:
>         "Fixed infinite redirection with ?fail=1"
>       + Backport r1529 from upstream's Subversion repository:
>         "Fixed bug with fprintf and buffer containing "%""
>         [Our patch just eliminates the format string vulnerability.]
>       + Backport r1620 from upstream's Subversion repository:
>         "Prohibit '..' in URLs" [[CVE-2006-0347](https://security-tracker.debian.org/tracker/CVE-2006-0347)]
>       + Backport r1635 from upstream's Subversion repository:
>         "Fixed potential buffer overflows" [[CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439)]
>       + Backport r1636 from upstream's Subversion repository:
>         "Added IP address to log file"

Why is r1636 necessary? This seems like a new feature (better logging
in case of an attack), but doesn't seem to fix a direct security problem
and could potentially break scripts that monitor the log file and expect
the current logfile file format.

The rest of the patch looks fine.

Cheers,
        Moritz

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@debian.org>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=74), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=74), [link](#73)).

---

**Acknowledgement sent** to `Recai Oktaş <roktas@omu.edu.tr>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@debian.org>`.
([full text](bugreport.cgi?bug=349528;msg=76), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=76), [link](#75)).

---

[Message #77](#77) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=77), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=77), reply):

![](/cgi-bin/libravatar.cgi?email=roktas%40omu.edu.tr)
From: Recai Oktaş <roktas@omu.edu.tr>
To: Moritz Muehlenhoff <jmm@inutil.org>
Cc: team@security.debian.org, 349528@bugs.debian.org,
Florian Weimer <fw@deneb.enyo.de>, Stefan Ritt <stefan.ritt@psi.ch>
Subject: Re: Security bugs in elog
Date: Sat, 28 Jan 2006 01:56:06 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=349528;msg=77) (text/plain, inline)]
```
```
* Moritz Muehlenhoff [2006-01-27 15:28:00+0100]
> Recai Oktaş wrote:
> >       + Backport r1636 from upstream's Subversion repository:
> >         "Added IP address to log file"
>
> Why is r1636 necessary? This seems like a new feature (better logging
> in case of an attack), but doesn't seem to fix a direct security problem
> and could potentially break scripts that monitor the log file and expect
> the current logfile file format.

I'll remove it.

> The rest of the patch looks fine.

Hmm, just found some other issues regarding this [CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439).  Previous
tests had seemed fine to me, but when I made more tests, the bug came up
again.  I believe the attached patch should fix this completely.  Stefan,
could you have a look at it please?

--
roktas

```
```
[[0011-Real-Fix-CVE-2005-4439.txt](bugreport.cgi?att=1;bug=349528;filename=0011-Real-Fix-CVE-2005-4439.txt;msg=77) (text/plain, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=349528;filename=signature.asc;msg=77) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@debian.org>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=79), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=79), [link](#78)).

---

**Acknowledgement sent** to `Recai Oktaş <roktas@omu.edu.tr>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@debian.org>`.
([full text](bugreport.cgi?bug=349528;msg=81), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=81), [link](#80)).

---

[Message #82](#82) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=82), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=82), reply):

![](/cgi-bin/libravatar.cgi?email=roktas%40omu.edu.tr)
From: Recai Oktaş <roktas@omu.edu.tr>
To: Moritz Muehlenhoff <jmm@inutil.org>
Cc: team@security.debian.org, 349528@bugs.debian.org,
Florian Weimer <fw@deneb.enyo.de>
Subject: Re: Security bugs in elog
Date: Sat, 28 Jan 2006 15:18:07 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=349528;msg=82) (text/plain, inline)]
```
```
* Recai Oktaş [2006-01-28 01:56:06+0200]
> Hmm, just found some other issues regarding this [CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439).  Previous
> tests had seemed fine to me, but when I made more tests, the bug came up
> again.  I believe the attached patch should fix this completely.  Stefan,
> could you have a look at it please?

Stefan has confirmed my patch and applied it in r1642.  So far, the
following patches have been applied:

    <http://people.debian.org/~roktas/elog-backport-patches/>

I've created a new package and confirmed that it works:

    [http://people.debian.org/~roktas/packages/elog_2.5.7+r1558-4+sarge1.diff.gz](http://people.debian.org/~roktas/packages/elog_2.5.7%2Br1558-4%2Bsarge1.diff.gz)
    [http://people.debian.org/~roktas/packages/elog_2.5.7+r1558-4+sarge1.dsc](http://people.debian.org/~roktas/packages/elog_2.5.7%2Br1558-4%2Bsarge1.dsc)
    [http://people.debian.org/~roktas/packages/elog_2.5.7+r1558-4+sarge1_i386.deb](http://people.debian.org/~roktas/packages/elog_2.5.7%2Br1558-4%2Bsarge1_i386.deb)

Debdiff is attached and here is the new changelog for your convenience:

    elog (2.5.7+r1558-4+sarge1) stable-security; urgency=critical

    * Major security update (big thanks to Florian Weimer)
      + Backport r1333 from upstream's Subversion repository:
        "Fixed crashes with very long (revisions) attributes"
      + Backport r1335 from upstream's Subversion repository:
        "Applied patch from Emiliano to fix possible buffer overflow"
      + Backport r1472 from upstream's Subversion repository:
        "Do not distinguish between invalid user name and invalid password
         for security reasons"
      + Backport r1487 from upstream's Subversion repository:
        "Fixed infinite redirection with ?fail=1"
      + Backport r1529 from upstream's Subversion repository:
        "Fixed bug with fprintf and buffer containing "%""
        [Our patch just eliminates the format string vulnerability.]
      + Backport r1620 from upstream's Subversion repository:
        "Prohibit '..' in URLs" [[CVE-2006-0347](https://security-tracker.debian.org/tracker/CVE-2006-0347)]
      + Backport r1635 and r1642 from upstream's Subversion repository:
        "Fixed potential buffer overflows" [[CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439)]

Let me know whether it is fine and I'll make the upload to stable-security
(right?).

Regards,

--
roktas

```
```
[[elog_2.5.7+r1558-3_2.5.7+r1558-4+sarge1.debdiff.gz](bugreport.cgi?att=1;bug=349528;filename=elog_2.5.7%2Br1558-3_2.5.7%2Br1558-4%2Bsarge1.debdiff.gz;msg=82) (application/octet-stream, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=349528;filename=signature.asc;msg=82) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@debian.org>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=84), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=84), [link](#83)).

---

**Acknowledgement sent** to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@debian.org>`.
([full text](bugreport.cgi?bug=349528;msg=86), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=86), [link](#85)).

---

[Message #87](#87) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=87), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=87), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Recai Okta? <roktas@omu.edu.tr>
Cc: team@security.debian.org, 349528@bugs.debian.org,
Florian Weimer <fw@deneb.enyo.de>
Subject: Re: Security bugs in elog
Date: Sat, 28 Jan 2006 17:22:27 +0100
```
Recai Okta? wrote:
> Debdiff is attached and here is the new changelog for your convenience:
>
>     elog (2.5.7+r1558-4+sarge1) stable-security; urgency=critical
>
>     * Major security update (big thanks to Florian Weimer)
>       + Backport r1333 from upstream's Subversion repository:
>         "Fixed crashes with very long (revisions) attributes"
>       + Backport r1335 from upstream's Subversion repository:
>         "Applied patch from Emiliano to fix possible buffer overflow"
>       + Backport r1472 from upstream's Subversion repository:
>         "Do not distinguish between invalid user name and invalid password
>          for security reasons"
>       + Backport r1487 from upstream's Subversion repository:
>         "Fixed infinite redirection with ?fail=1"
>       + Backport r1529 from upstream's Subversion repository:
>         "Fixed bug with fprintf and buffer containing "%""
>         [Our patch just eliminates the format string vulnerability.]
>       + Backport r1620 from upstream's Subversion repository:
>         "Prohibit '..' in URLs" [[CVE-2006-0347](https://security-tracker.debian.org/tracker/CVE-2006-0347)]
>       + Backport r1635 and r1642 from upstream's Subversion repository:
>         "Fixed potential buffer overflows" [[CVE-2005-4439](https://security-tracker.debian.org/tracker/CVE-2005-4439)]
>
> Let me know whether it is fine and I'll make the upload to stable-security
> (right?).

Thanks, it looks good, please upload.

Cheers,
        Moritz

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@debian.org>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=89), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=89), [link](#88)).

---

**Acknowledgement sent** to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@debian.org>`.
([full text](bugreport.cgi?bug=349528;msg=91), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=91), [link](#90)).

---

[Message #92](#92) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=92), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=92), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Recai Okta? <roktas@omu.edu.tr>
Cc: team@security.debian.org, 349528@bugs.debian.org,
Florian Weimer <fw@deneb.enyo.de>
Subject: Re: Security bugs in elog
Date: Sun, 5 Feb 2006 19:47:45 +0100
```
Recai Okta? wrote:
> Let me know whether it is fine and I'll make the upload to stable-security
> (right?).

Did you upload? I don't see any builds trickling in. If not, I'll do it.

Cheers,
        Moritz

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai Oktaş <roktas@debian.org>`:

`Bug#349528`; Package `elog`.
([full text](bugreport.cgi?bug=349528;msg=94), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=94), [link](#93)).

---

**Acknowledgement sent** to `Recai Oktaş <roktas@omu.edu.tr>`:

Extra info received and forwarded to list. Copy sent to `Recai Oktaş <roktas@debian.org>`.
([full text](bugreport.cgi?bug=349528;msg=96), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=96), [link](#95)).

---

[Message #97](#97) received at 349528@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=97), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=97), reply):

![](/cgi-bin/libravatar.cgi?email=roktas%40omu.edu.tr)
From: Recai Oktaş <roktas@omu.edu.tr>
To: Moritz Muehlenhoff <jmm@inutil.org>
Cc: team@security.debian.org, 349528@bugs.debian.org,
Florian Weimer <fw@deneb.enyo.de>
Subject: Re: Security bugs in elog
Date: Sun, 5 Feb 2006 20:56:56 +0200
```
* Moritz Muehlenhoff [2006-02-05 19:47:45+0100]
> Recai Oktaş wrote:
> > Let me know whether it is fine and I'll make the upload to stable-security
> > (right?).
>
> Did you upload? I don't see any builds trickling in. If not, I'll do it.

Yes, uploaded on 28 January:

    <http://lists.debian.org/debian-changes/2006/01/msg00048.html>

--
roktas

```

---

**Bug marked as fixed in version 2.6.1+r1638-1, send any further explanations to Florian Weimer <fw@deneb.enyo.de>**
Request was from `"Adam D. Barratt" <debian-bts@adam-barratt.org.uk>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=349528;msg=99), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=99), [link](#98)).

---

**Message sent on** to `Florian Weimer <fw@deneb.enyo.de>`:

Bug#349528.
([full text](bugreport.cgi?bug=349528;msg=101), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=101), [link](#100)).

---

[Message #102](#102) received at 349528-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=349528;msg=102), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=102), reply):

![](/cgi-bin/libravatar.cgi?email=debian-bts%40adam-barratt.org.uk)
From: "Adam D. Barratt" <debian-bts@adam-barratt.org.uk>
To: 349528-submitter@bugs.debian.org
Subject: Debian bug #349528
Date: Thu, 26 Oct 2006 20:33:33 +0100
```
Hi,

You should have recently received (or will soon receive) an e-mail
telling you that I've closed Debian bug #349528 in the elog
package, which you reported.

Due to the fact that the package was uploaded by someone who does not
normally do so, the bug was marked as "fixed" rather than closed.

Debian's bug tracking system now allows for this information to be
recorded in a more useful manner, enabling these bugs to be closed.

Due to the volume of bugs affected by this change, we are unfortunately
not sending individualized explanations for each bug. If you have
questions about the fix for your particular bug or about this email,
please contact me directly or follow up to the bug report in the Debian
BTS.

[It's possible you may receive multiple messages stating that the bug
was fixed in several different versions of the package. There are two
common reasons for this:

  - the bug was fixed in one version but subsequently found to exist
    in a later version

  - the bug existed in multiple distributions (for instance, "unstable"
    and "stable") and was thus fixed in a separate upload to each
    distribution
]

Regards,

Adam

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 25 Jun 2007 00:59:05 GMT) ([full text](bugreport.cgi?bug=349528;msg=104), [mbox](bugreport.cgi?bug=349528;mbox=yes;msg=104), [link](#103)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=349528).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 19:11:15 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.debian.org_2f9bcc50_20250124_191147.html ===


---

[[Date Prev](msg00043.html)][[Date Next](msg00045.html)]
[[Thread Prev](msg00043.html)][[Thread Next](msg00045.html)]
[[Date Index](maillist.html#00044)]
[[Thread Index](threads.html#00044)]

# [SECURITY] [DSA 967-1] New elog packages fix arbitrary code execution

---

* *To*: debian-security-announce@lists.debian.org (Debian Security Announcements)
* *Subject*: [SECURITY] [DSA 967-1] New elog packages fix arbitrary code execution
* *From*: joey@infodrom.org (Martin Schulze)
* *Date*: Fri, 10 Feb 2006 07:04:26 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/m1F7ROM-000oh7C%40finlandia.Infodrom.North.DE) [m1F7ROM-000oh7C@finlandia.Infodrom.North.DE](msg00044.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 967-1                     security@debian.org
<http://www.debian.org/security/>                         Moritz Muehlenhoff
February 10th, 2006                     <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : elog
Vulnerability  : several
Problem-Type   : remote
Debian-specific: no
CVE IDs        : CVE-2006-4439 CVE-2006-0347 CVE-2006-0348 CVE-2006-0597
                 CVE-2006-0598 CVE-2006-0599 CVE-2006-0600
Debian Bug     : 349528

Several security problems have been found in elog, an electonic logbook
to manage notes.  The Common Vulnerabilities and Exposures Project
identifies the following problems:

CVE-2005-4439

    "GroundZero Security" discovered that elog insufficiently checks the
    size of a buffer used for processing URL parameters, which might lead
    to the execution of arbitrary code.

CVE-2006-0347

    It was discovered that elog contains a directory traveral vulnerability
    in the processing of "../" sequences in URLs, which might lead to
    information disclosure.

CVE-2006-0348

    The code to write the log file contained a format string vulnerability,
    which might lead to the execution of arbitrary code.

CVE-2006-0597

    Overly long revision attributes might trigger a crash due to a buffer
    overflow.

CVE-2006-0598

    The code to write the log file does not enforce bounds checks properly,
    which might lead to the execution of arbitrary code.

CVE-2006-0599

    elog emitted different errors messages for invalid passwords and invalid
    users, which allows an attacker to probe for valid user names.

CVE-2006-0600

    An attacker could be driven into infinite redirection with a crafted
    "fail" request, which has denial of service potential.

The old stable distribution (woody) does not contain elog packages.

For the stable distribution (sarge) these problems have been fixed in
version 2.5.7+r1558-4+sarge2.

For the unstable distribution (sid) these problems have been fixed in
version 2.6.1+r1642-1.

We recommend that you upgrade your elog package.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.1 alias sarge
- --------------------------------

  Source archives:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2.dsc](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2.dsc)
      Size/MD5 checksum:      581 ed02ecef4eb70c7344532b1a75f893bc
    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2.diff.gz](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2.diff.gz)
      Size/MD5 checksum:    21652 ab45bff97bf2e7c42cd5ccca5a80103e
    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558.orig.tar.gz](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558.orig.tar.gz)
      Size/MD5 checksum:   538216 e05c9fdaa02692ce20c70a5fd2748fe3

  Alpha architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_alpha.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_alpha.deb)
      Size/MD5 checksum:   555270 5cb3aba4fc1303a65984aab4acaf32da

  AMD64 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_amd64.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_amd64.deb)
      Size/MD5 checksum:   511706 5e41b71ee6f3a42d5e7ac033b436c059

  ARM architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_arm.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_arm.deb)
      Size/MD5 checksum:   516094 95f2c045af860501a8e8bad54d0f6958

  Intel IA-32 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_i386.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_i386.deb)
      Size/MD5 checksum:   513918 0dfe3628e07c5cea6f2609683104dbab

  Intel IA-64 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_ia64.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_ia64.deb)
      Size/MD5 checksum:   597254 7f83bb7006849edf56411255e0b55e5f

  HP Precision architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_hppa.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_hppa.deb)
      Size/MD5 checksum:   543576 a09646d99c692e210164fb4a7f58c05a

  Motorola 680x0 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_m68k.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_m68k.deb)
      Size/MD5 checksum:   482016 b92bbd85b3d1041cbf403070e4aa43c7

  Big endian MIPS architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_mips.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_mips.deb)
      Size/MD5 checksum:   521234 33f7d96179fa0b4bd7cd314a33c54e31

  Little endian MIPS architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_mipsel.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_mipsel.deb)
      Size/MD5 checksum:   524336 b30ef21a7a9a958839569cf548fffebb

  PowerPC architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_powerpc.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_powerpc.deb)
      Size/MD5 checksum:   523540 823e5cb99e854a5ba0264259d7116deb

  IBM S/390 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_s390.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_s390.deb)
      Size/MD5 checksum:   514274 01f3ebd90422c9d94c109f60921c2634

  Sun Sparc architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge2_sparc.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge2_sparc.deb)
      Size/MD5 checksum:   518960 661427182cad6ca5a08663ffa505e4ef

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (GNU/Linux)

iD8DBQFD7CzpW5ql+IAeqTIRAr7cAJwKu86gvdgW5UzWatM+8+EDiiSMdwCgnT2b
ttGvVBTdC3n7VV+RsftANhg=
=aKZq
-----END PGP SIGNATURE-----

```

---


