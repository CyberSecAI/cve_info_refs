=== Content from cxsecurity.com_ac4476a3_20250126_104724.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_4edd4de4_20250126_104723.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_74c44791_20250126_104724.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_cb778c05_20250125_175743.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **WARNING! Fake news / Disputed / BOGUS****SMF 1.0.7 and lower plus 1.1rc2 and lower - IP spoofing vulnerability/IP ban evasion vulnerability** **2007.02.17** Credit:  **[Jessica Hope](https://cxsecurity.com/author/Jessica%2BHope/1/)**  Risk: **Low** Local: **No** Remote: ****Yes**** CVE: **[CVE-2006-7013](https://cxsecurity.com/cveshow/CVE-2006-7013/ "Click to see CVE-2006-7013")** CWE: **[CWE-Other](https://cxsecurity.com/cwe/CWE-Other "CWE-Other")**  CVSS Base Score: **7.5/10** Impact Subscore: **6.4/10** Exploitability Subscore: **10/10** Exploit range: **Remote** Attack complexity: **Low** Authentication: **No required** Confidentiality impact: **Partial** Integrity impact: **Partial** Availability impact: **Partial** | | --- | |
| --- | --- | --- | --- |

======================================================================
Advisory : SMF 1.0.7 and lower plus 1.1rc2 and lower - IP spoofing
vulnerability/IP ban evasion vulnerability
Release Date : June 02, 2006
Application : SMF
Version : SMF 1.0.7 and previous versions, SMF1.1rc2 and lower
Platform : PHP
Vendor URL : http://www.simplemachines.org/
Author : Jessica Hope (jessicasaulhope (at) googlemail (dot) com [email concealed])
======================================================================
Overview
The IP detection section of SMF's code allows for someone to spoof the
X-Forwarded-For header.
SMF trusts this value over the IP address reported in general.
This allows an attacker to login and post using IP's that are not theirs,
making it impossible for the Administrator of the SMF forum to ban the user.
======================================================================
Discussion
There's code in QueryString.php that starts:
elseif (!empty($\_SERVER['HTTP\_X\_FORWARDED\_FOR']))
{
// If there are commas, get the last one.. probably.
if (strpos($\_SERVER['HTTP\_X\_FORWARDED\_FOR'], ',') !== false)
{
$ips = array\_reverse(explode(', ', $\_SERVER['HTTP\_X\_FORWARDED\_FOR']));
// Go through each IP...
foreach ($ips as $i => $ip)
{
// Make sure it's in a valid range...
if (preg\_match('~^((0|10|172\.16|192\.168|255|127\.0)\.|unknown)~',
$ip) != 0)
continue;
// Otherwise, we've got an IP!
$\_SERVER['REMOTE\_ADDR'] = trim($ip);
break;
}
}
// Otherwise just use the only one.
elseif (preg\_match('~^((0|10|172\.16|192\.168|255|127\.0)\.|unknown)~',
$\_SERVER['HTTP\_X\_FORWARDED\_FOR']) == 0)
$\_SERVER['REMOTE\_ADDR'] = $\_SERVER['HTTP\_X\_FORWARDED\_FOR'];
}
This code is used to obtain the users IP address. However, if
X-Forwarded-For HTTP header has been provided,
it will take the last IP address from the X-Forwared-For header and
blindly trust it to be the real IP address.
The problem is that the X-Forwarded-For HTTP header is easily forgable
via a number of methods.
For example, if the X-Forwarded-For header was set:
X-Forwarded-For: 1.2.3.4
the SMF application trusts 1.2.3.4 to be their IP address, and will
reflect this fact when the user does anything that SMF logs,
such as posting to the forum.This makes it possible for a user to set
the X-Forwareded-For IP to that of another user in
an attempt to masquerade as them. It also would require the SMF
administrator to track down the users real IP via httpd server logs,
assuming this is possible, which in some cases it is not.
This would also assume the SMF administrator knows the IP presented to
them isn't real.
On top of this, there's code in Security.php that starts:
// Check if we have a valid IP address.
if (preg\_match('/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/',
$user\_info['ip'], $ip\_parts) == 1)
{
$ban\_query[] = "(ban\_type = 'ip\_ban'
AND ($ip\_parts[1] BETWEEN ip\_low1 AND ip\_high1)
AND ($ip\_parts[2] BETWEEN ip\_low2 AND ip\_high2)
AND ($ip\_parts[3] BETWEEN ip\_low3 AND ip\_high3)
AND ($ip\_parts[4] BETWEEN ip\_low4 AND ip\_high4))";
// IP was valid, maybe there's also a hostname...
if (empty($modSettings['disableHostnameLookup']))
{
$hostname = @gethostbyaddr($user\_info['ip']);
if (strlen($hostname) > 0)
$ban\_query[] = "(ban\_type = 'hostname\_ban' AND ('$hostname' LIKE
hostname))";
}
}
This code indicates that a user could bypass bans on their IP by
setting the X-Forwarded-For header,
seeing as SMF blindly trusts the X-Forwarded-For IP to be real.
======================================================================
Solution
The offical response from SMF was:
'Trusting any server variable that carries the real IP address would
make no sense.
A hacker would be able to manipulate all headers being received by PHP.
SMF tries to give the best estimate of the user's real IP address,
but on the internet the IP address authenticity can never be relied
upon fully. '
- Hendrik Jan Visser - Lead Developer Simple Machines
Plus, when pressed about it being a vulnerability, they had this to say:
'I thought we had replied that none of these represent a security issue?
Could you please state again how these could be exploited?' - Grudge (
Matthew Wolf - Developer Simple Machines ).
This issue was first reported on the 14th Apr 2006, the first reply
was on the 23rd Apr 2006.
The follow ups were on the 10th May 2006 and 24th May 2006, with the
final reply of not being an issue sent on the 24th May 2006.
Thus there is no offical solution.
The solution that I will advise is to remove the code quoted from
QueryString.php
so that SMF doesn't trust the X-Forwarded-For variable.
This will also make it possible to properly ban someone by IP address.
======================================================================
Credit
This issue is to be credited to Jessica Hope ( jessicasaulhope (at) googlemail (dot) com [email concealed] )

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007020059)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top


