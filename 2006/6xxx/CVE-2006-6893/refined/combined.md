=== Content from www.lightbluetouchpaper.org_867b017d_20250125_222254.html ===

[# Light Blue Touchpaper

## Security Research, Computer Laboratory, University of Cambridge](https://www.lightbluetouchpaper.org/ "Light Blue Touchpaper")
Menu
[Skip to content](#content "Skip to content")

* [Home](https://www.lightbluetouchpaper.org/)
* [About the site](https://www.lightbluetouchpaper.org/about/)
* [Security Group](https://www.cl.cam.ac.uk/research/security/)

Search for:

# Hot or Not: Revealing Hidden Services by their Clock Skew

[2006-09-04](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/ "Permalink to Hot or Not: Revealing Hidden Services by their Clock Skew")[Hardware & signals](https://www.lightbluetouchpaper.org/category/security-engineering/hardware/), [Privacy technology](https://www.lightbluetouchpaper.org/category/privacy/)[Steven J. Murdoch](https://www.lightbluetouchpaper.org/author/sjm217/ "View all posts by Steven J. Murdoch")

Next month I will be presenting my paper “[Hot or Not: Revealing Hidden Services by their Clock Skew](http://www.cl.cam.ac.uk/~sjm217/papers/ccs06hotornot.pdf)” at the [13th ACM Conference on Computer and Communications Security (CCS)](http://www.acm.org/sigs/sigsac/ccs/CCS2006/) held in Alexandria, Virginia.

It is well known that quartz crystals, as used for controlling system clocks of computers, change speed when their temperature is altered. The paper shows how to use this effect to attack anonymity systems. One such attack is to observe timestamps from a PC connected to the Internet and watch how the frequency of the system clock changes.

Absolute clock skew has been [previously used](http://www.caida.org/publications/papers/2005/fingerprinting/) to tell whether two apparently different machines are in fact running on the same hardware. My paper adds that because the skew depends on temperature, in principle, a PC can be located by finding out when the day starts and how long it is, or just observing that the pattern is the same as a computer in a known location.

However, the paper is centered around *hidden services*. This is a feature of [Tor](http://tor.eff.org/) which allows servers to be run without giving away the identity of the operator. These can be attacked by repeatedly connecting to the hidden service, causing its CPU load, hence temperature, to increase and so change the clockskew. Then the attacker requests timestamps from all candidate servers and finds the one demonstrating the expected clockskew pattern. I tested this with a private Tor network and it works surprisingly well.

In the graph below, the temperature (orange circles) is modulated by either exercising the hidden service or not. This in turn alters the measured clock skew (blue triangles). The induced load pattern is clear in the clock skew and an attacker could use this to de-anonymise a hidden service. More details can be found in [the paper](http://www.cl.cam.ac.uk/~sjm217/papers/ccs06hotornot.pdf) (PDF 1.5M).

![Clock skew graph](http://www.lightbluetouchpaper.org/wp-content/uploads/2006/09/hotornot.png)

I happened upon this effect in a lucky accident, while trying to improve upon the results of the paper “[Remote physical device fingerprinting](http://www.caida.org/publications/papers/2005/fingerprinting/)“. A previous paper of mine, “[Embedding Covert Channels into TCP/IP](http://www.cl.cam.ac.uk/~sjm217/papers/ih05coverttcp.pdf)” showed how to extract high-precision timestamps from the Linux TCP initial sequence number generator. When I tested this hypothesis it did indeed improve the accuracy of clock skew measurement, to the extent that I noticed an unusual peak at about the time `cron` caused the hard disk on my test machine to spin-up. Eventually I realised the potential for this effect and ran the necessary further experiments to write the paper.

![](https://secure.gravatar.com/avatar/afeaccfb34918d26585632b8d2984447?s=74&d=mm&r=g)
## About Steven J. Murdoch

I am Professor of Security Engineering and Royal Society University Research Fellow in the [Information Security Research Group](https://sec.cs.ucl.ac.uk/) of the [Department of Computer Science](https://www.ucl.ac.uk/computer-science/) at University College London (UCL), and a member of the UCL [Academic Centre of Excellence in Cyber Security Research](https://www.ucl.ac.uk/cybersecurity-centre-of-excellence/). I am also a bye-fellow of [Christ’s College](http://www.christs.cam.ac.uk/), Innovation Security Architect at the [OneSpan](https://www.onespan.com/), Cambridge, a member of the [Tor Project](https://www.torproject.org/), and a Fellow of the [IET](http://www.theiet.org/membership/types/fiet/) and [BCS](http://www.bcs.org/category/10968). I teach on the UCL [MSc in Information Security](https://www.ucl.ac.uk/prospective-students/graduate/taught-degrees/information-security-msc). Further information and my [papers on information security research is on my personal website](https://murdoch.is/). I also blog about [information security research and policy on Bentham's Gaze](https://www.benthamsgaze.org/). [View all posts by Steven J. Murdoch →](https://www.lightbluetouchpaper.org/author/sjm217/)

# Post navigation

[← After ID Cards…](https://www.lightbluetouchpaper.org/2006/09/01/after-id-cards/) [The real hustle on BBC3: watch it! →](https://www.lightbluetouchpaper.org/2006/09/06/the-real-hustle-on-bbc3-watch-it/)

## 33 thoughts on “Hot or Not: Revealing Hidden Services by their Clock Skew”

1. Pingback: [Links » Turning the Heat Up on Anonymity](http://www.links.org/?p=134)
3. Pingback: [crazy about anonymity?](http://blog.zaphods.net/articles/2006/09/05/crazy-about-anonymity)
5. ![](https://secure.gravatar.com/avatar/0acfae041553eae096327e31fec0351a?s=74&d=mm&r=g) **suma** says:
   [2006-09-05 at 13:18 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3152)

   impressive

   [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3152#respond)
7. ![](https://secure.gravatar.com/avatar/329f1c90d69c2e363a87a1b5bed2bc29?s=74&d=mm&r=g) **Doug** says:
   [2006-09-05 at 16:45 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3153)

   Who’d have thunk? You guys certainly are creative! 🙂

   So, if the relative use of a CPU can give away the identity of a node, would a plausible countermeasure be to keep the CPU pegged at 100%? Would something as simple as running Folding@Home or SETI@Home on the machine be enough to thwart this?

   Just wondering.

   [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3153#respond)
9. ![](https://secure.gravatar.com/avatar/2f994f446a5cb6f77c50a40844e45a58?s=74&d=mm&r=g) **James Aguilar** says:
   [2006-09-05 at 17:38 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3154)

   This isn’t really something to worry about, right? The attacker has to have physical access to the server. If he does, you’ve got bigger problems than being de-anonymized already.

   [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3154#respond)
11. Pingback: [Clock Skew TOR Vulnerability/Exploit « TheMostBoringBlogInTheWorld](http://themostboringblogintheworld.wordpress.com/2006/09/05/clock-skew-tor-vulnerabilityexploit/)
13. Pingback: [The English Guy » Anonymity Services Not so Anonymous?](http://www.theenglishguy.co.uk/2006/09/05/anonymity-services-not-so-anonymous/)
15. ![](https://secure.gravatar.com/avatar/49017891096d1ee5b01c8a0d864b1aa6?s=74&d=mm&r=g) **[Steven J. Murdoch](http://www.cl.cam.ac.uk/users/sjm217/)** says:
    [2006-09-05 at 19:51 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3157)

    @James

    > The attacker has to have physical access to the server.

    No, the change in temperature is causing by increasing CPU load, which can be done simply by downloading a file from the hidden service. The clock skew is measured by requesting TCP timestamps, which is a feature enabled by all modern operating systems and seldom blocked by firewalls.

    > This isn’t really something to worry about, right?

    I don’t think there is any need for panic. Primarily the paper is designed to feed into the future design of Tor rather than suggest any short term fixes. There are already known attacks on Tor which will probably work better than this, but the proposed defences to these will not fix the problem I discuss in the paper.

    Also, I point out that for clarity the results in the paper are mainly from a private Tor network and running it in reality will be more messy. However, as the performace of the Tor network improves, the attack will be more effective, so is worth bearing in mind for the future.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3157#respond)
17. ![](https://secure.gravatar.com/avatar/2f994f446a5cb6f77c50a40844e45a58?s=74&d=mm&r=g) **James Aguilar** says:
    [2006-09-05 at 20:25 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3158)

    Oh, thanks for clearing that up. 🙂

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3158#respond)
19. ![](https://secure.gravatar.com/avatar/a0b368e7617c04a13c2336d56507e884?s=74&d=mm&r=g) **[Adam Langley](http://www.imperialviolet.org)** says:
    [2006-09-05 at 21:39 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3159)

    As a (very minor) Tor hacker, I’d like to say that this is great work! Well done.

    Have you tried it against other services? Like trying to see if you can tell the difference between a real and non-existent user via openssh?

    And any source code?

    (I apoligise that I’ve only skimmed the paper so far)

    Thanks

    AGL

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3159#respond)
21. ![](https://secure.gravatar.com/avatar/49017891096d1ee5b01c8a0d864b1aa6?s=74&d=mm&r=g) **[Steven J. Murdoch](http://www.cl.cam.ac.uk/users/sjm217/)** says:
    [2006-09-05 at 22:00 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3160)

    @Doug

    > So, if the relative use of a CPU can give away the identity of a node, would a plausible countermeasure be to keep the CPU pegged at 100%?

    This wasn’t something I tested, but I expect it will make the attack much harder and possibly infeasible. There might still be some effects apparent. For example, perhaps the hard-disk will have an effect and that can be spun up.

    Also, I expect that SETI@Home will pause when Tor is busy. If SETI@Home heats up the CPU more than Tor, then there still will be an effect. In my tests I did note significant difference in the CPU temperature between running Tor and [CPUBurn](http://pages.sbcglobal.net/redelm/), despite them both keeping the CPU at 100%.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3160#respond)
23. ![](https://secure.gravatar.com/avatar/49017891096d1ee5b01c8a0d864b1aa6?s=74&d=mm&r=g) **[Steven J. Murdoch](http://www.cl.cam.ac.uk/users/sjm217/)** says:
    [2006-09-05 at 22:09 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3161)

    @Adam

    > Have you tried it against other services? Like trying to see if you can tell the difference between a real and non-existent user via openssh?

    No, but that is a very good suggestion. I do remember that OpenSSH gave away whether user did not exist through timing. If they fix the response time, then the temperature attack could work. Hopefully the temperature difference between multiple `crypt()` invocations will be different from `sleep()`.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3161#respond)
25. ![](https://secure.gravatar.com/avatar/49017891096d1ee5b01c8a0d864b1aa6?s=74&d=mm&r=g) **[Steven J. Murdoch](http://www.cl.cam.ac.uk/users/sjm217/)** says:
    [2006-09-05 at 23:04 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3162)

    @Adam

    > And any source code?

    Currently it is a bit of a mess, slow, and sparsely documented. I do plan to put it on my site at some point when it is in an acceptable form. Right now I really should be writing my thesis 🙂

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3162#respond)
27. ![](https://secure.gravatar.com/avatar/896f2fb69e17f589971e20f46e938a7b?s=74&d=mm&r=g) **[trakgalvis](http://lockpicker.net/)** says:
    [2006-09-06 at 05:53 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3163)

    This is a very interesting effect!

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3163#respond)
29. ![](https://secure.gravatar.com/avatar/6a92ccb89e584ba28551e2cb01d34695?s=74&d=mm&r=g) **Jason Kirk** says:
    [2006-09-06 at 09:59 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3164)

    If the entire sequence relies on timing offsets created by server load then couldn’t the server deliberately include random timing offsets into the displayed timestamp.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3164#respond)
31. ![](https://secure.gravatar.com/avatar/49017891096d1ee5b01c8a0d864b1aa6?s=74&d=mm&r=g) **[Steven J. Murdoch](http://www.cl.cam.ac.uk/users/sjm217/)** says:
    [2006-09-06 at 10:05 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3165)

    @Jason

    > couldn’t the server deliberately include random timing offsets into the displayed timestamp.

    Random timing offsets would not be a very effective defence, because over time they would average out. Introducing a random skew would help against the fingerprinting attack, but to be complete it would need to be implemented at the timer-interrupt level which is not software controlled.

    Neither would be a good defence against modulating the clock skew, since without a good external reference clock, the computer couldn’t tell what the *true* clock is to base the jitter around. Changes will still be apparent, after removing some noise.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3165#respond)
33. ![](https://secure.gravatar.com/avatar/49017891096d1ee5b01c8a0d864b1aa6?s=74&d=mm&r=g) **[Steven J. Murdoch](http://www.cl.cam.ac.uk/users/sjm217/)** says:
    [2006-09-06 at 13:42 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3166)

    @Adam

    > Like trying to see if you can tell the difference between a real and non-existent user via openssh?

    I tried this by repeatedly performing keyboard interactive, password and public key authentications, but didn’t see any appreciable difference in CPU usage between users that exist and those that do not. This appears to be because OpenSSH generates a fake user, when the requested one does not exist; for details see `fakepw()` in [auth.c](http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/auth.c?rev=1.75&content-type=text/x-cvsweb-markup).

    The attack might still work in special cases, e.g. where PAM calls a particularly processor intensive module, or I might have missed an avenue in OpenSSH. There could be other packages which are vulnerable too.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3166#respond)
35. ![](https://secure.gravatar.com/avatar/d295efa24c768ebb9d6e046be8aac585?s=74&d=mm&r=g) **Clive Robinson** says:
    [2006-09-06 at 17:50 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3167)

    This is not a new attack (just the implementation) I was first aware of this when trying to design a random number generator with clock skew (it is not as easy as various reasurch papers would have you belive).

    When the paper about the original TCP timestap was posted I mentioned a solution on Bruce Schneire’s blog (plus a couple of other things such as using the change in temprature therfore skew to tell how hevily the machine was being used or side channel),

    <http://www.schneier.com/blog/archives/2005/03/remote_physical.html>

    The hardware solution briefly, which is quite simple and fairly cheep to implememnt,

    1, identify the CPU (not the backup clock) crystal.

    2, Check for the two small value capacitors (around 33pF) that go to ground from the crystal terminals (if they are fitted they often are not).

    3, Find which one is on the input (not the driver) side of the crystal (you might need a scope or a data sheet).

    4, Replace this with a cap twice the value with a varicap in series (in the ground leg) connect a high value resistor to the junction of the varicap and cap.

    5, then supply a suitable very very low frequency signal into the resistor.

    6, Make the very slow speed signal random (crypto random would be good) via a D-A or other system in a PIC micro controler etc.

    The effect of this is to marginally change the CPU clock frequency which will destroy any timing correlations (if you use the right signal to the varicap).

    As an extra thought for those using SSH or other key\_press-network program have a look at Matt Blaze’s site (www.crypto.com) and have a look at the JitterBugs paper it shows how the timing of an input signal (ie keypressess) can be modulated to make a side channel that can be reliably picked up on the network. This is without any kind of modification to the computer or it’s software…

    Now

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3167#respond)
37. ![](https://secure.gravatar.com/avatar/49017891096d1ee5b01c8a0d864b1aa6?s=74&d=mm&r=g) **[Steven J. Murdoch](http://www.cl.cam.ac.uk/users/sjm217/)** says:
    [2006-09-06 at 23:10 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3168)

    @Clive

    > This is not a new attack (just the implementation)

    I am not aware of anyone trying this before. Could you be thinking of “Remote physical device fingerprinting” by Kohno et al? They showed how to *fingerprint* hosts by *absolute* clock skew, but this is not what my paper is about.

    I show how *changes* in clock skew are caused by temperature and this can be induced by modulating CPU load. Clock skew can be measured remotely and CPU load can be altered remotely allowing an attacker to *tag* a machine.

    > The effect of this is to marginally change the CPU clock frequency which will destroy any timing correlations (if you use the right signal to the varicap).

    Altering the clock speed randomnly as you suggest would not be effective against the tagging attack, because it would just introduce noise. This would simply be averaged out over time. A better approach would be temperature componsated or oven controlled crystals, provided they could react fast enough.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3168#respond)
39. ![](https://secure.gravatar.com/avatar/1c5113951953278ed396c92629741e8b?s=74&d=mm&r=g) **John Brooks** says:
    [2006-09-07 at 04:51 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3169)

    Very creative, but not particularly useful.

    Firstly, this relies on having a server or a list of servers that might be hosting the hidden service – uncertain (see below) verification of if a server is hosting a specific hidden service, but if the hidden service is done properly, you have no idea who could be hosting it 😉

    Secondly, you have to (D)DoS the target server to get results – a good firewall or some proper throttling would make it nearly useless, and it is hardly subtle. Also, I imagine multiple CPUs would screw with this.

    And, of course, any other system load would contribute – if anything intensive is running, the results would be very unpredictable.

    The hidden service operator could just ensure that no one has any reason to suspect that their server is hosting the service, or use a properly configured firewall to prevent attacks like this

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3169#respond)
41. ![](https://secure.gravatar.com/avatar/d295efa24c768ebb9d6e046be8aac585?s=74&d=mm&r=g) **Clive Robinson** says:
    [2006-09-07 at 13:12 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3170)

    @Steven J. Murdoch

    Steve,

    Below (if it’s emotted correctly) is the last couple of paragraphs of my posting to the Schneier blog a year and a half ago,

     *Better still use similar technology to modern TCXO’s and use a PIC microcontroler to generate the voltage, also monitor various status lines (like reset etc) and change the voltage each time you reboot the machine, thus giving a different fingerprint each time you turn the laptop etc on.*

    This “attack” is a form of tempest attack, and the old addage about the information “energy and bandwidth” apply. Interestingly looking at their paper they have missed a couple of things that might provide more information about the computer. Basically the resonant frequency of an Xtal oscilator is decided by the elctrical and physical charecteristics of the circuit. These means that the frequency changes with the applied voltage, temprature, mechanical vibration. So it there is sufficient bandwidth in the time detection method it might well be possible to tell things about the environment the laptop is in and how much it is being used (heavy calculation take the temprature up and drops the powersupply voltage slightly).

    Posted by: Clive Robinson at March 10, 2005 05:10 AM

    In essence as I understand it from your paper (I willl need a bit more time to read it and go through all the stuff you mention as I printed in BW and the graphs need to be in colour) and from what you have said you are looking at the delta function of the synthetic quatz resonance frequency to temprature and it’s visable effects on the network. The temprature variation being due to the extra load put on the computer by activity of the components.

    In the last sentence of the last paragraph of my post I say,

     *So it there is sufficient bandwidth in the time detection method it might well be possible to tell things about the environment the laptop is in and how much it is being used (heavy calculation take the temprature up and drops the powersupply voltage slightly).*

    There are a number of issues with the bandwidth, the first and most importantly is that the bandwidth on the transfer of energy to the ambiant suroundings from the CPU or other high energy device is based around the transfer time on the heat sinking mechanism.

    A practical example of this is take a bare metal coat hanger and a lighted candle. Hold one corner of the hanger and put the other in the candle flame. Time how long it is before you feel a real temprature difference, it’s usually in the order of seconds.

    If you know consider CPU die to CPU package to heatsink to air to Xtal metal case to xtal inside as your thermal path it is fairly obvious that there is going to be a considerable time delay (also by even moderate mechanical changes the thermal path can be broken) .

    The bandwidth of this as an information carrying channel is inversly proportional to the time delay.

    Therefor any activity that an attacker is going to perform must be sufficiently long for it to fall well within the bandwith.

    With regard to TXCO’s long gone are the days when they used heating elerments and thermisters in closed loop feadback (I still have one at home which I show people as a curiosity along with a second world war spy set and it’s Xtals, and old TX valves and 807 based RX antena amp of the sort used in the X stations).

    Basicaly the modern version is a small single chip micro like a PIC for example that is capable of producing a voltage to a varicap on the XTAL that is the inverse of the temprature changes (hence my comment about PICs). The whole lot including the AT cut crystal is usually mounted in a small “relay can” with four (or more) contacts.

    With regard to supplying a changing signal to a varicap diode that is of very low frequency, providing the frequency changes it makes swamp that of the effects of temprature and are also of an appropriate frequency then the effect it has is to swamp the changes due to temprature from computer load variation (ie bury it in the noise).

    Yes you could average the “load signal” out but what method would you use, avaraging is effectivly a low pass filtering function with the cuttoff frequency set by the number of samples and their repetition rate. From the attackers point of view averaging just lowers the available signal bandwidth of the side channel even further.

    You could easily make the cutoff point be equivalent to 1/week with fairly minimal effort see stuff on Spread Spectrum to do with Direct Sequence and frequency hopping (also quite a few motherboards these days include spread spectrum clock modulation to help meet EMC requirments).

    As I noted at the begining of the last paragraph in my posting to the Schneier blog,

     *This “attack” is a form of tempest attack, and the old addage about the information “energy and bandwidth” apply.*

    You can see I am accutly aware of the limitations of the side channel attacks (allmost all practical tempest attacks are side channel attacks).

    In fact if you can get sufficient bandwidth, it might be more practical to use the mechanical effects on the XTAL resonant frequency (known as microphonics in the trade) as a low frequency microphone or sizmic sensor 😉

    The reason I am acutly aware of this stuff is that I have spent a considerable time one way or another looking into Comms Security.

    And more pertanently to the above (which falls into the general class of timing attacks) back in 2000 I was at an EU funded course in InfoSec (IPICS 2K) where Black / Mix nets where discussed and I pointed out the history of Tempest / side channel timing attacks and just how difficult it is to negate their effects to an acceptable level. This gave rise to actually thinking and testing what would be needed to perform a Tempest style attack on these networks (and how to solve many of them 😉

    By the way the story usually told about the “first Tempest attack” is quite relevent,

    Shortly after WW II Britain had a secure link from Washington to Britain that used an electronic form of the One Time Pad. The Xor function was implemented using a mechanical (post office 600) relay. Unfortunatly it had a bias in it’s hold and release timing. Which enabled you to strip of the encryption, simply by examining the timing on an osciliscope.

    Supposedly this is also one of the reasons a Canadian Prof spent so long developing the replacment known as the Rockex which was used by the F&CO for many years.

    Therefore it would not be unfair to make the same comment (about Tempest) once made by an NSA employee when talking about DES and differential crypto attacks 😉

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3170#respond)
43. ![](https://secure.gravatar.com/avatar/7379345fed54f2447537068ed1c2e440?s=74&d=mm&r=g) **[Salvatore Sanfilippo](http://www.hping.org)** says:
    [2006-09-08 at 09:46 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3171)

    Hello! I like this attack, yesterday I implemented clock skew detection in hping3 and I’ll release it in some day. With hping the attack is active, requires sending a packet for second, for 4/5 minutes, but it is very easy to use even for script kiddies 😉

    Ciao,

    Salvatore

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3171#respond)
45. Pingback: [Dr Jekyll & Mr Hyde » Blog Archive » Tor, plausible deniability, watchdog and seizures](http://www.rfc1149.net/blog/2006/09/11/tor-plausible-deniability-watchdog-and-seizures/)
47. ![](https://secure.gravatar.com/avatar/49017891096d1ee5b01c8a0d864b1aa6?s=74&d=mm&r=g) **[Steven J. Murdoch](http://www.cl.cam.ac.uk/users/sjm217/)** says:
    [2006-09-13 at 13:53 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3173)

    @John

    I deal with most of your points in the linked paper.

    > Very creative, but not particularly useful.

    I would disagree; in fact I used this technique in anger last week with good results. This will hopefully be described in a blog post of its own, later.

    > Firstly, this relies on having a server or a list of servers that might be hosting the hidden service

    “Many hidden servers are also publicly advertised Tor nodes, in order to mask hidden server traffic with other Tor traffic, so this scenario is plausible.”

    Also, this attack is orthogonal to other analysis techniques. If one of these produces a list of candidates, the attack presented can narrow down suspects.

    > Secondly, you have to (D)DoS the target server to get results – a good firewall or some proper throttling would make it nearly useless, and it is hardly subtle.

    This is not necessary; an attacker can be as subtle as it likes, it will just take longer. Over time even slight signals will become apparent. A firewall will not help, since the traffic to the hidden service is encrypted so the firewall will not see the source.

    > Also, I imagine multiple CPUs would screw with this.

    I tried this and there was no problem. Multiple CPU machines still have only one clock crystal.

    > And, of course, any other system load would contribute – if anything intensive is running, the results would be very unpredictable.

    This was not my experience with “Low-cost Traffic Analysis of Tor”. Noise like this disappears rapidly when you average the results over time.

    > The hidden service operator could just ensure that no one has any reason to suspect that their server is hosting the service, or use a properly configured firewall to prevent attacks like this

    The first point is unrealistic because the operator must have some motive to set up the hidden service in the first place. The second is a lot more difficult than it sounds. Firstly the operator, would have to block all incoming traffic, which precludes running a Tor node so loses the plausible deniability. Secondly this works for outgoing connections, so web-bugs and Javascript could work as well. An attacker could even snoop in outgoing traffic not destined to him. If all the candidates traffic could be monitored, other attacks will work better, but suppose the attacker could sit at a web proxy or DNS server.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3173#respond)
49. ![](https://secure.gravatar.com/avatar/d295efa24c768ebb9d6e046be8aac585?s=74&d=mm&r=g) **Clive Robinson** says:
    [2006-09-13 at 19:51 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3174)

    @Steven,

    I appriciate that at the moment the attack works.

    However I suspect that now it is out in the open as an attack system operators will start to look at the traffic on their machine via the logs etc (and vendors will code the appropriate filters into their IDS/P systems etc if sufficient customers ask for it).

    As the attack requires the target machine to be very heavily loaded for a couple of hours (or more) then lightly loaded for an equivalent time with this cycle repeated several times, this behaviour is very likley to give a clear signiture in the system logs (along with several other related indicators if the atack is not skillfuly put together).

    As you pointed out in your artical the attacker might have several hundred or more potential targets to attack before localising the network address of the machine. This makes it a clasical time/resource trade off. It is therefore quite likley the attacker will give away their precence to network operators and the TOR ops long before they have succeded.

    As I indicated previously there is a very workable solution to the problem, briefly and without getting bogged down in details (and counter attackes),

    Firstly you implement delaying tactics on the host to make the attackers time to probable target identification sufficiently long say a week or more. This then moves the advantage over to the system op as they can probably average the system logs more quickly to identify an attack than the attacker can average out the delaying tactics.

    Secondly you move the service around various host machines in a more frequent time than target identification takes, again this moves the advantage over to the alert sys ops as they can look for changes in averages across all the machines used.

    However the current TOR system does not support the second option, the question is how long before it does (assuming the good will of alternative host system owners).

    All in all you have done a very nice job of taking an idea and turning it into a practical attack and then publishing the result, which others have not done. So all credit to you for your work.

    Now you (or others) need to do the counter measures as in the old ECM ECCM game. In my experiance offering a possible solution to a problem you have discovered getts a more attentive audiance 😉

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3174#respond)
51. ![](https://secure.gravatar.com/avatar/b7348f6fc00afdf89667bd4318fc9121?s=74&d=mm&r=g) **[Mike Bond](http://www.cl.cam.ac.uk/~mkb23/)** says:
    [2006-09-20 at 00:29 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3175)

    Clive, a fascinating dialogue going here which I have enjoyed reading and I’m going to follow in greater depth.

    Given the wealth of information and suggestions outlined in your Schneier posts and in the thread here, have you considered putting together a paper of your own? Maybe the time constraints are prohibitive, but it seems to me all these ideas would benefit from coming together in a more formal whitepaper layout, even if the mechanics of a formal publication and review process are not necessarily followed.

    Just a thought; and on the possible overlap between such techniques and “tempest” emissions attacks, sadly this is another area where the academic literature is thinner on the ground than it should be too, imho!

    Mike

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3175#respond)
53. ![](https://secure.gravatar.com/avatar/33034bf206b76bbeda66d0d19940df96?s=74&d=mm&r=g) **dang** says:
    [2006-09-20 at 18:51 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3176)

    oscillator temperature and age stability is usually of functional concern in oscilloscopes and other instruments. We can probably draw on their solutions to fix this. The difference between expensive instruments and their less expensive brethren is in part the use of oven controlled oscillators. These control the temperature of the oscillator and provide significant improvements in measurement. Some instruments have double ovens…

    Also, I imagine if you have some reference data over time on a machine you could detect things like hardware replacement and other potentially interesting events by comparing the age drift of the oscillator.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3176#respond)
55. Pingback: [Light Blue Touchpaper » Random isn’t always useful](http://www.lightbluetouchpaper.org/2006/09/23/random-isnt-always-useful/)
57. ![](https://secure.gravatar.com/avatar/d295efa24c768ebb9d6e046be8aac585?s=74&d=mm&r=g) **Clive Robinson** says:
    [2006-10-04 at 11:34 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3178)

    Mike,

    Sorrey for not getting back to you put I ended up in hosiptal due to complications with an earlier visit 🙁

    I will send you an EMail to discuss further your proposel.

    Clive

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3178#respond)
59. ![](https://secure.gravatar.com/avatar/d295efa24c768ebb9d6e046be8aac585?s=74&d=mm&r=g) **Clive Robinson** says:
    [2006-10-06 at 18:03 UTC](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#comment-3179)

    With regard to two or more paths to a multihomed host (ie with two or more IP addresses / URLs not neciserilly network cards). Time/frequency skew actually provides a very good way to identify the host. Effectivly you are enumerating the hosts interfaces.

    Why is this possible put simply the time stamps etc are (in most OS’s) derived from the same clock source be it hardware or software. This is due simply to trying to minimise the use of resources by the OS.

    There are certain security areas where this is of great concern over and above anoymous hosting of services.

    First off think of Honey Nets, these are designed to trap the attempts of skilled crackers trying to break in, so that what they do can be anyalised. More often than not these Honey Nets are not made up of a host per IP address, they often use one set of hardware to look like multiple hosts. A Honey Net is only of use if it cannot be detected as such.

    Now if you assume you are an intelegent cracker who does not want your latest tricks revealed. Performing what looks like a bad network scan several times (ie script kiddy type behaviour) and harvesting the time stamps and doing comparisons will show that the time skew is possibly the same. Opps play safe you have probably found a Honey Net, time to move on and try somewhere else.

    The Honey Net Operator just sees it as one more Skript Kiddy and does not realise that his network has been found by Timestamp Enumeration (it might not even make it past his IDS detectors threshold). The Cracker meanwhile may let their (very few) trusted colleages know their suspicions, meaning that the Crackers the Honey Net Operators are realy after will not knock on their door so no data to analyse (which is not good for the rest of us).

    Why do I say “may let” well the best of the crackers these days do not do it for fun they do it for comercial advantage be it either for the write up and subsiquent consulting advantage. Or worse from the ordinary users prespective for snooping Maleware. Eitherway the last thing the cracker needs is for their money making crack to get publisized / rumbeled before they have made good value from it.

    As a secondary atack again of value, it is not unknown for Hosting organisations to run more than one customer companies services on a single host but with different IP addresses or URLs.

    Now on the assumption you are a cracker for gain, youwill want to get at details on a particular companies website as the data held there is of value to you or your employer.

    The target website it’s self may not present any available oportunities to break in. But another companies site on the same host might well do so (actually quite likley for small and startup companies using hosting organisations, why spend money on making a secure site if it a couple of static pages and an emailing script).

    So as the cracker you get a time/frequency skew for the site of interest, then scan all the other sites within the hosting organisations domain looking for a match. Even if the Host organisation use the same IP address and different URLs this will be productive as sometimes they move sites from host to host (there are various ways a Cracker can find this information but it’s not relevant to the argument).

    As the cracker you can then investigate the other websites on the host of interest, the chances are atleast one will have an exploitable weakness. At this point you are in to the host with the priveladges of the web software. For a poorly implemented host this may be all you need to get to the data you could not otherwise get. If not the chances are that you can escalate your priveladges up to a point where you can. Either way you get what you are looking for no matter how securly the target company produced it’s web site.

    Also of note the only way to trully hide a site from time stamp enumeration is to make the timestamps of no use for the attack. That is you lock them to a national standard so that there is no measurable time skew to use as a fingerprint.

    This by the way does not mean simply installing NTP software, some of it is poorly writen and the time correction “error signal” will be visable almost like a triangular wave on the time stamps. Again it’s visable and identical on all the IP addresses and URLs on the host due to the use of a common clock source for the network ticks.

    To understand why the correction signal is visable imagine

    (for arguments sake) the rising slope of the waveform is the time skew of the CPU clock it will carry on rising unless corrected. When the NTP software detects a sufficiently large time error it makes the correction this would be the downward slope, the pitch of the slope is dependent on how hard the NTP software makes the correction. Also the point at which the correction is made is usually not at the minimum detectable time difference but at some greater point as this minimises the NTP softwares use of the hosts resources.

    If you look at a NTP software often the writers do make attempts to make the correction slope gradual not a step, this is mainly because a suden step effects other software etc detrimentaly.

    Some NTP software is predictive, in that it tryies to apply small corrections prior to them being detectably necesary again this is to minimise the effect on other software, however it usually uses a long time window as the assumption is the time skew is effectivly constant (effectivly an adjustable low pass filter on the previous correction data).

    However NTP software is not usually dynamicaly predictive therefore changes in system load etc may take the system quickly to a point where a visable error signal would appear on the interfaces. At which point somebody doing a timestamp enumeration sees a change that they can start corelating against.

    [Reply](https://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/?replytocom=3179#respond)
61. Pingback: [Light Blue Touchpaper » 23rd Chaos Communication Congress](http://www.lightbluetouchpaper.org/2006/12/12/23rd-chaos-communication-congress/)
63. Pingback: [phoenitydawn » 23C3 - Tag 2 - Überblick](http://blog.phoenitydawn.de/index.php/2006/12/29/23c3-tag-2-ueberblick/)
65. Pingback: [J@§¤ñ’s Stack Trace » Blog Archive » Identify Tor server by Clock Skew](http://www.jasonmacpherson.com/?p=32)

### Leave a Reply [Cancel reply](/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

Δ

September 2006
| M | T | W | T | F | S | S |
| --- | --- | --- | --- | --- | --- | --- |
|  | | | | [1](https://www.lightbluetouchpaper.org/2006/09/01/) | 2 | 3 |
| [4](https://www.lightbluetouchpaper.org/2006/09/04/) | 5 | [6](https://www.lightbluetouchpaper.org/2006/09/06/) | 7 | [8](https://www.lightbluetouchpaper.org/2006/09/08/) | 9 | 10 |
| 11 | 12 | 13 | 14 | [15](https://www.lightbluetouchpaper.org/2006/09/15/) | 16 | 17 |
| 18 | 19 | [20](https://www.lightbluetouchpaper.org/2006/09/20/) | 21 | [22](https://www.lightbluetouchpaper.org/2006/09/22/) | [23](https://www.lightbluetouchpaper.org/2006/09/23/) | 24 |
| 25 | [26](https://www.lightbluetouchpaper.org/2006/09/26/) | 27 | 28 | 29 | 30 |  |

[« Aug](https://www.lightbluetouchpaper.org/2006/08/)

[Oct »](https://www.lightbluetouchpaper.org/2006/10/)

### Recent Posts

* [3rd edition of Ross Anderson’s Security Engineering now freely available for download](https://www.lightbluetouchpaper.org/2024/11/12/sev3-download/)
* [Join Our 3-Course Series on Cybersecurity Economics](https://www.lightbluetouchpaper.org/2024/09/25/join-our-3-course-series-on-cybersecurity-economics/)
* [Two invitations to Cambridge](https://www.lightbluetouchpaper.org/2024/07/04/two-invitations-to-cambridge/)
* [Security and Human Behavior 2024](https://www.lightbluetouchpaper.org/2024/06/20/security-and-human-behavior-2024/)
* [Cambridge Cybercrime Conference 2024 – Liveblog](https://www.lightbluetouchpaper.org/2024/06/11/cambridge-cybercrime-conference-2024-liveblog/)
### Recent Comments

* Linda J. Montz on [Chip and Skim: cloning EMV cards with the pre-play attack](https://www.lightbluetouchpaper.org/2012/09/10/chip-and-skim-cloning-emv-cards-with-the-pre-play-attack/#comment-2690455)
* Mary on [Chip and Skim: cloning EMV cards with the pre-play attack](https://www.lightbluetouchpaper.org/2012/09/10/chip-and-skim-cloning-emv-cards-with-the-pre-play-attack/#comment-2688107)
* King Ables on [3rd edition of Ross Anderson’s Security Engineering now freely available for download](https://www.lightbluetouchpaper.org/2024/11/12/sev3-download/#comment-2682958)
* Arthurdob on [Phishing take-down paper wins 'Best Paper Award' at APWG eCrime Researcher's Summit](https://www.lightbluetouchpaper.org/2007/10/04/phishing-take-down-paper-wins-best-paper-award-at-apwg-ecrime-researchers-summit/#comment-2682645)
* Clive Robinson on [CoverDrop: Securing Initial Contact for Whistleblowers](https://www.lightbluetouchpaper.org/2022/03/11/coverdrop-securing-initial-contact-for-whistleblowers/#comment-2678211)
### Categories

Categories
Select Category
Academic papers  (311)
Authentication  (69)
Awards  (24)
Banking security  (140)
Call for papers  (31)
CHERI  (4)
CL frontpage  (4)
Cybercrime  (117)
Electronic voting  (14)
Internet censorship  (74)
Jobs  (26)
Legal issues  (244)
Meta  (15)
News coverage  (214)
Open-source security  (30)
Operating systems  (39)
Politics  (194)
Privacy technology  (165)
Programmable logic  (7)
Programming languages  (16)
Security economics  (273)
Security engineering  (289)
   Cryptology  (54)
   Hardware & signals  (49)
   Processors  (17)
   Protocols  (45)
   Usability  (45)
Security psychology  (107)
Seminars  (24)
Social networks  (41)
Spam  (6)
Three Paper Thursday  (28)
Uncategorized  (21)
Useful software  (14)
Web security  (41)

### Archives

Archives
Select Month
 November 2024
 September 2024
 July 2024
 June 2024
 March 2024
 December 2023
 November 2023
 October 2023
 September 2023
 August 2023
 July 2023
 June 2023
 March 2023
 February 2023
 December 2022
 October 2022
 September 2022
 August 2022
 July 2022
 June 2022
 May 2022
 March 2022
 January 2022
 December 2021
 November 2021
 October 2021
 September 2021
 August 2021
 June 2021
 May 2021
 April 2021
 March 2021
 January 2021
 December 2020
 November 2020
 October 2020
 September 2020
 August 2020
 July 2020
 June 2020
 May 2020
 April 2020
 February 2020
 January 2020
 December 2019
 November 2019
 October 2019
 August 2019
 July 2019
 June 2019
 May 2019
 April 2019
 March 2019
 February 2019
 January 2019
 November 2018
 October 2018
 September 2018
 August 2018
 July 2018
 June 2018
 May 2018
 April 2018
 March 2018
 February 2018
 January 2018
 December 2017
 November 2017
 October 2017
 September 2017
 August 2017
 July 2017
 June 2017
 May 2017
 April 2017
 March 2017
 February 2017
 January 2017
 December 2016
 October 2016
 September 2016
 August 2016
 July 2016
 June 2016
 May 2016
 April 2016
 March 2016
 February 2016
 January 2016
 December 2015
 November 2015
 October 2015
 September 2015
 August 2015
 July 2015
 June 2015
 May 2015
 April 2015
 March 2015
 February 2015
 January 2015
 December 2014
 November 2014
 October 2014
 September 2014
 August 2014
 July 2014
 June 2014
 May 2014
 April 2014
 March 2014
 February 2014
 January 2014
 December 2013
 November 2013
 October 2013
 September 2013
 July 2013
 June 2013
 May 2013
 April 2013
 March 2013
 February 2013
 January 2013
 December 2012
 November 2012
 October 2012
 September 2012
 August 2012
 July 2012
 June 2012
 May 2012
 April 2012
 March 2012
 February 2012
 January 2012
 December 2011
 November 2011
 October 2011
 September 2011
 August 2011
 July 2011
 June 2011
 May 2011
 April 2011
 March 2011
 February 2011
 January 2011
 December 2010
 October 2010
 September 2010
 August 2010
 July 2010
 June 2010
 May 2010
 March 2010
 February 2010
 January 2010
 December 2009
 November 2009
 October 2009
 September 2009
 August 2009
 July 2009
 June 2009
 May 2009
 April 2009
 March 2009
 February 2009
 January 2009
 December 2008
 November 2008
 October 2008
 September 2008
 August 2008
 July 2008
 June 2008
 May 2008
 April 2008
 March 2008
 February 2008
 January 2008
 December 2007
 November 2007
 October 2007
 September 2007
 August 2007
 July 2007
 June 2007
 May 2007
 April 2007
 March 2007
 February 2007
 January 2007
 December 2006
 November 2006
 October 2006
 September 2006
 August 2006
 July 2006
 June 2006
 May 2006
 April 2006
 March 2006
 February 2006

### Meta

* [Log in](https://www.lightbluetouchpaper.org/wp-login.php)
* [Entries feed](https://www.lightbluetouchpaper.org/feed/)
* [Comments feed](https://www.lightbluetouchpaper.org/comments/feed/)
* [WordPress.org](https://wordpress.org/)

[Privacy Policy](https://www.lightbluetouchpaper.org/about/privacy-policy/) [Proudly powered by WordPress](https://wordpress.org/)



=== Content from events.ccc.de_4177f9ee_20250125_222251.html ===

[![23rd Chaos Communication Congress](/congress/2006/Fahrplan/images/conference-128x128.png)](http://events.ccc.de/congress/2006/Home)

* [Index](/congress/2006/Fahrplan/index.en.html)
* [Day 1](/congress/2006/Fahrplan/day_1.en.html)
* [Day 2](/congress/2006/Fahrplan/day_2.en.html)
* [Day 3](/congress/2006/Fahrplan/day_3.en.html)
* [Day 4](/congress/2006/Fahrplan/day_4.en.html)
* [Speakers](/congress/2006/Fahrplan/speakers.en.html)
* [Events](/congress/2006/Fahrplan/events.en.html)

+ [Hacking](/congress/2006/Fahrplan/track/Hacking/index.en.html)
+ [Science](/congress/2006/Fahrplan/track/Science/index.en.html)
+ [Community](/congress/2006/Fahrplan/track/Community/index.en.html)
+ [Culture](/congress/2006/Fahrplan/track/Culture/index.en.html)
+ [Society](/congress/2006/Fahrplan/track/Society/index.en.html)
+ [General](/congress/2006/Fahrplan/track/General/index.en.html)

23C3 - 1.5

**23rd Chaos Communication Congress**

*Who can you trust?*

| Speakers | |
| --- | --- |
|  | [Steven J. Murdoch](/congress/2006/Fahrplan/speakers/143.en.html) |

| Schedule | |
| --- | --- |
| Day | 2 |
| Room | Saal 1 |
| Start time | 12:45 |
| Duration | 01:00 |
| Info | |
| ID | 1513 |
| Event type | Lecture |
| Track | Hacking |
| Language | English |

| Feedback | |
| --- | --- |
| Did you attend this event?  [Give Feedback](https://pentabarf.cccv.de/feedback/23C3/event/1513.en.html) | |

# Detecting temperature through clock skew

Hot or Not: Defeating anonymity by monitoring clock skew to remotely detect the temperature of a PC

![](/congress/2006/Fahrplan/images/event-1513-128x128.png)

By requesting timestamps from a computer, a remote adversary can find out the precise speed of its system clock. As each clock crystal is slightly different, and varies with temperature, this can act as a fingerprint of the computer and its location.

The end of my 22C3 talk showed how a side effect of TCP/IP steganography detection was to precisely measure the error of a computers system clock (skew). This talk will review and expand on that material, showing the various other mechanisms for monitoring clock skew and discussing the tradeoffs involved. Because every computer has a unique clock skew, even ones of the same model, this acts as a fingerprint. Even if that computer moves location and changes ISP, it can be later identified through this clock skew. In addition to varying between computers, clock skew also changes depending on temperature. Thus a remote attacker, monitoring timestamps, can make an estimate of a computers environment, which has wide-scale implications on security and privacy. Through measuring day length and time-zone, the location of a computer could be estimated, which is a particular concern with anonymity networks and VPNs. Local temperature changes caused by air-conditioning or movements of people can identify whether two machines are in the location, or even are virtual machines on one server. The temperature of a computer can also be influenced by CPU load, so opening up a low-bandwidth covert channel. This could be used by processes which are prohibited from communicating for confidentiality reasons and because this is a physical covert channel, it can even cross "air-gap" security boundaries. The talk will demonstrate how to use this channel to attack the hidden service feature offered by the Tor anonymity system. Here, an attacker can repeatedly access a hidden service, increasing CPU load and inducing a temperature change. This will affect clock skew, which the attacker can monitor on all candidate Tor servers. When there is a match between the load pattern and the clock skew, the attacker has linked the real IP address of a hidden server to its pseudonym, violating the anonymity properties Tor is designed to provide. The talk will also present a separate illustration of the temperature covert channel technique, investigating a suspected attack on the Tor network in August 2006, by a well equipped adversary.

## Attached files

* [Detecting temperature through clock skew (PDF file - 5.0 MB)](/congress/2006/Fahrplan/attachments/1211-23c3hotornotpres.pdf)

## Links

* [Academic paper](http://www.cl.cam.ac.uk/~sjm217/papers/ccs06hotornot.pdf)
* [Summary in blog post](http://www.lightbluetouchpaper.org/2006/09/04/hot-or-not-revealing-hidden-services-by-their-clock-skew/)

[<<<](/congress/2006/Fahrplan/events/1656.en.html)
[>>>](/congress/2006/Fahrplan/events/1756.en.html)

Archived page - [Impressum/Datenschutz](https://legal.cccv.de/)
