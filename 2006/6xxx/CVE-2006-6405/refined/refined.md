The provided content describes a vulnerability related to how some virus scanners handle MIME encoded email attachments, specifically Base64 encoding and multipart/mixed content. This vulnerability allows malicious content to bypass detection.

**Root Cause of Vulnerability:**

The root cause lies in the failure of some virus scanners to correctly decode MIME encoded content, particularly when unusual characters are inserted into the Base64 encoded data or when the malicious attachment is nested within multiple layers of multipart/mixed content. Some scanners do not adhere to the RFC 2045 standard which states that "All line breaks or other characters not found in [the alphabet] must be ignored by decoding software" allowing for crafted Base64 to be passed undetected.

**Weaknesses/Vulnerabilities:**

*   **Incorrect Base64 Decoding:** Some virus scanners fail to ignore non-alphabet characters within Base64 encoded data, leading to the malicious payload not being correctly decoded and scanned.
*   **Multipart/Mixed Content Parsing Issues:** Deeply nested multipart/mixed content can confuse virus scanners, causing them to either fail to scan the attachment, or in some cases, crash.
*   **Lack of Robustness:** The scanners lack robustness in handling slightly malformed but RFC-compliant MIME structures.

**Impact of Exploitation:**

*   **Bypassed Virus Detection:** Attackers can successfully send malicious content, such as viruses, via email, bypassing the virus scanner and potentially infecting the recipient's system.
*   **Denial of Service (DoS):** In some cases, deeply nested multipart/mixed content can cause a stack overflow in ClamAV, leading to a denial of service.

**Attack Vectors:**

*   **Email Attachments:** The primary attack vector is through email attachments that are crafted with specific MIME encoding techniques to evade detection.
*   **Base64 Encoding with Non-Alphabet Characters:** Injecting non-alphabet characters into Base64 encoded content.
*   **Deeply Nested Multipart/Mixed Content:** Wrapping the malicious payload within multiple levels of multipart/mixed content.

**Required Attacker Capabilities/Position:**

*   **Ability to craft email messages:** The attacker needs to be able to create email messages with specific MIME encoding structures.
*   **Knowledge of target scanner weaknesses:** The attacker needs knowledge of specific virus scanners' weaknesses in MIME parsing.

**Vulnerable products (as listed in the content):**

*   BitDefender Mail Protection for SMB 2.0
*   ClamAV 0.88.7 (and earlier versions are susceptible to crashes)
*   F-Prot Antivirus for Linux x86 Mail Servers 4.6.61
*   Kaspersky Anti-Virus for Linux Mail Server 5.5.10

**Note:** The content also mentions "Less vulnerable" scanners which, while not passing the malicious payload completely undetected, may fail to scan it properly due to deep multipart nesting, making the final outcome dependent on the configured policy and "Not vulnerable" scanners which are not susceptible to the described methods.