## CVE-2006-6797

The provided documents describe a denial-of-service vulnerability in the Client/Server Run-time Subsystem (CSRSS) service within Microsoft Windows.

Here's a breakdown of the vulnerability:

*   **Vulnerability:** CSRSS Denial of Service
*   **Root Cause:** The vulnerability is caused by incorrect error handling by the CSRSS service. Specifically, the CSRSS process fails to properly handle error messages.
*   **Affected Component:** Windows Client/Server Run-time Subsystem (CSRSS). CSRSS is the user-mode portion of the Win32 subsystem. CSRSS is responsible for console windows and creating/deleting threads.
*   **Attack Vector:** An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability cannot be exploited remotely or by anonymous users. An attacker runs a specially crafted application that triggers the incorrect error handling in CSRSS.
*   **Impact:** An attacker who successfully exploits this vulnerability could cause the affected system to stop responding and automatically restart, leading to a denial of service. The denial of service vulnerability would not allow an attacker to run code or to elevate their user rights, but it could cause the affected system to stop accepting requests.
*   **Mitigating Factors:** An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users.
*   **Affected Systems:** Windows 2000 SP4, Windows XP SP2, Windows XP Professional x64 Edition and Microsoft Windows XP Professional x64 Edition Service Pack 2, Microsoft Windows Server 2003, Microsoft Windows Server 2003 Service Pack 1, and Microsoft Windows Server 2003 Service Pack 2, Microsoft Windows Server 2003 for Itanium-based Systems, Microsoft Windows Server 2003 with SP1 for Itanium-based Systems, and Microsoft Windows Server 2003 with SP2 for Itanium-based Systems, Microsoft Windows Server 2003 x64 Edition and Microsoft Windows Server 2003 x64 Edition Service Pack 2, Windows Vista, Windows Vista x64 Edition.
*   **Resolution:** The vulnerability is resolved by ensuring that the Client/Server Run-time Subsystem correctly processes error messages. Apply the update provided in Microsoft Security Bulletin MS07-021.