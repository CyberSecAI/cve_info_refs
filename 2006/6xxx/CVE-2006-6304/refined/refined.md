```
{
  "cve": "CVE-2006-6304",
  "description": "The `do_coredump()` function in the Linux kernel does not use the `O_EXCL` flag when opening a core dump file, allowing a local attacker to overwrite or append data to an existing core file if the process's `suid_dumpable` setting is set to 2 and the attacker can guess the core file name before it is created.",
  "affected_systems": [
    "Red Hat Enterprise Linux 5",
        "Avaya Aura™ Application Enablement Services 5.2, 5.2.1",
        "Avaya Aura™ Communication Manager 5.2.x",
        "Avaya Aura™ SIP Enablement Services 5.2.x",
        "Avaya Voice Portal 5.0",
        "Avaya Aura™ System Manager 5.2, 6.0",
        "Avaya Aura™ Session Manager 1.1, 5.2",
        "Avaya Aura™ System Platform 1.1"
  ],
  "vulnerability_details": {
    "root_cause": "The `do_coredump()` function in the Linux kernel does not use the `O_EXCL` flag when opening a core dump file.",
    "weaknesses": [
      "Missing `O_EXCL` flag in `filp_open()` call during core dump creation.",
      "Unprotected file creation leading to potential rewrite attacks."
    ],
    "impact": "A local attacker can overwrite or append data to existing core files.",
    "attack_vector": "Local access, attacker must guess the name of the core dump file before it's created.",
        "required_capabilities": "Local user with ability to trigger a core dump, and knowledge of/ability to guess the core file name."
  },
  "additional_notes": [
    "The vulnerability only affects systems with `/proc/sys/fs/suid_dumpable` set to 2 (the default value is 0).",
    "The fix changes the expected behavior: with `suid_dumpable` set to 2, the core file will not be recorded if the file already exists, thus preventing overwrite or appending.",
    "According to one source, there were no known exploits of this bug at the time it was reported."
  ]
}
```