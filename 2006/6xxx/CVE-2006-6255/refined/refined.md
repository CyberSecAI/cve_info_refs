- **Root cause of vulnerability**: The `util.php` file in the NukeAI module of PHP-Nuke does not sanitize input passed through the `AIbasedir` parameter. This allows for the inclusion of a remote file, leading to remote code execution. The vulnerable code is `require_once $AIbasedir."/NukeAI/util.php";`.
- **Weaknesses/vulnerabilities present**: Remote File Inclusion (RFI)
- **Impact of exploitation**: An attacker can achieve Remote Code Execution (RCE) on the server by including a malicious PHP script.
- **Attack vectors**: By sending a crafted HTTP POST request to `modules/NukeAI/util.php` with a malicious URL in the `AIbasedir` parameter. The attacker can also use the created php shell to execute commands.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the target server.

The exploit code provided creates a PHP shell on the target and subsequently can be used to execute system commands on the target machine.
The exploit works by first sending a POST request to the vulnerable script `util.php` using the `AIbasedir` parameter to inject php code into a file, the script then attempts to access this file which results in execution of the attacker's code. A subsequent GET request is used to execute system commands via the created shell file.