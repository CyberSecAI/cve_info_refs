=== Content from bugs.debian.org_2107c52c_20250125_165243.html ===

# Debian Bug report logs - #394454 uses HTTP\_X\_FORWARDED\_FOR for authentication (and other security holes)

[![version graph](version.cgi?absolute=0;height=2;found=chetcpasswd%2F2.3.3-1;package=chetcpasswd;collapse=1;width=2)](version.cgi?collapse=1;info=1;package=chetcpasswd;absolute=0;found=chetcpasswd%2F2.3.3-1)

Package:
[chetcpasswd](pkgreport.cgi?package=chetcpasswd);
Maintainer for [chetcpasswd](pkgreport.cgi?package=chetcpasswd) is [(unknown)](pkgreport.cgi?maint=);

Reported by: [Bas Zoetekouw <bas@debian.org>](pkgreport.cgi?submitter=bas%40debian.org)

Date: Sat, 21 Oct 2006 11:33:02 UTC

Severity: *critical*

Tags: security

Found in version chetcpasswd/2.3.3-1

**Done:** Moritz Muehlenhoff <jmm@inutil.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=394454;mbox=yes), [status mbox](bugreport.cgi?bug=394454;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=394454;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Joao Eriberto Mota Filho <eriberto@eriberto.pro.br>`:

`Bug#394454`; Package `chetcpasswd`.
([full text](bugreport.cgi?bug=394454;msg=2), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Bas Zoetekouw <bas@debian.org>`:

New Bug report received and forwarded. Copy sent to `Joao Eriberto Mota Filho <eriberto@eriberto.pro.br>`.
([full text](bugreport.cgi?bug=394454;msg=4), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=394454;msg=5), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=bas%40debian.org)
From: Bas Zoetekouw <bas@debian.org>
To: submit@bugs.debian.org
Subject: uses HTTP\_X\_FORWARDED\_FOR for authentication (and other security holes)
Date: Sat, 21 Oct 2006 13:16:41 +0200
```
Subject: uses HTTP_X_FORWARDED_FOR for authentication (and other security holes)
Package: chetcpasswd
Version: 2.3.3-1
Severity: critical
Tags: security

chetpasswd uses the HTTP_X_FORWARDED_FOR for authentication purposes:

   if(getenv("HTTP_X_FORWARDED_FOR"))
      sprintf(IP,"%s",getenv("HTTP_X_FORWARDED_FOR"));
    else sprintf(IP,"%s",getenv("REMOTE_ADDR"));

and then goes on to check IP against
/etc/chetcpasswd/chetcpasswd.allow.

Obviously, HTTP_X_FORWARDED_FOR is not a trusted variable, and can be
spoofed by any scriptkiddie who can read the man page of wget.  Simply
spoofing it to 127.0.0.1 will give access to the password changing app
from any remote host.

Furthermore, this cgi script doesn't seem to implement any rate
limiting for the passwd checks, thereby  allowing for a dictionary
attack via http.  Also, it seems to give different a error message if
the user is not found then if the entered password is wrong, thereby
exposing the names of user accounts to external attackers.

There are also issues with the package not using pam, and its
circumventing of any checks the admin might have in place.

I really think this package needs a security audit.

-- System Information:
Debian Release: testing/unstable
  APT prefers unstable
  APT policy: (500, 'unstable'), (200, 'experimental')
Architecture: amd64 (x86_64)
Shell:  /bin/sh linked to /bin/dash
Kernel: Linux 2.6.17.8
Locale: LANG=en_GB.UTF-8, LC_CTYPE=en_GB.UTF-8 (charmap=UTF-8)

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Joao Eriberto Mota Filho <eriberto@eriberto.pro.br>`:

`Bug#394454`; Package `chetcpasswd`.
([full text](bugreport.cgi?bug=394454;msg=7), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Eriberto <eriberto@eriberto.pro.br>`:

Extra info received and forwarded to list. Copy sent to `Joao Eriberto Mota Filho <eriberto@eriberto.pro.br>`.
([full text](bugreport.cgi?bug=394454;msg=9), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 394454@bugs.debian.org ([full text](bugreport.cgi?bug=394454;msg=10), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=eriberto%40eriberto.pro.br)
From: Eriberto <eriberto@eriberto.pro.br>
To: "Bas Zoetekouw" <bas@debian.org>, 394454@bugs.debian.org
Subject: Re: Bug#394454: uses HTTP\_X\_FORWARDED\_FOR for authentication (and other security holes)
Date: Mon, 13 Nov 2006 16:40:34 -0200
```
The upstream author is not willing to cooperate on fixing the reported
bugs and considers Debian to be "too demanding". Still, the upstream
disrespected the Debian Project (used swear-word). I'm not willing to
fork his work nor maintain an ever growing patch to fix chetcpasswd
security flaws.

Regards,

Eriberto - Brazil

2006/10/21, Bas Zoetekouw <bas@debian.org>:
> Subject: uses HTTP_X_FORWARDED_FOR for authentication (and other security holes)
> Package: chetcpasswd
> Version: 2.3.3-1
> Severity: critical
> Tags: security

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Joao Eriberto Mota Filho <eriberto@eriberto.pro.br>`:

`Bug#394454`; Package `chetcpasswd`.
([full text](bugreport.cgi?bug=394454;msg=12), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent** to `Stefan Fritsch <sf@sfritsch.de>`:

Extra info received and forwarded to list. Copy sent to `Joao Eriberto Mota Filho <eriberto@eriberto.pro.br>`.
([full text](bugreport.cgi?bug=394454;msg=14), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 394454@bugs.debian.org ([full text](bugreport.cgi?bug=394454;msg=15), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=sf%40sfritsch.de)
From: Stefan Fritsch <sf@sfritsch.de>
To: 394454@bugs.debian.org
Subject: CVE-2006-6639: more security issues in chetcpasswd
Date: Thu, 21 Dec 2006 20:09:27 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=394454;msg=15) (text/plain, inline)]
```
```
According to <http://secunia.com/advisories/23024>, there are more
security issues in chectpasswd.

It should be removed from Debian if no fix is expected.

Cheers,
Stefan

```
```
[[Message part 2](bugreport.cgi?att=1;bug=394454;msg=15) (application/pgp-signature, inline)]
```

---

**Reply sent** to `Moritz Muehlenhoff <jmm@inutil.org>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=394454;msg=17), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=17), [link](#16)).

---

**Notification sent** to `Bas Zoetekouw <bas@debian.org>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=394454;msg=19), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 394454-done@bugs.debian.org ([full text](bugreport.cgi?bug=394454;msg=20), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: 394454-done@bugs.debian.org, 394453-done@bugs.debian.org
Subject: Has been removed
Date: Mon, 25 Dec 2006 18:26:19 +0100
```
chetcpasswd has been removed from the archive; closing the open bugs.

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 18 Jun 2007 08:50:48 GMT) ([full text](bugreport.cgi?bug=394454;msg=22), [mbox](bugreport.cgi?bug=394454;mbox=yes;msg=22), [link](#21)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=394454).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 16:52:43 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


