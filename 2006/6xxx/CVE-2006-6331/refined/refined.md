```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is caused by the lack of proper sanitization of the 'torrent' parameter in metaInfo.php before passing it to shell_exec(). When the configuration option `$cfg['enable_file_priority']` is set to false, the application executes a shell command that includes the unsanitized 'torrent' parameter, leading to command injection.",
    "weaknesses": [
      "Improper input sanitization",
      "Command injection vulnerability"
    ],
    "impact": "Remote attackers can execute arbitrary shell commands on the server.",
    "attack_vectors": "By sending a specially crafted HTTP request to `details.php` or `startpop.php` with malicious shell metacharacters (backticks) in the 'torrent' parameter.",
     "required_capabilities": "The attacker must be able to send HTTP requests to the server and know that `$cfg['enable_file_priority']` is false. The attacker must also have a valid user account on the TorrentFlux system."
  },
  "additional_details": {
    "exploit_example": "An attacker can trigger the vulnerability by sending a request to `details.php` with the `torrent` parameter set to: `http://xxx/torrentflux/details.php?torrent=\`touch> /tmp/hello\``, which will execute the `touch` command.",
    "mitigation": "The vulnerability can be fixed by using `escapeshellarg()` on the input before passing it to `shell_exec()`, and by using SecurityClean() on the $torrent input in `metaInfo.php` and `startpop.php` to remove ../ sequences and other malicious characters.",
    "additional_notes": "This vulnerability is present in TorrentFlux 2.1 and 2.2, when `$cfg['enable_file_priority']` is false. The vulnerability can also be triggered in 2.2 by creating a custom torrent file containing filenames with backticks."
  }
}
```