- **Root cause of vulnerability:** The `buycd.php` script in Paristemi 0.8.3b fails to properly initialize the `$HTTP_DOCUMENT_ROOT` variable before using it in a file inclusion.
- **Weaknesses/vulnerabilities present:** Remote File Inclusion (RFI). The script is vulnerable because it uses an uninitialized variable in a `require_once` statement, allowing an attacker to control the included file path. The code `require_once $HTTP_DOCUMENT_ROOT.$INCLUDE_PATH.$HEADER;` is vulnerable because `$HTTP_DOCUMENT_ROOT` can be set via a query string if `register_globals` is enabled.
- **Impact of exploitation:** Remote code execution. By including a malicious remote file, an attacker can execute arbitrary code on the server.
- **Attack vectors:** By crafting a malicious URL that sets the `HTTP_DOCUMENT_ROOT` variable to point to a remote server containing attacker controlled code, an attacker can trigger the inclusion and execution of the malicious code.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the vulnerable server. The attacker also needs a server to host their malicious PHP code. The target server needs to have `register_globals` set to on.