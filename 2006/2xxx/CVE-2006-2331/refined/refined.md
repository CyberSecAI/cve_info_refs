```
{
  "vulnerability": {
    "root_cause": "The application fails to properly validate uploaded avatar file names and their content, and improperly sanitizes user-provided locale settings before including files.",
    "weaknesses": [
      "Improper file extension handling",
      "Insufficient input sanitization",
      "Arbitrary file upload",
      "Local file inclusion",
	  "SQL injection"
    ],
    "impact": "Arbitrary code execution, sensitive information disclosure.",
    "attack_vectors": [
      "Uploading a file with a double extension (e.g., .php.gif) containing malicious code as EXIF metadata through the avatar upload functionality.",
      "Manipulating the 'locale' setting in the 'last_seen_users_panel.php' and 'setup.php' files to include arbitrary local files.",
	  "SQL injection via the 'forum_id' and 'lastvisited' variables in forum components"
    ],
    "required_capabilities": "A valid user account is required to upload an avatar. The local file inclusion vulnerability requires register_globals to be on and magic_quotes_gpc to be off or magic_quotes_gpc to be off for setup.php. For the SQL injection the attacker has to be a logged in member or logged out for different attack vectors."
  }
}
```