=== Content from www.attrition.org_4a497072_20250125_190542.html ===

# [VIM] verified SQL injection in IntegraMOD 1.4.0 (source inspection)

**Steven M. Christey**
coley at mitre.org

*Mon Jun 12 17:44:10 EDT 2006*

* Previous message: [[VIM] verify of ViArt Shop Free 2.5.5 issue (diff digging)](000846.html)
* Next message: [[VIM] vendor inquiry for vsREAL / vSCAL](000849.html)
* **Messages sorted by:**
  [[ date ]](date.html#847)
  [[ thread ]](thread.html#847)
  [[ subject ]](subject.html#847)
  [[ author ]](author.html#847)

---

```

Ref:

  BUGTRAQ:20060606 Multiple Sql injection and XSS in integramod portal
  URL:<http://www.securityfocus.com/archive/1/archive/1/436457/100/0/threaded>

Some VDB's didn't list the SQL injection, but they listed the XSS.

notice in the Bugtraq post that the demo URL is:

  <http://target/index.php?STYLE_URL=%2527>

which decodes to "%27" which, itself, decodes to "'"

So, we have SQL injection by double-decoding.

from includes/functions.php of a 1.4.0 download:

	if ( isset($HTTP_POST_VARS[STYLE_URL]) || isset($HTTP_GET_VARS[STYLE_URL]) )
	{
		$style = urldecode( (isset($HTTP_POST_VARS[STYLE_URL])) ? $HTTP_POST_VARS[STYLE_URL] : $HTTP_GET_VARS[STYLE_URL] );
		if ( $theme = setup_style($style) )
		{

....

	if ( isset($HTTP_COOKIE_VARS[$board_config['cookie_name'] . '_style']) )
	{
		$style = $HTTP_COOKIE_VARS[$board_config['cookie_name'] . '_style'];
		if ( $theme = setup_style($style) )
		{

...

  function setup_style($style)
  {
  	global $db, $board_config, $template, $images, $phpbb_root_path, $var_cache, $portal_config, $current_template_path;

  	// BEGIN Style Select MOD
  	if ( intval($style) == 0 )
  	{
		$sql = "SELECT themes_id
				FROM " . THEMES_TABLE . "
				WHERE style_name = '$style'";

So... setup_style() checks if its $style argument equates to an
integer value of 0, which is the case with most arbitrary non-numeric
strings as I understand it.

But it then just feeds '$style' into a SQL query.

I would venture a guess that the "%2527" string is first decoded to
"%27" by PHP itself (this is mentioned in a comment in the online PHP
manual entry for urlencode), and then the "urldecode" call will then
translate the "%27" to a "'".

- Steve

```

---

* Previous message: [[VIM] verify of ViArt Shop Free 2.5.5 issue (diff digging)](000846.html)
* Next message: [[VIM] vendor inquiry for vsREAL / vSCAL](000849.html)
* **Messages sorted by:**
  [[ date ]](date.html#847)
  [[ thread ]](thread.html#847)
  [[ subject ]](subject.html#847)
  [[ author ]](author.html#847)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from securityreason.com_9a9e9ec6_20250125_190531.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


