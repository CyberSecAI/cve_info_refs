=== Content from www.vupen.com_0a28c8a5_20250124_153702.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from www.hustlelabs.com_620c9258_20250124_153702.html ===
Tumbleweed Email Firewall
Remote Stack Overflow
04-July-2006

Summary
Tumbleweed’s Email Firewall (EMF) blocks spam and viruses, phishing and
email fraud, and keeps hackers from compromising your network.  To ensure
compliance with government and industry regulations like HIPAA, GLBA,
Sarbanes-Oxley and Safe Harbor (EU), MailGate Email Firewall provides
sophisticated filtering, monitoring, encryption and reporting capabilities.
According to product literature, Tumbleweed is used by: over 150 healthcare
providers, the Department of Defense, the Department of Homeland Security, all
four branches of the US Military, state and local governments internationally, 8 of
the top 10 US banks, 4 of the top 5 Canadian banks, and 6 of the top 10
European banks.

Tumbleweed’s EMF Decomposer, a component that decompresses incoming e-
mail attachments, has three separate vulnerabilities within its LHA processing
routines.  The first issue causes the LHA processing engine to exhibit a stack-
buffer overflow while processing extended-header filenames.  The second issue
is a stack overflow while processing LHA extended-header directory names.  The
third issue is a buffer overflow during a sprintf call while processing long
filenames contained in an LHA archive.

Impact
These vulnerabilities are present by default in Tumbleweed’s Email Firewall.  To
exploit these vulnerabilities, an attacker only needs to send an e-mail to an
organization running Tumbleweed; it is not necessary that the e-mail is opened.
Successful exploitation of these vulnerabilities results in remote code execution
with the full privileges of the MMSDecompose process.  The default settings
allow an attacker to obtain super-user access to the machine.  Since these
vulnerabilities are stack based overflows, exploits can be made to work reliably.

Affected software
Tumbleweed Email Firewall (All Versions)

Credit
These vulnerabilities were researched by Ryan Smith.

Contact
advisories@hustlelabs.com

Page 1 of 5

Details
In the following code segment, the program reads a word-sized value from the
file: the LHA extended-header size.  If the LHA header level is equal-to 1 then the
program will read in more data to a buffer.  Next, depending on the value of the
extended-header-type byte, the program branches to an area of code that
handles the specific type or a generic handler if it’s an unrecognized type.

If the extended-header-type byte is equal to 0x01, then the following code parses
the data for the header.  The size allocated for this buffer is equal-to 0x100 bytes,
but there is no length restriction. Thus, an attacker can supply a value greater-
than 0x100 in an archive file to cause a buffer-overflow.

Page 2 of 5

As well, if the extended-header-type byte is equal to 0x02, then this next piece of
code parses the data for the header.  The size allocated for this buffer is equal-to
0x100 bytes; however, there is no restriction for the number of bytes the program
will copy from the file, to the buffer.  An attacker can supply a value greater-than
0x100 to cause a buffer-overflow.

The next code excerpt is responsible for concatenating a temporary directory and
the filename strings, in order to derive the path for the output of decompression.
The first variable to the sprintf call is the format string “%s/%s”, the second
variable is the temporary pathname, and the third is the filename.  Of these
parameters, the filename parameter is a user controlled value whose size should
be no larger than 0x100 bytes (Including a null-termination character), according
to the program’s data structures.  Ignoring the fact that the size restriction is not
enforced, a temporary pathname greater-than 2 characters in length will allow a
buffer overflow to occur even for archive names that are legitimately sized.

Page 3 of 5

Remediation
The code should be modified such that there is a standard maximum length of a
path.  If the path exceeds the maximum length, then the file should be rejected,
or the path truncated.

Though Tumbleweed won’t release a patch, they officially recommend the
following actions:

•  Stopping the EMF services
•  Removing or renaming the wlha32.dll file, found in the EMF install

directory.

•  Restarting the EMF services

Timeline of Events
04-July-2006 – Advisory draft
11-July-2006 – Vendor notification
24-July-2006 – Vendor released customer notification and the workaround

Page 4 of 5

Attributions
Images of Billy the Kid, Jesse James, Butch Cassidy, and Doc Holiday were
taken from Wikipedia.
(http://www.wikipedia.org)

Image of the tumbleweed along a road was photographed by AV Smith, from the
Galveston Arts Center. (http://www.galvestonartscenter.org)

Code and cross-reference screenshots captured using IDA
(http://www.datarescue.com).

Flawed code and marketing information obtained from Tumbleweed
(http://www.tumbleweed.com).

The Creative Commons license-notification image borrowed from
http://www.creativecommons.org.

License
This work is licensed under the Creative Commons Attribution 2.5 License. To
view a copy of this license, visit http://creativecommons.org/licenses/by/2.5/ or
send a letter to Creative Commons, 543 Howard Street, 5th Floor, San
Francisco, California, 94105, USA.

Attribution should be provided both in the form of a link or reference to
http://www.hustlelabs.com and a copy of the researchers’ names listed under the
Credit section of this document.

All other trademarks and copyrights referenced in this document are the property
of their respective owners.

Page 5 of 5


