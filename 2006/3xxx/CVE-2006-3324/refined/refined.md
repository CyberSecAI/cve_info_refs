```
{
  "cveId": "CVE-2006-3324",
  "relatedContent": [
    {
      "source": "aluigi.altervista.org_f96ec9d9_20250125_020414.html",
      "vulnerabilityDetails": {
        "rootCause": "The Quake 3 engine's 'Automatic Downloading' feature, combined with a vulnerability in how the server communicates with the client.",
        "weaknesses": [
          "**File Overwriting via Automatic Downloading:** The client downloads PK3 files from the server, and a flaw in how the filenames are handled allows a malicious server to overwrite files on the client's system.",
           "**Cvar Overwriting:** The server can overwrite client cvars (variables), including write-protected ones, by sending them in the systemInfo string. This allows for manipulation of client settings and behavior."
        ],
        "impact": "Arbitrary file overwriting, information stealing, and potentially arbitrary code execution through the modification of configuration files or other critical system files.",
        "attackVectors": [
          "A malicious server can send specially crafted server information to the client when a player joins, enabling the exploitation.",
            "The automatic download of PK3 files can lead to overwriting of arbitrary files on the client's machine"
        ],
        "attackerCapabilities": "The attacker needs to host a modified Quake 3 server.",
         "additionalDetails": "The 'Automatic Downloading' feature downloads PK3 files (maps and mods). The client compares the server's filenames and checksums with its own. If a file is needed, its name is added to the neededpaks buffer, using the Q_strcat function to prevent buffer overflows. However, if the string reaches a certain length (1023 bytes), the '.pk3' extension can be omitted from the last local filename. This leads to file overwriting because the client then saves the file with the server-provided name, and no extension enforcement takes place. The server can also set any client-side cvars including the fs_homepath which determines the folder used for the automatic downloads, which allows the attacker to specify where the malicious file gets downloaded. The cvars can be set without any client-side user interaction.",
         "affectedVersions": "Quake 3 <= 1.32c, Icculus.org Quake 3 <= revision 803, and other derived projects."
      }
    },
    {
        "source": "svn.icculus.org_351ef57f_20250125_020419.html",
        "vulnerabilityDetails": {
            "rootCause": "The vulnerability was due to a flaw in the automatic downloading functionality and directory traversal checks within the Quake 3 engine.",
            "weaknesses": [
                "The primary weakness was the lack of proper input validation and sanitization of filenames during automatic downloads, allowing directory traversal and file overwriting attacks."
            ],
            "impact": "A malicious server could write and overwrite any file within the Quake 3 directory of the client.",
            "attackVectors": [
                "A malicious server exploits the automatic downloading mechanism by sending crafted filenames that bypass directory traversal checks."
            ],
             "attackerCapabilities": "The attacker requires the ability to operate a malicious Quake 3 server.",
             "additionalDetails": "This commit log indicates a fix for the file overwriting vulnerability reported by Luigi Auriemma. The fix includes a directory traversal check being moved to a more appropriate location and added sanity checks for checksum/pakname storage. This commit specifically addresses the file overwriting vulnerability, which is part of CVE-2006-3324."

         }
    },
     {
      "source": "securityreason.com_98af3733_20250125_020417.html",
      "vulnerabilityDetails": {
        "rootCause": "The vulnerability is due to insufficient checks within the Quake 3 engine when handling server-sent data, allowing manipulation of client-side settings and file system access.",
        "weaknesses": [
          "**Unrestricted Cvar Modification:** The server can overwrite client-side variables (cvars), including write-protected ones, leading to unintended behavior.",
          "**File Overwriting:** The server can trigger automatic downloads with manipulated filenames, allowing the overwriting of arbitrary files on the client's file system."
        ],
        "impact": "Arbitrary file overwriting on the client system, modification of client configurations, and potential execution of arbitrary code through overwritten or manipulated files.",
        "attackVectors": [
          "A malicious Quake 3 server exploits this vulnerability when a client connects to it by sending crafted cvar and file download information.",
            "The automatic download functionality is misused by sending crafted file names to overwrite files."
        ],
        "attackerCapabilities": "The attacker needs to control a Quake 3 server to send the malicious data.",
           "additionalDetails": "This update clarifies that CD-key stealing is not possible through this vulnerability, but the provided proof-of-concept (PoC) now includes setting the `cl_allowdownload` cvar to force file downloads even when disabled by the client. The PoC shows how a malicious server can overwrite client files, and also mentions the need to relaunch the server or change map to repeat the attack.",
        "affectedVersions": "Quake 3 engine (1.32c / rev 803 / ...)"
      }
    }
  ]
}
```