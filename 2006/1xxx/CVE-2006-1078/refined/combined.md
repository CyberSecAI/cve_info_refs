=== Content from packetstormsecurity.com_c84eb758_20250125_131514.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from seclists.org_d99743fc_20250125_131516.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](358)
[By Date](date.html#359)
[![Next](/images/right-icon-16x16.png)](360)

[![Previous](/images/left-icon-16x16.png)](356)
[By Thread](index.html#359)
[![Next](/images/right-icon-16x16.png)](354)

![](/shared/images/nst-icons.svg#search)

# Re: local buffer overflow in htpasswd for apache 1.3.31 not fixed in .33?

---

*From*: Michael Engert <michi () bello engert org>

*Date*: Fri, 29 Oct 2004 23:34:08 +0200 (CEST)

---

```
Hello,

I can confirm the buffer overflow in htpasswd of apache 1.3.33, for which
Luiz Fernando has written a PoC. ...

On Fri, 29 Oct 2004, Larry Cashdollar wrote:

```
> ```
> This was posted on the full-disclosure list sept 16 2004 by
> Luiz Fernando.
>
> <http://archives.neohapsis.com/archives/fulldisclosure/2004-09/0547.html>
>
> ```

```
[...]

```
> ```
> It is still vulnerable.
>
> ```

```

But Larrys patch "fixes" a lot of peaces of code, which aren't
vulnerable in my oppinion. A closer look shows, that the calls to strcpy
are protected by if-statements, which prevent a exploitation. Its just one
place where a closing brace ('}') is at the wrong position. ;-)

So, instead of this ...

```
> ```
> root@bokchoy:~/tes/apache_1.3.33/src/support# diff -uN  htpasswd.orig.c
> htpasswd.c
> --- htpasswd.orig.c     2004-10-28 18:20:13.000000000 -0400
> +++ htpasswd.c  2004-10-28 18:17:25.000000000 -0400
> @@ -202,9 +202,9 @@
>         ap_cpystrn(record, "resultant record too long", (rlen - 1));
>         return ERR_OVERFLOW;
>      }
> -    strcpy(record, user);
> +    strncpy(record, user,MAX_STRING_LEN - 1);
>      strcat(record, ":");
> -    strcat(record, cpw);
> +    strncat(record, cpw,MAX_STRING_LEN - 1);
>      return 0;
>  }
>
> @@ -410,14 +410,14 @@
>             fprintf(stderr, "%s: filename too long\n", argv[0]);
>             return ERR_OVERFLOW;
>         }
> -       strcpy(pwfilename, argv[i]);
> +       strncpy(pwfilename, argv[i], MAX_STRING_LEN-1);
>         if (strlen(argv[i + 1]) > (sizeof(user) - 1)) {
>             fprintf(stderr, "%s: username too long (>%lu)\n", argv[0],
>                     (unsigned long)(sizeof(user) - 1));
>             return ERR_OVERFLOW;
>         }
>      }
> -    strcpy(user, argv[i + 1]);
> +    strncpy(user, argv[i + 1],MAX_STRING_LEN-1);
>      if ((arg = strchr(user, ':')) != NULL) {
>         fprintf(stderr, "%s: username contains illegal character
> '%c'\n",
>                 argv[0], *arg);
> @@ -429,7 +429,7 @@
>                     (unsigned long)(sizeof(password) - 1));
>             return ERR_OVERFLOW;
>         }
> -       strcpy(password, argv[i + 2]);
> +       strncpy(password, argv[i + 2],MAX_STRING_LEN - 1 );
>      }
>
>  #ifdef WIN32
> @@ -553,7 +553,7 @@
>                 putline(ftemp, line);
>                 continue;
>             }
> -           strcpy(scratch, line);
> +           strncpy(scratch, line,MAX_STRING_LEN -1);
>             /*
>              * See if this is our user.
>              */
>
> ```

```

... I suggest the following shorter one, which will give us also a correct
error message instead of eventually filling htpasswd with "short" entries:

| --- src/support/htpasswd.c.orig       Fri Feb 20 23:02:24 2004
| +++ src/support/htpasswd.c    Fri Oct 29 21:13:36 2004
| @@ -411,11 +411,11 @@
|           return ERR_OVERFLOW;
|       }
|       strcpy(pwfilename, argv[i]);
|-      if (strlen(argv[i + 1]) > (sizeof(user) - 1)) {
|-          fprintf(stderr, "%s: username too long (>%lu)\n", argv[0],
|-                  (unsigned long)(sizeof(user) - 1));
|-          return ERR_OVERFLOW;
|-      }
|+    }
|+    if (strlen(argv[i + 1]) > (sizeof(user) - 1)) {
|+      fprintf(stderr, "%s: username too long (>%lu)\n", argv[0],
|+              (unsigned long)(sizeof(user) - 1));
|+      return ERR_OVERFLOW;
|     }
|     strcpy(user, argv[i + 1]);
|     if ((arg = strchr(user, ':')) != NULL) {

This bug exists in 1.3.31, 1.3.32 and 1.3.33. I didn't test other
versions. As I don't find a entry in the bug database, I reported that bug
to the apache httpd people. The Bug ID is #31975.

Yours, Michi.
----------------------------------------------------------------------------
 Michael Engert                                            michi () engert org
 80337 München

```

---

[![Previous](/images/left-icon-16x16.png)](358)
[By Date](date.html#359)
[![Next](/images/right-icon-16x16.png)](360)

[![Previous](/images/left-icon-16x16.png)](356)
[By Thread](index.html#359)
[![Next](/images/right-icon-16x16.png)](354)

### Current thread:

* [local buffer overflow in htpasswd for apache 1.3.31 not fixed in .33?](343) *Larry Cashdollar (Oct 29)*
  + [Re: local buffer overflow in htpasswd for apache 1.3.31 not fixed in .33?](356) *André Malo (Oct 29)*
  + **Re: local buffer overflow in htpasswd for apache 1.3.31 not fixed in .33?** *Michael Engert (Oct 30)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from marc.info_b19f120d_20250125_131513.html ===

```
[[prev in list](?l=thttpd&m=114153031201867&w=2)] [[next in list](?l=thttpd&m=114170495829054&w=2)] [[prev in thread](?l=thttpd&m=114153031201867&w=2)] [next in thread]
List:       [thttpd](?l=thttpd&r=1&w=2)
Subject:    [Re: [THTTPD] htpasswd.c security issues.](?t=114153048400001&r=1&w=2)
From:       [Jef Poskanzer <jef () mail ! acme ! com>](?a=111654147100001&r=1&w=2)
Date:       [2006-03-05 2:44:01](?l=thttpd&r=1&w=2&b=200603)
Message-ID: [200603050244.k252i2Nc021694 () gate ! acme ! com](?i=200603050244.k252i2Nc021694%20()%20gate%20!%20acme%20!%20com)
[Download RAW [message](?l=thttpd&m=114154083000296&q=mbox) or [body](?l=thttpd&m=114154083000296&q=raw)]

Thanks.  htpasswd.c was copied verbatim from Apache so I tend
not to make changes to it.  However I'll see about importing
the current Apache version, which probably has been greatly improved.
---
Jef

       Jef Poskanzer  jef@mail.acme.com  <http://www.acme.com/jef/>
[[prev in list](?l=thttpd&m=114153031201867&w=2)] [[next in list](?l=thttpd&m=114170495829054&w=2)] [[prev in thread](?l=thttpd&m=114153031201867&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from issues.apache.org_d4396336_20250125_131511.html ===


ASF Bugzilla – Bug 41279
Apache 1.3.37 htpasswd is vulnerable to buffer overflow vulnerability
Last modified: 2011-03-21 11:03:14 UTC

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/en/html/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=41279&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=41279&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

[**Bug 41279**](show_bug.cgi?id=41279)
- Apache 1.3.37 htpasswd is vulnerable to buffer overflow vulnerability

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Apache 1.3.37 htpasswd is vulnerable to buffer overflow vulnerability

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED WONTFIX | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Apache httpd-1.3 | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Apache httpd-1.3 "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Other ([show other bugs](buglist.cgi?component=Other&product=Apache%20httpd-1.3&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | HEAD | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 normal ([vote](page.cgi?id=voting/user.html&bug_id=41279#vote_41279)) | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Apache HTTPD Bugs Mailing List | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2007-01-02 12:13 UTC by Matias S. Soler | | --- | --- | | Modified: | 2011-03-21 11:03 UTC ([History](show_activity.cgi?id=41279)) | | CC List: | 1 user (show)  gnuler | |  | | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=41279&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=41279&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=41279#c0)  Matias S. Soler    2007-01-02 12:13:32 UTC  ``` Synopsis: Apache 1.3.37 htpasswd buffer overflow vulnerability Version: 1.3.37 (latest 1.3.xx)  Product ======= Apache htpasswd utility   Issue ===== A buffer overflow vilnerability has been found, it is dangerous only on environment where the binary is suid root.  Details ======= Incorrect validation on the size of user input allows to copy a string, via strcpy, to a fixed size buffer. File: htpasswd.c, Line 421.  Solution ======== Apply this patch to htpasswd.c  -----8<-----8<-----8<-----8<-----8<-----8<-----8<-----8<-----8<-----8<-----8<--    415,419c415,420   <       if (strlen(argv[i + 1]) > (sizeof(user) - 1)) {   <           fprintf(stderr, "%s: username too long (>%lu)\n", argv[0],   <                   (unsigned long)(sizeof(user) - 1));   <           return ERR_OVERFLOW;   <       }   ---   >     }   >     if (strlen(argv[i + 1]) > (sizeof(user) - 1)) {   >       fprintf(stderr, "%s: username too long (>%lu)\n", argv[0],   >       (unsigned long)(sizeof(user) - 1));   >       return ERR_OVERFLOW;   > --->8----->8----->8----->8----->8----->8----->8----->8----->8----->8----->8-----  Affected Versions ================== 1.3.37 - <http://www.apache.org/dist/httpd/apache_1.3.37.tar.gz>  Notes & References ================== Another similar bug was discovered by Luiz Fernando [1], Larry Cashdollar's patch also fixed the bug i'm posting, but it seems not to be applied on the latest versions of apache 1.3.xx.  Michael Engert submitted another patch[1] which also fixed this bug and filled out a bug report [1], but it wasn't applied.  Have a look at Other posts[3][4] on this (and similar) issues.  1 - <http://archives.neohapsis.com/archives/fulldisclosure/2004-09/0547.html> 2 - <http://issues.apache.org/bugzilla/show_bug.cgi?id=31975> 3 - <http://seclists.org/bugtraq/2004/Oct/0359.html> 4 - <http://www.security-express.com/archives/fulldisclosure/2004-10/1117.html>   Credits ======= Matias S. Soler - gnuler [at] gmail [dot] com Luiz Fernando Michael Engert ```  [Comment 1](show_bug.cgi?id=41279#c1)  Malte S. Stretz    2011-03-21 11:03:14 UTC  ``` Apache HTTP Server 1.3.x is not supported anymore and no bugs will be fixed in the old codebase (cf. <[http://mail-archives.apache.org/mod_mbox/httpd-announce/201002.mbox/%3C20100203000334.GA19021@infiltrator.stdlib.net%3E](http://mail-archives.apache.org/mod_mbox/httpd-announce/201002.mbox/%3C20100203000334.GA19021%40infiltrator.stdlib.net%3E)>). Since this bug seems to affect only 1.3.x, I'm closing it as WONTFIX.  If this bug still affects you in a recent version (version 2.2.x or the upcoming version 2.4), please open a new bug.  Thank you for reporting the bug. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=41279)
* - [XML](show_bug.cgi?ctype=xml&id=41279)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=41279)
* - Top of page

This is **ASF Bugzilla**: the Apache Software Foundation bug system. In case
of problems with the functioning of ASF Bugzilla, please contact
bugzilla-admin@apache.org.
**Please Note:** this e-mail address is **only** for reporting problems
with ASF Bugzilla. Mail about any other subject will be silently
ignored.

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/en/html/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=41279&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=41279&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from issues.apache.org_0bc81fd2_20250125_131510.html ===


ASF Bugzilla – Bug 31975
httpd-1.3.33: buffer overflow in htpasswd if called with long arguments
Last modified: 2011-03-21 11:01:17 UTC

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/en/html/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=31975&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=31975&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

[**Bug 31975**](show_bug.cgi?id=31975)
- httpd-1.3.33: buffer overflow in htpasswd if called with long arguments

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
httpd-1.3.33: buffer overflow in htpasswd if called with long arguments

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED WONTFIX | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Apache httpd-1.3 | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Apache httpd-1.3 "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Other ([show other bugs](buglist.cgi?component=Other&product=Apache%20httpd-1.3&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | HEAD | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 normal with [3 votes](page.cgi?id=voting/bug.html&bug_id=31975) ([vote](page.cgi?id=voting/user.html&bug_id=31975#vote_31975)) | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Apache HTTPD Bugs Mailing List | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2004-10-29 21:22 UTC by Michael Engert | | --- | --- | | Modified: | 2011-03-21 11:01 UTC ([History](show_activity.cgi?id=31975)) | | CC List: | 1 user (show)  issues.apache.org | |  | | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=31975&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=31975&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=31975#c0)  Michael Engert    2004-10-29 21:22:13 UTC  ``` Luiz Fernando wrote an article in the Full-Disclosure Mailing List (see: <http://archives.neohapsis.com/archives/fulldisclosure/2004-09/0547.html>), publishing a PoC how to crash htpasswd. This could become a problem, if htpasswd is run suid root with user supplied arguments at the command line.  Larry Cashdollar <lwc@vapid.ath.cx> replied to this message via BUQTRAQ, giving a patch, which replaces all calls to strcpy() with calls to strncpy(). Looking at the code, I found that this wasn't neccessary, because the strcpy()-calls in the original are protected by if-statements. Well, almost all strcpy()-calls are protected. At one place the protecting if-statement slipped into another one, becoming useless in some situations.  So I created this little patch against src/support/htpasswd.c shipped with apache-1.3.33.tar.gz:  --- cut --- cut --- cut --- --- src/support/htpasswd.c.orig	Fri Feb 20 23:02:24 2004 +++ src/support/htpasswd.c	Fri Oct 29 21:13:36 2004 @@ -411,11 +411,11 @@  	    return ERR_OVERFLOW;  	}  	strcpy(pwfilename, argv[i]); -	if (strlen(argv[i + 1]) > (sizeof(user) - 1)) { -	    fprintf(stderr, "%s: username too long (>%lu)\n", argv[0], -		    (unsigned long)(sizeof(user) - 1)); -	    return ERR_OVERFLOW; -	} +    } +    if (strlen(argv[i + 1]) > (sizeof(user) - 1)) { +	fprintf(stderr, "%s: username too long (>%lu)\n", argv[0], +		(unsigned long)(sizeof(user) - 1)); +	return ERR_OVERFLOW;      }      strcpy(user, argv[i + 1]);      if ((arg = strchr(user, ':')) != NULL) { --- cut --- cut --- cut ---  Larry told us, that there is a nessus plugin which recognizes this buffer overflow and recommends an update to apache httpd 1.3.32. But I couldn't find a corresponding entry in the bug database. :-( Comparing the versions 1.3.31, 1.3.32 and 1.3.33, I found no differences between the files. ... ```  [Comment 1](show_bug.cgi?id=31975#c1)  Malte S. Stretz    2011-03-21 11:01:17 UTC  ``` Apache HTTP Server 1.3.x is not supported anymore and no bugs will be fixed in the old codebase (cf. <[http://mail-archives.apache.org/mod_mbox/httpd-announce/201002.mbox/%3C20100203000334.GA19021@infiltrator.stdlib.net%3E](http://mail-archives.apache.org/mod_mbox/httpd-announce/201002.mbox/%3C20100203000334.GA19021%40infiltrator.stdlib.net%3E)>). Since this bug seems to affect only 1.3.x, I'm closing it as WONTFIX.  If this bug still affects you in a recent version (version 2.2.x or the upcoming version 2.4), please open a new bug.  Thank you for reporting the bug. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=31975)
* - [XML](show_bug.cgi?ctype=xml&id=31975)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=31975)
* - Top of page

This is **ASF Bugzilla**: the Apache Software Foundation bug system. In case
of problems with the functioning of ASF Bugzilla, please contact
bugzilla-admin@apache.org.
**Please Note:** this e-mail address is **only** for reporting problems
with ASF Bugzilla. Mail about any other subject will be silently
ignored.

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/en/html/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=31975&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=31975&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from seclists.org_9644994d_20250125_131517.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](10)
[By Date](date.html#13)
[![Next](/images/right-icon-16x16.png)](14)

[![Previous](/images/left-icon-16x16.png)](10)
[By Thread](index.html#13)
[![Next](/images/right-icon-16x16.png)](14)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20231122 :: Multiple Vulnerabilities in m-privacy TightGate-Pro

---

*From*: "SEC Consult Vulnerability Lab, Research via Fulldisclosure" <fulldisclosure () seclists org>

*Date*: Wed, 22 Nov 2023 08:25:00 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20231122-0 >
=======================================================================
               title: Multiple Vulnerabilities
             product: m-privacy TightGate-Pro
  vulnerable version: Rolling Release, servers with the following package
                      versions are vulnerable:
                      tightgatevnc < 4.1.2~1
                      rsbac-policy-tgpro < 2.0.159
                      mprivacy-tools < 2.0.406g
       fixed version: Servers with the following package versions and higher:
                      mprivacy-tools_2.0.406g
                      tightgatevnc_4.1.2~1
                      rsbac-policy-tgpro_2.0.159
          CVE number: CVE-2023-47250, CVE-2023-47251
              impact: high
            homepage: <https://www.m-privacy.de/en/tightgate-pro-safe-surfing/>
               found: 2023-08-18
                  by: Daniel Hirschberger (Office Bochum)
                      Steven Kurka (Office Essen)
                      Marco Schillinger (Office Nürnberg)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Eviden business
                      Europe | Asia

                      <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"TightGate-Pro is a ReCoB system. ReCoBS stands for Remote-Controlled Browser
System, literally translated 'remote-controlled web browser'. TightGate-Pro
physically separates the web browser execution environment from the workstation.
The system thus shields the internal network from the Internet and reliably
and preventively prevents attacks via the web browser. TightGate-Pro is the
strongest dedicated ReCoBS, because only physical outsourcing on a hardened
system permanently withstands attacks. Local virtualisations, sandboxing
systems or micro-virtualisations do not offer effective protection.
TightGate-Pro is used in public authorities, financial institutions, industrial
companies and critical infrastructures – in short, everywhere where “safe
surfing on the Internet” is indispensable at the workplace and internal
infrastructures must be reliably protected. TightGate-Pro is BSI-certified
according to EAL3+."

Source: <https://www.m-privacy.de/en/tightgate-pro-safe-surfing/>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult highly recommends to perform a thorough security review of the product
conducted by security professionals to identify and resolve potential further
security issues.

Vulnerability overview/description:
-----------------------------------
1) Code Execution
Execution of single commands and scripts is possible with the privileges of
the current user. Code execution is possible with any file type on the
server and no specific permissions need to be set for the utilized file.

Vendor response (translated):
"It is intended behavior to execute arbitrary bash scripts. It is not possible
to execute arbitrary programs and libraries. There is no privilege escalation
possible with this vulnerability."

We can confirm that it was not possible to escalate privileges during our test.

2) Access to all Desktops (CVE-2023-47250)
Multiple users are connecting to the same TightGate-Pro server, resulting in
one instance of the X11 window system. Due to insecure permissions of the
X11 sockets it is possible for any user to open arbitrary windows on the
desktop of other users for phishing attacks or installing a keylogger
directly.

Vendor response (translated):
"We acknowledge this issue as a important vulnerability. A fix with full
RSBAC-Jail-Separation and changed Linux-Filesystem permissions is currently
available in the "Prestable" packages:
- mprivacy-tools_2.0.406g
- tightgatevnc_4.1.2~1
- rsbac-policy-tgpro_2.0.159
These can be applied by the admin user "update". The updates will be provided
automatically as Hotfix around 2023-10-24."

3) File Transfer by Abusing the Print function (CVE-2023-47251)
TightGate-Pro allows printing PDF documents on the host system. Documents are
transferred to the host, printed and deleted afterwards. An attacker is able
to control the path of the transferred file and to prevent the automatic
deletion of the file.

Vendor response (translated):
"This is not a severe finding but we already fixed it. The fixes are available
in the packages:
- mprivacy-tools_2.0.406g
- tightgatevnc_4.1.2~1

Now the .spool directly is always scanned for malicious data and the VNC- client
does not transfer files which contain path symbols (e.g. ../)."

4) Outdated Update Server
Based on disclosed version numbers the update server is running outdated software
with known vulnerabilities. The criticality of this issue depends on the
exploitability of these issues.

Vendor response (translated):
"The old version of thttpd is already known. This is not seen as security-relevant.
The access to the updateserver requires a previous registration of a customer-
provided SSH key, which is only available to administrators on the TightGate-Pro
instance. thttpd is isolated on the updateserver and can only *read* files.

Even if an attacker can write malicious updatepackages, these are still secured
by a cryptographic signature and would not be installed on TightGate-Pro instances.
We will eventually replace thttpd with lighthttpd which is still supported."

Proof of concept:
-----------------
1) Code Execution
Code execution is possible using the context menu of any file in the VNC session
of TightGate-Pro. Selecting "Öffnen mit" (Open with) in the context menu of any
file and  selecting the "Benutzerdefinierte Befehlszeile" (custom commandline)
section of the menu allows to provide a custom shell command to be executed:

[advisory_ce_open_with.png]
[advisory_ce_custom_command.png]

At this point there are two possible options:
In case the selected file is a bash script typing `/bin/bash` as custom command
will execute the script. For this PoC the following script has been used:

```
#!bin/bash
echo poc >> /home/user/testuser/Desktop/test/PoC2.txt
```

In case any other file is selected a complete command can be used as well.
A possible example is listed below:
`/bin/bash -c "echo poc >> /home/user/testuser/Desktop/test/PoC2.txt"`

According to vendor, arbitrary code execution is not possible as programs and
libraries won't be executed.

2) Access to all Desktops (CVE-2023-47250)
A normal user without special permissions has read and write access to all X11
sockets stored in the temp folder of the user TightGate-Pro, visible in the
following screenshot:

[advisory_desktop_access_x11_perms.png]

This allows any user for example to open dialogue boxes on the desktop of the
currently connected users as shown in the following screenshots. The command
used is listed below.

`/bin/bash -c 'for i in $(ls /home/tmpdir/tmp510/.X11-unix | cut -b 2-); do
DISPLAY=unix:"$i".0 zenity --password --username & done;'`

[advisory_desktop_access_gui_triggered.png]

As it can be seen in the following screenshot any input to the dialogue boxes
can be read by the attacker.

[advisory_desktop_access_result.png]

3) File Transfer by Abusing the Print function (CVE-2023-47251)
File transfers can be triggered for PDF files which are stored in the
`/home/user/.spool/<username>` directory. By setting a relative path as file
name, the file can be stored in any user directory on the host system.
In case the file name contains Unicode characters, deletion of the file is
not executed after transfer and closing of the print prompt. To store a file
on the user's desktop, the name `..\\..\\..\\..\\..\\Desktop\\Ỻeicar.pdf`
can be used. The transfer can then be triggered by sending the
signal `SIGUSR2` to the `Xtightgatevnc` process:

```
cp eicar.pdf '/home/user/.spool/<username>/..\\..\\..\\..\\..\\Desktop\\Ỻeicar.pdf'
pkill -u $USER --signal SIGUSR2 Xtightgatevnc
```

In addition, this file transfer does not check if any malicious files are
transferred to the host system. The following screenshot shows the warning of
a malware scanner after an eicar testfile was transferred. It is therefore
possible to circumvent the malware scanner of TightGate-Pro which only runs
if the intended way of transfer, namely the TightGate-Schleuse, is used.

[advisory_file_transfer_mal_file.png]

4) Outdated Update Server
Access to the update server is possible with the ssh key stored at
`/etc/cu/id_ed25519` and ssh port forwarding. The ssh key is customized
for each customer. Root access is needed to retrieve the key.
The command used for the forwarding is listed below:

```
ssh -N -L 8000:localhost:85 tgpro13 () update m-privacy de -i id_ed25519 -v
```

Afterwards access is possible at `http:127.0.0.1:8000`.
The server headers return the version of the webserver:
`thttpd/2.25b 29dec2003`

[advisory_outdated_server.png]

This version has in sum four known vulnerabilities (high and medium) listed:
* CVE-2006-1078
* CVE-2006-1079
* CVE-2007-0664
* CVE-2009-4491

Vulnerable / tested versions:
-----------------------------
A TightGate-Pro server with the following package versions was used
for testing:

* tightgatevnc < 4.1.2~1
* rsbac-policy-tgpro < 2.0.159
* mprivacy-tools < 2.0.406g

Vendor contact timeline:
------------------------
2023-10-11: Contacting vendor through info () m-privacy de via GPG
2023-10-13: CEO of m-privacy phones us and thanks us for the advisory,
             a developer will send us a written statement next week.
2023-10-16: Received a written statement of their lead developer;
             the vulnerabilities #2 (Access to all Desktops) and
             #3 (File Transfer by Abusing the Print function) are
             confirmed and a fix is available
             #1 is seen as a feature not a bug, #4 is claimed to be
             prevented by hardening measures on the server, also
             thttpd will be replaced by lighthttpd in the future.
2023-10-24: We ask for some clarifications regarding software
             versions and advisory publication date.
2023-10-29: Vendor provides software version information and asks us
             to publish the advisory after 2023-11-06.
2023-11-22: Public release of security advisory.

Solution:
---------
Install the "Prestable" packages or wait until they are available as hotfix:
* mprivacy-tools_2.0.406g
* tightgatevnc_4.1.2~1
* rsbac-policy-tgpro_2.0.159

Workaround:
-----------
None

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <https://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF Daniel Hirschberger, Steven Kurka, Marco Schillinger / @2023
```

[![](att-13/advisory_ce_custom_command.png)](att-13/advisory_ce_custom_command.png)

[![](att-13/advisory_ce_open_with.png)](att-13/advisory_ce_open_with.png)

[![](att-13/advisory_desktop_access_gui_triggered.png)](att-13/advisory_desktop_access_gui_triggered.png)

[![](att-13/advisory_desktop_access_result.png)](att-13/advisory_desktop_access_result.png)

[![](att-13/advisory_desktop_access_x11_perms.png)](att-13/advisory_desktop_access_x11_perms.png)

[![](att-13/advisory_file_transfer_mal_file.png)](att-13/advisory_file_transfer_mal_file.png)

[![](att-13/advisory_outdated_server_png.png)](att-13/advisory_outdated_server_png.png)

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](10)
[By Date](date.html#13)
[![Next](/images/right-icon-16x16.png)](14)

[![Previous](/images/left-icon-16x16.png)](10)
[By Thread](index.html#13)
[![Next](/images/right-icon-16x16.png)](14)

### Current thread:

* **SEC Consult SA-20231122 :: Multiple Vulnerabilities in m-privacy TightGate-Pro** *SEC Consult Vulnerability Lab, Research via Fulldisclosure (Nov 27)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from marc.info_b176e188_20250125_131512.html ===

```
[[prev in list](?l=thttpd&m=114149957305068&w=2)] [[next in list](?l=thttpd&m=114154083000296&w=2)] [prev in thread] [[next in thread](?l=thttpd&m=114154083000296&w=2)]
List:       [thttpd](?l=thttpd&r=1&w=2)
Subject:    [[THTTPD] htpasswd.c security issues.](?t=114153048400001&r=1&w=2)
From:       ["Larry Cashdollar" <lcashdol () gmail ! com>](?a=114153046300005&r=1&w=2)
Date:       [2006-03-05 0:05:50](?l=thttpd&r=1&w=2&b=200603)
Message-ID: [200603050005.k2505vgt069017 () gate ! acme ! com](?i=200603050005.k2505vgt069017%20()%20gate%20!%20acme%20!%20com)
[Download RAW [message](?l=thttpd&m=114153031201867&q=mbox) or [body](?l=thttpd&m=114153031201867&q=raw)]

Hi,
    I noticed that htpasswd.c shipped with thttpd-2.25b has a buffer
overflow when copying the user name from the argument list on line
189(strcpy), and another when reading a line from a file at line
197(strcpy).   You can also get htpasswd to execute commands locally when
changing passwords during the file template copy from temp on line 216
(system()).  I realize this is not installed setuid root, but this could be
used to break out of a sudo acl.

Just thought I'd let you guys know.  Btw, thttpd is awesome.

-- larry

[[Attachment #3 (text/html)]](?l=thttpd&m=114153031201867&q=p3)

<span class="gmail_quote"><br><br></span><div style="direction: ltr;">Hi,<br>
&nbsp;&nbsp;&nbsp; I noticed that htpasswd.c shipped with thttpd-2.25b
has a buffer overflow when copying the user name from the argument list
on line 189(strcpy), and another when reading a line from a file at
line 197(strcpy).&nbsp;&nbsp; You can also get htpasswd to execute
commands locally when changing passwords during the file template copy
from temp on line 216 (system()).&nbsp; I realize this is not installed
setuid root, but this could be used to break out of a sudo acl.<br>
<br>
Just thought I'd let you guys know.&nbsp; Btw, thttpd is awesome.<br></div><div \
style="direction: ltr;"><span class="sg"> <br>
-- larry<br>

</span></div>

[[prev in list](?l=thttpd&m=114149957305068&w=2)] [[next in list](?l=thttpd&m=114154083000296&w=2)] [prev in thread] [[next in thread](?l=thttpd&m=114154083000296&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


