```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2006-1015",
      "root_cause": "Improper handling of additional parameters in the `mail` and `mb_send_mail` functions in PHP when used with sendmail.",
      "weaknesses": [
        "Argument injection vulnerability",
         "Insufficient input sanitization",
          "Bypass of safe_mode and open_basedir restrictions"
      ],
      "impact": "Remote attackers can read and create arbitrary files on the server.",
      "attack_vectors": [
        "By injecting additional parameters into the `mail` or `mb_send_mail` functions' arguments.",
        "Specifically using the `-C` (alternate configuration file) and `-X` (log all to file) options for sendmail."
      ],
      "attacker_capabilities": "The attacker needs to be able to pass input to a PHP script that uses the vulnerable `mail` or `mb_send_mail` functions. No authentication is needed.",
       "additional_details": "The vulnerability exists in PHP 4, and PHP 5 when using sendmail 8.13.4 or lower. When safemode is disabled and open_basedir restrictions are in effect, extra parameters can be passed to the sendmail command in the mail function.  When safemode is enabled and open_basedir restrictions are in effect, extra parameters can be passed to sendmail command in the `mb_send_mail` function.  Attackers can exploit this by using the `-C` argument to specify an alternate configuration file, and the `-X` argument to log all mail activity to a specified file. By setting the `-C` argument to a file they want to view and the `-X` argument to a file they control, they can read files from the server by having sendmail log the contents."
    }
  ]
}
```