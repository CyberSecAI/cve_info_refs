=== Content from www.vupen.com_e69058b0_20250124_215504.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

Â© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from aluigi.altervista.org_d2e9b7f9_20250124_215433.html ===
#######################################################################
Luigi Auriemma
Application: Alien Arena 2006 Gold Edition
http://red.planetarena.org
Versions: <= 5.00
Platforms: Windows and Linux
Bugs: A] safe\_cprintf server format string
B] Cmd\_Say\_f server buffer-overflow
C] Com\_sprintf crash
Exploitation: A] remote, versus server (in-game)
B] remote, versus server (in-game)
C] remote, versus clients and server (in-game)
Date: 07 Mar 2006
Author: Luigi Auriemma
e-mail: aluigi@autistici.org
web: aluigi.org
#######################################################################
1) Introduction
2) Bugs
3) The Code
4) Fix
#######################################################################
===============
1) Introduction
===============
Alien Arena 2006 GE is the latest release of the CodeRED series, an
open source game developed on an enhanced version (CRX engine) of the
GPLed Quake II engine.
The game supports both LAN and Internet multiplayer.
#######################################################################
=======
2) Bugs
=======
All the bugs need to be exploited in-game so the attacker's IP must be
not banned and he must know the right keyword if the server is
protected by password.
I have found no ways to exploit them "externally".
------------------------------------
A] safe\_cprintf server format string
------------------------------------
The safe\_cprintf() function used by the server for sending messages to
the clients is affected by a format string vulnerability which could
allow the execution of malicious code.
After having built the output string the function passes it as format
argument (yes it's just like a double sprintf) to gi.cprintf() ->
"void PF\_cprintf (edict\_t \*ent, int level, char \*fmt, ...)".
From games/acesrc/acebot\_cmds.c:
void safe\_cprintf (edict\_t \*ent, int printlevel, char \*fmt, ...)
{
char bigbuffer[0x10000];
va\_list argptr;
int len;
if (ent && (!ent->inuse || ent->is\_bot))
return;
va\_start (argptr,fmt);
len = vsprintf (bigbuffer,fmt,argptr);
va\_end (argptr);
gi.cprintf(ent, printlevel, bigbuffer);
}
-----------------------------------
B] Cmd\_Say\_f server buffer-overflow
-----------------------------------
The function Cmd\_Say\_f is used by the server for handling the text
messages received from the clients.
Cmd\_Say\_f uses a buffer of 2048 bytes in which puts the nickname of the
player who has sent the message using the secure (enough secure)
Com\_sprintf() function followed by strcat() for appending the received
message.
These instructions allow an attacker to exploit the resulted
buffer-overflow for executing malicious code.
From source/game/g\_cmds.c:
void Cmd\_Say\_f (edict\_t \*ent, qboolean team, qboolean arg0)
{
int i, j;
edict\_t \*other;
char \*p;
char text[2048];
gclient\_t \*cl;
if (gi.argc () < 2 && !arg0)
return;
if ((!((int)(dmflags->value) & (DF\_MODELTEAMS | DF\_SKINTEAMS))) || (!ctf->value))
team = false;
if (team)
Com\_sprintf (text, sizeof(text), "(%s): ", ent->client->pers.netname);
else
Com\_sprintf (text, sizeof(text), "%s: ", ent->client->pers.netname);
if (arg0)
{
strcat (text, gi.argv(0));
strcat (text, " ");
strcat (text, gi.args());
}
else
{
p = gi.args();
if (\*p == '"')
{
p++;
p[strlen(p)-1] = 0;
}
strcat(text, p);
}
...
--------------------
C] Com\_sprintf crash
--------------------
The Com\_sprintf() function is a custom snprintf() replacement widely
used in the code.
The only problem of this function (usually bigbuffer is enough big so
doesn't represent a risk) is caused by the final strncpy() call which
is not followed by an instruction for delimiting dest with a NULL byte.
Often, depending by the system/compiler, this lack leads to a crash.
In my tests I were able to crash the precompiled Windows clients
without problems through a skin of about 110 chars (MAX\_OSPATH is 128).
In fact one of the best ways for exploiting this bug is just using a
player with a long skin, weapon or model name so any client which is
inside or will join the server while the attacker is playing will be
crashed immediately.
In this case we can watch the exploitation in the function
CL\_LoadClientinfo() located in client/cl\_parse.c.
From source/game/q\_shared.c:
void Com\_sprintf (char \*dest, int size, char \*fmt, ...)
{
int len;
va\_list argptr;
char bigbuffer[0x10000];
va\_start (argptr,fmt);
len = vsprintf (bigbuffer,fmt,argptr);
va\_end (argptr);
if (len >= size)
Com\_Printf ("Com\_sprintf: overflow of %i in %i\n", len, size);
strncpy (dest, bigbuffer, size-1);
}
#######################################################################
===========
3) The Code
===========
http://aluigi.org/poc/aa2k6x.zip
#######################################################################
======
4) Fix
======
No fix.
The developers will release a patch the next months.
#######################################################################

