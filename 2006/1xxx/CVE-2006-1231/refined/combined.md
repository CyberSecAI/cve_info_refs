=== Content from marc.info_76ea6a84_20250124_211819.html ===

```
[[prev in list](?l=full-disclosure&m=114184197431606&w=2)] [[next in list](?l=full-disclosure&m=114176932713138&w=2)] [prev in thread] [next in thread]
List:       [full-disclosure](?l=full-disclosure&r=1&w=2)
Subject:    [Full-disclosure] capi4hylafax insecure manipulation with tmp files
From:       [Javor Ninov <drfrancky () securax ! org>](?a=112171601000003&r=1&w=2)
Date:       [2006-03-07 21:27:19](?l=full-disclosure&r=1&w=2&b=200603)
Message-ID: [440DFAB7.4010007 () securax ! org](?i=440DFAB7.4010007%20()%20securax%20!%20org)
[Download RAW [message](?l=full-disclosure&m=114176689513438&q=mbox) or [body](?l=full-disclosure&m=114176689513438&q=raw)]

[[Attachment #2 (multipart/signed)]](?l=full-disclosure&m=114176689513438&q=p2)

capi4hylafax suite (<http://freshmeat.net/projects/capi4hylafax/> ) is
addon for hylafax fax server (<http://www.hylafax.org/>)

vulnerable:
capi4hylafax-01.03.00 /probably others/

in capi4hylafax-01.03.00/src/faxrecv/faxrecv.cpp :

#ifdef GENERATE_DEBUGSFFDATAFILE
    dwarning (DebugSffDataFile == 0);
      if (!DebugSffDataFile) {
       DebugSffDataFile = fopen ("/tmp/c2faxrecv_dbgdatafile.sff", "w");
      }
#endif

in

and in capi4hylafax-01.03.00/src/faxsend/faxsend.cpp :

#ifdef GENERATE_DEBUGSFFDATAFILE
     dassert (DebugSffDataFile == 0);
     DebugSffDataFile = fopen ("/tmp/c2faxsend_dbgdatafile.sff", "w");
#endif

vulnerable capi4hylafax-1.1a

in capi4hylafax-1.1a/src/standard/ExtFuncs.h :
    #define DEBUG_FILE_NAME             "/tmp/c2faxfcalls.log"

then in capi4hylafax-1.1a/src/standard/DbgFile.c:
unsigned DebugFileOpen (void) {
    DebugFileClose();
    hFile = fopen (DEBUG_FILE_NAME, "w");
    return (hFile != 0);
}
<snip>
void DebugFilePrint (char *string) {
    if (hFile) {
        fprintf (hFile, string);
        fflush (hFile);
    }
    printf (string);
}

impact:
a regular user of the system can create a symbolic link to file on which
hylafax has write access leading to overwriting of this file

!!! VENDOR IS NOT NOTIFIED !!!

Javor Ninov aka DrFrancky
drfrancky shift+2 securax.org

[["signature.asc" (application/pgp-signature)]](?l=full-disclosure&m=114176689513438&q=p5)

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>

[[prev in list](?l=full-disclosure&m=114184197431606&w=2)] [[next in list](?l=full-disclosure&m=114176932713138&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


