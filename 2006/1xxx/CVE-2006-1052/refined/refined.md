Based on the provided information, here's an analysis of CVE-2006-1052:

**Root Cause of Vulnerability:**

The vulnerability lies in the SELinux ptrace handling logic within the Linux kernel. Specifically, the `selinux_ptrace` function, which is called for both actual ptrace attach operations and by proc for permission checks on files like `/proc/pid/environ` and `/proc/pid/mem`, incorrectly reset the tracer SID (security identifier) even when a process was already being traced.

**Weaknesses/Vulnerabilities Present:**

- **Incorrect SID Reset:** The `selinux_ptrace` function was designed to save the SID of the tracing process for later use. However, it was incorrectly resetting the tracer SID to the SID of the process accessing certain `/proc` files, even if the process was not initiating a ptrace attach.
- **Side Effects in Permission Check:** The `selinux_ptrace` hook was being used for both permission checking and for setting the tracer SID, leading to unwanted side effects during normal proc file access.

**Impact of Exploitation:**

- **Privilege Escalation:**  A local attacker, with the ability to ptrace their own process, could potentially manipulate the tracer SID of a traced process by inducing a privileged process to read the traced process's `/proc/pid/environ` or `/proc/pid/mem` files. This allows the attacker to then exploit the incorrect SID to gain a different domain via execve.
- **Bypass SELinux Restrictions:** Although the base Linux Discretionary Access Control (DAC) restrictions remained intact, the vulnerability could enable an attacker to gain access to a domain that is normally restricted by SELinux policy.

**Attack Vectors:**

1.  **Initial ptrace Attach:** The attacker must first attach to their own process using `ptrace`.
2.  **Trigger SID Reset:**  The attacker must induce a privileged process (with ptrace permission to the target domain) to read the `/proc/pid/environ` or `/proc/pid/mem` files of the attacker's traced process. This action will incorrectly reset the tracer SID to the SID of the privileged process.
3.  **Execve with Incorrect SID:** The attacker needs to execute a program that is authorized to enter the desired (target) domain and they need transition permission to that domain. At exec time the tracer sid will be used and validated for ptrace access which they would not normally have.

**Required Attacker Capabilities/Position:**

- **Local User:** The attacker needs to be a local user on the system.
- **ptrace Permission:** The attacker must have ptrace permission, at least to their own domain/processes.
- **Control over Process:** The attacker needs to be able to control a process to trigger the vulnerability.
- **Privileged Process Manipulation:** The attacker needs to be able to wait for or induce a privileged process to read specific `/proc` files of a process under the attacker's control.
- **Execute permission:** Must be able to execute a program authorized to enter the target domain.
- **Transition Permission:** Must have the permissions to transition to the target domain.

**Additional Notes:**

- The vulnerability only affects the SELinux ptrace handling, not the underlying Linux DAC (Discretionary Access Control) permissions.
- Even if the attacker successfully escalates privileges within the SELinux context, they still require matching Linux DAC permissions, which may limit the impact if not appropriately configured.
- The fix involves only setting the tracer SID if the process is not already being traced. A cleaner solution, involving separate hooks for permission checks and attach operations, was planned for future kernels.
- Red Hat, Avaya and other vendors released patches for this vulnerability.

This analysis provides more details than the original CVE description.