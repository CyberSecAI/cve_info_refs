=== Content from www.debian.org_1fae9f87_20250124_173007.html ===


---

[[Date Prev](msg00342.html)][[Date Next](msg00344.html)]
[[Thread Prev](msg00342.html)][[Thread Next](msg00344.html)]
[[Date Index](maillist.html#00343)]
[[Thread Index](threads.html#00343)]

# [SECURITY] [DSA 1242-1] New elog packages fix arbitrary code execution

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1242-1] New elog packages fix arbitrary code execution
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 27 Dec 2006 23:33:30 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20061227223330.GA15059%40galadriel.inutil.org)Â [20061227223330.GA15059@galadriel.inutil.org](msg00343.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 1242-1                    security@debian.org
<http://www.debian.org/security/>                         Moritz Muehlenhoff
December 27th, 2006                     <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : elog
Vulnerability  : several
Problem-Type   : remote
Debian-specific: no
CVE ID         : CVE-2006-5063 CVE-2006-5790 CVE-2006-5791 CVE-2006-6318

Several remote vulnerabilities have been discovered in elog, a web-based
electronic logbook, which may lead to the execution of arbitrary code.
The Common Vulnerabilities and Exposures project identifies the following
problems:

CVE-2006-5063

    Tilman Koschnick discovered that log entry editing in HTML is vulnerable
    to cross-site scripting. This update disables the vulnerable code.

CVE-2006-5790

    Ulf Harnhammar of the Debian Security Audit Project discovered several
    format string vulnerabilities in elog, which may lead to execution of
    arbitrary code.

CVE-2006-5791

    Ulf Harnhammar of the Debian Security Audit Project discovered
    cross-site scripting vulnerabilities in the creation of new logbook
    entries.

CVE-2006-6318

    Jayesh KS and Arun Kethipelly of OS2A discovered that elog performs
    insufficient error handling in config file parsing, which may lead to
    denial of service through a NULL pointer dereference.

For the stable distribution (sarge) these problems have been fixed in
version 2.5.7+r1558-4+sarge3.

The upcoming stable distribution (etch) will no longer include elog.

For the unstable distribution (sid) these problems have been fixed in
version 2.6.2+r1754-1.

We recommend that you upgrade your elog package.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.1 alias sarge
- --------------------------------

  Source archives:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3.dsc](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3.dsc)
      Size/MD5 checksum:      581 c072e867caa0058ac44cbd69c6afff51
    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3.diff.gz](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3.diff.gz)
      Size/MD5 checksum:    23758 0718302e60a98844f27cd6eab336c5ce
    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558.orig.tar.gz](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558.orig.tar.gz)
      Size/MD5 checksum:   538216 e05c9fdaa02692ce20c70a5fd2748fe3

  Alpha architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_alpha.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_alpha.deb)
      Size/MD5 checksum:   556190 081bd3b98bea9516c26b487024d6140f

  AMD64 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_amd64.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_amd64.deb)
      Size/MD5 checksum:   512510 48ee1c675cefa6a0b0af01f7cbb9f079

  ARM architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_arm.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_arm.deb)
      Size/MD5 checksum:   517072 5e4a4dc726a8a0bf75f05de3fe17e07c

  HP Precision architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_hppa.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_hppa.deb)
      Size/MD5 checksum:   544448 5f5c83341837c6dd18211b4164bbd1dc

  Intel IA-32 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_i386.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_i386.deb)
      Size/MD5 checksum:   514786 c14108b91d171ac38b0104ae769cfc96

  Intel IA-64 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_ia64.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_ia64.deb)
      Size/MD5 checksum:   598224 df22b05edfb9dfab43cc69233f2d88e4

  Motorola 680x0 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_m68k.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_m68k.deb)
      Size/MD5 checksum:   482826 254d8a1f1cae62719a9f6f2a461cffd8

  Big endian MIPS architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_mips.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_mips.deb)
      Size/MD5 checksum:   522074 909b22df0ac8302bd7b00b8338511198

  Little endian MIPS architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_mipsel.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_mipsel.deb)
      Size/MD5 checksum:   525164 278bc7397817c8f6a8a44d2879f0682c

  PowerPC architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_powerpc.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_powerpc.deb)
      Size/MD5 checksum:   524304 37438b8fff9c0b162aa6870fd5c7ba31

  IBM S/390 architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_s390.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_s390.deb)
      Size/MD5 checksum:   515148 32cf397b104321646de736141a90354d

  Sun Sparc architecture:

    [http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7+r1558-4+sarge3_sparc.deb](http://security.debian.org/pool/updates/main/e/elog/elog_2.5.7%2Br1558-4%2Bsarge3_sparc.deb)
      Size/MD5 checksum:   519788 b532c963d03d66f4e32861531adefe4e

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQFFkvSHXm3vHE4uyloRAk+DAJ49IGlpV6HUrg2/EWlIRrFONVx80gCgu22h
5xHJ1Ia+bLJKBAUBWvd019Y=
=8iOu
-----END PGP SIGNATURE-----

```

---



=== Content from www.vupen.com_c552e7dd_20250124_173007.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

Â© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from bugs.debian.org_976314b8_20250124_173006.html ===

# Debian Bug report logs - #392016 elog: Needs a security audit

[![version graph](version.cgi?absolute=0;fixed=2.6.3%2Br1764-1.1%2Brm;height=2;collapse=1;width=2;package=elog)](version.cgi?package=elog;absolute=0;fixed=2.6.3%2Br1764-1.1%2Brm;info=1;collapse=1)

Package:
[elog](pkgreport.cgi?package=elog);
Maintainer for [elog](pkgreport.cgi?package=elog) is [(unknown)](pkgreport.cgi?maint=);

Reported by: [Moritz Muehlenhoff <jmm@debian.org>](pkgreport.cgi?submitter=jmm%40debian.org)

Date: Mon, 9 Oct 2006 20:33:03 UTC

Severity: *grave*

Tags: patch, security

Fixed in version 2.6.3+r1764-1.1+rm

**Done:** Raphael Geissert <atomo64@gmail.com>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=392016;mbox=yes), [status mbox](bugreport.cgi?bug=392016;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=392016;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Debian Security Team <team@security.debian.org>, Recai OktaÅŸ <roktas@debian.org>`:

`Bug#392016`; Package `elog`.
([full text](bugreport.cgi?bug=392016;msg=2), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Moritz Muehlenhoff <jmm@debian.org>`:

New Bug report received and forwarded. Copy sent to `Debian Security Team <team@security.debian.org>, Recai OktaÅŸ <roktas@debian.org>`.
([full text](bugreport.cgi?bug=392016;msg=4), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=392016;msg=5), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40debian.org)
From: Moritz Muehlenhoff <jmm@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Cc: debian-audit@shellcode.org
Subject: elog: Needs a security audit
Date: Mon, 09 Oct 2006 19:48:02 +0200
```
Package: elog
Severity: grave
Tags: security
Justification: user security hole

In #389361 a complete lack of web script sanitising for logbook entries
was discovered and DSA-967 already fixed lots of vulnerabilities.

AFAICT Debian is the only distribution including elog, which seems
to have received relatively few external review. I guess it should
only be included in Etch after an audit by the debian-audit people.

Audit people, do you think you can review it before Etch?

Cheers,
        Moritz

-- System Information:
Debian Release: testing/unstable
  APT prefers unstable
  APT policy: (500, 'unstable')
Architecture: i386 (i686)
Shell:  /bin/sh linked to /bin/bash
Kernel: Linux 2.6.18-1-686
Locale: LANG=C, LC_CTYPE=de_DE.ISO-8859-15@euro (charmap=ISO-8859-15)

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai OktaÅŸ <roktas@debian.org>`:

`Bug#392016`; Package `elog`.
([full text](bugreport.cgi?bug=392016;msg=7), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `"Ulf Harnhammar" <metaur@operamail.com>`:

Extra info received and forwarded to list. Copy sent to `Recai OktaÅŸ <roktas@debian.org>`.
([full text](bugreport.cgi?bug=392016;msg=9), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 392016@bugs.debian.org ([full text](bugreport.cgi?bug=392016;msg=10), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=metaur%40operamail.com)
From: "Ulf Harnhammar" <metaur@operamail.com>
To: 392016@bugs.debian.org
Subject: Perhaps
Date: Wed, 18 Oct 2006 16:31:34 +0100
```
I'll see what I can do.

// Ulf

--
_______________________________________________
Surf the Web in a faster, safer and easier way:
Download Opera 9 at <http://www.opera.com>

Powered by Outblaze

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai OktaÅŸ <roktas@debian.org>`:

`Bug#392016`; Package `elog`.
([full text](bugreport.cgi?bug=392016;msg=12), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent** to `"Ulf Harnhammar" <metaur@operamail.com>`:

Extra info received and forwarded to list. Copy sent to `Recai OktaÅŸ <roktas@debian.org>`.
([full text](bugreport.cgi?bug=392016;msg=14), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 392016@bugs.debian.org ([full text](bugreport.cgi?bug=392016;msg=15), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=metaur%40operamail.com)
From: "Ulf Harnhammar" <metaur@operamail.com>
To: 392016@bugs.debian.org
Cc: Stefan.Ritt@psi.ch
Subject: ELOG security audit
Date: Tue, 31 Oct 2006 23:21:10 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=392016;msg=15) (text/plain, inline)]
```
```
Hello,

I have performed a security audit of ELOG and here is what I found:

1) There are some incorrect handling of *printf() calls and format
strings. They lead to ELOG crashing completely, with the potential
of executing arbitrary machine code programs, when a user uploads
and submits as the first attachment in an entry a file called
"%n%n%n%n" - or similar - which must not be empty.

The attached patch fixes this in two places and many other format
string problems just to be sure.

2) There is a Cross-site Scripting issue when requesting correctly
named but non-existant files for downloading, like with this URL:

[http://localhost:8080/demo/123456_789012/%3Cscript%3Ealert(%22XSS%22)%3C/script%3E](http://localhost:8080/demo/123456_789012/%3Cscript%3Ealert%28%22XSS%22%29%3C/script%3E)

The attached patch corrects this by quoting the dangerous characters.

3) There are also Cross-site Scripting issues when creating new
entries with New. If a document sends data to ELOG where the
fields Type and Category contain invalid entries with HTML code,
the resulting error document will print the Type or Category data
as-is with no quoting.

The attached patch corrects this minor problem as well.

I have verified that all three problems exist in Debian unstable,
as well as in the upstream ELOG-2.6.2 version. I haven't checked
any other versions (but the upstream SVN trunk looks like it also
has these bugs).

// Ulf Harnhammar, Debian Security Audit Project
   <http://www.debian.org/security/audit/>

--
_______________________________________________
Surf the Web in a faster, safer and easier way:
Download Opera 9 at <http://www.opera.com>

Powered by Outblaze

```
```
[[elog.security.patch](bugreport.cgi?att=1;bug=392016;filename=elog.security.patch;msg=15) (application/octet-stream, attachment)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai OktaÅŸ <roktas@debian.org>`:

`Bug#392016`; Package `elog`.
([full text](bugreport.cgi?bug=392016;msg=17), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent** to `metaur@telia.com`:

Extra info received and forwarded to list. Copy sent to `Recai OktaÅŸ <roktas@debian.org>`.
([full text](bugreport.cgi?bug=392016;msg=19), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 392016@bugs.debian.org ([full text](bugreport.cgi?bug=392016;msg=20), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=metaur%40telia.com)
From: Ulf Harnhammar <metaur@telia.com>
To: 392016@bugs.debian.org
Cc: team@security.debian.org
Subject: elog in stable is also vulnerable
Date: Wed, 8 Nov 2006 23:14:16 +0100
```
I've just verified that elog in stable is vulnerable to
all issues mentioned in bug #392016.

// Ulf

```

---

**Tags added: patch**
Request was from `Ulf Harnhammar <metaur@telia.com>`
to `control@bugs.debian.org`.
([full text](bugreport.cgi?bug=392016;msg=22), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=22), [link](#21)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#392016`; Package `elog`.
([full text](bugreport.cgi?bug=392016;msg=24), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent** to `Recai OktaÅŸ <roktas@debian.org>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=392016;msg=26), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 392016@bugs.debian.org ([full text](bugreport.cgi?bug=392016;msg=27), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=roktas%40debian.org)
From: Recai OktaÅŸ <roktas@debian.org>
To: metaur@telia.com, 392016@bugs.debian.org
Cc: team@security.debian.org
Subject: Re: Bug#392016: elog in stable is also vulnerable
Date: Thu, 9 Nov 2006 12:13:02 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=392016;msg=27) (text/plain, inline)]
```
```
* Ulf Harnhammar [2006-11-08 23:14:16+0100]
> I've just verified that elog in stable is vulnerable to
> all issues mentioned in bug #392016.

Thank you very much for looking into this!  I've got another report
attached below.  I'll look into this problem also and will keep this bug
report open as I think elog should not enter to Etch due to all potential
security issues which increase the work-load on our security team during
the stable release cycle.

---------------------------------->8---------------------------------------
FYI

Hi,
We are working with Mr. Stefan Ritt on this issue and waiting for the fix.

Thanks,
OS2A

Forwarded Conversation
Subject: ELOG Web Logbook Remote Denial of Service Vulnerability
------------------------

 From: OS2A BTO <os2a.bto@gmail.com>
To: stefan.ritt@psi.ch
Date: Wed, Nov 8, 2006 at 6:12 PM
Attachments: os2a_1008.txt

Hi,
We recently came across a Denial of Service vulnerability in ELOG's
elogd server which allows attackers to crash the service, thereby preventing
legitimate access.

Attached is our security advisory which describes the vulnerability in detail.

Please let us know the time you might require to fix this issue.
And also let us know if you have any questions.

A quick and positive response from your side would be highly appreciated.

Thanks,
OS2A Team.

--------
 From: Stefan Ritt <stefan.ritt@psi.ch>
To: OS2A BTO <os2a.bto@gmail.com>
Date: Wed, Nov 8, 2006 at 6:31 PM

Dear OS2A team,

thank you for reporting this vulnerability and for the detailed
analysis, I really appreciate. I fixed this problem and just released
version 2.6.2-7 (SVN revision 1746).

Best regards,

   Stefan Ritt

--
Dr. Stefan Ritt           Phone: +41 56 310 3728
Paul Scherrer Institute   FAX: +41 56 310 2199
OLGA/021                  mailto:stefan.ritt@psi.ch
CH-5232 Villigen PSI      <http://midas.psi.ch/~stefan>
[Quoted text hidden]>
------------------------------------------------------------------------
>
> ELOG Web Logbook Remote Denial of Service Vulnerability
>
>
> OS2A ID: OS2A_1008                    Status:
>                                       10/31/2006      Issue Discovered
>                                       11/08/2006      Reported to the Vendor
>                                       --              Fixed by Vendor
>                                       --              Advisory Released
>
>
> Class: Denial of Service              Severity: Medium
>
>
> Overview:
> ---------
> The Electronic Logbook (ELOG) is part of a family of applications known as
> weblogs. ELOG is a remarkable implementation of a weblog in its simplicity of
> use and versatility.
> <http://midas.psi.ch/elog/index.html>
>
> Description:
> ------------
> Remote exploitation of a denial of service vulnerability in ELOG's
> elogd server allows attackers to crash the service, thereby preventing
> legitimate access.
>
> The [global]  section in configuration file elogd.cfg is used for settings
> common to all logbooks. The vulnerability is due to improper handling of an
> HTTP GET request if logbook name 'global' (or any logbook name prefixed
> with global) is used in the request. When such a request is received,
> a NULL pointer dereference occurs, leading to a crash of the service.
>
> Only authenticated users can exploit this vulnerability if the application
> is configured with password.
>
> Impact:
> -------
> Successful exploitation allows a remote attacker to crash the elogd server.
>
> Affected Software(s):
> ---------------------
> ELOG 2.6.2 and prior.
>
> Proof of Concept:
> -----------------
> The HTTP GET request given below is sufficient to crash affected server:
> <http://www.example.com/global/>
>
> Analysis:
> -----------
> #gdb ./elogd
> ...
> ...
>
> (gdb) break show_elog_list
> Breakpoint 2 at 0x809d6e0
>
> (gdb) c
> Continuing.
> (no debugging symbols found)
> elogd 2.6.2 built Nov  8 2006, 01:25:48 revision 1699
> Falling back to default group "elog"
> Falling back to default user "elog"
> Indexing logbooks ... done
> Server listening on port 8080 ...
>
> Breakpoint 2, 0x0809d6e0 in show_elog_list ()
> (gdb) c
> Continuing.
>
> Program received signal SIGSEGV, Segmentation fault.
> 0x0809eb7a in show_elog_list ()
>
> (gdb) bt
> #0  0x0809eb7a in show_elog_list ()
> #1  0x00000000 in ?? ()
>
> (gdb) i r
> eax            0x0      0
> ecx            0x9d43d88        164904328
> edx            0x0      0
> ebx            0x0      0
> esp            0xbfa8aca0       0xbfa8aca0
> ebp            0x80df40c        0x80df40c
> esi            0xbfb27050       -1078824880
> edi            0x0      0
> eip            0x809eb7a        0x809eb7a
> eflags         0x200246 2097734
> cs             0x73     115
> ss             0x7b     123
> ds             0x7b     123
> es             0x7b     123
> fs             0x0      0
> gs             0x33     51
>
> (gdb) x/i $eip
> 0x809eb7a <show_elog_list+5274>:        mov    (%eax),%eax
>
> The vulnerable code is at Line:16774 of elogd.c,
> n_msg = *lbs->n_el_index;
> where the pointer lbs is dereferenced before being null checked.
>
> --- elogd.c, Line:16772 -----
>
> } else {
>       n_logbook = 1;
>       n_msg = *lbs->n_el_index;
>    }
>
>    msg_list = xmalloc(sizeof(MSG_LIST) * n_msg);
>
> ---elogd.c, Line:16778 -----
>
>
> CVSS Score Report:
> -----------------
>     ACCESS_VECTOR          = REMOTE
>     ACCESS_COMPLEXITY      = LOW
>     AUTHENTICATION         = NOT_REQUIRED
>     CONFIDENTIALITY_IMPACT = NONE
>     INTEGRITY_IMPACT       = NONE
>     AVAILABILITY_IMPACT    = COMPLETE
>     IMPACT_BIAS            = AVAILABILITY
>     EXPLOITABILITY         = FUNCTIONAL
>     REMEDIATION_LEVEL      = WORKAROUND
>     REPORT_CONFIDENCE      = CONFIRMED
>     CVSS Base Score        = 5.0 (AV:R/AC:L/Au:NR/C:N/I:N/A:C/B:A)
>     CVSS Temporal Score    = 4.5
>     Risk factor            = Medium
>
>
> Vendor Response:
> ---------------
>
>
>
> Solution:
> ---------
> Before using the pointer, ensure that it is not equal to NULL.
> eg:
>
> if(!lbs->n_el_index) {
>     /* handle the null pointer dereference condition here */
> }
>
> Credits:
> -------
> Jayesh KS and Arun Kethipelly of OS2A have been credited with the discovery and
> analysis of this vulnerability.
>

--------
 From: OS2A BTO <os2a.bto@gmail.com>
To: Stefan Ritt <stefan.ritt@psi.ch>
Date: Wed, Nov 8, 2006 at 7:27 PM

Dear Stefan Ritt,
Thanks for the quick response.
We tested the fix you provided and still seems to be having the problem.
We created another logbook named 'global', after the logbook 'demo',
in the configuration file elogd.cfg and tried accessing the server
with <http://elogsite:8080/global/>.

Its giving segmentation fault.

This is the configuration file we used:

------elogd.cfg------------
[global]
port = 8080

[demo]
Theme = default
Comment = General linux tips & tricks
Attributes = Author, Type, Category, Subject
Options Type = Routine, Software Installation, Problem Fixed,
Configuration, Other
Options Category = General, Hardware, Software, Network, Other
Extendable Options = Category
Required Attributes = Author, Type
Page Title = ELOG - $subject
Reverse sort = 1
Quick filter = Date, Type

[global]
Theme = default
Comment = General linux tips & tricks
Attributes = Author, Type, Category, Subject
Options Type = Routine, Software Installation, Problem Fixed,
Configuration, Other
Options Category = General, Hardware, Software, Network, Other
Extendable Options = Category
Required Attributes = Author, Type
Page Title = ELOG - $subject
Reverse sort = 1
Quick filter = Date, Type
-------------elogd.cfg---------------------

Thanks,
OS2A
[Quoted text hidden]
--------
 From: Stefan Ritt <stefan.ritt@psi.ch>
To: OS2A BTO <os2a.bto@gmail.com>
Date: Wed, Nov 8, 2006 at 7:39 PM

Can you try again? I just updated 2.6.2-7, it's now SVN revision 1747.
Having a [global] section plus a [global] logbook is a severe
misconfiguration, so I did not try that combination before. But now it
should be fixed.

- Stefan
[Quoted text hidden]
--------
 From: OS2A BTO <os2a.bto@gmail.com>
To: Stefan Ritt <stefan.ritt@psi.ch>
Date: Wed, Nov 8, 2006 at 7:54 PM

Hi,

If we create any other directory prefixed with global in configuration
file, and try the same in URL, it again crashes.
I created a logbook names 'global__'  in elogd.cfg and tried to access
<http://192.168.3.5:8080/global__/>
it crashed again.

---------------------------------->8---------------------------------------

--
roktas

```
```
[[signature.asc](bugreport.cgi?att=1;bug=392016;filename=signature.asc;msg=27) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai OktaÅŸ <roktas@debian.org>`:

`Bug#392016`; Package `elog`.
([full text](bugreport.cgi?bug=392016;msg=29), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=29), [link](#28)).

---

**Acknowledgement sent** to `"OS2A BTO" <os2a.bto@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Recai OktaÅŸ <roktas@debian.org>`.
([full text](bugreport.cgi?bug=392016;msg=31), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 392016@bugs.debian.org ([full text](bugreport.cgi?bug=392016;msg=32), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=os2a.bto%40gmail.com)
From: "OS2A BTO" <os2a.bto@gmail.com>
To: 392016@bugs.debian.org
Subject: ELOG Web Logbook Remote Denial of Service Vulnerability
Date: Sat, 11 Nov 2006 21:42:18 +0530
```
[[Message part 1](bugreport.cgi?att=0;bug=392016;msg=32) (text/plain, inline)]
```
```
Details of the vulnerability is described in the advisory
(os2a_1008.txt) attached with this mail.

Thanks,
OS2A

```
```
[[os2a_1008.txt](bugreport.cgi?att=1;bug=392016;filename=os2a_1008.txt;msg=32) (text/plain, attachment)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai OktaÅŸ <roktas@debian.org>`:

`Bug#392016`; Package `elog`.
([full text](bugreport.cgi?bug=392016;msg=34), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=34), [link](#33)).

---

**Acknowledgement sent** to `metaur@telia.com`:

Extra info received and forwarded to list. Copy sent to `Recai OktaÅŸ <roktas@debian.org>`.
([full text](bugreport.cgi?bug=392016;msg=36), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=36), [link](#35)).

---

[Message #37](#37) received at 392016@bugs.debian.org ([full text](bugreport.cgi?bug=392016;msg=37), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=37), reply):

![](/cgi-bin/libravatar.cgi?email=metaur%40telia.com)
From: Ulf Harnhammar <metaur@telia.com>
To: 392016@bugs.debian.org
Cc: Stefan.Ritt@psi.ch
Subject: Further security patching of ELOG
Date: Sat, 2 Dec 2006 20:54:28 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=392016;msg=37) (text/plain, inline)]
```
```
Hello,

while browsing the ELOG entries at Secunia, I saw that my
security bugs in ELOG were only marked as partially fixed.
After some investigation, I found out that one more patch
was needed to close the XSS bug when handling Categories
(more specifically, when Adding a new Category called
something like "><script>alert(1096)</script>, that piece
of JavaScript will be executed when other users click on
New, which is bad). I have attached a patch for this too.

I also noticed that two other vulnerabilities in ELOG
were marked as Unpatched. Are these two fixed, Stefan?

  o  <http://secunia.com/advisories/18124/>
  o  <http://secunia.com/advisories/22057/>

Regards, Ulf Harnhammar

```
```
[[elog.security2.patch](bugreport.cgi?att=1;bug=392016;filename=elog.security2.patch;msg=37) (text/plain, attachment)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Recai OktaÅŸ <roktas@debian.org>`:

`Bug#392016`; Package `elog`.
([full text](bugreport.cgi?bug=392016;msg=39), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=39), [link](#38)).

---

**Acknowledgement sent** to `Stefan Ritt <stefan.ritt@psi.ch>`:

Extra info received and forwarded to list. Copy sent to `Recai OktaÅŸ <roktas@debian.org>`.
([full text](bugreport.cgi?bug=392016;msg=41), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=41), [link](#40)).

---

[Message #42](#42) received at 392016@bugs.debian.org ([full text](bugreport.cgi?bug=392016;msg=42), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=42), reply):

![](/cgi-bin/libravatar.cgi?email=stefan.ritt%40psi.ch)
From: Stefan Ritt <stefan.ritt@psi.ch>
To: 392016@bugs.debian.org
Subject: Re: Further security patching of ELOG
Date: Fri, 16 Feb 2007 23:05:57 +0100
```
Hi,

the vulnerabilities on secunia.com have been fixed long time ago (see
their recommendation to upgrade).

The patch you supplied is actually not enough to prohibit users from
entering script code. I fixed following additional cases:

- Enter a user name, full name or email address conaining JavaScript
- Doing a search by entering JavaScript in an attribute search field
- Entering JavaScript in a quick filter text box.

The fixes are contained in SVN revision 1792.

Regards,

  Stefan Ritt

```

---

**Reply sent** to `Raphael Geissert <atomo64@gmail.com>`:

You have taken responsibility.
([full text](bugreport.cgi?bug=392016;msg=44), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=44), [link](#43)).

---

**Notification sent** to `Moritz Muehlenhoff <jmm@debian.org>`:

Bug acknowledged by developer.
([full text](bugreport.cgi?bug=392016;msg=46), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=46), [link](#45)).

---

[Message #47](#47) received at 392016-done@bugs.debian.org ([full text](bugreport.cgi?bug=392016;msg=47), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=47), reply):

![](/cgi-bin/libravatar.cgi?email=atomo64%40gmail.com)
From: Raphael Geissert <atomo64@gmail.com>
To: 392016-done@bugs.debian.org
Subject: elog has been removed from Debian, closing #392016
Date: Thu, 15 May 2008 14:14:42 -0500
```
Version: 2.6.3+r1764-1.1+rm

The elog package has been removed from Debian testing, unstable and
experimental, so I am now closing the remaining open bugs.

For more information about this package's removal, read
<http://bugs.debian.org/472279> . That bug might give the reasons why
this package was removed, and suggestions of possible replacements.

Don't hesitate to reply to this mail if you have any question.

Thank you for your contribution to Debian.

Kind regards,
--
Raphael Geissert

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 10 Aug 2008 10:16:45 GMT) ([full text](bugreport.cgi?bug=392016;msg=49), [mbox](bugreport.cgi?bug=392016;mbox=yes;msg=49), [link](#48)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=392016).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 17:30:06 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


