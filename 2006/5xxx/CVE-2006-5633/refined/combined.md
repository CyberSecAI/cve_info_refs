=== Content from bugzilla.mozilla.org_eea1f44c_20250124_202429.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/358797)
* [XML](/show_bug.cgi?ctype=xml&id=358797)

Closed
[Bug 358797](/show_bug.cgi?id=358797)

Opened 18 years ago
Closed 18 years ago

# range.createContextualFragment() crash when range node is DocType

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

range.createContextualFragment() crash when range node is DocType

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

1.8 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: dveditz, Assigned: dveditz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40)  [dveditz](/user_profile?user_id=1689)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/8393b8cb5ce8371dcfe93f5d4f76e90a?d=mm&size=40)  [ian](/user_profile?user_id=4054)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40)  [dveditz](/user_profile?user_id=1689)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

20 people

## References

### ( [URL](http://lists.grok.org.uk/pipermail/full-disclosure/2006-October/050416.html "http://lists.grok.org.uk/pipermail/full-disclosure/2006-October/050416.html") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[lists.grok.org.uk/pipermail/full-disc...](http://lists.grok.org.uk/pipermail/full-disclosure/2006-October/050416.html "http://lists.grok.org.uk/pipermail/full-disclosure/2006-October/050416.html")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[launchpad.net/bugs/69719](https://launchpad.net/bugs/69719 "https://launchpad.net/bugs/69719")

## Details

### (Keywords: crash, verified1.8.0.9, verified1.8.1.1)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[verified1.8.0.9](/buglist.cgi?keywords=verified1.8.0.9&resolution=---),
[verified1.8.1.1](/buglist.cgi?keywords=verified1.8.1.1&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [blocking1.8.1.1](#c0 "18 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.8.1.1 | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [blocking1.8.0.9](#a2520237_1689 "18 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | blocking1.8.0.9 | + |
| --- | --- | --- |
| [sayrer](/user_profile?user_id=180188) | [in-testsuite](#c0 "18 years ago") | + |
| --- | --- | --- |
| [sayrer](/user_profile?user_id=180188) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [modified original testcase (won't crash on open)](/attachment.cgi?id=244356)  [18 years ago](#c5)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   522 bytes, text/html |  | [Details](/attachment.cgi?id=244356&action=edit) |
| --- | --- | --- |
| [1.8 branch patch](/attachment.cgi?id=244371)  [18 years ago](#c8)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   1.56 KB, patch | sicking : [review+](#c0 "18 years ago")  sicking : [superreview+](#c10 "18 years ago")  dveditz : [approval1.8.1.1+](#c0 "18 years ago") | [Details](/attachment.cgi?id=244371&action=edit) | [Diff](/attachment.cgi?id=244371&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=358797&attachment=244371) |
| [mochittest compatible testcase](/attachment.cgi?id=245475)  [18 years ago](#c12)  [Adam Guthrie](/user_profile?user_id=195226)   978 bytes, text/plain | dveditz : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=245475&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=358797#c0)• 18 years ago |
|  | |

Carlos Barros reported a DoS crash calling Mozilla-specific createContextualFragment on a range whose selected node is the DocType. This leads to a null-dereference crash in FF1.5.0.x and FF2
<http://www.gotfault.net/research/advisory/gadv-firefox.txt>
<http://lists.grok.org.uk/pipermail/full-disclosure/2006-October/050416.html>
According to the DOM spec trying to select the DocType should raise an exception
<http://www.w3.org/TR/2000/REC-DOM-Level-2-Traversal-Range-20001113/ranges.html#Level2-Range-method-selectNode>

|  | [Adam Guthrie](/user_profile?user_id=195226) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=358797#a244_195226)• 18 years ago |

Flags: in-testsuite?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=358797#c1)• 18 years ago |
|  | |

This appears to have been fixed on trunk on Oct 20. [bug 357445](/show_bug.cgi?id=357445 "RESOLVED FIXED - Clean up ranges") is the only possibly relevant patch, and it's a biggie.
I initially suspected [bug 336381](/show_bug.cgi?id=336381 "VERIFIED FIXED - Crash [@ nsRange::InsertNode] involving ranges in detached nodes") of fixing this since it added nsRange::IsValidBoundary that throws the right exception, but that was checked in May 2006 so clearly not. Looks like that's only called from SetStart/SetEnd but not selectNode.
selectNode does check for some bad node types, but doctype isn't one of those.
The existing validity checks only check the specified node itself, doesn't look like there are any "or ancestor" checks as mentioned in the DOM spec.
Would be simple to add nsIDOMNode::DOCUMENT\_TYPE\_NODE: at <http://bonsai.mozilla.org/cvsblame.cgi?file=mozilla/content/base/src/nsRange.cpp&rev=1.211&mark=707#694>
Would that be sufficient? Probably leaves all sorts of variants given the inconsistent checks (and some missing on the 1.8 branch)

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=358797#c2)• 18 years ago |
|  | |

Like you said, [bug 357445](/show_bug.cgi?id=357445 "RESOLVED FIXED - Clean up ranges") was a pretty hard whack to the range code, so I'm not sure what fixed it. The stack in the report seems very odd and not related to the described crash.

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=358797#c3)• 18 years ago |
|  | |

Adding DOCUMENT\_TYPE\_NODE there would be wrong. You are allowed to select \*around\* a doctype, you're just not allowed to put a range endpoint \*inside\* the doctype.
Checking for a doctype up the parent chain is not needed since there is no way to give doctypes any children.

|  | [Hermann Schwab](/user_profile?user_id=61658) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=358797#c4)• 18 years ago |
|  | |

Talkback records on testcase <http://werterxyz.altervista.org/Firefox2Range.htm> from <http://www.derkeiler.com/Mailing-Lists/securityfocus/bugtraq/2006-10/msg00509.html>
TB25358411M Firefox 1.5.0.8
TB25349295K Firefox 2.0

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=358797#c5)• 18 years ago |
|  | |

Attached file
[modified original testcase (won't crash on open)](attachment.cgi?id=244356)
— [Details](attachment.cgi?id=244356&action=edit)

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=358797#c6)• 18 years ago |
|  | |

I suspect we should fix this two ways on branch. One problem is that selectNode(docType) will create a range in an invalid state since we'll actually put the endpoints \*inside\* the doctype (due to the ugly hack where selectNode on a node whos parent is a document acts as selectNodeContents).
But we should also be able to deal with the parser being null rather than crashing.

|  | [Alex](/user_profile?user_id=262274) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=358797#c7)• 18 years ago |
|  | |

I don't know if this is of any relevance, but if I wrap this POC in a try/catch exception handler, Firefox doesn't crash here.
Why?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=358797#c8)• 18 years ago |
|  | |

Attached patch

[1.8 branch patch](attachment.cgi?id=244371&action=diff)
— [Details](attachment.cgi?id=244371&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=358797&attachment=244371)

This stops the crash, but what bad things could happen if we propagate the bad state?
The null-check on the sink is extra, but looked like it could lead to the same kinds of problems. I'll happily put it back if you think I should.
[Attachment #244371](/attachment.cgi?id=244371&action=edit "1.8 branch patch") -
Flags: review?(bugmail)

|  | [Ian Macfarlane](/user_profile?user_id=43863) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=358797#a227500_43863)• 18 years ago |

Flags: blocking1.8.1.1?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=358797#c9)• 18 years ago |
|  | |

Where do you put the try/catch? doesn't seem to help me any on FF2.

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=358797#c10)• 18 years ago |
|  | |

Comment on [attachment 244371](/attachment.cgi?id=244371 "1.8 branch patch") [[details]](/attachment.cgi?id=244371&action=edit "1.8 branch patch") [[diff]](/attachment.cgi?id=244371&action=diff "1.8 branch patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=358797&attachment=244371)
1.8 branch patch
>Index: parser/htmlparser/src/nsParser.cpp
>===================================================================
>RCS file: /cvsroot/mozilla/parser/htmlparser/src/nsParser.cpp,v
>retrieving revision 3.370.4.4
>diff -u -p -6 -r3.370.4.4 nsParser.cpp
>--- parser/htmlparser/src/nsParser.cpp 13 Jul 2006 17:28:08 -0000 3.370.4.4
>+++ parser/htmlparser/src/nsParser.cpp 1 Nov 2006 23:28:14 -0000
>@@ -1870,19 +1870,27 @@ nsParser::ParseFragment(const nsAString&
> if (NS\_FAILED(result)) {
> mFlags |= NS\_PARSER\_FLAG\_OBSERVERS\_ENABLED;
> return result;
> }
>
> nsCOMPtr<nsIFragmentContentSink> fragSink = do\_QueryInterface(mSink);
>- NS\_ASSERTION(fragSink, "ParseFragment requires a fragment content sink");
>+ if (!fragSink) {
>+ NS\_ERROR("ParseFragment requires a fragment content sink");
>+ mFlags |= NS\_PARSER\_FLAG\_OBSERVERS\_ENABLED;
>+ return kUnknownError;
>+ }
Just return NS\_ERROR\_HTMLPARSER\_UNKNOWN instead.
> if (!aXMLMode) {
> // First, we have to flush any tags that don't belong in the head if there
> // was no <body> in the context.
> // XXX This is extremely ugly. Maybe CNavDTD should have FlushMisplaced()?
>- NS\_ASSERTION(mParserContext, "Parsing didn't create a parser context?");
>+ if (!mParserContext) {
>+ NS\_ERROR("Parsing didn't create a parser context?");
>+ mFlags |= NS\_PARSER\_FLAG\_OBSERVERS\_ENABLED;
>+ return kInvalidParserContext;
>+ }
Same thing here, simply return NS\_ERROR\_HTMLPARSER\_INVALIDPARSERCONTEXT
r/sr=sicking with that
[Attachment #244371](/attachment.cgi?id=244371&action=edit "1.8 branch patch") -
Flags: superreview+
[Attachment #244371](/attachment.cgi?id=244371&action=edit "1.8 branch patch") -
Flags: review?(bugmail)
[Attachment #244371](/attachment.cgi?id=244371&action=edit "1.8 branch patch") -
Flags: review+

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=358797#c11)• 18 years ago |
|  | |

I just checked, and on branch and on trunk up until today it has been possible to get into the same state by calling range.selectNodeContents(doctype), so I don't think we need to add extra checks for that on branch.
On trunk it should be impossible to get into that state starting today.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=358797#a967533_1689)• 18 years ago |

Assignee: traversal-range → dveditzFlags: blocking1.8.1.1? → blocking1.8.1.1+

|  | [Adam Guthrie](/user_profile?user_id=195226) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=358797#c12)• 18 years ago |
|  | |

Attached file
[mochittest compatible testcase](attachment.cgi?id=245475)
— [Details](attachment.cgi?id=245475&action=edit)

|  | [Adam Guthrie](/user_profile?user_id=195226) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=358797#c13)• 18 years ago |
|  | |

Comment on [attachment 245475](/attachment.cgi?id=245475 "mochittest compatible testcase") [[details]](/attachment.cgi?id=245475&action=edit "mochittest compatible testcase")
mochittest compatible testcase
dveditz, can you take a quick look at this to make sure it's correct?
[Attachment #245475](/attachment.cgi?id=245475&action=edit "mochittest compatible testcase") -
Flags: review?(dveditz)

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=358797#c14)• 18 years ago |
|  | |

As this is blocking1.8.1.1+, please request approval1.8.1.1 on the current patch.
Also, does this patch need to be committed to the trunk, or is it already
there?Status: NEW → ASSIGNED

|  | [Jonas Sicking (:sicking) No longer reading bugmail consistently](/user_profile?user_id=9186) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=358797#c15)• 18 years ago |
|  | |

We may actually want to land this on trunk too even tough there are other things stopping crash there already. It's always good to have multiple levels of protection.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=358797#c16)• 18 years ago |
|  | |

Comment on [attachment 245475](/attachment.cgi?id=245475 "mochittest compatible testcase") [[details]](/attachment.cgi?id=245475&action=edit "mochittest compatible testcase")
mochittest compatible testcase
r=dveditz
[Attachment #245475](/attachment.cgi?id=245475&action=edit "mochittest compatible testcase") -
Flags: review?(dveditz) → review+

|  | [Reed Loden [:reed]](/user_profile?user_id=159758) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=358797#a2432733_159758)• 18 years ago |

[Attachment #244371](/attachment.cgi?id=244371&action=edit "1.8 branch patch") -
Flags: approval1.8.1.1?

|  | [Robert Sayre](/user_profile?user_id=180188) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=358797#c17)• 18 years ago |
|  | |

Checking in tests/test\_bug358797.html;
/cvsroot/mozilla/testing/mochitest/tests/test\_bug358797.html,v <-- test\_bug358797.html
initial revision: 1.1
doneFlags: in-testsuite? → in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=358797#c18)• 18 years ago |
|  | |

Comment on [attachment 244371](/attachment.cgi?id=244371 "1.8 branch patch") [[details]](/attachment.cgi?id=244371&action=edit "1.8 branch patch") [[diff]](/attachment.cgi?id=244371&action=diff "1.8 branch patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=358797&attachment=244371)
1.8 branch patch
approved for 1.8 branch, a=dveditz for drivers
[Attachment #244371](/attachment.cgi?id=244371&action=edit "1.8 branch patch") -
Flags: approval1.8.1.1? → approval1.8.1.1+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=358797#a2507496_1689)• 18 years ago |

Whiteboard: needs landing

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=358797#a2520237_1689)• 18 years ago |

Flags: blocking1.8.0.9+Keywords: [fixed1.8.0.9](/buglist.cgi?keywords=fixed1.8.0.9&resolution=---),
[fixed1.8.1.1](/buglist.cgi?keywords=fixed1.8.1.1&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=358797#a2520276_1689)• 18 years ago |

Whiteboard: needs landing

|  | [[:Aleksej]](/user_profile?user_id=197295) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=358797#c19)• 18 years ago |
|  | |

Verified:
Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.0.9pre) Gecko/20061201 Firefox/1.5.0.9pre
Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.1pre) Gecko/20061201 BonEcho/2.0.0.1pre

|  | [[:Aleksej]](/user_profile?user_id=197295) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=358797#c20)• 18 years ago |
|  | |

The verification above was with the modified original testcase.

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=358797#c21)• 18 years ago |
|  | |

Works for me on Windows XP x64 Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.8.1.1pre) Gecko/20061129 BonEcho/2.0.0.1pre
Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US; rv:1.8.0.9pre) Gecko/20061130 Firefox/1.5.0.9pre
Also tested with Vista and also no crash on testcase from [comment #5](/show_bug.cgi?id=358797#c5 "VERIFIED FIXED - range.createContextualFragment() crash when range node is DocType"). I leave this Bug as assigned, because i can`t find a checkin for this patch :)
Keywords: [fixed1.8.0.9](/buglist.cgi?keywords=fixed1.8.0.9&resolution=---),
[fixed1.8.1.1](/buglist.cgi?keywords=fixed1.8.1.1&resolution=---) → [verified1.8.0.9](/buglist.cgi?keywords=verified1.8.0.9&resolution=---),
[verified1.8.1.1](/buglist.cgi?keywords=verified1.8.1.1&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=358797#c22)• 18 years ago |
|  | |

This was checked in to the branches on Nov 28
<http://bonsai.mozilla.org/cvsquery.cgi?treeid=default&module=all&branch=&branchtype=match&dir=mozilla%2Fparser&file=&filetype=match&who=dveditz%25cruzio.com&whotype=match&sortby=Date&hours=2&date=explicit&mindate=2006-11-28&maxdate=2006-11-29&cvsroot=%2Fcvsroot>
Marking fixed since it's not a trunk problemStatus: ASSIGNED → RESOLVEDClosed: 18 years agoResolution: --- → FIXED

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=358797#c23)• 18 years ago |
|  | |

verified fixed because of [comment #19](/show_bug.cgi?id=358797#c19 "VERIFIED FIXED - range.createContextualFragment() crash when range node is DocType") and #21Status: RESOLVED → VERIFIED

|  | [Launchpad](/user_profile?user_id=363145) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=358797#a122527133_363145)• 14 years ago |

See Also: → <https://launchpad.net/bugs/69719>

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=358797#a202870565_1)• 12 years ago |

Component: DOM: Traversal-Range → DOM: Core & HTML
You need to [log in](/show_bug.cgi?id=358797&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.redhat.com_cad4a64b_20250124_202431.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D213237)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D213237)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D213237)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 213237

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 213237**](show_bug.cgi?id=213237)
- Firefox crash due to javascript-triggered NULL pointer dereference

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Firefox crash due to javascript-triggered NULL pointer dereference

| | [Keywords](describekeywords.cgi): |  | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Red Hat Enterprise Linux 4 | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Red Hat | | [Component:](describecomponents.cgi?product=Red Hat Enterprise Linux 4 "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | firefox | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.4 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Target Release](page.cgi?id=fields.html#target_release): | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Christopher Aillon | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://www.gotfault.net/research/advi...](http://www.gotfault.net/research/advisory/gadv-firefox.txt) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | reported=20061031,source=fulldisclosu... | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [213238](show_bug.cgi?id=213238 "CLOSED ERRATA - Firefox crash due to javascript-triggered NULL pointer dereference") | | TreeView+ | [depends on](buglist.cgi?bug_id=213237&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=213237&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2006-10-31 12:53 UTC by Lubomir Kundrak | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2007-11-17 01:14 UTC ([History](show_activity.cgi?id=213237)) | | [CC List:](page.cgi?id=fields.html#cclist) | 0 users | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2006-11-03 02:16:19 UTC | | | Target Upstream Version: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Firefox 1.5.0.7 crash testcase**](attachment.cgi?id=139850 "View the content of the attachment") (368 bytes, text/plain)  [2006-10-31 12:53 UTC](#attach_139850 "Go to the comment associated with the attachment"), Lubomir Kundrak | *no flags* | [Details](attachment.cgi?id=139850&action=edit) | | [View All](attachment.cgi?bugid=213237&action=viewall) | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Mozilla Foundation | [358797](https://bugzilla.mozilla.org/show_bug.cgi?id=358797) | 0 | None | None | None | Never | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=213237#c0)  Lubomir Kundrak    2006-10-31 12:53:46 UTC  ``` Description of problem:  Mozilla Firefox is prone to a DoS within its javascript Range object. In a special condition, a NULL Pointer Deference occur and Firefox crashes. Refer to advisory text or attached testcase for details.  Version-Release number of selected component (if applicable): 1.5.0.7   ```  [Comment 1](show_bug.cgi?id=213237#c1)  Lubomir Kundrak    2006-10-31 12:53:46 UTC  ``` Created [attachment 139850](attachment.cgi?id=139850 "Firefox 1.5.0.7 crash testcase") [[details]](attachment.cgi?id=139850&action=edit "Firefox 1.5.0.7 crash testcase") Firefox 1.5.0.7 crash testcase   ```  [Comment 2](show_bug.cgi?id=213237#c2)  Lubomir Kundrak    2006-10-31 13:00:48 UTC  ``` Comment on [attachment 139850](attachment.cgi?id=139850 "Firefox 1.5.0.7 crash testcase") [[details]](attachment.cgi?id=139850&action=edit "Firefox 1.5.0.7 crash testcase") Firefox 1.5.0.7 crash testcase  I set the MIME type of the patch to text/plain, for obvious reason.   ```  [Comment 3](show_bug.cgi?id=213237#c3)  Josh Bressers    2006-11-03 02:16:19 UTC  ``` This issue is simply a NULL dereference crash, follow the thread.  <http://www.securityfocus.com/archive/1/archive/1/450167/100/0/threaded>  I'm removing the Security keyword.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=213237&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


