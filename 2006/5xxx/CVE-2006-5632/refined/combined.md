=== Content from www.attrition.org_33ced936_20250124_224722.html ===

# [VIM] Ig-shop change\_pass.php XSS - 2 vectors

**Steven M. Christey**
coley at mitre.org

*Tue Oct 31 15:53:26 EST 2006*

* Previous message: [[VIM] parameter name error in vuln DBs for EPNadmin](001098.html)
* Next message: [[VIM] Ig-shop change\_pass.php XSS - 2 vectors](001101.html)
* **Messages sorted by:**
  [[ date ]](date.html#1099)
  [[ thread ]](thread.html#1099)
  [[ subject ]](subject.html#1099)
  [[ author ]](author.html#1099)

---

```

There's a slightly confusing discrepancy in SECTRACK:1017130 and
BID:20768, in which the description mentions the "id" parameter.
However, the raw source, included verbatim in the SECTRACK, provides
an exploit using the action parameter.

I dug up the source code and figured out that both vectors are valid.

In version 1.4 from sourceforge, dated 2003, change_pass.php has:

>			<input type="hidden" name="email" value="<?=$HTTP_GET_VARS['id']?>">

So, that's the "id" vector.

And, for $action we have:

		if($action=="1")
		{
			...
		}
		else
		{
?>
			<form method="post" action="<?=$PHP_SELF?>" name="mem_change_form" onSubmit="return Validate();">

So, as long as action is not "1", the query string is dumped into the
form.  This takes care of the action parameter, in the sense
that it's not "1" and is part of the query string.

I don't know what the original researcher's intention was with listing
the Validate() function.  It doesn't seem to contain any of that
DOM-based XSS stuff, and it's only activated when the user presses
Submit.

There might be some other issues elsewhere in the code, such as where
action is 1, but I didn't investigate further.

- Steve

```

---

* Previous message: [[VIM] parameter name error in vuln DBs for EPNadmin](001098.html)
* Next message: [[VIM] Ig-shop change\_pass.php XSS - 2 vectors](001101.html)
* **Messages sorted by:**
  [[ date ]](date.html#1099)
  [[ thread ]](thread.html#1099)
  [[ subject ]](subject.html#1099)
  [[ author ]](author.html#1099)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)


