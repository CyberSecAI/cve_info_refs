- **Root cause of vulnerability:** The `change_pass.php` script in Ig-shop version 1.4 (and possibly other versions) does not properly sanitize user-supplied input when generating HTML, leading to Cross-Site Scripting (XSS) vulnerabilities.
- **Weaknesses/vulnerabilities present:** The script is vulnerable to XSS through two different parameters: `id` and `action`.
  - The `id` parameter is directly inserted into a hidden input field: `<input type="hidden" name="email" value="<?=$HTTP_GET_VARS['id']?>">`
  - If the `action` parameter is not equal to "1", it is included in the form's `action` attribute:  `<form method="post" action="<?=$PHP_SELF?>" ...>`  where `$PHP_SELF` includes the query string containing `action`.
- **Impact of exploitation:** A successful attack would allow an attacker to inject malicious JavaScript code into the web page, which would then be executed in the context of the user's browser. This could lead to various malicious activities, such as stealing cookies, session hijacking, or redirecting users to malicious websites.
- **Attack vectors:** The attack vector involves crafting malicious URLs that include JavaScript code within the `id` or `action` parameters.
- **Required attacker capabilities/position:** The attacker needs to be able to craft and deliver a URL with the malicious code to a victim.