=== Content from attrition.org_2af71c9c_20250124_165710.html ===

# [VIM] DISPUTE: PHP file inclusion in Ariadne 2.4.1

**Heinbockel, Bill**
heinbockel at mitre.org

*Mon Nov 6 17:17:56 EST 2006*

* Previous message: [[VIM] DISPUTE: PHP file inclusion in Ariadne 2.4.1](001108.html)
* Next message: [[VIM] Vendor ACK for iodine buffer overflow](001110.html)
* **Messages sorted by:**
  [[ date ]](date.html#1109)
  [[ thread ]](thread.html#1109)
  [[ subject ]](subject.html#1109)
  [[ author ]](author.html#1109)

---

```

>-----Original Message-----
>From: Heinbockel, Bill
>Sent: Montag, 6. November 2006 17:02
>To: 'Vulnerability Information Managers'
>Subject: DISPUTE: PHP file inclusion in Ariadne 2.4.1
>
>Researcher: ajann
>BUGTRAQ:20061106 Ariadne <= 2.4.1 Multiple Remote File Include
>Vulnerabilities(New)
><http://www.securityfocus.com/archive/1/archive/1/450709/100/0/threaded>
>XF:ariadne-storeconfig-file-include(30018)
>BID:20916
>
>*************************
>
>Examining Ariadne 2.4.1, the reported issues are not possible
>if the installation instructions are followed...
>
...
>
>    if (!@include("../www/ariadne.inc")) {
>        chdir(substr($_SERVER['PHP_SELF'], 0, strrpos($_SERVER['PHP_SE
>        include("../www/ariadne.inc");
>    }
>    require($ariadne."/configs/ariadne.phtml");
>    require($ariadne."/configs/ftp/$configfile");
>    require($ariadne."/configs/store.phtml");
>    require($ariadne."/includes/loader.ftp.php");
>    require($ariadne."/configs/sessions.phtml");
>    require($ariadne."/stores/".$store_config["dbms"]."store.phtml");

Just to clarify on the rest of the claims:

Additionally, the $configfile variable is defined previously in the
file
and $store_config["dbms"] is initialized in the configs/store.phtml
file
(and should not be publicly accessible if the installation instructions
are followed).

Some of the phtml files are installed by the user following the
instructions
while others are taken care of by running the install/install.php
script
(again, listed as a step in the installation instructions).

```

---

* Previous message: [[VIM] DISPUTE: PHP file inclusion in Ariadne 2.4.1](001108.html)
* Next message: [[VIM] Vendor ACK for iodine buffer overflow](001110.html)
* **Messages sorted by:**
  [[ date ]](date.html#1109)
  [[ thread ]](thread.html#1109)
  [[ subject ]](subject.html#1109)
  [[ author ]](author.html#1109)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)



=== Content from securityreason.com_241d51cb_20250124_165711.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from attrition.org_c8134c7c_20250124_165709.html ===

# [VIM] DISPUTE: PHP file inclusion in Ariadne 2.4.1

**Heinbockel, Bill**
heinbockel at mitre.org

*Mon Nov 6 17:01:47 EST 2006*

* Previous message: [[VIM] FtpXQ Server Default Accounts](001107.html)
* Next message: [[VIM] DISPUTE: PHP file inclusion in Ariadne 2.4.1](001109.html)
* **Messages sorted by:**
  [[ date ]](date.html#1108)
  [[ thread ]](thread.html#1108)
  [[ subject ]](subject.html#1108)
  [[ author ]](author.html#1108)

---

```
Researcher: ajann
BUGTRAQ:20061106 Ariadne <= 2.4.1 Multiple Remote File Include
Vulnerabilities(New)
<http://www.securityfocus.com/archive/1/archive/1/450709/100/0/threaded>
XF:ariadne-storeconfig-file-include(30018)
BID:20916

*************************

Examining Ariadne 2.4.1, the reported issues are not possible
if the installation instructions are followed...

The files reported are:
/ftp/loader.php   <== assumed, this matches the posted code
/lib/includes/loader.cmd.php

The "loader.php" files include:
/ftp/loader.php
/soap/loader.php
/webdav/loader.php
/www/loader.php

Looking at any of the loader.php files, specifically
/ftp/loader.php, though they all include /www/ariadne.inc:

    if (!@include("../www/ariadne.inc")) {
        chdir(substr($_SERVER['PHP_SELF'], 0, strrpos($_SERVER['PHP_SE
        include("../www/ariadne.inc");
    }
    require($ariadne."/configs/ariadne.phtml");
    require($ariadne."/configs/ftp/$configfile");
    require($ariadne."/configs/store.phtml");
    require($ariadne."/includes/loader.ftp.php");
    require($ariadne."/configs/sessions.phtml");
    require($ariadne."/stores/".$store_config["dbms"]."store.phtml");
    require($ariadne."/nls/en");
    require($ariadne."/modules/mod_mimemagic.php");

    require($ariadne."/modules/mod_virusscan.php");

Looking in the www directory, there is a ariadne.inc-win and
ariadne.inc-unix...

>From the installation instructions referenced by the README and located
in /docs/install.txt and install.win.rtf, we see that:

2) Move the www, lib and files directories to their proper place.
Preferably you
   don't want the lib and files directories under the document root.
   e.g.:

     cd /usr/local/lib/
     tar xvzf ~/ariadne.2.4.1.tgz
     cd /var/www
     ln -s /usr/local/lib/ariadne/www/ ariadne
...
6) Copy the file www/ariadne.inc-unix to www/ariadne.inc and edit it to
reflect
   the includepath to the Ariadne lib directory.
[in ariadne.inc*:  $ariadne='/usr/local/lib/ariadne/lib';]

So, if the installation instructions are followed, neither of the two
issues
exist since the file is either in (1) a not publicly accessible
directory or
(2) includes the www/ariadne.inc file before using the $ariadne
variable.

William Heinbockel
Infosec Engineer
The MITRE Corporation
202 Burlington Rd. MS S145
Bedford, MA 01730
[heinbockel at mitre.org](http://www.attrition.org/mailman/listinfo/vim)
781-271-2615

```

---

* Previous message: [[VIM] FtpXQ Server Default Accounts](001107.html)
* Next message: [[VIM] DISPUTE: PHP file inclusion in Ariadne 2.4.1](001109.html)
* **Messages sorted by:**
  [[ date ]](date.html#1108)
  [[ thread ]](thread.html#1108)
  [[ subject ]](subject.html#1108)
  [[ author ]](author.html#1108)

---

[More information about the VIM
mailing list](http://www.attrition.org/mailman/listinfo/vim)


