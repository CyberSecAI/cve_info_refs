Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2006-5822

**Vulnerability:** Buffer Overflow

**Root Cause:** The vulnerability exists in the `bpcd.exe` daemon of Symantec Veritas NetBackup. When parsing `CONNECT_OPTIONS` requests, the daemon copies the contents into a stack-allocated buffer without proper length checking. This lack of validation allows an attacker to send an overly long `CONNECT_OPTIONS` request, overflowing the buffer.

**Weaknesses:**
*   **Lack of Input Validation:** The primary weakness is the missing length check before copying data into a fixed-size buffer.
*   **Stack-based Buffer Overflow:** The vulnerable buffer is allocated on the stack, which can lead to control-flow hijacking.

**Impact of Exploitation:**
*   **Arbitrary Code Execution:** Successful exploitation allows a remote, unauthenticated attacker to execute arbitrary code on the vulnerable system.
*   **Complete System Compromise:** Due to the nature of arbitrary code execution, an attacker could gain complete control over the affected system.
*   **Privilege Escalation:** The code will be executed with the privileges of the `bpcd` daemon.

**Attack Vectors:**
*   **Network:** The attack vector is remote and network-based.
*   **Specific Port:** The vulnerability is triggered through network requests sent to the `bpcd` daemon on port `13782/tcp`.
*   **Unauthenticated:** Authentication is not required to exploit the vulnerability.

**Required Attacker Capabilities/Position:**
*   **Remote Access:** The attacker needs network access to the vulnerable system on port `13782/tcp`.
*   **No Authentication Required:**  The attacker does not need any prior authentication or credentials to exploit this flaw.
*   **Crafted Malicious Request:** The attacker needs to send a specially crafted `CONNECT_OPTIONS` request containing data that exceeds the buffer's size.

**Additional Information:**
*   **Affected Products:** Symantec Veritas NetBackup versions prior to the patched versions are vulnerable.
*   **Patches Released:** Symantec released patches in NetBackup Enterprise Server/NetBackup Server; Server and client and Storage Migrator versions 6.0_MP4, 5.1_MP6, and 5.0_MP7.
*   **Workarounds:** Restricting access to the affected ports or using host-based firewalls, along with the implementation of NetBackup Access Control (NBAC), can mitigate the risk.
*   **Discovery:** The vulnerability was reported by TippingPoint ZDI, who credited Sebastian Apelt for the discovery.