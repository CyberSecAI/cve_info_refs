```
{
  "cveId": "CVE-2006-5051",
  "description": "A signal handler race condition exists in OpenSSH before 4.4. A remote attacker can exploit this to cause a denial of service (crash) and possibly execute arbitrary code if GSSAPI authentication is enabled, via unspecified vectors that lead to a double-free.",
  "vulnerabilityDetails": [
    {
      "rootCause": "The signal handler in OpenSSH is vulnerable to a race condition due to calling non-async-signal-safe functions, like syslog(), during cleanup operations.",
      "weaknesses": [
        "Signal handler race condition",
        "Use of non-async-signal-safe functions in signal handler",
        "Double-free vulnerability"
      ],
      "impact": "A remote attacker can cause a denial of service (crash) and potentially execute arbitrary code.",
      "attackVectors": [
        "Sending specially crafted packets to trigger the race condition during cleanup.",
        "Unspecified vectors leading to a double-free."
      ],
      "attackerCapabilities": "Remote, unauthenticated attacker.",
       "additionalDetails": "The vulnerability does not actually depend on GSSAPI as originally stated in the description, but rather a flaw in cleanup process that can cause a double free. It is exploitable without GSSAPI being enabled."
    },
    {
      "rootCause": "The vulnerability was reintroduced in OpenSSH 8.5p1 due to removal of '#ifdef DO_LOG_SAFE_IN_SIGHAND' from sigdie() function.",
      "weaknesses": [
          "Regression vulnerability",
           "Signal handler race condition"
      ],
       "impact": "Remote code execution can be achieved by exploiting the race condition in the signal handler and heap corruption using specific techniques (e.g., Malloc Maleficarum).",
      "attackVectors": [
        "Interrupting the execution of malloc() or free() with SIGALRM.",
          "Manipulating heap metadata to overwrite function pointers (e.g., __free_hook)."
      ],
     "attackerCapabilities": "Remote, unauthenticated attacker with ability to send malformed SSH packets."
    }
  ]
}
```