=== Content from www.vupen.com_c7b56de6_20250125_205248.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from bugzilla.mozilla.org_1e23ae78_20250125_205258.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/355728)
* [XML](/show_bug.cgi?ctype=xml&id=355728)

Closed
[Bug 355728](/show_bug.cgi?id=355728)

Opened 18 years ago
Closed 18 years ago

# [SECURITY] XSS in the "id" parameter of showdependencygraph when "doall" is set

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] XSS in the "id" parameter of showdependencygraph when "doall" is set

## Categories

### (Bugzilla :: Creating/Changing Bugs, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Creating%2FChanging%20Bugs#Creating%2FChanging%20Bugs)

Creating/Changing Bugs
▾

Bugzilla :: Creating/Changing Bugs
Creating, changing, and viewing bugs. `enter_bug.cgi, post_bug.cgi, show_bug.cgi, process_bug.cgi`
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Creating%2FChanging%20Bugs&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Creating%2FChanging%20Bugs&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Creating%2FChanging%20Bugs)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.15

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.18

## People

### (Reporter: mkanat, Assigned: mkanat)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8d3dd762c1c841898a384ebc42abec97?d=mm&size=40)  [mkanat](/user_profile?user_id=73187)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/8d3dd762c1c841898a384ebc42abec97?d=mm&size=40)  [mkanat](/user_profile?user_id=73187)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

### ( [URL](showdependencygraph.cgi?doall=80000001&id=%27%22%3E%3Cscript+id%3D%2280000000%22%3Ealert%28%22hi%21%22%29%3B%3C%2Fscript%3E+&rankdir=80000001&showsummary=%27+having+1%3D1- "showdependencygraph.cgi?doall=80000001&id=%27%22%3E%3Cscript+id%3D%2280000000%22%3Ealert%28%22hi%21%22%29%3B%3C%2Fscript%3E+&rankdir=80000001&showsummary=%27+having+1%3D1-") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[126793](/show_bug.cgi?id=126793 "RESOLVED FIXED - Templatise showdependencygraph.cgi")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[346525](/show_bug.cgi?id=346525 "RESOLVED FIXED - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

Dependency [tree](/showdependencytree.cgi?id=355728&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=355728)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[showdependencygraph.cgi?doall=8000000...](showdependencygraph.cgi?doall=80000001&id=%27%22%3E%3Cscript+id%3D%2280000000%22%3Ealert%28%22hi%21%22%29%3B%3C%2Fscript%3E+&rankdir=80000001&showsummary=%27+having+1%3D1- "showdependencygraph.cgi?doall=80000001&id=%27%22%3E%3Cscript+id%3D%2280000000%22%3Ealert%28%22hi%21%22%29%3B%3C%2Fscript%3E+&rankdir=80000001&showsummary=%27+having+1%3D1-")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [ready for 2.18.6][ready for 2.20.3][ready for 2.22.1][ready for 2.23.3])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[ready for 2.18.6][ready for 2.20.3][ready for 2.22.1][ready for 2.23.3]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [justdave](/user_profile?user_id=10297) | [approval](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking3.0](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking3.0 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.22](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.22 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking2.22.1](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking2.22.1 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.20](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.20 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking2.20.3](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking2.20.3 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.18](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.18 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking2.18.6](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking2.18.6 | + |
| --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 2 obsolete files)

| [v1 (all branches)](/attachment.cgi?id=241461)  [18 years ago](#c2)  [Max Kanat-Alexander](/user_profile?user_id=73187)   653 bytes, patch | LpSolit : [review-](#c0 "18 years ago") | [Details](/attachment.cgi?id=241461&action=edit) | [Diff](/attachment.cgi?id=241461&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241461) |
| --- | --- | --- |
| [v2 (tip and 2.22)](/attachment.cgi?id=241529)  [18 years ago](#c8)  [Max Kanat-Alexander](/user_profile?user_id=73187)   1.77 KB, patch |  | [Details](/attachment.cgi?id=241529&action=edit) | [Diff](/attachment.cgi?id=241529&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241529) |
| [Release Notes Fix (2.20)](/attachment.cgi?id=241531)  [18 years ago](#c9)  [Max Kanat-Alexander](/user_profile?user_id=73187)   858 bytes, patch | LpSolit : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=241531&action=edit) | [Diff](/attachment.cgi?id=241531&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241531) |
| [Release Notes Fix (2.18)](/attachment.cgi?id=241532)  [18 years ago](#c10)  [Max Kanat-Alexander](/user_profile?user_id=73187)   969 bytes, patch | LpSolit : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=241532&action=edit) | [Diff](/attachment.cgi?id=241532&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241532) |
| [v3](/attachment.cgi?id=241535)  [18 years ago](#c11)  [Max Kanat-Alexander](/user_profile?user_id=73187)   1.70 KB, patch | LpSolit : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=241535&action=edit) | [Diff](/attachment.cgi?id=241535&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241535) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=355728#c0)• 18 years ago |
|  | |

Reported to support-bugzilla:
It looks like if you pass JavaScript in the 'id' parameter it gets
placed verbatim into the 'value' parameter of the 'id' input field.
I adapted a URL from their warning text to try to highlight the
problem:
showdependencygraph.cgi?doall=80000001&id=%27%22%3E%3Cscript+id%3D%2280000000%22%3Ealert%28%22hi%21%22%29%3B%3C%2Fscript%3E+&rankdir=80000001&showsummary=%27+having+1%3D1-

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=355728#a78_120380)• 18 years ago |

URL: [showdependencygraph.cgi?doall=8000000...](showdependencygraph.cgi?doall=80000001&id=%27%22%3E%3Cscript+id%3D%2280000000%22%3Ealert%28%22hi%21%22%29%3B%3C%2Fscript%3E+&rankdir=80000001&showsummary=%27+having+1%3D1-)

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=355728#c1)• 18 years ago |
|  | |

I can reproduce the JS injection on both 2.18.6 and tip. As it seems very specific to showdependencygraph.cgi, it's fine to take it now during our QA process. And I know mkanat is working on it already.Flags: blocking3.0?Flags: blocking2.22.1?Flags: blocking2.20.3?Flags: blocking2.18.6?Version: 2.23 → 2.18.5

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=355728#a1840_73187)• 18 years ago |

Flags: blocking3.0?Flags: blocking3.0+Flags: blocking2.22.1?Flags: blocking2.22.1+Flags: blocking2.20.3?Flags: blocking2.20.3+Flags: blocking2.18.6?Flags: blocking2.18.6+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=355728#a2335_120380)• 18 years ago |

Blocks: [346525](/show_bug.cgi?id=346525 "RESOLVED FIXED - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=355728#c2)• 18 years ago |
|  | |

Attached patch

[v1 (all branches)](attachment.cgi?id=241461&action=diff) (obsolete)
— [Details](attachment.cgi?id=241461&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241461)

Okay. Here's the least invasive fix possible.Assignee: create-and-change → mkanatStatus: NEW → ASSIGNED
[Attachment #241461](/attachment.cgi?id=241461&action=edit "v1 (all branches)") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=355728#c3)• 18 years ago |
|  | |

Comment on [attachment 241461](/attachment.cgi?id=241461 "v1 (all branches)") [[details]](/attachment.cgi?id=241461&action=edit "v1 (all branches)") [[diff]](/attachment.cgi?id=241461&action=diff "v1 (all branches)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241461)
v1 (all branches)
Actually, this file applies cleanly on every branch, not just on the tip.
[Attachment #241461](/attachment.cgi?id=241461&action=edit "v1 (all branches)") -
Attachment description: v1 (tip) → v1 (all branches)

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=355728#c4)• 18 years ago |
|  | |

Comment on [attachment 241461](/attachment.cgi?id=241461 "v1 (all branches)") [[details]](/attachment.cgi?id=241461&action=edit "v1 (all branches)") [[diff]](/attachment.cgi?id=241461&action=diff "v1 (all branches)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241461)
v1 (all branches)
>-$vars->{'bug\_id'} = $cgi->param('id');
>+my @bugs = map { detaint\_natural($\_) } ($cgi->param('id'));
>+$vars->{'bug\_id'} = join(', ', @bugs);
This is not the right fix. In the "Bug numbers:" text field, if you enter a comma separated list of bug IDs (which is a valid action), this list is cleared by your patch as $cgi->param('id') is a scalar, not an array.
IMO, what we should do is to delete $cgi->param('id') if $cgi->param('doall') is defined and relax the
if (!defined $cgi->param('id') && !defined $cgi->param('doall')) {
ThrowCodeError("missing\_bug\_id");
}
test a bit, replacing && by ||. If we want all bugs, then we shouldn't care about bug\_id. If 'doall' is not given, then
} else {
foreach my $i (split('[\s,]+', $cgi->param('id'))) {
$i = trim($i);
ValidateBugID($i);
$baselist{$i} = 1;
}
my @stack = keys(%baselist);
is called and $cgi->param('id') should be regenerated:
$cgi->param('id') = join(',', @stack);
[Attachment #241461](/attachment.cgi?id=241461&action=edit "v1 (all branches)") -
Flags: review?(LpSolit) → review-

|  | [Marc Schumann [:Wurblzap]](/user_profile?user_id=84162) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=355728#c5)• 18 years ago |
|  | |

Maybe I'm to naïve, but shouldn't it be possible to simply filter the bugger on output? Worst you'd end up when clicking such a doctored link would be an input field with suspicious content, right?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=355728#c6)• 18 years ago |
|  | |

(In reply to [comment #5](/show_bug.cgi?id=355728#c5 "RESOLVED FIXED - [SECURITY] XSS in the \"id\" parameter of showdependencygraph when \"doall\" is set"))
> Maybe I'm to naïve, but shouldn't it be possible to simply filter the bugger
> on output? Worst you'd end up when clicking such a doctored link would be an
> input field with suspicious content, right?
Yeah. I already have a patch that filters the output, I just thought that the two-line solution to filter the input was simpler, since it's a security bug. Filtering the output is much messier.
But I can attach that instead, possibly.

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=355728#c7)• 18 years ago |
|  | |

I don't like the idea of filtering the output. The data given by the user should be sanitized. That's how we do in all other scripts and is by far the safest solution.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=355728#c8)• 18 years ago |
|  | |

Attached patch

[v2 (tip and 2.22)](attachment.cgi?id=241529&action=diff) (obsolete)
— [Details](attachment.cgi?id=241529&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241529)

Okay, here's the patch. I tested this one, and it works fine.
The code part works on all branches. The release notes part only applies to 2.22 and the tip, of course.
[Attachment #241461](/attachment.cgi?id=241461&action=edit "v1 (all branches)") -
Attachment is obsolete: true
[Attachment #241529](/attachment.cgi?id=241529&action=edit "v2 (tip and 2.22)") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=355728#c9)• 18 years ago |
|  | |

Attached patch

[Release Notes Fix (2.20)](attachment.cgi?id=241531&action=diff)
— [Details](attachment.cgi?id=241531&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241531)

Here's the Release Notes part of the patch for 2.20.
[Attachment #241531](/attachment.cgi?id=241531&action=edit "Release Notes Fix (2.20)") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=355728#c10)• 18 years ago |
|  | |

Attached patch

[Release Notes Fix (2.18)](attachment.cgi?id=241532&action=diff)
— [Details](attachment.cgi?id=241532&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241532)

And this fixes the Release Notes for 2.18.
[Attachment #241532](/attachment.cgi?id=241532&action=edit "Release Notes Fix (2.18)") -
Flags: review?(LpSolit)

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=355728#c11)• 18 years ago |
|  | |

Attached patch

[v3](attachment.cgi?id=241535&action=diff)
— [Details](attachment.cgi?id=241535&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241535)

LpSolit pointed out on IRC that the previous patch could throw undef warnings during the join, if detaint\_natural failed.
He suggested this fix, which I thought was pretty clever. :-)
[Attachment #241529](/attachment.cgi?id=241529&action=edit "v2 (tip and 2.22)") -
Attachment is obsolete: true
[Attachment #241535](/attachment.cgi?id=241535&action=edit "v3") -
Flags: review?(LpSolit)
[Attachment #241529](/attachment.cgi?id=241529&action=edit "v2 (tip and 2.22)") -
Flags: review?(LpSolit)

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=355728#c12)• 18 years ago |
|  | |

Comment on [attachment 241535](/attachment.cgi?id=241535 "v3") [[details]](/attachment.cgi?id=241535&action=edit "v3") [[diff]](/attachment.cgi?id=241535&action=diff "v3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241535)
v3
Tested on all 4 branches. This correctly fixes the problem and the web server error log doesn't report any error anymore. r=LpSolit for all branches.
[Attachment #241535](/attachment.cgi?id=241535&action=edit "v3") -
Flags: review?(LpSolit) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=355728#a66692_120380)• 18 years ago |

Flags: approval?Flags: approval2.22?Flags: approval2.20?Flags: approval2.18?Whiteboard: [ready for 2.18.6][ready for 2.20.3][ready for 2.22.1][ready for 2.23.3]

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=355728#c13)• 18 years ago |
|  | |

Comment on [attachment 241531](/attachment.cgi?id=241531 "Release Notes Fix (2.20)") [[details]](/attachment.cgi?id=241531&action=edit "Release Notes Fix (2.20)") [[diff]](/attachment.cgi?id=241531&action=diff "Release Notes Fix (2.20)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241531)
Release Notes Fix (2.20)
>-prior to 2.20.3. None of them are considered to be of critical
>-severity, but we still strongly recommend that you update any
>+prior to 2.20.3. We still strongly recommend that you update any
> 2.20.x installation to 2.20.3.
Nit: not sure that "still" should be kept. R=LpSolit
[Attachment #241531](/attachment.cgi?id=241531&action=edit "Release Notes Fix (2.20)") -
Flags: review?(LpSolit) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=355728#c14)• 18 years ago |
|  | |

Comment on [attachment 241532](/attachment.cgi?id=241532 "Release Notes Fix (2.18)") [[details]](/attachment.cgi?id=241532&action=edit "Release Notes Fix (2.18)") [[diff]](/attachment.cgi?id=241532&action=diff "Release Notes Fix (2.18)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=355728&attachment=241532)
Release Notes Fix (2.18)
r=LpSolit
[Attachment #241532](/attachment.cgi?id=241532&action=edit "Release Notes Fix (2.18)") -
Flags: review?(LpSolit) → review+

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=355728#c15)• 18 years ago |
|  | |

For reference, this was introduced during the templatization of showdependencygraph.cgi, in [bug 126793](/show_bug.cgi?id=126793 "RESOLVED FIXED - Templatise showdependencygraph.cgi"). Previous to the templatization, there was a value\_quote() around the id. In the original template, bug\_id was filtered!
But bbaetz commented that it was unnecessary to filter the id, here:
[https://bugzilla.mozilla.org/show\_bug.cgi?id=126793#c10](/show_bug.cgi?id=126793#c10 "RESOLVED FIXED - Templatise showdependencygraph.cgi")
justdave replied that it didn't hurt.
However, it looks like on checkin, the filter was removed.
I'm not trying to put blame on anybody--we've all made mistakes, and some of them worse than this. I just wanted to note the story so that we could avoid it in the future.
Bugzilla has been affected since 2.15.
So, the lesson is, when in doubt, FILTER html.Depends on: [126793](/show_bug.cgi?id=126793 "RESOLVED FIXED - Templatise showdependencygraph.cgi")Version: 2.18.5 → 2.15

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=355728#a634658_10297)• 18 years ago |

Flags: approval?Flags: approval2.22?Flags: approval2.22+Flags: approval2.20?Flags: approval2.20+Flags: approval2.18?Flags: approval2.18+Flags: approval+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=355728#c16)• 18 years ago |
|  | |

tip:
Checking in showdependencygraph.cgi;
/cvsroot/mozilla/webtools/bugzilla/showdependencygraph.cgi,v <-- showdependencygraph.cgi
new revision: 1.54; previous revision: 1.53
done
Checking in docs/rel\_notes.txt;
/cvsroot/mozilla/webtools/bugzilla/docs/rel\_notes.txt,v <-- rel\_notes.txt
new revision: 1.42; previous revision: 1.41
done
2.22:
Checking in showdependencygraph.cgi;
/cvsroot/mozilla/webtools/bugzilla/showdependencygraph.cgi,v <-- showdependencygraph.cgi
new revision: 1.48.2.1; previous revision: 1.48
done
Checking in docs/rel\_notes.txt;
/cvsroot/mozilla/webtools/bugzilla/docs/rel\_notes.txt,v <-- rel\_notes.txt
new revision: 1.36.2.6; previous revision: 1.36.2.5
done
2.20.2:
Checking in showdependencygraph.cgi;
/cvsroot/mozilla/webtools/bugzilla/showdependencygraph.cgi,v <-- showdependencygraph.cgi
new revision: 1.38.4.3; previous revision: 1.38.4.2
done
Checking in docs/rel\_notes.txt;
/cvsroot/mozilla/webtools/bugzilla/docs/rel\_notes.txt,v <-- rel\_notes.txt
new revision: 1.32.2.7; previous revision: 1.32.2.6
done
2.18.5:
Checking in showdependencygraph.cgi;
/cvsroot/mozilla/webtools/bugzilla/showdependencygraph.cgi,v <-- showdependencygraph.cgi
new revision: 1.35.2.2; previous revision: 1.35.2.1
done
Checking in docs/rel\_notes.txt;
/cvsroot/mozilla/webtools/bugzilla/docs/rel\_notes.txt,v <-- rel\_notes.txt
new revision: 1.24.2.15; previous revision: 1.24.2.14
done
Status: ASSIGNED → RESOLVEDClosed: 18 years agoResolution: --- → FIXEDSummary: XSS in the "id" parameter of showdependencygraph when "doall" is set → [SECURITY] XSS in the "id" parameter of showdependencygraph when "doall" is set

|  | [Max Kanat-Alexander](/user_profile?user_id=73187)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=355728#c17)• 18 years ago |
|  | |

Security Advisory has been sent, so this bug is no longer private.Group: webtools-security
You need to [log in](/show_bug.cgi?id=355728&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Max Kanat-Alexander](/user_profile?user_id=73187)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from secunia.com_c332feed_20250125_205241.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from bugzilla.mozilla.org_a133d475_20250125_205256.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/206037)
* [XML](/show_bug.cgi?ctype=xml&id=206037)

Closed
[Bug 206037](/show_bug.cgi?id=206037)

Opened 22 years ago
Closed 18 years ago

# [SECURITY] Fix escaping/quoting in editXXX.cgi scripts

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] Fix escaping/quoting in editXXX.cgi scripts

## Categories

### (Bugzilla :: Administration, task)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Administration#Administration)

Administration
▾

Bugzilla :: Administration
Administration of a bugzilla installation, including `editcomponents.cgi, editgroups.cgi, editkeywords.cgi, editparams.cgi, editproducts.cgi, editusers.cgi, editversions.cgi, sanitycheck.cgi`
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Administration&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Administration&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Administration)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.10

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

task

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

minor

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.18

## People

### (Reporter: gerv, Assigned: LpSolit)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/559c3cf31c98a95b23421186b78df500?d=mm&size=40)  [gerv](/user_profile?user_id=9911)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[236560](/show_bug.cgi?id=236560 "RESOLVED FIXED - change a login n@domain to <n@domain> removes link in 'Select user'")

[235265](/show_bug.cgi?id=235265 "RESOLVED FIXED - Url-parameter XSS vulnerability in edit*.cgi")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[323521](/show_bug.cgi?id=323521 "RESOLVED FIXED - editkeywords.cgi and describekeywords.cgi treat description differently as regards HTML"), [346525](/show_bug.cgi?id=346525 "RESOLVED FIXED - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

Dependency [tree](/showdependencytree.cgi?id=206037&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=206037)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[236142](/show_bug.cgi?id=236142 "RESOLVED DUPLICATE - editusers.cgi XSS vulnerability"), [319085](/show_bug.cgi?id=319085 "RESOLVED DUPLICATE - XSS with the \"product=\" parameter of editproducts.cgi")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: ready for 2.18.6] [ready for 2.20.3][ready for 2.22.1][ready for 2.23.3])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

ready for 2.18.6] [ready for 2.20.3][ready for 2.22.1][ready for 2.23.3]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [justdave](/user_profile?user_id=10297) | [approval](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.22](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.22 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking2.22.1](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking2.22.1 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.20](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.20 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking2.20.3](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking2.20.3 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.18](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.18 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking2.18.6](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking2.18.6 | + |
| --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 25 obsolete files)

| [proper quoting for admin cgis,version 1](/attachment.cgi?id=129127)  [21 years ago](#c6)  [GavinS](/user_profile?user_id=15150)   75.64 KB, patch |  | [Details](/attachment.cgi?id=129127&action=edit) | [Diff](/attachment.cgi?id=129127&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=129127) |
| --- | --- | --- |
| [patch for tip, v1](/attachment.cgi?id=229914)  [19 years ago](#c35)  [Frédéric Buclin](/user_profile?user_id=120380)   11.01 KB, patch |  | [Details](/attachment.cgi?id=229914&action=edit) | [Diff](/attachment.cgi?id=229914&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=229914) |
| [patch for tip, v1.1](/attachment.cgi?id=229949)  [19 years ago](#c36)  [Frédéric Buclin](/user_profile?user_id=120380)   12.44 KB, patch |  | [Details](/attachment.cgi?id=229949&action=edit) | [Diff](/attachment.cgi?id=229949&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=229949) |
| [patch for tip, v2](/attachment.cgi?id=230034)  [19 years ago](#c42)  [Frédéric Buclin](/user_profile?user_id=120380)   35.91 KB, patch |  | [Details](/attachment.cgi?id=230034&action=edit) | [Diff](/attachment.cgi?id=230034&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=230034) |
| [unbitrotten patch for tip, v2.0.1](/attachment.cgi?id=230568)  [19 years ago](#c44)  [Frédéric Buclin](/user_profile?user_id=120380)   35.93 KB, patch |  | [Details](/attachment.cgi?id=230568&action=edit) | [Diff](/attachment.cgi?id=230568&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=230568) |
| [patch for 2.22, v1](/attachment.cgi?id=231163)  [18 years ago](#c45)  [Frédéric Buclin](/user_profile?user_id=120380)   35.51 KB, patch |  | [Details](/attachment.cgi?id=231163&action=edit) | [Diff](/attachment.cgi?id=231163&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231163) |
| [patch for tip, v2.1](/attachment.cgi?id=231165)  [18 years ago](#c46)  [Frédéric Buclin](/user_profile?user_id=120380)   36.24 KB, patch |  | [Details](/attachment.cgi?id=231165&action=edit) | [Diff](/attachment.cgi?id=231165&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231165) |
| [patch for 2.20, v1](/attachment.cgi?id=231227)  [18 years ago](#c47)  [Frédéric Buclin](/user_profile?user_id=120380)   37.49 KB, patch |  | [Details](/attachment.cgi?id=231227&action=edit) | [Diff](/attachment.cgi?id=231227&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231227) |
| [patch for tip, v2.2](/attachment.cgi?id=231228)  [18 years ago](#c48)  [Frédéric Buclin](/user_profile?user_id=120380)   36.35 KB, patch | justdave : [review-](#c0 "18 years ago") | [Details](/attachment.cgi?id=231228&action=edit) | [Diff](/attachment.cgi?id=231228&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231228) |
| [patch for 2.22, v1.1](/attachment.cgi?id=231229)  [18 years ago](#c49)  [Frédéric Buclin](/user_profile?user_id=120380)   35.68 KB, patch | justdave : [review-](#c0 "18 years ago") | [Details](/attachment.cgi?id=231229&action=edit) | [Diff](/attachment.cgi?id=231229&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231229) |
| [patch for 2.18, v1](/attachment.cgi?id=231266)  [18 years ago](#c50)  [Frédéric Buclin](/user_profile?user_id=120380)   46.79 KB, patch |  | [Details](/attachment.cgi?id=231266&action=edit) | [Diff](/attachment.cgi?id=231266&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231266) |
| [patch for 2.20, v1.1](/attachment.cgi?id=231268)  [18 years ago](#c51)  [Frédéric Buclin](/user_profile?user_id=120380)   37.69 KB, patch | justdave : [review-](#c0 "18 years ago") | [Details](/attachment.cgi?id=231268&action=edit) | [Diff](/attachment.cgi?id=231268&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231268) |
| [patch for 2.18, v1.1](/attachment.cgi?id=231347)  [18 years ago](#c52)  [Frédéric Buclin](/user_profile?user_id=120380)   47.23 KB, patch |  | [Details](/attachment.cgi?id=231347&action=edit) | [Diff](/attachment.cgi?id=231347&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231347) |
| [patch for tip, v3](/attachment.cgi?id=237791)  [18 years ago](#c68)  [Frédéric Buclin](/user_profile?user_id=120380)   40.05 KB, patch |  | [Details](/attachment.cgi?id=237791&action=edit) | [Diff](/attachment.cgi?id=237791&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=237791) |
| [patch for tip, v3.1](/attachment.cgi?id=237794)  [18 years ago](#c69)  [Frédéric Buclin](/user_profile?user_id=120380)   40.33 KB, patch |  | [Details](/attachment.cgi?id=237794&action=edit) | [Diff](/attachment.cgi?id=237794&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=237794) |
| [patch for tip, v3.2](/attachment.cgi?id=237862)  [18 years ago](#c71)  [Frédéric Buclin](/user_profile?user_id=120380)   40.64 KB, patch |  | [Details](/attachment.cgi?id=237862&action=edit) | [Diff](/attachment.cgi?id=237862&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=237862) |
| [patch for 2.18, v2](/attachment.cgi?id=238049)  [18 years ago](#c73)  [Frédéric Buclin](/user_profile?user_id=120380)   51.24 KB, patch | justdave : [review-](#c0 "18 years ago") | [Details](/attachment.cgi?id=238049&action=edit) | [Diff](/attachment.cgi?id=238049&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=238049) |
| [patch for tip, v4](/attachment.cgi?id=238054)  [18 years ago](#c74)  [Frédéric Buclin](/user_profile?user_id=120380)   40.65 KB, patch | justdave : [review-](#c0 "18 years ago") | [Details](/attachment.cgi?id=238054&action=edit) | [Diff](/attachment.cgi?id=238054&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=238054) |
| [patch for tip, v5](/attachment.cgi?id=239137)  [18 years ago](#c79)  [Frédéric Buclin](/user_profile?user_id=120380)   41.05 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=239137&action=edit) | [Diff](/attachment.cgi?id=239137&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239137) |
| [patch for 2.22, v2](/attachment.cgi?id=239144)  [18 years ago](#c80)  [Frédéric Buclin](/user_profile?user_id=120380)   39.85 KB, patch |  | [Details](/attachment.cgi?id=239144&action=edit) | [Diff](/attachment.cgi?id=239144&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239144) |
| [patch for 2.20, v2](/attachment.cgi?id=239147)  [18 years ago](#c81)  [Frédéric Buclin](/user_profile?user_id=120380)   43.35 KB, patch |  | [Details](/attachment.cgi?id=239147&action=edit) | [Diff](/attachment.cgi?id=239147&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239147) |
| [patch for 2.22, v2.1](/attachment.cgi?id=239149)  [18 years ago](#c82)  [Frédéric Buclin](/user_profile?user_id=120380)   40.92 KB, patch |  | [Details](/attachment.cgi?id=239149&action=edit) | [Diff](/attachment.cgi?id=239149&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239149) |
| [patch for 2.18, v3](/attachment.cgi?id=239150)  [18 years ago](#c83)  [Frédéric Buclin](/user_profile?user_id=120380)   53.00 KB, patch |  | [Details](/attachment.cgi?id=239150&action=edit) | [Diff](/attachment.cgi?id=239150&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239150) |
| [patch for tip, v5.1](/attachment.cgi?id=239524)  [18 years ago](#c86)  [Frédéric Buclin](/user_profile?user_id=120380)   42.37 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=239524&action=edit) | [Diff](/attachment.cgi?id=239524&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239524) |
| [patch for 2.22, v2.2](/attachment.cgi?id=239830)  [18 years ago](#c87)  [Frédéric Buclin](/user_profile?user_id=120380)   41.33 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=239830&action=edit) | [Diff](/attachment.cgi?id=239830&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239830) |
| [patch for 2.20, v2.1](/attachment.cgi?id=239838)  [18 years ago](#c88)  [Frédéric Buclin](/user_profile?user_id=120380)   43.73 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=239838&action=edit) | [Diff](/attachment.cgi?id=239838&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239838) |
| [patch for 2.22, v2.3](/attachment.cgi?id=239839)  [18 years ago](#c91)  [Frédéric Buclin](/user_profile?user_id=120380)   41.29 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=239839&action=edit) | [Diff](/attachment.cgi?id=239839&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239839) |
| [patch for tip, v5.2](/attachment.cgi?id=239840)  [18 years ago](#c93)  [Frédéric Buclin](/user_profile?user_id=120380)   42.34 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=239840&action=edit) | [Diff](/attachment.cgi?id=239840&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239840) |
| [patch for 2.18, v3.1](/attachment.cgi?id=239843)  [18 years ago](#c95)  [Frédéric Buclin](/user_profile?user_id=120380)   53.38 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=239843&action=edit) | [Diff](/attachment.cgi?id=239843&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239843) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=206037#c0)• 22 years ago |
|  | |

If you add a component, the name isn't escaped properly, or is over-escaped, or
something.
[This bug report is a transcription of a scrap of paper. I assume that if
someone tests Add Component a little bit (with &amp; and & signs etc.) they'll
figure out what the problem was that I saw.]
Gerv

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=206037#c1)• 22 years ago |
|  | |

It is true that very few (if any) of the components and products are
html\_quote()-ed in both editproducts.cgi and editcomponents.cgi.

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=206037#c2)• 22 years ago |
|  | |

Obviously, the proper templatisation of the admin pages is far preferable, but
would people be interested in a patch to the current
edit{products,components}.cgi pages to add html\_quote() calls where necessary?

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=206037#c3)• 22 years ago |
|  | |

yes. At least for 2.16.4. We ought to make them run in taint mode while we're
at it. That'll make things easier for the win32 folks.
Zippy has all the edit\*.cgi files already templatized, but we'll have do our own
templates, theirs depend on too much javascript foo, not to mention they've been
hacked to pieces to handle their project setup. So I don't know how quickly it
can be done. We might as well do the html\_quote stuff for 2.17.5 too, as a
stop-gap measure.
Several of us have known about the XSS problems in edit\*.cgi for a while now,
and we've kind of been shoving it aside because it requires admin privs to
exploit it, and we figure the admins should know better. In truth, Bugzilla is
starting to be used more and more in situations where the admin winds up being
someone who's not exactly tech savvy, and they can accidently shoot themselves
with it, so we might as well get it over with and fix it :)Group: webtools-securityWhiteboard: [wanted for 2.16.4] [wanted for 2.17.5]

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=206037#c4)• 22 years ago |
|  | |

I'll attach a patch sometime this week.Assignee: justdave → bugzilla

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a6300838_15150)• 21 years ago |

Status: NEW → ASSIGNEDSummary: Bad escaping in Add Component → Fix escaping/quoting in editXXX.cgi scripts

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=206037#c5)• 21 years ago |
|  | |

Running edit\*.cgi in taint mode is [bug#141006](/show_bug.cgi?id=141006 "RESOLVED FIXED - edit*.cgis should be run in taint mode").

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=206037#c6)• 21 years ago |
|  | |

Attached patch

[proper quoting for admin cgis,version 1](attachment.cgi?id=129127&action=diff) (obsolete)
— [Details](attachment.cgi?id=129127&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=129127)

Version 1, adding quoting to the editXXX.cgi scripts. Currently, only the
keyword description is not quoted, as that was explicit in keywords.html.tmpl.

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a6779066_15150)• 21 years ago |

[Attachment #129127](/attachment.cgi?id=129127&action=edit "proper quoting for admin cgis,version 1") -
Flags: review?

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a8505899_10297)• 21 years ago |

Target Milestone: --- → Bugzilla 2.16

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a10233897_10297)• 21 years ago |

Whiteboard: [wanted for 2.16.4] [wanted for 2.17.5] → [wanted for 2.16.5] [wanted for 2.17.6]

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=206037#c7)• 21 years ago |
|  | |

Comment on [attachment 129127](/attachment.cgi?id=129127 "proper quoting for admin cgis,version 1") [[details]](/attachment.cgi?id=129127&action=edit "proper quoting for admin cgis,version 1") [[diff]](/attachment.cgi?id=129127&action=diff "proper quoting for admin cgis,version 1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=129127)
proper quoting for admin cgis,version 1
bitrotted.
This applies to the tip with only 14 conflicts. That's actually not bad given
there's close to 150 hunks in this patch.
It's obviously trunk from 6 months ago and not 2.16 though. It looks like we
might actually be making progress on the templatization of the admin stuff on
the trunk shortly, but something along the lines of this patch is needed for
2.16.
[Attachment #129127](/attachment.cgi?id=129127&action=edit "proper quoting for admin cgis,version 1") -
Attachment is obsolete: true
[Attachment #129127](/attachment.cgi?id=129127&action=edit "proper quoting for admin cgis,version 1") -
Flags: review?

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=206037#c8)• 21 years ago |
|  | |

Are we really going to attempt all this on 2.16? Is it not better to put the
effort into making win32 work for 2.18?
Gerv

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a18366241_10297)• 21 years ago |

Whiteboard: [wanted for 2.16.5] [wanted for 2.17.6] → [wanted for 2.16.5] [wanted for 2.17.7]

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=206037#c9)• 21 years ago |
|  | |

This doesn't look like it'll happen in the next 4 days :(Whiteboard: [wanted for 2.16.5] [wanted for 2.17.7] → [wanted for 2.16.6] [wanted for 2.17.8]

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a24638590_10297)• 21 years ago |

Depends on: [235265](/show_bug.cgi?id=235265 "RESOLVED FIXED - Url-parameter XSS vulnerability in edit*.cgi")

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a24638966_10297)• 21 years ago |

Whiteboard: [wanted for 2.16.6] [wanted for 2.17.8] → [wanted for 2.16.6] [wanted for 2.18rc1]

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=206037#c10)• 21 years ago |
|  | |

OK, we need this for 2.18 whether we have admin templatization done or not. I'm
tired of sitting on this, and I want 2.18 to be clean :)Flags: blocking2.18+Flags: blocking2.16.6+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=206037#c11)• 21 years ago |
|  | |

\*\*\* [Bug 236142](/show_bug.cgi?id=236142 "RESOLVED DUPLICATE - editusers.cgi XSS vulnerability") has been marked as a duplicate of this bug. \*\*\*

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=206037#c12)• 21 years ago |
|  | |

OK, the following edit\*.cgi files also have references to %FORM that we're
trying to eliminate as part of [bug 225818](/show_bug.cgi?id=225818 "RESOLVED FIXED - %FORM, %MFORM, and %COOKIE need to go away, in favor of the CGI methods"):
editcomponents.cgi
editflagtypes.cgi
editgroups.cgi
editmilestones.cgi
editproducts.cgi
editusers.cgi
editversions.cgi
it's going to be really hard to fix the %FORM stuff without fixing this with it.
Should we go ahead and file bugs for the %FORM stuff for the above files, and
kill off the XSS stuff on the trunk via those, and just do the 2.16 branch on
this bug? Remember that on the trunk, people are expected to pick up new
features in order to get security patches, so we don't necessarily have to have
a single coherant patch for the trunk...
thoughts anyone?

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a32387533_10297)• 21 years ago |

Depends on: [236560](/show_bug.cgi?id=236560 "RESOLVED FIXED - change a login n@domain to <n@domain> removes link in 'Select user'")

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a36123483_10297)• 21 years ago |

Flags: blocking2.18-Flags: blocking2.18+Flags: blocking2.16.7+Flags: blocking2.16.6-Flags: blocking2.16.6+Whiteboard: [wanted for 2.16.6] [wanted for 2.18rc1] → [wanted for 2.16.7] [wanted for 2.18.1] [wanted for 2.19.1]

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=206037#c13)• 21 years ago |
|  | |

A question which arose during the editcomponents templatisation:
Should \*absolutely\* everything be filtered out-of-the-box?
Currently, b.m.o uses html in the descriptions of products/components/keywords
-- should these description fields be html-filtered in the Bugzilla codebase, or
is it a Bugzilla feature that the description fields for products, components,
and keywords may contain html?
I would vote that the default should be to filter everything, and a site can
customise away the filtering if they want html in these descriptions - comments?

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=206037#c14)• 21 years ago |
|  | |

> I would vote that the default should be to filter everything, and a site can
> customise away the filtering if they want html in these descriptions - comments?
This has backwards-compatibility issues. Perhaps we should note in the UI which
fields allow HTML and which do not, but I think it's perfectly reasonable to
allow admins to put HTML in some fields. After all, if an admin can edit the
templates, you have to trust them :-)
Gerv

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a42235598_10297)• 20 years ago |

Whiteboard: [wanted for 2.16.7] [wanted for 2.18.1] [wanted for 2.19.1] → [wanted for 2.16.8] [wanted for 2.18.1] [wanted for 2.20]

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a45438317_10297)• 20 years ago |

Flags: blocking2.16.7+ → blocking2.16.7-

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=206037#c15)• 20 years ago |
|  | |

I have a question about the profiles disabledtext field. This is currently
displayed without filtering when a disabled user tries to log in. Should html be
allowed in this field, or should it be filtered?

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=206037#c16)• 20 years ago |
|  | |

HTML should be allowed. After all, it's admin-controlled only, and they may want
to put in <a href="mailto:">s or a big red "Stuff Off".
Gerv

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=206037#c17)• 20 years ago |
|  | |

OK, this \*might\* actually be fixed on the trunk now, as a side effect of the
admin CGIs getting templatized...Whiteboard: [wanted for 2.16.8] [wanted for 2.18.1] [wanted for 2.20] → [wanted for 2.16.10] [wanted for 2.18.2] [wanted for 2.20]

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=206037#c18)• 20 years ago |
|  | |

(In reply to [comment #17](/show_bug.cgi?id=206037#c17 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> OK, this \*might\* actually be fixed on the trunk now, as a side effect of the
> admin CGIs getting templatized...
From what I can see, this is \*not\* fixed. At least not in editproducts.cgi.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=206037#c19)• 19 years ago |
|  | |

I think this bug is now fixed on 2.21.1. editproducts.cgi has been templatized
and (do)editparams.cgi seem safe at first glance.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=206037#c20)• 19 years ago |
|  | |

doeditparams.cgi no longer exists in 2.21.1+ and editparams.cgi has been
templatized.Whiteboard: [wanted for 2.16.10] [wanted for 2.18.2] [wanted for 2.20] → [wanted for 2.16.11] [wanted for 2.18.5] [wanted for 2.20.1][doesn't affect 2.22]

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=206037#c21)• 19 years ago |
|  | |

\*\*\* [Bug 319085](/show_bug.cgi?id=319085 "RESOLVED DUPLICATE - XSS with the \"product=\" parameter of editproducts.cgi") has been marked as a duplicate of this bug. \*\*\*

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=206037#c22)• 19 years ago |
|  | |

I would like to make things clear: as long as we allow at least \*one\* field to be unfiltered (which is the case of the description fields), we are vulnerable to XSS. html\_quote()-ing everything else in 2.16, 2.18 and 2.20 except the descriptions would not completely fix the problem. And having a whitelist of allowed tags in unfiltered fields is not an easy task, per zack's comment: [bug 319091 comment 6](/show_bug.cgi?id=319091#c6 "VERIFIED WONTFIX - disabledtext accepts HTML and thus <script>").
Look at the obsolete patch attached here. It's a 75 Kb patch, for one version of Bugzilla only! Does it really worth spending hours (days) to have a non perfect solution?
One solution could be to extend [bug 281181](/show_bug.cgi?id=281181 "RESOLVED FIXED - [SECURITY] It's way too easy to delete versions/components/milestones etc...") to all actions in edit\*.cgi pages, not only on deletion. In other words:
- accept action="new" only if action="add" has been called previously
- accept action"update" only if action="edit" has been called previously
- accept action="delete" only of action="del" has been called previously
All this by using tokens.
This way, even if you click on some untrusted URL which redirects you to one of these actions, you will be stopped before anything bad is either displayed (XSS) or inserted into the DB.
Let's discuss this now, take a decision, and fix it for good!
LpSolit
PS: please let discuss this problem here. Not everybody is in the security@ mailing-list, but I still want other reviewers in the discussion. Or open a discussion in reviewers@.

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=206037#c23)• 19 years ago |
|  | |

In [comment#13](/show_bug.cgi?id=206037#c13 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"), I voted for filtering \_EVERYTHING\_ out of the box and allowing admins to change things locally if they want to...
Extra token checks in the admins is good as well.

|  | [Joel Peshkin](/user_profile?user_id=40200) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=206037#c24)• 19 years ago |
|  | |

Actually, the token approach has some other advantages. It puts an infrastructure in place that enables us to prevent accidental submission of duplicate bugs.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=206037#c25)• 19 years ago |
|  | |

I may be being dumb, but I can't see the security issue here. LpSolit: can you give us a sample attack scenario which doesn't start with untrusted people having admin rights?
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=206037#c26)• 19 years ago |
|  | |

(In reply to [comment #25](/show_bug.cgi?id=206037#c25 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> I may be being dumb, but I can't see the security issue here. LpSolit: can you
> give us a sample attack scenario which doesn't start with untrusted people
> having admin rights?
Precisely, I cannot! Thanks gerv! I will quote what I said in [bug 319085 comment 1](/show_bug.cgi?id=319085#c1 "RESOLVED DUPLICATE - XSS with the \"product=\" parameter of editproducts.cgi"), which I marked as a dupe of this bug:
"The only field which is not filtered is the product description, and it's so by design. If an admin is stupid enough to inject malicious JS code here, then this Bugzilla installation doesn't worth to be considered."
That's the whole discussion: either we trust admins and stop complaining about XSS vulnerabilities in edit\*.cgi pages, or we don't trust them and we have to fix the problem about unfiltered fields as described in [comment 22](/show_bug.cgi?id=206037#c22 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts").
My [comment 22](/show_bug.cgi?id=206037#c22 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts") was a reaction to the discussion in security@ about the fact that we didn't fix this bug earlier. "You estimate that there are XSS holes? ok, so let's see what we have to fix" was the summary of my previous comment.
What I want from you (all of you, CC'ed guys) is a clear decision about what to do here. Allowing \*one\* field unfiltered would still allow a "stupid" admin to inject malicious JS code. So we come back to the beginning of this comment: do we trust the admins or not?
gerv, I hope this answers your question.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=206037#c27)• 19 years ago |
|  | |

Right, I see. I vote for trusting the admins, clearly.
However, that doesn't necessarily mean that we should leave bugs like this entirely unfixed, because they may prevent e.g. admins using & or < characters in their product names, which they might like to do.
Gerv

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=206037#c28)• 19 years ago |
|  | |

Yes, I think that as long as this is fixed on the tip, it's fine. If somebody can get admin access when they shouldn't be able to, that's a security bug. I mean, heck, what are we going to do next, say "Admins can delete users," and file that as a security bug? Is "root users on Linux can do 'rm -rf /'" a security bug? If you're an administrator, you can do anything. If you have DB write access, you can do anything.
The token thing is actually another bug -- [bug 26257](/show_bug.cgi?id=26257 "RESOLVED FIXED - [SECURITY] Bugzilla should prevent malicious webpages from making bugzilla users submit changes to bugs.").

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=206037#c29)• 19 years ago |
|  | |

The token thing in [bug 26257](/show_bug.cgi?id=26257 "RESOLVED FIXED - [SECURITY] Bugzilla should prevent malicious webpages from making bugzilla users submit changes to bugs.") is the main reason this is actually an issue. Yes, we should be able to trust the admins. No, we can't trust the people who might trick an admin into viewing a page with a hidden IFRAME on it that links to one fo the admin UIs with a URL that does something stupid, and the admin would never be the wiser because it happened in an IFRAME. Between introducing the tokens and filtering the HTML tags that we allow in the descriptions, I think the filtering is probably going to be far less risky to backport to the older branches we're still supporting. Many of the issues listed here are also blatant XSS holes in places we didn't intend to have HTML in the older branches (but got fixed on the tip as part of templatizing).

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=206037#c30)• 19 years ago |
|  | |

(In reply to [comment #29](/show_bug.cgi?id=206037#c29 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> the tokens and filtering the HTML tags that we allow in the descriptions, I
> think the filtering is probably going to be far less risky to backport to the
> older branches we're still supporting.
So let's enumerate these HTML tags we will allow and those we will forbid:
allow: <b>, <em>, <i>, <u>, <p>, <br>, <span>, <div>, <ul>, <li>, <ol>, <dt>, <dd>, <dl> + what else? <a> to let us point to a malicious page ;)
forbid: <script>, <form>, onload, onsubmit, onfoo, onbar, ... + ???
of course, we should take care of tags of the form <p class="" foo="bar">
I suggest a new routine Util::html\_light => [% description FILTER html\_light %]
GavinS, is that something you want to do? If yes, please only fix missing html\_quote() and implement this routine. Don't fix nits not directly related to this bug (to avoid another 75Kb patch).

|  | [Bradley Baetz (:bbaetz)](/user_profile?user_id=29274) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=206037#c31)• 19 years ago |
|  | |

Fixing this requires taint mode be enabled; its the only way to make sure that we have everything.
And since taint is runtime, and these pages aren't used that often, the first release will break something. (What it breaks was probably a security issue, though)

|  | [Alexis Sukrieh](/user_profile?user_id=174337) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=206037#c32)• 19 years ago |
|  | |

Hello, I'm maintaining Bugzilla Debian packages and am interested in having a valid patch for closing this issue on our stable package, which is version 2.16.7.
What does remain to be done for this bug to be closed for the 2.16 branch?
Thanks.

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=206037#c33)• 19 years ago |
|  | |

(In reply to [comment #32](/show_bug.cgi?id=206037#c32 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> What does remain to be done for this bug to be closed for the 2.16 branch?
Adding url\_quote() and html\_quote() appropriately to all the admin pages. [Attachment 129127](/attachment.cgi?id=129127 "proper quoting for admin cgis,version 1") [[details]](/attachment.cgi?id=129127&action=edit "proper quoting for admin cgis,version 1") [[diff]](/attachment.cgi?id=129127&action=diff "proper quoting for admin cgis,version 1") is the sort of thing (but that patch does have a few changes which are not strictly for this bug). I don't remember which version that was against.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=206037#c34)• 19 years ago |
|  | |

The support for the 2.16 branch is over. Also removing old flags.Flags: blocking2.18-Flags: blocking2.16.7-Flags: blocking2.16.6-Whiteboard: [wanted for 2.16.11] [wanted for 2.18.5] [wanted for 2.20.1][doesn't affect 2.22] → [wanted for 2.18.6] [wanted for 2.20.3][doesn't affect 2.22]Target Milestone: Bugzilla 2.16 → Bugzilla 2.18

|  | [Olav Vitters](/user_profile?user_id=26173) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a97836903_26173)• 19 years ago |

QA Contact: mattyt-bugzilla → default-qa

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=206037#c35)• 19 years ago |
|  | |

Attached patch

[patch for tip, v1](attachment.cgi?id=229914&action=diff) (obsolete)
— [Details](attachment.cgi?id=229914&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=229914)

Implement my suggestion from [comment 30](/show_bug.cgi?id=206037#c30 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"). The list of HTML elements considered as safe is:
my @safe = qw(b em i u p br);
Attributes are not accepted, as well as URLs (because <a> requires at least one attribute). This is pretty restrictive, but this allows you to do some basic formatting which I consider to be enough for component/product/classification descriptions.
This patch is for 2.23.2+.Assignee: bugzilla → LpSolit
[Attachment #229914](/attachment.cgi?id=229914&action=edit "patch for tip, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=206037#c36)• 19 years ago |
|  | |

Attached patch

[patch for tip, v1.1](attachment.cgi?id=229949&action=diff) (obsolete)
— [Details](attachment.cgi?id=229949&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=229949)

Two changes:
- Added <strong> to the whitelist;
- Filter product and component descriptions in global/choose-product.html.tmpl and reports/components.html.tmpl.
There are still two unsafe places where FILTER none is used:
1. The text for disabled user accounts;
2. The text for the new Param('announcehtml') in global/header.html.tmpl.
If it is possible to use IFRAMEs for product and component descriptions, I don't see what would prevent an attacker from using the same trick for these two fields.
[Attachment #229914](/attachment.cgi?id=229914&action=edit "patch for tip, v1") -
Attachment is obsolete: true
[Attachment #229949](/attachment.cgi?id=229949&action=edit "patch for tip, v1.1") -
Flags: review?(justdave)
[Attachment #229914](/attachment.cgi?id=229914&action=edit "patch for tip, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=206037#c37)• 19 years ago |
|  | |

Hum, I was looking at filterexceptions.pl and thought: "huh?! we have tons of unfiltered fields here which are strings entered by the user" (in opposition to integers only or hardcoded strings).
In other words: the fields I fixed in my patch are only the top of the iceberg compared to all fields which are "silently" unfiltered. Why? Because keyword and group descriptions, among many others, are unfiltered too.
Now that all pages have been templatized, I would tend to mark this bug as FIXED, retarget it to 2.22, remove the security flag, and live with it. Per my [comment 36](/show_bug.cgi?id=206037#c36 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"), as long as we allow at least one field to be completely unfiltered, an attacker could try to inject code there.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=206037#c38)• 19 years ago |
|  | |

(In reply to [comment #36](/show_bug.cgi?id=206037#c36 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> There are still two unsafe places where FILTER none is used:
> 1. The text for disabled user accounts;
Note that this point has been filed separately as [bug 319091](/show_bug.cgi?id=319091 "VERIFIED WONTFIX - disabledtext accepts HTML and thus <script>") which has been marked as WONTFIX. So this bug no longer makes sense, IMO, as there is at least one door open.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=206037#c39)• 19 years ago |
|  | |

(In reply to [comment #37](/show_bug.cgi?id=206037#c37 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> an attacker could try to inject code there.
An admin attacker?? Preventing any attacker who isn't an admin is already covered in [bug 26257](/show_bug.cgi?id=26257 "RESOLVED FIXED - [SECURITY] Bugzilla should prevent malicious webpages from making bugzilla users submit changes to bugs.").
Any pre-template Bugzilla may also have more holes of which we are unaware, which is what this bug was originally about.
However, continuing to allow this hole is basically like giving anybody with editcomponents or editkeywords the "editusers" privilege, because we basically allow them to steal users' logincookies if they so desire (via a <script>).

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=206037#c40)• 19 years ago |
|  | |

[bug 26257](/show_bug.cgi?id=26257 "RESOLVED FIXED - [SECURITY] Bugzilla should prevent malicious webpages from making bugzilla users submit changes to bugs.") is unrelated. It's about process\_bug.cgi. And no, I'm not talking about an admin attacker, see [comment 29](/show_bug.cgi?id=206037#c29 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts").

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=206037#c41)• 19 years ago |
|  | |

(In reply to [comment #40](/show_bug.cgi?id=206037#c40 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> [bug 26257](/show_bug.cgi?id=26257 "RESOLVED FIXED - [SECURITY] Bugzilla should prevent malicious webpages from making bugzilla users submit changes to bugs.") is unrelated. It's about process\_bug.cgi. And no, I'm not talking
> about an admin attacker, see [comment 29](/show_bug.cgi?id=206037#c29 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts").
I did see [comment 29](/show_bug.cgi?id=206037#c29 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"). That's exactly what I was talking about. We can fix that problem with [bug 26257](/show_bug.cgi?id=26257 "RESOLVED FIXED - [SECURITY] Bugzilla should prevent malicious webpages from making bugzilla users submit changes to bugs."), as justdave mentions in that comment.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=206037#c42)• 19 years ago |
|  | |

Attached patch

[patch for tip, v2](attachment.cgi?id=230034&action=diff) (obsolete)
— [Details](attachment.cgi?id=230034&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=230034)

Per private discussion on IRC with mkanat and justdave, we came to the conclusion that everything which had to be filtered must be filtered, meaning removing some stuff from filterexceptions.pl. Also, to avoid attacks against fields such the disabled text, [bug 281181](/show_bug.cgi?id=281181 "RESOLVED FIXED - [SECURITY] It's way too easy to delete versions/components/milestones etc...") must also be fixed to get a complete solution.
[Attachment #229949](/attachment.cgi?id=229949&action=edit "patch for tip, v1.1") -
Attachment is obsolete: true
[Attachment #230034](/attachment.cgi?id=230034&action=edit "patch for tip, v2") -
Flags: review?(justdave)
[Attachment #229949](/attachment.cgi?id=229949&action=edit "patch for tip, v1.1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a100269929_120380)• 19 years ago |

[Attachment #230034](/attachment.cgi?id=230034&action=edit "patch for tip, v2") -
Attachment description: patch, v2 → patch for tip, v2

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a100269991_120380)• 19 years ago |

[Attachment #229949](/attachment.cgi?id=229949&action=edit "patch for tip, v1.1") -
Attachment description: patch, v1.1 → patch for tip, v1.1

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=206037#c43)• 19 years ago |
|  | |

Let's first see if this patch is good before wasting time backporting it.Whiteboard: [wanted for 2.18.6] [wanted for 2.20.3][doesn't affect 2.22] → [wanted for 2.18.6] [wanted for 2.20.3][wanted for 2.22.1] patch for tip awaiting review

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=206037#c44)• 19 years ago |
|  | |

Attached patch

[unbitrotten patch for tip, v2.0.1](attachment.cgi?id=230568&action=diff) (obsolete)
— [Details](attachment.cgi?id=230568&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=230568)

What I hate with security bugs is that as you have to wait the next release before committing patches, this gives you a plently of time to see them bitrotten.
[Attachment #230034](/attachment.cgi?id=230034&action=edit "patch for tip, v2") -
Attachment is obsolete: true
[Attachment #230568](/attachment.cgi?id=230568&action=edit "unbitrotten patch for tip, v2.0.1") -
Flags: review?(justdave)
[Attachment #230034](/attachment.cgi?id=230034&action=edit "patch for tip, v2") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=206037#c45)• 18 years ago |
|  | |

Attached patch

[patch for 2.22, v1](attachment.cgi?id=231163&action=diff) (obsolete)
— [Details](attachment.cgi?id=231163&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231163)

[Attachment #231163](/attachment.cgi?id=231163&action=edit "patch for 2.22, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=206037#c46)• 18 years ago |
|  | |

Attached patch

[patch for tip, v2.1](attachment.cgi?id=231165&action=diff) (obsolete)
— [Details](attachment.cgi?id=231165&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231165)

Fix admin/groups/edit.html.tmpl (I found it while backporting it on 2.22). My patch for 2.22 already contains this fix.
[Attachment #230568](/attachment.cgi?id=230568&action=edit "unbitrotten patch for tip, v2.0.1") -
Attachment is obsolete: true
[Attachment #231165](/attachment.cgi?id=231165&action=edit "patch for tip, v2.1") -
Flags: review?(justdave)
[Attachment #230568](/attachment.cgi?id=230568&action=edit "unbitrotten patch for tip, v2.0.1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=206037#c47)• 18 years ago |
|  | |

Attached patch

[patch for 2.20, v1](attachment.cgi?id=231227&action=diff) (obsolete)
— [Details](attachment.cgi?id=231227&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231227)

[Attachment #231227](/attachment.cgi?id=231227&action=edit "patch for 2.20, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=206037#c48)• 18 years ago |
|  | |

Attached patch

[patch for tip, v2.2](attachment.cgi?id=231228&action=diff) (obsolete)
— [Details](attachment.cgi?id=231228&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231228)

I forgot to remove a "allow\_html\_content => 1" from admin/users/list.html.tmpl which is now useless. The patch for 2.20 already contains this fix.
[Attachment #231165](/attachment.cgi?id=231165&action=edit "patch for tip, v2.1") -
Attachment is obsolete: true
[Attachment #231228](/attachment.cgi?id=231228&action=edit "patch for tip, v2.2") -
Flags: review?(justdave)
[Attachment #231165](/attachment.cgi?id=231165&action=edit "patch for tip, v2.1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=206037#c49)• 18 years ago |
|  | |

Attached patch

[patch for 2.22, v1.1](attachment.cgi?id=231229&action=diff) (obsolete)
— [Details](attachment.cgi?id=231229&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231229)

Same fix as above about admin/users/list.html.tmpl.
[Attachment #231163](/attachment.cgi?id=231163&action=edit "patch for 2.22, v1") -
Attachment is obsolete: true
[Attachment #231229](/attachment.cgi?id=231229&action=edit "patch for 2.22, v1.1") -
Flags: review?(justdave)
[Attachment #231163](/attachment.cgi?id=231163&action=edit "patch for 2.22, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=206037#c50)• 18 years ago |
|  | |

Attached patch

[patch for 2.18, v1](attachment.cgi?id=231266&action=diff) (obsolete)
— [Details](attachment.cgi?id=231266&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231266)

This one was really painful to write and to test. Note that for these fixes to be really complete, we should also fix [bug 330555](/show_bug.cgi?id=330555 "RESOLVED FIXED - [SECURITY] H1, H2 and H3 are not filtered in global/header.html.tmpl").
[Attachment #231266](/attachment.cgi?id=231266&action=edit "patch for 2.18, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=206037#c51)• 18 years ago |
|  | |

Attached patch

[patch for 2.20, v1.1](attachment.cgi?id=231268&action=diff) (obsolete)
— [Details](attachment.cgi?id=231268&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231268)

Forgot to escape milestones and versions when listing all products. The patch for 2.18 already contains this fix. 2.22 and tip are not affected. So this should be the last patch. :)
[Attachment #231227](/attachment.cgi?id=231227&action=edit "patch for 2.20, v1") -
Attachment is obsolete: true
[Attachment #231268](/attachment.cgi?id=231268&action=edit "patch for 2.20, v1.1") -
Flags: review?(justdave)
[Attachment #231227](/attachment.cgi?id=231227&action=edit "patch for 2.20, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a101090366_120380)• 18 years ago |

Blocks: [346524](/show_bug.cgi?id=346524 "RESOLVED DUPLICATE - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a101090373_120380)• 18 years ago |

Blocks: [346525](/show_bug.cgi?id=346525 "RESOLVED FIXED - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a101090445_120380)• 18 years ago |

No longer blocks: [346524](/show_bug.cgi?id=346524 "RESOLVED DUPLICATE - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a101103619_120380)• 18 years ago |

Flags: blocking2.22.1?Flags: blocking2.20.3?Flags: blocking2.18.6?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a101104180_73187)• 18 years ago |

Flags: blocking2.22.1?Flags: blocking2.22.1+Flags: blocking2.20.3?Flags: blocking2.20.3+Flags: blocking2.18.6?Flags: blocking2.18.6+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=206037#c52)• 18 years ago |
|  | |

Attached patch

[patch for 2.18, v1.1](attachment.cgi?id=231347&action=diff) (obsolete)
— [Details](attachment.cgi?id=231347&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231347)

I found an unfiltered field in editgroups.cgi while doing some additional tests.
[Attachment #231266](/attachment.cgi?id=231266&action=edit "patch for 2.18, v1") -
Attachment is obsolete: true
[Attachment #231347](/attachment.cgi?id=231347&action=edit "patch for 2.18, v1.1") -
Flags: review?(justdave)
[Attachment #231266](/attachment.cgi?id=231266&action=edit "patch for 2.18, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a102652642_120380)• 18 years ago |

Blocks: [323521](/show_bug.cgi?id=323521 "RESOLVED FIXED - editkeywords.cgi and describekeywords.cgi treat description differently as regards HTML")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a104736113_120380)• 18 years ago |

Whiteboard: [wanted for 2.18.6] [wanted for 2.20.3][wanted for 2.22.1] patch for tip awaiting review → [wanted for 2.18.6] [wanted for 2.20.3][wanted for 2.22.1] patches awaiting review from justdave

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=206037#c53)• 18 years ago |
|  | |

Comment on [attachment 231228](/attachment.cgi?id=231228 "patch for tip, v2.2") [[details]](/attachment.cgi?id=231228&action=edit "patch for tip, v2.2") [[diff]](/attachment.cgi?id=231228&action=diff "patch for tip, v2.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231228)
patch for tip, v2.2
>Index: Bugzilla/Util.pm
>+sub html\_light\_quote {
>+ # List of the HTML elements considered as safe.
>+ # Note that none of them can have attributes, else
>+ # they would be escaped. <a> is not considered as safe.
<a> needs to be made safe or you'll break b.m.o (and other installations as well I'd imagine). Most of the product descriptions have links to the product's home page in them. I would suggest that we allow <a>, but only allow title and href attributes and restrict what can be linked to (well-formed URLs on common protocols only)
We don't have any on b.m.o, but I could easily imaging people using <abbr> tags in them as well. That should be fairly safe, but we'd need to allow a title attribute on that one (I think that's the right one).
Attribute filtering is going to be a pain in the butt. :( (And I'm sure you were hoping we could get away without it)
>Index: template/en/default/admin/products/edit-common.html.tmpl
> <td><textarea rows="4" cols="64" wrap="virtual" name="description">
>- [% product.description FILTER none %]</textarea>
>+ [% product.description FILTER html\_light %]</textarea>
This should probably be FILTER html rather than either FILTER none or FILTER html\_light. This is the content of a textarea, so we need to neither parse the data nor corrupt it.
Other than those two things, nothing else is jumping out at me, and I'm not finding any problems anywhere. If it weren't for the attribute thing, this would be easy to fix up. :(
[Attachment #231228](/attachment.cgi?id=231228&action=edit "patch for tip, v2.2") -
Flags: review?(justdave) → review-

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=206037#c54)• 18 years ago |
|  | |

(In reply to [comment #53](/show_bug.cgi?id=206037#c53 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> I would suggest that we allow <a>, but only
> allow title and href attributes and restrict what can be linked to
> (well-formed URLs on common protocols only)
The same list of URLs we accept for hyperlinking in comments (quoteUrls) would probably work.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=206037#c55)• 18 years ago |
|  | |

In order to allow attributes, I could write:
$text =~ s#<(($safe)(?:\s+[^<>\\]+)?)>#$chr$1$chr#go;
but it lets <a href="javascript:alert('foo')">bar</a> going through. Is that a problem?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=206037#c56)• 18 years ago |
|  | |

For the record, I think we're getting into HTML cleaning, and that's a very dangerous area. Of course, I suppose it's at least more secure than not filtering them at all.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=206037#c57)• 18 years ago |
|  | |

(In reply to [comment #55](/show_bug.cgi?id=206037#c55 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> In order to allow attributes, I could write:
>
> $text =~ s#<(($safe)(?:\s+[^<>\\]+)?)>#$chr$1$chr#go;
It's too easy to abuse this regexp, e.g.:
<b attr=">" <!-- Hidden comment //--> >
I'm not sure this is valid HTML (besides the fact that attr is not a valid attribute of <b>), but at least I could easily break the HTML page this way. I entirely agree with Max on this, it's a dangerous area. The good news is that all unrecognized tags will be escaped, and thanks to [bug 281181](/show_bug.cgi?id=281181 "RESOLVED FIXED - [SECURITY] It's way too easy to delete versions/components/milestones etc..."), it should not be possible to inject such code without the admin consent.
One alternative could be to put this regexp in a comment (i.e. rejecting all attributes, and so rejecting <a>), and write in the documentation that admins can uncomment this line if they want to allow attributes, but that this regexp could easily be abused.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=206037#c58)• 18 years ago |
|  | |

Please, please don't try and strip or sanitise HTML using regexps. The authors of the Perl FAQ even say it's a bad plan:
<http://perldoc.perl.org/perlfaq9.html#How-do-I-remove-HTML-from-a-string%3f>
They do provide a regexp if you are set on using one, but given the non-performance-critical nature of this code, can't we use HTML::Scrubber or HTML::Sanitiser?
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=206037#c59)• 18 years ago |
|  | |

(In reply to [comment #58](/show_bug.cgi?id=206037#c58 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> can't we use HTML::Scrubber or HTML::Sanitiser?
Yes, I was reading the doc for HTML::Sanitizer and it looks very promising and easy to use. The problem is, what do we do for systems which do not have this package installed?

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=206037#c60)• 18 years ago |
|  | |

> Yes, I was reading the doc for HTML::Sanitizer and it looks very promising and
> easy to use. The problem is, what do we do for systems which do not have this
> package installed?
The same thing we always do - add it to the list of required packages, and to Bundle::Bugzilla :-)
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=206037#c61)• 18 years ago |
|  | |

(In reply to [comment #60](/show_bug.cgi?id=206037#c60 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> The same thing we always do - add it to the list of required packages, and to
> Bundle::Bugzilla :-)
justdave just suggested me on IRC to make this package optional and forbid attributes unless they have this package installed. So admins complaining that their links are escaped would have to install this package.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=206037#c62)• 18 years ago |
|  | |

That sounds a bit more complicated. And who says attributes are the only problem - have you tested your regexp against the hard examples given in the FAQ question?
What's wrong with just requiring this package? Does it have nasty dependencies? Or native code? Or is it as simple as "Install HTML::Sanitizer"?
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=206037#c63)• 18 years ago |
|  | |

(In reply to [comment #62](/show_bug.cgi?id=206037#c62 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> That sounds a bit more complicated. And who says attributes are the only
> problem - have you tested your regexp against the hard examples given in the
> FAQ question?
No need. My example in [comment 57](/show_bug.cgi?id=206037#c57 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts") already broke my page. :(
> What's wrong with just requiring this package? Does it have nasty dependencies?
> Or native code? Or is it as simple as "Install HTML::Sanitizer"?
HTML::Sanitizer requires HTML::TreeBuilder, HTML::Scrubber requires HTML::Parser. So I'm now reading the doc for HTML::Scrubber as I guess HTML::Parser is more popular.
I checked on Mandriva 2006.0, and none of these HTML::Sanitizer/Scrubber packages exist in the distro. Maybe this would be a problem for admins which have to use packages from their distro only (due to some internal policy).
I don't think it's that difficult. I could do an eval {require HTML::Scrubber;}, and if it fails, then I forbid attributes using my previous patch, else pass the text to the sanitizer.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Reporter |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=206037#c64)• 18 years ago |
|  | |

Are you sure your previous patch forbids attributes in a watertight way? And are you sure that forbidding attributes makes things completely safe? For example:
<script>
// Do something nasty
</script>
has no attributes.
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=206037#c65)• 18 years ago |
|  | |

(In reply to [comment #64](/show_bug.cgi?id=206037#c64 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> Are you sure your previous patch forbids attributes in a watertight way?
Yes, because I explicitly enumerate allowed tags:
/<(p|br|strong|em|...)>/
> <script>
> // Do something nasty
> </script>
>
> has no attributes.
But <script> doesn't belong to my list of safe tags enumerated above.

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=206037#c66)• 18 years ago |
|  | |

title="..."
<blockquote>
<address>
<strong>
<strike>
<cite>
<ins>
<del>
<q>

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=206037#c67)• 18 years ago |
|  | |

i think this is a complete list.
<a><abbr><acronym><address><area><b><bdo><big><blockquote><br><caption><center><cite><code><col><colgroup><dd><del><dir><div><dfn><dl><dt><em><font><h1><h2><h3><h4><h5><h6><hr><i><img><ins><kbd><label><li><map><ol><p><pre><q><s><samp><small><span><strike><strong><sub><sup><table><tbody><td><tfoot><th><thead><tr><tt><u><ul><var>
intentionally removed are script, frames, forms, style/link/things outside body, object/applet/embed
of them, <s> was among the ones i did want to include

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=206037#c68)• 18 years ago |
|  | |

Attached patch

[patch for tip, v3](attachment.cgi?id=237791&action=diff) (obsolete)
— [Details](attachment.cgi?id=237791&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=237791)

OK, I now use HTML::Scrubber if this package is installed. This allows us to be less restrictive and accept tags such as <a href="..." title="...">foo</a> and <span class="">bar</span>. If HTML::Scrubber is not installed, we fallback on my method, i.e. not allowing attributes, which is not that bad in most cases.
[Attachment #231228](/attachment.cgi?id=231228&action=edit "patch for tip, v2.2") -
Attachment is obsolete: true
[Attachment #237791](/attachment.cgi?id=237791&action=edit "patch for tip, v3") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=206037#c69)• 18 years ago |
|  | |

Attached patch

[patch for tip, v3.1](attachment.cgi?id=237794&action=diff) (obsolete)
— [Details](attachment.cgi?id=237794&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=237794)

Let's avoid any attempt to abuse <q> and <blockquote>.
[Attachment #237791](/attachment.cgi?id=237791&action=edit "patch for tip, v3") -
Attachment is obsolete: true
[Attachment #237794](/attachment.cgi?id=237794&action=edit "patch for tip, v3.1") -
Flags: review?(justdave)
[Attachment #237791](/attachment.cgi?id=237791&action=edit "patch for tip, v3") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=206037#c70)• 18 years ago |
|  | |

My apache error log is full of this message:
Parsing of undecoded UTF-8 will give garbage when decoding entities at /usr/lib/perl5/site\_perl/5.8.7/HTML/Scrubber.pm line 322.
The 'utf8' parameter is turned on in my bz installation, but I also have data which is encoded in ISO-8859-1 (because some data come from 2.18).
Gerv, any clue how to fix this problem?

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=206037#c71)• 18 years ago |
|  | |

Attached patch

[patch for tip, v3.2](attachment.cgi?id=237862&action=diff) (obsolete)
— [Details](attachment.cgi?id=237862&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=237862)

Possible fix to suppress the warning in the web server error log. I have absolutely \*no idea\* if this hack is correct. It seems to work fine with the 'utf8' param turned on as well as turned off.
[Attachment #237862](/attachment.cgi?id=237862&action=edit "patch for tip, v3.2") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=206037#c72)• 18 years ago |
|  | |

FYI, we have to write:
if (ref($scrubber->{\_p}) eq 'HTML::Parser')
instead of:
if (exists $scrubber->{\_p} && $scrubber->{\_p}->can('utf8\_mode'))
else it fails if $scrubber->{\_p} is not an object.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=206037#c73)• 18 years ago |
|  | |

Attached patch

[patch for 2.18, v2](attachment.cgi?id=238049&action=diff) (obsolete)
— [Details](attachment.cgi?id=238049&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=238049)

HTML::Parser::utf8\_mode() only works with Perl 5.8 and higher. It seems that Perl 5.8 or higher use UTF-8 internally and so we have to pass this information to HTML::Parser. Perl 5.6.x is not affected.
[Attachment #231347](/attachment.cgi?id=231347&action=edit "patch for 2.18, v1.1") -
Attachment is obsolete: true
[Attachment #238049](/attachment.cgi?id=238049&action=edit "patch for 2.18, v2") -
Flags: review?(justdave)
[Attachment #231347](/attachment.cgi?id=231347&action=edit "patch for 2.18, v1.1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=206037#c74)• 18 years ago |
|  | |

Attached patch

[patch for tip, v4](attachment.cgi?id=238054&action=diff) (obsolete)
— [Details](attachment.cgi?id=238054&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=238054)

[Attachment #237794](/attachment.cgi?id=237794&action=edit "patch for tip, v3.1") -
Attachment is obsolete: true
[Attachment #237862](/attachment.cgi?id=237862&action=edit "patch for tip, v3.2") -
Attachment is obsolete: true
[Attachment #238054](/attachment.cgi?id=238054&action=edit "patch for tip, v4") -
Flags: review?(justdave)
[Attachment #237794](/attachment.cgi?id=237794&action=edit "patch for tip, v3.1") -
Flags: review?(justdave)
[Attachment #237862](/attachment.cgi?id=237862&action=edit "patch for tip, v3.2") -
Flags: review?(justdave)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=206037#c75)• 18 years ago |
|  | |

Comment on [attachment 238054](/attachment.cgi?id=238054 "patch for tip, v4") [[details]](/attachment.cgi?id=238054&action=edit "patch for tip, v4") [[diff]](/attachment.cgi?id=238054&action=diff "patch for tip, v4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=238054)
patch for tip, v4
>+ # Is HTML::Scrubber installed?
>+ eval { require HTML::Scrubber; };
>+
>+ if ($@) { # Package not installed.
Not sure if it's worth making it optional on the trunk. Definitely on the backports, but on the trunk I think we can just require it and be done with it.
>+ my @rules = (a => {
>+ href => qr{^(?!(?:java)?script:)}i,
The one thing that worries me about this is that there's other URL schemes other than javascript: that can be dangerous (such as data:), and there may be new schemes in the future which are. I would much rather give a list of schemes that we'll allow rather than a list of the ones we won't. It's more future-proof that way, and it's what we already do in quoteUrls (which we should be sharing the legal scheme list with - which I thought I suggested already on IRC). It also provides an obvious place in the code for people to add a scheme if someone has something they want to use on their site that it's not allowing.
[Attachment #238054](/attachment.cgi?id=238054&action=edit "patch for tip, v4") -
Flags: review?(justdave) → review-

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=206037#c76)• 18 years ago |
|  | |

Comment on [attachment 238049](/attachment.cgi?id=238049 "patch for 2.18, v2") [[details]](/attachment.cgi?id=238049&action=edit "patch for 2.18, v2") [[diff]](/attachment.cgi?id=238049&action=diff "patch for 2.18, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=238049)
patch for 2.18, v2
ok, this is only r- because of the same reason given for the tip one -- we need a uri scheme whitelist rather than a blacklist on the URI attribute scrubbers. This patch is r+ with that fixed however (but because of this being a security bug, we still need the final patch on the bug before it gets committed).
[Attachment #238049](/attachment.cgi?id=238049&action=edit "patch for 2.18, v2") -
Flags: review?(justdave) → review-

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=206037#c77)• 18 years ago |
|  | |

Comment on [attachment 231229](/attachment.cgi?id=231229 "patch for 2.22, v1.1") [[details]](/attachment.cgi?id=231229&action=edit "patch for 2.22, v1.1") [[diff]](/attachment.cgi?id=231229&action=diff "patch for 2.22, v1.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231229)
patch for 2.22, v1.1
This is r+ with the exception of the Scrubber stuff that hasn't been backported yet. Just getting it here on record so you know I've looked at it and to get it out of my review queue. :)
[Attachment #231229](/attachment.cgi?id=231229&action=edit "patch for 2.22, v1.1") -
Flags: review?(justdave) → review-

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=206037#c78)• 18 years ago |
|  | |

Comment on [attachment 231268](/attachment.cgi?id=231268 "patch for 2.20, v1.1") [[details]](/attachment.cgi?id=231268&action=edit "patch for 2.20, v1.1") [[diff]](/attachment.cgi?id=231268&action=diff "patch for 2.20, v1.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=231268)
patch for 2.20, v1.1
This is r+ with the exception of the Scrubber stuff that hasn't been backported yet. Same as the 2.22 one. :)
[Attachment #231268](/attachment.cgi?id=231268&action=edit "patch for 2.20, v1.1") -
Flags: review?(justdave) → review-

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=206037#c79)• 18 years ago |
|  | |

Attached patch

[patch for tip, v5](attachment.cgi?id=239137&action=diff) (obsolete)
— [Details](attachment.cgi?id=239137&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239137)

HTML::Scrubber is still optional as it's not available in all distro yet (Mandriva only has it since Mandriva 2007 which should be released this week).
I now use a whitelist instead of a blacklist.
[Attachment #238054](/attachment.cgi?id=238054&action=edit "patch for tip, v4") -
Attachment is obsolete: true
[Attachment #239137](/attachment.cgi?id=239137&action=edit "patch for tip, v5") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=206037#c80)• 18 years ago |
|  | |

Attached patch

[patch for 2.22, v2](attachment.cgi?id=239144&action=diff) (obsolete)
— [Details](attachment.cgi?id=239144&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239144)

Use HTML::Scrubber + whitelist
[Attachment #231229](/attachment.cgi?id=231229&action=edit "patch for 2.22, v1.1") -
Attachment is obsolete: true
[Attachment #239144](/attachment.cgi?id=239144&action=edit "patch for 2.22, v2") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=206037#c81)• 18 years ago |
|  | |

Attached patch

[patch for 2.20, v2](attachment.cgi?id=239147&action=diff) (obsolete)
— [Details](attachment.cgi?id=239147&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239147)

Use HTML::Scrubber + whitelist
[Attachment #231268](/attachment.cgi?id=231268&action=edit "patch for 2.20, v1.1") -
Attachment is obsolete: true
[Attachment #239147](/attachment.cgi?id=239147&action=edit "patch for 2.20, v2") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=206037#c82)• 18 years ago |
|  | |

Attached patch

[patch for 2.22, v2.1](attachment.cgi?id=239149&action=diff) (obsolete)
— [Details](attachment.cgi?id=239149&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239149)

I forgot to include checksetup.pl in the patch for 2.22.
[Attachment #239144](/attachment.cgi?id=239144&action=edit "patch for 2.22, v2") -
Attachment is obsolete: true
[Attachment #239149](/attachment.cgi?id=239149&action=edit "patch for 2.22, v2.1") -
Flags: review?(justdave)
[Attachment #239144](/attachment.cgi?id=239144&action=edit "patch for 2.22, v2") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=206037#c83)• 18 years ago |
|  | |

Attached patch

[patch for 2.18, v3](attachment.cgi?id=239150&action=diff) (obsolete)
— [Details](attachment.cgi?id=239150&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239150)

Use a whitelist instead of a blacklist.
[Attachment #238049](/attachment.cgi?id=238049&action=edit "patch for 2.18, v2") -
Attachment is obsolete: true
[Attachment #239150](/attachment.cgi?id=239150&action=edit "patch for 2.18, v3") -
Flags: review?(justdave)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=206037#c84)• 18 years ago |
|  | |

Comment on [attachment 239137](/attachment.cgi?id=239137 "patch for tip, v5") [[details]](/attachment.cgi?id=239137&action=edit "patch for tip, v5") [[diff]](/attachment.cgi?id=239137&action=diff "patch for tip, v5") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239137)
patch for tip, v5
OK, when I tried to run this on landfil, I got:
undef error - Can't locate auto/HTML/Parser/utf8\_mode.al in @INC (@INC contains: . /usr/lib/perl5/5.8.5/i386-linux-thread-multi /usr/lib/perl5/5.8.5
...
After a bit of research, I found this:
------8<------
2004-11-23 Gisle Aas <gisle@ActiveState.com>
Release 3.39\_92
[...]
New boolean option; $p->utf8\_mode to allow parsing of raw UTF-8.
------8<------
Landfill has 3.35
Current version is 3.55.
So it looks like we need to require HTML::Parser 3.39\_92 or higher (or just call it 3.40 to make it easy)
Unfortunately rpmforge is shipping 3.35 (that's where landfill got it)
With that little nuisance out of the way, it works as advertised. My one concern was if someone did something sneaky like &#58; (a :) it would think it was a local relative url and let it by...
I tried this:
This is a <a href="javascript&#58;alert('foo')">link</a>.
But it successfully scrubbed it, so HTML::Scrubber is smart. :)
So consider this r+ with the HTML::Parser version check added.
[Attachment #239137](/attachment.cgi?id=239137&action=edit "patch for tip, v5") -
Flags: review?(justdave) → review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=206037#c85)• 18 years ago |
|  | |

(In reply to [comment #84](/show_bug.cgi?id=206037#c84 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"))
> So consider this r+ with the HTML::Parser version check added.
Actually, with it being optional, that makes this tricky... how do we want to handle that? maybe check the HTML::Parser version before calling utf8\_mode()? Does it break if we don't call it and so the older version is buggy without it?

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=206037#c86)• 18 years ago |
|  | |

Attached patch

[patch for tip, v5.1](attachment.cgi?id=239524&action=diff) (obsolete)
— [Details](attachment.cgi?id=239524&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239524)

Make sure that HTML::Parser 3.40 is installed if running Perl 5.8+.
[Attachment #239137](/attachment.cgi?id=239137&action=edit "patch for tip, v5") -
Attachment is obsolete: true
[Attachment #239524](/attachment.cgi?id=239524&action=edit "patch for tip, v5.1") -
Flags: review?(justdave)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a105883085_10297)• 18 years ago |

[Attachment #239524](/attachment.cgi?id=239524&action=edit "patch for tip, v5.1") -
Flags: review?(justdave) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=206037#c87)• 18 years ago |
|  | |

Attached patch

[patch for 2.22, v2.2](attachment.cgi?id=239830&action=diff) (obsolete)
— [Details](attachment.cgi?id=239830&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239830)

[Attachment #239149](/attachment.cgi?id=239149&action=edit "patch for 2.22, v2.1") -
Attachment is obsolete: true
[Attachment #239830](/attachment.cgi?id=239830&action=edit "patch for 2.22, v2.2") -
Flags: review?(justdave)
[Attachment #239149](/attachment.cgi?id=239149&action=edit "patch for 2.22, v2.1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=206037#c88)• 18 years ago |
|  | |

Attached patch

[patch for 2.20, v2.1](attachment.cgi?id=239838&action=diff)
— [Details](attachment.cgi?id=239838&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239838)

grr... if + use = bad idea, even within an eval. I have to require HTML::Parser instead of using it, else Bugzilla crashes if the package has a too low version. I will have to fix the previous patches too.
[Attachment #239147](/attachment.cgi?id=239147&action=edit "patch for 2.20, v2") -
Attachment is obsolete: true
[Attachment #239838](/attachment.cgi?id=239838&action=edit "patch for 2.20, v2.1") -
Flags: review?(justdave)
[Attachment #239147](/attachment.cgi?id=239147&action=edit "patch for 2.20, v2") -
Flags: review?(justdave)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=206037#c89)• 18 years ago |
|  | |

Comment on [attachment 239830](/attachment.cgi?id=239830 "patch for 2.22, v2.2") [[details]](/attachment.cgi?id=239830&action=edit "patch for 2.22, v2.2") [[diff]](/attachment.cgi?id=239830&action=diff "patch for 2.22, v2.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239830)
patch for 2.22, v2.2
r+ based on interdiff from the previous patch for 2.22
[Attachment #239830](/attachment.cgi?id=239830&action=edit "patch for 2.22, v2.2") -
Flags: review?(justdave) → review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=206037#c90)• 18 years ago |
|  | |

Comment on [attachment 239838](/attachment.cgi?id=239838 "patch for 2.20, v2.1") [[details]](/attachment.cgi?id=239838&action=edit "patch for 2.20, v2.1") [[diff]](/attachment.cgi?id=239838&action=diff "patch for 2.20, v2.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239838)
patch for 2.20, v2.1
r+ based on interdiff from the previous 2.20 patch
[Attachment #239838](/attachment.cgi?id=239838&action=edit "patch for 2.20, v2.1") -
Flags: review?(justdave) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=206037#c91)• 18 years ago |
|  | |

Attached patch

[patch for 2.22, v2.3](attachment.cgi?id=239839&action=diff)
— [Details](attachment.cgi?id=239839&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239839)

[Attachment #239830](/attachment.cgi?id=239830&action=edit "patch for 2.22, v2.2") -
Attachment is obsolete: true
[Attachment #239839](/attachment.cgi?id=239839&action=edit "patch for 2.22, v2.3") -
Flags: review?(justdave)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=206037#c92)• 18 years ago |
|  | |

Comment on [attachment 239839](/attachment.cgi?id=239839 "patch for 2.22, v2.3") [[details]](/attachment.cgi?id=239839&action=edit "patch for 2.22, v2.3") [[diff]](/attachment.cgi?id=239839&action=diff "patch for 2.22, v2.3") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239839)
patch for 2.22, v2.3
oh yeah, the "use" thing we already talked about. :)
[Attachment #239839](/attachment.cgi?id=239839&action=edit "patch for 2.22, v2.3") -
Flags: review?(justdave) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=206037#c93)• 18 years ago |
|  | |

Attached patch

[patch for tip, v5.2](attachment.cgi?id=239840&action=diff)
— [Details](attachment.cgi?id=239840&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239840)

[Attachment #239524](/attachment.cgi?id=239524&action=edit "patch for tip, v5.1") -
Attachment is obsolete: true
[Attachment #239840](/attachment.cgi?id=239840&action=edit "patch for tip, v5.2") -
Flags: review?(justdave)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 94](/show_bug.cgi?id=206037#c94)• 18 years ago |
|  | |

Comment on [attachment 239840](/attachment.cgi?id=239840 "patch for tip, v5.2") [[details]](/attachment.cgi?id=239840&action=edit "patch for tip, v5.2") [[diff]](/attachment.cgi?id=239840&action=diff "patch for tip, v5.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239840)
patch for tip, v5.2
yup, same as the other one.
[Attachment #239840](/attachment.cgi?id=239840&action=edit "patch for tip, v5.2") -
Flags: review?(justdave) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=206037#c95)• 18 years ago |
|  | |

Attached patch

[patch for 2.18, v3.1](attachment.cgi?id=239843&action=diff)
— [Details](attachment.cgi?id=239843&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239843)

[Attachment #239150](/attachment.cgi?id=239150&action=edit "patch for 2.18, v3") -
Attachment is obsolete: true
[Attachment #239843](/attachment.cgi?id=239843&action=edit "patch for 2.18, v3.1") -
Flags: review?(justdave)
[Attachment #239150](/attachment.cgi?id=239150&action=edit "patch for 2.18, v3") -
Flags: review?(justdave)

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=206037#c96)• 18 years ago |
|  | |

Comment on [attachment 239843](/attachment.cgi?id=239843 "patch for 2.18, v3.1") [[details]](/attachment.cgi?id=239843&action=edit "patch for 2.18, v3.1") [[diff]](/attachment.cgi?id=239843&action=diff "patch for 2.18, v3.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=206037&attachment=239843)
patch for 2.18, v3.1
Had to take a little closer look at this one since we skipped 2.18 in the last round or two of patch updates. Looks good though.
[Attachment #239843](/attachment.cgi?id=239843&action=edit "patch for 2.18, v3.1") -
Flags: review?(justdave) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=206037#c97)• 18 years ago |
|  | |

yay!!Flags: approval?Flags: approval2.22?Flags: approval2.20?Flags: approval2.18?Whiteboard: [wanted for 2.18.6] [wanted for 2.20.3][wanted for 2.22.1] patches awaiting review from justdave → ready for 2.18.6] [ready for 2.20.3][ready for 2.22.1][ready for 2.23.3]

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=206037#c98)• 18 years ago |
|  | |

As far as I know, the earliest version of Bugzilla affected by this vulnerability is 2.0. 2.10 is the lowest that the Version field allows me to go, though. :-)Version: 2.17.4 → 2.10

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=206037#a107618599_10297)• 18 years ago |

Flags: approval?Flags: approval2.22?Flags: approval2.22+Flags: approval2.20?Flags: approval2.20+Flags: approval2.18?Flags: approval2.18+Flags: approval+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 99](/show_bug.cgi?id=206037#c99)• 18 years ago |
|  | |

tip:
Checking in Bugzilla/Constants.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Constants.pm,v <-- Constants.pm
new revision: 1.54; previous revision: 1.53
done
Checking in Bugzilla/Template.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Template.pm,v <-- Template.pm
new revision: 1.64; previous revision: 1.63
done
Checking in Bugzilla/Util.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Util.pm,v <-- Util.pm
new revision: 1.55; previous revision: 1.54
done
Checking in Bugzilla/Install/Requirements.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Install/Requirements.pm,v <-- Requirements.pm
new revision: 1.21; previous revision: 1.20
done
Checking in skins/standard/editusers.css;
/cvsroot/mozilla/webtools/bugzilla/skins/standard/editusers.css,v <-- editusers.css
new revision: 1.2; previous revision: 1.1
done
Checking in t/008filter.t;
/cvsroot/mozilla/webtools/bugzilla/t/008filter.t,v <-- 008filter.t
new revision: 1.26; previous revision: 1.25
done
Checking in template/en/default/filterexceptions.pl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/filterexceptions.pl,v <-- filterexceptions.pl
new revision: 1.79; previous revision: 1.78
done
Checking in template/en/default/account/prefs/permissions.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/account/prefs/permissions.html.tmpl,v <-- permissions.html.tmpl
new revision: 1.9; previous revision: 1.8
done
Checking in template/en/default/account/prefs/settings.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/account/prefs/settings.html.tmpl,v <-- settings.html.tmpl
new revision: 1.4; previous revision: 1.3
done
Checking in template/en/default/admin/table.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/table.html.tmpl,v <-- table.html.tmpl
new revision: 1.8; previous revision: 1.7
done
Checking in template/en/default/admin/classifications/del.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/del.html.tmpl,v <-- del.html.tmpl
new revision: 1.5; previous revision: 1.4
done
Checking in template/en/default/admin/classifications/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.9; previous revision: 1.8
done
Checking in template/en/default/admin/classifications/reclassify.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/reclassify.html.tmpl,v <-- reclassify.html.tmpl
new revision: 1.6; previous revision: 1.5
done
Checking in template/en/default/admin/classifications/select.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/select.html.tmpl,v <-- select.html.tmpl
new revision: 1.7; previous revision: 1.6
done
Checking in template/en/default/admin/components/confirm-delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/components/confirm-delete.html.tmpl,v <-- confirm-delete.html.tmpl
new revision: 1.7; previous revision: 1.6
done
Checking in template/en/default/admin/components/updated.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/components/updated.html.tmpl,v <-- updated.html.tmpl
new revision: 1.6; previous revision: 1.5
done
Checking in template/en/default/admin/groups/delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/delete.html.tmpl,v <-- delete.html.tmpl
new revision: 1.9; previous revision: 1.8
done
Checking in template/en/default/admin/groups/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.7; previous revision: 1.6
done
Checking in template/en/default/admin/groups/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.8; previous revision: 1.7
done
Checking in template/en/default/admin/keywords/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/keywords/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.9; previous revision: 1.8
done
Checking in template/en/default/admin/products/confirm-delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/confirm-delete.html.tmpl,v <-- confirm-delete.html.tmpl
new revision: 1.5; previous revision: 1.4
done
Checking in template/en/default/admin/products/edit-common.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/edit-common.html.tmpl,v <-- edit-common.html.tmpl
new revision: 1.6; previous revision: 1.5
done
Checking in template/en/default/admin/products/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.6; previous revision: 1.5
done
Checking in template/en/default/admin/products/updated.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/updated.html.tmpl,v <-- updated.html.tmpl
new revision: 1.4; previous revision: 1.3
done
Checking in template/en/default/admin/settings/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/settings/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.5; previous revision: 1.4
done
Checking in template/en/default/admin/users/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.5; previous revision: 1.4
done
Checking in template/en/default/admin/users/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.3; previous revision: 1.2
done
Checking in template/en/default/bug/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.85; previous revision: 1.84
done
Checking in template/en/default/bug/show-multiple.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/show-multiple.html.tmpl,v <-- show-multiple.html.tmpl
new revision: 1.33; previous revision: 1.32
done
Checking in template/en/default/bug/create/create.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/create/create.html.tmpl,v <-- create.html.tmpl
new revision: 1.67; previous revision: 1.66
done
Checking in template/en/default/global/choose-classification.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/choose-classification.html.tmpl,v <-- choose-classification.html.tmpl
new revision: 1.7; previous revision: 1.6
done
Checking in template/en/default/global/choose-product.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/choose-product.html.tmpl,v <-- choose-product.html.tmpl
new revision: 1.15; previous revision: 1.14
done
Checking in template/en/default/list/edit-multiple.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/edit-multiple.html.tmpl,v <-- edit-multiple.html.tmpl
new revision: 1.39; previous revision: 1.38
done
Checking in template/en/default/list/list-simple.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/list-simple.html.tmpl,v <-- list-simple.html.tmpl
new revision: 1.10; previous revision: 1.9
done
Checking in template/en/default/reports/components.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/components.html.tmpl,v <-- components.html.tmpl
new revision: 1.12; previous revision: 1.11
done
Checking in template/en/default/reports/keywords.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/keywords.html.tmpl,v <-- keywords.html.tmpl
new revision: 1.9; previous revision: 1.8
done
2.22:
Checking in checksetup.pl;
/cvsroot/mozilla/webtools/bugzilla/checksetup.pl,v <-- checksetup.pl
new revision: 1.469.2.15; previous revision: 1.469.2.14
done
Checking in globals.pl;
/cvsroot/mozilla/webtools/bugzilla/Attic/globals.pl,v <-- globals.pl
new revision: 1.348.2.5; previous revision: 1.348.2.4
done
Checking in Bugzilla/Constants.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Constants.pm,v <-- Constants.pm
new revision: 1.34.2.1; previous revision: 1.34
done
Checking in Bugzilla/Template.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Template.pm,v <-- Template.pm
new revision: 1.41.2.3; previous revision: 1.41.2.2
done
Checking in Bugzilla/Util.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Util.pm,v <-- Util.pm
new revision: 1.45.2.5; previous revision: 1.45.2.4
done
Checking in skins/standard/editusers.css;
/cvsroot/mozilla/webtools/bugzilla/skins/standard/editusers.css,v <-- editusers.css
new revision: 1.1.6.1; previous revision: 1.1
done
Checking in t/008filter.t;
/cvsroot/mozilla/webtools/bugzilla/t/008filter.t,v <-- 008filter.t
new revision: 1.21.2.2; previous revision: 1.21.2.1
done
Checking in template/en/default/filterexceptions.pl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/filterexceptions.pl,v <-- filterexceptions.pl
new revision: 1.61.2.1; previous revision: 1.61
done
Checking in template/en/default/account/prefs/permissions.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/account/prefs/permissions.html.tmpl,v <-- permissions.html.tmpl
new revision: 1.8.2.1; previous revision: 1.8
done
Checking in template/en/default/account/prefs/settings.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/account/prefs/settings.html.tmpl,v <-- settings.html.tmpl
new revision: 1.3.2.1; previous revision: 1.3
done
Checking in template/en/default/admin/table.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/table.html.tmpl,v <-- table.html.tmpl
new revision: 1.6.2.2; previous revision: 1.6.2.1
done
Checking in template/en/default/admin/classifications/del.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/del.html.tmpl,v <-- del.html.tmpl
new revision: 1.3.2.1; previous revision: 1.3
done
Checking in template/en/default/admin/classifications/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.6.2.1; previous revision: 1.6
done
Checking in template/en/default/admin/classifications/reclassify.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/reclassify.html.tmpl,v <-- reclassify.html.tmpl
new revision: 1.4.2.1; previous revision: 1.4
done
Checking in template/en/default/admin/classifications/select.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/select.html.tmpl,v <-- select.html.tmpl
new revision: 1.5.2.1; previous revision: 1.5
done
Checking in template/en/default/admin/components/confirm-delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/components/confirm-delete.html.tmpl,v <-- confirm-delete.html.tmpl
new revision: 1.4.2.1; previous revision: 1.4
done
Checking in template/en/default/admin/components/updated.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/components/updated.html.tmpl,v <-- updated.html.tmpl
new revision: 1.2.4.1; previous revision: 1.2
done
Checking in template/en/default/admin/groups/delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/delete.html.tmpl,v <-- delete.html.tmpl
new revision: 1.6.2.1; previous revision: 1.6
done
Checking in template/en/default/admin/groups/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.5.6.1; previous revision: 1.5
done
Checking in template/en/default/admin/groups/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.4.2.3; previous revision: 1.4.2.2
done
Checking in template/en/default/admin/keywords/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/keywords/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.7.2.1; previous revision: 1.7
done
Checking in template/en/default/admin/products/confirm-delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/confirm-delete.html.tmpl,v <-- confirm-delete.html.tmpl
new revision: 1.3.2.1; previous revision: 1.3
done
Checking in template/en/default/admin/products/edit-common.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/edit-common.html.tmpl,v <-- edit-common.html.tmpl
new revision: 1.4.2.1; previous revision: 1.4
done
Checking in template/en/default/admin/products/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.5.2.1; previous revision: 1.5
done
Checking in template/en/default/admin/products/updated.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/updated.html.tmpl,v <-- updated.html.tmpl
new revision: 1.2.2.2; previous revision: 1.2.2.1
done
Checking in template/en/default/admin/settings/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/settings/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.3.4.1; previous revision: 1.3
done
Checking in template/en/default/admin/users/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.2.2.1; previous revision: 1.2
done
Checking in template/en/default/admin/users/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.1.6.1; previous revision: 1.1
done
Checking in template/en/default/bug/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.69.2.3; previous revision: 1.69.2.2
done
Checking in template/en/default/bug/create/create.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/create/create.html.tmpl,v <-- create.html.tmpl
new revision: 1.54.2.3; previous revision: 1.54.2.2
done
Checking in template/en/default/global/choose-classification.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/choose-classification.html.tmpl,v <-- choose-classification.html.tmpl
new revision: 1.6.2.1; previous revision: 1.6
done
Checking in template/en/default/global/choose-product.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/choose-product.html.tmpl,v <-- choose-product.html.tmpl
new revision: 1.13.2.1; previous revision: 1.13
done
Checking in template/en/default/list/edit-multiple.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/edit-multiple.html.tmpl,v <-- edit-multiple.html.tmpl
new revision: 1.31.2.3; previous revision: 1.31.2.2
done
Checking in template/en/default/list/list-simple.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/list-simple.html.tmpl,v <-- list-simple.html.tmpl
new revision: 1.9.8.1; previous revision: 1.9
done
Checking in template/en/default/reports/components.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/components.html.tmpl,v <-- components.html.tmpl
new revision: 1.9.4.1; previous revision: 1.9
done
Checking in template/en/default/reports/keywords.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/keywords.html.tmpl,v <-- keywords.html.tmpl
new revision: 1.6.12.1; previous revision: 1.6
done
2.20.2:
Checking in checksetup.pl;
/cvsroot/mozilla/webtools/bugzilla/checksetup.pl,v <-- checksetup.pl
new revision: 1.412.2.25; previous revision: 1.412.2.24
done
Checking in editproducts.cgi;
/cvsroot/mozilla/webtools/bugzilla/editproducts.cgi,v <-- editproducts.cgi
new revision: 1.85.2.9; previous revision: 1.85.2.8
done
Checking in globals.pl;
/cvsroot/mozilla/webtools/bugzilla/Attic/globals.pl,v <-- globals.pl
new revision: 1.326.2.6; previous revision: 1.326.2.5
done
Checking in Bugzilla/Constants.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Constants.pm,v <-- Constants.pm
new revision: 1.25.2.3; previous revision: 1.25.2.2
done
Checking in Bugzilla/Template.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Template.pm,v <-- Template.pm
new revision: 1.26.2.5; previous revision: 1.26.2.4
done
Checking in Bugzilla/Util.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Util.pm,v <-- Util.pm
new revision: 1.28.2.5; previous revision: 1.28.2.4
done
Checking in skins/standard/editusers.css;
/cvsroot/mozilla/webtools/bugzilla/skins/standard/editusers.css,v <-- editusers.css
new revision: 1.1.4.1; previous revision: 1.1
done
Checking in t/008filter.t;
/cvsroot/mozilla/webtools/bugzilla/t/008filter.t,v <-- 008filter.t
new revision: 1.17.6.4; previous revision: 1.17.6.3
done
Checking in template/en/default/filterexceptions.pl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/filterexceptions.pl,v <-- filterexceptions.pl
new revision: 1.43.2.5; previous revision: 1.43.2.4
done
Checking in template/en/default/account/prefs/permissions.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/account/prefs/permissions.html.tmpl,v <-- permissions.html.tmpl
new revision: 1.6.10.1; previous revision: 1.6
done
Checking in template/en/default/account/prefs/settings.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/account/prefs/settings.html.tmpl,v <-- settings.html.tmpl
new revision: 1.1.4.2; previous revision: 1.1.4.1
done
Checking in template/en/default/admin/table.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/table.html.tmpl,v <-- table.html.tmpl
new revision: 1.5.2.1; previous revision: 1.5
done
Checking in template/en/default/admin/classifications/del.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/del.html.tmpl,v <-- del.html.tmpl
new revision: 1.2.6.1; previous revision: 1.2
done
Checking in template/en/default/admin/classifications/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.3.6.2; previous revision: 1.3.6.1
done
Checking in template/en/default/admin/classifications/reclassify.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/reclassify.html.tmpl,v <-- reclassify.html.tmpl
new revision: 1.2.6.1; previous revision: 1.2
done
Checking in template/en/default/admin/classifications/select.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/classifications/select.html.tmpl,v <-- select.html.tmpl
new revision: 1.3.6.1; previous revision: 1.3
done
Checking in template/en/default/admin/components/confirm-delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/components/confirm-delete.html.tmpl,v <-- confirm-delete.html.tmpl
new revision: 1.3.2.1; previous revision: 1.3
done
Checking in template/en/default/admin/components/updated.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/components/updated.html.tmpl,v <-- updated.html.tmpl
new revision: 1.2.2.1; previous revision: 1.2
done
Checking in template/en/default/admin/groups/delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/delete.html.tmpl,v <-- delete.html.tmpl
new revision: 1.4.4.2; previous revision: 1.4.4.1
done
Checking in template/en/default/admin/groups/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.5.4.1; previous revision: 1.5
done
Checking in template/en/default/admin/groups/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.1.8.3; previous revision: 1.1.8.2
done
Checking in template/en/default/admin/keywords/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/keywords/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.6.8.1; previous revision: 1.6
done
Checking in template/en/default/admin/products/confirm-delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/confirm-delete.html.tmpl,v <-- confirm-delete.html.tmpl
new revision: 1.1.2.2; previous revision: 1.1.2.1
done
Checking in template/en/default/admin/settings/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/settings/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.3.2.1; previous revision: 1.3
done
Checking in template/en/default/admin/users/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.1.4.1; previous revision: 1.1
done
Checking in template/en/default/admin/users/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.1.4.1; previous revision: 1.1
done
Checking in template/en/default/bug/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.60.2.7; previous revision: 1.60.2.6
done
Checking in template/en/default/bug/create/create.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/create/create.html.tmpl,v <-- create.html.tmpl
new revision: 1.51.2.4; previous revision: 1.51.2.3
done
Checking in template/en/default/global/choose-classification.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/choose-classification.html.tmpl,v <-- choose-classification.html.tmpl
new revision: 1.4.4.2; previous revision: 1.4.4.1
done
Checking in template/en/default/global/choose-product.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/choose-product.html.tmpl,v <-- choose-product.html.tmpl
new revision: 1.12.4.1; previous revision: 1.12
done
Checking in template/en/default/list/edit-multiple.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/edit-multiple.html.tmpl,v <-- edit-multiple.html.tmpl
new revision: 1.26.2.5; previous revision: 1.26.2.4
done
Checking in template/en/default/list/list-simple.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/list-simple.html.tmpl,v <-- list-simple.html.tmpl
new revision: 1.9.6.1; previous revision: 1.9
done
Checking in template/en/default/reports/components.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/components.html.tmpl,v <-- components.html.tmpl
new revision: 1.9.2.1; previous revision: 1.9
done
Checking in template/en/default/reports/keywords.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/keywords.html.tmpl,v <-- keywords.html.tmpl
new revision: 1.6.10.1; previous revision: 1.6
done
2.18.5:
Checking in checksetup.pl;
/cvsroot/mozilla/webtools/bugzilla/checksetup.pl,v <-- checksetup.pl
new revision: 1.289.2.36; previous revision: 1.289.2.35
done
Checking in editcomponents.cgi;
/cvsroot/mozilla/webtools/bugzilla/editcomponents.cgi,v <-- editcomponents.cgi
new revision: 1.41.2.4; previous revision: 1.41.2.3
done
Checking in editgroups.cgi;
/cvsroot/mozilla/webtools/bugzilla/editgroups.cgi,v <-- editgroups.cgi
new revision: 1.38.2.3; previous revision: 1.38.2.2
done
Checking in editmilestones.cgi;
/cvsroot/mozilla/webtools/bugzilla/editmilestones.cgi,v <-- editmilestones.cgi
new revision: 1.23.2.3; previous revision: 1.23.2.2
done
Checking in editproducts.cgi;
/cvsroot/mozilla/webtools/bugzilla/editproducts.cgi,v <-- editproducts.cgi
new revision: 1.53.2.7; previous revision: 1.53.2.6
done
Checking in editusers.cgi;
/cvsroot/mozilla/webtools/bugzilla/editusers.cgi,v <-- editusers.cgi
new revision: 1.61.2.9; previous revision: 1.61.2.8
done
Checking in editversions.cgi;
/cvsroot/mozilla/webtools/bugzilla/editversions.cgi,v <-- editversions.cgi
new revision: 1.22.2.2; previous revision: 1.22.2.1
done
Checking in globals.pl;
/cvsroot/mozilla/webtools/bugzilla/Attic/globals.pl,v <-- globals.pl
new revision: 1.270.2.13; previous revision: 1.270.2.12
done
Checking in Bugzilla/Constants.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Constants.pm,v <-- Constants.pm
new revision: 1.10.2.3; previous revision: 1.10.2.2
done
Checking in Bugzilla/Template.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Template.pm,v <-- Template.pm
new revision: 1.18.2.2; previous revision: 1.18.2.1
done
Checking in Bugzilla/Util.pm;
/cvsroot/mozilla/webtools/bugzilla/Bugzilla/Util.pm,v <-- Util.pm
new revision: 1.12.2.6; previous revision: 1.12.2.5
done
Checking in t/008filter.t;
/cvsroot/mozilla/webtools/bugzilla/t/008filter.t,v <-- 008filter.t
new revision: 1.12.2.4; previous revision: 1.12.2.3
done
Checking in template/en/default/filterexceptions.pl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/filterexceptions.pl,v <-- filterexceptions.pl
new revision: 1.16.2.3; previous revision: 1.16.2.2
done
Checking in template/en/default/account/prefs/permissions.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/account/prefs/permissions.html.tmpl,v <-- permissions.html.tmpl
new revision: 1.6.2.1; previous revision: 1.6
done
Checking in template/en/default/admin/keywords/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/keywords/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.4.2.1; previous revision: 1.4
done
Checking in template/en/default/bug/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.40.2.7; previous revision: 1.40.2.6
done
Checking in template/en/default/bug/create/create.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/create/create.html.tmpl,v <-- create.html.tmpl
new revision: 1.30.2.4; previous revision: 1.30.2.3
done
Checking in template/en/default/global/choose-product.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/choose-product.html.tmpl,v <-- choose-product.html.tmpl
new revision: 1.10.2.2; previous revision: 1.10.2.1
done
Checking in template/en/default/list/edit-multiple.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/edit-multiple.html.tmpl,v <-- edit-multiple.html.tmpl
new revision: 1.17.2.6; previous revision: 1.17.2.5
done
Checking in template/en/default/list/list-simple.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/list-simple.html.tmpl,v <-- list-simple.html.tmpl
new revision: 1.7.2.2; previous revision: 1.7.2.1
done
Checking in template/en/default/reports/components.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/components.html.tmpl,v <-- components.html.tmpl
new revision: 1.8.2.1; previous revision: 1.8
done
Checking in template/en/default/reports/keywords.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/keywords.html.tmpl,v <-- keywords.html.tmpl
new revision: 1.6.2.1; previous revision: 1.6
done
Status: ASSIGNED → RESOLVEDClosed: 18 years agoResolution: --- → FIXEDSummary: Fix escaping/quoting in editXXX.cgi scripts → [SECURITY] Fix escaping/quoting in editXXX.cgi scripts

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 100](/show_bug.cgi?id=206037#c100)• 18 years ago |
|  | |

Security Advisory has been sent, so this bug is no longer private.Group: webtools-security
You need to [log in](/show_bug.cgi?id=206037&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [GavinS](/user_profile?user_id=15150)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from secunia.com_466aef2f_20250125_205242.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.debian.org_1bd6d0c5_20250125_205248.html ===


---

[[Date Prev](msg00303.html)][[Date Next](msg00305.html)]
[[Thread Prev](msg00303.html)][[Thread Next](msg00305.html)]
[[Date Index](maillist.html#00304)]
[[Thread Index](threads.html#00304)]

# [SECURITY] [DSA 1208-1] New bugzilla packages fix several vulnerabilities

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1208-1] New bugzilla packages fix several vulnerabilities
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sat, 11 Nov 2006 15:08:27 +0100
* *Message-id*: <[[🔎]](/msgid-search/20061111140827.GA3549%40galadriel.inutil.org) [20061111140827.GA3549@galadriel.inutil.org](msg00304.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA 1208-1                    security@debian.org
<http://www.debian.org/security/>                         Moritz Muehlenhoff
November 11th, 2006                     <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : bugzilla
Vulnerability  : several
Problem-Type   : remote
Debian-specific: no
CVE ID         : CVE-2005-4534 CVE-2006-5453
Debian Bug     : 395094 329387

Several remote vulnerabilities have been discovered in the Bugzilla
bug tracking system, which may lead to the execution of arbitrary code.
The Common Vulnerabilities and Exposures project identifies the following
problems:

CVE-2005-4534

    Javier Fernández-Sanguino Peña discovered that insecure temporary
    file usage may lead to denial of service through a symlink attack.

CVE-2006-5453

    Several cross-site scripting vulnerabilities may lead to injection
    of arbitrary web script code.

For the stable distribution (sarge) these problems have been fixed in
version 2.16.7-7sarge2.

For the upcoming stable distribution (etch) these problems have been
fixed in version 2.22.1-1.

For the unstable distribution (sid) these problems have been fixed in
version 2.22.1-1.

We recommend that you upgrade your bugzilla packages.

Upgrade Instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 3.1 alias sarge
- --------------------------------

  Source archives:

    <http://security.debian.org/pool/updates/main/b/bugzilla/bugzilla_2.16.7-7sarge2.dsc>
      Size/MD5 checksum:      672 94d9f5a0686916545b0a2331cf701e9b
    <http://security.debian.org/pool/updates/main/b/bugzilla/bugzilla_2.16.7-7sarge2.diff.gz>
      Size/MD5 checksum:    58117 4b7c3e3f2dd3a25c85cc422431915355
    <http://security.debian.org/pool/updates/main/b/bugzilla/bugzilla_2.16.7.orig.tar.gz>
      Size/MD5 checksum:  1378708 b3f3fcac3103c139a218e7316a9bbcc7

  Architecture independent components:

    <http://security.debian.org/pool/updates/main/b/bugzilla/bugzilla-doc_2.16.7-7sarge2_all.deb>
      Size/MD5 checksum:   572342 353444279ff5ea591fdc70aaf18fa690
    <http://security.debian.org/pool/updates/main/b/bugzilla/bugzilla_2.16.7-7sarge2_all.deb>
      Size/MD5 checksum:   368594 93e7597ee670fe72b8a68f796a5f4b4d

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)

iD8DBQFFVdkNXm3vHE4uyloRAvVSAKDnorfUdv22vwTwDlGhqCZUzcaaTwCgh8Xy
YN0cShqNsRoiWxhkXOZ8rh0=
=88Op
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_11b672c6_20250125_205244.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Bugzilla: Multiple Vulnerabilities — GLSA **200611-04**

Bugzilla is vulnerable to cross-site scripting, script injection, and
request forgery.

### Affected packages

| Package | **www-apps/bugzilla** on all architectures |
| --- | --- |
| Affected versions | < **2.18.6** |
| Unaffected versions | >= **2.18.6** |

### Background

Bugzilla is a bug tracking system used to allow developers to more
easily track outstanding bugs in products.

### Description

The vulnerabilities identified in Bugzilla are as follows:

* Frederic Buclin and Gervase Markham discovered that input passed to
  various fields throughout Bugzilla were not properly sanitized before
  being sent back to users (CVE-2006-5453).
* Frederic Buclin and Josh "timeless" Soref discovered a bug when
  viewing attachments in diff mode that allows users not of the
  "insidergroup" to read attachment descriptions. Additionally, it was
  discovered that the "deadline" field is visible to users who do not
  belong to the "timetrackinggroup" when bugs are exported to XML
  (CVE-2006-5454).
* Gavin Shelley reported that Bugzilla allows certain operations to
  be performed via HTTP GET and HTTP POST requests without verifying
  those requests properly (CVE-2006-5455).
* Max Kanat-Alexander discovered that input passed to
  showdependencygraph.cgi is not properly sanitized before being returned
  to users (CVE-2006-5453).

### Impact

An attacker could inject scripts into the content loaded by a user's
browser in order to have those scripts executed in a user's browser in
the context of the site currently being viewed. This could include
gaining access to privileged session information for the site being
viewed. Additionally, a user could forge an HTTP request in order to
create, modify, or delete bugs within a Bugzilla instance. Lastly, an
unauthorized user could view sensitive information about bugs or bug
attachments.

### Workaround

There is no known workaround at this time.

### Resolution

All Bugzilla users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/bugzilla-2.18.6"
```
### References

* [CVE-2006-5453](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5453)
* [CVE-2006-5454](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5454)
* [CVE-2006-5455](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5455)

**Release date**

November 09, 2006

**Latest revision**

November 09, 2006: 01

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [151563](https://bugs.gentoo.org/show_bug.cgi?id=151563)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.bugzilla.org_0bde4b1c_20250125_205247.html ===

[![Bugzilla Logo](/assets/img/logo-header.svg)
Bugzilla](/)
Show Nav Menu

* [About](/about/ "Find out more about Bugzilla.")
  [Project](/about/ "Find out more about Bugzilla.")
  [Features](/about/features.html)
  [Who Uses Bugzilla?](/about/installation-list.html "Hundreds of companies and organizations trust Bugzilla.")
  [Meet the Team](/about/developers "Meet the Bugzilla team.")
  [Zarro Boogs Corporation](/about/zarroboogs.html "Find out about the company managing the Bugzilla Project.")
* [News](/blog/ "Get the low down on what's happening with the project.")
  [Blog](/blog/ "Bugzilla Blog")
  [Release Information](/releases/ "Information on current and previous releases.")
  [Security Advisories](/security/ "Important updates regarding Bugzilla security.")
  [Planet Bugzilla](http://planet.bugzilla.org "View the status of the Bugzilla project.")
* [Download](/download/ "Download Bugzilla")
* [Documentation](/docs/ "Bugzilla Documentation")
* [Support](/support/ "Find out where to get more information and help.")
* [Contribute](/contributing/ "Ways you can help Bugzilla")
  [How to?](/contributing/ "Ways you can help Bugzilla")
  [Report a Bug](/contributing/reporting_bugs "Let us know if there is an error in Bugzilla.")
  [Donate](/donate "Donate to Bugzilla, and see how your money is used.")
  [Wiki](https://wiki.mozilla.org/Bugzilla%3AHome "Collaboratively updated information about Bugzilla.")

Search bugzilla.org

1. [Security Advisories](/security/)
2. 2.18.5, 2.20.2, 2.22, and 2.23.2 Security Advisory

# 2.18.5, 2.20.2, 2.22, and 2.23.2 Security Advisory

Sunday, Oct 15th, 2006
```

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* Sometimes the information put into the <h1> and <h2> tags in Bugzilla
  was not properly escaped, leading to a possible XSS vulnerability.

* Bugzilla administrators were allowed to put raw, unfiltered HTML into
  many fields in Bugzilla, leading to a possible XSS vulnerability.
  Now, the HTML allowed in those fields is limited.

* attachment.cgi could leak the names of private attachments

* The "deadline" field was visible in the XML format of a bug, even to
  users who were not a member of the "timetrackinggroup."

* A malicious user could pass a URL to an admin, and make the admin
  delete or change something that he had not intended to delete or
  change.

* It is possible to inject arbitrary HTML into the showdependencygraph.cgi
  page, allowing for a cross-site scripting attack.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Cross-Site Scripting
Affected:    2.15 and above
Description: Bugzilla sometimes displays admin-provided data in page
             headers (meaning the <h1> and <h2> HTML tags of a page).
             Sometimes, this data was not properly escaped, leading to
             the possibility of a Cross-Site Scripting vulnerability.
             For the most part, this was only exploitable by
             administrators, and so is not of critical severity.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=330555

Class:       Cross-Site Scripting
Affected:    2.0 and above
Description: Bugzilla allows administrators to put HTML in the
             descriptions of products, components, and other items. It
             also allows HTML in certain other fields. Before the
             most recent releases of Bugzilla, this HTML was completely
             unfiltered. These fields are only editable by
             certain users, who are specified by the admin. This makes
             this vulnerability less severe. However, these users could
             use this exploit to perform Cross-Site Scripting attacks
             on nearly all users of a particular Bugzilla (including
             users with higher permission levels than themselves).

             Bugzilla now allows only certain HTML tags in those fields,
             protecting users from a Cross-Site Scripting attack.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=206037

Class:       Information Leak
Affected:    2.17 and above
Description: When viewing an attachment in "Diff" mode, a user who is
             not in the "insidergroup" (the group required to view
             private attachments) can read the one-line descriptions
             of all attachments, even "private" attachments.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=346086

Class:       Information Leak
Affected:    2.19.2 and above
Description: Bugzilla has a "deadline" field, which is usually only
             visible to people in the "timetrackinggroup" group.
             However, it was exposed in the XML format of a bug to all
             users.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=346564

Class:       Security Enhancement
Affected:    2.0 and above
Description: Bugzilla updates, deletes, and creates data through a
             web interface. Administrators update things like user
             accounts through this interface. All of these pages accept
             URL variables in both GET and POST formats.

             A malicious user could craft a URL that would edit a user
             (or any other admin-protected item), and then using a
             service like TinyURL, could obscure the URL so that an
             administrator couldn't tell what it was. Then, getting the
             administrator to click on that URL, the action would be
             performed, against the administrator's will.

             This is now prevented. Bugzilla will only accept changes
             on administrative pages if they come from Bugzilla's own
             forms. That is, you have to use the form to make changes--
             you now cannot just click a URL and accidentally make an
             administrative change to Bugzilla.

             Although technically this affects all versions of Bugzilla,
             it has only been fixed on our most recent release (2.22.1
             and our latest development snapshot, 2.23.3), because the
             fix was too invasive to backport further. Administrators
             of previous versions of Bugzilla should only click on URLs
             from users that they fully trust.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=281181

Class:       Cross-Site Scripting
Affected:    2.15 and above
Description: showdependencygraph.cgi is a script that allows you to display
             a graph of how bugs are related. There is a cross-site
             scripting vulnerability in this script that allows for arbitrary
             HTML injection. The user would have to follow a malicious URL
             in order to trigger the attack--it is not possible for another
             user to otherwise inject HTML into the page for the current
             user.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=355728

Vulnerability Solutions
=======================

The fix for these issues is included in the
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issues at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  https://www.bugzilla.org/download/

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix this
issue:

Issue 1 Reporter: Frédéric Buclin
Issue 1 Fixed by: Frédéric Buclin, Gavin Shelley, Max Kanat-Alexander, Dave Miller

Issue 2 Reporter: Gervase Markham
Issue 2 Fixed by: Gavin Shelley, Dave Miller, Gervase Markham, Frédéric Buclin

Issue 3 Reporter: Frédéric Buclin
Issue 3 Fixed by: Frédéric Buclin, Dave Miller, Gervase Markham, Myk Melez

Issue 4 Reporter: Josh "timeless" Soref
Issue 4 Fixed by: Frédéric Buclin, Max Kanat-Alexander, Olav Vitters

Issue 5 Reporter: Gavin Shelley
Issue 5 Fixed by: Frédéric Buclin, Dave Miller, Max Kanat-Alexander

Issue 6 Reporter: Max Kanat-Alexander
Issue 6 Fixed by: Max Kanat-Alexander, Frédéric Buclin, Dave Miller

General information about the Bugzilla bug-tracking system can be found
at:

  https://www.bugzilla.org/

Comments and follow-ups can be directed to the support-bugzilla mailing list.
https://www.bugzilla.org/support/ has directions for accessing this forum.

```

* [GitHub
  GitHub](https://github.com/bugzilla "GitHub")
* [X](https://x.com/%40bugzilla "X")
* [Mastodon
  Mastodon](https://techhub.social/%40bugzilla "Mastodon")
* [Bluesky](https://bsky.app/profile/bugzilla.org "Bluesky")
* [Facebook
  Facebook](https://www.facebook.com/BugzillaProject "Facebook")
* [LinkedIn
  LinkedIn](https://www.linkedin.com/company/bugzilla-project "LinkedIn")
* [IRC
  IRC on Libera.Chat](https://web.libera.chat/#/#bugzilla "IRC on Libera.Chat")
* [Discord
  Discord](https://discord.gg/ZhN6uBA "Discord")
* [Matrix
  Matrix](https://matrix.to/#/#bugzilla:mozilla.org "Matrix")
* [YouTube
  YouTube](https://www.youtube.com/%40bugzillaproject "YouTube")
* [Twitch
  Twitch](https://twitch.tv/bugzillaproject "Twitch")

---

Copyright © 1998-2024 bugzilla.org contributors
Creative Commons Attribution-ShareAlike 2.0[Creative CommonsAttributionShareAlike](https://creativecommons.org/licenses/by-sa/2.0/)



=== Content from bugzilla.mozilla.org_dc2c5dea_20250125_205257.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/330555)
* [XML](/show_bug.cgi?ctype=xml&id=330555)

Closed
[Bug 330555](/show_bug.cgi?id=330555)

Opened 19 years ago
Closed 18 years ago

# [SECURITY] H1, H2 and H3 are not filtered in global/header.html.tmpl

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] H1, H2 and H3 are not filtered in global/header.html.tmpl

## Categories

### (Bugzilla :: Bugzilla-General, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Bugzilla-General#Bugzilla-General)

Bugzilla-General
▾

Bugzilla :: Bugzilla-General
Anything that doesn't fit in the other components, or spans multiple components.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Bugzilla-General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

2.15

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

major

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 2.18

## People

### (Reporter: LpSolit, Assigned: LpSolit)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[317126](/show_bug.cgi?id=317126 "RESOLVED FIXED - Queries with some special characters are double-escaped"), [346525](/show_bug.cgi?id=346525 "RESOLVED FIXED - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

[321556](/show_bug.cgi?id=321556 "RESOLVED FIXED - Prepare Bugzilla to ship with at least 2 skins")

[330290](/show_bug.cgi?id=330290 "RESOLVED FIXED - Edit users should include user's real name and address in title")

Dependency [tree](/showdependencytree.cgi?id=330555&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=330555)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [ready for 2.18.6][ready for 2.20.3][ready for 2.22.1][ready for 2.23.3])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[ready for 2.18.6][ready for 2.20.3][ready for 2.22.1][ready for 2.23.3]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [justdave](/user_profile?user_id=10297) | [approval](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.22](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.22 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking2.22.1](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking2.22.1 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.20](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.20 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking2.20.3](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking2.20.3 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval2.18](#c0 "18 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval2.18 | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | [blocking2.18.6](#c0 "18 years ago") | + |
| --- | --- | --- |
| [mkanat](/user_profile?user_id=73187) | blocking2.18.6 | + |
| --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | approval4.4 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [patch for tip, v1](/attachment.cgi?id=231308)  [18 years ago](#c9)  [Frédéric Buclin](/user_profile?user_id=120380)   7.90 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=231308&action=edit) | [Diff](/attachment.cgi?id=231308&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=330555&attachment=231308) |
| --- | --- | --- |
| [patch for 2.22, v1](/attachment.cgi?id=231318)  [18 years ago](#c10)  [Frédéric Buclin](/user_profile?user_id=120380)   7.91 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=231318&action=edit) | [Diff](/attachment.cgi?id=231318&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=330555&attachment=231318) |
| [patch for 2.20, v1](/attachment.cgi?id=231335)  [18 years ago](#c11)  [Frédéric Buclin](/user_profile?user_id=120380)   10.13 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=231335&action=edit) | [Diff](/attachment.cgi?id=231335&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=330555&attachment=231335) |
| [patch for 2.18, v1](/attachment.cgi?id=231345)  [18 years ago](#c12)  [Frédéric Buclin](/user_profile?user_id=120380)   7.56 KB, patch | justdave : [review+](#c0 "18 years ago") | [Details](/attachment.cgi?id=231345&action=edit) | [Diff](/attachment.cgi?id=231345&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=330555&attachment=231345) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=330555#c0)• 19 years ago |
|  | |

[% IF !h1.defined %][% h1 = title %][% END %]
<title>[% title FILTER html %]</title>
[% IF h1 %]
<h1>[% h1 %]</h1>
[% END %]
If h1 is not defined, which is the case on most pages, h1 has the same content as title, but only title is filtered, h1 is not (see above).
I was reviewing [bug 330290](/show_bug.cgi?id=330290 "RESOLVED FIXED - Edit users should include user's real name and address in title") and I wondered why only part of the user identity was displayed in h1 while it was correctly displayed in the title. The reason was because we had:
<title>Edit user Guest 4 &lt;guest4&#64;bugzilla.org&gt;</title>
<div id="header">
<h1>Edit user Guest 4 <guest4@bugzilla.org></h1>
</div>
"<" and ">" have not been filtered in h1 and Firefox ignored this "tag". If I wrote "script ..." instead of guest4, the JS code would have been executed.

|  | [GavinS](/user_profile?user_id=15150) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=330555#c1)• 19 years ago |
|  | |

Also discussed in [bug#317126](/show_bug.cgi?id=317126 "RESOLVED FIXED - Queries with some special characters are double-escaped")
Need to firm up the interface to headers.html.tmpl. Either callers filter all params, or headers template filters all, or we don't default <h1>, and require it from callers
Changes will be required in a few callers.

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=330555#c2)• 19 years ago |
|  | |

That makes this a sec bug.Group: webtools-security

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=330555#c3)• 19 years ago |
|  | |

For security reasons, it's safer if global/headers.html.tmpl filters titles and H1-H3 itself.

|  | [Teemu Mannermaa (:wicked)](/user_profile?user_id=1064) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=330555#c4)• 19 years ago |
|  | |

Hmm, can title tag contain HTML formatting? I thought it was pure text.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=330555#c5)• 19 years ago |
|  | |

(In reply to [comment #4](/show_bug.cgi?id=330555#c4 "RESOLVED FIXED - [SECURITY] H1, H2 and H3 are not filtered in global/header.html.tmpl"))
> Hmm, can title tag contain HTML formatting? I thought it was pure text.
>
It is, that's why <title> must be filtered in all cases. Consequently, we have no other choices than filtering H1-H3 too. And to be sure this is done, we should do it in a centralized way.

|  | [Teemu Mannermaa (:wicked)](/user_profile?user_id=1064) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=330555#c6)• 19 years ago |
|  | |

(In reply to [comment #5](/show_bug.cgi?id=330555#c5 "RESOLVED FIXED - [SECURITY] H1, H2 and H3 are not filtered in global/header.html.tmpl"))
> (In reply to [comment #4](/show_bug.cgi?id=330555#c4 "RESOLVED FIXED - [SECURITY] H1, H2 and H3 are not filtered in global/header.html.tmpl"))
> > Hmm, can title tag contain HTML formatting? I thought it was pure text.
> It is, that's why <title> must be filtered in all cases. Consequently, we have
Then why some templates are trying to output HTML to title anyway? Like your patch in [attachment 216459](/attachment.cgi?id=216459 "patch, v2") [[details]](/attachment.cgi?id=216459&action=edit "patch, v2") [[diff]](/attachment.cgi?id=216459&action=diff "patch, v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=44595&attachment=216459) on [bug 44595](/show_bug.cgi?id=44595 "RESOLVED FIXED - interface for administrator to delete attachments"). Hmm, maybe they are trying to provide value for h1 (that I think can have some markup, but I'm not sure). That's just stupid. They should use h1 specifically and provide two different values (one for title and one for h1).
This begins to sound like I want title and h1 decoupled on the header template. :)

|  | [Marc Schumann [:Wurblzap]](/user_profile?user_id=84162) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a2934756_84162)• 19 years ago |

Blocks: [321556](/show_bug.cgi?id=321556 "RESOLVED FIXED - Prepare Bugzilla to ship with at least 2 skins")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a11797664_120380)• 18 years ago |

Target Milestone: Bugzilla 2.20 → Bugzilla 2.18Version: 2.20 → 2.18.5

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=330555#c7)• 18 years ago |
|  | |

I just did a quick audit of some of our templates on tip, and I realized that most titles and H1-H3 strings were filtered in templates themselves, before being passed to header.html.tmpl. In [comment 3](/show_bug.cgi?id=330555#c3 "RESOLVED FIXED - [SECURITY] H1, H2 and H3 are not filtered in global/header.html.tmpl") and even today on IRC, I suggested to change this behavior and do the filtering in header.html.tmpl. But now I change my mind for the following reasons:
1. Looks like > 95% of all templates pass filtered strings. So fixing the remaining 5% is much less invasive and prone to regressions.
2. If we decided to pass unfiltered strings to header.html.tmpl, filterexceptions.pl (and 008filter.t) would complain that these fields are... unfiltered, forcing us to add boring "FILTER none" almost everywhere, or even worse: forcing us to add these fields in filterexceptions.pl, which I consider as a potentially security problem, as 008filter.t wouldn't complain anymore if we forget to filter a directive elsewhere in the template. So this last suggestion is not acceptable.
And we can as well write "FILTER html" instead of "FILTER none" directly in templates. The number of characters is exactly the same! ;)
I want this bug fixed asap, in addition to [bug 206037](/show_bug.cgi?id=206037 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"). This problem is even more visible on 2.18 and 2.20, where title filtering is almost inexistant.Assignee: general → LpSolit

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a11799279_120380)• 18 years ago |

Status: NEW → ASSIGNED

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a11834339_120380)• 18 years ago |

Blocks: [346524](/show_bug.cgi?id=346524 "RESOLVED DUPLICATE - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a11834346_120380)• 18 years ago |

Blocks: [346525](/show_bug.cgi?id=346525 "RESOLVED FIXED - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a11834418_120380)• 18 years ago |

No longer blocks: [346524](/show_bug.cgi?id=346524 "RESOLVED DUPLICATE - Security Advisory for 2.18.6, 2.20.3, 2.22.1, and 2.23.3")

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a11847606_120380)• 18 years ago |

Flags: blocking2.22.1?Flags: blocking2.20.3?Flags: blocking2.18.6?

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=330555#c8)• 18 years ago |
|  | |

The filter test wouldn't complain that a variable is unfiltered inside of a PROCESS statement, or inside of a SET statement, right?
I think the only reason to require callers to filter h1/title/h2 is if we \*want\* to have HTML code in them. Otherwise, if they should never have HTML, seems like they should be filtered inside header.html.tmpl.
I see at least in our 2.20 example that this is exploitable on an admin page, so that makes this a valid sec. blocker.Flags: blocking2.22.1?Flags: blocking2.22.1+Flags: blocking2.20.3?Flags: blocking2.20.3+Flags: blocking2.18.6?Flags: blocking2.18.6+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=330555#c9)• 18 years ago |
|  | |

Attached patch

[patch for tip, v1](attachment.cgi?id=231308&action=diff)
— [Details](attachment.cgi?id=231308&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=330555&attachment=231308)

[Attachment #231308](/attachment.cgi?id=231308&action=edit "patch for tip, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=330555#c10)• 18 years ago |
|  | |

Attached patch

[patch for 2.22, v1](attachment.cgi?id=231318&action=diff)
— [Details](attachment.cgi?id=231318&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=330555&attachment=231318)

[Attachment #231318](/attachment.cgi?id=231318&action=edit "patch for 2.22, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=330555#c11)• 18 years ago |
|  | |

Attached patch

[patch for 2.20, v1](attachment.cgi?id=231335&action=diff)
— [Details](attachment.cgi?id=231335&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=330555&attachment=231335)

[Attachment #231335](/attachment.cgi?id=231335&action=edit "patch for 2.20, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=330555#c12)• 18 years ago |
|  | |

Attached patch

[patch for 2.18, v1](attachment.cgi?id=231345&action=diff)
— [Details](attachment.cgi?id=231345&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=330555&attachment=231345)

For 2.18, I forced PutHeader() in CGI.pl to filter title, h1 and h2 itself for not yet templatized pages. This is way much less invasive than fixing all these edit\*.cgi scripts. And in opposition to 2.20 and newer, URLs are never passed to headers so it's safe to do it here and doesn't break current behavior.
[Attachment #231345](/attachment.cgi?id=231345&action=edit "patch for 2.18, v1") -
Flags: review?(justdave)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a13473666_120380)• 18 years ago |

Blocks: [317126](/show_bug.cgi?id=317126 "RESOLVED FIXED - Queries with some special characters are double-escaped")

|  | [Marc Schumann [:Wurblzap]](/user_profile?user_id=84162) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=330555#c13)• 18 years ago |
|  | |

This bug is scheduled for the same release as [bug 321556](/show_bug.cgi?id=321556 "RESOLVED FIXED - Prepare Bugzilla to ship with at least 2 skins"), but they depend on each other. As this is a sec bug, and as such needs to go in more or less at time of release, leaving no time for [bug 321556](/show_bug.cgi?id=321556 "RESOLVED FIXED - Prepare Bugzilla to ship with at least 2 skins"), it'd make sense to reverse the dependency--but this would hit this bug's tip patch with bad rottage. Shall we reverse the dependency anyway?

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=330555#c14)• 18 years ago |
|  | |

Marc, please no. We would like to start QA tests next week, assuming all security patches will be reviewed meanwhile. Anyway, I won't prevent you from working on your skin patch. If yours is checked in before this one is reviewed, I will unbitrot it (I have no other choices anyway). So let's keep the dependencies unchanged, but feel free to work on your patch.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a15480149_120380)• 18 years ago |

Whiteboard: patches awaiting review from justdave

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=330555#c15)• 18 years ago |
|  | |

Comment on [attachment 231308](/attachment.cgi?id=231308 "patch for tip, v1") [[details]](/attachment.cgi?id=231308&action=edit "patch for tip, v1") [[diff]](/attachment.cgi?id=231308&action=diff "patch for tip, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=330555&attachment=231308)
patch for tip, v1
This looks good as is. Although there isn't a dependency set, I seem to recall someone saying this depended on the patch on [bug 206037](/show_bug.cgi?id=206037 "RESOLVED FIXED - [SECURITY] Fix escaping/quoting in editXXX.cgi scripts"), and I had both that patch and this one applied in tandem for review purposes.
[Attachment #231308](/attachment.cgi?id=231308&action=edit "patch for tip, v1") -
Flags: review?(justdave) → review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a16218858_10297)• 18 years ago |

[Attachment #231318](/attachment.cgi?id=231318&action=edit "patch for 2.22, v1") -
Flags: review?(justdave) → review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a16219480_10297)• 18 years ago |

[Attachment #231335](/attachment.cgi?id=231335&action=edit "patch for 2.20, v1") -
Flags: review?(justdave) → review+

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a16220281_10297)• 18 years ago |

[Attachment #231345](/attachment.cgi?id=231345&action=edit "patch for 2.18, v1") -
Flags: review?(justdave) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a16225244_120380)• 18 years ago |

Flags: approval?Flags: approval2.22?Flags: approval2.20?Flags: approval2.18?Whiteboard: patches awaiting review from justdave → [ready for 2.18.6][ready for 2.20.3][ready for 2.22.1][ready for 2.23.3]

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=330555#c16)• 18 years ago |
|  | |

As nearly as I can tell from looking at bonsai, every version of Bugzilla that's ever had templates was affected by this bug, meaning it goes back to about 2.15. So I'm setting the version field appropriately. (This stuff is needed for the security advisory.)Version: 2.18.5 → 2.15

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=330555#a18362573_10297)• 18 years ago |

Flags: approval?Flags: approval2.22?Flags: approval2.22+Flags: approval2.20?Flags: approval2.20+Flags: approval2.18?Flags: approval2.18+Flags: approval+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=330555#c17)• 18 years ago |
|  | |

tip:
Checking in template/en/default/filterexceptions.pl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/filterexceptions.pl,v <-- filterexceptions.pl
new revision: 1.80; previous revision: 1.79
done
Checking in template/en/default/admin/flag-type/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/flag-type/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.21; previous revision: 1.20
done
Checking in template/en/default/admin/groups/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.8; previous revision: 1.7
done
Checking in template/en/default/admin/groups/remove.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/remove.html.tmpl,v <-- remove.html.tmpl
new revision: 1.2; previous revision: 1.1
done
Checking in template/en/default/admin/users/confirm-delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/confirm-delete.html.tmpl,v <-- confirm-delete.html.tmpl
new revision: 1.13; previous revision: 1.12
done
Checking in template/en/default/admin/users/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.6; previous revision: 1.5
done
Checking in template/en/default/bug/show.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/show.html.tmpl,v <-- show.html.tmpl
new revision: 1.15; previous revision: 1.14
done
Checking in template/en/default/bug/create/create.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/create/create.html.tmpl,v <-- create.html.tmpl
new revision: 1.68; previous revision: 1.67
done
Checking in template/en/default/global/header.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/header.html.tmpl,v <-- header.html.tmpl
new revision: 1.47; previous revision: 1.46
done
Checking in template/en/default/reports/duplicates.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/duplicates.html.tmpl,v <-- duplicates.html.tmpl
new revision: 1.17; previous revision: 1.16
done
2.22:
Checking in template/en/default/filterexceptions.pl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/filterexceptions.pl,v <-- filterexceptions.pl
new revision: 1.61.2.2; previous revision: 1.61.2.1
done
Checking in template/en/default/admin/flag-type/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/flag-type/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.14.2.2; previous revision: 1.14.2.1
done
Checking in template/en/default/admin/groups/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.5.6.2; previous revision: 1.5.6.1
done
Checking in template/en/default/admin/groups/remove.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/remove.html.tmpl,v <-- remove.html.tmpl
new revision: 1.1.10.1; previous revision: 1.1
done
Checking in template/en/default/admin/users/confirm-delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/confirm-delete.html.tmpl,v <-- confirm-delete.html.tmpl
new revision: 1.7.2.3; previous revision: 1.7.2.2
done
Checking in template/en/default/admin/users/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.2.2.2; previous revision: 1.2.2.1
done
Checking in template/en/default/bug/show.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/show.html.tmpl,v <-- show.html.tmpl
new revision: 1.11.2.1; previous revision: 1.11
done
Checking in template/en/default/global/header.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/header.html.tmpl,v <-- header.html.tmpl
new revision: 1.40.2.1; previous revision: 1.40
done
Checking in template/en/default/reports/components.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/components.html.tmpl,v <-- components.html.tmpl
new revision: 1.9.4.2; previous revision: 1.9.4.1
done
Checking in template/en/default/reports/duplicates.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/duplicates.html.tmpl,v <-- duplicates.html.tmpl
new revision: 1.15.2.1; previous revision: 1.15
done
2.20.2:
Checking in editproducts.cgi;
/cvsroot/mozilla/webtools/bugzilla/editproducts.cgi,v <-- editproducts.cgi
new revision: 1.85.2.10; previous revision: 1.85.2.9
done
Checking in template/en/default/filterexceptions.pl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/filterexceptions.pl,v <-- filterexceptions.pl
new revision: 1.43.2.6; previous revision: 1.43.2.5
done
Checking in template/en/default/admin/flag-type/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/flag-type/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.11.4.2; previous revision: 1.11.4.1
done
Checking in template/en/default/admin/groups/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.5.4.2; previous revision: 1.5.4.1
done
Checking in template/en/default/admin/groups/remove.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/groups/remove.html.tmpl,v <-- remove.html.tmpl
new revision: 1.1.8.1; previous revision: 1.1
done
Checking in template/en/default/admin/products/groupcontrol/confirm-edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/groupcontrol/confirm-edit.html.tmpl,v <-- confirm-edit.html.tmpl
new revision: 1.5.10.2; previous revision: 1.5.10.1
done
Checking in template/en/default/admin/users/confirm-delete.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/confirm-delete.html.tmpl,v <-- confirm-delete.html.tmpl
new revision: 1.4.2.6; previous revision: 1.4.2.5
done
Checking in template/en/default/admin/users/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/users/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.1.4.2; previous revision: 1.1.4.1
done
Checking in template/en/default/bug/show.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/show.html.tmpl,v <-- show.html.tmpl
new revision: 1.10.6.1; previous revision: 1.10
done
Checking in template/en/default/global/header.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/header.html.tmpl,v <-- header.html.tmpl
new revision: 1.39.4.2; previous revision: 1.39.4.1
done
Checking in template/en/default/list/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.37.2.3; previous revision: 1.37.2.2
done
Checking in template/en/default/reports/components.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/components.html.tmpl,v <-- components.html.tmpl
new revision: 1.9.2.2; previous revision: 1.9.2.1
done
Checking in template/en/default/reports/duplicates.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/duplicates.html.tmpl,v <-- duplicates.html.tmpl
new revision: 1.14.10.1; previous revision: 1.14
done
2.18.5:
Checking in CGI.pl;
/cvsroot/mozilla/webtools/bugzilla/Attic/CGI.pl,v <-- CGI.pl
new revision: 1.211.2.11; previous revision: 1.211.2.10
done
Checking in editgroups.cgi;
/cvsroot/mozilla/webtools/bugzilla/editgroups.cgi,v <-- editgroups.cgi
new revision: 1.38.2.4; previous revision: 1.38.2.3
done
Checking in template/en/default/filterexceptions.pl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/filterexceptions.pl,v <-- filterexceptions.pl
new revision: 1.16.2.4; previous revision: 1.16.2.3
done
Checking in template/en/default/admin/flag-type/edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/flag-type/edit.html.tmpl,v <-- edit.html.tmpl
new revision: 1.6.2.5; previous revision: 1.6.2.4
done
Checking in template/en/default/admin/products/groupcontrol/confirm-edit.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/admin/products/groupcontrol/confirm-edit.html.tmpl,v <-- confirm-edit.html.tmpl
new revision: 1.5.2.1; previous revision: 1.5
done
Checking in template/en/default/bug/show.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/bug/show.html.tmpl,v <-- show.html.tmpl
new revision: 1.6.2.5; previous revision: 1.6.2.4
done
Checking in template/en/default/global/header.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/global/header.html.tmpl,v <-- header.html.tmpl
new revision: 1.24.2.6; previous revision: 1.24.2.5
done
Checking in template/en/default/list/list.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/list/list.html.tmpl,v <-- list.html.tmpl
new revision: 1.25.2.3; previous revision: 1.25.2.2
done
Checking in template/en/default/reports/components.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/components.html.tmpl,v <-- components.html.tmpl
new revision: 1.8.2.2; previous revision: 1.8.2.1
done
Checking in template/en/default/reports/duplicates.html.tmpl;
/cvsroot/mozilla/webtools/bugzilla/template/en/default/reports/duplicates.html.tmpl,v <-- duplicates.html.tmpl
new revision: 1.14.2.1; previous revision: 1.14
done
Status: ASSIGNED → RESOLVEDClosed: 18 years agoResolution: --- → FIXEDSummary: H1, H2 and H3 are not filtered in global/header.html.tmpl → [SECURITY] H1, H2 and H3 are not filtered in global/header.html.tmpl

|  | [Max Kanat-Alexander](/user_profile?user_id=73187) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=330555#c18)• 18 years ago |
|  | |

Security Advisory has been sent, so this bug is no longer private.Group: webtools-security
You need to [log in](/show_bug.cgi?id=330555&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frédéric Buclin](/user_profile?user_id=120380)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from securityreason.com_1ce0a752_20250125_205246.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


