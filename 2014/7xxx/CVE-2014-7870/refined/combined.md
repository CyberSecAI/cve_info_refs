=== Content from seclists.org_7edebca2_20250126_002013.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](40)
[By Date](date.html#41)
[![Next](/images/right-icon-16x16.png)](42)

[![Previous](/images/left-icon-16x16.png)](40)
[By Thread](index.html#41)
[![Next](/images/right-icon-16x16.png)](43)

![](/shared/images/nst-icons.svg#search)

# Drupal Custom Search module XSS

---

*From*: Justin Klein Keane <justin () madirish net>

*Date*: Wed, 02 Apr 2014 19:40:47 -0400

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Vulnerability Report

Author: Justin C. Klein Keane <justin () madirish net>
Reported: 19 Feb, 2014

Description of Vulnerability:
- -----------------------------
Drupal (<http://drupal.org>) is a robust content management system (CMS)
written in PHP and MySQL.  The Custom Search module "alters the default
search box in many ways. If you need to have options available like in
advanced search, but directly in the search box, this module is for
you."  The Drupal Custom Search module
(<https://drupal.org/project/custom_search>) contains a persistent cross
site scripting (XSS) vulnerability due to the fact that it fails to
sanitize filter labels before display.

Systems affected:
- -----------------
Drupal 7.26 with Custom Search 7.x-1.13 was tested and shown to be
vulnerable

Impact
- ------
Users can inject arbitrary HTML (including JavaScript) in order to
attack site users, including administrative users.  This could lead to
account compromise, which could in turn lead to web server compromise,
or expose administrative users to client side malware attacks.

Mitigating factors:
- -------------------
In order to inject arbitrary script malicious users must have the
ability "administer custom search."

Proof of Concept Exploits:
- -----------------
1.  Install and enable the Custom Search module
2.  Navigate the Custom Search configuration at
?q=admin/config/search/custom_search/results
3.  Change the 'Position' drop down to 'Above results'
4.  Enter "<script>alert('xss');</script>" in the 'Label text' input
field
5.  Click the 'Save Configuration' button
6.  Submit any search to view the JavaScript on the results page.

Vendor response:
- ----------------
Vulnerability is fixed in the latest versions of the Custom Search
module (ref <https://drupal.org/node/2231665>)

- --
Justin C. Klein Keane
<http://www.MadIrish.net>

The digital signature on this e-mail may be verified using
the public key at <http://www.madirish.net/gpgkey>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.22 (Darwin)
Comment: GPGTools - <http://gpgtools.org>
Comment: Using GnuPG with Thunderbird - <http://www.enigmail.net/>

iPwEAQECAAYFAlM8n/8ACgkQkSlsbLsN1gAGXwb9FaDO4jn6RBhqOqLkvFPu3eJE
Ae+E5BEAxJ8wQpZx2dnen5hizNtN0q2o6LkDffwkEaOjZMJZIum23F8ovnxciuiA
B/vg4ZfKav+08Ac8ZJcC5FwKbz0hs6mlMR5aLGQK28PjLShEEtMUEzlfDzhAA1GK
3I3huJIUCszR5nkgYGjvxrHmCVHMEZ9f0hS5L6tfEaLKCSFtyVbM65CfdGcFnrr0
o2+YQd9NQ8NnLYe+wB2VGXgydBseQ8AdshnB6c1WTG7/lHHVqOV2f8vbr4kewoCz
PQln6M5j/UJtaMyMmds=
=Sqil
-----END PGP SIGNATURE-----

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](40)
[By Date](date.html#41)
[![Next](/images/right-icon-16x16.png)](42)

[![Previous](/images/left-icon-16x16.png)](40)
[By Thread](index.html#41)
[![Next](/images/right-icon-16x16.png)](43)

### Current thread:

* **Drupal Custom Search module XSS** *Justin Klein Keane (Apr 02)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


