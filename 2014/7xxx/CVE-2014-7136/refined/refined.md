```
{
  "cve": "CVE-2014-7136",
  "source_content": [
    {
      "url": "seclists.org_82e1daa8_20250124_145915.html",
      "data": "Vulnerability title: Privilege Escalation In K7 Computing Multiple Products [K7FWFilt.sys]\nCVE: CVE-2014-7136\nVendor: K7 Computing\nProduct: Multiple Products [K7FWFilt.sys]\nAffected version: Earlier and including 11.0.1.5\nFixed version: 14.0.1.16\nReported by: Kyriakos Economou\nDetails:\n\nLatest, and possibly earlier versions of K7FWFilt.sys kernel mode driver, also named as the 'K7Firewall Packet Driver',\nsuffers from a heap overflow condition that can be exploited locally by an attacker in order to execute code with\nkernel privileges. Successful exploitation of this bug results in vertical privilege escalation.\n\nTechnical Details:\n\nThe function handling IOCTL 0x830020C4 does not validate the size of the output buffer parameter passed in the\nDeviceIoControl API, which leads to a heap overflow on buffer data initialization. In particular, the function assumes\nthat the output buffer has a size of 0x22C4 bytes. By declaring a smaller buffer we are able to overwrite other data\nand kernel objects that might follow and potentially control the execution flow via a corrupted kernel object.\n\nba31cb06 8b7d14 mov edi,dword ptr [ebp+14h] <--- EDI == allocated buffer\nba31cb09 ff7514 push dword ptr [ebp+14h]\nba31cb0c b9b1080000 mov ecx,8B1h <--- assume buffer size 0x8b1 * 4\nba31cb11 33c0 xor eax,eax <--- zero out EAX\nba31cb13 f3ab rep stos dword ptr es:[edi] <--- Heap Overflow\n\nFurther details at:\n\n<https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-7136/>"
    }
  ],
  "vulnerability_details": {
    "root_cause": "The K7FWFilt.sys kernel mode driver does not validate the size of the output buffer parameter passed to the DeviceIoControl API when handling IOCTL 0x830020C4. It assumes a fixed buffer size of 0x22C4 bytes.",
    "weaknesses": [
      "Heap overflow"
    ],
    "impact": "Local privilege escalation. Successful exploitation allows an attacker to execute code with kernel privileges.",
    "attack_vectors": [
      "Local exploitation via DeviceIoControl API call with a smaller-than-expected output buffer to trigger the heap overflow."
    ],
    "required_capabilities": [
      "Local access to the system."
    ]
  }
}
```