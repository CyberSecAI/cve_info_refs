```
{
  "cveId": "CVE-2014-0147",
  "relatedContent": [
    {
      "source": "bugzilla.redhat.com_0d80c883_20250125_070958.html",
      "vulnerabilityDetails": {
        "rootCause": "The QEMU block driver for QCOW2 format has a vulnerability due to how the update_refcount() function is called when creating QCOW2 snapshots.",
        "weaknesses": [
          "Use of signed data types or a logic error",
           "Incorrectly calling update_refcount()"
        ],
        "impact": "A user able to alter the Qemu disk image files loaded by a guest could use this flaw to crash the Qemu instance resulting in DoS or corrupt QEMU process memory on the host, which could potentially result in arbitrary code execution on the host with the privileges of the QEMU process.",
         "attackVectors": [
          "Altering QEMU disk image files"
         ],
        "attackerCapabilities": "An attacker must be able to modify disk image files loaded by a guest."
      }
    },
    {
      "source": "www.openwall.com_e161b6ac_20250125_070955.html",
        "vulnerabilityDetails": {
        "rootCause": "The root cause is an issue in `alloc_refcount_block` where it does not rely on `free_cluster_index`.",
          "weaknesses": [
           "Logic error due to relying on incorrect index"
          ],
          "impact": "Possible crash of QEMU.",
         "attackVectors": [
           "Maliciously crafted qcow2 images"
          ],
        "attackerCapabilities": "An attacker must be able to provide a maliciously crafted qcow2 image."
      }
    },
    {
      "source": "bugzilla.redhat.com_4a47118d_20250126_070650.html",
      "vulnerabilityDetails": {
        "rootCause": "The Qemu block driver for the various disk image formats used by Bochs and for the QCOW version 2 format, are vulnerable to a possible crash caused by signed data types or a logic error while creating QCOW2 snapshots, which leads to incorrectly calling update_refcount() routine.",
        "weaknesses": [
          "Use of signed data types or a logic error",
          "Incorrectly calling update_refcount()"
        ],
         "impact": "An user able to alter the Qemu disk image files loaded by a guest could use this flaw to crash the Qemu instance resulting in DoS or corrupt QEMU process memory on the host, which could potentially result in arbitrary code execution on the host with the privileges of the QEMU process.",
        "attackVectors": [
           "Altering QEMU disk image files"
        ],
        "attackerCapabilities": "An attacker must be able to modify disk image files loaded by a guest."
      }
    },
      {
        "source": "bugzilla.redhat.com_ecf1e696_20250125_070956.html",
        "vulnerabilityDetails": {
          "rootCause": "The Qemu block driver for the various disk image formats used by Bochs and for the QCOW version 2 format, are vulnerable to a possible crash caused by signed data types or a logic error while creating QCOW2 snapshots, which leads to incorrectly calling update_refcount() routine.",
          "weaknesses": [
            "Use of signed data types or a logic error",
            "Incorrectly calling update_refcount()"
          ],
          "impact": "An user able to alter the Qemu disk image files loaded by a guest could use this flaw to crash the Qemu instance resulting in DoS or corrupt QEMU process memory on the host, which could potentially result in arbitrary code execution on the host with the privileges of the QEMU process.",
          "attackVectors": [
            "Altering QEMU disk image files"
          ],
          "attackerCapabilities": "An attacker must be able to modify disk image files loaded by a guest."
      }
    },
    {
      "source": "rhn.redhat.com_02a1a449_20250125_070954.html",
       "vulnerabilityDetails": {
        "rootCause": "Multiple integer overflow, input validation, logic error, and buffer overflow flaws were discovered in various QEMU block drivers. Specifically, CVE-2014-0147 is related to a logic error while creating QCOW2 snapshots, which leads to incorrectly calling update_refcount() routine.",
         "weaknesses":[
          "Logic error in QCOW2 snapshot creation",
          "Incorrect function call to update_refcount()"
           ],
        "impact": "An attacker able to modify a disk image file loaded by a guest could use these flaws to crash the guest, or corrupt QEMU process memory on the host, potentially resulting in arbitrary code execution on the host with the privileges of the QEMU process.",
         "attackVectors": [
          "Modifying disk image files loaded by a guest"
         ],
        "attackerCapabilities": "An attacker must be able to modify disk image files loaded by a guest."
       }
     },
        {
          "source": "rhn.redhat.com_d5af3eab_20250125_070954.html",
           "vulnerabilityDetails": {
            "rootCause": "Multiple integer overflow, input validation, logic error, and buffer overflow flaws were discovered in various QEMU block drivers. Specifically, CVE-2014-0147 is related to a logic error while creating QCOW2 snapshots, which leads to incorrectly calling update_refcount() routine.",
             "weaknesses":[
              "Logic error in QCOW2 snapshot creation",
              "Incorrect function call to update_refcount()"
               ],
            "impact": "An attacker able to modify a disk image file loaded by a guest could use these flaws to crash the guest, or corrupt QEMU process memory on the host, potentially resulting in arbitrary code execution on the host with the privileges of the QEMU process.",
             "attackVectors": [
              "Modifying disk image files loaded by a guest"
             ],
            "attackerCapabilities": "An attacker must be able to modify disk image files loaded by a guest."
           }
      }
  ]
}
```