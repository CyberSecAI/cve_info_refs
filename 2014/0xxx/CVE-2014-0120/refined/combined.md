=== Content from bugzilla.redhat.com_641b879a_20250125_132112.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1072681)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1072681)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1072681)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1072681

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1072681**](show_bug.cgi?id=1072681)
(CVE-2014-0120)
- [CVE-2014-0120](https://access.redhat.com/security/cve/CVE-2014-0120) hawtio-karaf-terminal: cross-site request forgery (CSRF)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-0120 hawtio-karaf-terminal: cross-site request forgery (CSRF)

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED CURRENTRELEASE | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-0120 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1072724](show_bug.cgi?id=1072724) | | TreeView+ | [depends on](buglist.cgi?bug_id=1072681&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1072681&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2014-03-05 02:52 UTC by Trevor Jay | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-12 13:07 UTC ([History](show_activity.cgi?id=1072681)) | | [CC List:](page.cgi?id=fields.html#cclist) | 5 users (show)  chazlett djorm jrusnack security-response-team weli | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2014-04-14 18:42:04 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1072681#c0)  Trevor Jay    2014-03-05 02:52:18 UTC  ``` hawtio-karaf-terminal is vulnerable to Cross-Site Request Forgery (CSRF) attacks. A remote attacker could provide a specially-crafted web page that, when visited by a user logged in to the hawt.io web console, could allow the attacker to run arbitrary commands on the underlying Karaf server.   ```  [Comment 1](show_bug.cgi?id=1072681#c1)  Trevor Jay    2014-03-05 05:52:03 UTC  ``` Acknowledgements:  This issue was discovered by David Jorm of the Red Hat Security Response Team.   ```  [Comment 3](show_bug.cgi?id=1072681#c3)  David Jorm    2014-03-07 03:14:04 UTC  ``` Upstream patch commit:  <https://github.com/hawtio/hawtio/commit/b4e23e002639c274a2f687ada980118512f06113>   ```  [Comment 5](show_bug.cgi?id=1072681#c5)  Chess Hazlett    2014-04-14 18:42:04 UTC  ``` Statement:  Not vulnerable. This issue only affects Red Hat JBoss Fuse 6.1.0 Beta. It is resolved in the general availability release of Red Hat JBoss Fuse 6.1.0. Earlier versions of Red Hat JBoss Fuse are not affected, as they did not include the hawtio-karaf-terminal component.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1072681&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_13c8f007_20250126_085402.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_3a261106_20250125_132115.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhawtio%2Fhawtio%2Fcommit%2Fb4e23e002639c274a2f687ada980118512f06113)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhawtio%2Fhawtio%2Fcommit%2Fb4e23e002639c274a2f687ada980118512f06113)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=hawtio%2Fhawtio)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[hawtio](/hawtio)
/
**[hawtio](/hawtio/hawtio)**
Public

* [Notifications](/login?return_to=%2Fhawtio%2Fhawtio) You must be signed in to change notification settings
* [Fork
  543](/login?return_to=%2Fhawtio%2Fhawtio)
* [Star
   1.4k](/login?return_to=%2Fhawtio%2Fhawtio)

* [Code](/hawtio/hawtio)
* [Issues
  26](/hawtio/hawtio/issues)
* [Pull requests
  4](/hawtio/hawtio/pulls)
* [Discussions](/hawtio/hawtio/discussions)
* [Actions](/hawtio/hawtio/actions)
* [Projects
  1](/hawtio/hawtio/projects)
* [Security](/hawtio/hawtio/security)
* [Insights](/hawtio/hawtio/pulse)

Additional navigation options

* [Code](/hawtio/hawtio)
* [Issues](/hawtio/hawtio/issues)
* [Pull requests](/hawtio/hawtio/pulls)
* [Discussions](/hawtio/hawtio/discussions)
* [Actions](/hawtio/hawtio/actions)
* [Projects](/hawtio/hawtio/projects)
* [Security](/hawtio/hawtio/security)
* [Insights](/hawtio/hawtio/pulse)

## Commit

[Permalink](/hawtio/hawtio/commit/b4e23e002639c274a2f687ada980118512f06113)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add a LoginTokenServlet that plugins can use to fetch a token, and le…

[Browse files](/hawtio/hawtio/tree/b4e23e002639c274a2f687ada980118512f06113)
Browse the repository at this point in the history

```
…t's use it in hawtio-karaf-terminal. Also handle cases where the terminal scope gets created a couple times.
```

* Loading branch information

[![@gashcrumb](https://avatars.githubusercontent.com/u/351660?s=40&v=4)](/gashcrumb)

[gashcrumb](/hawtio/hawtio/commits?author=gashcrumb "View all commits by gashcrumb")
committed
Mar 6, 2014

1 parent
[bedbba0](/hawtio/hawtio/commit/bedbba03dd971d481a6852ccdaec670a9665e94b)

commit b4e23e0

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**149 additions**
and
**48 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* hawtio-karaf-terminal/src/main

  + java/io/hawt/web/plugin/karaf/terminal

    - hawtio-karaf-terminal/src/main/java/io/hawt/web/plugin/karaf/terminal/TerminalServlet.java
      [TerminalServlet.java](#diff-72cad3054695fd6ad755c4fe7bae61ae82c01b3e037053b003d5163d7a891f45)
  + webapp

    - WEB-INF

      * hawtio-karaf-terminal/src/main/webapp/WEB-INF/web.xml
        [web.xml](#diff-0417d0fdc94c8f9c9248d4208e405b75bde3f22c21d34ce8942b2770f90f9a8f)
    - app/js

      * hawtio-karaf-terminal/src/main/webapp/app/js/gogo.js
        [gogo.js](#diff-80b19a74daa1ee7633949a28ad1a7bc7ea65a3d047298cbeca53172bc3806e8c)
      * hawtio-karaf-terminal/src/main/webapp/app/js/gogoPlugin.js
        [gogoPlugin.js](#diff-e6a6c477139f97f54f907b6da99a302908815310eea274f8adcb56832e933a5c)
* hawtio-system/src/main/java/io/hawt/web

  + hawtio-system/src/main/java/io/hawt/web/LoginServlet.java
    [LoginServlet.java](#diff-6d09570611be0da8573bffa99a92ec7a6bf95465c3c5628ac41292222c2c13b2)
  + hawtio-system/src/main/java/io/hawt/web/LoginTokenServlet.java
    [LoginTokenServlet.java](#diff-70ae5cc35b00833304abc2292902d34bb72b0f43a5a335b1fb433e95f2162bc2)

## There are no files selected for viewing

23 changes: 8 additions & 15 deletions

23
[hawtio-karaf-terminal/src/main/java/io/hawt/web/plugin/karaf/terminal/TerminalServlet.java](#diff-72cad3054695fd6ad755c4fe7bae61ae82c01b3e037053b003d5163d7a891f45 "hawtio-karaf-terminal/src/main/java/io/hawt/web/plugin/karaf/terminal/TerminalServlet.java")

Show comments

[View file](/hawtio/hawtio/blob/b4e23e002639c274a2f687ada980118512f06113/hawtio-karaf-terminal/src/main/java/io/hawt/web/plugin/karaf/terminal/TerminalServlet.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,23 +1,21 @@ |
|  |  | package io.hawt.web.plugin.karaf.terminal; |
|  |  |  |
|  |  | import io.hawt.system.Helpers; |
|  |  | import io.hawt.web.LoginTokenServlet; |
|  |  | import org.apache.felix.service.command.CommandProcessor; |
|  |  | import org.apache.felix.service.command.CommandSession; |
|  |  | import org.apache.felix.service.threadio.ThreadIO; |
|  |  | import org.apache.karaf.shell.console.jline.Console; |
|  |  | import org.slf4j.Logger; |
|  |  | import org.slf4j.LoggerFactory; |
|  |  |  |
|  |  | import javax.security.auth.Subject; |
|  |  | import javax.servlet.ServletException; |
|  |  | import javax.servlet.http.HttpServlet; |
|  |  | import javax.servlet.http.HttpServletRequest; |
|  |  | import javax.servlet.http.HttpServletResponse; |
|  |  | import javax.servlet.http.HttpSession; |
|  |  | import java.io.\*; |
|  |  | import java.lang.reflect.Constructor; |
|  |  | import java.security.AccessControlContext; |
|  |  | import java.security.AccessController; |
|  |  | import java.util.zip.GZIPOutputStream; |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -45,22 +43,17 @@ public ThreadIO getThreadIO() { |
|  |  | protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { |
|  |  |  |
|  |  | HttpSession session = request.getSession(false); |
|  |  | if (session == null) { |
|  |  | AccessControlContext acc = AccessController.getContext(); |
|  |  | Subject subject = Subject.getSubject(acc); |
|  |  | if (subject == null) { |
|  |  | String token = request.getHeader(LoginTokenServlet.LOGIN\_TOKEN); |
|  |  |  |
|  |  | if (token == null || session == null) { |
|  |  | Helpers.doForbidden(response); |
|  |  | return; |
|  |  | } |
|  |  | session = request.getSession(true); |
|  |  | session.setAttribute("subject", subject); |
|  |  | } else { |
|  |  | Subject subject = (Subject) session.getAttribute("subject"); |
|  |  | if (subject == null) { |
|  |  | session.invalidate(); |
|  |  | } |
|  |  |  |
|  |  | String sessionToken = (String) session.getAttribute(LoginTokenServlet.LOGIN\_TOKEN); |
|  |  | if (!token.equals(sessionToken)) { |
|  |  | Helpers.doForbidden(response); |
|  |  | return; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | String encoding = request.getHeader("Accept-Encoding"); |
| Expand Down | |  |

21 changes: 21 additions & 0 deletions

21
[hawtio-karaf-terminal/src/main/webapp/WEB-INF/web.xml](#diff-0417d0fdc94c8f9c9248d4208e405b75bde3f22c21d34ce8942b2770f90f9a8f "hawtio-karaf-terminal/src/main/webapp/WEB-INF/web.xml")

Show comments

[View file](/hawtio/hawtio/blob/b4e23e002639c274a2f687ada980118512f06113/hawtio-karaf-terminal/src/main/webapp/WEB-INF/web.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,7 +16,28 @@ |
|  |  | <filter-name>AuthenticationFilter</filter-name> |
|  |  | <url-pattern>/term/\*</url-pattern> |
|  |  | </filter-mapping> |
|  |  | <filter-mapping> |
|  |  | <filter-name>AuthenticationFilter</filter-name> |
|  |  | <url-pattern>/auth/\*</url-pattern> |
|  |  | </filter-mapping> |
|  |  |  |
|  |  | <servlet> |
|  |  | <servlet-name>login</servlet-name> |
|  |  | <servlet-class>io.hawt.web.LoginTokenServlet</servlet-class> |
|  |  | </servlet> |
|  |  | <servlet-mapping> |
|  |  | <servlet-name>login</servlet-name> |
|  |  | <url-pattern>/auth/login/\*</url-pattern> |
|  |  | </servlet-mapping> |
|  |  |  |
|  |  | <servlet> |
|  |  | <servlet-name>logout</servlet-name> |
|  |  | <servlet-class>io.hawt.web.LogoutServlet</servlet-class> |
|  |  | </servlet> |
|  |  | <servlet-mapping> |
|  |  | <servlet-name>logout</servlet-name> |
|  |  | <url-pattern>/auth/logout/\*</url-pattern> |
|  |  | </servlet-mapping> |
|  |  |  |
|  |  | <servlet> |
|  |  | <servlet-name>TerminalServlet</servlet-name> |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[hawtio-karaf-terminal/src/main/webapp/app/js/gogo.js](#diff-80b19a74daa1ee7633949a28ad1a7bc7ea65a3d047298cbeca53172bc3806e8c "hawtio-karaf-terminal/src/main/webapp/app/js/gogo.js")

Show comments

[View file](/hawtio/hawtio/blob/b4e23e002639c274a2f687ada980118512f06113/hawtio-karaf-terminal/src/main/webapp/app/js/gogo.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,7 +6,7 @@ |
|  |  |  |
|  |  | gogo = { }; |
|  |  |  |
|  |  | gogo.Terminal\_ctor = function(div, width, height, authHeader) { |
|  |  | gogo.Terminal\_ctor = function(div, width, height, token) { |
|  |  |  |
|  |  | var query0 = "w=" + width + "&h=" + height; |
|  |  | var query1 = query0 + "&k="; |
| Expand Down  Expand Up | | @@ -47,7 +47,7 @@ gogo.Terminal\_ctor = function(div, width, height, authHeader) { |
|  |  | force = 0; |
|  |  | } |
|  |  | r.open("POST", "hawtio-karaf-terminal/term", true); |
|  |  | r.setRequestHeader('Authorization', authHeader); |
|  |  | r.setRequestHeader('LoginToken', token); |
|  |  | r.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); |
|  |  | r.onreadystatechange = function () { |
|  |  | if (r.readyState == 4) { |
| Expand Down  Expand Up | | @@ -224,7 +224,7 @@ gogo.Terminal\_ctor = function(div, width, height, authHeader) { |
|  |  |  |
|  |  | } |
|  |  |  |
|  |  | gogo.Terminal = function(div, width, height, authHeader) { |
|  |  | return new this.Terminal\_ctor(div, width, height, authHeader); |
|  |  | gogo.Terminal = function(div, width, height, token) { |
|  |  | return new this.Terminal\_ctor(div, width, height, token); |
|  |  | } |
|  |  |  |

59 changes: 54 additions & 5 deletions

59
[hawtio-karaf-terminal/src/main/webapp/app/js/gogoPlugin.js](#diff-e6a6c477139f97f54f907b6da99a302908815310eea274f8adcb56832e933a5c "hawtio-karaf-terminal/src/main/webapp/app/js/gogoPlugin.js")

Show comments

[View file](/hawtio/hawtio/blob/b4e23e002639c274a2f687ada980118512f06113/hawtio-karaf-terminal/src/main/webapp/app/js/gogoPlugin.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,6 +16,34 @@ var Gogo = (function() { |
|  |  | restrict: 'A', |
|  |  | link: function(scope, element, attrs) { |
|  |  |  |
|  |  | scope.$on("$destroy", function(e) { |
|  |  | scope.destroyed = true; |
|  |  | document.onkeypress = null; |
|  |  | document.onkeydown = null; |
|  |  | if (!('term' in scope)) { |
|  |  | return; |
|  |  | } |
|  |  | var url = "hawtio-karaf-terminal/auth/logout/"; |
|  |  | delete scope.term; |
|  |  | $.ajax(url, { |
|  |  | type: "POST", |
|  |  | success: function (response) { |
|  |  | log.debug("logged out of terminal"); |
|  |  | Core.$apply(scope); |
|  |  | }, |
|  |  | error: function (xhr, textStatus, error) { |
|  |  | log.info("Failed to log out of terminal: ", error); |
|  |  | }, |
|  |  | beforeSend: function (xhr) { |
|  |  | xhr.setRequestHeader('Authorization', authHeader); |
|  |  | } |
|  |  | }) |
|  |  | }); |
|  |  |  |
|  |  | if (scope.destroyed) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | var width = 120; |
|  |  | var height = 39; |
|  |  |  |
| Expand Down  Expand Up | | @@ -52,11 +80,32 @@ var Gogo = (function() { |
|  |  |  |
|  |  | var authHeader = Core.getBasicAuthHeader(userDetails.username, userDetails.password); |
|  |  |  |
|  |  | gogo.Terminal(element.get(0), width, height, authHeader); |
|  |  |  |
|  |  | scope.$on("$destroy", function(e) { |
|  |  | document.onkeypress = null; |
|  |  | document.onkeydown = null; |
|  |  | var url = "hawtio-karaf-terminal/auth/login/"; |
|  |  |  |
|  |  | $.ajax(url, { |
|  |  | type: "POST", |
|  |  | success: function (response) { |
|  |  | if (scope.destroyed) { |
|  |  | log.debug("Scope's been destroyed since we made our request, let's not create a terminal instance"); |
|  |  | return; |
|  |  | } |
|  |  | log.debug("got back response: ", response); |
|  |  | if ('term' in scope) { |
|  |  | log.debug("Previous terminal created, let's clean it up"); |
|  |  | document.onkeypress = null; |
|  |  | document.onkeydown = null; |
|  |  | delete scope.term; |
|  |  | } |
|  |  | scope.term = gogo.Terminal(element.get(0), width, height, response['token']); |
|  |  | Core.$apply(scope); |
|  |  |  |
|  |  | }, |
|  |  | error: function (xhr, textStatus, error) { |
|  |  | log.warn("Failed to log into terminal: ", error); |
|  |  | }, |
|  |  | beforeSend: function (xhr) { |
|  |  | xhr.setRequestHeader('Authorization', authHeader); |
|  |  | } |
|  |  | }); |
|  |  |  |
|  |  | } |
| Expand Down | |  |

44 changes: 20 additions & 24 deletions

44
[hawtio-system/src/main/java/io/hawt/web/LoginServlet.java](#diff-6d09570611be0da8573bffa99a92ec7a6bf95465c3c5628ac41292222c2c13b2 "hawtio-system/src/main/java/io/hawt/web/LoginServlet.java")

Show comments

[View file](/hawtio/hawtio/blob/b4e23e002639c274a2f687ada980118512f06113/hawtio-system/src/main/java/io/hawt/web/LoginServlet.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,30 +1,25 @@ |
|  |  | package io.hawt.web; |
|  |  |  |
|  |  | import java.io.IOException; |
|  |  | import java.io.PrintWriter; |
|  |  | import java.security.AccessControlContext; |
|  |  | import java.security.AccessController; |
|  |  | import java.security.Principal; |
|  |  | import java.util.ArrayList; |
|  |  | import java.util.GregorianCalendar; |
|  |  | import java.util.HashMap; |
|  |  | import java.util.List; |
|  |  | import java.util.Map; |
|  |  | import java.util.Set; |
|  |  | import io.hawt.system.ConfigManager; |
|  |  | import io.hawt.system.Helpers; |
|  |  | import org.jolokia.converter.Converters; |
|  |  | import org.jolokia.converter.json.JsonConvertOptions; |
|  |  | import org.slf4j.Logger; |
|  |  | import org.slf4j.LoggerFactory; |
|  |  |  |
|  |  | import javax.security.auth.Subject; |
|  |  | import javax.servlet.ServletConfig; |
|  |  | import javax.servlet.ServletException; |
|  |  | import javax.servlet.http.HttpServlet; |
|  |  | import javax.servlet.http.HttpServletRequest; |
|  |  | import javax.servlet.http.HttpServletResponse; |
|  |  | import javax.servlet.http.HttpSession; |
|  |  |  |
|  |  | import io.hawt.system.ConfigManager; |
|  |  | import io.hawt.system.Helpers; |
|  |  | import org.jolokia.converter.Converters; |
|  |  | import org.jolokia.converter.json.JsonConvertOptions; |
|  |  | import org.slf4j.Logger; |
|  |  | import org.slf4j.LoggerFactory; |
|  |  | import java.io.IOException; |
|  |  | import java.io.PrintWriter; |
|  |  | import java.security.AccessControlContext; |
|  |  | import java.security.AccessController; |
|  |  | import java.security.Principal; |
|  |  | import java.util.\*; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* |
| Expand All | | @@ -34,9 +29,9 @@ public class LoginServlet extends HttpServlet { |
|  |  | private static final long serialVersionUID = 1L; |
|  |  | private static final transient Logger LOG = LoggerFactory.getLogger(LoginServlet.class); |
|  |  |  |
|  |  | Converters converters = new Converters(); |
|  |  | JsonConvertOptions options = JsonConvertOptions.DEFAULT; |
|  |  | ConfigManager config; |
|  |  | protected Converters converters = new Converters(); |
|  |  | protected JsonConvertOptions options = JsonConvertOptions.DEFAULT; |
|  |  | protected ConfigManager config; |
|  |  | private Integer timeout; |
|  |  |  |
|  |  | @Override |
| Expand Down  Expand Up | | @@ -74,8 +69,9 @@ protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws S |
|  |  | LOG.warn("No security subject stored in existing session, invalidating"); |
|  |  | session.invalidate(); |
|  |  | Helpers.doForbidden(resp); |
|  |  | return; |
|  |  | } |
|  |  | returnPrincipals(subject, out); |
|  |  | sendResponse(session, subject, out); |
|  |  | return; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -112,10 +108,10 @@ protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws S |
|  |  | LOG.debug("Http session timeout for user {} is {} sec.", username, session.getMaxInactiveInterval()); |
|  |  | } |
|  |  |  |
|  |  | returnPrincipals(subject, out); |
|  |  | sendResponse(session, subject, out); |
|  |  | } |
|  |  |  |
|  |  | private void returnPrincipals(Subject subject, PrintWriter out) { |
|  |  | protected void sendResponse(HttpSession session, Subject subject, PrintWriter out) { |
|  |  |  |
|  |  | Map<String, Object> answer = new HashMap<String, Object>(); |
|  |  |  |
| Expand Down | |  |

42 changes: 42 additions & 0 deletions

42
[hawtio-system/src/main/java/io/hawt/web/LoginTokenServlet.java](#diff-70ae5cc35b00833304abc2292902d34bb72b0f43a5a335b1fb433e95f2162bc2 "hawtio-system/src/main/java/io/hawt/web/LoginTokenServlet.java")

Show comments

[View file](/hawtio/hawtio/blob/b4e23e002639c274a2f687ada980118512f06113/hawtio-system/src/main/java/io/hawt/web/LoginTokenServlet.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,42 @@ |
|  |  | package io.hawt.web; |
|  |  |  |
|  |  | import org.apache.commons.codec.binary.Base64; |
|  |  |  |
|  |  | import javax.security.auth.Subject; |
|  |  | import javax.servlet.http.HttpSession; |
|  |  | import java.io.PrintWriter; |
|  |  | import java.security.SecureRandom; |
|  |  | import java.util.HashMap; |
|  |  | import java.util.Map; |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @author Stan Lewis |
|  |  | \*/ |
|  |  | public class LoginTokenServlet extends LoginServlet { |
|  |  |  |
|  |  | private static final long serialVersionUID = 1L; |
|  |  |  |
|  |  | public static final String LOGIN\_TOKEN = "LoginToken"; |
|  |  |  |
|  |  | @Override |
|  |  | protected void sendResponse(HttpSession session, Subject subject, PrintWriter out) { |
|  |  |  |
|  |  | String token = (String) session.getAttribute(LOGIN\_TOKEN); |
|  |  |  |
|  |  | if ( token == null) { |
|  |  | byte[] seed = (subject.toString() + new Long(System.currentTimeMillis()).toString()).getBytes(); |
|  |  | SecureRandom random = new SecureRandom(seed); |
|  |  | byte[] tokenBytes = new byte[128]; |
|  |  | random.nextBytes(tokenBytes); |
|  |  | token = Base64.encodeBase64String(tokenBytes); |
|  |  | session.setAttribute(LOGIN\_TOKEN, token); |
|  |  | } |
|  |  |  |
|  |  | Map<String, String> answer = new HashMap<String, String>(); |
|  |  | answer.put("token", token); |
|  |  |  |
|  |  | ServletHelpers.writeObject(converters, options, out, answer); |
|  |  | } |
|  |  |  |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b4e23e0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhawtio%2Fhawtio%2Fcommit%2Fb4e23e002639c274a2f687ada980118512f06113) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from infocon.org_7299c486_20250125_132122.html ===
Finding and
exploiting
novel flaws in
Java software

Introduction: David Jorm

● I am not a pen tester. High school dropout, no

formal training or education in security.

● Software engineer for 16 years, climatology domain

● Last 5 years focusing on security, mainly Java

● Managed Red Hat's Java middleware security team

● Now a product security engineer for IIX, and a
member of the ODL and ONOS security teams

● I love finding new 0day and popping shells!

Outline

● SSL issues

● Authentication bypasses

● XXE (general and parameter entities)

● Command parameter injection

● RCE: XSL extensions

● Path traversal

● RCE: EL interpolation

● RCE: binary deserialization

● RCE: XML deserialization

● RCE: new XML <-> binary mapping vector

● Future work: other InvocationHandlers

Introducing Lord Tuskington

● Chief Financial Pinniped for TuskCorp

● Presenter at Kiwicon 2012

● Used again in a panicked response to a request for

media attribution after Ruxcon 2014

● Goal: get major vendor to credit a stuffed walrus
for reporting a code exec flaw. No luck so far :(

SSL issues

● Lord T has the skinny if you're interested:

http://lordtuskington.blogspot.com/2014/10/cyanog
enmod-mitm-flaw.html

SSL issues

● “The Most Dangerous Code in the World: Validating

SSL Certificates in Non-Browser Software”
(Georgiev, M. et. al., 2012)

● No server hostname verification in a number of

clients: commons-httpclient, axis, many proprietary
clients including Chase internet banking app

● Hostname verification added to commons-

httpclient, but flawed not once (CVE-2012-6153)
but twice (CVE-2014-3577)

SSL issues: CVE-2014-3577

● Vulnerable CN extraction code:

● Use of comma as part of the subject attribute value
could confuse the tokenizer and attempt to match
a "CN=" string in the middle of some other
attribute value. For example:

O="foo,CN=www.apache.org"

SSL issues: CVE-2014-3577

● Exploitation relies on tricking a CA into signing such

a cert, but this has been proven by Facebook
engineers who found CVE-2014-3577

● Patched CN extraction code:

SSL issues: Cyanogenmod

●

android_external_apache-http/src/org/apache/http/conn/ssl/AbstractVerifier.java

● Challenge: find another instance of the vulnerable
code, or a variant of it, in an open source project

Authentication bypasses

● Logic errors in security constraints

● Incorrect paths, path wildcards

● HTTP verb/method tampering: security constraints

restricted to specific verbs/methods

● HEAD method used for tampering. RFC2616:

 “In particular, the convention has been established that the GET and HEAD
methods SHOULD NOT have the significance of taking an action other
than retrieval”

“The HEAD method is identical to GET except that the server MUST NOT

return a message-body in the response. The metainformation contained
in the HTTP headers in response to a HEAD request SHOULD be identical
to the information sent in response to a GET request.”

CVE-2014-0121

● Hawt.io project includes a web-based admin

terminal: http://localhost:8181/hawtio/hawtio-karaf-
terminal/term

● CVE-2014-0120: CSRF

● AuthenticationFilter.java

CVE-2014-0121

● Remote unauthenticated command execution

● Live demo

● Patch for AuthenticationFilter.java:

● Full patch commit:

https://github.com/hawtio/hawtio/commit/5289715
e4f2657562fdddcbad830a30969b96e1e

CVE-2010-0738

● JMX Console allows management of Java beans

● HtmlAdaptor servlet has a default security

constraint:

● Tomcat/JbossWeb executes the doGet() servlet

handler to handle HEAD requests (Content-Length)

CVE-2010-0738

● Many exploits in the wild, including the Jboss Worm.

Metasploit example:  http://www.exploit-
db.com/exploits/16319/

● Also works when there is no security constraint at
all, which is the case for Jboss AS 4.x/5.x upstream

● Lesson: always include default authn/authz

JMX Console: lesson learnt?

● CVE-2012-0874

The JMXInvokerHAServlet and EJBInvokerHAServlet invoker servlets allow

unauthenticated access by default in some profiles. Due to the second
layer of authentication provided by the security interceptor, there is no
way to directly exploit this flaw. If a user misconfigured the security
interceptor or inadvertently disabled it, this flaw would be exploitable. A
remote attacker could exploit this flaw to invoke MBean methods and run
arbitrary code in the context of the user running the JBoss server.

● CVE-2013-4810 (rgod, ZDI)

The HP ProCurve Manager (PCM) was found to expose unauthenticated

JMXInvokerServlet and EJBInvokerServlet interfaces. A remote attacker
could exploit this flaw to invoke MBean methods and run arbitrary code in
the context of the user running the PCM server.

Unauthenticated auth

● RFC4513 (LDAP)

“An LDAP client may use the unauthenticated authentication
mechanism of the simple Bind method to establish an
anonymous authorization state by sending a Bind request
with a name value (a distinguished name in LDAP string
form [RFC4514] of non-zero length) and specifying the
simple authentication choice containing a password value of
zero length."

“Operational experience shows that clients can (and
frequently do) misuse the unauthenticated authentication
mechanism of the simple Bind method (see Section 5.1.2).
For example, a client program might make a decision to
grant access to non-directory information on the basis of
successfully completing a Bind operation."

Unauthenticated auth

● CVE-2012-5629: JBoss AS

● CVE-2014-0074: Apache Shiro

● CVE-2014-3612: Apache ActiveMQ

● Etc. etc.

XXE (everywhere!)

● General entity attacks

● Parameter entity attacks

● Most Java APIs do not disable entity expansion by

default

● Relies on developers following best practices, e.g.

from OWASP

OWASP XXE guidelines

 It wasn’t always this way:

XXE: CVE-2014-3490

● RESTEasy REST API framework:
It was found that the fix for CVE-2012-0818 was incomplete: external
parameter entities were not disabled when the
resteasy.document.expand.entity.references parameter was set to false. A
remote attacker able to send XML requests to a RESTEasy endpoint could use
this flaw to read files accessible to the user running the application server,
and potentially perform other more advanced XXE attacks.

● Used by many apps, e.g. oVirt:

● test.dtd on the attacker server:

XXE: CVE-2014-3490

● Patch is simply to use the updated advice from the

OWASP guide:

XXE: XXEBugFind

● https://github.com/ssexxe/XXEBugFind

● Uses soot to parse compiled Java bytecode and

then run it through an analysis and rules engine.
Rules for anti-patterns that identify XXE are defined
in XML.

● Existing rules have some flaws, but the architecture

is rock-solid

● Example flaw I found using XXEBugFind, in a code
base I never read, never understood, and never
wrote a line of code for:

https://www.playframework.com/security/vulnerability
/CVE-2014-3630-XmlExternalEntity

Cmd parameter injection

● When a single command string is input to
Runtime.getRuntime().exec(), the string is
tokenized and split into the command and
parameters

● Direct injection of commands is not possible

● The attacker still has complete control over the

parameters, how can that be abused?

● Example: OpenSSL

Apache Ambari (no CVE)

● First reported Sep 2014, still not patched

● The certificate signing REST API does not require
authentication. It passes user-supplied input to
CertificateManager.signAgentCrt:

https://github.com/apache/ambari/blob/trunk/ambari-
server/src/main/java/org/apache/ambari/server/security/unsecur
ed/rest/CertificateSign.java#L63

● The agentHostname value is derived from user-

supplied input, and is then directly concatenated
into shell commands calling openssl:

https://github.com/apache/ambari/blob/trunk/ambari-
server/src/main/java/org/apache/ambari/server/security/Certifica
teManager.java#L207-219

RCE – XSL extensions

● Various XSL libraries allow embedding code in

stylesheets via extensions

● Xalan and Saxon allow embedding Java. Xalan allows

this by default, unless explicitly disabled.

● Even then, there are workarounds:

● You can find many other instances of this issue

RCE – XSL extensions

● Example exploit using Java extensions:

RCE – XSL extensions

● How can an attacker supply XSL?

● Camel-xslt transforms: http://camel.apache.org/xslt

● Attackers can provide an XML document, but what

about the XSL file?

● CamelXsltFileName message header (accepts

URLs)

● Live demo: CVE-2014-0003

RCE – XSL extensions

● Ektron CMS, user-supplied XSL without

authentication (CVE-2012-5357)

● Liferay, XSL portlets (CVE-2011-1571)

● SpagoBI, report presentation view (CVE-2014-7296)

● Apache Solr, in combination with a directory

traversal flaw (CVE-2013-6397)

● Many more to be found. Remember, the app only
has to fail to configure Xalan correctly, OR use an
outdated vulnerable Xalan JAR.

Path traversal

● Basic premise: path either consists of or ends in

user-supplied input

● Input can include “../” to make a relative path
absolute, and access any file accessible to the
process running on the server:

● Poison null byte injection can terminate the path,
allowing the latter case to be exploitable on older
unpatched JDKs

● Encode or double encode, e.g. %2e%2e%2f

CVE-2014-7816

“It was discovered that Undertow, when running on
Microsoft Windows, is vulnerable to a directory
traversal flaw. A remote attacker could use this flaw
to read arbitrary files that are accessible to the
user running the Java process.”

Why only Windows?

CVE-2014-8114

● Uberfire: information disclosure and RCE via

insecure file upload/download servlets

● RCE by uploading: cmd.jsp

● RCE by downloading?

● Credentials stored on disk

● username=HEX( MD5( username ':' realm ':'

password))

● Do I need to bother demoing that this is easy to

crack?

RCE – EL interpolation

● Various expression languages are commonly used

in Java libraries

● MVEL is one example

● Generally speaking, if an attacker can supply EL,
they can execute arbitrary code on the server

● How can an attacker supply EL?

RCE – EL interpolation

● Zanata is an open source translation memory

platform built on Seam

● Seam evaluates EL in log messages. If code

performs string concatenation with user-supplied
input to create the log messages, an attacker can
inject EL (Credit: Adrian Hayes)

● Zanata would log user-supplied strings using string

concatenation

EL: CVE-2014-3120

● Elasticsearch enables MVEL embedded in search

queries by default

● This is a feature, and the environment is meant to

be protected

● In many cases, of course, it is not

● Example: JBoss Fuse:

https://access.redhat.com/solutions/1191453

● Live demo

● CVE-2015-1427: sandboxing attempted, blocking
class, getClass(), etc. Pointless, this for example
still works...

EL: Example exploit

Spring EL

● Can be used in a variety of settings, but is not

designed to be user-supplied

● <spring:eval expression="${param.pwn}" />

(new
java.util.Scanner((T(java.lang.Runtime).getRuntim
e().exec("cat
/etc/passwd").getInputStream()),"UTF-
8")).useDelimiter("\\A").next()

RCE – binary deserialization

● Java contains a native serialization mechanism,

that converts objects to binary data

● When deserializing, the readObject() and

readResolve() methods of the class will be called

● This can lead to vulnerabilities if a class on the

classpath has something exploitable in
readObject() or readResolve()

● How can an attacker provide binary serialized

objects?

RCE – binary deserialization

● Serialization is used as a format for transferring

objects over networks, e.g. via REST APIs

● Example #1: RichFaces state (CVE-2013-2165,

Takeshi Terada, MBSD)

● Example #2: Restlet REST framework (CVE-2013-

4271)

● Live demo: CVE-2013-4271 PoC

● What kind of issue could exist in

readResolve()/readObject() that would be
exploitable?

commons-fileupload

● Component to simplify file uploads in Java apps

● DiskFileItem class implements readObject()

● The readObject method creates a tmp file on disk:
tempFile = new File(tempDir, tempFileName);

–

● tempDir is read from the repository private attribute
of the class, exposing a poison null byte flaw (file-
writing code is native, now patched)

● An attacker can provide a serialized instance of DFI

with a null-terminated full path value for the
repository attribute: /path/to/file.txt\0

● commons-fileupload code embedded in Tomcat

Restlet + DFI

● Upload a JSP shell to achieve RCE

● Solution #1: don't deserialize untrusted content

● Solution #2: don't introduce flaws in

readObject()/readResolve()

● Solution #3: type checking with look-ahead

deserialization (Pierre Ernst):
http://www.ibm.com/developerworks/java/library/se
-lookahead/index.html

● More information:

https://securityblog.redhat.com/2013/11/20/java-
deserialization-flaws-part-1-binary-deserialization/

RCE – XML deserialization

● Alternative XML-based serialization formats

● JAXB is the standard (no known flaws)

● Other XML serialization libraries exist, and have

exposed security issues leading to RCE

● We’ll look at two examples: XMLDecoder and

XStream

XMLDecoder

● XMLDecoder’s XML format can represent a series of
methods that will be called to reconstruct an object

● If XMLDecoder is used to deserialize untrusted

input, arbitrary code can be injected into the XML

● Example: Restlet CVE-2013-4221. Fixed by

removing vulnerable functionality.

XStream

● Reflection-based deserialization

● Has a special handler for dynamic proxies

(implementations of interfaces)

● Attackers can provide XML representing a dynamic
proxy class, which implements the interface of a
class the application might expect

● Dynamic proxy implements an EventHandler that
calls arbitrary code when any members of the
deserialized class are called

● Vulnerable components: Spring OXM, Sonatype

Nexus, Jenkins

XStream in Jenkins

● Jenkins XML API uses XStream to deserialize input

● Access to XML API -> RCE (but not such a huge

deal)

● Live demo: Jenkins

● Solution: blocked DynamicProxyConverter in

XStream wrapper class

● Upstream solution: whitelisting, with dynamic

proxies excluded by default

● More information:

https://securityblog.redhat.com/2014/01/23/java-
deserialization-flaws-part-2-xml-deserialization/

Dozer XML ↔ Binary Mapper

● Uses reflection-based approach to type conversion

● Used by e.g. Apache Camel to map types

● If used to map user-supplied objects, then an

attacker can provide a dynamic proxy

● There must either be an object being mapped to with
a getter/setter method that matches a method in an
interface on the server classpath, or a manual XML
mapping that allows an attacker to force the issue.

● Proxy must be serializable (implements Serializable)

● EventHandler is not

Dozer CVE-2014-9515

● Wouter Coekaerts reported a serializable

InvocationHandler in older versions of Spring: CVE-
2011-2894

● Using Alvaro Munoz's CVE-2011-2894 exploit, I was
able to develop a working Dozer exploit. It is only
exploitable if all the aforementioned conditions are
met, and vuln Spring JARs are on the classpath

● Live demo: Dozer RCE

(https://github.com/pentestingforfunandprofit/resea
rch/tree/master/dozer-rce)

● Reported upstream since Dec 2014, no response:
https://github.com/DozerMapper/dozer/issues/217

Other InvocationHandlers

● Any common component is useful, but in the JDK

itself means universally exploitable

● Three other InvocationHandlers in Java 7/8:
● CompositeDataInvocationHandler

● MbeanServerInvocationHandler

● RemoteObjectInvocationHandler

● CompositeDataInvocationHandler: forwards getter
methods to a CompositeData instance. No use.

MBeanServerInvocationHandler

● Proxy to an MBean on the server. Potentially useful,
e.g. if MBeans used by JBoss Worm are present.

● Problem 1: attacker must specify correct JMX URL

● Solution 1: JMX is exposed locally on port 1099

● Solution 2: Brute force JMX URL via Java PID

● Problem 2: attacker cannot control code that is run

for any method call, on specific method calls

● EventHandler exploits work no matter which

method is invoked on the proxy object.
MBeanServerInvocationHandler simply calls the
method of the same name on the MBean.

RemoteObjectInvocationHandler

● Proxy to a remote object exported via RMI

● Problem 1: attacker must know details of a remote

object exported to the server

● Solution: JMX registry is exposed via RMI. If JMX
is exposed locally on port 1099, the attacker
could craft an object instance that points to the
JMX RMI URL

● Problem 2: attacker cannot control code that is run

for any method call, on specific method calls

● Future work: look for more potentially exploitable

InvocationHandlers

How to find novel flaws

● Pick a language or platform and go deep

● Understand all the language or platform specific

issues that have been found before

● Synthesize this knowledge with creative thinking

● Questions?


