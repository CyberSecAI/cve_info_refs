=== Content from bugzilla.redhat.com_7f491efc_20250125_135639.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1064440)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1064440)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1064440)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1064440

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1064440**](show_bug.cgi?id=1064440)
(CVE-2014-0077)
- [CVE-2014-0077](https://access.redhat.com/security/cve/CVE-2014-0077) kernel: vhost-net: insufficiency in handling of big packets in handle\_rx()

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-0077 kernel: vhost-net: insufficiency in handling of big packets in ...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-0077 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | Duplicates (1): | [1064102](show_bug.cgi?id=1064102)  ([view as bug list](buglist.cgi?bug_id=1064102)) | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1064442](show_bug.cgi?id=1064442) [1064444](show_bug.cgi?id=1064444) [1064446](show_bug.cgi?id=1064446) [1074439](show_bug.cgi?id=1074439) [1074440](show_bug.cgi?id=1074440) [1081504](show_bug.cgi?id=1081504 "CLOSED ERRATA - CVE-2014-0077 kernel: vhost-net: insufficiency in handling of big packets in handle_rx() [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [994246](show_bug.cgi?id=994246) [1064451](show_bug.cgi?id=1064451) | | TreeView+ | [depends on](buglist.cgi?bug_id=1064440&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1064440&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2014-02-12 16:00 UTC by Petr Matousek | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-12 02:21 UTC ([History](show_activity.cgi?id=1064440)) | | [CC List:](page.cgi?id=fields.html#cclist) | 19 users (show)  agordeev anton aquini dhoward fhrbata gbarros jasowang jkurik kernel-mgr lwang mleitner mmilgram mst npajkovs pholasek qiguo security-response-team seldridg twest | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2014-06-03 07:15:19 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2014:0475](https://access.redhat.com/errata/RHSA-2014%3A0475) | 0 | normal | SHIPPED\_LIVE | Important: kernel security and bug fix update | 2014-05-07 22:46:14 UTC | | Red Hat Product Errata | [RHSA-2014:0593](https://access.redhat.com/errata/RHSA-2014%3A0593) | 0 | normal | SHIPPED\_LIVE | Important: kernel security and bug fix update | 2014-06-03 20:26:52 UTC | | Red Hat Product Errata | [RHSA-2014:0629](https://access.redhat.com/errata/RHSA-2014%3A0629) | 0 | normal | SHIPPED\_LIVE | Important: rhev-hypervisor6 security update | 2014-06-05 18:57:02 UTC | | Red Hat Product Errata | [RHSA-2014:0634](https://access.redhat.com/errata/RHSA-2014%3A0634) | 0 | normal | SHIPPED\_LIVE | Important: kernel security and bug fix update | 2014-06-04 21:06:59 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1064440#c0)  Petr Matousek    2014-02-12 16:00:54 UTC  ``` A flaw was found in the way handle_rx() function handled big packets when mergeable buffers were disabled.  A privileged user in the guest could use this flaw to crash the host, or, potentially, escalate their privileges to the ones of the hosting qemu process by corrupting qemu memory.  Acknowledgements:  This issue was discovered by Michael S. Tsirkin of Red Hat.   ```  [Comment 2](show_bug.cgi?id=1064440#c2)  Petr Matousek    2014-02-12 16:06:00 UTC  ``` Statement:  This issue does not affect Red Hat Enterprise Linux 5 and Red Hat Enterprise MRG 2.   ```  [Comment 3](show_bug.cgi?id=1064440#c3)  Ronen Hod    2014-02-24 07:33:57 UTC  ``` *** [Bug 1064102](show_bug.cgi?id=1064102) has been marked as a duplicate of this bug. ***   ```  [Comment 5](show_bug.cgi?id=1064440#c5)  Petr Matousek    2014-03-27 10:04:35 UTC  ``` Upstream patch submission:  <http://article.gmane.org/gmane.linux.network/311012>   ```  [Comment 6](show_bug.cgi?id=1064440#c6)  Petr Matousek    2014-03-27 13:15:53 UTC  ```  Created kernel tracking bugs for this issue:  Affects: fedora-all [[bug 1081504](show_bug.cgi?id=1081504 "CLOSED ERRATA - CVE-2014-0077 kernel: vhost-net: insufficiency in handling of big packets in handle_rx() [fedora-all]")]   ```  [Comment 7](show_bug.cgi?id=1064440#c7)  Fedora Update System    2014-04-04 09:45:51 UTC  ``` kernel-3.13.8-200.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 8](show_bug.cgi?id=1064440#c8)  Fedora Update System    2014-04-09 00:51:28 UTC  ``` kernel-3.13.9-100.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=1064440#c9)  errata-xmlrpc    2014-05-07 18:46:59 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 6  Via RHSA-2014:0475 <https://rhn.redhat.com/errata/RHSA-2014-0475.html>   ```  [Comment 10](show_bug.cgi?id=1064440#c10)  errata-xmlrpc    2014-06-03 16:27:04 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 6.3 EUS - Server and Compute Node Only  Via RHSA-2014:0593 <https://rhn.redhat.com/errata/RHSA-2014-0593.html>   ```  [Comment 11](show_bug.cgi?id=1064440#c11)  errata-xmlrpc    2014-06-04 17:07:33 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 6.4 EUS - Server and Compute Node Only  Via RHSA-2014:0634 <https://rhn.redhat.com/errata/RHSA-2014-0634.html>   ```  [Comment 12](show_bug.cgi?id=1064440#c12)  errata-xmlrpc    2014-06-05 14:58:54 UTC  ``` This issue has been addressed in following products:    RHEV-H and Agents for RHEL-6  Via RHSA-2014:0629 <https://rhn.redhat.com/errata/RHSA-2014-0629.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1064440&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from github.com_e1843884_20250126_091302.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-r4f5-rm36-v672)

**CVE-2014-0077**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-r4f5-rm36-v672)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2014-0077](/advisories/GHSA-r4f5-rm36-v672)

## drivers/vhost/net.c in the Linux kernel before 3.13.10,...

Moderate severity

Unreviewed

Published
May 13, 2022
to the GitHub Advisory Database
•
Updated Feb 13, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-r4f5-rm36-v672/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

drivers/vhost/net.c in the Linux kernel before 3.13.10, when mergeable buffers are disabled, does not properly validate packet lengths, which allows guest OS users to cause a denial of service (memory corruption and host OS crash) or possibly gain privileges on the host OS via crafted packets, related to the handle\_rx and get\_rx\_bufs functions.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2014-0077>
* [torvalds/linux@d8316f3](https://github.com/torvalds/linux/commit/d8316f3991d207fe32881a9ac20241be8fa2bad0)
* <https://bugzilla.redhat.com/show_bug.cgi?id=1064440>
* <http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=d8316f3991d207fe32881a9ac20241be8fa2bad0>
* <http://secunia.com/advisories/59386>
* <http://secunia.com/advisories/59599>
* <http://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.13.10>
* <http://www.securityfocus.com/bid/66678>
* <http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=d8316f3991d207fe32881a9ac20241be8fa2bad0>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2014-0077)
Apr 14, 2014

Published to the GitHub Advisory Database
May 13, 2022

Last updated
Feb 13, 2023

### Severity

Moderate

### EPSS score

0.254%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (65th percentile)

### Weaknesses

[CWE-787](/advisories?query=cwe%3A787)

### CVE ID

CVE-2014-0077

### GHSA ID

GHSA-r4f5-rm36-v672

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-r4f5-rm36-v672/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from secunia.com_d52c244e_20250125_135635.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from access.redhat.com_2e1b8cbf_20250126_091300.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_4419f8d3_20250125_135639.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Fd8316f3991d207fe32881a9ac20241be8fa2bad0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Fd8316f3991d207fe32881a9ac20241be8fa2bad0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=torvalds%2Flinux)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[torvalds](/torvalds)
/
**[linux](/torvalds/linux)**
Public

* [Notifications](/login?return_to=%2Ftorvalds%2Flinux) You must be signed in to change notification settings
* [Fork
  54.9k](/login?return_to=%2Ftorvalds%2Flinux)
* [Star
   186k](/login?return_to=%2Ftorvalds%2Flinux)

* [Code](/torvalds/linux)
* [Pull requests
  437](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects
  0](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

Additional navigation options

* [Code](/torvalds/linux)
* [Pull requests](/torvalds/linux/pulls)
* [Actions](/torvalds/linux/actions)
* [Projects](/torvalds/linux/projects)
* [Security](/torvalds/linux/security)
* [Insights](/torvalds/linux/pulse)

## Commit

[Permalink](/torvalds/linux/commit/d8316f3991d207fe32881a9ac20241be8fa2bad0)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

vhost: fix total length when packets are too short

[Browse files](/torvalds/linux/tree/d8316f3991d207fe32881a9ac20241be8fa2bad0)
Browse the repository at this point in the history

```
When mergeable buffers are disabled, and the
incoming packet is too large for the rx buffer,
get_rx_bufs returns success.

This was intentional in order for make recvmsg
truncate the packet and then handle_rx would
detect err != sock_len and drop it.

Unfortunately we pass the original sock_len to
recvmsg - which means we use parts of iov not fully
validated.

Fix this up by detecting this overrun and doing packet drop
immediately.

[CVE-2014-0077](https://github.com/advisories/GHSA-r4f5-rm36-v672 "CVE-2014-0077")

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
```

* Loading branch information

[![@mstsirkin](https://avatars.githubusercontent.com/u/1062804?s=40&v=4)](/mstsirkin) [![@davem330](https://avatars.githubusercontent.com/u/1053866?s=40&v=4)](/davem330)

[mstsirkin](/torvalds/linux/commits?author=mstsirkin "View all commits by mstsirkin")
authored and
[davem330](/torvalds/linux/commits?author=davem330 "View all commits by davem330")
committed
Mar 28, 2014

1 parent
[05efa8c](/torvalds/linux/commit/05efa8c943b1d5d90fa8c8147571837573338bb6)

commit d8316f3

Showing
**1 changed file**
with
**14 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

14 changes: 14 additions & 0 deletions

14
[drivers/vhost/net.c](#diff-b73c197a7560c4117ce89a96cd674c117107ca8812b07ffb2d956665c4386119 "drivers/vhost/net.c")

Show comments

[View file](/torvalds/linux/blob/d8316f3991d207fe32881a9ac20241be8fa2bad0/drivers/vhost/net.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -532,6 +532,12 @@ static int get\_rx\_bufs(struct vhost\_virtqueue \*vq, |
|  |  | \*iovcount = seg; |
|  |  | if (unlikely(log)) |
|  |  | \*log\_num = nlogs; |
|  |  |  |
|  |  | /\* Detect overrun \*/ |
|  |  | if (unlikely(datalen > 0)) { |
|  |  | r = UIO\_MAXIOV + 1; |
|  |  | goto err; |
|  |  | } |
|  |  | return headcount; |
|  |  | err: |
|  |  | vhost\_discard\_vq\_desc(vq, headcount); |
| Expand Down  Expand Up | | @@ -587,6 +593,14 @@ static void handle\_rx(struct vhost\_net \*net) |
|  |  | /\* On error, stop handling until the next kick. \*/ |
|  |  | if (unlikely(headcount < 0)) |
|  |  | break; |
|  |  | /\* On overrun, truncate and discard \*/ |
|  |  | if (unlikely(headcount > UIO\_MAXIOV)) { |
|  |  | msg.msg\_iovlen = 1; |
|  |  | err = sock->ops->recvmsg(NULL, sock, &msg, |
|  |  | 1, MSG\_DONTWAIT | MSG\_TRUNC); |
|  |  | pr\_debug("Discarded rx packet: len %zd\n", sock\_len); |
|  |  | continue; |
|  |  | } |
|  |  | /\* OK, now we need to know about added descriptors. \*/ |
|  |  | if (!headcount) { |
|  |  | if (unlikely(vhost\_enable\_notify(&net->dev, vq))) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d8316f3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftorvalds%2Flinux%2Fcommit%2Fd8316f3991d207fe32881a9ac20241be8fa2bad0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.kernel.org_4d55ded4_20250125_135637.html ===
commit f994ec5a5d8094a195c23b08d373b055ef0044aa
Author: Greg Kroah-Hartman
Date: Mon Apr 14 06:48:24 2014 -0700
Linux 3.13.10
commit bb59d7ebdf66319846943886e0d0d0ea05a2f9f6
Author: Ard Biesheuvel
Date: Thu Mar 27 18:14:40 2014 +0100
crypto: ghash-clmulni-intel - use C implementation for setkey()
commit 8ceee72808d1ae3fb191284afc2257a2be964725 upstream.
The GHASH setkey() function uses SSE registers but fails to call
kernel\_fpu\_begin()/kernel\_fpu\_end(). Instead of adding these calls, and
then having to deal with the restriction that they cannot be called from
interrupt context, move the setkey() implementation to the C domain.
Note that setkey() does not use any particular SSE features and is not
expected to become a performance bottleneck.
Signed-off-by: Ard Biesheuvel
Acked-by: H. Peter Anvin
Fixes: 0e1227d356e9b (crypto: ghash - Add PCLMULQDQ accelerated implementation)
Signed-off-by: Herbert Xu
Signed-off-by: Greg Kroah-Hartman
commit a055a7bb7316773d8fb916cb990e238eb7ed67f5
Author: Finn Thain
Date: Thu Mar 6 10:29:27 2014 +1100
m68k: Skip futex\_atomic\_cmpxchg\_inatomic() test
commit e571c58f313d35c56e0018470e3375ddd1fd320e upstream.
Skip the futex\_atomic\_cmpxchg\_inatomic() test in futex\_init(). It causes a
fatal exception on 68030 (and presumably 68020 also).
Signed-off-by: Finn Thain
Acked-by: Geert Uytterhoeven
Link: http://lkml.kernel.org/r/alpine.LNX.2.00.1403061006440.5525@nippy.intranet
Signed-off-by: Thomas Gleixner
Signed-off-by: Greg Kroah-Hartman
commit 12ce0d10f491b4a377333398d5938aaf19e0d647
Author: Heiko Carstens
Date: Sun Mar 2 13:09:47 2014 +0100
futex: Allow architectures to skip futex\_atomic\_cmpxchg\_inatomic() test
commit 03b8c7b623c80af264c4c8d6111e5c6289933666 upstream.
If an architecture has futex\_atomic\_cmpxchg\_inatomic() implemented and there
is no runtime check necessary, allow to skip the test within futex\_init().
This allows to get rid of some code which would always give the same result,
and also allows the compiler to optimize a couple of if statements away.
Signed-off-by: Heiko Carstens
Cc: Finn Thain
Cc: Geert Uytterhoeven
Link: http://lkml.kernel.org/r/20140302120947.GA3641@osiris
Signed-off-by: Thomas Gleixner
[geert: Backported to v3.10..v3.13]
Signed-off-by: Geert Uytterhoeven
Signed-off-by: Greg Kroah-Hartman
commit e75c66297379f26c0a2c112b9c8d302ef0dd0e96
Author: Vineet Gupta
Date: Sat Apr 5 15:30:22 2014 +0530
ARC: [nsimosci] Unbork console
commit 61fb4bfc010b0d2940f7fd87acbce6a0f03217cb upstream.
Despite the switch to right UART driver (prev patch), serial console
still doesn't work due to missing CONFIG\_SERIAL\_OF\_PLATFORM
Also fix the default cmdline in DT to not refer to out-of-tree
ARC framebuffer driver for console.
Signed-off-by: Vineet Gupta
Cc: Francois Bedard
Signed-off-by: Greg Kroah-Hartman
commit 08a7b3c3749c9696ae85ea0d89c10a44dd44552b
Author: Mischa Jonker
Date: Thu May 16 19:36:08 2013 +0200
ARC: [nsimosci] Change .dts to use generic 8250 UART
commit 6eda477b3c54b8236868c8784e5e042ff14244f0 upstream.
The Synopsys APB DW UART has a couple of special features that are not
in the System C model. In 3.8, the 8250\_dw driver didn't really use these
features, but from 3.9 onwards, the 8250\_dw driver has become incompatible
with our model.
Signed-off-by: Mischa Jonker
Signed-off-by: Vineet Gupta
Cc: Francois Bedard
Signed-off-by: Greg Kroah-Hartman
commit b2c4b9547b22398498fd890c7f81db67ed0d8554
Author: Mikulas Patocka
Date: Wed Dec 11 19:39:19 2013 -0500
powernow-k6: reorder frequencies
commit 22c73795b101597051924556dce019385a1e2fa0 upstream.
This patch reorders reported frequencies from the highest to the lowest,
just like in other frequency drivers.
Signed-off-by: Mikulas Patocka
Acked-by: Viresh Kumar
Signed-off-by: Rafael J. Wysocki
Signed-off-by: Greg Kroah-Hartman
commit 2420afb95ad6577f961dc64c9463ee8abe0c6f4b
Author: Mikulas Patocka
Date: Wed Dec 11 19:38:53 2013 -0500
powernow-k6: correctly initialize default parameters
commit d82b922a4acc1781d368aceac2f9da43b038cab2 upstream.
The powernow-k6 driver used to read the initial multiplier from the
powernow register. However, there is a problem with this:
\* If there was a frequency transition before, the multiplier read from the
register corresponds to the current multiplier.
\* If there was no frequency transition since reset, the field in the
register always reads as zero, regardless of the current multiplier that
is set using switches on the mainboard and that the CPU is running at.
The zero value corresponds to multiplier 4.5, so as a consequence, the
powernow-k6 driver always assumes multiplier 4.5.
For example, if we have 550MHz CPU with bus frequency 100MHz and
multiplier 5.5, the powernow-k6 driver thinks that the multiplier is 4.5
and bus frequency is 122MHz. The powernow-k6 driver then sets the
multiplier to 4.5, underclocking the CPU to 450MHz, but reports the
current frequency as 550MHz.
There is no reliable way how to read the initial multiplier. I modified
the driver so that it contains a table of known frequencies (based on
parameters of existing CPUs and some common overclocking schemes) and sets
the multiplier according to the frequency. If the frequency is unknown
(because of unusual overclocking or underclocking), the user must supply
the bus speed and maximum multiplier as module parameters.
This patch should be backported to all stable kernels. If it doesn't
apply cleanly, change it, or ask me to change it.
Signed-off-by: Mikulas Patocka
Signed-off-by: Rafael J. Wysocki
Signed-off-by: Greg Kroah-Hartman
commit d6d2e9388f12580deb78a9055f26c1e224fd3761
Author: Mikulas Patocka
Date: Wed Dec 11 19:38:32 2013 -0500
powernow-k6: disable cache when changing frequency
commit e20e1d0ac02308e2211306fc67abcd0b2668fb8b upstream.
I found out that a system with k6-3+ processor is unstable during network
server load. The system locks up or the network card stops receiving. The
reason for the instability is the CPU frequency scaling.
During frequency transition the processor is in "EPM Stop Grant" state.
The documentation says that the processor doesn't respond to inquiry
requests in this state. Consequently, coherency of processor caches and
bus master devices is not maintained, causing the system instability.
This patch flushes the cache during frequency transition. It fixes the
instability.
Other minor changes:
\* u64 invalue changed to unsigned long because the variable is 32-bit
\* move the logic to set the multiplier to a separate function
powernow\_k6\_set\_cpu\_multiplier
\* preserve lower 5 bits of the powernow port instead of 4 (the voltage
field has 5 bits)
\* mask interrupts when reading the multiplier, so that the port is not
open during other activity (running other kernel code with the port open
shouldn't cause any misbehavior, but we should better be safe and keep
the port closed)
This patch should be backported to all stable kernels. If it doesn't
apply cleanly, change it, or ask me to change it.
Signed-off-by: Mikulas Patocka
Signed-off-by: Rafael J. Wysocki
Signed-off-by: Greg Kroah-Hartman
commit 5986352314c939fdf1108ae32c6e4a799029c92b
Author: Sasha Levin
Date: Sat Mar 29 20:39:35 2014 -0400
rds: prevent dereference of a NULL device in rds\_iw\_laddr\_check
[ Upstream commit bf39b4247b8799935ea91d90db250ab608a58e50 ]
Binding might result in a NULL device which is later dereferenced
without checking.
Signed-off-by: Sasha Levin
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit deb2eaa1b2f3a6f7fa0b3fa2c45751bd3b99d163
Author: Dan Carpenter
Date: Tue Apr 8 12:23:09 2014 +0300
isdnloop: several buffer overflows
[ Upstream commit 7563487cbf865284dcd35e9ef5a95380da046737 ]
There are three buffer overflows addressed in this patch.
1) In isdnloop\_fake\_err() we add an 'E' to a 60 character string and
then copy it into a 60 character buffer. I have made the destination
buffer 64 characters and I'm changed the sprintf() to a snprintf().
2) In isdnloop\_parse\_cmd(), p points to a 6 characters into a 60
character buffer so we have 54 characters. The ->eazlist[] is 11
characters long. I have modified the code to return if the source
buffer is too long.
3) In isdnloop\_command() the cbuf[] array was 60 characters long but the
max length of the string then can be up to 79 characters. I made the
cbuf array 80 characters long and changed the sprintf() to snprintf().
I also removed the temporary "dial" buffer and changed it to use "p"
directly.
Unfortunately, we pass the "cbuf" string from isdnloop\_command() to
isdnloop\_writecmd() which truncates anything over 60 characters to make
it fit in card->omsg[]. (It can accept values up to 255 characters so
long as there is a '\n' character every 60 characters). For now I have
just fixed the memory corruption bug and left the other problems in this
driver alone.
Signed-off-by: Dan Carpenter
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 4fbd2c2ef76cd24293a2ca8df0b4ae764db7b8d0
Author: YOSHIFUJI Hideaki
Date: Wed Apr 2 12:48:42 2014 +0900
isdnloop: Validate NUL-terminated strings from user.
[ Upstream commit 77bc6bed7121936bb2e019a8c336075f4c8eef62 ]
Return -EINVAL unless all of user-given strings are correctly
NUL-terminated.
Signed-off-by: YOSHIFUJI Hideaki
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit c95176f32b88f95a0d6592ded5387d4cf076d83b
Author: Mike Rapoport
Date: Tue Apr 1 09:23:01 2014 +0300
net: vxlan: fix crash when interface is created with no group
[ Upstream commit 5933a7bbb5de66482ea8aa874a7ebaf8e67603c4 ]
If the vxlan interface is created without explicit group definition,
there are corner cases which may cause kernel panic.
For instance, in the following scenario:
node A:
$ ip link add dev vxlan42 address 2c:c2:60:00:10:20 type vxlan id 42
$ ip addr add dev vxlan42 10.0.0.1/24
$ ip link set up dev vxlan42
$ arp -i vxlan42 -s 10.0.0.2 2c:c2:60:00:01:02
$ bridge fdb add dev vxlan42 to 2c:c2:60:00:01:02 dst
$ ping 10.0.0.2
node B:
$ ip link add dev vxlan42 address 2c:c2:60:00:01:02 type vxlan id 42
$ ip addr add dev vxlan42 10.0.0.2/24
$ ip link set up dev vxlan42
$ arp -i vxlan42 -s 10.0.0.1 2c:c2:60:00:10:20
node B crashes:
vxlan42: 2c:c2:60:00:10:20 migrated from 4011:eca4:c0a8:6466:c0a8:6415:8e09:2118 to (invalid address)
vxlan42: 2c:c2:60:00:10:20 migrated from 4011:eca4:c0a8:6466:c0a8:6415:8e09:2118 to (invalid address)
BUG: unable to handle kernel NULL pointer dereference at 0000000000000046
IP: [] ip6\_route\_output+0x58/0x82
PGD 7bd89067 PUD 7bd4e067 PMD 0
Oops: 0000 [#1] SMP
Modules linked in:
CPU: 1 PID: 0 Comm: swapper/1 Not tainted 3.14.0-rc8-hvx-xen-00019-g97a5221-dirty #154
Hardware name: Bochs Bochs, BIOS Bochs 01/01/2011
task: ffff88007c774f50 ti: ffff88007c79c000 task.ti: ffff88007c79c000
RIP: 0010:[] [] ip6\_route\_output+0x58/0x82
RSP: 0018:ffff88007fd03668 EFLAGS: 00010282
RAX: 0000000000000000 RBX: ffffffff8186a000 RCX: 0000000000000040
RDX: 0000000000000000 RSI: ffff88007b0e4a80 RDI: ffff88007fd03754
RBP: ffff88007fd03688 R08: ffff88007b0e4a80 R09: 0000000000000000
R10: 0200000a0100000a R11: 0001002200000000 R12: ffff88007fd03740
R13: ffff88007b0e4a80 R14: ffff88007b0e4a80 R15: ffff88007bba0c50
FS: 0000000000000000(0000) GS:ffff88007fd00000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 000000008005003b
CR2: 0000000000000046 CR3: 000000007bb60000 CR4: 00000000000006e0
Stack:
0000000000000000 ffff88007fd037a0 ffffffff8186a000 ffff88007fd03740
ffff88007fd036c8 ffffffff814320bb 0000000000006e49 ffff88007b8b7360
ffff88007bdbf200 ffff88007bcbc000 ffff88007b8b7000 ffff88007b8b7360
Call Trace:
[] ip6\_dst\_lookup\_tail+0x2d/0xa4
[] ip6\_dst\_lookup+0x10/0x12
[] vxlan\_xmit\_one+0x32a/0x68c
[] ? \_raw\_spin\_unlock\_irqrestore+0x12/0x14
[] ? lock\_timer\_base.isra.23+0x26/0x4b
[] vxlan\_xmit+0x66a/0x6a8
[] ? ipt\_do\_table+0x35f/0x37e
[] ? selinux\_ip\_postroute+0x41/0x26e
[] dev\_hard\_start\_xmit+0x2ce/0x3ce
[] \_\_dev\_queue\_xmit+0x2d0/0x392
[] ? eth\_header+0x28/0xb5
[] dev\_queue\_xmit+0xb/0xd
[] neigh\_resolve\_output+0x134/0x152
[] ip\_finish\_output2+0x236/0x299
[] ip\_finish\_output+0x98/0x9d
[] ip\_output+0x62/0x67
[] dst\_output+0xf/0x11
[] ip\_local\_out+0x1b/0x1f
[] ip\_send\_skb+0x11/0x37
[] ip\_push\_pending\_frames+0x2f/0x33
[] icmp\_push\_reply+0x106/0x115
[] icmp\_reply+0x142/0x164
[] icmp\_echo.part.16+0x46/0x48
[] ? nf\_iterate+0x43/0x80
[] ? xfrm4\_policy\_check.constprop.11+0x52/0x52
[] icmp\_echo+0x25/0x27
[] icmp\_rcv+0x1d2/0x20a
[] ? xfrm4\_policy\_check.constprop.11+0x52/0x52
[] ip\_local\_deliver\_finish+0xd6/0x14f
[] ? xfrm4\_policy\_check.constprop.11+0x52/0x52
[] NF\_HOOK.constprop.10+0x4c/0x53
[] ip\_local\_deliver+0x4a/0x4f
[] ip\_rcv\_finish+0x253/0x26a
[] ? inet\_add\_protocol+0x3e/0x3e
[] NF\_HOOK.constprop.10+0x4c/0x53
[] ip\_rcv+0x2a6/0x2ec
[] \_\_netif\_receive\_skb\_core+0x43e/0x478
[] ? virtqueue\_poll+0x16/0x27
[] \_\_netif\_receive\_skb+0x55/0x5a
[] process\_backlog+0x76/0x12f
[] net\_rx\_action+0xa2/0x1ab
[] \_\_do\_softirq+0xca/0x1d1
[] irq\_exit+0x3e/0x85
[] do\_IRQ+0xa9/0xc4
[] common\_interrupt+0x6d/0x6d
[] ? native\_safe\_halt+0x6/0x8
[] default\_idle+0x9/0xd
[] arch\_cpu\_idle+0x13/0x1c
[] cpu\_startup\_entry+0xbc/0x137
[] start\_secondary+0x1a0/0x1a5
Code: 24 14 e8 f1 e5 01 00 31 d2 a8 32 0f 95 c2 49 8b 44 24 2c 49 0b 44 24 24 74 05 83 ca 04 eb 1c 4d 85 ed 74 17 49 8b 85 a8 02 00 00 <66> 8b 40 46 66 c1 e8 07 83 e0 07 c1 e0 03 09 c2 4c 89 e6 48 89
RIP [] ip6\_route\_output+0x58/0x82
RSP
CR2: 0000000000000046
---[ end trace 4612329caab37efd ]---
When vxlan interface is created without explicit group definition, the
default\_dst protocol family is initialiazed to AF\_UNSPEC and the driver
assumes IPv4 configuration. On the other side, the default\_dst protocol
family is used to differentiate between IPv4 and IPv6 cases and, since,
AF\_UNSPEC != AF\_INET, the processing takes the IPv6 path.
Making the IPv4 assumption explicit by settting default\_dst protocol
family to AF\_INET4 and preventing mixing of IPv4 and IPv6 addresses in
snooped fdb entries fixes the corner case crashes.
Signed-off-by: Mike Rapoport
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 15c3d765f97e2d563182184f6446ba6afbeadfbf
Author: Daniel Pieczko
Date: Tue Apr 1 13:10:34 2014 +0100
Call efx\_set\_channels() before efx->type->dimension\_resources()
[ Upstream commit 52ad762b85ed7947ec9eff6b036eb985352f6874 ]
When using the "separate\_tx\_channels=1" module parameter, the TX queues are
initially numbered starting from the first TX-only channel number (after all the
RX-only channels). efx\_set\_channels() renumbers the queues so that they are
indexed from zero.
On EF10, the TX queues need to be relabelled in this way before calling the
dimension\_resources NIC type operation, otherwise the TX queue PIO buffers can be
linked to the wrong VIs when using "separate\_tx\_channels=1".
Added comments to explain UC/WC mappings for PIO buffers
Signed-off-by: Shradha Shah
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 0e4a1bc23a2243f3f6700b777b6f4dac52090437
Author: Wei Liu
Date: Tue Apr 1 12:46:12 2014 +0100
xen-netback: disable rogue vif in kthread context
[ Upstream commit e9d8b2c2968499c1f96563e6522c56958d5a1d0d ]
When netback discovers frontend is sending malformed packet it will
disables the interface which serves that frontend.
However disabling a network interface involving taking a mutex which
cannot be done in softirq context, so we need to defer this process to
kthread context.
This patch does the following:
1. introduce a flag to indicate the interface is disabled.
2. check that flag in TX path, don't do any work if it's true.
3. check that flag in RX path, turn off that interface if it's true.
The reason to disable it in RX path is because RX uses kthread. After
this change the behavior of netback is still consistent -- it won't do
any TX work for a rogue frontend, and the interface will be eventually
turned off.
Also change a "continue" to "break" after xenvif\_fatal\_tx\_err, as it
doesn't make sense to continue processing packets if frontend is rogue.
This is a fix for XSA-90.
Reported-by: Török Edwin
Signed-off-by: Wei Liu
Cc: Ian Campbell
Reviewed-by: David Vrabel
Acked-by: Ian Campbell
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 5c4f2fdaf68b2f9ec8f445a0c5a138ee6c4f6cd9
Author: Pablo Neira
Date: Tue Apr 1 19:38:44 2014 +0200
netlink: don't compare the nul-termination in nla\_strcmp
[ Upstream commit 8b7b932434f5eee495b91a2804f5b64ebb2bc835 ]
nla\_strcmp compares the string length plus one, so it's implicitly
including the nul-termination in the comparison.
int nla\_strcmp(const struct nlattr \*nla, const char \*str)
{
int len = strlen(str) + 1;
...
d = memcmp(nla\_data(nla), str, len);
However, if NLA\_STRING is used, userspace can send us a string without
the nul-termination. This is a problem since the string
comparison will not match as the last byte may be not the
nul-termination.
Fix this by skipping the comparison of the nul-termination if the
attribute data is nul-terminated. Suggested by Thomas Graf.
Cc: Florian Westphal
Cc: Thomas Graf
Signed-off-by: Pablo Neira Ayuso
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 0f11c2a166af8686745f75170b7c1008c9b42761
Author: Hannes Frederic Sowa
Date: Mon Mar 31 20:14:10 2014 +0200
ipv6: some ipv6 statistic counters failed to disable bh
[ Upstream commit 43a43b6040165f7b40b5b489fe61a4cb7f8c4980 ]
After commit c15b1ccadb323ea ("ipv6: move DAD and addrconf\_verify
processing to workqueue") some counters are now updated in process context
and thus need to disable bh before doing so, otherwise deadlocks can
happen on 32-bit archs. Fabio Estevam noticed this while while mounting
a NFS volume on an ARM board.
As a compensation for missing this I looked after the other \*\_STATS\_BH
and found three other calls which need updating:
1) icmp6\_send: ip6\_fragment -> icmpv6\_send -> icmp6\_send (error handling)
2) ip6\_push\_pending\_frames: rawv6\_sendmsg -> rawv6\_push\_pending\_frames -> ...
(only in case of icmp protocol with raw sockets in error handling)
3) ping6\_v6\_sendmsg (error handling)
Fixes: c15b1ccadb323ea ("ipv6: move DAD and addrconf\_verify processing to workqueue")
Reported-by: Fabio Estevam
Tested-by: Fabio Estevam
Cc: Eric Dumazet
Signed-off-by: Hannes Frederic Sowa
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit cadf431bb527964be519675e560fd61db498fe98
Author: Paul Durrant
Date: Fri Mar 28 11:39:05 2014 +0000
xen-netback: remove pointless clause from if statement
[ Upstream commit 0576eddf24df716d8570ef8ca11452a9f98eaab2 ]
This patch removes a test in start\_new\_rx\_buffer() that checks whether
a copy operation is less than MAX\_BUFFER\_OFFSET in length, since
MAX\_BUFFER\_OFFSET is defined to be PAGE\_SIZE and the only caller of
start\_new\_rx\_buffer() already limits copy operations to PAGE\_SIZE or less.
Signed-off-by: Paul Durrant
Cc: Ian Campbell
Cc: Wei Liu
Cc: Sander Eikelenboom
Reported-By: Sander Eikelenboom
Tested-By: Sander Eikelenboom
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 569e4b6489af7e15a10c543b472356a1724a1491
Author: Eric Dumazet
Date: Thu Mar 27 07:19:19 2014 -0700
tcp: fix get\_timewait4\_sock() delay computation on 64bit
[ Upstream commit e2a1d3e47bb904082b758dec9d07edf241c45d05 ]
It seems I missed one change in get\_timewait4\_sock() to compute
the remaining time before deletion of IPV4 timewait socket.
This could result in wrong output in /proc/net/tcp for tm->when field.
Fixes: 96f817fedec4 ("tcp: shrink tcp6\_timewait\_sock by one cache line")
Signed-off-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit f0213f63e141fd6f023e263180db1ce91ef3cb55
Author: Michael S. Tsirkin
Date: Thu Mar 27 12:53:37 2014 +0200
vhost: validate vhost\_get\_vq\_desc return value
[ Upstream commit a39ee449f96a2cd44ce056d8a0a112211a9b1a1f ]
vhost fails to validate negative error code
from vhost\_get\_vq\_desc causing
a crash: we are using -EFAULT which is 0xfffffff2
as vector size, which exceeds the allocated size.
The code in question was introduced in commit
8dd014adfea6f173c1ef6378f7e5e7924866c923
vhost-net: mergeable buffers support
CVE-2014-0055
Signed-off-by: Michael S. Tsirkin
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 2c1e023a1882c841575a7647572196bd1586409c
Author: Michael S. Tsirkin
Date: Thu Mar 27 12:00:26 2014 +0200
vhost: fix total length when packets are too short
[ Upstream commit d8316f3991d207fe32881a9ac20241be8fa2bad0 ]
When mergeable buffers are disabled, and the
incoming packet is too large for the rx buffer,
get\_rx\_bufs returns success.
This was intentional in order for make recvmsg
truncate the packet and then handle\_rx would
detect err != sock\_len and drop it.
Unfortunately we pass the original sock\_len to
recvmsg - which means we use parts of iov not fully
validated.
Fix this up by detecting this overrun and doing packet drop
immediately.
CVE-2014-0077
Signed-off-by: Michael S. Tsirkin
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit c69b36124135f7e7f2f9f82912480dd5428201d9
Author: Vlad Yasevich
Date: Wed Mar 26 11:47:56 2014 -0400
vlan: Set hard\_header\_len according to available acceleration
[ Upstream commit fc0d48b8fb449ca007b2057328abf736cb516168 ]
Currently, if the card supports CTAG acceleration we do not
account for the vlan header even if we are configuring an
8021AD vlan. This may not be best since we'll do software
tagging for 8021AD which will cause data copy on skb head expansion
Configure the length based on available hw offload capabilities and
vlan protocol.
CC: Patrick McHardy
Signed-off-by: Vlad Yasevich
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 72e46f6e69c9ae676c5e0652be0a5d38de568ab5
Author: Oliver Neukum
Date: Wed Mar 26 14:32:51 2014 +0100
usbnet: include wait queue head in device structure
[ Upstream commit 14a0d635d18d0fb552dcc979d6d25106e6541f2e ]
This fixes a race which happens by freeing an object on the stack.
Quoting Julius:
> The issue is
> that it calls usbnet\_terminate\_urbs() before that, which temporarily
> installs a waitqueue in dev->wait in order to be able to wait on the
> tasklet to run and finish up some queues. The waiting itself looks
> okay, but the access to 'dev->wait' is totally unprotected and can
> race arbitrarily. I think in this case usbnet\_bh() managed to succeed
> it's dev->wait check just before usbnet\_terminate\_urbs() sets it back
> to NULL. The latter then finishes and the waitqueue\_t structure on its
> stack gets overwritten by other functions halfway through the
> wake\_up() call in usbnet\_bh().
The fix is to just not allocate the data structure on the stack.
As dev->wait is abused as a flag it also takes a runtime PM change
to fix this bug.
Signed-off-by: Oliver Neukum
Reported-by: Grant Grundler
Tested-by: Grant Grundler
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 1cc4545b64bb70290712e12c4e306867ea3357c9
Author: Jason Wang
Date: Wed Mar 26 13:03:00 2014 +0800
virtio-net: correct error handling of virtqueue\_kick()
[ Upstream commit 681daee2443291419c57cccb0671f5f94a839005 ]
Current error handling of virtqueue\_kick() was wrong in two places:
- The skb were freed immediately when virtqueue\_kick() fail during
xmit. This may lead double free since the skb was not detached from
the virtqueue.
- try\_fill\_recv() returns false when virtqueue\_kick() fail. This will
lead unnecessary rescheduling of refill work.
Actually, it's safe to just ignore the kick failure in those two
places. So this patch fixes this by partially revert commit
67975901183799af8e93ec60e322f9e2a1940b9b.
Fixes 67975901183799af8e93ec60e322f9e2a1940b9b
(virtio\_net: verify if virtqueue\_kick() succeeded).
Cc: Heinz Graalfs
Cc: Rusty Russell
Cc: Michael S. Tsirkin
Signed-off-by: Jason Wang
Acked-by: Michael S. Tsirkin
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 5ff906bf6e0a6e404aec88f27101904159d24508
Author: Vlad Yasevich
Date: Mon Mar 24 17:52:12 2014 -0400
tg3: Do not include vlan acceleration features in vlan\_features
[ Upstream commit 51dfe7b944998eaeb2b34d314f3a6b16a5fd621b ]
Including hardware acceleration features in vlan\_features breaks
stacked vlans (Q-in-Q) by marking the bottom vlan interface as
capable of acceleration. This causes one of the tags to be lost
and the packets are sent with a sing vlan header.
CC: Nithin Nayak Sujir
CC: Michael Chan
Signed-off-by: Vlad Yasevich
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 21ee270ccf2d5a91cabbd40a2ffc0d3ab80fedb9
Author: Pravin B Shelar
Date: Sun Mar 23 22:06:36 2014 -0700
ip\_tunnel: Fix dst ref-count.
[ Upstream commit fbd02dd405d0724a0f25897ed4a6813297c9b96f ]
Commit 10ddceb22ba (ip\_tunnel:multicast process cause panic due
to skb->\_skb\_refdst NULL pointer) removed dst-drop call from
ip-tunnel-recv.
Following commit reintroduce dst-drop and fix the original bug by
checking loopback packet before releasing dst.
Original bug: https://bugzilla.kernel.org/show\_bug.cgi?id=70681
CC: Xin Long
Signed-off-by: Pravin B Shelar
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit e78e7aa146835ad539534fe98e573043a73797f1
Author: Erik Hugne
Date: Mon Mar 24 16:56:38 2014 +0100
tipc: fix spinlock recursion bug for failed subscriptions
[ Upstream commit a5d0e7c037119484a7006b883618bfa87996cb41 ]
If a topology event subscription fails for any reason, such as out
of memory, max number reached or because we received an invalid
request the correct behavior is to terminate the subscribers
connection to the topology server. This is currently broken and
produces the following oops:
[27.953662] tipc: Subscription rejected, illegal request
[27.955329] BUG: spinlock recursion on CPU#1, kworker/u4:0/6
[27.957066] lock: 0xffff88003c67f408, .magic: dead4ead, .owner: kworker/u4:0/6, .owner\_cpu: 1
[27.958054] CPU: 1 PID: 6 Comm: kworker/u4:0 Not tainted 3.14.0-rc6+ #5
[27.960230] Hardware name: Bochs Bochs, BIOS Bochs 01/01/2011
[27.960874] Workqueue: tipc\_rcv tipc\_recv\_work [tipc]
[27.961430] ffff88003c67f408 ffff88003de27c18 ffffffff815c0207 ffff88003de1c050
[27.962292] ffff88003de27c38 ffffffff815beec5 ffff88003c67f408 ffffffff817f0a8a
[27.963152] ffff88003de27c58 ffffffff815beeeb ffff88003c67f408 ffffffffa0013520
[27.964023] Call Trace:
[27.964292] [] dump\_stack+0x45/0x56
[27.964874] [] spin\_dump+0x8c/0x91
[27.965420] [] spin\_bug+0x21/0x26
[27.965995] [] do\_raw\_spin\_lock+0x116/0x140
[27.966631] [] \_raw\_spin\_lock\_bh+0x15/0x20
[27.967256] [] subscr\_conn\_shutdown\_event+0x20/0xa0 [tipc]
[27.968051] [] tipc\_close\_conn+0xa4/0xb0 [tipc]
[27.968722] [] tipc\_conn\_terminate+0x1a/0x30 [tipc]
[27.969436] [] subscr\_conn\_msg\_event+0x1f2/0x2f0 [tipc]
[27.970209] [] tipc\_receive\_from\_sock+0x90/0xf0 [tipc]
[27.970972] [] tipc\_recv\_work+0x29/0x50 [tipc]
[27.971633] [] process\_one\_work+0x165/0x3e0
[27.972267] [] worker\_thread+0x119/0x3a0
[27.972896] [] ? manage\_workers.isra.25+0x2a0/0x2a0
[27.973622] [] kthread+0xdf/0x100
[27.974168] [] ? kthread\_create\_on\_node+0x1a0/0x1a0
[27.974893] [] ret\_from\_fork+0x7c/0xb0
[27.975466] [] ? kthread\_create\_on\_node+0x1a0/0x1a0
The recursion occurs when subscr\_terminate tries to grab the
subscriber lock, which is already taken by subscr\_conn\_msg\_event.
We fix this by checking if the request to establish a new
subscription was successful, and if not we initiate termination of
the subscriber after we have released the subscriber lock.
Signed-off-by: Erik Hugne
Reviewed-by: Jon Maloy
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit ad52e55b70e250f8835efe5757cc49b3cb11388b
Author: Li RongQing
Date: Fri Mar 21 20:53:57 2014 +0800
netpoll: fix the skb check in pkt\_is\_ns
[ Not applicable upstream commit, the code here has been removed
upstream. ]
Neighbor Solicitation is ipv6 protocol, so we should check
skb->protocol with ETH\_P\_IPV6
Signed-off-by: Li RongQing
Cc: WANG Cong
Signed-off-by: Greg Kroah-Hartman
commit 5bd0d8ba2538d16961e31c92d62cabaa1d3c9b58
Author: Nishanth Menon
Date: Fri Mar 21 01:52:48 2014 -0500
net: micrel : ks8851-ml: add vdd-supply support
[ Upstream commit ebf4ad955d3e26d4d2a33709624fc7b5b9d3b969 ]
Few platforms use external regulator to keep the ethernet MAC supplied.
So, request and enable the regulator for driver functionality.
Fixes: 66fda75f47dc (regulator: core: Replace direct ops->disable usage)
Reported-by: Russell King
Suggested-by: Markus Pargmann
Signed-off-by: Nishanth Menon
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 80171529b800b4f2e5be2ba4307cd6e94b18aef1
Author: Nicolas Dichtel
Date: Wed Mar 19 17:47:51 2014 +0100
ip6mr: fix mfc notification flags
[ Upstream commit f518338b16038beeb73e155e60d0f70beb9379f4 ]
Commit 812e44dd1829 ("ip6mr: advertise new mfc entries via rtnl") reuses the
function ip6mr\_fill\_mroute() to notify mfc events.
But this function was used only for dump and thus was always setting the
flag NLM\_F\_MULTI, which is wrong in case of a single notification.
Libraries like libnl will wait forever for NLMSG\_DONE.
CC: Thomas Graf
Signed-off-by: Nicolas Dichtel
Acked-by: Thomas Graf
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 8605c10e5859a56079d52aa15c6d1b4121d4eab7
Author: Nicolas Dichtel
Date: Wed Mar 19 17:47:50 2014 +0100
ipmr: fix mfc notification flags
[ Upstream commit 65886f439ab0fdc2dff20d1fa87afb98c6717472 ]
Commit 8cd3ac9f9b7b ("ipmr: advertise new mfc entries via rtnl") reuses the
function ipmr\_fill\_mroute() to notify mfc events.
But this function was used only for dump and thus was always setting the
flag NLM\_F\_MULTI, which is wrong in case of a single notification.
Libraries like libnl will wait forever for NLMSG\_DONE.
CC: Thomas Graf
Signed-off-by: Nicolas Dichtel
Acked-by: Thomas Graf
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 69ccd9b2df19189ea45ce07675c4e00b0df732c2
Author: Nicolas Dichtel
Date: Wed Mar 19 17:47:49 2014 +0100
rtnetlink: fix fdb notification flags
[ Upstream commit 1c104a6bebf3c16b6248408b84f91d09ac8a26b6 ]
Commit 3ff661c38c84 ("net: rtnetlink notify events for FDB NTF\_SELF adds and
deletes") reuses the function nlmsg\_populate\_fdb\_fill() to notify fdb events.
But this function was used only for dump and thus was always setting the
flag NLM\_F\_MULTI, which is wrong in case of a single notification.
Libraries like libnl will wait forever for NLMSG\_DONE.
CC: Thomas Graf
Signed-off-by: Nicolas Dichtel
Acked-by: Thomas Graf
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 652c3e3e38667d11e6e7ca204497930c24d059c3
Author: Eric Dumazet
Date: Wed Mar 19 21:02:21 2014 -0700
tcp: syncookies: do not use getnstimeofday()
[ Upstream commit 632623153196bf183a69686ed9c07eee98ff1bf8 ]
While it is true that getnstimeofday() uses about 40 cycles if TSC
is available, it can use 1600 cycles if hpet is the clocksource.
Switch to get\_jiffies\_64(), as this is more than enough, and
go back to 60 seconds periods.
Fixes: 8c27bd75f04f ("tcp: syncookies: reduce cookie lifetime to 128 seconds")
Signed-off-by: Eric Dumazet
Cc: Florian Westphal
Acked-by: Florian Westphal
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 3927dace523706cc00f808520eaf2125dd7c07b5
Author: David Stevens
Date: Mon Mar 24 10:39:58 2014 -0400
vxlan: fix nonfunctional neigh\_reduce()
[ Upstream commit 4b29dba9c085a4fb79058fb1c45a2f6257ca3dfa ]
The VXLAN neigh\_reduce() code is completely non-functional since
check-in. Specific errors:
1) The original code drops all packets with a multicast destination address,
even though neighbor solicitations are sent to the solicited-node
address, a multicast address. The code after this check was never run.
2) The neighbor table lookup used the IPv6 header destination, which is the
solicited node address, rather than the target address from the
neighbor solicitation. So neighbor lookups would always fail if it
got this far. Also for L3MISSes.
3) The code calls ndisc\_send\_na(), which does a send on the tunnel device.
The context for neigh\_reduce() is the transmit path, vxlan\_xmit(),
where the host or a bridge-attached neighbor is trying to transmit
a neighbor solicitation. To respond to it, the tunnel endpoint needs
to do a \*receive\* of the appropriate neighbor advertisement. Doing a
send, would only try to send the advertisement, encapsulated, to the
remote destinations in the fdb -- hosts that definitely did not do the
corresponding solicitation.
4) The code uses the tunnel endpoint IPv6 forwarding flag to determine the
isrouter flag in the advertisement. This has nothing to do with whether
or not the target is a router, and generally won't be set since the
tunnel endpoint is bridging, not routing, traffic.
The patch below creates a proxy neighbor advertisement to respond to
neighbor solicitions as intended, providing proper IPv6 support for neighbor
reduction.
Signed-off-by: David L Stevens
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit e1ef50212d122b0e775fb234b4c1523d52859acb
Author: David Stevens
Date: Tue Mar 18 12:32:29 2014 -0400
vxlan: fix potential NULL dereference in arp\_reduce()
[ Upstream commit 7346135dcd3f9b57f30a5512094848c678d7143e ]
This patch fixes a NULL pointer dereference in the event of an
skb allocation failure in arp\_reduce().
Signed-Off-By: David L Stevens
Acked-by: Cong Wang
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 7e2c8e661df7e27d6045822f29cf07e346053d6d
Author: Bjørn Mork
Date: Mon Mar 17 16:25:18 2014 +0100
net: cdc\_ncm: fix control message ordering
[ Upstream commit ff0992e9036e9810e7cd45234fa32ca1e79750e2 ]
This is a context modified revert of commit 6a9612e2cb22
("net: cdc\_ncm: remove ncm\_parm field") which introduced
a NCM specification violation, causing setup errors for
some devices. These errors resulted in the device and
host disagreeing about shared settings, with complete
failure to communicate as the end result.
The NCM specification require that many of the NCM specific
control reuests are sent only while the NCM Data Interface
is in alternate setting 0. Reverting the commit ensures that
we follow this requirement.
Fixes: 6a9612e2cb22 ("net: cdc\_ncm: remove ncm\_parm field")
Reported-and-tested-by: Pasi Kärkkäinen
Reported-by: Thomas Schäfer
Signed-off-by: Bjørn Mork
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 3e6a4ac48b3ae99739143b03076b341c0137a982
Author: lucien
Date: Mon Mar 17 12:51:01 2014 +0800
ipv6: ip6\_append\_data\_mtu do not handle the mtu of the second fragment properly
[ Upstream commit e367c2d03dba4c9bcafad24688fadb79dd95b218 ]
In ip6\_append\_data\_mtu(), when the xfrm mode is not tunnel(such as
transport),the ipsec header need to be added in the first fragment, so the mtu
will decrease to reserve space for it, then the second fragment come, the mtu
should be turn back, as the commit 0c1833797a5a6ec23ea9261d979aa18078720b74
said. however, in the commit a493e60ac4bbe2e977e7129d6d8cbb0dd236be, it use
\*mtu = min(\*mtu, ...) to change the mtu, which lead to the new mtu is alway
equal with the first fragment's. and cannot turn back.
when I test through ping6 -c1 -s5000 $ip (mtu=1280):
...frag (0|1232) ESP(spi=0x00002000,seq=0xb), length 1232
...frag (1232|1216)
...frag (2448|1216)
...frag (3664|1216)
...frag (4880|164)
which should be:
...frag (0|1232) ESP(spi=0x00001000,seq=0x1), length 1232
...frag (1232|1232)
...frag (2464|1232)
...frag (3696|1232)
...frag (4928|116)
so delete the min() when change back the mtu.
Signed-off-by: Xin Long
Fixes: 75a493e60ac4bb ("ipv6: ip6\_append\_data\_mtu did not care about pmtudisc and frag\_size")
Acked-by: Hannes Frederic Sowa
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 2e1540c3867a3b921c387c35101f49220c4efbd5
Author: Heiner Kallweit
Date: Wed Mar 12 22:13:19 2014 +0100
ipv6: Avoid unnecessary temporary addresses being generated
[ Upstream commit ecab67015ef6e3f3635551dcc9971cf363cc1cd5 ]
tmp\_prefered\_lft is an offset to ifp->tstamp, not now. Therefore
age needs to be added to the condition.
Age calculation in ipv6\_create\_tempaddr is different from the one
in addrconf\_verify and doesn't consider ADDRCONF\_TIMER\_FUZZ\_MINUS.
This can cause age in ipv6\_create\_tempaddr to be less than the one
in addrconf\_verify and therefore unnecessary temporary address to
be generated.
Use age calculation as in addrconf\_modify to avoid this.
Signed-off-by: Heiner Kallweit
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 20ffb64d6f8f4dc93952f90142107f31d4298161
Author: Stefan Wahren
Date: Wed Mar 12 11:28:19 2014 +0100
eth: fec: Fix lost promiscuous mode after reconnecting cable
[ Upstream commit 84fe61821e4ebab6322eeae3f3c27f77f0031978 ]
If the Freescale fec is in promiscuous mode and network cable is
reconnected then the promiscuous mode get lost. The problem is caused
by a too soon call of set\_multicast\_list to re-enable promisc mode.
The FEC\_R\_CNTRL register changes are overwritten by fec\_restart.
This patch fixes this by moving the call behind the init of FEC\_R\_CNTRL
register in fec\_restart.
Successful tested on a i.MX28 board.
Signed-off-by: Stefan Wahren
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit c0384f5d2d6582891e3229dd857378a7ffd77d0f
Author: dingtianhong
Date: Wed Mar 12 17:31:59 2014 +0800
bonding: set correct vlan id for alb xmit path
[ Upstream commit fb00bc2e6cd2046282ba4b03f4fe682aee70b2f8 ]
The commit d3ab3ffd1d728d7ee77340e7e7e2c7cfe6a4013e
(bonding: use rlb\_client\_info->vlan\_id instead of ->tag)
remove the rlb\_client\_info->tag, but occur some issues,
The vlan\_get\_tag() will return 0 for success and -EINVAL for
error, so the client\_info->vlan\_id always be set to 0 if the
vlan\_get\_tag return 0 for success, so the client\_info would
never get a correct vlan id.
We should only set the vlan id to 0 when the vlan\_get\_tag return error.
Fixes: d3ab3ffd1d7 (bonding: use rlb\_client\_info->vlan\_id instead of ->tag)
CC: Ding Tianhong
CC: Jay Vosburgh
CC: Andy Gospodarek
Signed-off-by: Ding Tianhong
Acked-by: Veaceslav Falico
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit aaf5da50027d01a039ae3d3102ea8e62e4e33d7c
Author: Matthew Leach
Date: Tue Mar 11 11:58:27 2014 +0000
net: socket: error on a negative msg\_namelen
[ Upstream commit dbb490b96584d4e958533fb637f08b557f505657 ]
When copying in a struct msghdr from the user, if the user has set the
msg\_namelen parameter to a negative value it gets clamped to a valid
size due to a comparison between signed and unsigned values.
Ensure the syscall errors when the user passes in a negative value.
Signed-off-by: Matthew Leach
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit a00acd077a49721fc399f89f4950c3dc597ef3d6
Author: Linus Lüssing
Date: Mon Mar 10 22:25:25 2014 +0100
bridge: multicast: enable snooping on general queries only
[ Upstream commit 20a599bec95a52fa72432b2376a2ce47c5bb68fb ]
Without this check someone could easily create a denial of service
by injecting multicast-specific queries to enable the bridge
snooping part if no real querier issuing periodic general queries
is present on the link which would result in the bridge wrongly
shutting down ports for multicast traffic as the bridge did not learn
about these listeners.
With this patch the snooping code is enabled upon receiving valid,
general queries only.
Signed-off-by: Linus Lüssing
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 3bc6750d9d2f02fcf4b92408fdd624ad48c13491
Author: Linus Lüssing
Date: Mon Mar 10 22:25:24 2014 +0100
bridge: multicast: add sanity check for general query destination
[ Upstream commit 9ed973cc40c588abeaa58aea0683ea665132d11d ]
General IGMP and MLD queries are supposed to have the multicast
link-local all-nodes address as their destination according to RFC2236
section 9, RFC3376 section 4.1.12/9.1, RFC2710 section 8 and RFC3810
section 5.1.15.
Without this check, such malformed IGMP/MLD queries can result in a
denial of service: The queries are ignored by most IGMP/MLD listeners
therefore they will not respond with an IGMP/MLD report. However,
without this patch these malformed MLD queries would enable the
snooping part in the bridge code, potentially shutting down the
according ports towards these hosts for multicast traffic as the
bridge did not learn about these listeners.
Reported-by: Jan Stancek
Signed-off-by: Linus Lüssing
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 426f46a7985905445cfedbb00e95d9417d530649
Author: Eric Dumazet
Date: Mon Mar 10 09:50:11 2014 -0700
tcp: tcp\_release\_cb() should release socket ownership
[ Upstream commit c3f9b01849ef3bc69024990092b9f42e20df7797 ]
Lars Persson reported following deadlock :
-000 |M:0x0:0x802B6AF8(asm) <-- arch\_spin\_lock
-001 |tcp\_v4\_rcv(skb = 0x8BD527A0) <-- sk = 0x8BE6B2A0
-002 |ip\_local\_deliver\_finish(skb = 0x8BD527A0)
-003 |\_\_netif\_receive\_skb\_core(skb = 0x8BD527A0, ?)
-004 |netif\_receive\_skb(skb = 0x8BD527A0)
-005 |elk\_poll(napi = 0x8C770500, budget = 64)
-006 |net\_rx\_action(?)
-007 |\_\_do\_softirq()
-008 |do\_softirq()
-009 |local\_bh\_enable()
-010 |tcp\_rcv\_established(sk = 0x8BE6B2A0, skb = 0x87D3A9E0, th = 0x814EBE14, ?)
-011 |tcp\_v4\_do\_rcv(sk = 0x8BE6B2A0, skb = 0x87D3A9E0)
-012 |tcp\_delack\_timer\_handler(sk = 0x8BE6B2A0)
-013 |tcp\_release\_cb(sk = 0x8BE6B2A0)
-014 |release\_sock(sk = 0x8BE6B2A0)
-015 |tcp\_sendmsg(?, sk = 0x8BE6B2A0, ?, ?)
-016 |sock\_sendmsg(sock = 0x8518C4C0, msg = 0x87D8DAA8, size = 4096)
-017 |kernel\_sendmsg(?, ?, ?, ?, size = 4096)
-018 |smb\_send\_kvec()
-019 |smb\_send\_rqst(server = 0x87C4D400, rqst = 0x87D8DBA0)
-020 |cifs\_call\_async()
-021 |cifs\_async\_writev(wdata = 0x87FD6580)
-022 |cifs\_writepages(mapping = 0x852096E4, wbc = 0x87D8DC88)
-023 |\_\_writeback\_single\_inode(inode = 0x852095D0, wbc = 0x87D8DC88)
-024 |writeback\_sb\_inodes(sb = 0x87D6D800, wb = 0x87E4A9C0, work = 0x87D8DD88)
-025 |\_\_writeback\_inodes\_wb(wb = 0x87E4A9C0, work = 0x87D8DD88)
-026 |wb\_writeback(wb = 0x87E4A9C0, work = 0x87D8DD88)
-027 |wb\_do\_writeback(wb = 0x87E4A9C0, force\_wait = 0)
-028 |bdi\_writeback\_workfn(work = 0x87E4A9CC)
-029 |process\_one\_work(worker = 0x8B045880, work = 0x87E4A9CC)
-030 |worker\_thread(\_\_worker = 0x8B045880)
-031 |kthread(\_create = 0x87CADD90)
-032 |ret\_from\_kernel\_thread(asm)
Bug occurs because \_\_tcp\_checksum\_complete\_user() enables BH, assuming
it is running from softirq context.
Lars trace involved a NIC without RX checksum support but other points
are problematic as well, like the prequeue stuff.
Problem is triggered by a timer, that found socket being owned by user.
tcp\_release\_cb() should call tcp\_write\_timer\_handler() or
tcp\_delack\_timer\_handler() in the appropriate context :
BH disabled and socket lock held, but 'owned' field cleared,
as if they were running from timer handlers.
Fixes: 6f458dfb4092 ("tcp: improve latencies of timer triggered events")
Reported-by: Lars Persson
Tested-by: Lars Persson
Signed-off-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit bb5393acc2ccb3cb0f94cf5f4374ef250b3bca40
Author: Michael S. Tsirkin
Date: Mon Mar 10 19:28:08 2014 +0200
skbuff: skb\_segment: orphan frags before copying
[ Upstream commit 1fd819ecb90cc9b822cd84d3056ddba315d3340f ]
skb\_segment copies frags around, so we need
to copy them carefully to avoid accessing
user memory after reporting completion to userspace
through a callback.
skb\_segment doesn't normally happen on datapath:
TSO needs to be disabled - so disabling zero copy
in this case does not look like a big deal.
Signed-off-by: Michael S. Tsirkin
Acked-by: Herbert Xu
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 0490e20d47bb1b1d26ddcce1d180338560784bf0
Author: Michael S. Tsirkin
Date: Mon Mar 10 19:27:59 2014 +0200
skbuff: skb\_segment: s/fskb/list\_skb/
[ Upstream commit 1a4cedaf65491e66e1e55b8428c89209da729209 ]
fskb is unrelated to frag: it's coming from
frag\_list. Rename it list\_skb to avoid confusion.
Signed-off-by: Michael S. Tsirkin
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit e375025a39b44459f5200c84a6ba8ac7c45ac326
Author: Michael S. Tsirkin
Date: Mon Mar 10 18:29:19 2014 +0200
skbuff: skb\_segment: s/skb/head\_skb/
[ Upstream commit df5771ffefb13f8af5392bd54fd7e2b596a3a357 ]
rename local variable to make it easier to tell at a glance that we are
dealing with a head skb.
Signed-off-by: Michael S. Tsirkin
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit b6d713db7651101cb2ce886e08a7c48658d85896
Author: Michael S. Tsirkin
Date: Mon Mar 10 18:29:14 2014 +0200
skbuff: skb\_segment: s/skb\_frag/frag/
[ Upstream commit 4e1beba12d094c6c761ba5c49032b9b9e46380e8 ]
skb\_frag can in fact point at either skb
or fskb so rename it generally "frag".
Signed-off-by: Michael S. Tsirkin
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit fe50c072d1326497ea9b1e7873d52382ff04c37a
Author: Michael S. Tsirkin
Date: Mon Mar 10 18:29:04 2014 +0200
skbuff: skb\_segment: s/frag/nskb\_frag/
[ Upstream commit 8cb19905e9287a93ce7c2cbbdf742a060b00e219 ]
frag points at nskb, so name it appropriately
Signed-off-by: Michael S. Tsirkin
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 92a887902f1ce91160183372e10c5ea7635efcd4
Author: Peter Boström
Date: Mon Mar 10 16:17:15 2014 +0100
vlan: Set correct source MAC address with TX VLAN offload enabled
[ Upstream commit dd38743b4cc2f86be250eaf156cf113ba3dd531a ]
With TX VLAN offload enabled the source MAC address for frames sent using the
VLAN interface is currently set to the address of the real interface. This is
wrong since the VLAN interface may be configured with a different address.
The bug was introduced in commit 2205369a314e12fcec4781cc73ac9c08fc2b47de
("vlan: Fix header ops passthru when doing TX VLAN offload.").
This patch sets the source address before calling the create function of the
real interface.
Signed-off-by: Peter Boström
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 66295293f1c89b83290dc610db9f8fc555f5a92b
Author: Annie Li
Date: Mon Mar 10 22:58:34 2014 +0800
Xen-netback: Fix issue caused by using gso\_type wrongly
[ Upstream commit 5bd076708664313f2bdbbc1cf71093313b7774a1 ]
Current netback uses gso\_type to check whether the skb contains
gso offload, and this is wrong. Gso\_size is the right one to
check gso existence, and gso\_type is only used to check gso type.
Some skbs contains nonzero gso\_type and zero gso\_size, current
netback would treat these skbs as gso and create wrong response
for this. This also causes ssh failure to domu from other server.
V2: use skb\_is\_gso function as Paul Durrant suggested
Signed-off-by: Annie Li
Acked-by: Wei Liu
Reviewed-by: Paul Durrant
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit eafe827b3bff6faf6c108a7b24e4bb6a025bd514
Author: Eric Dumazet
Date: Thu Mar 6 22:57:52 2014 -0800
pkt\_sched: fq: do not hold qdisc lock while allocating memory
[ Upstream commit 2d8d40afd187bced0a3d056366fb58d66fe845e3 ]
Resizing fq hash table allocates memory while holding qdisc spinlock,
with BH disabled.
This is definitely not good, as allocation might sleep.
We can drop the lock and get it when needed, we hold RTNL so no other
changes can happen at the same time.
Signed-off-by: Eric Dumazet
Fixes: afe4fd062416 ("pkt\_sched: fq: Fair Queue packet scheduler")
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 7cf38b2b8931f760e5eb4433f257a0b6202c9c5e
Author: Michael Chan
Date: Sun Mar 9 15:45:32 2014 -0800
bnx2: Fix shutdown sequence
[ Upstream commit a8d9bc2e9f5d1c5a25e33cec096d2a1652d3fd52 ]
The pci shutdown handler added in:
bnx2: Add pci shutdown handler
commit 25bfb1dd4ba3b2d9a49ce9d9b0cd7be1840e15ed
created a shutdown down sequence without chip reset if the device was
never brought up. This can cause the firmware to shutdown the PHY
prematurely and cause MMIO read cycles to be unresponsive. On some
systems, it may generate NMI in the bnx2's pci shutdown handler.
The fix is to tell the firmware not to shutdown the PHY if there was
no prior chip reset.
Signed-off-by: Michael Chan
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 0e0e70fba39b7151196116409daf4d35e93d173c
Author: Sabrina Dubroca
Date: Thu Mar 6 17:51:57 2014 +0100
ipv6: don't set DST\_NOCOUNT for remotely added routes
[ Upstream commit c88507fbad8055297c1d1e21e599f46960cbee39 ]
DST\_NOCOUNT should only be used if an authorized user adds routes
locally. In case of routes which are added on behalf of router
advertisments this flag must not get used as it allows an unlimited
number of routes getting added remotely.
Signed-off-by: Sabrina Dubroca
Acked-by: Hannes Frederic Sowa
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 0ceb6013f1a3b17eb187f598b3bf935e6c17d168
Author: Anton Nayshtut
Date: Wed Mar 5 08:30:08 2014 +0200
ipv6: Fix exthdrs offload registration.
[ Upstream commit d2d273ffabd315eecefce21a4391d44b6e156b73 ]
Without this fix, ipv6\_exthdrs\_offload\_init doesn't register IPPROTO\_DSTOPTS
offload, but returns 0 (as the IPPROTO\_ROUTING registration actually succeeds).
This then causes the ipv6\_gso\_segment to drop IPv6 packets with IPPROTO\_DSTOPTS
header.
The issue detected and the fix verified by running MS HCK Offload LSO test on
top of QEMU Windows guests, as this test sends IPv6 packets with
IPPROTO\_DSTOPTS.
Signed-off-by: Anton Nayshtut
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit a0110722e14d34d8ffbc273f209db1c86fb26de8
Author: Eric Dumazet
Date: Tue Mar 25 18:42:27 2014 -0700
net: unix: non blocking recvmsg() should not return -EINTR
[ Upstream commit de1443916791d75fdd26becb116898277bb0273f ]
Some applications didn't expect recvmsg() on a non blocking socket
could return -EINTR. This possibility was added as a side effect
of commit b3ca9b02b00704 ("net: fix multithreaded signal handling in
unix recv routines").
To hit this bug, you need to be a bit unlucky, as the u->readlock
mutex is usually held for very small periods.
Fixes: b3ca9b02b00704 ("net: fix multithreaded signal handling in unix recv routines")
Signed-off-by: Eric Dumazet
Cc: Rainer Weikusat
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 30183acef6ff2c3444de7a542f6f2748205ab21d
Author: Florian Westphal
Date: Thu Mar 6 18:06:41 2014 +0100
inet: frag: make sure forced eviction removes all frags
[ Upstream commit e588e2f286ed7da011ed357c24c5b9a554e26595 ]
Quoting Alexander Aring:
While fragmentation and unloading of 6lowpan module I got this kernel Oops
after few seconds:
BUG: unable to handle kernel paging request at f88bbc30
[..]
Modules linked in: ipv6 [last unloaded: 6lowpan]
Call Trace:
[] ? call\_timer\_fn+0x54/0xb3
[] ? process\_timeout+0xa/0xa
[] run\_timer\_softirq+0x140/0x15f
Problem is that incomplete frags are still around after unload; when
their frag expire timer fires, we get crash.
When a netns is removed (also done when unloading module), inet\_frag
calls the evictor with 'force' argument to purge remaining frags.
The evictor loop terminates when accounted memory ('work') drops to 0
or the lru-list becomes empty. However, the mem accounting is done
via percpu counters and may not be accurate, i.e. loop may terminate
prematurely.
Alter evictor to only stop once the lru list is empty when force is
requested.
Reported-by: Phoebe Buckheister
Reported-by: Alexander Aring
Tested-by: Alexander Aring
Signed-off-by: Florian Westphal
Acked-by: Eric Dumazet
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit fc9696c20861a1b3cb8e493344c35237839671e2
Author: Erik Hugne
Date: Thu Mar 6 14:40:21 2014 +0100
tipc: don't log disabled tasklet handler errors
[ Upstream commit 2892505ea170094f982516bb38105eac45f274b1 ]
Failure to schedule a TIPC tasklet with tipc\_k\_signal because the
tasklet handler is disabled is not an error. It means TIPC is
currently in the process of shutting down. We remove the error
logging in this case.
Signed-off-by: Erik Hugne
Reviewed-by: Jon Maloy
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 59caf2777566e6cb4ef45d092e87d4780db2943f
Author: Erik Hugne
Date: Thu Mar 6 14:40:20 2014 +0100
tipc: fix memory leak during module removal
[ Upstream commit 1bb8dce57f4d15233688c68990852a10eb1cd79f ]
When the TIPC module is removed, the tasklet handler is disabled
before all other subsystems. This will cause lingering publications
in the name table because the node\_down tasklets responsible to
clean up publications from an unreachable node will never run.
When the name table is shut down, these publications are detected
and an error message is logged:
tipc: nametbl\_stop(): orphaned hash chain detected
This is actually a memory leak, introduced with commit
993b858e37b3120ee76d9957a901cca22312ffaa ("tipc: correct the order
of stopping services at rmmod")
Instead of just logging an error and leaking memory, we free
the orphaned entries during nametable shutdown.
Signed-off-by: Erik Hugne
Reviewed-by: Jon Maloy
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 1b954f5307dec6871b1075537c22969e5786d1fc
Author: Erik Hugne
Date: Thu Mar 6 14:40:19 2014 +0100
tipc: drop subscriber connection id invalidation
[ Upstream commit edcc0511b5ee7235282a688cd604e3ae7f9e1fc9 ]
When a topology server subscriber is disconnected, the associated
connection id is set to zero. A check vs zero is then done in the
subscription timeout function to see if the subscriber have been
shut down. This is unnecessary, because all subscription timers
will be cancelled when a subscriber terminates. Setting the
connection id to zero is actually harmful because id zero is the
identity of the topology server listening socket, and can cause a
race that leads to this socket being closed instead.
Signed-off-by: Erik Hugne
Acked-by: Ying Xue
Reviewed-by: Jon Maloy
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit d7b4510a84a79153054e0ae707be2d6ed8322440
Author: Ying Xue
Date: Thu Mar 6 14:40:17 2014 +0100
tipc: fix connection refcount leak
[ Upstream commit 4652edb70e8a7eebbe47fa931940f65522c36e8f ]
When tipc\_conn\_sendmsg() calls tipc\_conn\_lookup() to query a
connection instance, its reference count value is increased if
it's found. But subsequently if it's found that the connection is
closed, the work of sending message is not queued into its server
send workqueue, and the connection reference count is not decreased.
This will cause a reference count leak. To reproduce this problem,
an application would need to open and closes topology server
connections with high intensity.
We fix this by immediately decrementing the connection reference
count if a send fails due to the connection being closed.
Signed-off-by: Ying Xue
Acked-by: Erik Hugne
Reviewed-by: Jon Maloy
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 3e28aa7519e2f20d048ca5743d1219a6474eb50e
Author: Ying Xue
Date: Thu Mar 6 14:40:16 2014 +0100
tipc: allow connection shutdown callback to be invoked in advance
[ Upstream commit 6d4ebeb4df0176b1973875840a9f7e91394c0685 ]
Currently connection shutdown callback function is called when
connection instance is released in tipc\_conn\_kref\_release(), and
receiving packets and sending packets are running in different
threads. Even if connection is closed by the thread of receiving
packets, its shutdown callback may not be called immediately as
the connection reference count is non-zero at that moment. So,
although the connection is shut down by the thread of receiving
packets, the thread of sending packets doesn't know it. Before
its shutdown callback is invoked to tell the sending thread its
connection has been closed, the sending thread may deliver
messages by tipc\_conn\_sendmsg(), this is why the following error
information appears:
"Sending subscription event failed, no memory"
To eliminate it, allow connection shutdown callback function to
be called before connection id is removed in tipc\_close\_conn(),
which makes the sending thread know the truth in time that its
socket is closed so that it doesn't send message to it. We also
remove the "Sending XXX failed..." error reporting for topology
and config services.
Signed-off-by: Ying Xue
Signed-off-by: Erik Hugne
Reviewed-by: Jon Maloy
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit dbfc575804afb124cdc27dade949d602c4925a78
Author: Linus Lüssing
Date: Tue Mar 4 03:57:35 2014 +0100
bridge: multicast: add sanity check for query source addresses
[ Upstream commit 6565b9eeef194afbb3beec80d6dd2447f4091f8c ]
MLD queries are supposed to have an IPv6 link-local source address
according to RFC2710, section 4 and RFC3810, section 5.1.14. This patch
adds a sanity check to ignore such broken MLD queries.
Without this check, such malformed MLD queries can result in a
denial of service: The queries are ignored by any MLD listener
therefore they will not respond with an MLD report. However,
without this patch these malformed MLD queries would enable the
snooping part in the bridge code, potentially shutting down the
according ports towards these hosts for multicast traffic as the
bridge did not learn about these listeners.
Reported-by: Jan Stancek
Signed-off-by: Linus Lüssing
Reviewed-by: Hannes Frederic Sowa
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit 37612b6148d8932256188aeb98a412a82e27d078
Author: Daniel Borkmann
Date: Tue Mar 4 16:35:51 2014 +0100
net: sctp: fix skb leakage in COOKIE ECHO path of chunk->auth\_chunk
[ Upstream commit c485658bae87faccd7aed540fd2ca3ab37992310 ]
While working on ec0223ec48a9 ("net: sctp: fix sctp\_sf\_do\_5\_1D\_ce to
verify if we/peer is AUTH capable"), we noticed that there's a skb
memory leakage in the error path.
Running the same reproducer as in ec0223ec48a9 and by unconditionally
jumping to the error label (to simulate an error condition) in
sctp\_sf\_do\_5\_1D\_ce() receive path lets kmemleak detector bark about
the unfreed chunk->auth\_chunk skb clone:
Unreferenced object 0xffff8800b8f3a000 (size 256):
comm "softirq", pid 0, jiffies 4294769856 (age 110.757s)
hex dump (first 32 bytes):
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
89 ab 75 5e d4 01 58 13 00 00 00 00 00 00 00 00 ..u^..X.........
backtrace:
[] kmemleak\_alloc+0x4e/0xb0
[] kmem\_cache\_alloc+0xc8/0x210
[] skb\_clone+0x49/0xb0
[] sctp\_endpoint\_bh\_rcv+0x1d9/0x230 [sctp]
[] sctp\_inq\_push+0x4c/0x70 [sctp]
[] sctp\_rcv+0x82e/0x9a0 [sctp]
[] ip\_local\_deliver\_finish+0xa8/0x210
[] nf\_reinject+0xbf/0x180
[] nfqnl\_recv\_verdict+0x1d2/0x2b0 [nfnetlink\_queue]
[] nfnetlink\_rcv\_msg+0x14b/0x250 [nfnetlink]
[] netlink\_rcv\_skb+0xa9/0xc0
[] nfnetlink\_rcv+0x23f/0x408 [nfnetlink]
[] netlink\_unicast+0x168/0x250
[] netlink\_sendmsg+0x2e1/0x3f0
[] sock\_sendmsg+0x8b/0xc0
[] \_\_\_sys\_sendmsg+0x369/0x380
What happens is that commit bbd0d59809f9 clones the skb containing
the AUTH chunk in sctp\_endpoint\_bh\_rcv() when having the edge case
that an endpoint requires COOKIE-ECHO chunks to be authenticated:
---------- INIT[RANDOM; CHUNKS; HMAC-ALGO] ---------->
<------- INIT-ACK[RANDOM; CHUNKS; HMAC-ALGO] ---------
------------------ AUTH; COOKIE-ECHO ---------------->
<-------------------- COOKIE-ACK ---------------------
When we enter sctp\_sf\_do\_5\_1D\_ce() and before we actually get to
the point where we process (and subsequently free) a non-NULL
chunk->auth\_chunk, we could hit the "goto nomem\_init" path from
an error condition and thus leave the cloned skb around w/o
freeing it.
The fix is to centrally free such clones in sctp\_chunk\_destroy()
handler that is invoked from sctp\_chunk\_free() after all refs have
dropped; and also move both kfree\_skb(chunk->auth\_chunk) there,
so that chunk->auth\_chunk is either NULL (since sctp\_chunkify()
allocs new chunks through kmem\_cache\_zalloc()) or non-NULL with
a valid skb pointer. chunk->skb and chunk->auth\_chunk are the
only skbs in the sctp\_chunk structure that need to be handeled.
While at it, we should use consume\_skb() for both. It is the same
as dev\_kfree\_skb() but more appropriately named as we are not
a device but a protocol. Also, this effectively replaces the
kfree\_skb() from both invocations into consume\_skb(). Functions
are the same only that kfree\_skb() assumes that the frame was
being dropped after a failure (e.g. for tools like drop monitor),
usage of consume\_skb() seems more appropriate in function
sctp\_chunk\_destroy() though.
Fixes: bbd0d59809f9 ("[SCTP]: Implement the receive and verification of AUTH chunk")
Signed-off-by: Daniel Borkmann
Cc: Vlad Yasevich
Cc: Neil Horman
Acked-by: Vlad Yasevich
Acked-by: Neil Horman
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit f3827de6d3209745e3d9823955e5857ebac62d3d
Author: Nikolay Aleksandrov
Date: Mon Mar 3 23:19:18 2014 +0100
net: fix for a race condition in the inet frag code
[ Upstream commit 24b9bf43e93e0edd89072da51cf1fab95fc69dec ]
I stumbled upon this very serious bug while hunting for another one,
it's a very subtle race condition between inet\_frag\_evictor,
inet\_frag\_intern and the IPv4/6 frag\_queue and expire functions
(basically the users of inet\_frag\_kill/inet\_frag\_put).
What happens is that after a fragment has been added to the hash chain
but before it's been added to the lru\_list (inet\_frag\_lru\_add) in
inet\_frag\_intern, it may get deleted (either by an expired timer if
the system load is high or the timer sufficiently low, or by the
fraq\_queue function for different reasons) before it's added to the
lru\_list, then after it gets added it's a matter of time for the
evictor to get to a piece of memory which has been freed leading to a
number of different bugs depending on what's left there.
I've been able to trigger this on both IPv4 and IPv6 (which is normal
as the frag code is the same), but it's been much more difficult to
trigger on IPv4 due to the protocol differences about how fragments
are treated.
The setup I used to reproduce this is: 2 machines with 4 x 10G bonded
in a RR bond, so the same flow can be seen on multiple cards at the
same time. Then I used multiple instances of ping/ping6 to generate
fragmented packets and flood the machines with them while running
other processes to load the attacked machine.
\*It is very important to have the \_same flow\_ coming in on multiple CPUs
concurrently. Usually the attacked machine would die in less than 30
minutes, if configured properly to have many evictor calls and timeouts
it could happen in 10 minutes or so.
An important point to make is that any caller (frag\_queue or timer) of
inet\_frag\_kill will remove both the timer refcount and the
original/guarding refcount thus removing everything that's keeping the
frag from being freed at the next inet\_frag\_put. All of this could
happen before the frag was ever added to the LRU list, then it gets
added and the evictor uses a freed fragment.
An example for IPv6 would be if a fragment is being added and is at
the stage of being inserted in the hash after the hash lock is
released, but before inet\_frag\_lru\_add executes (or is able to obtain
the lru lock) another overlapping fragment for the same flow arrives
at a different CPU which finds it in the hash, but since it's
overlapping it drops it invoking inet\_frag\_kill and thus removing all
guarding refcounts, and afterwards freeing it by invoking
inet\_frag\_put which removes the last refcount added previously by
inet\_frag\_find, then inet\_frag\_lru\_add gets executed by
inet\_frag\_intern and we have a freed fragment in the lru\_list.
The fix is simple, just move the lru\_add under the hash chain locked
region so when a removing function is called it'll have to wait for
the fragment to be added to the lru\_list, and then it'll remove it (it
works because the hash chain removal is done before the lru\_list one
and there's no window between the two list adds when the frag can get
dropped). With this fix applied I couldn't kill the same machine in 24
hours with the same setup.
Fixes: 3ef0eb0db4bf ("net: frag, move LRU list maintenance outside of
rwlock")
CC: Florian Westphal
CC: Jesper Dangaard Brouer
CC: David S. Miller
Signed-off-by: Nikolay Aleksandrov
Acked-by: Jesper Dangaard Brouer
Signed-off-by: David S. Miller
Signed-off-by: Greg Kroah-Hartman
commit e6496f503a0bbe5af1a6e9116cf6f3acbd426a6c
Author: Paul Moore
Date: Wed Mar 19 16:46:18 2014 -0400
selinux: correctly label /proc inodes in use before the policy is loaded
commit f64410ec665479d7b4b77b7519e814253ed0f686 upstream.
This patch is based on an earlier patch by Eric Paris, he describes
the problem below:
"If an inode is accessed before policy load it will get placed on a
list of inodes to be initialized after policy load. After policy
load we call inode\_doinit() which calls inode\_doinit\_with\_dentry()
on all inodes accessed before policy load. In the case of inodes
in procfs that means we'll end up at the bottom where it does:
/\* Default to the fs superblock SID. \*/
isec->sid = sbsec->sid;
if ((sbsec->flags & SE\_SBPROC) && !S\_ISLNK(inode->i\_mode)) {
if (opt\_dentry) {
isec->sclass = inode\_mode\_to\_security\_class(...)
rc = selinux\_proc\_get\_sid(opt\_dentry,
isec->sclass,
&sid);
if (rc)
goto out\_unlock;
isec->sid = sid;
}
}
Since opt\_dentry is null, we'll never call selinux\_proc\_get\_sid()
and will leave the inode labeled with the label on the superblock.
I believe a fix would be to mimic the behavior of xattrs. Look
for an alias of the inode. If it can't be found, just leave the
inode uninitialized (and pick it up later) if it can be found, we
should be able to call selinux\_proc\_get\_sid() ..."
On a system exhibiting this problem, you will notice a lot of files in
/proc with the generic "proc\_t" type (at least the ones that were
accessed early in the boot), for example:
# ls -Z /proc/sys/kernel/shmmax | awk '{ print $4 " " $5 }'
system\_u:object\_r:proc\_t:s0 /proc/sys/kernel/shmmax
However, with this patch in place we see the expected result:
# ls -Z /proc/sys/kernel/shmmax | awk '{ print $4 " " $5 }'
system\_u:object\_r:sysctl\_kernel\_t:s0 /proc/sys/kernel/shmmax
Cc: Eric Paris
Signed-off-by: Paul Moore
Acked-by: Eric Paris
Signed-off-by: Greg Kroah-Hartman

