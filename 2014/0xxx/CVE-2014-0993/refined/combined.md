=== Content from support.embarcadero.com_991aa33f_20250124_180528.html ===


| [Log On](https://members.embarcadero.com/login.aspx?returnurl=http://support.embarcadero.com/article/44015)   |   * English   + [My default language](http://support.embarcadero.com/language?clear=yes&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Arabic](http://support.embarcadero.com/language?code=ar&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Brazilian Portuguese](http://support.embarcadero.com/language?code=br&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Bulgarian](http://support.embarcadero.com/language?code=bg&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Croatian](http://support.embarcadero.com/language?code=hr&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Czech](http://support.embarcadero.com/language?code=cs&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [English](http://support.embarcadero.com/language?code=en&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Finnish](http://support.embarcadero.com/language?code=fi&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [French](http://support.embarcadero.com/language?code=fr&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [German](http://support.embarcadero.com/language?code=de&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Hebrew](http://support.embarcadero.com/language?code=he&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Hellenic (Greek)](http://support.embarcadero.com/language?code=el&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Hungarian](http://support.embarcadero.com/language?code=hu&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Italian](http://support.embarcadero.com/language?code=it&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Japanese](http://support.embarcadero.com/language?code=jp&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Korean](http://support.embarcadero.com/language?code=kr&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Norwegian](http://support.embarcadero.com/language?code=no&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Polish](http://support.embarcadero.com/language?code=pl&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Portuguese](http://support.embarcadero.com/language?code=pt&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Russian](http://support.embarcadero.com/language?code=ru&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Simplified Chinese](http://support.embarcadero.com/language?code=cn&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Spanish](http://support.embarcadero.com/language?code=es&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Swedish](http://support.embarcadero.com/language?code=sv&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Traditional Chinese](http://support.embarcadero.com/language?code=tw&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Turkish](http://support.embarcadero.com/language?code=tr&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   |  * Location   + [All Other](http://support.embarcadero.com/country?clear=yes&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + Regions   + [ASEAN](http://support.embarcadero.com/country?code=ASEAN&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015 "Brunei Darussalam, Cambodia, Indonesia, Laos, Malaysia, Philippines, Singapore, Thailand, Viet Nam")   + [Australia/New Zealand](http://support.embarcadero.com/country?code=ANZ&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015 "Australia, New Zealand")   + [Benelux](http://support.embarcadero.com/country?code=BENELUX&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015 "Belgium, Luxembourg, Netherlands")   + [D-A-CH](http://support.embarcadero.com/country?code=DACH&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015 "Austria, Germany, Switzerland")   + [Greater China](http://support.embarcadero.com/country?code=CHINAHK&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015 "China, Hong Kong")   + [Latin America](http://support.embarcadero.com/country?code=LATAM&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015 "Argentina, Bolivia, Chile, Colombia, Costa Rica, Dominican Republic, Ecuador, El Salvador, Guatemala, Honduras, Mexico, Nicaragua, Panama, Paraguay, Peru, Uruguay, Venezuela")   + [Nordic](http://support.embarcadero.com/country?code=NORDIC&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015 "Denmark, Finland, Iceland, Norway, Sweden")   + [Taiwan](http://support.embarcadero.com/country?code=TW&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [UK and Ireland](http://support.embarcadero.com/country?code=UKIR&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015 "Ireland, United Kingdom")   + [US and Caribbean](http://support.embarcadero.com/country?code=USCARIB&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015 "Anguilla, Antigua and Barbuda, Aruba, Bahamas, Barbados, Belize, Bermuda, Cayman Islands, Dominica, Falkland Islands (Malvinas), Grenada, Guadeloupe, Guyana, Haiti, Jamaica, Martinique, Montserrat, Netherlands Antilles, Puerto Rico, Saint Kitts and Nevis, Saint Lucia, Saint Vincent and the Grenadines, St. Barthelemy, Suriname, Trinidad and Tobago, Turks and Caicos Islands, United States, Virgin Islands (British), Virgin Islands (U.S.)")   + Countries   + [Brazil](http://support.embarcadero.com/country?code=BR&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Canada](http://support.embarcadero.com/country?code=CA&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [France](http://support.embarcadero.com/country?code=FR&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [India](http://support.embarcadero.com/country?code=IN&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Italy](http://support.embarcadero.com/country?code=IT&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Japan](http://support.embarcadero.com/country?code=JP&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Korea (South)](http://support.embarcadero.com/country?code=KR&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Russian Federation](http://support.embarcadero.com/country?code=RU&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   + [Spain](http://support.embarcadero.com/country?code=ES&returnurl=http%3a%2f%2fsupport.embarcadero.com%2farticle%2f44015)   [Embarcadero Home](http://www.embarcadero.com)     [Embarcadero Developer Network](http://edn.embarcadero.com) [Embarcadero Customer Support](http://edn.embarcadero.com)  [Home](http://support.embarcadero.com) Support Offerings Submit Case Resources Downloads [Contact Us](http://support.embarcadero.com/contact)          * [Printer-friendly](http://support.embarcadero.com/print/44015)  * [Support KB](http://support.embarcadero.com) * » * [Delphi](http://support.embarcadero.com/delphi)   | | Show All | | --- |   [All]    Delphi and C++ Builder VCL Library Buffer Overflow Abstract: Source code fix to address a potential vulnerability in VCL BMP file processing    Potential security vulnerabilities have been identified in the VCL when processing BMP files. These vulnerabilities could allow an attacker to craft a BMP file that produces a buffer overflow and thereby allowing it to execute arbitrary code.  **For users of** **XE7****, XE6,** **and** **XE****5****:** a hotfix is available.   1. Obtain and apply the appropriate hotfix  1. XE7 users: <http://cc.embarcadero.com/item/30010> 2. XE6 users: <http://cc.embarcadero.com/item/29913> 3. XE5 users: <http://cc.embarcadero.com/item/30014>  3. Rebuild your application   **For users of** **XE****4** **and** **prior versions of Delphi and C++Builder****:** these steps should be followed to modify the VCL source code and add it to your application.   1. Edit Vcl.Graphics.pas (see steps below) 2. Add the modified Vcl.Graphics.pas to your project 3. For C++Builder: Under Project | Options | Packages | Runtime Packages, set “Link with runtime packages” to false 4. Rebuild your application   **Changes to Vcl.Graphics.pas****:** Code Change 1  * Variable names and scoping might be slightly different depending on your product version. The syntax and screenshot below are from XE5. * Locate the function PaletteFromDIBColorTable. * Add the following code just before the line assigning a value to Pal.palNumEntries when the DIBHandle = 0 (see screenshot below).  ```   if ColorCount > 256 then       InvalidGraphic({$IFNDEF CLR}@{$ENDIF}SInvalidBitmap);;  ```  Hide image[Click to see full-sized image](images/44015/03000003.png) Code Change 2  * Variable names and scoping might be slightly different depending on your product version. The syntax and screenshot below are from XE7. * Locate the function TMetafile.ReadEMFStream. * Add the following code as shown in the screenshot below.  ```   if EnhHeader.nBytes < Sizeof(EnhHeader) then     InvalidMetafile;  ```  Hide image[Click to see full-sized image](images/44015/02000004.jpg) Code Change 3  * Variable names and scoping might be slightly different depending on your product version. The syntax and screenshot below are from XE7. * Locate the function TBitmap.ReadDIB. * Add the following code as shown in the screenshot below.  ```   if (biClrUsed * DIBPalSizes[OS2Format]) > (256 * SizeOf(TRGBQuad)) then      InvalidGraphic({$IFNDEF CLR}@{$ENDIF}SInvalidBitmap);    ```  Hide image[Click to see full-sized image](images/44015/02000005.jpg) | Translations  | [jp](http://support.embarcadero.com/article/44089) | [Delphi および C++ Builder の VCL ライブラリのバッファ オーバーフロー](http://support.embarcadero.com/article/44089) | | --- | --- | | | --- | --- | --- | --- | --- |             Copyright© 1994 - 2023 Embarcadero Technologies, Inc. All rights reserved.    [Site Map](http://support.embarcadero.com/sitemap) |
| --- | --- | --- | --- | --- | --- |

[Installation & Registration](http://support.embarcadero.com/install)
[Annual Agreements](http://support.embarcadero.com/annual)
[Single Incident](http://support.embarcadero.com/incident)
[Supported Versions](http://support.embarcadero.com/article/37740)

[Installation & Registration](http://support.embarcadero.com/forms/submitcase)
[Product Support](http://support.embarcadero.com/case)
[Single Incident](http://support.embarcadero.com/incident)

[Discussion Forums](https://forums.embarcadero.com "Discussion Forums")
[Documentation](http://docs.embarcadero.com "Documentation")
[Developer Network](http://edn.embarcadero.com "Embarcadero Developer Network")
[Bugs & Suggestions](http://qc.embarcadero.com "Submit bugs and feature requests. Also known as QualityCentral.")
[Examples](http://cc.embarcadero.com "Examples, code, etc.. Also known as CodeCentral.")
[Audio](http://edn.embarcadero.com/audio "Listen to Embarcadero's developers and management.")
[Audio & Video](http://edn.embarcadero.com/tv "View product demonstrations & listen to Embarcadero's developers and management.")
[Video](http://edn.embarcadero.com/video "Watch presentations and product demonstrations.")

[Registered User Downloads](http://cc.embarcadero.com/myreg)
[Maintenance Portal](https://maintenance.codegear.com)
[Free Trials](https://downloads.embarcadero.com/free)
[Beta Programs](http://www.embarcadero.com/products/beta_programs.html)



=== Content from www.kb.cert.org_15003348_20250124_180529.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#646748

## Embarcadero Delphi and C++Builder VCL BMP file processing buffer overflow

#### Vulnerability Note VU#646748

Original Release Date: 2014-09-11 | Last Revised: 2014-12-12

---

### Overview

Embarcadero Delphi and C++ Builder Visual Component Library (VCL) bitmap (BMP) file processing code contains a buffer overflow that could allow an attacker to execute arbitrary code.

### Description

| Embarcadero Delphi and C++ Builder tools contain a buffer overflow (CWE-119) in VCL BMP file processing code ([Vcl.Graphics.TPicture.Bitmap](http://docwiki.embarcadero.com/Libraries/XE6/en/Vcl.Graphics.TPicture.Bitmap)). Core Security Technologies advisory [CORE-2014-0004](http://www.coresecurity.com/advisories/delphi-and-c-builder-vcl-library-buffer-overflow) provides further details, including more specific information about vulnerable development tools. Any application built with a vulnerable VCL version are likely to also be vulnerable. |
| --- |

### Impact

| An attacker who can cause a vulnerable application to process a specially crafted BMP file could execute arbitrary code. Whether or not the attacker is remote or authenticated depends on the interfaces and behavior of the vulnerable application. |
| --- |

### Solution

| **Update**  Embarcadero has released a [hotfix](http://support.embarcadero.com/article/44015) for XE6-series tools and provided [documentation](http://support.embarcadero.com/article/44015) for older tools on how to modify VCL source code.**Rebuild applications**After updating using the hotfix or manually editing the VCL source code, rebuild applications using the updated VCL code. |
| --- |

### Vendor Information

646748
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23646748/) to view vendors.**
### [Embarcadero Technologies](#AAMN-9NUN9C) Affected

Notified:  July 09, 2014  Updated: September 11, 2014

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <http://support.embarcadero.com/article/44015>
* <http://docwiki.embarcadero.com/Libraries/XE6/en/Vcl.Graphics.TPicture.Bitmap>
* <http://qc.embarcadero.com/wc/qcmain.aspx?d=126004>

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 7.5 | AV:N/AC:L/Au:N/C:P/I:P/A:P |
| Temporal | 6.8 | E:POC/RL:ND/RC:C |
| Environmental | 5.1 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.coresecurity.com/advisories/delphi-and-c-builder-vcl-library-buffer-overflow>
* <http://docwiki.embarcadero.com/Libraries/XE6/en/Vcl.Graphics.TPicture.Bitmap>
* <http://qc.embarcadero.com/wc/qcmain.aspx?d=126004>
* <http://support.embarcadero.com/article/44015>
* <http://cwe.mitre.org/data/definitions/119.html>
### Acknowledgements

Thanks to Marcos Accossatto and JoaquÌn RodrÌguez Varela from Core Security Technologies and Mike Devery from Embarcadero.

This document was written by Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2014-0993](http://web.nvd.nist.gov/vuln/detail/CVE-2014-0993) |
| --- | --- |
| **Date Public:** | 2014-08-20 |
| **Date First Published:** | 2014-09-11 |
| **Date Last Updated:** | 2014-12-12 16:24 UTC |
| **Document Revision:** | 28 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


