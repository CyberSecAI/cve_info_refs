=== Content from access.redhat.com_e360343b_20250126_050333.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry this application will not work properly without JavaScript enabled.
Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from avatars.githubusercontent.com_de30067a_20250126_050317.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? ξ�m;S}\*�d]����xn�X(�I��`���d�7�-�P�ԣ��6�l����bw {��j��Z}�}�2X�w����
0$L�~Sێ���^�.�y����<�� (���<ߧ�fS���B͵t����&�yԪݗ����� �8Լ��(��Q�W�jۏ��8"�� e^ϭ���5�h`Ӯ`i���9\*dq��`������� �������,4��K��\_��Fu���/�8}7U�4X|�l���I���$������k�N?�K[h��@ӼP\*3ٶ��>����T�������ʀ �O }2G���-��O����S�\*�i��R>��$f�1��K�/u=��2���p��ƚ�֗k���-�������?;M�<ᰀX�{�Ӷ\*��d.�7�UŜ^R�H�Ei$S��[�r8��R:L���-��G�,��F\���0��� %M���C�D��;F�3���N;�k�F�N�\�slEl2����{t��2��͞�-����^D��W��`���A���O�Ͼ�� �� �T��w:
-�4:��o�r����-�a�s�s޳�ֿ煯��� ��5Zq�RS������T�,l\_�{�>�~����\*�Y�|������S�iڭ�Vw^h���~<��SEo�쨲�v|�����X�˰� ������Q���PW�N6�+|��u�w Nw~����

=== Content from github.com_96a0419f_20250126_050319.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8r7q-cvjq-x353)

**CVE-2014-1402**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8r7q-cvjq-x353)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2014-1402](/advisories/GHSA-8r7q-cvjq-x353)

## Incorrect Privilege Assignment in Jinja2

High severity

GitHub Reviewed

Published
May 14, 2022
to the GitHub Advisory Database
•
Updated Sep 24, 2024

[Vulnerability details](/advisories/GHSA-8r7q-cvjq-x353)
[Dependabot alerts
0](/advisories/GHSA-8r7q-cvjq-x353/dependabot)

## Package

pip

Jinja2
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 2.7.2

## Patched versions

2.7.2

## Description

The default configuration for `bccache.FileSystemBytecodeCache` in Jinja2 before 2.7.2 does not properly create temporary files, which allows local users to gain privileges via a crafted .cache file with a name starting with `__jinja2_` in `/tmp`.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2014-1402>
* <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=734747>
* <https://bugzilla.redhat.com/show_bug.cgi?id=1051421>
* <https://oss.oracle.com/pipermail/el-errata/2014-June/004192.html>
* <http://advisories.mageia.org/MGASA-2014-0028.html>
* <http://openwall.com/lists/oss-security/2014/01/10/2>
* <http://openwall.com/lists/oss-security/2014/01/10/3>
* <http://rhn.redhat.com/errata/RHSA-2014-0747.html>
* <http://rhn.redhat.com/errata/RHSA-2014-0748.html>
* <http://www.gentoo.org/security/en/glsa/glsa-201408-13.xml>
* [GHSA-8r7q-cvjq-x353](https://github.com/advisories/GHSA-8r7q-cvjq-x353 "GHSA-8r7q-cvjq-x353")
* <https://github.com/pypa/advisory-database/tree/main/vulns/jinja2/PYSEC-2014-8.yaml>
* [https://web.archive.org/web/20150523060528/http://www.mandriva.com/en/support/security/advisories/advisory/MDVSA-2014:096/?name=MDVSA-2014:096](https://web.archive.org/web/20150523060528/http%3A//www.mandriva.com/en/support/security/advisories/advisory/MDVSA-2014%3A096/?name=MDVSA-2014:096)
* <http://jinja.pocoo.org/docs/changelog>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2014-1402)
May 19, 2014

Published to the GitHub Advisory Database
May 14, 2022

Reviewed
Jul 7, 2022

Last updated
Sep 24, 2024

### Severity

High

8.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Local

Attack Complexity
Low

Attack Requirements
None

Privileges Required
None

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
High

Integrity
High

Availability
High
##### Subsequent System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N

### EPSS score

0.044%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (12th percentile)

### Weaknesses

[CWE-266](/advisories?query=cwe%3A266)

### CVE ID

CVE-2014-1402

### GHSA ID

GHSA-8r7q-cvjq-x353

### Source code

No known source code

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-8r7q-cvjq-x353/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_43188098_20250126_050317.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx��ֱu�@EQˇ� (���6"v+��m`~��,c��o�;{ ��H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���HXfx��:fO�h[���g$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$���c�� �v>; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���HXn�t^�m������+>; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A쀄e��g��}�Z��=�|v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�����9�c������� |�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�k�1{������H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A쀄�   ��s�� B7B    IEND�B`�

=== Content from avatars.githubusercontent.com_71141a2b_20250126_050331.html ===
�PNG

   
IHDR   P   P   ��    pHYs  �  ��+    IDATx�ļy�\Wu���g����zԓԚg�lK���9�1؎Ip!!��M|! � �@�`&c��m>l��A�d�j�ZR�z��k����Q%���|�s������U��v��]k�{����RJ�B�����u����g?�\s;�.��
!Q@
���H��Q�b)>���Y�n=}Mx��D���y^88̝Wmf͒E`f!���3��¥���W�W������]S��>.���U<��r�I�����7��c�s��-l[���-p$���$�JB�D �WT�XB'���v�ZEF��5
���81:��cp�� k�v���LŒ��s�ȗ\*l]����|�t�s���[�َÉ�i��N�X�P���������/~�+�-�
+�;��Y�\@ S���L� �����S9��plx����R�-\�i9��2����'\_!�3IL��[�s�M��=�����;q]������S,I%��x�M,Z��G��'��h�)��?x�6�l�p���m�O|�����܂����O�hY��7MH|�;o�AJ
S�KGPA5Q�OQ�lǥP�01����GC8H\*��ٽd�%��gb6�Z�?"�banǕd%E��O!�J�k:�m��'F�yu�Z"L��v����<�?}������\����D�u�.`I���R �y���)���< ��s���'F� (W,tM%$3d%^xs��1�����\���Ɛ�I֯��UR�u��S���G8~|�L�����+Qt��4�y�n�|��) �R�����p�e��!j�y�\*�\*R`�\*�4���8� ��\*¨\�h� ���d=�T\*6��2O�qY�T���$\_���"�β���\*غr۷]����iiW.%sss|�S���|�������J|��[���}�4ύIs\*e}�'���6.GU$��ز<\@ARv���Ը�Nh �)��[�"�$c��
j����l<ͺ�E���DNaQ����Iz�;�YH�����c�y��\_�h�:V,�Y��~�3�\v�<��KT�(��"�)sͶ5D�}����Ϡ(
�`����>�E�T$�xI�8.��B5��
�#�5�
)m�P�e�;Jp�v�@.����������N}ȏwqe�db.����N�}MtvuS
�j���d
@-��ƦE���x-�MO̱�����oS�TFs�G�Ѿi%
PpU���}���o!���;�wVo��(\*~ UFI�M�:�G\_`"~[.hፁ�B>-
aN䊸���[V���T��S���edrE����&����n��BT��ȩq��wa������T�����,�Ʊ-��mj5�l�3��#�x��GZ����n���o#���Pn!ɩ�Y&f��J:>�3g��joe�Et�6��� 4U�g��<����x�?E�����wP\*���3/�=�/v\����V�!j��&��s�,j����x<�
e,Ye��.x�-�%�J����@�y��-��B!Y\8�����e��&�Ϗ182E]K' ]�
|��\_3�HSW���ﾑc]��$�0�g��-��>��lپ����?Ng���e<���/~�kbc� ��������9��ŝT,��e�����^�4jM㉷ɖ��8�.���a
W(�/�[�͙�6�w���N��a��H� ]-Q�e���}�m����}X�1��l���J�j��$��4��B�Zɂ�<"�"y�~��׿�u6m����$���~Y7��2���kh�2�`��Ud�Et�
X�\����Du���7���Z�&-T�Pg�h)�s�n��)&}}D�#�VR�2M����L�/Y�L��Bp#����헻L,�fp,��=CD��aM"��f�{)��$+�� %�9�k��~��y���h3:�������w����p�G����[�d O��I��
D��M�zg^��i��fk�F{�)��#ϼUGY��GQ�����;�?4F8�c:�e�����C\y�I�1ٳ�Vs�����c��ϧl\*�&k��{NE#k�X����7v����S|��s:�p���7�a�[�U W�^E"\_$],��^�
\*`I������~,h�4YsD�IN��3K{R!�ѫ�9��C�����������B�Z�CO�<;D{}���\_�E?Ƭ��)m1��3�}��P)��Y+����Qfk���;y�~���CNҼ�U7X\_][V\�n=�"��X�ȃ��YϒWVSZ���M%�FYV>�&-��%�T�J/�U�/K��/!;�2����2t$�i�<6�/;ʵ;<��Z˲(^�T�Ǳ��½�b��L��f�'�FGјT�0���{W+���[�� cI��o�͖� ��V,[���/j��@��]CT�q&�z�+#h�&�����8��#\_�V�v�E������q8n��� ��kԡ�Q���k,1���?[J�w��\S�bR0tl�ŞS�X���g�H�ah�.t�%�5cI��Pi7�
THg+U�t%�D���l۶��\_�r���l�=�B!�~��P�!'�n��U��9��e�� z)N]C�@?��I����7p��1��x�;n^B��e8������\�7^�O�|����s|�D�$z L&��`����˔l��m�(.�T��/��&G}�����%۷s|b��#)�U��&o�wXC��4z H%�"�ٗ2�%���{/���.�h[�\*$]�X� T��b�k��gh��Li1 ��3�Y�yl?7���RC,Y�J9��C��r��LViAQ\ʶ��خ����\�I\_{���"Bu&�r�R�Q?�eY lټ�T��l<�KU�(L���y��E�[,PQ��轸V���I޷}9�"K�u�ݹ�+6,a\*mqbt�uIN�0�p��b7�v�B���4������|g�~n��8�� �л��#��J6��$!e;HU#����x�K���O���ʾyV�q�@=z����.<>�>��B�U�-��A
5�\*1���� V��q.�\*�zV!5����ٸ��cJ ���E���c���ǟc���wt�71�����
}7S��d�
1�S��Й�B�Ɖ���xX^f�� U�i�="�&�����;7�QLA�4Pw�����`bl�v��e떝����� �j���W6�P�;��˶��� #F/i5���Qʕ�,0^��Z��U�:��kO���Ӻ�N�� v�f�p�ǧ���cI��m�X
V����T�&����:��>\E%�B� �=�h
c�\*���x8vF���$��9
jKK�M�MD�#(�7����]J�cT����1P�?�w�zۻ�����W,�<�����x�C� �ދ��|�]
��&?�+�bH��tf���[o�}�:�ۚ:c��(Z�hC�L6�� ]иaC{O;�\��7�T[��45{��
9��1M\*��ԌN[�Ac�B�$І��91t�޾^�\_p~���ǹz�r������3� ������)��Q}����zr�X���o�����tۓ���(
�Tr�">�=u���s�ͽĦObul`��&�.܁���k\:B���>]�iŧ
�A�lZ[Q���
�Ұ�:"�>�x��vAu&�(\*�dS�|4���D���͛�����M�-nb��I�ڰCH\ E��`u�=b���2�y��������7��K��LW�S,���:�d�c��xm�KF�Ѽ���kn�P���=DE�90W��^��I�9�a�p�%ˢ� ���ߧP,h̦���!�;{$���)� hm�`zϏ�#��8��;" I/hBz�!>�����+��K�(�KӃ��j��&�� !~/�@��b�@�ߋ��Pz"�����E��~�m�4���#���;�q�XJl��Z�O��d�r}!�B
~~ءX6Y��Ck�IF�X�@��X䇰�6H�@� �m����+�M�%&4ya0K���I8�6^���T�;ڞ={ 8y�$6l��/����r���V-��[J��-�c��
�x��B�+%�i&c̥�؎K��d��4^]��K6s�\��s�"��g�M׳8�� �@A����qUb`E��Yǃ�����ix����ؕ���:/h�����\*��pe+�Dt��Z�@�P��+�J�%�
h�]wRJ ��[��.^e�%��X�)��P����wL�NW��ɕ\*�>5ɯ3Oc;.�"X�P��([7�,K�s���##ԯ��~dk�t�e
�C����
AP$L�fx#&h
�Z���hs�B�
��$�+0�A�
�z>�~m�>�w ��GP@2S�ߜxI\_����!h�o�>Eapp�?��?GUU������w�K�To�s�8��B����/�\*�ͫC��Ҽ:4N�XfEG#7nZʒ��A�:��g��ؗ�!}����}a6���!�@�fJ�Z�[T��Yp:�r�˛�����<��B��M����
��,`;0dA����u`�^/��$�����ATbJ���j\x~Vrw�@�f����a
�� 7�p=����`��v�[�.��V���������(�P�����sE.�kc��^:B(5ɒ�y��i~~�Bi�p�����N}/�R�?�@+�b@G ���%҅��z6+-�G�ۺ$�2�c��J +�1Ҩ�RӁ-!X�~�S;����ְ��y�U�(pE�xJ���js��^����ALOOK�4�D"���8lٴͩ��ވ�LE�+�@�펬���H{�8������;04��&TT�����3��&.��#\��K$ �Z��vxUɐF %�a��^;hI����SէZ��ӏY�/' �0��4Z4�ʄUR�ّ���%^.V�|y^򖠥V����W��T@�z����HUU����?~���$����tE� ��f��H�rr��$/
����/��tEQ�H���ݳ��Ē�}��.[�'^
"H�h
�d�� �@���:�$q�O\`@���\��$���/x�R�j�����I� �-2�T3�)VՁ�C0��~��p5�r:%���Lhg�{���{��>���c�6o� UQx��K��
BT��Yir��o��.�y��i�^����B, ?x�?�,e�}���>�>էT&��r��jϙg#x�wIT�ke��[4��0���[���W+�t�E���GP��u?U�.
A�h���$\A�o����h ���͇���؎CS4�R�T����#�y�����S�9��c�/�o\{�R��0<���O�|�\_r�7��(��3
R�� �!�{ b@��M��8��t�2C%�L-��՞?Z���\_t뒋������Ix�$�H��\_~�ќ�^
���'��� ��L< M���
d
P@�կ~۩����/>šCy�s�eQG�|��x�)��͢���P�v�(���d;̥sl���c�92Ç�O�G��]￉�zA����:論����+�`C�x�Xf,�Z3E�-�E�=��8���J���$�J�z�V��zS`�U�$�6U��0P�Z�Z��b-@��2�,�Pp` ^}�dk�8�G���p� �gg䚵�X֬��Ͻ��VE.�fÆ
ē)pъ>��k��UAUγO ���83���]�e>��ly�',��Ej0� G&��-i�U\_"%(.�mɬ-h�`�Y5��Z3 ������6�]�P�D�T�%(q� X��.�仓`����\_�NF�������PlW��iAWK�F��횩kflp�o���ϟx�~�}l���s3n��'����lZ���&x���L.�X�ZO}��P�9irr&NOs=�|��p��>�ed����%GF��m����`�USm����
�� Y�[�Ө���
6,�`�)���:%aO\p0>z�=y@aW�
{���<�k �k�5�� ��D���B�%̗�X��K�$9:h�4�GXܽ��~��v{��������}(B`����{����68������pbrY3卋�i�i���=4�hD8:fsh��M ��8���[�9Q�y[�L��!
H�.L����Tl��p������k���ЭJ����}.�B�%�/��Ss.��.�ܠ�
Đh�B� f�J���S�F�D�e�+r�<
�2�b��T�C �Cy�m�^���k0|��������n��k���K�m���x�%����Uܽc?{�(���Q�9x�
���y�Z�X���WE�������8vƢ-��+K�($�#QT�U?����/q�`̂}���`����FC�frŚ�� ��N�I',:��\*����ȃZr�#�P�˫��
/��I�[̤�8�dq���k�HVv
�Ʀ3t�t�X�B���|�LD�f +��>���5�����/|��\_���z/��"���7��05��g���!`��n�ܾ����Gg�ɮ�<��u~/K;��K�8��1���>���:��jwWT8R`(PT�����]��TUnn�F�5�՘���J�\A�,��!���B�C���
;/i
�YHY8�c '���
S'�1pl�:t6�0 z�k�}&9}bC���ϣ;6�J�)P%v��Wب�6mz����J��{��^���7q��n��y��~nۺ�x"�����7o^����~]cUW3�\_���+{�K���o��́��|�� W�y+m��r�P�A�H)�9��\_��AO���µ�%!�u�i�~\�� ]�RA2��T�)I1��®��:[{��9��3�k��jP�KP);�tD��˒X�S0��4E �
���ˤX�f���f�����3�J`U�xU���djY۶i��89������v�2�u4��/��>�y����sAO���ߏ
B���V��{=���\_�JWs=g�9��Y��!�
)�L��Xv9:Zdd��k�\��a�����-1[4�
I�X�jP)�$��)8�Vu̕���:��ƙ���7���c��Ё��ε]��E�^�~}��!�^�ŬS����,��ш�FrtM!�(��:=Q�^"W\*�K�=�|�b9�z���>�~�z4M��?��Y��Ƣ�0�xz�?Æ�Vw����NL-p��n�,�]ת�AEAA4��M˹~�
�9d��yc/�@�6�%1��gg@
�/2�r��κjz\*�w�r^?8G��O2��$%3E��"�L�|��!-i���D���p��8B�E�0=\*��<->��MA�"^Mepb�|�H%�DS}��O���Ǫ�ސ��-(ڠH��G����}��&��R\*�h��)����k��[��K/�!��Npjh�KV�P��eyO�;��^<Ȫ���~��$���k�,��S�-|^��T�TeMWS�o��7�l���01���#�~�M.m�pu��K���g ��K`���<��̏�,L����fgx���8r|�g&�%R,�ϣURe�r>��t��R��c1x�$���D4�L2N2'lJ��hR�(�]՚V�.��E\��r$Q���'�us�]����/��Hq�V |a�ˢz��\_�Ik�(v�Y��L(��y��;WuP��DE�fݥX,Ş8=�P]v�O����L���C
zq�e
\*Ga���O�����(gi
�(2X�Mm�����4B��O?�c>u��|�O����G\_[��'� �=��W�������z  lIDAT<�OL����d6��
)qQ��VU�&�����ѿ��\�BwK�qpk"�l��ڒfHE�L�Q��\_d0��O��S�HW�g&��Ĩ�J�DCi�X�v���,�p��\_273I��
��ĉ�Qr5�RG�6�r%9F�d19g0�qR�!y�s�Ek1V�a)6]�����sl�Ǌ>�X�R�V2� �>�������ҋ�Ìͧ�Oc;6��[@s$�x,E\_{#�������csx
�:�Nc8���%S(b��"MSQU��$�b'��\*��[��
(BR'�$]�a6O�bp���x�#{\_a���r��I�'����ҍ�k[ƒ�n���
��x�4��6
�L��ӣ�z;~�J�Z��cz�
���\_�qݦe�j�\*�����,��eI�:�@@�P�)���h�N�P���掻�����A�{���y�6��f6���}h�F8���+ycp��s\���|����\���yq�K�r�}|^]Q-0>=��|�|�L2���u�z3���\*
ŲE�da�"�\����J�Q��82�a��K�^���n#1:����ɚ�m9����\_�\_c?�Y1�ڞ
��K�"��2����#�~1�݄�n$�iO��c?�0?����문�^���W���e���6���\��
� �m�i:�u�����O��ÿ�S�P�/^?���,��0u�屗�r]W�����(��G\_G+�1��!�~��#(B��o>���VM�����]G\_{�AA�\�X��T�vP���<�yc���F�2��K�Q�.:y���8��)�'8u�5��&�����y���ˮ��DY%�J�Ϧ��\_�Q4U�
݃w��ؒl6Ga�a���+���� !�S�|������b�b�ۯ���
>Ի��R�D(BQ�st۶m��w��g��e��O����8�� ���|��W��� G�̱ii;�]�4=�%LC��u�|-�h���X�?��"V�u�zq��'����A�ʖM�\�k��RY���\_��\_fe{�?��VJ��xI�̓�x���Ͳ�wP�<=Q���~.�q;.����9����{.beԥE�R����%��B�����x|A|F;�⒵@�x��#�~�'��C4D�h�6r�-�5W\_�o���#�s���F�������������EQBua���r�{e7\_���
|�O���|�ǡ07�{w��W�-Zt5�Id��e�&����ѵ�J�����ր�0P�h8�%k��������'�ik�04r%�G\_x����'�+|��b�ì�/�jq']KW�u�b6/ocIw����7��XWu��ً$ q�{߃/܈#Tʾ6�Jw�0�J�R|���i:[�$�%
Y�1��u`�.�gOr|������\*
�|�W��?����-%Z�G���O%�4����fR�$�"ӱ4g���t�D�w�Z�^�3y�᣾������.�)���a��F�v,�i�:��h
��L��|/S�ws��r��b�b��e�Fyy�-m׾}��ٔ��hy��q����$�d �<��C�I��݊�c�7ﻁW��c�w�R���:=>��Pijl$�-�y���,�Tl�׋��ŕ�{���Wn���,M��� �M���d
%��S�$�l�x���\ټ�@�\*�B�O�Q�{۩xȣa[\*%�%T�z%��m�����~�#\_ 5�CW�Oe�M��T7�Kq�{<���i����Dk�"�e\
��]�رc \_����w]��
S���W��%�#Ǹ��M�g�Z��h������/�p��6]�q\^;6��[���I<�CU�B�X"I{K3�p��cY
�(+{[�u�\�HW[��(�|�l�tn���D�H�X!ʙ�3c�5��1Z�xt�U5 �IVz
��Y�8>���\_��b�E����k�T�c
|�xS+8����{7B.��r���`g�(������!�J�֭z�\_~���M����C�9�������|�;����c�RB~S�4W츘�\_~SW�tu�\�r�fpt�e]�L��D#!�dz>N�T������Vҙ,���u\��lǬ�� �|�}竀o�Akn��ui��
��O.�cf�8��[
Z�u�<d�:�`���Zt�}���Di~�Bi���d��H�T�D!�Y���W��4���G�~�ϒy�������o�u�6 }�Q܆F�
M�0����5�\_��7�L�R�L,�O^�&y�s��?� �\_���#s<{p�Bš�%��3s$RI� vBQ�`�L����4�3s�|^ff���D�b�D<�ĕn���!�U �xD�%C31�� ��$D�h��8��jyB@�\&��!���/&�]��QO�
o%F�|�Rz��� �lB�\*ѥ�t�"ڶ�P�N���D��o@�F���Rq�<''&�/������{�Y��-�����x���7��g>Ckkff�̟�?��s���=�����K���T�m+��p8vz��Q�ؼ�7Ǧ��|!�\*�d�&�i���'�!Hg�h�FŲ��G����mr��[�S��D����� �N��Zm������ ��"�RRv�.��`�J�y��XSOӶ�6�a�re����Z�c(u
�~�����л�(�S�������ն���t^{
[�m#39E>��ɧ�b��=\u͵���..���j��l��k{ٷo-m�G:H%'y��$!��L���-�-X\*R:�-X��Jl!#�,jo#\_,261Esc�0pSit�$��b&���B������E!\_(K�)U,�3c��
B�ѥӷ����f'F�3ð�B���"P<�6���Wod,�,��-.&h.�Rtpt���t,z�P��Kj���|��KI�~�
`"�```�~�C �YJ�M�Rfvr�����:?������[�����[n�{�"^u��O211���EӢ@>�߰X����S�q6��P.��X@�f��qn�x)��35;���#�� � �����d�&g�X��f>� �S,�P۶�-�hmn�1�'��LO��XIz ʜģ��#�����%؎N�`��!�ï����/\_�����YȲ$�ڍ��G.�n\*��� �\_@ś����Y\_pzj�[n���|���.��P�ftl���Khں��d�}�����O���!>��ƶuZ��/�~�YPJ�b�8�̫�8x�z1���+Tx��;/裱��x2���sy�"��r�!<�N:�#�-�h�ӳ4�G����Ԓ�$�I\�E7�jr7v�Rn�s#�@�\:E�m+�Az�(��Xu�t,Y���YD�M\*c#�b�� �L���a�rU �PȤ^�ktc�Fa��a��ժ\2���E|~[�l�0M��wp�AR�EŶ��S��g�o����&����'?�����x��A��M2R"��n4�\@��j�KK�k08�b|.���4G�p\�D:W�!���e�E�u����0Lr���7\J�2�R �۶1e������G�S3�
6-
�S�
�E8%Jfv�
���F!^�N�HMǲ�bUHǟ��[����zWa8�()�
`CC��w[�l�ݽGE�6�<�8n����Y�C�H
�ɏ��7��\_��s�f�9�!�u��������o��>J�"��vYg�����1��
�"�n�35�^�`l&FwG+㓳�-�zc���k��9��2�lW
,���1�fҘ��>�9;�%U��.Z���|\_y���8��x�Cɡ���:D�s%\_/ew�Pp��S�GoE(��|��&�}�O8r��=����������d��\v�vl�;?��7��'��8�Z~.y
�և�1��x��'X���%�rÎ�<�͟�O���M\�����Y���b����)�� '��Q5��xUӨ��(��uMC�4t\*���J�la�-��Y��<��}-�z'~s�����szl����#�-&�f�)�����"��Q�;oBJU "�0U��d�p]��{�L:���|�?��+/�����]���Ϋ����.'O�\_��Ӌ@Vo e����Z���6�C��o���-x=&�����\_���L��p�x\*˞�#U��
�d��G�@JeJe�b�Z�0
�|���To$f�@U�g�9��(V�h���Qf�&��Md�y��B�|�lw$Gi��� �:��$��D�<��7W�b�ȼ�z�W>������?�w��������]�!�Mʹ����\*�t���� ��Bs�c�IT5���mI�baMo<���Uv�Z��'�=�n;�o�����;736����v�g��|^�r�S㳘�N>\_D�5�����
EJ�
�B�R[�)h��m���}L�sX�C.1ˉC�s%ʁE,k�0:9CC��h2��3��^EM�x��T�i +E�~���I���בR�ܳ����Ú�ky�]w���R[������H�Q�!tf��J�2s.`�=΂$�D&��I"�8�[�nƩ�D�g)GN�8>2�6�#A���{y��B��|d��D�dޢT�p���Ʀ����R�Υ�tݠX�)W,<�I�T&Wv��l��C#��~z�A�n3ub?nl�i�:�o�cv�'�����4Z�2/�;�MBHC7��6V%��0z��i��3���Յa�[�j�{��K\_zE�SWw9�-���df��p�<H�( �"�8V�Z;UB����6�[�֮�|ky�#���w�ؾq�~��\s�Z~��8{N�S�>�B\*W ��Q,��ա��E:\_��5(�KL�2t4����12� �X ��c̳��-)��N;2����FDPE�:��4���u+����4H�������o3�%3ILB��f�5I��
���� ���ea���í�e�A�\�.7z���+
Q0H�`��d�a2��mf�t����>���"������������l���7���E��3%�@�{�ݛ��u��B��-��g�%�n��7Iydd�;�S�U�d�"�a�D(����h���%�UK�X�&U�b��A{a��&83Q�X,Ҭ���[��:$b�д�!A��OYD���Bk�r�fN��
�)9zV����z ��b���ٲe˛��<����Z�Fז�Ln��'P�$F� ���4\_B �iHRWcM��>�$��@P�8�4F���$
!$���ٳ�}H�4\_8=�V��7�fl�đӯ#+2���\*�E�L�� ��\*�b
�\*
.}�",W���g��>
��F�vӢQ� ��2����/'�� ߧe��%4-O$�׮��mT9���"�A��a�o�o[��U�عs'Ӆ����r�����){��Ʋ��bב�}�j�Wh� �=E�=N.�M�S��M͡�K0���F7.$����0W{�)��)T5����q����5���\_�q5�:�t�Ί\�q�� ��v+8�sF���$g�&Ɉ�w�<�H��cE>�6˩�-��C�^L4~��0�3��NS\*��;�5w�V{�:A�>G�5B�|����2�:H�=�Y;��}�FGGy��s͵��
�.\_��?��}��K�v����� ��M�뇱��� ���$�(W�u\*���V�o��ާ�̧1͗�����c"�te�16�X�E�u���;h�:��=�����yTU��x��t�>9�������G�5,�\*�S0�:n�9C�T�f�rgx
'X��O�~����5�2)��e��fk��y��=�=� �e���]�]�v͇��{�����'��N6��H��I�� A}9�S@���h྾[i����{�drK�0�^�0�\*i���n�S�������+���G�� p"�W-#
�������n�W�u ��#/0�h�J|�p����� � ]��{��?�r�v#E��uň�GR������Vö��b1V�����eh���\_���g����LL��\*��r{ �+z��{�X�:�����Q¡ww'�5A�u�qY��Z�/�&��b�G(r���ǃ�t�Z�D�B0o���G��n��e��'�Y����"1\(1<5�L��@"ݷ�dl�/(5���+�O~�kj��yM���0���HH� zh�Y�L�8C.�涍k�����)���+#l�z�J�`p�콽 ��q��O�j��i��;ɤwq��4%��噫 ��p�]L��:��U��歩�H�D×���
\_��'~Ɏ/���)������Ǧ�<q��������D�NT��� �p���0�h��|�P���N"zC/��h���^C:u+B(��s4[#d���za��/�tj-��r̩�;=�-K����9$ϡ\�drr��a�\_@\*MMٱ�6\*�����2wχ$ӥb���n��P.������C.}'����܃ic0�lg
׭�H1��oiz6m
����������\_���o�����k�ӰZ��������8;Y��������v��o{db:r �s�LR5,@"{?>��5���r�CU2�Ut��ҟ܊@Y��h����5���
��:#cg��6I��A�l����� "����ww��ۙ��x��؛�ƫ"t��}�Ė �8m{�3K�c���|������^��FU���� �/#��#x��Vsۙ�j�a ���0�S芌��\*m��6/���
W��ٷI�VS7\_$\ÿ��;ໄ�!���ߕ��������\U��)�D���#��F��@y�чQ��s�zA�?�b���8
���y�w��$�ܖ���~�л߁�L3]�|���'��/l^��X���.��hx#�}��f�U��Z"����8%��Q<��k�Ӻ��(�?�Cݣ�CG
B��H�ȋ ��]��ޢ���.�=A$�����qJ�`套t�g��I?�7ڶMU��MҮ��$Ka��P��|���aZ'�O��te�hX�c�}���c\�.H����=I˞�:�{"���{���e�x+;��}j����D�jd@W2$"Wm@BE�`4�\*)҉[X���E���h��=�9����q��+z��!��r/��,���S����m��>>-{Ϸ��00���cccF�� X/aT��zq�9���P
�z    IEND�B`�

=== Content from www.gentoo.org_3891a3f3_20250125_012544.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Jinja2: Multiple vulnerabilities — GLSA **201408-13**

Multiple vulnerabilities have been found in Jinja2, allowing local
attackers to escalate their privileges.

### Affected packages

| Package | **dev-python/jinja** on all architectures |
| --- | --- |
| Affected versions | < **2.7.3** |
| Unaffected versions | >= **2.7.3** |

### Background

Jinja2 is a template engine written in pure Python.

### Description

Multiple vulnerabilities have been discovered in Jinja2. Please review
the CVE identifiers referenced below for details.

### Impact

A local attacker could gain escalated privileges via a specially crafted
cache file or pre-created temporary directory.

### Workaround

There is no known workaround at this time.

### Resolution

All Jinja2 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-python/jinja-2.7.3"

```
### References

* [CVE-2014-0012](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-0012)
* [CVE-2014-1402](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1402)

**Release date**

August 29, 2014

**Latest revision**

August 29, 2014: 1

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [497690](https://bugs.gentoo.org/show_bug.cgi?id=497690)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from github.com_1697a52b_20250126_050332.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-fqh9-2qgg-h84h)

**CVE-2014-0012**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-fqh9-2qgg-h84h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2014-0012](/advisories/GHSA-fqh9-2qgg-h84h)

## Insecure Temporary File in Jinja2

Moderate severity

GitHub Reviewed

Published
May 17, 2022
to the GitHub Advisory Database
•
Updated Sep 23, 2024

[Vulnerability details](/advisories/GHSA-fqh9-2qgg-h84h)
[Dependabot alerts
0](/advisories/GHSA-fqh9-2qgg-h84h/dependabot)

## Package

pip

Jinja2
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 2.7.2

## Patched versions

2.7.2

## Description

FileSystemBytecodeCache in Jinja2 prior to version 2.7.2 does not properly create temporary directories, which allows local users to gain privileges by pre-creating a temporary directory with a user's uid. NOTE: this vulnerability exists because of an incomplete fix for [CVE-2014-1402](https://github.com/advisories/GHSA-8r7q-cvjq-x353 "CVE-2014-1402").

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2014-0012>
* <https://bugzilla.redhat.com/show_bug.cgi?id=1051421>
* <http://seclists.org/oss-sec/2014/q1/73>
* <http://www.gentoo.org/security/en/glsa/glsa-201408-13.xml>
* [pallets/jinja#292](https://github.com/pallets/jinja/pull/292)
* [pallets/jinja#296](https://github.com/pallets/jinja/pull/296)
* [pallets/jinja@acb672b](https://github.com/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)
* [pallets/jinja#292](https://github.com/pallets/jinja/pull/292)
* [pallets/jinja#296](https://github.com/pallets/jinja/pull/296)
* [pallets/jinja@acb672b](https://github.com/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)
* <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=734747>
* <https://github.com/pypa/advisory-database/tree/main/vulns/jinja2/PYSEC-2014-82.yaml>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2014-0012)
May 19, 2014

Published to the GitHub Advisory Database
May 17, 2022

Reviewed
Feb 14, 2023

Last updated
Sep 23, 2024

### Severity

Moderate

6.9

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Local

Attack Complexity
Low

Attack Requirements
None

Privileges Required
None

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
None

Integrity
High

Availability
None
##### Subsequent System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N

### EPSS score

0.042%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (5th percentile)

### Weaknesses

[CWE-377](/advisories?query=cwe%3A377)

### CVE ID

CVE-2014-0012

### GHSA ID

GHSA-fqh9-2qgg-h84h

### Source code

[pallets/jinja2](https://github.com/pallets/jinja2)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-fqh9-2qgg-h84h/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_841af716_20250125_012548.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F292)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F292)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=pallets%2Fjinja)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pallets](/pallets)
/
**[jinja](/pallets/jinja)**
Public

* [Notifications](/login?return_to=%2Fpallets%2Fjinja) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fpallets%2Fjinja)
* [Star
   10.5k](/login?return_to=%2Fpallets%2Fjinja)

* [Code](/pallets/jinja)
* [Issues
  62](/pallets/jinja/issues)
* [Pull requests
  16](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

Additional navigation options

* [Code](/pallets/jinja)
* [Issues](/pallets/jinja/issues)
* [Pull requests](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpallets%2Fjinja%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpallets%2Fjinja%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix for CVE-2014-0012 (Insecure temp folder creation) #292

 Closed

[kilink](/kilink)
wants to merge
1
commit into
[pallets:master](/pallets/jinja/tree/master "pallets/jinja:master")
from
kilink:fix-cve-2014-0012

 Closed

# [Fix for CVE-2014-0012 (Insecure temp folder creation)](#top) #292

[kilink](/kilink)
wants to merge
1
commit into
[pallets:master](/pallets/jinja/tree/master "pallets/jinja:master")
from
kilink:fix-cve-2014-0012

[Conversation
3](/pallets/jinja/pull/292)
[Commits
1](/pallets/jinja/pull/292/commits)
[Checks
0](/pallets/jinja/pull/292/checks)
[Files changed](/pallets/jinja/pull/292/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![kilink](https://avatars.githubusercontent.com/u/835139?s=60&v=4)](/kilink)

Copy link

### @kilink **[kilink](/kilink)** commented [Jan 18, 2014](#issue-25864374)

I think this one slipped through the cracks somehow, but the fix for [CVE-2014-1402](https://github.com/mitsuhiko/jinja2/commit/acb672b6a179567632e032f547582f30fa2f4aa7) introduced another security issue, which was assigned [CVE-2014-0012](https://github.com/advisories/GHSA-fqh9-2qgg-h84h "CVE-2014-0012").

This PR simply delegates temporary directory creation to `tempfile.mkdtemp()` in FileSystemBytecodeCache, which does the right thing.

The tests pass, but the only question I have is in regard to the intended behavior of the FilesystemBytecodeCache. Should multiple instances of a FileSystemBytecodeCache initialized without the directory argument point to the same directory? If so, I would need to modify my PR to stash the directory as a class variable (or something) to work around the issue.

Please see the following links for discussion of the issue:

<http://seclists.org/oss-sec/2014/q1/73>

<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=734956>

Note that it looks like this was fixed via a similar patch in Debian, but it would be nice to have this upstream.

Sorry, something went wrong.

All reactions

[![@kilink](https://avatars.githubusercontent.com/u/835139?s=40&v=4)](/kilink)

`[Fix for](/pallets/jinja/pull/292/commits/7dfea0feec6f28e600b81d0c0eba256b2f52558d "Fix for CVE-2014-0012") [CVE-2014-0012](https://github.com/advisories/GHSA-fqh9-2qgg-h84h "CVE-2014-0012")`

`[7dfea0f](/pallets/jinja/pull/292/commits/7dfea0feec6f28e600b81d0c0eba256b2f52558d)`

[![@thoger](https://avatars.githubusercontent.com/u/4051912?s=80&v=4)](/thoger)

Copy link

Contributor

### **[thoger](/thoger)** commented [Jan 27, 2014](#issuecomment-33396371)

| Similar patch is used in Debian packages too:  <http://patch-tracker.debian.org/patch/series/view/jinja2/2.7.2-2/fix_CVE-2014-0012.patch>  Should multiple instances of a FileSystemBytecodeCache initialized without the directory argument point to the same directory?  Jinja2 [documentation](http://jinja.pocoo.org/docs/api/#bytecode-cache) says:  Bytecode caches make it possible to store the generated bytecode on the file system or a different location to avoid parsing the templates on first use.  This is especially useful if you have a web application that is initialized on the first request and Jinja compiles many templates at once which slows down the application.  It seems re-use of cache across invocation is expected, which makes `tempfile.mkdtemp()` fix not usable. I also assume that approach has more issues with cache file clean up because of lack of temporary directory removal. |
| --- |

All reactions

Sorry, something went wrong.

[![@kilink](https://avatars.githubusercontent.com/u/835139?s=80&u=118c79f66465188311aebd5bf0dee76e3989345d&v=4)](/kilink)

Copy link

Author

### **[kilink](/kilink)** commented [Jan 28, 2014](#issuecomment-33490853)

| As I said, the directory name could be cached on the class to preserve it across instances of FileSystemBytecodeCache objects. I can change the PR, but first I'd like to get feedback from a Jinja2 committer.  The existing implementation doesn't clean up the directory it creates either, so I think that is a separate issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@thoger](https://avatars.githubusercontent.com/u/4051912?s=80&v=4)](/thoger)

Copy link

Contributor

### **[thoger](/thoger)** commented [Jan 28, 2014](#issuecomment-33496927)

| As I said, the directory name could be cached on the class to preserve it across instances of FileSystemBytecodeCache objects.  Is that something that should only work for multiple instances created during the one invocation of an application, or something that should work across application invocations? If I understand your brief hint correctly, that approach would not try to cover multiple invocations.  The existing implementation doesn't clean up the directory it creates either, so I think that is a separate issue.  The current implementation doesn't clean up, but there is a fixed limit on the number of cache files created - the number of templates used. With real temporary directory, it's that number multiplied by number of invocations. |
| --- |

All reactions

Sorry, something went wrong.

[thoger](/thoger)
referenced
this pull request
[Feb 9, 2014](#ref-commit-acb672b)
[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)

`[Fixed a security issue with temporary files on the filesystem cache o…](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7 "Fixed a security issue with temporary files on the filesystem cache on UNIX.")`
…

`[acb672b](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)`

```
…n UNIX.
```

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)
[mitsuhiko](/mitsuhiko)
closed this
[Jun 6, 2014](#event-128880302)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
locked as **resolved** and limited conversation to collaborators
[Nov 13, 2020](#event-3995394988)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F292).

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@kilink](https://avatars.githubusercontent.com/u/835139?s=52&v=4)](/kilink) [![@thoger](https://avatars.githubusercontent.com/u/4051912?s=52&v=4)](/thoger) [![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=52&v=4)](/mitsuhiko)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seclists.org_dc589346_20250125_012541.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](72)
[By Date](date.html#73)
[![Next](/images/right-icon-16x16.png)](74)

[![Previous](/images/left-icon-16x16.png)](72)
[By Thread](index.html#73)
[![Next](/images/right-icon-16x16.png)](74)

![](/shared/images/nst-icons.svg#search)

# CVE assignment for jinja2

---

*From*: Kurt Seifried <kseifried () redhat com>

*Date*: Fri, 10 Jan 2014 22:34:10 -0700

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

<https://github.com/mitsuhiko/jinja2/commit/acb672b6a179567632e032f547582f30fa2f4aa7>

dirname = '_jinja2-cache-%d' % os.getuid()

Arun Babu Neelicattu of Red Hat spotted this commit which introduces a
temporary file creation vulnerability. This issue has been assigned
CVE-2014-0012. For information on how to safely create temporary files
please see
<http://kurt.seifried.org/2012/03/14/creating-temporary-files-securely/>

For Python simply use ?mkstemp? for files and ?mkdtemp? for
directories from the ?tempfile? module.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJS0NfSAAoJEBYNRVNeJnmT9BMQAMg1DOmYdeZc+E4iKDf8DB8Z
pUwmv0fq64L1zkWK6tPi4PcEAh2b37RaVKTW8pU7QAzsDYiQvuPpgFKrAKD/wKJq
S6ySyyILmc8+ZDdamkRTq97i8Cfe/tf5wR/el4Cax+P8sL5qlfAKzfzdoG6PHErk
zlvfv6ESAPDAmh6iC4ckd4+Kkda6xdN1pAJsY3y+TTtE/tnCRJfR5r6QZLsJma8p
ovRZ4zzbn0I+i5/kyReVKKRQSaHF2jMY5Mt12V/vkIFyHovL9MJC7GrSos0VM6C1
V6YtkWjc/GYyIeookaHXRpaJx65BLqPcaQ6EpQ8jcogkfnHT0Eyh9G9EItcfqA9g
2rd7/1H6zpM+ijzq4SVFZAzhXvUmstk6ruUzbP90BPwrD6YEobzRTys/ZsV9Wnek
HCTW2NYh/qXRSvQrwNoKB8rIrvg2YKoz40LBsMF3fsvrWKZ86zBNYsgebXecdc+T
F+fNh7ioBWZnKGpZFCCzarAzrV1OjkSuAmf7cLLITSttJOAZkD1bcn40R2Z6YiRf
fWKgR8Af/SqIq6/8EVk9FEzJ9ni2I/0qaPOzX5927xSV+4vogyYBq4RZhEwqCQjs
+zfpiOUwzDuiQ5aRmMYqJSXK5ww+qO5hNiLyyxfLY/psaP2Y2df5zaRltvMLxCuk
wU92wxHFjUBKS5wBgwlP
=7f5m
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](72)
[By Date](date.html#73)
[![Next](/images/right-icon-16x16.png)](74)

[![Previous](/images/left-icon-16x16.png)](72)
[By Thread](index.html#73)
[![Next](/images/right-icon-16x16.png)](74)

### Current thread:

* **CVE assignment for jinja2** *Kurt Seifried (Jan 10)*
  + [Re: CVE assignment for jinja2](74) *Vincent Danen (Jan 11)*
    - [Re: CVE assignment for jinja2](75) *Vincent Danen (Jan 11)*
    - [Re: CVE assignment for jinja2](76) *Salvatore Bonaccorso (Jan 11)*
      * [Re: CVE assignment for jinja2](77) *Vincent Danen (Jan 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_069ee030_20250125_012549.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F296)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F296)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=pallets%2Fjinja)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pallets](/pallets)
/
**[jinja](/pallets/jinja)**
Public

* [Notifications](/login?return_to=%2Fpallets%2Fjinja) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fpallets%2Fjinja)
* [Star
   10.5k](/login?return_to=%2Fpallets%2Fjinja)

* [Code](/pallets/jinja)
* [Issues
  62](/pallets/jinja/issues)
* [Pull requests
  16](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

Additional navigation options

* [Code](/pallets/jinja)
* [Issues](/pallets/jinja/issues)
* [Pull requests](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpallets%2Fjinja%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpallets%2Fjinja%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix for CVE-2014-0012 #296

 Closed

[thoger](/thoger)
wants to merge
1
commit into
[pallets:master](/pallets/jinja/tree/master "pallets/jinja:master")
from
thoger:CVE-2014-0012

 Closed

# [Fix for CVE-2014-0012](#top) #296

[thoger](/thoger)
wants to merge
1
commit into
[pallets:master](/pallets/jinja/tree/master "pallets/jinja:master")
from
thoger:CVE-2014-0012

[Conversation
3](/pallets/jinja/pull/296)
[Commits
1](/pallets/jinja/pull/296/commits)
[Checks
0](/pallets/jinja/pull/296/checks)
[Files changed](/pallets/jinja/pull/296/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![thoger](https://avatars.githubusercontent.com/u/4051912?s=60&v=4)](/thoger)

Copy link

Contributor

### @thoger **[thoger](/thoger)** commented [Feb 9, 2014](#issue-27227270)

Commit [acb672b](https://github.com/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7) attempted to fix insecure temporary file use in FileSystemBytecodeCache by introducing per-user temporary directory. However, if directory already exists, it is used without checking its ownership and permissions. Local attacker able to create temporary directory with victim's uid before victim does so can achieve the same impact as with the original issue.

This attempts to address the issue by introducing ownership, permission and type check and makes jinja2 raise an exception if existing directory has unexpected attributes.

Further discussion can be found in:

<https://bugzilla.redhat.com/show_bug.cgi?id=1051421>

Sorry, something went wrong.

All reactions

[![@thoger-rh](https://avatars.githubusercontent.com/u/163308325?s=40&v=4)](/thoger-rh)

`[Fix](/pallets/jinja/pull/296/commits/4fe07b76b8c53d935963fb92394b4c71ea9d4c91 "Fix CVE-2014-0012

Add checks for the per-user temporary directory.  If it already exists, make
sure that it:
- is owned by the current user
- is directory
- has expected permissions

This commit also fixes:
- nt -> n typo pointed out in the review of acb672b
- replace 448 with stat.S_IRWXU when setting directory mode") [CVE-2014-0012](https://github.com/advisories/GHSA-fqh9-2qgg-h84h "CVE-2014-0012")`
 …

`[4fe07b7](/pallets/jinja/pull/296/commits/4fe07b76b8c53d935963fb92394b4c71ea9d4c91)`

```
Add checks for the per-user temporary directory.  If it already exists, make
sure that it:
- is owned by the current user
- is directory
- has expected permissions

This commit also fixes:
- nt -> n typo pointed out in the review of [acb672b](https://github.com/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)
- replace 448 with stat.S_IRWXU when setting directory mode
```

[thoger](/thoger)
referenced
this pull request
[Feb 9, 2014](#ref-commit-acb672b)
[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)

`[Fixed a security issue with temporary files on the filesystem cache o…](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7 "Fixed a security issue with temporary files on the filesystem cache on UNIX.")`
…

`[acb672b](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)`

```
…n UNIX.
```

[mitsuhiko](/mitsuhiko)
added a commit
that referenced
this pull request
[Jun 6, 2014](#ref-commit-377b9b5)
[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)

`[Applied changes from](/pallets/jinja/commit/377b9b55f3866fd8b1e4a941639f2af430c8285d "Applied changes from #296 for better checking.") [#296](https://github.com/pallets/jinja/pull/296) [for better checking.](/pallets/jinja/commit/377b9b55f3866fd8b1e4a941639f2af430c8285d "Applied changes from #296 for better checking.")`

`[377b9b5](/pallets/jinja/commit/377b9b55f3866fd8b1e4a941639f2af430c8285d)`

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=80&v=4)](/mitsuhiko)

Copy link

Contributor

### **[mitsuhiko](/mitsuhiko)** commented [Jun 6, 2014](#issuecomment-45358384)

| Fixed. |
| --- |

All reactions

Sorry, something went wrong.

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)
[mitsuhiko](/mitsuhiko)
closed this
[Jun 6, 2014](#event-128877407)

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=80&v=4)](/mitsuhiko)

Copy link

Contributor

### **[mitsuhiko](/mitsuhiko)** commented [Jun 6, 2014](#issuecomment-45359215)

| Sorry for the lack of feedback on this. I completely lost track of this issue and I did not subscribe to the red hat ticket so i failed to see the continued discussion. |
| --- |

All reactions

Sorry, something went wrong.

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=80&v=4)](/mitsuhiko)

Copy link

Contributor

### **[mitsuhiko](/mitsuhiko)** commented [Jun 6, 2014](#issuecomment-45359233)

| 2.7.3 has just this fix in now. |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
locked as **resolved** and limited conversation to collaborators
[Nov 13, 2020](#event-3995394283)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F296).

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@thoger](https://avatars.githubusercontent.com/u/4051912?s=52&v=4)](/thoger) [![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=52&v=4)](/mitsuhiko) [![@thoger-rh](https://avatars.githubusercontent.com/u/163308325?s=52&v=4)](/thoger-rh)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from access.redhat.com_c20e6496_20250126_050333.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_1a02c5a2_20250126_050319.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fcommit%2Facb672b6a179567632e032f547582f30fa2f4aa7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fcommit%2Facb672b6a179567632e032f547582f30fa2f4aa7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pallets%2Fjinja)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pallets](/pallets)
/
**[jinja](/pallets/jinja)**
Public

* [Notifications](/login?return_to=%2Fpallets%2Fjinja) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fpallets%2Fjinja)
* [Star
   10.5k](/login?return_to=%2Fpallets%2Fjinja)

* [Code](/pallets/jinja)
* [Issues
  62](/pallets/jinja/issues)
* [Pull requests
  16](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

Additional navigation options

* [Code](/pallets/jinja)
* [Issues](/pallets/jinja/issues)
* [Pull requests](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

## Commit

[Permalink](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixed a security issue with temporary files on the filesystem cache o…

[Browse files](/pallets/jinja/tree/acb672b6a179567632e032f547582f30fa2f4aa7)
Browse the repository at this point in the history

```
…n UNIX.
```

* Loading branch information

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)

[mitsuhiko](/pallets/jinja/commits?author=mitsuhiko "View all commits by mitsuhiko")
committed
Jan 10, 2014

1 parent
[701e9ad](/pallets/jinja/commit/701e9ada2b6968cf2bc41a3c1d4235922ce164f5)

commit acb672b

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**32 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGES
  [CHANGES](#diff-aac07aefec754086f5c344e2c233862f6a611c739b5647fd456c1b77d3577c79)
* jinja2

  + jinja2/bccache.py
    [bccache.py](#diff-464890d18e85aabcbfbf9c307d3e6527bdde1b79fb738dfdc248b2867dd34c95)

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[CHANGES](#diff-aac07aefec754086f5c344e2c233862f6a611c739b5647fd456c1b77d3577c79 "CHANGES")

Show comments

[View file](/pallets/jinja/blob/acb672b6a179567632e032f547582f30fa2f4aa7/CHANGES)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,6 +7,11 @@ Version 2.7.2 |
|  |  |  |
|  |  | - Prefix loader was not forwarding the locals properly to |
|  |  | inner loaders. This is now fixed. |
|  |  | - Security issue: Changed the default folder for the filesystem cache to be |
|  |  | user specific and read and write protected on UNIX systems. See `Debian bug |
|  |  | 734747`\_ for more information. |
|  |  |  |
|  |  | .. \_Debian bug 734747: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=734747 |
|  |  |  |
|  |  | Version 2.7.1 |
|  |  | ------------- |
| Expand Down | |  |

29 changes: 27 additions & 2 deletions

29
[jinja2/bccache.py](#diff-464890d18e85aabcbfbf9c307d3e6527bdde1b79fb738dfdc248b2867dd34c95 "jinja2/bccache.py")

Show comments

[View file](/pallets/jinja/blob/acb672b6a179567632e032f547582f30fa2f4aa7/jinja2/bccache.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,7 +15,9 @@ |
|  |  | :license: BSD. |
|  |  | """ |
|  |  | from os import path, listdir |
|  |  | import os |
|  |  | import sys |
|  |  | import errno |
|  |  | import marshal |
|  |  | import tempfile |
|  |  | import fnmatch |
| Expand Down  Expand Up | | @@ -189,7 +191,9 @@ class FileSystemBytecodeCache(BytecodeCache): |
|  |  | two arguments: The directory where the cache items are stored and a |
|  |  | pattern string that is used to build the filename. |
|  |  |  |
|  |  | If no directory is specified the system temporary items folder is used. |
|  |  | If no directory is specified a default cache directory is selected. On |
|  |  | Windows the user's temp directory is used, on UNIX systems a directory |
|  |  | is created for the user in the system temp directory. |
|  |  |  |
|  |  | The pattern can be used to have multiple separate caches operate on the |
|  |  | same directory. The default pattern is ``'\_\_jinja2\_%s.cache'``. ``%s`` |
| Expand All | | @@ -202,10 +206,31 @@ class FileSystemBytecodeCache(BytecodeCache): |
|  |  |  |
|  |  | def \_\_init\_\_(self, directory=None, pattern='\_\_jinja2\_%s.cache'): |
|  |  | if directory is None: |
|  |  | directory = tempfile.gettempdir() |
|  |  | directory = self.\_get\_default\_cache\_dir() |
|  |  | self.directory = directory |
|  |  | self.pattern = pattern |
|  |  |  |
|  |  | def \_get\_default\_cache\_dir(self): |
|  |  | tmpdir = tempfile.gettempdir() |
|  |  |  |
|  |  | # On windows the temporary directory is used specific unless |
|  |  | # explicitly forced otherwise. We can just use that. |
|  |  | if os.name == 'n': |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fcommit%2Facb672b6a179567632e032f547582f30fa2f4aa7)       Sorry, something went wrong.           Copy link    Quote reply     @alex **[alex](/alex)** [Jan 10, 2014](#r5034507)  This looks like a typo, should be "nt" I believe?      All reactions | | |
|  |  | return tmpdir |
|  |  | if not hasattr(os, 'getuid'): |
|  |  | raise RuntimeError('Cannot determine safe temp directory. You ' |
|  |  | 'need to explicitly provide one.') |
|  |  |  |
|  |  | dirname = '\_jinja2-cache-%d' % os.getuid() |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fcommit%2Facb672b6a179567632e032f547582f30fa2f4aa7)       Sorry, something went wrong.           Copy link    Quote reply     @vdanen **[vdanen](/vdanen)** [Jan 11, 2014](#r5042832)  this is vulnerable to a race condition; don't use os.getuid() here as your end result is neither safe nor predictable; in this case it will return /tmp/\_jinja2-cache-$uid or, if we're lucky and the user has $TMPDIR set in their environment, we might get ~/tmp/\_jinja2-cache-$uid, but there are no guarantees there.      All reactions | | |
|  |  | actual\_dir = os.path.join(tmpdir, dirname) |
|  |  | try: |
|  |  | os.mkdir(actual\_dir, 0700) |
|  |  | except OSError as e: |
|  |  | if e.errno != errno.EEXIST: |
|  |  | raise |
|  |  |  |
|  |  | return actual\_dir |
|  |  |  |
|  |  | def \_get\_cache\_filename(self, bucket): |
|  |  | return path.join(self.directory, self.pattern % bucket.key) |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 3 comments on commit `acb672b`

[![@vdanen](https://avatars.githubusercontent.com/u/643587?s=80&v=4)](/vdanen)

Copy link

### @vdanen **[vdanen](/vdanen)** commented on `[acb672b](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)` [Jan 11, 2014](#commitcomment-5042809)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This was actually assigned [CVE-2014-1402](https://github.com/advisories/GHSA-8r7q-cvjq-x353 "CVE-2014-1402") by MITRE, see <http://seclists.org/oss-sec/2014/q1/71>; as that assignment was made on the oss-security list about 20hrs earlier, [CVE-2014-0012](https://github.com/advisories/GHSA-fqh9-2qgg-h84h "CVE-2014-0012") shouldn't be used to refer to this issue (it will need to be rejected as a dupe)

Sorry, something went wrong.

All reactions

[![@vdanen](https://avatars.githubusercontent.com/u/643587?s=80&v=4)](/vdanen)

Copy link

### @vdanen **[vdanen](/vdanen)** commented on `[acb672b](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)` [Jan 11, 2014](#commitcomment-5042835)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Woops, ignore my comment about. [CVE-2014-1402](https://github.com/advisories/GHSA-8r7q-cvjq-x353 "CVE-2014-1402") is for the original issue this was supposed to fix, [CVE-2014-0012](https://github.com/advisories/GHSA-fqh9-2qgg-h84h "CVE-2014-0012") is for the new issue this one introduces (see my comment in the code at line 224; as Kurt says, mkstemp).

Sorry, something went wrong.

All reactions

[![@thoger](https://avatars.githubusercontent.com/u/4051912?s=80&v=4)](/thoger)

Copy link

Contributor

### @thoger **[thoger](/thoger)** commented on `[acb672b](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)` [Feb 9, 2014](#commitcomment-5320612)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Note there are now 2 pull requests that attempt to address [CVE-2014-0012](https://github.com/advisories/GHSA-fqh9-2qgg-h84h "CVE-2014-0012"):

* [Fix for CVE-2014-0012 (Insecure temp folder creation) #292](https://github.com/pallets/jinja/pull/292) - uses `tempfile.mkdtemp()` to create new temporary directory on each run
* [Fix for CVE-2014-0012 #296](https://github.com/pallets/jinja/pull/296) - uses per-uid temporary directory as used in 2.7.2, but adds checks to avoid directory owned by different user

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fcommit%2Facb672b6a179567632e032f547582f30fa2f4aa7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2f74f95d_20250126_050320.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F292)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F292)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=pallets%2Fjinja)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pallets](/pallets)
/
**[jinja](/pallets/jinja)**
Public

* [Notifications](/login?return_to=%2Fpallets%2Fjinja) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fpallets%2Fjinja)
* [Star
   10.5k](/login?return_to=%2Fpallets%2Fjinja)

* [Code](/pallets/jinja)
* [Issues
  62](/pallets/jinja/issues)
* [Pull requests
  16](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

Additional navigation options

* [Code](/pallets/jinja)
* [Issues](/pallets/jinja/issues)
* [Pull requests](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpallets%2Fjinja%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpallets%2Fjinja%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix for CVE-2014-0012 (Insecure temp folder creation) #292

 Closed

[kilink](/kilink)
wants to merge
1
commit into
[pallets:master](/pallets/jinja/tree/master "pallets/jinja:master")
from
kilink:fix-cve-2014-0012

 Closed

# [Fix for CVE-2014-0012 (Insecure temp folder creation)](#top) #292

[kilink](/kilink)
wants to merge
1
commit into
[pallets:master](/pallets/jinja/tree/master "pallets/jinja:master")
from
kilink:fix-cve-2014-0012

[Conversation
3](/pallets/jinja/pull/292)
[Commits
1](/pallets/jinja/pull/292/commits)
[Checks
0](/pallets/jinja/pull/292/checks)
[Files changed](/pallets/jinja/pull/292/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![kilink](https://avatars.githubusercontent.com/u/835139?s=60&v=4)](/kilink)

Copy link

### @kilink **[kilink](/kilink)** commented [Jan 18, 2014](#issue-25864374)

I think this one slipped through the cracks somehow, but the fix for [CVE-2014-1402](https://github.com/mitsuhiko/jinja2/commit/acb672b6a179567632e032f547582f30fa2f4aa7) introduced another security issue, which was assigned [CVE-2014-0012](https://github.com/advisories/GHSA-fqh9-2qgg-h84h "CVE-2014-0012").

This PR simply delegates temporary directory creation to `tempfile.mkdtemp()` in FileSystemBytecodeCache, which does the right thing.

The tests pass, but the only question I have is in regard to the intended behavior of the FilesystemBytecodeCache. Should multiple instances of a FileSystemBytecodeCache initialized without the directory argument point to the same directory? If so, I would need to modify my PR to stash the directory as a class variable (or something) to work around the issue.

Please see the following links for discussion of the issue:

<http://seclists.org/oss-sec/2014/q1/73>

<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=734956>

Note that it looks like this was fixed via a similar patch in Debian, but it would be nice to have this upstream.

Sorry, something went wrong.

All reactions

[![@kilink](https://avatars.githubusercontent.com/u/835139?s=40&v=4)](/kilink)

`[Fix for](/pallets/jinja/pull/292/commits/7dfea0feec6f28e600b81d0c0eba256b2f52558d "Fix for CVE-2014-0012") [CVE-2014-0012](https://github.com/advisories/GHSA-fqh9-2qgg-h84h "CVE-2014-0012")`

`[7dfea0f](/pallets/jinja/pull/292/commits/7dfea0feec6f28e600b81d0c0eba256b2f52558d)`

[![@thoger](https://avatars.githubusercontent.com/u/4051912?s=80&v=4)](/thoger)

Copy link

Contributor

### **[thoger](/thoger)** commented [Jan 27, 2014](#issuecomment-33396371)

| Similar patch is used in Debian packages too:  <http://patch-tracker.debian.org/patch/series/view/jinja2/2.7.2-2/fix_CVE-2014-0012.patch>  Should multiple instances of a FileSystemBytecodeCache initialized without the directory argument point to the same directory?  Jinja2 [documentation](http://jinja.pocoo.org/docs/api/#bytecode-cache) says:  Bytecode caches make it possible to store the generated bytecode on the file system or a different location to avoid parsing the templates on first use.  This is especially useful if you have a web application that is initialized on the first request and Jinja compiles many templates at once which slows down the application.  It seems re-use of cache across invocation is expected, which makes `tempfile.mkdtemp()` fix not usable. I also assume that approach has more issues with cache file clean up because of lack of temporary directory removal. |
| --- |

All reactions

Sorry, something went wrong.

[![@kilink](https://avatars.githubusercontent.com/u/835139?s=80&u=118c79f66465188311aebd5bf0dee76e3989345d&v=4)](/kilink)

Copy link

Author

### **[kilink](/kilink)** commented [Jan 28, 2014](#issuecomment-33490853)

| As I said, the directory name could be cached on the class to preserve it across instances of FileSystemBytecodeCache objects. I can change the PR, but first I'd like to get feedback from a Jinja2 committer.  The existing implementation doesn't clean up the directory it creates either, so I think that is a separate issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@thoger](https://avatars.githubusercontent.com/u/4051912?s=80&v=4)](/thoger)

Copy link

Contributor

### **[thoger](/thoger)** commented [Jan 28, 2014](#issuecomment-33496927)

| As I said, the directory name could be cached on the class to preserve it across instances of FileSystemBytecodeCache objects.  Is that something that should only work for multiple instances created during the one invocation of an application, or something that should work across application invocations? If I understand your brief hint correctly, that approach would not try to cover multiple invocations.  The existing implementation doesn't clean up the directory it creates either, so I think that is a separate issue.  The current implementation doesn't clean up, but there is a fixed limit on the number of cache files created - the number of templates used. With real temporary directory, it's that number multiplied by number of invocations. |
| --- |

All reactions

Sorry, something went wrong.

[thoger](/thoger)
referenced
this pull request
[Feb 9, 2014](#ref-commit-acb672b)
[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)

`[Fixed a security issue with temporary files on the filesystem cache o…](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7 "Fixed a security issue with temporary files on the filesystem cache on UNIX.")`
…

`[acb672b](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)`

```
…n UNIX.
```

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)
[mitsuhiko](/mitsuhiko)
closed this
[Jun 6, 2014](#event-128880302)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
locked as **resolved** and limited conversation to collaborators
[Nov 13, 2020](#event-3995394988)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F292).

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@kilink](https://avatars.githubusercontent.com/u/835139?s=52&v=4)](/kilink) [![@thoger](https://avatars.githubusercontent.com/u/4051912?s=52&v=4)](/thoger) [![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=52&v=4)](/mitsuhiko)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_75a8ba19_20250126_050332.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx���Au�0���B+P�&PL�A�����w�����\_ ���� 3�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$����pc籯�@���^=�\v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�c�1����<�������6�
nd��n���$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� ��\�y�'�G����H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A��������z�\_:�}���e$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� ��\�y�'�G����H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A��c�� >�e$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�  ��D�ہ�r�    IEND�B`�

=== Content from bugzilla.redhat.com_07c717af_20250125_012545.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1051421)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1051421)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1051421)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1051421

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1051421**](show_bug.cgi?id=1051421)
(CVE-2014-1402)
- [CVE-2014-1402](https://access.redhat.com/security/cve/CVE-2014-1402) python-jinja2: FileSystemBytecodeCache insecure cache temporary file use

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-1402 python-jinja2: FileSystemBytecodeCache insecure cache temporary...

| | [Keywords](describekeywords.cgi): | Reopened  Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-1402 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1051424](show_bug.cgi?id=1051424 "CLOSED ERRATA - python-jinja2: arbitrary code execution vulnerability [fedora-all]") [1051425](show_bug.cgi?id=1051425 "CLOSED ERRATA - python-jinja2: arbitrary code execution vulnerability [epel-all]") [1051426](show_bug.cgi?id=1051426 "CLOSED ERRATA - python26-jinja2: python-jinja2: arbitrary code execution vulnerability [epel-5]") [1051427](show_bug.cgi?id=1051427) [1102889](show_bug.cgi?id=1102889) [1102890](show_bug.cgi?id=1102890) [1102891](show_bug.cgi?id=1102891) [1102892](show_bug.cgi?id=1102892) [1102893](show_bug.cgi?id=1102893) [1102894](show_bug.cgi?id=1102894) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1051429](show_bug.cgi?id=1051429) | | TreeView+ | [depends on](buglist.cgi?bug_id=1051421&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1051421&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2014-01-10 09:36 UTC by Ratul Gupta | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 07:00 UTC ([History](show_activity.cgi?id=1051421)) | | [CC List:](page.cgi?id=fields.html#cclist) | 30 users (show)  aortega apevec ayoung bgollahe bkabrda chrisw drieden gkotton gmollett iheim jkurik jrusnack jwilk lhh lmacken markmc mmaslano mmcgrath nobody+bgollahe orion pfrields pj.pandit python-maint rbryant rhos-maint sclewis tdawson thomas.moschny vdanen yeylon | | Fixed In Version: | python-jinja2 2.7.3 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-01-20 18:31:18 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Fix for CVE-2014-0012**](attachment.cgi?id=856133 "View the content of the attachment") (880 bytes, patch)  [2014-01-27 16:05 UTC](#attach_856133 "Go to the comment associated with the attachment"), Bohuslav "Slavek" Kabrda | *no flags* | [Details](attachment.cgi?id=856133&action=edit) | [Diff](attachment.cgi?id=856133&action=diff) | | [**Fix for CVE-2014-0012 that uses lstat instead of stat**](attachment.cgi?id=856466 "View the content of the attachment") (882 bytes, patch)  [2014-01-28 10:39 UTC](#attach_856466 "Go to the comment associated with the attachment"), Bohuslav "Slavek" Kabrda | *no flags* | [Details](attachment.cgi?id=856466&action=edit) | [Diff](attachment.cgi?id=856466&action=diff) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=1051421&action=viewall&hide_obsolete=1) | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2014:0747](https://access.redhat.com/errata/RHSA-2014%3A0747) | 0 | normal | SHIPPED\_LIVE | Moderate: python-jinja2 security update | 2014-06-11 21:13:32 UTC | | Red Hat Product Errata | [RHSA-2014:0748](https://access.redhat.com/errata/RHSA-2014%3A0748) | 0 | normal | SHIPPED\_LIVE | Moderate: python33-python-jinja2 and python27-python-jinja2 security update | 2014-06-11 21:13:22 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1051421#c0)  Ratul Gupta    2014-01-10 09:36:01 UTC  ``` Jinja2, a template engine written in pure python, was found to use /tmp as a default directory for jinja2.bccache.FileSystemBytecodeCache, which is insecure because the /tmp directory is world-writable and the filenames used by FileSystemBytecodeCache are predictable. A malicious local user could exploit this bug to alter output generated by other user's application using Jinja2 or possibly, execute arbitrary code as another user.  References: <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=734747>   ```  [Comment 2](show_bug.cgi?id=1051421#c2)  Ratul Gupta    2014-01-10 09:39:24 UTC  ```  Created python-jinja2 tracking bugs for this issue:  Affects: fedora-all [[bug 1051424](show_bug.cgi?id=1051424 "CLOSED ERRATA - python-jinja2: arbitrary code execution vulnerability [fedora-all]")] Affects: epel-all [[bug 1051425](show_bug.cgi?id=1051425 "CLOSED ERRATA - python-jinja2: arbitrary code execution vulnerability [epel-all]")]   ```  [Comment 3](show_bug.cgi?id=1051421#c3)  Ratul Gupta    2014-01-10 09:39:29 UTC  ```  Created python26-jinja2 tracking bugs for this issue:  Affects: epel-5 [[bug 1051426](show_bug.cgi?id=1051426 "CLOSED ERRATA - python26-jinja2: python-jinja2: arbitrary code execution vulnerability [epel-5]")]   ```  [Comment 5](show_bug.cgi?id=1051421#c5)  Ratul Gupta    2014-01-10 11:42:49 UTC  ``` CVE Request: <http://seclists.org/oss-sec/2014/q1/71>   ```  [Comment 8](show_bug.cgi?id=1051421#c8)  Vincent Danen    2014-01-11 20:38:50 UTC  ``` The fix for this issue:  <https://github.com/mitsuhiko/jinja2/commit/acb672b6a179567632e032f547582f30fa2f4aa7>   ```  [Comment 9](show_bug.cgi?id=1051421#c9)  Vincent Danen    2014-01-11 20:55:21 UTC  ``` Note that Arun Babu Neelicattu reported [1] that the fix above introduced a new flaw (temporary file handling) which was assigned the CVE name [CVE-2014-0012](https://access.redhat.com/security/cve/CVE-2014-0012).  I've also commented on the upstream commit to make the problem very clear.  So the above patch cannot be used as-is; it needs to be corrected for the temporary file flaw.  As it stands now, we are not vulnerable to [CVE-2014-0012](https://access.redhat.com/security/cve/CVE-2014-0012) as nothing has used this flawed patch.   [1] <http://seclists.org/oss-sec/2014/q1/73>   ```  [Comment 10](show_bug.cgi?id=1051421#c10)  Thomas Moschny    2014-01-12 01:45:59 UTC  ``` (In reply to Vincent Danen from [comment #9](show_bug.cgi?id=1051421#c9)) > As it stands now, we are not vulnerable to [CVE-2014-0012](https://access.redhat.com/security/cve/CVE-2014-0012) as nothing has used > this flawed patch.  Well, I've build 2.7.2 (which includes a variant of that patch) for Rawhide, which is thus currently affected by the (new) [CVE-2014-0012](https://access.redhat.com/security/cve/CVE-2014-0012).  Version 2.7.2 has also been built for F20, but given that it is flawed, I will not create an update. Instead, I'll wait for an updated version of the patch, or a new version.  The final patch can then be ported to the older versions for F19 (2.6), F18 (2.8) and EL5 (2.2.1 and 2.5.5).   ```  [Comment 11](show_bug.cgi?id=1051421#c11)  Vincent Danen    2014-01-13 15:43:37 UTC  ``` I'm not too concerned about Rawhide.  That's a development version.  You're clearly aware of it, so I trust you'll ensure it's fixed there as well.  Provided 2.7.2 for F20 hasn't been pushed to stable, I think we can safely say this doesn't affect F20.  Waiting for a proper patch would be ideal, yes, although it probably wouldn't be too hard to just create one ourselves if upstream hasn't done so yet.  The only thing I can't tell by quickly looking is whether this cache directory needs to persist across invocations.  For instance, if it's supposed to survive from one run to the next then mkstemp is probably not the most appropriate way to go unless the location can be written to a config file for subsequent lookups.  I'm not familiar with this code and don't have time to look at it closer right now, but I do see that upstream hasn't yet done anything in this regard yet.  Given the impact of the issue, I think it would be ok to take a "wait and see" approach, provided upstream doesn't take too long.   ```  [Comment 12](show_bug.cgi?id=1051421#c12)  Thomas Moschny    2014-01-14 12:43:34 UTC  ``` (In reply to Vincent Danen from [comment #11](show_bug.cgi?id=1051421#c11)) > The only thing I can't tell by quickly looking is whether this cache > directory needs to persist across invocations.  For instance, if it's > supposed to survive from one run to the next then mkstemp is probably not > the most appropriate way to go unless the location can be written to a > config file for subsequent lookups.  Yes, the cache location needs to be persistent across invocations. Bugging upstream.   ```  [Comment 13](show_bug.cgi?id=1051421#c13)  Bohuslav "Slavek" Kabrda    2014-01-15 08:11:07 UTC  ``` (In reply to Thomas Moschny from [comment #12](show_bug.cgi?id=1051421#c12)) > (In reply to Vincent Danen from [comment #11](show_bug.cgi?id=1051421#c11)) > > The only thing I can't tell by quickly looking is whether this cache > > directory needs to persist across invocations.  For instance, if it's > > supposed to survive from one run to the next then mkstemp is probably not > > the most appropriate way to go unless the location can be written to a > > config file for subsequent lookups. >  > Yes, the cache location needs to be persistent across invocations. Bugging > upstream.  But that means that the directory name has to predictable in some way, doesn't it? So the real question is, how can you make a temporary file that's both safe and its location is computable across interpreter invocations.   ```  [Comment 14](show_bug.cgi?id=1051421#c14)  Vincent Danen    2014-01-17 18:14:15 UTC  ``` There's a few things, and it's tough to do this correctly.  The problem, as I gather it, is you can have more than one user run this which is why they were using directories based on the uid.  What would be ideal here, I think, is to have /var/run/jinja2/ created by the package and that would be the root directory (as opposed to /tmp).  Within this directory can be user-based sub-directorys (/var/run/jinja2/user or /var/run/jinga2/uid) and the code would look to a) see if it exists (if not, create with 0700 perms), and b) see if it is owned by the appropriate user (if not, complain really really loudly).  That's still not perfect, and there might still be a race condition there, but I don't think os.mkdir() will complete successfully if the named path exists as a directory or file, so should be ok).  So perhaps something like:  path = '/var/run/jinja2/%s' % os.getuid() try:     os.mkdir(path, 0700) except Exception as e:     raise e  if os.stat(path).st_uid is not os.getuid():     # error and exit  if oct(os.stat(path).st_mode & 0777) is not '0700':     # error and exit  That should work I think.  The other alternative is to again use /var/run/jinja2/ but use temp.mkstemp() to create a directory in there, but only if a config file or setting doesn't exist.  For instance, we have something like ~/.jinja2 or ~/.jinja2/config or whatever that has the setting:  path = /var/run/jina2/532/tmp123456  and then the module looks here first as the cache location (probably performing the same tests as above... "is it owned by me?" and "is it mode 0700?" before doing anything with it).  If such a config file/setting doesn't exist, create the file with temp.mkstemp() and write it to the config/setting for subsequent use.  If the noted file doesn't exist (or isn't usable due to failing any tests), create a new one with temp.mkstemp() and save the new path to the config file.  Those seem to to be the two best options to me.   ```  [Comment 15](show_bug.cgi?id=1051421#c15)  Bohuslav "Slavek" Kabrda    2014-01-20 08:12:29 UTC  ``` (In reply to Vincent Danen from [comment #14](show_bug.cgi?id=1051421#c14)) > There's a few things, and it's tough to do this correctly.  The problem, as > I gather it, is you can have more than one user run this which is why they > were using directories based on the uid. >  > What would be ideal here, I think, is to have /var/run/jinja2/ created by > the package and that would be the root directory (as opposed to /tmp).  > Within this directory can be user-based sub-directorys (/var/run/jinja2/user > or /var/run/jinga2/uid) and the code would look to a) see if it exists (if > not, create with 0700 perms), and b) see if it is owned by the appropriate > user (if not, complain really really loudly).  So how is this different from doing the same in /tmp? I don't see why you'd need to move to /var/run/jinja2. Based on what you're saying, I guess the upstream patch is OK, but it needs the two checks you mention:  > if os.stat(path).st_uid is not os.getuid(): >     # error and exit >  > if oct(os.stat(path).st_mode & 0777) is not '0700': >     # error and exit  Or is there some problem doing this in /tmp that I don't see? Thanks.   ```  [Comment 17](show_bug.cgi?id=1051421#c17)  Vincent Danen    2014-01-24 00:09:01 UTC  ``` Persistence.  If the idea is to have the cache persist across invocations of jinja2, then I assume it might be desirable to have it persist across reboots as well.  As many systems clean /tmp on reboot, that would remove the cache as well.  In /var/run/jinja2/ there are no such problems.  I also believe that cache files are not temporary files, necessarily, so I don't know if /tmp is the most appropriate.  Functionally it's the same thing, you're right.  The biggest thing for me is persistence.   ```  [Comment 18](show_bug.cgi?id=1051421#c18)  Tomas Hoger    2014-01-24 20:54:13 UTC  ``` (In reply to Vincent Danen from [comment #17](show_bug.cgi?id=1051421#c17)) > Persistence.  If the idea is to have the cache persist across invocations of > jinja2, then I assume it might be desirable to have it persist across > reboots as well. >  > As many systems clean /tmp on reboot, that would remove the cache as well.  > In /var/run/jinja2/ there are no such problems.  Given that it's only cache meant to provide speed improvement, persistence across reboots may not be that important.  On the other hand, /var/run/jinja2/ would imply new unexpected world-writable directory for administrators to deal with.  There's a workaround to achieve better persistence by setting TMPDIR to point to a directory that isn't wiped on reboot.  I'd leave improving persistence out of scope of this security fix.  The same persistence issues existed before.   ```  [Comment 19](show_bug.cgi?id=1051421#c19)  Tomas Hoger    2014-01-27 15:31:37 UTC  ``` (In reply to Vincent Danen from [comment #14](show_bug.cgi?id=1051421#c14)) > path = '/var/run/jinja2/%s' % os.getuid() > try: >     os.mkdir(path, 0700) > except Exception as e: >     raise e  This either needs a check for existence before mkdir (as you mentioned), or handle EEXIST error differently.  > if os.stat(path).st_uid is not os.getuid(): >     # error and exit >  > if oct(os.stat(path).st_mode & 0777) is not '0700': >     # error and exit  os.lstat needs to be used instead of os.stat to avoid symlink + race issues.  Hence something like:  try:     os.mkdir(path, 0700) except OSError as e:     if e.errno != errno.EEXIST:         raise      path_stat = os.lstat(path) if path_stat.st_uid != os.geteuid() \     or not stat.S_ISDIR(path_stat.st_mode) \     or (os.stat(path).st_mode & 0777) != 0700:     # raise some "bad permissions" exception  Possibly with all stat checks within except.   ```  [Comment 20](show_bug.cgi?id=1051421#c20)  Tomas Hoger    2014-01-27 15:51:11 UTC  ``` (In reply to Vincent Danen from [comment #9](show_bug.cgi?id=1051421#c9)) > Note that Arun Babu Neelicattu reported [1] that the fix above introduced a > new flaw (temporary file handling) which was assigned the CVE name > [CVE-2014-0012](https://access.redhat.com/security/cve/CVE-2014-0012).  The original issue falls into the "insecure temporary file use" category as well.  Both in terms of allowing file overwrite, and making jinja use a cache file from attacker.  Upstream fix changes situation a little - attacker needs to be able to create /tmp/_jinja2-cache-$UID directory before victim, but if they succeed in doing so, they can unlink cache files created by victim at any time.  There is a separate bug for [CVE-2014-0012](https://access.redhat.com/security/cve/CVE-2014-0012) - [bug 1052102](show_bug.cgi?id=1052102 "CLOSED NOTABUG - CVE-2014-0012 python-jinja2: FileSystemBytecodeCache insecure cache temporary file use, incorrect CVE-2014-1402 fix") - albeit all the real discussion happens here.   ```  [Comment 21](show_bug.cgi?id=1051421#c21)  Bohuslav "Slavek" Kabrda    2014-01-27 16:05:41 UTC  ``` Created [attachment 856133](attachment.cgi?id=856133&action=diff "Fix for CVE-2014-0012") [[details]](attachment.cgi?id=856133&action=edit "Fix for CVE-2014-0012") Fix for [CVE-2014-0012](https://access.redhat.com/security/cve/CVE-2014-0012)  (In reply to Tomas Hoger from [comment #18](show_bug.cgi?id=1051421#c18)) > (In reply to Vincent Danen from [comment #17](show_bug.cgi?id=1051421#c17)) > > Persistence.  If the idea is to have the cache persist across invocations of > > jinja2, then I assume it might be desirable to have it persist across > > reboots as well. > >  > > As many systems clean /tmp on reboot, that would remove the cache as well.  > > In /var/run/jinja2/ there are no such problems. >  > Given that it's only cache meant to provide speed improvement, persistence > across reboots may not be that important.  On the other hand, > /var/run/jinja2/ would imply new unexpected world-writable directory for > administrators to deal with.  There's a workaround to achieve better > persistence by setting TMPDIR to point to a directory that isn't wiped on > reboot.  I'd leave improving persistence out of scope of this security fix.  > The same persistence issues existed before.  Agreed. I'm attaching a patch that should fix the security problem - it checks for both dir ownership and proper permissions. Tomas, Vincent, can anyone of you review the patch and confirm it's ok before I commit it to RHEL and submit upstream? Thanks!   ```  [Comment 22](show_bug.cgi?id=1051421#c22)  Bohuslav "Slavek" Kabrda    2014-01-27 16:09:00 UTC  ``` Whoops, I accidentally assigned this to myself. Sorry, resetting.   ```  [Comment 23](show_bug.cgi?id=1051421#c23)  Tomas Hoger    2014-01-27 16:42:52 UTC  ``` (In reply to Bohuslav "Slavek" Kabrda from [comment #21](show_bug.cgi?id=1051421#c21)) > Agreed. I'm attaching a patch that should fix the security problem - it > checks for both dir ownership and proper permissions. > Tomas, Vincent, can anyone of you review the patch and confirm it's ok > before I commit it to RHEL and submit upstream? Thanks!  - Use os.lstat, not os.stat.  os.stat follows symlinks, so attacker can create link that points to some victim's directory with proper permission at the time of the check, and later replace with real directory, or symlink to an attacker's directory.  - Consider checking if path actually is directory.  (See [comment 19](show_bug.cgi?id=1051421#c19) for the both of the above comments.)  - Nitpick: use 0700 instead of 448.  448 is less obvious, are there significant benefits over 0700 to actually use it?  (I know upstream uses 448 elsewhere, so why not fix both while at it? :)  - A concern with the $UID directories is that it possibly makes it somewhat easier to "DoS" other local user by making Jinja2 raise exception because of cache file permissions.  But the problem is not new, older Jinja2 versions could raise exception too if they found cache files they could not use.   ```  [Comment 24](show_bug.cgi?id=1051421#c24)  jwilk    2014-01-27 18:56:50 UTC  ``` Jinja2 (>= 2.7) supports Python 2 and Python 3 with single codebase (no 2to3 involved). So upstream can't use 0700, because that's syntax error in Python 3. They could use 0o700 (which is syntactically valid since Python 2.6) or stat.S_IRWXU.   ```  [Comment 25](show_bug.cgi?id=1051421#c25)  Tomas Hoger    2014-01-27 19:48:39 UTC  ``` Ok, thank you for the clarification!   ```  [Comment 27](show_bug.cgi?id=1051421#c27)  Bohuslav "Slavek" Kabrda    2014-01-28 09:35:15 UTC  ``` (In reply to Tomas Hoger from [comment #23](show_bug.cgi?id=1051421#c23)) > (In reply to Bohuslav "Slavek" Kabrda from [comment #21](show_bug.cgi?id=1051421#c21)) > > Agreed. I'm attaching a patch that should fix the security problem - it > > checks for both dir ownership and proper permissions. > > Tomas, Vincent, can anyone of you review the patch and confirm it's ok > > before I commit it to RHEL and submit upstream? Thanks! >  > - Use os.lstat, not os.stat.  os.stat follows symlinks, so attacker can > create link that points to some victim's directory with proper permission at > the time of the check, and later replace with real directory, or symlink to > an attacker's directory.  Ok, will do.  > - Consider checking if path actually is directory.  I don't understand why that'd be needed. If the path is not a directory then there are two possibilities: - It's owned by the user that jinja2 is running under - then Python will just fail when trying to create a file in this directory (which is actually not a directory). - It's owned by another user - the check for owner will rise exception before any attempt to create a cached file. What do we gain by checking that the path is directory?   > - Nitpick: use 0700 instead of 448.  448 is less obvious, are there > significant benefits over 0700 to actually use it?  (I know upstream uses > 448 elsewhere, so why not fix both while at it? :)  Because I want to have a patch acceptable for upstream. If upstream is keen on using 448, then that's what I want to do to keep consistent and to have an acceptable patch (also it's better because of the reason mentioned in [comment #24](show_bug.cgi?id=1051421#c24) by Jakub Wilk).  > - A concern with the $UID directories is that it possibly makes it somewhat > easier to "DoS" other local user by making Jinja2 raise exception because of > cache file permissions.  But the problem is not new, older Jinja2 versions > could raise exception too if they found cache files they could not use.  Yes, the problem is old and I don't think that fixing it is in the scope of this bug.   So to sum up, I think that the only alteration needed for my patch is using "lstat" instead of "stat". Is that correct? Thanks a lot!   ```  [Comment 28](show_bug.cgi?id=1051421#c28)  Tomas Hoger    2014-01-28 10:28:00 UTC  ``` (In reply to Bohuslav "Slavek" Kabrda from [comment #27](show_bug.cgi?id=1051421#c27)) > > - Consider checking if path actually is directory. >  > I don't understand why that'd be needed. If the path is not a directory then > there are two possibilities: > - It's owned by the user that jinja2 is running under - then Python will > just fail when trying to create a file in this directory (which is actually > not a directory). > - It's owned by another user - the check for owner will rise exception > before any attempt to create a cached file. > What do we gain by checking that the path is directory?  I have no specific significant concern in mind.  The check can lead to better error report.  There should be no negative impact, if re-stat is avoided.   ```  [Comment 29](show_bug.cgi?id=1051421#c29)  Bohuslav "Slavek" Kabrda    2014-01-28 10:39:13 UTC  ``` Created [attachment 856466](attachment.cgi?id=856466&action=diff "Fix for CVE-2014-0012 that uses lstat instead of stat") [[details]](attachment.cgi?id=856466&action=edit "Fix for CVE-2014-0012 that uses lstat instead of stat") Fix for [CVE-2014-0012](https://access.redhat.com/security/cve/CVE-2014-0012) that uses lstat instead of stat  Ok, so I hope that [attached] is the final and correct patch for the CVE. I just replaced os.stat with os.lstat, no other change since the last patch.   ```  [Comment 30](show_bug.cgi?id=1051421#c30)  jwilk    2014-01-28 13:10:46 UTC  ``` The "is it a directory?" check is important, because we don't want to follow symlinks. Just because such a symlink is owned by the correct user, doesn't mean it was created by this user: it could have been hardlinked by an attacker.  Now, on Linux systems we are safe, because symlinks have always 0777 permissions, so they never pass the st_mode check. But it's not neccessarily the case on other systems.   ```  [Comment 31](show_bug.cgi?id=1051421#c31)  Tomas Hoger    2014-01-29 11:47:19 UTC  ``` Slavek, are you working on submitting pull request upstream?   ```  [Comment 32](show_bug.cgi?id=1051421#c32)  Tomas Hoger    2014-02-20 20:34:21 UTC  ``` I did a pull request with a fix that adds ownership, permission and type check for the temporary directory:  <https://github.com/mitsuhiko/jinja2/pull/296>   ```  [Comment 33](show_bug.cgi?id=1051421#c33)  Tomas Hoger    2014-04-02 09:08:19 UTC  ``` There's still no upstream feedback on additional fixes required to fix this issue, and no upstream commits since early Jan.  It seems we should proceed with our own fix without upstream.   ```  [Comment 34](show_bug.cgi?id=1051421#c34)  Tomas Hoger    2014-05-29 18:51:27 UTC  ``` Still no real activity upstream.   ```  [Comment 38](show_bug.cgi?id=1051421#c38)  Tomas Hoger    2014-06-06 21:55:35 UTC  ``` (In reply to Tomas Hoger from [comment #32](show_bug.cgi?id=1051421#c32)) > I did a pull request with a fix that adds ownership, permission and type > check for the temporary directory: >  > <https://github.com/mitsuhiko/jinja2/pull/296>  Applied upstream:  <https://github.com/mitsuhiko/jinja2/commit/964c61ce79f6748ff8c583e2eb12ec54082bf188>  Fixed in version 2.7.3.   ```  [Comment 39](show_bug.cgi?id=1051421#c39)  Thomas Moschny    2014-06-07 09:02:39 UTC  ``` I've updated rawhide to 2.7.3, and a build for F20 is underway.  We need to port the final patch to 2.6 (for F19 and RHEL7) and to 2.2.1 (for EPEL5 and RHEL6). Is someone from RH already working on this?   ```  [Comment 41](show_bug.cgi?id=1051421#c41)  errata-xmlrpc    2014-06-11 17:13:42 UTC  ``` This issue has been addressed in following products:    Red Hat Software Collections 1 for Red Hat Enterprise Linux 6   Red Hat Software Collections 1 for Red Hat Enterprise Linux 6.3 EUS   Red Hat Software Collections 1 for Red Hat Enterprise Linux 6.4 EUS   Red Hat Software Collections 1 for Red Hat Enterprise Linux 7  Via RHSA-2014:0748 <https://rhn.redhat.com/errata/RHSA-2014-0748.html>   ```  [Comment 42](show_bug.cgi?id=1051421#c42)  errata-xmlrpc    2014-06-11 17:14:30 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 6  Via RHSA-2014:0747 <https://rhn.redhat.com/errata/RHSA-2014-0747.html>   ```  [Comment 43](show_bug.cgi?id=1051421#c43)  Thomas Moschny    2014-06-12 19:26:16 UTC  ``` I guess it's ok for me to take the patches from these packages mentioned in [comment 41](show_bug.cgi?id=1051421#c41) and [comment 42](show_bug.cgi?id=1051421#c42) and apply them to the F19 and EPEL5 packages, respectively?   ```  [Comment 44](show_bug.cgi?id=1051421#c44)  Tomas Hoger    2014-06-12 19:41:57 UTC  ``` Right, they are backports of upstream fix, feel free to use.   ```  [Comment 45](show_bug.cgi?id=1051421#c45)  Thomas Moschny    2014-06-14 01:13:20 UTC  ``` There's no tracking bug for python-jinja2-26, I've used [bug 1051425](show_bug.cgi?id=1051425 "CLOSED ERRATA - python-jinja2: arbitrary code execution vulnerability [epel-all]") for that.   ```  [Comment 46](show_bug.cgi?id=1051421#c46)  Fedora Update System    2014-06-22 23:56:23 UTC  ``` python-jinja2-2.6-7.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 47](show_bug.cgi?id=1051421#c47)  Fedora Update System    2014-06-22 23:57:30 UTC  ``` python-jinja2-2.7.3-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 49](show_bug.cgi?id=1051421#c49)  Fedora Update System    2014-06-30 03:37:53 UTC  ``` python26-jinja2-2.5.5-5.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 50](show_bug.cgi?id=1051421#c50)  Fedora Update System    2014-06-30 03:38:21 UTC  ``` python-jinja2-26-2.6-3.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 51](show_bug.cgi?id=1051421#c51)  Fedora Update System    2014-06-30 03:38:41 UTC  ``` python-jinja2-2.2.1-2.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1051421&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from github.com_624a5dd1_20250126_050332.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F296)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F296)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=pallets%2Fjinja)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pallets](/pallets)
/
**[jinja](/pallets/jinja)**
Public

* [Notifications](/login?return_to=%2Fpallets%2Fjinja) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fpallets%2Fjinja)
* [Star
   10.5k](/login?return_to=%2Fpallets%2Fjinja)

* [Code](/pallets/jinja)
* [Issues
  62](/pallets/jinja/issues)
* [Pull requests
  16](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

Additional navigation options

* [Code](/pallets/jinja)
* [Issues](/pallets/jinja/issues)
* [Pull requests](/pallets/jinja/pulls)
* [Discussions](/pallets/jinja/discussions)
* [Actions](/pallets/jinja/actions)
* [Security](/pallets/jinja/security)
* [Insights](/pallets/jinja/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpallets%2Fjinja%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpallets%2Fjinja%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix for CVE-2014-0012 #296

 Closed

[thoger](/thoger)
wants to merge
1
commit into
[pallets:master](/pallets/jinja/tree/master "pallets/jinja:master")
from
thoger:CVE-2014-0012

 Closed

# [Fix for CVE-2014-0012](#top) #296

[thoger](/thoger)
wants to merge
1
commit into
[pallets:master](/pallets/jinja/tree/master "pallets/jinja:master")
from
thoger:CVE-2014-0012

[Conversation
3](/pallets/jinja/pull/296)
[Commits
1](/pallets/jinja/pull/296/commits)
[Checks
0](/pallets/jinja/pull/296/checks)
[Files changed](/pallets/jinja/pull/296/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![thoger](https://avatars.githubusercontent.com/u/4051912?s=60&v=4)](/thoger)

Copy link

Contributor

### @thoger **[thoger](/thoger)** commented [Feb 9, 2014](#issue-27227270)

Commit [acb672b](https://github.com/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7) attempted to fix insecure temporary file use in FileSystemBytecodeCache by introducing per-user temporary directory. However, if directory already exists, it is used without checking its ownership and permissions. Local attacker able to create temporary directory with victim's uid before victim does so can achieve the same impact as with the original issue.

This attempts to address the issue by introducing ownership, permission and type check and makes jinja2 raise an exception if existing directory has unexpected attributes.

Further discussion can be found in:

<https://bugzilla.redhat.com/show_bug.cgi?id=1051421>

Sorry, something went wrong.

All reactions

[![@thoger-rh](https://avatars.githubusercontent.com/u/163308325?s=40&v=4)](/thoger-rh)

`[Fix](/pallets/jinja/pull/296/commits/4fe07b76b8c53d935963fb92394b4c71ea9d4c91 "Fix CVE-2014-0012

Add checks for the per-user temporary directory.  If it already exists, make
sure that it:
- is owned by the current user
- is directory
- has expected permissions

This commit also fixes:
- nt -> n typo pointed out in the review of acb672b
- replace 448 with stat.S_IRWXU when setting directory mode") [CVE-2014-0012](https://github.com/advisories/GHSA-fqh9-2qgg-h84h "CVE-2014-0012")`
 …

`[4fe07b7](/pallets/jinja/pull/296/commits/4fe07b76b8c53d935963fb92394b4c71ea9d4c91)`

```
Add checks for the per-user temporary directory.  If it already exists, make
sure that it:
- is owned by the current user
- is directory
- has expected permissions

This commit also fixes:
- nt -> n typo pointed out in the review of [acb672b](https://github.com/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)
- replace 448 with stat.S_IRWXU when setting directory mode
```

[thoger](/thoger)
referenced
this pull request
[Feb 9, 2014](#ref-commit-acb672b)
[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)

`[Fixed a security issue with temporary files on the filesystem cache o…](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7 "Fixed a security issue with temporary files on the filesystem cache on UNIX.")`
…

`[acb672b](/pallets/jinja/commit/acb672b6a179567632e032f547582f30fa2f4aa7)`

```
…n UNIX.
```

[mitsuhiko](/mitsuhiko)
added a commit
that referenced
this pull request
[Jun 6, 2014](#ref-commit-377b9b5)
[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)

`[Applied changes from](/pallets/jinja/commit/377b9b55f3866fd8b1e4a941639f2af430c8285d "Applied changes from #296 for better checking.") [#296](https://github.com/pallets/jinja/pull/296) [for better checking.](/pallets/jinja/commit/377b9b55f3866fd8b1e4a941639f2af430c8285d "Applied changes from #296 for better checking.")`

`[377b9b5](/pallets/jinja/commit/377b9b55f3866fd8b1e4a941639f2af430c8285d)`

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=80&v=4)](/mitsuhiko)

Copy link

Contributor

### **[mitsuhiko](/mitsuhiko)** commented [Jun 6, 2014](#issuecomment-45358384)

| Fixed. |
| --- |

All reactions

Sorry, something went wrong.

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=40&v=4)](/mitsuhiko)
[mitsuhiko](/mitsuhiko)
closed this
[Jun 6, 2014](#event-128877407)

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=80&v=4)](/mitsuhiko)

Copy link

Contributor

### **[mitsuhiko](/mitsuhiko)** commented [Jun 6, 2014](#issuecomment-45359215)

| Sorry for the lack of feedback on this. I completely lost track of this issue and I did not subscribe to the red hat ticket so i failed to see the continued discussion. |
| --- |

All reactions

Sorry, something went wrong.

[![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=80&v=4)](/mitsuhiko)

Copy link

Contributor

### **[mitsuhiko](/mitsuhiko)** commented [Jun 6, 2014](#issuecomment-45359233)

| 2.7.3 has just this fix in now. |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
locked as **resolved** and limited conversation to collaborators
[Nov 13, 2020](#event-3995394283)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpallets%2Fjinja%2Fpull%2F296).

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@thoger](https://avatars.githubusercontent.com/u/4051912?s=52&v=4)](/thoger) [![@mitsuhiko](https://avatars.githubusercontent.com/u/7396?s=52&v=4)](/mitsuhiko) [![@thoger-rh](https://avatars.githubusercontent.com/u/163308325?s=52&v=4)](/thoger-rh)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


