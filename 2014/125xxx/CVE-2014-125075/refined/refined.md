The provided content is a commit diff from a GitHub repository, which shows changes made to the code. This commit addresses SQL injection vulnerabilities and adds input validation.

Here's a breakdown of the changes relevant to security:

**Root Cause of Vulnerability:**

*   The original code used string concatenation to build SQL queries, making it vulnerable to SQL injection. User-provided data (forename, surname, contact email) was directly inserted into the query without proper sanitization or escaping.

**Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The primary vulnerability was the use of string concatenation to build SQL queries in the `Model.java` file's `search` and `addContact` methods. This allowed attackers to inject arbitrary SQL code by manipulating the input fields for first name, last name, and email, potentially gaining unauthorized access to or modifying the database.

**Impact of Exploitation:**

*   **Data Breach:** An attacker could extract sensitive data from the database.
*   **Data Manipulation:** Malicious users could modify, delete, or add data to the database.
*   **Privilege Escalation:** In some situations, SQL injection can be used to elevate privileges, gaining access to system commands, depending on the privileges of the database user.

**Attack Vectors:**

*   **User Input:** Attackers would exploit the vulnerability by injecting malicious SQL code into the input fields on the web pages, such as `addcontact.jsp`, when adding or searching for contacts.

**Required Attacker Capabilities/Position:**

*   **Web Access:** The attacker needs access to the web application to interact with the vulnerable forms.
*   **Understanding of SQL:** Knowledge of SQL is needed to craft the malicious injection payloads.

**Changes Made to Mitigate the Vulnerability:**

*   **Prepared Statements:** The vulnerable code in the `Model.java` file is modified to use `PreparedStatement` instead of string concatenation for building SQL queries, which prevents SQL injection. Placeholders (`?`) are used in the SQL query and user input is provided as parameters to the prepared statement.

**File Changes:**

*   `src/Model.java`: This file had the most significant changes. The `search` and `addContact` methods are modified to use `PreparedStatement`, which fixes the SQL injection vulnerability.
*   `src/AddContact.java`, `src/Error.java`, `src/Login.java`, `src/SearchContact.java`: These files have minor changes related to request attributes.
*  `web/addcontact.jsp` and `web/contact.jsp`: Minor change to add required to input fields.

The commit message "Added validation for contact adding and changed use of prepared statements to avoid SQL injection" is consistent with the changes made, as the code now uses prepared statements.