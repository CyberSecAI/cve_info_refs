The provided content is a commit diff from the WordPress Portfolio Gallery plugin, which addresses a SQL injection vulnerability.

**Root cause of vulnerability:**
- The code was vulnerable to SQL injection due to unsanitized user input being directly used in SQL queries. Specifically, the `$_POST['search_events_by_title']` variable was used in a `LIKE` clause without proper sanitization.

**Weaknesses/vulnerabilities present:**
- SQL Injection: The main vulnerability was the direct concatenation of the user-provided search term into the SQL query without proper escaping.
- Multiple vulnerable instances: It appears that the `$search_tag` variable, derived from user input, is used in several queries without sanitization.

**Impact of exploitation:**
-  An attacker could craft a malicious SQL query through the `search_events_by_title` parameter to perform unauthorized database operations including data exfiltration, modification, or even deletion of data.

**Attack vectors:**
- The primary attack vector is through the `search_events_by_title` POST parameter in the WordPress admin panel when managing portfolios.

**Required attacker capabilities/position:**
- The attacker needs to have access to the WordPress admin panel, with the capability to manage portfolios. This means they need to be an authenticated user with the necessary privileges to access the plugin functionality.

**Technical Details:**

The commit diff shows changes where the following sanitization functions have been applied to the user supplied data:
- `esc_html(stripslashes($_POST['search_events_by_title']))`: This sanitizes the search input.
- `$wpdb->prepare()` is used to properly escape user input in the SQL queries. This prevents SQL injection by ensuring user-supplied values are treated as data and not as part of the SQL query itself.
- The SQL query construction has been modified from direct string concatenation to using `prepare` with placeholders, which is the correct method of preventing SQL injection.