=== Content from bugs.mageia.org_d0d3aca4_20250126_083428.html ===


Mageia Bugzilla ‚Äì Bug¬†13653
dbus new security issues CVE-2014-3532 and CVE-2014-3533
Last modified: 2014-07-26 13:49:35 CEST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=13653&GoAheadAndLogIn=1)

  [x]
* |
  [New¬†Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug¬†13653**](show_bug.cgi?id=13653)
- dbus new security issues CVE-2014-3532 and CVE-2014-3533

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
dbus new security issues CVE-2014-3532 and CVE-2014-3533

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): major | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sec team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/604236/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | MGA3TOO has\_procedure advisory mga4-6... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | validated\_update | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-07-02 18:16 CEST by David Walser | | --- | --- | | Modified: | 2014-07-26 13:49 CEST ([History](show_activity.cgi?id=13653)) | | CC List: | 6 users (show)  fundawang geiger.david68210 mageia simonnzg sysadmin-bugs tmb | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | dbus-1.6.20-1.mga5.src.rpm | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=13653&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=13653#c0)  David Walser    2014-07-02 18:16:52 CEST  ``` Two security issues in dbus were announced today (July 2): <http://openwall.com/lists/oss-security/2014/07/02/4>  The issues are fixed in 1.6.22.  Patches and details are in the message above.  Mageia 3 and Mageia 4 are also affected.  Reproducible:   Steps to Reproduce: ```  David Walser    2014-07-02 18:17:18 CEST   CC: (none) => fundawang, mageia, tmbWhiteboard: (none) => MGA4TOO, MGA3TOO  [Comment 1](show_bug.cgi?id=13653#c1)  David Walser    2014-07-03 16:36:57 CEST  ``` Debian has issued an advisory for this on July 2: <https://www.debian.org/security/2014/dsa-2971> ```  ---   URL: (none) => http://lwn.net/Vulnerabilities/604236/  [Comment 2](show_bug.cgi?id=13653#c2)  David Walser    2014-07-09 01:38:50 CEST  ``` Updated package uploaded for Cauldron.  Patched packages uploaded for Mageia 3 and Mageia 4.  Advisory: ========================  Updated dbus packages fix security vulnerabilities:  A flaw was reported in D-Bus's file descriptor passing feature. A local attacker could use this flaw to cause a service or application to disconnect from the bus, typically resulting in that service or application exiting (CVE-2014-3532).  A flaw was reported in D-Bus's file descriptor passing feature. A local attacker could use this flaw to cause an invalid file descriptor to be forwarded to a service or application, causing it to disconnect from the bus, typically resulting in that service or application exiting (CVE-2014-3533).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3532> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3533> <http://lists.freedesktop.org/archives/dbus/2014-July/016235.html> <https://lists.fedoraproject.org/pipermail/package-announce/2014-July/135226.html> ========================  Updated packages in core/updates_testing: ======================== dbus-1.6.8-4.4.mga3 libdbus1_3-1.6.8-4.4.mga3 libdbus-devel-1.6.8-4.4.mga3 dbus-x11-1.6.8-4.4.mga3 dbus-doc-1.6.8-4.4.mga3 dbus-1.6.18-1.3.mga4 libdbus1_3-1.6.18-1.3.mga4 libdbus-devel-1.6.18-1.3.mga4 dbus-x11-1.6.18-1.3.mga4 dbus-doc-1.6.18-1.3.mga4  from SRPMS: dbus-1.6.8-4.4.mga3.src.rpm dbus-1.6.18-1.3.mga4.src.rpm ```  ---   Version: Cauldron => 4Whiteboard: MGA4TOO, MGA3TOO => MGA3TOOSeverity: normal => major  [Comment 3](show_bug.cgi?id=13653#c3)  David Walser    2014-07-09 01:40:16 CEST  ``` Oops, forgot to assign to QA.  Updated package uploaded for Cauldron.  Patched packages uploaded for Mageia 3 and Mageia 4.  Advisory: ========================  Updated dbus packages fix security vulnerabilities:  A flaw was reported in D-Bus's file descriptor passing feature. A local attacker could use this flaw to cause a service or application to disconnect from the bus, typically resulting in that service or application exiting (CVE-2014-3532).  A flaw was reported in D-Bus's file descriptor passing feature. A local attacker could use this flaw to cause an invalid file descriptor to be forwarded to a service or application, causing it to disconnect from the bus, typically resulting in that service or application exiting (CVE-2014-3533).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3532> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3533> <http://lists.freedesktop.org/archives/dbus/2014-July/016235.html> <https://lists.fedoraproject.org/pipermail/package-announce/2014-July/135226.html> ========================  Updated packages in core/updates_testing: ======================== dbus-1.6.8-4.4.mga3 libdbus1_3-1.6.8-4.4.mga3 libdbus-devel-1.6.8-4.4.mga3 dbus-x11-1.6.8-4.4.mga3 dbus-doc-1.6.8-4.4.mga3 dbus-1.6.18-1.3.mga4 libdbus1_3-1.6.18-1.3.mga4 libdbus-devel-1.6.18-1.3.mga4 dbus-x11-1.6.18-1.3.mga4 dbus-doc-1.6.18-1.3.mga4  from SRPMS: dbus-1.6.8-4.4.mga3.src.rpm dbus-1.6.18-1.3.mga4.src.rpm ```  ---   Assignee: bugsquad => qa-bugs  [Comment 4](show_bug.cgi?id=13653#c4)  claire robinson    2014-07-09 15:06:41 CEST  ``` Testing mga4 64  No PoC's that I can find, embargoed still on rhbz it seems. Just ensuring that everything is normal after a reboot, all services started etc. ```  [Comment 5](show_bug.cgi?id=13653#c5)  claire robinson    2014-07-09 16:50:31 CEST  ``` Testing complete mga4 64.  # systemctl status dbus.service  dbus.service - D-Bus System Message Bus    Loaded: loaded (/usr/lib/systemd/system/dbus.service; static)    Active: active (running) since Wed 2014-07-09 14:08:17 BST; 1h 40min ago   No regressions noticed in use. ```  ---   Whiteboard: MGA3TOO => MGA3TOO has\_procedure mga4-64-ok  [Comment 6](show_bug.cgi?id=13653#c6)  Simon Parsons    2014-07-10 15:07:48 CEST  ``` Testing MGA4x64 No obvious problems. ```  ---   CC: (none) => gm4nzg  [Comment 7](show_bug.cgi?id=13653#c7)  David GEIGER    2014-07-10 15:43:45 CEST  ``` Tested mag4_32,  Testing complete for the new dbus-1.6.8-1.3.mga4 update, Ok for me and all services seems to work properly.  $ systemctl status dbus.service dbus.service - D-Bus System Message Bus    Loaded: loaded (/usr/lib/systemd/system/dbus.service; static)    Active: active (running) since jeu. 2014-07-10 15:08:55 CEST; 33min ago  Main PID: 751 (dbus-daemon)    CGroup: /system.slice/dbus.service            √¢√¢751 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile ...   No regressions found. ```  ---   CC: (none) => geiger.david68210  [Comment 8](show_bug.cgi?id=13653#c8)  David GEIGER    2014-07-10 15:47:00 CEST  ``` Tested mag3_32 & mga3_64,  Testing complete for the new dbus-1.6.8-4.4.mga3 update, Ok for me and all services seems to work properly.  $ systemctl status dbus.service dbus.service - D-Bus System Message Bus           Loaded: loaded (/usr/lib/systemd/system/dbus.service; static)           Active: active (running) since Thu, 2014-07-10 15:17:42 CEST; 26min ago         Main PID: 1159 (dbus-daemon)           CGroup: name=systemd:/system/dbus.service                   √¢ 1159 /usr/bin/dbus-daemon --system --address=systemd: -...                   √¢ 6378 /usr/libexec/packagekitd  No regressions found here too. ```  [Comment 9](show_bug.cgi?id=13653#c9)  David Walser    2014-07-10 15:49:07 CEST  ``` I added the OK tags per David's tests.  If dbus is broken it'd be fairly obvious, so this testing should suffice.  This can be validated. ```  ---   Whiteboard: MGA3TOO has\_procedure mga4-64-ok => MGA3TOO has\_procedure mga4-64-ok mga4-32-ok mga3-64-ok mga3-32-ok  [Comment 10](show_bug.cgi?id=13653#c10)  claire robinson    2014-07-10 17:15:41 CEST  ``` Validating. Advisory uploaded.  Could sysadmin please push to 3 & 4 updates  Thanks ```  ---   Keywords: (none) => validated\_updateWhiteboard: MGA3TOO has\_procedure mga4-64-ok mga4-32-ok mga3-64-ok mga3-32-ok => MGA3TOO has\_procedure advisory mga4-64-ok mga4-32-ok mga3-64-ok mga3-32-okCC: (none) => sysadmin-bugs  [Comment 11](show_bug.cgi?id=13653#c11)  Colin Guthrie    2014-07-26 13:49:35 CEST  ``` Update pushed.  <http://advisories.mageia.org/MGASA-2014-0294.html> ```  ---   Status: NEW => RESOLVEDResolution: (none) => FIXED |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=13653&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=13653)
* -¬†[XML](show_bug.cgi?ctype=xml&id=13653)
* -¬†[Clone ThisBug](enter_bug.cgi?cloned_bug_id=13653&normal=1)
* -¬†Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=13653&GoAheadAndLogIn=1)

    [x]
  + |
    [New¬†Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)



=== Content from bugs.freedesktop.org_5ec9f28c_20250125_123652.html ===


Bugzilla ‚Äì Bug¬†79694
Misbehaviour reading a message with passing file descriptors (duplicate/missing fds)
Last modified: 2014-07-02 16:06:16 UTC

* [Home](./)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

[**Bug¬†79694**](show_bug.cgi?id=79694)
- Misbehaviour reading a message with passing file descriptors (duplicate/missing fds)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Misbehaviour reading a message with passing file descriptors (duplicate/missi...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | dbus | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=dbus "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | core ([show other bugs](buglist.cgi?component=core&product=dbus&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux (All) | |  | | | [Importance](page.cgi?id=fields.html#importance): | medium normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Simon McVittie | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | review+ | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | patch | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-06-05 17:47 UTC by Alejandro Mart√≠nez Su√°rez | | --- | --- | | Modified: | 2014-07-02 16:06 UTC ([History](show_activity.cgi?id=79694)) | | CC List: | 5 users (show)  alban.crequy lennart smcv thiago walters | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [i915 platform:](page.cgi?id=fields.html#cf_i915_platform "Intel platforms affected by the bug") |  | | [i915 features:](page.cgi?id=fields.html#cf_i915_features "Features of the i915 driver affected by the bug.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**If the loader contains two messages with fds, don't corrupt the second**](attachment.cgi?id=100875 "View the content of the attachment") (1.16 KB, patch)  [2014-06-11 11:26 UTC](#attach_100875 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=100875&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=79694&attachment=100875) | | [View All](attachment.cgi?bugid=79694&action=viewall) | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=79694#c0)  Alejandro Mart√≠nez Su√°rez    2014-06-05 17:47:55 UTC  ``` This problem is related to file descriptor passing in Unix systems. It affects all versions since this functionality was introduced.  In source file 'dbus/dbus-message.c', 'load_message' function, if we have more than one file descriptors inside the loader and they are from different messages, when we are extracting them to compose the actual message, a misbehaviour uprises.  The problem is with this line (dbus/dbus-message.c:4207) of 1.8.X branch:  memmove(loader->unix_fds + n_unix_fds, loader->unix_fds, loader->n_unix_fds);  It pretends to move the array of FD's after extracting the current message ones, but the command has the source and destination arguments swapped.  Suppose we have two FD's in the loader:   (35,36) loader->n_unix_fds = 2  The message we are composing uses one FD (the 35). We assign it to the message, and after executing the previous command, we end with this info in the loader:   (35,35) loader->n_unix_fds = 1  We should have ended with:   (36, ) loader->n_unix_fds = 1  The problem is that we are duplicating the id of the first file descriptor in the position of the second one. Fix it is simple, we only need to interchange them:  memmove(loader->unix_fds, loader->unix_fds + n_unix_fds, loader->n_unix_fds);  This patch has worked succesfully for me. I have tested it on a Suse 11, and my problems with duplicated file descriptors (because two different messages where sharing the same file descriptor) are finally gone :). ```  [Comment 1](show_bug.cgi?id=79694#c1)  Simon McVittie    2014-06-11 11:20:09 UTC  ``` (In reply to [comment #0](show_bug.cgi?id=79694#c0)) > Suppose we have two FD's in the loader:  I think this is a potentially dangerous oversimplification, so I'm going to work through the logic with larger numbers.  Suppose we have 5 fds: the first message is meant to contain 2 and the second 3:  n_unix_fds = 2 message has 0 fds {} loader has 5 fds { 11, 12, 21, 22, 23 }  We copy the first 2 fds into the message:  n_unix_fds = 2 message has 2 fds { 11, 12 } loader has 5 fds { 11, 12, 21, 22, 23 }  and what we want to do is to shift unix_fds[2]..unix_fds[4], inclusive, down to unix_fds[0]..unix_fds[2], inclusive.  There are actually *two* bugs here. One is that we're trying to shift [0]..[2] upwards, not the other way round; so you would expect we would get { 11, 12, 21, 11, 12, [heap buffer overflow] }.  The other bug, which is what prevents this from being a buffer overflow, is that we're incorrectly copying loader->n_unix_fds *bytes*, not loader->n_unix_fds *ints*.  (The buffer overflows if      n_unix_fds * 4 + loader->n_unix_fds > max_message_unix_fds * 4  but since we know that n_unix_fds + loader->n_unix_fds <= max_message_unix_fds, that's impossible. Strictly speaking that "4" should be sizeof(int), but the same relationships remain true.)  > memmove(loader->unix_fds, loader->unix_fds + n_unix_fds, loader->n_unix_fds); >  > This patch has worked succesfully for me.  I think that's only because you happen to be on a little-endian platform, fds are small integers (< 256, so the first byte of little-endian representation is enough), and you're only moving one fd. ```  [Comment 2](show_bug.cgi?id=79694#c2)  Simon McVittie    2014-06-11 11:26:38 UTC  ``` Created [attachment 100875](attachment.cgi?id=100875 "If the loader contains two messages with fds, don't corrupt  the second") [[details]](attachment.cgi?id=100875&action=edit "If the loader contains two messages with fds, don't corrupt  the second") [[review]](page.cgi?id=splinter.html&bug=79694&attachment=100875) If the loader contains two messages with fds, don't corrupt  the second  There were two bugs here: we would previously overwrite the unused fds with the already-used fds instead of the other way round, and we would copy n bytes where we should have copied n ints.  Where's GArray when you need it? ```  [Comment 3](show_bug.cgi?id=79694#c3)  Alban Crequy    2014-06-23 15:04:01 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=79694#c2)) > Created [attachment 100875](attachment.cgi?id=100875 "If the loader contains two messages with fds, don't corrupt  the second") [[details]](attachment.cgi?id=100875&action=edit "If the loader contains two messages with fds, don't corrupt  the second") [[review]](page.cgi?id=splinter.html&bug=79694&attachment=100875) [review] > If the loader contains two messages with fds, don't corrupt  the second >  > There were two bugs here: we would previously overwrite the unused > fds with the already-used fds instead of the other way round, and > we would copy n bytes where we should have copied n ints. >  > Where's GArray when you need it?  The patch looks good to me.  I reproduced the bad behaviour when testing your scenario described in [comment #1](show_bug.cgi?id=79694#c1):  > Suppose we have 5 fds: the first message is meant to contain 2 and the > second 3:  And the issue is gone with your patch. I tested the patch applied on top of the Debian package dbus-1.8.4-1. ```  [Comment 4](show_bug.cgi?id=79694#c4)  Simon McVittie    2014-07-02 16:06:16 UTC  ``` Fixed in dbus 1.6.22, 1.8.6.  This bug also caused a security vulnerability, although it's a denial of service, not the buffer overflow I was initially worried about. See [Bug #80469](show_bug.cgi?id=80469 "RESOLVED FIXED - CVE-2014-3533: Security implications of Bug #79694 Misbehaviour reading a message with fdpassing") for that. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=79694)
* -¬†Top of page

* + [Home](./)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

Use of freedesktop.org services, including Bugzilla, is subject to our [Code of Conduct](https://www.freedesktop.org/wiki/CodeOfConduct/). How we collect and use information is described in our [Privacy Policy](https://www.freedesktop.org/wiki/PrivacyPolicy).



=== Content from www.debian.org_ad02d9cc_20250125_123646.html ===


---

[[Date Prev](msg00151.html)][[Date Next](msg00153.html)]
[[Thread Prev](msg00151.html)][[Thread Next](msg00153.html)]
[[Date Index](maillist.html#00152)]
[[Thread Index](threads.html#00152)]

# [SECURITY] [DSA 2971-1] dbus security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2971-1] dbus security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Wed, 02 Jul 2014 18:40:42 +0000
* *Message-id*: <[[üîé]](/msgid-search/E1X2PSU-0000Pb-8B%40master.debian.org)¬†[E1X2PSU-0000Pb-8B@master.debian.org](msg00152.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2971-1                   security@debian.org
<http://www.debian.org/security/>                      Salvatore Bonaccorso
July 02, 2014                          <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dbus
CVE ID         : CVE-2014-3477 CVE-2014-3532 CVE-2014-3533

Several vulnerabilities have been discovered in dbus, an asynchronous
inter-process communication system. The Common Vulnerabilities and
Exposures project identifies the following problems:

CVE-2014-3477

    Alban Crequy at Collabora Ltd. discovered that dbus-daemon sends an
    AccessDenied error to the service instead of a client when the
    client is prohibited from accessing the service. A local attacker
    could use this flaw to cause a bus-activated service that is not
    currently running to attempt to start, and fail, denying other users
    access to this service.

CVE-2014-3532

    Alban Crequy at Collabora Ltd. discovered a bug in dbus-daemon's
    support for file descriptor passing. A malicious process could force
    system services or user applications to be disconnected from the
    D-Bus system by sending them a message containing a file descriptor,
    leading to a denial of service.

CVE-2014-3533

    Alban Crequy at Collabora Ltd. and Alejandro Martinez Suarez
    discovered that a malicious process could force services to be
    disconnected from the D-Bus system by causing dbus-daemon to attempt
    to forward invalid file descriptors to a victim process, leading to
    a denial of service.

For the stable distribution (wheezy), these problems have been fixed in
version 1.6.8-1+deb7u3.

For the unstable distribution (sid), these problems have been fixed in
version 1.8.6-1.

We recommend that you upgrade your dbus packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJTtE2UAAoJEAVMuPMTQ89EH/QQAJlApEGPFhqUnkoH12Qwpluy
f0tzw9luGd6GbXVm3IR8pBOjZgtC2ZGBUlmE1yN0qvcuuhOM0RTf3VICJ4vStyKp
2xUlmjv32y8G0KCBs0ckk0kNDApa7TNufbuuBa1EFI3BIe6V0TnEyr9oXaKicvuV
PCUlaM81h13zDw1x2KfHsMWlJyr8uoM6PLlgicdRvtEJ88URBC9ZIieYXdK8rpsY
rBiuE9575AxEPtAXV0FUSF371zKXg+ZR3zV4EocrI9liMPigIwrIoqhCTWXfJ0WH
0iLlhG41SLDNiBG/Hw0vlw8kX9/X+dlHQTRYV+qzSYfiBu4wfk/KRaAR0nPdmt+H
ik28WCE5B7zyc7KImAgiruYIl9nfiVcJlJVCPav48x8Cij0+zf3tzYdI3Lo4jQTH
/cSCXWs47U0Lsj0xMc8vrhRJq2NDybTJiAzeY929snNR5EBfBwmm9GoZfOlfkIPx
yPn/TTX3u8N3SFcys0w9zHpL1lrdqZ8pJGTqErA+WlzcFLKMjGArpY1PxdJD8mAE
DLkHWz7yY48WfkaDxfc0iscVqKUPzHsPPVedY31wDCKQjJR36lIkTmyOzKyBoKa1
AyYNQVTKGoxkRsxL/riD57/MprpTqFFHAtDGTw1o3ORZpXbqHnLY5A0QaZPCs3M9
l6ellinwf6MDWjEZ7CPj
=gIUw
-----END PGP SIGNATURE-----

```

---



=== Content from lists.opensuse.org_407bde4d_20250125_123644.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

√ó
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

# openSUSE-SU-2014:1239-1: moderate: dbus-1: update to 1.6.24

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-securityÔº†opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-securityÔº†opensuse.org")

28 Sep
2014

28 Sep
'14

10:09

openSUSE Security Update: dbus-1: update to 1.6.24
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:1239-1
Rating: moderate
References: #896453
Cross-References: CVE-2014-3635 CVE-2014-3636 CVE-2014-3637
CVE-2014-3638 CVE-2014-3639
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 5 vulnerabilities is now available.
Description:
The DBUS-1 service and libraries were updated to upstream release 1.6.24
fixing security issues and bugs.
Upstream changes since dbus 1.6.8
+ Security fixes
- Do not accept an extra fd in the padding of a cmsg message, which
could lead to a 4-byte heap buffer overrun. (CVE-2014-3635,
fdo#83622; Simon McVittie)
- Reduce default for maximum Unix file descriptors passed per message
from 1024 to 16, preventing a uid with the default maximum number of
connections from exhausting the system bus' file descriptors under
Linux's default rlimit. Distributors or system administrators with a
more restrictive fd limit may wish to reduce these limits further.
Additionally, on Linux this prevents a second denial of service in
which the dbus-daemon can be made to exceed the maximum number of
fds per sendmsg() and disconnect the process that would have
received them. (CVE-2014-3636, fdo#82820; Alban Crequy)
- Disconnect connections that still have a fd pending unmarshalling
after a new configurable limit, pending\_fd\_timeout (defaulting to
150 seconds), removing the possibility of creating an abusive
connection that cannot be disconnected by setting up a circular
reference to a connection's file descriptor. (CVE-2014-3637,
fdo#80559; Alban Crequy)
- Reduce default for maximum pending replies per connection from 8192
to 128, mitigating an algorithmic complexity denial-of-service
attack (CVE-2014-3638, fdo#81053; Alban Crequy)
- Reduce default for authentication timeout on the system bus from 30
seconds to 5 seconds, avoiding denial of service by using up all
unauthenticated connection slots; and when all unauthenticated
connection slots are used up, make new connection attempts block
instead of disconnecting them. (CVE-2014-3639, fdo#80919; Alban
Crequy)
- On Linux >= 2.6.37-rc4, if sendmsg() fails with ETOOMANYREFS,
silently drop the message. This prevents an attack in which a
malicious client can make dbus-daemon disconnect a system service,
which is a local denial of service. (fdo#80163, CVE-2014-3532; Alban
Crequy)
- Track remaining Unix file descriptors correctly when more than one
message in quick succession contains fds. This prevents another
attack which a malicious client can make dbus-daemon disconnect a
system service. (fdo#79694, fdo#80469, CVE-2014-3533; Alejandro
Mart√≠nez Su√°rez, Simon McVittie, Alban Crequy)
- Alban Crequy at Collabora Ltd. discovered and fixed a
denial-of-service flaw in dbus-daemon, part of the reference
implementation of D-Bus. Additionally, in highly unusual
environments the same flaw could lead to a side channel between
processes that should not be able to communicate. (CVE-2014-3477,
fdo#78979)
- CVE-2013-2168: Fix misuse of va\_list that could be used as a denial
of service for system services. Vulnerability reported by Alexandru
Cornea. (Simon)
+ Other fixes
- Don't leak memory on out-of-memory while listing activatable or
active services (fdo#71526, Radoslaw Pajak)
- fix undefined behaviour in a regression test (fdo#69924, DreamNik)
- path\_namespace='/' in match rules incorrectly matched nothing; it
now matches everything. (fdo#70799, Simon McVittie)
- Make dbus\_connection\_set\_route\_peer\_messages(x, FALSE) behave as
documented. Previously, it assumed its second parameter was TRUE.
(fdo#69165, Chengwei Yang)
- Fix a NULL pointer dereference on an unlikely error path (fdo#69327,
Sviatoslav Chagaev)
- If accept4() fails with EINVAL, as it can on older Linux kernels
with newer glibc, try accept() instead of going into a busy-loop.
(fdo#69026, Chengwei Yang)
- If socket() or socketpair() fails with EINVAL or EPROTOTYPE, for
instance on Hurd or older Linux with a new glibc, try without
SOCK\_CLOEXEC. (fdo#69073; Pino Toscano, Chengwei Yang)
- Fix a file descriptor leak on an error code path. (fdo#69182,
Sviatoslav Chagaev)
- Fix compilation if writev() is unavailable (fdo#69409, Vasiliy
Balyasnyy)
- Avoid an infinite busy-loop if a signal interrupts waitpid()
(fdo#68945, Simon McVittie)
- Escape addresses containing non-ASCII characters correctly
(fdo#53499, Chengwei Yang)
- If malloc() returns NULL in \_dbus\_string\_init() or similar, don't
free an invalid pointer if the string is later freed (fdo#65959,
Chengwei Yang)
- If malloc() returns NULL in dbus\_set\_error(), don't va\_end() a
va\_list that was never va\_start()ed (fdo#66300, Chengwei Yang)
- Fix a regression test on platforms with strict alignment (fdo#67279,
Colin Walters)
- Avoid calling function parameters "interface" since certain Windows
headers have a namespace-polluting macro of that name (fdo#66493,
Ivan Romanov)
- Make "make -j check" work (fdo#68852, Simon McVittie)
- In dbus-daemon, don't crash if a .service file starts with key=value
(fdo#60853, Chengwei Yang)
- Fix an assertion failure if we try to activate systemd services
before systemd connects to the bus (fdo#50199, Chengwei Yang)
- Avoid compiler warnings for ignoring the return from write()
(Chengwei Yang)
- Following Unicode Corrigendum #9, the noncharacters U+nFFFE,
U+nFFFF, U+FDD0..U+FDEF are allowed in UTF-8 strings again.
(fdo#63072, Simon McVittie)
- Diagnose incorrect use of dbus\_connection\_get\_data() with negative
slot (i.e. before allocating the slot) rather than returning junk
(fdo#63127, Dan Williams)
- In the activation helper, when compiled for tests, do not reset the
system bus address, fixing the regression tests. (fdo#52202, Simon)
- Fix building with Valgrind 3.8, at the cost of causing harmless
warnings with Valgrind 3.6 on some compilers (fdo#55932, Arun
Raghavan)
- Don't leak temporary fds pointing to /dev/null (fdo#56927, Michel
HERMIER)
- Create session.d, system.d directories under CMake (fdo#41319, Ralf
Habacker)
- Include alloca.h for alloca() if available, fixing compilation on
Solaris 10 (fdo#63071, Dagobert Michelsen)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2014-557
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
dbus-1-1.6.24-2.26.1
dbus-1-debuginfo-1.6.24-2.26.1
dbus-1-debugsource-1.6.24-2.26.1
dbus-1-devel-1.6.24-2.26.1
dbus-1-x11-1.6.24-2.26.1
dbus-1-x11-debuginfo-1.6.24-2.26.1
dbus-1-x11-debugsource-1.6.24-2.26.1
libdbus-1-3-1.6.24-2.26.1
libdbus-1-3-debuginfo-1.6.24-2.26.1
- openSUSE 12.3 (x86\_64):
dbus-1-32bit-1.6.24-2.26.1
dbus-1-debuginfo-32bit-1.6.24-2.26.1
dbus-1-devel-32bit-1.6.24-2.26.1
libdbus-1-3-32bit-1.6.24-2.26.1
libdbus-1-3-debuginfo-32bit-1.6.24-2.26.1
- openSUSE 12.3 (noarch):
dbus-1-devel-doc-1.6.24-2.26.1
References:
<http://support.novell.com/security/cve/CVE-2014-3635.html>
<http://support.novell.com/security/cve/CVE-2014-3636.html>
<http://support.novell.com/security/cve/CVE-2014-3637.html>
<http://support.novell.com/security/cve/CVE-2014-3638.html>
<http://support.novell.com/security/cve/CVE-2014-3639.html>
<https://bugzilla.suse.com/show_bug.cgi?id=896453>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.mandriva.com_882a8d89_20250125_123649.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language¬†![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Fran√ßais
  + √ê¬†√ë¬É√ë¬Å√ë¬Å√ê¬∫√ê¬∏√ê¬π

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site ¬ª

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site ¬ª

Language
English (International)
Fran√ßais
√ê¬†√ë¬É√ë¬Å√ë¬Å√ê¬∫√ê¬∏√ê¬π

* ¬© 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from openwall.com_13b44427_20250125_123644.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <53B42D80.1000306@collabora.co.uk>
Date: Wed, 02 Jul 2014 17:04:16 +0100
From: Simon McVittie <simon.mcvittie@...labora.co.uk>
To: oss-security@...ts.openwall.com,
 "dbus@...ts.freedesktop.org" <dbus@...ts.freedesktop.org>
CC: Alban Cr√©quy <alban.crequy@...labora.co.uk>,
 Colin Walters <walters@...bum.org>,
 Thiago Macieira <thiago@....org>
Subject: CVE-2014-3532, -3533: two local DoS vulnerabilities in dbus-daemon

Impact: denial of service (force system services to exit)
Access required: local
Versions affected by CVE-2014-3532: dbus >= 1.3.0 on Linux >= 2.6.37-rc4
Versions affected by CVE-2014-3533: dbus >= 1.3.0 on all Unix platforms

Alban Crequy at Collabora Ltd. discovered a bug in dbus-daemon's support
for file descriptor passing. A malicious process could force system
services or user applications to be disconnected from the D-Bus system
bus by sending them a message containing a file descriptor, then causing
that file descriptor to exceed the kernel's maximum recursion depth
(itself introduced to fix a DoS) before dbus-daemon forwards the message
to the victim process. Most services and applications exit when
disconnected from the system bus, leading to a denial of service. This
is tracked as fd.o#80163 and CVE-2014-3532.

Additionally, Alban discovered that bug fd.o#79694, a bug previously
reported by Alejandro Mart√≠nez Su√°rez which was not believed to be a
security flaw, could be used for a similar denial of service, by causing
dbus-daemon to attempt to forward invalid file descriptors to a victim
process when file descriptors become associated with the wrong message.
Its security implications are tracked as fd.o#80469 and CVE-2014-3533.

For the 1.8.x stable branch, these vulnerabilities are fixed in version
1.8.6. For the 1.6.x old-stable branch, these vulnerabilities are fixed
in version 1.6.22.

All earlier versions of dbus with the file descriptor passing feature
(1.3.0 and up) are believed to be vulnerable. Distributions that
backport security fixes should backport git commits
07f4c12efe3b9bd45d109bc5fbaf6d9dbf69d78e and
9ca90648fc870c24d852ce6d7ce9387a9fc9a94a, attached.

References:

[fd.o#79694] <https://bugs.freedesktop.org/show_bug.cgi?id=79694>
[fd.o#80469] <https://bugs.freedesktop.org/show_bug.cgi?id=80469>
[fd.o#80163] <https://bugs.freedesktop.org/show_bug.cgi?id=80163>

Regards,
    S

View attachment "[0001-If-loader-contains-two-messages-with-fds-don-t-corru.patch](4/1)" of type "text/x-patch" (1687 bytes)

View attachment "[0002-Handle-ETOOMANYREFS-when-sending-recursive-fds-SCM_R.patch](4/2)" of type "text/x-patch" (4657 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.oracle.com_1148ec77_20250125_123649.html ===


* [Skip to content](#maincontent)
* [Accessibility Policy](https://www.oracle.com/corporate/accessibility/)

Products
Industries
Resources
Customers
Partners
Developers
Company

Close Search

Search Oracle.com

* QUICK LINKS
* [Oracle Cloud Infrastructure](/cloud/)
* [Oracle Fusion Cloud Applications](/applications/)
* [Oracle Database](/database/technologies/)
* [Download Java](/java/technologies/downloads/)
* [Careers at Oracle](/careers/)

Search

[Country
![]()](/countries-list.html#countries)

View Accounts

Back
Cloud Account
[Sign in to Cloud](/cloud/sign-in.html)
[Sign Up for Free Cloud Tier](/cloud/free/)

Oracle Account

* [Sign-In](https://www.oracle.com/webapps/redirect/signon?nexturl=)
* [Create an Account](https://profile.oracle.com/myprofile/account/create-account.jspx)

* [Help](/corporate/contact/help.html)
* Sign Out

[Contact Sales](/corporate/contact/ "Contact Sales")

[Menu

Menu](/global-menu-v2/)

* [Security Alerts](/security-alerts/)

# Oracle Solaris Third Party Bulletin - January 2016

## Oracle Solaris Third Party Bulletin - January 2016

### Description

The Oracle Solaris Third Party Bulletin announces patches for one or more security vulnerabilities fixed in third party software that is included in Oracle Solaris distributions. Starting January 20, 2015, Third Party Bulletins are released on the same day when Oracle Critical Patch Updates are released. These bulletins will also be updated on the Tuesday closest to the 17th of the following two months after their release (i.e. the two months between the normal quarterly Critical Patch Update publication dates). In addition, Third Party Bulletins may also be updated for vulnerability fixes deemed too critical to wait for the next monthly update.

**Due to the threat posed by a successful attack, Oracle strongly recommends that customers apply Third Party Bulletin fixes as soon as possible.**

### Patch Availability

Please see My Oracle Support Note [1448883.1](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=98356520554156&id=1448883.1)

### Third Party Bulletin Schedule

Third Party Bulletins are released on the Tuesday closest to the 17th day of January, April, July and October. The next four dates are:

* 19 April 2016
* 19 July 2016
* 18 October 2016
* 17 January 2017

### References

* Oracle Critical Patch Updates and Security Alerts main page¬† [ [Oracle Technology Network](/security-alerts/) ]
* Oracle Critical Patch Updates and Security Alerts - Frequently Asked Questions [ [CPU FAQ](/security-alerts/cpufaq.html) ]
* Risk Matrix definitions ¬† [ [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html) ]
* Use of Common Vulnerability Scoring System (CVSS) by Oracle ¬† [ [Oracle CVSS Scoring](/security-alerts/cvssscoringsystem.html) ]

### Modification History

| 2016-April-12 | Rev 5. Added multiple Samba CVEs |
| --- | --- |
| 2016-March-18 | Rev 4. Added all CVEs fixed in Solaris 11.3 SRU 6.5 |
| 2016-March-15 | Rev 3. Added CVE-2016-1285, CVE-2016-1286 |
| 2016-February-19 | Rev 2. Added all CVEs fixed in Solaris 11.3 SRU 5.6 |
| 2016-January-19 | Rev 1. Initial Release |

### Oracle Solaris Executive Summary

This Third Party Bulletin contains 84 new security fixes for the Oracle Solaris. 69 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without the need for a username and password.

### Oracle Solaris Risk Matrix

#### Revision 5: Published on 2016-04-12

| CVE# | Product | Protocol | Third Party component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen¬≠tication | Confid¬≠entiality | Inte¬≠grity | Avail¬≠ability |
| CVE-2016-2118 | Solaris | Multiple | Samba | Yes | 6.8 | Network | Medium | None | Partial+ | Partial+ | Partial+ | 11.3. 10 |  |
| CVE-2016-2115 | Solaris | Multiple | Samba | Yes | 6.8 | Network | Medium | None | Partial+ | Partial+ | Partial+ | 11.3. 10 |  |
| CVE-2016-2111 | Solaris | Multiple | Samba | Yes | 4.3 | Network | Medium | None | Partial+ | None | None | 11.3. 10 |  |
| CVE-2016-2112 | Solaris | Multiple | Samba | Yes | 4.3 | Network | Medium | None | None | Partial+ | None | 11.3, 10 |  |
| CVE-2016-2110 | Solaris | Multiple | Samba | Yes | 4.3 | Network | Medium | None | None | Partial | None | 11.3. 10 |  |
| CVE-2015-5370 | Solaris | Multiple | Samba | Yes | 4.3 | Network | Medium | None | None | None | Partial+ | 11.3. 10 |  |

#### Revision 4: Published on 2016-03-18

| CVE# | Product | Protocol | Third Party component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen¬≠tication | Confid¬≠entiality | Inte¬≠grity | Avail¬≠ability |
| CVE-2016-0799 | Solaris | SSL/TLS | OpenSSL | Yes | 10.0 | Network | Low | None | Complete | Complete | Complete | 10 |  |
| CVE-2015-3280 | Solaris | Multiple | OpenStack Compute (Nova) | No | 6.8 | Network | Low | Single | None | None | Complete | 11.3 |  |
| CVE-2015-5174 | Solaris | Multiple | Apache Tomcat | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 11.3, 10 | See Note 2 |
| CVE-2014-3636 | Solaris | None | DBus | No | 6.6 | Local | Medium | Single | Complete | Complete | Complete | 11.3 | See Note 10 |
| CVE-2015-7705 | Solaris | Multiple | NTP | Yes | 6.4 | Network | Low | None | None | Partial | Partial | 11.3, 10 | See Note 3 |
| CVE-2015-5252 | Solaris | Multiple | Samba | Yes | 5.0 | Network | Low | None | None | Partial | None | 11.3, 10 |  |
| CVE-2016-0797 | Solaris | SSL/TLS | OpenSSL | Yes | 5.0 | Network | Low | None | None | None | Partial | 10 |  |
| CVE-2015-5146 | Solaris | Multiple | NTP | No | 4.9 | Adjacent Network | Medium | Single | Partial | Partial | Partial | 11.3 |  |
| CVE-2015-5299 | Solaris | None | Samba | No | 4.6 | Local | Low | Single | Complete | None | None | 11.3, 10 |  |
| CVE-2015-5346 | Solaris | None | Apache Tomcat | No | 4.4 | Local | Medium | None | Partial | Partial | Partial | 11.3 | See Note 8 |
| CVE-2014-3566 | Solaris | HTTP | Apache HTTP Server | Yes | 4.3 | Network | Medium | None | Partial | None | None | 10 |  |
| CVE-2015-3197 | Solaris | SSL/TLS | OpenSSL | Yes | 4.3 | Network | Medium | None | Partial | None | None | 10 |  |
| CVE-2015-4000 | Solaris | SSL/TLS | OpenSSL | Yes | 4.3 | Network | Medium | None | None | Partial | None | 10 |  |
| CVE-2015-3197 | Solaris | SSL/TLS | Wanboot | Yes | 4.3 | Network | Medium | None | Partial | None | None | 10 |  |
| CVE-2016-0800 | Solaris | SSL/TLS | OpenSSL | Yes | 4.3 | Network | Medium | None | Partial | None | None | 10 |  |
| CVE-2016-0703 | Solaris | SSL/TLS | OpenSSL | Yes | 4.3 | Network | Medium | None | Partial | None | None | 10 |  |
| CVE-2016-0704 | Solaris | SSL/TLS | OpenSSL | Yes | 4.3 | Network | Medium | None | Partial | None | None | 10 |  |
| CVE-2015-5296 | Solaris | None | Samba | No | 3.0 | Local | Medium | Single | Partial+ | Partial+ | None | 11.3, 10 |  |
| CVE-2015-5300 | Solaris | Multiple | NTP | Yes | 2.6 | Network | High | None | None | Partial | None | 11.3, 10 |  |
| CVE-2014-3533 | Solaris | None | DBus | No | 2.1 | Local | Low | None | None | None | Partial | 11.3 | See Note 9 |
| CVE-2016-2533 | Solaris | None | Python Imaging Library (PIL) | No | 2.1 | Local | Low | None | None | None | Partial | 11.3 |  |
| CVE-2014-3532 | Solaris | None | DBus | No | 1.9 | Local | Medium | None | None | None | Partial | 11.3 | See Note 11 |

#### Revision 3: Published on 2016-03-15

| CVE# | Product | Protocol | Third Party component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen¬≠tication | Confid¬≠entiality | Inte¬≠grity | Avail¬≠ability |
| CVE-2016-1285 | Solaris | Bind | Bind | Yes | 5.0 | Network | Low | None | None | None | Partial+ | 11.3, 10 | See Note 1 |

#### Revision 2: Published on 2016-02-19

| CVE# | Product | Protocol | Third Party component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen¬≠tication | Confid¬≠entiality | Inte¬≠grity | Avail¬≠ability |
| CVE-2015-3217 | Solaris | Multiple | PCRE | Yes | 9.3 | Network | Medium | None | Complete | Complete | Complete | 11.3 | See Note 4 |
| CVE-2012-2814 | Solaris | Multiple | LibEXIF | Yes | 7.5 | Network | Low | None | Partial | Partial | Partial | 10 |  |
| CVE-2015-3144 | Solaris | Multiple | libcurl | Yes | 7.5 | Network | Low | None | Partial | Partial | Partial | 11.3 |  |
| CVE-2015-3145 | Solaris | Multiple | libcurl | Yes | 7.5 | Network | Low | None | Partial | Partial | Partial | 11.3 |  |
| CVE-2015-8557 | Solaris | Multiple | Pygments | Yes | 7.5 | Network | Low | None | Partial | Partial | Partial | 11.3 |  |
| CVE-2004-0548 | Solaris | Multiple | Aspell | No | 7.2 | Local | Low | None | Complete | Complete | Complete | 10 |  |
| CVE-2015-6564 | Solaris | None | OpenSSH | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 11.3 |  |
| CVE-2013-6418 | Solaris | Multiple | PYWBEM | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 11.3 | See Note 5 |
| CVE-2015-8605 | Solaris | Multiple | DHCP Server | No | 5.7 | Adjacent Network | Medium | None | None | None | Complete | 11.3 |  |
| CVE-2014-3566 | Solaris | Multiple | OpenPegasus CIM Server | Yes | 5.0 | Network | Low | None | Partial | None | None | 11.3 |  |
| CVE-2014-0015 | Solaris | Multiple | libcurl | Yes | 5.0 | Network | Low | None | None | Partial | None | 11.3 | See Note 6 |
| CVE-2015-3148 | Solaris | Multiple | libcurl | Yes | 5.0 | Network | Low | None | None | Partial | None | 11.3 |  |
| CVE-2015-3153 | Solaris | Multiple | libcurl | Yes | 5.0 | Network | Low | None | Partial | None | None | 11.3 |  |
| CVE-2015-7995 | Solaris | Multiple | libxslt | Yes | 5.0 | Network | Low | None | None | None | Partial | 11.3 |  |
| CVE-2015-3195 | Solaris | SSL/TLS | WanBoot | Yes | 5.0 | Network | Low | None | Partial | None | None | 10 |  |
| CVE-2015-4000 | Solaris | Multiple | Thunderbird | Yes | 4.3 | Network | Medium | None | None | Partial | None | 11.3 |  |
| CVE-2015-3236 | Solaris | Multiple | libcurl | Yes | 4.3 | Network | Medium | None | Partial | None | None | 11.3 | See Note 7 |
| CVE-2015-5352 | Solaris | Multiple | OpenSSH | Yes | 4.3 | Network | Medium | None | None | Partial | None | 11.3 |  |
| CVE-2015-8733 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8711 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8712 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8713 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8714 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8715 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8716 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8717 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8718 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8719 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8720 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8721 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8722 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8723 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8724 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8725 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | Partial | None | 11.3 |  |
| CVE-2015-8726 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8727 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8728 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8729 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8730 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8731 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8732 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-7942 | Solaris | Multiple | libxml2 | Yes | 2.6 | Network | High | None | None | None | Partial | 11.3 |  |
| CVE-2015-8241 | Solaris | Multiple | libxml2 | Yes | 2.6 | Network | High | None | None | None | Partial | 11.3 |  |
| CVE-2015-8242 | Solaris | Multiple | libxml2 | Yes | 2.6 | Network | High | None | None | None | Partial | 11.3 |  |
| CVE-2015-7498 | Solaris | Multiple | libxml2 | Yes | 2.6 | Network | High | None | Partial | None | None | 11.3 |  |
| CVE-2015-5312 | Solaris | Multiple | libxml2 | Yes | 2.6 | Network | High | None | None | None | Partial | 11.3 |  |
| CVE-2015-7499 | Solaris | Multiple | libxml2 | Yes | 2.6 | Network | High | None | None | None | Partial | 11.3 |  |
| CVE-2015-7500 | Solaris | Multiple | libxml2 | Yes | 2.6 | Network | High | None | None | None | Partial | 11.3 |  |
| CVE-2015-8317 | Solaris | Multiple | libxml2 | Yes | 2.6 | Network | High | None | None | None | Partial | 11.3 |  |
| CVE-2015-7497 | Solaris | Multiple | libxml2 | No | 2.1 | Network | High | Single | Partial | None | None | 11.3 |  |
| CVE-2015-6563 | Solaris | None | OpenSSH | No | 1.9 | Local | Medium | None | None | Partial | None | 11.3 |  |

#### Revision 1: Published on 2016-01-19

| CVE# | Product | Protocol | Third Party component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen¬≠tication | Confid¬≠entiality | Inte¬≠grity | Avail¬≠ability |
| CVE-2015-8704 | Solaris | Bind | Bind | No | 6.8 | Network | Low | Single | None | None | Complete | 11.3, 10 |  |
| CVE-2015-3194 | Solaris | SSL/TLS | OpenSSL | Yes | 5.0 | Network | Low | None | None | None | Partial | 11.3, 10 |  |
| CVE-2015-3195 | Solaris | SSL/TLS | OpenSSL | Yes | 5.0 | Network | Low | None | Partial | None | None | 11.3, 10 |  |
| CVE-2015-3196 | Solaris | SSL/TLS | OpenSSL | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3, 10 |  |

#### Notes:

1. This fix also addresses CVE-2016-1286.
2. This fix also addresses CVE-2015-5345 CVE-2016-0706 CVE-2016-0714.
3. This fix also addresses CVE-2015-5300 CVE-2015-7691 CVE-2015-7692 CVE-2015-7701 CVE-2015-7702 CVE-2015-7703 CVE-2015-7704 CVE-2015-7848 CVE-2015-7849 CVE-2015-7850 CVE-2015-7851 CVE-2015-7852 CVE-2015-7853 CVE-2015-7854 CVE-2015-7855 CVE-2015-7871 CVE-2015-7973 CVE-2015-7974 CVE-2015-7975 CVE-2015-7976 CVE-2015-7977 CVE-2015-7978 CVE-2015-7979 CVE-2015-8138 CVE-2015-8139 CVE-2015-8140 CVE-2015-8158.
4. This fix also addresses CVE-2015-3210.
5. This fix also addresses CVE-2013-6444.
6. This fix also addresses CVE-2015-3143.
7. This fix also addresses CVE-2015-3237.
8. This fix also addresses CVE-2015-5351 CVE-2016-0763.
9. This fix also addresses CVE-2014-3532 CVE-2014-3635 CVE-2015-0245.
10. This fix also addresses CVE-2014-3532 CVE-2014-3635 CVE-2014-3637 CVE-2014-3638 CVE-2014-3639 CVE-2014-7824 CVE-2015-0245.
11. This fix also addresses CVE-2014-3635 CVE-2015-0245.

Resources for

* [Careers](/careers/)
* [Developers](/developer/)
* [Investors](https://investor.oracle.com/home/default.aspx)
* [Partners](/partner/)
* [Researchers](/research/)
* [Students and Educators](https://academy.oracle.com/en/oa-web-overview.html)

Why Oracle

* [Analyst Reports](/corporate/analyst-reports/)
* [Best cloud-based
  ERP](/erp/what-is-erp/best-erp/)
* [Cloud Economics](/cloud/economics/)
* [Social Impact](/social-impact/)
* [Culture and Inclusion](/careers/diversity-inclusion/)
* [Security Practices](/corporate/security-practices/)

Learn

* [What is cloud
  computing?](/cloud/what-is-cloud-computing/)
* [What is CRM?](/cx/what-is-crm/)
* [What is
  Docker?](/cloud/cloud-native/container-registry/what-is-docker/)
* [What is
  Kubernetes?](/cloud/cloud-native/kubernetes-engine/what-is-kubernetes/)
* [What is
  Python?](/developer/what-is-python-for-developers/)
* [What is SaaS?](/applications/what-is-saas/)

News and Events

* [News](/news/)
* [Oracle CloudWorld](/cloudworld/)
* [Oracle CloudWorld Tour](/cloudworld-tour/)
* [Oracle Health Summit](/health/health-summit/)
* [Oracle Dev Tour](/developer/dev-tour/)
* [Search all events](https://search.oracle.com/events?q=&lang=english)

Contact Us

* US Sales: +1.800.633.0738
* [How can we help?](/corporate/contact/)
* [Subscribe to emails](https://go.oracle.com/subscribe/?l_code=en&src1=OW:O:FO)
* [Integrity Helpline](https://secure.ethicspoint.com/domain/media/en/gui/31053/index.html)
* [Accessibility](/corporate/accessibility/)

---

* [Country/Region](/universal-menu/#u10countrymenu)

* [¬© 2025 Oracle](/legal/copyright/)
* [Privacy](/legal/privacy/)/[Do Not Sell My
  Info](/legal/privacy/privacy-choices/)
* [Ad
  Choices](/legal/privacy/privacy-policy/#adchoices)
* [Careers](/corporate/careers/)



=== Content from bugs.freedesktop.org_00f97884_20250125_123652.html ===


Bugzilla ‚Äì Bug¬†80469
CVE-2014-3533: Security implications of Bug #79694 Misbehaviour reading a message with fdpassing
Last modified: 2014-07-02 16:07:11 UTC

* [Home](./)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

[**Bug¬†80469**](show_bug.cgi?id=80469)
- CVE-2014-3533: Security implications of [Bug #79694](show_bug.cgi?id=79694 "RESOLVED FIXED - Misbehaviour reading a message with passing file descriptors (duplicate/missing fds)") Misbehaviour reading a message with fdpassing

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-3533: Security implications of Bug #79694 Misbehaviour reading a mes...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | dbus | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=dbus "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | core ([show other bugs](buglist.cgi?component=core&product=dbus&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other All | |  | | | [Importance](page.cgi?id=fields.html#importance): | medium normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Simon McVittie | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sjoerd Simons | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-06-24 09:40 UTC by Alban Crequy | | --- | --- | | Modified: | 2014-07-02 16:07 UTC ([History](show_activity.cgi?id=80469)) | | CC List: | 3 users (show)  alban.crequy thiago walters | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [i915 platform:](page.cgi?id=fields.html#cf_i915_platform "Intel platforms affected by the bug") |  | | [i915 features:](page.cgi?id=fields.html#cf_i915_features "Features of the i915 driver affected by the bug.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | |  | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=80469#c0)  Alban Crequy    2014-06-24 09:40:50 UTC  ``` This bug is to discuss the security implications of [Bug #79694](show_bug.cgi?id=79694 "RESOLVED FIXED - Misbehaviour reading a message with passing file descriptors (duplicate/missing fds)") ("Misbehaviour reading a message with passing file descriptors (duplicate/missing fds)").  I can kick any connection off the bus with fdpassing, as long as the malicious program is allowed to send messages to the target.  I tested with this on the system bus: $ ./test79694 com.redhat.PrinterDriversInstaller And the process was terminated.  - The malicious program sends 2 messages to the target:    - Message 1: - contains 2 file descriptors (53 and 54 in the logs)                 - is slightly larger than 2048 bytes so it needs 2 iterations                   to read (*). See max_bytes_read_per_iteration.    - Message 2: - contains 3 file descriptors (61, 62, and 63 in the logs)                 - is a small message  Strace logs of dbus-daemon:  * receive part 1/2 of message 1:  recvmsg(40, {msg_name(0)=NULL,              msg_iov(1)=[{"l\1\1\1\f\10\0\0\2\0\0\0_\0\0\0\t\1u\0\2\0\0\0\10\1g\0\3hhs"..., 2048}],              msg_controllen=24, {cmsg_len=24, cmsg_level=SOL_SOCKET, cmsg_type=SCM_RIGHTS, {53, 54}},              msg_flags=MSG_CMSG_CLOEXEC}, MSG_CMSG_CLOEXEC) = 2048 fcntl(53, F_GETFD)                      = 0x1 (flags FD_CLOEXEC) fcntl(53, F_SETFD, FD_CLOEXEC)          = 0 fcntl(54, F_GETFD)                      = 0x1 (flags FD_CLOEXEC) fcntl(54, F_SETFD, FD_CLOEXEC)          = 0  * receive both part 2/2 of message 1 and message 2 in a single recvmsg() call:  recvmsg(40, {msg_name(0)=NULL, msg_iov(1)=[{"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"..., 2048}],              msg_controllen=32, {cmsg_len=28, cmsg_level=SOL_SOCKET, cmsg_type=SCM_RIGHTS, {61, 62, 63}},              msg_flags=MSG_CMSG_CLOEXEC}, MSG_CMSG_CLOEXEC) = 248 fcntl(61, F_GETFD)                      = 0x1 (flags FD_CLOEXEC) fcntl(61, F_SETFD, FD_CLOEXEC)          = 0 fcntl(62, F_GETFD)                      = 0x1 (flags FD_CLOEXEC) fcntl(62, F_SETFD, FD_CLOEXEC)          = 0 fcntl(63, F_GETFD)                      = 0x1 (flags FD_CLOEXEC) fcntl(63, F_SETFD, FD_CLOEXEC)          = 0  * send message 1 to target. Notice it sends the correct fds and closes them correctly:  sendmsg(36,         {msg_name(0)=NULL,          msg_iov(2)=[{"l\1\1\1\f\10\0\0\2\0\0\0o\0\0\0\t\1u\0\2\0\0\0\10\1g\0\3hhs"..., 128},                      {"\0\0\0\0\1\0\0\0\377\7\0\0XXXXXXXXXXXXXXXXXXXX"..., 2060}],          msg_controllen=24,          {cmsg_len=24, cmsg_level=SOL_SOCKET, cmsg_type=SCM_RIGHTS, {53, 54}},           msg_flags=0}, MSG_NOSIGNAL) = 2188 close(53)                               = 0 close(54)                               = 0  * send message 2 to target: due to the bug, it sends the wrong fds (the fds are closed already):  sendmsg(36,         {msg_name(0)=NULL,          msg_iov(2)=[{"l\1\1\1\f\0\0\0\3\0\0\0o\0\0\0\t\1u\0\3\0\0\0\10\1g\0\3hhh"..., 128},                      {"\0\0\0\0\1\0\0\0\2\0\0\0", 12}],          msg_controllen=32,          {cmsg_len=28, cmsg_level=SOL_SOCKET, cmsg_type=SCM_RIGHTS, {53, 54, 53}},           msg_flags=0}, MSG_NOSIGNAL) = -1 EBADF (Bad file descriptor)  * Notice that sendmsg() returns -1 EBADF! * Too bad for the innocent target! dbus-daemon kills the connection:  epoll_ctl(4, EPOLL_CTL_DEL, 36, {0, {u32=0, u64=0}}) = 0 close(36)                               = 0  * And closes the wrong fds:  close(53)                               = -1 EBADF (Bad file descriptor) write(2, "Failed to close file descriptor:"..., 55) = 55 close(54)                               = -1 EBADF (Bad file descriptor) write(2, "Failed to close file descriptor:"..., 55) = 55 close(53)                               = -1 EBADF (Bad file descriptor) write(2, "Failed to close file descriptor:"..., 55) = 55  => It is an effective way to kill any connection on the bus if the D-Bus      policy and SCMs allow the malicious program to send 2 D-Bus messages to the    target. D-Bus libraries often terminate the program when the D-Bus    connection is closed. So it can kill programs on the bus.  (*): If you wonder why message 1 needs to be bigger than      max_bytes_read_per_iteration, it is because the kernel will not      aggregate the two D-Bus messages in a single recvmsg() call otherwise:      <http://lxr.free-electrons.com/source/net/unix/af_unix.c#L2051>      2051                         if (siocb->scm->fp)      2052                                 break;      and the bug happends only when fds from several D-Bus messages are in      the loader at the same time.  ==========  The patch attached on [Bug #79694](show_bug.cgi?id=79694 "RESOLVED FIXED - Misbehaviour reading a message with passing file descriptors (duplicate/missing fds)") fixes the security issue.  [Bug #80163](show_bug.cgi?id=80163 "RESOLVED FIXED - CVE-2014-3532: kick any connection off the bus with fdpassing: denial of service") is a different bug but has a similar security impact. I suggest fixes for both could be released at the same time. ```  [Comment 1](show_bug.cgi?id=80469#c1)  Colin Walters    2014-06-24 12:02:05 UTC  ``` Can you attach the sources for "test79694"? ```  [Comment 2](show_bug.cgi?id=80469#c2)  Simon McVittie    2014-06-26 14:01:32 UTC  ``` If none of the other D-Bus maintainers review my patch for #79694 soon, I will treat Alban's positive review as sufficient for merge, and include it in the same DoS-fix release as [Bug #80163](show_bug.cgi?id=80163 "RESOLVED FIXED - CVE-2014-3532: kick any connection off the bus with fdpassing: denial of service").  (In reply to [comment #1](show_bug.cgi?id=80469#c1)) > Can you attach the sources for "test79694"?  Resolved elsewhere: Alban sent this by private email, because this bug is going to become public when unembargoed, and he wanted to err on the side of caution when passing around working exploits. ```  [Comment 3](show_bug.cgi?id=80469#c3)  Simon McVittie    2014-07-02 16:07:11 UTC  ``` Removing embargo. Fixed in dbus 1.8.6 and 1.6.22 which I just released. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=80469)
* -¬†Top of page

* + [Home](./)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

Use of freedesktop.org services, including Bugzilla, is subject to our [Code of Conduct](https://www.freedesktop.org/wiki/CodeOfConduct/). How we collect and use information is described in our [Privacy Policy](https://www.freedesktop.org/wiki/PrivacyPolicy).



=== Content from advisories.mageia.org_e4ba88a9_20250125_123643.html ===

# [Advisories](index.html) ¬ª MGASA-2014-0294

## Updated dbus packages fix multiple vulnerabilities

Publication date: 26 Jul 2014

Modification date: 26 Jul 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-3532](CVE-2014-3532.html)
,
[CVE-2014-3533](CVE-2014-3533.html)

## Description

```
Updated dbus packages fix security vulnerabilities:

A flaw was reported in D-Bus's file descriptor passing feature. A local
attacker could use this flaw to cause a service or application to disconnect
from the bus, typically resulting in that service or application exiting
(CVE-2014-3532).

A flaw was reported in D-Bus's file descriptor passing feature. A local
attacker could use this flaw to cause an invalid file descriptor to be
forwarded to a service or application, causing it to disconnect from the bus,
typically resulting in that service or application exiting (CVE-2014-3533).

```

## References

* <http://lists.freedesktop.org/archives/dbus/2014-July/016235.html>
* <https://lists.fedoraproject.org/pipermail/package-announce/2014-July/135226.html>
* <https://bugs.mageia.org/show_bug.cgi?id=13653>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3532>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3533>

## SRPMS

### 3/core

* dbus-1.6.8-4.4.mga3

### 4/core

* dbus-1.6.18-1.3.mga4


