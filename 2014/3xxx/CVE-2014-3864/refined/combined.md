=== Content from www.ubuntu.com_1deb6ec5_20250124_173215.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2242-1: dpkg vulnerabilities

10 June 2014

A malicious source package could write files outside the unpack directory.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 13.10](/security/notices?release=saucy)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [dpkg](/security/cves?package=dpkg) - Debian package management system

## Details

It was discovered that dpkg incorrectly handled certain patches when

unpacking source packages. If a user or an automated system were tricked

into unpacking a specially crafted source package, a remote attacker could

modify files outside the target unpack directory, leading to a denial of

service or potentially gaining access to the system.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 14.04

* [libdpkg-perl](https://launchpad.net/ubuntu/%2Bsource/dpkg)
  -
  [1.17.5ubuntu5.3](https://launchpad.net/ubuntu/%2Bsource/dpkg/1.17.5ubuntu5.3)

##### Ubuntu 13.10

* [libdpkg-perl](https://launchpad.net/ubuntu/%2Bsource/dpkg)
  -
  [1.16.12ubuntu1.3](https://launchpad.net/ubuntu/%2Bsource/dpkg/1.16.12ubuntu1.3)

##### Ubuntu 12.04

* [libdpkg-perl](https://launchpad.net/ubuntu/%2Bsource/dpkg)
  -
  [1.16.1.2ubuntu7.5](https://launchpad.net/ubuntu/%2Bsource/dpkg/1.16.1.2ubuntu7.5)

##### Ubuntu 10.04

* [dpkg-dev](https://launchpad.net/ubuntu/%2Bsource/dpkg)
  -
  [1.15.5.6ubuntu4.9](https://launchpad.net/ubuntu/%2Bsource/dpkg/1.15.5.6ubuntu4.9)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2014-3864](/security/CVE-2014-3864)
* [CVE-2014-3865](/security/CVE-2014-3865)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

Â© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from lists.ubuntu.com_be8ed54b_20250126_023401.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from security-tracker.debian.org_7364ac1c_20250126_023405.html ===

# CVE-2014-3865

| **Name** | CVE-2014-3865 |
| --- | --- |
| **Description** | Multiple directory traversal vulnerabilities in dpkg-source in dpkg-dev 1.3.0 allow remote attackers to modify files outside of the intended directories via a source package with a crafted Index: pseudo-header in conjunction with (1) missing --- and +++ header lines or (2) a +++ header line with a blank pathname. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2014-3865) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2014-3865); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2014-3865), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2014-3865), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2014-3865), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2014-3865), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-3865), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2014-3865), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2014-3865), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2014-3865)/[CVE](https://www.suse.com/security/cve/CVE-2014-3865/), GitHub [advisories](https://github.com/advisories?query=CVE-2014-3865)/[code](https://github.com/search?type=Code&q=%22CVE-2014-3865%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2014-3865%22), [web search](https://duckduckgo.com/html?q=%22CVE-2014-3865%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2953-1](/tracker/DSA-2953-1) |
| **Debian Bugs** | [749183](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=749183) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [dpkg](/tracker/source-package/dpkg) ([PTS](https://tracker.debian.org/pkg/dpkg)) | bullseye | 1.20.13 | fixed |
|  | bullseye (security) | 1.20.10 | fixed |
|  | bookworm | 1.21.22 | fixed |
|  | trixie | 1.22.11 | fixed |
|  | sid | 1.22.14 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [dpkg](/tracker/source-package/dpkg) | source | squeeze | 1.15.11 |  | [DSA-2953-1](/tracker/DSA-2953-1) |  |
| [dpkg](/tracker/source-package/dpkg) | source | wheezy | 1.16.15 |  | [DSA-2953-1](/tracker/DSA-2953-1) |  |
| [dpkg](/tracker/source-package/dpkg) | source | (unstable) | 1.17.10 |  |  | [749183](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=749183) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from security-tracker.debian.org_e7876c02_20250126_023403.html ===

# CVE-2014-3864

| **Name** | CVE-2014-3864 |
| --- | --- |
| **Description** | Directory traversal vulnerability in dpkg-source in dpkg-dev 1.3.0 allows remote attackers to modify files outside of the intended directories via a crafted source package that lacks a --- header line. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2014-3864) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2014-3864); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2014-3864), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2014-3864), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2014-3864), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2014-3864), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-3864), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2014-3864), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2014-3864), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2014-3864)/[CVE](https://www.suse.com/security/cve/CVE-2014-3864/), GitHub [advisories](https://github.com/advisories?query=CVE-2014-3864)/[code](https://github.com/search?type=Code&q=%22CVE-2014-3864%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2014-3864%22), [web search](https://duckduckgo.com/html?q=%22CVE-2014-3864%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2953-1](/tracker/DSA-2953-1) |
| **Debian Bugs** | [746498](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746498) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [dpkg](/tracker/source-package/dpkg) ([PTS](https://tracker.debian.org/pkg/dpkg)) | bullseye | 1.20.13 | fixed |
|  | bullseye (security) | 1.20.10 | fixed |
|  | bookworm | 1.21.22 | fixed |
|  | trixie | 1.22.11 | fixed |
|  | sid | 1.22.14 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [dpkg](/tracker/source-package/dpkg) | source | squeeze | 1.15.11 |  | [DSA-2953-1](/tracker/DSA-2953-1) |  |
| [dpkg](/tracker/source-package/dpkg) | source | wheezy | 1.16.15 |  | [DSA-2953-1](/tracker/DSA-2953-1) |  |
| [dpkg](/tracker/source-package/dpkg) | source | (unstable) | 1.17.10 |  |  | [746498](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746498) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from launchpad.net_6a4bcbf8_20250126_023401.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/dpkg/1.15.5.6ubuntu4.9/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[dpkg package](https://launchpad.net/ubuntu/%2Bsource/dpkg)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/dpkg)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/dpkg)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/dpkg)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/dpkg)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/dpkg)

# dpkg 1.15.5.6ubuntu4.9 source package in Ubuntu

## Changelog

```
dpkg (1.15.5.6ubuntu4.9) lucid-security; urgency=medium

  * SECURITY UPDATE: arbitrary file modification via dpkg-source
    - scripts/Dpkg/Source/Patch.pm: Use a better regex for patch header
      parsing
    - 5348cbc981a65c3c9b05bb4d13553bda930c2d78
    - CVE-2014-3864
    - CVE-2014-3865
 -- Marc Deslauriers <email address hidden>   Mon, 09 Jun 2014 13:03:40 -0400
```

## Upload details

Uploaded by:
[Marc Deslauriers](/~mdeslaur)
on 2014-06-09

Uploaded to:
[Lucid](/ubuntu/lucid)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
any

Section:
admin

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Lucid](/ubuntu/lucid):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6084155)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armel](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6084156)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6084157)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[ia64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6084158)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6084159)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[sparc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6084160)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [dpkg\_1.15.5.6ubuntu4.9.tar.bz2](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/dpkg/1.15.5.6ubuntu4.9/dpkg_1.15.5.6ubuntu4.9.tar.bz2) | 4.5 MiB | edeca24f5b6238acaca816841825d9baa6734f05be93cef1a0f54eb8a8fa3572 |
| [dpkg\_1.15.5.6ubuntu4.9.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/dpkg/1.15.5.6ubuntu4.9/dpkg_1.15.5.6ubuntu4.9.dsc) | 1.9 KiB | 385881807d391d386cb4c81946794aa745512aa1c836dc459f33637d71895927 |

### Available diffs

* [diff from 1.15.5.6ubuntu4.8 to 1.15.5.6ubuntu4.9](http://launchpadlibrarian.net/177271071/dpkg_1.15.5.6ubuntu4.8_1.15.5.6ubuntu4.9.diff.gz) (661 bytes)

[View changes file](http://launchpadlibrarian.net/177270985/dpkg_1.15.5.6ubuntu4.9_source.changes)

## Binary packages built by this source

[dpkg](/ubuntu/lucid/%2Bpackage/dpkg):
No summary available for dpkg in ubuntu lucid.

No description available for dpkg in ubuntu lucid.

[dpkg-dev](/ubuntu/lucid/%2Bpackage/dpkg-dev):
No summary available for dpkg-dev in ubuntu lucid.

No description available for dpkg-dev in ubuntu lucid.

[dselect](/ubuntu/lucid/%2Bpackage/dselect):
No summary available for dselect in ubuntu lucid.

No description available for dselect in ubuntu lucid.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
Â â¢
[Take the tour](https://launchpad.net/%2Btour)
Â â¢
[Read the guide](https://help.launchpad.net/)

Â© 2004
[CanonicalÂ Ltd.](http://canonical.com/)
Â â¢
[Terms of use](https://launchpad.net/legal)
Â â¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
Â â¢
[Contact Launchpad Support](/feedback)
Â â¢
[Blog](http://blog.launchpad.net/)
Â â¢
[Careers](https://canonical.com/careers)
Â â¢
[System status](https://ubuntu.social/%40launchpadstatus)
Â â¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.debian.org_74ce8704_20250124_173217.html ===

# Debian Bug report logs - #746498 dpkg-source: Directory traversal on unpack through missing --- header line

[![version graph](version.cgi?fixed=dpkg%2F1.17.10;fixed=dpkg%2F1.16.15;fixed=dpkg%2F1.15.11;collapse=1;height=2;found=1.3.0;absolute=0;package=dpkg-dev;width=2)](version.cgi?package=dpkg-dev;fixed=dpkg%2F1.17.10;fixed=dpkg%2F1.16.15;fixed=dpkg%2F1.15.11;collapse=1;found=1.3.0;absolute=0;info=1)

Package:
[dpkg-dev](pkgreport.cgi?package=dpkg-dev);
Maintainer for [dpkg-dev](pkgreport.cgi?package=dpkg-dev) is [Dpkg Developers <debian-dpkg@lists.debian.org>](pkgreport.cgi?maint=debian-dpkg%40lists.debian.org); Source for [dpkg-dev](pkgreport.cgi?package=dpkg-dev) is [src:dpkg](pkgreport.cgi?src=dpkg) ([PTS](https://tracker.debian.org/pkg/dpkg), [buildd](https://buildd.debian.org/dpkg), [popcon](https://qa.debian.org/popcon.php?package=dpkg)).

Reported by: [javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net](pkgreport.cgi?submitter=javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9%40jasp.net)

Date: Wed, 30 Apr 2014 16:18:01 UTC

Severity: important

Tags: security

Found in version 1.3.0

Fixed in versions dpkg/1.17.10, dpkg/1.16.15, dpkg/1.15.11

**Done:** Guillem Jover <guillem@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=746498;mbox=yes), [status mbox](bugreport.cgi?bug=746498;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=746498;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746498`; Package `dpkg`.
(Wed, 30 Apr 2014 16:18:06 GMT) ([full text](bugreport.cgi?bug=746498;msg=2), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

New Bug report received and forwarded. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.

Your message had a Version: pseudo-header with an invalid package
version:

1.15.8.13 1.16.12

please either use found or fixed to the control server with a correct
version, or reply to this report indicating the correct version so the
maintainer (or someone else) can correct it for you.

(Wed, 30 Apr 2014 16:18:06 GMT) ([full text](bugreport.cgi?bug=746498;msg=4), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=5), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=javier%40jasp.net)
From: Javier Serrano Polo <javier@jasp.net>
To: submit@bugs.debian.org
Subject: dpkg: directory traversal during unpack
Date: Wed, 30 Apr 2014 18:14:29 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=746498;msg=5) (text/plain, inline)]
```
```
Package: dpkg
Version: 1.15.8.13 1.16.12
Tags: security

Directory traversal was already possible. I have suggested a solution.
That is the way I fixed it: dry run, let the patch tool say what files
will be touched. Another solution would be to stop using an external
tool.

I will wait two days before releasing one of the exploit packages.

```
```
[[smime.p7s](bugreport.cgi?att=1;bug=746498;filename=smime.p7s;msg=5) (application/pkcs7-signature, attachment)]
```

---

**Marked as found in versions dpkg/1.15.8.13.**
Request was from `Javier Serrano Polo <javier@jasp.net>`
to `control@bugs.debian.org`.
(Wed, 30 Apr 2014 16:57:17 GMT) ([full text](bugreport.cgi?bug=746498;msg=7), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=7), [link](#6)).

---

**Marked as found in versions dpkg/1.16.12.**
Request was from `Javier Serrano Polo <javier@jasp.net>`
to `control@bugs.debian.org`.
(Wed, 30 Apr 2014 16:57:18 GMT) ([full text](bugreport.cgi?bug=746498;msg=9), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=9), [link](#8)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746498`; Package `dpkg`.
(Thu, 01 May 2014 04:57:05 GMT) ([full text](bugreport.cgi?bug=746498;msg=11), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=11), [link](#10)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Thu, 01 May 2014 04:57:05 GMT) ([full text](bugreport.cgi?bug=746498;msg=13), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=13), [link](#12)).

---

[Message #14](#14) received at 746498@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=14), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=14), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746498@bugs.debian.org
Subject: Re: Bug#746498: dpkg: directory traversal during unpack
Date: Thu, 1 May 2014 06:54:30 +0200
```
On Wed, 2014-04-30 at 18:14:29 +0200, Javier Serrano Polo wrote:
> Package: dpkg
> Version: 1.15.8.13 1.16.12
> Tags: security

> Directory traversal was already possible. I have suggested a solution.
> That is the way I fixed it: dry run, let the patch tool say what files
> will be touched. Another solution would be to stop using an external
> tool.

Ok, now I'm confused, do you mean there's another security problem?
And that you've got a patch fixing it, or just that you would fix it
that way?

> I will wait two days before releasing one of the exploit packages.

Didn't you do that before filing this bug report in:

  <<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746306#61>>

?

Thanks,
Guillem

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746498`; Package `dpkg`.
(Thu, 01 May 2014 05:42:04 GMT) ([full text](bugreport.cgi?bug=746498;msg=16), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=16), [link](#15)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Thu, 01 May 2014 05:42:04 GMT) ([full text](bugreport.cgi?bug=746498;msg=18), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=18), [link](#17)).

---

[Message #19](#19) received at 746498@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=19), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=19), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746498@bugs.debian.org
Subject: Re: Bug#746498: dpkg: directory traversal during unpack
Date: Thu, 1 May 2014 07:38:41 +0200
```
On Thu, 2014-05-01 at 06:54:30 +0200, Guillem Jover wrote:
> On Wed, 2014-04-30 at 18:14:29 +0200, Javier Serrano Polo wrote:
> > Package: dpkg
> > Version: 1.15.8.13 1.16.12
> > Tags: security
>
> > Directory traversal was already possible. I have suggested a solution.
> > That is the way I fixed it: dry run, let the patch tool say what files
> > will be touched. Another solution would be to stop using an external
> > tool.
>
> Ok, now I'm confused, do you mean there's another security problem?

If so, I'd appreciate if you could send me a PoC package.

Thanks,
Guillem

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746498`; Package `dpkg`.
(Fri, 02 May 2014 00:09:04 GMT) ([full text](bugreport.cgi?bug=746498;msg=21), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Fri, 02 May 2014 00:09:04 GMT) ([full text](bugreport.cgi?bug=746498;msg=23), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 746498@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=24), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746498@bugs.debian.org
Cc: team@security.debian.org
Subject: Re: Bug#746498: dpkg: directory traversal during unpack
Date: Fri, 2 May 2014 02:05:19 +0200
```
On Thu, 2014-05-01 at 07:38:41 +0200, Guillem Jover wrote:
> On Thu, 2014-05-01 at 06:54:30 +0200, Guillem Jover wrote:
> > On Wed, 2014-04-30 at 18:14:29 +0200, Javier Serrano Polo wrote:
> > > Package: dpkg
> > > Version: 1.15.8.13 1.16.12
> > > Tags: security
> >
> > > Directory traversal was already possible. I have suggested a solution.
> > > That is the way I fixed it: dry run, let the patch tool say what files
> > > will be touched. Another solution would be to stop using an external
> > > tool.
> >
> > Ok, now I'm confused, do you mean there's another security problem?
>
> If so, I'd appreciate if you could send me a PoC package.

Ok, I decided to take a look just now, and I've found one issue,
although as I don't know if it's the same we might end up having
to prepare multiple security updatesâ¦

I'll provide more details to the security team in private, and start
preparing fixed packages for all suites.

Thanks,
Guillem

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746498`; Package `dpkg`.
(Fri, 02 May 2014 17:18:09 GMT) ([full text](bugreport.cgi?bug=746498;msg=26), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=26), [link](#25)).

---

**Acknowledgement sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Fri, 02 May 2014 17:18:09 GMT) ([full text](bugreport.cgi?bug=746498;msg=28), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 746498@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=29), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=javier%40jasp.net)
From: Javier Serrano Polo <javier@jasp.net>
To: 746498@bugs.debian.org
Subject: Re: Bug#746498: Acknowledgement (dpkg: directory traversal during
unpack)
Date: Fri, 02 May 2014 18:37:16 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=746498;msg=29) (text/plain, inline)]
```
```
Here it is the package.

```
```
[[exploto_0.2.debian.tar.gz](bugreport.cgi?att=1;bug=746498;filename=exploto_0.2.debian.tar.gz;msg=29) (application/x-compressed-tar, attachment)]
```
```
[[exploto_0.2.dsc](bugreport.cgi?att=2;bug=746498;filename=exploto_0.2.dsc;msg=29) (text/plain, attachment)]
```
```
[[exploto_0.2.orig.tar.gz](bugreport.cgi?att=3;bug=746498;filename=exploto_0.2.orig.tar.gz;msg=29) (application/x-compressed-tar, attachment)]
```
```
[[smime.p7s](bugreport.cgi?att=4;bug=746498;filename=smime.p7s;msg=29) (application/pkcs7-signature, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746498`; Package `dpkg`.
(Fri, 02 May 2014 18:06:07 GMT) ([full text](bugreport.cgi?bug=746498;msg=31), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=31), [link](#30)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Fri, 02 May 2014 18:06:07 GMT) ([full text](bugreport.cgi?bug=746498;msg=33), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=33), [link](#32)).

---

[Message #34](#34) received at 746498@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=34), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=34), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746498@bugs.debian.org
Cc: team@security.debian.org
Subject: Re: Bug#746498: Acknowledgement (dpkg: directory traversal during
unpack)
Date: Fri, 2 May 2014 20:04:32 +0200
```
[ BTW, I keep having to check the debbugs web interface as I'm not
  receiving any of your mails. ]

On Fri, 2014-05-02 at 18:37:16 +0200, Javier Serrano Polo wrote:
> Here it is the package.

Ok, had already found and reported this second one to the security
team earlier today. So with this and the one I found yesterday,
there's nothing new here (and there's no problem disclosing there's
more than one issue now, as one is enough to exploit this).

Thanks,
Guillem

```

---

**Marked as found in versions dpkg/1.13.0.**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Sat, 24 May 2014 23:00:04 GMT) ([full text](bugreport.cgi?bug=746498;msg=36), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=36), [link](#35)).

---

**Bug reassigned from package '[dpkg](pkgreport.cgi?package=dpkg)' to '[dpkg-dev](pkgreport.cgi?package=dpkg-dev)'.**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Sat, 24 May 2014 23:06:04 GMT) ([full text](bugreport.cgi?bug=746498;msg=38), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=38), [link](#37)).

---

**No longer marked as found in versions dpkg/1.16.12, dpkg/1.13.0, and dpkg/1.15.8.13.**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Sat, 24 May 2014 23:06:05 GMT) ([full text](bugreport.cgi?bug=746498;msg=40), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=40), [link](#39)).

---

**Changed Bug title to 'dpkg-source: Directory traversal on unpack through missing --- header line' from 'dpkg: directory traversal during unpack'**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Sat, 24 May 2014 23:06:06 GMT) ([full text](bugreport.cgi?bug=746498;msg=42), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=42), [link](#41)).

---

**Marked as found in versions 1.3.0.**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Sat, 24 May 2014 23:09:07 GMT) ([full text](bugreport.cgi?bug=746498;msg=44), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=44), [link](#43)).

---

**Severity set to 'important' from 'normal'**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Sat, 24 May 2014 23:15:09 GMT) ([full text](bugreport.cgi?bug=746498;msg=46), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=46), [link](#45)).

---

**Added tag(s) pending.**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Thu, 05 Jun 2014 19:36:09 GMT) ([full text](bugreport.cgi?bug=746498;msg=48), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=48), [link](#47)).

---

**Message sent on**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug#746498.
(Thu, 05 Jun 2014 19:36:20 GMT) ([full text](bugreport.cgi?bug=746498;msg=50), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=50), [link](#49)).

---

[Message #51](#51) received at 746498-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=51), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=51), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746498-submitter@bugs.debian.org
Subject: Bug#746498 marked as pending
Date: Thu, 05 Jun 2014 19:33:38 +0000
```
tag 746498 pending
thanks

Hello,

Bug #746498 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=5348cbc>

---
commit 5348cbc981a65c3c9b05bb4d13553bda930c2d78
Author: Guillem Jover <guillem@debian.org>
Date:   Fri May 2 01:41:18 2014 +0200

    Dpkg::Source::Patch: Fix patch header parsing to avoid directory traversals

    The code parsing the patches was not taking into account that patches
    w/ partial or no pathname headers are still valid patches, and that
    they can specify the pathname in the Index: pseudo-header or in a
    single Â«+++ Â» pathname header, which allows doing directory traversal
    when unpacking source packages.

    The first vector is due to how the Index: pseudo-header is handled by
    patch. Its value gets used (on non-POSIX mode) only when both Â«+++ Â»
    and Â«--- Â» pathname headers do not provide a pathname, by either having
    an empty pathname or by the header being completely absent. The minimal
    fix for this is to just consider that we've parsed the header when we
    see a hunk header marker Â«@@ -Â». This is [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865) and #749183.

    The other vector is due to patches with only a Â«+++ Â» pathname header,
    which get skipped by the parser as it only checks for Â«--- Â» pathname
    header lines. The minimal fix for this is to also check for Â«+++ Â» when
    parsing the patch header. This is [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864) and #746498.

    The first issue is a superset of the second, and its fix is sufficient
    and covers and fixes too the second vector, as the Â«@@ -Â» marker is
    mandatory for a patch to be valid.

    An unspecified directory traversal vulnerability was initially reported
    in #746498 by Javier Serrano Polo <javier@jasp.net>, and while no
    information had been provided, I independently found #749183 and what
    was supposed to be #746498, which was later on published.

    Fixes: [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864), [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865)
    Closes: #[746498](bugreport.cgi?bug=746498), #[749183](bugreport.cgi?bug=749183)

diff --git a/debian/changelog b/debian/changelog
index ba0c19f..80990a7 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -66,6 +66,13 @@ dpkg (1.17.10) UNRELEASED; urgency=low
     Thanks to Hleb Valoshka <375gnu@gmail.com>.
   * Add support for DragonFlyBSD to start-stop-daemon. Closes: #[734452](bugreport.cgi?bug=734452)
     Based on a patch by Hleb Valoshka <375gnu@gmail.com>.
+  * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
+    traversal attempts from hostile source packages when unpacking them.
+    Reported by Javier Serrano Polo <javier@jasp.net> as an unspecified
+    directory traversal; meanwhile also independently found by me both
+    #749183 and what was supposed to be #746498, which was later on published
+    and ended up being just a subset of the other non-reported issue.
+    Fixes [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864) and [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865). Closes: #[746498](bugreport.cgi?bug=746498), #[749183](bugreport.cgi?bug=749183)

   [ Updated programs translations ]
   * Catalan (Guillem Jover).

```

---

**Reply sent**
to `Guillem Jover <guillem@debian.org>`:

You have taken responsibility.
(Thu, 05 Jun 2014 19:51:25 GMT) ([full text](bugreport.cgi?bug=746498;msg=53), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=53), [link](#52)).

---

**Notification sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug acknowledged by developer.
(Thu, 05 Jun 2014 19:51:25 GMT) ([full text](bugreport.cgi?bug=746498;msg=55), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=55), [link](#54)).

---

[Message #56](#56) received at 746498-close@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=56), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=56), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746498-close@bugs.debian.org
Subject: Bug#746498: fixed in dpkg 1.17.10
Date: Thu, 05 Jun 2014 19:48:41 +0000
```
Source: dpkg
Source-Version: 1.17.10

We believe that the bug you reported is fixed in the latest version of
dpkg, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 746498@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover <guillem@debian.org> (supplier of updated dpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 05 Jun 2014 20:18:04 +0200
Source: dpkg
Binary: libdpkg-dev dpkg dpkg-dev libdpkg-perl dselect
Architecture: source amd64 all
Version: 1.17.10
Distribution: unstable
Urgency: medium
Maintainer: Dpkg Developers <debian-dpkg@lists.debian.org>
Changed-By: Guillem Jover <guillem@debian.org>
Description:
 dpkg       - Debian package management system
 dpkg-dev   - Debian package development tools
 dselect    - Debian package management front-end
 libdpkg-dev - Debian package management static library
 libdpkg-perl - Dpkg perl modules
Closes: [584233](bugreport.cgi?bug=584233) [731530](bugreport.cgi?bug=731530) [734452](bugreport.cgi?bug=734452) [746122](bugreport.cgi?bug=746122) [746498](bugreport.cgi?bug=746498) [746973](bugreport.cgi?bug=746973) [747148](bugreport.cgi?bug=747148) [747370](bugreport.cgi?bug=747370) [748012](bugreport.cgi?bug=748012) [748544](bugreport.cgi?bug=748544) [749044](bugreport.cgi?bug=749044) [749183](bugreport.cgi?bug=749183) [750105](bugreport.cgi?bug=750105)
Changes:
 dpkg (1.17.10) unstable; urgency=medium
 .
   [ Guillem Jover ]
   * Use libtool to build the static libraries, which makes it possible to
     embed libcompat inside libdpkg, as required by some external programs
     linking against the latter. Closes: #[746122](bugreport.cgi?bug=746122)
   * Fix word wrapping logic in dselect. Regression introduced in dpkg 1.17.3.
   * Fix possible out of bounds buffer read access in the error output on
     bogus ar member sizes.
   * Fix memory leaks in buffer_copy() on error conditions.
   * Test suite:
     - Improve C code coverage.
     - Add template test cases for most perl modules.
     - Add test cases for Dpkg::Deps OR relationships.
     - Add minimal test case for Dpkg::Source::Quilt.
     - Add test cases for Dpkg::Source::Patch [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471) and [CVE-2014-3127](https://security-tracker.debian.org/tracker/CVE-2014-3127).
     - Add test case for patch disabling hunks; not security sensitive.
   * Fix non-security sensitive TOCTOU race in triggers database loading.
   * Fix non-security sensitive TOCTOU race in update-alternative alternative
     database loading.
   * Fix non-security sensitive TOCTOU race in update-alternative rename code.
   * Add a workaround to start-stop-daemon for bogus OpenVZ Linux kernels that
     prepend, instead of appending, the " (deleted)" marker in /proc/PID/exe.
     Closes: #[731530](bugreport.cgi?bug=731530)
   * Move dpkg-architecture -L argument to the Commands --help output section.
   * Make dpkg-maintscript-helper print only once that we are moving a
     conffile, and not on every interim state transition. Closes: #[747370](bugreport.cgi?bug=747370)
   * Do not use global match variables in perl code.
   * Man pages:
     - Attempt to clarify and improve wording of some strange or confused
       constructs. Reported by Helge Kreutzmann.
     - Expand Vcs-* field names into each supported field name in
       deb-src-control(5) to make it easier to search for them.
     - Change control.tar.gz reference to simply control.tar in deb(5).
     - Document in dpkg-deb(1) -Z option that bzip2 and lzma are deprecated.
     - Add notes in dpkg-gensymbols(1) about symbol backward-compatibility.
       Based on a patch by Bernhard R. Link <brlink@debian.org>.
       Closes: #[746973](bugreport.cgi?bug=746973)
     - Document that dpkg-buildpackage(1) -j argument is optional.
     - Add current and deprecated media types to deb(5).
     - Document in dpkg(1) that --audit now does more than just searching for
       partially installed packages.
   * Add support for automatic parallel job selection in dpkg-buildpackage,
     matching currently active processors, when using -jauto. Closes: #[748012](bugreport.cgi?bug=748012)
   * Perl modules:
     - Bump $VERSION for Dpkg::Patch, missed in 1.16.1.
     - Bump $VERSION for Dpkg::Deps, missed in 1.17.0.
     - Update and fix CHANGES POD sections for public modules.
     - Add missing Dpkg::Deps::Multiple profile_is_concerned() and
       reduce_profiles() methods, inherited by Dpkg::Deps::Union,
       Dpkg::Deps::AND and Dpkg::Deps::OR.
   * Do not mangle quilt series files with a missing newline on the last line.
     Closes: #[584233](bugreport.cgi?bug=584233)
   * Quiesce tar warnings in cron job by redirecting stderr to /dev/null, as
     it seems --warning=none does not work correctly. Closes: #[748544](bugreport.cgi?bug=748544)
   * Do not emit a trailing space from Dpkg::Control::Hash on a field's empty
     first line. Bump dpkg-dev Breaks on devscripts to 2.14.4, as previous
     versions expect a trailing space from dpkg-parsechangelog output.
     Based on a patch by Johannes Schauer <j.schauer@email.de>. Closes: #[749044](bugreport.cgi?bug=749044)
   * Do not assume that sensible-editor is present on Â«dpkg-source --commitÂ»,
     as that command is very Debian specific. Fallback to try VISUAL, EDITOR,
     or vi, if the previous commands are either unset or not found.
   * Use badusage() instead of ohshit() on dpkg --ignore-depends argument
     parsing errors.
   * Add per package dpkg --audit support.
   * Add support for DragonFlyBSD to ostable and triplettable.
     Thanks to Hleb Valoshka <375gnu@gmail.com>.
   * Add support for DragonFlyBSD to start-stop-daemon. Closes: #[734452](bugreport.cgi?bug=734452)
     Based on a patch by Hleb Valoshka <375gnu@gmail.com>.
   * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
     traversal attempts from hostile source packages when unpacking them.
     Reported by Javier Serrano Polo <javier@jasp.net> as an unspecified
     directory traversal; meanwhile also independently found by me both
     #749183 and what was supposed to be #746498, which was later on published
     and ended up being just a subset of the other non-reported issue.
     Fixes [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864) and [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865). Closes: #[746498](bugreport.cgi?bug=746498), #[749183](bugreport.cgi?bug=749183)
 .
   [ Updated programs translations ]
   * Catalan (Guillem Jover).
   * Italian (Milo Casagrande). Closes: #[750105](bugreport.cgi?bug=750105)
 .
   [ Updated scripts translations ]
   * German (Helge Kreutzmann).
 .
   [ Updated manpages translations ]
   * German (Helge Kreutzmann).
 .
   [ RaphaÃ«l Hertzog ]
   * Let dpkg-source unpack additional tarballs in a deterministic order.
     Thanks to Samuel Bronson for the report. Closes: #[747148](bugreport.cgi?bug=747148)
Checksums-Sha1:
 c91e1e1bb0dc5918f20e3874c4b371425dac0da3 2055 dpkg_1.17.10.dsc
 2d88ef04db662d046fadb005bb31667fc0ba64de 4198340 dpkg_1.17.10.tar.xz
 be325d2d7fac12f031e537b5ed269724542f118c 799530 libdpkg-dev_1.17.10_amd64.deb
 ab90f4afdca78f0a5b8cf359b6c1c31c8c3f9e66 2704088 dpkg_1.17.10_amd64.deb
 6e9d00f6e0e8155085c619090292a548373842c5 1059422 dselect_1.17.10_amd64.deb
 8c56a5720faf36231f2ce88c271d34941bb4d61b 1425374 dpkg-dev_1.17.10_all.deb
 6bbd6bddfe2a6af99cfbf547e5de9abbb48d7a81 974696 libdpkg-perl_1.17.10_all.deb
Checksums-Sha256:
 8552763122f36a4ede1e040dee28a84202de9f4b65dbcc90e2c068101d2a599d 2055 dpkg_1.17.10.dsc
 a3a6d4da2b99484c04b2aa8af83d59d87a988baea627d276308467b22310b4d9 4198340 dpkg_1.17.10.tar.xz
 a6b8ed0b95af7748ee3daf9e297c94bb0ab166d7908bbc46e2f5ef5ab93c08b1 799530 libdpkg-dev_1.17.10_amd64.deb
 81a2e6111e825e8a01caa8bf2c8876d806fe9e7297deea0eb61e5a9d93c9a82c 2704088 dpkg_1.17.10_amd64.deb
 1a8a3924786f18c9e0432b8cb34c8c99576dd96221fab9cda2a0f3b5b7606d51 1059422 dselect_1.17.10_amd64.deb
 ba58996d596f73a312b9d92bf01f40f2eeac1ba6db4011875bfbd685371c9619 1425374 dpkg-dev_1.17.10_all.deb
 702028918cfda7e1eaf7391717818b2e6dd05b00b02e4091ea084791e8308234 974696 libdpkg-perl_1.17.10_all.deb
Files:
 7c8852829f4caa99b6c3a232915ac28c 799530 libdevel optional libdpkg-dev_1.17.10_amd64.deb
 90ba5aa300a72a9a54eeda5990b2641f 2704088 admin required dpkg_1.17.10_amd64.deb
 b6f581a13931bfedde3719dc4340b476 1059422 admin optional dselect_1.17.10_amd64.deb
 405cccbb6024ecb98fa6fc8939365cbc 1425374 utils optional dpkg-dev_1.17.10_all.deb
 be5fa2aa735a59ec34d1e4c889c6b7d4 974696 perl optional libdpkg-perl_1.17.10_all.deb
 274a6b2892d179ed04ad916dd2103676 2055 admin required dpkg_1.17.10.dsc
 545f3cbac8b5f0b3d888574f3f79936c 4198340 admin required dpkg_1.17.10.tar.xz

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBCAAGBQJTkMS1AAoJELlyvz6krlejNxcP+wT/0vQECEQh1CI3DIS9aPYE
FfvmpoHioGn8dE8Su318SeZy+IADIis9IeE6GytqwMGIIekh6tC4ES574GRuLiRc
Edy4IrAlLnrGfM5VbAh5f1F9vmgZkBy2Z8R/oRjnQthgy5SUbGe1Bx9jqbh2sR4k
94EsdCuAxTiDI9+O15prM2u3Vxe7TD4Z7n9kjD3Tj35THVp6okpj1qGbTQ9bQJ04
nIcaWtZf6NXxyTNvXJ9Ac8Cdv47q1/CB4yXNQf47v0U6Rjorvh3EHkWyEtVpP1Ps
JVprxVwuxb9ayYn5j2MeBcMWS3igyowsh9a23+lZCwz0SALChZMHeYV74TB1/b8p
Gc53g6jSjI6bKK5xy5hst7tcG/ALmY0HE+jpkgVK/EJPwGKYq1julwgjd6kmrHA+
MBGs3p5ZTbR2PmzLYAmyzD2Ctabz7dFHZpMJ0c3pPsrGLUYD89gSZqp2k4zmrPIp
EEkhJNCsUFJbnG0ZpEw5aYCCHgPcKWazvsGh/DgYYytrWatJkmzgZi4I8KW+jEYG
85volBskw5V6aqJWJ9Sum/W2A11iR3El46YKqfqqSI83D2ucLWE5eXaMF3o5x+LP
AJ/XshrbiouHSu4GKiH/N7WGbD9OSYpnU/fdNbtiw+GNUC5KfsztDFWUWmiX4JP1
XzNrK95rGu/atNhtRghC
=d8BF
-----END PGP SIGNATURE-----

```

---

**Added tag(s) pending.**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Thu, 05 Jun 2014 21:57:04 GMT) ([full text](bugreport.cgi?bug=746498;msg=58), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=58), [link](#57)).

---

**Message sent on**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug#746498.
(Thu, 05 Jun 2014 21:57:19 GMT) ([full text](bugreport.cgi?bug=746498;msg=60), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=60), [link](#59)).

---

[Message #61](#61) received at 746498-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=61), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=61), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746498-submitter@bugs.debian.org
Subject: Bug#746498 marked as pending
Date: Thu, 05 Jun 2014 21:54:14 +0000
```
tag 746498 pending
thanks

Hello,

Bug #746498 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=7095952>

---
commit 709595277b09eec1b4fc4b783a25d0dc02823ff1
Author: Guillem Jover <guillem@debian.org>
Date:   Fri May 2 01:41:18 2014 +0200

    Dpkg::Source::Patch: Fix patch header parsing to avoid directory traversals

    Cherry picked from commit 5348cbc981a65c3c9b05bb4d13553bda930c2d78.

    The code parsing the patches was not taking into account that patches
    w/ partial or no pathname headers are still valid patches, and that
    they can specify the pathname in the Index: pseudo-header or in a
    single Â«+++ Â» pathname header, which allows doing directory traversal
    when unpacking source packages.

    The first vector is due to how the Index: pseudo-header is handled by
    patch. Its value gets used (on non-POSIX mode) only when both Â«+++ Â»
    and Â«--- Â» pathname headers do not provide a pathname, by either having
    an empty pathname or by the header being completely absent. The minimal
    fix for this is to just consider that we've parsed the header when we
    see a hunk header marker Â«@@ -Â». This is [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865) and #749183.

    The other vector is due to patches with only a Â«+++ Â» pathname header,
    which get skipped by the parser as it only checks for Â«--- Â» pathname
    header lines. The minimal fix for this is to also check for Â«+++ Â» when
    parsing the patch header. This is [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864) and #746498.

    The first issue is a superset of the second, and its fix is sufficient
    and covers and fixes too the second vector, as the Â«@@ -Â» marker is
    mandatory for a patch to be valid.

    An unspecified directory traversal vulnerability was initially reported
    in #746498 by Javier Serrano Polo <javier@jasp.net>, and while no
    information had been provided, I independently found #749183 and what
    was supposed to be #746498, which was later on published.

    Fixes: [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864), [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865)
    Closes: #[746498](bugreport.cgi?bug=746498), #[749183](bugreport.cgi?bug=749183)

diff --git a/debian/changelog b/debian/changelog
index cbbbf8d..94e53ab 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -3,6 +3,13 @@ dpkg (1.16.15) UNRELEASED; urgency=low
   [ Guillem Jover ]
   * Test suite:
     - Add test cases for Dpkg::Source::Patch [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471) and [CVE-2014-3127](https://security-tracker.debian.org/tracker/CVE-2014-3127).
+  * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
+    traversal attempts from hostile source packages when unpacking them.
+    Reported by Javier Serrano Polo <javier@jasp.net> as an unspecified
+    directory traversal; meanwhile also independently found by me both
+    #749183 and what was supposed to be #746498, which was later on published
+    and ended up being just a subset of the other non-reported issue.
+    Fixes [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864) and [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865). Closes: #[746498](bugreport.cgi?bug=746498), #[749183](bugreport.cgi?bug=749183)

   [ Updated scripts translations ]
   * German (Helge Kreutzmann).

```

---

**Message sent on**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug#746498.
(Thu, 05 Jun 2014 21:57:22 GMT) ([full text](bugreport.cgi?bug=746498;msg=63), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=63), [link](#62)).

---

[Message #64](#64) received at 746498-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=64), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=64), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746498-submitter@bugs.debian.org
Subject: Bug#746498 marked as pending
Date: Thu, 05 Jun 2014 21:54:31 +0000
```
tag 746498 pending
thanks

Hello,

Bug #746498 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=b171991>

---
commit b1719917979ac339a610a27aef8de7f4dcf93887
Author: Guillem Jover <guillem@debian.org>
Date:   Fri May 2 01:41:18 2014 +0200

    Dpkg::Source::Patch: Fix patch header parsing to avoid directory traversals

    Cherry picked from commit 5348cbc981a65c3c9b05bb4d13553bda930c2d78.

    The code parsing the patches was not taking into account that patches
    w/ partial or no pathname headers are still valid patches, and that
    they can specify the pathname in the Index: pseudo-header or in a
    single Â«+++ Â» pathname header, which allows doing directory traversal
    when unpacking source packages.

    The first vector is due to how the Index: pseudo-header is handled by
    patch. Its value gets used (on non-POSIX mode) only when both Â«+++ Â»
    and Â«--- Â» pathname headers do not provide a pathname, by either having
    an empty pathname or by the header being completely absent. The minimal
    fix for this is to just consider that we've parsed the header when we
    see a hunk header marker Â«@@ -Â». This is [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865) and #749183.

    The other vector is due to patches with only a Â«+++ Â» pathname header,
    which get skipped by the parser as it only checks for Â«--- Â» pathname
    header lines. The minimal fix for this is to also check for Â«+++ Â» when
    parsing the patch header. This is [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864) and #746498.

    The first issue is a superset of the second, and its fix is sufficient
    and covers and fixes too the second vector, as the Â«@@ -Â» marker is
    mandatory for a patch to be valid.

    An unspecified directory traversal vulnerability was initially reported
    in #746498 by Javier Serrano Polo <javier@jasp.net>, and while no
    information had been provided, I independently found #749183 and what
    was supposed to be #746498, which was later on published.

    Fixes: [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864), [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865)
    Closes: #[746498](bugreport.cgi?bug=746498), #[749183](bugreport.cgi?bug=749183)

diff --git a/debian/changelog b/debian/changelog
index 613b988..621875c 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -3,6 +3,13 @@ dpkg (1.15.11) UNRELEASED; urgency=low
   [ Guillem Jover ]
   * Test suite:
     - Add test cases for Dpkg::Source::Patch [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471) and [CVE-2014-3127](https://security-tracker.debian.org/tracker/CVE-2014-3127).
+  * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
+    traversal attempts from hostile source packages when unpacking them.
+    Reported by Javier Serrano Polo <javier@jasp.net> as an unspecified
+    directory traversal; meanwhile also independently found by me both
+    #749183 and what was supposed to be #746498, which was later on published
+    and ended up being just a subset of the other non-reported issue.
+    Fixes [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864) and [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865). Closes: #[746498](bugreport.cgi?bug=746498), #[749183](bugreport.cgi?bug=749183)

  -- Guillem Jover <guillem@debian.org>  Fri, 02 May 2014 00:09:43 +0200

```

---

**Reply sent**
to `Guillem Jover <guillem@debian.org>`:

You have taken responsibility.
(Sun, 15 Jun 2014 21:36:17 GMT) ([full text](bugreport.cgi?bug=746498;msg=66), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=66), [link](#65)).

---

**Notification sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug acknowledged by developer.
(Sun, 15 Jun 2014 21:36:17 GMT) ([full text](bugreport.cgi?bug=746498;msg=68), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=68), [link](#67)).

---

[Message #69](#69) received at 746498-close@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=69), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=69), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746498-close@bugs.debian.org
Subject: Bug#746498: fixed in dpkg 1.16.15
Date: Sun, 15 Jun 2014 21:33:14 +0000
```
Source: dpkg
Source-Version: 1.16.15

We believe that the bug you reported is fixed in the latest version of
dpkg, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 746498@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover <guillem@debian.org> (supplier of updated dpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 05 Jun 2014 22:24:36 +0200
Source: dpkg
Binary: libdpkg-dev dpkg dpkg-dev libdpkg-perl dselect
Architecture: source amd64 all
Version: 1.16.15
Distribution: wheezy-security
Urgency: high
Maintainer: Dpkg Developers <debian-dpkg@lists.debian.org>
Changed-By: Guillem Jover <guillem@debian.org>
Description:
 dpkg       - Debian package management system
 dpkg-dev   - Debian package development tools
 dselect    - Debian package management front-end
 libdpkg-dev - Debian package management static library
 libdpkg-perl - Dpkg perl modules
Closes: [746498](bugreport.cgi?bug=746498) [749183](bugreport.cgi?bug=749183)
Changes:
 dpkg (1.16.15) wheezy-security; urgency=high
 .
   [ Guillem Jover ]
   * Test suite:
     - Add test cases for Dpkg::Source::Patch [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471) and [CVE-2014-3127](https://security-tracker.debian.org/tracker/CVE-2014-3127).
     - Add test case for patch disabling hunks; not security sensitive.
   * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
     traversal attempts from hostile source packages when unpacking them.
     Reported by Javier Serrano Polo <javier@jasp.net> as an unspecified
     directory traversal; meanwhile also independently found by me both
     #749183 and what was supposed to be #746498, which was later on published
     and ended up being just a subset of the other non-reported issue.
     Fixes [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864) and [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865). Closes: #[746498](bugreport.cgi?bug=746498), #[749183](bugreport.cgi?bug=749183)
 .
   [ Updated programs translations ]
   * Merge translated strings from master.
 .
   [ Updated scripts translations ]
   * German (Helge Kreutzmann).
 .
   [ Updated man page translations ]
   * Merge translated strings from master.
   * Unfuzzy or update trivial translations (Guillem Jover).
Checksums-Sha1:
 be105c05324861a6864c782031ee04a9e52f1ca5 2016 dpkg_1.16.15.dsc
 c034f88c1ea9d8df7c5a84cc04bb7749e2b3617a 3800328 dpkg_1.16.15.tar.xz
 7dfd3227baecfe2ad664d50d6a55ba4f9cf83b02 696352 libdpkg-dev_1.16.15_amd64.deb
 7d947c681e58819378f602b285bb4fbc5ecce669 2656714 dpkg_1.16.15_amd64.deb
 52e908a53fda707b37479dbb5268dd878a8ef412 1159292 dselect_1.16.15_amd64.deb
 113be782cd7f9c6b9e3b55c55ecf50be1ca0d95e 1355958 dpkg-dev_1.16.15_all.deb
 47c95b017e2d3f914921bbf721e264312d815f0b 957964 libdpkg-perl_1.16.15_all.deb
Checksums-Sha256:
 00f01b04878d80d40e8d9420e5d35200101c5201f4fad36d4197a50a1d4c465d 2016 dpkg_1.16.15.dsc
 92bca9901ba2d9300be42f6de8dbea59b8367a918a2abeeb47d2176c9cf86b55 3800328 dpkg_1.16.15.tar.xz
 cf9fd73f4c8f54451ed9f2418737e232c0c9dc8907867af22c96ba649e60d248 696352 libdpkg-dev_1.16.15_amd64.deb
 47831eef504efd77a3998a5fecea04c278ba4d5512405e9da42008f38d726413 2656714 dpkg_1.16.15_amd64.deb
 4370e54fd4743969ffb86b53905ed7b96f8735eb0e9367a25eab98223306be88 1159292 dselect_1.16.15_amd64.deb
 ac4b9142ba4653faed8b902a39115a97ecc40ded51e67d01634f19389a39ba17 1355958 dpkg-dev_1.16.15_all.deb
 18a40e9f826f7ada39a03356924b86f14cc342e2ee0209459e394c89095b8073 957964 libdpkg-perl_1.16.15_all.deb
Files:
 3e0e5af42ed579f3bf721ea1a7020033 2016 admin required dpkg_1.16.15.dsc
 0e7d105a57839cdab2b0bf5e3612442f 3800328 admin required dpkg_1.16.15.tar.xz
 8db3cf1534386da5215c1916ba1fa38a 696352 libdevel optional libdpkg-dev_1.16.15_amd64.deb
 11948b8a099f6e51b8deea79f4b92916 2656714 admin required dpkg_1.16.15_amd64.deb
 7f4a898524458a347e24297b50639b7f 1159292 admin optional dselect_1.16.15_amd64.deb
 4ad8e09db95f05eaa558ee621954be53 1355958 utils optional dpkg-dev_1.16.15_all.deb
 b098ae11ce598105b700dbba5613f781 957964 perl optional libdpkg-perl_1.16.15_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBCAAGBQJTkN8dAAoJELlyvz6krlejp14P/iqmUqt7Kk2B4AxPaOEONHkY
Pe9lT/72tUfvWq1q3Xws2RH7kyf9EgbXPtzljkD+mwEq3pVstSfhgzbmgbafRpti
kxDRrgRx2szQDW5YwKQtoDjpcnoaNg+2XXTFW/bZ2BQ1tWkIEyTacdhKhECenU2G
xw9/jQAvLClex9G1AE09LtyBR50IJVL2yPgCSUUu6stzVMcJPt8Zr9wGXDlc0Bq8
CwNA6wjNQOZQNsAFKAwIgRNKRDjGbCaqGJkTIJzw5kzoHMoR4SBKclHfVbC24nBg
VYEEdkj1E4/kYuNcYrCW3iJP5PuQKTfsu21IowORf1htN4T+07mPBZ/Gy90j0OfS
6oGMPfzzrntEBjSKuz4n50f8pwUHMYNxzTyVSb/XaBWPMeasrZs85sc8si11VvMa
LnxAyV9pCXXhKW9zqoojtsOLcz6cm/ypk1Pua9UaEsy+317Cv76fhqWJFpvzHFRV
52UtjxNRwojFtPUnloJ4HXIVe227hZ8JhRWxL8ottOpVYlphCHAzv7n8hIFMv/c8
ZVvZitX2dQBMrFBoMNbFI5YTjIQ7rACSjpZsHQdY4A9BDjsrNZBNW4bD9e1O20wi
vHM6wXi6ujzBjQ/POAYu1fdBb514R4ihFrG2iUvPF6EKaJAEJAgU+rY9PuiiA2Vw
wK84p9QsUKk8IOMJo7Vq
=HssJ
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Guillem Jover <guillem@debian.org>`:

You have taken responsibility.
(Tue, 17 Jun 2014 12:51:15 GMT) ([full text](bugreport.cgi?bug=746498;msg=71), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=71), [link](#70)).

---

**Notification sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug acknowledged by developer.
(Tue, 17 Jun 2014 12:51:15 GMT) ([full text](bugreport.cgi?bug=746498;msg=73), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=73), [link](#72)).

---

[Message #74](#74) received at 746498-close@bugs.debian.org ([full text](bugreport.cgi?bug=746498;msg=74), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=74), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746498-close@bugs.debian.org
Subject: Bug#746498: fixed in dpkg 1.15.11
Date: Tue, 17 Jun 2014 12:49:29 +0000
```
Source: dpkg
Source-Version: 1.15.11

We believe that the bug you reported is fixed in the latest version of
dpkg, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 746498@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover <guillem@debian.org> (supplier of updated dpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 05 Jun 2014 22:52:45 +0200
Source: dpkg
Binary: libdpkg-dev dpkg dpkg-dev libdpkg-perl dselect
Architecture: source amd64 all
Version: 1.15.11
Distribution: squeeze-security
Urgency: high
Maintainer: Dpkg Developers <debian-dpkg@lists.debian.org>
Changed-By: Guillem Jover <guillem@debian.org>
Description:
 dpkg       - Debian package management system
 dpkg-dev   - Debian package development tools
 dselect    - Debian package management front-end
 libdpkg-dev - Debian package management static library
 libdpkg-perl - Dpkg perl modules
Closes: [746498](bugreport.cgi?bug=746498) [749183](bugreport.cgi?bug=749183)
Changes:
 dpkg (1.15.11) squeeze-security; urgency=high
 .
   [ Guillem Jover ]
   * Test suite:
     - Add test cases for Dpkg::Source::Patch [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471) and [CVE-2014-3127](https://security-tracker.debian.org/tracker/CVE-2014-3127).
     - Add test case for patch disabling hunks; not security sensitive.
   * Correctly parse patch headers in Dpkg::Source::Patch, to avoid directory
     traversal attempts from hostile source packages when unpacking them.
     Reported by Javier Serrano Polo <javier@jasp.net> as an unspecified
     directory traversal; meanwhile also independently found by me both
     #749183 and what was supposed to be #746498, which was later on published
     and ended up being just a subset of the other non-reported issue.
     Fixes [CVE-2014-3864](https://security-tracker.debian.org/tracker/CVE-2014-3864) and [CVE-2014-3865](https://security-tracker.debian.org/tracker/CVE-2014-3865). Closes: #[746498](bugreport.cgi?bug=746498), #[749183](bugreport.cgi?bug=749183)
Checksums-Sha1:
 4426c4d44a6c6c7c8eb21ad6e149d4b8bc71ec0e 1844 dpkg_1.15.11.dsc
 0d562e96d4df9592a8b96bfc76b19be91e88beee 5269052 dpkg_1.15.11.tar.bz2
 641c051ee3adebdd4a76222b0a9b0d59fc2d950d 440340 libdpkg-dev_1.15.11_amd64.deb
 095bd30806da1bad9e231c3910ac13430e2d7728 2401838 dpkg_1.15.11_amd64.deb
 52ea8293218b9a00764a2517eb1d62da1dfccb85 908748 dselect_1.15.11_amd64.deb
 1c3b37c6157816a79674fcab8323d929bbeee11d 815412 dpkg-dev_1.15.11_all.deb
 71dfa4767c572e62d041c6ab3cf5f0c86571a030 697686 libdpkg-perl_1.15.11_all.deb
Checksums-Sha256:
 207f68ed5ef4888e26f1918c84a3400fa32fd09ad098600ff7b4b9e6d8398c63 1844 dpkg_1.15.11.dsc
 7db2e5e23147e4159d95345dce420236a4af2c0ecff0a38dadee35160bb6f739 5269052 dpkg_1.15.11.tar.bz2
 9b9f1eb8f2536e8be4d4a9157f6262dff4f277285de1c25dc34fa2bc2df4cf72 440340 libdpkg-dev_1.15.11_amd64.deb
 b8921f46999dee2a1c48e08daf45d704de9951dff2879afabd458b341c402ed2 2401838 dpkg_1.15.11_amd64.deb
 0fd10aee9a03794e82530793b2ba71ff1b634b077d1d2475b259364a5debcb5b 908748 dselect_1.15.11_amd64.deb
 e0a6b0b3a506e5c48c7dfa5d439e645ad0416980c3c28f2c70ae4bdd3d8374e6 815412 dpkg-dev_1.15.11_all.deb
 afa97dfcddbf8a0856701622159a4711a8d471f9cacd9e0de1ba44b91ef0eba6 697686 libdpkg-perl_1.15.11_all.deb
Files:
 ed3eaf21406b5cf68c7e497dad16b8d7 1844 admin required dpkg_1.15.11.dsc
 92f54904ddc5b63f01308d181d8fcdf4 5269052 admin required dpkg_1.15.11.tar.bz2
 49bd29615ce3eb1cfc9409d601770cad 440340 libdevel optional libdpkg-dev_1.15.11_amd64.deb
 790ecea2ea1793a396df0ad254f00df0 2401838 admin required dpkg_1.15.11_amd64.deb
 2548575c77fced8d6ef1dd5f78871a4d 908748 admin optional dselect_1.15.11_amd64.deb
 68c22adf6501b43523510c606a0366f4 815412 utils optional dpkg-dev_1.15.11_all.deb
 5569fd703e0c43f304b232108e4de210 697686 perl optional libdpkg-perl_1.15.11_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBCAAGBQJTkN8sAAoJELlyvz6krlejZ0AP/RrUH5XmCbk3LVFpJsR7Gpx3
q6kUkzTisedFG0bgHsGeOxTljSVjgdCVKJ1gD8a+rVKMxNxyPTg6eWxw/Aium6wJ
H8u5qyLC+ZrCiBvKF3Bb0TsaiKCzc3yihd6/Z7mbLaSetC9K2MUnybnm5ESJlnmy
0HzOH3YerDvkMY4RCJyl/Z7j0VR+dX+EnD2cJrg8ivAHxoldaUPHxUaZzGRz33b5
V5J+r+o9OrXr9R7LnKbaMTQqBTj5Y169k4ZBFL00aaUiNZ4Q8HbMYDosPRn+mbdf
lrbzhHgThOlemK8hKV1yR6NexsUxuGiX/fbIRu2MYAfiaXjkmVoOiI6bBlJ3HwH+
GvTTbQnB7Gjhj0Guh50eoxankAZDVaxDY9a8q/jCMqPDRxCj0ZT46cma+27R81Ve
SRR5F79FU7J6h1uKspG8hHtUpep7zcrlxy2cW/TNcuiwfEv/aezW3zGqyMpwHG+X
Go6nDSI6p6L5y9EphSR3aNQDwjAvmBZhJF4Lj1AdSKy7tg/z+9Ahqu0U71cXmnfz
mr+xB7hf0AToNK1EB6ir/vZke/X2WY9/Qgl/gnqXyMkCCgS8MJkIBtaRCdQn34Db
BH3N3chFDejUn532mjrDnQFFXVTtDJ84xJMI+CVFg2YwCKwCHABK9ADz4d6eq0X/
YOQfC0pitPinsMz6Sx+5
=tDcj
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 16 Jul 2014 07:35:34 GMT) ([full text](bugreport.cgi?bug=746498;msg=76), [mbox](bugreport.cgi?bug=746498;mbox=yes;msg=76), [link](#75)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=746498).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 17:32:16 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from openwall.com_282d35d5_20250124_173212.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](../../../2014/05/29/16) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1804246.Yr4AJFuk5I@eee>
Date: Sun, 25 May 2014 11:31:51 +0200
From: Raphael Geissert <geissert@...ian.org>
To: Open Source Security <oss-security@...ts.openwall.com>
Cc: guillem@...ian.org
Subject: CVE request: another path traversal in dpkg-source during unpack

Hi,

Another path traversal was discovered[1] in dpkg-source, related to the
unpacking of source packages with specially-crafted patches.
While waiting for the original reporter's PoC/more information, Guillem
Jover (dpkg maintainer) independently re-discovered the issue, and a second
one.
This second issue has now been publicly reported as [2] to ease the
assignment of CVE id(s) given the combination of private and not-very-
specific public information.

Both issues are independent of the version of the patch tool.

While figuring out whether one or two ids should be requested (at least from
our POV), it appears that we can say that [2] is a superset of [1] - this is
based on the minimal fixes needed to fix either vulnerability: the fix for [1]
does not fix [2], but the fix for [2] does fix [1].

Could a CVE id be assigned please?

CC'ing Guillem for any complimentary information.

Thanks in advance.

[1] <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746498>
[2] <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=749183>

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_dc6f4071_20250124_173212.html ===


---

[[Date Prev](msg00132.html)][[Date Next](msg00134.html)]
[[Thread Prev](msg00132.html)][[Thread Next](msg00134.html)]
[[Date Index](maillist.html#00133)]
[[Thread Index](threads.html#00133)]

# [SECURITY] [DSA 2953-1] dpkg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2953-1] dpkg security update
* *From*: Raphael Geissert <geissert@debian.org>
* *Date*: Sun, 08 Jun 2014 17:35 +0200
* *Message-id*: <[[ð]](/msgid-search/5979401.DTyDjGRya0%40eee)Â [5979401.DTyDjGRya0@eee](msg00133.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2953-1                   security@debian.org
<http://www.debian.org/security/>                          Raphael Geissert
June 08, 2014                          <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dpkg
CVE ID         : CVE-2014-3864 CVE-2014-3865
Debian Bug     : 746498 749183

Multiple vulnerabilities were discovered in dpkg that allow file
modification through path traversal when unpacking source packages with
especially-crafted patch files.

This update had been scheduled before the end of security support for
the oldstable distribution (squeeze), hence an exception has been made
and was released through the security archive. However, no further updates
should be expected.

For the oldstable distribution (squeeze), these problems have been fixed in
version 1.15.11.

For the stable distribution (wheezy), these problems have been fixed in
version 1.16.15.

For the testing distribution (jessie), these problems will be fixed
soon.

For the unstable distribution (sid), these problems have been fixed in
version 1.17.10.

We recommend that you upgrade your dpkg packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iEYEARECAAYFAlOUgqkACgkQYy49rUbZzlq0jACfYeJXqy7AFEPAU4ESL4/W/cip
dpgAoJKIueWtitU4R0V6hKUfOrsmnOMj
=ThZI
-----END PGP SIGNATURE-----

```

---


