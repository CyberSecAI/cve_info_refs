=== Content from www.mandriva.com_882a8d89_20250124_193709.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from secunia.com_c5d55d85_20250124_193707.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from bugs.mageia.org_d0d3aca4_20250126_030645.html ===


Mageia Bugzilla – Bug 13653
dbus new security issues CVE-2014-3532 and CVE-2014-3533
Last modified: 2014-07-26 13:49:35 CEST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=13653&GoAheadAndLogIn=1)

  [x]
* |
  [New Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug 13653**](show_bug.cgi?id=13653)
- dbus new security issues CVE-2014-3532 and CVE-2014-3533

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
dbus new security issues CVE-2014-3532 and CVE-2014-3533

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): major | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sec team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/604236/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | MGA3TOO has\_procedure advisory mga4-6... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | validated\_update | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-07-02 18:16 CEST by David Walser | | --- | --- | | Modified: | 2014-07-26 13:49 CEST ([History](show_activity.cgi?id=13653)) | | CC List: | 6 users (show)  fundawang geiger.david68210 mageia simonnzg sysadmin-bugs tmb | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | dbus-1.6.20-1.mga5.src.rpm | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=13653&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=13653#c0)  David Walser    2014-07-02 18:16:52 CEST  ``` Two security issues in dbus were announced today (July 2): <http://openwall.com/lists/oss-security/2014/07/02/4>  The issues are fixed in 1.6.22.  Patches and details are in the message above.  Mageia 3 and Mageia 4 are also affected.  Reproducible:   Steps to Reproduce: ```  David Walser    2014-07-02 18:17:18 CEST   CC: (none) => fundawang, mageia, tmbWhiteboard: (none) => MGA4TOO, MGA3TOO  [Comment 1](show_bug.cgi?id=13653#c1)  David Walser    2014-07-03 16:36:57 CEST  ``` Debian has issued an advisory for this on July 2: <https://www.debian.org/security/2014/dsa-2971> ```  ---   URL: (none) => http://lwn.net/Vulnerabilities/604236/  [Comment 2](show_bug.cgi?id=13653#c2)  David Walser    2014-07-09 01:38:50 CEST  ``` Updated package uploaded for Cauldron.  Patched packages uploaded for Mageia 3 and Mageia 4.  Advisory: ========================  Updated dbus packages fix security vulnerabilities:  A flaw was reported in D-Bus's file descriptor passing feature. A local attacker could use this flaw to cause a service or application to disconnect from the bus, typically resulting in that service or application exiting (CVE-2014-3532).  A flaw was reported in D-Bus's file descriptor passing feature. A local attacker could use this flaw to cause an invalid file descriptor to be forwarded to a service or application, causing it to disconnect from the bus, typically resulting in that service or application exiting (CVE-2014-3533).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3532> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3533> <http://lists.freedesktop.org/archives/dbus/2014-July/016235.html> <https://lists.fedoraproject.org/pipermail/package-announce/2014-July/135226.html> ========================  Updated packages in core/updates_testing: ======================== dbus-1.6.8-4.4.mga3 libdbus1_3-1.6.8-4.4.mga3 libdbus-devel-1.6.8-4.4.mga3 dbus-x11-1.6.8-4.4.mga3 dbus-doc-1.6.8-4.4.mga3 dbus-1.6.18-1.3.mga4 libdbus1_3-1.6.18-1.3.mga4 libdbus-devel-1.6.18-1.3.mga4 dbus-x11-1.6.18-1.3.mga4 dbus-doc-1.6.18-1.3.mga4  from SRPMS: dbus-1.6.8-4.4.mga3.src.rpm dbus-1.6.18-1.3.mga4.src.rpm ```  ---   Version: Cauldron => 4Whiteboard: MGA4TOO, MGA3TOO => MGA3TOOSeverity: normal => major  [Comment 3](show_bug.cgi?id=13653#c3)  David Walser    2014-07-09 01:40:16 CEST  ``` Oops, forgot to assign to QA.  Updated package uploaded for Cauldron.  Patched packages uploaded for Mageia 3 and Mageia 4.  Advisory: ========================  Updated dbus packages fix security vulnerabilities:  A flaw was reported in D-Bus's file descriptor passing feature. A local attacker could use this flaw to cause a service or application to disconnect from the bus, typically resulting in that service or application exiting (CVE-2014-3532).  A flaw was reported in D-Bus's file descriptor passing feature. A local attacker could use this flaw to cause an invalid file descriptor to be forwarded to a service or application, causing it to disconnect from the bus, typically resulting in that service or application exiting (CVE-2014-3533).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3532> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3533> <http://lists.freedesktop.org/archives/dbus/2014-July/016235.html> <https://lists.fedoraproject.org/pipermail/package-announce/2014-July/135226.html> ========================  Updated packages in core/updates_testing: ======================== dbus-1.6.8-4.4.mga3 libdbus1_3-1.6.8-4.4.mga3 libdbus-devel-1.6.8-4.4.mga3 dbus-x11-1.6.8-4.4.mga3 dbus-doc-1.6.8-4.4.mga3 dbus-1.6.18-1.3.mga4 libdbus1_3-1.6.18-1.3.mga4 libdbus-devel-1.6.18-1.3.mga4 dbus-x11-1.6.18-1.3.mga4 dbus-doc-1.6.18-1.3.mga4  from SRPMS: dbus-1.6.8-4.4.mga3.src.rpm dbus-1.6.18-1.3.mga4.src.rpm ```  ---   Assignee: bugsquad => qa-bugs  [Comment 4](show_bug.cgi?id=13653#c4)  claire robinson    2014-07-09 15:06:41 CEST  ``` Testing mga4 64  No PoC's that I can find, embargoed still on rhbz it seems. Just ensuring that everything is normal after a reboot, all services started etc. ```  [Comment 5](show_bug.cgi?id=13653#c5)  claire robinson    2014-07-09 16:50:31 CEST  ``` Testing complete mga4 64.  # systemctl status dbus.service  dbus.service - D-Bus System Message Bus    Loaded: loaded (/usr/lib/systemd/system/dbus.service; static)    Active: active (running) since Wed 2014-07-09 14:08:17 BST; 1h 40min ago   No regressions noticed in use. ```  ---   Whiteboard: MGA3TOO => MGA3TOO has\_procedure mga4-64-ok  [Comment 6](show_bug.cgi?id=13653#c6)  Simon Parsons    2014-07-10 15:07:48 CEST  ``` Testing MGA4x64 No obvious problems. ```  ---   CC: (none) => gm4nzg  [Comment 7](show_bug.cgi?id=13653#c7)  David GEIGER    2014-07-10 15:43:45 CEST  ``` Tested mag4_32,  Testing complete for the new dbus-1.6.8-1.3.mga4 update, Ok for me and all services seems to work properly.  $ systemctl status dbus.service dbus.service - D-Bus System Message Bus    Loaded: loaded (/usr/lib/systemd/system/dbus.service; static)    Active: active (running) since jeu. 2014-07-10 15:08:55 CEST; 33min ago  Main PID: 751 (dbus-daemon)    CGroup: /system.slice/dbus.service            ââ751 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile ...   No regressions found. ```  ---   CC: (none) => geiger.david68210  [Comment 8](show_bug.cgi?id=13653#c8)  David GEIGER    2014-07-10 15:47:00 CEST  ``` Tested mag3_32 & mga3_64,  Testing complete for the new dbus-1.6.8-4.4.mga3 update, Ok for me and all services seems to work properly.  $ systemctl status dbus.service dbus.service - D-Bus System Message Bus           Loaded: loaded (/usr/lib/systemd/system/dbus.service; static)           Active: active (running) since Thu, 2014-07-10 15:17:42 CEST; 26min ago         Main PID: 1159 (dbus-daemon)           CGroup: name=systemd:/system/dbus.service                   â 1159 /usr/bin/dbus-daemon --system --address=systemd: -...                   â 6378 /usr/libexec/packagekitd  No regressions found here too. ```  [Comment 9](show_bug.cgi?id=13653#c9)  David Walser    2014-07-10 15:49:07 CEST  ``` I added the OK tags per David's tests.  If dbus is broken it'd be fairly obvious, so this testing should suffice.  This can be validated. ```  ---   Whiteboard: MGA3TOO has\_procedure mga4-64-ok => MGA3TOO has\_procedure mga4-64-ok mga4-32-ok mga3-64-ok mga3-32-ok  [Comment 10](show_bug.cgi?id=13653#c10)  claire robinson    2014-07-10 17:15:41 CEST  ``` Validating. Advisory uploaded.  Could sysadmin please push to 3 & 4 updates  Thanks ```  ---   Keywords: (none) => validated\_updateWhiteboard: MGA3TOO has\_procedure mga4-64-ok mga4-32-ok mga3-64-ok mga3-32-ok => MGA3TOO has\_procedure advisory mga4-64-ok mga4-32-ok mga3-64-ok mga3-32-okCC: (none) => sysadmin-bugs  [Comment 11](show_bug.cgi?id=13653#c11)  Colin Guthrie    2014-07-26 13:49:35 CEST  ``` Update pushed.  <http://advisories.mageia.org/MGASA-2014-0294.html> ```  ---   Status: NEW => RESOLVEDResolution: (none) => FIXED |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=13653&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=13653)
* - [XML](show_bug.cgi?ctype=xml&id=13653)
* - [Clone ThisBug](enter_bug.cgi?cloned_bug_id=13653&normal=1)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=13653&GoAheadAndLogIn=1)

    [x]
  + |
    [New Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)



=== Content from www.debian.org_ad02d9cc_20250124_193708.html ===


---

[[Date Prev](msg00151.html)][[Date Next](msg00153.html)]
[[Thread Prev](msg00151.html)][[Thread Next](msg00153.html)]
[[Date Index](maillist.html#00152)]
[[Thread Index](threads.html#00152)]

# [SECURITY] [DSA 2971-1] dbus security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2971-1] dbus security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Wed, 02 Jul 2014 18:40:42 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1X2PSU-0000Pb-8B%40master.debian.org) [E1X2PSU-0000Pb-8B@master.debian.org](msg00152.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2971-1                   security@debian.org
<http://www.debian.org/security/>                      Salvatore Bonaccorso
July 02, 2014                          <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dbus
CVE ID         : CVE-2014-3477 CVE-2014-3532 CVE-2014-3533

Several vulnerabilities have been discovered in dbus, an asynchronous
inter-process communication system. The Common Vulnerabilities and
Exposures project identifies the following problems:

CVE-2014-3477

    Alban Crequy at Collabora Ltd. discovered that dbus-daemon sends an
    AccessDenied error to the service instead of a client when the
    client is prohibited from accessing the service. A local attacker
    could use this flaw to cause a bus-activated service that is not
    currently running to attempt to start, and fail, denying other users
    access to this service.

CVE-2014-3532

    Alban Crequy at Collabora Ltd. discovered a bug in dbus-daemon's
    support for file descriptor passing. A malicious process could force
    system services or user applications to be disconnected from the
    D-Bus system by sending them a message containing a file descriptor,
    leading to a denial of service.

CVE-2014-3533

    Alban Crequy at Collabora Ltd. and Alejandro Martinez Suarez
    discovered that a malicious process could force services to be
    disconnected from the D-Bus system by causing dbus-daemon to attempt
    to forward invalid file descriptors to a victim process, leading to
    a denial of service.

For the stable distribution (wheezy), these problems have been fixed in
version 1.6.8-1+deb7u3.

For the unstable distribution (sid), these problems have been fixed in
version 1.8.6-1.

We recommend that you upgrade your dbus packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJTtE2UAAoJEAVMuPMTQ89EH/QQAJlApEGPFhqUnkoH12Qwpluy
f0tzw9luGd6GbXVm3IR8pBOjZgtC2ZGBUlmE1yN0qvcuuhOM0RTf3VICJ4vStyKp
2xUlmjv32y8G0KCBs0ckk0kNDApa7TNufbuuBa1EFI3BIe6V0TnEyr9oXaKicvuV
PCUlaM81h13zDw1x2KfHsMWlJyr8uoM6PLlgicdRvtEJ88URBC9ZIieYXdK8rpsY
rBiuE9575AxEPtAXV0FUSF371zKXg+ZR3zV4EocrI9liMPigIwrIoqhCTWXfJ0WH
0iLlhG41SLDNiBG/Hw0vlw8kX9/X+dlHQTRYV+qzSYfiBu4wfk/KRaAR0nPdmt+H
ik28WCE5B7zyc7KImAgiruYIl9nfiVcJlJVCPav48x8Cij0+zf3tzYdI3Lo4jQTH
/cSCXWs47U0Lsj0xMc8vrhRJq2NDybTJiAzeY929snNR5EBfBwmm9GoZfOlfkIPx
yPn/TTX3u8N3SFcys0w9zHpL1lrdqZ8pJGTqErA+WlzcFLKMjGArpY1PxdJD8mAE
DLkHWz7yY48WfkaDxfc0iscVqKUPzHsPPVedY31wDCKQjJR36lIkTmyOzKyBoKa1
AyYNQVTKGoxkRsxL/riD57/MprpTqFFHAtDGTw1o3ORZpXbqHnLY5A0QaZPCs3M9
l6ellinwf6MDWjEZ7CPj
=gIUw
-----END PGP SIGNATURE-----

```

---



=== Content from lists.opensuse.org_407bde4d_20250124_193706.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

# openSUSE-SU-2014:1239-1: moderate: dbus-1: update to 1.6.24

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

28 Sep
2014

28 Sep
'14

10:09

openSUSE Security Update: dbus-1: update to 1.6.24
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:1239-1
Rating: moderate
References: #896453
Cross-References: CVE-2014-3635 CVE-2014-3636 CVE-2014-3637
CVE-2014-3638 CVE-2014-3639
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 5 vulnerabilities is now available.
Description:
The DBUS-1 service and libraries were updated to upstream release 1.6.24
fixing security issues and bugs.
Upstream changes since dbus 1.6.8
+ Security fixes
- Do not accept an extra fd in the padding of a cmsg message, which
could lead to a 4-byte heap buffer overrun. (CVE-2014-3635,
fdo#83622; Simon McVittie)
- Reduce default for maximum Unix file descriptors passed per message
from 1024 to 16, preventing a uid with the default maximum number of
connections from exhausting the system bus' file descriptors under
Linux's default rlimit. Distributors or system administrators with a
more restrictive fd limit may wish to reduce these limits further.
Additionally, on Linux this prevents a second denial of service in
which the dbus-daemon can be made to exceed the maximum number of
fds per sendmsg() and disconnect the process that would have
received them. (CVE-2014-3636, fdo#82820; Alban Crequy)
- Disconnect connections that still have a fd pending unmarshalling
after a new configurable limit, pending\_fd\_timeout (defaulting to
150 seconds), removing the possibility of creating an abusive
connection that cannot be disconnected by setting up a circular
reference to a connection's file descriptor. (CVE-2014-3637,
fdo#80559; Alban Crequy)
- Reduce default for maximum pending replies per connection from 8192
to 128, mitigating an algorithmic complexity denial-of-service
attack (CVE-2014-3638, fdo#81053; Alban Crequy)
- Reduce default for authentication timeout on the system bus from 30
seconds to 5 seconds, avoiding denial of service by using up all
unauthenticated connection slots; and when all unauthenticated
connection slots are used up, make new connection attempts block
instead of disconnecting them. (CVE-2014-3639, fdo#80919; Alban
Crequy)
- On Linux >= 2.6.37-rc4, if sendmsg() fails with ETOOMANYREFS,
silently drop the message. This prevents an attack in which a
malicious client can make dbus-daemon disconnect a system service,
which is a local denial of service. (fdo#80163, CVE-2014-3532; Alban
Crequy)
- Track remaining Unix file descriptors correctly when more than one
message in quick succession contains fds. This prevents another
attack which a malicious client can make dbus-daemon disconnect a
system service. (fdo#79694, fdo#80469, CVE-2014-3533; Alejandro
Martínez Suárez, Simon McVittie, Alban Crequy)
- Alban Crequy at Collabora Ltd. discovered and fixed a
denial-of-service flaw in dbus-daemon, part of the reference
implementation of D-Bus. Additionally, in highly unusual
environments the same flaw could lead to a side channel between
processes that should not be able to communicate. (CVE-2014-3477,
fdo#78979)
- CVE-2013-2168: Fix misuse of va\_list that could be used as a denial
of service for system services. Vulnerability reported by Alexandru
Cornea. (Simon)
+ Other fixes
- Don't leak memory on out-of-memory while listing activatable or
active services (fdo#71526, Radoslaw Pajak)
- fix undefined behaviour in a regression test (fdo#69924, DreamNik)
- path\_namespace='/' in match rules incorrectly matched nothing; it
now matches everything. (fdo#70799, Simon McVittie)
- Make dbus\_connection\_set\_route\_peer\_messages(x, FALSE) behave as
documented. Previously, it assumed its second parameter was TRUE.
(fdo#69165, Chengwei Yang)
- Fix a NULL pointer dereference on an unlikely error path (fdo#69327,
Sviatoslav Chagaev)
- If accept4() fails with EINVAL, as it can on older Linux kernels
with newer glibc, try accept() instead of going into a busy-loop.
(fdo#69026, Chengwei Yang)
- If socket() or socketpair() fails with EINVAL or EPROTOTYPE, for
instance on Hurd or older Linux with a new glibc, try without
SOCK\_CLOEXEC. (fdo#69073; Pino Toscano, Chengwei Yang)
- Fix a file descriptor leak on an error code path. (fdo#69182,
Sviatoslav Chagaev)
- Fix compilation if writev() is unavailable (fdo#69409, Vasiliy
Balyasnyy)
- Avoid an infinite busy-loop if a signal interrupts waitpid()
(fdo#68945, Simon McVittie)
- Escape addresses containing non-ASCII characters correctly
(fdo#53499, Chengwei Yang)
- If malloc() returns NULL in \_dbus\_string\_init() or similar, don't
free an invalid pointer if the string is later freed (fdo#65959,
Chengwei Yang)
- If malloc() returns NULL in dbus\_set\_error(), don't va\_end() a
va\_list that was never va\_start()ed (fdo#66300, Chengwei Yang)
- Fix a regression test on platforms with strict alignment (fdo#67279,
Colin Walters)
- Avoid calling function parameters "interface" since certain Windows
headers have a namespace-polluting macro of that name (fdo#66493,
Ivan Romanov)
- Make "make -j check" work (fdo#68852, Simon McVittie)
- In dbus-daemon, don't crash if a .service file starts with key=value
(fdo#60853, Chengwei Yang)
- Fix an assertion failure if we try to activate systemd services
before systemd connects to the bus (fdo#50199, Chengwei Yang)
- Avoid compiler warnings for ignoring the return from write()
(Chengwei Yang)
- Following Unicode Corrigendum #9, the noncharacters U+nFFFE,
U+nFFFF, U+FDD0..U+FDEF are allowed in UTF-8 strings again.
(fdo#63072, Simon McVittie)
- Diagnose incorrect use of dbus\_connection\_get\_data() with negative
slot (i.e. before allocating the slot) rather than returning junk
(fdo#63127, Dan Williams)
- In the activation helper, when compiled for tests, do not reset the
system bus address, fixing the regression tests. (fdo#52202, Simon)
- Fix building with Valgrind 3.8, at the cost of causing harmless
warnings with Valgrind 3.6 on some compilers (fdo#55932, Arun
Raghavan)
- Don't leak temporary fds pointing to /dev/null (fdo#56927, Michel
HERMIER)
- Create session.d, system.d directories under CMake (fdo#41319, Ralf
Habacker)
- Include alloca.h for alloca() if available, fixing compilation on
Solaris 10 (fdo#63071, Dagobert Michelsen)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2014-557
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
dbus-1-1.6.24-2.26.1
dbus-1-debuginfo-1.6.24-2.26.1
dbus-1-debugsource-1.6.24-2.26.1
dbus-1-devel-1.6.24-2.26.1
dbus-1-x11-1.6.24-2.26.1
dbus-1-x11-debuginfo-1.6.24-2.26.1
dbus-1-x11-debugsource-1.6.24-2.26.1
libdbus-1-3-1.6.24-2.26.1
libdbus-1-3-debuginfo-1.6.24-2.26.1
- openSUSE 12.3 (x86\_64):
dbus-1-32bit-1.6.24-2.26.1
dbus-1-debuginfo-32bit-1.6.24-2.26.1
dbus-1-devel-32bit-1.6.24-2.26.1
libdbus-1-3-32bit-1.6.24-2.26.1
libdbus-1-3-debuginfo-32bit-1.6.24-2.26.1
- openSUSE 12.3 (noarch):
dbus-1-devel-doc-1.6.24-2.26.1
References:
<http://support.novell.com/security/cve/CVE-2014-3635.html>
<http://support.novell.com/security/cve/CVE-2014-3636.html>
<http://support.novell.com/security/cve/CVE-2014-3637.html>
<http://support.novell.com/security/cve/CVE-2014-3638.html>
<http://support.novell.com/security/cve/CVE-2014-3639.html>
<https://bugzilla.suse.com/show_bug.cgi?id=896453>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugs.freedesktop.org_b6549812_20250124_193711.html ===


Bugzilla – Bug 80163
CVE-2014-3532: kick any connection off the bus with fdpassing: denial of service
Last modified: 2014-07-02 16:12:43 UTC

* [Home](./)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

[**Bug 80163**](show_bug.cgi?id=80163)
- CVE-2014-3532: kick any connection off the bus with fdpassing: denial of service

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-3532: kick any connection off the bus with fdpassing: denial of service

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | dbus | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=dbus "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | core ([show other bugs](buglist.cgi?component=core&product=dbus&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Linux (All) | |  | | | [Importance](page.cgi?id=fields.html#importance): | medium normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Simon McVittie | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sjoerd Simons | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [80817](show_bug.cgi?id=80817 "RESOLVED MOVED - followup for CVE-2014-3532: messages with abusive recursion are silently dropped") | |  | Show dependency [tree](showdependencytree.cgi?id=80163&hide_resolved=1) / [graph](showdependencygraph.cgi?id=80163) | |  | | Reported: | 2014-06-17 20:17 UTC by Alban Crequy | | --- | --- | | Modified: | 2014-07-02 16:12 UTC ([History](show_activity.cgi?id=80163)) | | CC List: | 4 users (show)  kay lennart thiago walters | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [i915 platform:](page.cgi?id=fields.html#cf_i915_platform "Intel platforms affected by the bug") |  | | [i915 features:](page.cgi?id=fields.html#cf_i915_features "Features of the i915 driver affected by the bug.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**dbus-dos-recursive-fdpass.jpg**](attachment.cgi?id=101289 "View the content of the attachment") (125.81 KB, image/jpeg)  [2014-06-18 09:27 UTC](#attach_101289 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=101289&action=edit) | | [**[PATCH] Handle ETOOMANYREFS**](attachment.cgi?id=101748 "View the content of the attachment") (12.76 KB, patch)  [2014-06-25 14:20 UTC](#attach_101748 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=101748&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80163&attachment=101748) | | [**[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM\_RIGHTS)**](attachment.cgi?id=101754 "View the content of the attachment") (4.04 KB, patch)  [2014-06-25 17:51 UTC](#attach_101754 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=101754&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80163&attachment=101754) | | [**[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM\_RIGHTS)**](attachment.cgi?id=101811 "View the content of the attachment") (4.17 KB, patch)  [2014-06-26 15:40 UTC](#attach_101811 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=101811&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80163&attachment=101811) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=80163&action=viewall&hide_obsolete=1) | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=80163#c0)  Alban Crequy    2014-06-17 20:17:23 UTC  ``` Since Linux commit 25888e (from 2.6.37-rc4, Nov 2010), sendmsg() on Unix sockets returns -1 errno=ETOOMANYREFS ("Too many references: cannot splice") when the passfd mechanism (SCM_RIGHTS) is "abusively" used recursively by applications:  >    commit 25888e30319f8896fc656fc68643e6a078263060 >    Author: Eric Dumazet <eric.dumazet@gmail.com> >    Date:   Thu Nov 25 04:11:39 2010 +0000  An original fd can be inserted in the ancillary data of a message. While that message is waiting in the socket queue of the other end, the fd of the other end can itself be inserted in the ancillary data of another message. This commit considers that doing that recursively more than 4 times is abusive: #define MAX_RECURSION_LEVEL 4  This is to avoid eating all the kernel memory and internal file descriptors in the kernel: the memory used by the socket queue are not part of processes' memory and cannot be limited by ulimit / cgroups.  The kernel does not have an API to check whether a file descriptor is used recursively as described. Therefore dbus-daemon has no way to check whether a received fd will trigger a ETOOMANYREFS when forwarding the D-Bus message to recipients. Moreover, the ability to forward the file descriptor changes asynchronously when other processes append messages on the fd's delivery queue.  dbus-daemon does not handle ETOOMANYREFS: only EINTR is checked by dbus/dbus-sysdeps-unix.c:_dbus_write_socket_with_unix_fds_two():  >   bytes_written = sendmsg (fd, &m, 0 > #if HAVE_DECL_MSG_NOSIGNAL >                            |MSG_NOSIGNAL > #endif >                            ); >  >   if (bytes_written < 0 && errno == EINTR) >     goto again; > [...] >   return bytes_written;  This causes the caller to handle ETOOMANYREFS the same way as EPIPE. Then, dbus-daemon believes that the socket was closed and closes its end of the socket.  I wrote a program 'e' to demonstrate the security issue: $ ./e org.pulseaudio.Server  It causes dbus-daemon to disconnect whoever owns that D-Bus name. Since D-Bus libraries terminate programs when their D-Bus socket is closed, 'e' can kill any target programs on the bus.  I can send 'e' to D-Bus maintainers by private email in order to test fixes.  Mitigation 1: if 'e' is not allowed to send a D-Bus message to the target due to SCMs or due to the D-Bus policy, then 'e' will not be able to kill the target.  Mitigation 2: Linux kernels older than 2.6.37-rc4 are not affected. ```  [Comment 1](show_bug.cgi?id=80163#c1)  Thiago Macieira    2014-06-17 21:09:54 UTC  ``` I'm not sure I understand what the problem is. Is someone trying to pass the file descriptor of the D-Bus connection itself? ```  [Comment 2](show_bug.cgi?id=80163#c2)  Alban Crequy    2014-06-18 09:27:34 UTC  ``` Created [attachment 101289](attachment.cgi?id=101289 "dbus-dos-recursive-fdpass.jpg") [[details]](attachment.cgi?id=101289&action=edit "dbus-dos-recursive-fdpass.jpg") dbus-dos-recursive-fdpass.jpg  (In reply to [comment #1](show_bug.cgi?id=80163#c1)) > I'm not sure I understand what the problem is. Is someone trying to pass the > file descriptor of the D-Bus connection itself?  No, fds of D-Bus connections are not passed around. I am attaching a schema to show this.  The malicious program creates 5 socket pairs with socketpair(2): (fd1, fd2), (fd3, fd4), (fd5, fd6), (fd7, fd8), (fd9, fd10)  The kernel initializes all unix_sk(sk)->recursion_level to 0.  And it passes fds around in this way: - A packet containing fd2 is sent through fd3 to reach fd4's delivery queue   (fd4's recursion level is 1) - A packet containing fd4 is sent through fd5 to reach fd6's delivery queue   (fd6's recursion level is 2) - A packet containing fd6 is sent through fd7 to reach fd8's delivery queue   (fd8's recursion level is 3) - A packet containing fd8 is sent through fd9 to reach fd10's delivery queue   (fd10's recursion level is MAX_RECURSION_LEVEL=4 so it cannot be passed)  So far, D-Bus socket fd11 was not involved. Then: - A D-Bus message containing fd8 is sent through D-Bus socket fd11 to reach   fd12's delivery queue in the dbus-daemon process. - dbus-daemon receives the message and fd8. fd8's recursion level is still 3,   so it could forward it to another D-Bus client. Unfortunately, fd8's   recursion level can change at any time, because the malicious program still   has a copy of fd8. - The malicious program now sends a packet containing fd8 through fd7 to   reach fd8's delivery queue. fd8's recursion level is now   MAX_RECURSION_LEVEL=4 and fd8 cannot be passed anymore. - dbus-daemon is scheduled and tries to forward the D-Bus message containing   fd8 through fd13 for another client. It fails with ETOOMANYREFS. - dbus-daemon close(fd13) - another_client is notified on fd14 that the D-Bus connection is shutdown and   it terminates. The malicious program managed to kill another_client in this   way. ```  [Comment 3](show_bug.cgi?id=80163#c3)  Simon McVittie    2014-06-18 10:54:44 UTC  ``` While we're looking at file descriptor passing, [Bug #79694](show_bug.cgi?id=79694 "RESOLVED FIXED - Misbehaviour reading a message with passing file descriptors (duplicate/missing fds)") is not a security vulnerability, but is fairly fundamental and only avoided being a buffer overflow by luck (one bug compensated for another) so it would be good to review + fix.  The obvious solution here is to catch ETOOMANYREFS. Unfortunately, by the time we start calling sendmsg(), it's too late to refuse to forward the message, so the only thing we can do is to drop it on the floor (possibly with a best-effort notification back to the sender, but if the sender is doing this maliciously, they don't deserve for dbus-daemon to go to extra effort to notify them that they have failed).  It's unfortunate that we can't ask the kernel "is this OK to forward?" but that would be a TOCTOU (time of check / time of use) vulnerability in any case - as Alban points out, this attack only works if the malicious sender alters the recursion depth of the fd after dbus-daemon has already received it.  Catching ETOOMANYREFS in the same way as EINTR would not be correct: we'd busy-loop forever. EINTR is the thing that's special here: you can get it in otherwise normal operation.  The least bad solution I can think of is for do_writing() in dbus-transport-socket.c to distinguish between *three* categories of error:  * Those that are ignored: currently EAGAIN, EWOULDBLOCK, EPIPE  * Those that are fatal to the connection: currently the default for   unknown errno; ECONNRESET certainly needs to be in this category  * New category: those that cause the rest of this message to be skipped,   but do not disconnect the connection entirely:   ETOOMANYREFS  I suppose another possibility would be to re-send the message without the fd, and let the recipient deal with the missing fd; but that's only viable if major D-Bus implementations (libdbus, GDBus, systemd-bus) don't treat that as fatal.  I would welcome better ideas... ```  [Comment 4](show_bug.cgi?id=80163#c4)  Simon McVittie    2014-06-18 10:56:05 UTC  ``` Adding Lennart to Cc since iirc he wrote this stuff in the first place, so he might have ideas for how to solve it. ```  [Comment 5](show_bug.cgi?id=80163#c5)  Alban Crequy    2014-06-18 12:34:44 UTC  ``` (For completeness, another possibility would be to read things from the passed file descriptor to remove all packets from the delivery queue and to reduce the recursion depth to zero. dbus-daemon could check the content with recvfrom(MSG_PEEK) before removing them. But it would be intrusive for no good reason.)  I think dropping the message on the floor, with an error logged, and without notifying the sender is the best option.  I don't see any good reason to support more than 1 recursion depth in fd passing anyway. ```  [Comment 6](show_bug.cgi?id=80163#c6)  Thiago Macieira    2014-06-18 14:46:42 UTC  ``` (In reply to [comment #5](show_bug.cgi?id=80163#c5)) > I think dropping the message on the floor, with an error logged, and without > notifying the sender is the best option.  I actually think we should report an error if we can, since this might not be malicious at all.  > I don't see any good reason to support more than 1 recursion depth in fd > passing anyway.  That breaks abstractions. Sometimes, the level passing the fds doesn't know what the fds are. They may be other sockets that are doing work and happen to be passing file descriptors by themselves.  In any case, we can't detect 1 level any more than we can detect max-level. We can only try to pass and see what happens if we do.  For method calls, we should report the error back to the caller (if we can), if this isn't an eavasdropping delivery. For everything else, we drop the message and syslog an error. ```  [Comment 7](show_bug.cgi?id=80163#c7)  Simon McVittie    2014-06-18 16:32:13 UTC  ``` (In reply to [comment #6](show_bug.cgi?id=80163#c6)) > For method calls, we should report the error back to the caller (if we can), > if this isn't an eavasdropping delivery. For everything else, we drop the > message and syslog an error.  Unfortunately this is in generic libdbus code to send messages, not in dbus-daemon; so as far as I can see, this would require adding something like  void _dbus_connection_set_unable_to_send_callback (DBusConnection *conn,     void (*callback) (DBusConnection *, DBusMessage *, DBusError *,         void *data),     void *data)  or maybe  void _dbus_connection_set_unable_to_send_callback (DBusConnection *conn,     void (*callback) (DBusConnection *, DBusMessage *, int errno_, void *),     void *)  so that dbus-daemon could set that callback to an implementation of "syslog an error and maybe send an error back to the caller". ```  [Comment 8](show_bug.cgi?id=80163#c8)  Simon McVittie    2014-06-24 11:17:37 UTC  ``` Alban, are you able to spend some time writing a patch for this? ```  [Comment 9](show_bug.cgi?id=80163#c9)  Alban Crequy    2014-06-24 11:56:19 UTC  ``` (In reply to [comment #8](show_bug.cgi?id=80163#c8)) > Alban, are you able to spend some time writing a patch for this?  Yes, I will write a patch for this. ```  [Comment 10](show_bug.cgi?id=80163#c10)  Alban Crequy    2014-06-25 14:20:48 UTC  ``` Created [attachment 101748](attachment.cgi?id=101748 "[PATCH] Handle ETOOMANYREFS") [[details]](attachment.cgi?id=101748&action=edit "[PATCH] Handle ETOOMANYREFS") [[review]](page.cgi?id=splinter.html&bug=80163&attachment=101748) [PATCH] Handle ETOOMANYREFS  (In reply to [comment #7](show_bug.cgi?id=80163#c7)) > (In reply to [comment #6](show_bug.cgi?id=80163#c6)) > > For method calls, we should report the error back to the caller (if we can), > > if this isn't an eavasdropping delivery. For everything else, we drop the > > message and syslog an error. >  > Unfortunately this is in generic libdbus code to send messages, not in > dbus-daemon; so as far as I can see, this would require adding something like >  > void _dbus_connection_set_unable_to_send_callback (DBusConnection *conn, >     void (*callback) (DBusConnection *, DBusMessage *, DBusError *, >         void *data), >     void *data) >  > or maybe >  > void _dbus_connection_set_unable_to_send_callback (DBusConnection *conn, >     void (*callback) (DBusConnection *, DBusMessage *, int errno_, void *), >     void *) >  > so that dbus-daemon could set that callback to an implementation of "syslog > an error and maybe send an error back to the caller".  I wrote the libdbus part of this, see attached patch. It is already big:  7 files changed, 130 insertions(+), 7 deletions(-)  But the bus part seems more difficult and intrusive.  In bus/dispatch.c::bus_dispatch(), dbus-daemon uses bus_transaction_execute_and_free() to forward the message to the recipients.  The distinction between the main recipient (addressed recipient) and the additional recipients (match rules or eavesdropping) does not exist in the BusTransaction because bus_transaction_execute_and_free() is not supposed to fail and report errors to the caller.  Moreover, when this function returns, the messages might not have been sent on the sockets yet: if the sockets are not ready (no POLLOUT yet) it will merely add the D-Bus message in the DBusConnection outgoing queue. By the time the message is sent through the socket, the BusTransaction will have been freed. BusTransaction also does not have a reference to the DBusConnection of the sender, but only of its BusContext.  The attached patch + the changes for the bus part (not written yet) seem excessively big for a security fix.  So I suggest I write a simpler patch to just drop the unsendable message without telling the sender; this will turn this denial-of-service bug into a simple non-security bug. And after the security fix is released, I can open a new non-security bug for returning an error message to the sender. However I am still not convinced that a non-malicious application sending fds into fds with a recursion level greater than 4 could exist so my preference for that additional bug would be WONTFIX. ```  [Comment 11](show_bug.cgi?id=80163#c11)  Alban Crequy    2014-06-25 17:51:40 UTC  ``` Created [attachment 101754](attachment.cgi?id=101754 "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[details]](attachment.cgi?id=101754&action=edit "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[review]](page.cgi?id=splinter.html&bug=80163&attachment=101754) [PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)  This patch fixes the security issue but does not send an error to the sender. It is also smaller:   3 files changed, 46 insertions(+), 1 deletion(-) ```  [Comment 12](show_bug.cgi?id=80163#c12)  Simon McVittie    2014-06-26 13:29:15 UTC  ``` (In reply to [comment #10](show_bug.cgi?id=80163#c10)) > The attached patch + the changes for the bus part (not written yet) seem > excessively big for a security fix.  I agree.  > The distinction between the main recipient (addressed recipient) and the > additional recipients (match rules or eavesdropping) does not exist in the > BusTransaction because bus_transaction_execute_and_free() is not supposed to > fail and report errors to the caller.  I expected this would cause difficulty. Indeed, bus_transaction_execute_and_free() exists *because* it isn't meant to fail at this point: it is meant to either all succeed (modulo disconnected connections), or not get this far (hence "transaction").  > By the > time the message is sent through the socket, the BusTransaction will have > been freed. BusTransaction also does not have a reference to the > DBusConnection of the sender, but only of its BusContext.  I think the best we can possibly do here is best-effort. Perhaps for method calls, bus/ could attach user-data to the addressed recipient's DBusMessage with a reference to the sending DBusConnection, and the function called on ETOOMANYREFS could attempt to push an error message into that connection, but if there is an OOM or other error (including a full queue), just give up instead?  Additional can of worms: you can attach fds to a signal. I'm not sure why you'd want to, but you can. We can't do anything better than dropping the message on the floor in that case.  Additional additional can of worms: replying to a method reply (or an error, which could theoretically carry a fd, although in practice nobody sends a payload of signature != 's') is not a well-defined action, so I don't think we can/should synthesize an error reply for that either.  I'm starting to think Alban was right about WONTFIXing Thiago's request to send back an error reply: too much implementation, too little gain.  Lennart, Kay: how does kdbus deal with the equivalent of this? ```  [Comment 13](show_bug.cgi?id=80163#c13)  Simon McVittie    2014-06-26 13:30:03 UTC  ``` Comment on [attachment 101754](attachment.cgi?id=101754 "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[details]](attachment.cgi?id=101754&action=edit "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[review]](page.cgi?id=splinter.html&bug=80163&attachment=101754) [PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)  Review of [attachment 101754](attachment.cgi?id=101754 "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[details]](attachment.cgi?id=101754&action=edit "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[review]](page.cgi?id=splinter.html&bug=80163&attachment=101754): -----------------------------------------------------------------  I am broadly in favour of this patch, although there are some minor issues.  I'll ask on distros@ for CVE IDs for this and [Bug #80469](show_bug.cgi?id=80469 "RESOLVED FIXED - CVE-2014-3533: Security implications of Bug #79694 Misbehaviour reading a message with fdpassing") (either one or two CVEs, depending).  ::: dbus/dbus-sysdeps.c @@ +767,5 @@ > + */ > +dbus_bool_t > +_dbus_get_is_errno_toomanyrefs (void) > +{ > +  return errno == ETOOMANYREFS;  For portability, I think this has to be:  #ifdef ETOOMANYREFS   return errno == ETOOMANYREFS; #else   return FALSE; #endif  (Check that on GNU/Linux, ETOOMANYREFS is actually a #define - I think it is. I don't think we really consider non-GNU Linuxes like Android to be security-supported.)  ::: dbus/dbus-sysdeps.h @@ +384,4 @@ >  dbus_bool_t _dbus_get_is_errno_enomem                (void); >  dbus_bool_t _dbus_get_is_errno_eintr                 (void); >  dbus_bool_t _dbus_get_is_errno_epipe                 (void); > +dbus_bool_t _dbus_get_is_errno_toomanyrefs           (void);  For consistency with the others this should ideally be ...is_errno_etoomanyrefs()  ::: dbus/dbus-transport-socket.c @@ +669,5 @@ > +               * ETOOMANYREFS cannot happen after. > +               */ > +              _dbus_assert (socket_transport->message_bytes_written == 0); > + > +              _dbus_verbose (" discard message of %d bytes\n",  "...bytes due to ETOOMANYREFS\n"  @@ +672,5 @@ > + > +              _dbus_verbose (" discard message of %d bytes\n", > +                             total_bytes_to_write); > + > +              total += bytes_written;  bytes_written is -1 here. I don't think you want that?  (All this throws off is tracking of how many total bytes of messages we have sent without returning to the main loop, though.)  @@ +682,5 @@ > +              /* The message was not actually sent but it needs to be removed > +               * from the outgoing queue > +               */ > +              _dbus_connection_message_sent_unlocked (transport->connection, > +                                                      message);  I agree with your reasoning that this is about the most that is feasible to do as a security fix, and that we can handle the rest as an ordinary bug later.  Other maintainers, what do you think? (I'm particularly interested in opinions/ideas from those who wrote this stuff.) ```  [Comment 14](show_bug.cgi?id=80163#c14)  Alban Crequy    2014-06-26 15:36:45 UTC  ``` Comment on [attachment 101754](attachment.cgi?id=101754 "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[details]](attachment.cgi?id=101754&action=edit "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[review]](page.cgi?id=splinter.html&bug=80163&attachment=101754) [PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)  Review of [attachment 101754](attachment.cgi?id=101754 "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[details]](attachment.cgi?id=101754&action=edit "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[review]](page.cgi?id=splinter.html&bug=80163&attachment=101754): -----------------------------------------------------------------  ::: dbus/dbus-sysdeps.c @@ +767,5 @@ > + */ > +dbus_bool_t > +_dbus_get_is_errno_toomanyrefs (void) > +{ > +  return errno == ETOOMANYREFS;  It is a #define:  $ grep ETOOMANYREFS /usr/include/asm-generic/errno.h #define	ETOOMANYREFS	109	/* Too many references: cannot splice */  Changed.  ::: dbus/dbus-sysdeps.h @@ +384,4 @@ >  dbus_bool_t _dbus_get_is_errno_enomem                (void); >  dbus_bool_t _dbus_get_is_errno_eintr                 (void); >  dbus_bool_t _dbus_get_is_errno_epipe                 (void); > +dbus_bool_t _dbus_get_is_errno_toomanyrefs           (void);  Updated.  ::: dbus/dbus-transport-socket.c @@ +669,5 @@ > +               * ETOOMANYREFS cannot happen after. > +               */ > +              _dbus_assert (socket_transport->message_bytes_written == 0); > + > +              _dbus_verbose (" discard message of %d bytes\n",  Updated.  @@ +672,5 @@ > + > +              _dbus_verbose (" discard message of %d bytes\n", > +                             total_bytes_to_write); > + > +              total += bytes_written;  Oops. I removed that line. So It will check the limit per write iteration counting only effectively written message and not discarded messages. ```  [Comment 15](show_bug.cgi?id=80163#c15)  Alban Crequy    2014-06-26 15:40:47 UTC  ``` Created [attachment 101811](attachment.cgi?id=101811 "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[details]](attachment.cgi?id=101811&action=edit "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[review]](page.cgi?id=splinter.html&bug=80163&attachment=101811) [PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)  Patch updated following Simon's review. I added a small paragraph in the commit message too.  I tested the patch on top of 1.8.0 and it fixed the issue. I could see with strace that despite receiving ETOOMANYREFS, dbus-daemon does not close the target connection and the target application survives. ```  [Comment 16](show_bug.cgi?id=80163#c16)  Thiago Macieira    2014-06-27 00:49:33 UTC  ``` Comment on [attachment 101811](attachment.cgi?id=101811 "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[details]](attachment.cgi?id=101811&action=edit "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[review]](page.cgi?id=splinter.html&bug=80163&attachment=101811) [PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)  Review of [attachment 101811](attachment.cgi?id=101811 "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[details]](attachment.cgi?id=101811&action=edit "[PATCH] Handle ETOOMANYREFS when sending recursive fds (SCM_RIGHTS)") [[review]](page.cgi?id=splinter.html&bug=80163&attachment=101811): -----------------------------------------------------------------  Looks good. ```  [Comment 17](show_bug.cgi?id=80163#c17)  Simon McVittie    2014-07-02 16:07:32 UTC  ``` Removing embargo. Fixed in dbus 1.8.6 and 1.6.22 which I just released. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=80163)
* - Top of page

* + [Home](./)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

Use of freedesktop.org services, including Bugzilla, is subject to our [Code of Conduct](https://www.freedesktop.org/wiki/CodeOfConduct/). How we collect and use information is described in our [Privacy Policy](https://www.freedesktop.org/wiki/PrivacyPolicy).



=== Content from advisories.mageia.org_e4ba88a9_20250124_193705.html ===

# [Advisories](index.html) » MGASA-2014-0294

## Updated dbus packages fix multiple vulnerabilities

Publication date: 26 Jul 2014

Modification date: 26 Jul 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-3532](CVE-2014-3532.html)
,
[CVE-2014-3533](CVE-2014-3533.html)

## Description

```
Updated dbus packages fix security vulnerabilities:

A flaw was reported in D-Bus's file descriptor passing feature. A local
attacker could use this flaw to cause a service or application to disconnect
from the bus, typically resulting in that service or application exiting
(CVE-2014-3532).

A flaw was reported in D-Bus's file descriptor passing feature. A local
attacker could use this flaw to cause an invalid file descriptor to be
forwarded to a service or application, causing it to disconnect from the bus,
typically resulting in that service or application exiting (CVE-2014-3533).

```

## References

* <http://lists.freedesktop.org/archives/dbus/2014-July/016235.html>
* <https://lists.fedoraproject.org/pipermail/package-announce/2014-July/135226.html>
* <https://bugs.mageia.org/show_bug.cgi?id=13653>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3532>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3533>

## SRPMS

### 3/core

* dbus-1.6.8-4.4.mga3

### 4/core

* dbus-1.6.18-1.3.mga4



=== Content from openwall.com_13b44427_20250124_193706.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <53B42D80.1000306@collabora.co.uk>
Date: Wed, 02 Jul 2014 17:04:16 +0100
From: Simon McVittie <simon.mcvittie@...labora.co.uk>
To: oss-security@...ts.openwall.com,
 "dbus@...ts.freedesktop.org" <dbus@...ts.freedesktop.org>
CC: Alban Créquy <alban.crequy@...labora.co.uk>,
 Colin Walters <walters@...bum.org>,
 Thiago Macieira <thiago@....org>
Subject: CVE-2014-3532, -3533: two local DoS vulnerabilities in dbus-daemon

Impact: denial of service (force system services to exit)
Access required: local
Versions affected by CVE-2014-3532: dbus >= 1.3.0 on Linux >= 2.6.37-rc4
Versions affected by CVE-2014-3533: dbus >= 1.3.0 on all Unix platforms

Alban Crequy at Collabora Ltd. discovered a bug in dbus-daemon's support
for file descriptor passing. A malicious process could force system
services or user applications to be disconnected from the D-Bus system
bus by sending them a message containing a file descriptor, then causing
that file descriptor to exceed the kernel's maximum recursion depth
(itself introduced to fix a DoS) before dbus-daemon forwards the message
to the victim process. Most services and applications exit when
disconnected from the system bus, leading to a denial of service. This
is tracked as fd.o#80163 and CVE-2014-3532.

Additionally, Alban discovered that bug fd.o#79694, a bug previously
reported by Alejandro Martínez Suárez which was not believed to be a
security flaw, could be used for a similar denial of service, by causing
dbus-daemon to attempt to forward invalid file descriptors to a victim
process when file descriptors become associated with the wrong message.
Its security implications are tracked as fd.o#80469 and CVE-2014-3533.

For the 1.8.x stable branch, these vulnerabilities are fixed in version
1.8.6. For the 1.6.x old-stable branch, these vulnerabilities are fixed
in version 1.6.22.

All earlier versions of dbus with the file descriptor passing feature
(1.3.0 and up) are believed to be vulnerable. Distributions that
backport security fixes should backport git commits
07f4c12efe3b9bd45d109bc5fbaf6d9dbf69d78e and
9ca90648fc870c24d852ce6d7ce9387a9fc9a94a, attached.

References:

[fd.o#79694] <https://bugs.freedesktop.org/show_bug.cgi?id=79694>
[fd.o#80469] <https://bugs.freedesktop.org/show_bug.cgi?id=80469>
[fd.o#80163] <https://bugs.freedesktop.org/show_bug.cgi?id=80163>

Regards,
    S

View attachment "[0001-If-loader-contains-two-messages-with-fds-don-t-corru.patch](4/1)" of type "text/x-patch" (1687 bytes)

View attachment "[0002-Handle-ETOOMANYREFS-when-sending-recursive-fds-SCM_R.patch](4/2)" of type "text/x-patch" (4657 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


