=== Content from bugs.debian.org_1531dd1d_20250125_002848.html ===

# Debian Bug report logs - #746306 dpkg: CVE-2014-0471 fix introduces the vulnerability into squeeze

[![version graph](version.cgi?collapse=1;package=dpkg;width=2;height=2;fixed=dpkg%2F1.17.9;fixed=dpkg%2F1.16.14;fixed=dpkg%2F1.15.10;found=dpkg%2F1.15.9;absolute=0)](version.cgi?info=1;absolute=0;found=dpkg%2F1.15.9;package=dpkg;collapse=1;fixed=dpkg%2F1.17.9;fixed=dpkg%2F1.16.14;fixed=dpkg%2F1.15.10)

Package:
[dpkg](pkgreport.cgi?package=dpkg);
Maintainer for [dpkg](pkgreport.cgi?package=dpkg) is [Dpkg Developers <debian-dpkg@lists.debian.org>](pkgreport.cgi?maint=debian-dpkg%40lists.debian.org); Source for [dpkg](pkgreport.cgi?package=dpkg) is [src:dpkg](pkgreport.cgi?src=dpkg) ([PTS](https://tracker.debian.org/pkg/dpkg), [buildd](https://buildd.debian.org/dpkg), [popcon](https://qa.debian.org/popcon.php?package=dpkg)).

Reported by: [javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net](pkgreport.cgi?submitter=javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9%40jasp.net)

Date: Mon, 28 Apr 2014 20:39:02 UTC

Severity: normal

Tags: security, squeeze

Found in version dpkg/1.15.9

Fixed in versions dpkg/1.17.9, dpkg/1.16.14, dpkg/1.15.10

**Done:** Guillem Jover <guillem@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=746306;mbox=yes), [status mbox](bugreport.cgi?bug=746306;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=746306;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Mon, 28 Apr 2014 20:39:06 GMT) ([full text](bugreport.cgi?bug=746306;msg=2), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

New Bug report received and forwarded. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Mon, 28 Apr 2014 20:39:06 GMT) ([full text](bugreport.cgi?bug=746306;msg=4), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=5), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=javier%40jasp.net)
From: Javier Serrano Polo <javier@jasp.net>
To: submit@bugs.debian.org
Subject: dpkg: CVE-2014-0471 fix introduces the vulnerability into squeeze
Date: Mon, 28 Apr 2014 22:35:57 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=746306;msg=5) (text/plain, inline)]
```
```
Package: dpkg
Version: 1.15.9
Tags: security squeeze

As far as I see, escaping file names was added to diffutils in 2012. The
feature is not present in a squeeze environment. [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471) does not
apply.

Directory traversal during unpack is possible now. I will wait one day
before releasing an exploit package.

```
```
[[smime.p7s](bugreport.cgi?att=1;bug=746306;filename=smime.p7s;msg=5) (application/pkcs7-signature, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Tue, 29 Apr 2014 06:15:05 GMT) ([full text](bugreport.cgi?bug=746306;msg=7), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Tue, 29 Apr 2014 06:15:05 GMT) ([full text](bugreport.cgi?bug=746306;msg=9), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=10), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746306@bugs.debian.org
Cc: team@security.debian.org
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the vulnerability
into squeeze
Date: Tue, 29 Apr 2014 08:11:44 +0200
```
Hi,

On Mon, 2014-04-28 at 22:35:57 +0200, Javier Serrano Polo wrote:
> Package: dpkg
> Version: 1.15.9
> Tags: security squeeze

> As far as I see, escaping file names was added to diffutils in 2012. The
> feature is not present in a squeeze environment. [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471) does not
> apply.
>
> Directory traversal during unpack is possible now. I will wait one day
> before releasing an exploit package.

Oh, woah, right now I'm either guessing I mixed up my chroots when
initially checking the submitted test package, or had the files in /tmp
from a previous extraction, otherwise I cannot explain this blunder. :/
I've reproduced this now locally on a squeeze chroot with a test package.

In any case, squeeze could be affected by a partial upgrade of patch, so
the options I see are:

  1. Simply revert the patch, and ignore issues w/ partial upgrades (at
     least for now?).
  2. Revert the patch and add versioned depdendencies against the working
     patch package. This might require some dist-upgrade tests, though.
  3. Fix the patch to take into account the old behaviour, by checking
     if either of the filenames (escaped and unescaped) are unsafe.

I guess the last one is the “safest option”. In any case I'd like
input from the security team (CCed just to make sure you get this),
and I'm very sorry guys about this. :(

I think I could have either option 1 or 3 ready for later today,
option 2 would require more consideration and testing.

Thanks,
Guillem

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Tue, 29 Apr 2014 09:39:09 GMT) ([full text](bugreport.cgi?bug=746306;msg=12), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Tue, 29 Apr 2014 09:39:09 GMT) ([full text](bugreport.cgi?bug=746306;msg=14), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=15), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=javier%40jasp.net)
From: Javier Serrano Polo <javier@jasp.net>
To: 746306@bugs.debian.org
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the
vulnerability into squeeze
Date: Tue, 29 Apr 2014 11:04:26 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=746306;msg=15) (text/plain, inline)]
```
```
El dt 29 de 04 de 2014 a les 08:11 +0200, Guillem Jover va escriure:
> In any case, squeeze could be affected by a partial upgrade of patch,

That is true.

Since patch is the one doing the job, how about performing a --dry-run
first and checking the output?

```
```
[[smime.p7s](bugreport.cgi?att=1;bug=746306;filename=smime.p7s;msg=15) (application/pkcs7-signature, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Tue, 29 Apr 2014 10:30:09 GMT) ([full text](bugreport.cgi?bug=746306;msg=17), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Raphael Geissert <geissert@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Tue, 29 Apr 2014 10:30:09 GMT) ([full text](bugreport.cgi?bug=746306;msg=19), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=20), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=geissert%40debian.org)
From: Raphael Geissert <geissert@debian.org>
To: Guillem Jover <guillem@debian.org>
Cc: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, 746306@bugs.debian.org,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the vulnerability
into squeeze
Date: Tue, 29 Apr 2014 12:27:50 +0200
```
Hi,

On 29 April 2014 08:11, Guillem Jover <guillem@debian.org> wrote:
[...]
>   2. Revert the patch and add versioned depdendencies against the working
>      patch package. This might require some dist-upgrade tests, though.
>   3. Fix the patch to take into account the old behaviour, by checking
>      if either of the filenames (escaped and unescaped) are unsafe.
>
> I guess the last one is the “safest option”. In any case I'd like
> input from the security team (CCed just to make sure you get this),
> and I'm very sorry guys about this. :(

This goes both ways:
* if using dependencies, they would need to be added to all versions
so that e.g. wheezy's dpkg can't be used with squeeze's patch
* if handling both behaviors, it should also apply to both releases.

Unless I missed something, of course.

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Tue, 29 Apr 2014 15:33:13 GMT) ([full text](bugreport.cgi?bug=746306;msg=22), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent**
to `Sven Joachim <svenjoac@gmx.de>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Tue, 29 Apr 2014 15:33:13 GMT) ([full text](bugreport.cgi?bug=746306;msg=24), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=25), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=svenjoac%40gmx.de)
From: Sven Joachim <svenjoac@gmx.de>
To: Raphael Geissert <geissert@debian.org>
Cc: Guillem Jover <guillem@debian.org>, 746306@bugs.debian.org, javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net, Debian Security Team <team@security.debian.org>
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the vulnerability into squeeze
Date: Tue, 29 Apr 2014 17:29:50 +0200
```
On 2014-04-29 12:27 +0200, Raphael Geissert wrote:

> On 29 April 2014 08:11, Guillem Jover <guillem@debian.org> wrote:
> [...]
>>   2. Revert the patch and add versioned depdendencies against the working
>>      patch package. This might require some dist-upgrade tests, though.
>>   3. Fix the patch to take into account the old behaviour, by checking
>>      if either of the filenames (escaped and unescaped) are unsafe.
>>
>> I guess the last one is the “safest option”. In any case I'd like
>> input from the security team (CCed just to make sure you get this),
>> and I'm very sorry guys about this. :(
>
> This goes both ways:
> * if using dependencies, they would need to be added to all versions
> so that e.g. wheezy's dpkg can't be used with squeeze's patch
> * if handling both behaviors, it should also apply to both releases.
>
> Unless I missed something, of course.

Something nobody has mentioned yet: isn't the critical path between
wheezy and jessie/sid rather than between squeeze and wheezy?  Support
for double-quoted filenames was added in patch 2.7, which entered
unstable only in June 2013.

Cheers,
       Sven

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Tue, 29 Apr 2014 16:57:09 GMT) ([full text](bugreport.cgi?bug=746306;msg=27), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=27), [link](#26)).

---

[Message #28](#28) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=28), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=28), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40debian.org)
From: Jakub Wilk <jwilk@debian.org>
To: 746306@bugs.debian.org
Cc: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net,
team@security.debian.org
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the vulnerability
into squeeze
Date: Tue, 29 Apr 2014 18:55:35 +0200
```
* Guillem Jover <guillem@debian.org>, 2014-04-29, 08:11:
>1. Simply revert the patch, and ignore issues w/ partial upgrades (at
>least for now?).
>2. Revert the patch and add versioned depdendencies against the working
>patch package. This might require some dist-upgrade tests, though.
>3. Fix the patch to take into account the old behaviour, by checking if
>either of the filenames (escaped and unescaped) are unsafe.
>
>I guess the last one is the “safest option”.

For a quick fix, 3 is probably the best.

But I think this bug shows that validating diffs is not viable in the
long run. We need to either fix patch(1) not to traverse directory
symlinks, or implement a completely different strategy:

1) Unpack .orig.tar.
2) Delete all symlinks (and maybe also other non-regular files).
3) Apply patches.
4) Restore all the files deleted in step 2.

In another mail Javier suggested to check --dry-run output. I don't
think this is feasible. Parsing --dry-run output is probably even harder
than parsing patches, and after reading
<https://savannah.gnu.org/bugs/index.php?37642> I wouldn't trust it to be
very "dry" anyway...

--
Jakub Wilk

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Tue, 29 Apr 2014 20:42:17 GMT) ([full text](bugreport.cgi?bug=746306;msg=30), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=30), [link](#29)).

---

**Acknowledgement sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Tue, 29 Apr 2014 20:42:17 GMT) ([full text](bugreport.cgi?bug=746306;msg=32), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=32), [link](#31)).

---

[Message #33](#33) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=33), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=33), reply):

![](/cgi-bin/libravatar.cgi?email=javier%40jasp.net)
From: Javier Serrano Polo <javier@jasp.net>
To: 746306@bugs.debian.org
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the
vulnerability into squeeze
Date: Tue, 29 Apr 2014 22:39:37 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=746306;msg=33) (text/plain, inline)]
```
```
I am giving some hours to the security team, that has asked for a proof
of concept.

```
```
[[exploto_0.1.dsc](bugreport.cgi?att=1;bug=746306;filename=exploto_0.1.dsc;msg=33) (text/plain, attachment)]
```
```
[[exploto_0.1.orig.tar.gz](bugreport.cgi?att=2;bug=746306;filename=exploto_0.1.orig.tar.gz;msg=33) (application/x-compressed-tar, attachment)]
```
```
[[smime.p7s](bugreport.cgi?att=3;bug=746306;filename=smime.p7s;msg=33) (application/pkcs7-signature, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Tue, 29 Apr 2014 21:45:23 GMT) ([full text](bugreport.cgi?bug=746306;msg=35), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=35), [link](#34)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Tue, 29 Apr 2014 21:45:23 GMT) ([full text](bugreport.cgi?bug=746306;msg=37), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=38), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: Jakub Wilk <jwilk@debian.org>, 746306@bugs.debian.org
Cc: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net,
team@security.debian.org
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the vulnerability
into squeeze
Date: Tue, 29 Apr 2014 23:40:25 +0200
```
On Tue, 2014-04-29 at 18:55:35 +0200, Jakub Wilk wrote:
> * Guillem Jover <guillem@debian.org>, 2014-04-29, 08:11:
> >1. Simply revert the patch, and ignore issues w/ partial upgrades (at
> >least for now?).
> >2. Revert the patch and add versioned depdendencies against the working
> >patch package. This might require some dist-upgrade tests, though.
> >3. Fix the patch to take into account the old behaviour, by checking if
> >either of the filenames (escaped and unescaped) are unsafe.
> >
> >I guess the last one is the “safest option”.
>
> For a quick fix, 3 is probably the best.

Did you mean 1? After having checked to implement 3, there's many
parts of the code that need to be changed and moved around, I'll try
to cook an actual patch to see how bad it is though.

There's also the newly supported git formatted patches now recognized
by patch, “fortunately” Dpkg::Source::Patch does not understand them
and because it creates any necessary directories (or what looks like
one), I don't see a way it can be exploited. But I might be short on
imagination at this moment.

Also another issue is that independently of partial upgrades, dpkg-dev
might be used on other systems where we don't know what patch version
is available, so it could be vulnerable or not depending on that. :/

> But I think this bug shows that validating diffs is not viable in the long
> run. We need to either fix patch(1) not to traverse directory symlinks,

Yeah, I've to agree with that, the only really safe option here is for
patch to not follow any symlinks at all. And that seems to have been
partly the intention behind the new default and the option to revert
it with --follow-symlinks, but it seems to only apply to the last
component.

A patch program that follows symlinks also means that extracting a
Debian source package manually is unsafe…

> or implement a completely different strategy:
>
> 1) Unpack .orig.tar.
> 2) Delete all symlinks (and maybe also other non-regular files).
> 3) Apply patches.
> 4) Restore all the files deleted in step 2.
>
>
> In another mail Javier suggested to check --dry-run output. I don't think
> this is feasible. Parsing --dry-run output is probably even harder than
> parsing patches,

Yeah, I don't think parsing --dry-run output is a good idea either,
it's not future-proof and prone to break if the output changes.

Your proposed solution might be the safer and more future-proof way
to deal with the current patch changing behaviour, but it might not
cover all future new features (think similar extensions like the git
formatted patches).

Thanks,
Guillem

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Tue, 29 Apr 2014 22:15:08 GMT) ([full text](bugreport.cgi?bug=746306;msg=40), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=40), [link](#39)).

---

[Message #41](#41) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=41), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=41), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40debian.org)
From: Jakub Wilk <jwilk@debian.org>
To: 746306@bugs.debian.org
Cc: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net,
team@security.debian.org
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the vulnerability
into squeeze
Date: Wed, 30 Apr 2014 00:12:56 +0200
```
* Guillem Jover <guillem@debian.org>, 2014-04-29, 23:40:
>>>1. Simply revert the patch, and ignore issues w/ partial upgrades (at
>>>least for now?).
>>>2. Revert the patch and add versioned depdendencies against the
>>>working patch package. This might require some dist-upgrade tests,
>>>though.
>>>3. Fix the patch to take into account the old behaviour, by checking
>>>if either of the filenames (escaped and unescaped) are unsafe.
>>>
>>>I guess the last one is the “safest option”.
>>
>>For a quick fix, 3 is probably the best.
>
>Did you mean 1? After having checked to implement 3, there's many parts
>of the code that need to be changed and moved around, I'll try to cook
>an actual patch to see how bad it is though.

I had assumed that the patch for 3 would we straightforward. If this is
not the case, then I'd go for 1 for now, and maybe we'll figure out
something better later. Of course, Security Team's option may vary.

>There's also the newly supported git formatted patches now recognized
>by patch, “fortunately” Dpkg::Source::Patch does not understand them
>and because it creates any necessary directories (or what looks like
>one), I don't see a way it can be exploited. But I might be short on
>imagination at this moment.

Oh, I completely forgot about git patches. I have a hunch that there's a
clever way to exploit them. :\

--
Jakub Wilk

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Tue, 29 Apr 2014 23:45:11 GMT) ([full text](bugreport.cgi?bug=746306;msg=43), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=43), [link](#42)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Tue, 29 Apr 2014 23:45:11 GMT) ([full text](bugreport.cgi?bug=746306;msg=45), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=45), [link](#44)).

---

[Message #46](#46) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=46), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=46), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: Jakub Wilk <jwilk@debian.org>, 746306@bugs.debian.org
Cc: javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net,
team@security.debian.org
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the vulnerability
into squeeze
Date: Wed, 30 Apr 2014 01:36:36 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=746306;msg=46) (text/plain, inline)]
```
```
Hi!

On Wed, 2014-04-30 at 00:12:56 +0200, Jakub Wilk wrote:
> * Guillem Jover <guillem@debian.org>, 2014-04-29, 23:40:
> >>>1. Simply revert the patch, and ignore issues w/ partial upgrades (at
> >>>least for now?).
> >>>2. Revert the patch and add versioned depdendencies against the
> >>>working patch package. This might require some dist-upgrade tests,
> >>>though.
> >>>3. Fix the patch to take into account the old behaviour, by checking
> >>>if either of the filenames (escaped and unescaped) are unsafe.
> >>>
> >>>I guess the last one is the “safest option”.
> >>
> >>For a quick fix, 3 is probably the best.
> >
> >Did you mean 1? After having checked to implement 3, there's many parts of
> >the code that need to be changed and moved around, I'll try to cook an
> >actual patch to see how bad it is though.
>
> I had assumed that the patch for 3 would we straightforward. If this is not
> the case, then I'd go for 1 for now, and maybe we'll figure out something
> better later. Of course, Security Team's option may vary.

Well it looks a bit gross, because it might end up generating strange
directories, as those are recorded by the same code analyzing and
deciding if a pathname is safe or not. So if we have to check both
we don't know which one will end up being used by patch and would
need to create them all. :/

And actually, after having pondered about this for a bit, it just
occurred to me that the most strightforward and safe solution of all is
to simply and completely ban C-style strings, which would be option 4.
Because we avoid any discrepancy in behaviour from dpkg-dev and patch,
avoid any strange directory creation side-effects, and works everywhere,
even on systems with old/new or non-GNU patch programs. Also any such
new patches would not extract correctly on old suites anyway. And why
should we support those encoded characters at all, when we've lived
w/o them all this time.

Attached a non-tested quick patch implementing this. I'll start
testing it and preparing packages for all suites.

> >There's also the newly supported git formatted patches now recognized by
> >patch, “fortunately” Dpkg::Source::Patch does not understand them and
> >because it creates any necessary directories (or what looks like one), I
> >don't see a way it can be exploited. But I might be short on imagination
> >at this moment.
>
> Oh, I completely forgot about git patches. I have a hunch that there's a
> clever way to exploit them. :\

That's what I fear too, but I've been trying to concoct some PoC and
failed.

Thanks,
Guillem

```
```
[[dpkg-ban-patch-with-c-style-filename.patch](bugreport.cgi?att=1;bug=746306;filename=dpkg-ban-patch-with-c-style-filename.patch;msg=46) (text/x-diff, attachment)]
```

---

**Added tag(s) pending.**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Wed, 30 Apr 2014 06:36:12 GMT) ([full text](bugreport.cgi?bug=746306;msg=48), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=48), [link](#47)).

---

**Message sent on**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug#746306.
(Wed, 30 Apr 2014 06:36:37 GMT) ([full text](bugreport.cgi?bug=746306;msg=50), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=50), [link](#49)).

---

[Message #51](#51) received at 746306-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=51), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=51), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746306-submitter@bugs.debian.org
Subject: Bug#746306 marked as pending
Date: Wed, 30 Apr 2014 06:32:33 +0000
```
tag 746306 pending
thanks

Hello,

Bug #746306 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=a12eb58>

---
commit a12eb58959d0a10584a428f4a3103a49204c410f
Author: Guillem Jover <guillem@debian.org>
Date:   Wed Apr 30 02:28:45 2014 +0200

    Dpkg::Source::Patch: Outright reject C-style filenames in patches

    Because patch only started recognizing C-style filenames in diffs
    in version 2.7, it's not safe to assume one behaviour or the other,
    as the system might or might not have a recent enough version, or
    a GNU patch program at all. There's also no reason we should be
    supporting this kind of strange encoded filenames in patches, when
    we have not done so up to now.

    Let's just ban these types of diffs and be done with it.

    Fixes: [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471)
    Closes: #[746306](bugreport.cgi?bug=746306)

diff --git a/debian/changelog b/debian/changelog
index d95f849..9d09866 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,5 +1,9 @@
 dpkg (1.17.9) UNRELEASED; urgency=low

+  [ Guillem Jover ]
+  * Do not allow patch files with C-style encoded filenames. Closes: #[746306](bugreport.cgi?bug=746306)
+    Unconditionally fixes [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471).
+
   [ Updated scripts translations ]
   * French (Steve Petruzzello). Closes: #[746350](bugreport.cgi?bug=746350)
   * German (Helge Kreutzmann).

```

---

**Reply sent**
to `Guillem Jover <guillem@debian.org>`:

You have taken responsibility.
(Wed, 30 Apr 2014 06:51:10 GMT) ([full text](bugreport.cgi?bug=746306;msg=53), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=53), [link](#52)).

---

**Notification sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug acknowledged by developer.
(Wed, 30 Apr 2014 06:51:10 GMT) ([full text](bugreport.cgi?bug=746306;msg=55), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=55), [link](#54)).

---

[Message #56](#56) received at 746306-close@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=56), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=56), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746306-close@bugs.debian.org
Subject: Bug#746306: fixed in dpkg 1.17.9
Date: Wed, 30 Apr 2014 06:48:35 +0000
```
Source: dpkg
Source-Version: 1.17.9

We believe that the bug you reported is fixed in the latest version of
dpkg, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 746306@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover <guillem@debian.org> (supplier of updated dpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Wed, 30 Apr 2014 05:45:20 +0200
Source: dpkg
Binary: libdpkg-dev dpkg dpkg-dev libdpkg-perl dselect
Architecture: source amd64 all
Version: 1.17.9
Distribution: unstable
Urgency: high
Maintainer: Dpkg Developers <debian-dpkg@lists.debian.org>
Changed-By: Guillem Jover <guillem@debian.org>
Description:
 dpkg       - Debian package management system
 dpkg-dev   - Debian package development tools
 dselect    - Debian package management front-end
 libdpkg-dev - Debian package management static library
 libdpkg-perl - Dpkg perl modules
Closes: [746306](bugreport.cgi?bug=746306) [746331](bugreport.cgi?bug=746331) [746350](bugreport.cgi?bug=746350) [746354](bugreport.cgi?bug=746354)
Changes:
 dpkg (1.17.9) unstable; urgency=high
 .
   [ Guillem Jover ]
   * Do not allow patch files with C-style encoded filenames. Closes: #[746306](bugreport.cgi?bug=746306)
     Unconditionally fixes [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471).
   * Switch alternative database backups from xz to gzip. Closes: #[746354](bugreport.cgi?bug=746354)
   * Do not leak long tar names on bogus or truncated archives.
   * Do not leak the filepackages iterator when a directory is used by other
     packages.
   * Fix short lived memory leaks in «dpkg-split --split».
   * Fix memory leak in unused Keybindings screen in dselect.
   * Do not leak color string on «dselect --color».
   * Fix memory leaks when parsing alternatives.
   * Fix off-by-one stack buffer overrun in start-stop-daemon on GNU/Linux and
     GNU/kFreeBSD if the executable pathname is longer than _POSIX_PATH_MAX.
     Although this should not have security implications as the buffer is
     surrounded by two arrays (so those catch accesses even if the stack
     grows up or down), and we are compiling with -fstack-protector anyway.
   * Mark the command_get_pager() tests on a tty as TODO for now, so that
     we do not get failures on build daemons.
   * Make test suite errors abort the build again. Closes: #[746331](bugreport.cgi?bug=746331)
 .
   [ Updated scripts translations ]
   * French (Steve Petruzzello). Closes: #[746350](bugreport.cgi?bug=746350)
   * German (Helge Kreutzmann).
 .
   [ Updated manpages translations ]
   * German (Helge Kreutzmann).
Checksums-Sha1:
 744b7ca070758a06ff2b4e5f7bc029833ac6b2dd 2051 dpkg_1.17.9.dsc
 9e49682e77929217da9b88f570be192c4276506a 4051292 dpkg_1.17.9.tar.xz
 f559a84afbf319e2436632d65c4ecbbbb914d5fe 780370 libdpkg-dev_1.17.9_amd64.deb
 e83f48909ec6c2771429daafc29ca56ca70a95f3 2674880 dpkg_1.17.9_amd64.deb
 c5dd624c5855eb3b33e4779be4728452051453ba 1042774 dselect_1.17.9_amd64.deb
 43183a9b438ac8b0c469da9e1133414b495d6370 1421568 dpkg-dev_1.17.9_all.deb
 75481fa5fea4380978ea1d23151b39abcd592716 959148 libdpkg-perl_1.17.9_all.deb
Checksums-Sha256:
 63c7570f96b2228a04bcc7351b63c342f125a97b1ea47bd30c97197af9ad01b8 2051 dpkg_1.17.9.dsc
 da58389a80a3515ea12aaf10c9e48f84ee6c08d2fe2c9e1450f4df49ffeeb6aa 4051292 dpkg_1.17.9.tar.xz
 bfc333b4d369823b8ae80a2df0c6dbc60474212f462c6c67a9cb8a48a9992b83 780370 libdpkg-dev_1.17.9_amd64.deb
 e0b86bed6cecb2a99b79dee0718522d0f9f751355f8f323cbb3c34a3aa1ec94f 2674880 dpkg_1.17.9_amd64.deb
 d8bb1a550313150285dc10974534fcced7ddb127713fcf5944ff660e3484f2be 1042774 dselect_1.17.9_amd64.deb
 ef375c0f35faef02f4f4e4a5fca6dbebeb3f1ffec2f55231ede88071ced56e15 1421568 dpkg-dev_1.17.9_all.deb
 399e5df6ead0127fd60ada3e91d6b277d5eccca95f038daef575cba0e37fc4fb 959148 libdpkg-perl_1.17.9_all.deb
Files:
 33ef1f167613f458252837ba3576cf7d 780370 libdevel optional libdpkg-dev_1.17.9_amd64.deb
 bb89d3dc43cf694aa8b1e9907d8fc763 2674880 admin required dpkg_1.17.9_amd64.deb
 3a86c3659b935d0d10f10177170326aa 1042774 admin optional dselect_1.17.9_amd64.deb
 df82eada5d4715f2ae154531896fc9af 1421568 utils optional dpkg-dev_1.17.9_all.deb
 e8c0d86420a6792d3929abb77d322240 959148 perl optional libdpkg-perl_1.17.9_all.deb
 505c25bb1c0e299f37323c16c5775317 2051 admin required dpkg_1.17.9.dsc
 088e60aca2b2e14dcf4450a0d1cb2ef0 4051292 admin required dpkg_1.17.9.tar.xz

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBCAAGBQJTYJO5AAoJELlyvz6krlejql4P/3LBwRUuaFEafOA4mrYmH0m6
FthTsFBZlc3URhAEzoFpd9b3r00Q0DvGSbHY/VNWLM7L2KmJ2RqcfGFuybO8xrck
8eq4mJfl2tcFfQprHDkuulbmgmHx8COKl3f4UVkYUHIKJlDqmrqlYALkAZPW3o1U
dD6mB2F5iJan/VZOS8hhLePLxmR/b2RYMnFFZKc6EUCaiCm2mI8tlifsKsXv+WIV
ozcz6AEZDQxdy3MMgskTCoNbMP7h/AFn7mVq0lbWGzYDj/EDLcibJlX8Sh58X+xl
8fGTMfFVhNw2j/YU7rj9j8MYtqfkLim2rWK6j1/ov/dyB1mEZ6sGXJ3CAS0YwXod
UEgOACScl1tyD+trG/y7dKp4K3SR54kOpCtGHjvS9IWsHgFJsJLKP8bmj0RzE+Ey
c58uoJ3q6IHDNyIuB164Axoo7yEM6Dv1TDtn8vDwC13jCq8l1BqwRkl83xniptKE
gfuBvqEAo5+jUpfer+iZ3K2ZBiStsyoaF4EH8wDj76m1FptjzTW8Yf4SbByfXYNp
XJ+qlQjpWeSvZ9n8xELdYQ2GItu2ktIoDIG/TeLfFSrW4hl9qdX05vIGoTOoZJs+
UoPG/sSQDZ44SdzpjlEXIXm+reXAzxKnJrxOuuHz1zSVj6k6paA8dpGDjV1BLPDE
WJ+KEAGOTeH9dVRO7jaJ
=M6+t
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Wed, 30 Apr 2014 10:51:14 GMT) ([full text](bugreport.cgi?bug=746306;msg=58), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=58), [link](#57)).

---

**Acknowledgement sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Wed, 30 Apr 2014 10:51:14 GMT) ([full text](bugreport.cgi?bug=746306;msg=60), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=60), [link](#59)).

---

[Message #61](#61) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=61), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=61), reply):

![](/cgi-bin/libravatar.cgi?email=javier%40jasp.net)
From: Javier Serrano Polo <javier@jasp.net>
To: 746306@bugs.debian.org
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the
vulnerability into squeeze
Date: Wed, 30 Apr 2014 12:46:34 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=746306;msg=61) (text/plain, inline)]
```
```
Here it is the missing file.

However, this is not over.

```
```
[[exploto_0.1.debian.tar.gz](bugreport.cgi?att=1;bug=746306;filename=exploto_0.1.debian.tar.gz;msg=61) (application/x-compressed-tar, attachment)]
```
```
[[smime.p7s](bugreport.cgi?att=2;bug=746306;filename=smime.p7s;msg=61) (application/pkcs7-signature, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Wed, 30 Apr 2014 12:51:08 GMT) ([full text](bugreport.cgi?bug=746306;msg=63), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=63), [link](#62)).

---

**Acknowledgement sent**
to `Raphael Geissert <geissert@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Wed, 30 Apr 2014 12:51:08 GMT) ([full text](bugreport.cgi?bug=746306;msg=65), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=65), [link](#64)).

---

[Message #66](#66) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=66), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=66), reply):

![](/cgi-bin/libravatar.cgi?email=geissert%40debian.org)
From: Raphael Geissert <geissert@debian.org>
To: Guillem Jover <guillem@debian.org>
Cc: Jakub Wilk <jwilk@debian.org>, 746306@bugs.debian.org,
javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the vulnerability
into squeeze
Date: Wed, 30 Apr 2014 14:45:36 +0200
```
Hi Guillem,

On 30 April 2014 01:36, Guillem Jover <guillem@debian.org> wrote:
[...]
> Attached a non-tested quick patch implementing this. I'll start
> testing it and preparing packages for all suites.

In case you were waiting for an ACK, please go ahead. I'll handle the
update soon after they've hit the sec archive.

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dpkg Developers <debian-dpkg@lists.debian.org>`:

`Bug#746306`; Package `dpkg`.
(Wed, 30 Apr 2014 13:06:05 GMT) ([full text](bugreport.cgi?bug=746306;msg=68), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=68), [link](#67)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Dpkg Developers <debian-dpkg@lists.debian.org>`.
(Wed, 30 Apr 2014 13:06:05 GMT) ([full text](bugreport.cgi?bug=746306;msg=70), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=70), [link](#69)).

---

[Message #71](#71) received at 746306@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=71), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=71), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: Raphael Geissert <geissert@debian.org>, 746306@bugs.debian.org
Cc: Jakub Wilk <jwilk@debian.org>,
javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net,
Debian Security Team <team@security.debian.org>
Subject: Re: Bug#746306: dpkg: CVE-2014-0471 fix introduces the vulnerability
into squeeze
Date: Wed, 30 Apr 2014 15:03:11 +0200
```
On Wed, 2014-04-30 at 14:45:36 +0200, Raphael Geissert wrote:
> On 30 April 2014 01:36, Guillem Jover <guillem@debian.org> wrote:
> [...]
> > Attached a non-tested quick patch implementing this. I'll start
> > testing it and preparing packages for all suites.
>
> In case you were waiting for an ACK, please go ahead. I'll handle the
> update soon after they've hit the sec archive.

Ok thanks, I'm preparing the uploads for squeeze and wheezy right
away. The wheezy one contains some translation updates, hope that's
fine.

Thanks,
Guillem

```

---

**Added tag(s) pending.**
Request was from `Guillem Jover <guillem@debian.org>`
to `control@bugs.debian.org`.
(Wed, 30 Apr 2014 13:51:08 GMT) ([full text](bugreport.cgi?bug=746306;msg=73), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=73), [link](#72)).

---

**Message sent on**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug#746306.
(Wed, 30 Apr 2014 13:51:22 GMT) ([full text](bugreport.cgi?bug=746306;msg=75), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=75), [link](#74)).

---

[Message #76](#76) received at 746306-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=76), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=76), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746306-submitter@bugs.debian.org
Subject: Bug#746306 marked as pending
Date: Wed, 30 Apr 2014 13:48:51 +0000
```
tag 746306 pending
thanks

Hello,

Bug #746306 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=2389c75>

---
commit 2389c7542534e2f44ed3b8b2ad3fded559e8ca26
Author: Guillem Jover <guillem@debian.org>
Date:   Wed Apr 30 02:28:45 2014 +0200

    Dpkg::Source::Patch: Outright reject C-style filenames in patches

    Cherry picked from commit d49704f7fd699e809aead799a1dd4d20d969665a.

    Because patch only started recognizing C-style filenames in diffs
    in version 2.7, it's not safe to assume one behaviour or the other,
    as the system might or might not have a recent enough version, or
    a GNU patch program at all. There's also no reason we should be
    supporting this kind of strange encoded filenames in patches, when
    we have not done so up to now.

    Let's just ban these types of diffs and be done with it.

    Fixes: [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471)
    Closes: #[746306](bugreport.cgi?bug=746306)

diff --git a/debian/changelog b/debian/changelog
index 242a02b..14fbf2f 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,11 @@
+dpkg (1.15.10) UNRELEASED; urgency=low
+
+  [ Guillem Jover ]
+  * Do not allow patch files with C-style encoded filenames. Closes: #[746306](bugreport.cgi?bug=746306)
+    Unconditionally fixes [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471).
+
+ -- Guillem Jover <guillem@debian.org>  Wed, 30 Apr 2014 15:14:11 +0200
+
 dpkg (1.15.9) squeeze-security; urgency=high

   * Correctly parse C-style diff filenames in Dpkg::Source::Patch, to avoid

```

---

**Message sent on**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug#746306.
(Wed, 30 Apr 2014 13:51:25 GMT) ([full text](bugreport.cgi?bug=746306;msg=78), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=78), [link](#77)).

---

[Message #79](#79) received at 746306-submitter@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=79), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=79), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746306-submitter@bugs.debian.org
Subject: Bug#746306 marked as pending
Date: Wed, 30 Apr 2014 13:48:59 +0000
```
tag 746306 pending
thanks

Hello,

Bug #746306 reported by you has been fixed in the Git repository. You can
see the changelog below, and you can check the diff of the fix at:

    <http://git.debian.org/?p=dpkg/dpkg.git;a=commitdiff;h=d49704f>

---
commit d49704f7fd699e809aead799a1dd4d20d969665a
Author: Guillem Jover <guillem@debian.org>
Date:   Wed Apr 30 02:28:45 2014 +0200

    Dpkg::Source::Patch: Outright reject C-style filenames in patches

    Cherry picked from commit a12eb58959d0a10584a428f4a3103a49204c410f.

    Because patch only started recognizing C-style filenames in diffs
    in version 2.7, it's not safe to assume one behaviour or the other,
    as the system might or might not have a recent enough version, or
    a GNU patch program at all. There's also no reason we should be
    supporting this kind of strange encoded filenames in patches, when
    we have not done so up to now.

    Let's just ban these types of diffs and be done with it.

    Fixes: [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471)
    Closes: #[746306](bugreport.cgi?bug=746306)

diff --git a/debian/changelog b/debian/changelog
index c19f42f..1a65e57 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,5 +1,9 @@
 dpkg (1.16.14) UNRELEASED; urgency=low

+  [ Guillem Jover ]
+  * Do not allow patch files with C-style encoded filenames. Closes: #[746306](bugreport.cgi?bug=746306)
+    Unconditionally fixes [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471).
+
   [ Updated scripts translations ]
   * German (Helge Kreutzmann).

```

---

**Reply sent**
to `Guillem Jover <guillem@debian.org>`:

You have taken responsibility.
(Sun, 04 May 2014 21:36:28 GMT) ([full text](bugreport.cgi?bug=746306;msg=81), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=81), [link](#80)).

---

**Notification sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug acknowledged by developer.
(Sun, 04 May 2014 21:36:28 GMT) ([full text](bugreport.cgi?bug=746306;msg=83), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=83), [link](#82)).

---

[Message #84](#84) received at 746306-close@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=84), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=84), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746306-close@bugs.debian.org
Subject: Bug#746306: fixed in dpkg 1.16.14
Date: Sun, 04 May 2014 21:32:13 +0000
```
Source: dpkg
Source-Version: 1.16.14

We believe that the bug you reported is fixed in the latest version of
dpkg, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 746306@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover <guillem@debian.org> (supplier of updated dpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Wed, 30 Apr 2014 08:14:16 +0200
Source: dpkg
Binary: libdpkg-dev dpkg dpkg-dev libdpkg-perl dselect
Architecture: source amd64 all
Version: 1.16.14
Distribution: wheezy-security
Urgency: high
Maintainer: Dpkg Developers <debian-dpkg@lists.debian.org>
Changed-By: Guillem Jover <guillem@debian.org>
Description:
 dpkg       - Debian package management system
 dpkg-dev   - Debian package development tools
 dselect    - Debian package management front-end
 libdpkg-dev - Debian package management static library
 libdpkg-perl - Dpkg perl modules
Closes: [746306](bugreport.cgi?bug=746306)
Changes:
 dpkg (1.16.14) wheezy-security; urgency=high
 .
   [ Guillem Jover ]
   * Do not allow patch files with C-style encoded filenames. Closes: #[746306](bugreport.cgi?bug=746306)
     Unconditionally fixes [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471).
 .
   [ Updated scripts translations ]
   * German (Helge Kreutzmann).
 .
   [ Updated man page translations ]
   * German (Helge Kreutzmann).
Checksums-Sha1:
 cb23376408e2551d7384a5b86c006f4fca8e0914 2016 dpkg_1.16.14.dsc
 9f469aaef4083d1dabb278ccd4b2783d64bc8824 3790568 dpkg_1.16.14.tar.xz
 36ce26ac0d8bf880e522d5656dd41dc798f7ab10 694282 libdpkg-dev_1.16.14_amd64.deb
 002236bb0381d06878861946f11ad53fe185e49f 2651488 dpkg_1.16.14_amd64.deb
 a533517abc2515ef24bf4a1bdfdab40539622751 1157222 dselect_1.16.14_amd64.deb
 0329ddab5cd92f2dd71d814dd272a30b86b5a029 1352280 dpkg-dev_1.16.14_all.deb
 80bd4641fbe28f7e7ffc7d9f87d09b2f5bbac85b 955608 libdpkg-perl_1.16.14_all.deb
Checksums-Sha256:
 e0f7fbc2e28da300993bd04b2462ccf9bcfe07ff8146a1ca21dfdee732be6f05 2016 dpkg_1.16.14.dsc
 3cdaf40cfdaed20000e440a984c9237c780539e1131a5d8a9c11bacbda34473f 3790568 dpkg_1.16.14.tar.xz
 347dae3f2ffd688fa4189bb8e8af61e5924099f314f082f2c9c760c7a6c01095 694282 libdpkg-dev_1.16.14_amd64.deb
 ad91edf0c742e8b813e4a6150bf51b7be8060d773f9da31947b984aed7e7e129 2651488 dpkg_1.16.14_amd64.deb
 7b509901a0b69ab642db2410cdfd527098f2bf37cfb78bce95d370d4f7d75027 1157222 dselect_1.16.14_amd64.deb
 1ee6dc0511611ea3e07095adf139acc102bfbf934bfc9dfd69f99957afdce5cd 1352280 dpkg-dev_1.16.14_all.deb
 3709bfe1856711a45364133e03a41fe4ac00a48f9491a63da09dd2ac1aee7a93 955608 libdpkg-perl_1.16.14_all.deb
Files:
 a58d05b4f9eca505a06ae167ad156801 2016 admin required dpkg_1.16.14.dsc
 235f4368451a8e696fc7d92007ff9125 3790568 admin required dpkg_1.16.14.tar.xz
 d04c04ffc6a22a3a4efd8e9cc120ad00 694282 libdevel optional libdpkg-dev_1.16.14_amd64.deb
 8de5c017fa40d82a7195645f85e6fb13 2651488 admin required dpkg_1.16.14_amd64.deb
 f19c74bd266c5ab6729b33d75310335a 1157222 admin optional dselect_1.16.14_amd64.deb
 4341983ef7669a0e040873e8da642953 1352280 utils optional dpkg-dev_1.16.14_all.deb
 2d3da3565c2baa45c0069434c8516cb2 955608 perl optional libdpkg-perl_1.16.14_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBCAAGBQJTYP5pAAoJELlyvz6krlej+Z4P/AjGVOFLf25nzKSG8ZCCMQnm
6CvzGiBadpS6RYcWyZs7wXYq7KfzqWBLSWAWk+0XylRVD3bCTu89j7wRf+RyvE3b
UoaMueEmxBGH/TmLLMIyaDsExZb9p7fw2/pu9ZiSmNMV4oGg1WNuUTPKNeshT/4B
G9kDC/+5C9/5sNh0cZrlSti73QqVw22DMlXA7vw2ZFYgnwarKrP83vHQZXSovLej
FkEKDSyQiEBM9SQ5t5lO5o2lycSIjxsnmwqc6xj7jKmh1WZ+x+/0kJqDWCGag6F7
Gok5Zyn55lqx6bPM+V9NvUCMKWJta2efNSAunBKhWGoH1k5nUNWximN6M5veEMd/
psWg+yiyH3C+E3FywuN6I24n4KGSalyEmQEsLmCZho7ky1oAgOxKRXAVExoilz1H
FwTgLiXv6dj1TkBe1Njx9kwVg7tW7JQCeO3N2Zy8Mewy8HFVvGZdimRrLOE9hZab
1GH0otAWIYcrYxFfw7lIHucsptr78qsu6DurGYkuFWv0MsoCp6f9GVdfkv2JZMvD
d0Lpt06W47kLauQrOjZIz6OcKE+3wEHNFYttKYQa8146o5/cAW0tnLWNGKSRWesD
AmJaLQkn1YnmnjtGznDXf9oLdjoQ67+w9NPQR3GSvz4CbX9ZFCWfZrUvLIhrGncA
KEPGfTqS2An/Qng8u9qY
=JPzK
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Guillem Jover <guillem@debian.org>`:

You have taken responsibility.
(Wed, 07 May 2014 22:51:19 GMT) ([full text](bugreport.cgi?bug=746306;msg=86), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=86), [link](#85)).

---

**Notification sent**
to `javier--7C8FrOsBhwV6hRgYM4mLHJBYcgPTm9@jasp.net`:

Bug acknowledged by developer.
(Wed, 07 May 2014 22:51:19 GMT) ([full text](bugreport.cgi?bug=746306;msg=88), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=88), [link](#87)).

---

[Message #89](#89) received at 746306-close@bugs.debian.org ([full text](bugreport.cgi?bug=746306;msg=89), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=89), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: 746306-close@bugs.debian.org
Subject: Bug#746306: fixed in dpkg 1.15.10
Date: Wed, 07 May 2014 22:47:36 +0000
```
Source: dpkg
Source-Version: 1.15.10

We believe that the bug you reported is fixed in the latest version of
dpkg, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 746306@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Guillem Jover <guillem@debian.org> (supplier of updated dpkg package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Wed, 30 Apr 2014 15:15:09 +0200
Source: dpkg
Binary: libdpkg-dev dpkg dpkg-dev libdpkg-perl dselect
Architecture: source amd64 all
Version: 1.15.10
Distribution: squeeze-security
Urgency: high
Maintainer: Dpkg Developers <debian-dpkg@lists.debian.org>
Changed-By: Guillem Jover <guillem@debian.org>
Description:
 dpkg       - Debian package management system
 dpkg-dev   - Debian package development tools
 dselect    - Debian package management front-end
 libdpkg-dev - Debian package management static library
 libdpkg-perl - Dpkg perl modules
Closes: [746306](bugreport.cgi?bug=746306)
Changes:
 dpkg (1.15.10) squeeze-security; urgency=high
 .
   [ Guillem Jover ]
   * Do not allow patch files with C-style encoded filenames. Closes: #[746306](bugreport.cgi?bug=746306)
     Unconditionally fixes [CVE-2014-0471](https://security-tracker.debian.org/tracker/CVE-2014-0471).
Checksums-Sha1:
 f2209ccc7d4826f0f12b2ba4993d71b0bc247284 1844 dpkg_1.15.10.dsc
 f2c72b7a9bfccad2cabca9398b139a2b732f6b2b 5264376 dpkg_1.15.10.tar.bz2
 1b4aae62081e28bf0a58f9ce4f3047b9408371c2 438696 libdpkg-dev_1.15.10_amd64.deb
 fc74f45f518a9428bf510cb025cf23cbf68401c5 2399996 dpkg_1.15.10_amd64.deb
 3dda8b3580dfc8b77f8da8679c9624567cff12f2 907360 dselect_1.15.10_amd64.deb
 45f4b535a700be1ce115b0c8f28bcc60af2a927c 813812 dpkg-dev_1.15.10_all.deb
 06d85c884192a9940037809c1e385fb925a9854d 695864 libdpkg-perl_1.15.10_all.deb
Checksums-Sha256:
 91f80b5d11ca42698c36cc984ca01214e5cf4938622c0f210db31cb7b968f37b 1844 dpkg_1.15.10.dsc
 dd89a48007b3532e44e2da205138f734b5de61a97610a24014ce7b2177e60cd4 5264376 dpkg_1.15.10.tar.bz2
 fdf1138477a7d5d57411097a6072bbf3d81c274eb6c1248bade560925c2578ae 438696 libdpkg-dev_1.15.10_amd64.deb
 0354df07175db056962e4d4e945a58276d5a46d9adccadb65985a63857558a22 2399996 dpkg_1.15.10_amd64.deb
 10506c4a2be38d3aaafbea7fed88c64158a8d1525e3aef999e05f85bc5fd567a 907360 dselect_1.15.10_amd64.deb
 c521126f45747849abac8fb6943203e60c9c0724d7cbcffcb2521957d05aae07 813812 dpkg-dev_1.15.10_all.deb
 07fb89dae2acd61246880d2f4c13052944cca681b2c72acfa119fed039a52c8a 695864 libdpkg-perl_1.15.10_all.deb
Files:
 fc1e5c58b6df4390f5733677af8cec8b 1844 admin required dpkg_1.15.10.dsc
 1f51f4bb93799e7c338bc5fbe71d1ed1 5264376 admin required dpkg_1.15.10.tar.bz2
 8c9840b53bdcd34fbac53e930ae04089 438696 libdevel optional libdpkg-dev_1.15.10_amd64.deb
 db86693607163dcfc60fa8ba199b9ed2 2399996 admin required dpkg_1.15.10_amd64.deb
 97cba51293bc2ed88435b73c5352729a 907360 admin optional dselect_1.15.10_amd64.deb
 4702e61f79e457c53de584a3d59199fb 813812 utils optional dpkg-dev_1.15.10_all.deb
 7e0dbbb37721a7f9323424fbfdd03d55 695864 perl optional libdpkg-perl_1.15.10_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQIcBAEBCAAGBQJTYP4AAAoJELlyvz6krlejfpAQAMGr8MmviKl0EV16c2BWeGHO
1sZcJY3KQo4CRMFge3EAapN02udQUFPGqKIELLO4Qz7mNEI7U+xMQNaLr2rmNXkj
pqy0y96IApEty9Icca31EiVZ9gKlVV9Cundz1KOUGCr6lVrzz/3N6oT3FMdSG3Yr
o93jWbLDXwjnMqyFHK2KrRPv0JPqw4LoxThH6v4v1kyPHSreBshbov0YArjbDN48
W2zdNZd3KG6MGQIXbJq/PlGqPvQus/Us9UbCydGHxI2zExsyUOD+XcVh7PxlmNLx
3HhI9dmUf9XGrZuNRrAS1rz43LnRbwI1foV4xhKqfoO5bu6d1A0eHf9FMGArKYzE
o2Zkle6X2ALB7K+8JJGXaUCtcUkg/fTsyLyrclfNvrY2usGNg9TvV/MkPW5AXa4y
r1Y+3qMfndHuNcPeBuv+GvjHEMzM/XTuo9ybTOsjQXTK+rchVFjNzYVTTtEwm+S2
KGM9fEu/cf7njFZS/6WeeWwrMcn0gcXIBVb6KWAXlF0UV6AZg6c3IGRtuyWkSAId
7+/THGSbKiN4dZaSNsfdYaSR5yiAm4ASoHlw+wsit8nSG8WZOqQpIo2H56ERzelo
a/f4UsHVEnFmMCcjM7GpHZwmameetyTRTAFIbFa26JxzjlGrtZNt7UOgTWCwzVNk
VH2dlvJlBxWYvLyQ20Jn
=U5G2
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Thu, 05 Jun 2014 07:26:06 GMT) ([full text](bugreport.cgi?bug=746306;msg=91), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=91), [link](#90)).

---

**Bug unarchived.**
Request was from `Samuel Bronson <naesten@gmail.com>`
to `control@bugs.debian.org`.
(Sun, 29 Jun 2014 20:51:04 GMT) ([full text](bugreport.cgi?bug=746306;msg=93), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=93), [link](#92)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 28 Jul 2014 07:25:18 GMT) ([full text](bugreport.cgi?bug=746306;msg=95), [mbox](bugreport.cgi?bug=746306;mbox=yes;msg=95), [link](#94)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=746306).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 00:28:48 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from seclists.org_efbbf358_20250125_002846.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](190)
[By Date](date.html#191)
[![Next](/images/right-icon-16x16.png)](192)

[![Previous](/images/left-icon-16x16.png)](199)
[By Thread](index.html#191)
[![Next](/images/right-icon-16x16.png)](227)

![](/shared/images/nst-icons.svg#search)

# CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze

---

*From*: Raphael Geissert <geissert () debian org>

*Date*: Tue, 29 Apr 2014 16:59:38 +0200

---

```
Hi,

The recent update[1] of dpkg for CVE-2014-0471 in Debian squeeze (and
possibly Ubuntu lucid[2]) actually introduces a vulnerability in that
release[3], while it was not affected by the original vulnerability.
The newly introduced vulnerability is dependent on the version of
patch(1) that is installed on the system, so that:

updated dpkg in squeeze + patch(1) from squeeze = vulnerable
updated dpkg in squeeze + patch(1) from wheezy = not vulnerable
updated dpkg in wheezy + patch(1) from squeeze = vulnerable (but not confirmed)
updated dpkg in wheezy + patch(1) from wheezy = not vulnerable

In other words, if the updated dpkg package is not installed in a
squeeze system, this new vulnerability would only be exposed if a
system is partially upgraded to wheezy.

Given that at least one PoC demonstrates that squeeze's updated
package is vulnerable, while the previous dpkg in wheezy isn't (it
refuses to unpack the package), I think this is a new vulnerability
and should therefore receive its own CVE.

If you agree, could you please assign one?

Thanks in advance.

[1]<https://www.debian.org/security/2014/dsa-2915>
[2]<http://www.ubuntu.com/usn/usn-2183-1/>
[3]<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746306>

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

---

[![Previous](/images/left-icon-16x16.png)](190)
[By Date](date.html#191)
[![Next](/images/right-icon-16x16.png)](192)

[![Previous](/images/left-icon-16x16.png)](199)
[By Thread](index.html#191)
[![Next](/images/right-icon-16x16.png)](227)

### Current thread:

* **CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze** *Raphael Geissert (Apr 29)*
  + [Re: CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze](227) *cve-assign (May 01)*
    - [Re: Re: CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze](356) *Raphael Geissert (May 25)*
      * [Re: Re: CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze](359) *Guillem Jover (May 25)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_f4ce6330_20250125_002846.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](226)
[By Date](date.html#227)
[![Next](/images/right-icon-16x16.png)](228)

[![Previous](/images/left-icon-16x16.png)](191)
[By Thread](index.html#227)
[![Next](/images/right-icon-16x16.png)](356)

![](/shared/images/nst-icons.svg#search)

# Re: CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze

---

*From*: cve-assign () mitre org

*Date*: Thu, 1 May 2014 20:52:37 -0400 (EDT)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> The recent update of dpkg for CVE-2014-0471 in Debian squeeze actually
> introduces a vulnerability in that release
>
> ```

```

This is a somewhat unusual situation from the perspective of CVE
assignment. The outcome of 746306 is that C-style filenames aren't
accepted. However, we probably can't assign a CVE ID for a root cause
of "attempts to support C-style filenames," because supporting those
filenames isn't inherently unsafe if an OS vendor is programmatically,
or by policy, ensuring that the patch program is one that interacts
safely with that support.

The

  updated dpkg in squeeze + patch(1) from squeeze = vulnerable

behavior is something that seems to be best categorized as a release
engineering problem. Although there are very few cases in which CVE
IDs have been assigned for release engineering problems, these
problems can be within the scope of CVE, and the current one is. Use
CVE-2014-3127 for this issue. In other words, because squeeze's new
dpkg program is incompatible, in a security-relevant way, with
squeeze's patch program, the two should not have been allowed to exist
together within any correctly maintained/supported squeeze
environment.

However, there is another question that could possibly result in a
second CVE ID. On wheezy, there's apparently a security problem in, at
least, these two cases:

  1. the installed patch program is an older version of patch that's
     identical to squeeze's supported version of patch. Possibly, this
     can happen on a correctly maintained/supported Debian system
     because sometimes a system is in a partially upgraded state. In
     particular, the vulnerability affects root's use of dpkg, which
     may be a completely expected activity because the administrator
     might want to unpack a source package even though an upgrade is
     unfinished.

  2. the patch program in root's path is not something obtained from
     Debian, e.g., the administrator intentionally decided to install
     a non-GNU patch program

We're not sure what can be done about case 1. The general issue is
that, when doing an upgrade of an arbitrary OS, the system might
intermittently be in a state in which incompatibility of
old-OS-version programs and new-OS-version programs has a major
security risk. Maybe the right answer is a policy that nobody is
allowed to do anything while an upgrade is in progress. In other
words, regular users may not be logged in, and root should only be
running the upgrade program and nothing else. ("nothing else" is
impractical; realistically, risk is reduced by running as little else
as possible.)

Case 2 possibly violates the expectations of the concept of a Linux
distribution OS or other OS. In other words, the dpkg program requires
the patch program, and therefore the administrator must ensure that
the patch program (at least, in root's path) is the one provided by
the OS vendor. If the administrator decided to install any other patch
program, the resulting security problem would typically be considered
a site-specific problem and thus outside the scope of CVE. However, a
CVE ID could be assigned of any of these is true:

  - on wheezy, dpkg doesn't have any explicit requirements about the
    patch program

  - the dpkg documentation states that a non-GNU patch program can be
    used if desired

  - Debian has a general policy that a supported program (such as
    dpkg) must be robust in the face of non-standard but reasonable
    site-specific software changes. In other words, if Debian program
    1 allows arbitrary code execution in situations where the
    administrator replaces Debian program 2 with an
    often-considered-equivalent non-Debian program, this is supposed
    to be treated as a vulnerability in Debian program 1.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJTYustAAoJEKllVAevmvmswDgIAIhRUCoIuvrHcrVlhEH2aicu
4eacUenhaY1BfLg167t+csxZooZClRzsykhoun36VlrTT9jzLTBHjrSwupwIaNia
LvdmEEMgRcig0nPIl0233Jew3vIWXD+BJcQXOyyGPmjOmWWUew6JO+hkuDGg2JTr
r3nyNPQafsbdfBWGZ0rnmOqp+gUc+3bgqReVtsogcXvd0yVbKMFdWm1kuOIHeevf
ZWdmBdF2cwWyCGk9SAvRVGj15HxFlmmyuQ4u0PN2oxzbLd8cooJGmZnWz/q8X+h7
A4srxRFTqyHceZgWB0cqsXyjY9oiFEqweC+pA1WHozu+2f2D6isBoH1WYjLOA8c=
=PQIS
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](226)
[By Date](date.html#227)
[![Next](/images/right-icon-16x16.png)](228)

[![Previous](/images/left-icon-16x16.png)](191)
[By Thread](index.html#227)
[![Next](/images/right-icon-16x16.png)](356)

### Current thread:

* [CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze](191) *Raphael Geissert (Apr 29)*
  + **Re: CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze** *cve-assign (May 01)*
    - [Re: Re: CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze](356) *Raphael Geissert (May 25)*
      * [Re: Re: CVE request: directory traversal in DSA-2915-1-patched dpkg in Debian squeeze](359) *Guillem Jover (May 25)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


