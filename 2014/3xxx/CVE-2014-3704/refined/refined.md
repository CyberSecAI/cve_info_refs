```
{
  "vulnerability": {
    "cveID": "CVE-2014-3704",
    "description": "The provided content describes a SQL injection vulnerability in Drupal versions 7.x prior to 7.32. This vulnerability stems from how Drupal's database abstraction API handles prepared statements, specifically when expanding array arguments in an IN clause.",
    "rootCause": "The vulnerability lies within the `expandArguments` function in Drupal's database abstraction layer. This function incorrectly processes array arguments with non-integer keys, leading to the injection of arbitrary SQL code.",
    "weaknesses": [
      "SQL Injection: The core weakness is the failure to sanitize or properly handle array keys within SQL queries, allowing an attacker to inject arbitrary SQL.",
        "Improper Input Validation: The `expandArguments` function does not validate the keys of the input array, allowing non-integer keys, which causes the vulnerability."
    ],
    "impact": "A successful exploit allows an attacker to:\n\n  - Execute arbitrary SQL queries.\n  - Insert, modify, or delete data in the database.\n  - Achieve remote code execution by inserting malicious data and leveraging Drupal's form handling mechanisms.",
    "attackVectors": [
      "HTTP Request Manipulation: The vulnerability is exploited by crafting a malicious HTTP request containing a specially crafted cookie or POST parameter with injected SQL code.",
      "Unauthenticated Access:  The vulnerability is exploitable without any prior authentication, making it highly critical.",
       "Cookie Manipulation:  The vulnerability can be triggered by manipulating insecure session cookies."
    ],
      "requiredCapabilities": "An attacker needs to be able to send crafted HTTP requests to a vulnerable Drupal instance. No authentication is needed to trigger the vulnerability.",
      "additionalDetails": "The vulnerability exists in how Drupal handles prepared statements and expands array arguments. The `expandArguments` function is flawed in how it generates placeholders for IN clauses when array keys are non-integers, leading to SQL injection. This can be exploited through various entry points, including session handling and form submissions, and ultimately allows for remote code execution via form callbacks."
  }
}
```