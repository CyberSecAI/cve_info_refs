=== Content from projects.theforeman.org_d6e7eece_20250125_065605.html ===


âš²

### Project

### General

### Profile

* [Sign in](/login)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/foreman/search?scope=subprojects):

 Foreman[All Projects](/projects?jump=issues)
#

* [Overview](/projects/foreman)
* [Activity](/projects/foreman/activity)
* [Roadmap](/projects/foreman/roadmap)
* [Issues](/projects/foreman/issues)
* [Wiki](/projects/foreman/wiki)
* [Repository](/projects/foreman/repository)

### Custom queries

* [3.11.5 release DONE](/projects/foreman/issues?query_id=182)
* [3.11.5 release TODO](/projects/foreman/issues?query_id=186)
* [3.12.2 release DONE](/projects/foreman/issues?query_id=181)
* [3.12.2 release TODO](/projects/foreman/issues?query_id=168)
* [3.13.0 release DONE](/projects/foreman/issues?query_id=176)
* [3.13.0 release TODO](/projects/foreman/issues?query_id=167)
* [All bugs by votes](/projects/foreman/issues?query_id=25)
* [All issues closed in the last 3 weeks](/projects/foreman/issues?query_id=102)
* [Easy and Trivial Issues](/projects/foreman/issues?query_id=42)
* [Easy Issues (only)](/projects/foreman/issues?query_id=11)
* [Foreman - new open issues in last 10 days](/projects/foreman/issues?query_id=179)
* [Good first issues - Foreman core](/projects/foreman/issues?query_id=131)
* [high prio open bugs](/projects/foreman/issues?query_id=133)
* [Host registration [open]](/projects/foreman/issues?query_id=158)
* [Mine](/projects/foreman/issues?query_id=128)
* [My issues closed in the last 3 weeks](/projects/foreman/issues?query_id=132)
* [old bugs](/projects/foreman/issues?query_id=159)
* [Open with target version set (aka blockers)](/projects/foreman/issues?query_id=134)
* [registration](/projects/foreman/issues?query_id=173)
* [taken-none](/projects/foreman/issues?query_id=117)
* [Team Atlas untriaged bugs](/projects/foreman/issues?query_id=166)
* [templates](/projects/foreman/issues?query_id=172)
* [Trivial Issues](/projects/foreman/issues?query_id=10)
* [Untriaged and opened in the past two weeks](/projects/foreman/issues?query_id=144)

Actions
Copy link
## Bug #5881

closed
![](https://www.gravatar.com/avatar/e36bafa4e8bbf7ed347fdfa34d647591?rating=PG&size=50&default=identicon "Author: Dominic Cleal")
![](https://www.gravatar.com/avatar/2e3458169ec423666270dfe6ae600742?rating=PG&size=22&default=identicon "Assignee: Joseph Magen")

### CVE-2014-3491 - XSS from create/update/destroy notification boxes

Added by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-05-22 "05/22/2014 02:40 PM") ago.
Updated [over 6 years](/projects/foreman/activity?from=2018-07-10 "07/10/2018 12:50 PM") ago.

Status:ClosedPriority:HighAssignee:[Joseph Magen](/users/3472)Category:SecurityTarget version:[1.4.5](/versions/512)
Difficulty:Triaged:Bugzilla link:[1100313](https://bugzilla.redhat.com/show_bug.cgi?id=1100313)Pull request:Fixed in Releases:Found in Releases:Red Hat JIRA:|  |

---

**Description**

possible XSS: Configure -> Host groups - key name with HTML evaluated when submitted

How reproducible:
always

Steps to Reproduce:
1. In webUI go to Configure -> Host groups -> New Host groups
2. Fill in this:
 Name: test<script>alert('HI')</script>

```
Click "Submit" to create the hostgroup
3. Note that parameter name is correctly escaped in the parameters list
```

Actual results:
Once the hostgroup is SUBMITED, JavaScript alert window appears (script gets executed)

Expected results:
Submit button should not execute javascript

---

**Files**

| [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/857) | [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/download/857/0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch "Download") | 3.8 KB | v1 patch | Dominic Cleal, 06/10/2014 04:23 PM |  |
| --- | --- | --- | --- | --- | --- |
| [0002-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/858) | [0002-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/download/858/0002-fixes-5881-XSS-from-create-update-destroy-notificati.patch "Download") | 3.71 KB |  | Joseph Magen, 06/11/2014 01:19 PM |  |
| [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/864) | [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/download/864/0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch "Download") | 4.84 KB | v3 patch against develop | Dominic Cleal, 06/17/2014 04:03 PM |  |
| [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/865) | [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/download/865/0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch "Download") | 3.38 KB | v3 patch against 1.4-stable | Dominic Cleal, 06/17/2014 04:04 PM |  |

---

**Related issues**
[3](/issues?issue_id=6351%2C6402%2C6903&set_filter=true&status_id=%2A) (0 open â€” [3 closed](/issues?issue_id=6351%2C6402%2C6903&set_filter=true&status_id=c))

|  | Related to Foreman - [Bug #6351](/issues/6351): <br /> seen in UI errors when multiple errors exist on a resource | Duplicate |  | 06/24/2014 |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |
|  | Related to Foreman - [Bug #6402](/issues/6402): Using "run puppet" feature fails: undefined method `gsub' for #<Array ...> | Closed | [Dominic Cleal](/users/3536) | 06/26/2014 |  |  | Actions |
|  | Related to Foreman - [Bug #6903](/issues/6903): "<br/>" in text when receiving error while deleting multiple hosts | Closed |  | 08/04/2014 |  |  | Actions |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/5881?tab=history)
* [Notes](/issues/5881?tab=notes)
* [Property changes](/issues/5881?tab=properties)
* [Associated revisions](/issues/5881?tab=changesets)

ActionsCopy link
[#1](#note-1)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-05-22 "05/22/2014 02:42 PM") ago

* **Subject** changed from *XSS from create/update/destroy notification boxes* to *EMBARGOED: XSS from create/update/destroy notification boxes*

ActionsCopy link
[#2](#note-2)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-05-22 "05/22/2014 02:44 PM") ago

This appears to be coming from the popup notifications in the UI that appear when creating/updating/deleting resources. I suppose one user could create a resource with such a name and then another user could try editing or deleting it to execute the script, but when creating, a user is only going to be able to attach themselves.

The host group name is also formatted strangely in the host groups list, may be worth checking out at the same time.

(I've also seen this when deleting config groups and templates, it's a problem generally with the process\_success type notifications.)

ActionsCopy link
[#3](#note-3)
#### Updated by [Joseph Magen](/users/3472) [over 10 years](/projects/foreman/activity?from=2014-05-27 "05/27/2014 01:41 PM") ago

* **Status** changed from *New* to *Assigned*

Rails automatic escapes/sanitizes text strings when saving to the db, so this is the reason of the "strange formatting"

I emailed patch.

ActionsCopy link
[#4](#note-4)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-05-27 "05/27/2014 01:43 PM") ago

Please just attach the patch for review here, thanks.

ActionsCopy link
[#5](#note-5)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-10 "06/10/2014 04:24 PM") ago

* **File** [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/857) [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/download/857/0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch "Download") added
* **Assignee** set to *Joseph Magen*

Attached is the v1 patch.

Works well, though could we escape the HTML rather than sanitizing it? Just so the actual name fully shows up.

I looked into the index name display, it's just a bug in the ancestry\_helper, pretty sure it's harmless. I'll file another bug once this is unembargoed.

ActionsCopy link
[#6](#note-6)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-10 "06/10/2014 04:25 PM") ago

* **Translation missing: en.field\_release** set to *16*

ActionsCopy link
[#7](#note-7)
#### Updated by [Joseph Magen](/users/3472) [over 10 years](/projects/foreman/activity?from=2014-06-11 "06/11/2014 01:22 PM") ago

* **File** [0002-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/858) [0002-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/download/858/0002-fixes-5881-XSS-from-create-update-destroy-notificati.patch "Download") added
* **Status** changed from *Assigned* to *Ready For Testing*

new patch attached that uses CGI::escapeHTML rather than ActionController::Base.helpers.sanitize

ActionsCopy link
[#8](#note-8)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-11 "06/11/2014 03:24 PM") ago

* **Subject** changed from *EMBARGOED: XSS from create/update/destroy notification boxes* to *EMBARGOED: CVE-2014-3491 - XSS from create/update/destroy notification boxes*

ActionsCopy link
[#9](#note-9)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-11 "06/11/2014 05:20 PM") ago

* **Status** changed from *Ready For Testing* to *Pending*

ACK, thanks Joseph!

ActionsCopy link
[#10](#note-10)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-11 "06/11/2014 06:22 PM") ago

* **Target version** changed from *1.8.2* to *1.8.1*

ActionsCopy link
[#11](#note-11)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-13 "06/13/2014 12:46 PM") ago

* **Translation missing: en.field\_release** changed from *16* to *19*

ActionsCopy link [Download all files](/attachments/journals/21150/download "Download all files")
[#12](#note-12)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-17 "06/17/2014 04:04 PM") ago

* **File** [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/864) [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/download/864/0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch "Download") added
* **File** [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/865) [0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch](/attachments/download/865/0001-fixes-5881-XSS-from-create-update-destroy-notificati.patch "Download") added

Updated patch to fix tests, backported to 1.4-stable.

ActionsCopy link
[#13](#note-13)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-18 "06/18/2014 08:01 AM") ago

* **Subject** changed from *EMBARGOED: CVE-2014-3491 - XSS from create/update/destroy notification boxes* to *CVE-2014-3491 - XSS from create/update/destroy notification boxes*
* **Private** changed from *Yes* to *No*

ActionsCopy link
[#14](#note-14)
#### Updated by [Joseph Magen](/users/3472) [over 10 years](/projects/foreman/activity?from=2014-06-18 "06/18/2014 08:31 AM") ago

* **Status** changed from *Pending* to *Closed*
* **% Done** changed from *0* to *100*

Applied in changeset [983075c0c0e95c0d4715591325e88c90c7f09d71](/projects/foreman/repository/foreman/revisions/983075c0c0e95c0d4715591325e88c90c7f09d71 "fixes #5881 - XSS from create/update/destroy notification boxes (CVE-2014-3491)").

ActionsCopy link
[#15](#note-15)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-18 "06/18/2014 09:08 AM") ago

Fixes committed to 1.4-stable, 1.5-stable and develop.

Foreman 1.4.5 and 1.5.1 releases will be made today with the fix.

ActionsCopy link
[#16](#note-16)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-24 "06/24/2014 08:16 AM") ago

* **Related to** *[Bug #6351](/issues/6351): <br /> seen in UI errors when multiple errors exist on a resource* added

ActionsCopy link
[#17](#note-17)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-06-26 "06/26/2014 04:04 PM") ago

* **Related to** *[Bug #6402](/issues/6402): Using "run puppet" feature fails: undefined method `gsub' for #<Array ...>* added

ActionsCopy link
[#18](#note-18)
#### Updated by [Dominic Cleal](/users/3536) [over 10 years](/projects/foreman/activity?from=2014-08-04 "08/04/2014 06:12 AM") ago

* **Related to** *[Bug #6903](/issues/6903): "<br/>" in text when receiving error while deleting multiple hosts* added

Actions
Copy link

Also available in: [Atom](/issues/5881.atom)
[PDF](/issues/5881.pdf)

Powered by [Redmine](https://www.redmine.org/) Â© 2006-2024 Jean-Philippe Lang

Loading...



=== Content from www.gravatar.com_effabc93_20250126_065322.html ===
ï¿½ï¿½ï¿½ï¿½ JFIF  ` `  ï¿½ï¿½ ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
ï¿½ï¿½ C 



ï¿½ï¿½ C  

ï¿½ï¿½   " ï¿½ï¿½           
ï¿½ï¿½ ï¿½   } !1AQa"q2ï¿½ï¿½ï¿½#Bï¿½ï¿½Rï¿½ï¿½$3brï¿½
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½        
ï¿½ï¿½ ï¿½  w !1AQaq"2ï¿½Bï¿½ï¿½ï¿½ï¿½ #3Rï¿½brï¿½
$4ï¿½%ï¿½&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   ? ï¿½$ï¿½Oï¿½ï¿½'ï¿½ï¿½Ã¾ï¿½ï¿½ï¿½ï¿½)k}i.ï¿½wï¿½G#ï¿½ï¿½h%$BpXï¿½ï¿½I<ï¿½}ï¿½Yï¿½ï¿½uï¿½x~\_xWâ¯‹aï¿½>ï¿½ï¿½,eï¿½ï¿½-ï¿½yR'FSï¿½9ï¿½ï¿½FAï¿½ï¿½|kï¿½ï¿½|g{ï¿½ï¿½n|2ï¿½hï¿½gï¿½ï¿½IRV0ï¿½eï¿½ï¿½ï¿½gï¿½ï¿½ï¿½Sï¿½<9ï¿½ï¿½iZï¿½^=ï¿½ï¿½#ï¿½ï¿½ghï¿½\*ï¿½ï¿½ï¿½`O$ï¿½ï¿½ï¿½ï¿½×žï¿½Tï¿½gï¿½ï¿½ï¿½ï¿½Tyï¿½kï¿½ï¿½ï¿½ï¿½â¾¥ï¿½ï¿½×…|e,1Ayzï¿½CzTï¿½ï¿½ï¿½ï¿½Ø¨'ï¿½Jï¿½>ï¿½Wï¿½ï¿½ï¿½ï¿½ï¿½~ï¿½vW^ï¿½ï¿½'&ï¿½gï¿½\ï¿½ï¿½Bï¿½$0ï¿½8lï¿½ï¿½ï¿½8ï¿½ï¿½]>ï¿½ï¿½ï¿½\_3Ä«Nï¿½iHï¿½ï¿½\_ï¿½
ï¿½ï¿½ï¿½ï¿½ï¿½.ï¿½Gï¿½[mCGï¿½ï¿½ï¿½ï¿½!"VHcÃ»g#o6ï¿½ï¿½ukï¿½ï¿½kï¿½î»¨ï¿½3Igmï¿½ï¿½@ï¿½G.Å˜)$ï¿½sï¿½>ï¿½QYï¿½ï¿½ï¿½Oï¿½^Gï¿½ï¿½\_ï¿½ï¿½ï¿½ï¿½ï¿½kï¿½ï¿½ï¿½7ï¿½72ï¿½ï¿½]ï¿½<ï¿½dï¿½Hrï¿½ï¿½Xwï¿½ï¿½ï¿½9(ï¿½ï¿½ï¿½Gï¿½'wsï¿½ï¿½
