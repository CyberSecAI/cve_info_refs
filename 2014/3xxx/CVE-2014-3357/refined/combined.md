=== Content from tools.cisco.com_902edaef_20250125_161555.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

| | Cisco Security AdvisoryMultiple Vulnerabilities in Cisco IOS Software Multicast Domain Name System High   Advisory ID:  cisco-sa-20140924-mdns  First Published: 2014 September 24 16:00 GMT  Version 1.0:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  [See below](#workarounds)   Cisco Bug IDs: [CSCuj58950](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuj58950)  [CSCul90866](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCul90866)     CVE-2014-3357 CVE-2014-3358     CWE-20 CWE-399       CVSS Score: [Base 7.8, Temporal 6.4](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=2.0&vector=AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C)**Click Icon to Copy Verbose Score** AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C       CVE-2014-3357 CVE-2014-3358     CWE-20 CWE-399       [Download OVAL](https://sec.cloudapps.cisco.com/security/center/contentxml/CiscoSecurityAdvisory/cisco-sa-20140924-mdns/oval/cisco-sa-20140924-mdns_522.xml)   Email      Summary  * The Cisco IOS Software implementation of the multicast Domain Name System (mDNS) feature contains the following vulnerabilities when processing mDNS packets that could allow an unauthenticated, remote attacker to cause a denial of service (DoS) condition:   + Cisco IOS Software mDNS Gateway Memory Leak Vulnerability   + Cisco IOS Software mDNS Gateway Denial of Service VulnerabilityCisco has released software updates that address these vulnerabilities. This advisory is available at the following link:  Affected Products  * Vulnerable ProductsCisco devices that are running affected Cisco IOS Software or Cisco IOS XE Software are vulnerable. Cisco mDNS Gateway functionality is enabled by default on Cisco IOS and Cisco IOS XE Software. There is no specific configuration on the affected device needed to process mDNS packets.      To determine whether a Cisco IOS device or Cisco IOS XE device would process mDNS packets, log into the device and issue either of the following command line interface (CLI) commands **show ip socket**, **show udp**, or **show control-plane host open-ports**. If the output shows any IP addresses listening on port UDP 5353, the device is vulnerable.      The following example shows a Cisco IOS device that is affected by these vulnerabilities. The device is vulnerable because the socket is opened on UDP port 5353: ```   Router#show ip socket     Proto Remote Port Local Port In Out Stat TTY OutputIF    17 --listen-- 192.168.0.1 67 0 0 1 0    17 --listen-- 192.168.0.1 68 0 0 1 0    17 --listen-- 224.0.0.251 5353 0 0 1 0   Router#      Router#sho udp    Proto        Remote      Port      Local       Port  In Out  Stat TTY OutputIF   17     224.0.0.251      5353 --any--          5353   0   0 1000021   0    17(v6) FF02::FB         5353 --any--          5353   0   0 1020021   0    Router#      Router#sho control-plane host open-ports    Active internet connections (servers and established)   Prot               Local Address             Foreign Address                  Service    State    tcp                        *:22                         *:0               SSH-Server   LISTEN    tcp                        *:23                         *:0                   Telnet   LISTEN    udp                      *:5353               224.0.0.251:0         IOS host service   LISTEN   Router#      ``` **Note:** The behavior of Cisco IOS and Cisco IOS XE Software prior to the fix for Cisco bug ID CSCum51028 is to turn the mDNS functionality on by default. This behavior was changed through Cisco bug ID CSCum51028 and is now disabled by default. If the administrator wants to enable mDNS functionality, it must be manually configured on a device.    To determine the Cisco IOS Software release that is running on a Cisco product, administrators can log in to the device and issue the **show version** command to display the system banner. The system banner confirms that the device is running Cisco IOS Software by displaying text similar to "Cisco Internetwork Operating System Software" or "Cisco IOS Software." The image name displays in parentheses, followed by "Version" and the Cisco IOS Software release name. Other Cisco devices do not have the **show version** command or may provide different output.  The following example identifies a Cisco product that is running Cisco IOS Software Release 15.2(4)M5 with an installed image name of C3900-UNIVERSALK9-M:  ```   Router> show version Cisco IOS Software, C3900 Software (C3900-UNIVERSALK9-M), 15.2(4)M5, RELEASE SOFTWARE (fc2)Technical Support: http://www.cisco.com/techsupportCopyright (c) 1986-2013 by Cisco Systems, Inc.Compiled Fri 13-Sep-13 16:44 by prod_rel_team   ```   ```   !--- output truncated    ```  Additional information about Cisco IOS Software release naming conventions is available in [White Paper: Cisco IOS and NX-OS Software Reference Guide](http://www.cisco.com/web/about/security/intelligence/ios-ref.html). Products Confirmed Not VulnerableCisco IOS XR Software is not affected by these vulnerabilities.      No other Cisco products are currently known to be affected by these vulnerabilities.  Details  * Cisco's Service Discovery Gateway (mDNS Gateway) is an IOS component that allows for controlled and secure access to services and devices across subnets. It listens to service announcements on all configured network segments and builds a cache of services and addresses.      **Cisco IOS Software mDNS Gateway Memory Leak Vulnerability**      A vulnerability in the multicast Domain Name System (mDNS) implementation of Cisco IOS Software could allow an unauthenticated, remote attacker to cause a memory leak condition, which could eventually lead to an interface wedge or a reload of the affected device.      The vulnerability is due to improper parsing of malformed mDNS packets sent to an affected device. An attacker could exploit this vulnerability by sending malformed mDNS packets to be processed by an affected device. An exploit could allow the attacker to cause a memory leak condition, which could eventually lead to an interface wedge or a reload of the affected device.      This vulnerability can be exploited using both IPv4 and IPv6 packets. The vulnerability can be triggered by malformed UDP packets destined for port 5353 using either IPv4/IPv6 unicast address of any interface configured on a device, IPv4 multicast address 224.0.0.251, or IPv6 multicast address FF02::FB.      This vulnerability can only be triggered by the traffic destined to an affected device and cannot be exploited with traffic transiting an affected device.      In devices that meet the vulnerable configuration criteria, malformed UDP mDNS packets could trigger this vulnerability. An attacker with knowledge of the infrastructure could craft mDNS packets with set conditions to exploit this vulnerability. Successful exploitation of the vulnerability could result in a memory leak that can lead to an interface wedge and eventually a reload of the affected device. Recovery from an interface queue wedge condition requires a reload of the device, which could result in a denial of service (DoS) condition.      An interface queue wedge is a class of vulnerability in which certain packets are received and queued by a Cisco IOS router or switch but, due to a processing error, are never removed from the queue. Consult the Workarounds section of this advisory for more information about queue wedges and some detection mechanisms that may be used to identify a blocked interface on Cisco IOS Software. Also see the Cisco Security Blog "Cisco IOS Queue Wedges Explained" at the following link: <http://blogs.cisco.com/security/cisco_ios_queue_wedges_explained/>      This vulnerability is documented in Cisco bug ID [CSCuj58950](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuj58950) ([registered](https://sec.cloudapps.cisco.comRPF/register/register.do) customers only) and has been assigned Common Vulnerabilities and Exposures (CVE) ID CVE-2014-3358.      **Cisco IOS Software mDNS Gateway Denial of Service Vulnerability**      A vulnerability in the multicast DNS (mDNS) gateway function of Cisco IOS Software could allow an unauthenticated, remote attacker to reload the vulnerable device.      The vulnerability is due to improper validation of mDNS packets. An attacker could exploit this vulnerability by sending malformed IPv4 or IPv6 packets on UDP port 5353. An exploit could allow the attacker to cause a denial of service (DoS) condition.      This vulnerability can be exploited using both IPv4 and IPv6 packets. The vulnerability can be triggered by malformed UDP packets destined for port 5353 using either IPv4/IPv6 unicast address of any interface configured on a device, IPv4 multicast address 224.0.0.251, or IPv6 multicast address FF02::FB.      This vulnerability can only be triggered by the traffic destined to an affected device and cannot be exploited with traffic transiting an affected device.      In devices that meet the vulnerable configuration criteria, malformed UDP mDNS packets could trigger this vulnerability. An attacker with knowledge of the infrastructure could craft mDNS packets with set conditions to exploit this vulnerability. Successful exploitation of the vulnerability can result in a reload of the affected device.      This vulnerability is documented in Cisco bug ID [CSCul90866](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCul90866) ([registered](https://sec.cloudapps.cisco.comRPF/register/register.do) customers only) and has been assigned CVE ID CVE-2014-3357.  Workarounds  * **Access Control Lists**      On Cisco IOS and Cisco IOS XE Software releases that do not have a fix for Cisco bug ID CSCum51028, there is currently no way to manually close the port or disable the service.      On those releases, a possible workaround consists of configuring an extended access control list (ACL) that can be created and applied to an interface to block traffic destined to UDP port 5353.      Because the mDNS feature in this vulnerability utilizes UDP as a transport, it is possible to spoof the sender's IP address, which may defeat ACLs that permit communication to these ports from trusted IP addresses. In addition to ACLs, administrators should enable uRPF, a security feature of Cisco IOS Software that verifies the reachability of the source address in packets being forwarded. The combination of these two technologies offers a stronger workaround than ACLs alone.      The ACL example below should be included as part of the deployed interface access-list, which will help protect the device from traffic destined to UDP port 5353: ```   !---   !--- Deny IPv4 mDNS traffic to a device   !---       access-list 150 deny udp any any eq 5353        !--- Permit/deny all other Layer 3 and Layer 4 IPv4 traffic in    !--- accordance with existing security policies and    !--- configurations. Permit all other traffic to transit the   !--- device.        access-list 150 permit ip any any        !---   !--- Deny IPv6 mDNS traffic to a device   !---    ipv6 access-list v6_list     deny udp any any eq 5353        !--- Permit/deny all other Layer 3 and Layer 4 IPv6 traffic in    !--- accordance with existing security policies and    !--- configurations. Permit all other traffic to transit the   !--- device.        permit ipv6 any any        !--- Apply access-list to all interfaces (only one example   !--- shown)        interface fastEthernet 2/0    ip access-group 150 in     ipv6 traffic-filter v6_list in      ``` **Control Plane Policing**      Control Plane Policing (CoPP) can be used to block untrusted UDP traffic to the device. Cisco IOS Software releases 12.0S, 12.2SX, 12.2S, 12.3T, 12.4, and 12.4T support the CoPP feature. CoPP can be configured on a device to help protect the management and control planes and minimize the risk and effectiveness of direct infrastructure attacks by explicitly permitting only authorized traffic that is sent to infrastructure devices in accordance with existing security policies and configurations.       The CoPP example below should be included as part of the deployed CoPP, which will help protect the device from traffic destined to UDP port 5353: ```   !---   !--- Match IPv4 mDNS traffic with permit statement   !---       access-list 150 permit udp any any eq 5353        !--- Permit (Police or Drop)/Deny (Allow) all other Layer3 and    !--- Layer4 IPv4 traffic in accordance with existing security policies    !--- and configurations for traffic that is authorized to be sent    !--- to infrastructure devices    !---       access-list 150 deny ip any any        !--- Create a Class-Map for traffic to be policed by   !--- the CoPP feature   !---      class-map match-all drop-udp-class    match access-group 150      !--- Create a Policy-Map that will be applied to the    !--- Control-Plane of the device.        policy-map drop-udp-traffic class drop-udp-class drop        !--- Apply the Policy-Map to the    !--- Control-Plane of the device        control-plane service-policy    input drop-udp-traffic      ``` In the above CoPP example, the access control list entries (ACE) that match the potential exploit packets with the "permit" action result in these packets being discarded by the policy-map "drop" function, while packets that match the "deny" action (not shown) are not affected by the policy-map "drop" function. Please note that the policy-map syntax is different in the 12.2S and 12.0S Cisco IOS software trains: ```   policy-map drop-udp-traffic      class drop-udp-class      police 32000 1500 1500 conform-action drop exceed-action drop      ``` **Note:** Cisco does not recommend deploying CoPP for IPv6 traffic.      Additional information on the configuration and use of the CoPP feature can be found in the documents, "Control Plane Policing Implementation Best Practices" and "Control Plane Policing" at the following links: <http://www.cisco.com/web/about/security/intelligence/coppwp_gs.html> and <http://www.cisco.com/en/US/docs/ios/12_4t/12_4t4/htcpp.html>      On Cisco IOS and Cisco IOS XE Software releases that have a fix for Cisco bug ID CSCum51028, mDNS Gateway functionality can be disabled by configuring the **no service-routing mdns-sd** command-line interface global configuration (CLI) command.      The following identification mechanisms exist for the Cisco IOS Software mDNS Memory Leak Vulnerability:      **Embedded Event Manager**      A Cisco IOS Embedded Event Manager (EEM) policy that is based on Tool Command Language (Tcl) can be used on vulnerable Cisco IOS devices to identify and detect an interface queue wedge that is caused by this vulnerability. The policy allows administrators to monitor the interfaces on a Cisco IOS device and detect when the interface input queues are full. When Cisco IOS EEM detects potential exploitation of this vulnerability, the policy can trigger a response by sending an alert to the network administrator, who could then decide to implement an upgrade, implement suitable mitigations or reload the device to clear the input queue.      The Tcl script is available for download at the "Cisco Beyond: Embedded Event Manager (EEM) Scripting Community" at the following link: <https://supportforums.cisco.com/docs/DOC-19337>      Also see the Cisco Security Blog "Cisco IOS Queue Wedges Explained" at the following link: <http://blogs.cisco.com/security/cisco_ios_queue_wedges_explained/>      Additional mitigations that can be deployed on Cisco devices within the network are available in the Cisco Applied Mitigation Bulletin companion document for this advisory, which is available at the following link: <https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023>  Fixed Software  * When considering software upgrades, customers are advised to consult the Cisco Security Advisories, Responses, and Notices archive at <http://www.cisco.com/go/psirt> and review subsequent advisories to determine exposure and a complete upgrade solution.      In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.          Cisco IOS Software Cisco has provided a tool to help customers determine their exposure to vulnerabilities in Cisco IOS Software. The [Cisco IOS Software Checker](https://sec.cloudapps.cisco.com/security/center/selectIOSVersion.x) allows customers to perform the following tasks:    + Initiate a search by selecting releases from the drop-down menu or uploading a file from a local system   + Enter **show version** command output for the tool to parse   + Create a customized search by including all previously published Cisco Security Advisories, a specific publication, or all advisories in the September 2015 bundled publication The tool will identify any Cisco Security Advisories that impact a queried software release and the earliest release that corrects all vulnerabilities in each Cisco Security Advisory ("First Fixed"). If applicable, the tool will also return the earliest possible release that corrects all vulnerabilities in all displayed advisories ("Combined First Fixed"). Please visit the [Cisco IOS Software Checker](https://sec.cloudapps.cisco.com/security/center/selectIOSVersion.x) or simply enter a Cisco IOS Software release in the following field to determine whether it is affected by any of the advisories in this bundled publication.  (Example entry: 15.1(4)M2)              Cisco IOS XE SoftwareCisco IOS XE Software is affected by the vulnerabilities that are disclosed in this document.      For a mapping of Cisco IOS XE Software releases to Cisco IOS Software releases, refer to [Cisco IOS XE 2 Release Notes](http://www.cisco.com/en/US/docs/ios/ios_xe/2/release/notes/rnasr21.html#wp2310700), [Cisco IOS XE 3S Release Notes](http://www.cisco.com/en/US/docs/ios/ios_xe/3/release/notes/asr1k_rn_3s_sys_req.html#wp2999052), and [Cisco IOS XE 3SG Release Notes](http://www.cisco.com/en/US/docs/switches/lan/catalyst4500/release/note/OL_24726.html#wp2570252).      | Cisco IOS XE Software Release | First Fixed Release | First Fixed Release for All Advisories in the September 2014 Cisco IOS Software Security Advisory Bundled Publication |   | --- | --- | --- |   | 2.1.x | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 2.2.x | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 2.3.x | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 2.4.x | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 2.5.x | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 2.6.x | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 3.1.xS | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 3.1.xSG | Not vulnerable | Not vulnerable |   | 3.2.xS | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 3.2.xSE | Not vulnerable | Vulnerable; migrate to 3.3.2SE |   | 3.2.xSG | Not vulnerable | Not vulnerable |   | 3.2.xXO | Not vulnerable | Not vulnerable |   | 3.2.xSQ | Not vulnerable | Not vulnerable |   | 3.3.xS | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 3.3.xSE | 3.3.2SE | 3.3.2SE |   | 3.3.xSG | Not vulnerable. | Vulnerable; migrate to 3.4.4SG or later. |   | 3.3.xXO | 3.3.1XO | 3.3.1XO |   | 3.3.xSQ | Not vulnerable | Not vulnerable |   | 3.4.xS | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 3.4.xSG | Not vulnerable | 3.4.4SG |   | 3.4.xSQ | Not vulnerable | Not vulnerable |   | 3.5.xS | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 3.5.xE | 3.5.2E | 3.5.2E |   | 3.6.xS | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 3.6.xE | Not vulnerable | Not vulnerable |   | 3.7.xS | Not vulnerable | Vulnerable; migrate to 3.7.6S or later. |   | 3.7.xE | Not vulnerable | Not vulnerable |   | 3.8.xS | Not vulnerable | Vulnerable; migrate to 3.10.4S or later. |   | 3.9.xS | Not vulnerable | Vulnerable; migrate to 3.10.4S or later. |   | 3.10.xS | Not vulnerable | 3.10.4S |   | 3.11.xS | 3.11.1S | Vulnerable; migrate to 3.12S or later. |   | 3.12.xS | Not vulnerable | Not vulnerable |   | 3.13.xS | Not vulnerable | Not vulnerable |         Cisco IOS XR SoftwareCisco IOS XR Software is not affected by any of the vulnerabilities that are disclosed in the September 2014 Cisco IOS Software Security Advisory Bundled Publication.  Exploitation and Public Announcements  * The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerabilities that are described in this advisory.      These vulnerabilities were discovered during the internal investigation.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Action Links for This Advisory  * [Identifying and Mitigating Exploitation of the Multiple Vulnerabilities in Cisco IOS Software Multicast Domain Name System](https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023)      [Malformed mDNS Response](https://sec.cloudapps.cisco.com/security/center/viewIpsSignature.x?signatureId=4565&signatureSubId=0&softwareVersion=6.0&releaseVersion=S823)      [Malformed mDNS Response](https://sec.cloudapps.cisco.com/security/center/viewIpsSignature.x?signatureId=4698&signatureSubId=0&softwareVersion=6.0&releaseVersion=S825)  Related to This Advisory  * [Cisco Event Response: September 2014 Semiannual Cisco IOS Software Security Advisory Bundled Publication](http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_sep14.html)      [Announcing the Cisco IOS Software Security Advisory Bundled Publication](http://blogs.cisco.com/security/announcing-the-cisco-ios-software-security-advisory-bundled-publication/)      [Cisco IOS Software Multicast Domain Name System Gateway Memory Leak Vulnerability](https://sec.cloudapps.cisco.com/security/center/viewAlert.x?alertId=35607)      [Cisco IOS Software Multicast Domain Name System Gateway Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/viewAlert.x?alertId=35608)  URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140924-mdns>  Revision History  * | Revision 1.0 | 2014-September-24 | Initial public release. |   | --- | --- | --- |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Action Links for This Advisory  * [Identifying and Mitigating Exploitation of the Multiple Vulnerabilities in Cisco IOS Software Multicast Domain Name System](https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023)      [Malformed mDNS Response](https://sec.cloudapps.cisco.com/security/center/viewIpsSignature.x?signatureId=4565&signatureSubId=0&softwareVersion=6.0&releaseVersion=S823)      [Malformed mDNS Response](https://sec.cloudapps.cisco.com/security/center/viewIpsSignature.x?signatureId=4698&signatureSubId=0&softwareVersion=6.0&releaseVersion=S825)  Related to This Advisory  * [Cisco Event Response: September 2014 Semiannual Cisco IOS Software Security Advisory Bundled Publication](http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_sep14.html)      [Announcing the Cisco IOS Software Security Advisory Bundled Publication](http://blogs.cisco.com/security/announcing-the-cisco-ios-software-security-advisory-bundled-publication/)      [Cisco IOS Software Multicast Domain Name System Gateway Memory Leak Vulnerability](https://sec.cloudapps.cisco.com/security/center/viewAlert.x?alertId=35607)      [Cisco IOS Software Multicast Domain Name System Gateway Denial of Service Vulnerability](https://sec.cloudapps.cisco.com/security/center/viewAlert.x?alertId=35608) |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |



=== Content from sec.cloudapps.cisco.com_d8525ab9_20250126_101224.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Latest Threat Information](https://sec.cloudapps.cisco.com/security/center/navigation.x?i=118)
#### Cisco Security

# Common Vulnerability Scoring System

| Choose the version of CVSS calculator:   Version 1  Version 2  Version 3  Version 3.1 |
| --- |
| Common Vulnerability Scoring System (CVSS) Online Calculator, version 2.0 |
| Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC/CDP:ND/TD:ND/CR:ND/IR:ND/AR:ND |
| This tool is used to calculate a specific threat/vulnerability's CVSS score. Please select the appropriate options below, click "Calculate Score," and the CVSS score will be displayed. Use of this calculator is subject to [the disclaimer below.](#disclaimer) |
| ---    | |
| Base Parameters |
| Once discovered, analyzed, and catalogued, there are certain aspects of a vulnerability that do not change, assuming the initial information is complete and correct. These immutable characteristics will not change over time, nor in different environments. The base metric group captures the access to and impact on the target.  Access Vector AV: Local AV: Adjacent Network AV: Network  Access Complexity AC: High AC: Medium AC: Low  Authentication Au: Multiple Au: Single Au: None  Confidentiality Impact C: None C: Partial C: Complete  Integrity Impact I: None I: Partial I: Complete  Availability Impact A: None A: Partial A: Complete     Base Score: 7.8 |
| Temporal Parameters |
| As a vulnerability ages, certain intrinsic characteristics will change with time. In many cases, when a vulnerability is first discovered, the number of vulnerable systems will be at or close to its peak, while the availability of exploit and remedial information will be at its lowest point. As time progresses, patch information will become more available and more systems will be fixed as more exploits occur, driving the need for the fix. Eventually, the number of vulnerable systems will reach its low point as remedial information reaches its high point. The CVSS temporal metrics group captures these characteristics of a vulnerability that change over time.  Exploitability E: Unproven  E: Proof-of-Concept  E: Functional  E: High  E: Not Defined   **Exploitability**  ---   Unproven (U) No exploit code is available, or an exploit is entirely theoretical. Proof-of-Concept (POC) Proof-of-concept exploit code or an attack demonstration that is not practical for most systems is available. The code or technique is not functional in all situations and may require substantial modification by a skilled attacker.  Functional (F) Functional exploit code is available. The code works in most situations where the vulnerability exists.  High (H) Either the vulnerability is exploitable by functional mobile autonomous code, or no exploit is required (manual trigger) and details are widely available. The code works in every situation, or is actively being delivered via a mobile autonomous agent (such as a worm or virus).  Not Defined (ND) Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.  Remediation Level RL: Official-Fix  RL: Temporary-Fix  RL: Workaround  RL: Unavailable  RL: Not Defined   **Remediation Level**  ---   Official Fix (OF)  A complete vendor solution is available. Either the vendor has issued an official patch, or an upgrade is available. Temporary Fix (TF) There is an official but temporary fix available. This includes instances where the vendor issues a temporary hotfix, tool, or workaround.  Workaround (W)  There is an unofficial, non-vendor solution available. In some cases, users of the affected technology will create a patch of their own or provide steps to work around or otherwise mitigate the vulnerability.  Unavailable (U)  There is either no solution available or it is impossible to apply.  Not Defined (ND)  Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.  Report Confidence RC: Unconfirmed  RC: Uncorroborated  RC: Confirmed  RC: Not Defined   **Report Confidence**  ---   Unconfirmed (UC) There is a single unconfirmed source or possibly multiple conflicting reports. There is little confidence in the validity of the reports. An example is a rumor that surfaces from the hacker underground. Uncorroborated (UR) There are multiple non-official sources, possibly including independent security companies or research organizations. At this point there may be conflicting technical details or some other lingering ambiguity.  Confirmed (C) The vulnerability has been acknowledged by the vendor or author of the affected technology. The vulnerability may also be ?Confirmed? when its existence is confirmed from an external event such as publication of functional or proof-of-concept exploit code or widespread exploitation.  Not Defined (ND) Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.     Temporal Score: 0.0 |

| Environmental Parameters |
| Different user environments can have an immense bearing on how (or if) a vulnerability affects a given information system and its stakeholders. The CVSS environmental metrics group captures characteristics of vulnerabilities that are tied to system distribution and network environment.  Collateral Damage Potential CDP: None  CDP: Low  CDP: Low-Medium  CDP: Medium-High  CDP: High  CDP: Not Defined   Target Distribution TD: None  TD: Low  TD: Medium  TD: High  TD: Not Defined   Confidentiality Requirement CR: Not Defined  CR: Low  CR: Medium  CR: High   Integrity Requirement IR: Not Defined  IR: Low  IR: Medium  IR: High   Availability Requirement AR: Not Defined  AR: Low  AR: Medium  AR: High      Environmental Score: 0.0 |

| --- |
|  |
|

![](https://www.static-cisco.com/web/fw/search//img/loader.gif)

Loading..

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

| --- |
| --- |
| **ENDORSEMENT**  Cisco endorses and subscribes to the vulnerability guidelines outlined by the National Infrastructure Advisory Council (NIAC). The NIAC commissioned the development of the Common Vulnerability Scoring System (CVSS), which is currently maintained by FIRST (Forum of Incident Response and Security Teams), www.first.org, and was a combined effort involving many companies, including Cisco Systems, Inc.  **GENERAL DISCLAIMER AND LIMITATION OF LIABILITY**  All information provided by the CVSS Online Calculator is for informational purposes only and is subject to change or withdrawal at any time without notice. The CVSS Online Calculator is a pilot program and Cisco assumes no responsibility for the accuracy or completeness of the information provided and any decision made or action taken or not taken in reliance upon the information provided or furnished hereunder. The information and results provided by the CVSS Online Calculator vary based on the information provided by each user, which is specific to each user's network and cannot be verified or confirmed by Cisco. The CVSS Online Calculator is offered only as a convenience and any use of the results or information provided is at the user's risk. |



=== Content from bst.cloudapps.cisco.com_c6d4c9b9_20250126_101222.html ===


Back

US

EN

×

Your email address belongs to an organization that also manages
your Cisco account login.

Log in to your organization to also log in to Cisco.

Organization Log In

×

Description here

Contact Support
[Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
[Terms &
Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
[Cookies](https://www.cisco.com/c/en/us/about/legal/privacy-full.html#cookies)
[Trademarks](http://www.cisco.com/web/siteassets/legal/trademark.html)
[京ICP备05085544号-1](http://beian.miit.gov.cn)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Cisco Identity](https://id.cisco.com/fs/bco/1/fs0a411g73DFKaj7K5d7)

## The page has timed out

If this page does not reload automatically, please refresh your browser.



=== Content from sec.cloudapps.cisco.com_56bd6146_20250126_101223.html ===


# Cisco Security

## Cisco Security

| | The Page You Have Requested Is Not Available The Cisco Security that you are trying to access may have been relocated or removed.  If you typed the address, please verify that your entry was correct.  You may find what you are looking for through the [Advanced Search](https://tools.cisco.com/security/center/search.x) functionality of [Cisco Security](https://tools.cisco.com/security/center/home.x). Report a Broken Link Please use this form to report broken links on Cisco.com.  <<  Go Back to Previous Page |   Related LinksSolutions  * [Security Solutions](http://www.cisco.com/en/US/products/hw/vpndevc/solutions.html) * [E-mail Security](http://www.cisco.com/en/US/products/ps10154/index.html) * [Threat Control for Endpoints](http://www.cisco.com/en/US/netsol/ns681/index.html) * [Threat Control for Infrastructure](http://www.cisco.com/en/US/netsol/ns680/index.html)  Products & Services  * [Security Services](http://www.cisco.com/en/US/products/svcs/ps2961/ps2952/serv_group_home.html) * [Security Products](http://www.cisco.com/en/US/products/hw/vpndevc/index.html) * [Cisco IntelliShield Alert Manager](http://www.cisco.com/en/US/products/ps6834/serv_group_home.html)  About Cisco  * [Cisco Global Government Affairs](http://www.cisco.com/web/about/gov/index.html) * [High Tech Policy Blog](http://blogs.cisco.com/gov/) * [High Tech Policy Guide](http://www.cisco.com/web/about/gov/policy_guide.html) | | --- | --- | |
| --- | --- | --- |



=== Content from tools.cisco.com_22ab1a47_20250125_161556.html ===
xml version="1.0" encoding="UTF-8"?
Multiple Vulnerabilities in Cisco IOS Software Multicast Domain Name System
Cisco Security Advisory
Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.
Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html

cisco-sa-20140924-mdns

Final
1.0
1.0
2014-09-24T15:46:16
Initial public release.

2014-09-24T16:00:00
2014-09-24T16:00:00
TVCE

The Cisco IOS Software implementation of the multicast Domain Name System (mDNS) feature contains the following vulnerabilities when processing mDNS packets that could allow an unauthenticated, remote attacker to cause a denial of service (DoS) condition:
Cisco IOS Software mDNS Gateway Memory Leak Vulnerability
Cisco IOS Software mDNS Gateway Denial of Service Vulnerability
Cisco has released software updates that address these vulnerabilities. This advisory is available at the following link:
https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140924-mdns["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140924-mdns"]
Note: The September 24, 2014, Cisco IOS Software Security Advisory bundled publication includes six Cisco Security Advisories. All advisories address vulnerabilities in Cisco IOS Software. Individual publication links are in Cisco Event Response: Semiannual Cisco IOS Software Security Advisory Bundled Publication at the following link:
http://www.cisco.com/web/about/security/intelligence/Cisco\_ERP\_sep14.html["http://www.cisco.com/web/about/security/intelligence/Cisco\_ERP\_sep14.html"]

Cisco devices that are running affected Cisco IOS Software or Cisco IOS XE Software are vulnerable. Cisco mDNS Gateway functionality is enabled by default on Cisco IOS and Cisco IOS XE Software. There is no specific configuration on the affected device needed to process mDNS packets.
To determine whether a Cisco IOS device or Cisco IOS XE device would process mDNS packets, log into the device and issue either of the following command line interface (CLI) commands show ip socket, show udp, or show control-plane host open-ports. If the output shows any IP addresses listening on port UDP 5353, the device is vulnerable.
The following example shows a Cisco IOS device that is affected by these vulnerabilities. The device is vulnerable because the socket is opened on UDP port 5353:
Router#show ip socket
Proto Remote Port Local Port In Out Stat TTY OutputIF
17 --listen-- 192.168.0.1 67 0 0 1 0
17 --listen-- 192.168.0.1 68 0 0 1 0
17 --listen-- 224.0.0.251 5353 0 0 1 0
Router#
Router#sho udp
Proto Remote Port Local Port In Out Stat TTY OutputIF
17 224.0.0.251 5353 --any-- 5353 0 0 1000021 0
17(v6) FF02::FB 5353 --any-- 5353 0 0 1020021 0
Router#
Router#sho control-plane host open-ports
Active internet connections (servers and established)
Prot Local Address Foreign Address Service State
tcp \*:22 \*:0 SSH-Server LISTEN
tcp \*:23 \*:0 Telnet LISTEN
udp \*:5353 224.0.0.251:0 IOS host service LISTEN
Router#
Note: The behavior of Cisco IOS and Cisco IOS XE Software prior to the fix for Cisco bug ID CSCum51028 is to turn the mDNS functionality on by default. This behavior was changed through Cisco bug ID CSCum51028 and is now disabled by default. If the administrator wants to enable mDNS functionality, it must be manually configured on a device.
To determine the Cisco IOS Software release that is running on a Cisco product, administrators can log in to the device and issue the show version command to display the system banner. The system banner confirms that the device is running Cisco IOS Software by displaying text similar to "Cisco Internetwork Operating System Software" or "Cisco IOS Software." The image name displays in parentheses, followed by "Version" and the Cisco IOS Software release name. Other Cisco devices do not have the show version command or may provide different output.
The following example identifies a Cisco product that is running Cisco IOS Software Release 15.2(4)M5 with an installed image name of C3900-UNIVERSALK9-M:
Router> show version
Cisco IOS Software, C3900 Software (C3900-UNIVERSALK9-M), 15.2(4)M5, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2013 by Cisco Systems, Inc.
Compiled Fri 13-Sep-13 16:44 by prod\_rel\_team
!--- output truncated
Additional information about Cisco IOS Software release naming conventions is available in White Paper: Cisco IOS and NX-OS Software Reference Guide["http://www.cisco.com/web/about/security/intelligence/ios-ref.html"].

Cisco IOS XR Software is not affected by these vulnerabilities.
No other Cisco products are currently known to be affected by these vulnerabilities.
Cisco's Service Discovery Gateway (mDNS Gateway) is an IOS component that allows for controlled and secure access to services and devices across subnets. It listens to service announcements on all configured network segments and builds a cache of services and addresses.
Cisco IOS Software mDNS Gateway Memory Leak Vulnerability
A vulnerability in the multicast Domain Name System (mDNS) implementation of Cisco IOS Software could allow an unauthenticated, remote attacker to cause a memory leak condition, which could eventually lead to an interface wedge or a reload of the affected device.
The vulnerability is due to improper parsing of malformed mDNS packets sent to an affected device. An attacker could exploit this vulnerability by sending malformed mDNS packets to be processed by an affected device. An exploit could allow the attacker to cause a memory leak condition, which could eventually lead to an interface wedge or a reload of the affected device.
This vulnerability can be exploited using both IPv4 and IPv6 packets. The vulnerability can be triggered by malformed UDP packets destined for port 5353 using either IPv4/IPv6 unicast address of any interface configured on a device, IPv4 multicast address 224.0.0.251, or IPv6 multicast address FF02::FB.
This vulnerability can only be triggered by the traffic destined to an affected device and cannot be exploited with traffic transiting an affected device.
In devices that meet the vulnerable configuration criteria, malformed UDP mDNS packets could trigger this vulnerability. An attacker with knowledge of the infrastructure could craft mDNS packets with set conditions to exploit this vulnerability. Successful exploitation of the vulnerability could result in a memory leak that can lead to an interface wedge and eventually a reload of the affected device. Recovery from an interface queue wedge condition requires a reload of the device, which could result in a denial of service (DoS) condition.
An interface queue wedge is a class of vulnerability in which certain packets are received and queued by a Cisco IOS router or switch but, due to a processing error, are never removed from the queue. Consult the Workarounds section of this advisory for more information about queue wedges and some detection mechanisms that may be used to identify a blocked interface on Cisco IOS Software. Also see the Cisco Security Blog "Cisco IOS Queue Wedges Explained" at the following link: http://blogs.cisco.com/security/cisco\_ios\_queue\_wedges\_explained/["http://blogs.cisco.com/security/cisco\_ios\_queue\_wedges\_explained/"]
This vulnerability is documented in Cisco bug ID CSCuj58950["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuj58950"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and has been assigned Common Vulnerabilities and Exposures (CVE) ID CVE-2014-3358.
Cisco IOS Software mDNS Gateway Denial of Service Vulnerability
A vulnerability in the multicast DNS (mDNS) gateway function of Cisco IOS Software could allow an unauthenticated, remote attacker to reload the vulnerable device.
The vulnerability is due to improper validation of mDNS packets. An attacker could exploit this vulnerability by sending malformed IPv4 or IPv6 packets on UDP port 5353. An exploit could allow the attacker to cause a denial of service (DoS) condition.
This vulnerability can be exploited using both IPv4 and IPv6 packets. The vulnerability can be triggered by malformed UDP packets destined for port 5353 using either IPv4/IPv6 unicast address of any interface configured on a device, IPv4 multicast address 224.0.0.251, or IPv6 multicast address FF02::FB.
This vulnerability can only be triggered by the traffic destined to an affected device and cannot be exploited with traffic transiting an affected device.
In devices that meet the vulnerable configuration criteria, malformed UDP mDNS packets could trigger this vulnerability. An attacker with knowledge of the infrastructure could craft mDNS packets with set conditions to exploit this vulnerability. Successful exploitation of the vulnerability can result in a reload of the affected device.
This vulnerability is documented in Cisco bug ID CSCul90866["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCul90866"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and has been assigned CVE ID CVE-2014-3357.
Access Control Lists
On Cisco IOS and Cisco IOS XE Software releases that do not have a fix for Cisco bug ID CSCum51028, there is currently no way to manually close the port or disable the service.
On those releases, a possible workaround consists of configuring an extended access control list (ACL) that can be created and applied to an interface to block traffic destined to UDP port 5353.
Because the mDNS feature in this vulnerability utilizes UDP as a transport, it is possible to spoof the sender's IP address, which may defeat ACLs that permit communication to these ports from trusted IP addresses. In addition to ACLs, administrators should enable uRPF, a security feature of Cisco IOS Software that verifies the reachability of the source address in packets being forwarded. The combination of these two technologies offers a stronger workaround than ACLs alone.
The ACL example below should be included as part of the deployed interface access-list, which will help protect the device from traffic destined to UDP port 5353:
!---
!--- Deny IPv4 mDNS traffic to a device
!---
access-list 150 deny udp any any eq 5353
!--- Permit/deny all other Layer 3 and Layer 4 IPv4 traffic in
!--- accordance with existing security policies and
!--- configurations. Permit all other traffic to transit the
!--- device.
access-list 150 permit ip any any
!---
!--- Deny IPv6 mDNS traffic to a device
!---
ipv6 access-list v6\_list
deny udp any any eq 5353
!--- Permit/deny all other Layer 3 and Layer 4 IPv6 traffic in
!--- accordance with existing security policies and
!--- configurations. Permit all other traffic to transit the
!--- device.
permit ipv6 any any
!--- Apply access-list to all interfaces (only one example
!--- shown)
interface fastEthernet 2/0
ip access-group 150 in
ipv6 traffic-filter v6\_list in
Control Plane Policing
Control Plane Policing (CoPP) can be used to block untrusted UDP traffic to the device. Cisco IOS Software releases 12.0S, 12.2SX, 12.2S, 12.3T, 12.4, and 12.4T support the CoPP feature. CoPP can be configured on a device to help protect the management and control planes and minimize the risk and effectiveness of direct infrastructure attacks by explicitly permitting only authorized traffic that is sent to infrastructure devices in accordance with existing security policies and configurations.
The CoPP example below should be included as part of the deployed CoPP, which will help protect the device from traffic destined to UDP port 5353:
!---
!--- Match IPv4 mDNS traffic with permit statement
!---
access-list 150 permit udp any any eq 5353
!--- Permit (Police or Drop)/Deny (Allow) all other Layer3 and
!--- Layer4 IPv4 traffic in accordance with existing security policies
!--- and configurations for traffic that is authorized to be sent
!--- to infrastructure devices
!---
access-list 150 deny ip any any
!--- Create a Class-Map for traffic to be policed by
!--- the CoPP feature
!---
class-map match-all drop-udp-class
match access-group 150
!--- Create a Policy-Map that will be applied to the
!--- Control-Plane of the device.
policy-map drop-udp-traffic class drop-udp-class drop
!--- Apply the Policy-Map to the
!--- Control-Plane of the device
control-plane service-policy
input drop-udp-traffic
In the above CoPP example, the access control list entries (ACE) that match the potential exploit packets with the "permit" action result in these packets being discarded by the policy-map "drop" function, while packets that match the "deny" action (not shown) are not affected by the policy-map "drop" function. Please note that the policy-map syntax is different in the 12.2S and 12.0S Cisco IOS software trains:
policy-map drop-udp-traffic
class drop-udp-class
police 32000 1500 1500 conform-action drop exceed-action drop
Note: Cisco does not recommend deploying CoPP for IPv6 traffic.
Additional information on the configuration and use of the CoPP feature can be found in the documents, "Control Plane Policing Implementation Best Practices" and "Control Plane Policing" at the following links: http://www.cisco.com/web/about/security/intelligence/coppwp\_gs.html["http://www.cisco.com/web/about/security/intelligence/coppwp\_gs.html"] and http://www.cisco.com/en/US/docs/ios/12\_4t/12\_4t4/htcpp.html["http://www.cisco.com/en/US/docs/ios/12\_4t/12\_4t4/htcpp.html"]
On Cisco IOS and Cisco IOS XE Software releases that have a fix for Cisco bug ID CSCum51028, mDNS Gateway functionality can be disabled by configuring the no service-routing mdns-sd command-line interface global configuration (CLI) command.
The following identification mechanisms exist for the Cisco IOS Software mDNS Memory Leak Vulnerability:
Embedded Event Manager
A Cisco IOS Embedded Event Manager (EEM) policy that is based on Tool Command Language (Tcl) can be used on vulnerable Cisco IOS devices to identify and detect an interface queue wedge that is caused by this vulnerability. The policy allows administrators to monitor the interfaces on a Cisco IOS device and detect when the interface input queues are full. When Cisco IOS EEM detects potential exploitation of this vulnerability, the policy can trigger a response by sending an alert to the network administrator, who could then decide to implement an upgrade, implement suitable mitigations or reload the device to clear the input queue.
The Tcl script is available for download at the "Cisco Beyond: Embedded Event Manager (EEM) Scripting Community" at the following link: https://supportforums.cisco.com/docs/DOC-19337["https://supportforums.cisco.com/docs/DOC-19337"]
Also see the Cisco Security Blog "Cisco IOS Queue Wedges Explained" at the following link: http://blogs.cisco.com/security/cisco\_ios\_queue\_wedges\_explained/["http://blogs.cisco.com/security/cisco\_ios\_queue\_wedges\_explained/"]
Additional mitigations that can be deployed on Cisco devices within the network are available in the Cisco Applied Mitigation Bulletin companion document for this advisory, which is available at the following link: https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023["https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023"]
When considering software upgrades, customers are advised to consult the Cisco Security Advisories, Responses, and Notices archive at http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"] and review subsequent advisories to determine exposure and a complete upgrade solution.
In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
Cisco IOS Software
Cisco has provided a tool to help customers determine their exposure to vulnerabilities in Cisco IOS Software. The Cisco IOS Software Checker["https://sec.cloudapps.cisco.com/security/center/selectIOSVersion.x"] allows customers to perform the following tasks:
Initiate a search by selecting releases from the drop-down menu or uploading a file from a local system
Enter show version command output for the tool to parse
Create a customized search by including all previously published Cisco Security Advisories, a specific publication, or all advisories in the September 2014 bundled publication
The tool will identify any Cisco Security Advisories that impact a queried software release and the earliest release that corrects all vulnerabilities in each Cisco Security Advisory ("First Fixed"). If applicable, the tool will also return the earliest possible release that corrects all vulnerabilities in all displayed advisories ("Combined First Fixed"). Please visit the Cisco IOS Software Checker["https://sec.cloudapps.cisco.com/security/center/selectIOSVersion.x"] or simply enter a Cisco IOS Software release in the following field to determine whether it is affected by any of the advisories in this bundled publication.
(Example entry: 15.1(4)M2)
Cisco IOS XE Software
Cisco IOS XE Software is affected by the vulnerabilities that are disclosed in this document.
For a mapping of Cisco IOS XE Software releases to Cisco IOS Software releases, refer to Cisco IOS XE 2 Release Notes["http://www.cisco.com/en/US/docs/ios/ios\_xe/2/release/notes/rnasr21.html#wp2310700"], Cisco IOS XE 3S Release Notes["http://www.cisco.com/en/US/docs/ios/ios\_xe/3/release/notes/asr1k\_rn\_3s\_sys\_req.html#wp2999052"], and Cisco IOS XE 3SG Release Notes["http://www.cisco.com/en/US/docs/switches/lan/catalyst4500/release/note/OL\_24726.html#wp2570252"].
Cisco IOS XE Software Release
First Fixed Release
First Fixed Release for All Advisories in the September 2014 Cisco IOS Software Security Advisory Bundled Publication
2.1.x
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
2.2.x
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
2.3.x
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
2.4.x
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
2.5.x
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
2.6.x
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
3.1.xS
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
3.1.xSG
Not vulnerable
Not vulnerable
3.2.xS
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
3.2.xSE
Not vulnerable
Vulnerable; migrate to 3.3.2SE
3.2.xSG
Not vulnerable
Not vulnerable
3.2.xXO
Not vulnerable
Not vulnerable
3.2.xSQ
Not vulnerable
Not vulnerable
3.3.xS
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
3.3.xSE
3.3.2SE
3.3.2SE
3.3.xSG
Not vulnerable.
Vulnerable; migrate to 3.4.4SG or later.
3.3.xXO
3.3.1XO
3.3.1XO
3.3.xSQ
Not vulnerable
Not vulnerable
3.4.xS
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
3.4.xSG
Not vulnerable
3.4.4SG
3.4.xSQ
Not vulnerable
Not vulnerable
3.5.xS
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
3.5.xE
3.5.2E
3.5.2E
3.6.xS
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
3.6.xE
Not vulnerable
Not vulnerable
3.7.xS
Not vulnerable
Vulnerable; migrate to 3.7.6S or later.
3.7.xE
Not vulnerable
Not vulnerable
3.8.xS
Not vulnerable
Vulnerable; migrate to 3.10.4S or later.
3.9.xS
Not vulnerable
Vulnerable; migrate to 3.10.4S or later.
3.10.xS
Not vulnerable
3.10.4S
3.11.xS
3.11.1S
Vulnerable; migrate to 3.12S or later.
3.12.xS
Not vulnerable
Not vulnerable
3.13.xS
Not vulnerable
Not vulnerable
Cisco IOS XR Software
Cisco IOS XR Software is not affected by any of the vulnerabilities that are disclosed in the September 2014 Cisco IOS Software Security Advisory Bundled Publication.
To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.
The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerabilities that are described in this advisory.
These vulnerabilities were discovered during the internal investigation.
THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.
A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.

https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023
Identifying and Mitigating Exploitation of the Multiple Vulnerabilities in Cisco IOS Software Multicast Domain Name System

https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140924-mdns
Multiple Vulnerabilities in Cisco IOS Software Multicast Domain Name System

https://sec.cloudapps.cisco.com/security/center/viewAlert.x?alertId=35607
Cisco IOS Software Multicast Domain Name System Gateway Memory Leak Vulnerability

https://sec.cloudapps.cisco.com/security/center/viewAlert.x?alertId=35608
Cisco IOS Software Multicast Domain Name System Gateway Denial of Service Vulnerability

Cisco IOS 15.1(2)SY

Cisco IOS 15.1(2)SY1

Cisco IOS 15.4(1)T

Cisco IOS 15.4(1)T1

Cisco IOS 15.2(1)E

Cisco IOS 15.2(1)E1

Cisco IOS 15.4(1)S

Cisco IOS XE Software 3.3.0SE

Cisco IOS XE Software 3.3.1SE

Cisco IOS XE Software 3.3.0XO

Cisco IOS XE Software 3.5.0E

Cisco IOS XE Software 3.5.1E

Cisco IOS XE Software 3.11.0S

Cisco IOS Software mDNS Gateway Memory Leak Vulnerability
CSCuj58950
CSCuj58950
Complete.

CVE-2014-3358
CVRFPID-115981
CVRFPID-183811
CVRFPID-184932
CVRFPID-187147
CVRFPID-188061
CVRFPID-196255
CVRFPID-196218
CVRFPID-196220
CVRFPID-196925
CVRFPID-197145
CVRFPID-203353

7.8
6.4
AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C

Access Control Lists
On Cisco IOS and Cisco IOS XE Software releases that do not have a fix for Cisco bug ID CSCum51028, there is currently no way to manually close the port or disable the service.
On those releases, a possible workaround consists of configuring an extended access control list (ACL) that can be created and applied to an interface to block traffic destined to UDP port 5353.
Because the mDNS feature in this vulnerability utilizes UDP as a transport, it is possible to spoof the sender's IP address, which may defeat ACLs that permit communication to these ports from trusted IP addresses. In addition to ACLs, administrators should enable uRPF, a security feature of Cisco IOS Software that verifies the reachability of the source address in packets being forwarded. The combination of these two technologies offers a stronger workaround than ACLs alone.
The ACL example below should be included as part of the deployed interface access-list, which will help protect the device from traffic destined to UDP port 5353:
!---
!--- Deny IPv4 mDNS traffic to a device
!---
access-list 150 deny udp any any eq 5353
!--- Permit/deny all other Layer 3 and Layer 4 IPv4 traffic in
!--- accordance with existing security policies and
!--- configurations. Permit all other traffic to transit the
!--- device.
access-list 150 permit ip any any
!---
!--- Deny IPv6 mDNS traffic to a device
!---
ipv6 access-list v6\_list
deny udp any any eq 5353
!--- Permit/deny all other Layer 3 and Layer 4 IPv6 traffic in
!--- accordance with existing security policies and
!--- configurations. Permit all other traffic to transit the
!--- device.
permit ipv6 any any
!--- Apply access-list to all interfaces (only one example
!--- shown)
interface fastEthernet 2/0
ip access-group 150 in
ipv6 traffic-filter v6\_list in
Control Plane Policing
Control Plane Policing (CoPP) can be used to block untrusted UDP traffic to the device. Cisco IOS Software releases 12.0S, 12.2SX, 12.2S, 12.3T, 12.4, and 12.4T support the CoPP feature. CoPP can be configured on a device to help protect the management and control planes and minimize the risk and effectiveness of direct infrastructure attacks by explicitly permitting only authorized traffic that is sent to infrastructure devices in accordance with existing security policies and configurations.
The CoPP example below should be included as part of the deployed CoPP, which will help protect the device from traffic destined to UDP port 5353:
!---
!--- Match IPv4 mDNS traffic with permit statement
!---
access-list 150 permit udp any any eq 5353
!--- Permit (Police or Drop)/Deny (Allow) all other Layer3 and
!--- Layer4 IPv4 traffic in accordance with existing security policies
!--- and configurations for traffic that is authorized to be sent
!--- to infrastructure devices
!---
access-list 150 deny ip any any
!--- Create a Class-Map for traffic to be policed by
!--- the CoPP feature
!---
class-map match-all drop-udp-class
match access-group 150
!--- Create a Policy-Map that will be applied to the
!--- Control-Plane of the device.
policy-map drop-udp-traffic class drop-udp-class drop
!--- Apply the Policy-Map to the
!--- Control-Plane of the device
control-plane service-policy
input drop-udp-traffic
In the above CoPP example, the access control list entries (ACE) that match the potential exploit packets with the "permit" action result in these packets being discarded by the policy-map "drop" function, while packets that match the "deny" action (not shown) are not affected by the policy-map "drop" function. Please note that the policy-map syntax is different in the 12.2S and 12.0S Cisco IOS software trains:
policy-map drop-udp-traffic
class drop-udp-class
police 32000 1500 1500 conform-action drop exceed-action drop
Note: Cisco does not recommend deploying CoPP for IPv6 traffic.
Additional information on the configuration and use of the CoPP feature can be found in the documents, "Control Plane Policing Implementation Best Practices" and "Control Plane Policing" at the following links: http://www.cisco.com/web/about/security/intelligence/coppwp\_gs.html["http://www.cisco.com/web/about/security/intelligence/coppwp\_gs.html"] and http://www.cisco.com/en/US/docs/ios/12\_4t/12\_4t4/htcpp.html["http://www.cisco.com/en/US/docs/ios/12\_4t/12\_4t4/htcpp.html"]
On Cisco IOS and Cisco IOS XE Software releases that have a fix for Cisco bug ID CSCum51028, mDNS Gateway functionality can be disabled by configuring the no service-routing mdns-sd command-line interface global configuration (CLI) command.
The following identification mechanisms exist for the Cisco IOS Software mDNS Memory Leak Vulnerability:
Embedded Event Manager
A Cisco IOS Embedded Event Manager (EEM) policy that is based on Tool Command Language (Tcl) can be used on vulnerable Cisco IOS devices to identify and detect an interface queue wedge that is caused by this vulnerability. The policy allows administrators to monitor the interfaces on a Cisco IOS device and detect when the interface input queues are full. When Cisco IOS EEM detects potential exploitation of this vulnerability, the policy can trigger a response by sending an alert to the network administrator, who could then decide to implement an upgrade, implement suitable mitigations or reload the device to clear the input queue.
The Tcl script is available for download at the "Cisco Beyond: Embedded Event Manager (EEM) Scripting Community" at the following link: https://supportforums.cisco.com/docs/DOC-19337["https://supportforums.cisco.com/docs/DOC-19337"]
Also see the Cisco Security Blog "Cisco IOS Queue Wedges Explained" at the following link: http://blogs.cisco.com/security/cisco\_ios\_queue\_wedges\_explained/["http://blogs.cisco.com/security/cisco\_ios\_queue\_wedges\_explained/"]
Additional mitigations that can be deployed on Cisco devices within the network are available in the Cisco Applied Mitigation Bulletin companion document for this advisory, which is available at the following link: https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023["https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023"]

https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140924-mdns
Multiple Vulnerabilities in Cisco IOS Software Multicast Domain Name System

Cisco IOS Software mDNS Gateway Denial of Service Vulnerability
CSCul90866
CSCul90866
Complete.

CVE-2014-3357
CVRFPID-115981
CVRFPID-183811
CVRFPID-184932
CVRFPID-187147
CVRFPID-188061
CVRFPID-195469
CVRFPID-196255
CVRFPID-196218
CVRFPID-196220
CVRFPID-196925
CVRFPID-197145
CVRFPID-203353
CVRFPID-206168

7.8
6.4
AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C

Access Control Lists
On Cisco IOS and Cisco IOS XE Software releases that do not have a fix for Cisco bug ID CSCum51028, there is currently no way to manually close the port or disable the service.
On those releases, a possible workaround consists of configuring an extended access control list (ACL) that can be created and applied to an interface to block traffic destined to UDP port 5353.
Because the mDNS feature in this vulnerability utilizes UDP as a transport, it is possible to spoof the sender's IP address, which may defeat ACLs that permit communication to these ports from trusted IP addresses. In addition to ACLs, administrators should enable uRPF, a security feature of Cisco IOS Software that verifies the reachability of the source address in packets being forwarded. The combination of these two technologies offers a stronger workaround than ACLs alone.
The ACL example below should be included as part of the deployed interface access-list, which will help protect the device from traffic destined to UDP port 5353:
!---
!--- Deny IPv4 mDNS traffic to a device
!---
access-list 150 deny udp any any eq 5353
!--- Permit/deny all other Layer 3 and Layer 4 IPv4 traffic in
!--- accordance with existing security policies and
!--- configurations. Permit all other traffic to transit the
!--- device.
access-list 150 permit ip any any
!---
!--- Deny IPv6 mDNS traffic to a device
!---
ipv6 access-list v6\_list
deny udp any any eq 5353
!--- Permit/deny all other Layer 3 and Layer 4 IPv6 traffic in
!--- accordance with existing security policies and
!--- configurations. Permit all other traffic to transit the
!--- device.
permit ipv6 any any
!--- Apply access-list to all interfaces (only one example
!--- shown)
interface fastEthernet 2/0
ip access-group 150 in
ipv6 traffic-filter v6\_list in
Control Plane Policing
Control Plane Policing (CoPP) can be used to block untrusted UDP traffic to the device. Cisco IOS Software releases 12.0S, 12.2SX, 12.2S, 12.3T, 12.4, and 12.4T support the CoPP feature. CoPP can be configured on a device to help protect the management and control planes and minimize the risk and effectiveness of direct infrastructure attacks by explicitly permitting only authorized traffic that is sent to infrastructure devices in accordance with existing security policies and configurations.
The CoPP example below should be included as part of the deployed CoPP, which will help protect the device from traffic destined to UDP port 5353:
!---
!--- Match IPv4 mDNS traffic with permit statement
!---
access-list 150 permit udp any any eq 5353
!--- Permit (Police or Drop)/Deny (Allow) all other Layer3 and
!--- Layer4 IPv4 traffic in accordance with existing security policies
!--- and configurations for traffic that is authorized to be sent
!--- to infrastructure devices
!---
access-list 150 deny ip any any
!--- Create a Class-Map for traffic to be policed by
!--- the CoPP feature
!---
class-map match-all drop-udp-class
match access-group 150
!--- Create a Policy-Map that will be applied to the
!--- Control-Plane of the device.
policy-map drop-udp-traffic class drop-udp-class drop
!--- Apply the Policy-Map to the
!--- Control-Plane of the device
control-plane service-policy
input drop-udp-traffic
In the above CoPP example, the access control list entries (ACE) that match the potential exploit packets with the "permit" action result in these packets being discarded by the policy-map "drop" function, while packets that match the "deny" action (not shown) are not affected by the policy-map "drop" function. Please note that the policy-map syntax is different in the 12.2S and 12.0S Cisco IOS software trains:
policy-map drop-udp-traffic
class drop-udp-class
police 32000 1500 1500 conform-action drop exceed-action drop
Note: Cisco does not recommend deploying CoPP for IPv6 traffic.
Additional information on the configuration and use of the CoPP feature can be found in the documents, "Control Plane Policing Implementation Best Practices" and "Control Plane Policing" at the following links: http://www.cisco.com/web/about/security/intelligence/coppwp\_gs.html["http://www.cisco.com/web/about/security/intelligence/coppwp\_gs.html"] and http://www.cisco.com/en/US/docs/ios/12\_4t/12\_4t4/htcpp.html["http://www.cisco.com/en/US/docs/ios/12\_4t/12\_4t4/htcpp.html"]
On Cisco IOS and Cisco IOS XE Software releases that have a fix for Cisco bug ID CSCum51028, mDNS Gateway functionality can be disabled by configuring the no service-routing mdns-sd command-line interface global configuration (CLI) command.
The following identification mechanisms exist for the Cisco IOS Software mDNS Memory Leak Vulnerability:
Embedded Event Manager
A Cisco IOS Embedded Event Manager (EEM) policy that is based on Tool Command Language (Tcl) can be used on vulnerable Cisco IOS devices to identify and detect an interface queue wedge that is caused by this vulnerability. The policy allows administrators to monitor the interfaces on a Cisco IOS device and detect when the interface input queues are full. When Cisco IOS EEM detects potential exploitation of this vulnerability, the policy can trigger a response by sending an alert to the network administrator, who could then decide to implement an upgrade, implement suitable mitigations or reload the device to clear the input queue.
The Tcl script is available for download at the "Cisco Beyond: Embedded Event Manager (EEM) Scripting Community" at the following link: https://supportforums.cisco.com/docs/DOC-19337["https://supportforums.cisco.com/docs/DOC-19337"]
Also see the Cisco Security Blog "Cisco IOS Queue Wedges Explained" at the following link: http://blogs.cisco.com/security/cisco\_ios\_queue\_wedges\_explained/["http://blogs.cisco.com/security/cisco\_ios\_queue\_wedges\_explained/"]
Additional mitigations that can be deployed on Cisco devices within the network are available in the Cisco Applied Mitigation Bulletin companion document for this advisory, which is available at the following link: https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023["https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=35023"]

https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140924-mdns
Multiple Vulnerabilities in Cisco IOS Software Multicast Domain Name System


