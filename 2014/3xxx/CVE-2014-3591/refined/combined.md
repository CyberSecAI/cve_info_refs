=== Content from www.debian.org_2ab938cb_20250125_102712.html ===


---

[[Date Prev](msg00069.html)][[Date Next](msg00071.html)]
[[Thread Prev](msg00069.html)][[Thread Next](msg00071.html)]
[[Date Index](maillist.html#00070)]
[[Thread Index](threads.html#00070)]

# [SECURITY] [DSA 3185-1] libgcrypt11 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3185-1] libgcrypt11 security update
* *From*: Thijs Kinkhorst <thijs@debian.org>
* *Date*: Thu, 12 Mar 2015 18:53:56 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20150312175356.391325A210%40kinkhorst.com)Â [20150312175356.391325A210@kinkhorst.com](msg00070.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3185-1                   security@debian.org
<http://www.debian.org/security/>                        Alessandro Ghedini
March 12, 2015                         <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libgcrypt11
CVE ID         : CVE-2014-3591 CVE-2015-0837

Multiple vulnerabilities were discovered in libgcrypt:

CVE-2014-3591

    The Elgamal decryption routine was susceptible to a side-channel
    attack discovered by researchers of Tel Aviv University. Ciphertext
    blinding was enabled to counteract it. Note that this may have a
    quite noticeable impact on Elgamal decryption performance.

CVE-2015-0837

    The modular exponentiation routine mpi_powm() was susceptible to a
    side-channel attack caused by data-dependent timing variations when
    accessing its internal pre-computed table.

For the stable distribution (wheezy), these problems have been fixed in
version 1.5.0-5+deb7u3.

We recommend that you upgrade your libgcrypt11 packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJVAdKBAAoJEFb2GnlAHawEGYoIAJDR41vTx6S3mVQBcaaZ+p3Y
kZiMLHqySwXhoLC1T5/X3vwuNk1nO/rbAJsvLo27dRJGCqd7EvhyUYJ9dmo9resN
9ryNUh2e0T6EJ/rt3ytldxE4fRwGL68yIQU7aGcyw1fxh26LHA2NHV+FDdVTylse
EM+HuC2sBLijC7MYsYq9iR0TQi8jiQJqVAijlz8ArvsuOFvqXqqBGsmOplW6cJpP
5y4C9h2tl0pT0JOC1mZEqmalSqCPdxHRNMI8mnz4V/QFvxkAE0kvlLxTGJW5zwje
PO/2eilKsCMqb/q1ccBWsKp4q7OL8f5jAfIy4Aurx014PCp71NxGvzzaTnK3yjA=
=+M3h
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_aaea2d57_20250125_102711.html ===


---

[[Date Prev](msg00068.html)][[Date Next](msg00070.html)]
[[Thread Prev](msg00068.html)][[Thread Next](msg00070.html)]
[[Date Index](maillist.html#00069)]
[[Thread Index](threads.html#00069)]

# [SECURITY] [DSA 3184-1] gnupg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3184-1] gnupg security update
* *From*: Thijs Kinkhorst <thijs@debian.org>
* *Date*: Thu, 12 Mar 2015 18:50:45 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20150312175045.07F775A210%40kinkhorst.com)Â [20150312175045.07F775A210@kinkhorst.com](msg00069.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3184-1                   security@debian.org
<http://www.debian.org/security/>                        Alessandro Ghedini
March 12, 2015                         <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : gnupg
CVE ID         : CVE-2014-3591 CVE-2015-0837 CVE-2015-1606

Multiple vulnerabilities were discovered in GnuPG, the GNU Privacy Guard:

CVE-2014-3591

    The Elgamal decryption routine was susceptible to a side-channel
    attack discovered by researchers of Tel Aviv University. Ciphertext
    blinding was enabled to counteract it. Note that this may have a
    quite noticeable impact on Elgamal decryption performance.

CVE-2015-0837

    The modular exponentiation routine mpi_powm() was susceptible to a
    side-channel attack caused by data-dependent timing variations when
    accessing its internal pre-computed table.

CVE-2015-1606

    The keyring parsing code did not properly reject certain packet
    types not belonging in a keyring, which caused an access to memory
    already freed. This could allow remote attackers to cause a denial
    of service (crash) via crafted keyring files.

For the stable distribution (wheezy), these problems have been fixed in
version 1.4.12-7+deb7u7.

For the upcoming stable distribution (jessie), these problems have been
fixed in version 1.4.18-7.

For the unstable distribution (sid), these problems have been fixed in
version 1.4.18-7.

We recommend that you upgrade your gnupg packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJVAdGHAAoJEFb2GnlAHawEJp4IAI50qDF5+QdQQ/1cvcP1tqda
H9QOu6omsKtiXtyTKQnoRfDmZ6dKblWdJMfH9cK9bfoziixwTTkol374u0xuTucY
MW6x08InvELESJKrgGvnnoj+g3xAvHDBOt0BXcL9tBYV81ZzaHBCS75VwwMwHD8n
B3mErX24JpnTH0Y2C4xAi+SuQ74KasB9FGSz3aAbrkvpwTEOumtLc9NG4mROjRXg
ARRJRIQv+PZ8VW2/vImoMiuAgALRttREtoVbaRoKOg8if/r9g49Ix28QFxrfJV7x
P2CaHXLfdcJq5oPuRltJK7vXmQUYwbgQAzv2Xmy0350HzfQcTTvBUFbld2Nd9dE=
=TLCo
-----END PGP SIGNATURE-----

```

---



=== Content from lists.gnupg.org_66c6b488_20250125_102712.html ===

# [Announce] GnuPG 1.4.19 released (with SCA fix)

**Werner Koch**
wk at gnupg.org

*Fri Feb 27 21:20:54 CET 2015*

* Previous message: [[Announce] GnuPG 2.0.27 "stable" released](000362.html)
* Next message: [[Announce] Libgcrypt 1.6.3 released (with SCA fix)](000364.html)
* **Messages sorted by:**
  [[ date ]](date.html#363)
  [[ thread ]](thread.html#363)
  [[ subject ]](subject.html#363)
  [[ author ]](author.html#363)

---

```
Hello!

We are pleased to announce the availability of a new GnuPG classic
release: Version 1.4.19.  This release mitigates two new side channel
attacks.

Updating any GnuPG 1.4 version to 1.4.19 is suggested!

To update a GnuPG 2.0 or 2.1 version you need to update the shared
library Libgcrypt to version 1.6.3.

What is GnuPG
=============

The GNU Privacy Guard (GnuPG) is a complete and free implementation of
the OpenPGP standard as defined by RFC-4880 and better known as PGP.

GnuPG, also known as GPG, allows to encrypt and sign data and
communication, features a versatile key management system as well as
access modules for public key directories.  GnuPG itself is a command
line tool with features for easy integration with other applications.
A wealth of frontend applications and libraries making use of GnuPG
are available.

GnuPG is Free Software (meaning that it respects your freedom). It can
be freely used, modified and distributed under the terms of the GNU
General Public License.

Three different versions of GnuPG are actively maintained:

- GnuPG "modern" (2.1) is the latest development with a lot of new
  features.

- GnuPG "stable" (2.0) is the current stable version for general use.
  This is what most users are currently using.

- GnuPG "classic" (1.4) is the old standalone version which is most
  suitable for older or embedded platforms.  This announcement is about
  a release of this version.

You may not install "modern" (2.1) and "stable" (2.0) at the same
time.  However, it is possible to install "classic" (1.4) along with
any of the other versions.

What's New in GnuPG 1.4.19
==========================

 * Use ciphertext blinding for Elgamal decryption [CVE-2014-3591].
   See <http://www.cs.tau.ac.il/~tromer/radioexp/> for details.

 * Fixed data-dependent timing variations in modular exponentiation
   [related to CVE-2015-0837, Last-Level Cache Side-Channel Attacks
   are Practical].

 * Detect faulty use of --verify on detached signatures.

 * Changed the PKA method to use CERT records and hashed names.

 * New import option "keep-ownertrust".

 * Support algorithm names when generating keys using the --command-fd
   method.

 * Updated many translations.

 * Updated build system.

 * Fixed a regression in keyserver import

 * Fixed argument parsing for option --debug-level.

 * Fixed DoS based on bogus and overlong key packets.

 * Fixed bugs related to bogus keyrings.

 * The usual minor minor bug fixes.

Getting the Software
====================

Please follow the instructions found at <https://gnupg.org/download/> or
read on:

GnuPG 1.4.19 may be downloaded from one of the GnuPG mirror sites or
direct from its primary FTP server.  The list of mirrors can be found
at <https://gnupg.org/mirrors.html> .  Note that GnuPG is not available
at ftp.gnu.org.

On ftp.gnupg.org you find these files:

 ftp://ftp.gnupg.org/gcrypt/gnupg/gnupg-1.4.19.tar.bz2  (3627k)
 ftp://ftp.gnupg.org/gcrypt/gnupg/gnupg-1.4.19.tar.bz2.sig

This is the GnuPG 1.4.19 source code compressed using BZIP2 and its
OpenPGP signature.

 ftp://ftp.gnupg.org/gcrypt/gnupg/gnupg-1.4.19.tar.gz  (5020k)
 ftp://ftp.gnupg.org/gcrypt/gnupg/gnupg-1.4.19.tar.gz.sig

This is the same GnuPG 1.4.19 source code compressed using GZIP and its
OpenPGP signature.

 ftp://ftp.gnupg.org/gcrypt/binary/gnupg-w32cli-1.4.19.exe (1586k)
 ftp://ftp.gnupg.org/gcrypt/binary/gnupg-w32cli-1.4.19.exe.sig

This is GnuPG 1.4.19 compiled for Microsoft Windows and its OpenPGP
signature.  This is a command line only version; the source files are
the same as above.  Note, that this is a minimal installer and unless
you are only in need for the simple the gpg binary, you are better off
using the full featured installer at <https://www.gpg4win.org> .

Checking the Integrity
======================

In order to check that the version of GnuPG which you are going to
install is an original and unmodified one, you can do it in one of
the following ways:

 * If you already have a version of GnuPG installed, you can simply
   verify the supplied signature.  For example to verify the signature
   of the file gnupg-1.4.19.tar.bz2 you would use this command:

     gpg --verify gnupg-1.4.19.tar.bz2.sig gnupg-1.4.19.tar.bz2

   This checks whether the signature file matches the source file.
   You should see a message indicating that the signature is good and
   made by one or more of the release signing keys.  Make sure that
   this is a valid key, either by matching the shown fingerprint
   against a trustworthy list of valid release signing keys or by
   checking that the key has been signed by trustworthy other keys.
   See below for information on the signing keys.

 * If you are not able to use an existing version of GnuPG, you have
   to verify the SHA-1 checksum.  On Unix systems the command to do
   this is either "sha1sum" or "shasum".  Assuming you downloaded the
   file gnupg-1.4.19.tar.bz2, you would run the command like this:

     sha1sum gnupg-1.4.19.tar.bz2

   and check that the output matches the first line from the
   following list:

5503f7faa0a0e84450838706a67621546241ca50  gnupg-1.4.19.tar.bz2
d0cf40cc42ce057d7d747908ec21a973a423a508  gnupg-1.4.19.tar.gz
dc03ae4e4c3e8fe0583b37dd6c3124f94246d2f8  gnupg-w32cli-1.4.19.exe

Release Signing Keys
====================

To guarantee that a downloaded GnuPG version has not been tampered by
malicious entities we provide signature files for all tarballs and
binary versions.  The keys are also signed by the long term keys of
their respective owners.  Current releases are signed by one or more
of these four keys:

  2048R/4F25E3B6 2011-01-12 [expires: 2019-12-31]
  Key fingerprint = D869 2123 C406 5DEA 5E0F  3AB5 249B 39D2 4F25 E3B6
  Werner Koch (dist sig)

  rsa2048/E0856959 2014-10-29 [expires: 2019-12-31]
  Key fingerprint = 46CC 7308 65BB 5C78 EBAB  ADCF 0437 6F3E E085 6959
  David Shaw (GnuPG Release Signing Key) <dshaw 'at' jabberwocky.com>

  rsa2048/33BD3F06 2014-10-29 [expires: 2016-10-28]
  Key fingerprint = 031E C253 6E58 0D8E A286  A9F2 2071 B08A 33BD 3F06
  NIIBE Yutaka (GnuPG Release Key) <gniibe 'at' fsij.org>

  rsa2048/7EFD60D9 2014-10-19 [expires: 2020-12-31]
  Key fingerprint = D238 EA65 D64C 67ED 4C30  73F2 8A86 1B1C 7EFD 60D9
  Werner Koch (Release Signing Key)

You may retrieve these files from the keyservers using this command

  gpg --recv-keys 249B39D24F25E3B6 04376F3EE0856959 \
                  2071B08A33BD3F06 8A861B1C7EFD60D9

The keys are also available at <https://gnupg.org/signature_key.html> .
Note that this mail has been signed using my standard PGP key.

Support
========

Please consult the archive of the gnupg-users mailing list before
reporting a bug <<https://gnupg.org/documentation/mailing-lists.html>>.
We suggest to send bug reports for a new release to this list in favor
of filing a bug at <<https://bugs.gnupg.org>>.  For commercial support
requests we keep a list of known service companies at:

  <https://gnupg.org/service.html>

If you are a developer and you may need a certain feature for your
project, please do not hesitate to bring it to the gnupg-devel mailing
list for discussion.

Thanks
======

We have to thank all the people who helped with this release, be it
testing, coding, translating, suggesting, auditing, administering the
servers, spreading the word, and answering questions on the mailing
lists.

Since the start of the funding campaign in December several thousand
people have been kind enough to donate a total of 250000 Euro to support
this project.  In addition the Linux Foundation gave a grant of $ 60000
for 2015, Stripe.com and Facebook.com each pledged $ 50000 per year.

I am amazed by this superb and unexpected support for the GnuPG project.
This does not only allow us to continue the project and allowed to hire
second full time developer, but also gives the resources to improve
things which have been delayed for too long.

*Thank you all !*

Salam-Shalom,

   Werner

p.s.
This is a announcement only mailing list.  Please send replies only to
the gnupg-users at gnupg.org mailing list.

--
Die Gedanken sind frei.  Ausnahmen regelt ein Bundesgesetz.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: </pipermail/attachments/20150227/86dd6e5c/attachment.sig>

```

---

* Previous message: [[Announce] GnuPG 2.0.27 "stable" released](000362.html)
* Next message: [[Announce] Libgcrypt 1.6.3 released (with SCA fix)](000364.html)
* **Messages sorted by:**
  [[ date ]](date.html#363)
  [[ thread ]](thread.html#363)
  [[ subject ]](subject.html#363)
  [[ author ]](author.html#363)

---

[More information about the Gnupg-announce
mailing list](http://lists.gnupg.org/mailman/listinfo/gnupg-announce)



=== Content from lists.gnupg.org_4c3aca7a_20250125_102712.html ===

# [Announce] Libgcrypt 1.6.3 released (with SCA fix)

**Werner Koch**
wk at gnupg.org

*Fri Feb 27 21:39:05 CET 2015*

* Previous message: [[Announce] GnuPG 1.4.19 released (with SCA fix)](000363.html)
* **Messages sorted by:**
  [[ date ]](date.html#364)
  [[ thread ]](thread.html#364)
  [[ subject ]](subject.html#364)
  [[ author ]](author.html#364)

---

```
Hello!

The GNU project is pleased to announce the availability of Libgcrypt
version 1.6.3.  This is a security fix release to mitigate two new side
channel attacks.

Libgcrypt is a general purpose library of cryptographic building blocks.
It does not provide any implementation of OpenPGP or other protocols.
Thorough understanding of applied cryptography is required for proper
use Libgcrypt.

Noteworthy changes in version 1.6.3
===================================

 * Use ciphertext blinding for Elgamal decryption [CVE-2014-3591].
   See <http://www.cs.tau.ac.il/~tromer/radioexp/> for details.

 * Fixed data-dependent timing variations in modular exponentiation
   [related to CVE-2015-0837, Last-Level Cache Side-Channel Attacks
   are Practical].

 * Improved asm support for older toolchains.

Download
========

Source code is hosted at the GnuPG FTP server and its mirrors as listed
at <http://www.gnupg.org/download/mirrors.html> .  On the primary server
the source tarball and its digital signature are:

 ftp://ftp.gnupg.org/gcrypt/libgcrypt/libgcrypt-1.6.3.tar.bz2 (2436k)
 ftp://ftp.gnupg.org/gcrypt/libgcrypt/libgcrypt-1.6.3.tar.bz2.sig

That file is bzip2 compressed.  A gzip compressed version is here:

 ftp://ftp.gnupg.org/gcrypt/libgcrypt/libgcrypt-1.6.3.tar.gz (2893k)
 ftp://ftp.gnupg.org/gcrypt/libgcrypt/libgcrypt-1.6.3.tar.gz.sig

In order to check that the version of Libgcrypt you are going to build
is an original and unmodified one, you can do it in one of the following
ways:

 * Check the supplied OpenPGP signature.  For example to check the
   signature of the file libgcrypt-1.6.3.tar.bz2 you would use this
   command:

     gpg --verify libgcrypt-1.6.3.tar.bz2.sig libgcrypt-1.6.3.tar.bz2

   This checks whether the signature file matches the source file.  You
   should see a message indicating that the signature is good and made
   by one of the release signing keys.
   See <https://gnupg.org/signature_key.html> .

 * If you are not able to use GnuPG, you have to verify the SHA-1
   checksum:

     sha1sum libgcrypt-1.6.3.tar.bz2

   and check that the output matches the first line from the
   following list:

9456e7b64db9df8360a1407a38c8c958da80bbf1  libgcrypt-1.6.3.tar.bz2
4d56b5d754d39acae239f876537672e1dc8298e3  libgcrypt-1.6.3.tar.gz

Copying
=======

Libgcrypt is distributed under the terms of the GNU Lesser General
Public License (LGPLv2.1+).  The helper programs as well as the
documentation are distributed under the terms of the GNU General Public
License (GPLv2+).  The file LICENSES has notices about contributions
that require these additional notices are distributed.

Support
=======

For help on developing with Libgcrypt you should read the included
manual and optional ask on the gcrypt-devel mailing list [1].  A
listing with commercial support offers for Libgcrypt and related
software is available at the GnuPG web site [2].

If you are a developer and you may need a certain feature for your
project, please do not hesitate to bring it to the gcrypt-devel mailing
list for discussion.

Thanks
======

We have to thank all the people who helped with this release, be it
testing, coding, translating, suggesting, auditing, administering the
servers, spreading the word, and answering questions on the mailing
lists.  Niibe Yutaka did most of the work on fixing the side channel
attacks.  Special thanks to
 a) Daniel Genkin and his team for working with us on the fix for the
    "radioexp" attack,
 b) Yuval Yarum and its team for advance information on their new cache
    attack and sample code on how to fix it.

Since the start of the GnuPG funding campaign in December several
thousand people have been kind enough to donate a total of 250000 Euro
to support this project.  In addition the Linux Foundation gave a grant
of $ 60000 for 2015, Stripe.com and Facebook.com each pledged $ 50000
per year.

I am amazed by this superb and unexpected support for the GnuPG project.
This will not only allow us to continue the project and hire a second
full time developer but gives us also the resources to improve things
which have been delayed for too long.

*Thank you all !*

Happy hacking,

  Werner

[1] <http://lists.gnupg.org/mailman/listinfo/gcrypt-devel>
[2] <https://www.gnupg.org/service.html>

p.s.
This is a announcement only mailing list.  Please send replies only to
the gcrypt-devel at gnupg.org mailing lists.
--
Die Gedanken sind frei.  Ausnahmen regelt ein Bundesgesetz.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: </pipermail/attachments/20150227/fdb445ed/attachment.sig>

```

---

* Previous message: [[Announce] GnuPG 1.4.19 released (with SCA fix)](000363.html)
* **Messages sorted by:**
  [[ date ]](date.html#364)
  [[ thread ]](thread.html#364)
  [[ subject ]](subject.html#364)
  [[ author ]](author.html#364)

---

[More information about the Gnupg-announce
mailing list](http://lists.gnupg.org/mailman/listinfo/gnupg-announce)



=== Content from www.cs.tau.ac.il_152487c9_20250125_102705.html ===

# Stealing Keys from PCs using a Radio: Cheap Electromagnetic Attacks on Windowed Exponentiation

| Daniel Genkin | Lev Pachmanov | Itamar Pipman | [Eran Tromer](http://cs.tau.ac.il/~tromer/ "Eran Tromer") |
| --- | --- | --- | --- |
| Technion and Tel Aviv University | Tel Aviv University | Tel Aviv University | Tel Aviv University |

 This web page contains an overview of, and Q&A
about, our recent results published in a [**technical
paper** (PDF, 2.1MB)](http://www.cs.tau.ac.il/~tromer/papers/radioexp.pdf), archived as [IACR
ePrintÂ 2015/170](http://eprint.iacr.org/2015/170). It was presented at the *Workshop on
Cryptographic Hardware and Embedded Systems ([CHES](https://www.cryptoexperts.com/ches2015/))
2015* in September 2015.

This research was conducted at the [Laboratory
for
Experimental Information Security (LEISec)](http://www.cs.tau.ac.il/~tromer/leisec).

In February 2016 we
published a follow-up paper, "[ECDH Key-Extraction
via Low-Bandwidth Electromagnetic Attacks on PCs](../ecdh/)", about
electromagnetic attacks on ECDH encryption.

In March 2016 we published another follow-up paper, "[ECDSA
Key Extraction from Mobile Devices via Nonintrusive Physical Side
Channels](../mobilesc/)", about extracting ECDSA secret keys from mobile phones.

## Overview

We demonstrate the extraction of secret decryption keys from laptop
computers, by nonintrusively measuring electromagnetic emanations for a
few seconds from a distance of 50 cm. The attack can be executed using
cheap and readily-available equipment: a consumer-grade radio receiver
or a Software Defined Radio USB dongle. The setup is compact and can
operate untethered; it can be easily concealed, e.g., inside pita bread.
Common laptops, and popular implementations of [RSA](http://en.wikipedia.org/wiki/RSA_%28cryptosystem%29)
and [ElGamal](http://en.wikipedia.org/wiki/ElGamal_encryption)
encryptions, are vulnerable to this attack, including those that
implement the decryption using modern exponentiation algorithms such as
sliding-window, or even its side-channel resistant variant, fixed-window
(*m*-ary) exponentiation.

We successfully extracted keys from laptops of various models running [GnuPG](https://www.gnupg.org/index.html) (popular open source
encryption software, implementing the [OpenPGP](http://www.openpgp.org/)
standard), within a few seconds. The attack sends a few carefully-crafted
ciphertexts, and when these are decrypted by the target computer, they
trigger the occurrence of specially-structured values inside the
decryption software. These special values cause observable fluctuations in
the electromagnetic field surrounding the laptop, in a way that depends on
the pattern of key bits (specifically, the key-bits window in the
exponentiation routine). The secret key can be deduced from these
fluctuations, through signal processing and cryptanalysis.

The attack can be mounted using various experimental setups:

* ***Software Defined Radio (SDR)
  attack.*** We constructed a simple shielded loop
  antenna (15 cm in diameter) using a coaxial cable. We then recorded
  the signal produced by the probe using an SDR receiver. The
  electromagnetic field, thus measured, is affected by ongoing
  computation, and our attacks exploit this to extract RSA and ElGamal
  keys, within a few seconds.

  [![Electromagnetic measurement](fcd-loop-close-handheld---w800.jpg)](fcd-loop-close-handheld---fullres.jpg)
* ***Untethered SDR
  attack.*** Setting out to simplify and shrink the
  analog and analog-to-digital portion of the measurement setup, we
  constructed the Portable Instrument for Trace Acquisition (Pita),
  which is built of readily-available electronics and food items ([see
  instructions here](#setupBuild)). Pita can be
  operated in two modes. In *online mode*, it
  connects wirelessly to a nearby observation station via WiFi, and
  provides real-time streaming of the digitized signal. The live stream
  helps optimize probe placement and allows adaptive recalibration of
  the carrier frequency and SDR gain adjustments. In *autonomous
  mode*, Pita is configured to
  continuously measure the electromagnetic field around a designated
  carrier frequency, and records the digitized signal into an internal
  microSD card for later retrieval, by physical access or via WiFi. In
  both cases, signal analysis is done offline, on a workstation.
  [![Untethered Attack](untethered-pita-with-baudline---w800.jpg)](untethered-pita-with-baudline---fullres.jpg)
* ***Consumer radio attack.***
  Despite its low price and compact size, assembly of the Pita
  device still requires the purchase of an SDR device. As discussed,
  the leakage signal is modulated around a carrier circa 1.7 MHz,
  located in the range of the commercial AM radio frequency band. We
  managed to use a plain consumer-grade radio receiver to acquire
  the desired signal, replacing the magnetic probe and SDR receiver.
  We then recorded the signal by connecting it to the microphone
  input of an HTC EVO 4G smartphone.

  [![radio attack](radio-afar---w800.jpg)](radio-afar---fullres.jpg)

---

## Q&A

### Q1: What information is leaked by the electromagnetic emanations from computers?

 This depends on the specific
computer hardware. We have tested numerous laptop computers, and found the
following:

* InÂ almost all machines, it is possible to tell, with
  sub-millisecond precision, whether the computer is idle or performing
  operations.
* On many machines, it is moreover possible to distinguish different
  patterns of CPU operations and different programs.
* Using [GnuPG](http://www.gnupg.org/) as our study case,
  we can, on some machines:
  + distinguish between the spectral signatures of different RSA
    secret keys (signing or decryption), and
  + fully extract decryption keys, by measuring the laptop's
    electromagnetic emanations during decryption of a chosen
    ciphertext.

A good way to visualize the signal is as a spectrogram, which plots the
measured power as a function of time and frequency. For example, in the
following spectrogram (recorded using the [first
setup pictured above](index.html#simpleSDR)), time runs vertically (spanning 2.1 seconds)
and frequency runs horizontally (spanning 1.6-1.75 MHz).Â  During this
time, the CPU performs loops of different operations (multiplications,
additions, memory accesses, etc.). One can easily discern when the CPU is
performing each operation, due to the different spectral signatures.

[![various CPU operations](EM-rattlew-n200---w800.png)](EM-rattlew-n200.png)

### Q2: Why does this happen?

Different CPU operations have different power requirements. As different
computations are performed during the decryption process, different
electrical loads are placed on the voltage regulator that provides the
processor with power. The regulator reacts to these varying loads,
inadvertently producing electromagnetic radiation that propagates away
from the laptop and can be picked up by a nearby observer. This radiation
contains information regarding the CPU operations used in the decryption,
which we use in our attack.
### Q3: How can I construct such a setup?

* Software
  Defined Radio (SDR) attack. The main component in the [first
  setup](index.html#simpleSDR) is aÂ [FUNcube
  Dongle Pro+](http://www.funcubedongle.com/) SDR receiver.Â Numerous cheap alternatives
  exist, including ``[rtl-sdr'](http://sdr.osmocom.org/trac/wiki/rtl-sdr)'
  USB receivers based on the Realtek RTL2832U chip (originally intended
  for DVB-T television receivers) with a suitable tuner and upconverter;
  the [Soft66RTL2 dongle](http://zao.jp/radio/soft66rtl/)
  is one such example.
* Untethered
  SDR attack. The [Pita
  device](#Untethered_SDR_attack) uses an unshielded loop antenna made of plain copper
  wire, wound into 3 turns of diameter 13 cm, with a tuning capacitor
  chosen to maximize sensitivity at 1.7 MHz (which is where the
  key-dependent leakage signal is present). These are connected to the
  aforementioned [FUNcube
  Dongle Pro+](http://www.funcubedongle.com/) SDR receiver. We control the SDR receiver using a
  small embedded computer, the [Rikomagic
  MK802
  IV](http://www.rikomagic.com/en/product/showpro_id_39_pid_19.html). This is an inexpensive Android TV dongle based on the
  Rockchip RK3188 ARM SoC. It supports USB host mode, WiFi and flash
  storage. We replaced the operating system with Debian Linux, in order
  to run our software, which operates the SDR receiver via USB and
  communicates via WiFi. Power is provided by 4 NiMH AA batteries, which
  suffice for several hours of operation.
  [![Pita Device](resized_untethered-pita-closeup---annotated---w800.png)](untethered-pita-closeup---annotated.png)

* Consumer
  radio attack. We have tried many consumer-grade radio
  receivers and smartphones with various results. Best results were
  achieved using a "Road Master" brand consumer radio connected to the
  microphone jack of an HTC EVO 4G smartphone, sampling at 48 kHz,
  through an [adapter
  cable](http://wiki.backyardbrains.com/Making_your_own_Smartphone_Cable).Â The dedicated line-in inputs of PCs and sound cards
  do not require such an adapter, and yield similar results.

### Q4: What is the range of the attack?

In order to extend the attack range, we added a 50dB gain stage using a
pair of inexpensive low-noise amplifiers ([Mini-Circuits](http://www.minicircuits.com/homepage/homepage.html)
[ZFL-500LN+](http://www.minicircuits.com/pdfs/ZFL-500LN%2B.pdf)
and [ZFL-1000LN+](http://www.minicircuits.com/pdfs/ZFL-1000LN%2B.pdf)
in series, 175$ total). We also added a low-pass filter before the
amplifiers. With this enhanced setup, the attack can be mounted from 50 cm
away. Using better antennas, amplifiers and digitizers, the range can be
extended even further.

Â [![long-range attack](fcd-longrange-53cm---w800.jpg)](fcd-longrange-53cm---fullres.jpg)
### Q5: What if I can't get physically close enough to the target computer?

There are still attacks that can be mounted from large distances.

* *Laptop-chassis potential*, measured from the *far end*
  of virtually any shielded cable connected to the laptop (such as
  Ethernet, USB, HDMI and VGA cables) can be used for key-extraction, as
  we demonstrated in a [paper presented at
  CHES'14](../handsoff/).
* *Acoustic emanations (sound)*, measured via a microphone, can
  also be used to extract keys from a range of several meters, as we
  showed in a [paper presented at CRYPTO'14](../acoustic).

### Q6: What's new since your previous papers?

* *Cheap experimental setup.* The previous papers required
  either a long attack time (about an hour) when using inexpensive
  equipment, or a fast attack (a few seconds) but using an expensive
  setup. In this paper we achieve the best of *both*, presenting
  an experimental setup which extracts keys quickly while remaining
  simple and cheap to construct.
* *New cryptographic technique addressing modern implementations*.
  In the previous papers we attacked the naive square-and-multiply
  exponentiation algorithm and the square-and-always-multiply variant
  (which reduces side-channel leakage). However, most modern
  implementations utilize faster exponentiation algorithms:
  sliding-window, or for better side-channel resistance, *m*-ary
  exponentiation. In this paper we demonstrate a low-bandwidth attack on
  the latter two algorithms, extracting their secret keys.

### Q7: How can low-frequency (kHz) leakage provide useful information about a much faster (GHz) computation?

We use two main techniques.

1. Leakage
   self-amplification. Individual
   CPU
   operations are too fast for our measurement equipment to pick up, but
   long operations (e.g., modular exponentiation in RSA and ElGamal) can
   create a characteristic (and detectable) spectral signature over many
   milliseconds. Using a suitably chosen ciphertext, we are able to use
   the algorithm's  *own*  code to amplify its own key leakage,
   creating very drastic changes, detectable even by low-bandwidth means.
2. Data-dependent
   leakage. While most implementations (such as GnuPG) attempt
   to decouple the secret key from the sequence of performedÂ operations,
   theÂ operands to these
   operations are key-dependent and often not fully randomized. The
   attacker can thus attempt to craft special inputs (e.g., ciphertexts
   to be decrypted) to the cryptographic algorithm that "poison" the
   intermediate values inside the algorithm, producing a distinct leakage
   pattern when used as operands during the algorithm's execution.
   Measuring leakage during such a poisoned execution can reveal in which
   operations the operands occurred, and thus leak secret-key
   information.

   For example, the figure presents the leakage signal (after suitable
   processing) of an ElGamal decryption. The signal appears to be mostly
   regular in shape, and each peak corresponds to a multiplication
   performed by GnuPG's exponentiation routine. However, an occasional
   "dip" (low peak) can be seen. These dips correspond to a
   multiplication by a poisoned value performed within the exponentiation
   routine.
   [![signal example](perfrct-signal-ann---w800.png)](perfrct-signal-ann.png)

### Q8: How vulnerable is GnuPG now?

We have disclosed our attack to GnuPG developers under [CVE-2014-3591](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3591),
suggested suitable countermeasures, and worked with the developers to test
them. [GnuPG
1.4.19](http://lists.gnupg.org/pipermail/gnupg-announce/2015q1/000363.html) and [Libgcrypt
1.6.3](http://lists.gnupg.org/pipermail/gnupg-announce/2015q1/000364.html) (which underlies GnuPG 2.x), containing these countermeasures
and resistant to the key-extraction attack described here, were released
concurrently with the first public posting of these results.
### Q9: How vulnerable are other algorithms and cryptographic implementations?

This is an open research question. Our attack requires careful
cryptographic analysis of the implementation, which so far has been
conducted only for the GnuPG 1.x implementation of RSA and ElGamal.
Implementations using ciphertext blinding (a common side-channel
countermeasure) appear less vulnerable.
### Q10: Is there a realistic way to perform a chosen-ciphertext attack on GnuPG?

GnuPG is often invoked to decrypt externally-controlled inputs, fed
into it by numerous frontends, via emails, files, chat and web pages.
The [list
of
GnuPG frontends](https://www.gnupg.org/related_software/frontends.html) contains dozens of such applications, each of them
can be potentially used in order to make the target decrypt the chosen
ciphertexts required by our attack. As a concrete example, [Enigmail](https://www.enigmail.net/)
(a popular plugin to the Thunderbird e-mail client) automatically
decrypts incoming e-mail (for notification purposes) using GnuPG. An
attacker can e-mail suitably-crafted messages to the victims (using the
[OpenPGP](http://tools.ietf.org/rfc/rfc4880) and [PGP/MIME](http://tools.ietf.org/rfc/rfc3516)
protocols), wait until they reach the target computer, and observe the
target's EM emanationsÂ during their decryption (as shown above),
thereby closing the attack loop. We have empirically verified that such
an injection method does not have any noticeable effect on the leakage
signal produced by GnuPG running on the target laptop. GnuPG's Outlook
plugin, GpgOL also did not seem to alter the target's leakage signal.

### Q11: What countermeasures are available?

Physical mitigation techniques of electromagnetic radiation include
Faraday cages. However, inexpensive protection of consumer-grade PCs
appears difficult. Alternatively, the cryptographic software can be
changed, and algorithmic techniques employed to render the emanations less
useful to the attacker. These techniques ensure that the rough-scale
behavior of the algorithm is independent of the inputs it receives; they
usually carry some performance penalty, but are often used in any case to
thwart other side-channel attacks. This is what we helped implement in
GnuPG (see [Q8](#Q-GnuPG)).
### Q12: Why software countermeasures? Isn't it the hardware's responsibility to avoid physical leakage?

It is tempting to enforce proper layering and decree that preventing
physical leakage is the responsibility of the physical hardware.
Unfortunately, such low-level leakage prevention is often impractical
due to the very bad cost vs. security tradeoff: (1) any leakage remnants
can often be amplified by suitable manipulation at the higher levels, as
we indeed do in our chosen-ciphertext attack; (2) low-level mechanisms
try to protect all computation, even though most of it is insensitive or
does not induce easily-exploitable leakage; and (3) leakage is often an
inevitable side effect of essential performance-enhancing mechanisms
(e.g., consider [cache
attacks](http://www.tau.ac.il/~tromer/papers/cache.pdf)).

Application-layer, algorithm-specific mitigation, in contrast, prevents
the (inevitably) leaked signal from bearing any useful information. It
is often cheap and effective, and most cryptographic software (including
GnuPG and libgcrypt) already includes various sorts of mitigation, both
through explicit code and through choice of algorithms. In fact, the
side-channel resistance of software implementations is nowadays a major
concern in the choice of cryptographic primitives, and was an explicit
evaluation criterion in NIST's AES and SHA-3 competitions.

### Q13: What does the RSA leakage look like?

Here is an example of a spectrogram (which plots the measured power as a
function of time and frequency) for a recording of GnuPG decrypting the
sameÂ ciphertext using different randomly generated RSA keys:

[![spectrogram of multiple GnuPG RSA decryptions](n200-manykeys-EM-h500.png "spectrogram of multiple GnuPG RSA decryptions")](n200-manykeys-EM.png)

In this spectrogram, the horizontal axis (frequency) spans ranges from
1.72 MHz to 1.78 MHz, and the vertical axis (time) spans 1.2 seconds. Each
yellow arrow points to the middle of a GnuPG RSA decryption. It is easy to
see where each decryption starts and ends. Notice the change in the middle
of each decryption operation, spanning several frequency bands. This is
because, internally, each GnuPG RSA decryption first exponentiates modulo
the secret prime *p* and then modulo the secret prime *q*,
and we can actually see the difference between these stages. Moreover,
each of these pairs looks different because each decryption uses a
different key. So in this example, by simply observing electromagnetic
emanationsÂ during decryption operations, using the setup from [this
figure](#simpleSDR), we can distinguish between different secret keys.
### Q14: What is the difference between your attack and the recent cache attack by Yarom et al.?

Cache side channel (timing cross-talk between processes or virtual
machines) apply to scenarios where the attacker can execute code on the
same physical machine as the targeted process (e.g., in shared computers,
such as Infrastructure as a Service cloud computing).

Our attack exploits physical information leakage from
computation devices, and does not require the attacker to execute his own
code on the intended target.

---

## Acknowledgments

We thank [Werner
Koch](http://werner.eifelkommune.de/), lead developer of GnuPG, for the prompt response to our
disclosure and the productive collaboration in adding suitable
countermeasures. Erik Olson's
[Baudline](http://www.baudline.com/) signal analysis
software was used for some of the analysis.

This work was sponsored by the [Check
Point Institute for Information Security](http://cpiis.cs.tau.ac.il/); by the European
Union's Tenth Framework Programme (FP10/2010-2016) under grant
agreement 259426 ERC-CaC; by the Leona M. & Harry B. Helmsley
Charitable Trust; by the Israeli
Ministry of Science and Technology; by the Israeli
Centers of Research Excellence I-CORE Program (center 4/11);
and by NATO's Public
Diplomacy Division in the Framework of "Science for Peace".

---


