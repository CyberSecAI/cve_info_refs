### CVE-2014-3496

**Root cause of vulnerability:**
The `rubygem-openshift-origin-node` package does not properly validate the 'Source-Url' of cartridge manifest files during application creation, leading to command injection. Specifically, the `cartridge_repository.rb` file constructs a `tar` command using the `source_url` without proper sanitization, which allows for arbitrary command execution if the `source_url` contains malicious characters such as `;`.

**Weaknesses/vulnerabilities present:**
- Command injection: The vulnerability lies in the insecure use of user-supplied input (cartridge `source_url`) in a system command. The `tar` command is executed via `Utils.oo_spawn` using the `source_url` directly, allowing an attacker to inject arbitrary commands by including special characters like `;` within the URL.
- Insufficient input validation: Although the manifest file validates that the 'Source-Url' is a valid URI, it does not sanitize the input to prevent command injection.

**Impact of exploitation:**
- Arbitrary code execution: A remote, authenticated user who is permitted to install cartridges can execute arbitrary code with root privileges on the Red Hat OpenShift Enterprise node server.
- System compromise: The successful exploitation can lead to complete compromise of the OpenShift node server.
- The PoC showed that the node can be rebooted by injecting a `reboot` command via the `Source-Url`.

**Attack vectors:**
- Remote exploitation: A malicious user can exploit this flaw through the web interface of Red Hat OpenShift Enterprise.
- Authenticated user: An attacker needs to be an authenticated user with permissions to install cartridges via the web interface.
- Malicious cartridge manifest: The attacker would need to create or modify a cartridge manifest file with a malicious `Source-Url`.
- Crafted URL: The attacker crafts a URL, including malicious commands, that points to a malicious archive (`.tar.gz`, `.tgz`, `.tar`, or `.zip`).

**Required attacker capabilities/position:**
- Network access: The attacker must have network access to the Red Hat OpenShift Enterprise node server.
- Authenticated access: The attacker must have a valid user account with permissions to install cartridges via the web interface.
- Knowledge of the vulnerability: The attacker must be aware of this command injection vulnerability and know how to craft a malicious `Source-Url` within a cartridge manifest file.
- Hosting a malicious archive: The attacker needs to host a malicious archive at a URL specified in the malformed manifest file.