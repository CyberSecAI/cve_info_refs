=== Content from wiki.jenkins-ci.org_cf83555a_20250124_113430.html ===


# Jenkins Security Advisory 2014-10-30

This advisory announces a security vulnerability/hardening (CVE-2014-3665) in Jenkins core.

## Description

Historically, Jenkins controller and agents behaved as if they altogether form a single distributed process. This means an agent can ask a controller to do just about anything within the confinement of the operating system, such as accessing files on the Jenkins controller or trigger other jobs on Jenkins.

This has increasingly become problematic, as larger enterprise deployments have developed more sophisticated trust separation model, where the administators of a controller might take agents owned by other teams. In such an environment, agents are less trusted than the Jenkins controller. Yet the "single distributed process" assumption was not communicated well to the users, resulting in vulnerabilities in some deployments.

SECURITY-144 (CVE-2014-3665) introduces a new subsystem to address this problem. This feature is off by default for compatibility reasons. See [Wiki](/redirect/security-144/) for more details, who should turn this on, and implications.

## Severity

CVE-2014-3665 is rated **high**. It only affects installations that accept agents from less trusted computers, but this will allow an owner of of such an agent to mount a remote code execution attack on Jenkins.

## Affected Versions

The following versions are affected, but only if you connect agents that are managed by less trusted users.

* All the main line releases < 1.587
* All the LTS releases < 1.580.1

## Fix

* Main line users should upgrade to 1.587
* LTS users should upgrade to 1.580.1

## Other Resources

* [Corresponding security advisory on CloudBees regarding DEV@cloud, Jenkins Enterprise by CloudBees, and Jenkins Operations Center by CloudBees](https://www.cloudbees.com/jenkins-security-advisory-2014-10-30)



=== Content from wiki.jenkins-ci.org_e2659ff4_20250126_005307.html ===
Please click [here](/httpservice/retry/enablejs?sei=c4eVZ9qyLrKjhbIP8P2buAw) if you are not redirected within a few seconds.If you're having trouble accessing Google Search, please[click here](/search?q=site:jenkins.io+Slave+To+Master+Access+Co&sca_esv=5b47f35e48776029&emsg=SG_REL&sei=c4eVZ9qyLrKjhbIP8P2buAw), or send[feedback](https://support.google.com/websearch).

=== Content from access.redhat.com_78159c07_20250126_005307.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_5583d41e_20250124_113429.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1147767)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1147767)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1147767)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1147767

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1147767**](show_bug.cgi?id=1147767)
(CVE-2014-3665)
- [CVE-2014-3665](https://access.redhat.com/security/cve/CVE-2014-3665) jenkins: remote code execution from slaves (SECURITY-144)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-3665 jenkins: remote code execution from slaves (SECURITY-144)

| | [Keywords](describekeywords.cgi): | Reopened  Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-3665 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1158239](show_bug.cgi?id=1158239) [1158241](show_bug.cgi?id=1158241) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1103334](show_bug.cgi?id=1103334) [1147771](show_bug.cgi?id=1147771) | | TreeView+ | [depends on](buglist.cgi?bug_id=1147767&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1147767&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2014-09-30 03:47 UTC by Murray McAllister | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-12 13:39 UTC ([History](show_activity.cgi?id=1147767)) | | [CC List:](page.cgi?id=fields.html#cclist) | 15 users (show)  bleanhar ccoleman dmcphers jdetiber jialiu jkeck joelsmith jokerman jrusnack kseifried lmeyer mmccomas mmcgrath security-response-team vdanen | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2014-11-04 05:50:38 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1147767#c0)  Murray McAllister    2014-09-30 03:47:18 UTC  ``` Jenkins Security Advisory SECURITY-144 notes:  Build slave processes can execute arbitrary code on Jenkins master, which makes Jenkins vulnerable from attacks that go through its build slaves.   ```  [Comment 1](show_bug.cgi?id=1147767#c1)  Murray McAllister    2014-10-02 02:44:36 UTC  ``` Acknowledgements:  Red Hat would like to thank the Jenkins project for reporting this issue.   ```  [Comment 6](show_bug.cgi?id=1147767#c6)  Kurt Seifried    2014-10-28 22:55:30 UTC  ``` Accidentally closed this bug, it is not yet fixed by upstream.   ```  [Comment 7](show_bug.cgi?id=1147767#c7)  Murray McAllister    2014-10-31 03:20:38 UTC  ``` This issue is public now:  [https://wiki.jenkins-ci.org/display/SECURITY/Jenkins+Security+Advisory+2014-10-30](https://wiki.jenkins-ci.org/display/SECURITY/Jenkins%2BSecurity%2BAdvisory%2B2014-10-30)   ```  [Comment 8](show_bug.cgi?id=1147767#c8)  Kurt Seifried    2014-11-04 05:50:38 UTC  ``` This issue has been addressed in the following products:    Red Hat OpenShift Enterprise 2.1  Via RHBA-2014:1630 <https://rhn.redhat.com/errata/RHBA-2014-1630.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1147767&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from wiki.jenkins-ci.org_07534fd6_20250124_113429.html ===


1. [Jenkins](index.html)
2. [Home](Home.html)
3. [Use Jenkins](Use-Jenkins.html)
# Jenkins : Slave To Master Access Control

Created by  Unknown User (kohsuke), last modified by  Unknown User (markewaite) on Nov 08, 2018

* [What is this?](#SlaveToMasterAccessControl-Whatisthis?)
* [My Jenkins is broken, help!](#SlaveToMasterAccessControl-MyJenkinsisbroken,help!)
  + [Check if the updates to plugins are available](#SlaveToMasterAccessControl-Checkiftheupdatestopluginsareavailable)
    - [Credentials Plugin](#SlaveToMasterAccessControl-CredentialsPlugin)
    - [SSH Credentials Plugin](#SlaveToMasterAccessControl-SSHCredentialsPlugin)
    - [Git Client Plugin](#SlaveToMasterAccessControl-GitClientPlugin)
  + [Enable the access control mechanism](#SlaveToMasterAccessControl-Enabletheaccesscontrolmechanism)
  + [Disable the access control mechanism altogether](#SlaveToMasterAccessControl-Disabletheaccesscontrolmechanismaltogether)
* [Whitelisting](#SlaveToMasterAccessControl-Whitelisting)
  + [Command whitelisting](#SlaveToMasterAccessControl-Commandwhitelisting)
  + [File access rules](#SlaveToMasterAccessControl-Fileaccessrules)
    - [Path matching](#SlaveToMasterAccessControl-Pathmatching)
  + [Whitelisting from GUI](#SlaveToMasterAccessControl-WhitelistingfromGUI)
* [I'm a plugin developer. What should I do?](#SlaveToMasterAccessControl-I'maplugindeveloper.WhatshouldIdo?)
  + [Vetting SlaveToMasterCallable/SlaveToMasterFileCallable](#SlaveToMasterAccessControl-VettingSlaveToMasterCallable/SlaveToMasterFileCallable)
  + [Fixing plugins without requiring newer Jenkins](#SlaveToMasterAccessControl-FixingpluginswithoutrequiringnewerJenkins)
  + [File access fromÂ agent to master](#SlaveToMasterAccessControl-Fileaccessfromagenttomaster)
  + [I'm not sure how to adapt my plugin, I need help](#SlaveToMasterAccessControl-I'mnotsurehowtoadaptmyplugin,Ineedhelp)

# What is this?

Historically, Jenkins master and agents behaved as if they all together form a single distributed process. This means an agent can ask a master to do just about anything within the confinement of the operating system, such as accessing files on the master or trigger other jobs on Jenkins.

This has increasingly become problematic, as larger enterprise deployments have developed more sophisticated trust separation model, where the administrators of a master might takeÂ agents owned by other teams. In such an environment,Â agents are less trusted than the master.

Starting 1.587 (and 1.580.1), Jenkins added a subsystem to put a wall between a master and anÂ agent to safely allow less trustedÂ agents to be connected to a master. Since Jenkins 2.0, this subsystem is enabled for all new installations of Jenkins. If you fit the "larger enterprise deployment" description above, then we highly recommend you turn this mode on. The following are examples of deployments that fit this profile:

* You tookÂ agents that are managed by another person who is not Jenkins administrator because they have special requirement for their build jobs
* You have some jobs that are configured to run on a specificÂ agent because it is sensitive

To turn this switch on, go to "Manage Jenkins" > "Configure Global Security", and check "Enable Agent â Master Access Control"

On the other hand, if all your agents are trusted to the same degree as your master, then it is safe to leave this subsystem off. The following are examples of deployments that fit this profile:

* You have set up your Jenkins master and all the agents by yourself
* All the users of your Jenkins have the same access to all the jobs

For this subsystem to function, it needs cooperation from plugins. And until plugins get updated to work in this new environment, this may cause seemingly legitimate operations to fail, resulting in broken builds and other failures.

This Wiki page is intended to be the one-stop shop for those who are experiencing problems due to this subsystem.

# My Jenkins is broken, help!

If you see an exception like the following in console output, logs, etc., then you are affected by this access control mechanism:

```
java.lang.SecurityException: agent may not create /var/lib/jenkins/foo/bar/...
See http://jenkins-ci.org/security-144 for more details

java.lang.SecurityException: Sending org.jenkinsci.plugins.gitclient.CliGitAPIImpl$GetPrivateKeys from agent to master is prohibited.
See http://jenkins-ci.org/security-144 for more details

```

The first message indicates that anÂ agent tried to access a file on the master, and Jenkins has blocked that. It is possible that this indicates an active attack, but it is also possible that plugins that haven't yet upgraded to work with SECURITY-144 is doing something legitimate.

The second message indicates that anÂ agent has asked the master to execute a command, and Jenkins has blocked that because the command isn't classified by plugin developers whether it is safe to be executed from the agent.

To resolve this problem, you have the following options:

* [Check if the updates to plugins are available](#SlaveToMasterAccessControl-update-plugins)
* [Disable the access control mechanism altogether](#SlaveToMasterAccessControl-kill-switch)
* [Whitelist the access](#SlaveToMasterAccessControl-whitelist)

## Check if the updates to plugins are available

During the testing of this feature, the following plugins and their versions have been known to interfere with this subsystem. If you are using one of those, upgrading those plugins will resolve the problem. This section will be updated as we discover affected plugins.

### [Credentials Plugin](Credentials-Plugin.html)

This plugin should be upgraded to 1.17. Earlier versions have command implementations that are vulnerable to malicious agents.

### [SSH Credentials Plugin](SSH-Credentials-Plugin.html)

This plugin should be upgraded to 1.10. Earlier versions have command implementations that are vulnerable to malicious agents.

### [Git Client Plugin](Git-Client-Plugin.html)

Versions up to 1.10.2 expose vulnerabilities in credentials plugin and SSH credentials plugin (see above). Upgrading those plugins will fix the problem, but there's also [a separate fix](https://github.com/jenkinsci/git-client-plugin/pull/147) in git-client plugin 1.11.0 itself that addresses this problem.

## Enable the access control mechanism

There are essentially three ways of enabling the access control mechanism:

1. Through web UI, go toÂ http://jenkins/configureSecurityand check "Enable Agent â Master Access Control" option.
2. Through file system, create or edit the fileÂ `$JENKINS_HOME/secrets/slave-to-master-security-kill-switch`Â so that it containsÂ `false`.
3. Using a [Groovy Hook Script](https://wiki.jenkins-ci.org/display/JENKINS/Groovy%2BHook%2BScript) [and doing something like this:](https://wiki.jenkins-ci.org/display/JENKINS/Groovy%2BHook%2BScript)

   ```
   import jenkins.security.s2m.AdminWhitelistRule
   import jenkins.model.Jenkins
   Jenkins.instance.getInjector().getInstance(AdminWhitelistRule.class)
   .setMasterKillSwitch(false)
   ```

## Disable the access control mechanism altogether

If all your agents are trusted to the same degree as your master, then it is safe to disable this subsystem completely. See the top of this page for a discussion of who can safely do this vs who should avoid doing this.

If you convinced yourself that this is the right thing to do, you can go to http://jenkins/configureSecurity and uncheck "Enable Agent â Master Access Control" option. This setting is remembered by `$JENKINS_HOME/secrets/slave-to-master-security-kill-switch`. The file should either contain `true` or `false` as the content (when the *kill-switch* is set to `false`, it means that *Agent â Master Access Control*Â is enabled). If you do not want this be configurable by anÂ administrator, you can make this file read-only for Jenkins.

For instances that have noÂ agents and instances that do not enable security, we do not expose this configuration switch as it is pointless.

Your Jenkins deployment may grow over time and start accepting less trusted agents. It's too easy for that to happen without you remembering this flag. So be careful when you do this. Please revisit this later to see if you should enable this subsystem.

# Whitelisting

Jenkins allows administrators to whitelist specific commands and file accesses on their Jenkins instances. This configuration consists of two pieces.

## Command whitelisting

Commands in Jenkins and its plugins are identified by their fully-qualified class names. Majority of those commands are intended to be executed onÂ agents by a request of a master, but some of them are intended to be executed on a master by a request of an agent. Plugins not yet updated for this subsystem does not classify which category each command falls into. So when an agent requests a master to execute a command and if it is not classified explicitly as intended for agent â master, Jenkins will err on the side of caution and refuses to execute the command.

Until all such plugins are properly updated, administrators can mark specific commands as intended to be executed on a master. We call this "whitelisting".

Administrators can whitelist classes by writing `$JENKINS_HOME/secrets/whitelisted-callables.d/*.conf` and listing command names in separate lines. All such files are read and the result gets combined. Jenkins by itself generates `default.conf` in this directory, which lists known safe commands. This file gets always overwritten by Jenkins every time it starts, but if you do not want to whitelist these classes for some reasons, you can do so by placing a file that's not writable by Jenkins.

Jenkins also manages `gui.conf` in this directory, which is editable through GUI as discussed later. If you do not want to allow Jenkins admins to whitelist anything, create an empty file that's not writable by Jenkins.

Whitelisting has to be done carefully

Whitelisting a command requires not only verifying that the command is intended to be used in this direction, but also that the command implementation is not exploitable by malicious agents. This requires careful analysis of the source code, taking such things into account as all possible serializable fields. As a user, you should just report those commands, and wait for project developers to perform this vetting process. Once we verified that they are safe, you can whitelist them by using this mechanism.

## File access rules

File access request from agents is tested against the rules you specify. Each rule is a tuple that consists of:

* **allow/deny**: if the following two parameters match the current request being considered, an "allow" entry would allow the request to be carried out and a "deny" entry would deny the request to be rejected, regardless of what later rules might say.
* **operation**: the type of the operation requested. The following 6 values exist. You can also list them separating with ',' or use "all" to indicate a match for all operations:
  + read: read file content or list directory entries
  + write: write file content
  + mkdirs: create a new directory
  + create: create a file in an existing directory
  + delete: delete a file or directory
  + stat: read metadata of a file/directory, such as timestamp, length, file access modes.
* **file path**: regular expression that specifies file paths that match this rule. In addition to [the base regexp syntax](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html), it supports the following tokens:
  + `<JENKINS_HOME>` can be used as a prefix to match your $JENKINS\_HOME directory
  + `<BUILDDIR>` can be used as a prefix to match your build record directory, such as `/var/lib/jenkins/job/foo/builds/2014-10-17_12-34-56`
  + `<BUILDID>` matches the timestamp-formatted build IDs, like `2014-10-17_12-34-56`.

The rules are ordered and applied in that order. The earliest match wins. So for example, the following rules allow access to `$JENKINS_HOME` except its `secrets` folders:

```
# To avoid hassle of escaping every '\' on Windows, you can use / everywhere, even on Windows.
deny all <JENKINS_HOME>/secrets/.*
allow all <JENKINS_HOME>/.*

```

The following rules are incorrectly written because the 2nd rule will never match:

```
allow all <JENKINS_HOME>/.*
deny all <JENKINS_HOME>/secrets/.*

```

Rules are read from `$JENKINS_HOME/secrets/filepath-filters.d/*.conf` after sorting these files in alphabetical order.

Jenkins by itself generates `30-default.conf` in this directory, which lists rules that the Jenkins core developers currently think are the best balance between compatibility and security. This file gets overwritten by Jenkins every time it starts, but if you do not want to whitelist these classes for some reasons, you can do so by placing a fileÂ with that name that's not writable by Jenkins.

Jenkins also manages `50-gui.conf` in this directory, which is editable through GUI as discussed later. If you do not want to allow Jenkins admins to whitelist anything, create an empty file that's not writable by Jenkins.

Unlike command whitelisting, file access rule decisions can be made individually based on common sense.

### Path matching

When a file access is checked, the path of a file being considered is absolutized (i.e., can be `/foo/bar/zot` but not `./zot`). It is also normalized to remove all intermediate "." and "..". So a regular expression `/foo/bar/zot.*` will never match `/foo/bar/zot/../../../etc/passwd`, and likewise a regular expression `/foo/bar/../zot/.+` will never match `/foo/zot/bar`.

A path is not always canonicalized. So if you have a symlink in `/var/lib/jenkins/passwd` that points to `/etc/passwd`, and if you allow read access to `/var/lib/jenkins/.*`, then `/etc/passwd` can be read.

The following Groovy script can be used from http://jenkins/script to test the rules:

```
import jenkins.security.admin.*;
import jenkins.security.s2m.AdminWhitelistRule;

String op = "write"; // or any other operation like "read"
File f = new File("/userContent/some-path");
Jenkins.instance.injector.getInstance(AdminWhitelistRule.class).checkFileAccess(op,f)
// true means whitelisted. false or SecurityException means rejected

```

More precisely, `FilePath` always internally normalize paths, and while it allows relative paths, no legitimate code will ever use it, so it shouldn't have to be factored in when writing rules. It isn't that the access checking subsystem does normalization/absolutization.

## Whitelisting from GUI

On Jenkins, you can go to http://jenkins/administrativeMonitor/slaveToMasterAccessControl/ to edit whitelist rules from GUI and have them reflected right away in the running instance. It consists of the following three sections:

* **Currently whitelisted commands**: See [above](#SlaveToMasterAccessControl-command-whitelist) for what this field means.
* **Currently rejected commands**: This section lists unclassified commands that Jenkins has actually rejected. You can check boxes and submit them to have Jenkins write them into the "currently whitelisted commands" section. Be careful when you do this, though. See [the command whitelisting discussion](#SlaveToMasterAccessControl-command-whitelist) above for the implications.
* **File access rules**: See [above](#SlaveToMasterAccessControl-filepath-rules) for what this field means.

When submitted, these changes are written back to disk and then re-read right away into Jenkins, including all `whitelisted-callables.d/*``.conf` and `filepath-filters.d/*``.conf`Â files.

# I'm a plugin developer. What should I do?

For the access control to work without requiring manual intervention by users, plugins need to classify their `Callable` and `FileCallable` objects whether they are meant to be run on a master or on an agent.

For this purpose, the `remoting` library has added the `RoleSensitive` interface with aÂ `checkRoles()` method. `Callable`, `FileCallable`, and other similar interfaces extend from this interface. So if you are directly implementingÂ `Callable` you will get an error saying that you have unimplemented abstract methods.

The easiest way to fix this is by extending from `MasterToSlaveCallable`, to indicate that your `Callable` is only meant to be sent from a master to an agent, or `SlaveToMasterCallable`, to indicate that your `Callable` is meant to be sent from an agent to a master. Note that `SlaveToMasterCallable` can still be executed on an agent, as agents do not perform this access control check. `FileCallable` similarly has `MasterToSlaveFileCallable` and `SlaveToMasterFileCallable`.

## Vetting `SlaveToMasterCallable`/`SlaveToMasterFileCallable`

When marking `Callable` forÂ agent â master, care has to be taken to ensure that the implementation is not exploitable by malicious agents.

* A maliciousÂ agent controls the Java serialization payload, so when your `Callable` gets deserialized on the master, all the serialized fields are controlled by the agent.
* AnÂ agent does not control class definitions on the master, so you can trust all the classes and methods to behave as it is written. It is not possible for a maliciousÂ agent to change the code executed on the master.

For example, the following `SlaveToMasterCallable` is exploitable. Callable itself is not public, but a malicious agent can send in arbitrary `path`, so it can be used to read any file on the master:

```
// UNSAFE
class SomeCodeThatRunsOnAgent {
    void readBackSomeFileFromMaster() {
        final String path = "...";
        channel.call(new SlaveToMasterCallable<String,IOException>() {
            public String call() {
                return FileUtils.readFileToString(new File(path));
            }
        });
    }
}

```

`Callable` that delegates execution to a deserialized object is dangerous and needs to be carefully examined, because a maliciousÂ agent can designate unintended `Runnable` object:

```
// UNSAFE
class MyCallable extends SlaveToMasterCallable<Void> {
    Runnable r;
    public Void call() {
        r.run();
        return null;
    }
}

```

To avoid this hassle entirely, consider rewriting your code not to call back to a master from an agent. Instead, when a master first sends a command to an agent, you can carry all the data you'll need with you. This may not be always possible or practical, but it's a lot easier to secure.

## Fixing plugins without requiring newer Jenkins

Classifying `Callable`/`FileCallable` requires new classes added to Jenkins 1.587/1.580.1. This poses a challenge if you want to retain backward compatibility with earlier versions of Jenkins.

To solve this problem, we've developed [SECURITY-144-compat](https://github.com/jenkinsci/SECURITY-144-compat) module. This module let you classify `Callable`, while still functioning correctly on earlier versions of Jenkins. See the [documentation of `SECURITY-144-compat`](https://github.com/jenkinsci/SECURITY-144-compat/blob/master/README.md) for details.

Note

As of version 1.1, this library is deprecated, as its use caused some unresolved problems ([JENKINS-25625](https://issues.jenkins-ci.org/browse/JENKINS-25625)).
Anyway 1.580.1 is now a fairly conservative choice of baseline: you will not exclude so many users by requiring it for new plugin releases.

## File access fromÂ agent to master

To avoid getting affected by file access rules, have the master work on files of an agent, instead of the other way around.

The following code example shows how the code that used to write a file from an agent now avoids that:

```
// PROBLEMATIC
class MySCM extends SCM {
    ...
    public void checkout( ..., FilePath workspace, File _changelogFile ) {
        FilePath changelogFile = new FilePath(_changelogFile);
        workspace.act(new Callable<Void,IOException>() {
            public Void call() {
                // this results in an agent asking the master to open a file for write
                try (OutputStream os = changelogFile.write()) {
                    writeStuffTo(os);
                }
            }
        });
    }
}

// GOOD
class MySCM extends SCM {
    ...
    public void checkout( ..., FilePath workspace, File _changelogFile ) {
        try (final OutputStream out = new RemoteOutputStream(_changelogFile)) {
            workspace.act(new Callable<Void,IOException>() {
                public Void call() {
                    // agent is just writing to a pipe to the master. Quite safe
                    writeStuffTo(out);
                }
            });
        }
    }
}

```

See `RemoteInputStream`, `RemoteOutputStream`, `RemoteWriter`, and `Pipe` for ways to do this.

## I'm not sure how to adapt my plugin, I need help

If you have questions, please write to jenkinsci-dev@googlegroups.com, or talk to us on [IRC](http://jenkins-ci.org/content/chat).

Document generated by Confluence on Sep 07, 2021 13:08

[Wiki home](/display/)



=== Content from www.cloudbees.com_9f176201_20250124_113431.html ===
[Book a demo](/contact-us)[Book a demo](/contact-us)Products[CloudBees CI](/capabilities/continuous-integration)

Capabilities

[High Availability / Horizontal Scalability](/capabilities/continuous-integration/high-availability-horizontal-scalability)[Workspace Caching](/capabilities/continuous-integration/workspace-caching)[Pipeline Explorer](/capabilities/continuous-integration/pipeline-explorer)[Jenkins in the Enterprise](/jenkins)

Use Cases

[Managing and Scaling Jenkins](/use-case/manage-scale-jenkins)[Support Hybrid Cloud](/use-case/support-hybrid-cloud)[Cloud-Native Platform](/products/saas-platform)

Capabilities

[CI/CD Workflows](/capabilities/ci-cd-workflows)[Feature Management](/capabilities/feature-management)

Use Cases

[Developer Self-Service](/use-case/developer-self-service)[Heterogeneous Orchestration](/use-case/heterogeneous-orchestration)[Pricing](/products/saas-platform/pricing)

Other Products

[CloudBees CD/RO](/products/cloudbees-cdro)[CloudBees Feature Management](/products/cloudbees-feature-management)[CloudBees Security and Compliance](/capabilities/compliance)[Launchable by CloudBees](https://www.launchableinc.com/)Solutions

By Solution

[Scale Your Jenkins](/use-case/manage-scale-jenkins)[Cloudify Your Jenkins](/use-case/support-hybrid-cloud)[Modernize Your DevSecOps](/use-case/automated-devsecops)[AI-Augmented Testing](https://www.launchableinc.com/)

By Industry

[Automotive](/industries/automotive)[Government](/industries/government)[Financial Services](/industries/financial-services)[Insurance](/industries/insurance)[Retail](/industries/retail)[Software](/industries/software)

By Audience

[Executive](/ci-for-executives)Why CloudBees

Why CloudBees

[Press and Recognition](/newsroom)

Compare CloudBees

[vs. Github Actions](/blog/cloudbees-vs-github-actions-choosing-a-ci-cd-platform-for-your-business)[vs. Jenkins Open Source](/blog/cloudbees-ci-enhancing-jenkins-for-business-and-mission-critical)[All Customer Stories](/customer-stories)[Autodesk Builds Better Software Faster with CloudBees](/customers/autodesk)[Salesforce Migrates DevOps to the Cloud with CloudBees CI](/customers/salesforce)[American Express Global Business Travel](/customers/AmexGBT)Resources

Support & Documentation

[Documentation](https://docs.cloudbees.com/)[CloudBees University](/cloudbees-university)[Customer Success & Professional Services](/services)[Security Advisories](/security-advisories)[Support](https://support.cloudbees.com/hc/en-us)[Resources](/resources)[Blogs](/blog)[Webinars & Videos](/videos)[Events](/events)[Whitepapers](/whitepapers)[Trust Center](/company/trust-center)[Book a demo](/contact-us)
# CloudBees Security Advisory 2014-10-30

This advisory announces a security vulnerability/hardening (CVE-2014-3665) in Jenkins core.

Historically, Jenkins master and slaves behaved as if they altogether form a single distributed process. This means a slave can ask a master to do just about anything within the confinement of the operating system, such as accessing files on the master or trigger other jobs on Jenkins. This has increasingly become problematic, as larger enterprise deployments have developed more sophisticated trust separation model, where the administators of a master might take slaves owned by other teams. In such an environment, slaves are less trusted than the master. Yet the "single distributed process" assumption was not communicated well to the users, resulting in vulnerabilities in some deployments. SECURITY-144 (CVE-2014-3665) introduces a new subsystem to address this problem. This feature is off by default for compatibility reasons. See [Wiki](https://wiki.jenkins-ci.org/display/JENKINS/Slave%2BTo%2BMaster%2BAccess%2BControl) for more details, who should turn this on, and implications.

### Severity

CVE-2014-3566 is rated **high** . It only affects installations that accept slaves from less trusted computers, but this will allow an owner of of such slave to mount a remote code execution attack on Jenkins.

### Fix

The following versions are affected, but only if you connect slaves that are managed by less trusted users. Affected users on those versions should upgrade to the following versions:

* All the main line releases < 1.587 should upgrade to 1.587
* All the LTS releases < 1.580.1 should upgrade to 1.580.1
* Jenkins Enterprise by CloudBees releases 1.532.x should upgrade to [1.532.11.1](http://nectar-downloads.cloudbees.com/jenkins-enterprise/1.532/)
* Jenkins Enterprise by CloudBees releases 1.554.x should upgrade to [1.554.11.1](http://nectar-downloads.cloudbees.com/jenkins-enterprise/1.554/)
* Jenkins Enterprise by CloudBees releases 1.565.x should upgrade to [1.565.11.1](http://nectar-downloads.cloudbees.com/jenkins-enterprise/1.565/)
* Jenkins Operations Center by CloudBees releases 1.554.x should upgrade to [1.554.11.1](http://nectar-downloads.cloudbees.com/jenkins-operations-center/1.554/)

DEV@cloud has this fix already rolled out. This should not affect your use, but if you suspect any regressions, please open a support ticket.

[More Security Advisories](/security-advisories)

Continuously redefine what’s possible through software

About CloudBees

* [About Us](/company)
* [Trust Center](/company/trust-center)
* [News](/newsroom)
* [Our Blog](/blog)
* [Join the Hive](/careers/job)
* [Contact us](/contact-us)
New to CloudBees?

* [What is DevOps?](/devops/what-is-devops)
* [What is DevSecOps?](/solutions/devsecops)
* [Customer Stories](/customer-stories)
* [Jenkins and Tekton](/jenkins)
* [Security Advisories](/security-advisories)
Partners

* [Partners Overview](/partners)
* [Technology Partners](/partners/technical-alliance-partner-program)
* [AWS](/partners/platform/aws)
* [Google Cloud](/partners/platform/google-cloud-platform)
* [VMware](/partners/platform/vmware)
© 2025 CloudBees, Inc., CloudBees® and the Infinity logo® are registered trademarks of CloudBees, Inc. in the United States and may be registered in other countries. Other products or brand names may be trademarks or registered trademarks of CloudBees, Inc. or their respective holders. Jenkins® is a registered trademark of LF Charities Inc.[Terms of Service](/company/terms-of-service)
