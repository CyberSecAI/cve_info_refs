=== Content from jvndb.jvn.jp_2124f46f_20250124_223639.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2014/08/19

| [[Japanese]](/ja/contents/2014/JVNDB-2014-000093.html) | |
| --- | --- |
| JVNDB-2014-000093 | |
| Piwigo vulnerable to cross-site scripting | |
| Overview | |
| Piwigo is a software to manage and host image files on the web. Piwigo contains a cross-site scripting vulnerability. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V2 Severity:Base Metrics [2.6](/cvss/en/v2.html#AV:N/AC:H/Au:N/C:N/I:P/A:N) (Low) [IPA Score]**  * Access Vector: Network * Access Complexity: High * Authentication: None * Confidentiality Impact: None * Integrity Impact: Partial * Availability Impact: None | |
| Affected Products | |
|  | |
| Piwigo  * Piwigo 2.6.3 and earlier | |
|  | |
| Impact | |
| An arbitrary script may be executed on the user's web browser. | |
| Solution | |
| [Apply a patch] | |
| Vendor Information | |
| Piwigo  * Piwigo : [0003089: SQL injection on photo edit - Mantis](http://piwigo.org/bugs/view.php?id=3089) * Piwigo : [Changeset 28678 - Piwigo](http://piwigo.org/dev/changeset/28678#file0) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Cross-site Scripting](http://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWE79)(CWE-79) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2014-3900](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3900) | |
| References | |
| 1. JVN : [JVN#09717399](http://jvn.jp/en/jp/JVN09717399/) 2. National Vulnerability Database (NVD) : [CVE-2014-3900](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-3900) | |
| Revision History | |
| * [2014/08/08] | |

| --- | |
| --- | --- |
| Date Public | 2014/08/08 |
| Date First Published | 2014/08/08 |
| Date Last Updated | 2014/08/19 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from piwigo.org_49971f05_20250124_223710.html ===

[![Piwigo logo](https://fr.piwigo.org/plugins/piwigo-piwigodotorg/images/piwigo.org.svg)](http://piwigo.org/dev)

Search:

* [Timeline](/dev/timeline)
* [Browse Source](/dev/browser)
* [Search](/dev/search)

## Context Navigation

* ← [Previous Changeset](/dev/changeset/28677 "Changeset 28677")
* [Next Changeset](/dev/changeset/28679 "Changeset 28679") →

---

# Changeset 28678

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
Jun 12, 2014, 11:33:20 AM
([11 years](/dev/timeline?from=2014-06-12T11%3A33%3A20%2B02%3A00&precision=second "See timeline at Jun 12, 2014, 11:33:20 AM") ago)

Author:
plg
Message:

bug 3089: prevent SQL injection on photo edition

File:

1 edited

* [trunk/admin/picture\_modify.php](/dev/browser/trunk/admin/picture_modify.php?rev=28678 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [trunk/admin/picture\_modify.php](/dev/changeset/28678/trunk/admin/picture_modify.php "Show the changeset 28678 restricted to trunk/admin/picture_modify.php")

  | [r28587](/dev/browser/trunk/admin/picture_modify.php?rev=28587#L156 "Show revision 28587 of this file in browser") | [r28678](/dev/browser/trunk/admin/picture_modify.php?rev=28678#L156 "Show revision 28678 of this file in browser") |  |
  | --- | --- | --- |
  | 156 | 156 | $\_POST['associate'] = array(); |
  | 157 | 157 | } |
  |  | 158 | check\_input\_parameter('associate', $\_POST, true, PATTERN\_ID); |
  | 158 | 159 | move\_images\_to\_categories(array($\_GET['image\_id']), $\_POST['associate']); |
  | 159 | 160 |  |
  | […](/dev/browser/trunk/admin/picture_modify.php?rev=28587#L165) | […](/dev/browser/trunk/admin/picture_modify.php?rev=28678#L166) |  |
  | 165 | 166 | $\_POST['represent'] = array(); |
  | 166 | 167 | } |
  |  | 168 | check\_input\_parameter('represent', $\_POST, true, PATTERN\_ID); |
  | 167 | 169 |  |
  | 168 | 170 | $no\_longer\_thumbnail\_for = array\_diff($represented\_albums, $\_POST['represent']); |

**Note:** See [TracChangeset](/dev/wiki/TracChangeset)
for help on using the changeset viewer.

### Download in other formats:

* [Unified Diff](?format=diff&new=28678)
* [Zip Archive](?format=zip&new=28678)

---

[![Trac Powered](/dev/chrome/common/trac_logo_mini.png)](http://trac.edgewall.org/)

Powered by [**Trac 1.2.3**](/dev/about)

By [Edgewall Software](http://www.edgewall.org/).

Visit the Trac open source project at
<http://trac.edgewall.org/>



=== Content from jvn.jp_874bee4b_20250124_223636.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2014/08/08  Last Updated:2014/08/08
# JVN#09717399 Piwigo vulnerable to cross-site scripting

## Overview

Piwigo contains a cross-site scripting vulnerability.

## Products Affected

* Piwigo 2.6.3 and earlier

## Description

Piwigo is a software to manage and host image files on the web. Piwigo contains a cross-site scripting vulnerability.

## Impact

An arbitrary script may be executed on the user's web browser.

## Solution

**Apply a patch**
Apply the patch according to the information provided by the developer.

According to the developer, this issue was addressed in Changeset 28678, which also addresses a SQL injection vulnerability ([JVN#87962145](https://jvn.jp/en/jp/JVN87962145/index.html))

## Vendor Status

| Vendor | Link |
| --- | --- |
| Piwigo | [0003089: SQL injection on photo edit - Mantis](http://piwigo.org/bugs/view.php?id=3089) |
|  | [Changeset 28678 - Piwigo](http://piwigo.org/dev/changeset/28678#file0) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

**Analyzed on 2014.08.08 (CVSS Base Metrics)**

[What is CVSS?](/en/nav/jvnhelp.html#cvssv2)

| Measures | Severity | | | Description |
| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) | A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access. Such a vulnerability is often termed "remotely exploitable". |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) | The access conditions are somewhat specialized. |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) | Authentication is not required to exploit the vulnerability. |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) | There is no impact to the confidentiality of the system. |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) | Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited. |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) | There is no impact to the availability of the system. |

Base Score:4.3

## Credit

Yuji Tounai of bogus.jp reported this vulnerability to IPA.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2014-3900](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3900) |
| JVN iPedia | [JVNDB-2014-000093](http://jvndb.jvn.jp/ja/contents/2014/JVNDB-2014-000093.html) |

* JVN
* HOME
* What is JVN ?
* Instructions
* List of Vulnerability Report
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* TRnotes
* JVN iPedia
* MyJVN
* JVNJS/RSS
* Vendor List
* List of unreachable developers
* Contact

Copyright (c) 2000-2014 JPCERT/CC and IPA. All rights reserved.


