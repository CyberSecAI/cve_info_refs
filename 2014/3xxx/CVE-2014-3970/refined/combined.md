=== Content from www.mandriva.com_146933b2_20250124_223956.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from bugs.mageia.org_bdce60d8_20250126_041126.html ===


Mageia Bugzilla – Bug 13483
pulseaudio new security issue CVE-2014-3970
Last modified: 2014-11-02 14:15:13 CET

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=13483&GoAheadAndLogIn=1)

  [x]
* |
  [New Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug 13483**](show_bug.cgi?id=13483)
- pulseaudio new security issue CVE-2014-3970

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
pulseaudio new security issue CVE-2014-3970

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sec team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/606884/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | MGA3TOO advisory MGA4-64-OK MGA4-32-O... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | validated\_update | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-06-04 18:01 CEST by David Walser | | --- | --- | | Modified: | 2014-11-02 14:15 CET ([History](show_activity.cgi?id=13483)) | | CC List: | 4 users (show)  mageia mageia ottoleipala1 sysadmin-bugs | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | pulseaudio-5.0-0.20131220.1.mga4.src.rpm | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=13483&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=13483#c0)  David Walser    2014-06-04 18:01:29 CEST  ``` A CVE was allocated for a security issue in PulseAudio today (June 4): <http://openwall.com/lists/oss-security/2014/06/04/16>  Reproducible:   Steps to Reproduce: ```  David Walser    2014-06-04 18:01:35 CEST   Whiteboard: (none) => MGA4TOO, MGA3TOO  [Comment 1](show_bug.cgi?id=13483#c1)  Colin Guthrie    2014-06-04 22:38:13 CEST  ``` Thanks David. I'll patch it as soon as the proposed patch or an alternative is accepted upstream. ```  [Comment 2](show_bug.cgi?id=13483#c2)  David Walser    2014-07-30 20:17:21 CEST  ``` Fedora has issued an advisory for this on July 9: <https://lists.fedoraproject.org/pipermail/package-announce/2014-July/136006.html>  They had to rebuild every package built against the libs for their update. ```  ---   URL: (none) => http://lwn.net/Vulnerabilities/606884/  [Comment 3](show_bug.cgi?id=13483#c3)  Colin Guthrie    2014-07-30 21:12:58 CEST  ``` We certainly won't need a rebuild for this issue. There was an ABI breakage for a while upstream and indeed we had it in cauldron before MGA4 came out, but I think the ABI breakage was only temporary so I it shouldn't have been a problem - perhaps they were just unluckly about whatever snapshot they used? Either way, this should be an easy enough fix. ```  [Comment 4](show_bug.cgi?id=13483#c4)  Sander Lepik    2014-10-04 15:51:58 CEST  ``` Ping.. ```  ---   CC: (none) => mageia  [Comment 5](show_bug.cgi?id=13483#c5)  Sander Lepik    2014-11-01 10:46:54 CET  ``` Ping #2, Colin, wake up :) ```  [Comment 6](show_bug.cgi?id=13483#c6)  Colin Guthrie    2014-11-01 12:16:30 CET  ``` Yeah I suck :)  Builds winging their way to MGA's 3 and 4 shortly. Will upload an advisory shortly. ```  [Comment 7](show_bug.cgi?id=13483#c7)  Colin Guthrie    2014-11-01 15:17:00 CET  ``` OK, advisory uploaded and packages built.   MGA3:  libpulseglib20-3.0-7.1.mga3.i586.rpm libpulsecommon3.0-3.0-7.1.mga3.i586.rpm libpulsecore3.0-3.0-7.1.mga3.i586.rpm pulseaudio-utils-3.0-7.1.mga3.i586.rpm pulseaudio-module-equalizer-3.0-7.1.mga3.i586.rpm libpulseaudio0-3.0-7.1.mga3.i586.rpm pulseaudio-module-x11-3.0-7.1.mga3.i586.rpm pulseaudio-3.0-7.1.mga3.i586.rpm pulseaudio-esound-compat-3.0-7.1.mga3.i586.rpm pulseaudio-module-jack-3.0-7.1.mga3.i586.rpm pulseaudio-module-bluetooth-3.0-7.1.mga3.i586.rpm pulseaudio-module-lirc-3.0-7.1.mga3.i586.rpm pulseaudio-module-xen-3.0-7.1.mga3.i586.rpm libpulseaudio-devel-3.0-7.1.mga3.i586.rpm pulseaudio-module-zeroconf-3.0-7.1.mga3.i586.rpm pulseaudio-module-gconf-3.0-7.1.mga3.i586.rpm pulseaudio-client-config-3.0-7.1.mga3.i586.rpm   pulseaudio-module-bluetooth-3.0-7.1.mga3.x86_64.rpm lib64pulsecore3.0-3.0-7.1.mga3.x86_64.rpm lib64pulsecommon3.0-3.0-7.1.mga3.x86_64.rpm lib64pulseaudio-devel-3.0-7.1.mga3.x86_64.rpm pulseaudio-3.0-7.1.mga3.x86_64.rpm pulseaudio-esound-compat-3.0-7.1.mga3.x86_64.rpm lib64pulseaudio0-3.0-7.1.mga3.x86_64.rpm pulseaudio-client-config-3.0-7.1.mga3.x86_64.rpm pulseaudio-module-x11-3.0-7.1.mga3.x86_64.rpm pulseaudio-module-gconf-3.0-7.1.mga3.x86_64.rpm pulseaudio-module-zeroconf-3.0-7.1.mga3.x86_64.rpm pulseaudio-utils-3.0-7.1.mga3.x86_64.rpm lib64pulseglib20-3.0-7.1.mga3.x86_64.rpm pulseaudio-module-lirc-3.0-7.1.mga3.x86_64.rpm pulseaudio-module-equalizer-3.0-7.1.mga3.x86_64.rpm pulseaudio-module-xen-3.0-7.1.mga3.x86_64.rpm pulseaudio-module-jack-3.0-7.1.mga3.x86_64.rpm    MGA 4  pulseaudio-module-gconf-5.0-1.mga4.i586.rpm libpulseaudio0-5.0-1.mga4.i586.rpm pulseaudio-module-zeroconf-5.0-1.mga4.i586.rpm pulseaudio-module-x11-5.0-1.mga4.i586.rpm libpulseaudio-devel-5.0-1.mga4.i586.rpm pulseaudio-module-bluetooth-5.0-1.mga4.i586.rpm pulseaudio-module-xen-5.0-1.mga4.i586.rpm pulseaudio-utils-5.0-1.mga4.i586.rpm pulseaudio-client-config-5.0-1.mga4.i586.rpm pulseaudio-module-jack-5.0-1.mga4.i586.rpm libpulsecommon5.0-5.0-1.mga4.i586.rpm pulseaudio-esound-compat-5.0-1.mga4.i586.rpm pulseaudio-5.0-1.mga4.i586.rpm pulseaudio-module-lirc-5.0-1.mga4.i586.rpm libpulsecore5.0-5.0-1.mga4.i586.rpm libpulseglib20-5.0-1.mga4.i586.rpm pulseaudio-module-equalizer-5.0-1.mga4.i586.rpm   pulseaudio-module-x11-5.0-1.mga4.x86_64.rpm lib64pulsecore5.0-5.0-1.mga4.x86_64.rpm pulseaudio-module-bluetooth-5.0-1.mga4.x86_64.rpm pulseaudio-module-gconf-5.0-1.mga4.x86_64.rpm pulseaudio-module-zeroconf-5.0-1.mga4.x86_64.rpm lib64pulseglib20-5.0-1.mga4.x86_64.rpm pulseaudio-module-lirc-5.0-1.mga4.x86_64.rpm lib64pulsecommon5.0-5.0-1.mga4.x86_64.rpm pulseaudio-esound-compat-5.0-1.mga4.x86_64.rpm lib64pulseaudio0-5.0-1.mga4.x86_64.rpm pulseaudio-client-config-5.0-1.mga4.x86_64.rpm pulseaudio-5.0-1.mga4.x86_64.rpm lib64pulseaudio-devel-5.0-1.mga4.x86_64.rpm pulseaudio-utils-5.0-1.mga4.x86_64.rpm pulseaudio-module-xen-5.0-1.mga4.x86_64.rpm pulseaudio-module-jack-5.0-1.mga4.x86_64.rpm pulseaudio-module-equalizer-5.0-1.mga4.x86_64.rpm ```  ---   Assignee: mageia => qa-bugsWhiteboard: MGA4TOO, MGA3TOO => MGA4TOO, MGA3TOO, has\_advisory  [Comment 8](show_bug.cgi?id=13483#c8)  Colin Guthrie    2014-11-01 15:17:57 CET  ``` FWIW, For testing, I'd just make sure the package works. The bug is not easily explioitable and was not enabled by default. Provided it works for normal sound output, I'd be happy enough to just push it :) ```  ---   CC: (none) => mageia  David Walser    2014-11-01 17:15:03 CET   Version: Cauldron => 4Whiteboard: MGA4TOO, MGA3TOO, has\_advisory => MGA3TOO advisory  [Comment 9](show_bug.cgi?id=13483#c9)  Otto Leipälä    2014-11-01 17:27:45 CET  ``` Little delay packaging this i was thinking i am slow but no :) i start to testing it. ```  ---   CC: (none) => ozkyster  [Comment 10](show_bug.cgi?id=13483#c10)  Otto Leipälä    2014-11-01 18:35:58 CET  ``` Testing finished both releases and both arch as usual,i validate it so it will get pushed. Sysadmins push this to updates. ```  ---   Keywords: (none) => validated\_updateCC: (none) => sysadmin-bugsWhiteboard: MGA3TOO advisory => MGA3TOO advisory MGA4-64-OK MGA4-32-OK MGA3-64-OK MGA3-32-OK  [Comment 11](show_bug.cgi?id=13483#c11)  Mageia Robot    2014-11-02 14:15:13 CET  ``` An update for this issue has been pushed to Mageia Updates repository.  <http://advisories.mageia.org/MGASA-2014-0440.html> ```  ---   Status: NEW => RESOLVEDResolution: (none) => FIXED |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=13483&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=13483)
* - [XML](show_bug.cgi?ctype=xml&id=13483)
* - [Clone ThisBug](enter_bug.cgi?cloned_bug_id=13483&normal=1)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=13483&GoAheadAndLogIn=1)

    [x]
  + |
    [New Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)



=== Content from lists.freedesktop.org_224414e3_20250124_223952.html ===

# [pulseaudio-discuss] Remotely triggerable crash in module-rtp-recv

**Alexander E. Patrakov**
patrakov at gmail.com

*Sat May 31 10:03:25 PDT 2014*

* Previous message: [[pulseaudio-discuss] [alsa-devel] Bug report: [alsa-sink-USB Audio] alsa-sink.c: Most likely this is a bug in the ALSA driver '(null)'. Please report this issue to the ALSA](020750.html)
* Next message: [[pulseaudio-discuss] [PATCH] module-rtp-recv: fix crash on empty UDP packets](020741.html)
* **Messages sorted by:**
  [[ date ]](date.html#20740)
  [[ thread ]](thread.html#20740)
  [[ subject ]](subject.html#20740)
  [[ author ]](author.html#20740)

---

```
Hello.

While looking at module-rtp-recv source, I found some suspicious use of
the FIONREAD ioctl (see below). I was going to test this bug, expecting
to find an infinite loop (as it would be common for such FIONREAD
misuse), but found an assertion failure instead. So there may be two bugs.

Assume that you have this kind of network:

  * A system with PulseAudio 5.0 and speakers, with the IP address
169.254.7.181.
  * A system with PulseAudio 5.0 and microphone, with IP address
169.254.10.194.
  * Avahi running on both systems, not sure if this is relevant.

On the system with the microphone: pacmd load-module module-rtp-send
On the system with speakers: pacmd load-module module-rtp-recv

As a result, some multicast packets will flow from the system with
microphone to the system with speakers.

And now an attacker can crash PulseAudio on the system with speakers
from the third host. All he needs to do is to figure out the correct
source and destination ports (trivially done with tcpdump, let's suppose
they are 59405 and 46402), and then to send an empty UDP packet to the
multicast address:

# nping --udp --dest-port 46402 --source-port 59405 --data-string ''
--privileged --send-ip --source-ip 169.254.10.194 224.0.0.56

Result:

E: [alsa-sink-ALC275 Analog] memblock.c: Assertion 'b' failed at
.../pulseaudio-5.0/src/pulsecore/memblock.c:596, function
pa_memblock_unref(). Aborting.

And here is what I expected and why.

Please see src/modules/rtp/rtp.c, function pa_rtp_recv.

The first thing it does with the socket is to call the FIONREAD ioctl in
order to see the size of the next incoming datagram (presumably after
getting the rtpoll notification that there is, in fact, something to
read). Then it looks whether there was an error. Then it compares: size
<= 0. And if size is indeed <= 0, it just returns, without doing
anything more with the socket or the memblock. Not even the same cleanup
as after the "fail:" label (but I am not sure what cleanup is needed at
this point).

And comparison of the FIONREAD output with 0 is a very dangerous thing
on UDP sockets, because it could mean two completely different things.

1. There is in fact nothing to read - e.g. there was a badly-checksummed
packet.

2. There is in fact a packet to read! A well-formed zero-sized packet.
You have to receive it for the poll/epoll to stop bothering you about it
again and again.

PulseAudio does not attempt to distinguish between these two cases, and
does not attempt to receive the resulting packet. See CVE-2011-1002 for
a similar bug in Avahi.

<http://xorl.wordpress.com/2011/02/20/cve-2011-1002-avahi-daemon-remote-denial-of-service/>

--
Alexander E. Patrakov

```

---

* Previous message: [[pulseaudio-discuss] [alsa-devel] Bug report: [alsa-sink-USB Audio] alsa-sink.c: Most likely this is a bug in the ALSA driver '(null)'. Please report this issue to the ALSA](020750.html)
* Next message: [[pulseaudio-discuss] [PATCH] module-rtp-recv: fix crash on empty UDP packets](020741.html)
* **Messages sorted by:**
  [[ date ]](date.html#20740)
  [[ thread ]](thread.html#20740)
  [[ subject ]](subject.html#20740)
  [[ author ]](author.html#20740)

---

[More information about the pulseaudio-discuss
mailing list](http://lists.freedesktop.org/mailman/listinfo/pulseaudio-discuss)



=== Content from advisories.mageia.org_49572f43_20250124_223951.html ===

# [Advisories](index.html) » MGASA-2014-0440

## Updated pulseaudio package fixes RTP remote crash vulnerability

Publication date: 02 Nov 2014

Modification date: 02 Nov 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-3970](CVE-2014-3970.html)

## Description

```
PulseAudio versions shipped in Mageia 3 and 4 were vulnerable to a
remote RTP attack which could crash the PulseAudio server simply by
sending an empty UDP packet.

Additionally, the version of PulseAudio shipped in Mageia 4 was a
pre-release version of PulseAudio v5 and has been updated to the
official final version.

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=13483>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3970>

## SRPMS

### 4/core

* pulseaudio-5.0-1.mga4

### 3/core

* pulseaudio-3.0-7.1.mga3



=== Content from seclists.org_87dd6557_20250124_223953.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](428)
[By Date](date.html#429)
[![Next](/images/right-icon-16x16.png)](430)

[![Previous](/images/left-icon-16x16.png)](423)
[By Thread](index.html#429)
[![Next](/images/right-icon-16x16.png)](437)

![](/shared/images/nst-icons.svg#search)

# CVE request: PulseAudio crash due to empty UDP packet

---

*From*: "Alexander E. Patrakov" <patrakov () gmail com>

*Date*: Wed, 04 Jun 2014 14:40:02 +0600

---

```

Hello.

```
If one has module-rtp-recv loaded into PulseAudio, then a remote
attacker can crash this instance of PulseAudio by sending an empty UDP
packet to the multicast address where module-rtp-recv has decided to
receive the stream due to a previous SAP/SDP announcement.
```

When PulseAudio crashes, it says to the log:

```
E: [alsa-sink-ALC275 Analog] memblock.c: Assertion 'b' failed at
.../pulseaudio-5.0/src/pulsecore/memblock.c:596, function
pa\_memblock\_unref(). Aborting.
```

```
So this doesn't look exploitable - just a DoS attack, and PulseAudio
usually gets respawned anyway.
```

The problem has been reported upstream, but got no response yet:

<http://lists.freedesktop.org/archives/pulseaudio-discuss/2014-May/020740.html>

```
The problematic code is in the pa\_rtp\_recv() function, in the handling
of the result of the FIONREAD ioctl. It existed since the introduction
of the module, i.e. since 2006-04-16 (git commit f1ddf0523), which is
before version 1.0.
```

```
The problem I found is that the function just returns immediately,
without even attempting to read the zero-sized packet. I don't know how
this later leads to the failed assertion.
```

<http://cgit.freedesktop.org/pulseaudio/pulseaudio/tree/src/modules/rtp/rtp.c#n185>

```
A patch has been sent, but not reviewed and thus not accepted, and thus
the problem still exists in git master:
```

<http://lists.freedesktop.org/archives/pulseaudio-discuss/2014-May/020741.html>

```
I have also tested SAP/SDP handling for the same type of vulnerability,
but PulseAudio survived an empty UDP packet there just fine.
```

--
Alexander E. Patrakov

```

---

[![Previous](/images/left-icon-16x16.png)](428)
[By Date](date.html#429)
[![Next](/images/right-icon-16x16.png)](430)

[![Previous](/images/left-icon-16x16.png)](423)
[By Thread](index.html#429)
[![Next](/images/right-icon-16x16.png)](437)

### Current thread:

* **CVE request: PulseAudio crash due to empty UDP packet** *Alexander E. Patrakov (Jun 04)*
  + [Re: CVE request: PulseAudio crash due to empty UDP packet](437) *cve-assign (Jun 04)*
    - [Re: CVE request: PulseAudio crash due to empty UDP packet](438) *Alexander E. Patrakov (Jun 04)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_df188dc3_20250124_223954.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](436)
[By Date](date.html#437)
[![Next](/images/right-icon-16x16.png)](438)

[![Previous](/images/left-icon-16x16.png)](429)
[By Thread](index.html#437)
[![Next](/images/right-icon-16x16.png)](438)

![](/shared/images/nst-icons.svg#search)

# Re: CVE request: PulseAudio crash due to empty UDP packet

---

*From*: cve-assign () mitre org

*Date*: Wed, 4 Jun 2014 11:30:43 -0400 (EDT)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> If one has module-rtp-recv loaded into PulseAudio, then a remote
> attacker can crash this instance of PulseAudio by sending an empty UDP
> packet
>
> ```

```

```
> ```
> memblock.c: Assertion 'b' failed
>
> ```

```

Use CVE-2014-3970.

```
> ```
> PulseAudio usually gets respawned anyway.
>
> ```

```

Apparently there are realistic circumstances in which respawning
doesn't happen (possibly a zero value of conf->daemonize or the
"User-configured server at %s, refusing to start/autospawn." case in
<http://cgit.freedesktop.org/pulseaudio/pulseaudio/tree/src/daemon/main.c>).

```
> ```
> <http://lists.freedesktop.org/archives/pulseaudio-discuss/2014-May/020740.html>
>
> ```

```

```
> ```
> expecting to find an infinite loop (as it would be common for such
> FIONREAD misuse), but found an assertion failure instead. So there may
> be two bugs.
>
> ```

```

The scope of CVE-2014-3970 does not include any infinite loop that
might be discovered later.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJTjztGAAoJEKllVAevmvmspWYIAMDODhaMo0EfkzPHhhmadz1H
B1wYGv+h7cvW3/acKVpvdE+oIcHS9I2rbzSuPlgAtAghAc+HNQFS4/QSNtvFfBo9
9AgbvUgsCYiF5uNcylnmK80P5f4QpxZ+n7lBqu75uveZV3EsitqKiS5W3qQ3Ef3i
GaIAYwpvtXLPq/GSdEv/UznmnOVqaTK4hwvqfyePgSfIEMdcED0GgeDGo8D/NLEL
XSYfDJbVgi5ry8YQcS4Q5nJtpTfBQS6knlcKPMqYB7KtvUesOECLC9hrv9jYYJga
XORzNGRP9tWJspn05rc9NlmAegurGeOUStaE/2q3PDA53gEWKhH4JwhzISfMmOQ=
=3Sw2
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](436)
[By Date](date.html#437)
[![Next](/images/right-icon-16x16.png)](438)

[![Previous](/images/left-icon-16x16.png)](429)
[By Thread](index.html#437)
[![Next](/images/right-icon-16x16.png)](438)

### Current thread:

* [CVE request: PulseAudio crash due to empty UDP packet](429) *Alexander E. Patrakov (Jun 04)*
  + **Re: CVE request: PulseAudio crash due to empty UDP packet** *cve-assign (Jun 04)*
    - [Re: CVE request: PulseAudio crash due to empty UDP packet](438) *Alexander E. Patrakov (Jun 04)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


