=== Content from secunia.com_9f88b4ec_20250124_130226.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner¬Æ

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera‚Äôs 2025 IT Priorities Report highlight what‚Äôs top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world‚Äôs best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world‚Äôs best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft‚Äôs Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren‚Äôt normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow¬Æ investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

¬© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

√ó

...



=== Content from www.openwall.com_e530aef7_20250124_130228.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <54185FAF.6010601@collabora.co.uk>
Date: Tue, 16 Sep 2014 17:05:03 +0100
From: Simon McVittie <simon.mcvittie@...labora.co.uk>
To: oss-security@...ts.openwall.com
Subject: CVE-2014-3635 to 3639: security issues in D-Bus < 1.8.8

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

D-Bus <<http://www.freedesktop.org/wiki/Software/dbus/>> is an
asynchronous inter-process communication system, commonly used
for system services or within a desktop session on Linux and other
operating systems.

Alban Crequy and Simon McVittie at Collabora Ltd. discovered and fixed
several security flaws in the reference implementation of
dbus-daemon, the D-Bus message bus daemon. fd.o #83622 is a heap
overflow and could potentially be exploited to alter data or executable
code; the rest are denial-of-service issues.

For the stable branch these are fixed in dbus 1.8.8.

For the old stable branch, these are fixed in dbus 1.6.24. Older
branches are not supported.

CVE-2014-3635 (fd.o #83622)
- ---------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=83622>
Category: CWE-805: Buffer Access with Incorrect Length Value
Impact: heap data corruption, worst-case: arbitrary code execution
Access required: local
Mitigation: 32-bit platforms are not vulnerable
Versions believed to be vulnerable: dbus >= 1.3.0
Credit: discovered and fixed by Simon McVittie

When using the default Unix-socket-based transport, dbus-daemon accepts
and forwards file descriptors (fds) attached to D-Bus messages
("fd-passing"). If the max_message_unix_fds limit is set to an odd
number on 64-bit platforms, a malicious message-sender could pass one
more fd through the kernel than the recipient is expecting. This causes
an assertion failure and dbus-daemon crash if assertions are enabled, or
a buffer overrun by sizeof (int) otherwise.

This has been resolved by passing the desired maximum size to the
syscall instead of the rounded-up size of the cmsg buffer, and
discarding any excess fds if the syscall fills the cmsg buffer anyway.

CVE-2014-3636 (fd.o#82820, parts A and B)
- -----------------------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=82820>
Category: CWE-774: Allocation of File Descriptors or Handles
Without Limits or Throttling
Impact: denial of service
Access required: local
Versions believed to be vulnerable: dbus >= 1.3.0
Credit: discovered and fixed by Alban Crequy

The default limits for the system bus allowed each uid to open 256
connections to the system bus, and allowed up to 1024 fds per message,
and up to 4096 fds queued in total on each connection.

(Part A) By queuing up the maximum allowed number of fds, a malicious
sender could reach the dbus-daemon's RLIMIT_NOFILE (ulimit -n, typically
65536 on Linux). This would act as a denial of service in two ways:

* new clients would be unable to connect to the dbus-daemon
* when receiving a subsequent message from a non-malicious client that
  contained a fd, dbus-daemon would receive the MSG_CTRUNC flag,
  indicating that the list of fds was truncated; kernel fd-passing APIs
  do not provide any way to recover from that, so dbus-daemon responds
  to MSG_CTRUNC by disconnecting the sender, causing denial of service
  to that sender

(Part B) Additionally, Linux allows up to 253 fds to be sent in a single
sendmsg() call; libdbus always sends all of a message's fds, and the
beginning of the message itself, in a single sendmsg() call. Combining
these two, a malicious sender could split a message across two or more
sendmsg() calls to construct a composite message with 254 or more fds.
When dbus-daemon attempted to relay that message to its
recipient in a single sendmsg() call, it would receive EINVAL,
interpret that as a fatal socket error and disconnect the recipient,
resulting in denial of service.

Both of these related issues have been resolved by changing the defaults
so up to 16 fds are allowed per message, and up to 64 on each
connection. This means that each uid can only queue up to 16384 fds, and
denial of service is only possible if several uids cooperate.

Since this limit might be changed further in future, the D-Bus
maintainers recommend that designers of D-Bus APIs, particularly on the
system bus, do not rely on being able to send more than one fd per
message.

Distributors on operating systems with a smaller default RLIMIT_NOFILE
should consider adjusting either that limit, or the defaults in
system.conf.

CVE-2014-3637 (fd.o#80559)
- --------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80559>
Category: CWE-775: Missing Release of File Descriptor or Handle after
Effective Lifetime
Impact: denial of service
Access required: local
Versions believed to be vulnerable: dbus >= 1.3.0
Credit: discovered and fixed by Alban Crequy

By attaching the file descriptor of a D-Bus connection to a D-Bus
message and sending that message via the dbus-daemon, a malicious
process can create D-Bus connections that persist after the process that
created them has terminated. This exacerbates various patterns of
undesirable/abusive behaviour by making it impossible to terminate them
by killing processes.

This has been addressed by closing any connection that has incoming file
descriptors queued for deserialization for more than a configurable
timeout, defaulting to 2.5 minutes.

CVE-2014-3638 (fd.o#81053)
- --------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=81053>
Category: CWE-407: Algorithmic Complexity
Impact: denial of service
Access required: local
Versions believed to be vulnerable: all dbus releases
Credit: discovered and fixed by Alban Crequy

dbus-daemon tracks whether method call messages expect a reply, so that
unsolicited replies can be dropped. As currently implemented, if there
are n parallel method calls in progress, each method reply takes O(n)
CPU time. A malicious user can exploit this by opening the maximum
allowed number of parallel connections and sending the maximum number of
parallel method calls on each one, causing subsequent method calls to be
unreasonably slow, a denial of service.

For the short term, this has been resolved by amending the default
system bus configuration to reduce the number of parallel method calls
allowed per connection, from 8192 to 128 (i.e. from 2097152 to 32768 per
uid).

Longer-term, we plan to use better data structures to make dbus-daemon
more scalable, but this was not felt to be suitable for a minimal
security patch.

CVE-2014-3639 (fd.o#80919)
- --------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80919>
Category: CWE-774: Allocation of File Descriptors or Handles Without
Limits or Throttling
Impact: denial of service
Access required: local
Versions believed to be vulnerable: all dbus releases
Credit: discovered and fixed by Alban Crequy

dbus-daemon allows a small number of "incomplete" connections (64 by
default) whose identity has not yet been confirmed. When this limit has
been reached, subsequent connections are dropped. Alban's testing
indicates that one malicious process that makes repeated connection
attempts, but never completes the authentication handshake and instead
waits for dbus-daemon to time out and disconnect it, can cause the
majority of legitimate connection attempts to fail.

This has been resolved by reducing the default authentication timeout
from 30 seconds to 5 seconds, and pausing calls to accept() when the
maximum number of incomplete connections is reached, resulting in
subsequent connections being queued in the kernel (blocking in
connect()) instead of being dropped.

- --
Simon McVittie, Collabora Ltd.
on behalf of the D-Bus maintainers

-----BEGIN PGP SIGNATURE-----

iQIVAwUBVBhfoE3o/ypjx8yQAQiqjw//T5IZyg8ZTzJZWybeZfaSCkLymcYf+7rf
uCavmRs507UtDhqRkd0cuFuM0GdEZVRQsFp4jiDOyZTPLr6SWmZJuBisHBzlFsTd
1zwX72mZL5rYEvkIgnq22Jhs0RHg50Ok+tL8Ld8Lcdhm2SR4SnCubGoV+pwmid5+
1rjBZc3/YVJ38vMPJDddYKfMidIdprnbpkGtq2jP+IVZFBab2VcHY5I6oB9OzKF/
EyT4a760TJOug5aAT5Yog++lvZ+UoRf7QOLlsvgARi8HHY7rWXikbs1/Eh3I2O//
3YadlgrsgibnmnCNYMCSKaR806FaUPD9AYe0G6u8AAcOKvMBg531RSMlENkmPOW5
WklMyCyfIFMJeOFdc6Vc6G3fAaSc9KX3pbJPVb7cfnuzHWhRnye3quHo1pEWP6EL
liFBDAtRg51EaD6bMgAEvsFkUSPEltMX2i0piQ7Uh6vTXTJvndq2APlW1w8hHKKn
MoJ/z1IEwCdYD34H48ddvJZptvZgbEGnTXxhQcs23kKvWt8vYnnidKbvWxctchmC
EvPv+6Clpnyp5cSkK0UJPxV1Bcc3rzsNK+JX5HMbSadoxwOBYj2efEdedqJ0ZapZ
430xawijqcFp9jB+tEztGyK/gnHclIUKeFyawCh2DQqGsoD9tSaHYeFz3C8SxssV
hnPsLAl1KbI=
=U6YK
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from advisories.mageia.org_73bc190f_20250124_130225.html ===

# [Advisories](index.html) ¬ª MGASA-2014-0395

## Updated dbus packages fix multiple security vulnerabilities

Publication date: 07 Oct 2014

Modification date: 07 Oct 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-3635](CVE-2014-3635.html)
,
[CVE-2014-3636](CVE-2014-3636.html)
,
[CVE-2014-3637](CVE-2014-3637.html)
,
[CVE-2014-3638](CVE-2014-3638.html)
,
[CVE-2014-3639](CVE-2014-3639.html)

## Description

```
Updated dbus packages fixes the following security issues:

Alban Crequy and Simon McVittie discovered several vulnerabilities in the
D-Bus message daemon:

On 64-bit platforms, file descriptor passing could be abused by local users
to cause heap corruption in dbus-daemon, leading to a crash, or potentially
to arbitrary code execution (CVE-2014-3635).

A denial-of-service vulnerability in dbus-daemon allowed local attackers to
prevent new connections to dbus-daemon, or disconnect existing clients, by
exhausting descriptor limits (CVE-2014-3636).

Malicious local users could create D-Bus connections to dbus-daemon which
could not be terminated by killing the participating processes, resulting
in a denial-of-service vulnerability (CVE-2014-3637).

dbus-daemon suffered from a denial-of-service vulnerability in the code
which tracks which messages expect a reply, allowing local attackers to
reduce the performance of dbus-daemon (CVE-2014-3638).

dbus-daemon did not properly reject malicious connections from local users,
resulting in a denial-of-service vulnerability (CVE-2014-3639).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=14102>
* <http://openwall.com/lists/oss-security/2014/09/16/9>
* <https://www.debian.org/security/2014/dsa-3026>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3635>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3636>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3637>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3638>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3639>

## SRPMS

### 3/core

* dbus-1.6.8-4.5.mga3

### 4/core

* dbus-1.6.18-1.4.mga4



=== Content from lists.opensuse.org_407bde4d_20250124_130225.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

√ó
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

# openSUSE-SU-2014:1239-1: moderate: dbus-1: update to 1.6.24

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-securityÔº†opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-securityÔº†opensuse.org")

28 Sep
2014

28 Sep
'14

10:09

openSUSE Security Update: dbus-1: update to 1.6.24
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:1239-1
Rating: moderate
References: #896453
Cross-References: CVE-2014-3635 CVE-2014-3636 CVE-2014-3637
CVE-2014-3638 CVE-2014-3639
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 5 vulnerabilities is now available.
Description:
The DBUS-1 service and libraries were updated to upstream release 1.6.24
fixing security issues and bugs.
Upstream changes since dbus 1.6.8
+ Security fixes
- Do not accept an extra fd in the padding of a cmsg message, which
could lead to a 4-byte heap buffer overrun. (CVE-2014-3635,
fdo#83622; Simon McVittie)
- Reduce default for maximum Unix file descriptors passed per message
from 1024 to 16, preventing a uid with the default maximum number of
connections from exhausting the system bus' file descriptors under
Linux's default rlimit. Distributors or system administrators with a
more restrictive fd limit may wish to reduce these limits further.
Additionally, on Linux this prevents a second denial of service in
which the dbus-daemon can be made to exceed the maximum number of
fds per sendmsg() and disconnect the process that would have
received them. (CVE-2014-3636, fdo#82820; Alban Crequy)
- Disconnect connections that still have a fd pending unmarshalling
after a new configurable limit, pending\_fd\_timeout (defaulting to
150 seconds), removing the possibility of creating an abusive
connection that cannot be disconnected by setting up a circular
reference to a connection's file descriptor. (CVE-2014-3637,
fdo#80559; Alban Crequy)
- Reduce default for maximum pending replies per connection from 8192
to 128, mitigating an algorithmic complexity denial-of-service
attack (CVE-2014-3638, fdo#81053; Alban Crequy)
- Reduce default for authentication timeout on the system bus from 30
seconds to 5 seconds, avoiding denial of service by using up all
unauthenticated connection slots; and when all unauthenticated
connection slots are used up, make new connection attempts block
instead of disconnecting them. (CVE-2014-3639, fdo#80919; Alban
Crequy)
- On Linux >= 2.6.37-rc4, if sendmsg() fails with ETOOMANYREFS,
silently drop the message. This prevents an attack in which a
malicious client can make dbus-daemon disconnect a system service,
which is a local denial of service. (fdo#80163, CVE-2014-3532; Alban
Crequy)
- Track remaining Unix file descriptors correctly when more than one
message in quick succession contains fds. This prevents another
attack which a malicious client can make dbus-daemon disconnect a
system service. (fdo#79694, fdo#80469, CVE-2014-3533; Alejandro
Mart√≠nez Su√°rez, Simon McVittie, Alban Crequy)
- Alban Crequy at Collabora Ltd. discovered and fixed a
denial-of-service flaw in dbus-daemon, part of the reference
implementation of D-Bus. Additionally, in highly unusual
environments the same flaw could lead to a side channel between
processes that should not be able to communicate. (CVE-2014-3477,
fdo#78979)
- CVE-2013-2168: Fix misuse of va\_list that could be used as a denial
of service for system services. Vulnerability reported by Alexandru
Cornea. (Simon)
+ Other fixes
- Don't leak memory on out-of-memory while listing activatable or
active services (fdo#71526, Radoslaw Pajak)
- fix undefined behaviour in a regression test (fdo#69924, DreamNik)
- path\_namespace='/' in match rules incorrectly matched nothing; it
now matches everything. (fdo#70799, Simon McVittie)
- Make dbus\_connection\_set\_route\_peer\_messages(x, FALSE) behave as
documented. Previously, it assumed its second parameter was TRUE.
(fdo#69165, Chengwei Yang)
- Fix a NULL pointer dereference on an unlikely error path (fdo#69327,
Sviatoslav Chagaev)
- If accept4() fails with EINVAL, as it can on older Linux kernels
with newer glibc, try accept() instead of going into a busy-loop.
(fdo#69026, Chengwei Yang)
- If socket() or socketpair() fails with EINVAL or EPROTOTYPE, for
instance on Hurd or older Linux with a new glibc, try without
SOCK\_CLOEXEC. (fdo#69073; Pino Toscano, Chengwei Yang)
- Fix a file descriptor leak on an error code path. (fdo#69182,
Sviatoslav Chagaev)
- Fix compilation if writev() is unavailable (fdo#69409, Vasiliy
Balyasnyy)
- Avoid an infinite busy-loop if a signal interrupts waitpid()
(fdo#68945, Simon McVittie)
- Escape addresses containing non-ASCII characters correctly
(fdo#53499, Chengwei Yang)
- If malloc() returns NULL in \_dbus\_string\_init() or similar, don't
free an invalid pointer if the string is later freed (fdo#65959,
Chengwei Yang)
- If malloc() returns NULL in dbus\_set\_error(), don't va\_end() a
va\_list that was never va\_start()ed (fdo#66300, Chengwei Yang)
- Fix a regression test on platforms with strict alignment (fdo#67279,
Colin Walters)
- Avoid calling function parameters "interface" since certain Windows
headers have a namespace-polluting macro of that name (fdo#66493,
Ivan Romanov)
- Make "make -j check" work (fdo#68852, Simon McVittie)
- In dbus-daemon, don't crash if a .service file starts with key=value
(fdo#60853, Chengwei Yang)
- Fix an assertion failure if we try to activate systemd services
before systemd connects to the bus (fdo#50199, Chengwei Yang)
- Avoid compiler warnings for ignoring the return from write()
(Chengwei Yang)
- Following Unicode Corrigendum #9, the noncharacters U+nFFFE,
U+nFFFF, U+FDD0..U+FDEF are allowed in UTF-8 strings again.
(fdo#63072, Simon McVittie)
- Diagnose incorrect use of dbus\_connection\_get\_data() with negative
slot (i.e. before allocating the slot) rather than returning junk
(fdo#63127, Dan Williams)
- In the activation helper, when compiled for tests, do not reset the
system bus address, fixing the regression tests. (fdo#52202, Simon)
- Fix building with Valgrind 3.8, at the cost of causing harmless
warnings with Valgrind 3.6 on some compilers (fdo#55932, Arun
Raghavan)
- Don't leak temporary fds pointing to /dev/null (fdo#56927, Michel
HERMIER)
- Create session.d, system.d directories under CMake (fdo#41319, Ralf
Habacker)
- Include alloca.h for alloca() if available, fixing compilation on
Solaris 10 (fdo#63071, Dagobert Michelsen)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2014-557
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
dbus-1-1.6.24-2.26.1
dbus-1-debuginfo-1.6.24-2.26.1
dbus-1-debugsource-1.6.24-2.26.1
dbus-1-devel-1.6.24-2.26.1
dbus-1-x11-1.6.24-2.26.1
dbus-1-x11-debuginfo-1.6.24-2.26.1
dbus-1-x11-debugsource-1.6.24-2.26.1
libdbus-1-3-1.6.24-2.26.1
libdbus-1-3-debuginfo-1.6.24-2.26.1
- openSUSE 12.3 (x86\_64):
dbus-1-32bit-1.6.24-2.26.1
dbus-1-debuginfo-32bit-1.6.24-2.26.1
dbus-1-devel-32bit-1.6.24-2.26.1
libdbus-1-3-32bit-1.6.24-2.26.1
libdbus-1-3-debuginfo-32bit-1.6.24-2.26.1
- openSUSE 12.3 (noarch):
dbus-1-devel-doc-1.6.24-2.26.1
References:
<http://support.novell.com/security/cve/CVE-2014-3635.html>
<http://support.novell.com/security/cve/CVE-2014-3636.html>
<http://support.novell.com/security/cve/CVE-2014-3637.html>
<http://support.novell.com/security/cve/CVE-2014-3638.html>
<http://support.novell.com/security/cve/CVE-2014-3639.html>
<https://bugzilla.suse.com/show_bug.cgi?id=896453>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.mandriva.com_882a8d89_20250124_130228.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language¬†![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Fran√ßais
  + √ê¬†√ë¬É√ë¬Å√ë¬Å√ê¬∫√ê¬∏√ê¬π

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site ¬ª

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site ¬ª

Language
English (International)
Fran√ßais
√ê¬†√ë¬É√ë¬Å√ë¬Å√ê¬∫√ê¬∏√ê¬π

* ¬© 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from www.debian.org_232d5a33_20250124_130226.html ===


---

[[Date Prev](msg00212.html)][[Date Next](msg00214.html)]
[[Thread Prev](msg00212.html)][[Thread Next](msg00214.html)]
[[Date Index](maillist.html#00213)]
[[Thread Index](threads.html#00213)]

# [SECURITY] [DSA 3026-1] dbus security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3026-1] dbus security update
* *From*: Florian Weimer <fw@deneb.enyo.de>
* *Date*: Tue, 16 Sep 2014 20:34:09 +0200
* *Message-id*: <[[üîé]](/msgid-search/87bnqf9zz2.fsf%40mid.deneb.enyo.de)¬†[87bnqf9zz2.fsf@mid.deneb.enyo.de](msg00213.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3026-1                   security@debian.org
<http://www.debian.org/security/>                            Florian Weimer
September 16, 2014                     <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dbus
CVE ID         : CVE-2014-3635 CVE-2014-3636 CVE-2014-3637 CVE-2014-3638
                 CVE-2014-3639

Alban Crequy and Simon McVittie discovered several vulnerabilities in
the D-Bus message daemon.

CVE-2014-3635

    On 64-bit platforms, file descriptor passing could be abused by
    local users to cause heap corruption in the dbus-daemon crash,
    leading to a crash, or potentially to arbitrary code execution.

CVE-2014-3636

    A denial-of-service vulnerability in dbus-daemon allowed local
    attackers to prevent new connections to dbus-daemon, or disconnect
    existing clients, by exhausting descriptor limits.

CVE-2014-3637

    Malicious local users could create D-Bus connections to
    dbus-daemon which could not be terminated by killing the
    participating processes, resulting in a denial-of-service
    vulnerability.

CVE-2014-3638

    dbus-daemon suffered from a denial-of-service vulnerability in the
    code which tracks which messages expect a reply, allowing local
    attackers to reduce the performance of dbus-daemon.

CVE-2014-3639

    dbus-daemon did not properly reject malicious connections from
    local users, resulting in a denial-of-service vulnerability.

For the stable distribution (wheezy), these problems have been fixed in
version 1.6.8-1+deb7u4.

For the unstable distribution (sid), these problems have been fixed in
version 1.8.8-1.

We recommend that you upgrade your dbus packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJUGIrzAAoJEL97/wQC1SS+bgAH/2v7suJ3q6QQ9r8dpK3wlYtC
n6DrrqHvzECB0oEro51cvkHY9cl8HSYlKZoRXdbluEaHGCu+8f/IZ0aQIC2hkz1e
Cqh62l4Gzo+CZRmnDk4oTi2PcqnEXkIJgOo7pEDT4C9+4c5sF+vbLkAJ+x4VoRbf
eneYNgwIPGh8pyvw9VrMzTJAE81j5fZC5g6jxFfQCCOfo6IZlxKhn+d5XCElDz1f
yO4oeczxOkH0oHUo0Jo6Kd2RllbTbO9F+f2PVTOPRAvr1yqEj1zRtll0kA2vXZ0p
13pcZd3F/AWYDF8O5slOPZulx8GmVDETir2Jd8bPCduv7C4DPN9x8MA2IoYV668=
=Cvxc
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_52f69b11_20250126_011429.html ===


---

[[Date Prev](msg00212.html)][[Date Next](msg00214.html)]
[[Thread Prev](msg00212.html)][[Thread Next](msg00214.html)]
[[Date Index](maillist.html#00213)]
[[Thread Index](threads.html#00213)]

# [SECURITY] [DSA 3026-1] dbus security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3026-1] dbus security update
* *From*: Florian Weimer <fw@deneb.enyo.de>
* *Date*: Tue, 16 Sep 2014 20:34:09 +0200
* *Message-id*: <[[üîé]](/msgid-search/87bnqf9zz2.fsf%40mid.deneb.enyo.de)¬†[87bnqf9zz2.fsf@mid.deneb.enyo.de](msg00213.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3026-1                   security@debian.org
<http://www.debian.org/security/>                            Florian Weimer
September 16, 2014                     <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dbus
CVE ID         : CVE-2014-3635 CVE-2014-3636 CVE-2014-3637 CVE-2014-3638
                 CVE-2014-3639

Alban Crequy and Simon McVittie discovered several vulnerabilities in
the D-Bus message daemon.

CVE-2014-3635

    On 64-bit platforms, file descriptor passing could be abused by
    local users to cause heap corruption in the dbus-daemon crash,
    leading to a crash, or potentially to arbitrary code execution.

CVE-2014-3636

    A denial-of-service vulnerability in dbus-daemon allowed local
    attackers to prevent new connections to dbus-daemon, or disconnect
    existing clients, by exhausting descriptor limits.

CVE-2014-3637

    Malicious local users could create D-Bus connections to
    dbus-daemon which could not be terminated by killing the
    participating processes, resulting in a denial-of-service
    vulnerability.

CVE-2014-3638

    dbus-daemon suffered from a denial-of-service vulnerability in the
    code which tracks which messages expect a reply, allowing local
    attackers to reduce the performance of dbus-daemon.

CVE-2014-3639

    dbus-daemon did not properly reject malicious connections from
    local users, resulting in a denial-of-service vulnerability.

For the stable distribution (wheezy), these problems have been fixed in
version 1.6.8-1+deb7u4.

For the unstable distribution (sid), these problems have been fixed in
version 1.8.8-1.

We recommend that you upgrade your dbus packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJUGIrzAAoJEL97/wQC1SS+bgAH/2v7suJ3q6QQ9r8dpK3wlYtC
n6DrrqHvzECB0oEro51cvkHY9cl8HSYlKZoRXdbluEaHGCu+8f/IZ0aQIC2hkz1e
Cqh62l4Gzo+CZRmnDk4oTi2PcqnEXkIJgOo7pEDT4C9+4c5sF+vbLkAJ+x4VoRbf
eneYNgwIPGh8pyvw9VrMzTJAE81j5fZC5g6jxFfQCCOfo6IZlxKhn+d5XCElDz1f
yO4oeczxOkH0oHUo0Jo6Kd2RllbTbO9F+f2PVTOPRAvr1yqEj1zRtll0kA2vXZ0p
13pcZd3F/AWYDF8O5slOPZulx8GmVDETir2Jd8bPCduv7C4DPN9x8MA2IoYV668=
=Cvxc
-----END PGP SIGNATURE-----

```

---



=== Content from www.ubuntu.com_b4015ba8_20250124_130229.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2352-1: DBus vulnerabilities

22 September 2014

Several security issues were fixed in DBus.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [dbus](/security/cves?package=dbus) - simple interprocess messaging system

## Details

Simon McVittie discovered that DBus incorrectly handled the file

descriptors message limit. A local attacker could use this issue to cause

DBus to crash, resulting in a denial of service, or possibly execute

arbitrary code. This issue only applied to Ubuntu 12.04 LTS and Ubuntu

14.04 LTS. ([CVE-2014-3635](/security/CVE-2014-3635))

Alban Crequy discovered that DBus incorrectly handled a large number of

file descriptor messages. A local attacker could use this issue to cause

DBus to stop responding, resulting in a denial of service. This issue only

applied to Ubuntu 12.04 LTS and Ubuntu 14.04 LTS. ([CVE-2014-3636](/security/CVE-2014-3636))

Alban Crequy discovered that DBus incorrectly handled certain file

descriptor messages. A local attacker could use this issue to cause DBus

to maintain persistent connections, possibly resulting in a denial of

service. This issue only applied to Ubuntu 12.04 LTS and Ubuntu 14.04 LTS.

([CVE-2014-3637](/security/CVE-2014-3637))

Alban Crequy discovered that DBus incorrectly handled a large number of

parallel connections and parallel message calls. A local attacker could use

this issue to cause DBus to consume resources, possibly resulting in a

denial of service. ([CVE-2014-3638](/security/CVE-2014-3638))

Alban Crequy discovered that DBus incorrectly handled incomplete

connections. A local attacker could use this issue to cause DBus to fail

legitimate connection attempts, resulting in a denial of service.

([CVE-2014-3639](/security/CVE-2014-3639))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 14.04

* [dbus](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.6.18-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/dbus/1.6.18-0ubuntu4.2)
* [libdbus-1-3](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.6.18-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/dbus/1.6.18-0ubuntu4.2)

##### Ubuntu 12.04

* [dbus](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.4.18-1ubuntu1.6](https://launchpad.net/ubuntu/%2Bsource/dbus/1.4.18-1ubuntu1.6)
* [libdbus-1-3](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.4.18-1ubuntu1.6](https://launchpad.net/ubuntu/%2Bsource/dbus/1.4.18-1ubuntu1.6)

##### Ubuntu 10.04

* [dbus](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.2.16-2ubuntu4.8](https://launchpad.net/ubuntu/%2Bsource/dbus/1.2.16-2ubuntu4.8)
* [libdbus-1-3](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.2.16-2ubuntu4.8](https://launchpad.net/ubuntu/%2Bsource/dbus/1.2.16-2ubuntu4.8)

After a standard system update you need to reboot your computer to make all

the necessary changes.

## References

* [CVE-2014-3635](/security/CVE-2014-3635)
* [CVE-2014-3636](/security/CVE-2014-3636)
* [CVE-2014-3637](/security/CVE-2014-3637)
* [CVE-2014-3638](/security/CVE-2014-3638)
* [CVE-2014-3639](/security/CVE-2014-3639)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

¬© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from launchpad.net_1f701165_20250126_011430.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/dbus/1.2.16-2ubuntu4.8/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[dbus package](https://launchpad.net/ubuntu/%2Bsource/dbus)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/dbus)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/dbus)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/dbus)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/dbus)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/dbus)

# dbus 1.2.16-2ubuntu4.8 source package in Ubuntu

## Changelog

```
dbus (1.2.16-2ubuntu4.8) lucid-security; urgency=medium

  * SECURITY UPDATE: denial of service via large number of pending replies
    - debian/patches/CVE-2014-3638.patch: reduce max_replies_per_connection
      to 128 in bus/config-parser.c.
    - CVE-2014-3638
  * SECURITY UPDATE: denial of service via incomplete connections
    - debian/patches/CVE-2014-3639.patch: reduce auth_timeout in
      bus/config-parser.c, stop listening on DBusServer sockets when
      reaching max_incomplete_connections in bus/bus.*, bus/connection.*,
      dbus/dbus-server-protected.h, dbus/dbus-server.c, dbus/dbus-watch.*.
    - CVE-2014-3639
 -- Marc Deslauriers <email address hidden>   Wed, 17 Sep 2014 12:27:46 -0400
```

## Upload details

Uploaded by:
[Marc Deslauriers](/~mdeslaur)
on 2014-09-17

Uploaded to:
[Lucid](/ubuntu/lucid)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
any

Section:
devel

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Lucid](/ubuntu/lucid):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6387249)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armel](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6387250)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6387251)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[ia64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6387252)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6387253)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[sparc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/6387254)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [dbus\_1.2.16.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/dbus/1.2.16-2ubuntu4.8/dbus_1.2.16.orig.tar.gz) | 1.5 MiB | 968a31c16a6c4bbbdb603cbaa3d60d6d19bc8ae30c0ed55d7f8c2e254413e4c8 |
| [dbus\_1.2.16-2ubuntu4.8.diff.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/dbus/1.2.16-2ubuntu4.8/dbus_1.2.16-2ubuntu4.8.diff.gz) | 39.8 KiB | 3460d127c715fd6aadb77d33a9c3084fb8cc0378873869f56972227a1a6132b4 |
| [dbus\_1.2.16-2ubuntu4.8.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/dbus/1.2.16-2ubuntu4.8/dbus_1.2.16-2ubuntu4.8.dsc) | 2.3 KiB | 13f87f4dad50c714d5efc3901ebc201dc3cc0a0a13b07d1158d5454b737fd1c6 |

### Available diffs

* [diff from 1.2.16-2ubuntu4.7 to 1.2.16-2ubuntu4.8](http://launchpadlibrarian.net/185124908/dbus_1.2.16-2ubuntu4.7_1.2.16-2ubuntu4.8.diff.gz) (3.6 KiB)

[View changes file](http://launchpadlibrarian.net/185124869/dbus_1.2.16-2ubuntu4.8_source.changes)

## Binary packages built by this source

[dbus](/ubuntu/lucid/%2Bpackage/dbus):
No summary available for dbus in ubuntu lucid.

No description available for dbus in ubuntu lucid.

[dbus-1-doc](/ubuntu/lucid/%2Bpackage/dbus-1-doc):
No summary available for dbus-1-doc in ubuntu lucid.

No description available for dbus-1-doc in ubuntu lucid.

[dbus-x11](/ubuntu/lucid/%2Bpackage/dbus-x11):
No summary available for dbus-x11 in ubuntu lucid.

No description available for dbus-x11 in ubuntu lucid.

[libdbus-1-3](/ubuntu/lucid/%2Bpackage/libdbus-1-3):
No summary available for libdbus-1-3 in ubuntu lucid.

No description available for libdbus-1-3 in ubuntu lucid.

[libdbus-1-dev](/ubuntu/lucid/%2Bpackage/libdbus-1-dev):
No summary available for libdbus-1-dev in ubuntu lucid.

No description available for libdbus-1-dev in ubuntu lucid.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
¬†‚Ä¢
[Take the tour](https://launchpad.net/%2Btour)
¬†‚Ä¢
[Read the guide](https://help.launchpad.net/)

¬© 2004
[Canonical¬†Ltd.](http://canonical.com/)
¬†‚Ä¢
[Terms of use](https://launchpad.net/legal)
¬†‚Ä¢
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
¬†‚Ä¢
[Contact Launchpad Support](/feedback)
¬†‚Ä¢
[Blog](http://blog.launchpad.net/)
¬†‚Ä¢
[Careers](https://canonical.com/careers)
¬†‚Ä¢
[System status](https://ubuntu.social/%40launchpadstatus)
¬†‚Ä¢
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.freedesktop.org_37be0d54_20250126_011428.html ===


Bugzilla ‚Äì Bug¬†83622
CVE-2014-3635: buffer overflow at fd-passing limit
Last modified: 2014-09-16 16:37:32 UTC

* [Home](./)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

[**Bug¬†83622**](show_bug.cgi?id=83622)
- CVE-2014-3635: buffer overflow at fd-passing limit

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-3635: buffer overflow at fd-passing limit

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | dbus | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=dbus "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | core ([show other bugs](buglist.cgi?component=core&product=dbus&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other All | |  | | | [Importance](page.cgi?id=fields.html#importance): | medium normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Simon McVittie | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Alban Crequy | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | review+ | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | patch, security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-09-08 18:00 UTC by Simon McVittie | | --- | --- | | Modified: | 2014-09-16 16:37 UTC ([History](show_activity.cgi?id=83622)) | | CC List: | 4 users (show)  lennart sjoerd thiago walters | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [i915 platform:](page.cgi?id=fields.html#cf_i915_platform "Intel platforms affected by the bug") |  | | [i915 features:](page.cgi?id=fields.html#cf_i915_features "Features of the i915 driver affected by the bug.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**\_dbus\_read\_socket\_with\_unix\_fds: do not accept extra fds in cmsg padding**](attachment.cgi?id=105917 "View the content of the attachment") (3.75 KB, patch)  [2014-09-08 19:36 UTC](#attach_105917 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=105917&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=105917) | | [**New test for fd-passing**](attachment.cgi?id=105918 "View the content of the attachment") (21.92 KB, patch)  [2014-09-08 19:37 UTC](#attach_105918 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=105918&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=105918) | | [**[v2] \_dbus\_read\_socket\_with\_unix\_fds: do not accept extra fds in cmsg padding**](attachment.cgi?id=105975 "View the content of the attachment") (4.30 KB, patch)  [2014-09-09 11:51 UTC](#attach_105975 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=105975&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=105975) | | [**Add \_DBUS\_GNUC\_UNUSED, and use it in \_DBUS\_STATIC\_ASSERT**](attachment.cgi?id=105976 "View the content of the attachment") (1.56 KB, patch)  [2014-09-09 11:51 UTC](#attach_105976 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=105976&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=105976) | | [**fdpass test: respond to the simpler bits of Alban's review**](attachment.cgi?id=105989 "View the content of the attachment") (7.29 KB, patch)  [2014-09-09 15:16 UTC](#attach_105989 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=105989&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=105989) | | [**Add a test-case for a synthetic message with 255 fds**](attachment.cgi?id=105990 "View the content of the attachment") (7.29 KB, patch)  [2014-09-09 15:16 UTC](#attach_105990 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=105990&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=105990) | | [**fdpass test: give the too-many tests distinct names**](attachment.cgi?id=105991 "View the content of the attachment") (1.16 KB, patch)  [2014-09-09 15:17 UTC](#attach_105991 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=105991&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=105991) | | [**\_dbus\_read\_socket\_with\_unix\_fds: do not accept extra fds in cmsg padding**](attachment.cgi?id=105996 "View the content of the attachment") (4.24 KB, patch)  [2014-09-09 18:31 UTC](#attach_105996 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=105996&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=105996) | | [**New test for fd-passing**](attachment.cgi?id=105997 "View the content of the attachment") (28.93 KB, patch)  [2014-09-09 18:31 UTC](#attach_105997 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=105997&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=105997) | | [**Re-order headers to avoid redefining GLIB\_VERSION\_MAX\_ALLOWED with older GLib**](attachment.cgi?id=106177 "View the content of the attachment") (876 bytes, patch)  [2014-09-12 12:47 UTC](#attach_106177 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106177&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=106177) | | [**fdpass test: declare Fixture, and the fallback g\_test\_skip() if needed, if !HAVE\_UNIX\_FD\_PASSING**](attachment.cgi?id=106178 "View the content of the attachment") (959 bytes, patch)  [2014-09-12 12:48 UTC](#attach_106178 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106178&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=106178) | | [**[patch v3] New test for fd passing**](attachment.cgi?id=106187 "View the content of the attachment") (28.85 KB, patch)  [2014-09-12 14:25 UTC](#attach_106187 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106187&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=106187) | | [**[backport to 1.6] New test for fd-passing**](attachment.cgi?id=106194 "View the content of the attachment") (28.73 KB, patch)  [2014-09-12 15:44 UTC](#attach_106194 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106194&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=83622&attachment=106194) | | [Show Obsolete](#a0) (9) [View All](attachment.cgi?bugid=83622&action=viewall&hide_obsolete=1) | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=83622#c0)  Simon McVittie    2014-09-08 18:00:03 UTC  ``` While investigating another bug I accidentally found another unlikely DoS.  More details when I've confirmed that this is embargoed. ```  [Comment 1](show_bug.cgi?id=83622#c1)  Simon McVittie    2014-09-08 18:27:59 UTC  ``` While writing a regression test to investigate [Bug #82820](show_bug.cgi?id=82820 "RESOLVED FIXED - CVE-2014-3636: using all available file descriptors in dbus-daemon: limit DEFAULT_MESSAGE_UNIX_FDS"), I discovered another weird DoS involving file descriptor passing.  If max_message_unix_fds is set to an odd number on 64-bit platforms, a malicious message-sender can crash the message recipient. (In general, the bad situation is that (max_message_unix_fds * sizeof (int)) % sizeof (size_t) is nonzero.)  This is because the recipient allocates enough space for a cmsg header (16 bytes on x86 Linux), plus padding to size_t alignment, plus an array of max_message_unix_fds (== *n_fds) ints, plus padding to size_t alignment. It is zero-filled.    m.msg_controllen = CMSG_SPACE(*n_fds * sizeof(int));   m.msg_control = alloca(m.msg_controllen);   memset(m.msg_control, 0, m.msg_controllen);  Let's suppose *n_fds is 7 for the sake of illustration. On my system, m.msg_controllen is 48:      ---- size_t aligned     0-15    cmsg header + padding (CMSG_LEN (0) == 16)     16-19   first fd     ...     40-43   seventh fd (CMSG_LEN (7 * sizeof (int)) == 44)     [44-47] padding (CMSG_SPACE (7 * sizeof (int)) == 48)     ---- size_t aligned  The only information that Linux has is m.msg_controllen. If the sender sends exactly one fd more than we wanted (i.e. exactly 8 fds), the kernel thinks "I need 16 bytes for the header and 32 bytes for these 8 fds, the dbus-daemon has given me exactly those 48 bytes, OK, I can fill them all" and does so.  Then we parse the cmsg header:               unsigned i;                _dbus_assert(cm->cmsg_len <= CMSG_LEN(*n_fds * sizeof(int)));              *n_fds = (cm->cmsg_len - CMSG_LEN(0)) / sizeof(int);                memcpy(fds, CMSG_DATA(cm), *n_fds * sizeof(int));              found = TRUE;  If assertions are enabled, dbus-daemon crashes with an assertion failure: cm->cmsg_len == 48, CMSG_LEN (*n_fds * sizeof (int)) == 44.  If assertions are not enabled, then we assign 8 to *n_fds, and memcpy 8 ints into a 7-int buffer. Bad news!  Mitigations:  * Platforms where cmsg is only aligned to int boundaries (e.g. i386)   are unaffected  * The default limit on the number of fds per message is not odd,   and approximately nobody changes the default arbitrary limits  * Assertions are normally disabled in production builds of dbus-daemon,   so we don't crash with an assertion failure (this would make matters   worse, potentially turning DoS into heap-smashing and arbitrary code   execution, if it wasn't for the third mitigation)  * loader->unix_fds is allocated with _dbus_realloc(), which is basically   libc realloc(), which is likely to round odd-sized allocations up to the   next 8- or 16-byte boundary; so writing 2*n ints into a buffer   intended for 2*n-1 ints will probably not actually overflow that buffer ```  [Comment 2](show_bug.cgi?id=83622#c2)  Simon McVittie    2014-09-08 19:36:43 UTC  ``` Created [attachment 105917](attachment.cgi?id=105917 "_dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[details]](attachment.cgi?id=105917&action=edit "_dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105917) _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding  If (*n_fds * sizeof (int) % sizeof (size_t)) is nonzero, then CMSG_SPACE (*n_fds * sizeof (int)) > CMSG_LEN (*n_fds * sizeof (int) because the SPACE includes padding to a size_t boundary, whereas the LEN does not. We have to allocate the SPACE. Previously, we told the kernel that the buffer size we wanted was the SPACE, not the LEN, which meant it was free to fill the padding with additional fds: on a 64-bit platform with 32-bit int, that's one extra fd, if *n_fds happens to be odd.  This meant that a malicious sender could send exactly 1 fd too many, which would make us fail an assertion if enabled, or overrun a buffer by 1 fd otherwise.  In practice, *n_fds == max_message_unix_fds, which defaults to an even number and is unlikely to be set to an odd number. ```  [Comment 3](show_bug.cgi?id=83622#c3)  Simon McVittie    2014-09-08 19:37:51 UTC  ``` Created [attachment 105918](attachment.cgi?id=105918 "New test for fd-passing") [[details]](attachment.cgi?id=105918&action=edit "New test for fd-passing") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105918) New test for fd-passing  ---  In particular, /odd-limit/plus1 exercises this bug. ```  [Comment 4](show_bug.cgi?id=83622#c4)  Alban Crequy    2014-09-09 11:15:51 UTC  ``` Comment on [attachment 105917](attachment.cgi?id=105917 "_dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[details]](attachment.cgi?id=105917&action=edit "_dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105917) _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding  Review of [attachment 105917](attachment.cgi?id=105917 "_dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[details]](attachment.cgi?id=105917&action=edit "_dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105917): -----------------------------------------------------------------  ::: dbus/dbus-sysdeps-unix.c @@ +386,5 @@ > +                 * someone could send us an extra fd per message > +                 * and we'd eventually run out. */ > +                for (i = (size_t) *n_fds; i < payload_len_fds; i++) > +                  { > +                    close (payload[i]);  This branch should not happen, but if it does, you close the fd and then set close_on_exec on the closed fd below.  @@ +398,5 @@ >   >              /* Linux doesn't tell us whether MSG_CMSG_CLOEXEC actually >                 worked, hence we need to go through this list and set >                 CLOEXEC everywhere in any case */ > +            for (i = 0; i < payload_len_fds; i++)  Shouldn't you keep n_fds here, since the additional fds would be closed in the "else" branch?  Also, fds[i] for i >= *nfds has not been memcpy()ed, so you would close_on_exec an uninitialized fd. ```  [Comment 5](show_bug.cgi?id=83622#c5)  Simon McVittie    2014-09-09 11:30:45 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=83622#c4)) > This branch [the one with payload_len_fds > *n_fds] > should not happen, but if it does, you close the fd and then set > close_on_exec on the closed fd below.  Not the case, unless there's a flaw in my logic below:  > > +            for (i = 0; i < payload_len_fds; i++) >  > Shouldn't you keep n_fds here, since the additional fds would be closed in > the "else" branch?  *n_fds and payload_len_fds are numerically equal (to whichever of their previous values was the lesser) after either branch.  In the branch where payload_len_fds <= (size_t) *n_fds, I set *n_fds = (int) payload_len_fds. Note that the casts are valid, because *n_fds is known to be non-negative, and size_t is unsigned, so the condition implies that 0 ‚â§ payload_len_fds ‚â§ *n_fds, therefore payload_len_fds certainly fits in the range of int.  In the branch where payload_len_fds > *n_fds, I set payload_len_fds = (size_t) *n_fds. Again, the cast is valid, because *n_fds is known to be non-negative. Before changing payload_len_fds, I close the excess fds, payload[*n_fds]..payload[old(payload_len_fds)-1], because resetting payload_len_fds means that the memcpy and the cloexec loop will not extend to those fds.  The only reason I changed the limit of the cloexec loop from *n_fds to payload_len_fds is that i is now a size_t, so we'd need yet another cast (for (i = 0; i < (size_t) *n_fds; i++)) otherwise the compiler would (reasonably) warn us that we're comparing integers with different ranges.  Perhaps I could make this clearer by introducing another temporary variable? ```  [Comment 6](show_bug.cgi?id=83622#c6)  Simon McVittie    2014-09-09 11:51:16 UTC  ``` Created [attachment 105975](attachment.cgi?id=105975 "[v2] _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[details]](attachment.cgi?id=105975&action=edit "[v2] _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105975) [v2] _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding  ---  Perhaps this one is clearer, and easier to reason about? I introduced a new variable fds_to_use, which makes payload_len_fds constant.  The use of _DBUS_STATIC_ASSERT does trip a -Wunused-local-typedefs warning which I'll fix with a simple extra patch. ```  [Comment 7](show_bug.cgi?id=83622#c7)  Simon McVittie    2014-09-09 11:51:50 UTC  ``` Created [attachment 105976](attachment.cgi?id=105976 "Add _DBUS_GNUC_UNUSED, and use it in _DBUS_STATIC_ASSERT") [[details]](attachment.cgi?id=105976&action=edit "Add _DBUS_GNUC_UNUSED, and use it in _DBUS_STATIC_ASSERT") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105976) Add _DBUS_GNUC_UNUSED, and use it in _DBUS_STATIC_ASSERT  This means we can use _DBUS_STATIC_ASSERT at non-global scope without tripping -Wunused-local-typedefs. ```  [Comment 8](show_bug.cgi?id=83622#c8)  Alban Crequy    2014-09-09 12:12:24 UTC  ``` Comment on [attachment 105975](attachment.cgi?id=105975 "[v2] _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[details]](attachment.cgi?id=105975&action=edit "[v2] _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105975) [v2] _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding  Review of [attachment 105975](attachment.cgi?id=105975 "[v2] _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[details]](attachment.cgi?id=105975&action=edit "[v2] _dbus_read_socket_with_unix_fds: do not accept extra fds in  cmsg padding") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105975): -----------------------------------------------------------------  Not tested, but it looks good to me. ```  [Comment 9](show_bug.cgi?id=83622#c9)  Alban Crequy    2014-09-09 12:13:27 UTC  ``` Comment on [attachment 105976](attachment.cgi?id=105976 "Add _DBUS_GNUC_UNUSED, and use it in _DBUS_STATIC_ASSERT") [[details]](attachment.cgi?id=105976&action=edit "Add _DBUS_GNUC_UNUSED, and use it in _DBUS_STATIC_ASSERT") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105976) Add _DBUS_GNUC_UNUSED, and use it in _DBUS_STATIC_ASSERT  Review of [attachment 105976](attachment.cgi?id=105976 "Add _DBUS_GNUC_UNUSED, and use it in _DBUS_STATIC_ASSERT") [[details]](attachment.cgi?id=105976&action=edit "Add _DBUS_GNUC_UNUSED, and use it in _DBUS_STATIC_ASSERT") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105976): -----------------------------------------------------------------  Not tested, but it looks good to me. ```  [Comment 10](show_bug.cgi?id=83622#c10)  Alban Crequy    2014-09-09 13:15:41 UTC  ``` Comment on [attachment 105918](attachment.cgi?id=105918 "New test for fd-passing") [[details]](attachment.cgi?id=105918&action=edit "New test for fd-passing") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105918) New test for fd-passing  Review of [attachment 105918](attachment.cgi?id=105918 "New test for fd-passing") [[details]](attachment.cgi?id=105918&action=edit "New test for fd-passing") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105918): -----------------------------------------------------------------  Only some minor comments:  ::: test/fdpass.c @@ +101,5 @@ > +    g_error ("expected success but got error: %s: %s", e->name, e->message); > +} > + > +static DBusHandlerResult > +server_message_cb (DBusConnection *server_conn,  I suggest the name left_server_message_cb() or to add a comment.  @@ +354,5 @@ > +  int i; > + > +  if (f->fd_before < 0) > +    { > +      g_test_skip ("cannot open /dev/zero");  Any reason opening /dev/zero could fail? If no reason, why not factorise the test in setup()?  @@ +437,5 @@ > + > +  dbus_message_unref (outgoing); > + > +  /* The sender is unceremoniously disconnected. */ > +  while (dbus_connection_get_is_connected (f->left_client_conn))  You could also check that f->left_server_conn get disconnected.  while (dbus_connection_get_is_connected (f->left_client_conn) ||        dbus_connection_get_is_connected (f->left_server_conn))  @@ +444,5 @@ > +      test_main_context_iterate (f->ctx, TRUE); > +    } > + > +  /* The message didn't get through without its fds. */ > +  g_assert_cmpuint (g_queue_get_length (&f->messages), ==, 0);  Hopefully, left_client_conn's misbehaviour does not disconnect right_client_conn. We could check that with:  g_assert (dbus_connection_get_is_connected (f->right_client_conn)); g_assert (dbus_connection_get_is_connected (f->right_server_conn));  @@ +569,5 @@ > +          test_main_context_iterate (f->ctx, TRUE); > +        } > + > +      /* The message didn't get through without its fds. */ > +      g_assert_cmpuint (g_queue_get_length (&f->messages), ==, 0);  And the right connection is still alive.  g_assert (dbus_connection_get_is_connected (f->right_client_conn)); g_assert (dbus_connection_get_is_connected (f->right_server_conn));  @@ +583,5 @@ > +          test_main_context_iterate (f->ctx, TRUE); > +        } > + > +      g_assert_cmpuint (g_queue_get_length (&f->messages), ==, 1); > +  And both connections are still alive.  g_assert (dbus_connection_get_is_connected (f->right_client_conn)); g_assert (dbus_connection_get_is_connected (f->right_server_conn)); g_assert (dbus_connection_get_is_connected (f->left_client_conn)); g_assert (dbus_connection_get_is_connected (f->left_server_conn));  @@ +667,5 @@ > +      test_too_many, teardown); > +  g_test_add ("/too-many", Fixture, GUINT_TO_POINTER (2), setup, > +      test_too_many, teardown); > +  g_test_add ("/too-many", Fixture, GUINT_TO_POINTER (17), setup, > +      test_too_many, teardown);  In addition to 1, 2 and 17, can you check 256? It should also work with 256 but it would use a different code path for the reason explained in [Bug #82820 Comment #9](show_bug.cgi?id=82820#c9 "RESOLVED FIXED - CVE-2014-3636: using all available file descriptors in dbus-daemon: limit DEFAULT_MESSAGE_UNIX_FDS"). ```  [Comment 11](show_bug.cgi?id=83622#c11)  Simon McVittie    2014-09-09 13:42:05 UTC  ``` (In reply to [comment #10](show_bug.cgi?id=83622#c10)) > I suggest the name left_server_message_cb() ... > You could also check that f->left_server_conn get disconnected. ... > Hopefully, left_client_conn's misbehaviour does not disconnect > right_client_conn. ... > And the right connection is still alive. ... > And both connections are still alive.  All good ideas. I'll do them in one big patch since they're simple.  > > +      g_test_skip ("cannot open /dev/zero"); >  > Any reason opening /dev/zero could fail? If no reason, why not factorise the > test in setup()?  I don't know whether g_test_skip() can work during setup(), and the fallback implementation certainly can't. I don't really want the test to hard-depend on a more modern GLib since I would like to merge it into stable-branches, hence this weird setup.  However, if I replace /dev/zero with a path that definitely exists on every reasonable Unix platform, like /bin/sh, I can just make it a g_error(). I'll do that.  > In addition to 1, 2 and 17, can you check 256? It should also work with 256 > but it would use a different code path for the reason explained in Bug > #82820 [Comment #9](show_bug.cgi?id=83622#c9).  Good idea.  The numbers here are the margin by which to exceed the limit, rather than an absolute number of fds; for the 256 case I'll use exactly 256 fds instead. ```  [Comment 12](show_bug.cgi?id=83622#c12)  Simon McVittie    2014-09-09 15:16:11 UTC  ``` Created [attachment 105989](attachment.cgi?id=105989 "fdpass test: respond to the simpler bits of Alban's  review") [[details]](attachment.cgi?id=105989&action=edit "fdpass test: respond to the simpler bits of Alban's  review") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105989) fdpass test: respond to the simpler bits of Alban's  review  - rename server_message_cb to left_server_message_cb - open /dev/null instead of /dev/zero, and just crash if we can't - when the left connection should be disconnected, assert that both   ends disconnect; when it should not, assert that - always assert that the right connection is not disconnected - make my_test_skip() inline since it's trivial, it will not   currently be used on fd-passing platforms, and inline functions   are immune to -Wunused  ---  I'll probably squash this into [Attachment #105918](attachment.cgi?id=105918 "New test for fd-passing") [[details]](attachment.cgi?id=105918&action=edit "New test for fd-passing"). ```  [Comment 13](show_bug.cgi?id=83622#c13)  Simon McVittie    2014-09-09 15:16:29 UTC  ``` Created [attachment 105990](attachment.cgi?id=105990 "Add a test-case for a synthetic message with 255 fds") [[details]](attachment.cgi?id=105990&action=edit "Add a test-case for a synthetic message with 255 fds") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105990) Add a test-case for a synthetic message with 255 fds ```  [Comment 14](show_bug.cgi?id=83622#c14)  Simon McVittie    2014-09-09 15:17:15 UTC  ``` Created [attachment 105991](attachment.cgi?id=105991 "fdpass test: give the too-many tests distinct names") [[details]](attachment.cgi?id=105991&action=edit "fdpass test: give the too-many tests distinct names") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105991) fdpass test: give the too-many tests distinct names  ---  To be squashed into [Attachment #105918](attachment.cgi?id=105918 "New test for fd-passing") [[details]](attachment.cgi?id=105918&action=edit "New test for fd-passing"), but it's probably easier to review like this. ```  [Comment 15](show_bug.cgi?id=83622#c15)  Alban Crequy    2014-09-09 15:49:49 UTC  ``` The 3 new patches look good to me.  When you squash all the patches, can you make sure the commit log in the resulting patch references the bugzilla entry? ```  [Comment 16](show_bug.cgi?id=83622#c16)  Simon McVittie    2014-09-09 18:29:03 UTC  ``` (In reply to [comment #1](show_bug.cgi?id=83622#c1)) > If max_message_unix_fds is set to an odd number on 64-bit platforms  Alban has pointed out that this is not actually necessary...  > * The default limit on the number of fds per message is not odd, >   and approximately nobody changes the default arbitrary limits  ... and so this mitigation does not really exist, because it is  possible to get *n_fds < max_message_unix_fds. Users of libdbus (and probably every other D-Bus implementation) will attach fds to the sendmsg() that contains the first byte of the message, but a malicious sender could send a message in more than one sendmsg(), with (maybe an odd number of) fds in more than one part. Linux preserves message boundaries if fds are attached, so we'd receive them in more than one recvmsg(), with *n_fds reducing with each recvmsg() (possibly down to zero). ```  [Comment 17](show_bug.cgi?id=83622#c17)  Simon McVittie    2014-09-09 18:31:18 UTC  ``` Created [attachment 105996](attachment.cgi?id=105996 "_dbus_read_socket_with_unix_fds: do not accept extra fds  in cmsg padding") [[details]](attachment.cgi?id=105996&action=edit "_dbus_read_socket_with_unix_fds: do not accept extra fds  in cmsg padding") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105996) _dbus_read_socket_with_unix_fds: do not accept extra fds  in cmsg padding  If (*n_fds * sizeof (int) % sizeof (size_t)) is nonzero, then CMSG_SPACE (*n_fds * sizeof (int)) > CMSG_LEN (*n_fds * sizeof (int) because the SPACE includes padding to a size_t boundary, whereas the LEN does not. We have to allocate the SPACE. Previously, we told the kernel that the buffer size we wanted was the SPACE, not the LEN, which meant it was free to fill the padding with additional fds: on a 64-bit platform with 32-bit int, that's one extra fd, if *n_fds happens to be odd.  This meant that a malicious sender could send exactly 1 fd too many, which would make us fail an assertion if enabled, or overrun a buffer by 1 fd otherwise.  ---  The only change is that I deleted the part of the commit message that said *n_fds would be even in practice, because we can't assume that. ```  [Comment 18](show_bug.cgi?id=83622#c18)  Simon McVittie    2014-09-09 18:31:51 UTC  ``` Created [attachment 105997](attachment.cgi?id=105997 "New test for fd-passing") [[details]](attachment.cgi?id=105997&action=edit "New test for fd-passing") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=105997) New test for fd-passing  ---  Squashed version of what Alban already reviewed. ```  [Comment 19](show_bug.cgi?id=83622#c19)  Simon McVittie    2014-09-09 18:33:26 UTC  ``` Calling this a positive review because virtually nothing has changed since Alban said yes (I deleted one misleading paragraph from a commit message, and squashed all the test patches together). ```  [Comment 20](show_bug.cgi?id=83622#c20)  Simon McVittie    2014-09-09 18:36:18 UTC  ``` (In reply to [comment #15](show_bug.cgi?id=83622#c15)) > When you squash all the patches, can you make sure the commit log in the > resulting patch references the bugzilla entry?  Yes, I did that.  The _DBUS_GNUC_UNUSED patch deliberately does not reference this bug because I want to be able to drop it into master sooner than this bug being unembargoed, if it's useful elsewhere. ```  [Comment 21](show_bug.cgi?id=83622#c21)  Simon McVittie    2014-09-12 12:47:24 UTC  ``` Created [attachment 106177](attachment.cgi?id=106177 "Re-order headers to avoid redefining  GLIB_VERSION_MAX_ALLOWED with older GLib") [[details]](attachment.cgi?id=106177&action=edit "Re-order headers to avoid redefining  GLIB_VERSION_MAX_ALLOWED with older GLib") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=106177) Re-order headers to avoid redefining  GLIB_VERSION_MAX_ALLOWED with older GLib  dbus-internals.h re-includes config.h, and glib.h redefines GLIB_VERSION_MAX_ALLOWED to the current version if it is a later version. The combination results in macro redefinition warnings.  ---  To be squashed into a replacement for [Attachment #105997](attachment.cgi?id=105997 "New test for fd-passing") [[details]](attachment.cgi?id=105997&action=edit "New test for fd-passing").  Spotted by trying to cross-build with mingw: my mingw setup happens to have an older GLib.  I don't think I'm going to include this test in the dbus-1.8 branch or the security release, since a security release that didn't compile would be Bad. I'll just put it in master. ```  [Comment 22](show_bug.cgi?id=83622#c22)  Simon McVittie    2014-09-12 12:48:08 UTC  ``` Created [attachment 106178](attachment.cgi?id=106178 "fdpass test: declare Fixture, and the fallback  g_test_skip() if needed, if !HAVE_UNIX_FD_PASSING") [[details]](attachment.cgi?id=106178&action=edit "fdpass test: declare Fixture, and the fallback  g_test_skip() if needed, if !HAVE_UNIX_FD_PASSING") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=106178) fdpass test: declare Fixture, and the fallback  g_test_skip() if needed, if !HAVE_UNIX_FD_PASSING  This was failing to cross-compile with mingw.  ---  Also to be squashed into a replacement for [Attachment #105997](attachment.cgi?id=105997 "New test for fd-passing") [[details]](attachment.cgi?id=105997&action=edit "New test for fd-passing"). ```  [Comment 23](show_bug.cgi?id=83622#c23)  Alban Crequy    2014-09-12 13:04:48 UTC  ``` Comment on [attachment 106177](attachment.cgi?id=106177 "Re-order headers to avoid redefining  GLIB_VERSION_MAX_ALLOWED with older GLib") [[details]](attachment.cgi?id=106177&action=edit "Re-order headers to avoid redefining  GLIB_VERSION_MAX_ALLOWED with older GLib") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=106177) Re-order headers to avoid redefining  GLIB_VERSION_MAX_ALLOWED with older GLib  Review of [attachment 106177](attachment.cgi?id=106177 "Re-order headers to avoid redefining  GLIB_VERSION_MAX_ALLOWED with older GLib") [[details]](attachment.cgi?id=106177&action=edit "Re-order headers to avoid redefining  GLIB_VERSION_MAX_ALLOWED with older GLib") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=106177): -----------------------------------------------------------------  It looks good to me. ```  [Comment 24](show_bug.cgi?id=83622#c24)  Alban Crequy    2014-09-12 13:05:08 UTC  ``` Comment on [attachment 106178](attachment.cgi?id=106178 "fdpass test: declare Fixture, and the fallback  g_test_skip() if needed, if !HAVE_UNIX_FD_PASSING") [[details]](attachment.cgi?id=106178&action=edit "fdpass test: declare Fixture, and the fallback  g_test_skip() if needed, if !HAVE_UNIX_FD_PASSING") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=106178) fdpass test: declare Fixture, and the fallback  g_test_skip() if needed, if !HAVE_UNIX_FD_PASSING  Review of [attachment 106178](attachment.cgi?id=106178 "fdpass test: declare Fixture, and the fallback  g_test_skip() if needed, if !HAVE_UNIX_FD_PASSING") [[details]](attachment.cgi?id=106178&action=edit "fdpass test: declare Fixture, and the fallback  g_test_skip() if needed, if !HAVE_UNIX_FD_PASSING") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=106178): -----------------------------------------------------------------  It looks good to me. ```  [Comment 25](show_bug.cgi?id=83622#c25)  Simon McVittie    2014-09-12 14:25:31 UTC  ``` Created [attachment 106187](attachment.cgi?id=106187 "[patch v3] New test for fd passing") [[details]](attachment.cgi?id=106187&action=edit "[patch v3] New test for fd passing") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=106187) [patch v3] New test for fd passing  ---  squashed version of what Alban already reviewed ```  [Comment 26](show_bug.cgi?id=83622#c26)  Simon McVittie    2014-09-12 15:44:19 UTC  ``` Created [attachment 106194](attachment.cgi?id=106194 "[backport to 1.6] New test for fd-passing") [[details]](attachment.cgi?id=106194&action=edit "[backport to 1.6] New test for fd-passing") [[review]](page.cgi?id=splinter.html&bug=83622&attachment=106194) [backport to 1.6] New test for fd-passing  ---  I don't think I'm actually going to apply this to dbus-1.6, because anyone who is still on dbus-1.6 (e.g. Debian stable) is going to be picking isolated patches anyway; but people might find it useful for testing. ```  [Comment 27](show_bug.cgi?id=83622#c27)  Simon McVittie    2014-09-12 22:15:58 UTC  ``` CVE-2014-3635 has been allocated for this vulnerability. ```  [Comment 28](show_bug.cgi?id=83622#c28)  Simon McVittie    2014-09-15 11:06:09 UTC  ``` (In reply to [comment #1](show_bug.cgi?id=83622#c1)) > Mitigations: ... > * loader->unix_fds is allocated with _dbus_realloc(), which is basically >   libc realloc(), which is likely to round odd-sized allocations up to the >   next 8- or 16-byte boundary; so writing 2*n ints into a buffer >   intended for 2*n-1 ints will probably not actually overflow that buffer  I have realized that by the same logic Alban used to dismiss the "not usually odd" mitigation, this mitigation also does not work. Let's say our buffer is sized for N ints, where N is such that libc does not over-allocate (in practice, this will be true, because we habitually choose "nice" limits). A malicious sender can split their message across two sendmsg() calls, putting N-1 fds in the first, and 2 fds in the second. In this case we still overrun the buffer by 1 fd.  So this is rather less theoretical than I had first thought, and needs fixing with correspondingly higher urgency. ```  [Comment 29](show_bug.cgi?id=83622#c29)  Simon McVittie    2014-09-16 16:37:32 UTC  ``` Fixed in 1.8.8, making public ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=83622)
* -¬†Top of page

* + [Home](./)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

Use of freedesktop.org services, including Bugzilla, is subject to our [Code of Conduct](https://www.freedesktop.org/wiki/CodeOfConduct/). How we collect and use information is described in our [Privacy Policy](https://www.freedesktop.org/wiki/PrivacyPolicy).


