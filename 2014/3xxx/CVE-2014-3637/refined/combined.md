=== Content from lists.opensuse.org_407bde4d_20250125_202300.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

# openSUSE-SU-2014:1239-1: moderate: dbus-1: update to 1.6.24

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

28 Sep
2014

28 Sep
'14

10:09

openSUSE Security Update: dbus-1: update to 1.6.24
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:1239-1
Rating: moderate
References: #896453
Cross-References: CVE-2014-3635 CVE-2014-3636 CVE-2014-3637
CVE-2014-3638 CVE-2014-3639
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 5 vulnerabilities is now available.
Description:
The DBUS-1 service and libraries were updated to upstream release 1.6.24
fixing security issues and bugs.
Upstream changes since dbus 1.6.8
+ Security fixes
- Do not accept an extra fd in the padding of a cmsg message, which
could lead to a 4-byte heap buffer overrun. (CVE-2014-3635,
fdo#83622; Simon McVittie)
- Reduce default for maximum Unix file descriptors passed per message
from 1024 to 16, preventing a uid with the default maximum number of
connections from exhausting the system bus' file descriptors under
Linux's default rlimit. Distributors or system administrators with a
more restrictive fd limit may wish to reduce these limits further.
Additionally, on Linux this prevents a second denial of service in
which the dbus-daemon can be made to exceed the maximum number of
fds per sendmsg() and disconnect the process that would have
received them. (CVE-2014-3636, fdo#82820; Alban Crequy)
- Disconnect connections that still have a fd pending unmarshalling
after a new configurable limit, pending\_fd\_timeout (defaulting to
150 seconds), removing the possibility of creating an abusive
connection that cannot be disconnected by setting up a circular
reference to a connection's file descriptor. (CVE-2014-3637,
fdo#80559; Alban Crequy)
- Reduce default for maximum pending replies per connection from 8192
to 128, mitigating an algorithmic complexity denial-of-service
attack (CVE-2014-3638, fdo#81053; Alban Crequy)
- Reduce default for authentication timeout on the system bus from 30
seconds to 5 seconds, avoiding denial of service by using up all
unauthenticated connection slots; and when all unauthenticated
connection slots are used up, make new connection attempts block
instead of disconnecting them. (CVE-2014-3639, fdo#80919; Alban
Crequy)
- On Linux >= 2.6.37-rc4, if sendmsg() fails with ETOOMANYREFS,
silently drop the message. This prevents an attack in which a
malicious client can make dbus-daemon disconnect a system service,
which is a local denial of service. (fdo#80163, CVE-2014-3532; Alban
Crequy)
- Track remaining Unix file descriptors correctly when more than one
message in quick succession contains fds. This prevents another
attack which a malicious client can make dbus-daemon disconnect a
system service. (fdo#79694, fdo#80469, CVE-2014-3533; Alejandro
Martínez Suárez, Simon McVittie, Alban Crequy)
- Alban Crequy at Collabora Ltd. discovered and fixed a
denial-of-service flaw in dbus-daemon, part of the reference
implementation of D-Bus. Additionally, in highly unusual
environments the same flaw could lead to a side channel between
processes that should not be able to communicate. (CVE-2014-3477,
fdo#78979)
- CVE-2013-2168: Fix misuse of va\_list that could be used as a denial
of service for system services. Vulnerability reported by Alexandru
Cornea. (Simon)
+ Other fixes
- Don't leak memory on out-of-memory while listing activatable or
active services (fdo#71526, Radoslaw Pajak)
- fix undefined behaviour in a regression test (fdo#69924, DreamNik)
- path\_namespace='/' in match rules incorrectly matched nothing; it
now matches everything. (fdo#70799, Simon McVittie)
- Make dbus\_connection\_set\_route\_peer\_messages(x, FALSE) behave as
documented. Previously, it assumed its second parameter was TRUE.
(fdo#69165, Chengwei Yang)
- Fix a NULL pointer dereference on an unlikely error path (fdo#69327,
Sviatoslav Chagaev)
- If accept4() fails with EINVAL, as it can on older Linux kernels
with newer glibc, try accept() instead of going into a busy-loop.
(fdo#69026, Chengwei Yang)
- If socket() or socketpair() fails with EINVAL or EPROTOTYPE, for
instance on Hurd or older Linux with a new glibc, try without
SOCK\_CLOEXEC. (fdo#69073; Pino Toscano, Chengwei Yang)
- Fix a file descriptor leak on an error code path. (fdo#69182,
Sviatoslav Chagaev)
- Fix compilation if writev() is unavailable (fdo#69409, Vasiliy
Balyasnyy)
- Avoid an infinite busy-loop if a signal interrupts waitpid()
(fdo#68945, Simon McVittie)
- Escape addresses containing non-ASCII characters correctly
(fdo#53499, Chengwei Yang)
- If malloc() returns NULL in \_dbus\_string\_init() or similar, don't
free an invalid pointer if the string is later freed (fdo#65959,
Chengwei Yang)
- If malloc() returns NULL in dbus\_set\_error(), don't va\_end() a
va\_list that was never va\_start()ed (fdo#66300, Chengwei Yang)
- Fix a regression test on platforms with strict alignment (fdo#67279,
Colin Walters)
- Avoid calling function parameters "interface" since certain Windows
headers have a namespace-polluting macro of that name (fdo#66493,
Ivan Romanov)
- Make "make -j check" work (fdo#68852, Simon McVittie)
- In dbus-daemon, don't crash if a .service file starts with key=value
(fdo#60853, Chengwei Yang)
- Fix an assertion failure if we try to activate systemd services
before systemd connects to the bus (fdo#50199, Chengwei Yang)
- Avoid compiler warnings for ignoring the return from write()
(Chengwei Yang)
- Following Unicode Corrigendum #9, the noncharacters U+nFFFE,
U+nFFFF, U+FDD0..U+FDEF are allowed in UTF-8 strings again.
(fdo#63072, Simon McVittie)
- Diagnose incorrect use of dbus\_connection\_get\_data() with negative
slot (i.e. before allocating the slot) rather than returning junk
(fdo#63127, Dan Williams)
- In the activation helper, when compiled for tests, do not reset the
system bus address, fixing the regression tests. (fdo#52202, Simon)
- Fix building with Valgrind 3.8, at the cost of causing harmless
warnings with Valgrind 3.6 on some compilers (fdo#55932, Arun
Raghavan)
- Don't leak temporary fds pointing to /dev/null (fdo#56927, Michel
HERMIER)
- Create session.d, system.d directories under CMake (fdo#41319, Ralf
Habacker)
- Include alloca.h for alloca() if available, fixing compilation on
Solaris 10 (fdo#63071, Dagobert Michelsen)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2014-557
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
dbus-1-1.6.24-2.26.1
dbus-1-debuginfo-1.6.24-2.26.1
dbus-1-debugsource-1.6.24-2.26.1
dbus-1-devel-1.6.24-2.26.1
dbus-1-x11-1.6.24-2.26.1
dbus-1-x11-debuginfo-1.6.24-2.26.1
dbus-1-x11-debugsource-1.6.24-2.26.1
libdbus-1-3-1.6.24-2.26.1
libdbus-1-3-debuginfo-1.6.24-2.26.1
- openSUSE 12.3 (x86\_64):
dbus-1-32bit-1.6.24-2.26.1
dbus-1-debuginfo-32bit-1.6.24-2.26.1
dbus-1-devel-32bit-1.6.24-2.26.1
libdbus-1-3-32bit-1.6.24-2.26.1
libdbus-1-3-debuginfo-32bit-1.6.24-2.26.1
- openSUSE 12.3 (noarch):
dbus-1-devel-doc-1.6.24-2.26.1
References:
<http://support.novell.com/security/cve/CVE-2014-3635.html>
<http://support.novell.com/security/cve/CVE-2014-3636.html>
<http://support.novell.com/security/cve/CVE-2014-3637.html>
<http://support.novell.com/security/cve/CVE-2014-3638.html>
<http://support.novell.com/security/cve/CVE-2014-3639.html>
<https://bugzilla.suse.com/show_bug.cgi?id=896453>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.openwall.com_7f8f714c_20250125_202307.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](12) [[next>]](14) [[<thread-prev]](12) [[thread-next>]](14) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20190624193048.GA8039@espresso.pseudorandom.co.uk>
Date: Mon, 24 Jun 2019 20:30:48 +0100
From: Simon McVittie <smcv@...ian.org>
To: oss-security@...ts.openwall.com
Subject: Re: Thousands of vulnerabilities, almost no CVEs:
 OSS-Fuzz

On Mon, 24 Jun 2019 at 13:00:28 -0400, David A. Wheeler wrote:
> In particular, many organizations have a rapid upgrade process
> if some software version has a CVE, and a slow process otherwise.
> (There are things that need doing besides upgrading software.)
> If a particular version of software has a serious vulnerability, it needs at least one
> of the most serious vulnerabilities assigned a CVE so that people will upgrade
> it more rapidly.

I think you might have also been implying this, but just to say it
explicitly: if a particular version of software has lots of fixed bugs,
but they are not exploitable vulnerabilities in practice, then it would
be counterproductive to try to fast-track upgrades (trick people into
using their rapid upgrade process) by assigning CVE IDs to those bugs.

Fast-tracking upgrades of packages with CVE fixes is only going to happen
as long as it's still a rational strategy for balancing vulnerability
exposure against the risk of regressions. If lots of CVE IDs get assigned
to issues that aren't exploitable in the real world, then that will teach
consumers of software that they can safely ignore "most" CVEs, which
will tend to result in some issues that *are* exploitable being missed
and not fixed on deployed systems. Everyone loses (except attackers).

This is a particularly interesting trade-off for denial-of-service
vulnerabilities, because regressions caused by flawed fixes for
vulnerabilities often cause denial of service. (This is often a crash,
but not necessarily - addressing local DoS vulnerability CVE-2014-3637
in dbus led to some machines not booting reliably, denying service to
rather more people than the original vulnerability.)

In the worst case, a flawed fix for a vulnerability might contain a
regression that is a more serious vulnerability.

    smcv

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_96dedf0e_20250125_202307.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](13) [[next>]](../../../2019/06/25/1) [[<thread-prev]](13) [[thread-next>]](../../../2019/06/25/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAFRnB2XeQ-casQLm0MRCdRmQ5aeF9K=X3Km5eYg9DB6A915d5A@mail.gmail.com>
Date: Mon, 24 Jun 2019 19:15:20 -0400
From: Alex Gaynor <alex.gaynor@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: Thousands of vulnerabilities, almost no CVEs: OSS-Fuzz

I figured it'd be useful to summarize the themes I think I'm hearing:

- Greater automation around requesting CVEs so that when there really are a
lot of vulnerabilities they can be requested easily and have most of the
details filled in by automatic systems like syzbot of ClusterFuzz.
- Better automation around assessing exploitability -- I confess this one
sounds very hard to me, at least without requiring more user involvement
than ASAN requires right now. This seems like a very cool area for academic
research though!
- Not having sooooo many vulnerabilities. While there's some dispute over
just what % of the bugs that OSS-Fuzz and syzbot turn up are exploitable,
there's no doubt that they find a _lot_ of them. Even if only 20% of
OSS-Fuzz reports were truly exploitable vulnerabilities, that'd still be
>600 of them. We can't produce this many vulnerabilities and then try to
clean up afterwards by finding them with fuzzing -- at some point the
number of vulnerabilities simply overwhelms us. Tactics for reducing
vulnerabilities in the first instance, like memory safe languages, are an
important part of making this problem tractable.

Do folks feel like there were important themes that this misses?

All of these seem actionable, in their own way, which I like.

Alex

On Mon, Jun 24, 2019 at 3:32 PM Simon McVittie <smcv@...ian.org> wrote:

> On Mon, 24 Jun 2019 at 13:00:28 -0400, David A. Wheeler wrote:
> > In particular, many organizations have a rapid upgrade process
> > if some software version has a CVE, and a slow process otherwise.
> > (There are things that need doing besides upgrading software.)
> > If a particular version of software has a serious vulnerability, it
> needs at least one
> > of the most serious vulnerabilities assigned a CVE so that people will
> upgrade
> > it more rapidly.
>
> I think you might have also been implying this, but just to say it
> explicitly: if a particular version of software has lots of fixed bugs,
> but they are not exploitable vulnerabilities in practice, then it would
> be counterproductive to try to fast-track upgrades (trick people into
> using their rapid upgrade process) by assigning CVE IDs to those bugs.
>
> Fast-tracking upgrades of packages with CVE fixes is only going to happen
> as long as it's still a rational strategy for balancing vulnerability
> exposure against the risk of regressions. If lots of CVE IDs get assigned
> to issues that aren't exploitable in the real world, then that will teach
> consumers of software that they can safely ignore "most" CVEs, which
> will tend to result in some issues that *are* exploitable being missed
> and not fixed on deployed systems. Everyone loses (except attackers).
>
> This is a particularly interesting trade-off for denial-of-service
> vulnerabilities, because regressions caused by flawed fixes for
> vulnerabilities often cause denial of service. (This is often a crash,
> but not necessarily - addressing local DoS vulnerability CVE-2014-3637
> in dbus led to some machines not booting reliably, denying service to
> rather more people than the original vulnerability.)
>
> In the worst case, a flawed fix for a vulnerability might contain a
> regression that is a more serious vulnerability.
>
>     smcv
>

--
All that is necessary for evil to succeed is for good people to do nothing.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.suse.com_da5358c8_20250126_114144.html ===


| Bugzilla – Bug 896453 | VUL-0: CVE-2014-3635 - CVE-2014-3639: dbus-1: various denial of service issues in fd passing | Last modified: 2014-11-06 17:59:17 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D896453)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 896453**](show_bug.cgi?id=896453)
(CVE-2014-3635)
- VUL-0: CVE-2014-3635 - CVE-2014-3639: dbus-1: various denial of service issues in fd passing

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2014-3635 - CVE-2014-3639: dbus-1: various denial of service issue...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-3635 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Major | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Deadline](page.cgi?id=fields.html#deadline): | 2014-09-19 | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Fridrich Strba | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | maint:released:sle10-sp3:58973 maint:... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-09-12 11:53 UTC by Marcus Meissner | | --- | --- | | Modified: | 2014-11-06 17:59 UTC ([History](show_activity.cgi?id=896453)) | | CC List: | 3 users (show)  jsegitz meissner security-team | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=896453) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**0001-system-bus-limit-use-max\_replies\_per\_connection-128-.patch**](attachment.cgi?id=606138 "View the content of the attachment") (938 bytes, patch)  [2014-09-12 11:54 UTC](#attach_606138 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606138&action=edit) | [Diff](attachment.cgi?id=606138&action=diff) | | [**0002-config-reduce-DEFAULT\_MESSAGE\_UNIX\_FDS-to-16.patch**](attachment.cgi?id=606139 "View the content of the attachment") (3.56 KB, patch)  [2014-09-12 11:54 UTC](#attach_606139 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606139&action=edit) | [Diff](attachment.cgi?id=606139&action=diff) | | [**0003-config-change-default-auth\_timeout-to-5-seconds.patch**](attachment.cgi?id=606140 "View the content of the attachment") (1.19 KB, patch)  [2014-09-12 11:55 UTC](#attach_606140 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606140&action=edit) | [Diff](attachment.cgi?id=606140&action=diff) | | [**0004-Stop-listening-on-DBusServer-sockets-when-reaching-m.patch**](attachment.cgi?id=606141 "View the content of the attachment") (11.55 KB, patch)  [2014-09-12 11:55 UTC](#attach_606141 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606141&action=edit) | [Diff](attachment.cgi?id=606141&action=diff) | | [**0005-config-add-new-limit-pending\_fd\_timeout.patch**](attachment.cgi?id=606142 "View the content of the attachment") (5.87 KB, patch)  [2014-09-12 11:56 UTC](#attach_606142 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606142&action=edit) | [Diff](attachment.cgi?id=606142&action=diff) | | [**0006-DBusConnection-implements-\_dbus\_connection\_get\_pendi.patch**](attachment.cgi?id=606143 "View the content of the attachment") (4.76 KB, patch)  [2014-09-12 11:56 UTC](#attach_606143 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606143&action=edit) | [Diff](attachment.cgi?id=606143&action=diff) | | [**0007-DBusConnection-implements-\_dbus\_connection\_set\_pendi.patch**](attachment.cgi?id=606144 "View the content of the attachment") (8.21 KB, patch)  [2014-09-12 11:57 UTC](#attach_606144 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606144&action=edit) | [Diff](attachment.cgi?id=606144&action=diff) | | [**0008-bus-enforce-pending\_fd\_timeout.patch**](attachment.cgi?id=606145 "View the content of the attachment") (4.69 KB, patch)  [2014-09-12 11:57 UTC](#attach_606145 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606145&action=edit) | [Diff](attachment.cgi?id=606145&action=diff) | | [**0009-Add-\_DBUS\_GNUC\_UNUSED-and-use-it-in-\_DBUS\_STATIC\_ASS.patch**](attachment.cgi?id=606146 "View the content of the attachment") (1.62 KB, patch)  [2014-09-12 11:57 UTC](#attach_606146 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606146&action=edit) | [Diff](attachment.cgi?id=606146&action=diff) | | [**0010-\_dbus\_read\_socket\_with\_unix\_fds-do-not-accept-extra-.patch**](attachment.cgi?id=606147 "View the content of the attachment") (4.24 KB, patch)  [2014-09-12 11:58 UTC](#attach_606147 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606147&action=edit) | [Diff](attachment.cgi?id=606147&action=diff) | | [**0011-New-test-for-fd-passing.patch**](attachment.cgi?id=606148 "View the content of the attachment") (28.93 KB, patch)  [2014-09-12 11:58 UTC](#attach_606148 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606148&action=edit) | [Diff](attachment.cgi?id=606148&action=diff) | | [**0011-New-test-for-fd-passing.patch**](attachment.cgi?id=606149 "View the content of the attachment") (28.84 KB, patch)  [2014-09-12 12:00 UTC](#attach_606149 "Go to the comment associated with the attachment"), Marcus Meissner | [Details](attachment.cgi?id=606149&action=edit) | [Diff](attachment.cgi?id=606149&action=diff) | | [View All](attachment.cgi?bugid=896453&action=viewall)  [Add an attachment](attachment.cgi?bugid=896453&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=896453&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=896453#c0)  Marcus Meissner   2014-09-12 11:53:36 UTC  ``` EMBARGOED, via distros  From: Simon McVittie <simon.mcvittie@collabora.co.uk> Date: Tue, 09 Sep 2014 19:49:06 +0100 Subject: [vs-plain] CVE request for some D-Bus DoS fixes  Hello distro security people,  We would like however many CVE IDs are felt to be appropriate for the vulnerabilities described below, probably at least 2 (one for the file descriptor passing issues that were introduced in 1.3.0, and one for older issues). We intend to fix them all in the same dbus release. Proposed unembargo date: Tuesday 16th September, timing tbd.  The referenced bugs on freedesktop.org are embargoed and non-public. If distro security contacts or dbus maintainers would like access, please open a freedesktop.org Bugzilla account if you don't already have one, and tell me its associated address by private email.  Bugs listed in approximately descending order of worst-case severity.  A preliminary version of the fixes is attached. Patch 0009 and 0011 are non-essential: 0009 silences a compiler warning in 0010, and 0011 adds a regression test.  Thanks,     S  ----8<----  D-Bus <<http://www.freedesktop.org/wiki/Software/dbus/>> is an asynchronous inter-process communication system, commonly used for system services or within a desktop session on Linux and other operating systems.  Alban Crequy and Simon McVittie at Collabora Ltd. discovered and fixed several denial-of-service flaws in the reference implementation of dbus-daemon, the D-Bus message bus daemon. fd.o #83622 could conceivably also be exploitable to alter data or executable code, but we do not believe that this is likely.  fd.o #83622 -----------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=83622> Credit: discovered and fixed by Simon McVittie Impact: denial of service, possibly heap data corruption Access required: local Mitigation: only unusual configurations are vulnerable Versions believed to be vulnerable: dbus >= 1.3.0  When using the default Unix-socket-based transport, dbus-daemon accepts and forwards file descriptors (fds) attached to D-Bus messages ("fd-passing"). If the max_message_unix_fds limit is set to an odd number on 64-bit platforms, a malicious message-sender could pass one more fd through the kernel than the recipient is expecting. This causes an assertion failure and dbus-daemon crash if assertions are enabled, or a buffer overrun by sizeof (int) otherwise.  We do not believe that the buffer overrun can be exploited to alter data or execute arbitrary code in practice, because the buffer that is overrun is allocated with libc realloc(), which typically rounds up odd allocations to a multiple of 8 bytes. This would mean that the overrun could not actually leave the allocated buffer.  This has been resolved by passing the desired maximum size to the syscall instead of the rounded-up size of the cmsg buffer, and discarding any excess fds if the syscall fills the cmsg buffer anyway.  fd.o#82820, part A ------------------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=82820> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: dbus >= 1.3.0  The default limits for the system bus allowed each uid to open 256 connections to the system bus, and allowed up to 1024 fds per message, and up to 4096 fds queued in total on each connection.  By queuing up the maximum allowed number of fds, a malicious sender could reach the dbus-daemon's RLIMIT_NOFILE (ulimit -n, typically 65536 on Linux). This would act as a denial of service in two ways:  * new clients would be unable to connect to the dbus-daemon * when receiving a subsequent message from a non-malicious client that   contained a fd, dbus-daemon would receive the MSG_CTRUNC flag,   indicating that the list of fds was truncated; kernel fd-passing APIs   do not provide any way to recover from that, so dbus-daemon responds   to MSG_CTRUNC by disconnecting the sender, causing denial of service   to that sender  This has been resolved by changing the defaults so up to 16 fds are allowed per message, and up to 64 on each connection. This means that each uid can only queue up to 16384 fds, and denial of service is only possible if several uids cooperate.  Since this limit might be changed further in future, the D-Bus maintainers recommend that designers of D-Bus APIs, particularly on the system bus, do not rely on being able to send more than one fd per message.  Distributors on operating systems with a smaller default RLIMIT_NOFILE should consider adjusting either that limit, or the defaults in system.conf. fd.o#82820, part B ------------------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=82820> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: dbus >= 1.3.0  Linux allows up to 253 fds to be sent in a single sendmsg() call; libdbus always sends all of a message's fds, and the beginning of the message itself, in a single sendmsg() call. Combining these two, a malicious sender could split a message across two or more sendmsg() calls to construct a composite message with 254 or more fds. When dbus-daemon attempted to relay that message to its recipient in a single sendmsg() call, it would receive EINVAL, interpret that as a fatal socket error and disconnect the recipient, resulting in denial of service.  This has been resolved by the same change as fd.o #82820, part A.  fd.o#80559 ----------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80559> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: dbus >= 1.3.0  By attaching the file descriptor of a D-Bus connection to a D-Bus message and sending that message via the dbus-daemon, a malicious process can create D-Bus connections that persist after the process that created them has terminated. This exacerbates various patterns of undesirable/abusive behaviour by making it impossible to terminate them by killing processes.  This has been addressed by closing any connection that has incoming file descriptors queued for deserialization for more than a configurable timeout, defaulting to 2.5 minutes.  fd.o#81053 ----------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=81053> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: all dbus releases  dbus-daemon tracks whether method call messages expect a reply, so that unsolicited replies can be dropped. As currently implemented, if there are n parallel method calls in progress, each method reply takes O(n) CPU time. A malicious user can exploit this by opening the maximum allowed number of parallel connections and sending the maximum number of parallel method calls on each one, causing subsequent method calls to be unreasonably slow, a denial of service.  For the short term, this has been resolved by amending the default system bus configuration to reduce the number of parallel method calls allowed per connection, from 8192 to 128 (i.e. from 2097152 to 32768 per uid).  Longer-term, we plan to use better data structures to make dbus-daemon more scalable, but this was not felt to be suitable for a minimal security patch.  fd.o#80919 ----------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80919> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: all dbus releases  dbus-daemon allows a small number of "incomplete" connections (64 by default) whose identity has not yet been confirmed. When this limit has been reached, subsequent connections are dropped. Alban's testing indicates that one malicious process that makes repeated connection attempts, but never completes the authentication handshake and instead waits for dbus-daemon to time out and disconnect it, can cause the majority of legitimate connection attempts to fail.  This has been resolved by reducing the default authentication timeout from 30 seconds to 5 seconds, and pausing calls to accept() when the maximum number of incomplete connections is reached, resulting in subsequent connections being queued in the kernel (blocking in connect()) instead of being dropped.  ----8<---- ``` [Comment 1](show_bug.cgi?id=896453#c1)  Marcus Meissner   2014-09-12 11:54:20 UTC  ``` Created [attachment 606138](attachment.cgi?id=606138&action=diff "0001-system-bus-limit-use-max_replies_per_connection-128-.patch") [[details]](attachment.cgi?id=606138&action=edit "0001-system-bus-limit-use-max_replies_per_connection-128-.patch") 0001-system-bus-limit-use-max_replies_per_connection-128-.patch  0001-system-bus-limit-use-max_replies_per_connection-128-.patch ``` [Comment 2](show_bug.cgi?id=896453#c2)  Marcus Meissner   2014-09-12 11:54:51 UTC  ``` Created [attachment 606139](attachment.cgi?id=606139&action=diff "0002-config-reduce-DEFAULT_MESSAGE_UNIX_FDS-to-16.patch") [[details]](attachment.cgi?id=606139&action=edit "0002-config-reduce-DEFAULT_MESSAGE_UNIX_FDS-to-16.patch") 0002-config-reduce-DEFAULT_MESSAGE_UNIX_FDS-to-16.patch  0002-config-reduce-DEFAULT_MESSAGE_UNIX_FDS-to-16.patch ``` [Comment 3](show_bug.cgi?id=896453#c3)  Marcus Meissner   2014-09-12 11:55:14 UTC  ``` Created [attachment 606140](attachment.cgi?id=606140&action=diff "0003-config-change-default-auth_timeout-to-5-seconds.patch") [[details]](attachment.cgi?id=606140&action=edit "0003-config-change-default-auth_timeout-to-5-seconds.patch") 0003-config-change-default-auth_timeout-to-5-seconds.patch  0003-config-change-default-auth_timeout-to-5-seconds.patch ``` [Comment 4](show_bug.cgi?id=896453#c4)  Marcus Meissner   2014-09-12 11:55:37 UTC  ``` Created [attachment 606141](attachment.cgi?id=606141&action=diff "0004-Stop-listening-on-DBusServer-sockets-when-reaching-m.patch") [[details]](attachment.cgi?id=606141&action=edit "0004-Stop-listening-on-DBusServer-sockets-when-reaching-m.patch") 0004-Stop-listening-on-DBusServer-sockets-when-reaching-m.patch  0004-Stop-listening-on-DBusServer-sockets-when-reaching-m.patch ``` [Comment 5](show_bug.cgi?id=896453#c5)  Marcus Meissner   2014-09-12 11:56:25 UTC  ``` Created [attachment 606142](attachment.cgi?id=606142&action=diff "0005-config-add-new-limit-pending_fd_timeout.patch") [[details]](attachment.cgi?id=606142&action=edit "0005-config-add-new-limit-pending_fd_timeout.patch") 0005-config-add-new-limit-pending_fd_timeout.patch  0005-config-add-new-limit-pending_fd_timeout.patch ``` [Comment 6](show_bug.cgi?id=896453#c6)  Marcus Meissner   2014-09-12 11:56:52 UTC  ``` Created [attachment 606143](attachment.cgi?id=606143&action=diff "0006-DBusConnection-implements-_dbus_connection_get_pendi.patch") [[details]](attachment.cgi?id=606143&action=edit "0006-DBusConnection-implements-_dbus_connection_get_pendi.patch") 0006-DBusConnection-implements-_dbus_connection_get_pendi.patch ``` [Comment 7](show_bug.cgi?id=896453#c7)  Marcus Meissner   2014-09-12 11:57:19 UTC  ``` Created [attachment 606144](attachment.cgi?id=606144&action=diff "0007-DBusConnection-implements-_dbus_connection_set_pendi.patch") [[details]](attachment.cgi?id=606144&action=edit "0007-DBusConnection-implements-_dbus_connection_set_pendi.patch") 0007-DBusConnection-implements-_dbus_connection_set_pendi.patch ``` [Comment 8](show_bug.cgi?id=896453#c8)  Marcus Meissner   2014-09-12 11:57:36 UTC  ``` Created [attachment 606145](attachment.cgi?id=606145&action=diff "0008-bus-enforce-pending_fd_timeout.patch") [[details]](attachment.cgi?id=606145&action=edit "0008-bus-enforce-pending_fd_timeout.patch") 0008-bus-enforce-pending_fd_timeout.patch ``` [Comment 9](show_bug.cgi?id=896453#c9)  Marcus Meissner   2014-09-12 11:57:56 UTC  ``` Created [attachment 606146](attachment.cgi?id=606146&action=diff "0009-Add-_DBUS_GNUC_UNUSED-and-use-it-in-_DBUS_STATIC_ASS.patch") [[details]](attachment.cgi?id=606146&action=edit "0009-Add-_DBUS_GNUC_UNUSED-and-use-it-in-_DBUS_STATIC_ASS.patch") 0009-Add-_DBUS_GNUC_UNUSED-and-use-it-in-_DBUS_STATIC_ASS.patch ``` [Comment 10](show_bug.cgi?id=896453#c10)  Marcus Meissner   2014-09-12 11:58:18 UTC  ``` Created [attachment 606147](attachment.cgi?id=606147&action=diff "0010-_dbus_read_socket_with_unix_fds-do-not-accept-extra-.patch") [[details]](attachment.cgi?id=606147&action=edit "0010-_dbus_read_socket_with_unix_fds-do-not-accept-extra-.patch") 0010-_dbus_read_socket_with_unix_fds-do-not-accept-extra-.patch ``` [Comment 11](show_bug.cgi?id=896453#c11)  Marcus Meissner   2014-09-12 11:58:41 UTC  ``` Created [attachment 606148](attachment.cgi?id=606148&action=diff "0011-New-test-for-fd-passing.patch") [[details]](attachment.cgi?id=606148&action=edit "0011-New-test-for-fd-passing.patch") 0011-New-test-for-fd-passing.patch ``` [Comment 12](show_bug.cgi?id=896453#c12)  Marcus Meissner   2014-09-12 12:00:49 UTC  ``` Created [attachment 606149](attachment.cgi?id=606149&action=diff "0011-New-test-for-fd-passing.patch") [[details]](attachment.cgi?id=606149&action=edit "0011-New-test-for-fd-passing.patch") 0011-New-test-for-fd-passing.patch  alternative 0011 version patch against dbus-1.8 ``` [Comment 15](show_bug.cgi?id=896453#c15)  Swamp Workflow Management   2014-09-12 12:57:39 UTC  ``` An update workflow for this issue was started. This issue was rated as important. Please submit fixed packages until 2014-09-19. When done, reassign the bug to security-team@suse.de. <https://swamp.suse.de/webswamp/wf/58958> ``` [Comment 16](show_bug.cgi?id=896453#c16)  SMASH SMASH   2014-09-12 13:00:15 UTC  ``` Affected packages:  SLE-10-SP3-TERADATA: dbus-1 SLE-11-SP3: dbus-1 SLE-11-SP3-PRODUCTS: dbus-1 SLE-11-SP3-UPTU: dbus-1 ``` [Comment 17](show_bug.cgi?id=896453#c17)  Swamp Workflow Management   2014-09-12 22:01:03 UTC  ``` bugbot adjusting priority ``` [Comment 19](show_bug.cgi?id=896453#c19)  Marcus Meissner   2014-09-15 10:47:26 UTC  ``` Apologies for the delay:  fd.o #83622 -----------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=83622> Credit: discovered and fixed by Simon McVittie Impact: denial of service, possibly heap data corruption Access required: local Mitigation: only unusual configurations are vulnerable Versions believed to be vulnerable: dbus >= 1.3.0  for 83622 please use CVE-2014-3635   fd.o#82820, part A ------------------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=82820> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: dbus >= 1.3.0  fd.o#82820, part B ------------------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=82820> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: dbus >= 1.3.0  82820 Part A and part B are merged please use CVE-2014-3636   fd.o#80559 ----------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80559> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: dbus >= 1.3.0  80559 please use CVE-2014-3637  fd.o#81053 ----------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=81053> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: all dbus releases  81053 please use CVE-2014-3638   fd.o#80919 ----------  Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80919> Credit: discovered and fixed by Alban Crequy Impact: denial of service Access required: local Versions believed to be vulnerable: all dbus releases  80919 please use CVE-2014-3639  ----8<---- ``` [Comment 25](show_bug.cgi?id=896453#c25)  Marcus Meissner   2014-09-16 21:11:07 UTC  ``` public now via oss-sec ``` [Comment 27](show_bug.cgi?id=896453#c27)  Swamp Workflow Management   2014-09-19 21:04:58 UTC  ``` SUSE-SU-2014:1146-1: An update that fixes one vulnerability is now available.  Category: security (important) Bug References: 896453 CVE References: CVE-2014-3638 Sources used: SUSE Linux Enterprise Software Development Kit 11 SP3 (src):    dbus-1-1.2.10-3.31.1 SUSE Linux Enterprise Server 11 SP3 for VMware (src):    dbus-1-1.2.10-3.31.1, dbus-1-x11-1.2.10-3.31.1 SUSE Linux Enterprise Server 11 SP3 (src):    dbus-1-1.2.10-3.31.1, dbus-1-x11-1.2.10-3.31.1 SUSE Linux Enterprise Desktop 11 SP3 (src):    dbus-1-1.2.10-3.31.1, dbus-1-x11-1.2.10-3.31.1 ``` [Comment 28](show_bug.cgi?id=896453#c28)  Swamp Workflow Management   2014-09-28 10:05:49 UTC  ``` openSUSE-SU-2014:1228-1: An update that fixes 6 vulnerabilities is now available.  Category: security (moderate) Bug References: 896453 CVE References: CVE-2012-3524,CVE-2014-3635,CVE-2014-3636,CVE-2014-3637,CVE-2014-3638,CVE-2014-3639 Sources used: openSUSE 13.1 (src):    dbus-1-1.8.8-4.20.1, dbus-1-x11-1.8.8-4.20.2 ``` [Comment 29](show_bug.cgi?id=896453#c29)  Swamp Workflow Management   2014-09-28 10:09:44 UTC  ``` openSUSE-SU-2014:1239-1: An update that fixes 5 vulnerabilities is now available.  Category: security (moderate) Bug References: 896453 CVE References: CVE-2014-3635,CVE-2014-3636,CVE-2014-3637,CVE-2014-3638,CVE-2014-3639 Sources used: openSUSE 12.3 (src):    dbus-1-1.6.24-2.26.1, dbus-1-x11-1.6.24-2.26.1 ``` [Comment 33](show_bug.cgi?id=896453#c33)  Fridrich Strba   2014-11-06 17:46:35 UTC  ``` As of the [comment #32](show_bug.cgi?id=896453#c32), closing this bug ``` [Comment 34](show_bug.cgi?id=896453#c34)  Fridrich Strba   2014-11-06 17:59:17 UTC  ``` As of the [comment #32](show_bug.cgi?id=896453#c32), closing this bug ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=896453)
* - [XML](show_bug.cgi?ctype=xml&id=896453)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=896453)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D896453)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from secunia.com_9f88b4ec_20250125_202301.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.openwall.com_e530aef7_20250125_202306.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <54185FAF.6010601@collabora.co.uk>
Date: Tue, 16 Sep 2014 17:05:03 +0100
From: Simon McVittie <simon.mcvittie@...labora.co.uk>
To: oss-security@...ts.openwall.com
Subject: CVE-2014-3635 to 3639: security issues in D-Bus < 1.8.8

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

D-Bus <<http://www.freedesktop.org/wiki/Software/dbus/>> is an
asynchronous inter-process communication system, commonly used
for system services or within a desktop session on Linux and other
operating systems.

Alban Crequy and Simon McVittie at Collabora Ltd. discovered and fixed
several security flaws in the reference implementation of
dbus-daemon, the D-Bus message bus daemon. fd.o #83622 is a heap
overflow and could potentially be exploited to alter data or executable
code; the rest are denial-of-service issues.

For the stable branch these are fixed in dbus 1.8.8.

For the old stable branch, these are fixed in dbus 1.6.24. Older
branches are not supported.

CVE-2014-3635 (fd.o #83622)
- ---------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=83622>
Category: CWE-805: Buffer Access with Incorrect Length Value
Impact: heap data corruption, worst-case: arbitrary code execution
Access required: local
Mitigation: 32-bit platforms are not vulnerable
Versions believed to be vulnerable: dbus >= 1.3.0
Credit: discovered and fixed by Simon McVittie

When using the default Unix-socket-based transport, dbus-daemon accepts
and forwards file descriptors (fds) attached to D-Bus messages
("fd-passing"). If the max_message_unix_fds limit is set to an odd
number on 64-bit platforms, a malicious message-sender could pass one
more fd through the kernel than the recipient is expecting. This causes
an assertion failure and dbus-daemon crash if assertions are enabled, or
a buffer overrun by sizeof (int) otherwise.

This has been resolved by passing the desired maximum size to the
syscall instead of the rounded-up size of the cmsg buffer, and
discarding any excess fds if the syscall fills the cmsg buffer anyway.

CVE-2014-3636 (fd.o#82820, parts A and B)
- -----------------------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=82820>
Category: CWE-774: Allocation of File Descriptors or Handles
Without Limits or Throttling
Impact: denial of service
Access required: local
Versions believed to be vulnerable: dbus >= 1.3.0
Credit: discovered and fixed by Alban Crequy

The default limits for the system bus allowed each uid to open 256
connections to the system bus, and allowed up to 1024 fds per message,
and up to 4096 fds queued in total on each connection.

(Part A) By queuing up the maximum allowed number of fds, a malicious
sender could reach the dbus-daemon's RLIMIT_NOFILE (ulimit -n, typically
65536 on Linux). This would act as a denial of service in two ways:

* new clients would be unable to connect to the dbus-daemon
* when receiving a subsequent message from a non-malicious client that
  contained a fd, dbus-daemon would receive the MSG_CTRUNC flag,
  indicating that the list of fds was truncated; kernel fd-passing APIs
  do not provide any way to recover from that, so dbus-daemon responds
  to MSG_CTRUNC by disconnecting the sender, causing denial of service
  to that sender

(Part B) Additionally, Linux allows up to 253 fds to be sent in a single
sendmsg() call; libdbus always sends all of a message's fds, and the
beginning of the message itself, in a single sendmsg() call. Combining
these two, a malicious sender could split a message across two or more
sendmsg() calls to construct a composite message with 254 or more fds.
When dbus-daemon attempted to relay that message to its
recipient in a single sendmsg() call, it would receive EINVAL,
interpret that as a fatal socket error and disconnect the recipient,
resulting in denial of service.

Both of these related issues have been resolved by changing the defaults
so up to 16 fds are allowed per message, and up to 64 on each
connection. This means that each uid can only queue up to 16384 fds, and
denial of service is only possible if several uids cooperate.

Since this limit might be changed further in future, the D-Bus
maintainers recommend that designers of D-Bus APIs, particularly on the
system bus, do not rely on being able to send more than one fd per
message.

Distributors on operating systems with a smaller default RLIMIT_NOFILE
should consider adjusting either that limit, or the defaults in
system.conf.

CVE-2014-3637 (fd.o#80559)
- --------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80559>
Category: CWE-775: Missing Release of File Descriptor or Handle after
Effective Lifetime
Impact: denial of service
Access required: local
Versions believed to be vulnerable: dbus >= 1.3.0
Credit: discovered and fixed by Alban Crequy

By attaching the file descriptor of a D-Bus connection to a D-Bus
message and sending that message via the dbus-daemon, a malicious
process can create D-Bus connections that persist after the process that
created them has terminated. This exacerbates various patterns of
undesirable/abusive behaviour by making it impossible to terminate them
by killing processes.

This has been addressed by closing any connection that has incoming file
descriptors queued for deserialization for more than a configurable
timeout, defaulting to 2.5 minutes.

CVE-2014-3638 (fd.o#81053)
- --------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=81053>
Category: CWE-407: Algorithmic Complexity
Impact: denial of service
Access required: local
Versions believed to be vulnerable: all dbus releases
Credit: discovered and fixed by Alban Crequy

dbus-daemon tracks whether method call messages expect a reply, so that
unsolicited replies can be dropped. As currently implemented, if there
are n parallel method calls in progress, each method reply takes O(n)
CPU time. A malicious user can exploit this by opening the maximum
allowed number of parallel connections and sending the maximum number of
parallel method calls on each one, causing subsequent method calls to be
unreasonably slow, a denial of service.

For the short term, this has been resolved by amending the default
system bus configuration to reduce the number of parallel method calls
allowed per connection, from 8192 to 128 (i.e. from 2097152 to 32768 per
uid).

Longer-term, we plan to use better data structures to make dbus-daemon
more scalable, but this was not felt to be suitable for a minimal
security patch.

CVE-2014-3639 (fd.o#80919)
- --------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80919>
Category: CWE-774: Allocation of File Descriptors or Handles Without
Limits or Throttling
Impact: denial of service
Access required: local
Versions believed to be vulnerable: all dbus releases
Credit: discovered and fixed by Alban Crequy

dbus-daemon allows a small number of "incomplete" connections (64 by
default) whose identity has not yet been confirmed. When this limit has
been reached, subsequent connections are dropped. Alban's testing
indicates that one malicious process that makes repeated connection
attempts, but never completes the authentication handshake and instead
waits for dbus-daemon to time out and disconnect it, can cause the
majority of legitimate connection attempts to fail.

This has been resolved by reducing the default authentication timeout
from 30 seconds to 5 seconds, and pausing calls to accept() when the
maximum number of incomplete connections is reached, resulting in
subsequent connections being queued in the kernel (blocking in
connect()) instead of being dropped.

- --
Simon McVittie, Collabora Ltd.
on behalf of the D-Bus maintainers

-----BEGIN PGP SIGNATURE-----

iQIVAwUBVBhfoE3o/ypjx8yQAQiqjw//T5IZyg8ZTzJZWybeZfaSCkLymcYf+7rf
uCavmRs507UtDhqRkd0cuFuM0GdEZVRQsFp4jiDOyZTPLr6SWmZJuBisHBzlFsTd
1zwX72mZL5rYEvkIgnq22Jhs0RHg50Ok+tL8Ld8Lcdhm2SR4SnCubGoV+pwmid5+
1rjBZc3/YVJ38vMPJDddYKfMidIdprnbpkGtq2jP+IVZFBab2VcHY5I6oB9OzKF/
EyT4a760TJOug5aAT5Yog++lvZ+UoRf7QOLlsvgARi8HHY7rWXikbs1/Eh3I2O//
3YadlgrsgibnmnCNYMCSKaR806FaUPD9AYe0G6u8AAcOKvMBg531RSMlENkmPOW5
WklMyCyfIFMJeOFdc6Vc6G3fAaSc9KX3pbJPVb7cfnuzHWhRnye3quHo1pEWP6EL
liFBDAtRg51EaD6bMgAEvsFkUSPEltMX2i0piQ7Uh6vTXTJvndq2APlW1w8hHKKn
MoJ/z1IEwCdYD34H48ddvJZptvZgbEGnTXxhQcs23kKvWt8vYnnidKbvWxctchmC
EvPv+6Clpnyp5cSkK0UJPxV1Bcc3rzsNK+JX5HMbSadoxwOBYj2efEdedqJ0ZapZ
430xawijqcFp9jB+tEztGyK/gnHclIUKeFyawCh2DQqGsoD9tSaHYeFz3C8SxssV
hnPsLAl1KbI=
=U6YK
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_232d5a33_20250125_202303.html ===


---

[[Date Prev](msg00212.html)][[Date Next](msg00214.html)]
[[Thread Prev](msg00212.html)][[Thread Next](msg00214.html)]
[[Date Index](maillist.html#00213)]
[[Thread Index](threads.html#00213)]

# [SECURITY] [DSA 3026-1] dbus security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3026-1] dbus security update
* *From*: Florian Weimer <fw@deneb.enyo.de>
* *Date*: Tue, 16 Sep 2014 20:34:09 +0200
* *Message-id*: <[[🔎]](/msgid-search/87bnqf9zz2.fsf%40mid.deneb.enyo.de) [87bnqf9zz2.fsf@mid.deneb.enyo.de](msg00213.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3026-1                   security@debian.org
<http://www.debian.org/security/>                            Florian Weimer
September 16, 2014                     <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dbus
CVE ID         : CVE-2014-3635 CVE-2014-3636 CVE-2014-3637 CVE-2014-3638
                 CVE-2014-3639

Alban Crequy and Simon McVittie discovered several vulnerabilities in
the D-Bus message daemon.

CVE-2014-3635

    On 64-bit platforms, file descriptor passing could be abused by
    local users to cause heap corruption in the dbus-daemon crash,
    leading to a crash, or potentially to arbitrary code execution.

CVE-2014-3636

    A denial-of-service vulnerability in dbus-daemon allowed local
    attackers to prevent new connections to dbus-daemon, or disconnect
    existing clients, by exhausting descriptor limits.

CVE-2014-3637

    Malicious local users could create D-Bus connections to
    dbus-daemon which could not be terminated by killing the
    participating processes, resulting in a denial-of-service
    vulnerability.

CVE-2014-3638

    dbus-daemon suffered from a denial-of-service vulnerability in the
    code which tracks which messages expect a reply, allowing local
    attackers to reduce the performance of dbus-daemon.

CVE-2014-3639

    dbus-daemon did not properly reject malicious connections from
    local users, resulting in a denial-of-service vulnerability.

For the stable distribution (wheezy), these problems have been fixed in
version 1.6.8-1+deb7u4.

For the unstable distribution (sid), these problems have been fixed in
version 1.8.8-1.

We recommend that you upgrade your dbus packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJUGIrzAAoJEL97/wQC1SS+bgAH/2v7suJ3q6QQ9r8dpK3wlYtC
n6DrrqHvzECB0oEro51cvkHY9cl8HSYlKZoRXdbluEaHGCu+8f/IZ0aQIC2hkz1e
Cqh62l4Gzo+CZRmnDk4oTi2PcqnEXkIJgOo7pEDT4C9+4c5sF+vbLkAJ+x4VoRbf
eneYNgwIPGh8pyvw9VrMzTJAE81j5fZC5g6jxFfQCCOfo6IZlxKhn+d5XCElDz1f
yO4oeczxOkH0oHUo0Jo6Kd2RllbTbO9F+f2PVTOPRAvr1yqEj1zRtll0kA2vXZ0p
13pcZd3F/AWYDF8O5slOPZulx8GmVDETir2Jd8bPCduv7C4DPN9x8MA2IoYV668=
=Cvxc
-----END PGP SIGNATURE-----

```

---



=== Content from advisories.mageia.org_73bc190f_20250125_202258.html ===

# [Advisories](index.html) » MGASA-2014-0395

## Updated dbus packages fix multiple security vulnerabilities

Publication date: 07 Oct 2014

Modification date: 07 Oct 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-3635](CVE-2014-3635.html)
,
[CVE-2014-3636](CVE-2014-3636.html)
,
[CVE-2014-3637](CVE-2014-3637.html)
,
[CVE-2014-3638](CVE-2014-3638.html)
,
[CVE-2014-3639](CVE-2014-3639.html)

## Description

```
Updated dbus packages fixes the following security issues:

Alban Crequy and Simon McVittie discovered several vulnerabilities in the
D-Bus message daemon:

On 64-bit platforms, file descriptor passing could be abused by local users
to cause heap corruption in dbus-daemon, leading to a crash, or potentially
to arbitrary code execution (CVE-2014-3635).

A denial-of-service vulnerability in dbus-daemon allowed local attackers to
prevent new connections to dbus-daemon, or disconnect existing clients, by
exhausting descriptor limits (CVE-2014-3636).

Malicious local users could create D-Bus connections to dbus-daemon which
could not be terminated by killing the participating processes, resulting
in a denial-of-service vulnerability (CVE-2014-3637).

dbus-daemon suffered from a denial-of-service vulnerability in the code
which tracks which messages expect a reply, allowing local attackers to
reduce the performance of dbus-daemon (CVE-2014-3638).

dbus-daemon did not properly reject malicious connections from local users,
resulting in a denial-of-service vulnerability (CVE-2014-3639).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=14102>
* <http://openwall.com/lists/oss-security/2014/09/16/9>
* <https://www.debian.org/security/2014/dsa-3026>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3635>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3636>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3637>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3638>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3639>

## SRPMS

### 3/core

* dbus-1.6.8-4.5.mga3

### 4/core

* dbus-1.6.18-1.4.mga4



=== Content from www.mandriva.com_882a8d89_20250125_202305.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from bugs.freedesktop.org_82886714_20250126_114146.html ===


Bugzilla – Bug 80559
CVE-2014-3637: Immortal D-Bus connection in dbus-daemon
Last modified: 2014-09-16 16:34:07 UTC

* [Home](./)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

[**Bug 80559**](show_bug.cgi?id=80559)
- CVE-2014-3637: Immortal D-Bus connection in dbus-daemon

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-3637: Immortal D-Bus connection in dbus-daemon

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | dbus | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=dbus "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | core ([show other bugs](buglist.cgi?component=core&product=dbus&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other All | |  | | | [Importance](page.cgi?id=fields.html#importance): | medium normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Simon McVittie | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sjoerd Simons | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | review+ | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | patch, security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-06-26 14:00 UTC by Alban Crequy | | --- | --- | | Modified: | 2014-09-16 16:34 UTC ([History](show_activity.cgi?id=80559)) | | CC List: | 2 users (show)  thiago walters | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [i915 platform:](page.cgi?id=fields.html#cf_i915_platform "Intel platforms affected by the bug") |  | | [i915 features:](page.cgi?id=fields.html#cf_i915_features "Features of the i915 driver affected by the bug.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**[PATCH 1/4] config: add new limit: pending\_fd\_timeout**](attachment.cgi?id=103210 "View the content of the attachment") (5.81 KB, patch)  [2014-07-21 18:47 UTC](#attach_103210 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=103210&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80559&attachment=103210) | | [**[PATCH 2/4] DBusConnection: implements \_dbus\_connection\_get\_pending\_fds\_count**](attachment.cgi?id=103211 "View the content of the attachment") (4.70 KB, patch)  [2014-07-21 18:48 UTC](#attach_103211 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=103211&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80559&attachment=103211) | | [**[PATCH 3/4] DBusConnection: implements \_dbus\_connection\_set\_pending\_fds\_function**](attachment.cgi?id=103212 "View the content of the attachment") (8.14 KB, patch)  [2014-07-21 18:49 UTC](#attach_103212 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=103212&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80559&attachment=103212) | | [**[PATCH 4/4] bus: enforce pending\_fd\_timeout**](attachment.cgi?id=103213 "View the content of the attachment") (4.63 KB, patch)  [2014-07-21 18:49 UTC](#attach_103213 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=103213&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80559&attachment=103213) | | [**[PATCH 2/4 v2] DBusConnection: implements \_dbus\_connection\_get\_pending\_fds\_count**](attachment.cgi?id=106175 "View the content of the attachment") (4.95 KB, patch)  [2014-09-12 12:15 UTC](#attach_106175 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106175&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80559&attachment=106175) | | [**[backport to 1.6] config: add new limit: pending\_fd\_timeout**](attachment.cgi?id=106191 "View the content of the attachment") (6.02 KB, patch)  [2014-09-12 15:39 UTC](#attach_106191 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106191&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80559&attachment=106191) | | [**[backport to 1.6, 2/4] DBusConnection: implements \_dbus\_connection\_get\_pending\_fds\_count**](attachment.cgi?id=106192 "View the content of the attachment") (4.92 KB, patch)  [2014-09-12 15:40 UTC](#attach_106192 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106192&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80559&attachment=106192) | | [**[backport to 1.6, 3/4] DBusConnection: implements \_dbus\_connection\_set\_pending\_fds\_function**](attachment.cgi?id=106193 "View the content of the attachment") (8.16 KB, patch)  [2014-09-12 15:41 UTC](#attach_106193 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106193&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=80559&attachment=106193) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=80559&action=viewall&hide_obsolete=1) | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=80559#c0)  Alban Crequy    2014-06-26 14:00:23 UTC  ``` A D-Bus client can create an "immortal" D-Bus connection in dbus-daemon. Dbus-daemon will still have the resources allocated for the connection like a file descriptor, an unique name, and possibly well-known names and match rules. An immortal connection stays alive in dbus-daemon even when the clients owning the other end of the socket are terminated.  To create such an immortal connection, a client can send the first byte of a D-Bus message with the file descriptor of the connection itself attached with fdpassing (SCM_RIGHTS). Then dbus-daemon has the file descriptors of both ends of the Unix socket. The client can close(2) or exit(3) (but not shutdown(2)!). Dbus-daemon has no way to detect the close(2) because it merely reduce the socket reference counter in the kernel but another process (dbus-daemon itself) still have a reference on it so it stays alive. When the client terminates, nobody will ever finish writing the end of the D-Bus message after the first byte. So the fd will stay in the DBusMessageLoader forever.  There are a few possible attacks related to immortal D-Bus connections:  1. A malicious program could create plenty of immortal D-Bus connections until the fd limit is reached. The limit could be max_completed_connections: typically 2048 on the system bus or 100000 on the session bus:    <limit name="max_completed_connections">100000</limit> There is also a limit per process ("ulimit -n", typically 65536) and a global limit (/proc/sys/fs/file-max, 800796 for me).  The problem here is that it's not possible to kill D-Bus clients until dbus-daemon recovers more file descriptors. When the limit is reached, even when the malicious program is terminated, I cannot get new connections:  This problem is mitigated on the system bus by max_connections_per_user, typically 256 on the system bus or 100000 on the session bus. So it would still need 2048/256 = 8 users to collaborate.  $ dbus-monitor  Failed to open connection to session bus: Failed to determine seats of user "1000": Too many open files  I've also seen an "accept busy loop" taking too much cpu:  accept4(6, 0xbfff9c2c, [16], SOCK_CLOEXEC) = -1 EMFILE (Too many open files) fcntl64(-1, F_GETFD)                    = -1 EBADF (Bad file descriptor) clock_gettime(CLOCK_MONOTONIC, {519, 413430300}) = 0 epoll_wait(3, {{EPOLLIN, {u32=6, u64=578500642725691398}}}, 64, -1) = 1 clock_gettime(CLOCK_MONOTONIC, {519, 414742757}) = 0 accept4(6, 0xbfff9c2c, [16], SOCK_CLOEXEC) = -1 EMFILE (Too many open files) etc.  Because a poll on the listening socket returns POLLIN but accept() does not work and it keeps trying again.  2. A malicious program could request some D-Bus names such as "org.freedesktop.Telepathy.MissionControl5" and then make the connection immortal. MissionControl will not be able to start without restarting the session: killing the malicious program will not release the well-known name. An immortal connection is not necessarily unusable: a malicious process could create two immortal D-Bus connections by sending the two fds attached to the same byte in one of the two connections. In this way, one of the connections could be used to impersonate MissionControl and send/receive messages, and the other connection stays blocked after sending the first byte.  3. A malicious program could register some match rules and make the connection immortal and attempt to make dbus-daemon memory usage balloon with [Bug #33606](show_bug.cgi?id=33606 "RESOLVED MOVED - stop dbus-daemon memory usage ballooning if a client is slow to read").  4. A user could prevent root to umount a partition without killing the system bus. A malicious program can pass an open fd on the mount to dbus-daemon on the system bus through the immortal connection and then exit. The administrators will use "lsof" to find the processes preventing the umount; they will find the process dbus-daemon for the system bus.  5. Similar to the umount problem: a malicious program could create an exclusive lock with flock() or fcntl() on some databases and then pass the fd to the system bus.  ==  Possible ideas to make dbus-daemon more resistant against this kind of attacks:  - timeout when receiving a pending fd in an incomplete msg   (fds should not stay in the loader for too long)  - keep track of the numbers of pending fds in DBusMessageLoaders. Don't   accept() on the listening socket when there are too many fds pending.  - don't accept fds spread across a message: if a fd was attached to the first   byte of the message, the next bytes should not have a fd attached. It needs   some research to see if the "un-glue fds messages from different skbs" is   Linux-specific or not, see   <http://lxr.free-electrons.com/source/net/unix/af_unix.c#L2051>  - disconnect connections sending a message with a fd but without the   appropriate header.  - only accept message with fds attached when received a sdk big enough to   check the header to see if it is supposed to contain fds. ```  [Comment 1](show_bug.cgi?id=80559#c1)  Simon McVittie    2014-06-26 14:21:12 UTC  ``` Mitigations:  (In reply to [comment #0](show_bug.cgi?id=80559#c0)) > This problem is mitigated on the system bus by max_connections_per_user, > typically 256 on the system bus or 100000 on the session bus. So it would > still need 2048/256 = 8 users to collaborate.  Those 8 users could already cooperate to DoS the system bus; the only difference here is that a sysadmin cannot clean up the situation by killing their processes.  > 2. A malicious program could request some D-Bus names such as > "org.freedesktop.Telepathy.MissionControl5"  If a malicious program can do this, you've already lost. If your bus is a security boundary, then you need to limit who is allowed to own particular names.  > 3. A malicious program could register some match rules and make the > connection > immortal and attempt to make dbus-daemon memory usage balloon with Bug > #33606.  They can already do that; solutions welcome. Again, the difference here is that a sysadmin cannot mitigate the situation by killing their processes.  > 4. A user could prevent root to umount a partition without killing the system > bus. A malicious program can pass an open fd on the mount to dbus-daemon on > the > system bus through the immortal connection and then exit. The administrators > will use "lsof" to find the processes preventing the umount; they will find > the process dbus-daemon for the system bus.  Mitigation: don't let people access partitions you want to unmount  Mitigation: if you're sufficiently desperate, ptrace the dbus-daemon and close the fd that way :-) ```  [Comment 2](show_bug.cgi?id=80559#c2)  Thiago Macieira    2014-06-27 00:56:20 UTC  ``` The fds must be between the first and second bytes in a Unix socket message. I don't think we should accept them anywhere else.  That doesn't solve the problem, though. The malicious connection could send the first byte, the fds, maybe a second byte and then close its side of the connection. Now the daemon is simply stuck.  I think the only mitigation possible is to timeout messages with pending fds.   It might be possible to use getsockname() and getpeername() to identify whether the pending message has passed a file descriptor to the D-Bus socket itself and only time that one out. However, I think we should always do the timing out. Otherwise, it's possible for multiple connections to cooperate to exhaust the daemon's file descriptor limit by not closing their connections. ```  [Comment 3](show_bug.cgi?id=80559#c3)  Alban Crequy    2014-06-27 11:18:40 UTC  ``` (In reply to [comment #2](show_bug.cgi?id=80559#c2)) > The fds must be between the first and second bytes in a Unix socket message. > I don't think we should accept them anywhere else. >  > That doesn't solve the problem, though. The malicious connection could send > the first byte, the fds, maybe a second byte and then close its side of the > connection. Now the daemon is simply stuck.  I agree that we can make things a bit stricter. It will not solve this specific issue but it can solve similar issues. For example, if a client sends a message byte by byte with a new fd attached on each byte...  > I think the only mitigation possible is to timeout messages with pending > fds.   I wonder what would be the default timeout for that? 25 seconds? For big messages sent in several sendmsg/recvfrom iterations, I would like if SIGSTOP and gdb on the sending process don't break things.  > It might be possible to use getsockname() and getpeername() to identify > whether the pending message has passed a file descriptor to the D-Bus socket > itself and only time that one out. However, I think we should always do the > timing out. Otherwise, it's possible for multiple connections to cooperate > to exhaust the daemon's file descriptor limit by not closing their > connections.  It can work in some scenario but not all of them. dbus-daemon would need to check whether the received fd is a Unix socket, then use recvfrom(...MSG_PEEK) to get all packets from the socket queue and recursively unpack file descriptors and inspect them. The problem is that the malicious sender could send more packets at any point in the recursive pile of packets and fds. So at the time dbus-daemon checks it could be fine, and then it will become not fine. It could be a time of check / time of use problem. We can check that regularly, each time the timeout about pending fds in DBusMessageLoader is triggered, but it will not help if two different connections (e.g. one on the system bus, one on another bus) get passed to each other. ```  [Comment 4](show_bug.cgi?id=80559#c4)  Thiago Macieira    2014-06-27 16:30:32 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=80559#c3)) > (In reply to [comment #2](show_bug.cgi?id=80559#c2)) > > I think the only mitigation possible is to timeout messages with pending > > fds.  >  > I wonder what would be the default timeout for that? 25 seconds? For big > messages sent in several sendmsg/recvfrom iterations, I would like if > SIGSTOP and gdb on the sending process don't break things.  I'm going to say a little higher. The bus-enforced reply timeout is 5 minutes when enabled, so either we do 5 minutes or half of that.  If we had the ability to change the fd-passing protocol, I'd change it to work as follows: - send the file descriptors after the header, but before the data payload (instead of between first and second bytes) - add a header entry that indicates the number of file descriptors being passed - keep a daemon-wide fixed-size list of file descriptors being passed  That way, we know whether we need to allocate and fd array before receiving them. If the array doesn't have enough room, the connection is suspended until we find room -- and we implement the timing out, so there will eventually be room. Since we know whether a message is passing file descriptors, messages without them will still go through.  The possible attack vectors I can think in this are that multiple connections could cooperate to DoS any file descriptor passing by keeping the daemon list always full. At least connections that aren't exchanging file descriptors would still work. ```  [Comment 5](show_bug.cgi?id=80559#c5)  Thiago Macieira    2014-06-27 16:32:41 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=80559#c4)) > If we had the ability to change the fd-passing protocol, I'd change it to > work as follows: > - send the file descriptors after the header, but before the data payload > (instead of between first and second bytes)  > The possible attack vectors I can think in this are that multiple > connections could cooperate to DoS any file descriptor passing by keeping > the daemon list always full. At least connections that aren't exchanging > file descriptors would still work.  Maybe if we instead require the file descriptors to be passed with the *last* byte of the message, we won't have a timeout problem -- the message is complete then.  Actually, it might be possible to implement this if we just add a new capability in the header and negotiate that. After a period of grace, we disable the old extension, so old clients sending file descriptors between the first and second bytes will not be able to pass them anymore. ```  [Comment 6](show_bug.cgi?id=80559#c6)  Alban Crequy    2014-07-21 18:44:13 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=80559#c4)) > - send the file descriptors after the header, but before the data payload > (instead of between first and second bytes)  File descriptors are not attached to a specific byte of the stream but to a skb (socket buffer). When the client calls sendmsg() with 2 iovecs (one for the header and one for the body of the message as libdbus does) and 1 fd, it is still one skb containing 1 buffer + 1 fd in kernel. And when dbus-daemon receives data with recvmsg(), the buffer received might not have the same boundaries as the skb because it is SOCK_STREAM and not SOCK_DGRAM. Dbus-daemon can receive a buffer coming from 2 skbs with 1 fd for example, and the information about which offset or which skb the fd was attached to is lost from dbus-daemon's perspective.  > - add a header entry that indicates the number of file descriptors being > passed  It already exists: header field UNIX_FDS (UINT32).  > - keep a daemon-wide fixed-size list of file descriptors being passed  At the moment, the list is purely in libdbus, in DBusMessageLoader attached to the DBusConnection.  > That way, we know whether we need to allocate and fd array before receiving > them. If the array doesn't have enough room, the connection is suspended > until we find room -- and we implement the timing out, so there will > eventually be room. Since we know whether a message is passing file > descriptors, messages without them will still go through.  When recvmsg() is called without a msg_control buffer (or with a buffer too small for all file descriptors), the kernel cannot place the file descriptors and they get closed and it's not possible to recover them. Dbus-daemon could know they were discarded with msg_flags=MSG_CTRUNC but it does not help. So it must always call recvmsg() with a control buffer for receiving fds.  For this to work, it would require dbus-daemon to call recvmsg with the correct sizes of buffer so two skbs don't get aggregated, instead of calling with a fixed sized buffer of 2kB (max_bytes_read_per_iteration). It would impact the performances negatively.  > The possible attack vectors I can think in this are that multiple > connections could cooperate to DoS any file descriptor passing by keeping > the daemon list always full. At least connections that aren't exchanging > file descriptors would still work.  Existing connections that aren't exchanging file descriptors are already working, but not new ones. So it is not as bad as it could be.  (In reply to [comment #5](show_bug.cgi?id=80559#c5)) > Maybe if we instead require the file descriptors to be passed with the > *last* byte of the message, we won't have a timeout problem -- the message > is complete then.  I think it would work, but it would require clients to send the message is two separate syscalls sendmsg(): the first with all the bytes of the message except the last byte, and the second with the last byte + the fds.  So it would require changes in dbus libraries used by clients: libdbus, QtDBus.  > Actually, it might be possible to implement this if we just add a new > capability in the header and negotiate that. After a period of grace, we > disable the old extension, so old clients sending file descriptors between > the first and second bytes will not be able to pass them anymore.  I like the idea but it seems to be a big change in dbus-daemon + in client libraries. So I would prefer if the timeout idea was enough.  I will attach patches about the timeout idea. ```  [Comment 7](show_bug.cgi?id=80559#c7)  Alban Crequy    2014-07-21 18:47:59 UTC  ``` Created [attachment 103210](attachment.cgi?id=103210 "[PATCH 1/4] config: add new limit: pending_fd_timeout") [[details]](attachment.cgi?id=103210&action=edit "[PATCH 1/4] config: add new limit: pending_fd_timeout") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=103210) [PATCH 1/4] config: add new limit: pending_fd_timeout ```  [Comment 8](show_bug.cgi?id=80559#c8)  Alban Crequy    2014-07-21 18:48:43 UTC  ``` Created [attachment 103211](attachment.cgi?id=103211 "[PATCH 2/4] DBusConnection: implements _dbus_connection_get_pending_fds_count") [[details]](attachment.cgi?id=103211&action=edit "[PATCH 2/4] DBusConnection: implements _dbus_connection_get_pending_fds_count") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=103211) [PATCH 2/4] DBusConnection: implements _dbus_connection_get_pending_fds_count ```  [Comment 9](show_bug.cgi?id=80559#c9)  Alban Crequy    2014-07-21 18:49:23 UTC  ``` Created [attachment 103212](attachment.cgi?id=103212 "[PATCH 3/4] DBusConnection: implements _dbus_connection_set_pending_fds_function") [[details]](attachment.cgi?id=103212&action=edit "[PATCH 3/4] DBusConnection: implements _dbus_connection_set_pending_fds_function") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=103212) [PATCH 3/4] DBusConnection: implements _dbus_connection_set_pending_fds_function ```  [Comment 10](show_bug.cgi?id=80559#c10)  Alban Crequy    2014-07-21 18:49:53 UTC  ``` Created [attachment 103213](attachment.cgi?id=103213 "[PATCH 4/4] bus: enforce pending_fd_timeout") [[details]](attachment.cgi?id=103213&action=edit "[PATCH 4/4] bus: enforce pending_fd_timeout") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=103213) [PATCH 4/4] bus: enforce pending_fd_timeout ```  [Comment 11](show_bug.cgi?id=80559#c11)  Simon McVittie    2014-09-03 17:56:38 UTC  ``` This looks good in principle, although I'd like to re-review it to be sure. ```  [Comment 12](show_bug.cgi?id=80559#c12)  Simon McVittie    2014-09-09 18:16:42 UTC  ``` I think these are fine.  There are some trivial conflicts between [Attachment #103210](attachment.cgi?id=103210 "[PATCH 1/4] config: add new limit: pending_fd_timeout") [[details]](attachment.cgi?id=103210&action=edit "[PATCH 1/4] config: add new limit: pending_fd_timeout") and the one on [Bug #82820](show_bug.cgi?id=82820 "RESOLVED FIXED - CVE-2014-3636: using all available file descriptors in dbus-daemon: limit DEFAULT_MESSAGE_UNIX_FDS"), so when we do the security advisory, we should send out linearized patches. ```  [Comment 13](show_bug.cgi?id=80559#c13)  Simon McVittie    2014-09-12 12:15:19 UTC  ``` Created [attachment 106175](attachment.cgi?id=106175 "[PATCH 2/4 v2] DBusConnection: implements  _dbus_connection_get_pending_fds_count") [[details]](attachment.cgi?id=106175&action=edit "[PATCH 2/4 v2] DBusConnection: implements  _dbus_connection_get_pending_fds_count") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=106175) [PATCH 2/4 v2] DBusConnection: implements  _dbus_connection_get_pending_fds_count  From: Alban Crequy <alban.crequy@collabora.co.uk>  This will allow the bus to know whether there are pending file descriptors in a DBusConnection's DBusMessageLoader.  [fix compilation on platforms that do not HAVE_UNIX_FD_PASSING -smcv]  ---  Cross-building with mingw while doing a "test all the configurations" run for a release-candidate:  /home/smcv/src/fdo/dbus-1.8/dbus/dbus-message.c: In function '_dbus_message_loader_get_pending_fds_count': /home/smcv/src/fdo/dbus-1.8/dbus/dbus-message.c:4515:16: error: 'DBusMessageLoader' has no member named 'n_unix_fds'    return loader->n_unix_fds;  I think the solution (wrap it in #ifdef) is trivial enough to not really need review, but if someone could glance at it and say yes, that would be reassuring. ```  [Comment 14](show_bug.cgi?id=80559#c14)  Alban Crequy    2014-09-12 12:27:52 UTC  ``` (In reply to [comment #13](show_bug.cgi?id=80559#c13)) > I think the solution (wrap it in #ifdef) is trivial enough to not really > need review, but if someone could glance at it and say yes, that would be > reassuring.  I've not tested it but the wrapping looks good to me. ```  [Comment 15](show_bug.cgi?id=80559#c15)  Simon McVittie    2014-09-12 15:39:10 UTC  ``` Created [attachment 106191](attachment.cgi?id=106191 "[backport to 1.6] config: add new limit: pending_fd_timeout") [[details]](attachment.cgi?id=106191&action=edit "[backport to 1.6] config: add new limit: pending_fd_timeout") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=106191) [backport to 1.6] config: add new limit: pending_fd_timeout  ---  Just some conflicts in cmake/bus/dbus-daemon.xml. ```  [Comment 16](show_bug.cgi?id=80559#c16)  Simon McVittie    2014-09-12 15:40:21 UTC  ``` Created [attachment 106192](attachment.cgi?id=106192 "[backport to 1.6, 2/4] DBusConnection: implements _dbus_connection_get_pending_fds_count") [[details]](attachment.cgi?id=106192&action=edit "[backport to 1.6, 2/4] DBusConnection: implements _dbus_connection_get_pending_fds_count") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=106192) [backport to 1.6, 2/4] DBusConnection: implements _dbus_connection_get_pending_fds_count  ---  Some conflicts with the change that fixed thread-safety-by-default. ```  [Comment 17](show_bug.cgi?id=80559#c17)  Simon McVittie    2014-09-12 15:41:23 UTC  ``` Created [attachment 106193](attachment.cgi?id=106193 "[backport to 1.6, 3/4] DBusConnection: implements _dbus_connection_set_pending_fds_function") [[details]](attachment.cgi?id=106193&action=edit "[backport to 1.6, 3/4] DBusConnection: implements _dbus_connection_set_pending_fds_function") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=106193) [backport to 1.6, 3/4] DBusConnection: implements _dbus_connection_set_pending_fds_function  ---  Likewise.  Patch 4/4 "enforce pending_fd_timeout" does not need backporting, just apply the same one. ```  [Comment 18](show_bug.cgi?id=80559#c18)  Simon McVittie    2014-09-12 16:16:02 UTC  ``` Comment on [attachment 106191](attachment.cgi?id=106191 "[backport to 1.6] config: add new limit: pending_fd_timeout") [[details]](attachment.cgi?id=106191&action=edit "[backport to 1.6] config: add new limit: pending_fd_timeout") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=106191) [backport to 1.6] config: add new limit: pending_fd_timeout  Review of [attachment 106191](attachment.cgi?id=106191 "[backport to 1.6] config: add new limit: pending_fd_timeout") [[details]](attachment.cgi?id=106191&action=edit "[backport to 1.6] config: add new limit: pending_fd_timeout") [[review]](page.cgi?id=splinter.html&bug=80559&attachment=106191): -----------------------------------------------------------------  This probably requires fixing [Bug #81053](show_bug.cgi?id=81053 "RESOLVED FIXED - CVE-2014-3638: Flooding dbus-daemon with pending replies: denial of service"), [Bug #82820](show_bug.cgi?id=82820 "RESOLVED FIXED - CVE-2014-3636: using all available file descriptors in dbus-daemon: limit DEFAULT_MESSAGE_UNIX_FDS"), [Bug #80919](show_bug.cgi?id=80919 "RESOLVED FIXED - CVE-2014-3639: Security implications of Bug #80851 - max_incomplete_connections") first, because they all touch the list of limits. ```  [Comment 19](show_bug.cgi?id=80559#c19)  Simon McVittie    2014-09-12 22:17:33 UTC  ``` CVE-2014-3637 has been allocated for this vulnerability. ```  [Comment 20](show_bug.cgi?id=80559#c20)  Simon McVittie    2014-09-16 16:34:07 UTC  ``` Fixed in 1.8.8, raising embargo ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=80559)
* - Top of page

* + [Home](./)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

Use of freedesktop.org services, including Bugzilla, is subject to our [Code of Conduct](https://www.freedesktop.org/wiki/CodeOfConduct/). How we collect and use information is described in our [Privacy Policy](https://www.freedesktop.org/wiki/PrivacyPolicy).



=== Content from www.ubuntu.com_b4015ba8_20250125_202309.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2352-1: DBus vulnerabilities

22 September 2014

Several security issues were fixed in DBus.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [dbus](/security/cves?package=dbus) - simple interprocess messaging system

## Details

Simon McVittie discovered that DBus incorrectly handled the file

descriptors message limit. A local attacker could use this issue to cause

DBus to crash, resulting in a denial of service, or possibly execute

arbitrary code. This issue only applied to Ubuntu 12.04 LTS and Ubuntu

14.04 LTS. ([CVE-2014-3635](/security/CVE-2014-3635))

Alban Crequy discovered that DBus incorrectly handled a large number of

file descriptor messages. A local attacker could use this issue to cause

DBus to stop responding, resulting in a denial of service. This issue only

applied to Ubuntu 12.04 LTS and Ubuntu 14.04 LTS. ([CVE-2014-3636](/security/CVE-2014-3636))

Alban Crequy discovered that DBus incorrectly handled certain file

descriptor messages. A local attacker could use this issue to cause DBus

to maintain persistent connections, possibly resulting in a denial of

service. This issue only applied to Ubuntu 12.04 LTS and Ubuntu 14.04 LTS.

([CVE-2014-3637](/security/CVE-2014-3637))

Alban Crequy discovered that DBus incorrectly handled a large number of

parallel connections and parallel message calls. A local attacker could use

this issue to cause DBus to consume resources, possibly resulting in a

denial of service. ([CVE-2014-3638](/security/CVE-2014-3638))

Alban Crequy discovered that DBus incorrectly handled incomplete

connections. A local attacker could use this issue to cause DBus to fail

legitimate connection attempts, resulting in a denial of service.

([CVE-2014-3639](/security/CVE-2014-3639))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 14.04

* [dbus](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.6.18-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/dbus/1.6.18-0ubuntu4.2)
* [libdbus-1-3](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.6.18-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/dbus/1.6.18-0ubuntu4.2)

##### Ubuntu 12.04

* [dbus](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.4.18-1ubuntu1.6](https://launchpad.net/ubuntu/%2Bsource/dbus/1.4.18-1ubuntu1.6)
* [libdbus-1-3](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.4.18-1ubuntu1.6](https://launchpad.net/ubuntu/%2Bsource/dbus/1.4.18-1ubuntu1.6)

##### Ubuntu 10.04

* [dbus](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.2.16-2ubuntu4.8](https://launchpad.net/ubuntu/%2Bsource/dbus/1.2.16-2ubuntu4.8)
* [libdbus-1-3](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.2.16-2ubuntu4.8](https://launchpad.net/ubuntu/%2Bsource/dbus/1.2.16-2ubuntu4.8)

After a standard system update you need to reboot your computer to make all

the necessary changes.

## References

* [CVE-2014-3635](/security/CVE-2014-3635)
* [CVE-2014-3636](/security/CVE-2014-3636)
* [CVE-2014-3637](/security/CVE-2014-3637)
* [CVE-2014-3638](/security/CVE-2014-3638)
* [CVE-2014-3639](/security/CVE-2014-3639)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


