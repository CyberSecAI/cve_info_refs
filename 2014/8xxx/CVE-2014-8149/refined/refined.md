```
Message-ID: <CAO33bZUoNPSMYObtR0a38g4h3kB45JqnbYmjVseK2Cgom+TURQ@mail.gmail.com>
Date: Thu, 22 Jan 2015 10:44:56 +1000
From: David Jorm <david.jorm@...il.com>
To: oss-security@...ts.openwall.com,
	opendaylight-announce@...ts.opendaylight.org
Subject: Defense4all security advisory: CVE-2014-8149 users can export report
 data to an arbitrary file on the server's filesystem

It was found that the defense4all framework's "dump" method allows a user
to request that report data is exported to a file on the server's
filesystem. The user can specify any path, and the server will write to it
with no validation. This could be used to perform a range of attacks. For
example, a critical file could be overwritten, thereby disabling the
defense4all server. On Windows servers, a UNC path could be injected,
potentially causing the server to write data to remote filesystems. An
attacker cannot control the contents of the file, but they can define a
report query that returns no results, and therefore force it to write an
empty file. An error message is received if the server cannot write to the
provided path. An attacker could therefore use this issue to map out the
writable filesystem on the server and potentially perform more advanced
attacks by manipulating special files in the /dev and /proc filesystems of
Linux servers.

It was also found that defense4all was using Spring 3.0.0 RC3. This
component is vulnerable to a number of vulnerabilities as listed on the
pivotal advisories page: <http://www.pivotal.io/security>
Full details including how to apply a patch are available on the
OpenDaylight security advisories page:

<https://wiki.opendaylight.org/view/Security_Advisories>

Thanks
David Jorm on behalf of the OpenDaylight security response team
```

- **Root cause of vulnerability:** The defense4all framework's "dump" method allows a user to specify an arbitrary path on the server's filesystem where report data should be exported. The server then writes to this path without validation.
- **Weaknesses/vulnerabilities present:** Path traversal/arbitrary file write vulnerability due to lack of input validation of the output file path.
- **Impact of exploitation:** An attacker could overwrite critical system files, potentially disabling the server. On Windows, they could write to remote filesystems via UNC paths. Although they can't control file contents, they can force the creation of empty files. They can also probe the file system for writeable locations and potentially manipulate special files on linux systems, like in `/dev` and `/proc`.
- **Attack vectors:** The "dump" method of the defense4all framework, which allows user-specified file paths for data export.
- **Required attacker capabilities/position:** The attacker needs to be able to access and call the "dump" method to trigger the export functionality of the framework.