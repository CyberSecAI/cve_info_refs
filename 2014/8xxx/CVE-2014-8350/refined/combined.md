=== Content from bugs.debian.org_9922e70c_20250124_222948.html ===

# Debian Bug report logs - #765920 smarty3: CVE-2014-8350: secure mode bypass

[![version graph](version.cgi?package=smarty3;width=2;absolute=0;fixed=smarty3%2F3.1.21-1;found=smarty3%2F3.1.10-2;found=smarty3%2F3.0~rc1-1;collapse=1;height=2)](version.cgi?info=1;package=smarty3;collapse=1;fixed=smarty3%2F3.1.21-1;absolute=0;found=smarty3%2F3.1.10-2;found=smarty3%2F3.0~rc1-1)

Package:
[smarty3](pkgreport.cgi?package=smarty3);
Maintainer for [smarty3](pkgreport.cgi?package=smarty3) is [Mike Gabriel <sunweaver@debian.org>](pkgreport.cgi?maint=sunweaver%40debian.org); Source for [smarty3](pkgreport.cgi?package=smarty3) is [src:smarty3](pkgreport.cgi?src=smarty3) ([PTS](https://tracker.debian.org/pkg/smarty3), [buildd](https://buildd.debian.org/smarty3), [popcon](https://qa.debian.org/popcon.php?package=smarty3)).

Reported by: [Thue <thuejk@gmail.com>](pkgreport.cgi?submitter=thuejk%40gmail.com)

Date: Sun, 19 Oct 2014 09:18:11 UTC

Severity: important

Tags: fixed-upstream, security, upstream

Found in versions smarty3/3.1.10-2, smarty3/3.0~rc1-1

Fixed in version smarty3/3.1.21-1

**Done:** Mike Gabriel <sunweaver@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=765920;mbox=yes), [status mbox](bugreport.cgi?bug=765920;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=765920;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Mike Gabriel <sunweaver@debian.org>`:

`Bug#765920`; Package `smarty3`.
(Sun, 19 Oct 2014 09:18:16 GMT) ([full text](bugreport.cgi?bug=765920;msg=2), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Thue <thuejk@gmail.com>`:

New Bug report received and forwarded. Copy sent to `Mike Gabriel <sunweaver@debian.org>`.

Your message had a Version: pseudo-header with an invalid package
version:

All below 3.1.21

please either use found or fixed to the control server with a correct
version, or reply to this report indicating the correct version so the
maintainer (or someone else) can correct it for you.

(Sun, 19 Oct 2014 09:18:16 GMT) ([full text](bugreport.cgi?bug=765920;msg=4), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=765920;msg=5), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=thuejk%40gmail.com)
From: Thue <thuejk@gmail.com>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: smarty3: Secure mode bypass
Date: Sun, 19 Oct 2014 11:17:51 +0200
```
Package: smarty3
Version: All below 3.1.21
Severity: important

Smarty secure mode should allow untrusted users to write templates,
without allowing them to execute arbitrary PHP code. However, all
smarty3 versions in Debian (sid, Jessie, stable, oldstable) currently
has a security hole allowing arbitrary PHP code execution if you can
edit templates.

Example:

test.php:
<?php
require_once('/home/thue/smarty/libs/SmartyBC.class.php');
$smarty = new Smarty();

$smarty->setTemplateDir('templates/');
$smarty->setCompileDir('templates_c/');
$smarty->enableSecurity();
$smarty->force_compile = true;
$tpl = $smarty->createTemplate('test.tpl');
$tpl->compileTemplateSource();
$smarty->display('test.tpl');
?>

templates/test.tpl:
{literal}<{/literal}script language=php>echo 1+1;</script>

If secure mode worked, that should output
   <script language=php>echo 1+1;</script>
In smarty3<3.1.21 it outputs
   2

Regards, Thue

-- System Information:
Debian Release: 7.6
  APT prefers stable-updates
  APT policy: (500, 'stable-updates'), (500, 'stable')
Architecture: amd64 (x86_64)

Kernel: Linux 3.2.0-4-amd64 (SMP w/2 CPU cores)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

```

---

**Reply sent**
to `Mike Gabriel <sunweaver@debian.org>`:

You have taken responsibility.
(Sun, 19 Oct 2014 22:23:03 GMT) ([full text](bugreport.cgi?bug=765920;msg=7), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=7), [link](#6)).

---

**Notification sent**
to `Thue <thuejk@gmail.com>`:

Bug acknowledged by developer.
(Sun, 19 Oct 2014 22:23:03 GMT) ([full text](bugreport.cgi?bug=765920;msg=9), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 765920-close@bugs.debian.org ([full text](bugreport.cgi?bug=765920;msg=10), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=sunweaver%40debian.org)
From: Mike Gabriel <sunweaver@debian.org>
To: 765920-close@bugs.debian.org
Subject: Bug#765920: fixed in smarty3 3.1.21-1
Date: Sun, 19 Oct 2014 22:20:19 +0000
```
Source: smarty3
Source-Version: 3.1.21-1

We believe that the bug you reported is fixed in the latest version of
smarty3, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 765920@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Mike Gabriel <sunweaver@debian.org> (supplier of updated smarty3 package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sun, 19 Oct 2014 23:45:18 +0200
Source: smarty3
Binary: smarty3
Architecture: source all
Version: 3.1.21-1
Distribution: unstable
Urgency: medium
Maintainer: Mike Gabriel <sunweaver@debian.org>
Changed-By: Mike Gabriel <sunweaver@debian.org>
Description:
 smarty3    - Template engine for PHP
Closes: [636148](bugreport.cgi?bug=636148) [765920](bugreport.cgi?bug=765920)
Changes:
 smarty3 (3.1.21-1) unstable; urgency=medium
 .
   * New upstream release. (Closes: #[765920](bugreport.cgi?bug=765920)).
   * debian/smarty3-lexer:
     + Add 4 files from smarty3 SVN that are used to generate some PHP
       files in the upstream tarball. See README.lexer for details.
       (Closes: #[636148](bugreport.cgi?bug=636148)).
   * debian/copyright:
     + Add copyright information for debian/smarty3-lexer/*.
     + Fix upstream license (LGPL-3 -> LGPL-3+) after reading the upstream-
       shipped COPYING.lib file more thoroughly.
     + Relicense debian/* under same license as upstream sources (LGPL-3+).
   * debian/control:
     + Bump Standards: to 3.9.6. No changes needed.
Checksums-Sha1:
 2f8d9a1ae833bdad64ca9587dbe27de26038f69b 1831 smarty3_3.1.21-1.dsc
 46edd54a87e1e33b1b4bee71999e92ba5c4273fb 207705 smarty3_3.1.21.orig.tar.gz
 0e551d2b1f6e0baa47f81ae72a88eee038ff60f6 15284 smarty3_3.1.21-1.debian.tar.xz
 8f8ad892d9fa2d87820de5707fd0acc8c98f9f7c 165714 smarty3_3.1.21-1_all.deb
Checksums-Sha256:
 4881917573a6143436502b04e307c4235bbaad88cd650629e6427155ab3defaa 1831 smarty3_3.1.21-1.dsc
 9597569443d80705fa7042bfa446786390b770e2ef4c49a08553a715cb1b93ed 207705 smarty3_3.1.21.orig.tar.gz
 4cf392556ebc83758ac581da21d23094c1d4f9594ca1b15ea3d01f4c7c4fbe98 15284 smarty3_3.1.21-1.debian.tar.xz
 2d85ce5b0732401e1a94f1a10c1fb3b490fbf141212b99c09d1dc32e4f02207d 165714 smarty3_3.1.21-1_all.deb
Files:
 17228eae8f6a6441e420781e99302737 1831 web optional smarty3_3.1.21-1.dsc
 44600c60cf473292529687de8e69134e 207705 web optional smarty3_3.1.21.orig.tar.gz
 b64fb34f3affc5bbef6d2d725930605f 15284 web optional smarty3_3.1.21-1.debian.tar.xz
 7028416490f250299b22332d6349752f 165714 web optional smarty3_3.1.21-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJURDbPAAoJEJr0azAldxsxe6IP/1O+JZX9kyzjFjZNNMv9jHBA
hCPNAVsuQNuevSe/MRheACkhOpInc8YL9r1XpwhtEJ/Efg2rDrKH1/vaGWmlFXC2
xYZMax3zjUXwAAtIg0qbaEE5n1U4tEMr7mHVDuelPwoybPXccvYkAMH4kYaNyEQY
kr1XZ76a53hl737Z/0yNE0wUWOh0+AAm9qX1Nk6gUqE+hRt0tdospcYXiN6fdFtu
tPYY2cMtugTSZ3bKXa8rmK2MAX76QkhgaohhJ+IdFfoeN3LuTwyHzw4k0+9zDppf
e/xADWtGGa/X+opP/G62YvaTvEjEvo3/mYH/Pl9BFgt1SUdaW3Zx3nLdLbrjmBB3
hqFRXSJHdHtml98ANJ14zMwSAmVO3ihscA9NsxzggQm0tun4DQAK7jL1p/1Ip8Pd
XBFq8fabiwC82MwAdDJx45RiXSWJ0bVotaAhSh6ngVwZ2hahDeAlbw/qKwNWxaDn
FawfZOQFb4Tj1DO+nbfShyu5bPGOKpASOyiuknzisgXwomIvHUAsS5id9AyCNkkt
bQhrE4EsfbxD2vlUqzbZErv2SzjNXuJ7l01GUDxaZJwgGDk42piIsvkaxsJdpB8X
MHEhgOW40bFLrAdn1llSlhkLcrbkET6SfWIquPenU/NkuqzMZEB8U03IHJbOZ8pg
oc8Hp1u52chAtDfx9wuf
=Vvf4
-----END PGP SIGNATURE-----

```

---

**Added tag(s) upstream.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:39:04 GMT) ([full text](bugreport.cgi?bug=765920;msg=12), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=12), [link](#11)).

---

**Added tag(s) fixed-upstream.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:39:08 GMT) ([full text](bugreport.cgi?bug=765920;msg=14), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=14), [link](#13)).

---

**Added tag(s) security.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:39:13 GMT) ([full text](bugreport.cgi?bug=765920;msg=16), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=16), [link](#15)).

---

**Marked as found in versions smarty3/3.1.10-2.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:51:15 GMT) ([full text](bugreport.cgi?bug=765920;msg=18), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=18), [link](#17)).

---

**Marked as found in versions smarty3/3.0~rc1-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:51:16 GMT) ([full text](bugreport.cgi?bug=765920;msg=20), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=20), [link](#19)).

---

**Changed Bug title to 'smarty3: CVE-2014-8350: secure mode bypass' from 'smarty3: Secure mode bypass'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 25 Oct 2014 08:48:12 GMT) ([full text](bugreport.cgi?bug=765920;msg=22), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=22), [link](#21)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Thu, 27 Nov 2014 07:27:58 GMT) ([full text](bugreport.cgi?bug=765920;msg=24), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=24), [link](#23)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=765920).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 22:29:48 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.mandriva.com_120ac681_20250124_222941.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from seclists.org_5ffcd787_20250124_222936.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](420)
[By Date](date.html#421)
[![Next](/images/right-icon-16x16.png)](422)

[![Previous](/images/left-icon-16x16.png)](420)
[By Thread](index.html#421)
[![Next](/images/right-icon-16x16.png)](423)

![](/shared/images/nst-icons.svg#search)

# Re: CVE Request: smarty: secure mode bypass

---

*From*: cve-assign () mitre org

*Date*: Thu, 23 Oct 2014 00:30:08 -0400 (EDT)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> Can a CVE be assigned for the following smarty issue: upstream
> released new version 3.1.21:
>
>
> ```
> > ```
> > Smarty 3.1.21 Released Oct 18, 2014
> > Smarty 3.1.21 minor bug fixes and improvements. Also following up a
> > security bug fix where <script language="php"> tags still worked in
> > secure mode. To note, this only affects users using Smarty in secure
> > mode and exposing templates to untrusted third parties.
> >
> > ```
>
> ```
>
>
> <https://code.google.com/p/smarty-php/source/browse/trunk/distribution/change_log.txt?r=4902>
> <https://bugs.debian.org/765920>
>
> {literal}<{/literal}script language=php>echo 1+1;</script>
>
> ```

```

Use CVE-2014-8350.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJUSINZAAoJEKllVAevmvmsUZMH/jStJjghvRVAX4RijuoQ5Tuk
ar0fNY4h8A8x/wb/Q7yfA06//uvPJeeUz6B1kptYnq6H+quBMm4JuWZSs1dRrjDi
TJVmoNx4+bPPCfbaEsZfbX59HaDLf5rtDfeq1XeV+mHX7FgmuDcImDSsAjlra+Ko
2ixpC6NZG8ii58mikQial1wWlbvguCqkZPvV4KdkXbly+CEiA4/y4AIXEbAmSZyB
oyDNkZdpOHrF5FoHWIqsTOysTvQaaC0jnJbuC9wvyPaOLJS39ZgRi7pVvz7UYv/r
HvLTwoPJB9UmS/DeKV2nstkk+BpRJy+JqXITvwRGNl8FAIvxfxiRJAzLAQFNzzE=
=3ELY
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](420)
[By Date](date.html#421)
[![Next](/images/right-icon-16x16.png)](422)

[![Previous](/images/left-icon-16x16.png)](420)
[By Thread](index.html#421)
[![Next](/images/right-icon-16x16.png)](423)

### Current thread:

* [CVE Request: smarty: secure mode bypass](420) *Salvatore Bonaccorso (Oct 22)*
  + **Re: CVE Request: smarty: secure mode bypass** *cve-assign (Oct 22)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from advisories.mageia.org_83885533_20250124_222934.html ===

# [Advisories](index.html) » MGASA-2014-0468

## Updated php-smarty packages fix security vulnerabilities

Publication date: 21 Nov 2014

Modification date: 21 Nov 2014

Type: security

Affected Mageia releases :
[3](3.html)

CVE:
[CVE-2012-4437](CVE-2012-4437.html)
,
[CVE-2014-8350](CVE-2014-8350.html)

## Description

```
Cross-site scripting (XSS) vulnerability in the SmartyException class in
Smarty (aka smarty-php) before 3.1.12 allows remote attackers to inject
arbitrary web script or HTML via unspecified vectors that trigger a Smarty
exception (CVE-2012-4437).

Smarty before 3.1.21 allows remote attackers to bypass the secure mode
restrictions and execute arbitrary PHP code as demonstrated by
"{literal}<{/literal}script language=php>" in a template (CVE-2014-8350).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=14465>
* <https://lists.fedoraproject.org/pipermail/package-announce/2014-November/142696.html>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4437>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8350>

## SRPMS

### 3/core

* php-smarty-3.1.21-1.mga3



=== Content from bugs.mageia.org_835c927e_20250126_040708.html ===


Mageia Bugzilla – Bug 14465
php-smarty new security issue CVE-2014-8350
Last modified: 2014-11-28 23:55:23 CET

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=14465&GoAheadAndLogIn=1)

  [x]
* |
  [New Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug 14465**](show_bug.cgi?id=14465)
- php-smarty new security issue CVE-2014-8350

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
php-smarty new security issue CVE-2014-8350

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): major | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sec team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/619213/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | MGA3TOO has\_procedure mga4-32-ok mga4... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | validated\_update | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-11-05 16:42 CET by David Walser | | --- | --- | | Modified: | 2014-11-28 23:55 CET ([History](show_activity.cgi?id=14465)) | | CC List: | 6 users (show)  guillomovitch oe olchal rverschelde sysadmin-bugs thomas | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | php-smarty-3.1.19-5.mga5.src.rpm | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=14465&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=14465#c0)  David Walser    2014-11-05 16:42:29 CET  ``` Fedora has issued an advisory on October 27: <https://lists.fedoraproject.org/pipermail/package-announce/2014-November/142696.html>  The issue is fixed upstream in 3.1.21.  Mageia 3 and Mageia 4 are also affected.  Reproducible:   Steps to Reproduce: ```  David Walser    2014-11-05 16:42:43 CET   CC: (none) => guillomovitchWhiteboard: (none) => MGA4TOO, MGA3TOO  [Comment 1](show_bug.cgi?id=14465#c1)  David Walser    2014-11-05 16:52:30 CET  ``` Oden has informed me that egroupware-gallery and php-pear-PhpDocumentor may also bundle Smarty. ```  ---   CC: (none) => thomas  [Comment 2](show_bug.cgi?id=14465#c2)  David Walser    2014-11-05 17:03:38 CET  ``` For php-pear-PhpDocumentor, it already is patched to use the system smarty, but it also ships its bundled copy because it isn't deleted during the package build.  Oden gave this svn diff to fix it:  Index: SPECS/php-pear-PhpDocumentor.spec =================================================================== --- SPECS/php-pear-PhpDocumentor.spec   (revision 795826) +++ SPECS/php-pear-PhpDocumentor.spec   (working copy) @@ -64,6 +64,9 @@  %patch -p 1  mv package.xml %{upstream_name}-%{version}/%{upstream_name}.xml   +# nuke bundled smarty +rm -rf phpDocumentor/Smarty-2.6.0 +  %install  cd %{upstream_name}-%{version}  pear install --nodeps --packagingroot %{buildroot} %{upstream_name}.xml ```  David Walser    2014-11-05 18:27:26 CET   URL: (none) => http://lwn.net/Vulnerabilities/619213/  [Comment 3](show_bug.cgi?id=14465#c3)  Thomas Spuhler    2014-11-06 01:17:31 CET  ``` (In reply to David Walser from [comment #2](show_bug.cgi?id=14465#c2)) > For php-pear-PhpDocumentor, it already is patched to use the system smarty, > but it also ships its bundled copy because it isn't deleted during the > package build.  Oden gave this svn diff to fix it: >  > Index: SPECS/php-pear-PhpDocumentor.spec > =================================================================== > --- SPECS/php-pear-PhpDocumentor.spec   (revision 795826) > +++ SPECS/php-pear-PhpDocumentor.spec   (working copy) > @@ -64,6 +64,9 @@ >  %patch -p 1 >  mv package.xml %{upstream_name}-%{version}/%{upstream_name}.xml >   > +# nuke bundled smarty > +rm -rf phpDocumentor/Smarty-2.6.0 > + >  %install >  cd %{upstream_name}-%{version} >  pear install --nodeps --packagingroot %{buildroot} %{upstream_name}.xml  It's not that simple. That patch was removed because of php-pear-PhpDocumentor crashing using the system smarty. It was easy to fix because php-pear-PhpDocumentor provided a bundled smarty-2.6.0. What I see in the report, the security advisory only lists smarty-3 ```  [Comment 4](show_bug.cgi?id=14465#c4)  David Walser    2014-11-06 01:25:54 CET  ``` (In reply to Thomas Spuhler from [comment #3](show_bug.cgi?id=14465#c3)) > It's not that simple. > That patch was removed because of php-pear-PhpDocumentor crashing using the > system smarty.  I see.  > It was easy to fix because php-pear-PhpDocumentor provided a bundled > smarty-2.6.0. > What I see in the report, the security advisory only lists smarty-3  While that's true, smarty2 has several unfixed security vulnerabilities and is unmaintained upstream.  In fact, I removed it from Cauldron today because of that.  Does PhpDocumenter have a solution upstream for using smarty3? ```  [Comment 5](show_bug.cgi?id=14465#c5)  Thomas Spuhler    2014-11-06 01:48:29 CET  ``` (In reply to David Walser from [comment #4](show_bug.cgi?id=14465#c4)) > (In reply to Thomas Spuhler from [comment #3](show_bug.cgi?id=14465#c3)) > > It's not that simple. > > That patch was removed because of php-pear-PhpDocumentor crashing using the > > system smarty. >  > I see. >  > > It was easy to fix because php-pear-PhpDocumentor provided a bundled > > smarty-2.6.0. > > What I see in the report, the security advisory only lists smarty-3 >  > While that's true, smarty2 has several unfixed security vulnerabilities and > is unmaintained upstream.  In fact, I removed it from Cauldron today because > of that.  Does PhpDocumenter have a solution upstream for using smarty3?  This package is not maintained upstream anymore except for bug fixes. My take this isn't true either. It has been replaced with PhpDocumenter-2.8.0. I don't see smarty in there. Let me try to see if it builds. ```  [Comment 6](show_bug.cgi?id=14465#c6)  David Walser    2014-11-07 19:02:53 CET  ``` Fixed in Cauldron in php-smarty-3.1.21-1.mga5. ```  ---   Version: Cauldron => 4Whiteboard: MGA4TOO, MGA3TOO => MGA3TOO  [Comment 7](show_bug.cgi?id=14465#c7)  David Walser    2014-11-14 18:32:36 CET  ``` Updated packages uploaded for Mageia 3 and Mageia 4.  Note to QA, there is a PoC here: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=765920>  Advisory: ========================  Updated php-smarty packages fix security vulnerability:  Smarty before 3.1.21 allows remote attackers to bypass the secure mode restrictions and execute arbitrary PHP code as demonstrated by "{literal}<{/literal}script language=php>" in a template (CVE-2014-8350).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8350> <https://lists.fedoraproject.org/pipermail/package-announce/2014-November/142696.html> ========================  Updated packages in core/updates_testing: ======================== php-smarty-3.1.21-1.mga3 php-smarty-doc-3.1.21-1.mga3 php-smarty-3.1.21-1.mga4 php-smarty-doc-3.1.21-1.mga4  from SRPMS: php-smarty-3.1.21-1.mga3 php-smarty-3.1.21-1.mga4 ```  ---   CC: (none) => oeAssignee: oe => qa-bugs  David Walser    2014-11-14 19:54:01 CET   Whiteboard: MGA3TOO => MGA3TOO has\_procedure  [Comment 8](show_bug.cgi?id=14465#c8)  claire robinson    2014-11-17 18:50:45 CET  ``` Testing complete mga4 64  Using modified PoC for our php-smarty path.  $ mkdir -p testing/templates $ cd testing  $ cat test.php  <?php require_once('/usr/share/php/Smarty/SmartyBC.class.php'); $smarty = new Smarty();  $smarty->setTemplateDir('templates/'); $smarty->setCompileDir('templates_c/'); $smarty->enableSecurity(); $smarty->force_compile = true; $tpl = $smarty->createTemplate('test.tpl'); $tpl->compileTemplateSource(); $smarty->display('test.tpl'); ?>  $ cat templates/test.tpl  {literal}<{/literal}script language=php>echo 1+1;</script>   Before ------ $ php ./test.php  2  This shows it has executed the script, echoing the result of 1 + 1.  After ----- $ rm -rf templates_c $ php ./test.php  <script language=php>echo 1+1;</script> ```  ---   Whiteboard: MGA3TOO has\_procedure => MGA3TOO has\_procedure mga4-64-ok  [Comment 9](show_bug.cgi?id=14465#c9)  David Walser    2014-11-17 19:06:24 CET  ``` Testing complete Mageia 3 i586 and Mageia 4 i586 using Claire's procedure in [Comment 8](show_bug.cgi?id=14465#c8).  I was able to reproduce the same results as she had, both before and after the update. ```  ---   Whiteboard: MGA3TOO has\_procedure mga4-64-ok => MGA3TOO has\_procedure mga4-32-ok mga4-64-ok mga3-32-ok  [Comment 10](show_bug.cgi?id=14465#c10)  olivier charles    2014-11-17 21:48:06 CET  ```  Testing on Mageia3-64 real HW  Using Claire's procedure in [comment 8](show_bug.cgi?id=14465#c8).  Current packages : ---------------- - php-smarty-3.1.11-4.mga3.noarch - php-smarty-doc-3.1.11-4.mga3.noarch  $ php ./test.php  2  Updated testing packages : ------------------------ - php-smarty-3.1.21-1.mga3.noarch - php-smarty-doc-3.1.21-1.mga3.noarch $ php ./test.php  <script language=php>echo 1+1;</script> ```  ---   CC: (none) => olchalWhiteboard: MGA3TOO has\_procedure mga4-32-ok mga4-64-ok mga3-32-ok => MGA3TOO has\_procedure mga4-32-ok mga4-64-ok mga3-32-ok MGA3-64-OK  [Comment 11](show_bug.cgi?id=14465#c11)  David Walser    2014-11-18 13:45:29 CET  ``` Thomas, Oden just informed me that php-pear-PhpDocumentor bundles more than just smarty, for instance php-ZendFramework2 as well.  I see nothing requires php-pear-PhpDocumentor.  Could we drop it from Cauldron? ```  [Comment 12](show_bug.cgi?id=14465#c12)  Oden Eriksson    2014-11-18 13:56:59 CET  ``` (In reply to David Walser from [comment #11](show_bug.cgi?id=14465#c11)) > Thomas, Oden just informed me that php-pear-PhpDocumentor bundles more than > just smarty, for instance php-ZendFramework2 as well.  I see nothing > requires php-pear-PhpDocumentor.  Could we drop it from Cauldron?  No, I meant php-pear-phpDocumentor that's in svn only. Not the same thing. ```  [Comment 13](show_bug.cgi?id=14465#c13)  David Walser    2014-11-18 14:08:47 CET  ``` (In reply to Oden Eriksson from [comment #12](show_bug.cgi?id=14465#c12)) > (In reply to David Walser from [comment #11](show_bug.cgi?id=14465#c11)) > > Thomas, Oden just informed me that php-pear-PhpDocumentor bundles more than > > just smarty, for instance php-ZendFramework2 as well.  I see nothing > > requires php-pear-PhpDocumentor.  Could we drop it from Cauldron? >  > No, I meant php-pear-phpDocumentor that's in svn only. Not the same thing.  Oh, I see.  OK.  I just dropped that one from SVN then. ```  [Comment 14](show_bug.cgi?id=14465#c14)  Oden Eriksson    2014-11-19 11:27:05 CET  ``` Note. For mga3 you also have:  <http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4437> ```  [Comment 15](show_bug.cgi?id=14465#c15)  David Walser    2014-11-19 13:34:00 CET  ``` Thanks Oden.  Use the [Comment 7](show_bug.cgi?id=14465#c7) advisory for Mageia 4.  For Mageia 3, use below:  Advisory (Mageia 3): ========================  Updated php-smarty packages fix security vulnerability:  Cross-site scripting (XSS) vulnerability in the SmartyException class in Smarty (aka smarty-php) before 3.1.12 allows remote attackers to inject arbitrary web script or HTML via unspecified vectors that trigger a Smarty exception (CVE-2012-4437).  Smarty before 3.1.21 allows remote attackers to bypass the secure mode restrictions and execute arbitrary PHP code as demonstrated by "{literal}<{/literal}script language=php>" in a template (CVE-2014-8350).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4437> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8350> <https://lists.fedoraproject.org/pipermail/package-announce/2014-November/142696.html> ```  [Comment 16](show_bug.cgi?id=14465#c16)  Rémi Verschelde    2014-11-19 13:47:17 CET  ``` Validating, advisories uploaded as 14465.mga3.adv and 14465.mga4.adv. ```  ---   Keywords: (none) => validated\_updateWhiteboard: MGA3TOO has\_procedure mga4-32-ok mga4-64-ok mga3-32-ok MGA3-64-OK => MGA3TOO has\_procedure mga4-32-ok mga4-64-ok mga3-32-ok MGA3-64-OK advisoryCC: (none) => remi, sysadmin-bugs  [Comment 17](show_bug.cgi?id=14465#c17)  Mageia Robot    2014-11-21 13:45:38 CET  ``` An update for this issue has been pushed to Mageia Updates repository.  <http://advisories.mageia.org/MGASA-2014-0468.html> ```  ---   Status: NEW => RESOLVEDResolution: (none) => FIXED  [Comment 18](show_bug.cgi?id=14465#c18)  Mageia Robot    2014-11-21 13:45:40 CET  ``` An update for this issue has been pushed to Mageia Updates repository.  <http://advisories.mageia.org/MGASA-2014-0469.html> ```  [Comment 19](show_bug.cgi?id=14465#c19)  David Walser    2014-11-24 20:46:14 CET  ``` LWN reference for CVE-2012-4437: <http://lwn.net/Vulnerabilities/622956/> ```  [Comment 20](show_bug.cgi?id=14465#c20)  Thomas Spuhler    2014-11-28 23:41:06 CET  ``` (In reply to Thomas Spuhler from [comment #5](show_bug.cgi?id=14465#c5)) > (In reply to David Walser from [comment #4](show_bug.cgi?id=14465#c4)) > > (In reply to Thomas Spuhler from [comment #3](show_bug.cgi?id=14465#c3)) > > > It's not that simple. > > > That patch was removed because of php-pear-PhpDocumentor crashing using the > > > system smarty. > >  > > I see. > >  > > > It was easy to fix because php-pear-PhpDocumentor provided a bundled > > > smarty-2.6.0. > > > What I see in the report, the security advisory only lists smarty-3 > >  > > While that's true, smarty2 has several unfixed security vulnerabilities and > > is unmaintained upstream.  In fact, I removed it from Cauldron today because > > of that.  Does PhpDocumenter have a solution upstream for using smarty3? >  > This package is not maintained upstream anymore except for bug fixes. My > take this isn't true either. > It has been replaced with PhpDocumenter-2.8.0. I don't see smarty in there. > Let me try to see if it builds.  I upgraded cauldron to phpDocumentor-2.8.1 (notice the spelling change) and obsoleted PhpDocumentor. I am not quite sure how to handle on mga4 (mga3 = EOL) Reopening the bug report ```  ---   Status: RESOLVED => REOPENEDResolution: FIXED => (none)Assignee: qa-bugs => thomas  [Comment 21](show_bug.cgi?id=14465#c21)  David Walser    2014-11-28 23:55:23 CET  ``` This bug is closed, php-smarty is fixed.  Feel free to open a new bug for phpDocumentor if you wish. ```  ---   Status: REOPENED => RESOLVEDResolution: (none) => FIXEDAssignee: thomas => qa-bugs |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=14465&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=14465)
* - [XML](show_bug.cgi?ctype=xml&id=14465)
* - [Clone ThisBug](enter_bug.cgi?cloned_bug_id=14465&normal=1)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=14465&GoAheadAndLogIn=1)

    [x]
  + |
    [New Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)



=== Content from code.google.com_037562e0_20250124_222949.html ===

[# Google Code](/archive/)

[## Archive](/archive/)
[Skip to content](#content)

The Google Code Archive requires JavaScript to be enabled in your browser.

* [Google](//www.google.com/)
* [About Google](//www.google.com/intl/en/about/)
* [Privacy](//www.google.com/intl/en/policies/privacy/)
* [Terms](//www.google.com/intl/en/policies/terms/)



=== Content from seclists.org_a31b9a28_20250124_222935.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](419)
[By Date](date.html#420)
[![Next](/images/right-icon-16x16.png)](421)

[![Previous](/images/left-icon-16x16.png)](419)
[By Thread](index.html#420)
[![Next](/images/right-icon-16x16.png)](421)

![](/shared/images/nst-icons.svg#search)

# CVE Request: smarty: secure mode bypass

---

*From*: Salvatore Bonaccorso <carnil () debian org>

*Date*: Wed, 22 Oct 2014 21:53:57 +0200

---

```
Hi

Can a CVE be assigned for the following smarty issue: upstream
released new version 3.1.21:

```
> ```
> Smarty 3.1.21 Released Oct 18, 2014
> Smarty 3.1.21 minor bug fixes and improvements. Also following up a
> security bug fix where <script language="php"> tags still worked in
> secure mode. To note, this only affects users using Smarty in secure
> mode and exposing templates to untrusted third parties.
>
> ```

```

Changelog: <https://code.google.com/p/smarty-php/source/browse/trunk/distribution/change_log.txt?r=4902>

Debian Bugreport: <https://bugs.debian.org/765920>

Regards,
Salvatore

```

---

[![Previous](/images/left-icon-16x16.png)](419)
[By Date](date.html#420)
[![Next](/images/right-icon-16x16.png)](421)

[![Previous](/images/left-icon-16x16.png)](419)
[By Thread](index.html#420)
[![Next](/images/right-icon-16x16.png)](421)

### Current thread:

* **CVE Request: smarty: secure mode bypass** *Salvatore Bonaccorso (Oct 22)*
  + [Re: CVE Request: smarty: secure mode bypass](421) *cve-assign (Oct 22)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from bugs.debian.org_0e6da6ad_20250126_040704.html ===

# Debian Bug report logs - #765920 smarty3: CVE-2014-8350: secure mode bypass

[![version graph](version.cgi?package=smarty3;found=smarty3%2F3.1.10-2;found=smarty3%2F3.0~rc1-1;absolute=0;width=2;height=2;collapse=1;fixed=smarty3%2F3.1.21-1)](version.cgi?absolute=0;found=smarty3%2F3.1.10-2;found=smarty3%2F3.0~rc1-1;package=smarty3;collapse=1;info=1;fixed=smarty3%2F3.1.21-1)

Package:
[smarty3](pkgreport.cgi?package=smarty3);
Maintainer for [smarty3](pkgreport.cgi?package=smarty3) is [Mike Gabriel <sunweaver@debian.org>](pkgreport.cgi?maint=sunweaver%40debian.org); Source for [smarty3](pkgreport.cgi?package=smarty3) is [src:smarty3](pkgreport.cgi?src=smarty3) ([PTS](https://tracker.debian.org/pkg/smarty3), [buildd](https://buildd.debian.org/smarty3), [popcon](https://qa.debian.org/popcon.php?package=smarty3)).

Reported by: [Thue <thuejk@gmail.com>](pkgreport.cgi?submitter=thuejk%40gmail.com)

Date: Sun, 19 Oct 2014 09:18:11 UTC

Severity: important

Tags: fixed-upstream, security, upstream

Found in versions smarty3/3.1.10-2, smarty3/3.0~rc1-1

Fixed in version smarty3/3.1.21-1

**Done:** Mike Gabriel <sunweaver@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=765920;mbox=yes), [status mbox](bugreport.cgi?bug=765920;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=765920;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Mike Gabriel <sunweaver@debian.org>`:

`Bug#765920`; Package `smarty3`.
(Sun, 19 Oct 2014 09:18:16 GMT) ([full text](bugreport.cgi?bug=765920;msg=2), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Thue <thuejk@gmail.com>`:

New Bug report received and forwarded. Copy sent to `Mike Gabriel <sunweaver@debian.org>`.

Your message had a Version: pseudo-header with an invalid package
version:

All below 3.1.21

please either use found or fixed to the control server with a correct
version, or reply to this report indicating the correct version so the
maintainer (or someone else) can correct it for you.

(Sun, 19 Oct 2014 09:18:16 GMT) ([full text](bugreport.cgi?bug=765920;msg=4), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=765920;msg=5), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=thuejk%40gmail.com)
From: Thue <thuejk@gmail.com>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: smarty3: Secure mode bypass
Date: Sun, 19 Oct 2014 11:17:51 +0200
```
Package: smarty3
Version: All below 3.1.21
Severity: important

Smarty secure mode should allow untrusted users to write templates,
without allowing them to execute arbitrary PHP code. However, all
smarty3 versions in Debian (sid, Jessie, stable, oldstable) currently
has a security hole allowing arbitrary PHP code execution if you can
edit templates.

Example:

test.php:
<?php
require_once('/home/thue/smarty/libs/SmartyBC.class.php');
$smarty = new Smarty();

$smarty->setTemplateDir('templates/');
$smarty->setCompileDir('templates_c/');
$smarty->enableSecurity();
$smarty->force_compile = true;
$tpl = $smarty->createTemplate('test.tpl');
$tpl->compileTemplateSource();
$smarty->display('test.tpl');
?>

templates/test.tpl:
{literal}<{/literal}script language=php>echo 1+1;</script>

If secure mode worked, that should output
   <script language=php>echo 1+1;</script>
In smarty3<3.1.21 it outputs
   2

Regards, Thue

-- System Information:
Debian Release: 7.6
  APT prefers stable-updates
  APT policy: (500, 'stable-updates'), (500, 'stable')
Architecture: amd64 (x86_64)

Kernel: Linux 3.2.0-4-amd64 (SMP w/2 CPU cores)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

```

---

**Reply sent**
to `Mike Gabriel <sunweaver@debian.org>`:

You have taken responsibility.
(Sun, 19 Oct 2014 22:23:03 GMT) ([full text](bugreport.cgi?bug=765920;msg=7), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=7), [link](#6)).

---

**Notification sent**
to `Thue <thuejk@gmail.com>`:

Bug acknowledged by developer.
(Sun, 19 Oct 2014 22:23:03 GMT) ([full text](bugreport.cgi?bug=765920;msg=9), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 765920-close@bugs.debian.org ([full text](bugreport.cgi?bug=765920;msg=10), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=sunweaver%40debian.org)
From: Mike Gabriel <sunweaver@debian.org>
To: 765920-close@bugs.debian.org
Subject: Bug#765920: fixed in smarty3 3.1.21-1
Date: Sun, 19 Oct 2014 22:20:19 +0000
```
Source: smarty3
Source-Version: 3.1.21-1

We believe that the bug you reported is fixed in the latest version of
smarty3, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 765920@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Mike Gabriel <sunweaver@debian.org> (supplier of updated smarty3 package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sun, 19 Oct 2014 23:45:18 +0200
Source: smarty3
Binary: smarty3
Architecture: source all
Version: 3.1.21-1
Distribution: unstable
Urgency: medium
Maintainer: Mike Gabriel <sunweaver@debian.org>
Changed-By: Mike Gabriel <sunweaver@debian.org>
Description:
 smarty3    - Template engine for PHP
Closes: [636148](bugreport.cgi?bug=636148) [765920](bugreport.cgi?bug=765920)
Changes:
 smarty3 (3.1.21-1) unstable; urgency=medium
 .
   * New upstream release. (Closes: #[765920](bugreport.cgi?bug=765920)).
   * debian/smarty3-lexer:
     + Add 4 files from smarty3 SVN that are used to generate some PHP
       files in the upstream tarball. See README.lexer for details.
       (Closes: #[636148](bugreport.cgi?bug=636148)).
   * debian/copyright:
     + Add copyright information for debian/smarty3-lexer/*.
     + Fix upstream license (LGPL-3 -> LGPL-3+) after reading the upstream-
       shipped COPYING.lib file more thoroughly.
     + Relicense debian/* under same license as upstream sources (LGPL-3+).
   * debian/control:
     + Bump Standards: to 3.9.6. No changes needed.
Checksums-Sha1:
 2f8d9a1ae833bdad64ca9587dbe27de26038f69b 1831 smarty3_3.1.21-1.dsc
 46edd54a87e1e33b1b4bee71999e92ba5c4273fb 207705 smarty3_3.1.21.orig.tar.gz
 0e551d2b1f6e0baa47f81ae72a88eee038ff60f6 15284 smarty3_3.1.21-1.debian.tar.xz
 8f8ad892d9fa2d87820de5707fd0acc8c98f9f7c 165714 smarty3_3.1.21-1_all.deb
Checksums-Sha256:
 4881917573a6143436502b04e307c4235bbaad88cd650629e6427155ab3defaa 1831 smarty3_3.1.21-1.dsc
 9597569443d80705fa7042bfa446786390b770e2ef4c49a08553a715cb1b93ed 207705 smarty3_3.1.21.orig.tar.gz
 4cf392556ebc83758ac581da21d23094c1d4f9594ca1b15ea3d01f4c7c4fbe98 15284 smarty3_3.1.21-1.debian.tar.xz
 2d85ce5b0732401e1a94f1a10c1fb3b490fbf141212b99c09d1dc32e4f02207d 165714 smarty3_3.1.21-1_all.deb
Files:
 17228eae8f6a6441e420781e99302737 1831 web optional smarty3_3.1.21-1.dsc
 44600c60cf473292529687de8e69134e 207705 web optional smarty3_3.1.21.orig.tar.gz
 b64fb34f3affc5bbef6d2d725930605f 15284 web optional smarty3_3.1.21-1.debian.tar.xz
 7028416490f250299b22332d6349752f 165714 web optional smarty3_3.1.21-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJURDbPAAoJEJr0azAldxsxe6IP/1O+JZX9kyzjFjZNNMv9jHBA
hCPNAVsuQNuevSe/MRheACkhOpInc8YL9r1XpwhtEJ/Efg2rDrKH1/vaGWmlFXC2
xYZMax3zjUXwAAtIg0qbaEE5n1U4tEMr7mHVDuelPwoybPXccvYkAMH4kYaNyEQY
kr1XZ76a53hl737Z/0yNE0wUWOh0+AAm9qX1Nk6gUqE+hRt0tdospcYXiN6fdFtu
tPYY2cMtugTSZ3bKXa8rmK2MAX76QkhgaohhJ+IdFfoeN3LuTwyHzw4k0+9zDppf
e/xADWtGGa/X+opP/G62YvaTvEjEvo3/mYH/Pl9BFgt1SUdaW3Zx3nLdLbrjmBB3
hqFRXSJHdHtml98ANJ14zMwSAmVO3ihscA9NsxzggQm0tun4DQAK7jL1p/1Ip8Pd
XBFq8fabiwC82MwAdDJx45RiXSWJ0bVotaAhSh6ngVwZ2hahDeAlbw/qKwNWxaDn
FawfZOQFb4Tj1DO+nbfShyu5bPGOKpASOyiuknzisgXwomIvHUAsS5id9AyCNkkt
bQhrE4EsfbxD2vlUqzbZErv2SzjNXuJ7l01GUDxaZJwgGDk42piIsvkaxsJdpB8X
MHEhgOW40bFLrAdn1llSlhkLcrbkET6SfWIquPenU/NkuqzMZEB8U03IHJbOZ8pg
oc8Hp1u52chAtDfx9wuf
=Vvf4
-----END PGP SIGNATURE-----

```

---

**Added tag(s) upstream.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:39:04 GMT) ([full text](bugreport.cgi?bug=765920;msg=12), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=12), [link](#11)).

---

**Added tag(s) fixed-upstream.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:39:08 GMT) ([full text](bugreport.cgi?bug=765920;msg=14), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=14), [link](#13)).

---

**Added tag(s) security.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:39:13 GMT) ([full text](bugreport.cgi?bug=765920;msg=16), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=16), [link](#15)).

---

**Marked as found in versions smarty3/3.1.10-2.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:51:15 GMT) ([full text](bugreport.cgi?bug=765920;msg=18), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=18), [link](#17)).

---

**Marked as found in versions smarty3/3.0~rc1-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 22 Oct 2014 19:51:16 GMT) ([full text](bugreport.cgi?bug=765920;msg=20), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=20), [link](#19)).

---

**Changed Bug title to 'smarty3: CVE-2014-8350: secure mode bypass' from 'smarty3: Secure mode bypass'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 25 Oct 2014 08:48:12 GMT) ([full text](bugreport.cgi?bug=765920;msg=22), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=22), [link](#21)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Thu, 27 Nov 2014 07:27:58 GMT) ([full text](bugreport.cgi?bug=765920;msg=24), [mbox](bugreport.cgi?bug=765920;mbox=yes;msg=24), [link](#23)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=765920).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 26 04:07:03 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


