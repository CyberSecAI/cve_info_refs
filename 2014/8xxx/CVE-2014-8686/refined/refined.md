```
{
  "vulnerability_details": {
    "root_cause": "The CodeIgniter framework, specifically versions prior to 2.2.0, uses a custom XOR-based encryption method for session cookies when the Mcrypt library isn't available. This method is weak and allows for easy decryption and manipulation of session data.",
    "weaknesses": [
      "Weak session cookie encryption using a custom XOR-based method.",
      "Use of a static encryption key across all installations of a CodeIgniter application.",
      "Storing session data client-side, in cookies, which are vulnerable to tampering.",
        "Unserialize of user supplied data from cookie",
      "Insufficient validation of session data (user agent, IP address checks) after unserialization.",
      "Reliance on MD5 for data integrity checking, which is susceptible to brute-force attacks."
    ],
    "impact": "An attacker can decrypt, modify, and re-encrypt session cookies to: \n\n*   Bypass IP/UserAgent restrictions for session hijacking.\n*   Perform object injection attacks through serialized data.\n*   Inject arbitrary session variables, potentially leading to authentication bypass or other exploits.\n*   Achieve remote code execution by manipulating the session 'language' parameter to include a malicious file." ,
    "attack_vectors": [
      "Man-in-the-middle attacks to capture session cookies.",
      "XSS to steal session cookies.",
      "Direct modification of session cookies.",
      "Brute-forcing of the encryption key using known data in the cookie.",
      "Exploitation of a local file inclusion via the session 'language' parameter."
    ],
    "required_attacker_capabilities": "Attacker needs to intercept, capture, or manipulate session cookies, and have knowledge of the weak encryption implementation. For remote code execution, the attacker needs to find a way to write a malicious PHP script on the file system.",
       "additional_details": "The vulnerability arises from the combination of insecure session data handling, weak encryption, and the use of `unserialize` on user-controlled data in the cookie. Specifically, the lack of proper server-side session management and reliance on a simple XOR encryption algorithm coupled with a predictable salt allows for cookie manipulation. This can lead to session hijacking, arbitrary code execution, and complete control over the application. The vulnerability is further exacerbated by the fact that all devices using this framework share the same encryption key, enabling an attacker to use a valid session from one instance on other instances."
  }
}
```