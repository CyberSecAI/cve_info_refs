- **Root cause of vulnerability**: A race condition exists in the `chan_pjsip` channel driver where actions (like answering or sending ringing) can be queued after a SIP session is terminated by a CANCEL request. The code then incorrectly assumes the session is active and attempts to send a SIP response, leading to an assertion in the PJSIP library.
- **Weaknesses/vulnerabilities present**: Race condition, incorrect session state handling.
- **Impact of exploitation**: Denial of Service (remote crash) due to an assertion in the PJSIP library.
- **Attack vectors**: Sending a CANCEL request to terminate a SIP session while also triggering actions that would send responses.
- **Required attacker capabilities/position**: Remote, unauthenticated attacker capable of sending SIP messages.