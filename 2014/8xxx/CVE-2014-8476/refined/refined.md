```
Root cause of vulnerability: When setlogin() is called, the login name is copied into an uninitialized stack buffer. This buffer is then copied into a buffer of the same size within the session structure. However, getlogin() returns the entire buffer, including the uninitialized part, instead of only the login name itself.
Weaknesses/vulnerabilities present: Kernel stack disclosure. The vulnerability arises from copying data into an uninitialized buffer and returning the whole buffer, leading to information leakage.
Impact of exploitation: An unprivileged user can read beyond the null terminator of the login name and leak kernel stack memory. This leaked memory might contain sensitive information such as file cache portions or terminal buffers, which can be used to gain elevated privileges.
Attack vectors: By calling the getlogin() system call, an attacker can read the uninitialized stack buffer. The attacker does not need elevated privileges.
Required attacker capabilities/position: The attacker needs to be able to execute code on the system and call the getlogin() system call. No special privileges are needed.
```