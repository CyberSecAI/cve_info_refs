=== Content from www.redteam-pentesting.de_f34c628b_20250126_071814.html ===
+49 241 510081-0kontakt@redteam-pentesting.de[DE](/de/advisories/rt-sa-2014-009/)[![RedTeam Pentesting Logo](/img/redteam-logo_hub5a66d245245ce30f53b50d2b4dfb31b_19123_120x0_resize_q100_h2_box_3.webp)](/)[DE](/de/advisories/rt-sa-2014-009/ "Deutsche Version")

* Company
  Company
  + [About us](/en/redteam/)
  + [History](/en/redteam/history/)
  + [Press](/en/press/)
  + [News Archive](/en/archive/)
* Pentest
  Pentest
  + [Definition](/en/pentest/)
  + [Types of Tests](/en/pentest/types/)
  + [Workflow](/en/pentest/workflow/)
  + [FAQ](/en/faq/)
* Publications
  Publications
  + [Overview](/en/publications/)
  + [Advisories](/en/advisories/)
  + [Talks](/en/talks/)
  + [Other Publications](/en/publications-other/)
* [Career](https://jobs.redteam-pentesting.de/)
* [Blog](https://blog.redteam-pentesting.de/)
* [Contact](#contactform)

Contact

Contact us

+49 241 510081-0kontakt@redteam-pentesting.de[Contact form](#contactform)JavaScript is not enabled in your browser. Please consider that some functions might not be available for you.![RedTeam Pentesting Header](/img/header/hl_header-1_hu0f2d230fb5185511a90e67c2e597c0b5_900546_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-2_hub774373357e916cb041b4943299d8717_1132770_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-3_hub8fc12cb70b2021e589c6810b4b53d04_895916_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-4_hu27d71f64bf1f030161a23c2dcd666f59_1015002_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-5_hud32f8d698ff23308f4d8b8566aae5928_933115_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-6_hu1bc03534cd122894ef676fff89833ac5_1144618_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-7_hu91e55bd77169043ae9e542f1b5f8f2f4_1354043_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-8_hu155130647c165410f2ffa35227549138_1321813_1000x0_resize_q100_h2_box.webp)[newer](https://www.redteam-pentesting.de/en/advisories/rt-sa-2014-010/)[back to overview](/en/advisories)[older](https://www.redteam-pentesting.de/en/advisories/rt-sa-2014-008/)

[Text Version](/en/advisories/rt-sa-2014-009.txt)

## Information Disclosure in TYPO3 Extension ke\_questionnaire

The TYPO3 extension ke\_questionnaire stores answered questionnaires in a
publicly reachable directory on the webserver with filenames that are
easily guessable.

### Details

* Product: ke\_questionnaire
* Affected Versions: 2.5.2 (possibly all versions)
* Fixed Versions: unknown
* Vulnerability Type: Information Disclosure
* Security Risk: medium
* Vendor URL: `http://kequestionnaire.kennziffer.com/`
* Vendor Status: notified
* Advisory URL: `https://www.redteam-pentesting.de/advisories/rt-sa-2014-009`
* Advisory Status: published
* CVE: CVE-2014-8874
* CVE URL: `https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8874`

### Introduction

“The TYPO3 extension kequestionnaire allows to easily and quickly create
and evaluate individual questionnaires online in any TYPO3 website.”

(translated from the official website of ke\_questionnaire)

### More Details

Files containing the answered questionnaires are stored in the
“typo3temp” directory within the TYPO3 installation. As the source code
of the ke\_questionnaire extension shows, the filename of an answered
questionnaire is solely based on the questionnaire ID and the user ID of
the user who created the questionnaire.

Source code (shortened):
.. code:

```
function init() {
    global $BE_USER,$LANG,$BACK_PATH,$TCA_DESCR,$TCA,$CLIENT,$TYPO3_CONF_VARS;

    $this->temp_file = \
'tx_kequestionnaire_temp_'.$this->q_id.'_'.$GLOBALS['BE_USER']->user['uid'];
    [...]
}
[...]
function createSchedulerTask(){
    $myVars = $GLOBALS['BE_USER']->getSessionData('tx_kequestionnaire');
    $file_path = PATH_site.'typo3temp/'.$this->temp_file;
    [...]
}

```

A valid URL that returns the answers to a questionnaire could look like
the following:

`http://www.example.com/typo3temp/tx_kequestionnaire_temp_15999_7`

### Proof of Concept

Using the tool wfuzz (<https://code.google.com/p/wfuzz/>) it is possible to search for answers to
questionnaires on a TYPO3 site that employs ke\_questionnaire:

```
$ python wfuzz.py -c -z range,14000-15000 -z range,1-10 --hc 301 \
  http://example.com/typo3temp/tx_kequestionnaire_temp_FUZZ_FUZ2Z

```
### Workaround

The webserver config should deny access to answered questionnaire files,
for example by adding an .htaccess file that limits access to
[tx\_kequestionnaire](/en/)\* files (this may hinder online evaluation of the
questionnaires).

### Fix

No official fix available.

### Security Risk

Depending on the questions in the questionnaire the answered
questionnaires may contain personal information including participants'
full names, addresses and so on. The risk therefore strongly depends on
the information supplied in the questionnaires. Since this information
will at least often contain email addresses, it is rated as at least a
medium risk.

### Timeline

* 2014-04-21 Vulnerability identified
* 2014-04-30 Customer approved disclosure to vendor
* 2014-05-13 Vendor notified
* 2014-05-20 Vendor works with TYPO3 security team on a fix
* 2014-06-15 Vendor releases updated version which according to them
  does not fix the issue
* 2014-10-08 TYPO3 security team says the issue is still unresolved
* 2014-11-04 Vendor continues to release updated versions, no response
  whether the security issue is fixed
* 2014-11-14 CVE number assigned
* 2014-12-01 Advisory released

### RedTeam Pentesting GmbH

RedTeam Pentesting offers individual penetration tests, short pentests,
performed by a team of specialised IT-security experts. Hereby, security
weaknesses in company networks or products are uncovered and can be
fixed immediately.

As there are only few experts in this field, RedTeam Pentesting wants to
share its knowledge and enhance the public knowledge with research in
security-related areas. The results are made available as public
security advisories.

More information about RedTeam Pentesting can be found at
<https://www.redteam-pentesting.de>.

# Contact us

We are happy to advise you and answer your questions.Contact dataPhone: +49 241 510081-0
Email: kontakt@redteam-pentesting.de
([GnuPG/PGP public key](/gpg/RedTeam-Pentesting-GPG-Kontakt-Key.asc))Visit and Postal AddressRedTeam Pentesting GmbH
Alter Posthof 1
52062 AachenEmployees of RedTeam Pentesting may be contacted directly at
firstname.lastname@redteam-pentesting.de:
([GnuPG/PGP public keys](/gpg/RedTeam-Pentesting-GPG-All-Keys.asc))Contact formâ![CAPTCHA]()
I agree to the transmission and processing of my data to RedTeam Pentesting according to RedTeam Pentesting’s [privacy policy](/en/imprint/privacy).
Company

* [About us](/en/redteam/)
* [History](/en/redteam/history/)
* [Press](/en/press/)
* [News Archive](/en/archive/)
Pentest

* [Definition](/en/pentest/)
* [Types of Tests](/en/pentest/types/)
* [Workflow](/en/pentest/workflow/)
* [FAQ](/en/faq/)
Publications

* [Overview](/en/publications/)
* [Advisories](/en/advisories/)
* [Talks](/en/talks/)
* [Other Publications](/en/publications-other/)
[Career](https://jobs.redteam-pentesting.de/)[Blog](https://blog.redteam-pentesting.de/)[Contact](#contactform)[Imprint](/en/imprint/) |
[Privacy Policy](/en/imprint/privacy/)

=== Content from seclists.org_b17ca1d0_20250125_073734.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](0)
[By Date](date.html#1)
[![Next](/images/right-icon-16x16.png)](2)

[![Previous](/images/left-icon-16x16.png)](0)
[By Thread](index.html#1)
[![Next](/images/right-icon-16x16.png)](2)

![](/shared/images/nst-icons.svg#search)

# [RT-SA-2014-009] Information Disclosure in TYPO3 Extension ke\_questionnaire

---

*From*: RedTeam Pentesting GmbH <release () redteam-pentesting de>

*Date*: Mon, 1 Dec 2014 15:22:35 +0100

---

```
Advisory: Information Disclosure in TYPO3 Extension ke_questionnaire

The TYPO3 extension ke_questionnaire stores answered questionnaires in a
publicly reachable directory on the webserver with filenames that are
easily guessable.

Details
=======

Product: ke_questionnaire
Affected Versions: 2.5.2 (possibly all versions)
Fixed Versions: unknown
Vulnerability Type: Information Disclosure
Security Risk: medium
Vendor URL: <http://kequestionnaire.kennziffer.com/>
Vendor Status: notified
Advisory URL: <https://www.redteam-pentesting.de/advisories/rt-sa-2014-009>
Advisory Status: published
CVE: CVE-2014-8874
CVE URL: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8874>

Introduction
============

"The TYPO3 extension kequestionnaire allows to easily and quickly create
and evaluate individual questionnaires online in any TYPO3 website."

(translated from the official website of ke_questionnaire)

More Details
============

Files containing the answered questionnaires are stored in the
"typo3temp" directory within the TYPO3 installation. As the source code
of the ke_questionnaire extension shows, the filename of an answered
questionnaire is solely based on the questionnaire ID and the user ID of
the user who created the questionnaire.

Source code (shortened):
------------------------------------------------------------------------------
function init() {
    global $BE_USER,$LANG,$BACK_PATH,$TCA_DESCR,$TCA,$CLIENT,$TYPO3_CONF_VARS;

    $this->temp_file = \
'tx_kequestionnaire_temp_'.$this->q_id.'_'.$GLOBALS['BE_USER']->user['uid'];
    [...]
}
[...]
function createSchedulerTask(){
    $myVars = $GLOBALS['BE_USER']->getSessionData('tx_kequestionnaire');
    $file_path = PATH_site.'typo3temp/'.$this->temp_file;
    [...]
}
------------------------------------------------------------------------------

A valid URL that returns the answers to a questionnaire could look like
the following:

<http://www.example.com/typo3temp/tx_kequestionnaire_temp_15999_7>

Proof of Concept
================

Using the tool wfuzz[1] it is possible to search for answers to
questionnaires on a TYPO3 site that employs ke_questionnaire:

------------------------------------------------------------------------
$ python wfuzz.py -c -z range,14000-15000 -z range,1-10 --hc 301 \
  <http://example.com/typo3temp/tx_kequestionnaire_temp_FUZZ_FUZ2Z>
------------------------------------------------------------------------

Workaround
==========

The webserver config should deny access to answered questionnaire files,
for example by adding an .htaccess file that limits access to
tx_kequestionnaire_* files (this may hinder online evaluation of the
questionnaires).

Fix
===

No official fix available.

Security Risk
=============

Depending on the questions in the questionnaire the answered
questionnaires may contain personal information including participants'
full names, addresses and so on. The risk therefore strongly depends on
the information supplied in the questionnaires. Since this information
will at least often contain email addresses, it is rated as at least a
medium risk.

Timeline
========

2014-04-21 Vulnerability identified
2014-04-30 Customer approved disclosure to vendor
2014-05-13 Vendor notified
2014-05-20 Vendor works with TYPO3 security team on a fix
2014-06-15 Vendor releases updated version which according to them
           does not fix the issue
2014-10-08 TYPO3 security team says the issue is still unresolved
2014-11-04 Vendor continues to release updated versions, no response
           whether the security issue is fixed
2014-11-14 CVE number assigned
2014-12-01 Advisory released

References
==========

[1] <https://code.google.com/p/wfuzz/>

RedTeam Pentesting GmbH
=======================

RedTeam Pentesting offers individual penetration tests, short pentests,
performed by a team of specialised IT-security experts. Hereby, security
weaknesses in company networks or products are uncovered and can be
fixed immediately.

As there are only few experts in this field, RedTeam Pentesting wants to
share its knowledge and enhance the public knowledge with research in
security-related areas. The results are made available as public
security advisories.

More information about RedTeam Pentesting can be found at
<https://www.redteam-pentesting.de>.

--
RedTeam Pentesting GmbH                   Tel.: +49 241 510081-0
Dennewartstr. 25-27                       Fax : +49 241 510081-99
52068 Aachen                    <https://www.redteam-pentesting.de>
Germany                         Registergericht: Aachen HRB 14004
Geschäftsführer:                       Patrick Hof, Jens Liebchen

```

**Attachment:
[signature.asc](att-1/signature_asc.bin)**

*Description:* Digital signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](0)
[By Date](date.html#1)
[![Next](/images/right-icon-16x16.png)](2)

[![Previous](/images/left-icon-16x16.png)](0)
[By Thread](index.html#1)
[![Next](/images/right-icon-16x16.png)](2)

### Current thread:

* **[RT-SA-2014-009] Information Disclosure in TYPO3 Extension ke\_questionnaire** *RedTeam Pentesting GmbH (Dec 01)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


