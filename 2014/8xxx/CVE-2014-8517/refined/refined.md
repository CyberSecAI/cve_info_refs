Based on the provided content, here's a breakdown of the vulnerability described by CVE-2014-8517:

**Root Cause of Vulnerability:**
The `tnftp` client, when used to fetch data via HTTP, would derive the output filename from the URL path if no output file was specified using the `-o` option. If the derived filename started with a pipe character (`|`), the client would pass the rest of the filename as a command to `popen()`, leading to arbitrary command execution. This command injection vulnerability occurs due to insufficient validation of the filename derived from the URL.

**Weaknesses/Vulnerabilities Present:**
*   **Command Injection:** The primary vulnerability is a command injection flaw. The `ftp` client interprets a specially crafted filename as a command.
*   **Insufficient Input Validation:** The client fails to properly sanitize or validate the filename extracted from the URL, specifically not checking for the presence of a leading `|` character.

**Impact of Exploitation:**
*   **Arbitrary Command Execution:** A remote attacker can execute arbitrary commands on the victim's machine with the privileges of the user running the `tnftp` command.

**Attack Vectors:**
*   **HTTP Redirects:** The attacker uses a malicious HTTP server that responds with a redirect to a URL containing the malicious command.
*   **Lack of `-o` Option:** Exploitation relies on the user not specifying an output file using the `-o` command-line option.

**Required Attacker Capabilities/Position:**
*   **Remote:** The attacker needs a web server to host the malicious redirect and crafted URL.
*   **Network Access:** The attacker must be able to induce a user to utilize the vulnerable `tnftp` client to access their malicious web server.

**Additional Details:**
*   The vulnerability is present in the `fetch.c` file of the `tnftp` client.
*   The fix involves checking if the output filename is from the command line before treating special characters like `|` as commands.
*   The vulnerability affects NetBSD, FreeBSD, Dragonfly, and macOS systems that utilize the vulnerable tnftp client.
*   The Metasploit module `tnftp_savefile.rb` has been created to exploit this vulnerability.