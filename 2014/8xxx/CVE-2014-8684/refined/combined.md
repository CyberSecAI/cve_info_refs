=== Content from seclists.org_fcff110d_20250125_222833.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](53)
[By Date](date.html#54)
[![Next](/images/right-icon-16x16.png)](55)

[![Previous](/images/left-icon-16x16.png)](53)
[By Thread](index.html#54)
[![Next](/images/right-icon-16x16.png)](58)

![](/shared/images/nst-icons.svg#search)

# CodeIgniter <= 2.1.4 and Kohana <= 3.2.3, 3.3.2 - Timing Attacks and Object Injection

---

*From*: Scott Arciszewski <kobrasrealm () gmail com>

*Date*: Mon, 12 May 2014 22:46:48 -0400

---

```
Background info and boring history shit:
<https://scott.arciszewski.me/research/view/php-framework-timing-attacks-object-injection>

Vulnerability:
1. Remote timing attack
2. PHP Object Injection
3. Possibly, as a result of 2, remote code execution

Affects:
- CodeIgniter (<= 2.1.4)
- Kohana (<= 3.2.3, 3.3.2)

Some PHP frameworks (CodeIgniter and Kohana, for sure), give you the option
of storing $_SESSION data in a cookie, then appending a hash of the session
data and an unknown key.

For example:

a:2:{s:1:"a";s:10:"douchelord";s:8:"is_admin";b:0;}5c2d88368e2c154398e77269c3af3edd

Vulnerability 1 - Remote Timing Attack

<https://github.com/EllisLab/CodeIgniter/blob/master/system/libraries/Session.php#L159>
<https://github.com/kohana/core/blob/3.3/master/classes/Kohana/Cookie.php#L74>

If you wanted to alter the above serialized blob to read:

a:2:{s:1:"a";s:5:"admin";s:8:"is_admin";b:1;}

... in theory, you would need to either know the encryption key stored in
the framework's configuration. And remotely brute-forcing an md5/sha1 hash
isn't really attractive.

Luckily, the behavior of standard string comparison operators (== and ===)
is to return false as soon as two bytes do not match. Thus we could
discover that...

a:2:{s:1:"a";s:5:"admin";s:8:"is_admin";b:1;}ef000000000000000000000000000000

...takes a little longer than...

a:2:{s:1:"a";s:5:"admin";s:8:"is_admin";b:1;}00000000000000000000000000000000

... and then ...

a:2:{s:1:"a";s:5:"admin";s:8:"is_admin";b:1;}ef870000000000000000000000000000

... will take slightly longer.

Theoretically, if we need 100 samples per possible hexit to guess the
correct value through this strategy, and there are 32 hexits in a hash, at
10 request per second it will take 51200 samples to crack an md5 hash. If
you can guess 50 per second without bringing the target server to its
knees, that's about 18 minutes (worst case) to get the end result:

a:2:{s:1:"a";s:5:"admin";s:8:"is_admin";b:1;}ef87978c40e2c2871ba58ab55b50854e

Vulnerability 2 - PHP Object Injection

If you can convince PHP to pass arbitrary data to unserialize(), which is
the automatic next step when the timing attack succeeds, then you can
inject objects into the code. From what I understand, this can also lead to
remote code execution.

CodeIgniter already patched this in its 3.0/develop branch.
Kohana accepted my pull request for its 3.3/develop branch:
<https://github.com/kohana/core/pull/492>

Note: Kohana uses SHA1, not MD5, so add another 20% to my estimate.

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](53)
[By Date](date.html#54)
[![Next](/images/right-icon-16x16.png)](55)

[![Previous](/images/left-icon-16x16.png)](53)
[By Thread](index.html#54)
[![Next](/images/right-icon-16x16.png)](58)

### Current thread:

* **CodeIgniter <= 2.1.4 and Kohana <= 3.2.3, 3.3.2 - Timing Attacks and Object Injection** *Scott Arciszewski (May 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_4ebd5f22_20250125_222834.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkohana%2Fcore%2Fpull%2F492)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkohana%2Fcore%2Fpull%2F492)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=kohana%2Fcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kohana](/kohana)
/
**[core](/kohana/core)**
Public

* [Notifications](/login?return_to=%2Fkohana%2Fcore) You must be signed in to change notification settings
* [Fork
  326](/login?return_to=%2Fkohana%2Fcore)
* [Star
   632](/login?return_to=%2Fkohana%2Fcore)

* [Code](/kohana/core)
* [Issues
  26](/kohana/core/issues)
* [Pull requests
  14](/kohana/core/pulls)
* [Actions](/kohana/core/actions)
* [Projects
  0](/kohana/core/projects)
* [Security](/kohana/core/security)
* [Insights](/kohana/core/pulse)

Additional navigation options

* [Code](/kohana/core)
* [Issues](/kohana/core/issues)
* [Pull requests](/kohana/core/pulls)
* [Actions](/kohana/core/actions)
* [Projects](/kohana/core/projects)
* [Security](/kohana/core/security)
* [Insights](/kohana/core/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fkohana%2Fcore%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fkohana%2Fcore%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# 3.3/develop #492

 Merged

[shadowhand](/shadowhand)
merged 2 commits into
[kohana:3.3/develop](/kohana/core/tree/3.3/develop "kohana/core:3.3/develop")
from
sarciszewski:3.3/develop

May 13, 2014

 Merged

# [3.3/develop](#top) #492

[shadowhand](/shadowhand)
merged 2 commits into
[kohana:3.3/develop](/kohana/core/tree/3.3/develop "kohana/core:3.3/develop")
from
sarciszewski:3.3/develop

May 13, 2014

[Conversation
1](/kohana/core/pull/492)
[Commits
2](/kohana/core/pull/492/commits)
[Checks
0](/kohana/core/pull/492/checks)
[Files changed](/kohana/core/pull/492/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![sarciszewski](https://avatars.githubusercontent.com/u/3710836?s=60&v=4)](/sarciszewski)

Copy link

Contributor

### @sarciszewski **[sarciszewski](/sarciszewski)** commented [May 13, 2014](#issue-33361716)

Now on the correct branch!

When cryptographic hashes are compared with the `===` operator, they are susceptible to remote timing attacks. This patch affects the cookie-based session driver as well as `Security::check($token)`; you may wish to also patch other hash comparison functions.

`slow_equals()` taken from <https://defuse.ca/php-pbkdf2.htm>

Sorry, something went wrong.

All reactions

 [sarciszewski](/sarciszewski)
added 2 commits
[May 12, 2014 21:15](#commits-pushed-1228996)

[![@sarciszewski](https://avatars.githubusercontent.com/u/3710836?s=40&v=4)](/sarciszewski)

`[Update Security.php](/kohana/core/pull/492/commits/122899681eb7073fc72c0a62d8df66fea035f56d "Update Security.php")`

`[1228996](/kohana/core/pull/492/commits/122899681eb7073fc72c0a62d8df66fea035f56d)`

[![@sarciszewski](https://avatars.githubusercontent.com/u/3710836?s=40&v=4)](/sarciszewski)

`[Update Cookie.php](/kohana/core/pull/492/commits/ee0e121c665100b8f6899149db3cdea4cf0f7f6b "Update Cookie.php")`

`[ee0e121](/kohana/core/pull/492/commits/ee0e121c665100b8f6899149db3cdea4cf0f7f6b)`

[shadowhand](/shadowhand)
pushed a commit
that referenced
this pull request
[May 13, 2014](#ref-commit-66b409a)

`[Merge pull request](/kohana/core/commit/66b409a6da2960130888989534ff1799532b8f32 "Merge pull request #492 from sarciszewski/3.3/develop

Add Security::slow_equals and make use of it in Cookie::get and Security::check") [#492](https://github.com/kohana/core/pull/492) [from sarciszewski/3.3/develop](/kohana/core/commit/66b409a6da2960130888989534ff1799532b8f32 "Merge pull request #492 from sarciszewski/3.3/develop

Add Security::slow_equals and make use of it in Cookie::get and Security::check")`
…

`[66b409a](/kohana/core/commit/66b409a6da2960130888989534ff1799532b8f32)`

```
Add Security::slow_equals and make use of it in Cookie::get and Security::check
```

[![@shadowhand](https://avatars.githubusercontent.com/u/38203?s=40&u=df5c370c2f89bec5c3f3b220bc599fd049dac8ee&v=4)](/shadowhand)
[shadowhand](/shadowhand)
merged commit [`66b409a`](/kohana/core/commit/66b409a6da2960130888989534ff1799532b8f32)
into
kohana:3.3/develop

[May 13, 2014](https://github.com/kohana/core/pull/492#event-120399845)

[![@shadowhand](https://avatars.githubusercontent.com/u/38203?s=80&u=df5c370c2f89bec5c3f3b220bc599fd049dac8ee&v=4)](/shadowhand)

Copy link

Contributor

### **[shadowhand](/shadowhand)** commented [May 13, 2014](#issuecomment-42911709)

| Thanks again! |
| --- |

All reactions

Sorry, something went wrong.

 [![@sarciszewski](https://avatars.githubusercontent.com/u/3710836?s=40&u=1491cd961f9a2ed0f4351f4b68375fd46941c770&v=4)](/sarciszewski)
[sarciszewski](/sarciszewski)
deleted the
3.3/develop

branch
[May 13, 2014 04:05](#event-120411184)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fkohana%2Fcore%2Fpull%2F492)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@sarciszewski](https://avatars.githubusercontent.com/u/3710836?s=52&v=4)](/sarciszewski) [![@shadowhand](https://avatars.githubusercontent.com/u/38203?s=52&v=4)](/shadowhand)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_265bfbc5_20250125_222832.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


