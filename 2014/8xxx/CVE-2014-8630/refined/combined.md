=== Content from advisories.mageia.org_efba4b46_20250125_152304.html ===

# [Advisories](index.html) » MGASA-2015-0048

## Updated bugzilla packages fix CVE-2014-8630

Publication date: 31 Jan 2015

Modification date: 31 Jan 2015

Type: security

Affected Mageia releases :
[4](4.html)

CVE:
[CVE-2014-8630](CVE-2014-8630.html)

## Description

```
Updated bugzilla packages fix security vulnerability:

Some code in Bugzilla does not properly utilize 3 arguments form for open()
and it is possible for an account with editcomponents permissions to inject
commands into product names and other attributes (CVE-2014-8630).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=15134>
* <http://www.bugzilla.org/security/4.0.15/>
* <http://www.bugzilla.org/releases/4.4.8/release-notes.html>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8630>

## SRPMS

### 4/core

* bugzilla-4.4.8-1.mga4



=== Content from security.gentoo.org_fdd30520_20250125_152310.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Bugzilla: Multiple vulnerabilities — GLSA **201607-11**

Multiple vulnerabilities have been found in Bugzilla, the worst of
which could lead to the escalation of privileges.

### Affected packages

| Package | **www-apps/bugzilla** on all architectures |
| --- | --- |
| Affected versions | < **5.0.3** |
| Unaffected versions | >= **5.0.3**revision > **4.4.12** |

### Background

Bugzilla is the bug-tracking system from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Bugzilla. Please review
the CVE identifiers referenced below for details.

### Impact

Privileged account holders could execute system level commands, and the
new user process could be exploited to allow for the escalation of
privileges.

### Workaround

There is no known workaround at this time.

### Resolution

All Bugzilla 4.x users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/bugzilla-4.4.12"

```

All Bugzilla 5.x users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/bugzilla-5.0.3"

```
### References

* [CVE-2014-1572](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1572)
* [CVE-2014-1573](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1573)
* [CVE-2014-8630](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8630)

**Release date**

July 20, 2016

**Latest revision**

July 20, 2016: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [524316](https://bugs.gentoo.org/show_bug.cgi?id=524316)
* [537448](https://bugs.gentoo.org/show_bug.cgi?id=537448)
* [560406](https://bugs.gentoo.org/show_bug.cgi?id=560406)
* [583236](https://bugs.gentoo.org/show_bug.cgi?id=583236)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from wiki.mozilla.org_73f8d6fa_20250126_095137.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.bugzilla.org_40405eca_20250125_152306.html ===

[![Bugzilla Logo](/assets/img/logo-header.svg)
Bugzilla](/)
Show Nav Menu

* [About](/about/ "Find out more about Bugzilla.")
  [Project](/about/ "Find out more about Bugzilla.")
  [Features](/about/features.html)
  [Who Uses Bugzilla?](/about/installation-list.html "Hundreds of companies and organizations trust Bugzilla.")
  [Meet the Team](/about/developers "Meet the Bugzilla team.")
  [Zarro Boogs Corporation](/about/zarroboogs.html "Find out about the company managing the Bugzilla Project.")
* [News](/blog/ "Get the low down on what's happening with the project.")
  [Blog](/blog/ "Bugzilla Blog")
  [Release Information](/releases/ "Information on current and previous releases.")
  [Security Advisories](/security/ "Important updates regarding Bugzilla security.")
  [Planet Bugzilla](http://planet.bugzilla.org "View the status of the Bugzilla project.")
* [Download](/download/ "Download Bugzilla")
* [Documentation](/docs/ "Bugzilla Documentation")
* [Support](/support/ "Find out where to get more information and help.")
* [Contribute](/contributing/ "Ways you can help Bugzilla")
  [How to?](/contributing/ "Ways you can help Bugzilla")
  [Report a Bug](/contributing/reporting_bugs "Let us know if there is an error in Bugzilla.")
  [Donate](/donate "Donate to Bugzilla, and see how your money is used.")
  [Wiki](https://wiki.mozilla.org/Bugzilla%3AHome "Collaboratively updated information about Bugzilla.")

Search bugzilla.org

1. [Security Advisories](/security/)
2. 5.0rc1, 4.4.6, 4.2.11, and 4.0.15 Security Advisory

# 5.0rc1, 4.4.6, 4.2.11, and 4.0.15 Security Advisory

Wednesday, Jan 21st, 2015
```

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* A user with editcomponents permissions could possibly inject system
  commands in product names and possibly other attributes.

* Methods from imported modules could possibly be executed using
  the WebService API.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Command Injection
Affected:    All versions before 4.0.16, 4.1.1 to 4.2.11, 4.3.1 to 4.4.6, 4.5.1 to 4.5.6
Fixed In:    4.0.16, 4.2.12, 4.4.7, 5.0rc1
Description: Some code in Bugzilla does not properly utilize 3 arguments form
             for open() and it is possible for an account with editcomponents
             permissions to inject commands into product names and other
             attributes.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=1079065
CVE Number:  CVE-2014-8630

Class:       Information Leak
Affected:    2.23.3 to 4.0.15, 4.1.1 to 4.2.11, 4.3.1 to 4.4.6, 4.5.1 to 4.5.6
Fixed In:    4.0.16, 4.2.12, 4.4.7, 5.0rc1
Description: Some code in Bugzilla does not properly utilize 3 arguments form
             for open() and it is possible for an account with editcomponents
             permissions to inject commands into product names and other
             attributes.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=1090275

Vulnerability Solutions
=======================

The fix for these issues is included in the
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issues at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  https://www.bugzilla.org/download/

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix this
issue:

Issue 1 Reporter: John Lightsey
Issue 1 Fixed by: Gervase Markham, David Lawrence, Dylan Hardison

Issue 2 Reporter: David Lawrence
Issue 2 Fixed by: Gervase Markham, David Lawrence, Dylan Hardison

General information about the Bugzilla bug-tracking system can be found
at:

  https://www.bugzilla.org/

Comments and follow-ups can be directed to the support-bugzilla mailing list.
https://www.bugzilla.org/support/ has directions for accessing this forum.

```

* [GitHub
  GitHub](https://github.com/bugzilla "GitHub")
* [X](https://x.com/%40bugzilla "X")
* [Mastodon
  Mastodon](https://techhub.social/%40bugzilla "Mastodon")
* [Bluesky](https://bsky.app/profile/bugzilla.org "Bluesky")
* [Facebook
  Facebook](https://www.facebook.com/BugzillaProject "Facebook")
* [LinkedIn
  LinkedIn](https://www.linkedin.com/company/bugzilla-project "LinkedIn")
* [IRC
  IRC on Libera.Chat](https://web.libera.chat/#/#bugzilla "IRC on Libera.Chat")
* [Discord
  Discord](https://discord.gg/ZhN6uBA "Discord")
* [Matrix
  Matrix](https://matrix.to/#/#bugzilla:mozilla.org "Matrix")
* [YouTube
  YouTube](https://www.youtube.com/%40bugzillaproject "YouTube")
* [Twitch
  Twitch](https://twitch.tv/bugzillaproject "Twitch")

---

Copyright © 1998-2024 bugzilla.org contributors
Creative Commons Attribution-ShareAlike 2.0[Creative CommonsAttributionShareAlike](https://creativecommons.org/licenses/by-sa/2.0/)



=== Content from bugzilla.mozilla.org_1c88fe33_20250126_095136.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1079065)
* [XML](/show_bug.cgi?ctype=xml&id=1079065)

Closed
[Bug 1079065](/show_bug.cgi?id=1079065)
(CVE-2014-8630)

Opened 10 years ago
Closed 10 years ago

# [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] Always use the 3 arguments form for open() to prevent shell code injection

## Categories

### (Bugzilla :: Bugzilla-General, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Bugzilla-General#Bugzilla-General)

Bugzilla-General
▾

Bugzilla :: Bugzilla-General
Anything that doesn't fit in the other components, or spans multiple components.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Bugzilla-General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

4.4.6

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 4.0

## People

### (Reporter: john, Assigned: gerv)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/559c3cf31c98a95b23421186b78df500?d=mm&size=40)  [gerv](/user_profile?user_id=9911)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/64d154af0913123d213e4ce4f80280c9?d=mm&size=40)  [john](/user_profile?user_id=519664)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1118994](/show_bug.cgi?id=1118994 "RESOLVED FIXED - Security advisory for Bugzilla 5.0rc1, 4.4.7, 4.2.12, and 4.0.16"), [1124432](/show_bug.cgi?id=1124432 "RESOLVED FIXED - Backport upstream bug 1079065 to bmo/4.2 to fix improper use of open() calls")

Dependency [tree](/showdependencytree.cgi?id=1079065&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1079065)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: exploitation requires admin or editcomponents permissions)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2014-8630

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

exploitation requires admin or editcomponents permissions

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [mail](/user_profile?user_id=124400) | [approval](#a618506_124400 "10 years ago") | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | approval | + |
| --- | --- | --- |
| [glob](/user_profile?user_id=13647) | [approval5.0](#a1726088_13647 "10 years ago") | + |
| --- | --- | --- |
| [glob](/user_profile?user_id=13647) | approval5.0 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking5.0](#c45 "10 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking5.0 | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | [approval4.4](#a618506_124400 "10 years ago") | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | approval4.4 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.4.7](#c45 "10 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.4.7 | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | [approval4.2](#a618506_124400 "10 years ago") | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | approval4.2 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.2.12](#c45 "10 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.2.12 | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | [approval4.0](#a618506_124400 "10 years ago") | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | approval4.0 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.0.16](#c45 "10 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.0.16 | + |
| --- | --- | --- |
| [abillings](/user_profile?user_id=280903) | [sec-bounty](#a9650620_280903 "10 years ago") | - |
| --- | --- | --- |
| [abillings](/user_profile?user_id=280903) | sec-bounty | - |
| --- | --- | --- |
|  | approval5.2 | ? |
| --- | --- | --- |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | testcase |  | | |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 2 obsolete files)

| [Patch v.1 for 4.0](/attachment.cgi?id=8501074)  [10 years ago](#c10)  [Gervase Markham [:gerv]](/user_profile?user_id=9911)   13.42 KB, patch |  | [Details](/attachment.cgi?id=8501074&action=edit) | [Diff](/attachment.cgi?id=8501074&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501074) |
| --- | --- | --- |
| [Patch v.2 for 4.0](/attachment.cgi?id=8501084)  [10 years ago](#c14)  [Gervase Markham [:gerv]](/user_profile?user_id=9911)   13.52 KB, patch | dylan : [review+](#c17 "10 years ago") | [Details](/attachment.cgi?id=8501084&action=edit) | [Diff](/attachment.cgi?id=8501084&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501084) |
| [Patch v.1 for 4.2](/attachment.cgi?id=8501598)  [10 years ago](#c19)  [Gervase Markham [:gerv]](/user_profile?user_id=9911)   12.03 KB, patch | dylan : [review+](#c29 "10 years ago") | [Details](/attachment.cgi?id=8501598&action=edit) | [Diff](/attachment.cgi?id=8501598&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501598) |
| [Patch v.1 for 4.4](/attachment.cgi?id=8501600)  [10 years ago](#c20)  [Gervase Markham [:gerv]](/user_profile?user_id=9911)   12.92 KB, patch | dylan : [review+](#c30 "10 years ago") | [Details](/attachment.cgi?id=8501600&action=edit) | [Diff](/attachment.cgi?id=8501600&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501600) |
| [Patch v.1 for tip](/attachment.cgi?id=8501604)  [10 years ago](#c21)  [Gervase Markham [:gerv]](/user_profile?user_id=9911)   10.94 KB, patch | dylan : [review+](#c34 "10 years ago") | [Details](/attachment.cgi?id=8501604&action=edit) | [Diff](/attachment.cgi?id=8501604&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501604) |
| [Patch v.1 for BMO](/attachment.cgi?id=8501627)  [10 years ago](#c22)  [Gervase Markham [:gerv]](/user_profile?user_id=9911)   14.07 KB, patch | dylan : [review+](#c33 "10 years ago") | [Details](/attachment.cgi?id=8501627&action=edit) | [Diff](/attachment.cgi?id=8501627&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501627) |
| [Patch v.2 for tip](/attachment.cgi?id=8552608)  [10 years ago](#c46)  [David Lawrence [:dkl]](/user_profile?user_id=5898)   6.37 KB, patch | dkl : [review+](#c46 "10 years ago") | [Details](/attachment.cgi?id=8552608&action=edit) | [Diff](/attachment.cgi?id=8552608&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8552608) |
| [Patch v.1 for 5.0](/attachment.cgi?id=8552618)  [10 years ago](#c47)  [David Lawrence [:dkl]](/user_profile?user_id=5898)   7.10 KB, patch | dkl : [review+](#c47 "10 years ago") | [Details](/attachment.cgi?id=8552618&action=edit) | [Diff](/attachment.cgi?id=8552618&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8552618) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [John Lightsey](/user_profile?user_id=519664)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1079065#c0)• 10 years ago |
|  | |

User Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; Touch; .NET4.0E; .NET4.0C; Tablet PC 2.0; .NET CLR 3.5.30729; .NET CLR 2.0.50727; .NET CLR 3.0.30729; rv:11.0) like Gecko
Steps to reproduce:
I noticed this during a cursory look through 4.4.6 to examine the other security issues that were fixed.
The filtering of the product name before the 2 arg open in reports.cgi generate\_chart() only sanitizes against path traversal attacks. 2 arg open in perl is generally exploitable for shell code injection if the attacker can control the first or last character of the filename. As far as I can tell, an attacker could leverage this input point IF they have enough permissions to control a project name.
The code that validates project names doesn't appear to prevent using a name like:
xyzzy||perl -e 'use URI::Escape;system(uri\_unescape(q{touch%20%2Ftmp%2FI\_RAN\_SHELLCODE}))'|
I don't have a test server with enough permissions to rename a project or time to set one up before this weekend. I'm expecting that you guys will be able to test the injection readily tough and would prefer to have this reported sooner rather than later.
To verify:
- rename a project to the injection listed above
- run reports.cgi for this project to hit the generate\_chart() function
- verify that /tmp/I\_RAN\_SHELLCODE was created
If you have any trouble verifying this, let me know and I'll check it this weekend.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1079065#c1)• 10 years ago |
|  | |

Hi John,
Thanks for the tip - I'll try this out now.
Gerv

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1079065#c2)• 10 years ago |
|  | |

There are two open()s in this file.
The first line of code is line 124:
open(DATA, '<', "$dir/0")
$dir is passed in to the get\_data function. The call site is on line 55:
my @data = get\_data($dir);
Line 39 says:
my $dir = bz\_locations()->{'datadir'} . "/mining";
So this is not attacker-controlled, and not vulnerable.
The second open is on line 141:
if (! open FILE, $data\_file) {
my $data\_file = $dir . '/' . $product->id;
$product->id is a Bugzilla-assigned numeric value, and is not attacker-controlled. (The product name is $product->name.) $dir is passed in, but is the same value as above:
my $dir = bz\_locations()->{'datadir'} . "/mining";
So also, as far as I can see, not vulnerable.
Please let me know if you think I've misanalysed this, and thanks very much for auditing our code and reporting what you find :-)
Gerv

|  | [John Lightsey](/user_profile?user_id=519664)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1079065#c3)• 10 years ago |
|  | |

I think you're looking at 4.5.6. I was looking at 4.4.6.
sub generate\_chart {
my ($dir, $image\_file, $product, $datasets) = @\_;
$product = $product ? $product->name : '-All-';
my $data\_file = $product;
$data\_file =~ s/\//-/gs;
$data\_file = $dir . '/' . $data\_file;
if (! open FILE, $data\_file) {

|  | [Simon Green](/user_profile?user_id=124400) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1079065#c4)• 10 years ago |
|  | |

I don't believe that there is a security issue here because the files in data/mining are not executable, and thus the following
1 #!/usr/bin/perl
2
3 my $a = q#/home/simon/bugzilla/fourfour/data/mining/x ||perl -e 'use URI::Escape;system(uri\_unescape(q{touch%20%2Ftmp%2FI\_RAN\_SHELLCODE}))'|#;
4 open FILE, $a;
returns sh: 1: /home/simon/bugzilla/fourfour/data/mining/x: not found
Having said that, Windows or other Linux operating systems might be affected. I don't use Windows so cannot test that. If it is an issue, it would only be in 4.4 and earlier.
However, I think all two params open() calls should be changed to three parameters. Not doing so is just asking for trouble at some point. It's kinda like not updating bash because you are not affected by shellshock now.
-- simonFlags: sec-bounty?

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1079065#c5)• 10 years ago |
|  | |

Ah, yes - looks like this got changed in [bug 604388](/show_bug.cgi?id=604388 "RESOLVED FIXED - Filenames used to store data for Old Charts should be based on product IDs, not names (avoid dataloss when renaming products)") so that data wasn't lost when products were renamed. I thought this code looked unfamiliar.
Simon: your error says "file not found"; when I turn the starting filename to one which actually exists, I get "permission denied", which is perhaps the error you meant. However, I also get a file /tmp/I\_RAN\_SHELLCODE, so I think perhaps this is a potential risk.
However, there are a number of migitations. Firstly, only a limited number of people (those with the 'editcomponents' privilege) can edit products. Secondly, the length of a product name is limited to 64 characters both client and server-side. This might not be enough of a mitigation, except that because the code converts "/" to "-", you can't use "/" - hence Dylan's Perl-based URI-unescaping trick. However, that blows your 64-character budget if you want a command with "/" in. (Product names absolutely can contain spaces.)
I've tried creating a product called "x || gerv |", where gerv is a command on my system which does something noticeable, and I can't exploit this. Even pasting Dylan's exploit code directly into the variable doesn't work - is there a permissions issue?
However, I am by no means willing to bet that it's unexploitable. We should certainly stop using 2-arg open().
Gerv

|  | [John Lightsey](/user_profile?user_id=519664)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1079065#c6)• 10 years ago |
|  | |

The editcomponents privilege seems like the only significant limitation to me. If the total limitation on the product name is 64 characters, you can use 61 for the injection. That is plenty of space to download code or switch to a different payload that allows more space. For example, I could put the payload in the user agent string and have the shellcode execute it:
HTTP\_USER\_AGENT='touch /tmp/I\_RAN\_AGAIN' perl -e 'my $fn = q{x;sh -c '\''$HTTP\_USER\_AGENT'\''|}; print length($fn) . "\n"; open FH, "/tmp/$fn";'
Thanks for confirming this so quickly.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1079065#c7)• 10 years ago |
|  | |

Hi John,
I am going to look at producing patches to eliminate 2-arg open entirely. (Remembering, of course, this bug is not present on the latest Bugzilla.) However, I haven't managed to exploit this, although I really can't see why it doesn't work. If you were able to spend a fun afternoon confirming it works with an actual Bugzilla, that would be great :-)
Gerv

|  | [John Lightsey](/user_profile?user_id=519664)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1079065#c8)• 10 years ago |
|  | |

No problem. I'll spin up a VM with Bugzilla this weekend to work up a proper proof of concept. There might be something I'm missing in reading through the code that mitigates this further.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1079065#c9)• 10 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #7](/show_bug.cgi?id=1079065#c7 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> Hi John,
>
> I am going to look at producing patches to eliminate 2-arg open entirely.
> (Remembering, of course, this bug is not present on the latest Bugzilla.)
> However, I haven't managed to exploit this, although I really can't see why
> it doesn't work. If you were able to spend a fun afternoon confirming it
> works with an actual Bugzilla, that would be great :-)
>
> Gerv
Do you mean entirely from the codebase? If so, allow me to aid you in
your quest:
these are the occurrences in master:
search\_plugin.cgi: Two-argument "open" used at line 30, column 5.
showdependencygraph.cgi: Two-argument "open" used at line 52, column 5.
showdependencygraph.cgi: Two-argument "open" used at line 261, column 5.
showdependencygraph.cgi: Two-argument "open" used at line 290, column 5.
Bugzilla/Attachment.pm: Two-argument "open" used at line 331, column 13.
Bugzilla/Attachment.pm: Two-argument "open" used at line 377, column 13.
Bugzilla/Error.pm: Two-argument "open" used at line 77, column 9.
Bugzilla/Config/Common.pm: Two-argument "open" used at line 237, column 13.
Bugzilla/Install/CPAN.pm: Two-argument "open" used at line 200, column 5.
Bugzilla/Install/Filesystem.pm: Two-argument "open" used at line 636, column 9.
Bugzilla/Send/Sendmail.pm: Two-argument "open" used at line 34, column 5.
If you end up not being able to slay these dragons, I would be most happy to oblige.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1079065#c10)• 10 years ago |
|  | |

Attached patch

[Patch v.1 for 4.0](attachment.cgi?id=8501074&action=diff) (obsolete)
— [Details](attachment.cgi?id=8501074&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501074)

Here's a patch for 4.0 (to start with) that eliminates all uses of 2-argument open. I found all the references using this grep:
ack "open[( ]" \*.cgi \*.pl Bugzilla
I then removed false positives and fixed the rest.
I found one other instance which is sort-of exploitable; if you are an admin and can configure the "webdotbase" parameter, which is the path to an executable, you can (rather unsurprisingly) cause the execution of any local executable (although you can't control the parameters). This hardly seems like a hole, given that this is the point, and my patch doesn't change it, but I mention it for completeness. One possible fix is that suggested in [bug 950486](/show_bug.cgi?id=950486 "RESOLVED FIXED - Move the webdotbase and font_file parameters from data/params into localconfig (and kill the Graphs panel)").
GervAssignee: general → gervStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true
[Attachment #8501074](/attachment.cgi?id=8501074&action=edit "Patch v.1 for 4.0") -
Flags: review?(dylan)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1079065#c11)• 10 years ago |
|  | |

Should we call the security impact "moderate" because Product renaming is generally limited to trusted admins or near-admins? Although if that trust is misplaced that one moderate data-administration privilege could be leveraged into much more (assuming this is confirmed as a workable attack) so I could also be sold on "high".
Gerv, Simon-- please change the sec- keyword if you think I'm low-balling the impact.Assignee: gerv → generalStatus: ASSIGNED → UNCONFIRMEDEver confirmed: falseKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a35672_1689)• 10 years ago |

Assignee: general → gervStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1079065#c12)• 10 years ago |
|  | |

(In reply to Dylan William Hardison [:dylan] from [comment #9](/show_bug.cgi?id=1079065#c9 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> Do you mean entirely from the codebase? If so, allow me to aid you in
> your quest:
Sorry I wasn't clear; I meant that I've not been able to actually exploit Bugzilla by creating a product with an appropriate name, and that if someone were actually to confirm it would be done, that would be great. Yes, I can use grep - see attached patch :-)
Gerv

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1079065#c13)• 10 years ago |
|  | |

dveditz: not sure what the criteria are, but on BMO, 18 people are admins, and 25 have editcomponents. So for us, "near-admin" is probably right. We don't let just anyone create new products in our Bugzilla. But it could be different elsewhere.
Gerv

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1079065#c14)• 10 years ago |
|  | |

Attached patch

[Patch v.2 for 4.0](attachment.cgi?id=8501084&action=diff)
— [Details](attachment.cgi?id=8501084&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501084)

Oops, missed one. (I planned to come back to it and forgot.)
Gerv
[Attachment #8501074](/attachment.cgi?id=8501074&action=edit "Patch v.1 for 4.0") -
Attachment is obsolete: true
[Attachment #8501074](/attachment.cgi?id=8501074&action=edit "Patch v.1 for 4.0") -
Flags: review?(dylan)
[Attachment #8501084](/attachment.cgi?id=8501084&action=edit "Patch v.2 for 4.0") -
Flags: review?(dylan)

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1079065#c15)• 10 years ago |
|  | |

I think that what mitigates the problem with 2 args open() calls are:
1) command would be executed as the 'apache' user, which has limited privileges;
2) admins are trusted users and I can hardly imagine that they want to shoot themselves in the foot. On test installations such as landfill where mostly everybody can ask to be an admin, that's another story. But 1) still stands.
So to me, this bug looks more like a security enhancement than a security bug. But I fully agree that 2 args is bad and should be forbidden from our codebase. 3 args is the way to go.

|  | [John Lightsey](/user_profile?user_id=519664)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1079065#c16)• 10 years ago |
|  | |

I had some free time tonight to configure a test server and work up a proper proof of concept.
Rename a project to:
x;eval $HTTP\_USER\_AGENT|
The payload goes into your user agent string. It needs to be shell code and you start off with an empty PATH variable. That's probably the hurdle that was making it difficult to reproduce. It's simple to work around.
root@tiger:/srv/www# curl -o /dev/null -A 'export PATH=/usr/bin:/bin;echo "I am running code as "`whoami` > /tmp/I\_RAN\_FROM\_THE\_USERAGENT' '<http://localhost/reports.cgi?product=x%3Beval%20%24HTTP_USER_AGENT%7C&datasets=x>'
% Total % Received % Xferd Average Speed Time Time Time Current
Dload Upload Total Spent Left Speed
100 303 100 303 0 0 1506 0 --:--:-- --:--:-- --:--:-- 1515
root@tiger:/srv/www# cat /tmp/I\_RAN\_FROM\_THE\_USERAGENT
I am running code as www-data
root@tiger:/srv/www#
Whether or not you guys treat this as a vulnerability is your call. If it's a vulnerability, it seems minor to me since the internal permission requirements are high. #1 above doesn't sound like a realistic argument though. Most remote code execution flaws execute as the web server user.
I could only see this flaw being a problem in environments where Bugzilla and some other web application are hosted under the same system user. Nothing in Bugzilla appears to suggest that admins, limited to the editcomponent privilege or not, are intended to run arbitrary code on the webserver. Flaws requiring highly privileged users are always a bit fuzzy to handle though.

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1079065#c17)• 10 years ago |
|  | |

Comment on [attachment 8501084](/attachment.cgi?id=8501084 "Patch v.2 for 4.0") [[details]](/attachment.cgi?id=8501084&action=edit "Patch v.2 for 4.0") [[diff]](/attachment.cgi?id=8501084&action=diff "Patch v.2 for 4.0") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501084)
Patch v.2 for 4.0
Review of [attachment 8501084](/attachment.cgi?id=8501084 "Patch v.2 for 4.0") [[details]](/attachment.cgi?id=8501084&action=edit "Patch v.2 for 4.0") [[diff]](/attachment.cgi?id=8501084&action=diff "Patch v.2 for 4.0") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501084):
-----------------------------------------------------------------
Using the revised example, I am able to confirm this fixes the bug.
r=dylan
we'll need this for bmo as well.
[Attachment #8501084](/attachment.cgi?id=8501084&action=edit "Patch v.2 for 4.0") -
Flags: review?(dylan) → review+

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1079065#c18)• 10 years ago |
|  | |

Hi John,
Thanks for taking the time to reproduce this. We appreciate you helping us out in this way. I'll produce patches for all supported versions and for the bugzilla.mozilla.org branch.
Dylan: can I confirm that in your review, you checked that I hadn't screwed up any of the conversions?
Gerv

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1079065#c19)• 10 years ago |
|  | |

Attached patch

[Patch v.1 for 4.2](attachment.cgi?id=8501598&action=diff)
— [Details](attachment.cgi?id=8501598&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501598)

[Attachment #8501598](/attachment.cgi?id=8501598&action=edit "Patch v.1 for 4.2") -
Flags: review?(dylan)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1079065#c20)• 10 years ago |
|  | |

Attached patch

[Patch v.1 for 4.4](attachment.cgi?id=8501600&action=diff)
— [Details](attachment.cgi?id=8501600&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501600)

[Attachment #8501600](/attachment.cgi?id=8501600&action=edit "Patch v.1 for 4.4") -
Flags: review?(dylan)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1079065#c21)• 10 years ago |
|  | |

Attached patch

[Patch v.1 for tip](attachment.cgi?id=8501604&action=diff) (obsolete)
— [Details](attachment.cgi?id=8501604&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501604)

[Attachment #8501604](/attachment.cgi?id=8501604&action=edit "Patch v.1 for tip") -
Flags: review?(dylan)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1079065#c22)• 10 years ago |
|  | |

Attached patch

[Patch v.1 for BMO](attachment.cgi?id=8501627&action=diff)
— [Details](attachment.cgi?id=8501627&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501627)

BMO has some additional open() calls not present elsewhere. I suspect this one from Bugzilla/PatchReader/AddCVSContext.pm:
open my $fh, "<", $this->{FILENAME} or die "Could not open $this->{FILENAME}";
would be exploitable by someone able to control the name of a file in our CVS repo... if we were still using CVS, which we aren't.
This file is a local copy of the PatchReader.pm module, which still contains the same construction here:
<http://cpansearch.perl.org/src/TMANNERM/PatchReader-0.9.6/lib/PatchReader/AddCVSContext.pm>
PatchReader is an optional module for Bugzilla. Do we need to notify the maintainer to make a security release?
Gerv
[Attachment #8501627](/attachment.cgi?id=8501627&action=edit "Patch v.1 for BMO") -
Flags: review?(dylan)

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1079065#c23)• 10 years ago |
|  | |

wicked: see [comment 22](/show_bug.cgi?id=1079065#c22 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"). CPAN suggests you are the maintainer of PatchReader.
I haven't followed it through to be certain that it's exploitable, but it's strongly suspect.
Gerv

|  | [John Lightsey](/user_profile?user_id=519664)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1079065#c24)• 10 years ago |
|  | |

One tip when you're looking to get rid of all two argument opens. IO::File->new($filename) and FileHandle->new($filename) are additional ways of writing them.
perl -e 'my $user\_input = "whoami|"; my $fh = IO::File->new($user\_input); print while (readline($fh));'

|  | [John Lightsey](/user_profile?user_id=519664)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1079065#c25)• 10 years ago |
|  | |

I would also agree that PatchReader::AddCVSContext is exploitable. You need the checkout command to succeed to get to the open() call though. Probably the simplest way to attack this code is with the same kind of payload that defeats file existence checks.
IE: code that does
my $untrusted\_filename = ...
if (-e $untrusted\_filename) {
open my $fh, $untrusted\_filename;
...
You get past this with a null before the pipe character. It'll end up executing the target file rather than opening it for reading. In the case of AddCVSContext, the null will strip the pipe character from the system() call that runs cvs and into the open() call.
Something like "directory/filename\0|"
Nice find.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1079065#c26)• 10 years ago |
|  | |

Interesting :-) John: are you at all interested in doing any more security code-reviewing on Bugzilla? :-)
Gerv

|  | [John Lightsey](/user_profile?user_id=519664)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1079065#c27)• 10 years ago |
|  | |

Sure, I'll definitely dig into the codebase more when I have time. If there's anything specific you'd like a second set of eyes on, let me know and I'll focus in that direction.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1079065#c28)• 10 years ago |
|  | |

John: I guess the key risks are constructs which could lead to server compromise, and constructs which could lead to unauthorized information disclosure from Bugzilla itself. (Those might require a little more Bugzilla-specific knowledge.)
Also, I would draw your attention to:
<https://www.mozilla.org/security/bug-bounty.html>
This bug is only a sec-moderate, but find a sec-high or sec-critical and we will show our gratitude in the appropriate manner :-)
Gerv

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1079065#c29)• 10 years ago |
|  | |

Comment on [attachment 8501598](/attachment.cgi?id=8501598 "Patch v.1 for 4.2") [[details]](/attachment.cgi?id=8501598&action=edit "Patch v.1 for 4.2") [[diff]](/attachment.cgi?id=8501598&action=diff "Patch v.1 for 4.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501598)
Patch v.1 for 4.2
Review of [attachment 8501598](/attachment.cgi?id=8501598 "Patch v.1 for 4.2") [[details]](/attachment.cgi?id=8501598&action=edit "Patch v.1 for 4.2") [[diff]](/attachment.cgi?id=8501598&action=diff "Patch v.1 for 4.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501598):
-----------------------------------------------------------------
Looks good, despite my horror at the cases where we intentionally shell out.
r=dylan
::: Bugzilla/Attachment/PatchReader.pm
@@ +108,5 @@
>
> # Send through interdiff, send output directly to template.
> # Must hack path so that interdiff will work.
> $ENV{'PATH'} = $lc->{diffpath};
> + open my $interdiff\_fh, '-|', "$lc->{interdiffbin} $old\_filename $new\_filename";
definitely will want to invest in shell quoting in the future.
::: showdependencygraph.cgi
@@ +258,5 @@
> or warn install\_string('chmod\_failed', { path => $pngfilename,
> error => $! });
>
> binmode $pngfh;
> + open(DOT, '-|', "\"$webdotbase\" -Tpng $filename");
yeeesh, this is an improvement, but I would like to see a shell\_escape() function around these filenames.
@@ +287,5 @@
> or warn install\_string('chmod\_failed', { path => $mapfilename,
> error => $! });
>
> binmode $mapfh;
> + open(DOT, '-|', "\"$webdotbase\" -Tismap $filename");
see previous comment
[Attachment #8501598](/attachment.cgi?id=8501598&action=edit "Patch v.1 for 4.2") -
Flags: review?(dylan) → review+

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1079065#c30)• 10 years ago |
|  | |

Comment on [attachment 8501600](/attachment.cgi?id=8501600 "Patch v.1 for 4.4") [[details]](/attachment.cgi?id=8501600&action=edit "Patch v.1 for 4.4") [[diff]](/attachment.cgi?id=8501600&action=diff "Patch v.1 for 4.4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501600)
Patch v.1 for 4.4
Review of [attachment 8501600](/attachment.cgi?id=8501600 "Patch v.1 for 4.4") [[details]](/attachment.cgi?id=8501600&action=edit "Patch v.1 for 4.4") [[diff]](/attachment.cgi?id=8501600&action=diff "Patch v.1 for 4.4") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501600):
-----------------------------------------------------------------
r=dylan
[Attachment #8501600](/attachment.cgi?id=8501600&action=edit "Patch v.1 for 4.4") -
Flags: review?(dylan) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a409129_120380)• 10 years ago |

Target Milestone: --- → Bugzilla 4.0

|  | [John Lightsey](/user_profile?user_id=519664)  Reporter |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1079065#c31)• 10 years ago |
|  | |

Just so it doesn't get forgotten in the mix, are you folks coordinating to get PatchReader fixed on CPAN or should I contact that author?

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1079065#c32)• 10 years ago |
|  | |

(In reply to John Lightsey from [comment #31](/show_bug.cgi?id=1079065#c31 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> Just so it doesn't get forgotten in the mix, are you folks coordinating to
> get PatchReader fixed on CPAN or should I contact that author?
the author is already aware of the problem

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1079065#c33)• 10 years ago |
|  | |

Comment on [attachment 8501627](/attachment.cgi?id=8501627 "Patch v.1 for BMO") [[details]](/attachment.cgi?id=8501627&action=edit "Patch v.1 for BMO") [[diff]](/attachment.cgi?id=8501627&action=diff "Patch v.1 for BMO") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501627)
Patch v.1 for BMO
Review of [attachment 8501627](/attachment.cgi?id=8501627 "Patch v.1 for BMO") [[details]](/attachment.cgi?id=8501627&action=edit "Patch v.1 for BMO") [[diff]](/attachment.cgi?id=8501627&action=diff "Patch v.1 for BMO") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501627):
-----------------------------------------------------------------
r=dylan
[Attachment #8501627](/attachment.cgi?id=8501627&action=edit "Patch v.1 for BMO") -
Flags: review?(dylan) → review+

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1079065#c34)• 10 years ago |
|  | |

Comment on [attachment 8501604](/attachment.cgi?id=8501604 "Patch v.1 for tip") [[details]](/attachment.cgi?id=8501604&action=edit "Patch v.1 for tip") [[diff]](/attachment.cgi?id=8501604&action=diff "Patch v.1 for tip") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501604)
Patch v.1 for tip
Review of [attachment 8501604](/attachment.cgi?id=8501604 "Patch v.1 for tip") [[details]](/attachment.cgi?id=8501604&action=edit "Patch v.1 for tip") [[diff]](/attachment.cgi?id=8501604&action=diff "Patch v.1 for tip") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501604):
-----------------------------------------------------------------
r=dylan
[Attachment #8501604](/attachment.cgi?id=8501604&action=edit "Patch v.1 for tip") -
Flags: review?(dylan) → review+

|  | [Dylan Hardison [:dylan] (he/him)](/user_profile?user_id=491519) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a556856_491519)• 10 years ago |

Flags: approval?Flags: approval4.4?Flags: approval4.2?Flags: approval4.0?

|  | [Simon Green](/user_profile?user_id=124400) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a618506_124400)• 10 years ago |

Flags: approval?Flags: approval4.4?Flags: approval4.4+Flags: approval4.2?Flags: approval4.2+Flags: approval4.0?Flags: approval4.0+Flags: approval+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a626171_120380)• 10 years ago |

Summary: Shell code injection via reports.cgi → Always use the 3 arguments form for open() to prevent shell code injection

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1079065#c35)• 10 years ago |
|  | |

OK, so the situation is:
\* The flaw in editproducts.cgi is a medium-severity vulnerability for 4.4 and older.
\* The flaw in PatchReader is also not particularly serious, because this code wasn't well-used even when people used CVS (I don't know of users other than Mozilla) and so few people use CVS these days anyway. We should wait until it's fixed on CPAN, and then publish a note in our advisory encouraging people to upgrade. [Bug 1068494](/show_bug.cgi?id=1068494 "RESOLVED FIXED - Remove CVS/Bonsai/LXR-specific bits of Patch Viewer") removes the use of PatchReader::AddCVSContext anyway; we should make sure that's committed to trunk.
teemu: what are the plans for a new version of PatchReader?
dkl/glob: can we apply the patch to BMO straight away?
dkl: will you be coordinating a security release for this? Given the severity level, can we hold it for a while to see if we find more stuff?
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1079065#c36)• 10 years ago |
|  | |

Again, is any of the vulnerabilities reported here exploitable by someone who has not editcomponents privileges? If not, then I will repeat what I said in [comment 15](/show_bug.cgi?id=1079065#c15 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"): this is more a security enhancement (and so no security advisory is needed and no security releases are required either) than a security fix.

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1079065#c37)• 10 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #35](/show_bug.cgi?id=1079065#c35 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> dkl/glob: can we apply the patch to BMO straight away?
Once we commit it upstream we will backport the fix. As for when see below.
> dkl: will you be coordinating a security release for this? Given the
> severity level, can we hold it for a while to see if we find more stuff?
I agree with LpSolit and others that since it requires being an empowered user, it is not
as a critical issue. Therefore we bundle it with any other issues that come in and release
at a later time.
dkl

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1079065#c38)• 10 years ago |
|  | |

(In reply to David Lawrence [:dkl] from [comment #37](/show_bug.cgi?id=1079065#c37 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> I agree with LpSolit and others that since it requires being an empowered
> user, it is not as a critical issue. Therefore we bundle it with any other issues that come
> in and release at a later time.
Things are never as simple as they seem when you look at the big picture. While this vulnerability by itself is not very critical, it becomes a non-privileged remote code execution vulnerability when combined with [CVE-2014-1572](https://www.cve.org/CVERecord?id=CVE-2014-1572) that we just released a fix for last week, if exploited on a system with lazy group regexp configuration.

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1079065#c39)• 10 years ago |
|  | |

(In reply to David Lawrence [:dkl] from [comment #37](/show_bug.cgi?id=1079065#c37 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> (In reply to Gervase Markham [:gerv] from [comment #35](/show_bug.cgi?id=1079065#c35 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> > dkl/glob: can we apply the patch to BMO straight away?
>
> Once we commit it upstream we will backport the fix. As for when see below.
You know I backported it already, right? Or by backport did you mean "commit"?
Gerv

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1079065#c40)• 10 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #39](/show_bug.cgi?id=1079065#c39 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> (In reply to David Lawrence [:dkl] from [comment #37](/show_bug.cgi?id=1079065#c37 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> > (In reply to Gervase Markham [:gerv] from [comment #35](/show_bug.cgi?id=1079065#c35 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> > > dkl/glob: can we apply the patch to BMO straight away?
> >
> > Once we commit it upstream we will backport the fix. As for when see below.
>
> You know I backported it already, right? Or by backport did you mean
> "commit"?
>
> Gerv
Admittedly I see that now, but I did actually mean commit. If this was a critical vulnerability I would have WebOps hotpatch (which of course we would have to keep doing each push) but since it is not, we can commit when the upstream version is committed as it will be public then.
dkl

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a1333344_120380)• 10 years ago |

Flags: approval5.0?

|  | [:glob ✱](/user_profile?user_id=13647) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a1726088_13647)• 10 years ago |

Flags: approval5.0? → approval5.0+

|  | [Teemu Mannermaa (:wicked)](/user_profile?user_id=1064) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1079065#c41)• 10 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #35](/show_bug.cgi?id=1079065#c35 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> teemu: what are the plans for a new version of PatchReader?
It's long overdue for one for sure. I guess I should sync that release with release of this in Bugzilla?
Looks like [attachment #8501627](/attachment.cgi?id=8501627 "Patch v.1 for BMO") [[details]](/attachment.cgi?id=8501627&action=edit "Patch v.1 for BMO") [[diff]](/attachment.cgi?id=8501627&action=diff "Patch v.1 for BMO") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501627) contains the two lines I need to change in PatchReader, right? In case anybody wants to help me get this released, you could make a patch against <https://github.com/tmannerm/PatchReader> (attaching here or emailing it to me is fine) with any changelog text that's appropriate for the issue. Thanks!

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1079065#c42)• 10 years ago |
|  | |

(In reply to Teemu Mannermaa (:wicked) from [comment #41](/show_bug.cgi?id=1079065#c41 "RESOLVED FIXED - [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection"))
> Looks like [attachment #8501627](/attachment.cgi?id=8501627 "Patch v.1 for BMO") [[details]](/attachment.cgi?id=8501627&action=edit "Patch v.1 for BMO") [[diff]](/attachment.cgi?id=8501627&action=diff "Patch v.1 for BMO") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8501627) [diff] [review] contains the two
> lines I need to change in PatchReader, right?
Well, I would advise you to do your own audit of all open() calls in PatchReader. But you will certainly need those two lines.
Gerv

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1079065#c43)• 10 years ago |
|  | |

Is the status here that we are holding until a security release comes along that we can piggyback on?
wicked: have you managed to ship an updated PatchReader yet?
Gerv

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a8080698_9911)• 10 years ago |

Blocks: [bz-release-50rc1](/show_bug.cgi?id=1118964 "RESOLVED FIXED - Release Bugzilla 5.0rc1, 4.4.7, 4.2.12, and 4.0.16")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a8081130_5898)• 10 years ago |

Blocks: [1118994](/show_bug.cgi?id=1118994 "RESOLVED FIXED - Security advisory for Bugzilla 5.0rc1, 4.4.7, 4.2.12, and 4.0.16")
No longer blocks: [bz-release-50rc1](/show_bug.cgi?id=1118964 "RESOLVED FIXED - Release Bugzilla 5.0rc1, 4.4.7, 4.2.12, and 4.0.16")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1079065#c44)• 10 years ago |
|  | |

call this one [CVE-2014-8630](https://www.cve.org/CVERecord?id=CVE-2014-8630)Alias: CVE-2014-8630Whiteboard: exploitation requires admin or editcomponents permissions

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1079065#c45)• 10 years ago |
|  | |

Marking the bug as blocker to have it in our radar.Flags: blocking5.0+Flags: blocking4.4.7+Flags: blocking4.2.12+Flags: blocking4.0.16+Summary: Always use the 3 arguments form for open() to prevent shell code injection → [SECURITY] Always use the 3 arguments form for open() to prevent shell code injection

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1079065#c46)• 10 years ago |
|  | |

Attached patch

[Patch v.2 for tip](attachment.cgi?id=8552608&action=diff)
— [Details](attachment.cgi?id=8552608&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8552608)

Updated patch for tip.
[Attachment #8501604](/attachment.cgi?id=8501604&action=edit "Patch v.1 for tip") -
Attachment is obsolete: true
[Attachment #8552608](/attachment.cgi?id=8552608&action=edit "Patch v.2 for tip") -
Flags: review+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1079065#c47)• 10 years ago |
|  | |

Attached patch

[Patch v.1 for 5.0](attachment.cgi?id=8552618&action=diff)
— [Details](attachment.cgi?id=8552618&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1079065&attachment=8552618)

[Attachment #8552618](/attachment.cgi?id=8552618&action=edit "Patch v.1 for 5.0") -
Flags: review+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1079065#c48)• 10 years ago |
|  | |

To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[367d9c2..4dabf1a master -> master](https://github.com/bugzilla/bugzilla/commit/4dabf1a)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[272b0b6..19117cc 5.0 -> 5.0](https://github.com/bugzilla/bugzilla/commit/19117cc)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[d98f8cd..f5b9cba 4.4 -> 4.4](https://github.com/bugzilla/bugzilla/commit/f5b9cba)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[f78bebb..7e1b7a5 4.2 -> 4.2](https://github.com/bugzilla/bugzilla/commit/7e1b7a5)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[9162eab..5c7b317 4.0 -> 4.0](https://github.com/bugzilla/bugzilla/commit/5c7b317)Status: ASSIGNED → RESOLVEDClosed: 10 years agoResolution: --- → FIXED

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1079065#c49)• 10 years ago |
|  | |

ReleasedGroup: bugzilla-security

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a9225670_5898)• 10 years ago |

Blocks: [1124432](/show_bug.cgi?id=1124432 "RESOLVED FIXED - Backport upstream bug 1079065 to bmo/4.2 to fix improper use of open() calls")

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a9650620_280903)• 10 years ago |

Flags: sec-bounty? → sec-bounty-

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1079065#a304426803_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1079065&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gervase Markham [:gerv]](/user_profile?user_id=9911)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_45914eeb_20250126_095137.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugs.gentoo.org_f55b036a_20250126_095133.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 52431
[New version] sys-fs/dd-rescue-1.03 available
Last modified: 2004-06-02 14:51:02 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=52431&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=52431&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 52431**](show_bug.cgi?id=52431)
- [New version] sys-fs/dd-rescue-1.03 available

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
[New version] sys-fs/dd-rescue-1.03 available

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Current packages ([show other bugs](buglist.cgi?component=Current%20packages&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High enhancement | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Daniel Ahlberg (RETIRED) | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://www.garloff.de/kurt/linux/ddre...](http://www.garloff.de/kurt/linux/ddrescue/) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [52435](show_bug.cgi?id=52435 "CONFIRMED - [New ebuild] dd_rhelp") | |  | Show dependency [tree](showdependencytree.cgi?id=52431&hide_resolved=1) | |  | | Reported: | 2004-05-30 03:35 UTC by Alexandru Toma | | --- | --- | | Modified: | 2004-06-02 14:51 UTC ([History](show_activity.cgi?id=52431)) | | CC List: | 1 user (show)  base-system | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=52431&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=52431&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Alexandru Toma    2004-05-30 03:35:44 UTC  ``` A new version of dd_rescue is out  Reproducible: Always Steps to Reproduce: 1. 2. 3. ```  [Comment 1](#c1)  Daniel Ahlberg (RETIRED)   gentoo-dev  2004-06-02 14:51:02 UTC  ``` In CVS, thanks! ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=52431)
* - [XML](show_bug.cgi?ctype=xml&id=52431)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=52431)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=52431&product=Gentoo%20Linux)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=52431&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=52431&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.mandriva.com_ada6433e_20250125_152308.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from bugs.mageia.org_4c799181_20250126_095132.html ===


Mageia Bugzilla – Bug 15134
bugzilla new security issue CVE-2014-8630
Last modified: 2015-02-03 17:54:52 CET

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=15134&GoAheadAndLogIn=1)

  [x]
* |
  [New Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug 15134**](show_bug.cgi?id=15134)
- bugzilla new security issue CVE-2014-8630

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
bugzilla new security issue CVE-2014-8630

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sec team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/631503/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | has\_procedure advisory MGA4-32-OK mga... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | validated\_update | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2015-01-26 15:28 CET by David Walser | | --- | --- | | Modified: | 2015-02-03 17:54 CET ([History](show_activity.cgi?id=15134)) | | CC List: | 2 users (show)  olchal sysadmin-bugs | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | bugzilla-4.4.6-1.mga4.src.rpm | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=15134&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=15134#c0)  David Walser    2015-01-26 15:28:53 CET  ``` Upstream has issued an advisory on January 21: <http://www.bugzilla.org/security/4.0.15/>  The issue is fixed in 4.4.7.  Mageia 4 is also affected.  According to Olav, this version causes a regression and 4.4.8 is planned.  Reproducible:   Steps to Reproduce: ```  David Walser    2015-01-26 15:29:10 CET   Whiteboard: (none) => MGA4TOO  [Comment 1](show_bug.cgi?id=15134#c1)  David Walser    2015-01-28 14:37:49 CET  ``` Version 4.4.8 has been released: <http://www.bugzilla.org/releases/4.4.8/release-notes.html>  Freeze push requested for Cauldron, updates checked into SVN. ```  [Comment 2](show_bug.cgi?id=15134#c2)  David Walser    2015-01-28 16:04:23 CET  ``` Updated package uploaded for Mageia 4.  Freeze push pending for Cauldron.  Advisory: ========================  Updated bugzilla packages fix security vulnerability:  Some code in Bugzilla does not properly utilize 3 arguments form for open() and it is possible for an account with editcomponents permissions to inject commands into product names and other attributes (CVE-2014-8630).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8630> <http://www.bugzilla.org/security/4.0.15/> <http://www.bugzilla.org/releases/4.4.8/release-notes.html> ========================  Updated packages in core/updates_testing: ======================== bugzilla-4.4.8-1.mga4.noarch.rpm bugzilla-contrib-4.4.8-1.mga4.noarch.rpm  from bugzilla-4.4.8-1.mga4.src.rpm ```  ---   Whiteboard: MGA4TOO => (none)Assignee: bugsquad => qa-bugsVersion: Cauldron => 4  [Comment 3](show_bug.cgi?id=15134#c3)  David Walser    2015-01-28 16:04:36 CET  ``` Testing procedure: [https://bugs.mageia.org/show_bug.cgi?id=9088#c14](show_bug.cgi?id=9088#c14 "RESOLVED FIXED - Multiple vulnerabilities in bugzilla (CVE-2012-4199,4198,4189,4197,5475, CVE-2013-0785,0786)") ```  ---   Whiteboard: (none) => has\_procedure  [Comment 4](show_bug.cgi?id=15134#c4)  olivier charles    2015-01-28 21:29:16 CET  ```  Testing on Mageia4-32 real hardware, retracing my steps in previous bug ([https://bugs.mageia.org/show_bug.cgi?id=14241#c2](show_bug.cgi?id=14241#c2 "RESOLVED FIXED - bugzilla new security issues CVE-2014-157[1-3]")) based on procedure mentioned in [comment 3](show_bug.cgi?id=15134#c3). Did not fin any PoC in <http://www.bugzilla.org/security/4.0.15/>  From current package : -------------------- bugzilla-4.4.6-1.mga4  Installed bugzilla using mysql,  Browsed to <http://localhost/bugzilla/> Logged in, created bugs, deleted bugs, made replies, attached files, logged out and back in, etc.  All OK  To updated testing package : -------------------------- bugzilla-4.4.8-1.mga4  Restarted httpd, Browsed to <http://localhost/bugzilla/> Logged in and found my previous bugs, added some, deleted, attached files...  All OK ```  ---   Whiteboard: has\_procedure => has\_procedure MGA4-32-OKCC: (none) => olchal  [Comment 5](show_bug.cgi?id=15134#c5)  claire robinson    2015-01-29 17:27:24 CET  ``` Testing complete mga4 64 ```  ---   Whiteboard: has\_procedure MGA4-32-OK => has\_procedure MGA4-32-OK mga4-64-ok  [Comment 6](show_bug.cgi?id=15134#c6)  claire robinson    2015-01-29 17:42:28 CET  ``` Validating. Advisory uploaded.  Could sysadmin please push to 4 updates  Thanks ```  ---   Whiteboard: has\_procedure MGA4-32-OK mga4-64-ok => has\_procedure advisory MGA4-32-OK mga4-64-okKeywords: (none) => validated\_updateCC: (none) => sysadmin-bugs  [Comment 7](show_bug.cgi?id=15134#c7)  Mageia Robot    2015-01-31 14:24:30 CET  ``` An update for this issue has been pushed to Mageia Updates repository.  <http://advisories.mageia.org/MGASA-2015-0048.html> ```  ---   Resolution: (none) => FIXEDStatus: NEW => RESOLVED  David Walser    2015-02-03 17:54:52 CET   URL: (none) => http://lwn.net/Vulnerabilities/631503/ |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=15134&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=15134)
* - [XML](show_bug.cgi?ctype=xml&id=15134)
* - [Clone ThisBug](enter_bug.cgi?cloned_bug_id=15134&normal=1)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=15134&GoAheadAndLogIn=1)

    [x]
  + |
    [New Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)


