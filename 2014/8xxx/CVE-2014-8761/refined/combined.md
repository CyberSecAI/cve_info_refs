=== Content from www.openwall.com_dcd32ea0_20250125_232336.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](../../../2014/10/16/9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <87eguc2m1l.fsf@redhat.com>
Date: Mon, 13 Oct 2014 14:26:14 +0200
From: Martin Prpic <mprpic@...hat.com>
To: oss-security@...ts.openwall.com
Subject: CVE request: various security flaws in dokuwiki

Hi, could CVEs please be assigned to the following issues?

The following security-related flaws have been fixed in the 2014-05-05 and 2014-09-29 releases of dokuwiki:

* Security Hotfix 2014-05-05a for Issue 765:

<https://github.com/splitbrain/dokuwiki/issues/765>

* Security Hotfix 2014-05-05b for AD/LDAP auth plugin related problem
  Security fix for AD/LDAP auth plugin related problem:

<http://www.freelists.org/post/dokuwiki/Fwd-Dokuwiki-maybe-security-issue-Null-byte-poisoning-in-LDAP-authentication>

Red Hat Bugzilla bug: <https://bugzilla.redhat.com/show_bug.cgi?id=1150131>

--
Martin Prpiƒç / Red Hat Product Security

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.dokuwiki.org_bf5f07bf_20250125_232338.html ===

This is a static dump of issues in the old "Flyspray" bugtracker for DokuWiki. Bugs and feature requests
are now tracked at the [issue tracker at Github](https://github.com/splitbrain/dokuwiki/issues).

**Closed**

Deferred
# FS#2647 $NS is deleted, but template.php ajax.php mediamanager.php still use it.

## Backend

* ![](http://www.gravatar.com/avatar/c289718adb8a2c36662f2fe05e813133?d=monsterid&s=48)

  2012-10-22
  furun

  not sure about this...

  $NS is deleted, but template.php, media.php, ajax.php, mediamanager.php still use it (and maybe plugins). (unused declaration in media.php.)

  is this intended?

  (some of the functions are defining $NS, but i think not that all functions are using $NS correctly. correct $NS should be renamed to $ns or a alternative global name to avoid conflicts with the deprecated $NS, and all functions should by checked if they should use global $NS. plugin developers should be informed if there plugins are using $NS.)
* ![](http://www.gravatar.com/avatar/4933823dc5f71300a20a506869fcf4d9?d=monsterid&s=48)

  2012-10-22
  ach

  Hmm, I was the one who deleted it. Sorry, I didn't check if it was in use, because I assumed whoever deprecated it would have made sure of that. (Note to self: Never assume anything!)

  The solution should be to use $NS = getNS($ID) instead.

  I wonder why that hasn't caused any problems so far!?
* ![](http://www.gravatar.com/avatar/4933823dc5f71300a20a506869fcf4d9?d=monsterid&s=48)

  2012-10-22
  ach

  Hmm, the original deprecation commit message might shed a light why this doesn't cause any problems:

  "$NS is only used in lib/exe/{ajax,mediamanager}.php when no $ID context

  is present. The two functions which use $NS in inc/template.php are only

  called through those both endpoints, not through doku.php. In doku.php,

  $ID is the only correct value, $NS is not kept synchronous with $ID."

  See<https://github.com/splitbrain/dokuwiki/commit/bced4159c8c5f1b4da2e98b2242c2ec1c09ec74e>
* ![](http://www.gravatar.com/avatar/c289718adb8a2c36662f2fe05e813133?d=monsterid&s=48)

  2012-10-22
  furun

  this was the reason why i was not sure. but some users have reported problems with the media-manager...

  maybe anyway rename the global exchange $NS different, because of exactly this confusion? or maybe even clean op the code more deeper?

  dont't know if dokuwiki uses a base of all plugins to check incompatibilities, but i expect that some plugins will report problems, and maybe they search for a long time before they find the empty $NS, expect if they check the deprecated/update advices ;)

  (for luxury, a regexp search/lister could find plugins and native codes which have to be updated, and put a short advice how. this update had some more changes, and i see more coming.)

  PS:

  i checked the code, but i don't know this code very well and don't see the dependencies to maybe outside code, so i leave the patching to more skilled coders.
* ![](http://www.gravatar.com/avatar/125bdfa8a2b91432c072615364bc3fa1?d=monsterid&s=48)

  2013-02-16
  Michitux

  This seems to be rather complicated as the global $NS is populated from different input variables so it's not possible to replace them easily. However I have the feeling that $NS is defined before it is used as the media manager code includes lib/exe/mediamanager.php which defines $NS and also the ajax handlers define it before calling the media manager functions. I think the proper fix should be to pass $NS as parameter where it is still used.
* ![](http://www.gravatar.com/avatar/b6b4d7dbe3fb7cf61b68e36cd80f8698?d=monsterid&s=48)

  2013-02-17
  andi

  bad coding style but not a real bug. should be fixed for next release, probably by reorganizing the code
* ![](http://www.gravatar.com/avatar/50eb1042e50ebf3b50f99e3822b36746?d=monsterid&s=48)

  2014-06-24
  Greenleon

  Not sure if related:

  Namespace-ACLs are broken in "Ponder Stibbons".

  Permissions for a namespace other than the global namespace are not looked up in the media manager.

  I noticed that in inc/media.php (line 820) $ns is empty for me. $ns is passed as a parameter.

  The function is called from inc/template.php (line 1474). There, (global) $NS is used as the parameter for $ns.

  Using getNS($image) instead of $NS seems to work but there are other places affected.

  Please fix!
* ![](http://www.gravatar.com/avatar/8498600ecaeedbee2f19647083d758cc?d=monsterid&s=48)

  2015-08-16
  Klap-in

  Something that would improve with rewrite of the media backend stuff.

  e.g.<https://github.com/splitbrain/dokuwiki/tree/mediarefactor>

  Closing, as it is part of general possible improvements of the media backend code.
* ![](http://www.gravatar.com/avatar/8498600ecaeedbee2f19647083d758cc?d=monsterid&s=48)

  2015-08-16
  Klap-in

  Works, better is fine. Good to fix in general media backed rewrite.



=== Content from www.debian.org_fbe003fc_20250125_232335.html ===


---

[[Date Prev](msg00246.html)][[Date Next](msg00248.html)]
[[Thread Prev](msg00246.html)][[Thread Next](msg00248.html)]
[[Date Index](maillist.html#00247)]
[[Thread Index](threads.html#00247)]

# [SECURITY] [DSA 3059-1] dokuwiki security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3059-1] dokuwiki security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 29 Oct 2014 19:25:22 +0100
* *Message-id*: <[[üîé]](/msgid-search/20141029182522.GA3503%40pisco.westfalen.local)¬†[20141029182522.GA3503@pisco.westfalen.local](msg00247.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3059-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
October 29, 2014                       <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dokuwiki
CVE ID         : CVE-2014-8761 CVE-2014-8762 CVE-2014-8763 CVE-2014-8764

Two vulnerabilities have been discovered in dokuwiki. Access control in
the media manager was insufficiently restricted and authentication could
be bypassed when using Active Directory for LDAP authentication.

For the stable distribution (wheezy), these problems have been fixed in
version 0.0.20120125b-2+deb7u1.

For the unstable distribution (sid), these problems have been fixed in
version 0.0.20140929.a-1.

We recommend that you upgrade your dokuwiki packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJUUTDUAAoJEBDCk7bDfE42VjwP/iHt/wO7rlL+1ClvL0JtqFe3
AQRhLwZE/abLsu1JSjBcB4uT58YnI/woP2IvMK02MxRdMFUbllqEQUvfM+XQo/mh
HtvC9AjwzY6E4qeudWtkfzA4t4+g3OHEoboo6Phaj34ZteaCoJEZslfD0o/WpGDV
igNFxCqvczCUQLGOcvgB+2LOTvVhUjQCjuUhdNvhHe/jehdpXbYC01CqigEQzQSy
Sfbbz6mlnj3/PLSY9bMVGQGmhOgr5q17MMhO8OW4sBVPLvNomUHqIySEeo46xhOI
x4we68w4pa4aV8W80ke/VkIn1AiqjEXwMzs/Go5N+Skuwwy77H4UZGq6aq4U9qYT
5NPGCHwFDuC2vC7zC52rcs0GW5MAn5So3pkZx+t8je07O2pWVA31+Q2OBsbLWBMJ
8LkAXiZOAuNafmIOCHvA1fys6mSxP9E+TSN5ssUcFRlcn7vOeIbvmEpXvRt/Kggm
QqiRfNVqkeaiPWacV9TaycyzZsM71dxQFPWutyln4zCCqT1waxT5ry9MRz3pAEHG
k5gE5lEjqYHWwmpHXt246tQ93PcdjcetLr2V8LCBQuzEHczfSXSAuNfTcHNuGoYX
ch06m3nwT+NqPY8uM57a39z4KerzndO6+xb+pav+FWB3zjfj9VffqPUn6eH7skpO
574YUoKw2HZRmPgfY3Qj
=6JJe
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_6536d4d3_20250125_232337.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](10) [[<thread-prev]](../../../2014/10/13/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20141016160742.CE78D6C0025@smtpvmsrv1.mitre.org>
Date: Thu, 16 Oct 2014 12:07:42 -0400 (EDT)
From: cve-assign@...re.org
To: mprpic@...hat.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: various security flaws in dokuwiki

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> The following security-related flaws have been fixed in the
> 2014-05-05 and 2014-09-29 releases of dokuwiki:

> <https://github.com/splitbrain/dokuwiki/issues/765>

There are two CVE IDs for 765 because there are apparently two
different types of problems.

> I can simply open an image I have no permission for in the media
> manager, I get a permission denied message in the media details tab
> and when I click on the detail tabs they load via ajax with the real
> content.

This issue appears to be about incorrect authorization logic in the
inc/template.php file. Use CVE-2014-8761.

> The media diff ajax call is a bit more difficult to test as the ns
> parameter (but only that one) is a post parameter, but after changing
> the code to accept a get parameter as well I can clearly see that it
> uses the ns parameter for the permission check (and nothing else).

Here, within the ajax_mediadiff function, the ns parameter is
untrusted input, so this is an instance of CWE-807. Use CVE-2014-8762.

There was also a third report in 765:

> <https://github.com/splitbrain/dokuwiki/issues/765#issuecomment-47109046>
>
> I noticed this same issue with media manager & acl just today, but
> from the other way around. When a user has full access to a namespace
> but no access to the parent namespace. The media manager shows the
> images but gives a denied access message when viewing details.

We think this might not be a vulnerability, if the user in this
scenario was supposed to be able to view details, and "a denied access
message" suggests that the authorization check was incorrect only
because it was too strict. There is currently no CVE ID for this.

> <http://www.freelists.org/post/dokuwiki/Fwd-Dokuwiki-maybe-security-issue-Null-byte-poisoning-in-LDAP-authentication>

The first issue is about a valid username, and a non-empty password
that begins with a \0 character. It is analogous to CVE-2014-8088 in
the <http://openwall.com/lists/oss-security/2014/10/10/5> post and
CVE-2014-6387 in the
<http://openwall.com/lists/oss-security/2014/09/12/14> post. Use
CVE-2014-8763 for the occurrence of this mistake within DokuWiki.

> In addition, I have just found that Dokuwiki is also vulnerable to
> null-byte-forced anonymous binds (as opposed to just unauthenticated
> binds):
>
> With a Dokuwiki instance using Active Directory for LDAP
> authentication (as described earlier), one can log in using a username
> that has a null byte as the first character and with a password that
> similarly has a null byte as the first character. This will result in
> an anonymous bind being performed by Dokuwiki, and hence the log in
> will always succeed, regardless of the whether the username exists or
> not in the LDAP directory.

Use CVE-2014-8764 for this additional issue. (Within an application
that uses LDAP, input validation related to the possibility of an
empty or invalid username, and input validation related to the
possibility of an empty or invalid password, are relevant for
different reasons.)

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJUP+w5AAoJEKllVAevmvmsfjMH/i2Lg02JfsecntpuGpfn7yE3
32WhweD8x/LFg/aTgd7HfXVcPyr9g6ZXsUyS1xKrhgCvOFMgNNE3M+ii+YvLXWqJ
Wr/mOXmdYTy7+mY+EwZ6iQItzqKPpZKZNuEtz2RijA7gp02Xp9b1d440DQ1W+add
1WMoGMuSslaOKQNbsLgHzNyDUlzw/+Bshle56KuenNRhn4jHt2hGel/MnNvsgYc5
It6Mv5xO3pZxDFnw+Al62iMJXGqVJQmMjTOxOW4nCUbxcIO9NAbnQQIWHilH29cS
3etv4DY4/Bq/wApiveOJt6lAHrVtyQkig5lyjYZjJXcgxmpOp/h+BZNnaM44+kA=
=UoQp
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from advisories.mageia.org_134b278d_20250125_232332.html ===

# [Advisories](index.html) ¬ª MGASA-2014-0438

## Updated dokuwiki packages fix security vulnerabilities

Publication date: 31 Oct 2014

Modification date: 31 Oct 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-8761](CVE-2014-8761.html)
,
[CVE-2014-8762](CVE-2014-8762.html)
,
[CVE-2014-8763](CVE-2014-8763.html)
,
[CVE-2014-8764](CVE-2014-8764.html)

## Description

```
inc/template.php in DokuWiki before 2014-05-05a only checks for access to the
root namespace, which allows remote attackers to access arbitrary images via a
media file details ajax call (CVE-2014-8761).

The ajax_mediadiff function in DokuWiki before 2014-05-05a allows remote
attackers to access arbitrary images via a crafted namespace in the ns
parameter (CVE-2014-8762).

DokuWiki before 2014-05-05b, when using Active Directory for LDAP
authentication, allows remote attackers to bypass authentication via a
password starting with a null (\0) character and a valid user name, which
triggers an unauthenticated bind (CVE-2014-8763).

DokuWiki 2014-05-05a and earlier, when using Active Directory for LDAP
authentication, allows remote attackers to bypass authentication via a user
name and password starting with a null (\0) character, which triggers an
anonymous bind (CVE-2014-8764).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=14252>
* <https://www.dokuwiki.org/changes#release_2014-09-29_hrun>
* <http://www.freelists.org/post/dokuwiki/Fwd-Dokuwiki-maybe-security-issue-Null-byte-poisoning-in-LDAP-authentication>
* <http://openwall.com/lists/oss-security/2014/10/16/9>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8761>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8762>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8763>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8764>

## SRPMS

### 3/core

* dokuwiki-20140929-1.1.mga3

### 4/core

* dokuwiki-20140929-1.1.mga4



=== Content from github.com_22e9f289_20250125_232339.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdokuwiki%2Fdokuwiki%2Fissues%2F765)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdokuwiki%2Fdokuwiki%2Fissues%2F765)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=dokuwiki%2Fdokuwiki)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dokuwiki](/dokuwiki)
/
**[dokuwiki](/dokuwiki/dokuwiki)**
Public

* [Notifications](/login?return_to=%2Fdokuwiki%2Fdokuwiki) You must be signed in to change notification settings
* [Fork
  859](/login?return_to=%2Fdokuwiki%2Fdokuwiki)
* [Star
   4.2k](/login?return_to=%2Fdokuwiki%2Fdokuwiki)

* [Code](/dokuwiki/dokuwiki)
* [Issues
  406](/dokuwiki/dokuwiki/issues)
* [Pull requests
  80](/dokuwiki/dokuwiki/pulls)
* [Actions](/dokuwiki/dokuwiki/actions)
* [Projects
  0](/dokuwiki/dokuwiki/projects)
* [Security](/dokuwiki/dokuwiki/security)
* [Insights](/dokuwiki/dokuwiki/pulse)

Additional navigation options

* [Code](/dokuwiki/dokuwiki)
* [Issues](/dokuwiki/dokuwiki/issues)
* [Pull requests](/dokuwiki/dokuwiki/pulls)
* [Actions](/dokuwiki/dokuwiki/actions)
* [Projects](/dokuwiki/dokuwiki/projects)
* [Security](/dokuwiki/dokuwiki/security)
* [Insights](/dokuwiki/dokuwiki/pulse)

# ACL checks in the media file details ajax calls only for root/arbitrary namespace¬†#765

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[ACL checks in the media file details ajax calls only for root/arbitrary namespace](#top)#765Copy linkLabels[Bug](https://github.com/dokuwiki/dokuwiki/issues?q=state%3Aopen%20label%3A%22Bug%22)[![@michitux](https://avatars.githubusercontent.com/u/198317?v=4&size=80)](/michitux)
## Description

[![@michitux](https://avatars.githubusercontent.com/u/198317?v=4&size=48)](/michitux)[michitux](https://github.com/michitux)opened [on Jun 25, 2014](https://github.com/dokuwiki/dokuwiki/issues/765#issue-36480567)

[A comment](https://bugs.dokuwiki.org/index.php?do=details&task_id=2647#comment6204) in our old bug tracker alerted me of this issue: in the media manager ACLs are broken for all views for individual files if you have access to the root namespace or - in the case of the media diff ajax call - an arbitrary namespace.

I have reproduced this issue in my local DokuWiki installation, I can simply open an image I have no permission for in the media manager, I get a permission denied message in the media details tab and when I click on the detail tabs they load via ajax with the real content. The media diff ajax call is a bit more difficult to test as the ns parameter (but only that one) is a post parameter, but after changing the code to accept a get parameter as well I can clearly see that it uses the ns parameter for the permission check (and nothing else).

No actual file content is exposed, just the metadata, but the metadata can contain a lot of information (title, caption etc. from the exif metadata) and the full history is displayed, too. This also requires knowing the actual media file id.

So far I can see the following problems in the code:

* in `ajax_mediadetails()`, `$NS` is not set, but in `tpl_mediaFileDetails()` `$NS` is used and its value is only checked when it is set (`if(isset($NS) && getNS($image) != $NS) return;`)
* `$AUTH` is a cache for the permissions of the current media ns (wtf?) which is set by `ajax_mediadiff()` using the "ns" parameter as namespace without any checks if this is actually the namespace of the current media file. This check is done in `tpl_mediaFileDetails()` but not in `media_diff()` which is called in `ajax_mediadiff()`.

I think a first fix could be to ignore the ns parameter in all ajax calls and instead set it based on the supplied image id.

I think we should fix this and release a hotfix release ASAP.

## Metadata

### Assignees

No one assigned

### Labels

[Bug](https://github.com/dokuwiki/dokuwiki/issues?q=state%3Aopen%20label%3A%22Bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


