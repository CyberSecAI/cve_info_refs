=== Content from www.debian.org_70448fca_20250125_195001.html ===


---

[[Date Prev](msg00274.html)][[Date Next](msg00276.html)]
[[Thread Prev](msg00274.html)][[Thread Next](msg00276.html)]
[[Date Index](maillist.html#00275)]
[[Thread Index](threads.html#00275)]

# [SECURITY] [DSA 3085-1] wordpress security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3085-1] wordpress security update
* *From*: Yves-Alexis Perez <corsac@debian.org>
* *Date*: Wed, 3 Dec 2014 09:38:56 +0100
* *Message-id*: <[[🔎]](/msgid-search/20141203083851.GA29481%40scapa.corsac.net) [20141203083851.GA29481@scapa.corsac.net](msg00275.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3085-1                   security@debian.org
<http://www.debian.org/security/>                         Yves-Alexis Perez
December 03, 2014                      <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : wordpress
CVE ID         : CVE-2014-9031 CVE-2014-9033 CVE-2014-9034 CVE-2014-9035
                 CVE-2014-9036 CVE-2014-9037 CVE-2014-9038 CVE-2014-9039
Debian Bug     : 770425

Multiple security issues have been discovered in Wordpress, a web
blogging tool, resulting in denial of service or information disclosure.
More information can be found in the upstream advisory at
<https://wordpress.org/news/2014/11/wordpress-4-0-1/>

CVE-2014-9031

    Jouko Pynnonen discovered an unauthenticated cross site scripting
    vulnerability (XSS) in wptexturize(), exploitable via comments or
    posts.

CVE-2014-9033

    Cross site request forgery (CSRF) vulnerability in the password
    changing process, which could be used by an attacker to trick an
    user into changing her password.

CVE-2014-9034

    Javier Nieto Arevalo and Andres Rojas Guerrero reported a potential
    denial of service in the way the phpass library is used to handle
    passwords, since no maximum password length was set.

CVE-2014-9035

    John Blackbourn reported an XSS in the "Press This" function (used
    for quick publishing using a browser "bookmarklet").

CVE-2014-9036

    Robert Chapin reported an XSS in the HTML filtering of CSS in posts.

CVE-2014-9037

    David Anderson reported a hash comparison vulnerability for
    passwords stored using the old-style MD5 scheme. While unlikely,
    this could be exploited to compromise an account, if the user had
    not logged in after a Wordpress 2.5 update (uploaded to Debian on 2
    Apr, 2008) and the password MD5 hash could be collided with due to
    PHP dynamic comparison.

CVE-2014-9038

    Ben Bidner reported a server side request forgery (SSRF) in the core
    HTTP layer which unsufficiently blocked the loopback IP address
    space.

CVE-2014-9039

    Momen Bassel, Tanoy Bose, and Bojan Slavkovic reported a
    vulnerability in the password reset process: an email address change
    would not invalidate a previous password reset email.

For the stable distribution (wheezy), these problems have been fixed in
version 3.6.1+dfsg-1~deb7u5.

For the upcoming stable distribution (jessie), these problems have been
fixed in version 4.0.1+dfsg-1.

For the unstable distribution (sid), these problems have been fixed in
version 4.0.1+dfsg-1.

We recommend that you upgrade your wordpress packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQEcBAEBCgAGBQJUfswVAAoJEG3bU/KmdcClQrsIAJDl/JfGi7LWL2wk4QGuFg23
FtWl0bjFYAMxR/97MGHWMxnk0tafu9tFOfKLopnhVY73TyzmfsrWKjvkRhqCs083
MO1BJkzVi7pG8JbLq0o1GrPj72bzaBh9eTnVWRtzIjk1ACCXOXa+6O8GfPLyAwOm
37VrThtxzBAyJ5AvE+vKfOI8u2n2CoiCAqeUpcLGH35dMbjxG7MaMmEvYjKnXNCn
1rBepPlBMBFY5Z2QQJF4C4c1Foca5pOl01OsybycZ/zXvIcb8o6besPo2OdNvLQp
2K4RcrnD7r8LgjY1lTOxhzVXp77Mp9QH9MdqHyDLV6vyrnu1O2/YDKRdsj0hIv8=
=pOFB
-----END PGP SIGNATURE-----

```

---



=== Content from wordpress.org_9cc191c2_20250126_112955.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[News](https://wordpress.org/news)

WordPress 4.0.1 Security Release

All posts

Search results

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

November 20, 2014
By [Andrew Nacin](https://profiles.wordpress.org/nacin/)
in [Releases](https://wordpress.org/news/category/releases/), [Security](https://wordpress.org/news/category/security/)
# WordPress 4.0.1 Security Release

---

WordPress 4.0.1 is now available. This is a **critical security release** for all previous versions and we strongly encourage you to update your sites immediately.

Sites that support automatic background updates will be updated to WordPress 4.0.1 within the next few hours. If you are still on WordPress 3.9.2, 3.8.4, or 3.7.4, you will be updated to 3.9.3, 3.8.5, or 3.7.5 to keep everything secure. (We don’t support older versions, so please update to 4.0.1 for the latest and greatest.)

WordPress versions 3.9.2 and earlier are affected by a critical cross-site scripting vulnerability, which could enable anonymous users to compromise a site. This was reported by [Jouko Pynnonen](http://klikki.fi/). This issue does not affect version 4.0, but version 4.0.1 does address these eight security issues:

* Three cross-site scripting issues that a contributor or author could use to compromise a site. Discovered by [Jon Cave](http://joncave.co.uk/), [Robert Chapin](http://www.miqrogroove.com/), and [John Blackbourn](https://johnblackbourn.com/) of the WordPress security team.
* A cross-site request forgery that could be used to trick a user into changing their password.
* An issue that could lead to a denial of service when passwords are checked. Reported by [Javier Nieto Arevalo](http://www.behindthefirewalls.com/) and [Andres Rojas Guerrero](http://www.devconsole.info/).
* Additional protections for server-side request forgery attacks when WordPress makes HTTP requests. Reported by Ben Bidner (vortfu).
* An extremely unlikely hash collision could allow a user’s account to be compromised, that also required that they haven’t logged in since 2008 (I wish I were kidding). Reported by [David Anderson](http://david.dw-perspective.org.uk).
* WordPress now invalidates the links in a password reset email if the user remembers their password, logs in, and changes their email address. Reported separately by [Momen Bassel](https://twitter.com/MomenBassel), [Tanoy Bose](http://c0dehouse.blogspot.in/), and [Bojan Slavković of ManageWP](https://managewp.com/).

Version 4.0.1 also fixes 23 bugs with 4.0, and we’ve made two hardening changes, including better validation of EXIF data we are extracting from uploaded photos. Reported by [Chris Andrè Dale](http://www.securesolutions.no/).

We appreciated the [responsible disclosure](https://codex.wordpress.org/FAQ_Security) of these issues directly to our security team. For more information, see the [release notes](https://codex.wordpress.org/Version_4.0.1) or consult the [list of changes](https://core.trac.wordpress.org/log/branches/4.0?rev=30475&stop_rev=29710).

[Download WordPress 4.0.1](https://wordpress.org/download/) or venture over to **Dashboard → Updates** and simply click “Update Now”.

*Already testing WordPress 4.1? The second beta is now available ([zip](https://wordpress.org/wordpress-4.1-beta2.zip)) and it contains these security fixes. For more on 4.1, see [the beta 1 announcement post](https://wordpress.org/news/2014/11/wordpress-4-1-beta-1/).*

Share this:

* [Threads](https://wordpress.org/news/2014/11/wordpress-4-0-1/?share=threads&nb=1)
* [Mastodon](https://wordpress.org/news/2014/11/wordpress-4-0-1/?share=mastodon&nb=1)
* [Bluesky](https://wordpress.org/news/2014/11/wordpress-4-0-1/?share=bluesky&nb=1)
* [X](https://wordpress.org/news/2014/11/wordpress-4-0-1/?share=x&nb=1)
* [Facebook](https://wordpress.org/news/2014/11/wordpress-4-0-1/?share=facebook&nb=1)
* [LinkedIn](https://wordpress.org/news/2014/11/wordpress-4-0-1/?share=linkedin&nb=1)

---

[Previous WordPress 4.1 Beta 1](https://wordpress.org/news/2014/11/wordpress-4-1-beta-1/)
[Next WordPress 4.1 Release Candidate](https://wordpress.org/news/2014/12/wordpress-4-1-release-candidate/)

## Get the Latest Updates

### Subscribe to WordPress News

Email Address

Subscribe

Join 18.7K other subscribers

### WP Briefing — The WordPress Podcast

Learn about where WordPress is going and how you can get involved.

* [Apple Podcasts](https://podcasts.apple.com/us/podcast/wp-briefing/id1551691710)
* [Pocket Casts](https://pca.st/uqvvmt8t)
* [RSS](https://wordpress.org/news/feed/podcast)
* [Spotify](https://open.spotify.com/show/6BxgmE9Qg2TZA8EKZLJ4zS)
* [Stitcher](https://www.stitcher.com/show/wp-briefing)

[Listen to all episodes](https://wordpress.org/news/podcast/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from advisories.mageia.org_323c1e45_20250125_194956.html ===

# [Advisories](index.html) » MGASA-2014-0493

## Updated wordpress package fixes security vulnerabilities

Publication date: 26 Nov 2014

Modification date: 26 Nov 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-9031](CVE-2014-9031.html)
,
[CVE-2014-9032](CVE-2014-9032.html)
,
[CVE-2014-9033](CVE-2014-9033.html)
,
[CVE-2014-9034](CVE-2014-9034.html)
,
[CVE-2014-9035](CVE-2014-9035.html)
,
[CVE-2014-9036](CVE-2014-9036.html)
,
[CVE-2014-9037](CVE-2014-9037.html)
,
[CVE-2014-9038](CVE-2014-9038.html)
,
[CVE-2014-9039](CVE-2014-9039.html)

## Description

```
XSS in wptexturize() via comments or posts, exploitable for unauthenticated users (CVE-2014-9031).

XSS in media playlists (CVE-2014-9032).

CSRF in the password reset process (CVE-2014-9033).

Denial of service for giant passwords. The phpass library by Solar Designer
was used in both projects without setting a maximum password length, which
can lead to CPU exhaustion upon hashing (CVE-2014-9034).

XSS in Press This (CVE-2014-9035).

XSS in HTML filtering of CSS in posts (CVE-2014-9036).

Hash comparison vulnerability in old-style MD5-stored passwords
(CVE-2014-9037).

SSRF: Safe HTTP requests did not sufficiently block the loopback IP address
space (CVE-2014-9038).

Previously an email address change would not invalidate a previous password
reset email (CVE-2014-9039).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=14625>
* <https://wordpress.org/news/2014/11/wordpress-4-0-1/>
* <http://openwall.com/lists/oss-security/2014/11/25/12>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9031>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9032>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9033>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9034>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9035>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9036>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9037>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9038>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9039>

## SRPMS

### 3/core

* wordpress-3.9.3-1.mga3

### 4/core

* wordpress-3.9.3-1.mga4



=== Content from openwall.com_9481e133_20250125_194958.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](11) [[next>]](13) [[<thread-prev]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20141125200956.098966C4006@smtpvmsrv1.mitre.org>
Date: Tue, 25 Nov 2014 15:09:56 -0500 (EST)
From: cve-assign@...re.org
To: nacin@...dpress.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: WordPress 4.0.1 Security Release

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

>  * XSS in wptexturize() via comments or posts. Unauthenticated. Affected
> versions <= 3.9.2 (except >= 3.8.5 / 3.7.5). Discovered by Jouko Pynnonen.

> <http://klikki.fi/adv/wordpress.html>

Use CVE-2014-9031.

>  * XSS in media playlists. Affected versions 3.9, 3.9.1, 3.9.2, 4.0.
> Reported by Jon Cave.

Use CVE-2014-9032.

>  * CSRF in the password reset process. Affected versions 4.0, 3.9.2, 3.8.4,
> 3.7.4.

> <http://core.trac.wordpress.org/changeset/30418>

Use CVE-2014-9033.

>  * Denial of service for giant passwords. This is the same issue as
> CVE-2014-9016
> in Drupal, and was reported by the same individuals to both projects. The
> phpass library by Solar Designer was used in both projects without setting
> a maximum password length, which can lead to CPU exhaustion upon hashing.
> Reported by Javier Nieto Arevalo and Andres Rojas Guerrero.

> <http://core.trac.wordpress.org/changeset/30467>

Use CVE-2014-9034.

We consider this distinct from CVE-2014-9016 because the use of a
maximum password length can be chosen independently.

>  * XSS in Press This. Affected versions <= 4.0 (except >= 3.8.5 / 3.7.5 /
> 3.9.3). Reported by John Blackbourn.

Use CVE-2014-9035.

>  * XSS in HTML filtering of CSS in posts. Affected versions <= 4.0 (except
> >= 3.8.5 / 3.7.5 / 3.9.3). Reported by Robert Chapin.

Use CVE-2014-9036.

(Note that, for the XSS issues, we have used the discoverer
information as expressed in the
<http://openwall.com/lists/oss-security/2014/11/25/10> post -- this is
slightly different from the way the discoverer information was
expressed in the <https://wordpress.org/news/2014/11/wordpress-4-0-1/>
announcement.)

>  * Hash comparison vulnerability in old-style MD5-stored
> passwords. Affected versions <= 4.0 (except >= 3.8.5 / 3.7.5 / 3.9.3). The
> WordPress install have once run WordPress < 2.5 (March 29, 2008), the user
> must not have logged in since the install was updated to >= 2.5, and the
> user needed to have a password for which the md5 hash was something that
> could be collided with due to PHP dynamic type comparisons (something like
> 1 in 170 million). Reported by David Anderson.

Use CVE-2014-9037.

>  * SSRF: Safe HTTP requests did not sufficiently block the loopback IP
> address space. Affected versions <= 4.0 (except >= 3.8.5 / 3.7.5 / 3.9.3).
> Reported by Ben Bidner.

> <https://core.trac.wordpress.org/changeset/30444>

Use CVE-2014-9038.

> * Previously an email address change would not invalidate a previous
> password reset email.  Affected versions <= 4.0 (except >= 3.8.5 / 3.7.5 /
> 3.9.3). WordPress now invalidates this if the user remembers their
> password, logs in, and changes their email address. Reported by Momen
> Bassel, Tanoy Bose, and Bojan Slavkovic.

> <http://core.trac.wordpress.org/changeset/30431>

Use CVE-2014-9039.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJUdOGsAAoJEKllVAevmvmst7QIAJtdJNpYCY4mjY+o8DCovdSp
q32y8P+xHhcZyiCp7Aac1OARc1Niy4qTBvIKh2kxDjx7wZ7R+mN2cMH/DvgN1zOE
pHaj+HumkNCP8yfkh24M4eqViq68RHutIddkT4dZHMU/uGL9Xe3Ba39+c0h5hyGk
Dyfb04BEkizvOQIonk3f6H+38S2XupGITt5gpxtHS2NUG9OQeVRcRG744IsdfsoU
lx+Qenkqb+yYDX5mq3OfBYgJ+FnBnDyteyO6nJ0+1NNepBCiiwG0LtEHXBKRrpDw
OyiUv+MzZfGnnMZ5rWTsg26y5vGPjlF6EiT0MxgpcHLGk/YiY0eUPQi2aagHeeY=
=8PCM
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from seclists.org_c72a605f_20250125_195000.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](61)
[By Date](date.html#62)
[![Next](/images/right-icon-16x16.png)](63)

[![Previous](/images/left-icon-16x16.png)](61)
[By Thread](index.html#62)
[![Next](/images/right-icon-16x16.png)](63)

![](/shared/images/nst-icons.svg#search)

# WordPress 3 persistent script injection

---

*From*: Jouko Pynnonen <jouko () iki fi>

*Date*: Thu, 20 Nov 2014 21:52:14 +0200

---

```
OVERVIEW
========

A security flaw in WordPress 3 allows injection of JavaScript into certain
text fields. In particular, the problem affects comment boxes on WordPress
posts and pages. These don't require authentication by default.

The JavaScript injected into a comment is executed when the target user
views it, either on a blog post, a page, or in the Comments section of the
administrative Dashboard.

In the most obvious scenario the attacker leaves a comment containing the
JavaScript and some links in order to put the comment in the moderation
queue. The exploit is not then visible to normal users, search engines, etc.

When a blog administrator goes to the Dashboard/Comments section to review
new comments, the JavaScript gets executed. The script can then perform
operations with administrator privileges.

For instance, our PoC exploits first clean up traces of the injected script
from the database, then perform other administrative tasks such as changing
the current user's password, adding a new administrator account, or using
the plugin editor to write attacker-supplied PHP code on the server (this
impact applies to any WordPress XSS if triggered by an administrator).

These operations happen in the background without the user seeing anything
out of ordinary.

If the attacker writes new PHP code on the server via the plugin editor,
another AJAX request can be used to execute it instantaneously, whereby the
attacker gains operating system level access on the server.

The exploit will NOT be triggered directly at the Dashboard "root view"
because only snippets (20 first words) of the latest comments are shown
there with all HTML stripped.

If approved there, the exploit will be triggered by any user viewing the
targeted blog posting or page, with their corresponding privileges.

Plugins that let unprivileged users to enter HTML text may offer other
attack vectors.

DETAILS
=======

WordPress allows a few HTML tags in comments, such as the anchor <A>, bold
<B>, and code <CODE> tags. Certain white-listed attributes are allowed in
each tag. Obviously, the "href" attribute is important for anchor tags, but
e.g. the "onmouseover" attribute would be undesirable.

The problem occurs in a text formatting function called wptexturize() which
is normally executed for each comment and other blocks of text. The
function replaces certain simple characters with fancier HTML entities. For
instance, straight quote symbols are replaced with opening and closing
curly quotes, unicode 8220 and 8221.

In order to avoid interfering with HTML formatting, wptexturize() first
splits the text in segments. The splitting is expected to pick HTML tags
(which aren't texturized) apart from running text (which is texturized).

In addition to HTML tags, the code is supposed to recognize
square-bracketed shortcodes such as [CODE] and avoid texturizing them.

The splitting is implemented with a regular expression in
wp-includes/formatting.php:

   $textarr = preg_split('/(<.*>|\[.*\])/Us', $text, -1,
                         PREG_SPLIT_DELIM_CAPTURE);

A text containing carefully mixed square and angle brackets confuses the
splitting process and results in HTML code getting partially texturized.

An attacker can exploit the bug to supply any attributes in the allowed
HTML tags. A style attribute can be used to create a transparent tag
covering the whole window, forcing the execution of its onmouseover handler.

In practical applications the script would probably first remove the
transparent tag to avoid interfering with UI events and re-triggering
the handler.
It could then insert a new <SCRIPT> tag to load a more complex JavaScript
file to execute from another web server. This script can use e.g. jQuery to
chain AJAX operations for posting HTML forms and retrieving the required
nonces.

AFFECTED VERSIONS
=================

We tested a few WordPress versions from 3.0 to the latest 3.9.2. All tested
versions were vulnerable. The problem seems to have gone uncorrected for
almost four years.

Version 4.0 uses a different kind of regular expression and is NOT
vulnerable to this problem.

WORKAROUNDS
===========

Texturizing can be easily disabled by adding a return statement in the
beginning of the function in wp-includes/formatting.php:

  function wptexturize($text) {
        return $text;                  // ADD THIS LINE
        global $wp_cockneyreplace;

This changes how some punctuation marks look like but the difference is
quite minor.

We have also made a WordPress plugin available for disabling texturization. For
more information and an up-to-date version of this document, please refer
to our website <http://klikki.fi>

The preferred solution should be applying the official patch released by
WordPress.

VENDOR RESPONSE
===============

WordPress was notified on September 26 and has released patches correcting
the problem. The WordPress security advisory is available at

<https://wordpress.org/news/2014/11/wordpress-4-0-1/>

CREDITS
=======

The vulnerability was discovered and researched by Jouko Pynnonen, Klikki
Oy, Finland.

--
Jouko Pynnonen <jouko () iki fi>
Klikki Oy - <http://klikki.fi>

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](61)
[By Date](date.html#62)
[![Next](/images/right-icon-16x16.png)](63)

[![Previous](/images/left-icon-16x16.png)](61)
[By Thread](index.html#62)
[![Next](/images/right-icon-16x16.png)](63)

### Current thread:

* **WordPress 3 persistent script injection** *Jouko Pynnonen (Nov 20)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.mandriva.com_f803d9f6_20250125_195004.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from klikki.fi_56e57958_20250125_194957.html ===

[Skip to content](#content)
 Klikki Tmi

![mobile](https://klikki.fi/wp-content/themes/fast-press/images/mobile.jpg)

Search for:
Search for:

X

Menu

Search for:
Search for:

X

# WordPress 3 core unauthenticated stored XSS

### Overview

A security flaw in WordPress 3 allows injection of JavaScript into certain text fields. In particular, the problem affects comment boxes on WordPress posts and pages. These don’t require authentication by default.

The JavaScript injected into a comment is executed when the target user views it, either on a blog post, a page, or in the Comments section of the administrative Dashboard.

In the most obvious scenario the attacker leaves a comment containing the JavaScript and some links in order to put the comment in the moderation queue. The exploit is not then visible to normal users, search engines, etc.

When a blog administrator goes to the Dashboard/Comments section to review new comments, the JavaScript gets executed. The script can then perform operations with administrator privileges.

For instance, our PoC exploits first clean up traces of the injected script from the database, then perform other administrative tasks such as changing the current user’s password, adding a new administrator account, or using the plugin editor to write attacker-supplied PHP code on the server (this impact applies to any WordPress XSS if triggered by an administrator).

These operations happen in the background without the user seeing anything out of ordinary.

If the attacker writes new PHP code on the server via the plugin editor, another AJAX request can be used to execute it instantaneously, whereby the attacker gains operating system level access on the server.

The exploit will NOT be triggered directly at the Dashboard “root view” because only snippets (20 first words) of the latest comments are shown there with all HTML stripped.

If approved there, the exploit will be triggered by any user viewing the targeted blog posting or page, with their corresponding privileges.

Plugins that let unprivileged users to enter HTML text may offer other attack vectors.

### Details

WordPress allows a few HTML tags in comments, such as the anchor <A>, bold <B>, and code <CODE> tags. Certain white-listed attributes are allowed in each tag. Obviously, the “href” attribute is important for anchor tags, but e.g. the “onmouseover” attribute would be undesirable.

The problem occurs in a text formatting function called wptexturize() which is normally executed for each comment and other blocks of text. The function replaces certain simple characters with fancier HTML entities. For instance, straight quote symbols are replaced with opening and closing curly quotes, unicode 8220 and 8221.

In order to avoid interfering with HTML formatting, wptexturize() first splits the text in segments. The splitting is expected to pick HTML tags (which aren’t texturized) apart from running text (which is texturized).

In addition to HTML tags, the code is supposed to recognize square-bracketed shortcodes such as [CODE] and avoid texturizing them.

The splitting is implemented with a regular expression in wp-includes/formatting.php:

```
    $textarr = preg_split('/(<.*>|\[.*\])/Us', $text, -1, PREG_SPLIT_DELIM_CAPTURE);

```

A text containing carefully mixed square and angle brackets confuses the splitting process and results in HTML code getting partially texturized.

An attacker can exploit the bug to supply any attributes in the allowed HTML tags. A style attribute can be used to create a transparent tag covering the whole window, forcing the execution of its onmouseover handler.

In practical applications the script would probably first remove the transparent tag to avoid interfering with UI events and re-triggering the handler. It could then insert a new <SCRIPT> tag to load a more complex JavaScript file to execute from another web server. This script can use e.g. jQuery to chain AJAX operations for posting HTML forms and retrieving the required nonces.

### Affected versions

We tested a few WordPress versions from 3.0 to the latest 3.9.2. All tested versions were vulnerable. The problem seems to have gone uncorrected for almost four years. As of September 2014, about 90% of all WordPress sites were running a vulnerable version. On November 20, the percentage is down to about 86%.

Version 4.0 uses a different kind of regular expression and is NOT vulnerable to this problem.

### Workarounds

Texturizing can be easily disabled by adding a return statement in the beginning of the function in wp-includes/formatting.php:

```
  function wptexturize($text) {
        return $text;                  // ADD THIS LINE
        global $wp_cockneyreplace;

```

This changes how some punctuation marks look like but the difference is quite minor.

The preferred solution should still be applying the official patch.

### Vendor response

WordPress was notified on September 26 and has released patches correcting the problem. At the moment of writing they have been deployed as automatic updates to WordPress users. The advisory is available [here](https://wordpress.org/news/2014/11/wordpress-4-0-1/).

### Credits

The vulnerability was discovered and researched by Jouko Pynnonen, [Klikki Oy](https://klikki.fi), Finland.

Update December 1, 2014: a [proof of concept exploit](/adv/wordpress_update.html) published.

Update January 31, 2015: another 0-day with a similar impact to be released soon. Vendor notified on November 7.

Update April 25, 2015: [exploit attempts](http://security.stackexchange.com/questions/86766/is-email-from-my-wordpress-site-a-hack-or-just-a-normal-comment) in the wild

Update July 27, 2015: The “another 0-day” referred above is now public, [read more](/adv/wordpress3.html). Meanwhile there was one more comment XSS found by us, [read more](/adv/wordpress2.html).

 [November 20, 2014February 3, 2023](https://klikki.fi/wordpress-3-core-unauthenticated-stored-xss/)  [klikki](https://klikki.fi/author/klikki/)
 [security](https://klikki.fi/category/security/) [wordpress](https://klikki.fi/tag/wordpress/)

 [Previous](https://klikki.fi/kaikki-yleisesti-kaytossa-olevat-wordpress-versiot-haavoittuvia/)
[Next](https://klikki.fi/wordpress-comment-exploit-published/)

SearchSearch

* [media](https://klikki.fi/category/media/)
* [security](https://klikki.fi/category/security/)

* [Kiekko.tk](https://kiekko.tv)
* [TyperA](https://typera.net)
* [EverQuest Online Adventures](https://eqoa.live)

* jouko@iki.fi
* [HackerOne](https://hackerone.com/jouko)
* [Twitter](https://twitter.com/klikkioy)

[Powered by WordPress](https://wordpress.org/)

All rights reserved © Klikki
[Fast Press Theme by Seos Themes](https://seosthemes.com/ "Seos Theme - Fast Press")


