```
Message-Id: <20141125200956.098966C4006@smtpvmsrv1.mitre.org>
Date: Tue, 25 Nov 2014 15:09:56 -0500 (EST)
From: cve-assign@...re.org
To: nacin@...dpress.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: WordPress 4.0.1 Security Release

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

>  * Denial of service for giant passwords. This is the same issue as
> CVE-2014-9016
> in Drupal, and was reported by the same individuals to both projects. The
> phpass library by Solar Designer was used in both projects without setting
> a maximum password length, which can lead to CPU exhaustion upon hashing.
> Reported by Javier Nieto Arevalo and Andres Rojas Guerrero.

> <http://core.trac.wordpress.org/changeset/30467>

Use CVE-2014-9034.

We consider this distinct from CVE-2014-9016 because the use of a
maximum password length can be chosen independently.
-----END PGP SIGNATURE-----
```

```
# Changeset 30467

Prevent high resource usage when hashing large passwords. props mdawaffe, pento

3 edited

* src/wp-includes/class-phpass.php
  (modified)
  
    215 | 215 | function HashPassword($password)
    216 | 216 | {
    | 217 | if ( strlen( $password ) > 4096 ) {
    | 218 | return '\*';
    | 219 | }
    | 220 |
    217 | 221 | $random = '';

    250 | 254 | function CheckPassword($password, $stored\_hash)
    251 | 255 | {
    | 256 | if ( strlen( $password ) > 4096 ) {
    | 257 | return false;
    | 258 | }
    | 259 |
    252 | 260 | $hash = $this->crypt\_private($password, $stored\_hash);

* tests/phpunit/tests/auth.php
(modified)
  | 104 | function test\_password\_length\_limit() {
  | 105 | $passwords = array(
  | 106 | str\_repeat( 'a', 4095 ), // short
  | 107 | str\_repeat( 'a', 4096 ), // limit
  | 108 | str\_repeat( 'a', 4097 ), // long
  | 109 | );
    ...
  | 130 |
  | 131 | wp\_set\_password( $passwords[2], $user\_id );
  | 132 | $user = get\_user\_by( 'id', $user\_id );
  | 133 | // Password broken by setting it to be too long.
  | 134 | $this->assertEquals( '\*', $user->data->user\_pass );

```

```
# [Advisories](index.html) Â» MGASA-2014-0493

## Updated wordpress package fixes security vulnerabilities

Publication date: 26 Nov 2014

Modification date: 26 Nov 2014

Type: security


CVE:
[CVE-2014-9034](CVE-2014-9034.html)

## Description

```
Denial of service for giant passwords. The phpass library by Solar Designer
was used in both projects without setting a maximum password length, which
can lead to CPU exhaustion upon hashing (CVE-2014-9034).
```
```
# WordPress 4.0.1 Security Release

WordPress 4.0.1 is now available. This is a **critical security release** for all previous versions and we strongly encourage you to update your sites immediately.
...
Version 4.0.1 does address these eight security issues:
...
* An issue that could lead to a denial of service when passwords are checked. Reported by [Javier Nieto Arevalo](http://www.behindthefirewalls.com/) and [Andres Rojas Guerrero](http://www.devconsole.info/).
```

```
# [SECURITY] [DSA 3085-1] wordpress security update

Package        : wordpress
CVE ID         : CVE-2014-9034

CVE-2014-9034

    Javier Nieto Arevalo and Andres Rojas Guerrero reported a potential
    denial of service in the way the phpass library is used to handle
    passwords, since no maximum password length was set.
```

**Root cause of vulnerability:**
The phpass library used for password hashing did not enforce a maximum password length.

**Weaknesses/vulnerabilities present:**
- Lack of password length validation in the phpass library.
- Potential for CPU exhaustion due to excessive hashing of extremely long passwords.

**Impact of exploitation:**
- Denial of service (DoS) through CPU exhaustion.

**Attack vectors:**
- Sending an extremely long password for hashing (e.g., during login or password reset).

**Required attacker capabilities/position:**
- The attacker doesn't need to be authenticated. They can try to login with a very long password.

The provided information aligns with the CVE description, detailing a denial-of-service vulnerability due to the lack of a maximum password length check in WordPress's phpass library, which can lead to CPU exhaustion when hashing excessively long passwords.