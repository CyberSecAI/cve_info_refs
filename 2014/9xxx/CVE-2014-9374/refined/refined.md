Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability lies within the `res_http_websocket` module of Asterisk.
*   The module dynamically resizes memory to accommodate WebSocket payloads.
*   When a zero-length payload is received, the code attempts to resize the memory to zero.
*   This zero-resize operation incorrectly frees the memory and is treated as a failure.
*   Later, when the session is torn down, this already freed memory is freed again, leading to a double-free condition and a crash.

**Weaknesses/Vulnerabilities:**

*   **Double Free:** The core vulnerability is a double-free condition, where the same memory is freed twice, leading to a crash and denial of service.
*   **Incorrect Size Handling:** The code mishandles zero-length payloads in the memory resizing logic.
*   **NULL Termination Assumption:**  The initial implementation also incorrectly assumed that provided text frames would be NULL-terminated.

**Impact of Exploitation:**

*   **Denial of Service (DoS):** Successful exploitation leads to a crash of the Asterisk service, causing a denial of service.
*   **Remote Crash:** The vulnerability can be triggered remotely via a WebSocket connection.

**Attack Vectors:**

*   **Network:** The attack vector is through the network via a WebSocket connection.
*   **WebSocket Frame Manipulation:** An attacker sends a WebSocket frame with a zero-length payload after sending a non-zero length payload.

**Required Attacker Capabilities/Position:**

*   **Remote Unauthenticated Access:** The attacker only needs remote network access to the vulnerable Asterisk service via WebSocket. No prior authentication is required.

**Additional Details:**

*   The vulnerability is present in multiple versions of Asterisk.
*   Patches and version updates were released to address the issue.
*   The issue was fixed by not treating the zero-length resize and free as an error.

**Affected Versions:**

*   Certified Asterisk 11.6 (all versions)
*   Asterisk Open Source 11.x (all versions)
*   Asterisk Open Source 12.x (all versions)
*   Asterisk Open Source 13.x (all versions)

**Corrected Versions:**

*   Certified Asterisk 11.6-cert9
*   Asterisk Open Source 11.14.2
*   Asterisk Open Source 12.7.2
*   Asterisk Open Source 13.0.2

**Mitigation:**

*   Disable the built-in HTTP server if not needed.
*   Upgrade to a corrected version of Asterisk or apply the provided patches.