```
Message-ID: <20160408092855.GD8144@suse.de>
Date: Fri, 8 Apr 2016 11:28:55 +0200
From: Marcus Meissner <meissner@...e.de>
To: OSS Security List <oss-security@...ts.openwall.com>
Subject: CVE Request: systemd / journald created world readable journal files

Hi,

systemd-journald from systemd v213 started creating world readable journals, allowing
local users to read sensitive system log entries.

While spotted by our users in
<https://bugzilla.suse.com/show_bug.cgi?id=972612>
the problem was present and fixed in upstream systemd git...

Introduced by this commit in v213:
<https://github.com/systemd/systemd/commit/a606871da508995f5ede113a8fc6538afd98966c>

Fixed for volatile journals was done by this commit in v214:
<https://github.com/systemd/systemd/commit/176f2acf8dee45fee832fd2ab07243f63783a238>

Fixed for the current persistent journal by this commit in v229:
<https://github.com/systemd/systemd/commit/afae249efa4774c6676738ac5de6aeb4daf4889f>

Ciao, Marcus
```
- **Root cause of vulnerability**: systemd-journald, starting from version 213, created journal files with world-readable permissions.
- **Weaknesses/vulnerabilities**: Incorrect file permissions leading to information disclosure.
- **Impact of exploitation**: Local users could read sensitive system log entries.
- **Attack vectors**: Local access to the system.
- **Required attacker capabilities/position**: A local user on the system.

```
CVE-2014-9770 at MITRE
Description
tmpfiles.d/systemd.conf in systemd before 214 uses weak permissions for journal files under (1) /run/log/journal/%m and (2) /var/log/journal/%m, which allows local users to obtain sensitive information by reading these files.
```
The provided content provides more specific details regarding the vulnerable versions (starting from v213) and the commits that introduced the vulnerability and provided partial fixes. It also clarifies that the vulnerability affected both volatile and persistent journal storage.

```
Message-Id: <20160408173332.997BE6C05DD@smtpvmsrv1.mitre.org>
Date: Fri,  8 Apr 2016 13:33:32 -0400 (EDT)
From: cve-assign@...re.org
To: meissner@...e.de
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: systemd / journald created world readable journal files

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> Fixed for volatile journals was done by this commit in v214:
> <https://github.com/systemd/systemd/commit/176f2acf8dee45fee832fd2ab07243f63783a238>

>> committed Jun 11, 2014

Use CVE-2014-9770.

> Fixed for the current persistent journal by this commit in v229:
> <https://github.com/systemd/systemd/commit/afae249efa4774c6676738ac5de6aeb4daf4889f>

>> committed Nov 29, 2015

Use CVE-2015-8842.
```
This confirms CVE-2014-9770 assignment for the volatile journals fix commit and points towards CVE-2015-8842 for the persistent journal fix commit.

```
Bug 972612
VUL-1: CVE-2014-9770: systemd: Archived journal files are world readable
Description
On Leap archived journal files in /var/log/journal/$uuid are all world-readable - both system and user. The current journal (i.e. system.journal for system instance or user-$UID.journal for user) are correctly restricted to root/systemd-journal or owning user).
This allows any user to read anyone's archived journals by using explicit  journalctl --file=/path/to/archived/file
```
This confirms the world-readable issue for archived journal files, and that `journalctl --file=/path/to/archived/file` can be used to access the information. It also states that current logs are correctly restricted, although this was later found to be incorrect in some cases.

```
tmpfiles: don't allow read access to journal files to users not in sy…
…stemd-journal

Also, don't apply access mode recursively to /var/log/journal/*/, since
that might be quite large, and should be correct anyway.
```
This commit description provides more information: the fix is to restrict journal file access to users in the `systemd-journal` group, and not to recursively apply access modes.

```
tmpfiles: set acls on system.journal explicitly
```
This commit fixes the persistent journal files issue, explicitly setting ACLs for `system.journal`.

```
tmpfiles.d/systemd.conf in systemd before 214 uses weak permissions for journal files under (1) /run/log/journal/%m and (2) /var/log/journal/%m, which allows local users to obtain sensitive information by reading these files.
```
This provides a good description of the vulnerability and impacted directories.

```
openSUSE Security Update: Security update for systemd
Description:
This update for systemd fixes several issues.
These security issues were fixed:
- CVE-2014-9770, CVE-2015-8842: Don't allow read access to journal files
to users (boo#972612)
```
This confirms the fix for the vulnerability in openSUSE.

```
CVE-2015-8842 at MITRE
Description
tmpfiles.d/systemd.conf in systemd before 229 uses weak permissions for /var/log/journal/%m/system.journal, which allows local users to obtain sensitive information by reading the file.
```
This confirms the scope of CVE-2015-8842.