```json
{
  "cveId": "CVE-2014-9421",
  "baseScore": "9.0",
  "temporalScore": "7.0",
  "vulnerability": {
    "rootCause": "Double-free vulnerability due to improper handling of partial XDR deserialization results in `auth_gssapi_unwrap_data()`",
    "weaknesses": [
      "Incorrect memory management",
       "Double-free",
       "Use-after-free"
    ],
    "impact": "Denial of service (daemon crash), potential arbitrary code execution",
    "attackVectors": [
      "Network",
       "Malformed XDR data"
    ],
    "requiredCapabilities": [
      "Remote authenticated user"
    ],
    "details": "The `auth_gssapi_unwrap_data` function in `lib/rpc/auth_gssapi_misc.c` in MIT Kerberos 5 (krb5) does not properly handle partial XDR deserialization. When an XDR deserialization fails, this function calls `xdr_free()` on the allocated memory. However, when using GSSAPI authentication the caller functions `svctcp_getargs()` and `svcudp_getargs()` also free the same memory. This can lead to a double-free condition. Additionally, some XDR functions, specifically for handling principal names and tag-length data within `libkadm5`, lack the necessary defense to nullify pointer values after freeing them. This can result in a use-after-free condition when those XDR functions are called again for partial deserialization clean-up."
  },
  "affectedProducts": [
    "MIT Kerberos 5 (krb5) through 1.11.5",
    "1.12.x through 1.12.2",
    "1.13.x before 1.13.1",
      "kadmind and other server applications using libgssrpc"
  ],
  "suggestedFixes": [
    "Avoid calling xdr_free in auth_gssapi_unwrap_data function as this responsibility belongs to the caller",
      "Null out pointers after freeing in xdr_krb5_tl_data() and xdr_krb5_principal() XDR functions within libkadm5"
  ],
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2014-9421",
    "https://github.com/krb5/krb5/commit/a197e92349a4aa2141b5dff12e9dd44c2a2166e3",
    "http://lists.fedoraproject.org/pipermail/package-announce/2015-March/151103.html",
    "http://lists.fedoraproject.org/pipermail/package-announce/2015-March/151437.html",
    "http://lists.opensuse.org/opensuse-security-announce/2015-02/msg00011.html",
    "http://lists.opensuse.org/opensuse-security-announce/2015-02/msg00016.html",
    "http://lists.opensuse.org/opensuse-updates/2015-02/msg00044.html",
    "http://rhn.redhat.com/errata/RHSA-2015-0439.html",
    "http://rhn.redhat.com/errata/RHSA-2015-0794.html",
    "http://web.mit.edu/kerberos/advisories/2015-001-patch-r113.txt",
    "http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2015-001.txt",
    "http://www.debian.org/security/2015/dsa-3153",
    "http://www.mandriva.com/security/advisories?name=MDVSA-2015:069",
    "http://www.securityfocus.com/bid/72496",
    "http://www.ubuntu.com/usn/USN-2498-1"
  ]
}
```