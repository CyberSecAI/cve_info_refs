=== Content from bugs.debian.org_93d258fa_20250125_094056.html ===

# Debian Bug report logs - #774172 rar: CVE-2014-9983: symlink directory traversal

[![version graph](version.cgi?collapse=1;height=2;absolute=0;fixed=rar%2F2%3A5.3.b2-1;package=rar;found=rar%2F2%3A4.2.0-1;found=rar%2F2%3A5.2.1b2-1;width=2)](version.cgi?collapse=1;absolute=0;fixed=rar%2F2%3A5.3.b2-1;info=1;package=rar;found=rar%2F2%3A4.2.0-1;found=rar%2F2%3A5.2.1b2-1)

Package:
[rar](pkgreport.cgi?package=rar);
Maintainer for [rar](pkgreport.cgi?package=rar) is [Martin Meredith <mez@debian.org>](pkgreport.cgi?maint=mez%40debian.org); Source for [rar](pkgreport.cgi?package=rar) is [src:rar](pkgreport.cgi?src=rar) ([PTS](https://tracker.debian.org/pkg/rar), [buildd](https://buildd.debian.org/rar), [popcon](https://qa.debian.org/popcon.php?package=rar)).

Reported by: [Jakub Wilk <jwilk@debian.org>](pkgreport.cgi?submitter=jwilk%40debian.org)

Date: Mon, 29 Dec 2014 21:33:07 UTC

Severity: important

Tags: security, upstream

Found in versions rar/2:4.2.0-1, rar/2:5.2.1b2-1

Fixed in version rar/2:5.3.b2-1

**Done:** Martin Meredith <mez@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=774172;mbox=yes), [status mbox](bugreport.cgi?bug=774172;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=774172;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, jwilk@debian.org, Martin Meredith <mez@debian.org>`:

`Bug#774172`; Package `rar`.
(Mon, 29 Dec 2014 21:33:11 GMT) ([full text](bugreport.cgi?bug=774172;msg=2), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=2), [link](#1)).

---

[Message #3](#3) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=774172;msg=3), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=3), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40debian.org)
From: Jakub Wilk <jwilk@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: rar: symlink directory traversal
Date: Mon, 29 Dec 2014 22:29:28 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=774172;msg=3) (text/plain, inline)]
```
```
Package: rar
Version: 2:4.2.0-1
Tags: security

RAR follows symlinks when unpacking stuff, even the symlinks that were
created during the same unpack process.
It is therefore possible to create a malicious RAR archive that will be
unpacked into arbitrary directory outside cwd.

Proof of concept:

$ pwd
/home/jwilk

$ rar x traversal.rar

RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012
Trial version             Type RAR -? for help

Extracting from traversal.rar

Extracting  tmp                                                       OK
Extracting  tmp/moo                                                   OK
All OK

$ ls -l /tmp/moo
-rw-r--r-- 1 jwilk jwilk 4 Dec 29 21:41 /tmp/moo

-- System Information:
Debian Release: 8.0
 APT prefers unstable
 APT policy: (500, 'unstable'), (1, 'experimental')
Architecture: amd64 (x86_64)

Kernel: Linux 3.16.0-4-amd64 (SMP w/1 CPU core)
Locale: LANG=C, LC_CTYPE=C (charmap=ANSI_X3.4-1968)
Shell: /bin/sh linked to /bin/dash
Init: systemd (via /run/systemd/system)

--
Jakub Wilk

```
```
[[traversal.rar](bugreport.cgi?att=1;bug=774172;filename=traversal.rar;msg=3) (application/rar, attachment)]
```

---

**Marked as found in versions rar/2:5.2.1b2-1.**
Request was from `Scott Kitterman <scott@kitterman.com>`
to `control@bugs.debian.org`.
(Mon, 27 Apr 2015 17:00:20 GMT) ([full text](bugreport.cgi?bug=774172;msg=5), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=5), [link](#4)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Martin Meredith <mez@debian.org>`:

`Bug#774172`; Package `rar`.
(Tue, 27 Dec 2016 15:21:02 GMT) ([full text](bugreport.cgi?bug=774172;msg=7), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Moritz Mühlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Martin Meredith <mez@debian.org>`.
(Tue, 27 Dec 2016 15:21:02 GMT) ([full text](bugreport.cgi?bug=774172;msg=9), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 774172@bugs.debian.org ([full text](bugreport.cgi?bug=774172;msg=10), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Mühlenhoff <jmm@inutil.org>
To: 774172@bugs.debian.org
Cc: jwilk@debian.org
Subject: Re: rar: symlink directory traversal
Date: Tue, 27 Dec 2016 16:18:53 +0100
```
On Mon, Dec 29, 2014 at 10:29:28PM +0100, Jakub Wilk wrote:
> Package: rar
> Version: 2:4.2.0-1
> Tags: security
>
> RAR follows symlinks when unpacking stuff, even the symlinks that were
> created during the same unpack process.
> It is therefore possible to create a malicious RAR archive that will be
> unpacked into arbitrary directory outside cwd.

What't the status? This bug hasn't seen maintainer acknowledgement in
two years?

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Martin Meredith <mez@debian.org>`:

`Bug#774172`; Package `rar`.
(Tue, 27 Dec 2016 15:27:03 GMT) ([full text](bugreport.cgi?bug=774172;msg=12), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Martin Meredith <martin@sourceguru.net>`:

Extra info received and forwarded to list. Copy sent to `Martin Meredith <mez@debian.org>`.
(Tue, 27 Dec 2016 15:27:03 GMT) ([full text](bugreport.cgi?bug=774172;msg=14), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 774172@bugs.debian.org ([full text](bugreport.cgi?bug=774172;msg=15), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=martin%40sourceguru.net)
From: Martin Meredith <martin@sourceguru.net>
To: 774172@bugs.debian.org, Moritz Mühlenhoff <jmm@inutil.org>
Subject: Re: Bug#774172: rar: symlink directory traversal
Date: Tue, 27 Dec 2016 15:24:03 +0000
```
[[Message part 1](bugreport.cgi?att=0;bug=774172;msg=15) (text/plain, inline)]
```
```
This has been passed on upstream, with no responses as it should have been
marked.

On 27 Dec 2016 3:21 p.m., "Moritz Mühlenhoff" <jmm@inutil.org> wrote:

> On Mon, Dec 29, 2014 at 10:29:28PM +0100, Jakub Wilk wrote:
> > Package: rar
> > Version: 2:4.2.0-1
> > Tags: security
> >
> > RAR follows symlinks when unpacking stuff, even the symlinks that were
> > created during the same unpack process.
> > It is therefore possible to create a malicious RAR archive that will be
> > unpacked into arbitrary directory outside cwd.
>
> What't the status? This bug hasn't seen maintainer acknowledgement in
> two years?
>
> Cheers,
>         Moritz
>

```
```
[[Message part 2](bugreport.cgi?att=1;bug=774172;msg=15) (text/html, inline)]
```

---

**Severity set to 'important' from 'normal'**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `control@bugs.debian.org`.
(Sat, 22 Apr 2017 15:27:04 GMT) ([full text](bugreport.cgi?bug=774172;msg=17), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=17), [link](#16)).

---

**Added tag(s) upstream.**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `control@bugs.debian.org`.
(Sat, 22 Apr 2017 15:27:06 GMT) ([full text](bugreport.cgi?bug=774172;msg=19), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=19), [link](#18)).

---

**Changed Bug title to 'rar: CVE-2014-9983: symlink directory traversal' from 'rar: symlink directory traversal'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sun, 04 Jun 2017 14:57:04 GMT) ([full text](bugreport.cgi?bug=774172;msg=21), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=21), [link](#20)).

---

**Reply sent**
to `Martin Meredith <mez@debian.org>`:

You have taken responsibility.
(Tue, 29 Aug 2017 10:27:04 GMT) ([full text](bugreport.cgi?bug=774172;msg=23), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=23), [link](#22)).

---

**Notification sent**
to `Jakub Wilk <jwilk@debian.org>`:

Bug acknowledged by developer.
(Tue, 29 Aug 2017 10:27:04 GMT) ([full text](bugreport.cgi?bug=774172;msg=25), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=25), [link](#24)).

---

[Message #26](#26) received at 774172-done@bugs.debian.org ([full text](bugreport.cgi?bug=774172;msg=26), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=26), reply):

![](/cgi-bin/libravatar.cgi?email=mez%40debian.org)
From: Martin Meredith <mez@debian.org>
To: 774172-done@bugs.debian.org, control@bugs.debian.org
Subject: Seems to be patched
Date: Tue, 29 Aug 2017 11:25:37 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=774172;msg=26) (text/plain, inline)]
```
```
fixed 2:5.4.0+dfsg.1-0.1
thanks

Just looking over this - and I can't reproduce this in in current versions.

I'm closing this - but please, feel free to re-open and send me further
details if there's a further fix.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=774172;msg=26) (text/html, inline)]
```

---

**Marked as fixed in versions rar/2:5.3.b2-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 29 Aug 2017 19:06:02 GMT) ([full text](bugreport.cgi?bug=774172;msg=28), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=28), [link](#27)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Martin Meredith <mez@debian.org>`:

`Bug#774172`; Package `rar`.
(Tue, 29 Aug 2017 19:21:20 GMT) ([full text](bugreport.cgi?bug=774172;msg=30), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=30), [link](#29)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Martin Meredith <mez@debian.org>`.
(Tue, 29 Aug 2017 19:21:20 GMT) ([full text](bugreport.cgi?bug=774172;msg=32), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=32), [link](#31)).

---

[Message #33](#33) received at 774172@bugs.debian.org ([full text](bugreport.cgi?bug=774172;msg=33), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=33), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Martin Meredith <martin@sourceguru.net>, 774172@bugs.debian.org
Cc: Moritz Mühlenhoff <jmm@inutil.org>
Subject: Re: Bug#774172: rar: symlink directory traversal
Date: Tue, 29 Aug 2017 21:08:13 +0200
```
This should be fixed in 5.21 upstream:

+   Version 5.21
+
+   1. While previous versions could produce RAR5 volumes of slightly
+      smaller than requested size sometimes, such situation is less
+      likely now. In most cases volume size equals to specified by user.
+
+   2. Now by default RAR skips symbolic links with absolute paths
+      in link target when extracting. You can enable creating such links
+      with -ola switch.
+
+      Such links pointing to directories outside of extraction destination
+      directory can present a security risk. Enable their extraction only
+      if you are sure that archive contents is safe, such as your own backup.

the first version in unstable containging the fix should be 2:5.3.b2-1.

Regards,
Salvatore

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 27 Sep 2017 07:32:03 GMT) ([full text](bugreport.cgi?bug=774172;msg=35), [mbox](bugreport.cgi?bug=774172;mbox=yes;msg=35), [link](#34)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=774172).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 09:40:56 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


