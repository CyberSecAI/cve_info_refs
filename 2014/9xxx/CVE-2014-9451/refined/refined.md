```
SEC Consult Vulnerability Lab Security Advisory < 20141218-0 >
=======================================================================
              title: Multiple critical vulnerabilities
            product: VDG Security SENSE (formerly DIVA)
 vulnerable version: 2.3.13
      fixed version: unknown - no vendor confirmation
             impact: critical
           homepage: <https://vdgsecurity.com/>
              found: 2014-10-01
                 by: Stefan Viehb√∂ck
                     SEC Consult Vulnerability Lab
                     <https://www.sec-consult.com>
=======================================================================

Vulnerability overview/description:
-----------------------------------
1) Unauthenticated local file disclosure
    - **Root cause:** Vulnerability in the proprietary web server implementation.
    - **Weaknesses:** Unauthenticated users can read arbitrary files from the filesystem with the privileges of the "SYSTEM" operating system user.
    - **Impact:** Disclosure of sensitive information such as clear text passwords/password hashes which can be used in further attacks.
    - **Attack vector:** Sending a crafted HTTP request to the web server. Example: `http://<host>/images/../../../../Windows/SysWOW64/config/systemprofile/AppData/Roaming/Diva/Settings/users.ini`

2) Authentication bypass / Clear text password disclosure
    - **Root cause:** Vulnerability in the DIVA application authentication mechanism.
    - **Weaknesses:** Authentication for some parts of the application can be bypassed by sending the HTTP Authorization header containing a colon ":".
    - **Impact:** Attackers can read plugin configurations, which includes clear text DIVA administrator credentials. Attackers can also update DIVA plugin configurations.
    - **Attack vector:** Sending a crafted HTTP request with an authorization header like `Authorization: Basic Og==` to endpoints such as `/plugins/divacal/getsettings?sessionkey=` or `/plugins/?sessionkey=`.

3) Insecure service configuration / Hardcoded default credentials - Postgres
    - **Root cause:** The PostgreSQL database is offered via the network (TCP port 5432) and can be accessed remotely using hardcoded credentials.
    - **Weaknesses:** Hardcoded credentials (Username: root, Password: ArpaRomaWi) are used to access the database remotely and cannot be changed.
    - **Impact:** Full access to the database.
    - **Attack vector:** Connecting to the Postgres database via TCP port 5432 with the hardcoded credentials.

4) Hardcoded default credentials - Windows Users
    - **Root cause:** Several local Windows users are created during the DIVA setup with hardcoded credentials.
    - **Weaknesses:** Hardcoded credentials (Username: postgres, Password: !DVService and Username: NTP, Password: !DVService)
    - **Impact:** Attackers can log on to the server running DIVA using these credentials.
    - **Attack vector:** Using the hardcoded credentials to log on to the Windows system.

5) Critical information disclosure / User database leakage
    - **Root cause:** The server returns the contents of the user database to the client after authentication with the DIVA (fat) client via the proprietary protocol (TCP port 51410).
    - **Weaknesses:** Regardless of user rights, the server returns the user database (users.ini) which contains all users and their password hashes.
    - **Impact:** An attacker can use the password hashes to log in as another user.
    - **Attack vector:** Authenticating to the DIVA server via the proprietary protocol (TCP port 51410).

6) Use of plain text protocols
    - **Root cause:** All DIVA communication transport channels (e.g., via TCP port 80, 51410) lack encryption.
    - **Weaknesses:** All communication is sent in plain text.
    - **Impact:** Communication can be intercepted and read by a network attacker.
    - **Attack vector:** Network traffic interception.

7) Buffer overflow vulnerabilities
    - **Root cause:** The DIVA web service API (/webservice) is vulnerable to a stack-based buffer overflow when processing "AuthenticateUser" requests.
    - **Weaknesses:**  The "user" and the "password" parameters are vulnerable. None of the DIVA modules are ASLR-enabled.
    - **Impact:** Potential for arbitrary code execution. An exploit that uses ROP to bypass DEP has been implemented.
    - **Attack vector:** Sending a specially crafted "AuthenticateUser" request to the `/webservice` endpoint.

```