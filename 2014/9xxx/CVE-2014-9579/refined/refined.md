```
SEC Consult Vulnerability Lab Security Advisory < 20141218-0 >
=======================================================================
              title: Multiple critical vulnerabilities
            product: VDG Security SENSE (formerly DIVA)
 vulnerable version: 2.3.13
      fixed version: unknown - no vendor confirmation
             impact: critical
           homepage: <https://vdgsecurity.com/>
              found: 2014-10-01
                 by: Stefan Viehb√∂ck
                     SEC Consult Vulnerability Lab
                     <https://www.sec-consult.com>
=======================================================================
```
**Root cause of vulnerability:**
The VDG Security SENSE (formerly DIVA) software has multiple vulnerabilities stemming from insecure configurations, lack of encryption, and vulnerable code.

**Weaknesses/vulnerabilities present:**
1.  **Unauthenticated local file disclosure:** Arbitrary files can be read from the filesystem with SYSTEM user privileges via the proprietary web server, which includes configuration files containing sensitive data.
2.  **Authentication bypass / Clear text password disclosure:** Authentication can be bypassed in some application parts using an empty Authorization header, allowing attackers to update plugin configurations. This configuration includes clear text administrator credentials.
3.  **Insecure service configuration / Hardcoded default credentials (Postgres):** The PostgreSQL database is accessible remotely using hardcoded credentials that cannot be changed.
4.  **Hardcoded default credentials (Windows Users):** Multiple local Windows users created during setup have hardcoded credentials that can be used to log into the server.
5.  **Critical information disclosure / User database leakage:** After authenticating with the DIVA client, the server returns the entire user database, including password hashes, regardless of user privileges.
6.  **Use of plain text protocols:** All DIVA communications lack encryption.
7.  **Buffer overflow vulnerabilities:** The DIVA web service API is vulnerable to a stack-based buffer overflow when processing "AuthenticateUser" requests due to insufficient input validation of "user" and "password" parameters. The modules are not ASLR-enabled, and a ROP exploit bypassing DEP is implemented.

**Impact of exploitation:**
*   Complete compromise of the VDG SENSE server.
*   Gaining system-level access.
*   Use of the SENSE server as an entry point for lateral movement and privilege escalation within the target infrastructure.
*   Disclosure of sensitive information (clear text passwords, password hashes, etc.).
*   Remote access to the PostgreSQL database.
*   Ability to log onto the server with default user credentials.
*   Ability to manipulate DIVA plugin configurations.
*   Remote code execution via the buffer overflow vulnerability.

**Attack vectors:**
*   Sending specially crafted HTTP requests to the web server to exploit file disclosure and authentication bypass.
*   Connecting to the PostgreSQL database using hardcoded credentials.
*   Logging into the server using default Windows user credentials.
*   Authenticating to the DIVA client and receiving user database leakage.
*   Exploiting the buffer overflow via the web service API.

**Required attacker capabilities/position:**
*   Network access to the vulnerable VDG SENSE server.
*   Ability to send HTTP requests to the server.
*   Knowledge of the hardcoded credentials.
*   Ability to connect to the PostgreSQL server.
*   Ability to authenticate to the DIVA client.
*  For the buffer overflow, the attacker must have the ability to send a malicious AuthenticateUser request to the web service API.

This content provides more detailed information than the typical CVE description, including specific attack vectors, proof-of-concept examples, and the vendor's communication timeline.