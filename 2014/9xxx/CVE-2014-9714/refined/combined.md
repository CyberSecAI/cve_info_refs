=== Content from phabricator.wikimedia.org_e8894945_20250124_162232.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT85851)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T85851
# Reflected XSS in api.php using wddx formattingClosed, Resolved[Public](/policy/explain/PHID-TASK-wn4f6ut64iznnv5vhd75/view/)Actions

* [Edit Task](/maniphest/task/edit/85851/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/85851/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-wn4f6ut64iznnv5vhd75/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-wn4f6ut64iznnv5vhd75/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-wn4f6ut64iznnv5vhd75/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-wn4f6ut64iznnv5vhd75/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-wn4f6ut64iznnv5vhd75/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-wn4f6ut64iznnv5vhd75/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-wn4f6ut64iznnv5vhd75/)
* [Protect as security issue](/wmf/escalate-task/85851/)
* [Award Token](/token/give/PHID-TASK-wn4f6ut64iznnv5vhd75/)
* [Flag For Later](/flag/edit/PHID-TASK-wn4f6ut64iznnv5vhd75/)

Assigned To

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

Authored By

|  | [• csteipp](/p/csteipp/) |
| --- | --- |
| Jan 5 2015, 8:49 PM2015-01-05 20:49:24 (UTC+0) |

Tags

* [MediaWiki-Core-Team](/tag/mediawiki-core-team/)
* [MediaWiki-Action-API](/tag/mediawiki-action-api/) [(Needs Review)](/project/board/200/)
* [HHVM](/tag/hhvm/) [(Backlog)](/project/board/79/)
* [Vuln-XSS](/tag/vuln-xss/)
* [Patch-For-Review](/tag/patch-for-review/)
* [Security](/tag/security/)
Referenced Files

|  | [F32619: 0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch](/F32619) |
| --- | --- |
| Jan 28 2015, 5:53 PM2015-01-28 17:53:31 (UTC+0) |

|  | [F32400: 0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch](/F32400) |
| --- | --- |
| Jan 27 2015, 7:13 PM2015-01-27 19:13:17 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [Grunny](/p/Grunny/) |
| --- | --- |

|  | [Joe](/p/Joe/) |
| --- | --- |

|  | [Legoktm](/p/Legoktm/) |
| --- | --- |

|  | [ori](/p/ori/) |
| --- | --- |

|  | [ProgramCeltic](/p/ProgramCeltic/) |
| --- | --- |

# Description

FINDING ID: iSEC-WMF1214-8

DESCRIPTION: The API supports multiple data output formats, some of which have recently been

deprecated. The wddx output format will return a response with Content-Type: text/xml . The

response always indicates that the wddx output format has been deprecated and instructs the API

user to use the json format instead. However, if an API request with this output format is sent to

api.php with an invalid parameter, the response will also include an error message that reflects the

user-supplied parameter without any output encoding. This allows an attacker to inject XML, which

can be used to trick the browser into interpreting the response as XHTML and executing injected

JavaScript. To exploit this vulnerability, an attacker can craft a simple URL that, when clicked by

a MediaWiki user, will execute arbitrary JavaScript in their browser session for that domain. The

following URL will execute JavaScript that pops up an alert window on the resulting MediaWiki page,

demonstrating a reflected XSS attack.

<http://devwiki/w/api.php?action=flow&format=wddx&submodule=invalid%3C/string%3E%3Cfoo%3E%0A%3Chtml%20xmlns%3ahtml%3d%27http%3a%2f%2fwww.w3.org%2f1999%2fxhtml%27%3E%0A%20%3Chtml%3ascript%3Ealert(%22Reflected%20XSS!%22)%3b%3C%2fhtml%3ascript%3E%0A%3C%2fhtml%3E%0A%3C%2ffoo%3E%3Cstring%3E&page=User_talk%3AAdmin&ntreplyTo=&nttopic=Flow&ntcontent=flowwwww&token=3b44a9711080c52414b4d1f05682590554a1ead0%2B>

This exploit works on several browsers that iSEC tested and bypasses Chrome's anti-XSS filters, making

it especially effective.

---

**Patch**: 0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/qg7jnlmxls3d37izfil6/PHID-FILE-gkukjzh5n3cr3zy7ioxk/0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch)

* 1.24: 0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/qg7jnlmxls3d37izfil6/PHID-FILE-gkukjzh5n3cr3zy7ioxk/0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch)

**Affected Versions**: MediaWiki on HHVM before 3.6.1

**Type**: xss

**CVE**: CVE-2015-2941

# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: Fix reflected XSS in API with wddx output under HHVM](https://gerrit.wikimedia.org/r/c/201020) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_24](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_24) | +39 -9 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T85851)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T88120 [Release MW 1.24.2 and 1.23.9 tarballs](/T88120) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85862 [Make iSec assessment public](/T85862) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T87275 [MediaWiki Security release 1.24.2](/T87275) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85851 [Reflected XSS in api.php using wddx formatting](/T85851) |

Mentioned In [rMWced28b90e59b: SECURITY: Fix reflected XSS in API with wddx output under HHVM](/rMWced28b90e59b26c1cff08124bd572e0d4a79934e) Mentioned Here [T75531: ApiFormatWddxTest::testValidSyntax fails in mediawiki-core-regression-hhvm-master test](/T75531)
### Event Timeline

[• csteipp](/p/csteipp/) created this task.[Jan 5 2015, 8:49 PM2015-01-05 20:49:24 (UTC+0)](#956089)[• csteipp](/p/csteipp/) raised the priority of this task from  to High.[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-hdhuary43e567eh/)[• csteipp](/p/csteipp/) added projects: [acl\*security](/tag/acl_security/), [MediaWiki-Core-Team](/tag/mediawiki-core-team/).[• csteipp](/p/csteipp/) changed the visibility from "Public (No Login Required)" to "[acl\*security](/tag/acl_security/) (Project)".[• csteipp](/p/csteipp/) changed the edit policy from "All Users" to "[acl\*security](/tag/acl_security/) (Project)".[• csteipp](/p/csteipp/) changed Security from None to Software security bug.[• csteipp](/p/csteipp/) added subscribers: [• csteipp](/p/csteipp/), [Anomie](/p/Anomie/).Restricted Application changed the visibility from "[acl\*security](/tag/acl_security/) (Project)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-cb6lx6hovfbw7mo/)".  · [View Herald Transcript](/herald/transcript/535171/)[Jan 5 2015, 8:49 PM2015-01-05 20:49:24 (UTC+0)](#956098)Restricted Application changed the edit policy from "[acl\*security](/tag/acl_security/) (Project)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-2d27imoadf5quj2/)".  · [View Herald Transcript](/herald/transcript/535171/)[Anomie](/p/Anomie/) added a project: [MediaWiki-Action-API](/tag/mediawiki-action-api/).[Jan 5 2015, 8:55 PM2015-01-05 20:55:13 (UTC+0)](#956154)Restricted Application changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-rry7pyyosjzrunz/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-rry7pyyosjzrunz/)".  · [View Herald Transcript](/herald/transcript/535191/)[Jan 5 2015, 8:55 PM2015-01-05 20:55:13 (UTC+0)](#956155)Restricted Application changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-5qdgvf3hrkej7cl/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-5qdgvf3hrkej7cl/)".  · [View Herald Transcript](/herald/transcript/535191/)

[Anomie](/p/Anomie/) added a comment.[Jan 5 2015, 9:05 PM2015-01-05 21:05:39 (UTC+0)](#956165)Comment Actions

This appears to only affects HHVM, and should be fixed by the upstream change <https://github.com/facebook/hhvm/commit/324701c9fd31beb4f070f1b7ef78b115fbdfec34> that fixed [T75531](/T75531).

It should also be fixed by [Gerrit change 181580](https://gerrit.wikimedia.org/r/#/c/181580/) which implemented a better workaround in MediaWiki for the HHVM bug behind [T75531](/T75531).

Restricted Application changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-4byclrots25e7xi/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-4byclrots25e7xi/)".  · [View Herald Transcript](/herald/transcript/535197/)[Jan 5 2015, 9:05 PM2015-01-05 21:05:39 (UTC+0)](#956167)Restricted Application changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-ixvbthf6frzhj4u/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-ixvbthf6frzhj4u/)".  · [View Herald Transcript](/herald/transcript/535197/)[Anomie](/p/Anomie/) added a project: [HHVM](/tag/hhvm/).[Jan 5 2015, 9:06 PM2015-01-05 21:06:03 (UTC+0)](#956169)Restricted Application changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-2dlm6434mw6d3vk/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-2dlm6434mw6d3vk/)".  · [View Herald Transcript](/herald/transcript/535198/)[Jan 5 2015, 9:06 PM2015-01-05 21:06:03 (UTC+0)](#956170)Restricted Application changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-2ocvbycop3gfsxl/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-2ocvbycop3gfsxl/)".  · [View Herald Transcript](/herald/transcript/535198/)

[Anomie](/p/Anomie/) added a comment.Edited · [Jan 5 2015, 9:07 PM2015-01-05 21:07:53 (UTC+0)](#956173)Comment Actions

BTW, a better test link is <https://test.wikipedia.org/w/api.php?action=query&format=wddx&prop=invalid%3C/string%3E%3Cfoo%3E%0A%3Chtml%20xmlns%3ahtml%3d%27http%3a%2f%2fwww.w3.org%2f1999%2fxhtml%27%3E%0A%20%3Chtml%3ascript%3Ealert%28%22Reflected%20XSS!%22%29%3b%3C%2fhtml%3ascript%3E%0A%3C%2fhtml%3E%0A%3C%2ffoo%3E%3Cstring%3E> (since it doesn't rely on Flow being installed).

Restricted Application changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-hpgtzgyvqusgn7u/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-hpgtzgyvqusgn7u/)".  · [View Herald Transcript](/herald/transcript/535200/)[Jan 5 2015, 9:07 PM2015-01-05 21:07:53 (UTC+0)](#956174)Restricted Application changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-5opjyvznf5hohym/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-5opjyvznf5hohym/)".  · [View Herald Transcript](/herald/transcript/535200/)[• csteipp](/p/csteipp/) added subscribers: [Joe](/p/Joe/), [ori](/p/ori/).[Jan 7 2015, 6:14 PM2015-01-07 18:14:35 (UTC+0)](#960175)Comment Actions
> In [T85851#956165](/T85851#956165), [@Anomie](/p/Anomie/) wrote:
>
> This appears to only affects HHVM, and should be fixed by the upstream change <https://github.com/facebook/hhvm/commit/324701c9fd31beb4f070f1b7ef78b115fbdfec34> that fixed [T75531](/T75531).

[@Joe](/p/Joe/), [@ori](/p/ori/), what's the process for getting hhvm upgraded on the cluster?

Restricted Application changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-5ojo4uhlatyb3ik/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-5ojo4uhlatyb3ik/)".  · [View Herald Transcript](/herald/transcript/537430/)[Jan 7 2015, 6:14 PM2015-01-07 18:14:36 (UTC+0)](#960177)Restricted Application changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-ahel5pfhhwwxt2h/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-ahel5pfhhwwxt2h/)".  · [View Herald Transcript](/herald/transcript/537430/)

[Anomie](/p/Anomie/) added a comment.[Jan 8 2015, 2:07 PM2015-01-08 14:07:45 (UTC+0)](#962759)Comment Actions

I note that testwiki is no longer exhibiting the vulnerability, now that it is on 1.25wmf14 (which includes [Gerrit change 181580](https://gerrit.wikimedia.org/r/#/c/181580/))

Restricted Application changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-7tissbscuoe7onf/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-7tissbscuoe7onf/)".  · [View Herald Transcript](/herald/transcript/538826/)[Jan 8 2015, 2:07 PM2015-01-08 14:07:45 (UTC+0)](#962760)Restricted Application changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-gw2ig7seajxkom2/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-gw2ig7seajxkom2/)".  · [View Herald Transcript](/herald/transcript/538826/)[• csteipp](/p/csteipp/) added a parent task: [T87275: MediaWiki Security release 1.24.2](/T87275).[Jan 20 2015, 11:08 PM2015-01-20 23:08:51 (UTC+0)](#987727)

[Legoktm](/p/Legoktm/) subscribed.[Jan 27 2015, 6:19 PM2015-01-27 18:19:04 (UTC+0)](#996282)Comment Actions
> In [T85851#956165](/T85851#956165), [@Anomie](/p/Anomie/) wrote:
>
> It should also be fixed by [Gerrit change 181580](https://gerrit.wikimedia.org/r/#/c/181580/) which implemented a better workaround in MediaWiki for the HHVM bug behind [T75531](/T75531).

Should we backport this for people who might be running older HHVM versions?

[Anomie](/p/Anomie/) added a comment.[Jan 27 2015, 6:34 PM2015-01-27 18:34:44 (UTC+0)](#996339)Comment Actions

If we do decide to backport it (since it only affects certain versions of HHVM, maybe we shouldn't), only the changes in <https://gerrit.wikimedia.org/r/#/c/181580/7/includes/api/ApiFormatWddx.php> are needed. And, for that matter, only ApiFormatWddx::useSlowPrinter() and the change on line 41 to use it are needed.

[Legoktm](/p/Legoktm/) added a comment.[Jan 27 2015, 7:13 PM2015-01-27 19:13:17 (UTC+0)](#996446)Comment Actions

0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/vge4hi7xus6gmqv57rel/PHID-FILE-s4zx4ht3itnhufxied7y/0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch)

Haven't been able to install an older version of HHVM to test it.

[Anomie](/p/Anomie/) added a comment.[Jan 27 2015, 7:41 PM2015-01-27 19:41:18 (UTC+0)](#996492)Comment Actions

You've got a few extraneous changes in there (the two spacing-change bits at the end of the first block). Otherwise it looks like it should do it.

[Legoktm](/p/Legoktm/) added a comment.[Jan 28 2015, 5:53 PM2015-01-28 17:53:31 (UTC+0)](#998587)Comment Actions
> In [T85851#996492](/T85851#996492), [@Anomie](/p/Anomie/) wrote:
>
> You've got a few extraneous changes in there (the two spacing-change bits at the end of the first block). Otherwise it looks like it should do it.

0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/qg7jnlmxls3d37izfil6/PHID-FILE-gkukjzh5n3cr3zy7ioxk/0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch) removes the spacing changing.

[Anomie](/p/Anomie/) added a comment.[Jan 28 2015, 5:57 PM2015-01-28 17:57:02 (UTC+0)](#998608)Comment Actions
> In [T85851#998587](/T85851#998587), [@Legoktm](/p/Legoktm/) wrote:
>
> 0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch2 KB[Download](https://phab.wmfusercontent.org/file/download/qg7jnlmxls3d37izfil6/PHID-FILE-gkukjzh5n3cr3zy7ioxk/0001-SECURITY-Fix-reflected-XSS-in-API-with-wddx-output-u.patch) removes the spacing changing.

Code-Review: +1

[Anomie](/p/Anomie/) moved this task from [Unsorted](/project/board/200/) to [Needs Review](/project/board/200/) on the [MediaWiki-Action-API](/tag/mediawiki-action-api/) board.[Feb 19 2015, 6:04 PM2015-02-19 18:04:50 (UTC+0)](#1050277)[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-u26v4dy44v7cshe/)[Mar 18 2015, 12:09 AM2015-03-18 00:09:11 (UTC+0)](#1126975)[• csteipp](/p/csteipp/) added a project: [Vuln-XSS](/tag/vuln-xss/).[• csteipp](/p/csteipp/) closed this task as Resolved.[Mar 28 2015, 5:27 AM2015-03-28 05:27:02 (UTC+0)](#1159145)[• csteipp](/p/csteipp/) claimed this task.[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-wgbyzq4r5cmkffg/)[bd808](/p/bd808/) moved this task from [Backlog](/project/board/37/) to [Done](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Mar 30 2015, 7:21 PM2015-03-30 19:21:44 (UTC+0)](#1164128)[• csteipp](/p/csteipp/) added subscribers: [Grunny](/p/Grunny/), [ProgramCeltic](/p/ProgramCeltic/).[Mar 30 2015, 8:01 PM2015-03-30 20:01:49 (UTC+0)](#1164348)[• csteipp](/p/csteipp/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-terim2o5lg5tf43/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-terim2o5lg5tf43/)".[Mar 31 2015, 12:37 PM2015-03-31 12:37:32 (UTC+0)](#1166659)[• csteipp](/p/csteipp/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-twtthooywhflpt3/)" to "Public (No Login Required)".[Mar 31 2015, 9:15 PM2015-03-31 21:15:27 (UTC+0)](#1168316)[• csteipp](/p/csteipp/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-26h6awd5a66qhqs/)" to "All Users".[• csteipp](/p/csteipp/) changed Security from Software security bug to None.[gerritbot](/p/gerritbot/) subscribed.[Mar 31 2015, 9:22 PM2015-03-31 21:22:30 (UTC+0)](#1168381)Comment Actions

Change 201020 had a related patch set uploaded (by CSteipp):

SECURITY: Fix reflected XSS in API with wddx output under HHVM

<https://gerrit.wikimedia.org/r/201020>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Mar 31 2015, 9:22 PM2015-03-31 21:22:31 (UTC+0)](#1168382)[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 10:05 PM2015-03-31 22:05:31 (UTC+0)](#1168516)Comment Actions

Change 201020 merged by jenkins-bot:

SECURITY: Fix reflected XSS in API with wddx output under HHVM

<https://gerrit.wikimedia.org/r/201020>

[• csteipp](/p/csteipp/) mentioned this in [rMWced28b90e59b: SECURITY: Fix reflected XSS in API with wddx output under HHVM](/rMWced28b90e59b26c1cff08124bd572e0d4a79934e).[Mar 31 2015, 10:06 PM2015-03-31 22:06:05 (UTC+0)](#1168528)[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-zgxdmg26jjvbbik/)[Apr 9 2015, 11:26 PM2015-04-09 23:26:03 (UTC+0)](#1196426)[• csteipp](/p/csteipp/) added a comment.[Apr 9 2015, 11:28 PM2015-04-09 23:28:18 (UTC+0)](#1196441)Comment Actions

CVE assignment:

> It seems that the major concern here is the HHVM vulnerability fixed
>
> by the
>
> <https://github.com/facebook/hhvm/commit/324701c9fd31beb4f070f1b7ef78b115fbdfec34>
>
> commit. Use CVE-2014-9714 for that HHVM vulnerability.
>
> As far as we can tell, [T85851](/T85851) is recommending
>
> <https://gerrit.wikimedia.org/r/#/c/201020/1/includes/api/ApiFormatWddx.php,unified>
>
> as a vulnerability fix for MediaWiki deployments that use an older
>
> version of HHVM. Use CVE-2015-2941 for this MediaWiki vulnerability in
>
> which unsafe calls to wddx\_serialize\_value can occur.

[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:56 PM2020-02-10 22:56:08 (UTC+0)](#5868768) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:16 PM2020-02-20 20:16:12 (UTC+0)](#5904313) · [Aklapper](/p/Aklapper/) removed a subscriber: [Anomie](/p/Anomie/).[Oct 16 2020, 5:41 PM2020-10-16 17:41:12 (UTC+0)](#6554396) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from github.com_114608c5_20250126_021044.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffacebook%2Fhhvm%2Fcommit%2F324701c9fd31beb4f070f1b7ef78b115fbdfec34)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffacebook%2Fhhvm%2Fcommit%2F324701c9fd31beb4f070f1b7ef78b115fbdfec34)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=facebook%2Fhhvm)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[facebook](/facebook)
/
**[hhvm](/facebook/hhvm)**
Public

* [Notifications](/login?return_to=%2Ffacebook%2Fhhvm) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Ffacebook%2Fhhvm)
* [Star
   18.3k](/login?return_to=%2Ffacebook%2Fhhvm)

* [Code](/facebook/hhvm)
* [Issues
  453](/facebook/hhvm/issues)
* [Pull requests
  85](/facebook/hhvm/pulls)
* [Discussions](/facebook/hhvm/discussions)
* [Actions](/facebook/hhvm/actions)
* [Wiki](/facebook/hhvm/wiki)
* [Security](/facebook/hhvm/security)
* [Insights](/facebook/hhvm/pulse)

Additional navigation options

* [Code](/facebook/hhvm)
* [Issues](/facebook/hhvm/issues)
* [Pull requests](/facebook/hhvm/pulls)
* [Discussions](/facebook/hhvm/discussions)
* [Actions](/facebook/hhvm/actions)
* [Wiki](/facebook/hhvm/wiki)
* [Security](/facebook/hhvm/security)
* [Insights](/facebook/hhvm/pulse)

## Commit

[Permalink](/facebook/hhvm/commit/324701c9fd31beb4f070f1b7ef78b115fbdfec34)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

HTMLEncode strings in wddx\_serialize\_value()

[Browse files](/facebook/hhvm/tree/324701c9fd31beb4f070f1b7ef78b115fbdfec34)
Browse the repository at this point in the history

```
Summary: Strings returned through wddx_serialize_value should be HTMLEncode()'d during
serialization.

Fixes [#4283](https://github.com/facebook/hhvm/issues/4283)

{sync, type="child", parent="internal", parentrevid="1691695", parentrevfbid="1537976659780590", parentdiffid="5726084"}

Reviewed By: [@JoelMarcey](https://github.com/JoelMarcey)

Differential Revision: D1691695

Signature: t1:1691695:1416530595:722bfcdaf7c0dbee379bea886cd4c43d997ca7dd
```

* Loading branch information

[![@paulbiss](https://avatars.githubusercontent.com/u/1039792?s=40&v=4)](/paulbiss) [![@hhvm-bot](https://avatars.githubusercontent.com/u/8306375?s=40&v=4)](/hhvm-bot)

[paulbiss](/facebook/hhvm/commits?author=paulbiss "View all commits by paulbiss")
authored and
[hhvm-bot](/facebook/hhvm/commits?author=hhvm-bot "View all commits by hhvm-bot")
committed
Nov 21, 2014

1 parent
[d81ad6e](/facebook/hhvm/commit/d81ad6e8711aa20abe80a3a96ed86890f5cd188c)

commit 324701c

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**12 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* hphp

  + runtime/ext/wddx

    - hphp/runtime/ext/wddx/ext\_wddx.cpp
      [ext\_wddx.cpp](#diff-7417aa531c88744cfde99b6a70f9c26c1399b7521942429f442a40817cdcdbd4)
  + test/slow/ext\_wddx

    - hphp/test/slow/ext\_wddx/htmlent.php
      [htmlent.php](#diff-a967eadd428046d1c9dd6d03cc013e32034ae2f61be1889b2636e60c1625d139)
    - hphp/test/slow/ext\_wddx/htmlent.php.expect
      [htmlent.php.expect](#diff-17c9bc915400f1ee06a4dcd44f941635e4af1ca4c4e11d73a422da07a6721aeb)

## There are no files selected for viewing

6 changes: 5 additions & 1 deletion

6
[hphp/runtime/ext/wddx/ext\_wddx.cpp](#diff-7417aa531c88744cfde99b6a70f9c26c1399b7521942429f442a40817cdcdbd4 "hphp/runtime/ext/wddx/ext_wddx.cpp")

Show comments

[View file](/facebook/hhvm/blob/324701c9fd31beb4f070f1b7ef78b115fbdfec34/hphp/runtime/ext/wddx/ext_wddx.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -126,9 +126,13 @@ bool WddxPacket::recursiveAddVar(const String& varName, |
|  |  |  |
|  |  | std::string varType = getDataTypeString(varVariant.getType()).data(); |
|  |  | if (!getWddxEncoded(varType, "", varName, false).empty()) { |
|  |  | std::string varValue = varVariant.toString().data(); |
|  |  | std::string varValue; |
|  |  | if (varType.compare("boolean") == 0) { |
|  |  | varValue = varVariant.toBoolean() ? "true" : "false"; |
|  |  | } else { |
|  |  | varValue = StringUtil::HtmlEncode(varVariant.toString(), |
|  |  | StringUtil::QuoteStyle::Double, |
|  |  | "UTF-8", false, false).toCppString(); |
|  |  | } |
|  |  | m\_packetString += getWddxEncoded(varType, varValue, varName, hasVarTag); |
|  |  | return true; |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[hphp/test/slow/ext\_wddx/htmlent.php](#diff-a967eadd428046d1c9dd6d03cc013e32034ae2f61be1889b2636e60c1625d139 "hphp/test/slow/ext_wddx/htmlent.php")

Show comments

[View file](/facebook/hhvm/blob/324701c9fd31beb4f070f1b7ef78b115fbdfec34/hphp/test/slow/ext_wddx/htmlent.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,5 @@ |
|  |  | <?php |
|  |  | $s = wddx\_serialize\_value("Test for &"); |
|  |  | var\_dump($s); |
|  |  | $d = wddx\_deserialize($s); |
|  |  | var\_dump($d); |

2 changes: 2 additions & 0 deletions

2
[hphp/test/slow/ext\_wddx/htmlent.php.expect](#diff-17c9bc915400f1ee06a4dcd44f941635e4af1ca4c4e11d73a422da07a6721aeb "hphp/test/slow/ext_wddx/htmlent.php.expect")

Show comments

[View file](/facebook/hhvm/blob/324701c9fd31beb4f070f1b7ef78b115fbdfec34/hphp/test/slow/ext_wddx/htmlent.php.expect)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,2 @@ |
|  |  | string(92) "<wddxPacket version='1.0'><header/><data><string>Test for &amp;</string></data></wddxPacket>" |
|  |  | string(10) "Test for &" |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `324701c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffacebook%2Fhhvm%2Fcommit%2F324701c9fd31beb4f070f1b7ef78b115fbdfec34) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b4438ba3_20250124_162229.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffacebook%2Fhhvm%2Fissues%2F4283)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffacebook%2Fhhvm%2Fissues%2F4283)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=facebook%2Fhhvm)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[facebook](/facebook)
/
**[hhvm](/facebook/hhvm)**
Public

* [Notifications](/login?return_to=%2Ffacebook%2Fhhvm) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Ffacebook%2Fhhvm)
* [Star
   18.3k](/login?return_to=%2Ffacebook%2Fhhvm)

* [Code](/facebook/hhvm)
* [Issues
  453](/facebook/hhvm/issues)
* [Pull requests
  87](/facebook/hhvm/pulls)
* [Discussions](/facebook/hhvm/discussions)
* [Actions](/facebook/hhvm/actions)
* [Wiki](/facebook/hhvm/wiki)
* [Security](/facebook/hhvm/security)
* [Insights](/facebook/hhvm/pulse)

Additional navigation options

* [Code](/facebook/hhvm)
* [Issues](/facebook/hhvm/issues)
* [Pull requests](/facebook/hhvm/pulls)
* [Discussions](/facebook/hhvm/discussions)
* [Actions](/facebook/hhvm/actions)
* [Wiki](/facebook/hhvm/wiki)
* [Security](/facebook/hhvm/security)
* [Insights](/facebook/hhvm/pulse)

# wddx\_serialize\_value() does not escape "&"s #4283

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[wddx\_serialize\_value() does not escape "&"s](#top)#4283Copy linkAssignees [![paulbiss](https://avatars.githubusercontent.com/u/1039792?s=64&v=4)](/paulbiss)Labels[php5 incompatibility](https://github.com/facebook/hhvm/issues?q=state%3Aopen%20label%3A%22php5%20incompatibility%22)[![@scfc](https://avatars.githubusercontent.com/u/798568?v=4&size=80)](/scfc)
## Description

[![@scfc](https://avatars.githubusercontent.com/u/798568?v=4&size=48)](/scfc)[scfc](https://github.com/scfc)opened [on Nov 19, 2014](https://github.com/facebook/hhvm/issues/4283#issue-49317855)

With PHP 5.5.18, the test script:

```
<?php
$s = wddx_serialize_value("Test for &");
var_dump($s);
$d = wddx_deserialize($s);
var_dump($d);

```

gives:

```
string(92) "<wddxPacket version='1.0'><header/><data><string>Test for &amp;</string></data></wddxPacket>"
string(10) "Test for &"

```

HipHop VM 3.3.1 fails with:

```
string(88) "<wddxPacket version='1.0'><header/><data><string>Test for &</string></data></wddxPacket>"
Entity: line 1: parser error : xmlParseEntityRef: no name
<wddxPacket version='1.0'><header/><data><string>Test for &</string></data></wdd
                                                           ^
NULL

```

The "&" needs to be escaped for the resulting WDDX to be valid XML.

## Metadata

### Assignees

* [![@paulbiss](https://avatars.githubusercontent.com/u/1039792?s=64&v=4)paulbiss](/paulbiss)
### Labels

[php5 incompatibility](https://github.com/facebook/hhvm/issues?q=state%3Aopen%20label%3A%22php5%20incompatibility%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_473cc16a_20250124_162227.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2015/03/31/9) [[next>]](2) [[thread-next>]](../../../2015/04/07/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAKcmtDzP7GhQWdTNb2XaVD1dzfDPXzyjWRhoYaKPrZy+NALygA@mail.gmail.com>
Date: Tue, 31 Mar 2015 18:34:21 -0700
From: Chris Steipp <csteipp@...imedia.org>
To: oss-security@...ts.openwall.com
Subject: CVE request: MediaWiki 1.24.2/1.23.9/1.19.24

Hi, we patched several security issues in MediaWiki today. Could we get
CVE's assigned?

* iSEC Partners discovered a way to circumvent the SVG MIME blacklist for
embedded resources (iSEC-WMF1214-11). This allowed an attacker to embed
JavaScript in the SVG. The issue was additionally identified by Mario
Heiderich / Cure53. MIME types are now whitelisted.
<<https://phabricator.wikimedia.org/T85850>>

* MediaWiki user Bawolff pointed out that the SVG filter to prevent
injecting JavaScript using animate elements was incorrect.
<<https://phabricator.wikimedia.org/T86711>>

* MediaWiki user Bawolff reported a stored XSS vulnerability due to the way
attributes were expanded in MediaWiki's Html class, in combination with
LanguageConverter substitutions.
<<https://phabricator.wikimedia.org/T73394>>

* Internal review discovered that MediaWiki's SVG filtering could be
bypassed with entity encoding under the Zend interpreter. This could be
used to inject JavaScript. This issue was also discovered by Mario Gomes /
Beyond Security.
<<https://phabricator.wikimedia.org/T88310>>

* iSEC Partners discovered a way to bypass the style filtering for SVG
files (iSEC-WMF1214-3) to load external resource. This could violate the
anonymity of users viewing the SVG.
<<https://phabricator.wikimedia.org/T85349>>

* Internal review and iSEC Partners discovered (iSEC-WMF1214-1) that
MediaWiki versions using PBKDF2 for password hashing (the default since
1.24) are vulnerable to DoS attacks using extremely long passwords.
<<https://phabricator.wikimedia.org/T64685>>

* Internal review found that MediaWiki is vulnerable to "Quadratic Blowup"
DoS attacks, under both HHVM and Zend PHP.
<<https://phabricator.wikimedia.org/T71210>>

* iSEC Partners reported that the MediaWiki feature allowing a user to
preview another user's custom JavaScript could be abused for privilege
escalation (iSEC-WMF1214-10). This feature has been removed.
<<https://phabricator.wikimedia.org/T85855>>

* Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function
names were sanitized in Lua error backtraces, which could lead to XSS.
<<https://phabricator.wikimedia.org/T85113>>

* Extension:CheckUser - iSEC Partners discovered that the CheckUser
extension did not prevent CSRF attacks on the form allowing checkusers to
look up sensitive information about other users (iSEC-WMF1214-6). Since the
use of CheckUser is logged, the CSRF could be abused to defame a trusted
user or flood the logs with noise.
<<https://phabricator.wikimedia.org/T85858>>

These next issues came up because of the difference in how HHVM handles PHP
code vs Zend. I'm not sure if CVE's are assigned for specific runtime
configurations? For MediaWiki, we say that HHVM support is experimental,
although we do run Wikipedia on it.

* iSEC Partners discovered a XSS vulnerability in the way api errors were
reflected under HHVM versions before 3.6.1 (iSEC-WMF1214-8). MediaWiki now
detects and mitigates this issue on older versions of HHVM.
<<https://phabricator.wikimedia.org/T85851>>

* iSEC Partners discovered that MediaWiki's SVG and XMP parsing running
under HHVM was susceptible to "Billion Laughs" DoS attacks
(iSEC-WMF1214-13).
<<https://phabricator.wikimedia.org/T85848>>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_697f15b9_20250124_162227.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2015/04/01/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150407073412.354C26C0003@smtpvmsrv1.mitre.org>
Date: Tue,  7 Apr 2015 03:34:12 -0400 (EDT)
From: cve-assign@...re.org
To: csteipp@...imedia.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: MediaWiki 1.24.2/1.23.9/1.19.24

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> * iSEC Partners discovered a way to circumvent the SVG MIME blacklist for
> embedded resources (iSEC-WMF1214-11). This allowed an attacker to embed
> JavaScript in the SVG. The issue was additionally identified by Mario
> Heiderich / Cure53. MIME types are now whitelisted.
> <https://phabricator.wikimedia.org/T85850>

Use CVE-2015-2931 for this issue involving an incomplete list of
disallowed MIME types for data: URIs (the application/xml type wasn't
in this list). In other words, CVE-2015-2931 does not refer more
generally to the desirability of the "MIME types are now whitelisted"
decision.

> * MediaWiki user Bawolff pointed out that the SVG filter to prevent
> injecting JavaScript using animate elements was incorrect.
> <https://phabricator.wikimedia.org/T86711>

Use CVE-2015-2932 for this issue involving an incomplete list of
dangerous parts of HTML5. (The list is supposed to include all uses of
'animate attributename="xlink:href"' in SVG documents.)

> * MediaWiki user Bawolff reported a stored XSS vulnerability due to the way
> attributes were expanded in MediaWiki's Html class, in combination with
> LanguageConverter substitutions.
> <https://phabricator.wikimedia.org/T73394>

Use CVE-2015-2933 for this XSS issue.

Also, this part of T73394 seems potentially interesting although it is
apparently neither a MediaWiki bug nor a PHP bug:

  <https://phabricator.wikimedia.org/T73394#750588>
  preg_match() silently returns false on limit exhaustion

In other words, if a PHP application uses
"ini_set('pcre.recursion_limit'" and does not properly handle the
preg_match return value, then a hard-to-find XSS vulnerability might
exist.

> * Internal review discovered that MediaWiki's SVG filtering could be
> bypassed with entity encoding under the Zend interpreter. This could be
> used to inject JavaScript. This issue was also discovered by Mario Gomes /
> Beyond Security.
> <https://phabricator.wikimedia.org/T88310>

Use CVE-2015-2934 for this interaction issue in which (roughly
speaking) secure operation of MediaWiki had been relying on a libxml
behavior that was removed for unrelated security reasons. (In other
words, it's apparently an usual type of vulnerability whose avoidance
requires studying all "improvements" in new releases of library code,
and determining whether any of them have unintended adverse
consequences.)

> * iSEC Partners discovered a way to bypass the style filtering for SVG
> files (iSEC-WMF1214-3) to load external resource. This could violate the
> anonymity of users viewing the SVG.
> <https://phabricator.wikimedia.org/T85349>

Use CVE-2015-2935 for this issue of information leaks observable in
log files on an attacker-controlled web server. This issue exists
because of an incomplete fix for CVE-2014-7199.

> * Internal review and iSEC Partners discovered (iSEC-WMF1214-1) that
> MediaWiki versions using PBKDF2 for password hashing (the default since
> 1.24) are vulnerable to DoS attacks using extremely long passwords.
> <https://phabricator.wikimedia.org/T64685>

Use CVE-2015-2936 for this vulnerability with a CPU consumption impact.

> * Internal review found that MediaWiki is vulnerable to "Quadratic Blowup"
> DoS attacks, under both HHVM and Zend PHP.
> <https://phabricator.wikimedia.org/T71210>

Use CVE-2015-2937. This is a quadratic issue and isn't the same as the
CVE-2015-2942 exponential issue affecting only HHVM (see below).

> * iSEC Partners reported that the MediaWiki feature allowing a user to
> preview another user's custom JavaScript could be abused for privilege
> escalation (iSEC-WMF1214-10). This feature has been removed.
> <https://phabricator.wikimedia.org/T85855>

Use CVE-2015-2938 for this XSS issue.

> * Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function
> names were sanitized in Lua error backtraces, which could lead to XSS.
> <https://phabricator.wikimedia.org/T85113>

Use CVE-2015-2939 for this XSS issue. In the above quoted text, "were
sanitized" should be "were not sanitized" instead.

> * Extension:CheckUser - iSEC Partners discovered that the CheckUser
> extension did not prevent CSRF attacks on the form allowing checkusers to
> look up sensitive information about other users (iSEC-WMF1214-6). Since the
> use of CheckUser is logged, the CSRF could be abused to defame a trusted
> user or flood the logs with noise.
> <https://phabricator.wikimedia.org/T85858>

For purposes of CVE, we'll accept reports from a software's author
stating that there is a CSRF vulnerability for a request to read data.
Use CVE-2015-2940. This does not mean that similar reports from
arbitrary researchers about arbitrary products would have CVE IDs
assigned. For many products, the implied security policy does not
include a CSRF protection mechanism that prevents all
undesirable/confusing log entries.

> I'm not sure if CVE's are assigned for specific runtime
> configurations? For MediaWiki, we say that HHVM support is experimental,
> although we do run Wikipedia on it.

There isn't a general rule that CVE IDs are assigned for arbitrary
unsupported deployments of a product. Our impression is that users may
realistically decide that the HHVM support is "complete enough" for
their purposes. Also, in some cases, HHVM support is referenced or
documented in places that don't directly discuss the experimental
nature, such as on the <http://www.mediawiki.org/wiki/HHVM> and
[http://www.mediawiki.org/wiki/Manual:How_to_debug](http://www.mediawiki.org/wiki/Manual%3AHow_to_debug) pages. So, here, we
do want to assign CVE IDs applicable only to HHVM deployments.

> * iSEC Partners discovered a XSS vulnerability in the way api errors were
> reflected under HHVM versions before 3.6.1 (iSEC-WMF1214-8). MediaWiki now
> detects and mitigates this issue on older versions of HHVM.
> <https://phabricator.wikimedia.org/T85851>

It seems that the major concern here is the HHVM vulnerability fixed
by the
<https://github.com/facebook/hhvm/commit/324701c9fd31beb4f070f1b7ef78b115fbdfec34>
commit. Use CVE-2014-9714 for that HHVM vulnerability.

As far as we can tell, T85851 is recommending
<https://gerrit.wikimedia.org/r/#/c/201020/1/includes/api/ApiFormatWddx.php,unified>
as a vulnerability fix for MediaWiki deployments that use an older
version of HHVM. Use CVE-2015-2941 for this MediaWiki vulnerability in
which unsafe calls to wddx_serialize_value can occur.

> * iSEC Partners discovered that MediaWiki's SVG and XMP parsing running
> under HHVM was susceptible to "Billion Laughs" DoS attacks
> (iSEC-WMF1214-13).
> <https://phabricator.wikimedia.org/T85848>

Use CVE-2015-2942 for this exponential issue, which is different from
the CVE-2015-2937 quadratic issue mentioned above.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVI4etAAoJEKllVAevmvmsxk0H/R0orjbDyN56mEOJ9a/rlowS
D5cuaiDe4dzWbqEOzii8g+3d2iVsb1BUJHxfuGOFjf0zstb2KhJP5iaKN6hsXcHn
HKdtHE8uKMzs5DYxxeGsbphrp/J/Uff1+G7vwPmBTG3Z+tcLNXstuoIO18Pg3HuP
yT/P37KKJvlyhn5l325M4h0ln3kRu7egDHEctsJGNnb0IHoSoT8VmaiMYs/OwdP/
GT0XZVc7iNIBpXx0Ao03HxaSMgEfFs5X8PNnO95j9V9ngcP7zKQVT9ycsBHAhawP
dP+etPml55OJJKViqVZji5Dvv6BxZWnBACgzDI9ZcNFSHSykgr6Y3E+6nxmEKWY=
=vxIE
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from gerrit.wikimedia.org_6a7e441f_20250126_021044.html ===




=== Content from lists.wikimedia.org_c65686ea_20250124_162231.html ===


[lists.wikimedia.org](/hyperkitty/)

[Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)
[Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)

* [Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)
* [Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)

* [Manage this list](/postorius/lists/mediawiki-announce.lists.wikimedia.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2025/1/)

### 2024

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/1/)

### 2023

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/1/)

### 2022

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/1/)

### 2021

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/1/)

### 2020

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/1/)

### 2019

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/1/)

### 2018

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/1/)

### 2017

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/1/)

### 2016

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/1/)

### 2015

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/1/)

### 2014

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/1/)

### 2013

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/1/)

### 2012

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/1/)

### 2011

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/1/)

### 2010

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/1/)

### 2009

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/1/)

### 2008

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/1/)

### 2007

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/1/)

### 2006

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/1/)

### 2005

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/1/)

### 2004

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2004/12/)

[List overview](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

[Download](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/export/mediawiki-announce%40lists.wikimedia.org-OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN.mbox.gz?message=OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN "This message in gzipped mbox format")

[thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/#OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN)

# [MediaWiki-announce] MediaWiki Security and Maintenance Releases: 1.19.24, 1.23.9, and 1.24.2

[Chris Steipp](/hyperkitty/users/dd272b532a8d4667a37daa128483ef95/ "See the profile for Chris Steipp")

31 Mar
2015

31 Mar
'15

11:20 p.m.

I would like to announce the release of MediaWiki 1.24.2, 1.23.9 and
1.19.24. These releases fix 10 security issues, in addition to other bug
fixes. Download links are given at the end of this email.

== Security fixes ==

\* iSEC Partners discovered a way to circumvent the SVG MIME blacklist for
embedded resources (iSEC-WMF1214-11). This allowed an attacker to embed
JavaScript in the SVG. The issue was additionally identified by Mario
Heiderich / Cure53. MIME types are now whitelisted.
<https://phabricator.wikimedia.org/T85850>

\* MediaWiki user Bawolff pointed out that the SVG filter to prevent
injecting JavaScript using animate elements was incorrect.
<https://phabricator.wikimedia.org/T86711>

\* MediaWiki user Bawolff reported a stored XSS vulnerability due to the way
attributes were expanded in MediaWiki's Html class, in combination with
LanguageConverter substitutions.
<https://phabricator.wikimedia.org/T73394>

\* Internal review discovered that MediaWiki's SVG filtering could be
bypassed with entity encoding under the Zend interpreter. This could be
used to inject JavaScript. This issue was also discovered by Mario Gomes
from Beyond Security.
<https://phabricator.wikimedia.org/T88310>

\* iSEC Partners discovered a XSS vulnerability in the way api errors were
reflected when running under HHVM versions before 3.6.1 (iSEC-WMF1214-8).
MediaWiki now detects and mitigates this issue on older versions of HHVM.
<https://phabricator.wikimedia.org/T85851>

\* Internal review and iSEC Partners discovered (iSEC-WMF1214-1) that
MediaWiki versions using PBKDF2 for password hashing (the default since
1.24) are vulnerable to DoS attacks using extremely long passwords.
<https://phabricator.wikimedia.org/T64685>

\* iSEC Partners discovered that MediaWiki's SVG and XMP parsing, running
under HHVM, was susceptible to "Billion Laughs" DoS attacks
(iSEC-WMF1214-13).
<https://phabricator.wikimedia.org/T85848>

\* Internal review found that MediaWiki is vulnerable to "Quadratic Blowup"
DoS attacks, under both HHVM and Zend PHP.
<https://phabricator.wikimedia.org/T71210>

\* iSEC Partners discovered a way to bypass the style filtering for SVG
files (iSEC-WMF1214-3). This could violate the anonymity of users viewing
the SVG.
<https://phabricator.wikimedia.org/T85349>

\* iSEC Partners reported that the MediaWiki feature allowing a user to
preview another user's custom JavaScript could be abused for privilege
escalation (iSEC-WMF1214-10). This feature has been removed.
<https://phabricator.wikimedia.org/T85855>

Additionally, the following extensions have been updated to fix security
issues:

\* Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function
names were not sanitized in Lua error backtraces, which could lead to XSS.
<https://phabricator.wikimedia.org/T85113>

\* Extension:CheckUser - iSEC Partners discovered that the CheckUser
extension did not prevent CSRF attacks on the form allowing checkusers to
look up sensitive information about other users (iSEC-WMF1214-6). Since the
use of CheckUser is logged, the CSRF could be abused to defame a trusted
user or flood the logs with noise.
<https://phabricator.wikimedia.org/T85858>

== Bug fixes ==

=== 1.24 ===

\* Fix case of SpecialAllPages/SpecialAllMessages in SpecialPageFactory to
fix loading these special pages when $wgAutoloadAttemptLowercase is false.
\* (bug T76254) Fix deleting of pages with PostgreSQL. Requires a schema
change and running update.php to fix.

== 1.23 & 1.24 ==

\* (bug T70087) Fix Special:ActiveUsers page for installations using
PostgreSQL.

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

Full release notes:
<https://www.mediawiki.org/wiki/Release_notes/1.24>
<https://www.mediawiki.org/wiki/Release_notes/1.23>
<https://www.mediawiki.org/wiki/Release_notes/1.19>

Download:
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.tar.gz>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.tar.gz>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.tar.gz>

Patch to previous version:
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.patch.gz>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.patch.gz>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.patch.gz>

GPG signatures:
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.patch.gz.sig>

Extensions:
[http://www.mediawiki.org/wiki/Extension:Scribunto](http://www.mediawiki.org/wiki/Extension%3AScribunto)
[http://www.mediawiki.org/wiki/Extension:CheckUser](http://www.mediawiki.org/wiki/Extension%3ACheckUser)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/#OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN)

[Back to the list](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.


