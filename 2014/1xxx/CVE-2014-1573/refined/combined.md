=== Content from www.mandriva.com_1240e8cb_20250125_205526.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from openwall.com_e0f0488b_20250125_205521.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](19) [[next>]](21) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20141007111351.GA7104@openwall.com>
Date: Tue, 7 Oct 2014 15:13:51 +0400
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: "New Class of Vulnerability in Perl Web Applications"

Hi,

I feel this is worth bringing in here (and I wish someone wrote a proper
mailing list posting with this info, to have it properly archived):

New Class of Vulnerability in Perl Web Applications
<http://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/>

"While perl may have a particularly subtle manifestation, this is not Perl-specific."
<http://www.reddit.com/r/netsec/comments/2ihen0/new_class_of_vulnerability_in_perl_web/>

Bugzilla 4.0.14, 4.2.10, 4.4.5, and 4.5.5 Security Advisory
<http://www.bugzilla.org/security/4.0.14/>

Bug 1074812 - (CVE-2014-1572) [SECURITY] The 'realname' parameter is not correctly filtered on user account creation, leading to user data override
<https://bugzilla.mozilla.org/show_bug.cgi?id=1074812>

<http://www.opennet.ru/opennews/art.shtml?num=40766> (Russian)

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.mozilla.org_ef446784_20250126_115410.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1075578)
* [XML](/show_bug.cgi?ctype=xml&id=1075578)

Closed
[Bug 1075578](/show_bug.cgi?id=1075578)
(CVE-2014-1573)

Opened 10 years ago
Closed 10 years ago

# [SECURITY] Improper filtering of CGI arguments

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] Improper filtering of CGI arguments

## Categories

### (Bugzilla :: Bugzilla-General, defect, P1)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=Bugzilla-General#Bugzilla-General)

Bugzilla-General
▾

Bugzilla :: Bugzilla-General
Anything that doesn't fit in the other components, or spans multiple components.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=Bugzilla-General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=Bugzilla-General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

blocker

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 4.0

## People

### (Reporter: LpSolit, Assigned: LpSolit)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [LpSolit](/user_profile?user_id=120380)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

39 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1072497](/show_bug.cgi?id=1072497 "RESOLVED FIXED - Security advisory for Bugzilla 4.5.6, 4.4.6, 4.2.11, and 4.0.15"), [CVE-2014-1572](/show_bug.cgi?id=1074812 "RESOLVED FIXED - [SECURITY] The 'realname' parameter is not correctly filtered on user account creation, leading to user data override")

[1074980](/show_bug.cgi?id=1074980 "RESOLVED FIXED - Forbid the { foo => $cgi->param() } syntax to prevent data override")

Dependency [tree](/showdependencytree.cgi?id=1075578&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1075578)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: regression, Whiteboard: EMBARGO until Monday Oct 6, 7am PDT (10am Eastern))

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2014-1573

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

EMBARGO until Monday Oct 6, 7am PDT (10am Eastern)

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [mail](/user_profile?user_id=124400) | [approval](#a205189_124400 "10 years ago") | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | approval | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | [approval4.4](#a205189_124400 "10 years ago") | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | approval4.4 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.4.6](#c0 "10 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.4.6 | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | [approval4.2](#a205189_124400 "10 years ago") | + |
| --- | --- | --- |
| [mail](/user_profile?user_id=124400) | approval4.2 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.2.11](#c0 "10 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.2.11 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval4.0](#a440376_10297 "10 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval4.0 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.0.15](#c0 "10 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.0.15 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [testcase](#c0 "10 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | testcase | + | | |
| --- | --- | --- | --- | --- |
|  | approval5.0 | ? |
| --- | --- | --- |
|  | approval5.2 | ? |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 5 obsolete files)

| [WIP, v0.1](/attachment.cgi?id=8498216)  [10 years ago](#c2)  [Frédéric Buclin](/user_profile?user_id=120380)   1.94 KB, patch |  | [Details](/attachment.cgi?id=8498216&action=edit) | [Diff](/attachment.cgi?id=8498216&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498216) |
| --- | --- | --- |
| [WIP, v0.2](/attachment.cgi?id=8498285)  [10 years ago](#c6)  [Frédéric Buclin](/user_profile?user_id=120380)   5.00 KB, patch |  | [Details](/attachment.cgi?id=8498285&action=edit) | [Diff](/attachment.cgi?id=8498285&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498285) |
| [WIP, v0.3](/attachment.cgi?id=8498376)  [10 years ago](#c9)  [Frédéric Buclin](/user_profile?user_id=120380)   7.26 KB, patch |  | [Details](/attachment.cgi?id=8498376&action=edit) | [Diff](/attachment.cgi?id=8498376&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498376) |
| [WIP, v0.4](/attachment.cgi?id=8498399)  [10 years ago](#c11)  [Frédéric Buclin](/user_profile?user_id=120380)   10.31 KB, patch |  | [Details](/attachment.cgi?id=8498399&action=edit) | [Diff](/attachment.cgi?id=8498399&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498399) |
| [patch for trunk, v1](/attachment.cgi?id=8498492)  [10 years ago](#c13)  [Frédéric Buclin](/user_profile?user_id=120380)   11.53 KB, patch | dkl : [review+](#c14 "10 years ago")  gerv : [review+](#c15 "10 years ago") | [Details](/attachment.cgi?id=8498492&action=edit) | [Diff](/attachment.cgi?id=8498492&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498492) |
| [patch for 4.4, v1](/attachment.cgi?id=8499050)  [10 years ago](#c23)  [Frédéric Buclin](/user_profile?user_id=120380)   11.03 KB, patch | dkl : [review+](#c25 "10 years ago") | [Details](/attachment.cgi?id=8499050&action=edit) | [Diff](/attachment.cgi?id=8499050&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499050) |
| [patch for 4.2, v1](/attachment.cgi?id=8499092)  [10 years ago](#c24)  [Frédéric Buclin](/user_profile?user_id=120380)   12.59 KB, patch | dkl : [review+](#c26 "10 years ago") | [Details](/attachment.cgi?id=8499092&action=edit) | [Diff](/attachment.cgi?id=8499092&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499092) |
| [patch for 4.0, v1](/attachment.cgi?id=8499926)  [10 years ago](#c29)  [Frédéric Buclin](/user_profile?user_id=120380)   11.62 KB, patch |  | [Details](/attachment.cgi?id=8499926&action=edit) | [Diff](/attachment.cgi?id=8499926&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499926) |
| [patch for 4.0, v1.1](/attachment.cgi?id=8499928)  [10 years ago](#c30)  [Frédéric Buclin](/user_profile?user_id=120380)   11.63 KB, patch | dkl : [review+](#c31 "10 years ago") | [Details](/attachment.cgi?id=8499928&action=edit) | [Diff](/attachment.cgi?id=8499928&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499928) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1075578#c0)• 10 years ago |
|  | |

I wrote a test in [bug 1074980](/show_bug.cgi?id=1074980 "RESOLVED FIXED - Forbid the { foo => $cgi->param() } syntax to prevent data override") to catch the |foo => $cgi->param()| syntax, and it found 15 places which use this syntax. The first one I checked is already exploitable (XSS), and I didn't look at the other ones yet. I think things are worse than expected in [bug 1074812](/show_bug.cgi?id=1074812 "RESOLVED FIXED - [SECURITY] The 'realname' parameter is not correctly filtered on user account creation, leading to user data override").
I will comment in this bug when new vulnerabilities are found, and will also update my patch accordingly.Flags: testcase+Flags: blocking4.4.6+Flags: blocking4.2.11+Flags: blocking4.0.15+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a207_120380)• 10 years ago |

Summary: [SECURITY] The 'realname' parameter is not correctly filtered on user account creation, leading to user data override → [SECURITY] Improper filtering of CGI arguments

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a445_120380)• 10 years ago |

Whiteboard: [Same CVE number as the original bug 1074812: CVE-2014-1572]

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1075578#c2)• 10 years ago |
|  | |

Attached patch

[WIP, v0.1](attachment.cgi?id=8498216&action=diff) (obsolete)
— [Details](attachment.cgi?id=8498216&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498216)

This patch fixes the vulnerability reported in [comment 1](/show_bug.cgi?id=1075578#c1 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments") and the original issue about token.cgi from [bug 1074812](/show_bug.cgi?id=1074812 "RESOLVED FIXED - [SECURITY] The 'realname' parameter is not correctly filtered on user account creation, leading to user data override").

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1075578#c3)• 10 years ago |
|  | |

Do we need to check that they are all exploitable? Can't we just patch them all and forbid the pattern? Or do we need more detailed exploit information to e.g. allocate CVEs or write proper release notes?
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1075578#c4)• 10 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #3](/show_bug.cgi?id=1075578#c3 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments"))
> Do we need to check that they are all exploitable? Can't we just patch them
> all and forbid the pattern?
The pattern is already forbidden, see [bug 1074980](/show_bug.cgi?id=1074980 "RESOLVED FIXED - Forbid the { foo => $cgi->param() } syntax to prevent data override"). But blindly prepending "scalar" everywhere doesn't make much sense. I like to know which parts of the code are vulnerable as this often discloses more hidden problems.Blocks: [1074980](/show_bug.cgi?id=1074980 "RESOLVED FIXED - Forbid the { foo => $cgi->param() } syntax to prevent data override")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a5526_1689)• 10 years ago |

Alias: CVE-2014-1572Whiteboard: [Same CVE number as the original bug 1074812: CVE-2014-1572]

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1075578#c6)• 10 years ago |
|  | |

Attached patch

[WIP, v0.2](attachment.cgi?id=8498285&action=diff) (obsolete)
— [Details](attachment.cgi?id=8498285&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498285)

2nd vuln. fixed.
[Attachment #8498216](/attachment.cgi?id=8498216&action=edit "WIP, v0.1") -
Attachment is obsolete: true

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1075578#c8)• 10 years ago |
|  | |

Note: the PoC works, but Bugzilla fails to autolinkify the final "}" so clicking the link in [comment 7](/show_bug.cgi?id=1075578#c7 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments") won't work. Copy and paste instead.
Gerv

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1075578#c9)• 10 years ago |
|  | |

Attached patch

[WIP, v0.3](attachment.cgi?id=8498376&action=diff) (obsolete)
— [Details](attachment.cgi?id=8498376&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498376)

3rd vuln. fixed
[Attachment #8498285](/attachment.cgi?id=8498285&action=edit "WIP, v0.2") -
Attachment is obsolete: true

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1075578#c11)• 10 years ago |
|  | |

Attached patch

[WIP, v0.4](attachment.cgi?id=8498399&action=diff) (obsolete)
— [Details](attachment.cgi?id=8498399&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498399)

4th vuln. fixed. Two files left and I'm done with this bug.
[Attachment #8498376](/attachment.cgi?id=8498376&action=edit "WIP, v0.3") -
Attachment is obsolete: true

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1075578#c13)• 10 years ago |
|  | |

Attached patch

[patch for trunk, v1](attachment.cgi?id=8498492&action=diff)
— [Details](attachment.cgi?id=8498492&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498492)

Here is the final patch for trunk. This patch doesn't apply cleanly to 4.x and will need backports once this one is reviewed.
[Attachment #8498399](/attachment.cgi?id=8498399&action=edit "WIP, v0.4") -
Attachment is obsolete: true
[Attachment #8498492](/attachment.cgi?id=8498492&action=edit "patch for trunk, v1") -
Flags: review?(dkl)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a34676_120380)• 10 years ago |

Blocks: [CVE-2014-1572](/show_bug.cgi?id=1074812 "RESOLVED FIXED - [SECURITY] The 'realname' parameter is not correctly filtered on user account creation, leading to user data override")No longer depends on: [CVE-2014-1572](/show_bug.cgi?id=1074812 "RESOLVED FIXED - [SECURITY] The 'realname' parameter is not correctly filtered on user account creation, leading to user data override")

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1075578#c14)• 10 years ago |
|  | |

Comment on [attachment 8498492](/attachment.cgi?id=8498492 "patch for trunk, v1") [[details]](/attachment.cgi?id=8498492&action=edit "patch for trunk, v1") [[diff]](/attachment.cgi?id=8498492&action=diff "patch for trunk, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498492)
patch for trunk, v1
Review of [attachment 8498492](/attachment.cgi?id=8498492 "patch for trunk, v1") [[details]](/attachment.cgi?id=8498492&action=edit "patch for trunk, v1") [[diff]](/attachment.cgi?id=8498492&action=diff "patch for trunk, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498492):
-----------------------------------------------------------------
r=dkl
[Attachment #8498492](/attachment.cgi?id=8498492&action=edit "patch for trunk, v1") -
Flags: review?(dkl) → review+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a43696_5898)• 10 years ago |

Flags: approval?

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1075578#c15)• 10 years ago |
|  | |

Comment on [attachment 8498492](/attachment.cgi?id=8498492 "patch for trunk, v1") [[details]](/attachment.cgi?id=8498492&action=edit "patch for trunk, v1") [[diff]](/attachment.cgi?id=8498492&action=diff "patch for trunk, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498492)
patch for trunk, v1
Review of [attachment 8498492](/attachment.cgi?id=8498492 "patch for trunk, v1") [[details]](/attachment.cgi?id=8498492&action=edit "patch for trunk, v1") [[diff]](/attachment.cgi?id=8498492&action=diff "patch for trunk, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8498492):
-----------------------------------------------------------------
It may be a bit late to suggest this, but $cgi is an object we control, right? A Bugzilla/CGI.pm object? So perhaps we should have a new function on that objection, oneparam(), which only returns a scalar value, and make the param() call throw? That would prevent anyone making this mistake again in the future. I know we have a test, but is it possible that the same problem could occur in other contexts?
Alternative idea: should we try and ban assigning the return value of functions to hash members entirely? I.e. you need to extract it to a variable first? Or is that overkill?
Having suggested all that, this patch seems good to me for fixing the problem now.
Gerv
[Attachment #8498492](/attachment.cgi?id=8498492&action=edit "patch for trunk, v1") -
Flags: review+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1075578#c16)• 10 years ago |
|  | |

(In reply to Gervase Markham [:gerv] from [comment #15](/show_bug.cgi?id=1075578#c15 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments"))
> A Bugzilla/CGI.pm object? So perhaps we should have a new function on
> that objection, oneparam(), which only returns a scalar value
This wouldn't really help. You would still have to think about returning a scalar or an array. If the developer thinks about that, he could as well write "scalar" in front of "$cgi->param(). And the number of places to fix s/param/oneparam/ would be huge and really prone to errors.
> Alternative idea: should we try and ban assigning the return value of
> functions to hash members entirely? I.e. you need to extract it to a
> variable first? Or is that overkill?
IMO overkill to forbid it explicitly (i.e. enforced in a test). In methods called very often, you don't want to store the data in a separate variable (see e.g. [bug 797636](/show_bug.cgi?id=797636 "RESOLVED FIXED - Improve performance for buglists")).

|  | [Gervase Markham [:gerv]](/user_profile?user_id=9911) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1075578#c17)• 10 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #16](/show_bug.cgi?id=1075578#c16 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments"))
> (In reply to Gervase Markham [:gerv] from [comment #15](/show_bug.cgi?id=1075578#c15 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments"))
> > A Bugzilla/CGI.pm object? So perhaps we should have a new function on
> > that objection, oneparam(), which only returns a scalar value
>
> This wouldn't really help. You would still have to think about returning a
> scalar or an array.
No, it would always return a scalar. If we needed a version returning an array (which we probably would), we'd implement multiparam() as well. Or we could call them scalarparam() and arrayparam().
> If the developer thinks about that, he could as well
> write "scalar" in front of "$cgi->param().
We would force them to decide what they wanted by not allowing param() at all.
> And the number of places to fix
> s/param/oneparam/ would be huge and really prone to errors.
Well no, because a) grep, and b) we would make param() throw, so instances where we kept using it would become obvious.
> IMO overkill to forbid it explicitly (i.e. enforced in a test). In methods
> called very often, you don't want to store the data in a separate variable
> (see e.g. [bug 797636](/show_bug.cgi?id=797636 "RESOLVED FIXED - Improve performance for buglists")).
But in cases like those, you aren't assigning to a hash. (Good work in that bug, BTW.)
Gerv

|  | [Shahar Tal](/user_profile?user_id=517022) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1075578#c18)• 10 years ago |
|  | |

Hi guys,
I'm getting no response from security@bugzilla.org as to planned timeframes.
Can you help me understand when the patch and advisory would be made public? I would like to coordinate, as we will be releasing as well.
Thx,
Shahar

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1075578#c19)• 10 years ago |
|  | |

(In reply to Shahar Tal from [comment #18](/show_bug.cgi?id=1075578#c18 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments"))
> Hi guys,
> I'm getting no response from security@bugzilla.org as to planned timeframes.
> Can you help me understand when the patch and advisory would be made public?
> I would like to coordinate, as we will be releasing as well.
> Thx,
> Shahar
Sorry. Did you mean security@mozilla.org or security@bugzilla.org. Either way I am sorry I did not see the email sent.
We are working hard to get this released this week but due to the other areas that were discovered due to your report, we want to include as much fixes as we can. This unfortunately needs to go through the standard review/approval process as any major code changes require. We are getting very close.
That being said, we are getting close to Friday here and I tend to dislike releasing on Fridays as a courtesy to sysadmins. Would this be best to plan for a Monday release and we just have everything ready to go by then?
Thoughts
dkl

|  | [Shahar Tal](/user_profile?user_id=517022) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1075578#c20)• 10 years ago |
|  | |

Sure, I'll be syncing for a Monday release, can we plan for 10:00AM ET?
Do let me know if we foresee any dramatic changes.
Cheers, and keep up the good work!
Shahar

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1075578#c21)• 10 years ago |
|  | |

(In reply to David Lawrence [:dkl] from [comment #19](/show_bug.cgi?id=1075578#c19 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments"))
> That being said, we are getting close to Friday here and I tend to dislike
> releasing on Fridays as a courtesy to sysadmins.
It's \_already\_ Friday in Australia and East Asia and we have yet to port and test this on other supported branches. Assuming CheckPoint isn't telling people about this, and didn't give details to the reporter(s?) they talked to we may be putting more people at risk shipping now and revealing the flaw than waiting until Monday.

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1075578#c22)• 10 years ago |
|  | |

(In reply to Shahar Tal from [comment #20](/show_bug.cgi?id=1075578#c20 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments"))
> Sure, I'll be syncing for a Monday release, can we plan for 10:00AM ET?
> Do let me know if we foresee any dramatic changes.
> Cheers, and keep up the good work!
> Shahar
As long as we can get all of the release preparation stuff done by EOB tomorrow (friday ET) then I do not see an issue with releasing at 10:00AM ET Monday.
dkl

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1075578#c23)• 10 years ago |
|  | |

Attached patch

[patch for 4.4, v1](attachment.cgi?id=8499050&action=diff)
— [Details](attachment.cgi?id=8499050&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499050)

[Attachment #8499050](/attachment.cgi?id=8499050&action=edit "patch for 4.4, v1") -
Flags: review?(dkl)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1075578#c24)• 10 years ago |
|  | |

Attached patch

[patch for 4.2, v1](attachment.cgi?id=8499092&action=diff)
— [Details](attachment.cgi?id=8499092&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499092)

[Attachment #8499092](/attachment.cgi?id=8499092&action=edit "patch for 4.2, v1") -
Flags: review?(dkl)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1075578#c25)• 10 years ago |
|  | |

Comment on [attachment 8499050](/attachment.cgi?id=8499050 "patch for 4.4, v1") [[details]](/attachment.cgi?id=8499050&action=edit "patch for 4.4, v1") [[diff]](/attachment.cgi?id=8499050&action=diff "patch for 4.4, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499050)
patch for 4.4, v1
Review of [attachment 8499050](/attachment.cgi?id=8499050 "patch for 4.4, v1") [[details]](/attachment.cgi?id=8499050&action=edit "patch for 4.4, v1") [[diff]](/attachment.cgi?id=8499050&action=diff "patch for 4.4, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499050):
-----------------------------------------------------------------
r=dkl
[Attachment #8499050](/attachment.cgi?id=8499050&action=edit "patch for 4.4, v1") -
Flags: review?(dkl) → review+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a102330_5898)• 10 years ago |

Flags: approval4.4?

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1075578#c26)• 10 years ago |
|  | |

Comment on [attachment 8499092](/attachment.cgi?id=8499092 "patch for 4.2, v1") [[details]](/attachment.cgi?id=8499092&action=edit "patch for 4.2, v1") [[diff]](/attachment.cgi?id=8499092&action=diff "patch for 4.2, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499092)
patch for 4.2, v1
Review of [attachment 8499092](/attachment.cgi?id=8499092 "patch for 4.2, v1") [[details]](/attachment.cgi?id=8499092&action=edit "patch for 4.2, v1") [[diff]](/attachment.cgi?id=8499092&action=diff "patch for 4.2, v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499092):
-----------------------------------------------------------------
r=dkl
[Attachment #8499092](/attachment.cgi?id=8499092&action=edit "patch for 4.2, v1") -
Flags: review?(dkl) → review+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a107913_5898)• 10 years ago |

Flags: approval4.2?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a116411_1689)• 10 years ago |

Whiteboard: EMBARGO until Monday Oct 6, 7am PDT (10am Eastern)

|  | [Andre Klapper](/user_profile?user_id=217879) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1075578#c27)• 10 years ago |
|  | |

7am PDT means that sysadmins on the west coast would have to deploy this Friday. So do I interpret "review+" correctly that the corresponding patch has been tested and is recommended to be deployed on affected live systems? Flag meanings and workflows might not be known to everybody, hence some verbosity on recommendations could help.

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1075578#c28)• 10 years ago |
|  | |

(In reply to Andre Klapper from [comment #27](/show_bug.cgi?id=1075578#c27 "RESOLVED FIXED - [SECURITY] Improper filtering of CGI arguments"))
> So do I interpret "review+" correctly that the corresponding patch
> has been tested and is recommended to be deployed on affected live systems?
Correct. I still have to backport my patch to the 4.0 branch and we are ready to release. If you use these patches before Monday, please do not make them public (public git repo, public server, etc...). And of course do not talk about these problems before Monday. :)

|  | [Simon Green](/user_profile?user_id=124400) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a205189_124400)• 10 years ago |

Flags: approval?Flags: approval4.4?Flags: approval4.4+Flags: approval4.2?Flags: approval4.2+Flags: approval+

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1075578#c29)• 10 years ago |
|  | |

Attached patch

[patch for 4.0, v1](attachment.cgi?id=8499926&action=diff) (obsolete)
— [Details](attachment.cgi?id=8499926&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499926)

[Attachment #8499926](/attachment.cgi?id=8499926&action=edit "patch for 4.0, v1") -
Flags: review?(dkl)

|  | [Frédéric Buclin](/user_profile?user_id=120380)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1075578#c30)• 10 years ago |
|  | |

Attached patch

[patch for 4.0, v1.1](attachment.cgi?id=8499928&action=diff)
— [Details](attachment.cgi?id=8499928&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499928)

[Attachment #8499926](/attachment.cgi?id=8499926&action=edit "patch for 4.0, v1") -
Attachment is obsolete: true
[Attachment #8499926](/attachment.cgi?id=8499926&action=edit "patch for 4.0, v1") -
Flags: review?(dkl)
[Attachment #8499928](/attachment.cgi?id=8499928&action=edit "patch for 4.0, v1.1") -
Flags: review?(dkl)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1075578#c31)• 10 years ago |
|  | |

Comment on [attachment 8499928](/attachment.cgi?id=8499928 "patch for 4.0, v1.1") [[details]](/attachment.cgi?id=8499928&action=edit "patch for 4.0, v1.1") [[diff]](/attachment.cgi?id=8499928&action=diff "patch for 4.0, v1.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499928)
patch for 4.0, v1.1
Review of [attachment 8499928](/attachment.cgi?id=8499928 "patch for 4.0, v1.1") [[details]](/attachment.cgi?id=8499928&action=edit "patch for 4.0, v1.1") [[diff]](/attachment.cgi?id=8499928&action=diff "patch for 4.0, v1.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075578&attachment=8499928):
-----------------------------------------------------------------
r=dkl
[Attachment #8499928](/attachment.cgi?id=8499928&action=edit "patch for 4.0, v1.1") -
Flags: review?(dkl) → review+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a383658_5898)• 10 years ago |

Flags: approval4.0?

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1075578#c32)• 10 years ago |
|  | |

To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[eb8f788..406dea6 4.0 -> 4.0](https://github.com/bugzilla/bugzilla/commit/406dea6)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[b07267a..ce590bf 4.2 -> 4.2](https://github.com/bugzilla/bugzilla/commit/ce590bf)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[4e5cf94..7b8e0ab 4.4 -> 4.4](https://github.com/bugzilla/bugzilla/commit/7b8e0ab)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[553568d..9e186bd master -> master](https://github.com/bugzilla/bugzilla/commit/9e186bd)Status: ASSIGNED → RESOLVEDClosed: 10 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1075578#c33)• 10 years ago |
|  | |

Because some installations have applied a patch for [bug 1074812](/show_bug.cgi?id=1074812 "RESOLVED FIXED - [SECURITY] The 'realname' parameter is not correctly filtered on user account creation, leading to user data override") already it's better if this extended issue gets a new CVE -- [CVE-2014-1573](https://www.cve.org/CVERecord?id=CVE-2014-1573) for this bug, [CVE-2014-1572](https://www.cve.org/CVERecord?id=CVE-2014-1572) will cover only the initial problem reported by Check PointAlias: CVE-2014-1572 → CVE-2014-1573

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a440376_10297)• 10 years ago |

Flags: approval4.0? → approval4.0+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075578#a444022_5898)• 10 years ago |

Group: bugzilla-security
You need to [log in](/show_bug.cgi?id=1075578&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frédéric Buclin](/user_profile?user_id=120380)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from advisories.mageia.org_f942398b_20250125_205516.html ===

# [Advisories](index.html) » MGASA-2014-0412

## Updated bugzilla packages fix security vulnerabilities

Publication date: 09 Oct 2014

Modification date: 09 Oct 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-1571](CVE-2014-1571.html)
,
[CVE-2014-1572](CVE-2014-1572.html)
,
[CVE-2014-1573](CVE-2014-1573.html)

## Description

```
Updated bugzilla packages fix security vulnerabilities:

If a new comment was marked private to the insider group, and a flag was set
in the same transaction, the comment would be visible to flag recipients
even if they were not in the insider group (CVE-2014-1571).

An attacker creating a new Bugzilla account can override certain parameters
when finalizing the account creation that can lead to the user being created
with a different email address than originally requested. The overridden
login name could be automatically added to groups based on the group's
regular expression setting (CVE-2014-1572).

During an audit of the Bugzilla code base, several places were found where
cross-site scripting exploits could occur which could allow an attacker to
access sensitive information (CVE-2014-1573).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=14241>
* <http://www.bugzilla.org/security/4.0.14/>
* <http://www.bugzilla.org/releases/4.4.6/release-notes.html>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1571>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1572>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1573>

## SRPMS

### 3/core

* bugzilla-4.4.6-1.mga3

### 4/core

* bugzilla-4.4.6-1.mga4



=== Content from packetstormsecurity.com_b24f6068_20250125_205523.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.reddit.com_8fda4f9b_20250125_205531.html ===

[Skip to main content](#main-content)

### We value your privacy

Reddit and its partners use cookies and similar technologies to provide you with a better experience. By accepting all cookies, you agree to our use of cookies to deliver and maintain our services and site, improve the quality of Reddit, personalize Reddit content and advertising, and measure the effectiveness of advertising. By rejecting non-essential cookies, Reddit may still use certain cookies to ensure the proper functionality of our platform.
For more information, please see our
[Cookie Notice](https://reddit.com/en-us/policies/cookies)
and our
[Privacy Policy](https://reddit.com/en-us/policies/privacy-policy).

Open menu

Open navigation
Go to Reddit Home

r/netsec

A chip

A close button

Get App

Get the Reddit app

[Log In](https://www.reddit.com/login/)Log in to Reddit

Expand user menu
Open settings menu

[![r/netsec icon](https://styles.redditmedia.com/t5_1rqwi/styles/communityIcon_ldtzxmwbf8e91.png)

Go to netsec](/r/netsec/)

[r/netsec](/r/netsec/)
![r/netsec icon](https://styles.redditmedia.com/t5_1rqwi/styles/communityIcon_ldtzxmwbf8e91.png)

[r/netsec](/r/netsec/)

/r/netsec is a community-curated aggregator of technical information security content. Our mission is to extract signal from the noise — to provide value to security practitioners, students, researchers, and hackers everywhere.
‎

---

Members

Online

•

[deleted]

ADMIN

MOD

# New Class of Vulnerability in Perl Web Applications

**Top 1%**
[Rank by size](https://www.reddit.com/best/communities/6/#t5_1rqwi/)

 Public

Anyone can view, post, and comment to this community

## Top Posts

---

* [Reddit

  reReddit: Top posts of October 6, 2014

  ---](https://www.reddit.com/posts/2014/october-6-1/)
* [Reddit

  reReddit: Top posts of October 2014

  ---](https://www.reddit.com/posts/2014/october/)
* [Reddit

  reReddit: Top posts of 2014

  ---](https://www.reddit.com/posts/2014/)

- &nbsp;

---

- TOPICS

- Internet Culture (Viral)

* [Amazing](https://reddit.com/t/amazing/)

* [Animals & Pets](https://reddit.com/t/animals_and_pets/)

* [Cringe & Facepalm](https://reddit.com/t/cringe_and_facepalm/)

* [Funny](https://reddit.com/t/funny/)

* [Interesting](https://reddit.com/t/interesting/)

* [Memes](https://reddit.com/t/memes/)

* [Oddly Satisfying](https://reddit.com/t/oddly_satisfying/)

* [Reddit Meta](https://reddit.com/t/reddit_meta/)

* [Wholesome & Heartwarming](https://reddit.com/t/wholesome_and_heartwarming/)

- Games

* [Action Games](https://reddit.com/t/action_games/)

* [Adventure Games](https://reddit.com/t/adventure_games/)

* [Esports](https://reddit.com/t/esports/)

* [Gaming Consoles & Gear](https://reddit.com/t/gaming_consoles_and_gear/)

* [Gaming News & Discussion](https://reddit.com/t/gaming_news_and_discussion/)

* [Mobile Games](https://reddit.com/t/mobile_games/)

* [Other Games](https://reddit.com/t/other_games/)

* [Role-Playing Games](https://reddit.com/t/role_playing_games/)

* [Simulation Games](https://reddit.com/t/simulation_games/)

* [Sports & Racing Games](https://reddit.com/t/sports_and_racing_games/)

* [Strategy Games](https://reddit.com/t/strategy_games/)

* [Tabletop Games](https://reddit.com/t/tabletop_games/)

- Q&As

* [Q&As](https://reddit.com/t/q_and_as/)

* [Stories & Confessions](https://reddit.com/t/stories_and_confessions/)

- Technology

* [3D Printing](https://reddit.com/t/3d_printing/)

* [Artificial Intelligence & Machine Learning](https://reddit.com/t/artificial_intelligence_and_machine_learning/)

* [Computers & Hardware](https://reddit.com/t/computers_and_hardware/)

* [Consumer Electronics](https://reddit.com/t/consumer_electronics/)

* [DIY Electronics](https://reddit.com/t/diy_electronics/)

* [Programming](https://reddit.com/t/programming/)

* [Software & Apps](https://reddit.com/t/software_and_apps/)

* [Streaming Services](https://reddit.com/t/streaming_services/)

* [Tech News & Discussion](https://reddit.com/t/tech_news_and_discussion/)

* [Virtual & Augmented Reality](https://reddit.com/t/virtual_and_augmented_reality/)

- Pop Culture

* [Celebrities](https://reddit.com/t/celebrities/)

* [Creators & Influencers](https://reddit.com/t/creators_and_influencers/)

* [Generations & Nostalgia](https://reddit.com/t/generations_and_nostalgia/)

* [Podcasts](https://reddit.com/t/podcasts/)

* [Streamers](https://reddit.com/t/streamers/)

* [Tarot & Astrology](https://reddit.com/t/tarot_and_astrology/)

- Movies & TV

* [Action Movies & Series](https://reddit.com/t/action_movies_and_series/)

* [Animated Movies & Series](https://reddit.com/t/animated_movies_and_series/)

* [Comedy Movies & Series](https://reddit.com/t/comedy_movies_and_series/)

* [Crime, Mystery, & Thriller Movies & Series](https://reddit.com/t/crime_mystery_and_thriller_movies_and_series/)

* [Documentary Movies & Series](https://reddit.com/t/documentary_movies_and_series/)

* [Drama Movies & Series](https://reddit.com/t/drama_movies_and_series/)

* [Fantasy Movies & Series](https://reddit.com/t/fantasy_movies_and_series/)

* [Horror Movies & Series](https://reddit.com/t/horror_movies_and_series/)

* [Movie News & Discussion](https://reddit.com/t/movie_news_and_discussion/)

* [Reality TV](https://reddit.com/t/reality_tv/)

* [Romance Movies & Series](https://reddit.com/t/romance_movies_and_series/)

* [Sci-Fi Movies & Series](https://reddit.com/t/scifi_movies_and_series/)

* [Superhero Movies & Series](https://reddit.com/t/superhero_movies_and_series/)

* [TV News & Discussion](https://reddit.com/t/tv_news_and_discussion/)

---

- RESOURCES

- [About Reddit](https://www.redditinc.com)
 - [Advertise](https://accounts.reddit.com/adsregister?utm_source=web3x_consumer&utm_name=left_nav_cta)
 - [Help](https://support.reddithelp.com/hc?utm_source=reddit&utm_medium=footer&utm_campaign=evergreen)
 - [Blog](https://redditblog.com/)
 - [Careers](https://www.redditinc.com/careers)
 - [Press](https://www.redditinc.com/press)

---

 - [Communities](https://www.reddit.com/best/communities/1/)
 - [Best of Reddit](https://www.reddit.com/posts/2025/global/)
 - [Topics](https://www.reddit.com/topics/a-1/)

---

 - [Reddit Rules](https://www.redditinc.com/policies/content-policy)
 - [Privacy Policy](https://www.reddit.com/policies/privacy-policy)
 - [User Agreement](https://www.redditinc.com/policies/user-agreement)

[Reddit, Inc. © 2025. All rights reserved.](https://redditinc.com)

close

# Don’t miss a thing from Reddit!

I agree to get emails about cool stuff on Reddit

Continue

close

# Log In

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

Continue with phone number

---

OR

---

Email or username

Password

Forgot password?

New to Reddit?
Sign Up

Log In

back

# Enter the 6-digit code from your authenticator app

You’ve set up two-factor authentication for this account.

Verification code

Lost access to your authenticator?
Use a backup code

Check code

back

# Enter a 6-digit backup code

You’ve set up two-factor authentication for this account.

Backup code

Don’t have access to your backup code?
Use a code from an authenticator app

Check code

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Continue with phone number

---

OR

---

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

back

# Reset your password

Enter your email address or username and we’ll send you a link to reset your password

Email or username

[Need help?](https://reddithelp.com/hc/sections/360008917491-Account-Security)

Reset password

close

back

# Check your inbox

An email with a link to reset your password was sent to the email address associated with your account

Didn't get an email?

Resend

close

# Choose a Reddit account to continue

back

close

# Reset your password

New password

Confirm new password

Resetting your password will log you out on all devices.

Continue



=== Content from security.gentoo.org_fdd30520_20250125_205602.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Bugzilla: Multiple vulnerabilities — GLSA **201607-11**

Multiple vulnerabilities have been found in Bugzilla, the worst of
which could lead to the escalation of privileges.

### Affected packages

| Package | **www-apps/bugzilla** on all architectures |
| --- | --- |
| Affected versions | < **5.0.3** |
| Unaffected versions | >= **5.0.3**revision > **4.4.12** |

### Background

Bugzilla is the bug-tracking system from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Bugzilla. Please review
the CVE identifiers referenced below for details.

### Impact

Privileged account holders could execute system level commands, and the
new user process could be exploited to allow for the escalation of
privileges.

### Workaround

There is no known workaround at this time.

### Resolution

All Bugzilla 4.x users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/bugzilla-4.4.12"

```

All Bugzilla 5.x users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/bugzilla-5.0.3"

```
### References

* [CVE-2014-1572](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1572)
* [CVE-2014-1573](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1573)
* [CVE-2014-8630](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8630)

**Release date**

July 20, 2016

**Latest revision**

July 20, 2016: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [524316](https://bugs.gentoo.org/show_bug.cgi?id=524316)
* [537448](https://bugs.gentoo.org/show_bug.cgi?id=537448)
* [560406](https://bugs.gentoo.org/show_bug.cgi?id=560406)
* [583236](https://bugs.gentoo.org/show_bug.cgi?id=583236)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.bugzilla.org_163c5d13_20250125_205524.html ===

[![Bugzilla Logo](/assets/img/logo-header.svg)
Bugzilla](/)
Show Nav Menu

* [About](/about/ "Find out more about Bugzilla.")
  [Project](/about/ "Find out more about Bugzilla.")
  [Features](/about/features.html)
  [Who Uses Bugzilla?](/about/installation-list.html "Hundreds of companies and organizations trust Bugzilla.")
  [Meet the Team](/about/developers "Meet the Bugzilla team.")
  [Zarro Boogs Corporation](/about/zarroboogs.html "Find out about the company managing the Bugzilla Project.")
* [News](/blog/ "Get the low down on what's happening with the project.")
  [Blog](/blog/ "Bugzilla Blog")
  [Release Information](/releases/ "Information on current and previous releases.")
  [Security Advisories](/security/ "Important updates regarding Bugzilla security.")
  [Planet Bugzilla](http://planet.bugzilla.org "View the status of the Bugzilla project.")
* [Download](/download/ "Download Bugzilla")
* [Documentation](/docs/ "Bugzilla Documentation")
* [Support](/support/ "Find out where to get more information and help.")
* [Contribute](/contributing/ "Ways you can help Bugzilla")
  [How to?](/contributing/ "Ways you can help Bugzilla")
  [Report a Bug](/contributing/reporting_bugs "Let us know if there is an error in Bugzilla.")
  [Donate](/donate "Donate to Bugzilla, and see how your money is used.")
  [Wiki](https://wiki.mozilla.org/Bugzilla%3AHome "Collaboratively updated information about Bugzilla.")

Search bugzilla.org

1. [Security Advisories](/security/)
2. 4.0.14, 4.2.10, 4.4.5, and 4.5.5 Security Advisory

# 4.0.14, 4.2.10, 4.4.5, and 4.5.5 Security Advisory

Monday, Oct 6th, 2014
```

Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issues have been discovered
in Bugzilla:

* The 'realname' parameter is not correctly filtered on user account
  creation, which could lead to user data override.

* Several places were found in the Bugzilla code where cross-site
  scripting attacks could be used to access sensitive information.

* Private comments can be shown to flagmail recipients who aren't in
  the insider group

* Specially formatted values in a CSV search results export could be
  used in spreadsheet software to attack a user's computer.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Unauthorized Account Creation
Affected:    2.23.3 to 4.0.14, 4.1.1 to 4.2.10, 4.3.1 to 4.4.5, 4.5.1 to 4.5.5
Fixed In:    4.0.15, 4.2.11, 4.4.6, 4.5.6
Description: An attacker creating a new Bugzilla account can override certain
             parameters when finalizing the account creation that can lead to the
             user being created with a different email address than originally
             requested. The overridden login name could be automatically added
             to groups based on the group's regular expression setting.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=1074812
CVE Number:  CVE-2014-1572

Class:       Cross-Site Scripting
Affected:    2.17.1 to 4.0.14, 4.1.1 to 4.2.10, 4.3.1 to 4.4.5, 4.5.1 to 4.5.5
Fixed In:    4.0.15, 4.2.11, 4.4.6, 4.5.6
Description: During an audit of the Bugzilla code base, several places
             were found where cross-site scripting exploits could occur which
             could allow an attacker to access sensitive information.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=1075578
CVE Number:  CVE-2014-1573

Class:       Information Leak
Affected:    2.17.1 to 4.0.14, 4.1.1 to 4.2.10, 4.3.1 to 4.4.5, 4.5.1 to 4.5.5
Fixed In:    4.0.15, 4.2.11, 4.4.6, 4.5.6
Description: If a new comment was marked private to the insider group, and a flag
             was set in the same transaction, the comment would be visible to
             flag recipients even if they were not in the insider group.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=1064140
CVE Number:  CVE-2014-1571

Class:       Social Engineering
Affected:    2.17.1 to 4.0.14, 4.1.1 to 4.2.10, 4.3.1 to 4.4.5, 4.5.1 to 4.5.5
Fixed In:    4.0.15, 4.2.11, 4.4.6, 4.5.6
Description: Search results can be exported as a CSV file which can then be
             imported into external spreadsheet programs. Specially formatted
             field values can be interpreted as formulas which can be executed
             and used to attack a user's computer.
References:  https://bugzilla.mozilla.org/show_bug.cgi?id=1054702

Vulnerability Solutions
=======================

The fix for these issues is included in the
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of these issues.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issues at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  https://www.bugzilla.org/download/

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix this
issue:

Issue 1 Reporter: Netanel Rubin of Check Point Vulnerability Research
Issue 1 Fixed by: Frédéric Buclin, Simon Green, Matt Tyson, David Lawrence, Byron Jones

Issue 2 Reporter: Frédéric Buclin
Issue 2 Fixed by: Frédéric Buclin, Simon Green, Matt Tyson, David Lawrence, Byron Jones

Issue 3 Reporter: Byron Jones
Issue 3 Fixed by: Frédéric Buclin, Simon Green, Matt Tyson, David Lawrence, Byron Jones

Issue 4 Reporter: James Kettle
Issue 4 Fixed by: Frédéric Buclin, Simon Green, Matt Tyson, David Lawrence, Byron Jones

General information about the Bugzilla bug-tracking system can be found
at:

  https://www.bugzilla.org/

Comments and follow-ups can be directed to the support-bugzilla mailing list.
https://www.bugzilla.org/support/ has directions for accessing this forum.

```

* [GitHub
  GitHub](https://github.com/bugzilla "GitHub")
* [X](https://x.com/%40bugzilla "X")
* [Mastodon
  Mastodon](https://techhub.social/%40bugzilla "Mastodon")
* [Bluesky](https://bsky.app/profile/bugzilla.org "Bluesky")
* [Facebook
  Facebook](https://www.facebook.com/BugzillaProject "Facebook")
* [LinkedIn
  LinkedIn](https://www.linkedin.com/company/bugzilla-project "LinkedIn")
* [IRC
  IRC on Libera.Chat](https://web.libera.chat/#/#bugzilla "IRC on Libera.Chat")
* [Discord
  Discord](https://discord.gg/ZhN6uBA "Discord")
* [Matrix
  Matrix](https://matrix.to/#/#bugzilla:mozilla.org "Matrix")
* [YouTube
  YouTube](https://www.youtube.com/%40bugzillaproject "YouTube")
* [Twitch
  Twitch](https://twitch.tv/bugzillaproject "Twitch")

---

Copyright © 1998-2024 bugzilla.org contributors
Creative Commons Attribution-ShareAlike 2.0[Creative CommonsAttributionShareAlike](https://creativecommons.org/licenses/by-sa/2.0/)



=== Content from www.opennet.ru_184bbd64_20250125_205529.html ===


Профиль: **[Аноним](/~ "/~ - сводная страница участника")** ([вход](https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=login) | [регистрация](https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=user_register)) неRU **opennet.me**

| [The OpenNET Project](/) |  | | [**НОВОСТИ**](../opennews/) ([+](../news/opennet.shtml)) | [**КОНТЕНТ**](../mp/) | [**WIKI**](http://wiki.opennet.ru) | [**MAN'ы**](../man.shtml) | [**ФОРУМ**](../forum/) | [Поиск](../search.shtml) ([теги](../keywords/)) | | --- | --- | --- | --- | --- | --- | | [RSS](https://www.opennet.ru/opennews/opennews_all_utf.rss) [twitter](https://twitter.com/opennetru) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

[![The OpenNET Project / Index page](/opennet2_lite.gif)](/)

[ [новости](/opennews/) /[+++](/opennews/?full_lines=15&lines=15&mid_lines=00) | [форум](/forum/) | [теги](/keywords/)
| ![](/img/telegram2.png "Telegram")
]

| [В Bugzilla устранена опасная уязвимость, открывшая новый вид атак на web-приложения](https://opennet.ru/40766-bugzilla)07.10.2014 13:25 |
| --- |

| В [выпусках](http://www.bugzilla.org/security/4.0.14/) 4.0.14, 4.2.10, 4.4.5 и 4.5.5 системы для ведения базы данных ошибок, контроля за их исправлением и общего координирования процесса разработки [Bugzilla](http://www.bugzilla.org/) устранена опасная [уязвимость](http://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/) ([CVE-2014-1572](https://bugzilla.mozilla.org/show_bug.cgi?id=1074812)), позволяющая поднять свои привилегии и получить доступ к закрытым группам. Теоретически аналогичные ошибки могут присутствовать и в других проектах на языке Perl, использующих модуль CGI.pm и заполняющих хэши неэкранированными значениями функции param. Проблема вызвана непониманием особенности разбора повторяющихся параметров в URL - в случае передачи скрипту нескольких параметров с одинаковым именем, функция param модуля CGI.pm возвращает не скалярную переменную, а массив, в котором перечислены все значения подобных параметров. При заполнении хэша открытым списком по сути производится перечисление пар ключ/значение (символ "=>" в присвоении вполне может быть заменён на запятую), поэтому если вместо одного из аргументов передан массив и этот аргумент не экранирован, то можно перечислить в данном массиве имена ключей и их значение, и данные ключи будут определены в хэше. Например, в случае запроса "index.cgi?realname=JRandomUser&realname=login\_name&realname=admin@mozilla.com", переменная realname передаётся три раза, что приведёт к выдаче функцией param массива ("JRandomUser", "login\_name", "admin@mozilla.com"). Если в коде присутствует присвоение "realname => $cgi->param('realname')", то по сути этот блок можно отождествить с конструкцией ("realname", "JRandomUser", "login\_name", "admin@mozilla.com"), что аналогично представлению (realname => "JRandomUser", login\_name => "admin@mozilla.com"), т.е. осуществлено определение нового ключа "login\_name". Простейшим способом устранения проблемы является явное определение скалярного типа переменной, т.е. указание "realname => scalar $cgi->param('realname')". Используя данный метод выявившие уязвимость исследователи безопасности [смогли](http://www.checkpoint.com/blog/bug-bug-tracker/) [завести](https://bugzilla.mozilla.org/show_bug.cgi?id=1074812) аккаунты с доступом к закрытым областям Bugzilla проекта Mozilla, обойдя стадию верификации почтового адреса. Уязвимость использовалась для передачи фиктивного email в момент определения группы пользователя - bugzilla автоматически назначает новых пользователей в группы, на основании проверки email (например, можно вместо реального адреса, заполнить поле значением в поддомене @mozilla.com, при том, что изначально для верификации использовался совершенно другой адрес). Вектором атаки может быть получение доступа к записям, в которых отвечающие за безопасность команды разработчиков могут обсуждать ещё не исправленные уязвимости, до их придания огласке. Bugzilla достаточно [широко используется](http://www.bugzilla.org/installation-list/) для координации внесения исправлений в открытых проектах, например, применяется сообществами Apache, LibreOffice, Mozilla, ядра Linux, OpenSSH, Eclipse, KDE, GNOME. Проблеме подвержены все установки Bugzilla начиная с версии 2.23.3, выпущенной в 2006 году. Выявившие уязвимость исследователи указывают на то, что проблема не ограничивается Bugzilla и возможно присутствует в некоторых других web-проектах. Сама уязвимость рассматривается как новый класс атак на неаккуратно написанные web-приложения, сопоставимый по степени опасности с внедрением SQL-кода. При этом проблема не ограничивается Perl и может [проявляться](http://www.reddit.com/r/netsec/comments/2ihen0/new_class_of_vulnerability_in_perl_web/cl2b7f3) и в других языках с динамической типизацией. |
| --- |
| |  | [исправить](#toptop "Общедоступная правка в wiki-стиле, дополнение текста приветствуется")  +8 +/– | | --- | --- | |
| 1. [Главная ссылка к новости (http://krebsonsecurity.com/201...)](http://krebsonsecurity.com/2014/10/bugzilla-zero-day-exposes-zero-day-bugs/) 2. [OpenNews: Проект Mozilla объявил о возможной утечке 97 тысяч аккаунтов тестового сервера Bugzilla](https://www.opennet.ru/opennews/art.shtml?num=40491) 3. [OpenNews: Релиз свободной системы отслеживания ошибок Bugzilla 4.0](https://www.opennet.ru/opennews/art.shtml?num=29637) |
| Лицензия: [CC BY 3.0](https://creativecommons.org/licenses/by/3.0/) |
| Короткая ссылка: https://opennet.ru/40766-bugzilla |
| Ключевые слова: [bugzilla](/keywords/bugzilla.html) |

| При перепечатке указание ссылки на opennet.ru обязательно |

| **Обсуждение** [(22)](/openforum/vsluhforumID3/99287.html#TOP "Число ответов") | [Основной режим](/openforum/vsluhforumID3/99287.html "Исходный режим") | [Ajax](/openforum/vsluhforumID3/99287.html "Отображение дерева сообщений через Ajax с раскрытием непрочитанных.") | [1 уровень](/openforum/vsluhforumID3/99287.html "Показать сообщения 1 уровня в режиме Ajax") | [Линейный](/openforum/vsluhforumID3/ubb/99287.html#END "Ajax списком в порядке публикации. При открытии в новой вкладке - все сообщения с сортировкой по дате.") | +/- | [Раскрыть всё](/openforum/vsluhforumID3/99287.html#1 "Отключает автоскрытие сообщений в ветке. Режим запоминается.") | [RSS](/cgi-bin/openforum/rss_forum.cgi?forum=vsluhforumID3&om=99287) |
| --- | --- |

| | - [1.1](/openforum/vsluhforumID3/99287.html#1), [Гость](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (??), 13:50, 07/10/2014 [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=1&news_key=40766)] [[﹢﹢﹢](/openforum/vsluhforumID3/99287.html#1 "Показать все нераскрытые сообщения в подветке")] [· · ·] | +2 +/– | | --- | --- | | :-D красиво! | | |  | |    | - [1.2](/openforum/vsluhforumID3/99287.html#2), [онаним](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (?), 14:25, 07/10/2014 [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=2&news_key=40766)] [[﹢﹢﹢](/openforum/vsluhforumID3/99287.html#2 "Показать все нераскрытые сообщения в подветке")] [· · ·] | +/– | | --- | --- | | fail. Удивительно, как можно делать столь сильные предположения о типе переменной в динамическом яп, особенно таком как перловка. | | |  | |  |  | | - [2.17](/openforum/vsluhforumID3/99287.html#17), [bOOster](/~bOOster) (?), 15:34, 11/10/2014 [[^](#2 "к родителю")] [[^^](#2 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=17&news_key=40766)] | –1 +/– | | --- | --- | | Как можно вообще использовать в web языки с динамической типизацией?!? (что есть уже потенциальная проблема) | | |  | |  |  | | - [**3.19**](/openforum/vsluhforumID3/99287.html#19), [vitalif](/~vitalif) (ok), 20:12, 13/10/2014 [[^](#17 "к родителю")] [[^^](#2 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=19&news_key=40766)] | +/– | | --- | --- | | > Как можно вообще использовать в web языки с динамической типизацией?!? (что есть  > уже потенциальная проблема)  А ты чо, часто на сях сайтики пишешь? :D | | |  | |  |  | | - [**4.20**](/openforum/vsluhforumID3/99287.html#20), [Аноним](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (-), 11:49, 14/10/2014 [[^](#19 "к родителю")] [[^^](#2 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=20&news_key=40766)] | +/– | | --- | --- | | Так теперь основной объем дыр - в вебне и прочей скриптятине... | | |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |    | - [1.3](/openforum/vsluhforumID3/99287.html#3), [Аноним](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (-), 15:13, 07/10/2014 [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=3&news_key=40766)] [[﹢﹢﹢](/openforum/vsluhforumID3/99287.html#3 "Показать все нераскрытые сообщения в подветке")] [· · ·] | –1 +/– | | --- | --- | | <http://bloodhound.apache.org/> | | |  | |  |  | | - [2.12](/openforum/vsluhforumID3/99287.html#12), [vitalif](/~vitalif) (ok), 18:57, 07/10/2014 [[^](#3 "к родителю")] [[^^](#3 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=12&news_key=40766)] | +/– | | --- | --- | | > <http://bloodhound.apache.org/>  <https://bh-demo2.apache.org/> Proxy Error The proxy server received an invalid response from an upstream server. The proxy server could not handle the request GET /. Reason: Error reading from remote server Apache/2.2.22 (Ubuntu) Server at bh-demo2.apache.org Port 443 | | |  | |  |  | | - [**3.21**](/openforum/vsluhforumID3/99287.html#21), [Аноним](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (-), 11:50, 14/10/2014 [[^](#12 "к родителю")] [[^^](#3 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=21&news_key=40766)] | +/– | | --- | --- | | > Apache/2.2.22 (Ubuntu) Server at bh-demo2.apache.org Port 443  Единственное чего полезного отсюда можно узнать - что про забивон апачистов на бзды не врут. Опач под убунтой, однако :). | | |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |    | - [1.4](/openforum/vsluhforumID3/99287.html#4), [Аноним](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (-), 16:23, 07/10/2014 [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=4&news_key=40766)] [[﹢﹢﹢](/openforum/vsluhforumID3/99287.html#4 "Показать все нераскрытые сообщения в подветке")] [· · ·] | –3 +/– | | --- | --- | | >CGI.pm  >2014 | | |  | |  |  | | - [2.14](/openforum/vsluhforumID3/99287.html#14), [анонимес](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (?), 19:52, 07/10/2014 [[^](#4 "к родителю")] [[^^](#4 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=14&news_key=40766)] | +1 +/– | | --- | --- | | знакомые буквы увидел? | | |  | | | | --- | --- | --- | --- | --- | --- | --- | --- |    | - [1.5](/openforum/vsluhforumID3/99287.html#5), [vitalif](/~vitalif) (ok), 16:24, 07/10/2014 [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=5&news_key=40766)] [[﹢﹢﹢](/openforum/vsluhforumID3/99287.html#5 "Показать все нераскрытые сообщения в подветке")] [· · ·] | +/– | | --- | --- | | Я всегда охреневал от людей, которые вообще CGI.pm используют. Его достаточно один раз открыть, чтобы понять, что его писал героиновый наркоман. Эталонный кусок перл-говнокода. И Bugzilla сама тоже хороша, я её форк пилю уже лет 5, планомерно говнокод (и CGI.pm тоже, ага) оттуда выкашивая. Хочу допилить и потом опубликовать где-нибудь с намёком на то, что "эй смотрите мазильщики, я тут ваш говнокод немного в чувство привёл"... | | |  | |  |  | | - [2.15](/openforum/vsluhforumID3/99287.html#15), [Тупой молодец](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%20%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (ok), 09:25, 09/10/2014 [[^](#5 "к родителю")] [[^^](#5 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=15&news_key=40766)] | +/– | | --- | --- | | а им патчи отослать, не? | | |  | |  |  | | - [**3.18**](/openforum/vsluhforumID3/99287.html#18), [vitalif](/~vitalif) (ok), 20:10, 13/10/2014 [[^](#15 "к родителю")] [[^^](#5 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=18&news_key=40766)] | +/– | | --- | --- | | Бессмысленно, там столько переделано, что живого места нет. Даже если умудриться это как-то разбить на патчи (что просто АБСОЛЮТНО НЕРЕАЛЬНО), авторы изменения всё равно не примут. Да и не хочется уже ничего им отправлять, они там дикие говнокодеры, на некоторые вещи  реально страшно смотреть было. Даже смержить с 4.4 почти нереально (моя форкнута от 3.6). Хотя и невелика беда, там всё равно никаких масштабных фич не появилось. Я раньше ещё стеснялся и как-то ограничивал себя, чтобы совсем ВСЁ не перехреначивать - думал мержить же потом... а сейчас надоело и я просто переделываю ВСЁ, что мне отсвечивает. Хочу уже доделать и как форк зарелизить. | | |  | | | | --- | --- | --- | --- | --- | --- | --- | --- |  | - [**2.22**](/openforum/vsluhforumID3/99287.html#22), [Аноним](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (-), 11:51, 14/10/2014 [[^](#5 "к родителю")] [[^^](#5 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=22&news_key=40766)] | +/– | | --- | --- | | > Я всегда охреневал от людей, которые вообще CGI.pm используют.  Да весь CGI - протокол для тех кто хочет по мелочи сэкономить сначала и много и героически долбаться потом. | | |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |    | - [1.6](/openforum/vsluhforumID3/99287.html#6), [PavelR](/~PavelR) (??), 16:49, 07/10/2014 [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=6&news_key=40766)] [[﹢﹢﹢](/openforum/vsluhforumID3/99287.html#6 "Показать все нераскрытые сообщения в подветке")] [· · ·] | +/– | | --- | --- | | Я правильно понял, что надо написать примерно так: %hash = (key=>$cgi->param('key')); ?? | | |  | |  |  | | - [2.7](/openforum/vsluhforumID3/99287.html#7), [vitalif](/~vitalif) (ok), 16:59, 07/10/2014 [[^](#6 "к родителю")] [[^^](#6 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=7&news_key=40766)] | +/– | | --- | --- | | Так НЕ надо писать... Надо писать %hash = (key => scalar $cgi->param('key')); Иначе если передать несколько значений key, то у тебя весь хеш "поедет" - контекст списочный, cgi->param вернёт список всех значений, и часть из них станет ключами, т.к. "=>" - синоним запятой. А ещё лучше ВООБЩЕ НЕ ЮЗАТЬ $cgi->param - даже если используется CGI.pm, то просто стырить себе куда-нибудь все параметры в виде хеша и хавать их оттуда. Причём $cgi->Vars возвращает криво tie'енный хеш, так что нужно просто в цикле вытаскивать все параметры. Ну или вообще юзать какой-нибудь PCGI.pm. | | |  | |  |  | | - [3.8](/openforum/vsluhforumID3/99287.html#8), [PavelR](/~PavelR) (??), 17:03, 07/10/2014 [[^](#7 "к родителю")] [[^^](#6 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=8&news_key=40766)] | +/– | | --- | --- | | Эмм, я как раз и имел ввиду, что так писать не надо, и если так написать - то именно так и схватишь уязвимость. 0) В чем кривизна $cgi->Vars(), если это можно в двух словах описать? | | |  | |  |  | | - [4.9](/openforum/vsluhforumID3/99287.html#9), [vitalif](/~vitalif) (ok), 17:09, 07/10/2014 [[^](#8 "к родителю")] [[^^](#6 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=9&news_key=40766)] | +/– | | --- | --- | | Если у какого-то ключа несколько значений, то в $cgi->Vars значением этого ключа будут просто сконкатенированные все эти значения. Т.е. из строчки &a=1&a=1 получится { a => '11' }. | | |  | |  |  | | - [5.10](/openforum/vsluhforumID3/99287.html#10), [PavelR](/~PavelR) (??), 17:44, 07/10/2014 [[^](#9 "к родителю")] [[^^](#6 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=10&news_key=40766)] | +/– | | --- | --- | | ух-ты, прикольно. Спасибо за разъяснение.) | | |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |  | - [3.13](/openforum/vsluhforumID3/99287.html#13), [vitalif](/~vitalif) (ok), 19:50, 07/10/2014 [[^](#7 "к родителю")] [[^^](#6 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=13&news_key=40766)] | +/– | | --- | --- | | А, кстати нет, с PCGI та же хрень - он вообще не умеет хеш значений вернуть... | | |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |    | - [1.11](/openforum/vsluhforumID3/99287.html#11), [Аноним](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD) (-), 18:20, 07/10/2014 [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=11&news_key=40766)] [[﹢﹢﹢](/openforum/vsluhforumID3/99287.html#11 "Показать все нераскрытые сообщения в подветке")] [· · ·] | +/– | | --- | --- | | сам повысил свои привилегии, потом сам же и пофиксил с новыми привилегиями :) | | |  | |  |  | | - [2.16](/openforum/vsluhforumID3/99287.html#16), [Аноним.](/~%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD.) (?), 19:22, 10/10/2014 [[^](#11 "к родителю")] [[^^](#11 "на 1 уровень")] [[^^^](#lenta_nav "вверх")] [[ответить](/cgi-bin/openforum/vsluhboard.cgi?az=post&om=99287&forum=vsluhforumID3&omm=16&news_key=40766)] | +/– | | --- | --- | | Зря смеетесь. На практике был случай убираения проблемного демео скрипта bash как cgi через уязвимость shellshock | | |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| **Добавить комментарий** |
| --- |

|  |
| --- |

| Имя: |
| --- |
| E-Mail: |

| | Текст: | | --- | |

| | Памятные даты | | --- |  | 16 января [Tcl](/tcl) исполнилось 36 лет | | --- |    | Навигация | | --- |  | Фильтры События Обзоры и статьи Программы Уязвимости Исключить Linux Исключить BSD Исключить Rust ----- Формат вывода 10 полных 20 сокращенных 40 заголовков | | --- | | [Каналы:](https://wiki.opennet.ru/RSS) [XML](https://wiki.opennet.ru/RSS) [twitter](https://twitter.com/opennetru) | | [Разделы новостей](/opennews/chapters.shtml) | [Сводные](/news/grab_mix.shtml) | | [Что нового на OpenNet](/news/opennet.shtml) | | [Поиск в новостях](/search_adv.shtml#news) | | [Новые комментарии](/cgi-bin/openforum/vsluhboard.cgi?az=list&forum=vsluhforumID3&open=new) | | [Добавить свою новость](https://www.opennet.ru/announce_news.shtml?cache=off) |   | [Важное](https://www.opennet.ru/#imp) | | --- |  | **-** 24.01 [На базе Clang для языка Си реализован режим проверки границ буферов](/opennews/art.shtml?num=62606) (209 +18) | | --- | | **-** 20.01 [Релиз ядра Linux 6.13](/opennews/art.shtml?num=62587) (180 +35) | | **-** 18.01 [Haiku ограничит доступ из Великобритании из-за риска нарушения закона Online Safety Act](/opennews/art.shtml?num=62579) (19 +41) | | **-** 11.01 [Компания Automattic свела к минимуму своё участие в разработке WordPress](/opennews/art.shtml?num=62544) (103 +22 ↻) | | **-** 09.01 [Суд обязал компанию AVM выполнить условия лицензии LGPL](/opennews/art.shtml?num=62535) (67 +58) | | **-** 04.01 [Наиболее важные события 2024 года, связанные с открытыми проектами](/opennews/art.shtml?num=62475) (43 +50) | | **-**  [Сводка событий за 2024 год](/opennews/art.shtml?num=62475) |  | [Советы](/tips/sml/) | | --- |  | **-** 19.01.2025 [Установка движка графических квестов RenPy в Debian](/tips/3263_renpy_game_debian_build_git_patch.shtml) | | --- | | **-** 06.12.2024 [Использование инструментария Podman для запуска контейнеров во FreeBSD](/tips/3262_podman_freebsd_container_chroot.shtml) | | **-** 04.12.2024 [Запуск ChromeOS Flex в виртуальной машине Proxmox](/tips/3261_chromeos_proxmox_virtual_qemu.shtml) | | **-** 25.11.2024 [Как сделать ноутбук с APU AMD гораздо тише и холоднее](/tips/3259_amd_notebook_power_idle.shtml) | | **-** 07.11.2024 [Как отключить TLS-расширение ECH для решения проблем с Cloudflare в РФ](/tips/3258_tls_ech_block_cloudflare_firefox_chrome.shtml) |  | [Обсуждаемые новости](https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=list&forum=vsluhforumID3) | | --- |  | **-** 23:49 [Доступен IMAP-сервер Dovecot 2.4.0](/openforum/vsluhforumID3/135854.html)  (42) | | --- | | **-** 23:46 [На соревновании Pwn2Own Automotive 2025 представлено 49 уязвимостей автомобильных систем](/openforum/vsluhforumID3/135862.html) (30) | | **-** 23:43 [На базе Clang для языка Си реализован режим проверки границ буферов](/openforum/vsluhforumID3/135850.html) (211) | | **-** 23:37 [Релиз http-сервера Apache 2.4.63](/openforum/vsluhforumID3/135853.html) (65) | | **-** 23:35 [Определена дата заморозки пакетной базы Debian 13](/openforum/vsluhforumID3/135837.html) (181) | | **-** 23:30 [Релиз мультимедийной библиотеки SDL 3](/openforum/vsluhforumID3/135828.html) (97) | | **-** 23:30 [Выпуск файлового менеджера Midnight Commander 4.8.33](/openforum/vsluhforumID3/135847.html) (172) | | **-** 23:29 [AMD развивает собственный композитный сервер ACS, использующий Wayland](/openforum/vsluhforumID3/135856.html) (98) |  | [Новые версии](/lastsoft/) | | --- |  | Программы:   25.01 [Shotcut 25.01.25](https://github.com/mltframework/shotcut/tags)   25.01 [GTK 3.24.48](https://github.com/GNOME/gtk/tags)   25.01 [Distrobox 1.8.1.2](https://github.com/89luca89/distrobox/tags)   25.01 [libtorrent 2.0.11](https://github.com/arvidn/libtorrent/tags)   25.01 [etcd 3.5.18](https://github.com/etcd-io/etcd/tags)   25.01 [Eclipse 7.98](https://github.com/eclipse/che/tags)   25.01 [Electron 32.3.0, 34.0.1](https://github.com/electron/electron/tags)   24.01 [Dovecot IMAP 2.4.0](https://www.opennet.ru/opennews/art.shtml?num=62611)   24.01 [xz 5.6.4](https://github.com/tukaani-project/xz/tags)   24.01 [strace 6.13](https://github.com/strace/strace/tags)   24.01 [cmake 3.31.5](https://github.com/Kitware/CMake/tags)   24.01 [apache 2.4.63](https://www.opennet.ru/opennews/art.shtml?num=62610)   24.01 [Glib 2.83.3](https://github.com/GNOME/glib/tags)   23.01 [pipewire 1.3.81](https://github.com/PipeWire/pipewire/tags)   23.01 [MC 4.8.33](https://github.com/MidnightCommander/mc/tags)   23.01 [Qt Creator 15.0.1](https://github.com/qt-creator/qt-creator/tags)   23.01 [Chrome 132.0.6834.110](http://www.google.com/chrome)   23.01 [mesa 3d 24.3.4](https://gitlab.freedesktop.org/mesa/mesa/-/tags)   23.01 [mongoDB 5.0.31](https://github.com/mongodb/mongo/tags)   23.01 [Mattermost 10.4.2](https://github.com/mattermost/mattermost/tags)   23.01 [VeraCrypt 1.26.19](https://www.opennet.ru/opennews/art.shtml?num=62593)   22.01 [Julia 1.11.3](https://github.com/JuliaLang/julia/tags)   22.01 [archinstall 3.0.2](https://github.com/archlinux/archinstall/tags)   22.01 [ClamAV 1.4.2](https://github.com/Cisco-Talos/clamav/tags)   22.01 [docker 27.5.1](https://github.com/moby/moby/tags)   22.01 [knot 3.4.4](https://github.com/CZ-NIC/knot/tags) Дистрибутивы:   18.01 [Chrome OS 132](https://chromereleases.googleblog.com/)   18.01 [LibreELEC 12.0.2](https://github.com/LibreELEC/LibreELEC.tv/tags)   15.01 [Linux Mint 22.1](https://blog.linuxmint.com/)   14.01 [MX Linux 23.5](https://mxlinux.org/)   12.01 [Debian GNU/Linux 12.9](https://www.opennet.ru/opennews/art.shtml?num=62546)   09.01 [Tails 6.11](https://www.opennet.ru/opennews/art.shtml?num=62534) Актуальные ядра Linux:   23.01 [6.12.11](/kernel/6.12.11.html), [6.6.74](/kernel/6.6.74.html), [6.1.127](/kernel/6.1.127.html), [5.15.177](/kernel/5.15.177.html)   19.01 [6.13](/kernel/6.13.html) ([merge](/kernel/6.13-merge.html), [pull](/kernel/ml/6.13.html))   09.01 [5.10.233](/kernel/5.10.233.html), [5.4.289](/kernel/5.4.289.html)| [Изменения в ядре 6.14](/kernel/ml/) | | | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

Партнёры:

[![PostgresPro](/img/pp_200.png)](https://www.postgrespro.ru)

[![Inferno Solutions](/img/inferno2.png)](https://ishosting.com/ru)

[![Hosting by Hoster.ru](/img/dh143x60t.png)](http://hoster.ru/?utm_source=site&utm_medium=banner&utm_campaign=opennet)

Хостинг:

 [Закладки на сайте](/cgi-bin/opennet/bookmark.cgi) [Проследить за страницей](/cgi-bin/opennet/bookmark.cgi?submit=add) | Created 1996-2025 by **[Maxim Chirkov](/contact.shtml "email maxim.chirkov@gmail.com")** [Добавить](https://www.opennet.ru/add.shtml), [Поддержать](https://www.opennet.ru/donate.shtml), [Вебмастеру](https://www.opennet.ru/banners2.shtml) |



=== Content from blog.gerv.net_5e12c090_20250125_205517.html ===

# [Hacking for Christ](https://blog.gerv.net/ "Hacking for Christ")

## Gervase Markham

Search

### Main menu

[Skip to primary content](#content "Skip to primary content")
[Skip to secondary content](#secondary "Skip to secondary content")

* [Home](https://blog.gerv.net/)

### Post navigation

[← Previous](https://blog.gerv.net/2014/09/prevent-territoriality/)
[Next →](https://blog.gerv.net/2014/10/rebel-alliance-ideas/)

# New Class of Vulnerability in Perl Web Applications

Posted on [October 6, 2014](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/ "8:13 PM")  by  [gerv](https://blog.gerv.net/author/gerv/ "View all posts by gerv")

We did a Bugzilla security release today, to fix some holes responsibly disclosed to us by [Check Point Vulnerability Research](http://www.checkpoint.com/), to whom we are very grateful. The most serious of them would allow someone to create and control an account for an arbitrary email address they don’t own. If your Bugzilla gives group permissions based on someone’s email domain, as some do, this could be a privilege escalation.

(**Update 2014-10-07 05:42 BST**: to be clear, this pattern is most commonly used to add “all people in a particular company” to a group, using an email address regexp like `.*@mozilla.com$`. It is used this way on bugzilla.mozilla.org to allow Mozilla Corporation employees access to e.g. Human Resources bugs. Membership of the Mozilla security group, which has access to unfixed vulnerabilities, is done on an individual basis and could not be obtained using this bug. The same is true of BMO admin privileges.)

These bugs are actually quite interesting, because they seem to represent a new Perl-specific security problem. (At least, as far as I’m aware it’s new, but perhaps we are about to find that everyone knows about it but us. **Update 2014-10-08 09:20 BST**: [everything old is new again](http://seclists.org/vulnwatch/2006/q4/6); but the level of response, including changes to CGI.pm, suggest that this had mostly faded from collective memory.) This is how it works. I’m using the [most serious bug](https://bugzilla.mozilla.org/show_bug.cgi?id=1074812) as my example. The somewhat less serious bugs caused by this pattern were XSS holes. (Check Point are going to be presenting on this vulnerability at the [31st Chaos Communications Congress](http://events.ccc.de/category/31c3/) in December in Hamburg, so check their analysis out too.)

Here’s the vulnerable code:

```

my $otheruser = Bugzilla::User->create({
    login_name => $login_name,
    realname   => $cgi->param('realname'),
    cryptpassword => $password});

```

This code creates a new Bugzilla user in the database when someone signs up. `$cgi` is an object representing the HTTP request made to the page.

The issue is a combination of two things. Firstly, the `$cgi->param()` call is context-sensitive – it can [return a scalar or an array](http://perldoc.perl.org/CGI.html#FETCHING-THE-VALUE-OR-VALUES-OF-A-SINGLE-NAMED-PARAMETER:), [depending on the context](https://metacpan.org/source/LEEJO/CGI-4.04/lib/CGI.pm#L452) in which you call it – i.e. the type of the variable you assign the return value to. The ability for functions to do this is a Perl “do what I mean” feature.

Let’s say you called a page as follows, with 3 instances of the same parameter:

```

index.cgi?foo=bar&foo=baz&foo=quux

```

If you call `param()` in an array context (the @ sigil represents a variable which is an array), you get an array of values:

```

@values = $cgi->param('foo');
-->
['bar', 'baz', 'quux']

```

If you call it in a scalar context (the $ sigil represents a variable which is a scalar), you get a single value, probably the first one:

```

$value = $cgi->param('foo');
-->
'bar'

```

So what context is it being called in, in the code under suspicion? Well, that’s exactly the problem. It turns out that functions called during hash value assignment are evaluated in a list context. However, when the result comes back, that value or those values are assigned to be part of uthe hash as if they were a set of individual, comma-separated scalars. I suspect this behaviour exists because of the close relationship of lists and hashes; it allows you to do stuff like:

```

my @array = ("foo", 3, "bar", 6);
my %hash = @array;
-->
{ "foo" => 3, "bar" => 6 }

```

Therefore, when assigning the result of a function call as a hash value, if the return value is a single scalar, all goes as you would expect, but if it’s an array, the second and subsequent values end up being added as key/value pairs in the hash as well. This allows an attacker to override values already in the hash (specified earlier), which may have already been validated, with values controlled by them. In our case, `real_name` can be any string, so doesn’t need validation, but `login_name` most definitely does, and it already has been by the time this code is called.

So, in the case of the problematic code above, something like:

```

index.cgi?realname=JRandomUser&realname=login_name&realname=admin@mozilla.com

```

would end up overriding the already-validated `login_name` variable, giving the attacker control of the value used in the call to `Bugzilla::User->create()`. Oops.

We found 15 instances of this pattern in our code, four of which were exploitable to some degree. If you maintain a Perl web application, you may want to audit it for this pattern. Clearly, CGI.pm `param()` calls are the first thing to look for, but it’s possible that this pattern could occur with other modules which use the same context-sensitive return feature. The generic fix is to require the function call to be evaluated in scalar context:

```

my $otheruser = Bugzilla::User->create({
    login_name => $login_name,
    realname   => scalar $cgi->param('realname'),
    cryptpassword => $password});

```

I’d say it might be wise to not ever allow hash values to be assigned directly from functions without a call to `scalar`.

This entry was posted in [Bugzilla](https://blog.gerv.net/category/bugzilla/), [Security](https://blog.gerv.net/category/security/), [Syndicate](https://blog.gerv.net/category/syndicate/) by [gerv](https://blog.gerv.net/author/gerv/). Bookmark the [permalink](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/ "Permalink to New Class of Vulnerability in Perl Web Applications").

## 41 thoughts on “New Class of Vulnerability in Perl Web Applications”

1. Pingback: [ADnjus | Bugzilla 0-day can reveal 0-day bugs in OSS giants like Mozilla, Red Hat](http://news.aronlindegaard.com/?p=75782)
3. ![](http://1.gravatar.com/avatar/14c751a7de307f3f50a2cb67b38a6796?s=68&d=mm&r=g)Breno on [October 7, 2014 at 12:52 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43414) said:

   List context is a Perl feature that has sadly been misused in this particular case, but doesn’t qualify as a vulnerability. As you said, the proper use when assigning a context sensitive value to a hash is supposed to be together with the “scalar” statement. Better yet: sanitize your parameters upfront and only pass on variables which you control, never something like user input.

   This is all textbook web security, as you know, and language agnostic. What happened was just an unfortunate slip from the developers, which lead to this serious vulnerability.
5. ![](http://0.gravatar.com/avatar/f556deeff7d35483da58a973d49d5fca?s=68&d=mm&r=g)Luca on [October 7, 2014 at 1:02 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43415) said:

   This looks like a variant of HPP ([https://www.owasp.org/index.php/Testing\_for\_HTTP\_Parameter\_pollution\_(OTG-INPVAL-004)](https://www.owasp.org/index.php/Testing_for_HTTP_Parameter_pollution_%28OTG-INPVAL-004%29). Pretty cool bug!

   “Supplying multiple HTTP parameters with the same name may cause an application to interpret values in unanticipated ways. By exploiting these effects, an attacker may be able to bypass input validation, trigger application errors or modify internal variables values. As HTTP Parameter Pollution (in short HPP) affects a building block of all web technologies, server and client side attacks exist.”
7. ![](http://0.gravatar.com/avatar/3974f4c1e996748fa3a9f3d7be45259c?s=39&d=mm&r=g)gerv on [October 7, 2014 at 5:38 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43420) said:

   Breno: I wouldn’t call this “an unfortunatey slip from the developers”, I’d say that this particular feature (or rather, the combination of two features) is a footgun. And its use in CGI.pm is very unfortunate.

   For a start, “param” is a singular word. If it were called “params”, it might be a bit more obvious that it can return a list.
9. ![](http://0.gravatar.com/avatar/3974f4c1e996748fa3a9f3d7be45259c?s=39&d=mm&r=g)gerv on [October 7, 2014 at 5:40 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43421) said:

   Yep, I think you are right. The general attack idea is known, but the particular vulnerability caused by the list context of hash assignments is (to my knowledge) new.
11. Pingback: [Bugzilla 0-day can reveal 0-day bugs in OSS giants like Mozilla, Red Hat - Binary Reveux](http://binlog.reveux.com/34169/bugzilla-0-day-can-reveal-0-day-bugs-in-oss-giants-like-mozilla-red-hat/)
13. ![](http://2.gravatar.com/avatar/e17949267bbfe21a0fadf1bbf00592b4?s=39&d=mm&r=g)[Aristotle Pagaltzis](http://plasmasturm.org/) on [October 7, 2014 at 6:44 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43423) said:

    This is very old hat: <http://seclists.org/vulnwatch/2006/q4/6>

    And among several similar reasons, it’s why Hash::MultiValue was invented for parameter handling in Plack: <http://bulknews.typepad.com/blog/2009/12/perl-why-parameters-sucks-and-what-we-can-do.html>
15. ![](http://1.gravatar.com/avatar/acde2aaaba1e40097d66dad28063c1b3?s=39&d=mm&r=g)[Dave Cross](http://perlhacks.com/) on [October 7, 2014 at 10:23 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43424) said:

    The method is called “param” because it returns all of the values of a particular (single) parameter. CGI.pm already has a “params” method which returns a list containing the names of all of the parameters in the HTTP request.
17. ![](http://0.gravatar.com/avatar/3974f4c1e996748fa3a9f3d7be45259c?s=39&d=mm&r=g)[Gervase Markham](http://www.gerv.net/) on [October 7, 2014 at 10:31 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43425) said:

    Well, OK, naming is hard :-) But I think my point stands – it’s not all that obvious that $cgi->param(‘foo’) can return a list, and it’s easy to write code which assumes it doesn’t, and that code works fine right up until the time someone attacks you.

    If you think I’m wrong about “easy”, let’s see how many CVEs there are over the next few months as other Perl codebases get audited for this, and what Check Point say at CCC in December.
19. ![](http://2.gravatar.com/avatar/52d869b25e754a41a7bb8ac6db2f0be6?s=68&d=mm&r=g)[Lee J](http://leejo.github.io) on [October 7, 2014 at 10:32 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43426) said:

    Primary maintainer of CGI.pm here – there’s a lot of history in CGI.pm that makes it difficult to patch these kind of issues without massively breaking back compat, but of course critical vulnerabilities need looking at. I’ve made some progress with the existing issues queue and aim to really gut the module with v5 releases, probably post perl 5.22 when it should (hopefully) be clearer that CGI.pm is no longer core.

    There’s an important bit of information missing here. The Bugzilla code actually subclasses CGI.pm with Bugzilla::CGI, so the link to the CGI.pm param method is misleading as Bugzilla::CGI has its own param method that overrides the CGI.pm param method and does not call SUPER. So really you need to be pointing at the Bugzilla source code: [https://bzr.mozilla.org/bugzilla/4.4/view/head:/Bugzilla/CGI.pm#L345](https://bzr.mozilla.org/bugzilla/4.4/view/head%3A/Bugzilla/CGI.pm#L345)

    I’ve been working my way through the Bugzilla::CGI code to get any useful changes back upstream into CGI.pm, some of these i can and some i can’t at present due to aforementioned back compat issues.

    As always – patches welcome :)
21. ![](http://2.gravatar.com/avatar/52d869b25e754a41a7bb8ac6db2f0be6?s=68&d=mm&r=g)[Lee J](http://leejo.github.io) on [October 7, 2014 at 10:34 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43427) said:

    Ooops! sorry, clarification that Bugzilla::CGI \*does\* call SUPER in the param method. Nonetheless, previous link still applies.
23. ![](http://1.gravatar.com/avatar/acde2aaaba1e40097d66dad28063c1b3?s=39&d=mm&r=g)[Dave Cross](http://perlhacks.com/) on [October 7, 2014 at 10:37 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43428) said:

    It’s always easy to write code with bugs in when you don’t read (or, perhaps more importantly, understand) the documentation :-)

    I’m happy to admit that I’ve written code with this bug in. I don’t blame Perl, I blame my own incompetance.
25. ![](http://0.gravatar.com/avatar/3e42479b6063be4a85f9974d2161dadf?s=68&d=mm&r=g)[Neil Rashbrook](http://neil.rashbrook.org/) on [October 7, 2014 at 11:39 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43429) said:

    Part of the confusion is that => looks like a hash construction operator, but in fact it’s just a list separator that magically quotes its LHS. (Similar confusions exist in other languages, e.g. in C++ T t(); is a function declaration and not a default constructed variable, while in JavaScript ({x : y}) is an object initialised with a property but {x : y} is a labelled expression in a block.)
27. ![](http://0.gravatar.com/avatar/3974f4c1e996748fa3a9f3d7be45259c?s=39&d=mm&r=g)[Gervase Markham](http://www.gerv.net/) on [October 7, 2014 at 1:04 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43430) said:

    Hi Lee,

    Thanks for dropping in :-) Glad to hear you are on the case. As you note, we do call SUPER, hence we inherit the wantarray behaviour.

    I completely understand that back compat means it’s hard to fix these issues. I’m not blaming you at all. If I were you, I think I’d add explicit scalarparam() and arrayparam() calls (naming is hard; do think of better ones) and document param() as being deprecated. That way, people have to make an explicit choice about what they want, and it’s not possible to introduce a bug through unawareness of the return type.
29. Pingback: [В BugZilla устранена опасная уязвимость, позволяющая повысить свои привилегии | AllUNIX.ru — Всероссийский портал о UNIX-системах](http://allunix.ru/2014/10/07/%D0%B2-bugzilla-%D1%83%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B0-%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%B0%D1%8F-%D1%83%D1%8F%D0%B7%D0%B2%D0%B8%D0%BC%D0%BE%D1%81%D1%82%EF%BF%BD)
31. ![](http://2.gravatar.com/avatar/52d869b25e754a41a7bb8ac6db2f0be6?s=39&d=mm&r=g)[Lee J](http://leejo.github.io) on [October 7, 2014 at 1:41 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43434) said:

    Yes, unfortunately CGI.pm has a lot of history that makes this kind of stuff “fun”.

    My first thought is to add a warning so any call to ->param in list context will raise loud noises and point the user at (to be updated) documentation. Of course, this warning would be configurable so can be switched off.

    I think it’s important that any users of the module can see clearly that they might be doing something wrong and many don’t ever see blog posts like this, or follow CVE announcements and the like; so having them upgrade CGI and suddenly see scary warnings might get their attention.

    Actually splitting ->param into two distinct methods would be a good idea for the v5 roadmap. Deprecating ->param in the v4 releases is probably going to upset far more people than simply raising a warning. As i said, fun :)
33. ![](http://1.gravatar.com/avatar/d9cc76df188eca49c05eeeaad3c4557c?s=68&d=mm&r=g)[Sebastian](http://www.pal-blog.de) on [October 7, 2014 at 1:56 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43435) said:

    Not a new issue (using list return values when building a hash) and no “Perl bug” at all. What about “realname” being “%00” or “do\_something\_very\_bad()” – would you allow that to enter your database? Great fun if the realname is shown somewhere with admin priviledges…

    Always check your arguments, expecially when they come from (web) users. Perl’s taint mode helps for remembering the checks.
35. ![](http://0.gravatar.com/avatar/3974f4c1e996748fa3a9f3d7be45259c?s=39&d=mm&r=g)[Gervase Markham](http://www.gerv.net/) on [October 7, 2014 at 2:02 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43436) said:

    You put “Perl bug” in quotes – who are you quoting? I never said it’s a bug in Perl. It’s a footgun, but it’s not a bug.

    I’d be entirely fine with a realname of %00 or do\_something\_very\_bad(), because we don’t pass the string unfiltered to the database.
37. ![](http://1.gravatar.com/avatar/d7b981231f4fabcf7e9e117ef3e99763?s=68&d=mm&r=g)Markus Peter on [October 7, 2014 at 2:23 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43437) said:

    Well, it’s a CGI bug, but still, Perl could offer an optional, stricter hash-initialization mode where, a duplicate key in {}, or a duplicate key in list assignment to a hash would automatically error.

    Something along the lines of:

    use strict ‘hash-init’;

    my %foo = ( key => $param, key => $param ); # dies

    but re-assignment won’t die:

    my %foo = ( key => $param);

    $foo{key} = $param2; # does not die

    In my experience, doubled keys within the same assignment are accidental bugs in 99% of cases – an optional strict mode would not only solve security bugs like that but also avoid accidental bugs.

    There are Tie-modules which implement similar behavior and of course the option to lock hashes, but this is not quite the same – often changing the the values is desired, the bugs are usually, where this happens within the same statement.
39. ![](http://1.gravatar.com/avatar/d7b981231f4fabcf7e9e117ef3e99763?s=39&d=mm&r=g)Markus Peter on [October 7, 2014 at 2:24 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43438) said:

    Oops, clarification: not a bug in CGI.pm itself of course, just an unfortunate design decision which easily causes bugs. During re-read I found my statement easy to misunderstand.
41. ![](http://0.gravatar.com/avatar/3974f4c1e996748fa3a9f3d7be45259c?s=39&d=mm&r=g)[Gervase Markham](http://www.gerv.net/) on [October 7, 2014 at 2:51 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43439) said:

    This wouldn’t necessarily cover all bases, because an attacker could still add extra optional members to the hash which were not always present on some codepaths but which were checked for later, and that would avoid this “die” saving the developer. I agree it would do a lot, but it wouldn’t be foolproof.
43. Pingback: [Critical Bugzilla vulnerability could give hackers access to undisclosed software flaws - Computer Stuff](http://compustuff.tk/critical-bugzilla-vulnerability-could-give-hackers-access-to-undisclosed-software-flaws/)
45. ![](http://1.gravatar.com/avatar/14c751a7de307f3f50a2cb67b38a6796?s=39&d=mm&r=g)Breno on [October 7, 2014 at 4:54 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43441) said:

    Again, validating user input before doing anything with it is textbook security and, if you’re doing anything other than that, your code is likely susceptible to attacks – no matter what language you pick.

    That said, I agree with you that frameworks exist to assist developers in not shooting themselves on the foot, and any measures that can be taken to prevent security issues and encourage best practices should be taken. This is one of the reasons CGI.pm was removed from core in modern perl releases :)

    Modern Perl frameworks such as Dancer (perldancer.org) turn lists of parameters in param(“foo”) into a list reference (which is a single value), not a common list. If Bugzilla had been written in Dancer, for example, the bug would likely have been just a bug, not a vulnerability, as it would turn “realname” into an array reference and not expand into the hash itself.

    Other popular Perl web frameworks such as Catalyst (catalystframework.org) and Mojolicious (mojolicio.us) have recently updated their code and documentation as well. Catalyst included a bigger “hey, don’t do that” note next to param()’s documentation pointing to this post, and Mojolicious made “param()” only return one value, providing “multi\_param()” if you want the entire list – making the code more robust against this kind of mishap.
47. ![](http://0.gravatar.com/avatar/3974f4c1e996748fa3a9f3d7be45259c?s=39&d=mm&r=g)gerv on [October 7, 2014 at 7:15 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43444) said:

    I’m not sure what you would have had us do differently; the real name doesn’t need validating because it can be any string. We’re not coding in C here.

    The Dancer solution is bogus, because it means to call the param() function reliably, you either need to do:

     `my $p = $cgi->param('foo');

    my $scalar = ref $p eq 'ARRAY' ? $p->[0] : $p;

    or

    my @array = ref $p eq 'ARRAY' ? @$p : ($p);`

    And that’s just ugly. See <http://bulknews.typepad.com/blog/2009/12/perl-why-parameters-sucks-and-what-we-can-do.html> for more on this (with Catalyst as the example).
49. Pingback: [Bugzilla zero-day can reveal zero-day vulnerabilities in top open-source projects | eKanpSack](http://blog.eknapsack.com/archives/745)
51. ![](http://0.gravatar.com/avatar/3fb2d1d9349ce50e23f813797858b0e7?s=39&d=mm&r=g)BlindWanderer on [October 8, 2014 at 4:13 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43446) said:

    I never realized that about javascript! So all I was missing was the parentheses to make it work.
53. ![](http://2.gravatar.com/avatar/52d869b25e754a41a7bb8ac6db2f0be6?s=39&d=mm&r=g)[Lee J](http://leejo.github.io) on [October 8, 2014 at 8:45 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43448) said:

    FWIW – v4.05 of CGI.pm has been pushed to CPAN, which addresses this issue (amongst others, please see Changes).
55. ![](http://1.gravatar.com/avatar/d7b981231f4fabcf7e9e117ef3e99763?s=39&d=mm&r=g)Markus Peter on [October 8, 2014 at 10:35 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43450) said:

    Didn’t mean it was foolproof, but it would help in avoiding many of bugs, just like the other “strict” rules.
57. ![](http://1.gravatar.com/avatar/1228cc62b9ab9755f36bb6fd54d69aa2?s=39&d=mm&r=g)Simo Sutela on [October 9, 2014 at 2:31 PM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-43476) said:

    The suggested strict mode could also force the “=>” operator to evaluate its arguments as scalars or references, of course, as putting list-type things next to it makes very little sense.
59. Pingback: [В BugZilla устранена опасная уязвимость, открывшая новый вид атак на web-приложения | AllUNIX.ru — Всероссийский портал о UNIX-системах](http://allunix.ru/2014/10/11/%D0%B2-bugzilla-%D1%83%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B0-%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%B0%D1%8F-%D1%83%D1%8F%D0%B7%D0%B2%D0%B8%D0%BC%D0%BE%D1%81%D1%82%EF%BF%BD)
61. Pingback: [Bugzilla 0-day can reveal 0-day bugs in OSS giants like Mozilla, Red Hat | VIGALUM](http://www.vigalum.com/bugzilla-0-day-can-reveal-0-day-bugs-in-oss-giants-like-mozilla-red-hat/)
63. Pingback: [Bugzilla 0-day can reveal 0-day bugs in OSS giants like Mozilla, Red Hat | infopunk.org](http://infopunk.org/main/blog/2014/10/06/bugzilla-0-day-can-reveal-0-day-bugs-in-oss-giants-like-mozilla-red-hat/)
65. Pingback: [SB14-293: Vulnerability Summary for the Week of October 13, 2014 « CyberSafe NV](http://cybersafenv.org/sb14-293-vulnerability-summary-for-the-week-of-october-13-2014/)
67. Pingback: [SB14-293: Vulnerability Summary for the Week of October 13, 2014 | 007 Software](http://007software.net/sb14-293-vulnerability-summary-for-the-week-of-october-13-2014/)
69. Pingback: [Bulletin (SB14-293) Vulnerability Summary for the Week of October 13, 2014 | ECI Networks](http://ecinetworks.com/?p=2342)
71. Pingback: [SB14-293: Vulnerability Summary for the Week of October 13, 2014 | Blogg'n @ ECI](http://blogs.eciems.com/sb14-293-vulnerability-summary-for-the-week-of-october-13-2014/)
73. Pingback: [SB14-293: Vulnerability Summary for the Week of October 13, 2014 « ECI Blog @WordPress](http://ecinetworks.wordpress.com/2014/10/21/sb14-293-vulnerability-summary-for-the-week-of-october-13-2014/)
75. Pingback: [A Bug in Bug Tracker "Bugzilla" exposes Private Bugs | Hacker News](http://allhackersnews.com/2014/11/bug-bug-tracker-bugzilla-exposes-private-bugs.html)
77. ![](http://1.gravatar.com/avatar/4098a22f076c8ed0d2c223c58364b753?s=68&d=mm&r=g)[Bradly](http://severty322.com) on [December 30, 2019 at 2:03 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-53515) said:

    Hi to all, as I am really eager of reading this blog’s post to be updated on a regular basis.

    It includes nice stuff.
79. ![](http://0.gravatar.com/avatar/caad6327683509f338abfbafbec30f74?s=68&d=mm&r=g)[Cyber security](https://getwebhawk.com/) on [February 6, 2020 at 6:02 AM](https://blog.gerv.net/2014/10/new-class-of-vulnerability-in-perl-web-applications/#comment-55463) said:

    Hi, I am new here I found this blog very interesting. As it is an old blog but very much engaging and informative thank you for the post.
81. Pingback: [Is array injection a vulnerability and what is the proper term for it? – Config9.com](https://config9.com/sec/is-array-injection-a-vulnerability-and-what-is-the-proper-term-for-it/)

### Leave a Reply [Cancel reply](/2014/10/new-class-of-vulnerability-in-perl-web-applications/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

[Proudly powered by WordPress](http://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from bugs.mageia.org_37d85c1d_20250126_115409.html ===


Mageia Bugzilla – Bug 14241
bugzilla new security issues CVE-2014-157[1-3]
Last modified: 2014-10-09 18:42:48 CEST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=14241&GoAheadAndLogIn=1)

  [x]
* |
  [New Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug 14241**](show_bug.cgi?id=14241)
- bugzilla new security issues CVE-2014-157[1-3]

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
bugzilla new security issues CVE-2014-157[1-3]

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sec team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/615620/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | MGA3TOO has\_procedure advisory mga3-3... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | validated\_update | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-10-06 21:59 CEST by David Walser | | --- | --- | | Modified: | 2014-10-09 18:42 CEST ([History](show_activity.cgi?id=14241)) | | CC List: | 3 users (show)  olchal sysadmin-bugs tmb | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | bugzilla-4.4.5-1.mga4.src.rpm | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=14241&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=14241#c0)  David Walser    2014-10-06 21:59:43 CEST  ``` Upstream has issued an advisory today (October 6): <http://www.bugzilla.org/security/4.0.14/>  Updated packages uploaded for Mageia 3, Mageia 4, and Cauldron.  Advisory: ========================  Updated bugzilla packages fix security vulnerabilities:  If a new comment was marked private to the insider group, and a flag was set in the same transaction, the comment would be visible to flag recipients even if they were not in the insider group (CVE-2014-1571).  An attacker creating a new Bugzilla account can override certain parameters when finalizing the account creation that can lead to the user being created with a different email address than originally requested. The overridden login name could be automatically added to groups based on the group's regular expression setting (CVE-2014-1572).  During an audit of the Bugzilla code base, several places were found where cross-site scripting exploits could occur which could allow an attacker to access sensitive information (CVE-2014-1573).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1571> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1572> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1573> <http://www.bugzilla.org/security/4.0.14/> <http://www.bugzilla.org/releases/4.4.6/release-notes.html> ========================  Updated packages in core/updates_testing: ======================== bugzilla-4.4.6-1.mga3.noarch.rpm bugzilla-contrib-4.4.6-1.mga3.noarch.rpm bugzilla-4.4.6-1.mga4.noarch.rpm bugzilla-contrib-4.4.6-1.mga4.noarch.rpm  from SRPMS: bugzilla-4.4.6-1.mga3.src.rpm bugzilla-4.4.6-1.mga4.src.rpm  Reproducible:   Steps to Reproduce: ```  [Comment 1](show_bug.cgi?id=14241#c1)  David Walser    2014-10-06 22:00:26 CEST  ``` Testing procedure: [https://bugs.mageia.org/show_bug.cgi?id=9088#c14](show_bug.cgi?id=9088#c14 "RESOLVED FIXED - Multiple vulnerabilities in bugzilla (CVE-2012-4199,4198,4189,4197,5475, CVE-2013-0785,0786)") ```  ---   Whiteboard: (none) => MGA3TOO has\_procedure  [Comment 2](show_bug.cgi?id=14241#c2)  olivier charles    2014-10-07 22:42:38 CEST  ```  Testing on Mageia4-32  Installed : - bugzilla-4.4.6-1.mga4.noarch  in /usr/share/bugzilla/bin # ./checksetup.pl --check-modules # ./checksetup.pl  # leafpad /etc/bugzilla/localconfig $db_driver = 'mysql'; $db_host = 'localhost'; $db_name = 'bugs'; $db_pass = 'passwd';  # mysqladmin --user=root -p create bugs # mysql -u root -p  MariaDB [(none)]> GRANT SELECT, INSERT, UPDATE, DELETE, INDEX, ALTER, CREATE, LOCK TABLES, CREATE TEMPORARY TABLES, DROP, REFERENCES ON bugs.* TO bugs@localhost IDENTIFIED BY 'passwd'; MariaDB [(none)]>  FLUSH PRIVILEGES; MariaDB [(none)]> quit  # cd /etc/bugzilla/ # grep webservergroup localconfig $webservergroup = 'apache'; #  grep Group /etc/httpd/conf/httpd.conf # User/Group: The name (or #number) of the user/group to run httpd as. Group apache  # cd /usr/share/bugzilla/bin/ #  ./checksetup.pl * This is Bugzilla 4.4.6 on perl 5.18.1 (...) Enter the e-mail address of the administrator: olli@free.fr Enter the real name of the administrator: olli Enter a password for the administrator account:  Please retype the password to verify:  olli@free.fr is now set up as an administrator. Creating initial dummy product 'TestProduct'... checksetup.pl complete.  edit /etc/bugzilla/localconfig  <http://localhost/bugzilla/>  Logged in as olli@free.fr and passwd previously set. On welcome page, went to Administration/Parameters/Required Settings and filled urlbase :  <http://localhost/bugzilla/>  Then created bugs, add attachments, logged out, search, read bugs, download attachments...  All went smooth. ```  ---   CC: (none) => olchalWhiteboard: MGA3TOO has\_procedure => MGA3TOO has\_procedure MGA4-32-OK  [Comment 3](show_bug.cgi?id=14241#c3)  olivier charles    2014-10-08 20:56:02 CEST  ```  Testing on Mageia4-64  * This is Bugzilla 4.4.6 on perl 5.18.1  Followed same procedure as in [comment 2](show_bug.cgi?id=14241#c2)  Once installed and configured, created bugs, placed comments, attachments, logged in and out, created users, products, etc ...  All good. ```  ---   Whiteboard: MGA3TOO has\_procedure MGA4-32-OK => MGA3TOO has\_procedure MGA4-32-OK MGA4-64-OK  [Comment 4](show_bug.cgi?id=14241#c4)  claire robinson    2014-10-09 14:41:51 CEST  ``` Testing complete mga3 64 ```  ---   Whiteboard: MGA3TOO has\_procedure MGA4-32-OK MGA4-64-OK => MGA3TOO has\_procedure mga3-64-ok MGA4-32-OK MGA4-64-OK  [Comment 5](show_bug.cgi?id=14241#c5)  claire robinson    2014-10-09 15:02:49 CEST  ``` Testing complete mga3 32 ```  ---   Whiteboard: MGA3TOO has\_procedure mga3-64-ok MGA4-32-OK MGA4-64-OK => MGA3TOO has\_procedure mga3-32-ok mga3-64-ok MGA4-32-OK MGA4-64-OK  [Comment 6](show_bug.cgi?id=14241#c6)  claire robinson    2014-10-09 16:01:01 CEST  ``` Validating. Advisory uploaded.  Could sysadmin please push to 3 & 4 updates  Thanks ```  ---   Keywords: (none) => validated\_updateWhiteboard: MGA3TOO has\_procedure mga3-32-ok mga3-64-ok MGA4-32-OK MGA4-64-OK => MGA3TOO has\_procedure advisory mga3-32-ok mga3-64-ok MGA4-32-OK MGA4-64-OKCC: (none) => sysadmin-bugs  [Comment 7](show_bug.cgi?id=14241#c7)  Mageia Robot    2014-10-09 16:40:02 CEST  ``` An update for this issue has been pushed to Mageia Updates repository.  <http://advisories.mageia.org/MGASA-2014-0412.html> ```  ---   Status: NEW => RESOLVEDResolution: (none) => FIXED  David Walser    2014-10-09 18:34:17 CEST   URL: (none) => http://lwn.net/Vulnerabilities/615620/  [Comment 8](show_bug.cgi?id=14241#c8)  Thomas Backlund    2014-10-09 18:42:48 CEST  ```  bugs.mageia.org also updated to 4.4.6 ```  ---   CC: (none) => tmb |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=14241&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=14241)
* - [XML](show_bug.cgi?ctype=xml&id=14241)
* - [Clone ThisBug](enter_bug.cgi?cloned_bug_id=14241&normal=1)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=14241&GoAheadAndLogIn=1)

    [x]
  + |
    [New Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)


