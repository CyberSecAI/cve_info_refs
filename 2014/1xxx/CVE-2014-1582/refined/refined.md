```
{
  "CVE-2014-1582": {
    "Description": "Patrick McManus reported a method to use SPDY or HTTP/2 connection coalescing to bypass key pinning on different sites that resolve to the same IP address. This could allow the use of a fraudulent certificate when a saved pin for that subdomain should have prevented the connection. This leads to possible man-in-the-middle attacks if an attacker has control of the DNS connection and the ability to obtain a fraudulent certificate that browsers would accept in the absence of the pin.",
    "Root cause": "The vulnerability arises from the ability to bypass key pinning using SPDY or HTTP/2 connection coalescing. When multiple sites resolve to the same IP address, an attacker can use a connection established with one site (and its certificate) to serve content for another site, even if that other site has a different key pin configured. This bypass occurs because the initial connection's certificate, valid for the IP, is deemed valid for subsequent connections to the same IP.",
    "Weaknesses": [
      "Bypassing key pinning through SPDY/HTTP2 connection coalescing",
      "Insufficient verification of certificate chain for coalesced connections",
      "Lack of full certificate chain during resumed connections"
    ],
    "Impact": "The impact of this vulnerability is that an attacker can potentially perform a man-in-the-middle (MitM) attack. By controlling DNS and obtaining a fraudulent certificate for the victim domain (often with a wildcard), the attacker can intercept and manipulate traffic intended for the legitimate site.",
    "Attack vectors": [
      "Man-in-the-Middle (MitM) attack",
      "DNS spoofing to make multiple sites resolve to the same IP",
      "Use of fraudulent certificates issued by a trusted CA, with subjectAltName(s) that cover the victim site(s)"
    ],
    "Required attacker capabilities/position": [
      "Control over DNS to redirect traffic",
      "Ability to obtain a fraudulent certificate that browsers would accept",
      "Ability to manipulate network traffic to perform MitM attacks",
      "Knowledge of target sites' key pins"
    ],
     "Additional Details": "The fix involved saving the verified certificate chain for each TransportSecurityInfo so that it could be used later to check for pinning compliance. Additionally, a hash table was added to keep track of validated chains from hosts that could potentially initiate a session resumption, and a timer was introduced to cull the entries periodically. This was improved in patch v2 to save intermediates from successful connections to allow re-verification of certificates from successful connections."
  }
}
```