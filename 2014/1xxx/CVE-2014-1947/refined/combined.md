=== Content from www.openwall.com_9ca2dee9_20250125_132900.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2014/02/12/13) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <52FC49E8.4060105@redhat.com>
Date: Thu, 13 Feb 2014 15:28:24 +1100
From: Murray McAllister <mmcallis@...hat.com>
To: oss-security@...ts.openwall.com
CC: cve-assign@...re.org
Subject: Re: information on "ImageMagick PSD Images Processing RLE Decoding
 Buffer Overflow Vulnerability"

On 02/13/2014 03:11 AM, cve-assign@...re.org wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
>> that's still 4 bytes too many
>
> Use CVE-2014-1947.

Thanks to everyone who explained this to me off-list.

Peter Hutterer of Red Hat has added some information about all of this
to <https://bugzilla.redhat.com/show_bug.cgi?id=1064098#c4>

To summarize, what I posted here originally is
<http://trac.imagemagick.org/changeset/13736> and has been assigned
CVE-2014-1947

The Secunia advisory (<http://secunia.com/advisories/56844/>) is referring
to this commit:

<http://trac.imagemagick.org/changeset/14801>

Which as far as I know does not have a CVE yet.

Cheers,

--
Murray McAllister / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_f859216e_20250125_132859.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](13) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <52FAD5B9.1060603@redhat.com>
Date: Wed, 12 Feb 2014 13:00:25 +1100
From: Murray McAllister <mmcallis@...hat.com>
To: oss-security@...ts.openwall.com
Subject: information on "ImageMagick PSD Images Processing RLE Decoding Buffer
 Overflow Vulnerability"

Good morning,

Does anyone have further information about
<<http://secunia.com/advisories/56844/>>? (I could not get the
<http://freecode.com/projects/imagemagick/tags/bugfixes> link to show
anything useful.)

diffing ImageMagick-6.8.7/coders/psd.c ImageMagick-6.8.8/coders/psd.c:

""
@@ -1224,7 +1224,7 @@
                Allocate layered image.
              */
              layer_info[i].image=CloneImage(image,layer_info[i].page.width,
-              layer_info[i].page.height == ~0U ? 1 :
layer_info[i].page.height,
+              layer_info[i].page.height == ~0UL ? 1 :
layer_info[i].page.height,
                MagickFalse,&image->exception);
              if (layer_info[i].image == (Image *) NULL)
                {
@@ -2112,9 +2112,6 @@
    StringInfo
      *bim_profile;

-  unsigned char
-    layer_name[4];
-
    /*
      Open image file.
    */
@@ -2372,12 +2369,15 @@
          property=(const char *) GetImageProperty(next_image,"label");
          if (property == (const char *) NULL)
            {
+            char
+              layer_name[MaxTextExtent];
+
              (void) WriteBlobMSBLong(image,16);
              (void) WriteBlobMSBLong(image,0);
              (void) WriteBlobMSBLong(image,0);
-            (void) FormatLocaleString((char *) layer_name,MaxTextExtent,
-              "L%06ld",(long) layer_count++);
-            WritePascalString( image, (char*)layer_name, 4 );
+            (void)
FormatLocaleString(layer_name,MaxTextExtent,"L%06ld",(long)
+              layer_count++);
+            WritePascalString(image,layer_name,4);
            }
          else
            {

""

Would the issue have been writing the amount of 6 long ints into the 4
byte layer_name buffer?

Having a (very brief) look at ImageMagick-6.5.4 on RHEL 6, it's using
"L%02ld" instead of "L%06ld", but that's still 4 bytes too many before
the layer_name[MaxTextExtent]; change.

Could a CVE please be assigned if it has not been already?

Sorry for missing anything obvious.

--
Murray McAllister / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.suse.com_a0fe14aa_20250125_132902.html ===


# Security update for ImageMagick

SUSE Security Update: Security update for ImageMagick

---

| Announcement ID: | SUSE-SU-2014:0359-1 |
| --- | --- |
| Rating: | moderate |
| References: | [#863838](https://bugzilla.novell.com/863838) |
| Affected Products: | - SUSE Linux Enterprise Software Development Kit 11 SP3 - SUSE Linux Enterprise Server 11 SP3 for VMware - SUSE Linux Enterprise Server 11 SP3 - SUSE Linux Enterprise Desktop 11 SP3 |

---

An update that fixes one vulnerability is now available.

## Description:

The image converter program and library set of ImageMagick

received an update that fixes a buffer overflow when

handling PSD images.

Security Issue reference:

\* CVE-2014-1947

>
## Patch Instructions:

To install this SUSE Security Update use YaST online\_update.

Alternatively you can run the command listed for your product:

* SUSE Linux Enterprise Software Development Kit 11 SP3:

  `zypper in -t patch sdksp3-ImageMagick-8978`
* SUSE Linux Enterprise Server 11 SP3 for VMware:

  `zypper in -t patch slessp3-ImageMagick-8978`
* SUSE Linux Enterprise Server 11 SP3:

  `zypper in -t patch slessp3-ImageMagick-8978`
* SUSE Linux Enterprise Desktop 11 SP3:

  `zypper in -t patch sledsp3-ImageMagick-8978`

To bring your system up-to-date, use "zypper patch".

## Package List:

* SUSE Linux Enterprise Software Development Kit 11 SP3 (i586 ia64 ppc64 s390x x86\_64):
  * ImageMagick-6.4.3.6-7.28.1
  * ImageMagick-devel-6.4.3.6-7.28.1
  * libMagick++-devel-6.4.3.6-7.28.1
  * libMagick++1-6.4.3.6-7.28.1
  * libMagickWand1-6.4.3.6-7.28.1
  * perl-PerlMagick-6.4.3.6-7.28.1
* SUSE Linux Enterprise Software Development Kit 11 SP3 (ppc64 s390x x86\_64):
  * libMagickWand1-32bit-6.4.3.6-7.28.1
* SUSE Linux Enterprise Server 11 SP3 for VMware (i586 x86\_64):
  * libMagickCore1-6.4.3.6-7.28.1
* SUSE Linux Enterprise Server 11 SP3 for VMware (x86\_64):
  * libMagickCore1-32bit-6.4.3.6-7.28.1
* SUSE Linux Enterprise Server 11 SP3 (i586 ia64 ppc64 s390x x86\_64):
  * libMagickCore1-6.4.3.6-7.28.1
* SUSE Linux Enterprise Server 11 SP3 (ppc64 s390x x86\_64):
  * libMagickCore1-32bit-6.4.3.6-7.28.1
* SUSE Linux Enterprise Desktop 11 SP3 (i586 x86\_64):
  * ImageMagick-6.4.3.6-7.28.1
  * libMagick++1-6.4.3.6-7.28.1
  * libMagickCore1-6.4.3.6-7.28.1
  * libMagickWand1-6.4.3.6-7.28.1
* SUSE Linux Enterprise Desktop 11 SP3 (x86\_64):
  * libMagickCore1-32bit-6.4.3.6-7.28.1

## References:

* http://support.novell.com/security/cve/CVE-2014-1947.html
* https://bugzilla.novell.com/863838
* http://download.suse.com/patch/finder/?keywords=6fc80c29f232e8bde0a66206d3bae9d6



=== Content from www.openwall.com_b7a1498f_20250125_132900.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](2) [[thread-next>]](../../../2014/02/14/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201402131905.s1DJ5Brw016839@linus.mitre.org>
Date: Thu, 13 Feb 2014 14:05:11 -0500 (EST)
From: cve-assign@...re.org
To: mmcallis@...hat.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: information on "ImageMagick PSD Images Processing RLE Decoding Buffer Overflow Vulnerability"

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> The Secunia advisory (<http://secunia.com/advisories/56844/>) is referring
> to this commit:
>
> <http://trac.imagemagick.org/changeset/14801>
>
> Which as far as I know does not have a CVE yet.

Use CVE-2014-1958 for changeset 14801.

There are at least two ways to handle the CVE assignments for the
other issues. The problem is that CVE-2014-1947 was originally bound
to the disclosure of "that's still 4 bytes too many" (in ImageMagick
6.5.4) but this is apparently not an accurate description of the
problem. (Possibly "4 bytes too many" was based on an incorrect
interpretation that "L%02ld" meant two four-byte integer values, going
into a single four-byte buffer.)

Option 1:

1a. REJECT CVE-2014-1947.

1b. Assign one new CVE-2014-#### ID for the vulnerability in older
ImageMagick versions that use the "L%02ld" string. The root cause here
is that the code did not cover the case of more than 99 layers, which
is apparently allowable but relatively uncommon. This has a resultant
buffer overflow, e.g, L99\0 is safe but L100\0 is unsafe. When the
overflow occurs, it can be described as "1 or more bytes too many."

1c. Assign another new CVE-2014-#### ID for the vulnerability in newer
ImageMagick versions that use the "L%06ld" string. The root cause here
is that the code did not recognize the relationship between the 8 (or
more) characters in "L%06ld" and the actual buffer size. This has a
resultant buffer overflow of "4 or more bytes too many."

Option 2:

2a. Keep CVE-2014-1947 for the above-mentioned vulnerability in older
ImageMagick versions. This preserves the original meaning of
CVE-2014-1947 as a vulnerability affecting (for example) ImageMagick
6.5.4.

2b. Assign a new CVE-2014-#### ID for the above-mentioned
vulnerability in newer ImageMagick versions.

(We will proceed with option 2 unless option 1 is substantially better
for someone.)

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJS/RcdAAoJEKllVAevmvmsFEAH/R/cAm9u7IGz//9qvH9tqlJn
KIB+95ZCz0DBJDWTlyXot3TkvEdd8dnfKNLMfSYdWnTCMMNwOKLhO+2cYd1RJ/Fp
U8T0vgRIXywrzkXHkdMmxDOrL+5GC1WEUb2ibGlsTRpbtycQOcHyevOkr2o01HwR
f6Imq8s15Uf/R519ZYdAvrLSfrq/i8cB9seHcXhz81ZxGBkUXiznSOCnwjg+tbLv
HWjHl75eid5PTs2Zh1dZ9pty949Az23FqhDF1n8uFSk44FuNCpZiNCPICqO+eRrc
8Ib6PIKfqzelHz9Q2wBQW3I2vxvKxlCm6ohf699TrhypgHjI0O0IlshnrmqntpA=
=2sDp
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from access.redhat.com_acca7f39_20250126_085743.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.openwall.com_9f00738d_20250125_132859.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](12) [[next>]](14) [[<thread-prev]](2) [[thread-next>]](../../../2014/02/13/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201402121611.s1CGB6We013412@linus.mitre.org>
Date: Wed, 12 Feb 2014 11:11:06 -0500 (EST)
From: cve-assign@...re.org
To: mmcallis@...hat.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: information on "ImageMagick PSD Images Processing RLE Decoding Buffer Overflow Vulnerability"

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> that's still 4 bytes too many

Use CVE-2014-1947.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJS+5y4AAoJEKllVAevmvmsIWEIALFbHQ54/qebyTcMY7e/HwEM
daQGR0Eo2u9rrP+XzNPHr+MDX7GgG2YVyai6uloZ5d+18o/pEn0WnpIYfHLTT+R5
U0TOj4drUFaL4so9xAv2UiW4cKHvSG2Ol96a/aeQzyT5pjuocYwiip+X2o4efo8/
aNycBs1XcZQsZY5rxj4tFRPkk20nUXnMrsx5IU/N11Ph1wCe7YELgCQS24c976BC
B80noQp168isrz8YLtoOTcFPG80gHrHVEhd8Gl1b8o7uTl0ZCYfxN8rwCHkbWkHq
YIOp+c0ccqAFEeEFuIKbgcHes22SkkaadwMLFmevj+GNHW/ykbhHTmy23nNh8iY=
=r8N9
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_ff1d0982_20250125_132900.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](12) [[next>]](14) [[<thread-prev]](../../../2014/02/14/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201402192340.s1JNe4eM029545@linus.mitre.org>
Date: Wed, 19 Feb 2014 18:40:04 -0500 (EST)
From: cve-assign@...re.org
To: mmcallis@...hat.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: information on "ImageMagick PSD Images Processing RLE Decoding Buffer Overflow Vulnerability"

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> (We will proceed with option 2 unless option 1 is substantially better
> for someone.)

Option 2 has now been chosen.

The clarified meaning of CVE-2014-1947 is now the vulnerability in
older ImageMagick versions (such as 6.5.4) that use the "L%02ld"
string. The root cause here is that the code did not cover the case of
more than 99 layers, which is apparently allowable but relatively
uncommon. This has a resultant buffer overflow, e.g, L99\0 is safe but
L100\0 is unsafe. When the overflow occurs, it can be described as "1
or more bytes too many."

A new ID of CVE-2014-2030 is now assigned for the vulnerability in
newer ImageMagick versions that use the "L%06ld" string. The root
cause here is that the code did not recognize the relationship between
the 8 (or more) characters in "L%06ld" and the actual buffer size.
This has a resultant buffer overflow of "4 or more bytes too many."

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJTBUBdAAoJEKllVAevmvms6DMIAKIPMAVIsUycaTjAgTdFoUmj
aDrKyOIAWMLWNE4wOUBDLQkrObjwwptbh7AptBr2L1bscUPiLao1A2CQwXLtZDVV
RX41OJ62YlZFZnPRay997+4oM5tbHa27UIc60paPFK8FBfMthf4JLWvuVUxWnFXl
CI+9XYRvkW6bdEQng9UDA9xTjuUJWPzemjscbS4+WvixU3+iCwhZF5lCSjICarXU
ZB5bmTnKqJPPhLvUB/6xIAhfGzXF7XuriGQL1jS1gllIZ59MKpOreRPNWgsWTVEs
HfFxtx1OvfdDPB/twSeK7viVJiKm9fNHZYCYCKoQooxd6Ks84MDzGP835c2yLvU=
=WQsh
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_81e85f33_20250125_132902.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1064098)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1064098)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1064098)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1064098

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1064098**](show_bug.cgi?id=1064098)
(CVE-2014-1947)
- [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) ImageMagick: PSD writing layer name buffer overflow ("L%02ld")

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-1947 ImageMagick: PSD writing layer name buffer overflow ("L%02ld")

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-1947 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1083082](show_bug.cgi?id=1083082 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [fedora-all]") [1083083](show_bug.cgi?id=1083083 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [epel-5]") [1083084](show_bug.cgi?id=1083084 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [epel-6]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1064101](show_bug.cgi?id=1064101) | | TreeView+ | [depends on](buglist.cgi?bug_id=1064098&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1064098&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2014-02-12 02:30 UTC by Murray McAllister | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:13 UTC ([History](show_activity.cgi?id=1064098)) | | [CC List:](page.cgi?id=fields.html#cclist) | 12 users (show)  bfriesen bleanhar carnil ccoleman dmcphers jialiu jkurik lmeyer nmurray pahan peter.hutterer rdieter | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-08 02:31:35 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1064098#c0)  Murray McAllister    2014-02-12 02:30:11 UTC  ``` A buffer overflow flaw affecting ImageMagick versions prior to 6.8.8-5 when handling PSD images was reported:  <http://secunia.com/advisories/56844/>  Diffing ImageMagick-6.8.7/coders/psd.c and ImageMagick-6.8.8/coders/psd.c, it looks like the flaw may be FormatLocaleString() writing the amount of 6 long integers (approximately 48 bytes) into a buffer (layer_name) that is only 4 bytes:  "" @@ -1224,7 +1224,7 @@                Allocate layered image.              */              layer_info[i].image=CloneImage(image,layer_info[i].page.width, -              layer_info[i].page.height == ~0U ? 1 : layer_info[i].page.height, +              layer_info[i].page.height == ~0UL ? 1 : layer_info[i].page.height,                MagickFalse,&image->exception);              if (layer_info[i].image == (Image *) NULL)                { @@ -2112,9 +2112,6 @@    StringInfo      *bim_profile;   -  unsigned char -    layer_name[4]; -    /*      Open image file.    */ @@ -2372,12 +2369,15 @@          property=(const char *) GetImageProperty(next_image,"label");          if (property == (const char *) NULL)            { +            char +              layer_name[MaxTextExtent]; +              (void) WriteBlobMSBLong(image,16);              (void) WriteBlobMSBLong(image,0);              (void) WriteBlobMSBLong(image,0); -            (void) FormatLocaleString((char *) layer_name,MaxTextExtent, -              "L%06ld",(long) layer_count++); -            WritePascalString( image, (char*)layer_name, 4 ); +            (void) FormatLocaleString(layer_name,MaxTextExtent,"L%06ld",(long) +              layer_count++); +            WritePascalString(image,layer_name,4);            }          else            {  ""  CVE request: <http://www.openwall.com/lists/oss-security/2014/02/12/2>   ```  [Comment 1](show_bug.cgi?id=1064098#c1)  Tomas Hoger    2014-02-12 10:02:33 UTC  ``` (In reply to Murray McAllister from [comment #0](show_bug.cgi?id=1064098#c0)) > Diffing ImageMagick-6.8.7/coders/psd.c and ImageMagick-6.8.8/coders/psd.c, > it looks like the flaw may be FormatLocaleString() writing the amount of 6 > long integers (approximately 48 bytes) into a buffer (layer_name) that is > only 4 bytes:  It's writing less than those mentioned 48 bytes.  It's writing a long integer in a way that at least 6 digits are always printed, prefixed with zeros if needed (e.g. L000001, L000123, or L1234567).  Adding space for 'L' and terminating '\0', that implies there is at least 4 byte buffer overflow whenever that code is reached.  Depending on actual memory layout, this may only clobber other local variables in WritePSDImage().  The maximum overflow is architecture dependent.  It seems the maximum number of digits is written if layer_count is LONG_MIN, resulting in layer_name being L-2147483648 (32bit) or L-9223372036854775808 (64bit), yielding the maximum of 18 byte overflow.  As the value printed is layer counter, it may not be possible to provide input image with that many layers.  Practical overflow may not be much longer than the overflow that happens in the non-malicious case mentioned above.  Older ImageMagick versions have this format string instead "L%02ld", so it does not always overflow, it only starts to overflow with 100 layers.  Upstream commit: <http://trac.imagemagick.org/changeset/13736>   ```  [Comment 2](show_bug.cgi?id=1064098#c2)  Tomas Hoger    2014-02-12 10:07:17 UTC  ``` There is this suspicious commit: <http://trac.imagemagick.org/changeset/14801>  Even though no obvious link to RLE decoding mentioned in the Secunia advisory.   ```  [Comment 3](show_bug.cgi?id=1064098#c3)  Vincent Danen    2014-02-12 17:44:13 UTC  ``` This was assigned CVE-2014-1947:  <http://www.openwall.com/lists/oss-security/2014/02/12/13>   ```  [Comment 4](show_bug.cgi?id=1064098#c4)  Peter Hutterer    2014-02-13 04:08:27 UTC  ``` As noted in IRC, I believe what Murray found (second and third hunk) is a different issue. Tomas' commit identifies the patch mentioned in the Secunia advisory.  The fix is in the DecodePSDPixels function and looks RLE-related. RLE is a simple compression using pairs of bytes, first the number of elements, then the value for an element. A pair of [3, a] would produce "aaa" on decompression.  RLE can overflow at the pre-allocated target buffer if no size check for the uncompressed length of the current pair is performed. A simple example is allocating a buffer of size 4, then having a encoding pair of [3, a] and [256, b]. After writing 'aaa' the buffer still has room, so (current_index < buffer_length) is true and we decompress the next pair, writing 255 bytes beyond the buffer boundary. That's exactly what happens here.  In this code: compact_pixels is the set of RLE pairs, number_pixels is the length of the buffer. i is the current pixel index, pixel points to the current characters. Buffer overflow can happen when (i >= number_pixels - 256).  The patch fixed this by capping the length of the decompressed set to the remainder.  The other size checks are ok, so an exploit would only be able use one packet to write past the buffer boundary, and the byte values aren't completely arbitrary but somewhat limited by the format. How to exploit that requires more creativity than I have. Max overflow is 256 bytes.   ```  [Comment 5](show_bug.cgi?id=1064098#c5)  Vincent Danen    2014-02-13 23:03:39 UTC  ``` (In reply to Tomas Hoger from [comment #2](show_bug.cgi?id=1064098#c2)) > There is this suspicious commit: > <http://trac.imagemagick.org/changeset/14801> >  > Even though no obvious link to RLE decoding mentioned in the Secunia > advisory.  This commit was assigned [CVE-2014-1958](https://access.redhat.com/security/cve/CVE-2014-1958) as per:  <http://seclists.org/oss-sec/2014/q1/343>  This one is pretty messy.  It looks like there may be further discussion about this but we probably want to file a second bug for this CVE once it gets detangled a bit.   ```  [Comment 6](show_bug.cgi?id=1064098#c6)  Murray McAllister    2014-02-20 04:58:57 UTC  ``` quoting from MITRE in <http://www.openwall.com/lists/oss-security/2014/02/19/13>  "" The clarified meaning of [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) is now the vulnerability in older ImageMagick versions (such as 6.5.4) that use the "L%02ld" string. The root cause here is that the code did not cover the case of more than 99 layers, which is apparently allowable but relatively uncommon. This has a resultant buffer overflow, e.g, L99\0 is safe but L100\0 is unsafe. When the overflow occurs, it can be described as "1 or more bytes too many."  A new ID of [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) is now assigned for the vulnerability in newer ImageMagick versions that use the "L%06ld" string. The root cause here is that the code did not recognize the relationship between the 8 (or more) characters in "L%06ld" and the actual buffer size. This has a resultant buffer overflow of "4 or more bytes too many." ""   ```  [Comment 7](show_bug.cgi?id=1064098#c7)  Murray McAllister    2014-02-20 05:24:26 UTC  ```  Created ImageMagick tracking bugs for this issue:  Affects: fedora-all [[bug 1067278](show_bug.cgi?id=1067278 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick: buffer overflow when handling PSD images [fedora-all]")]   ```  [Comment 8](show_bug.cgi?id=1064098#c8)  Murray McAllister    2014-02-20 05:28:21 UTC  ``` (In reply to Vincent Danen from [comment #5](show_bug.cgi?id=1064098#c5)) > (In reply to Tomas Hoger from [comment #2](show_bug.cgi?id=1064098#c2)) > > There is this suspicious commit: > > <http://trac.imagemagick.org/changeset/14801> > >  > > Even though no obvious link to RLE decoding mentioned in the Secunia > > advisory. >  > This commit was assigned [CVE-2014-1958](https://access.redhat.com/security/cve/CVE-2014-1958) as per: >  > <http://seclists.org/oss-sec/2014/q1/343> >  > This one is pretty messy.  It looks like there may be further discussion > about this but we probably want to file a second bug for this CVE once it > gets detangled a bit.  Filed [https://bugzilla.redhat.com/show_bug.cgi?id=1067276](show_bug.cgi?id=1067276 "CLOSED NOTABUG - CVE-2014-1958 ImageMagick: buffer overflow flaw when handling PSD images that use RLE encoding")   ```  [Comment 9](show_bug.cgi?id=1064098#c9)  Pavel Alexeev    2014-03-04 13:26:19 UTC  ``` Citing upstream author from upstream bug report ( <http://www.imagemagick.org/discourse-server/viewtopic.php?f=3&t=25128> ): "However, we're not sure about [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030). They say "new ID of [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) is now assigned for the vulnerability in newer ImageMagick versions that use the "L%06ld" string. The root cause here is that the code did not recognize the relationship between the 8 (or more) characters in "L%06ld" and the actual buffer size." Since the layer_name buffer is now 4096 characters, whereas the maximum label size is 21 characters (i.e. L-9223372036854775808 @ 64-bit). So we're not sure why 2030 is filed as a vulnerability."  Could someone answer it?   ```  [Comment 10](show_bug.cgi?id=1064098#c10)  Tomas Hoger    2014-03-04 16:37:27 UTC  ``` Both CVEs here are for ImageMagick versions before changeset 13736.  [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) is for versions that use format string "L%02ld".  The layer_name there is layer_name[4] so overflow only occurs if there are more than 99 layers.  Format was changed from "L%02ld" to "L%06ld" in r1448: <http://trac.imagemagick.org/changeset/1448>  [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) is applicable to ImageMagick versions after the above r1448, where layer_name is still layer_name[4], but overflow occurs even with a single (unnamed) layer.  Fixed in r13736 that made layer_name large enough: <http://trac.imagemagick.org/changeset/13736>  r13736 is fix for both CVEs, but anyone shipping pre-r1448 IM versions should use [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) in released updates instead of [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030).   ```  [Comment 11](show_bug.cgi?id=1064098#c11)  Pavel Alexeev    2014-03-07 08:58:46 UTC  ``` So, we can then just update it to last version and constatate what all three CVE fixed? Right?   ```  [Comment 13](show_bug.cgi?id=1064098#c13)  Stefan Cornelius    2014-04-01 12:22:35 UTC  ``` [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) also affects GraphicMagic. Although there are small differences, the root cause is identical and overall the code is similar enough to certain ImageMagick versions to reuse [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947). In GraphicsMagick, the buffer overflow is caught by the fortify source buffer overflow protection.   ```  [Comment 15](show_bug.cgi?id=1064098#c15)  Stefan Cornelius    2014-04-01 12:57:01 UTC  ```  Created GraphicsMagick tracking bugs for this issue:  Affects: fedora-all [[bug 1083082](show_bug.cgi?id=1083082 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [fedora-all]")] Affects: epel-5 [[bug 1083083](show_bug.cgi?id=1083083 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [epel-5]")] Affects: epel-6 [[bug 1083084](show_bug.cgi?id=1083084 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [epel-6]")]   ```  [Comment 16](show_bug.cgi?id=1064098#c16)  Stefan Cornelius    2014-04-01 12:59:41 UTC  ``` (In reply to Pavel Alexeev (aka Pahan-Hubbitus) from [comment #11](show_bug.cgi?id=1064098#c11)) > So, we can then just update it to last version and constatate what all three > CVE fixed? Right?  Yes, the latest version should fix all issues.   ```  [Comment 18](show_bug.cgi?id=1064098#c18)  Tomas Hoger    2014-04-04 13:40:02 UTC  ``` As [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) and [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) affect different versions, tracking of [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) was split to a separate [bug 1083477](show_bug.cgi?id=1083477 "CLOSED NOTABUG - CVE-2014-2030 ImageMagick: PSD writing layer name buffer overflow (\"L%06ld\")").   ```  [Comment 19](show_bug.cgi?id=1064098#c19)  Fedora Update System    2014-04-15 15:38:00 UTC  ``` ImageMagick-6.8.6.3-4.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 20](show_bug.cgi?id=1064098#c20)  Rex Dieter    2014-08-20 14:41:18 UTC  ``` Here's what I'm using for GraphicsMagick, adapting a similar fix (I think): <http://pkgs.fedoraproject.org/cgit/GraphicsMagick.git/tree/GraphicsMagick-1.3.20-CVE-2014-1947.patch>  diff -up GraphicsMagick-1.3.20/coders/psd.c.[CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) GraphicsMagick-1.3.20/coders/psd.c --- GraphicsMagick-1.3.20/coders/psd.c.[CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947)	2014-08-16 15:33:23.000000000 -0500 +++ GraphicsMagick-1.3.20/coders/psd.c	2014-08-20 07:30:08.767862041 -0500 @@ -1719,8 +1719,7 @@ static unsigned int WritePSDImage(const      i;      unsigned char -    *pixels, -    layer_name[4]; +    *pixels;      unsigned int      packet_size, @@ -1944,8 +1943,9 @@ static unsigned int WritePSDImage(const              (void) WriteBlob(image, 3, &layer_name[1]);            */           } else { -          (void) sprintf((char *) layer_name, "L%02d", layer_count++ ); -          WritePascalString( image, (char*)layer_name, 4 ); +          char layer_name[4]; +          (void) sprintf(layer_name, "L%02d", layer_count++ ); +          WritePascalString( image, layer_name, 4 );          }          tmp_image = tmp_image->next;        };   ```  [Comment 21](show_bug.cgi?id=1064098#c21)  Tomas Hoger    2014-08-25 09:50:40 UTC  ``` (In reply to Rex Dieter from [comment #20](show_bug.cgi?id=1064098#c20)) > Here's what I'm using for GraphicsMagick  What is the change supposed to do?  It does not increase the size of layer_name, so more than 99 layers should still lead to overflow as described in [comment 10](show_bug.cgi?id=1064098#c10).   ```  [Comment 22](show_bug.cgi?id=1064098#c22)  Rex Dieter    2014-08-25 18:48:27 UTC  ``` Oh, indeed, I'd naively thought the main fix was adjusting to a char array (and avoiding the cast).  Does this look better?  --- GraphicsMagick-1.3.20/coders/psd.c.[CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947)    2014-08-16 15:33:23.000000000 -0500 +++ GraphicsMagick-1.3.20/coders/psd.c  2014-08-20 07:30:08.767862041 -0500 @@ -1719,8 +1719,7 @@ static unsigned int WritePSDImage(const      i;      unsigned char -    *pixels, -    layer_name[4]; +    *pixels;      unsigned int      packet_size, @@ -1944,8 +1943,9 @@ static unsigned int WritePSDImage(const              (void) WriteBlob(image, 3, &layer_name[1]);            */           } else { -          (void) sprintf((char *) layer_name, "L%02d", layer_count++ ); -          WritePascalString( image, (char*)layer_name, 4 ); +          char layer_name[MaxTextExtent]; +          (void) sprintf(layer_name, "L%06ld", layer_count++ ); +          WritePascalString( image, layer_name, 4 );          }          tmp_image = tmp_image->next;        };   ```  [Comment 23](show_bug.cgi?id=1064098#c23)  Tomas Hoger    2014-08-25 19:31:23 UTC  ``` (In reply to Rex Dieter from [comment #22](show_bug.cgi?id=1064098#c22)) > Oh, indeed, I'd naively thought the main fix was adjusting to a char array > (and avoiding the cast).  Does this look better?  I haven't looked at GM specifically.  In IM, MaxTextExtent is large enough to hold layer name, regardless of whether L%02d or L%06ld format is used.   ```  [Comment 24](show_bug.cgi?id=1064098#c24)  Rex Dieter    2014-08-28 12:51:53 UTC  ``` OK, not being intimately familiar with this code either, I'm going back to the original L%02d format variant.  It would appear GM upstream may not be aware of this... I'll try to make some time soon to poke them about it too.   ```  [Comment 25](show_bug.cgi?id=1064098#c25)  Fedora Update System    2014-08-28 15:34:29 UTC  ``` GraphicsMagick-1.3.20-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 26](show_bug.cgi?id=1064098#c26)  Rex Dieter    2014-08-28 15:52:20 UTC  ``` This looks like a match, <http://sourceforge.net/p/graphicsmagick/bugs/234/> added a comment there, and they responded to me already with some questions.   ```  [Comment 27](show_bug.cgi?id=1064098#c27)  Bob Friesenhahn    2014-08-29 03:47:12 UTC  ``` I just pushed GraphicsMagick changeset 14139:a083f9eeef1d with a patch which is mostly similar to Rex Dieter's patch.  It seems doubtful that this issue is covered by any existing GraphicsMagick bug report.  The PSD code in GraphicsMagick has many unresolved issues.   ```  [Comment 28](show_bug.cgi?id=1064098#c28)  Fedora Update System    2014-09-09 22:15:43 UTC  ``` GraphicsMagick-1.3.20-3.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 29](show_bug.cgi?id=1064098#c29)  Fedora Update System    2014-09-14 03:27:04 UTC  ``` GraphicsMagick-1.3.20-3.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 30](show_bug.cgi?id=1064098#c30)  Fedora Update System    2014-09-18 23:50:39 UTC  ``` GraphicsMagick-1.3.20-3.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 31](show_bug.cgi?id=1064098#c31)  Fedora Update System    2014-09-18 23:51:04 UTC  ``` GraphicsMagick-1.3.20-3.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 32](show_bug.cgi?id=1064098#c32)  Fedora Update System    2014-11-14 12:08:25 UTC  ``` GraphicsMagick-1.3.20-3.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1064098&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_55c1c59c_20250126_085742.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_cf038f88_20250126_085730.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1064098)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1064098)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1064098)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1064098

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1064098**](show_bug.cgi?id=1064098)
(CVE-2014-1947)
- [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) ImageMagick: PSD writing layer name buffer overflow ("L%02ld")

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-1947 ImageMagick: PSD writing layer name buffer overflow ("L%02ld")

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-1947 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1083082](show_bug.cgi?id=1083082 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [fedora-all]") [1083083](show_bug.cgi?id=1083083 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [epel-5]") [1083084](show_bug.cgi?id=1083084 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [epel-6]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1064101](show_bug.cgi?id=1064101) | | TreeView+ | [depends on](buglist.cgi?bug_id=1064098&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1064098&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2014-02-12 02:30 UTC by Murray McAllister | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:13 UTC ([History](show_activity.cgi?id=1064098)) | | [CC List:](page.cgi?id=fields.html#cclist) | 12 users (show)  bfriesen bleanhar carnil ccoleman dmcphers jialiu jkurik lmeyer nmurray pahan peter.hutterer rdieter | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-08 02:31:35 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1064098#c0)  Murray McAllister    2014-02-12 02:30:11 UTC  ``` A buffer overflow flaw affecting ImageMagick versions prior to 6.8.8-5 when handling PSD images was reported:  <http://secunia.com/advisories/56844/>  Diffing ImageMagick-6.8.7/coders/psd.c and ImageMagick-6.8.8/coders/psd.c, it looks like the flaw may be FormatLocaleString() writing the amount of 6 long integers (approximately 48 bytes) into a buffer (layer_name) that is only 4 bytes:  "" @@ -1224,7 +1224,7 @@                Allocate layered image.              */              layer_info[i].image=CloneImage(image,layer_info[i].page.width, -              layer_info[i].page.height == ~0U ? 1 : layer_info[i].page.height, +              layer_info[i].page.height == ~0UL ? 1 : layer_info[i].page.height,                MagickFalse,&image->exception);              if (layer_info[i].image == (Image *) NULL)                { @@ -2112,9 +2112,6 @@    StringInfo      *bim_profile;   -  unsigned char -    layer_name[4]; -    /*      Open image file.    */ @@ -2372,12 +2369,15 @@          property=(const char *) GetImageProperty(next_image,"label");          if (property == (const char *) NULL)            { +            char +              layer_name[MaxTextExtent]; +              (void) WriteBlobMSBLong(image,16);              (void) WriteBlobMSBLong(image,0);              (void) WriteBlobMSBLong(image,0); -            (void) FormatLocaleString((char *) layer_name,MaxTextExtent, -              "L%06ld",(long) layer_count++); -            WritePascalString( image, (char*)layer_name, 4 ); +            (void) FormatLocaleString(layer_name,MaxTextExtent,"L%06ld",(long) +              layer_count++); +            WritePascalString(image,layer_name,4);            }          else            {  ""  CVE request: <http://www.openwall.com/lists/oss-security/2014/02/12/2>   ```  [Comment 1](show_bug.cgi?id=1064098#c1)  Tomas Hoger    2014-02-12 10:02:33 UTC  ``` (In reply to Murray McAllister from [comment #0](show_bug.cgi?id=1064098#c0)) > Diffing ImageMagick-6.8.7/coders/psd.c and ImageMagick-6.8.8/coders/psd.c, > it looks like the flaw may be FormatLocaleString() writing the amount of 6 > long integers (approximately 48 bytes) into a buffer (layer_name) that is > only 4 bytes:  It's writing less than those mentioned 48 bytes.  It's writing a long integer in a way that at least 6 digits are always printed, prefixed with zeros if needed (e.g. L000001, L000123, or L1234567).  Adding space for 'L' and terminating '\0', that implies there is at least 4 byte buffer overflow whenever that code is reached.  Depending on actual memory layout, this may only clobber other local variables in WritePSDImage().  The maximum overflow is architecture dependent.  It seems the maximum number of digits is written if layer_count is LONG_MIN, resulting in layer_name being L-2147483648 (32bit) or L-9223372036854775808 (64bit), yielding the maximum of 18 byte overflow.  As the value printed is layer counter, it may not be possible to provide input image with that many layers.  Practical overflow may not be much longer than the overflow that happens in the non-malicious case mentioned above.  Older ImageMagick versions have this format string instead "L%02ld", so it does not always overflow, it only starts to overflow with 100 layers.  Upstream commit: <http://trac.imagemagick.org/changeset/13736>   ```  [Comment 2](show_bug.cgi?id=1064098#c2)  Tomas Hoger    2014-02-12 10:07:17 UTC  ``` There is this suspicious commit: <http://trac.imagemagick.org/changeset/14801>  Even though no obvious link to RLE decoding mentioned in the Secunia advisory.   ```  [Comment 3](show_bug.cgi?id=1064098#c3)  Vincent Danen    2014-02-12 17:44:13 UTC  ``` This was assigned CVE-2014-1947:  <http://www.openwall.com/lists/oss-security/2014/02/12/13>   ```  [Comment 4](show_bug.cgi?id=1064098#c4)  Peter Hutterer    2014-02-13 04:08:27 UTC  ``` As noted in IRC, I believe what Murray found (second and third hunk) is a different issue. Tomas' commit identifies the patch mentioned in the Secunia advisory.  The fix is in the DecodePSDPixels function and looks RLE-related. RLE is a simple compression using pairs of bytes, first the number of elements, then the value for an element. A pair of [3, a] would produce "aaa" on decompression.  RLE can overflow at the pre-allocated target buffer if no size check for the uncompressed length of the current pair is performed. A simple example is allocating a buffer of size 4, then having a encoding pair of [3, a] and [256, b]. After writing 'aaa' the buffer still has room, so (current_index < buffer_length) is true and we decompress the next pair, writing 255 bytes beyond the buffer boundary. That's exactly what happens here.  In this code: compact_pixels is the set of RLE pairs, number_pixels is the length of the buffer. i is the current pixel index, pixel points to the current characters. Buffer overflow can happen when (i >= number_pixels - 256).  The patch fixed this by capping the length of the decompressed set to the remainder.  The other size checks are ok, so an exploit would only be able use one packet to write past the buffer boundary, and the byte values aren't completely arbitrary but somewhat limited by the format. How to exploit that requires more creativity than I have. Max overflow is 256 bytes.   ```  [Comment 5](show_bug.cgi?id=1064098#c5)  Vincent Danen    2014-02-13 23:03:39 UTC  ``` (In reply to Tomas Hoger from [comment #2](show_bug.cgi?id=1064098#c2)) > There is this suspicious commit: > <http://trac.imagemagick.org/changeset/14801> >  > Even though no obvious link to RLE decoding mentioned in the Secunia > advisory.  This commit was assigned [CVE-2014-1958](https://access.redhat.com/security/cve/CVE-2014-1958) as per:  <http://seclists.org/oss-sec/2014/q1/343>  This one is pretty messy.  It looks like there may be further discussion about this but we probably want to file a second bug for this CVE once it gets detangled a bit.   ```  [Comment 6](show_bug.cgi?id=1064098#c6)  Murray McAllister    2014-02-20 04:58:57 UTC  ``` quoting from MITRE in <http://www.openwall.com/lists/oss-security/2014/02/19/13>  "" The clarified meaning of [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) is now the vulnerability in older ImageMagick versions (such as 6.5.4) that use the "L%02ld" string. The root cause here is that the code did not cover the case of more than 99 layers, which is apparently allowable but relatively uncommon. This has a resultant buffer overflow, e.g, L99\0 is safe but L100\0 is unsafe. When the overflow occurs, it can be described as "1 or more bytes too many."  A new ID of [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) is now assigned for the vulnerability in newer ImageMagick versions that use the "L%06ld" string. The root cause here is that the code did not recognize the relationship between the 8 (or more) characters in "L%06ld" and the actual buffer size. This has a resultant buffer overflow of "4 or more bytes too many." ""   ```  [Comment 7](show_bug.cgi?id=1064098#c7)  Murray McAllister    2014-02-20 05:24:26 UTC  ```  Created ImageMagick tracking bugs for this issue:  Affects: fedora-all [[bug 1067278](show_bug.cgi?id=1067278 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick: buffer overflow when handling PSD images [fedora-all]")]   ```  [Comment 8](show_bug.cgi?id=1064098#c8)  Murray McAllister    2014-02-20 05:28:21 UTC  ``` (In reply to Vincent Danen from [comment #5](show_bug.cgi?id=1064098#c5)) > (In reply to Tomas Hoger from [comment #2](show_bug.cgi?id=1064098#c2)) > > There is this suspicious commit: > > <http://trac.imagemagick.org/changeset/14801> > >  > > Even though no obvious link to RLE decoding mentioned in the Secunia > > advisory. >  > This commit was assigned [CVE-2014-1958](https://access.redhat.com/security/cve/CVE-2014-1958) as per: >  > <http://seclists.org/oss-sec/2014/q1/343> >  > This one is pretty messy.  It looks like there may be further discussion > about this but we probably want to file a second bug for this CVE once it > gets detangled a bit.  Filed [https://bugzilla.redhat.com/show_bug.cgi?id=1067276](show_bug.cgi?id=1067276 "CLOSED NOTABUG - CVE-2014-1958 ImageMagick: buffer overflow flaw when handling PSD images that use RLE encoding")   ```  [Comment 9](show_bug.cgi?id=1064098#c9)  Pavel Alexeev    2014-03-04 13:26:19 UTC  ``` Citing upstream author from upstream bug report ( <http://www.imagemagick.org/discourse-server/viewtopic.php?f=3&t=25128> ): "However, we're not sure about [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030). They say "new ID of [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) is now assigned for the vulnerability in newer ImageMagick versions that use the "L%06ld" string. The root cause here is that the code did not recognize the relationship between the 8 (or more) characters in "L%06ld" and the actual buffer size." Since the layer_name buffer is now 4096 characters, whereas the maximum label size is 21 characters (i.e. L-9223372036854775808 @ 64-bit). So we're not sure why 2030 is filed as a vulnerability."  Could someone answer it?   ```  [Comment 10](show_bug.cgi?id=1064098#c10)  Tomas Hoger    2014-03-04 16:37:27 UTC  ``` Both CVEs here are for ImageMagick versions before changeset 13736.  [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) is for versions that use format string "L%02ld".  The layer_name there is layer_name[4] so overflow only occurs if there are more than 99 layers.  Format was changed from "L%02ld" to "L%06ld" in r1448: <http://trac.imagemagick.org/changeset/1448>  [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) is applicable to ImageMagick versions after the above r1448, where layer_name is still layer_name[4], but overflow occurs even with a single (unnamed) layer.  Fixed in r13736 that made layer_name large enough: <http://trac.imagemagick.org/changeset/13736>  r13736 is fix for both CVEs, but anyone shipping pre-r1448 IM versions should use [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) in released updates instead of [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030).   ```  [Comment 11](show_bug.cgi?id=1064098#c11)  Pavel Alexeev    2014-03-07 08:58:46 UTC  ``` So, we can then just update it to last version and constatate what all three CVE fixed? Right?   ```  [Comment 13](show_bug.cgi?id=1064098#c13)  Stefan Cornelius    2014-04-01 12:22:35 UTC  ``` [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) also affects GraphicMagic. Although there are small differences, the root cause is identical and overall the code is similar enough to certain ImageMagick versions to reuse [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947). In GraphicsMagick, the buffer overflow is caught by the fortify source buffer overflow protection.   ```  [Comment 15](show_bug.cgi?id=1064098#c15)  Stefan Cornelius    2014-04-01 12:57:01 UTC  ```  Created GraphicsMagick tracking bugs for this issue:  Affects: fedora-all [[bug 1083082](show_bug.cgi?id=1083082 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [fedora-all]")] Affects: epel-5 [[bug 1083083](show_bug.cgi?id=1083083 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [epel-5]")] Affects: epel-6 [[bug 1083084](show_bug.cgi?id=1083084 "CLOSED ERRATA - CVE-2014-1947 CVE-2014-2030 ImageMagick, GraphicsMagick: buffer overflow when handling PSD images [epel-6]")]   ```  [Comment 16](show_bug.cgi?id=1064098#c16)  Stefan Cornelius    2014-04-01 12:59:41 UTC  ``` (In reply to Pavel Alexeev (aka Pahan-Hubbitus) from [comment #11](show_bug.cgi?id=1064098#c11)) > So, we can then just update it to last version and constatate what all three > CVE fixed? Right?  Yes, the latest version should fix all issues.   ```  [Comment 18](show_bug.cgi?id=1064098#c18)  Tomas Hoger    2014-04-04 13:40:02 UTC  ``` As [CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) and [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) affect different versions, tracking of [CVE-2014-2030](https://access.redhat.com/security/cve/CVE-2014-2030) was split to a separate [bug 1083477](show_bug.cgi?id=1083477 "CLOSED NOTABUG - CVE-2014-2030 ImageMagick: PSD writing layer name buffer overflow (\"L%06ld\")").   ```  [Comment 19](show_bug.cgi?id=1064098#c19)  Fedora Update System    2014-04-15 15:38:00 UTC  ``` ImageMagick-6.8.6.3-4.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 20](show_bug.cgi?id=1064098#c20)  Rex Dieter    2014-08-20 14:41:18 UTC  ``` Here's what I'm using for GraphicsMagick, adapting a similar fix (I think): <http://pkgs.fedoraproject.org/cgit/GraphicsMagick.git/tree/GraphicsMagick-1.3.20-CVE-2014-1947.patch>  diff -up GraphicsMagick-1.3.20/coders/psd.c.[CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947) GraphicsMagick-1.3.20/coders/psd.c --- GraphicsMagick-1.3.20/coders/psd.c.[CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947)	2014-08-16 15:33:23.000000000 -0500 +++ GraphicsMagick-1.3.20/coders/psd.c	2014-08-20 07:30:08.767862041 -0500 @@ -1719,8 +1719,7 @@ static unsigned int WritePSDImage(const      i;      unsigned char -    *pixels, -    layer_name[4]; +    *pixels;      unsigned int      packet_size, @@ -1944,8 +1943,9 @@ static unsigned int WritePSDImage(const              (void) WriteBlob(image, 3, &layer_name[1]);            */           } else { -          (void) sprintf((char *) layer_name, "L%02d", layer_count++ ); -          WritePascalString( image, (char*)layer_name, 4 ); +          char layer_name[4]; +          (void) sprintf(layer_name, "L%02d", layer_count++ ); +          WritePascalString( image, layer_name, 4 );          }          tmp_image = tmp_image->next;        };   ```  [Comment 21](show_bug.cgi?id=1064098#c21)  Tomas Hoger    2014-08-25 09:50:40 UTC  ``` (In reply to Rex Dieter from [comment #20](show_bug.cgi?id=1064098#c20)) > Here's what I'm using for GraphicsMagick  What is the change supposed to do?  It does not increase the size of layer_name, so more than 99 layers should still lead to overflow as described in [comment 10](show_bug.cgi?id=1064098#c10).   ```  [Comment 22](show_bug.cgi?id=1064098#c22)  Rex Dieter    2014-08-25 18:48:27 UTC  ``` Oh, indeed, I'd naively thought the main fix was adjusting to a char array (and avoiding the cast).  Does this look better?  --- GraphicsMagick-1.3.20/coders/psd.c.[CVE-2014-1947](https://access.redhat.com/security/cve/CVE-2014-1947)    2014-08-16 15:33:23.000000000 -0500 +++ GraphicsMagick-1.3.20/coders/psd.c  2014-08-20 07:30:08.767862041 -0500 @@ -1719,8 +1719,7 @@ static unsigned int WritePSDImage(const      i;      unsigned char -    *pixels, -    layer_name[4]; +    *pixels;      unsigned int      packet_size, @@ -1944,8 +1943,9 @@ static unsigned int WritePSDImage(const              (void) WriteBlob(image, 3, &layer_name[1]);            */           } else { -          (void) sprintf((char *) layer_name, "L%02d", layer_count++ ); -          WritePascalString( image, (char*)layer_name, 4 ); +          char layer_name[MaxTextExtent]; +          (void) sprintf(layer_name, "L%06ld", layer_count++ ); +          WritePascalString( image, layer_name, 4 );          }          tmp_image = tmp_image->next;        };   ```  [Comment 23](show_bug.cgi?id=1064098#c23)  Tomas Hoger    2014-08-25 19:31:23 UTC  ``` (In reply to Rex Dieter from [comment #22](show_bug.cgi?id=1064098#c22)) > Oh, indeed, I'd naively thought the main fix was adjusting to a char array > (and avoiding the cast).  Does this look better?  I haven't looked at GM specifically.  In IM, MaxTextExtent is large enough to hold layer name, regardless of whether L%02d or L%06ld format is used.   ```  [Comment 24](show_bug.cgi?id=1064098#c24)  Rex Dieter    2014-08-28 12:51:53 UTC  ``` OK, not being intimately familiar with this code either, I'm going back to the original L%02d format variant.  It would appear GM upstream may not be aware of this... I'll try to make some time soon to poke them about it too.   ```  [Comment 25](show_bug.cgi?id=1064098#c25)  Fedora Update System    2014-08-28 15:34:29 UTC  ``` GraphicsMagick-1.3.20-1.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 26](show_bug.cgi?id=1064098#c26)  Rex Dieter    2014-08-28 15:52:20 UTC  ``` This looks like a match, <http://sourceforge.net/p/graphicsmagick/bugs/234/> added a comment there, and they responded to me already with some questions.   ```  [Comment 27](show_bug.cgi?id=1064098#c27)  Bob Friesenhahn    2014-08-29 03:47:12 UTC  ``` I just pushed GraphicsMagick changeset 14139:a083f9eeef1d with a patch which is mostly similar to Rex Dieter's patch.  It seems doubtful that this issue is covered by any existing GraphicsMagick bug report.  The PSD code in GraphicsMagick has many unresolved issues.   ```  [Comment 28](show_bug.cgi?id=1064098#c28)  Fedora Update System    2014-09-09 22:15:43 UTC  ``` GraphicsMagick-1.3.20-3.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 29](show_bug.cgi?id=1064098#c29)  Fedora Update System    2014-09-14 03:27:04 UTC  ``` GraphicsMagick-1.3.20-3.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 30](show_bug.cgi?id=1064098#c30)  Fedora Update System    2014-09-18 23:50:39 UTC  ``` GraphicsMagick-1.3.20-3.el5 has been pushed to the Fedora EPEL 5 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 31](show_bug.cgi?id=1064098#c31)  Fedora Update System    2014-09-18 23:51:04 UTC  ``` GraphicsMagick-1.3.20-3.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 32](show_bug.cgi?id=1064098#c32)  Fedora Update System    2014-11-14 12:08:25 UTC  ``` GraphicsMagick-1.3.20-3.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1064098&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


