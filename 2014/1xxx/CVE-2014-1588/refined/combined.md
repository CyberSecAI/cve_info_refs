=== Content from bugzilla.mozilla.org_9a229935_20250125_020545.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1037830)
* [XML](/show_bug.cgi?ctype=xml&id=1037830)

Closed
[Bug 1037830](/show_bug.cgi?id=1037830)

Opened 11 years ago
Closed 10 years ago

# GMP encoder trusts plugin's length report

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

GMP encoder trusts plugin's length report

## Categories

### (Core :: WebRTC: Audio/Video, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo#WebRTC%3A%20Audio%2FVideo)

WebRTC: Audio/Video
▾

Core :: WebRTC: Audio/Video
Bugs in WebRTC audio and video capture, handling, echo cancellation, encoding, and playback
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla34

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=unaffected) |
| firefox33 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix) |
| firefox34 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) |
| firefox-esr24 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr24&o1=equals&v1=unaffected) |
| firefox-esr31 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected) |
| b2g-v1.3 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_3&o1=equals&v1=unaffected) |
| b2g-v1.3T | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_3t&o1=equals&v1=unaffected) |
| b2g-v1.4 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected) |
| b2g-v2.0 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) |
| b2g-v2.1 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 |  | unaffected |
| firefox33 |  | wontfix |
| firefox34 |  | fixed |
| firefox-esr24 |  | unaffected |
| firefox-esr31 |  | unaffected |
| b2g-v1.3 |  | unaffected |
| b2g-v1.3T |  | unaffected |
| b2g-v1.4 |  | unaffected |
| b2g-v2.0 |  | unaffected |
| b2g-v2.1 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ekr, Assigned: jesup)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/f3b5a842a3ef240e7ba5b3efab681531?d=mm&size=40)  [ekr](/user_profile?user_id=35667)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/9362a14d9b87a3935eb16cfc834ed51f?d=mm&size=40)  [jib](/user_profile?user_id=456498)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-high, Whiteboard: [adv-main34+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main34+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c17 "10 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 2 obsolete files)

| [Enforce size limit on returned encoded data from GMP plugins for webrtc](/attachment.cgi?id=8454908)  [11 years ago](#c1)  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)   4.17 KB, patch |  | [Details](/attachment.cgi?id=8454908&action=edit) | [Diff](/attachment.cgi?id=8454908&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8454908) |
| --- | --- | --- |
| [Enforce size limit on returned encoded data from GMP plugins for webrtc](/attachment.cgi?id=8454921)  [11 years ago](#c3)  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)   4.67 KB, patch | cpearce : [feedback+](#a114504_287422 "11 years ago") | [Details](/attachment.cgi?id=8454921&action=edit) | [Diff](/attachment.cgi?id=8454921&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8454921) |
| [Enforce size limit on returned encoded data from GMP plugins for webrtc](/attachment.cgi?id=8459703)  [11 years ago](#c10)  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)   4.72 KB, patch | ekr : [review+](#c14 "11 years ago") | [Details](/attachment.cgi?id=8459703&action=edit) | [Diff](/attachment.cgi?id=8459703&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8459703) |
| [Enforce size limit on returned encoded data from GMP plugins for webrtc (unbitrotted)](/attachment.cgi?id=8466620)  [10 years ago](#c15)  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)   3.99 KB, patch |  | [Details](/attachment.cgi?id=8466620&action=edit) | [Diff](/attachment.cgi?id=8466620&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8466620) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1037830#c0)• 11 years ago |
|  | |

The following code processes encoded video data coming from the GMP plugin.
<http://dxr.mozilla.org/mozilla-central/source/media/webrtc/signaling/src/media-conduit/WebrtcGmpVideoCodec.cpp#348>
It reads the buffer length out of the packet at, for instance:
<http://dxr.mozilla.org/mozilla-central/source/media/webrtc/signaling/src/media-conduit/WebrtcGmpVideoCodec.cpp#406>
However, it does not check the buffer length and therefore a bogus size will
cause a read past the end of the buffer. We should be protecting against a misbehaving plugin here.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a1497_11539)• 11 years ago |

Assignee: nobody → rjesup

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1037830#c1)• 11 years ago |
|  | |

Attached patch

[Enforce size limit on returned encoded data from GMP plugins for webrtc](attachment.cgi?id=8454908&action=diff) (obsolete)
— [Details](attachment.cgi?id=8454908&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8454908)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a4833_11539)• 11 years ago |

[Attachment #8454908](/attachment.cgi?id=8454908&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Flags: review?(ekr)

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1037830#c2)• 11 years ago |
|  | |

Comment on [attachment 8454908](/attachment.cgi?id=8454908 "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[details]](/attachment.cgi?id=8454908&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[diff]](/attachment.cgi?id=8454908&action=diff "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8454908)
Enforce size limit on returned encoded data from GMP plugins for webrtc
Review of [attachment 8454908](/attachment.cgi?id=8454908 "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[details]](/attachment.cgi?id=8454908&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[diff]](/attachment.cgi?id=8454908&action=diff "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8454908):
-----------------------------------------------------------------
Jesup,
If this is really what you want, I will r+ it, but I would suggest cleaning up
the below. I believe it does fix the proximal problem.
::: media/webrtc/signaling/src/media-conduit/WebrtcGmpVideoCodec.cpp
@@ +352,5 @@
> + size\_bytes = 4;
> + break;
> + default:
> + // really that it's not in the enum; gives more readable error
> + MOZ\_ASSERT(aEncodedFrame->BufferType() != GMP\_BufferSingle);
Do we actually want an assert here? This would mean that plugin misbehavior crashes FFOX in debug, right?
@@ +361,3 @@
> uint32\_t size;
> + // make sure we don't read past the end of the buffer getting the size
> + while (buffer+size\_bytes < end) {
This seems like it fails to report plugin errors where the remainder is < size\_bytes. Wouldn't that be more helpful?
@@ +391,5 @@
> + }
> + if (buffer+size > end) {
> + LOG(PR\_LOG\_ERROR,
> + ("GMP plugin returned badly formatted encoded data: end is %d bytes past buffer end",
> + buffer+size - end));
/Is %d really what we want for ptrdiff\_t
[Attachment #8454908](/attachment.cgi?id=8454908&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Flags: review?(ekr)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1037830#c3)• 11 years ago |
|  | |

Attached patch

[Enforce size limit on returned encoded data from GMP plugins for webrtc](attachment.cgi?id=8454921&action=diff) (obsolete)
— [Details](attachment.cgi?id=8454921&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8454921)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a11090_11539)• 11 years ago |

[Attachment #8454908](/attachment.cgi?id=8454908&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Attachment is obsolete: true

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1037830#c4)• 11 years ago |
|  | |

Comment on [attachment 8454921](/attachment.cgi?id=8454921 "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[details]](/attachment.cgi?id=8454921&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[diff]](/attachment.cgi?id=8454921&action=diff "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8454921)
Enforce size limit on returned encoded data from GMP plugins for webrtc
Updated. Left the MOZ\_ASSERT on bad type in DEBUG builds in on purpose.
f? to cpearce on that issue.
[Attachment #8454921](/attachment.cgi?id=8454921&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Flags: review?(ekr)
[Attachment #8454921](/attachment.cgi?id=8454921&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Flags: feedback?(cpearce)

|  | [Chris Pearce [:cpearce (Not reading bugmail)]](/user_profile?user_id=287422) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1037830#c5)• 11 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #4](/show_bug.cgi?id=1037830#c4 "RESOLVED FIXED - GMP encoder trusts plugin's length report"))
> Comment on [attachment 8454921](/attachment.cgi?id=8454921 "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[details]](/attachment.cgi?id=8454921&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[diff]](/attachment.cgi?id=8454921&action=diff "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8454921)
> Enforce size limit on returned encoded data from GMP plugins for webrtc
>
> Updated. Left the MOZ\_ASSERT on bad type in DEBUG builds in on purpose.
>
> f? to cpearce on that issue.
Making mistakes more visible in debug builds sounds like a good thing to me.

|  | [Chris Pearce [:cpearce (Not reading bugmail)]](/user_profile?user_id=287422) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a114504_287422)• 11 years ago |

[Attachment #8454921](/attachment.cgi?id=8454921&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Flags: feedback?(cpearce) → feedback+

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1037830#c6)• 11 years ago |
|  | |

(In reply to Chris Pearce (:cpearce) from [comment #5](/show_bug.cgi?id=1037830#c5 "RESOLVED FIXED - GMP encoder trusts plugin's length report"))
> (In reply to Randell Jesup [:jesup] from [comment #4](/show_bug.cgi?id=1037830#c4 "RESOLVED FIXED - GMP encoder trusts plugin's length report"))
> > Comment on [attachment 8454921](/attachment.cgi?id=8454921 "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[details]](/attachment.cgi?id=8454921&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[diff]](/attachment.cgi?id=8454921&action=diff "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8454921)
> > Enforce size limit on returned encoded data from GMP plugins for webrtc
> >
> > Updated. Left the MOZ\_ASSERT on bad type in DEBUG builds in on purpose.
> >
> > f? to cpearce on that issue.
>
> Making mistakes more visible in debug builds sounds like a good thing to me.
My concern here is that defects in the plugin should not crash the browser.
The browser should kill the plugin here, perhaps...

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1037830#c7)• 11 years ago |
|  | |

This sounds like sec-moderate at worst to me, because it requires a misbehaving plugin. I assume we're not trying to protect against an arbitrary misbehaving plugin? Requiring a user to install a misbehaving plugin would mitigate it a bit to me.

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1037830#c8)• 11 years ago |
|  | |

(In reply to Andrew McCreight (Away July 17-24) [:mccr8] from [comment #7](/show_bug.cgi?id=1037830#c7 "RESOLVED FIXED - GMP encoder trusts plugin's length report"))
> This sounds like sec-moderate at worst to me, because it requires a
> misbehaving plugin. I assume we're not trying to protect against an
> arbitrary misbehaving plugin? Requiring a user to install a misbehaving
> plugin would mitigate it a bit to me.
We are trying to protect against plugin compromise which could lead to a
misbehaving plugin. Hence sandboxing the plugin.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1037830#c9)• 11 years ago |
|  | |

Ok, thanks. I guess I'll mark this sec-high.Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1037830#c10)• 11 years ago |
|  | |

Attached patch

[Enforce size limit on returned encoded data from GMP plugins for webrtc](attachment.cgi?id=8459703&action=diff)
— [Details](attachment.cgi?id=8459703&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8459703)

don't crash; look to improve this in an update of the GMP codec <-> users API RSN

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a788242_11539)• 11 years ago |

[Attachment #8454921](/attachment.cgi?id=8454921&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Attachment is obsolete: true
[Attachment #8454921](/attachment.cgi?id=8454921&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Flags: review?(ekr)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1037830#c11)• 11 years ago |
|  | |

Comment on [attachment 8459703](/attachment.cgi?id=8459703 "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[details]](/attachment.cgi?id=8459703&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[diff]](/attachment.cgi?id=8459703&action=diff "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8459703)
Enforce size limit on returned encoded data from GMP plugins for webrtc
We'll need uplift once this is on central
[Attachment #8459703](/attachment.cgi?id=8459703&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Flags: review?(ekr)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1037830#c12)• 11 years ago |
|  | |

pingFlags: needinfo?(ekr)

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1037830#c13)• 11 years ago |
|  | |

I'm at IETF. I should get to this this weekend. If you need it now, needinfo?joshFlags: needinfo?(ekr)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a1127778_406194)• 11 years ago |

[status-firefox32](/buglist.cgi?f1=cf_status_firefox32&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=unaffected)
[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)

|  | [Eric Rescorla (:ekr)](/user_profile?user_id=35667)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1037830#c14)• 11 years ago |
|  | |

Comment on [attachment 8459703](/attachment.cgi?id=8459703 "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[details]](/attachment.cgi?id=8459703&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[diff]](/attachment.cgi?id=8459703&action=diff "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8459703)
Enforce size limit on returned encoded data from GMP plugins for webrtc
Review of [attachment 8459703](/attachment.cgi?id=8459703 "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[details]](/attachment.cgi?id=8459703&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[diff]](/attachment.cgi?id=8459703&action=diff "Enforce size limit on returned encoded data from GMP plugins for webrtc") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8459703):
-----------------------------------------------------------------
r+ but IMO you should rewrite the length reading code to be a loop.
It would be less code and you wouldn't need to worry about unaligned
reads.
::: media/webrtc/signaling/src/media-conduit/WebrtcGmpVideoCodec.cpp
@@ +393,5 @@
> buffer += 4;
> break;
> default:
> + break; // already handled above
> + }
Wouldn't this code be cleaner with a loop incrementing
through size\_bytes?
size\_t size = 0;
for (size\_t i=0; i < size\_bytes; ++i) {
size\_t b = \*buffer;
size += b << (i \* 8);
++buffer;
}
@@ +395,5 @@
> default:
> + break; // already handled above
> + }
> + if (buffer+size > end) {
> + // XXX see above - should we kill the plugin for returning extra bytes? Probably
This comment is confusing. Unless I misunderstand you don't do that.
[Attachment #8459703](/attachment.cgi?id=8459703&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc") -
Flags: review?(ekr) → review+

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1037830#c15)• 10 years ago |
|  | |

Attached patch

[Enforce size limit on returned encoded data from GMP plugins for webrtc (unbitrotted)](attachment.cgi?id=8466620&action=diff)
— [Details](attachment.cgi?id=8466620&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1037830&attachment=8466620)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1037830#c16)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/0e7b30eb1a7c>Target Milestone: --- → mozilla34

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a1780014_11539)• 10 years ago |

[Attachment #8466620](/attachment.cgi?id=8466620&action=edit "Enforce size limit on returned encoded data from GMP plugins for webrtc (unbitrotted)") -
Attachment description: Enforce size limit on returned encoded data from GMP plugins for webrtc → Enforce size limit on returned encoded data from GMP plugins for webrtc (unbitrotted)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1037830#c17)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/0e7b30eb1a7c>Status: NEW → RESOLVEDClosed: 10 years ago
[status-b2g-v1.3](/buglist.cgi?f1=cf_status_b2g_1_3&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_3&o1=equals&v1=unaffected)
[status-b2g-v1.3T](/buglist.cgi?f1=cf_status_b2g_1_3t&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_3t&o1=equals&v1=unaffected)
[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)
[status-firefox-esr24](/buglist.cgi?f1=cf_status_firefox_esr24&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr24&o1=equals&v1=unaffected)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected)Flags: in-testsuite?Resolution: --- → FIXED

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1037830#c18)• 10 years ago |
|  | |

This should have gone through sec-approval since it affects 33 and 34.Whiteboard: [adv-main34+]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a20869222_75935)• 10 years ago |

[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix)

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a35999954_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1037830#a59904142_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1037830&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_f87795e6_20250125_020544.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1026037)
* [XML](/show_bug.cgi?ctype=xml&id=1026037)

Closed
[Bug 1026037](/show_bug.cgi?id=1026037)

Opened 11 years ago
Closed 10 years ago

# UAF of cc\_call\_info\_t\_

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

UAF of cc\_call\_info\_t\_

## Categories

### (Core :: WebRTC: Signaling, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC%3A%20Signaling#WebRTC%3A%20Signaling)

WebRTC: Signaling
▾

Core :: WebRTC: Signaling
Bugs in WebRTC call-setup and re-negotiation code, in particular JSEP and SDP handling
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Signaling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Signaling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC%3A%20Signaling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla34

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox33 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix) |
| firefox34 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) |
| firefox-esr31 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=wontfix) |
| b2g-v2.1 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox33 |  | wontfix |
| firefox34 |  | fixed |
| firefox-esr31 |  | wontfix |
| b2g-v2.1 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bwc, Assigned: bwc)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3e201149abea356acc9bb6f0eea8b5a0?d=mm&size=40)  [bwc](/user_profile?user_id=478411)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3e201149abea356acc9bb6f0eea8b5a0?d=mm&size=40)  [bwc](/user_profile?user_id=478411)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/059051e6b5d28b0b6540b2c81cb586e7?d=mm&size=40)  [ng](/user_profile?user_id=552932)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[991037](/show_bug.cgi?id=991037 "RESOLVED FIXED - WebRTC: ICE candidate gathering becomes complete before all candidates processed")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1026037&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1026037)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, sec-high, Whiteboard: [adv-main34+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main34+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [kjozwiak](/user_profile?user_id=455785) | [qe-verify](#c10 "10 years ago") | - |
| --- | --- | --- |
| [kjozwiak](/user_profile?user_id=455785) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1026037#c0)• 11 years ago |
|  | |

Just saw an ASAN crash on my linux box:
#0 0x786ada in strlib\_is\_string /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/src-common/string\_lib.c:330
#1 0x7869ec in strlib\_copy /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/src-common/string\_lib.c:95
#2 0x5b2908 in calllogger\_copy\_call\_log /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/call\_logger.c:33
#3 0x5d43c2 in getDeepCopyOfSessionData /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccprovider.c:1078
#4 0x5bae87 in CCAPI\_Call\_getCallInfo /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccapi\_call.c:30
#5 0x5c7c58 in ccsnap\_gen\_callEvent /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccapi\_snapshot.c:438
#6 0x5d1ce8 in ccappUpdateSessionData /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccprovider.c:1633
#7 0x5cb7c9 in ccp\_handler /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccprovider.c:2026
#8 0x5cae08 in CCApp\_task /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccapp\_task.c:184
#9 0x43f293 in \_\_asan::AsanThread::ThreadStart(unsigned long) (/home/bcampen/checkouts/mozilla-central/objdir-ff-asan/dist/cppunittests/signaling\_unittests+0x43f293)
#10 0x3620807f32 in start\_thread (/lib64/libpthread.so.0+0x3620807f32)
#11 0x36204f4eac in \_\_clone (/lib64/libc.so.6+0x36204f4eac)
0x6040000a7f6c is located 28 bytes inside of 37-byte region [0x6040000a7f50,0x6040000a7f75)
freed by thread T0 here:
#0 0x438c14 in \_\_interceptor\_free (/home/bcampen/checkouts/mozilla-central/objdir-ff-asan/dist/cppunittests/signaling\_unittests+0x438c14)
#1 0x5b2c79 in calllogger\_free\_call\_log /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/call\_logger.c:50
#2 0x5bafcf in CCAPI\_Call\_releaseCallInfo /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccapi\_call.c:60
#3 0x597151 in CSF::CC\_SIPCCCallInfo::~CC\_SIPCCCallInfo() /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_ecc/../../../../../media/webrtc/signaling/src/softphonewrapper/CC\_SIPCCCallInfo.cpp:33
#4 0x597103 in CSF::CC\_SIPCCCallInfo::~CC\_SIPCCCallInfo() /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_ecc/../../../../../media/webrtc/signaling/src/softphonewrapper/CC\_SIPCCCallInfo.cpp:32
#5 0x529cd2 in CSF::CC\_CallInfo::Release() /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_ecc/../../../../../media/webrtc/signaling/include/CC\_CallInfo.h:32
#6 0x576e1f in ~nsRefPtr /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_ecc/../../../../../xpcom/base/nsAutoPtr.h:870
#7 0x576e1f in ~nsRefPtr /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_ecc/../../../../../xpcom/base/nsAutoPtr.h:868
#8 0x576e1f in ~runnable\_args\_nm\_3 /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_ecc/../../../../../media/mtransport/runnable\_utils\_generated.h:235
#9 0x576e1f in ~runnable\_args\_nm\_3 /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_ecc/../../../../../media/mtransport/runnable\_utils\_generated.h:235
#10 0x576e1f in mozilla::runnable\_args\_nm\_3<void (\*)(nsAutoPtr<std::string>, ccapi\_call\_event\_e, nsRefPtr<CSF::CC\_CallInfo>), nsAutoPtr<std::string>, ccapi\_call\_event\_e, nsRefPtr<CSF::CC\_CallInfo> >::~runnable\_args\_nm\_3() /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_ecc/../../../../../media/mtransport/runnable\_utils\_generated.h:235
#11 0x1985124 in nsRunnable::Release() /home/bcampen/checkouts/latest-central/objdir-ff-asan/xpcom/glue/../../../xpcom/glue/nsThreadUtils.cpp:32
#12 0x2b9130127040 in ~nsCOMPtr /home/bcampen/checkouts/mozilla-central/objdir-ff-asan/xpcom/threads/../../dist/include/nsCOMPtr.h:535
#13 0x2b9130127040 in nsThread::ProcessNextEvent(bool, bool\*) /home/bcampen/checkouts/mozilla-central/objdir-ff-asan/xpcom/threads/../../../xpcom/threads/nsThread.cpp:772
#14 0x1986b0a in NS\_ProcessNextEvent(nsIThread\*, bool) /home/bcampen/checkouts/latest-central/objdir-ff-asan/xpcom/glue/../../../xpcom/glue/nsThreadUtils.cpp:263
#15 0x486d67 in main /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signaling/test/../../../../../media/webrtc/signaling/test/signaling\_unittests.cpp:4384
#16 0x3620421d64 in \_\_libc\_start\_main (/lib64/libc.so.6+0x3620421d64)
previously allocated by thread T14 here:
#0 0x438cf4 in \_\_interceptor\_malloc (/home/bcampen/checkouts/mozilla-central/objdir-ff-asan/dist/cppunittests/signaling\_unittests+0x438cf4)
#1 0x2b913c3d63f2 in moz\_xmalloc /home/bcampen/checkouts/latest-central/objdir-ff-asan/memory/mozalloc/../../../memory/mozalloc/mozalloc.cpp:52
#2 0x786876 in strlib\_malloc /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/src-common/string\_lib.c:53
#3 0x786b2e in strlib\_update /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/src-common/string\_lib.c:155
#4 0x5b3943 in handlePlacedCall /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/call\_logger.c:182
#5 0x5d2458 in ccappUpdateSessionData /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccprovider.c:1721
#6 0x5cb7c9 in ccp\_handler /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccprovider.c:2026
#7 0x5cae08 in CCApp\_task /home/bcampen/checkouts/latest-central/objdir-ff-asan/media/webrtc/signalingtest/signaling\_sipcc/../../../../../media/webrtc/signaling/src/sipcc/core/ccapp/ccapp\_task.c:184
#8 0x43f293 in \_\_asan::AsanThread::ThreadStart(unsigned long) (/home/bcampen/checkouts/mozilla-central/objdir-ff-asan/dist/cppunittests/signaling\_unittests+0x43f293)
It seems that we have both main and sipcc's CCApp task touching the same data. main can destroy one of these when a CSF::CC\_CallInfoPtr goes out of scope (this is essentially a nsRefPtr<CC\_CallInfo>, which points at an instance of CC\_SIPCCCallInfo, which contains a cc\_callinfo\_ref\_t that it will release). CCApp task can also free these. Neither the refcount nor the container are threadsafe.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1026037#a84756_406194)• 11 years ago |

Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1026037#a84782_280903)• 11 years ago |

[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1026037#a2379932_1689)• 11 years ago |

Group: media-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1026037#c1)• 10 years ago |
|  | |

Byron, is this something you are still seeing? Is there something we can do here or should it be closed as incomplete? Thanks.Flags: needinfo?(docfaraday)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1026037#c2)• 10 years ago |
|  | |

I have some major work in progress that will solve this and other problems. ehugg might have cycles to put together a quick fix in the meantime, though, since this work is still a little ways out.Flags: needinfo?(docfaraday) → needinfo?(ethanhugg)

|  | [Ethan Hugg [:ehugg]](/user_profile?user_id=436277) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1026037#c3)• 10 years ago |
|  | |

I'll take a look to see if there's a simple fix that can be done before your threading refactor lands.Flags: needinfo?(ethanhugg)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1026037#c4)• 10 years ago |
|  | |

This should be fixed now that 991037 has landed.Status: NEW → RESOLVEDClosed: 10 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1026037#a6416554_1689)• 10 years ago |

Group: media-core-security

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1026037#a6719626_75935)• 10 years ago |

Assignee: nobody → docfaraday
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)Target Milestone: --- → mozilla34

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1026037#c5)• 10 years ago |
|  | |

Is there a subset of [bug 991037](/show_bug.cgi?id=991037 "RESOLVED FIXED - WebRTC: ICE candidate gathering becomes complete before all candidates processed") we could land to fix this on the ESR31 branch? Or does this not happen there for some reason?
Then again you didn't discover this until nightly was Firefox 33, maybe this is a regression and wouldn't happen on ESR31? I'd feel more confident in that if you can identify a regressing check-in or feature.
[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=affected)
[tracking-firefox-esr31](/buglist.cgi?f1=cf_tracking_firefox_esr31&o1=isnotempty):
--- → [34+](/buglist.cgi?f1=cf_tracking_firefox_esr31&o1=equals&v1=34%2B)Depends on: [991037](/show_bug.cgi?id=991037 "RESOLVED FIXED - WebRTC: ICE candidate gathering becomes complete before all candidates processed")Flags: needinfo?(docfaraday)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1026037#c6)• 10 years ago |
|  | |

I suspect that this was not a regression, and the backport would be gigantic. Ethan, do you have any cycles to take a crack at this?Flags: needinfo?(docfaraday) → needinfo?(ethanhugg)

|  | [Ethan Hugg [:ehugg]](/user_profile?user_id=436277) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1026037#c7)• 10 years ago |
|  | |

So, this was found in the signaling unittests. Do we have crash reports of this happening in Firefox?
I looked at this earlier and I don't think there's a simple fix to it and migrating the patch from 991037 would definitely be risky.Flags: needinfo?(ethanhugg)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1026037#c8)• 10 years ago |
|  | |

I looked at crashstats for a bit, and didn't find anything with CCApp\_task in the stack in the last year. And, I only had this happen to me once, in a test-case, where things like destruction of PCImpl aren't handled by the garbage collector. Might be a really hard bug to hit in the field.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1026037#c9)• 10 years ago |
|  | |

Minusing this for ESR31. It doesn't seem like we're going to take this there.
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=wontfix)
[tracking-firefox-esr31](/buglist.cgi?f1=cf_tracking_firefox_esr31&o1=isnotempty):
[34+](/buglist.cgi?f1=cf_tracking_firefox_esr31&o1=equals&v1=34%2B) → ---Whiteboard: [adv-main34+]

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1026037#c10)• 10 years ago |
|  | |

I'm going to mark this as qe‑verify- due to the lack of poc/STR in this bug. If there's anything that QE and can do to verify this, please let us know and will take a another look!Flags: qe-verify-

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1026037#a38235159_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1026037#a62139308_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1026037&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑



=== Content from bugzilla.mozilla.org_5d419702_20250125_020540.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1013001)
* [XML](/show_bug.cgi?ctype=xml&id=1013001)

Closed
[Bug 1013001](/show_bug.cgi?id=1013001)

Opened 11 years ago
Closed 10 years ago

# Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189

## Categories

### (Core :: JavaScript Engine: JIT, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT#JavaScript%20Engine%3A%20JIT)

JavaScript Engine: JIT
▾

Core :: JavaScript Engine: JIT
JavaScript engine's JIT compilers
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

ARM

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla36

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=wontfix) |
| firefox33 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix) |
| firefox34 | [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=verified) |
| firefox35 | [+](/buglist.cgi?f1=cf_tracking_firefox35&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=verified) |
| firefox36 | [+](/buglist.cgi?f1=cf_tracking_firefox36&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=verified) |
| firefox-esr31 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected) |
| b2g-v1.4 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected) |
| b2g-v2.0 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) |
| b2g-v2.0M | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected) |
| b2g-v2.1 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 |  | wontfix |
| firefox33 |  | wontfix |
| firefox34 | + | verified |
| firefox35 | + | verified |
| firefox36 | + | verified |
| firefox-esr31 |  | unaffected |
| b2g-v1.4 |  | unaffected |
| b2g-v2.0 |  | unaffected |
| b2g-v2.0M |  | unaffected |
| b2g-v2.1 |  | unaffected |
| b2g-v2.2 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: terrence)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/045baa1e1ab4c1401b5ee569f11eaabf?d=mm&size=40)  [terrence](/user_profile?user_id=231770)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1023158](/show_bug.cgi?id=1023158 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js")

Dependency [tree](/showdependencytree.cgi?id=1013001&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1013001)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1023158](/show_bug.cgi?id=1023158 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js")

## Details

### (Keywords: assertion, sec-high, testcase, Whiteboard: [jsbugmon:update,testComment=6][adv-main34+][b2g-adv-main2.2-])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:update,testComment=6][adv-main34+][b2g-adv-main2.2-]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 2 obsolete files)

| [bug\_1013001-v0.diff](/attachment.cgi?id=8505876)  [10 years ago](#c7)  [Terrence Cole [:terrence]](/user_profile?user_id=231770)   7.28 KB, patch |  | [Details](/attachment.cgi?id=8505876&action=edit) | [Diff](/attachment.cgi?id=8505876&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8505876) |
| --- | --- | --- |
| [bug\_1013001-v0.diff](/attachment.cgi?id=8506478)  [10 years ago](#c10)  [Terrence Cole [:terrence]](/user_profile?user_id=231770)   23.75 KB, patch |  | [Details](/attachment.cgi?id=8506478&action=edit) | [Diff](/attachment.cgi?id=8506478&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8506478) |
| [bug\_1013001-v2.diff](/attachment.cgi?id=8507200)  [10 years ago](#c12)  [Terrence Cole [:terrence]](/user_profile?user_id=231770)   24.76 KB, patch | jandem : [review+](#c13 "10 years ago")  lsblakk : [approval-mozilla-aurora+](#a13961556_272375 "10 years ago")  abillings : [sec-approval+](#c15 "10 years ago") | [Details](/attachment.cgi?id=8507200&action=edit) | [Diff](/attachment.cgi?id=8507200&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8507200) |
| [beta-uplift-bug1013001.diff](/attachment.cgi?id=8512135)  [10 years ago](#c19)  [Terrence Cole [:terrence]](/user_profile?user_id=231770)   24.71 KB, patch | terrence : [review+](#c19 "10 years ago")  lsblakk : [approval-mozilla-beta+](#a13961576_272375 "10 years ago") | [Details](/attachment.cgi?id=8512135&action=edit) | [Diff](/attachment.cgi?id=8512135&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8512135) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1013001#c0)• 11 years ago |
|  | |

The following testcase asserts on mozilla-central revision 41a54c8add09 (run with --fuzzing-safe --ion-eager):
function second() {
var arr = {};
var s = 'a|b|c';
return s.replace(/[a-z]/g, function(a) { return arr[a]; }, 'g');
}
Object.defineProperty(
Object.prototype, "b", {
get: (function() {
"use asm"
return {}
})
}
);
second();

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1013001#c1)• 11 years ago |
|  | |

Another issue found with the simulator build, marked as s-s because it involves the Assembler and the assertion sounds GC-related.Flags: needinfo?(mrosenberg)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a148233_1689)• 11 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a1365693_395101)• 11 years ago |

Whiteboard: [jsbugmon:update,bisect]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a1405244_395101)• 11 years ago |

Whiteboard: [jsbugmon:update,bisect] → [jsbugmon:update]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1013001#c2)• 11 years ago |
|  | |

Is there somebody who can look at this Jandem?Flags: needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1013001#c3)• 11 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #2](/show_bug.cgi?id=1013001#c2 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189"))
> Is there somebody who can look at this Jandem?
Hm this could be a duplicate of [bug 1023158](/show_bug.cgi?id=1023158 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"), let's try this again once that bug is fixed...Flags: needinfo?(jdemooij)See Also: → [1023158](/show_bug.cgi?id=1023158 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a3245599_406194)• 11 years ago |

Flags: needinfo?(mrosenberg)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a3245622_406194)• 11 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update][dupe of bug 1023158?]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a4776860_1689)• 11 years ago |

Group: javascript-core-security

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a6801885_452604)• 10 years ago |

[status-firefox32](/buglist.cgi?f1=cf_status_firefox32&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=affected)
[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a7405276_395101)• 10 years ago |

Whiteboard: [jsbugmon:update][dupe of bug 1023158?] → [dupe of bug 1023158?] [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1013001#c4)• 10 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 76b55c0850ca).

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a7406619_395101)• 10 years ago |

Whiteboard: [dupe of bug 1023158?] [jsbugmon:update,ignore] → [dupe of bug 1023158?] [jsbugmon:bisectfix]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a7422347_395101)• 10 years ago |

Whiteboard: [dupe of bug 1023158?] [jsbugmon:bisectfix] → [dupe of bug 1023158?] [jsbugmon:]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1013001#c5)• 10 years ago |
|  | |

JSBugMon: Fix Bisection requested, result:
Due to skipped revisions, the first good revision could be any of:
changeset: <https://hg.mozilla.org/mozilla-central/rev/a0dd5a83ba36>
user: Jan de Mooij
date: Thu Jul 24 11:56:43 2014 +0200
summary: [Bug 1031529](/show_bug.cgi?id=1031529 "RESOLVED FIXED - Remove JS_THREADSAFE and add a --no-threads shell flag") part 2 - Remove JS\_THREADSAFE #ifdefs everywhere. r=bhackett
changeset: <https://hg.mozilla.org/mozilla-central/rev/6426fef52f51>
user: Jan de Mooij
date: Thu Jul 24 11:56:45 2014 +0200
summary: [Bug 1031529](/show_bug.cgi?id=1031529 "RESOLVED FIXED - Remove JS_THREADSAFE and add a --no-threads shell flag") part 3 - Step defining JS\_THREADSAFE, remove --disable-threadsafe. r=glandium
This iteration took 479.049 seconds to run.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1013001#c6)• 10 years ago |
|  | |

Still happens with rev 7fc96293ada8 with these flags: --fuzzing-safe --ion-eager --no-threads
function second() {
var arr = {};
var s = 'a|b|c';
return s.replace(/[a-z]/g, function(a) { return arr[a]; }, 'g');
}
Object.defineProperty(
Object.prototype, "b", {
get: (function() {
"use asm"
return {}
})
}
);
second();Whiteboard: [dupe of bug 1023158?] [jsbugmon:] → [dupe of bug 1023158?] [jsbugmon:update,testComment=6]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a9826710_280903)• 10 years ago |

[status-firefox32](/buglist.cgi?f1=cf_status_firefox32&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=wontfix)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1013001#c7)• 10 years ago |
|  | |

Attached patch

[bug\_1013001-v0.diff](attachment.cgi?id=8505876&action=diff) (obsolete)
— [Details](attachment.cgi?id=8505876&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8505876)

Sorry I didn't see this bug sooner, as the fix is straightforward. Please do NI me on any like this in the future so that I don't miss them in the tide of bugmail.Assignee: nobody → terrenceStatus: NEW → ASSIGNED
[Attachment #8505876](/attachment.cgi?id=8505876&action=edit "bug_1013001-v0.diff") -
Flags: review?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1013001#c8)• 10 years ago |
|  | |

Comment on [attachment 8505876](/attachment.cgi?id=8505876 "bug_1013001-v0.diff") [[details]](/attachment.cgi?id=8505876&action=edit "bug_1013001-v0.diff") [[diff]](/attachment.cgi?id=8505876&action=diff "bug_1013001-v0.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8505876)
bug\_1013001-v0.diff
Review of [attachment 8505876](/attachment.cgi?id=8505876 "bug_1013001-v0.diff") [[details]](/attachment.cgi?id=8505876&action=edit "bug_1013001-v0.diff") [[diff]](/attachment.cgi?id=8505876&action=diff "bug_1013001-v0.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8505876):
-----------------------------------------------------------------
Looks good and thanks for fixing this, but see the question below.
::: js/src/jit-test/tests/gc/bug-1013001.js
@@ +1,1 @@
> +function second() {
If it's really a sec-high we should probably land without the testcase.
::: js/src/jit/arm/MacroAssembler-arm.h
@@ +1178,5 @@
> void pushValue(const Value &val) {
> jsval\_layout jv = JSVAL\_TO\_IMPL(val);
> push(Imm32(jv.s.tag));
> if (val.isMarkable())
> + push(ImmMaybeNurseryPtr(reinterpret\_cast<gc::Cell \*>(val.toGCThing())));
Don't we need this on other platforms too?
[Attachment #8505876](/attachment.cgi?id=8505876&action=edit "bug_1013001-v0.diff") -
Flags: review?(jdemooij)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1013001#c9)• 10 years ago |
|  | |

Comment on [attachment 8505876](/attachment.cgi?id=8505876 "bug_1013001-v0.diff") [[details]](/attachment.cgi?id=8505876&action=edit "bug_1013001-v0.diff") [[diff]](/attachment.cgi?id=8505876&action=diff "bug_1013001-v0.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8505876)
bug\_1013001-v0.diff
On further investigation, this is simply incomplete -- the same path is buggy in x86.

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1013001#c10)• 10 years ago |
|  | |

Attached patch

[bug\_1013001-v0.diff](attachment.cgi?id=8506478&action=diff) (obsolete)
— [Details](attachment.cgi?id=8506478&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8506478)

This re-implementation of ImmMaybeNurseryPtr strictly enforces the membrane, catching the misuse on the other two platforms as well as simplifying the rest of the code significantly.
This patch gives visibility of the raw pointer value in an ImmMaybeNurseryPtr to only AssemblerShared. This should make it impossible to do anything at all with a nursery pointer without first calling noteMaybeNurseryPtr. Between this, the isTenured assertion in ImmGCPtr, and the onMainThread assertion, it should now be basically impossible to use a nursery pointer incorrectly in the assembler in debug builds.
I've built and tested this with x86, x64, and arm-simulator builds. It will probably break mips and arm64 builds when we land it, but fixing these will be trivial.
[Attachment #8506478](/attachment.cgi?id=8506478&action=edit "bug_1013001-v0.diff") -
Flags: review?(jdemooij)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a12955272_231770)• 10 years ago |

[Attachment #8505876](/attachment.cgi?id=8505876&action=edit "bug_1013001-v0.diff") -
Attachment is obsolete: true

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1013001#c11)• 10 years ago |
|  | |

Comment on [attachment 8506478](/attachment.cgi?id=8506478 "bug_1013001-v0.diff") [[details]](/attachment.cgi?id=8506478&action=edit "bug_1013001-v0.diff") [[diff]](/attachment.cgi?id=8506478&action=diff "bug_1013001-v0.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8506478)
bug\_1013001-v0.diff
Nope, it looks like this doesn't actually close the hole discussed [bug 1023158](/show_bug.cgi?id=1023158 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"). Next time's the charm.
[Attachment #8506478](/attachment.cgi?id=8506478&action=edit "bug_1013001-v0.diff") -
Attachment is obsolete: true
[Attachment #8506478](/attachment.cgi?id=8506478&action=edit "bug_1013001-v0.diff") -
Flags: review?(jdemooij)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1013001#c12)• 10 years ago |
|  | |

Attached patch

[bug\_1013001-v2.diff](attachment.cgi?id=8507200&action=diff)
— [Details](attachment.cgi?id=8507200&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8507200)

To address the case of writeValueRelocation(Value), I (1) moved the implementation from x86-shared.h to x64.h, as it isn't used on x86, and (2) handled the IsInsideNursery case manually. This is less bulletproof than the other changes here, but I think is as good as we're going to get without an enormous amount of work wrapping Value in an ImmGCValue/ImmMaybeNurseryValue equivalent.
[Attachment #8507200](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") -
Flags: review?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1013001#c13)• 10 years ago |
|  | |

Comment on [attachment 8507200](/attachment.cgi?id=8507200 "bug_1013001-v2.diff") [[details]](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") [[diff]](/attachment.cgi?id=8507200&action=diff "bug_1013001-v2.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8507200)
bug\_1013001-v2.diff
Review of [attachment 8507200](/attachment.cgi?id=8507200 "bug_1013001-v2.diff") [[details]](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") [[diff]](/attachment.cgi?id=8507200&action=diff "bug_1013001-v2.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8507200):
-----------------------------------------------------------------
Great refactoring. Thanks for fixing this!
::: js/src/jit/shared/Assembler-shared.h
@@ +223,2 @@
> // Used for immediates which require relocation.
> +class ImmGCPtr
I wonder if we should rename this to ImmTenured(GC)Ptr or something as a followup?
[Attachment #8507200](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") -
Flags: review?(jdemooij) → review+

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1013001#c14)• 10 years ago |
|  | |

Comment on [attachment 8507200](/attachment.cgi?id=8507200 "bug_1013001-v2.diff") [[details]](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") [[diff]](/attachment.cgi?id=8507200&action=diff "bug_1013001-v2.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8507200)
bug\_1013001-v2.diff
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Probably not easily, although the fuzzing testcase is pretty small.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Not really.
Which older supported branches are affected by this flaw?
Back to 33.
If not all supported branches, which bug introduced the flaw?
GGC.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Should be fairly easy to backport and low risk.
How likely is this patch to cause regressions; how much testing does it need?
It's mostly a type-system change, so it's fairly unlikely to cause regressions or need significant testing.
[Attachment #8507200](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a13367194_280903)• 10 years ago |

[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix)
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=affected)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected)
[tracking-firefox34](/buglist.cgi?f1=cf_tracking_firefox34&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B)
[tracking-firefox35](/buglist.cgi?f1=cf_tracking_firefox35&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox35&o1=equals&v1=%2B)
[tracking-firefox36](/buglist.cgi?f1=cf_tracking_firefox36&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox36&o1=equals&v1=%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1013001#c15)• 10 years ago |
|  | |

Comment on [attachment 8507200](/attachment.cgi?id=8507200 "bug_1013001-v2.diff") [[details]](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") [[diff]](/attachment.cgi?id=8507200&action=diff "bug_1013001-v2.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8507200)
bug\_1013001-v2.diff
Sec-approval+. Please nominate for Aurora and Beta as well so we can fix it there (or make new patches for these if the current one doesn't apply cleanly and nominate them).
[Attachment #8507200](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") -
Flags: sec-approval? → sec-approval+

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1013001#c16)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/5df7f0bf77fc>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1013001#c17)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/5df7f0bf77fc>Status: ASSIGNED → RESOLVEDClosed: 10 years ago
[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla36

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a13465926_395101)• 10 years ago |

Status: RESOLVED → VERIFIED
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=verified)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1013001#c18)• 10 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1013001#c19)• 10 years ago |
|  | |

Attached patch

[beta-uplift-bug1013001.diff](attachment.cgi?id=8512135&action=diff)
— [Details](attachment.cgi?id=8512135&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8512135)

Approval Request Comment
[Feature/regressing bug #]: GGC.
[User impact if declined]: A potentially exploitable sec-high in release browsers.
[Describe test coverage new/current, TBPL]: On m-i/m-c for several weeks.
[Risks and why]: Low: there isn't much that can go wrong other than build failures.
[String/UUID change made/needed]: None.
[Attachment #8512135](/attachment.cgi?id=8512135&action=edit "beta-uplift-bug1013001.diff") -
Flags: review+
[Attachment #8512135](/attachment.cgi?id=8512135&action=edit "beta-uplift-bug1013001.diff") -
Flags: approval-mozilla-beta?

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1013001#c20)• 10 years ago |
|  | |

Comment on [attachment 8507200](/attachment.cgi?id=8507200 "bug_1013001-v2.diff") [[details]](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") [[diff]](/attachment.cgi?id=8507200&action=diff "bug_1013001-v2.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1013001&attachment=8507200)
bug\_1013001-v2.diff
Approval Request Comment
Same as for beta.
[Attachment #8507200](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a13961556_272375)• 10 years ago |

[Attachment #8507200](/attachment.cgi?id=8507200&action=edit "bug_1013001-v2.diff") -
Flags: approval-mozilla-aurora? → approval-mozilla-aurora+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a13961576_272375)• 10 years ago |

[Attachment #8512135](/attachment.cgi?id=8512135&action=edit "beta-uplift-bug1013001.diff") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1013001#c21)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/afef8d8afd37>
<https://hg.mozilla.org/releases/mozilla-beta/rev/c94fc6b83daa>
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a14050865_395101)• 10 years ago |

[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=verified)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=verified)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1013001#c22)• 10 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed on Fx34
JSBugMon: This bug has been automatically verified fixed on Fx35

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a15646682_75935)• 10 years ago |

Blocks: [1023158](/show_bug.cgi?id=1023158 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a15705455_1689)• 10 years ago |

Group: javascript-core-security

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a16067715_280903)• 10 years ago |

Whiteboard: [dupe of bug 1023158?] [jsbugmon:update,testComment=6] → [jsbugmon:update,testComment=6][adv-main34+]

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a34179061_465475)• 10 years ago |

Whiteboard: [jsbugmon:update,testComment=6][adv-main34+] → [jsbugmon:update,testComment=6][adv-main34+][b2g-adv-main2.2-]

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a40632165_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1013001#a64536744_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1013001&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Terrence Cole [:terrence]](/user_profile?user_id=231770)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from security.gentoo.org_d439654f_20250125_020606.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Products: Multiple vulnerabilities — GLSA **201504-01**

Multiple vulnerabilities have been found in Mozilla Firefox,
Thunderbird, and SeaMonkey, the worst of which may allow user-assisted
execution of arbitrary code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **31.5.3** |
| Unaffected versions | >= **31.5.3** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **31.5.3** |
| Unaffected versions | >= **31.5.3** |

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **31.5.0** |
| Unaffected versions | >= **31.5.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **31.5.0** |
| Unaffected versions | >= **31.5.0** |

| Package | **www-client/seamonkey** on all architectures |
| --- | --- |
| Affected versions | < **2.33.1** |
| Unaffected versions | >= **2.33.1** |

| Package | **www-client/seamonkey-bin** on all architectures |
| --- | --- |
| Affected versions | < **2.33.1** |
| Unaffected versions | >= **2.33.1** |

| Package | **dev-libs/nspr** on all architectures |
| --- | --- |
| Affected versions | < **4.10.6** |
| Unaffected versions | >= **4.10.6** |

### Background

Mozilla Firefox is an open-source web browser and Mozilla Thunderbird an
open-source email client, both from the Mozilla Project. The SeaMonkey
project is a community effort to deliver production-quality releases of
code derived from the application formerly known as the ‘Mozilla
Application Suite’.

### Description

Multiple vulnerabilities have been discovered in Firefox, Thunderbird,
and SeaMonkey. Please review the CVE identifiers referenced below for
details.

### Impact

A remote attacker could entice a user to view a specially crafted web
page or email, possibly resulting in execution of arbitrary code or a
Denial of Service condition. Furthermore, a remote attacker may be able
to perform Man-in-the-Middle attacks, obtain sensitive information, spoof
the address bar, conduct clickjacking attacks, bypass security
restrictions and protection mechanisms, or have other unspecified
impact.

### Workaround

There are no known workarounds at this time.

### Resolution

All firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-31.5.3"

```

All firefox-bin users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-31.5.3"

```

All thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-31.5.0"

```

All thunderbird-bin users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=mail-client/thunderbird-bin-31.5.0"

```

All seamonkey users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/seamonkey-2.33.1"

```

All seamonkey-bin users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/seamonkey-bin-2.33.1"

```

All nspr users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-libs/nspr-4.10.6"

```
### References

* [CVE-2013-1741](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-1741)
* [CVE-2013-2566](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-2566)
* [CVE-2013-5590](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5590)
* [CVE-2013-5591](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5591)
* [CVE-2013-5592](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5592)
* [CVE-2013-5593](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5593)
* [CVE-2013-5595](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5595)
* [CVE-2013-5596](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5596)
* [CVE-2013-5597](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5597)
* [CVE-2013-5598](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5598)
* [CVE-2013-5599](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5599)
* [CVE-2013-5600](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5600)
* [CVE-2013-5601](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5601)
* [CVE-2013-5602](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5602)
* [CVE-2013-5603](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5603)
* [CVE-2013-5604](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5604)
* [CVE-2013-5605](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5605)
* [CVE-2013-5606](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5606)
* [CVE-2013-5607](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5607)
* [CVE-2013-5609](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5609)
* [CVE-2013-5610](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5610)
* [CVE-2013-5612](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5612)
* [CVE-2013-5613](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5613)
* [CVE-2013-5614](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5614)
* [CVE-2013-5615](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5615)
* [CVE-2013-5616](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5616)
* [CVE-2013-5618](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5618)
* [CVE-2013-5619](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-5619)
* [CVE-2013-6671](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-6671)
* [CVE-2013-6672](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-6672)
* [CVE-2013-6673](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-6673)
* [CVE-2014-1477](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1477)
* [CVE-2014-1478](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1478)
* [CVE-2014-1479](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1479)
* [CVE-2014-1480](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1480)
* [CVE-2014-1481](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1481)
* [CVE-2014-1482](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1482)
* [CVE-2014-1483](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1483)
* [CVE-2014-1485](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1485)
* [CVE-2014-1486](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1486)
* [CVE-2014-1487](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1487)
* [CVE-2014-1488](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1488)
* [CVE-2014-1489](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1489)
* [CVE-2014-1490](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1490)
* [CVE-2014-1491](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1491)
* [CVE-2014-1492](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1492)
* [CVE-2014-1493](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1493)
* [CVE-2014-1494](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1494)
* [CVE-2014-1496](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1496)
* [CVE-2014-1497](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1497)
* [CVE-2014-1498](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1498)
* [CVE-2014-1499](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1499)
* [CVE-2014-1500](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1500)
* [CVE-2014-1502](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1502)
* [CVE-2014-1504](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1504)
* [CVE-2014-1505](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1505)
* [CVE-2014-1508](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1508)
* [CVE-2014-1509](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1509)
* [CVE-2014-1510](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1510)
* [CVE-2014-1511](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1511)
* [CVE-2014-1512](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1512)
* [CVE-2014-1513](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1513)
* [CVE-2014-1514](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1514)
* [CVE-2014-1518](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1518)
* [CVE-2014-1519](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1519)
* [CVE-2014-1520](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1520)
* [CVE-2014-1522](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1522)
* [CVE-2014-1523](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1523)
* [CVE-2014-1524](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1524)
* [CVE-2014-1525](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1525)
* [CVE-2014-1526](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1526)
* [CVE-2014-1529](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1529)
* [CVE-2014-1530](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1530)
* [CVE-2014-1531](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1531)
* [CVE-2014-1532](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1532)
* [CVE-2014-1533](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1533)
* [CVE-2014-1534](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1534)
* [CVE-2014-1536](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1536)
* [CVE-2014-1537](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1537)
* [CVE-2014-1538](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1538)
* [CVE-2014-1539](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1539)
* [CVE-2014-1540](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1540)
* [CVE-2014-1541](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1541)
* [CVE-2014-1542](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1542)
* [CVE-2014-1543](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1543)
* [CVE-2014-1544](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1544)
* [CVE-2014-1545](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1545)
* [CVE-2014-1547](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1547)
* [CVE-2014-1548](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1548)
* [CVE-2014-1549](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1549)
* [CVE-2014-1550](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1550)
* [CVE-2014-1551](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1551)
* [CVE-2014-1552](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1552)
* [CVE-2014-1553](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1553)
* [CVE-2014-1554](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1554)
* [CVE-2014-1555](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1555)
* [CVE-2014-1556](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1556)
* [CVE-2014-1557](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1557)
* [CVE-2014-1558](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1558)
* [CVE-2014-1559](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1559)
* [CVE-2014-1560](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1560)
* [CVE-2014-1561](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1561)
* [CVE-2014-1562](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1562)
* [CVE-2014-1563](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1563)
* [CVE-2014-1564](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1564)
* [CVE-2014-1565](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1565)
* [CVE-2014-1566](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1566)
* [CVE-2014-1567](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1567)
* [CVE-2014-1568](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1568)
* [CVE-2014-1574](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1574)
* [CVE-2014-1575](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1575)
* [CVE-2014-1576](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1576)
* [CVE-2014-1577](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1577)
* [CVE-2014-1578](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1578)
* [CVE-2014-1580](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1580)
* [CVE-2014-1581](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1581)
* [CVE-2014-1582](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1582)
* [CVE-2014-1583](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1583)
* [CVE-2014-1584](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1584)
* [CVE-2014-1585](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1585)
* [CVE-2014-1586](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1586)
* [CVE-2014-1587](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1587)
* [CVE-2014-1588](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1588)
* [CVE-2014-1589](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1589)
* [CVE-2014-1590](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1590)
* [CVE-2014-1591](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1591)
* [CVE-2014-1592](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1592)
* [CVE-2014-1593](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1593)
* [CVE-2014-1594](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-1594)
* [CVE-2014-5369](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-5369)
* [CVE-2014-8631](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8631)
* [CVE-2014-8632](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8632)
* [CVE-2014-8634](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8634)
* [CVE-2014-8635](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8635)
* [CVE-2014-8636](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8636)
* [CVE-2014-8637](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8637)
* [CVE-2014-8638](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8638)
* [CVE-2014-8639](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8639)
* [CVE-2014-8640](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8640)
* [CVE-2014-8641](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8641)
* [CVE-2014-8642](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8642)
* [CVE-2015-0817](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0817)
* [CVE-2015-0818](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0818)
* [CVE-2015-0819](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0819)
* [CVE-2015-0820](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0820)
* [CVE-2015-0821](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0821)
* [CVE-2015-0822](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0822)
* [CVE-2015-0823](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0823)
* [CVE-2015-0824](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0824)
* [CVE-2015-0825](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0825)
* [CVE-2015-0826](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0826)
* [CVE-2015-0827](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0827)
* [CVE-2015-0828](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0828)
* [CVE-2015-0829](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0829)
* [CVE-2015-0830](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0830)
* [CVE-2015-0831](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0831)
* [CVE-2015-0832](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0832)
* [CVE-2015-0833](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0833)
* [CVE-2015-0834](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0834)
* [CVE-2015-0835](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0835)
* [CVE-2015-0836](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0836)

**Release date**

April 07, 2015

**Latest revision**

April 08, 2015: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [489796](https://bugs.gentoo.org/show_bug.cgi?id=489796)
* [491234](https://bugs.gentoo.org/show_bug.cgi?id=491234)
* [493850](https://bugs.gentoo.org/show_bug.cgi?id=493850)
* [500320](https://bugs.gentoo.org/show_bug.cgi?id=500320)
* [505072](https://bugs.gentoo.org/show_bug.cgi?id=505072)
* [509050](https://bugs.gentoo.org/show_bug.cgi?id=509050)
* [512896](https://bugs.gentoo.org/show_bug.cgi?id=512896)
* [517876](https://bugs.gentoo.org/show_bug.cgi?id=517876)
* [522020](https://bugs.gentoo.org/show_bug.cgi?id=522020)
* [523652](https://bugs.gentoo.org/show_bug.cgi?id=523652)
* [525474](https://bugs.gentoo.org/show_bug.cgi?id=525474)
* [531408](https://bugs.gentoo.org/show_bug.cgi?id=531408)
* [536564](https://bugs.gentoo.org/show_bug.cgi?id=536564)
* [541316](https://bugs.gentoo.org/show_bug.cgi?id=541316)
* [544056](https://bugs.gentoo.org/show_bug.cgi?id=544056)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_44885f87_20250125_020553.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1064835)
* [XML](/show_bug.cgi?ctype=xml&id=1064835)

Closed
[Bug 1064835](/show_bug.cgi?id=1064835)

Opened 10 years ago
Closed 10 years ago

# Assertion failure: stack\_[\*size\_].isJs(), at vm/SPSProfiler.cpp:192 or Crash on Heap

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: stack\_[\*size\_].isJs(), at vm/SPSProfiler.cpp:192 or Crash on Heap

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla36

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox33 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix) |
| firefox34 | --- | [verified](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=verified) |
| firefox35 | [+](/buglist.cgi?f1=cf_tracking_firefox35&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=verified) |
| firefox36 | [+](/buglist.cgi?f1=cf_tracking_firefox36&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=verified) |
| firefox-esr31 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=wontfix) |
| b2g-v1.4 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=wontfix) |
| b2g-v2.0 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=wontfix) |
| b2g-v2.0M | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=wontfix) |
| b2g-v2.1 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox33 |  | wontfix |
| firefox34 |  | verified |
| firefox35 | + | verified |
| firefox36 | + | verified |
| firefox-esr31 |  | wontfix |
| b2g-v1.4 |  | wontfix |
| b2g-v2.0 |  | wontfix |
| b2g-v2.0M |  | wontfix |
| b2g-v2.1 |  | fixed |
| b2g-v2.2 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: djvj)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/55e0476b8efe4fd21a03a662d86e3578?d=mm&size=40)  [djvj](/user_profile?user_id=436087)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main34+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[crash](/buglist.cgi?keywords=crash&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main34+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [djvj](/user_profile?user_id=436087) | [in-testsuite](#c15 "10 years ago") | ? |
| --- | --- | --- |
| [djvj](/user_profile?user_id=436087) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [fix-bug-1064835.patch](/attachment.cgi?id=8502058)  [10 years ago](#c11)  [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)   10.71 KB, patch | jandem : [review+](#c13 "10 years ago")  abillings : [approval-mozilla-aurora+](#c22 "10 years ago")  abillings : [approval-mozilla-beta+](#c22 "10 years ago") | [Details](/attachment.cgi?id=8502058&action=edit) | [Diff](/attachment.cgi?id=8502058&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1064835&attachment=8502058) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1064835#c0)• 10 years ago |
|  | |

The following testcase asserts on mozilla-central revision 6b8da5940f74 (run with --no-threads --fuzzing-safe):
var lfcode = new Array();
lfcode.push("");
lfcode.push("");
lfcode.push("");
lfcode.push("x = function () { return arr.length; }");
lfcode.push("");
lfcode.push("");
lfcode.push("enableSPSProfiling();");
lfcode.push("");
lfcode.push("\
x >>= /x/;\
(function f() {\
x.r = x;\
return f()\
})();\
");
for (lfx in lfcode) { loadFile(lfcode[lfx]); }
function loadFile(lfVarx) {
try {
evaluate(lfVarx, { noScriptRval : true, compileAndGo : true });
} catch (lfVare) {}
}

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1064835#c1)• 10 years ago |
|  | |

Crash trace:
Program received signal SIGSEGV, Segmentation fault.
0x00007ffff7fe974d in ?? ()
#0 0x00007ffff7fe974d in ?? ()
#1 0x0000000000000001 in ?? ()
#2 0x00007fffffffd110 in ?? ()
#3 0x00007fffffffd770 in ?? ()
#4 0x0000000001666558 in ?? ()
#5 0x00007ffff7fe9700 in ?? ()
#6 0x00007fffffffce00 in ?? ()
#7 0x0000000001666540 in ?? ()
rbx 0x163d748 103102535496
=> 0x7ffff7fe974d: movq $0xaaff7c,(%rbx)
This bug does not reproduce with every run, you might need to run it multiple times. Marked s-s because I don't know if this affects more than just profiling. If it's profiling only, then it's probably sec-moderate.
This is a long standing bug that I was now able to isolate into a single testcase. Fixing it would also help triaging other heap crashes.
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected)Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1064835#c2)• 10 years ago |
|  | |

Needinfo from djvj because it's in SPS.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a18004_280903)• 10 years ago |

Flags: needinfo?(kvijayan)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1064835#c3)• 10 years ago |
|  | |

Jan, is there somebody who could look at this?Flags: needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1064835#c4)• 10 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #3](/show_bug.cgi?id=1064835#c3 "VERIFIED FIXED - Assertion failure: stack_[*size_].isJs(), at vm/SPSProfiler.cpp:192 or Crash on Heap"))
> Jan, is there somebody who could look at this?
djvj is our SPS guru but is already on needinfo. Kannan any idea what's going on?Flags: needinfo?(jdemooij)

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1064835#c5)• 10 years ago |
|  | |

I haven't looked at this yet, but I will this week. Taking the bug.Flags: needinfo?(kvijayan)

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a624089_436087)• 10 years ago |

Assignee: nobody → kvijayanQA Contact: kvijayan

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a624097_436087)• 10 years ago |

QA Contact: kvijayan

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1064835#c6)• 10 years ago |
|  | |

Kannan, have you had a chance to look at this? It would be nice to at least know that this is a profiler-only issue.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1064835#c7)• 10 years ago |
|  | |

This is still occurring and might be hiding real bugs even if this is profiler-only. The heap crashes are not always the same and not trivial to distinguish. Please fix this bug :)

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1064835#c8)• 10 years ago |
|  | |

Kannan, we need to look at this or at least understand it enough to rate it. Can you please give it some attention at your earliest convenience? Thank you.Flags: needinfo?(kvijayan)

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1064835#c9)• 10 years ago |
|  | |

I will look at this immediately. I've been working hard on replacing this entire backend and was hoping to get my patches under review. That process has started now.Flags: needinfo?(kvijayan)

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1064835#c10)• 10 years ago |
|  | |

Found the issue. Yet another corner-case path.
If we're bailing out from Ion to baseline, and we overflow the C stack on bailout, we pop an SPS frame for the last JS frame (if the bailout was not ArgumentCheck), because stack overflow causes the last frame to be dropped (and we need to pop the SPS frame to match it).
However, sometimes we duplicate this pop because occasionally, the baseline bailout is NOT an ArgumentCheck, but it STILL resumes into the prologue of the baseline script in some corner cases. In these cases, the baseline-bailout code itself pops the SPS frame, and then subsequently overflows, and then the general bailout code does another pop of the SPS frame, leading to a double-pop.
This \_could\_ be leveraged to engineer an attack. If an attacker were able to generate several of these, then they can cause the SPS stack size field to underflow and become negative. Since the offset is a uint32\_t, this becomes a positive offset around 4-billion. On 64-bit machines, that could well point into valid memory.
Then by subsequently controlling the JS code that gets called AFTER that underflow, some words can have controlled data written to them. This is because as the JS pushes pseudostack entries, it'll be pushing them at the underflowed offset (several gigabytes above the buffer pointer). Since an attacker can control the pcOffsets at which call sites occur in JS bytecode, and the PC offsets are stored in pseudostack entries, these words may also be controllable.
This is a very hard attack to execute, but it \_is\_ an opening.

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1064835#c11)• 10 years ago |
|  | |

Attached patch

[fix-bug-1064835.patch](attachment.cgi?id=8502058&action=diff)
— [Details](attachment.cgi?id=8502058&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1064835&attachment=8502058)

Fix for bug. Running through try before sending for review: <https://treeherder.mozilla.org/ui/#/jobs?repo=try&revision=f8efc7516fce>

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1064835#c12)• 10 years ago |
|  | |

Comment on [attachment 8502058](/attachment.cgi?id=8502058 "fix-bug-1064835.patch") [[details]](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") [[diff]](/attachment.cgi?id=8502058&action=diff "fix-bug-1064835.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1064835&attachment=8502058)
fix-bug-1064835.patch
Try run seems ok. Sending for review.
[Attachment #8502058](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") -
Flags: review?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1064835#c13)• 10 years ago |
|  | |

Comment on [attachment 8502058](/attachment.cgi?id=8502058 "fix-bug-1064835.patch") [[details]](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") [[diff]](/attachment.cgi?id=8502058&action=diff "fix-bug-1064835.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1064835&attachment=8502058)
fix-bug-1064835.patch
Review of [attachment 8502058](/attachment.cgi?id=8502058 "fix-bug-1064835.patch") [[details]](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") [[diff]](/attachment.cgi?id=8502058&action=diff "fix-bug-1064835.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1064835&attachment=8502058):
-----------------------------------------------------------------
Please add the testcase as well (not sure if we treat profiler bugs as sec-high/critical since content can't enable it...).
[Attachment #8502058](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") -
Flags: review?(jdemooij) → review+

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1064835#c14)• 10 years ago |
|  | |

I would err on the side of treating profiler bugs with the same level of seriousness as regular bugs.
I have the test on the patch queue. I'll land it after the patch gets uplifted.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a3038799_406194)• 10 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1064835#c15)• 10 years ago |
|  | |

 <https://hg.mozilla.org/integration/mozilla-inbound/rev/53d8fbf54227>
Test case queued up. Marking in-testsuite=? as reminder about test case push after this gets pulled upstream.Flags: in-testsuite?

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1064835#c16)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/53d8fbf54227>
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed)Target Milestone: --- → mozilla36

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a3290260_277293)• 10 years ago |

Status: NEW → RESOLVEDClosed: 10 years agoResolution: --- → FIXED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a3659284_395101)• 10 years ago |

Status: RESOLVED → VERIFIED
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=verified)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1064835#c17)• 10 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1064835#c18)• 10 years ago |
|  | |

Why isn't this being backported to Aurora and Beta (and ESR31, if it is affected) since it is a sec-high rated security bug?
Also, this went in without sec-approval. Unless it is trunk only, sec-high and sec-critical rated issues need to be approved before landing to help avoid 0daying ourselves. See <https://wiki.mozilla.org/Security/Bug_Approval_Process> for policy.Flags: needinfo?(kvijayan)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a5656698_280903)• 10 years ago |

[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=%3F)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=%3F)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=%3F)

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1064835#c19)• 10 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #18](/show_bug.cgi?id=1064835#c18 "VERIFIED FIXED - Assertion failure: stack_[*size_].isJs(), at vm/SPSProfiler.cpp:192 or Crash on Heap"))
> Why isn't this being backported to Aurora and Beta (and ESR31, if it is
> affected) since it is a sec-high rated security bug?
>
> Also, this went in without sec-approval. Unless it is trunk only, sec-high
> and sec-critical rated issues need to be approved before landing to help
> avoid 0daying ourselves. See
> <https://wiki.mozilla.org/Security/Bug_Approval_Process> for policy.
An attack using this is hard to engineer, and it requires that profiling be turned on. I documented one possible attack vector just for the sake of thoroughness. I think the sec rating of this bug can be reduced to sec-moderate.
We have been fixing and landing these pseudostack sync bugs for a while (work is underway to replace the infrastructure to eliminate that class of bugs entirely, but it has yet to land). We haven't been uplifting these as they land, so I assumed the same policy here.
That said, I didn't notice the sec-high on this bug, and wasn't aware of the specific policy for dealing with them. I'll be more alert about this in the future.
Pinging gkw.. do we downgrade this bug or do you think it needs uplift?Flags: needinfo?(kvijayan) → needinfo?(gary)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1064835#c20)• 10 years ago |
|  | |

(In reply to Kannan Vijayan [:djvj] from [comment #19](/show_bug.cgi?id=1064835#c19 "VERIFIED FIXED - Assertion failure: stack_[*size_].isJs(), at vm/SPSProfiler.cpp:192 or Crash on Heap"))
> That said, I didn't notice the sec-high on this bug, and wasn't aware of the
> specific policy for dealing with them. I'll be more alert about this in the
> future.
>
> Pinging gkw.. do we downgrade this bug or do you think it needs uplift?
While I'm not entirely sure about the severity of this bug myself, I'd say uplift it because it would help decoder:
(In reply to Christian Holler (:decoder) from [comment #1](/show_bug.cgi?id=1064835#c1 "VERIFIED FIXED - Assertion failure: stack_[*size_].isJs(), at vm/SPSProfiler.cpp:192 or Crash on Heap"))
> This is a long standing bug that I was now able to isolate into a single
> testcase. Fixing it would also help triaging other heap crashes.
Generally it is really appreciated to uplift issues where it would help the fuzzing folks.Flags: needinfo?(gary) → needinfo?(kvijayan)

|  | [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1064835#c21)• 10 years ago |
|  | |

Comment on [attachment 8502058](/attachment.cgi?id=8502058 "fix-bug-1064835.patch") [[details]](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") [[diff]](/attachment.cgi?id=8502058&action=diff "fix-bug-1064835.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1064835&attachment=8502058)
fix-bug-1064835.patch
Approval Request Comment
[Feature/regressing bug #]:
SPS Profiler implementation in JS engine.
[User impact if declined]:
Potentially exploitable crash when profiling turned on.
[Describe test coverage new/current, TBPL]:
New fuzztest to be landed in jit-tests. Hasn't been checked in yet.
[Risks and why]:
Low risk, minor changes to profiling logic only.
[String/UUID change made/needed]:
N/AFlags: needinfo?(kvijayan)
[Attachment #8502058](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") -
Flags: approval-mozilla-beta?
[Attachment #8502058](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") -
Flags: approval-mozilla-aurora?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a5720191_280903)• 10 years ago |

[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=wontfix)
[tracking-firefox35](/buglist.cgi?f1=cf_tracking_firefox35&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox35&o1=equals&v1=%2B)
[tracking-firefox36](/buglist.cgi?f1=cf_tracking_firefox36&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox36&o1=equals&v1=%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1064835#c22)• 10 years ago |
|  | |

Comment on [attachment 8502058](/attachment.cgi?id=8502058 "fix-bug-1064835.patch") [[details]](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") [[diff]](/attachment.cgi?id=8502058&action=diff "fix-bug-1064835.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1064835&attachment=8502058)
fix-bug-1064835.patch
Approved for Aurora and Beta. Please get this in before Monday as our beta build for Beta branch goes out then and we're not allowing checkins that aren't sec-critical after that.
[Attachment #8502058](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") -
Flags: approval-mozilla-beta?
[Attachment #8502058](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") -
Flags: approval-mozilla-beta+
[Attachment #8502058](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") -
Flags: approval-mozilla-aurora?
[Attachment #8502058](/attachment.cgi?id=8502058&action=edit "fix-bug-1064835.patch") -
Flags: approval-mozilla-aurora+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a5720258_280903)• 10 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1064835#c23)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/7c69d2736309>
<https://hg.mozilla.org/releases/mozilla-beta/rev/2f9e29cf1a7a>
[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=wontfix)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=wontfix)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=wontfix)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a5751233_395101)• 10 years ago |

[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=verified)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=verified)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1064835#c24)• 10 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed on Fx34
JSBugMon: This bug has been automatically verified fixed on Fx35

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1064835#c25)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-b2g34_v2_1/rev/2f9e29cf1a7a>
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a6345264_280903)• 10 years ago |

Whiteboard: [adv-main34+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1064835#c26)• 10 years ago |
|  | |

Lowering severity per [comment 19](/show_bug.cgi?id=1064835#c19 "VERIFIED FIXED - Assertion failure: stack_[*size_].isJs(), at vm/SPSProfiler.cpp:192 or Crash on Heap")Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a30909662_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1064835#a54814183_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1064835&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Kannan Vijayan [:djvj]](/user_profile?user_id=436087)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_5d5ed75b_20250125_020600.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1077687)
* [XML](/show_bug.cgi?ctype=xml&id=1077687)

Closed
[Bug 1077687](/show_bug.cgi?id=1077687)

Opened 10 years ago
Closed 10 years ago

# Style struct may refer to removed CounterStyle object

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Style struct may refer to removed CounterStyle object

## Categories

### (Core :: CSS Parsing and Computation, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=CSS%20Parsing%20and%20Computation#CSS%20Parsing%20and%20Computation)

CSS Parsing and Computation
▾

Core :: CSS Parsing and Computation

Issues with loading CSS style sheets from the network, parsing style sheets and style attributes in HTML markup, performing the CSS cascade, selector matching, and producing correct computed values for CSS properties.

Example bugs:

* toggling class name on an element does not restyle the element
* background-color property does not support hsl() values

Specifications covered:

* CSS Cascading
* CSS Conditional
* CSS Logical Properties
* CSS Namespaces
* CSS Scoping
* CSS Style Attributes
* CSS Syntax
* CSS Values
* CSS Variables
* Media Queries
* Selectors

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=CSS%20Parsing%20and%20Computation&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=CSS%20Parsing%20and%20Computation&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=CSS%20Parsing%20and%20Computation)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla36

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox33 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix) |
| firefox34 | [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) |
| firefox35 | [+](/buglist.cgi?f1=cf_tracking_firefox35&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed) |
| firefox36 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed) |
| firefox-esr31 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected) |
| b2g-v1.4 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected) |
| b2g-v2.0 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) |
| b2g-v2.0M | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected) |
| b2g-v2.1 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox33 |  | wontfix |
| firefox34 | + | fixed |
| firefox35 | + | fixed |
| firefox36 |  | fixed |
| firefox-esr31 |  | unaffected |
| b2g-v1.4 |  | unaffected |
| b2g-v2.0 |  | unaffected |
| b2g-v2.0M |  | unaffected |
| b2g-v2.1 |  | fixed |
| b2g-v2.2 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: xidorn, Assigned: MatsPalmgren\_bugz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/dbdad3c879a4ee90ae4054218c644e04?d=mm&size=40)  [xidorn](/user_profile?user_id=373403)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[966166](/show_bug.cgi?id=966166 "RESOLVED FIXED - Implement @counter-style rule"), [1075336](/show_bug.cgi?id=1075336 "VERIFIED FIXED - Heap-use-after-free in mozilla::CustomCounterStyle::IsBullet")

Dependency [tree](/showdependencytree.cgi?id=1077687&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1077687)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uaf, regression, sec-high, Whiteboard: [adv-main34+] bug 1077718 protects with frame poisoning, backported to Fx34)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main34+] bug 1077718 protects with frame poisoning, backported to Fx34

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 1 obsolete file)

| [testcase](/attachment.cgi?id=8511799)  [10 years ago](#c4)  [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)   298 bytes, text/html |  | [Details](/attachment.cgi?id=8511799&action=edit) |
| --- | --- | --- |
| [patch for explicit crash when the bug appears](/attachment.cgi?id=8511801)  [10 years ago](#c5)  [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)   3.16 KB, patch |  | [Details](/attachment.cgi?id=8511801&action=edit) | [Diff](/attachment.cgi?id=8511801&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8511801) |
| [stack](/attachment.cgi?id=8512047)  [10 years ago](#c7)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   6.64 KB, text/plain |  | [Details](/attachment.cgi?id=8512047&action=edit) |
| [wip](/attachment.cgi?id=8512052)  [10 years ago](#c8)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   1.05 KB, patch |  | [Details](/attachment.cgi?id=8512052&action=edit) | [Diff](/attachment.cgi?id=8512052&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8512052) |
| [fix](/attachment.cgi?id=8512703)  [10 years ago](#c10)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   2.90 KB, patch | roc : [review+](#a2156093_5038 "10 years ago")  dveditz : [approval-mozilla-aurora+](#c17 "10 years ago")  dveditz : [approval-mozilla-beta+](#c17 "10 years ago")  dveditz : [sec-approval+](#c17 "10 years ago") | [Details](/attachment.cgi?id=8512703&action=edit) | [Diff](/attachment.cgi?id=8512703&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8512703) |
| [patch for beta](/attachment.cgi?id=8517597)  [10 years ago](#c24)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   2.92 KB, patch |  | [Details](/attachment.cgi?id=8517597&action=edit) | [Diff](/attachment.cgi?id=8517597&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8517597) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1077687#c0)• 10 years ago |
|  | |

Per [bug 1075336 comment 11](/show_bug.cgi?id=1075336#c11 "VERIFIED FIXED - Heap-use-after-free in mozilla::CustomCounterStyle::IsBullet"), there is some other bug other than the lifetime management problem of CounterStyle, which causes [bug 1075336](/show_bug.cgi?id=1075336 "VERIFIED FIXED - Heap-use-after-free in mozilla::CustomCounterStyle::IsBullet").
In normal case, when any change of styles affect any CounterStyle object, style structs should be reconstructed so that all style structs will use the latest information of counter styles. Hence, when that happens, no style struct should refer to removed CounterStyle objects anymore.
However, [bug 1075336](/show_bug.cgi?id=1075336 "VERIFIED FIXED - Heap-use-after-free in mozilla::CustomCounterStyle::IsBullet") uncovers that there is cases that after a CounterStyle object is remove by the CounterStyleManager, someone could still be using it.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1077687#a332504_1689)• 10 years ago |

Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1077687#c1)• 10 years ago |
|  | |

With [bug 1077718](/show_bug.cgi?id=1077718 "RESOLVED FIXED - Switch dynamic CounterStyle objects to use arena allocation") fixed I think any use-after-free here would be protected by
the poisoning that the arena does.
Xidorn, do you think that the derived class that we didn't arena-allocate
(AnonymousCounterStyle), b/c it's ref-counted anyway, poses any risk for
use-after-free here?Severity: normal → criticalFlags: needinfo?(quanxunzhen)

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1077687#c2)• 10 years ago |
|  | |

If the ref-count mechanism is reliable, I don't think AnonymousCounterStyle poses use-after-free risk here. But as what David said in [bug 1075336 comment 11](/show_bug.cgi?id=1075336#c11 "VERIFIED FIXED - Heap-use-after-free in mozilla::CustomCounterStyle::IsBullet"), that bug indicates some other unknown bug.Flags: needinfo?(quanxunzhen)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1077687#c3)• 10 years ago |
|  | |

OK, it seems to me sec-high is a bit over-pessimistic then, but I guess we should
assume the worst until we know exactly what the problem is.
This bug is rather vague to me; Xidorn, could you debug this and provide more
details about what the error condition is and how to reproduce that error
condition, with relevant details about the sequence of events that leads
us there and why the style system is at fault for that condition to occur?Assignee: nobody → quanxunzhen

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1077687#c4)• 10 years ago |
|  | |

Attached file
[testcase](attachment.cgi?id=8511799)
— [Details](attachment.cgi?id=8511799&action=edit)

The very simplified testcase of this bug.
The conditions to trigger this bug are:
1. <style>#1 with "@counter-style disc {...}" and "li { float: left/right; }"
2. <style>#1 is in <li>#1
2. another non-empty <li> exists
3. the <li>#1 is removed dynamically
setTimeout in the file is not necessary, but it seems that, without a delay, sometimes this bug won't be triggered.

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1077687#c5)• 10 years ago |
|  | |

Attached patch

[patch for explicit crash when the bug appears](attachment.cgi?id=8511801&action=diff)
— [Details](attachment.cgi?id=8511801&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8511801)

Apply this patch to crash the application when the bug appears.

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1077687#a2012985_373403)• 10 years ago |

Assignee: quanxunzhen → nobody

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1077687#c6)• 10 years ago |
|  | |

BTW, I think [attachment 8511799](/attachment.cgi?id=8511799 "testcase") [[details]](/attachment.cgi?id=8511799&action=edit "testcase") could be the crashtest for [bug 1075336](/show_bug.cgi?id=1075336 "VERIFIED FIXED - Heap-use-after-free in mozilla::CustomCounterStyle::IsBullet").

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1077687#c7)• 10 years ago |
|  | |

Attached file
[stack](attachment.cgi?id=8512047)
— [Details](attachment.cgi?id=8512047&action=edit)

Thanks, that makes it clear what the issue is.
In nsPresContext::FlushCounterStyles()
<http://mxr.mozilla.org/mozilla-central/source/layout/base/nsPresContext.cpp?rev=968aa79b1200#2203>
we first call 1. NotifyCounterStylesAreDirty() which is what removes the
style from mCacheTable in the CounterStyleManager (synchronously) and
then 2. PostRebuildAllStyleDataEvent which posts a request to rebuild
all style data at the next refresh driver tick (asynchronously) .
This is the stack with Xidorn's patch above, indicating the bad access.
We entered ProcessPendingRestyles with mRebuildAllStyleData == true
which indicates that 2 hasn't happened yet, so we're operating with
stale style data.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1077687#c8)• 10 years ago |
|  | |

Attached patch

[wip](attachment.cgi?id=8512052&action=diff) (obsolete)
— [Details](attachment.cgi?id=8512052&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8512052)

I don't think ProcessPendingRestyles should process individual restyles when
there's a pending request to rebuild all style data. It should just rebuild
all style data directly.
<https://treeherder.mozilla.org/ui/#/jobs?repo=try&revision=ee12645c45f6>Assignee: nobody → mats

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1077687#c9)• 10 years ago |
|  | |

Interesting, the patch triggers the following assertion on Android 4.0 (but nowhere else?!):
ASSERTION: NS\_BLOCK\_HAS\_FIRST\_LETTER\_STYLE state out of sync: 'haveFirstLetterStyle == ((mState & NS\_BLOCK\_HAS\_FIRST\_LETTER\_STYLE) != 0)', file /builds/slave/try-and-d-00000000000000000000/build/layout/generic/nsBlockFrame.cpp, line 6540
layout/reftests/forms/button/first-letter-1.html (4 assertions)
layout/reftests/forms/button/first-letter-1-ref.html (2 assertions)
I believe this is an existing bug that is uncovered by the patch.
Not really a layout bug though, just a false positive assertion.
New Try run with that fixed:
<https://treeherder.mozilla.org/ui/#/jobs?repo=try&revision=5518af68d629>

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1077687#c10)• 10 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=8512703&action=diff)
— [Details](attachment.cgi?id=8512703&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8512703)

(I've submitted a fix for the first-letter assertions separately in [bug 399262](/show_bug.cgi?id=399262 "RESOLVED FIXED - \"ASSERTION: NS_BLOCK_HAS_FIRST_LETTER_STYLE state out of sync\" with select::first-letter").)
FWIW, the patch does cause a log warning on Android to occur more often
than before: "W/GeckoFaviconDecoder( 2100): Can't decode null data: URI."
I have no explanation for that currently; it's investigated/fixed in [bug 1089940](/show_bug.cgi?id=1089940 "RESOLVED FIXED - GeckoFaviconDecoder( 2100): Can't decode null data: URI.").
It also tickles the underlying bug behind the assertions in [bug 1019192](/show_bug.cgi?id=1019192 "NEW - Assertion count mismatch (ASSERTION: style context has old rule node, etc.) during layout/reftests/font-face/download-3-notref.html on Android 4.0 Debug")
slightly differently which is the reason for the assert count changes.
Green on Try:
<https://treeherder.mozilla.org/ui/#/jobs?repo=try&revision=62388857169b>
<https://treeherder.mozilla.org/ui/#/jobs?repo=try&revision=f74fe4424784>
[Attachment #8512052](/attachment.cgi?id=8512052&action=edit "wip") -
Attachment is obsolete: true
[Attachment #8512703](/attachment.cgi?id=8512703&action=edit "fix") -
Flags: review?(roc)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1077687#a2156093_5038)• 10 years ago |

[Attachment #8512703](/attachment.cgi?id=8512703&action=edit "fix") -
Flags: review?(roc) → review+

|  | [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1077687#c11)• 10 years ago |
|  | |

Comment on [attachment 8512703](/attachment.cgi?id=8512703 "fix") [[details]](/attachment.cgi?id=8512703&action=edit "fix") [[diff]](/attachment.cgi?id=8512703&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8512703)
fix
Review of [attachment 8512703](/attachment.cgi?id=8512703 "fix") [[details]](/attachment.cgi?id=8512703&action=edit "fix") [[diff]](/attachment.cgi?id=8512703&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8512703):
-----------------------------------------------------------------
::: layout/base/RestyleManager.cpp
@@ +1533,5 @@
> + RebuildAllStyleData(nsChangeHint(0), nsRestyleHint(0));
> + MOZ\_ASSERT(mPendingRestyles.Count() == 0);
> + return;
> + }
> +
It seems that there is effectively same code at the very end of this function, should we delete that code? If not, I guess we may need some comments about that?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1077687#c12)• 10 years ago |
|  | |

BTW, the "W/GeckoFaviconDecoder" thing turned out to be an unrelated issue - my Try push
was based on a rev that was buggy. I'll provide the details in [bug 1089940](/show_bug.cgi?id=1089940 "RESOLVED FIXED - GeckoFaviconDecoder( 2100): Can't decode null data: URI.").

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1077687#c13)• 10 years ago |
|  | |

(In reply to Xidorn Quan [:xidorn] (UTC+11) from [comment #11](/show_bug.cgi?id=1077687#c11 "RESOLVED FIXED - Style struct may refer to removed CounterStyle object"))
> It seems that there is effectively same code at the very end of this
> function, should we delete that code?
No, because 'mRebuildAllStyleData' could have been set true during the
course of this method.
> If not, I guess we may need some comments about that?
What do you think it should say? The code itself already implies the
above (even more so after my patch) so adding a comment that just points
that out seems redundant.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1077687#c14)• 10 years ago |
|  | |

Comment on [attachment 8512703](/attachment.cgi?id=8512703 "fix") [[details]](/attachment.cgi?id=8512703&action=edit "fix") [[diff]](/attachment.cgi?id=8512703&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8512703)
fix
>[Security approval request comment]
>How easily could an exploit be constructed based on the patch?
I don't think the patch reveals anything specific, other than "restyling".
>Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No.
>Which older supported branches are affected by this flaw?
Gecko 33 and later.
>If not all supported branches, which bug introduced the flaw?
[bug 966166](/show_bug.cgi?id=966166 "RESOLVED FIXED - Implement @counter-style rule").
>Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Same patch should apply on all affected branches.
>How likely is this patch to cause regressions; how much testing does it need?
Hard to say; I'm guessing medium risk for regressions. No special testing needed,
this path is well covered by our tests.
A note on the sec rating: I'm pretty sure it's not exploitable in v36 where we
have [bug 1077718](/show_bug.cgi?id=1077718 "RESOLVED FIXED - Switch dynamic CounterStyle objects to use arena allocation") because the arena poisoning will protect us. We might want to
uplift that patch too as a belt-and-suspenders fix, because I have some doubts
that my patch here fixes the problem completely. I'm pretty sure though, that
it would be a non-exploitable crash with that poisoning.
[Attachment #8512703](/attachment.cgi?id=8512703&action=edit "fix") -
Flags: sec-approval?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1077687#c15)• 10 years ago |
|  | |

> because I have some doubts that my patch here fixes the problem completely
The reason for that is that, as described in [comment 7](/show_bug.cgi?id=1077687#c7 "RESOLVED FIXED - Style struct may refer to removed CounterStyle object"), we're setting the
style data in an invalid state and then waiting for an asynchronous event
to correct that later. My patch here restores the valid state in
ProcessPendingRestyles(), which probably is the next thing that happens
after setting the invalid state, but I'm not entirely sure something else
couldn't slip in and use this invalid data before that. It seems unlikely,
but I can't prove it's impossible.
It seems to me we should take another look at the fragile design here and
see if we can avoid the invalid state altogether. I think the patch here
is good in any case.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1077687#a2341207_1689)• 10 years ago |

Blocks: [966166](/show_bug.cgi?id=966166 "RESOLVED FIXED - Implement @counter-style rule")Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Whiteboard: Less severe in Fx36 because bug 1077718 adds frame poisoning

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1077687#c16)• 10 years ago |
|  | |

> A note on the sec rating: I'm pretty sure it's not exploitable in v36 where we
> have [bug 1077718](/show_bug.cgi?id=1077718 "RESOLVED FIXED - Switch dynamic CounterStyle objects to use arena allocation") because the arena poisoning will protect us.
Fair enough, but in terms of tracking severity for our advisory writing about bugs affecting Firefox 33 users the lack of both bugs equals sec-high. I'd rather leave this one sec-high than move it to the mitigation bug (which is public).
> We might want to uplift that patch too as a belt-and-suspenders fix
Looks like this was done earlier today -- thanks for pushing for it.
[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=affected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)
[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected)
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=affected)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected)
[tracking-firefox34](/buglist.cgi?f1=cf_tracking_firefox34&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B)
[tracking-firefox35](/buglist.cgi?f1=cf_tracking_firefox35&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox35&o1=equals&v1=%2B)Whiteboard: Less severe in Fx36 because bug 1077718 adds frame poisoning → bug 1077718 protects with frame poisoning, backported to Fx34

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1077687#c17)• 10 years ago |
|  | |

Comment on [attachment 8512703](/attachment.cgi?id=8512703 "fix") [[details]](/attachment.cgi?id=8512703&action=edit "fix") [[diff]](/attachment.cgi?id=8512703&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8512703)
fix
sec-approval+
a=dveditz for landing on aurora and beta
[Attachment #8512703](/attachment.cgi?id=8512703&action=edit "fix") -
Flags: sec-approval?
[Attachment #8512703](/attachment.cgi?id=8512703&action=edit "fix") -
Flags: sec-approval+
[Attachment #8512703](/attachment.cgi?id=8512703&action=edit "fix") -
Flags: approval-mozilla-beta+
[Attachment #8512703](/attachment.cgi?id=8512703&action=edit "fix") -
Flags: approval-mozilla-aurora+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1077687#a2387797_75935)• 10 years ago |

[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1077687#c18)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/d2edb76fa2c0>
@sheriff I think we should let this bake for a few days before landing on branches
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1077687#c19)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/d2edb76fa2c0>Status: NEW → RESOLVEDClosed: 10 years agoResolution: --- → FIXEDTarget Milestone: --- → mozilla36

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1077687#c20)• 10 years ago |
|  | |

(In reply to Mats Palmgren (:mats) from [comment #18](/show_bug.cgi?id=1077687#c18 "RESOLVED FIXED - Style struct may refer to removed CounterStyle object"))
> @sheriff I think we should let this bake for a few days before landing on
> branches
Long enough now?Flags: needinfo?(mats)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1077687#c21)• 10 years ago |
|  | |

Yeah, go ahead and land it please. Thanks.Flags: needinfo?(mats)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1077687#c22)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/cb4e1d969e8d>
<https://hg.mozilla.org/releases/mozilla-beta/rev/fdb8b52bea5c>
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1077687#c23)• 10 years ago |
|  | |

Backed out from beta for bustage.
<https://hg.mozilla.org/releases/mozilla-beta/rev/5b4bac2ebf6c>
<https://treeherder.mozilla.org/ui/logviewer.html#?job_id=126309&repo=mozilla-beta>
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)Flags: needinfo?(mats)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1077687#c24)• 10 years ago |
|  | |

Attached patch

[patch for beta](attachment.cgi?id=8517597&action=diff)
— [Details](attachment.cgi?id=8517597&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1077687&attachment=8517597)

Sorry about that, here's the correct patch for beta.
(trivial change, so no need for re-review)Flags: needinfo?(mats) → needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1077687#c25)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/4e78f69ca4a9>
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)Flags: needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1077687#c26)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-b2g34_v2_1/rev/4e78f69ca4a9>
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1077687#a4486953_280903)• 10 years ago |

Whiteboard: bug 1077718 protects with frame poisoning, backported to Fx34 → [adv-main34+] bug 1077718 protects with frame poisoning, backported to Fx34

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1077687#a28806032_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1077687#a52710556_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1077687&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Xidorn Quan [:xidorn] UTC+10](/user_profile?user_id=373403)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_bf1e1b9e_20250125_020538.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2014-83

## Miscellaneous memory safety hazards (rv:34.0 / rv:31.3)

Announced
December 2, 2014
Reporter
Mozilla Developers
Impact
Critical
Products
Firefox, Firefox ESR, Firefox OS, SeaMonkey, Thunderbird
Fixed in

* Firefox 34
* Firefox ESR 31.3
* Firefox OS 2.2
* SeaMonkey 2.31
* Thunderbird 31.3

### Description

Mozilla developers and community identified and fixed several memory safety
bugs in the browser engine used in Firefox and other Mozilla-based products.
Some of these bugs showed evidence of memory corruption under certain
circumstances, and we presume that with enough effort at least some of these
could be exploited to run arbitrary code.

In general these flaws cannot be exploited through email in the
Thunderbird product because scripting is disabled, but are potentially a risk in
browser or browser-like contexts.

### References

Gary Kwong, Randell Jesup, Nils Ohlmeier, Jesse Ruderman, and Max Jonas
Werner reported memory safety problems and crashes that affect Firefox ESR 31.2
and Firefox 33.

* [Memory safety bugs fixed in Firefox ESR 31.3 and Firefox 34](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1042567,1080312,1089207,1072847,1079729) ([CVE-2014-1587](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1587))

Christian Holler, Gary Kwong, Jon Coppeard, Eric Rahm, Byron Campen, Eric
Rescorla, and Xidorn Quan reported memory safety problems and crashes that
affect Firefox 33.

* [Memory safety bugs fixed in Firefox 34.](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1013001,1023158,1064835,1096026,1075546,1086842,1073577,1048517,1026037,1037830,1077687) ([CVE-2014-1588](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1588))

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from blog.mozilla.org_214f5ef1_20250126_051451.html ===

[Skip to content](#content)

[Mozilla](https://blog.mozilla.org/en/)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

* [Internet Culture](https://blog.mozilla.org/en/category/internet-culture/)
  + [Deep Dives](https://blog.mozilla.org/en/category/internet-culture/deep-dives/)
  + [Mozilla Explains](https://blog.mozilla.org/en/category/internet-culture/mozilla-explains/)
  + [Interviews](https://blog.mozilla.org/en/category/internet-culture/interviews/)
  + [Videos](https://blog.mozilla.org/en/category/videos/)
* [Privacy & Security](https://blog.mozilla.org/en/category/privacy-security/)
* [Products](https://blog.mozilla.org/en/category/products/)
  + [Firefox](https://blog.mozilla.org/en/category/products/firefox/)
  + [Pocket](https://blog.mozilla.org/en/category/products/pocket/)
  + [Mozilla VPN](https://blog.mozilla.org/en/category/products/mozilla-vpn/)
* [Mozilla](https://blog.mozilla.org/en/category/mozilla/)
  + [News](https://blog.mozilla.org/en/category/mozilla/news/)
  + [Internet Policy](https://blog.mozilla.org/en/category/mozilla/internet-policy/)
  + [Leadership](https://blog.mozilla.org/en/category/mozilla/leadership/)
    - [Mitchell Baker, CEO](https://blog.mozilla.org/en/author/mitchellmozillacom/)
    - [Mark Surman, ED Foundation](https://blog.mozilla.org/en/author/markmozillafoundation-org/)
    - [Eric Rescorla, Firefox CTO](https://blog.mozilla.org/en/author/ekrmozilla-com/)

[Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

#### Search

Search for:

![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2019/01/mozilla-logo-bw-rgb.png)
## News

Official announcements and press releases

[![Room filled with people listening to a speaker on stage. Demo Day visual image in the background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/Demo_Day_Blog_Header_-1-800x800.jpg)
Mozilla
## Mozilla Builders: Celebrating community-driven innovation in AI

Read More](https://blog.mozilla.org/en/mozilla/mozilla-builders-demo-day/)

[![The Mozilla logo in green on a black background](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/logo-lockup-video-poster-800x800.png)
Mozilla
## Mozilla welcomes new executive team members

Read More](https://blog.mozilla.org/en/mozilla/new-executives/)

[![Decorative image of wrapped gifts in front of an iphone](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/11/moz_header_holiday_firefox-phone-gifts_blue-03.png-800x800.png)
Products
## Shopping for everyone? We’ve got you covered with the Fakespot Holiday Gift Guide 2024

Read More](https://blog.mozilla.org/en/products/shopping-for-everyone-weve-got-you-covered-with-the-fakespot-holiday-gift-guide-2024/)

[![Text: Mozilla Builders](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/Blog-16_9-1920x1080-1-800x800.png)
Mozilla
## 14 AI projects to watch: Mozilla’s first Builders Accelerator cohort kicks off

Read More](https://blog.mozilla.org/en/mozilla/14-ai-projects-to-watch-mozillas-first-builders-accelerator-cohort-kicks-off/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot’s guide to trending back-to-school products

Read More](https://blog.mozilla.org/en/mozilla/news/fakespots-guide-to-trending-back-to-school-products/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## BAFTA Award-Winner Siobhán McSweeney to host Mozilla’s 2nd Annual Rise25 Awards in Dublin, Ireland on Aug. 13

Read More](https://blog.mozilla.org/en/mozilla/bafta-award-winner-siobhan-mcsweeney-to-host-mozillas-2nd-annual-rise25-awards-in-dublin-ireland-on-august-13/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/05/fx_website_meta-image_tips-tricks_alt-04-1-800x800.webp)
Mozilla
## Here’s what we’re working on in Firefox

Read More](https://blog.mozilla.org/en/mozilla/heres-what-were-working-on-in-firefox/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot reveals the product categories with the most and least reliable product reviews

Read More](https://blog.mozilla.org/en/mozilla/news/fakespot-reveals-the-product-categories-with-the-most-and-least-reliable-product-reviews-for-summer-and-back-to-school-shopping/)

[![A dark blue speech bubble with horizontal purple and red bars on a pink background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2020/03/fx_blog_header_announcements_001_1920x1080-800x800.jpg)
Firefox
## Engaging with our Firefox community: Highlights from our recent AMA

Read More](https://blog.mozilla.org/en/products/firefox/engaging-with-our-firefox-community-highlights-from-our-recent-ama/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## Mozilla announces finalists for the 2nd annual Rise25 Awards

Read More](https://blog.mozilla.org/en/mozilla/mozilla-announces-finalists-for-the-2nd-annual-rise25-awards/)

[![Mozilla and Anonym logos](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/blog_1200x800_v2-800x800.png)
Mozilla
## Introducing Anonym: Raising the bar for privacy-preserving digital advertising

Read More](https://blog.mozilla.org/en/mozilla/mozilla-anonym-raising-the-bar-for-privacy-preserving-digital-advertising/)

[![logo - zero with a diagonal line through it, and the letters D, I, N](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/odintbanner-500x500.png)
Mozilla
## Keeping GenAI technologies secure is a shared responsibility

Read More](https://blog.mozilla.org/en/mozilla/keeping-genai-technologies-secure-is-a-shared-responsibility/)

1
[2](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla)
[3](https://blog.mozilla.org/en/category/mozilla/news/page/3?utm_source=www.mozilla)
…
[24](https://blog.mozilla.org/en/category/mozilla/news/page/24?utm_source=www.mozilla)
[next](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla)

![newsletter](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/newsletter.png)

### Keep up with all things Firefox

Get how-tos, advice and news to make your Firefox experience work best for you.

Your e-mail address

Country
- select -
Afghanistan
Akrotiri
Albania
Algeria
American Samoa
Andorra
Angola
Anguilla
Antarctica
Antigua and Barbuda
Argentina
Armenia
Aruba
Ashmore and Cartier Islands
Australia
Austria
Azerbaijan
Bahamas, The
Bahrain
Baker Island
Bangladesh
Barbados
Bassas da India
Belarus
Belgium
Belize
Benin
Bermuda
Bhutan
Bolivia
Bonaire, Sint Eustatius, and Saba
Bosnia and Herzegovina
Botswana
Bouvet Island
Brazil
British Indian Ocean Territory
Brunei
Bulgaria
Burkina Faso
Burma
Burundi
Cabo Verde
Cambodia
Cameroon
Canada
Cayman Islands
Central African Republic
Chad
Chile
China
Christmas Island
Clipperton Island
Cocos (Keeling) Islands
Colombia
Comoros
Congo (Brazzaville)
Congo (Kinshasa)
Cook Islands
Coral Sea Islands
Costa Rica
Croatia
Cuba
Curaçao
Cyprus
Czech Republic
Côte d’Ivoire
Denmark
Dhekelia
Diego Garcia
Djibouti
Dominica
Dominican Republic
Ecuador
Egypt
El Salvador
Equatorial Guinea
Eritrea
Estonia
Ethiopia
Europa Island
Falkland Islands (Islas Malvinas)
Faroe Islands
Fiji
Finland
France
French Guiana
French Polynesia
French Southern and Antarctic Lands
Gabon
Gambia, The
Gaza Strip
Georgia
Germany
Ghana
Gibraltar
Glorioso Islands
Greece
Greenland
Grenada
Guadeloupe
Guam
Guatemala
Guernsey
Guinea
Guinea-Bissau
Guyana
Haiti
Heard Island and McDonald Islands
Honduras
Hong Kong
Howland Island
Hungary
Iceland
India
Indonesia
Iran
Iraq
Ireland
Isle of Man
Israel
Italy
Jamaica
Jan Mayen
Japan
Jarvis Island
Jersey
Johnston Atoll
Jordan
Juan de Nova Island
Kazakhstan
Kenya
Kingman Reef
Kiribati
Korea, North
Korea, South
Kosovo
Kuwait
Kyrgyzstan
Laos
Latvia
Lebanon
Lesotho
Liberia
Libya
Liechtenstein
Lithuania
Luxembourg
Macau
Macedonia
Madagascar
Malawi
Malaysia
Maldives
Mali
Malta
Marshall Islands
Martinique
Mauritania
Mauritius
Mayotte
Mexico
Micronesia, Federated States of
Midway Islands
Moldova
Monaco
Mongolia
Montenegro
Montserrat
Morocco
Mozambique
Namibia
Nauru
Navassa Island
Nepal
Netherlands
New Caledonia
New Zealand
Nicaragua
Niger
Nigeria
Niue
Norfolk Island
Northern Mariana Islands
Norway
Oman
Pakistan
Palau
Palmyra Atoll
Panama
Papua New Guinea
Paracel Islands
Paraguay
Peru
Philippines
Pitcairn Islands
Poland
Portugal
Puerto Rico
Qatar
Reunion
Romania
Russia
Rwanda
Saint Barthelemy
Saint Helena, Ascension, and Tristan da Cunha
Saint Kitts and Nevis
Saint Lucia
Saint Martin
Saint Pierre and Miquelon
Saint Vincent and the Grenadines
Samoa
San Marino
Sao Tome and Principe
Saudi Arabia
Senegal
Serbia
Seychelles
Sierra Leone
Singapore
Sint Maarten
Slovakia
Slovenia
Solomon Islands
Somalia
South Africa
South Georgia and South Sandwich Islands
South Sudan
Spain
Spratly Islands
Sri Lanka
Sudan
Suriname
Svalbard
Swaziland
Sweden
Switzerland
Syria
Taiwan
Tajikistan
Tanzania
Thailand
Timor-Leste
Togo
Tokelau
Tonga
Trinidad and Tobago
Tromelin Island
Tunisia
Turkey
Turkmenistan
Turks and Caicos Islands
Tuvalu
Uganda
Ukraine
United Arab Emirates
United Kingdom
United States
Uruguay
Uzbekistan
Vanuatu
Vatican City
Venezuela
Vietnam
Virgin Islands, British
Virgin Islands, U.S.
Wake Island
Wallis and Futuna
West Bank
Western Sahara
Yemen
Zambia
Zimbabwe

Language
English
Bahasa Indonesia
Deutsch
Español
Français
Polski
Português
Русский
正體中文

Format

 HTML

 Text

I’m okay with Mozilla handling my info as explained in this [Privacy Policy](https://www.mozilla.org/privacy/).

Sign up now
We will only send you
Mozilla-related information.

## Thanks!

If you haven’t previously confirmed a subscription to a Mozilla-related newsletter you may have to do so. Please check your inbox or your spam filter for an e-mail from us.

[Mozilla](https://www.mozilla.org/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Mozilla

* [About](https://www.mozilla.org/about/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Contact Us](https://www.mozilla.org/contact/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Donate](https://donate.mozilla.org/?presets=50,30,20,10&amount=30¤cy=usd&utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Firefox

* [Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Desktop](https://www.mozilla.org/firefox/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Mobile](https://www.mozilla.org/firefox/mobile/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Features](https://www.mozilla.org/firefox/features/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Beta, Nightly, Developer Edition](https://www.mozilla.org/firefox/channel/desktop/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Resources

* [Privacy Hub](https://www.mozilla.org/privacy/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Browser Comparison](https://www.mozilla.org/firefox/browsers/compare/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Brand Standards](https://mozilla.design/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Social

Follow @Firefox

* [Twitter (@mozilla)](https://twitter.com/firefox)
* [Instagram (@mozilla)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)

Follow @Mozilla

* [Twitter (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)

* [Website Privacy Notice](https://www.mozilla.org/privacy/websites/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Legal](https://www.mozilla.org/about/legal/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)



=== Content from www.oracle.com_1aa3bc48_20250125_020538.html ===


* [Skip to content](#maincontent)
* [Accessibility Policy](https://www.oracle.com/corporate/accessibility/)

Products
Industries
Resources
Customers
Partners
Developers
Company

Close Search

Search Oracle.com

* QUICK LINKS
* [Oracle Cloud Infrastructure](/cloud/)
* [Oracle Fusion Cloud Applications](/applications/)
* [Oracle Database](/database/technologies/)
* [Download Java](/java/technologies/downloads/)
* [Careers at Oracle](/careers/)

Search

[Country
![]()](/countries-list.html#countries)

View Accounts

Back
Cloud Account
[Sign in to Cloud](/cloud/sign-in.html)
[Sign Up for Free Cloud Tier](/cloud/free/)

Oracle Account

* [Sign-In](https://www.oracle.com/webapps/redirect/signon?nexturl=)
* [Create an Account](https://profile.oracle.com/myprofile/account/create-account.jspx)

* [Help](/corporate/contact/help.html)
* Sign Out

[Contact Sales](/corporate/contact/ "Contact Sales")

[Menu

Menu](/global-menu-v2/)

* [Security Alerts](/security-alerts/)

# Oracle Solaris Third Party Bulletin - April 2016

## Oracle Solaris Third Party Bulletin - April 2016

### Description

The Oracle Solaris Third Party Bulletin announces patches for one or more security vulnerabilities fixed in third party software that is included in Oracle Solaris distributions. Starting January 20, 2015, Third Party Bulletins are released on the same day when Oracle Critical Patch Updates are released. These bulletins will also be updated on the Tuesday closest to the 17th of the following two months after their release (i.e. the two months between the normal quarterly Critical Patch Update publication dates). In addition, Third Party Bulletins may also be updated for vulnerability fixes deemed too critical to wait for the next monthly update.

**Due to the threat posed by a successful attack, Oracle strongly recommends that customers apply Third Party Bulletin fixes as soon as possible.**

### Patch Availability

Please see My Oracle Support Note [1448883.1](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=98356520554156&id=1448883.1)

### Third Party Bulletin Schedule

Third Party Bulletins are released on the Tuesday closest to the 17th day of January, April, July and October. The next four dates are:

* 19 July 2016
* 18 October 2016
* 17 January 2017
* 18 April 2017

### References

* Oracle Critical Patch Updates and Security Alerts main page  [ [Oracle Technology Network](/security-alerts/) ]
* Oracle Critical Patch Updates and Security Alerts - Frequently Asked Questions [ [CPU FAQ](/security-alerts/cpufaq.html) ]
* Risk Matrix definitions   [ [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html) ]
* Use of Common Vulnerability Scoring System (CVSS) by Oracle   [ [Oracle CVSS Scoring](/security-alerts/cvssscoringsystem.html) ]

### Modification History

| 2017-October-16 | Rev 8. Added 11.3 as Supported Versions Affected for CVE-2016-2108 |
| --- | --- |
| 2016-September-21 | Rev 7. Added new CVEs fixed via Firefox upgrade |
| 2016-July-08 | Rev 6. Added NTP CVEs |
| 2016-June-27 | Rev 5. Added OpenSSL CVE-2016-2177, CVE-2016-2178 |
| 2016-June-20 | Rev 4. Added all CVEs fixed in Solaris 11.3 SRU9.4 |
| 2016-June-10 | Rev 3. Added OpenSSL CVEs |
| 2016-May-31 | Rev 2. Added all CVEs fixed in Solaris 11.3 SRU8.7 |
| 2016-April-19 | Rev 1. Initial Release |

### Oracle Solaris Executive Summary

This Third Party Bulletin contains 53 new security fixes for the Oracle Solaris.  41 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without the need for a username and password.

### Oracle Solaris Risk Matrix

#### Revision 7: Published on 2016-09-21

| CVE# | Component | Protocol | Third Party ­component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2014-1545 | Solaris | Multiple | Firefox | Yes | 10.0 | Network | Low | None | Complete | Complete | Complete | 11.3 | See Note 13 |

#### Revision 6: Published on 2016-07-08

| CVE# | Component | Protocol | Third Party ­component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2016-1548 | Solaris | NTP | NTP | Yes | 6.4 | Network | Low | None | None | Partial | Partial | 11.3, 10 | See Note 11 |
| CVE-2016-4957 | Solaris | NTP | NTP | Yes | 5.0 | Network | Low | None | None | None | Partial | 11.3, 10 |  |
| CVE-2016-4956 | Solaris | NTP | NTP | Yes | 5.0 | Network | Low | None | None | None | Partial | 11.3, 10 |  |
| CVE-2016-4953 | Solaris | NTP | NTP | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3, 10 |  |
| CVE-2016-4954 | Solaris | NTP | NTP | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3, 10 |  |
| CVE-2016-4955 | Solaris | NTP | NTP | Yes | 2.6 | Network | High | None | None | None | Partial | 11.3, 10 |  |

#### Revision 5: Published on 2016-06-27

| CVE# | Component | Protocol | Third Party ­component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2016-2177 | Solaris | SSL/TLS | OpenSSL | Yes | 7.5 | Network | Low | None | Partial | Partial | Partial | 11.3, 10 |  |
| CVE-2016-2178 | Solaris | SSL/TLS | OpenSSL | No | 2.1 | Local | Low | None | Partial | None | None | 11.3, 10 |  |

#### Revision 4: Published on 2016-06-20

| CVE# | Component | Protocol | Third Party ­component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2015-2806 | Solaris | Multiple | GNU Libtasn1 | Yes | 10.0 | Network | Low | None | Complete | Complete | Complete | 11.3 |  |
| CVE-2014-9679 | Solaris | Multiple | Common Unix Printing System (CUPS) | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 11.3 |  |
| CVE-2015-8786 | Solaris | Multiple | RabbitMQ | No | 6.8 | Network | Low | Single | None | None | Complete | 11.3 |  |
| CVE-2015-7546 | Solaris | Multiple | OpenStack Identity (Keystone) | No | 6.0 | Network | Medium | Single | Partial | Partial | Partial | 11.3 |  |
| CVE-2015-5295 | Solaris | Multiple | OpenStack Orchestration API (Heat) | No | 5.5 | Network | Low | Single | Partial | None | Partial | 11.3 |  |
| CVE-2016-3115 | Solaris | SSH | OpenSSH | No | 5.5 | Network | Low | Single | Partial | Partial | None | 11.3 |  |
| CVE-2015-5223 | Solaris | Multiple | OpenStack Object Storage (Swift) | Yes | 5.0 | Network | Low | None | Partial | None | None | 11.3 |  |
| CVE-2016-0738 | Solaris | Multiple | OpenStack Object Storage (Swift) | Yes | 5.0 | Network | Low | None | None | None | Partial | 11.3 | See Note 8 |
| CVE-2015-8853 | Solaris | Multiple | Perl | Yes | 5.0 | Network | Low | None | None | None | Partial | 11.3 |  |
| CVE-2015-8665 | Solaris | Multiple | LibTIFF | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8683 | Solaris | Multiple | LibTIFF | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2015-8781 | Solaris | Multiple | LibTIFF | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3, 10 | See Note 9 |
| CVE-2015-1547 | Solaris | Multiple | LibTIFF | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3, 10 | See Note 10 |
| CVE-2016-2512 | Solaris | Multiple | Django Python web framework | Yes | 4.3 | Network | Medium | None | None | Partial | None | 11.3 |  |
| CVE-2016-4085 | Solaris | Multiple | Wireshark | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 | See Note 12 |
| CVE-2016-2513 | Solaris | Multiple | Django Python web framework | Yes | 2.6 | Network | High | None | Partial | None | None | 11.3 |  |

#### Revision 3: Published on 2016-06-10

| CVE# | Component | Protocol | Third Party ­component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2016-2108 | Solaris | SSL/TLS | OpenSSL | Yes | 10.0 | Network | Low | None | Complete | Complete | Complete | 11.3, 10 |  |
| CVE-2016-2109 | Solaris | SSL/TLS | OpenSSL | Yes | 7.8 | Network | Low | None | None | None | Complete | 11.3, 10 |  |
| CVE-2016-2176 | Solaris | SSL/TLS | OpenSSL | Yes | 6.4 | Network | Low | None | Partial | None | Partial | 11.3, 10 |  |
| CVE-2016-2105 | Solaris | SSL/TLS | OpenSSL | Yes | 5.0 | Network | Low | None | None | None | Partial | 11.3, 10 |  |
| CVE-2016-2106 | Solaris | SSL/TLS | OpenSSL | Yes | 5.0 | Network | Low | None | None | None | Partial | 11.3, 10 |  |
| CVE-2016-2107 | Solaris | SSL/TLS | OpenSSL | Yes | 2.6 | Network | High | None | Partial | None | None | 11.3, 10 | See Note 7 |

#### Revision 2: Published on 2016-05-31

| CVE# | Component | Protocol | Third Party ­component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2016-2315 | Solaris | Multiple | Git | Yes | 10.0 | Network | Low | None | Complete | Complete | Complete | 11.3 | See Note 5 |
| CVE-2016-2342 | Solaris | Multiple | Quagga | Yes | 7.6 | Network | High | None | Complete | Complete | Complete | 11.3 |  |
| CVE-2015-7545 | Solaris | Multiple | Git | Yes | 7.5 | Network | Low | None | Partial | Partial | Partial | 11.3 |  |
| CVE-2015-2695 | Solaris | Kerberos | Kerberos | Yes | 7.1 | Network | Medium | None | None | None | Complete | 11.3 |  |
| CVE-2015-2697 | Solaris | Kerberos | Kerberos | No | 6.8 | Network | Low | Single | None | None | Complete | 11.3 |  |
| CVE-2016-3068 | Solaris | Multiple | Mercurial source code management | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 11.3 | See Note 4 |
| CVE-2016-3115 | Solaris | SSH | SSH | No | 5.5 | Network | Low | Single | Partial | Partial | None | 11.3, 10 |  |
| CVE-2014-3566 | Solaris | SSL | Evolution | Yes | 5.0 | Network | Low | None | Partial | None | None | 11.3 |  |
| CVE-2015-7551 | Solaris | None | Ruby | No | 4.6 | Local | Low | None | Partial | Partial | Partial | 11.3 |  |
| CVE-2015-8629 | Solaris | Kerberos | Kerberos | No | 2.1 | Network | High | Single | Partial | None | None | 11.3, 10 |  |

#### Revision 1: Published on 2016-04-19

| CVE# | Component | Protocol | Third Party ­component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2016-0705 | Solaris | SSL/TLS | OpenSSL | Yes | 10.0 | Network | Low | None | Complete | Complete | Complete | 11.3, 10 |  |
| CVE-2016-0799 | Solaris | SSL/TLS | WanBoot | Yes | 10.0 | Network | Low | None | Complete | Complete | Complete | 10 | See Note 1 |
| CVE-2016-0798 | Solaris | SSL/TLS | OpenSSL | Yes | 7.8 | Network | Low | None | None | None | Complete | 11.3, 10 |  |
| CVE-2015-3415 | Solaris | Multiple | SQLite3 | Yes | 7.5 | Network | Low | None | Partial | Partial | Partial | 11.3, 10 | See Note 3 |
| CVE-2015-5602 | Solaris | None | Sudo | No | 7.2 | Local | Low | None | Complete | Complete | Complete | 11.3, 10 |  |
| CVE-2015-4752 | Solaris | None | MySQL | No | 7.2 | Local | Low | None | Complete | Complete | Complete | 11.3 | See Note 2 |
| CVE-2016-2523 | Solaris | Multiple | Wireshark | Yes | 7.1 | Network | Medium | None | None | None | Complete | 11.3 |  |
| CVE-2016-1283 | Solaris | Multiple | PCRE | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 11.3 |  |
| CVE-2014-9766 | Solaris | Multiple | X.Org | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 11.3, 10 |  |
| CVE-2015-3885 | Solaris | Multiple | Dcraw | Yes | 4.3 | Network | Medium | None | None | None | Partial | 11.3 |  |
| CVE-2007-6720 | Solaris | Multiple | Libmikmod | Yes | 2.6 | Network | High | None | None | None | Partial | 11.3 |  |
| CVE-2016-0702 | Solaris | None | OpenSSL | No | 1.9 | Local | Medium | None | Partial | None | None | 11.3, 10 | See Note 6 |

#### Notes:

1. This fix also addresses CVE-2016-0703 CVE-2016-0704 CVE-2016-0797 CVE-2016-0800.
2. This fix also addresses CVE-2014-6464 CVE-2014-6469 CVE-2014-6491 CVE-2014-6494 CVE-2014-6500 CVE-2014-6507 CVE-2014-6555 CVE-2014-6559 CVE-2014-6568 CVE-2015-0374 CVE-2015-0382 CVE-2015-0411 CVE-2015-0432 CVE-2015-0433 CVE-2015-0499 CVE-2015-0505 CVE-2015-2568 CVE-2015-2571 CVE-2015-2573 CVE-2015-2582 CVE-2015-2620 CVE-2015-2643 CVE-2015-2648 CVE-2015-4737 CVE-2015-4792 CVE-2015-4802 CVE-2015-4807 CVE-2015-4815 CVE-2015-4816 CVE-2015-4819 CVE-2015-4826 CVE-2015-4830 CVE-2015-4836 CVE-2015-4858 CVE-2015-4861 CVE-2015-4864 CVE-2015-4870 CVE-2015-4879 CVE-2015-4913 CVE-2015-7744 CVE-2016-0505 CVE-2016-0546 CVE-2016-0596 CVE-2016-0597 CVE-2016-0598 CVE-2016-0600 CVE-2016-0606 CVE-2016-0608 CVE-2016-0609 CVE-2016-0616.
3. This fix also addresses CVE-2015-3414 CVE-2015-3416.
4. This fix also addresses CVE-2016-3069 CVE-2016-3630.
5. This fix also addresses CVE-2016-2324.
6. This fix also addresses CVE-2016-0702 CVE-2016-0797 CVE-2016-0799.
7. This fix also addresses CVE-2016-2106 CVE-2016-2107 CVE-2016-2108 CVE-2016-2109 CVE-2016-2176.
8. This fix also addresses CVE-2016-0737.
9. This fix also addresses CVE-2015-8782 CVE-2015-8783.
10. This fix also addresses CVE-2015-8784.
11. This fix also addresses CVE-2016-1551 CVE-2016-1549 CVE-2016-2516 CVE-2016-2517 CVE-2016-2518 CVE-2016-2519 CVE-2016-1547 CVE-2015-7704 CVE-2015-8138 CVE-2016-1550.
12. This fix also addresses CVE-2016-4085.
13. This fix also addresses CVE-2013-5609 CVE-2013-5610 CVE-2013-5611 CVE-2013-5612 CVE-2013-5613 CVE-2013-5614 CVE-2013-5615 CVE-2013-5616 CVE-2013-5618 CVE-2013-5619 CVE-2013-6629 CVE-2013-6630 CVE-2013-6671 CVE-2013-6672 CVE-2013-6673 CVE-2014-1477 CVE-2014-1478 CVE-2014-1479 CVE-2014-1480 CVE-2014-1481 CVE-2014-1482 CVE-2014-1483 CVE-2014-1484 CVE-2014-1485 CVE-2014-1486 CVE-2014-1487 CVE-2014-1488 CVE-2014-1489 CVE-2014-1493 CVE-2014-1494 CVE-2014-1496 CVE-2014-1497 CVE-2014-1498 CVE-2014-1499 CVE-2014-1500 CVE-2014-1501 CVE-2014-1502 CVE-2014-1504 CVE-2014-1505 CVE-2014-1506 CVE-2014-1507 CVE-2014-1508 CVE-2014-1509 CVE-2014-1510 CVE-2014-1511 CVE-2014-1512 CVE-2014-1513 CVE-2014-1514 CVE-2014-1518 CVE-2014-1519 CVE-2014-1520 CVE-2014-1522 CVE-2014-1523 CVE-2014-1524 CVE-2014-1525 CVE-2014-1526 CVE-2014-1527 CVE-2014-1528 CVE-2014-1529 CVE-2014-1530 CVE-2014-1531 CVE-2014-1532 CVE-2014-1533 CVE-2014-1534 CVE-2014-1536 CVE-2014-1537 CVE-2014-1538 CVE-2014-1539 CVE-2014-1540 CVE-2014-1541 CVE-2014-1542 CVE-2014-1543 CVE-2014-1544 CVE-2014-1547 CVE-2014-1548 CVE-2014-1549 CVE-2014-1550 CVE-2014-1551 CVE-2014-1552 CVE-2014-1553 CVE-2014-1554 CVE-2014-1555 CVE-2014-1556 CVE-2014-1557 CVE-2014-1559 CVE-2014-1561 CVE-2014-1562 CVE-2014-1563 CVE-2014-1564 CVE-2014-1565 CVE-2014-1566 CVE-2014-1567 CVE-2014-1568 CVE-2014-1569 CVE-2014-1575 CVE-2014-1580 CVE-2014-1582 CVE-2014-1584 CVE-2014-1588 CVE-2014-1589 CVE-2014-1591 CVE-2014-1595 CVE-2014-2018 CVE-2014-8631 CVE-2014-8632 CVE-2014-8635 CVE-2014-8636 CVE-2014-8637 CVE-2014-8640 CVE-2014-8642 CVE-2014-8643 CVE-2015-0797 CVE-2015-0798 CVE-2015-0799 CVE-2015-0800 CVE-2015-0802 CVE-2015-0803 CVE-2015-0804 CVE-2015-0805 CVE-2015-0806 CVE-2015-0808 CVE-2015-0810 CVE-2015-0811 CVE-2015-0812 CVE-2015-0814 CVE-2015-0819 CVE-2015-0820 CVE-2015-0821 CVE-2015-0823 CVE-2015-0824 CVE-2015-0825 CVE-2015-0826 CVE-2015-0828 CVE-2015-0829 CVE-2015-0830 CVE-2015-0832 CVE-2015-0833 CVE-2015-0834 CVE-2015-0835 CVE-2015-2706 CVE-2015-2708 CVE-2015-2709 CVE-2015-2710 CVE-2015-2711 CVE-2015-2712 CVE-2015-2713 CVE-2015-2714 CVE-2015-2715 CVE-2015-2716 CVE-2015-2717 CVE-2015-2718 CVE-2015-2720 CVE-2015-2721 CVE-2015-2722 CVE-2015-2724 CVE-2015-2725 CVE-2015-2726 CVE-2015-2727 CVE-2015-2728 CVE-2015-2729 CVE-2015-2730 CVE-2015-2731 CVE-2015-2733 CVE-2015-2734 CVE-2015-2735 CVE-2015-2736 CVE-2015-2737 CVE-2015-2738 CVE-2015-2739 CVE-2015-2740 CVE-2015-2741 CVE-2015-2742 CVE-2015-2743 CVE-2015-4473 CVE-2015-4474 CVE-2015-4475 CVE-2015-4476 CVE-2015-4477 CVE-2015-4478 CVE-2015-4479 CVE-2015-4480 CVE-2015-4481 CVE-2015-4482 CVE-2015-4483 CVE-2015-4484 CVE-2015-4485 CVE-2015-4486 CVE-2015-4487 CVE-2015-4488 CVE-2015-4489 CVE-2015-4490 CVE-2015-4491 CVE-2015-4492 CVE-2015-4493 CVE-2015-4495 CVE-2015-4496 CVE-2015-4497 CVE-2015-4498 CVE-2015-4500 CVE-2015-4501 CVE-2015-4502 CVE-2015-4503 CVE-2015-4504 CVE-2015-4505 CVE-2015-4506 CVE-2015-4507 CVE-2015-4508 CVE-2015-4509 CVE-2015-4510 CVE-2015-4511 CVE-2015-4512 CVE-2015-4513 CVE-2015-4514 CVE-2015-4515 CVE-2015-4516 CVE-2015-4517 CVE-2015-4518 CVE-2015-4519 CVE-2015-4520 CVE-2015-4521 CVE-2015-4522 CVE-2015-7174 CVE-2015-7175 CVE-2015-7176 CVE-2015-7177 CVE-2015-7178 CVE-2015-7179 CVE-2015-7180 CVE-2015-7181 CVE-2015-7182 CVE-2015-7183 CVE-2015-7184 CVE-2015-7185 CVE-2015-7186 CVE-2015-7187 CVE-2015-7188 CVE-2015-7189 CVE-2015-7190 CVE-2015-7191 CVE-2015-7192 CVE-2015-7193 CVE-2015-7194 CVE-2015-7195 CVE-2015-7196 CVE-2015-7197 CVE-2015-7198 CVE-2015-7199 CVE-2015-7200.

Resources for

* [Careers](/careers/)
* [Developers](/developer/)
* [Investors](https://investor.oracle.com/home/default.aspx)
* [Partners](/partner/)
* [Researchers](/research/)
* [Students and Educators](https://academy.oracle.com/en/oa-web-overview.html)

Why Oracle

* [Analyst Reports](/corporate/analyst-reports/)
* [Best cloud-based
  ERP](/erp/what-is-erp/best-erp/)
* [Cloud Economics](/cloud/economics/)
* [Social Impact](/social-impact/)
* [Culture and Inclusion](/careers/diversity-inclusion/)
* [Security Practices](/corporate/security-practices/)

Learn

* [What is cloud
  computing?](/cloud/what-is-cloud-computing/)
* [What is CRM?](/cx/what-is-crm/)
* [What is
  Docker?](/cloud/cloud-native/container-registry/what-is-docker/)
* [What is
  Kubernetes?](/cloud/cloud-native/kubernetes-engine/what-is-kubernetes/)
* [What is
  Python?](/developer/what-is-python-for-developers/)
* [What is SaaS?](/applications/what-is-saas/)

News and Events

* [News](/news/)
* [Oracle CloudWorld](/cloudworld/)
* [Oracle CloudWorld Tour](/cloudworld-tour/)
* [Oracle Health Summit](/health/health-summit/)
* [Oracle Dev Tour](/developer/dev-tour/)
* [Search all events](https://search.oracle.com/events?q=&lang=english)

Contact Us

* US Sales: +1.800.633.0738
* [How can we help?](/corporate/contact/)
* [Subscribe to emails](https://go.oracle.com/subscribe/?l_code=en&src1=OW:O:FO)
* [Integrity Helpline](https://secure.ethicspoint.com/domain/media/en/gui/31053/index.html)
* [Accessibility](/corporate/accessibility/)

---

* [Country/Region](/universal-menu/#u10countrymenu)

* [© 2025 Oracle](/legal/copyright/)
* [Privacy](/legal/privacy/)/[Do Not Sell My
  Info](/legal/privacy/privacy-choices/)
* [Ad
  Choices](/legal/privacy/privacy-policy/#adchoices)
* [Careers](/corporate/careers/)



=== Content from bugzilla.mozilla.org_612f053e_20250125_020549.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1048517)
* [XML](/show_bug.cgi?ctype=xml&id=1048517)

Closed
[Bug 1048517](/show_bug.cgi?id=1048517)

Opened 10 years ago
Closed 10 years ago

# [libstagefright] |MPEG4Source::read| has several potential uninitialized variable errors

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[libstagefright] |MPEG4Source::read| has several potential uninitialized variable errors

## Categories

### (Core :: Audio/Video, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Audio%2FVideo#Audio%2FVideo)

Audio/Video
▾

Core :: Audio/Video
For problems related to media (video/audio) -- especially when the reporter is not sure which area of the media stack the problem is in. This category will mostly be for untriaged video/audio issues. Bugs in this category will typically be moved to another media category during the triage process.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Audio%2FVideo)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla34

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox34 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) |
| firefox-esr31 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=wontfix) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox34 |  | fixed |
| firefox-esr31 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: erahm, Assigned: ajones)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c511186c5469f5f88538c42f94c71a65?d=mm&size=40)  [ajones](/user_profile?user_id=443088)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/106da6447bb158720110ea58f6a20676?d=mm&size=40)  [erahm](/user_profile?user_id=496127)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[coverity-analysis](/show_bug.cgi?id=1230156 "NEW - [meta] Coverity Static Analysis fixes")

Dependency [tree](/showdependencytree.cgi?id=1048517&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1048517)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: coverity, sec-moderate, Whiteboard: [CID 1221246] [CID 1221247] [CID 1221248] [CID 1221249] [CID 1221250] [CID 1225496][adv-main34+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[coverity](/buglist.cgi?keywords=coverity&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[CID 1221246] [CID 1221247] [CID 1221248] [CID 1221249] [CID 1221250] [CID 1225496][adv-main34+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [CID 1221247](/attachment.cgi?id=8467297)  [10 years ago](#c1)  [Eric Rahm [:erahm]](/user_profile?user_id=496127)   11.34 KB, text/plain |  | [Details](/attachment.cgi?id=8467297&action=edit) |
| --- | --- | --- |
| [CID 1221248](/attachment.cgi?id=8467299)  [10 years ago](#c2)  [Eric Rahm [:erahm]](/user_profile?user_id=496127)   11.99 KB, text/plain |  | [Details](/attachment.cgi?id=8467299&action=edit) |
| [CID 1221249](/attachment.cgi?id=8467301)  [10 years ago](#c3)  [Eric Rahm [:erahm]](/user_profile?user_id=496127)   8.59 KB, text/plain |  | [Details](/attachment.cgi?id=8467301&action=edit) |
| [CID 1221250](/attachment.cgi?id=8467302)  [10 years ago](#c4)  [Eric Rahm [:erahm]](/user_profile?user_id=496127)   8.59 KB, text/plain |  | [Details](/attachment.cgi?id=8467302&action=edit) |
| [CID 1225496](/attachment.cgi?id=8467303)  [10 years ago](#c5)  [Eric Rahm [:erahm]](/user_profile?user_id=496127)   11.55 KB, text/plain |  | [Details](/attachment.cgi?id=8467303&action=edit) |
| [Initialised potentially uninitialised variables](/attachment.cgi?id=8467364)  [10 years ago](#c6)  [Anthony Jones (:ajones, :kentuckyfriedtakahe, :k17e)](/user_profile?user_id=443088)   1.75 KB, patch | cpearce : [review+](#a196113_287422 "10 years ago") | [Details](/attachment.cgi?id=8467364&action=edit) | [Diff](/attachment.cgi?id=8467364&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1048517&attachment=8467364) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Eric Rahm [:erahm]](/user_profile?user_id=496127)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1048517#c0)• 10 years ago |
|  | |

Coverity has flagged at least five potential uninitialized variable issues in |MPEG4Source::read| [1].
#1 - |offset| can be used uninitialized in buffer reads [2],[3]
#2 - |size| can be used uninitialized in buffer reads [2],[3]
#3 - |cts| can be used uninitialized when setting buffer metadata [4]
#4 - |duration| can be used uninitialized when setting buffer metadata [5]
#5 - |isSyncSample| can be used uninitialized in an if statement [6]
I will attach the Coverity analysis as well, it's somewhat convoluted but generally the issues arise if we take the false branch of |if (!mIsAVC || mWantsNALFragments)| [7].
[1] - <http://hg.mozilla.org/mozilla-central/annotate/71497ed2e0db/media/libstagefright/frameworks/av/media/libstagefright/MPEG4Extractor.cpp#l3079>
[2] - <http://hg.mozilla.org/mozilla-central/annotate/71497ed2e0db/media/libstagefright/frameworks/av/media/libstagefright/MPEG4Extractor.cpp#l3288>
[3] - <http://hg.mozilla.org/mozilla-central/annotate/71497ed2e0db/media/libstagefright/frameworks/av/media/libstagefright/MPEG4Extractor.cpp#l3290>
[4] - <http://hg.mozilla.org/mozilla-central/annotate/71497ed2e0db/media/libstagefright/frameworks/av/media/libstagefright/MPEG4Extractor.cpp#l3349>
[5] - <http://hg.mozilla.org/mozilla-central/annotate/71497ed2e0db/media/libstagefright/frameworks/av/media/libstagefright/MPEG4Extractor.cpp#l3351>
[6] - <http://hg.mozilla.org/mozilla-central/annotate/71497ed2e0db/media/libstagefright/frameworks/av/media/libstagefright/MPEG4Extractor.cpp#l3358>
[7] - <http://hg.mozilla.org/mozilla-central/annotate/71497ed2e0db/media/libstagefright/frameworks/av/media/libstagefright/MPEG4Extractor.cpp#l3280>

|  | [Eric Rahm [:erahm]](/user_profile?user_id=496127)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1048517#c1)• 10 years ago |
|  | |

Attached file
[CID 1221247](attachment.cgi?id=8467297)
— [Details](attachment.cgi?id=8467297&action=edit)

|  | [Eric Rahm [:erahm]](/user_profile?user_id=496127)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1048517#c2)• 10 years ago |
|  | |

Attached file
[CID 1221248](attachment.cgi?id=8467299)
— [Details](attachment.cgi?id=8467299&action=edit)

|  | [Eric Rahm [:erahm]](/user_profile?user_id=496127)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1048517#c3)• 10 years ago |
|  | |

Attached file
[CID 1221249](attachment.cgi?id=8467301)
— [Details](attachment.cgi?id=8467301&action=edit)

|  | [Eric Rahm [:erahm]](/user_profile?user_id=496127)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1048517#c4)• 10 years ago |
|  | |

Attached file
[CID 1221250](attachment.cgi?id=8467302)
— [Details](attachment.cgi?id=8467302&action=edit)

|  | [Eric Rahm [:erahm]](/user_profile?user_id=496127)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1048517#c5)• 10 years ago |
|  | |

Attached file
[CID 1225496](attachment.cgi?id=8467303)
— [Details](attachment.cgi?id=8467303&action=edit)

|  | [Eric Rahm [:erahm]](/user_profile?user_id=496127)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a1074_496127)• 10 years ago |

Whiteboard: [CID 1221247] [CID 1221248] [CID 1221249] [CID 1221250] [CID 1225496] → [CID 1221246] [CID 1221247] [CID 1221248] [CID 1221249] [CID 1221250] [CID 1225496]

|  | [Anthony Jones (:ajones, :kentuckyfriedtakahe, :k17e)](/user_profile?user_id=443088)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1048517#c6)• 10 years ago |
|  | |

Attached patch

[Initialised potentially uninitialised variables](attachment.cgi?id=8467364&action=diff)
— [Details](attachment.cgi?id=8467364&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1048517&attachment=8467364)

[Attachment #8467364](/attachment.cgi?id=8467364&action=edit "Initialised potentially uninitialised variables") -
Flags: review?(erahm)

|  | [Anthony Jones (:ajones, :kentuckyfriedtakahe, :k17e)](/user_profile?user_id=443088)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a5289_443088)• 10 years ago |

Assignee: nobody → ajonesStatus: NEW → ASSIGNED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a78231_1689)• 10 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Anthony Jones (:ajones, :kentuckyfriedtakahe, :k17e)](/user_profile?user_id=443088)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a196083_443088)• 10 years ago |

[Attachment #8467364](/attachment.cgi?id=8467364&action=edit "Initialised potentially uninitialised variables") -
Flags: review?(erahm) → review?(cpearce)

|  | [Chris Pearce [:cpearce (Not reading bugmail)]](/user_profile?user_id=287422) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a196113_287422)• 10 years ago |

[Attachment #8467364](/attachment.cgi?id=8467364&action=edit "Initialised potentially uninitialised variables") -
Flags: review?(cpearce) → review+

|  | [Anthony Jones (:ajones, :kentuckyfriedtakahe, :k17e)](/user_profile?user_id=443088)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1048517#c7)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/06b830f9b0e7>

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1048517#c8)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/06b830f9b0e7>Status: ASSIGNED → RESOLVEDClosed: 10 years ago
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla34

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1048517#c9)• 10 years ago |
|  | |

How far back does this issue go?

|  | [Anthony Jones (:ajones, :kentuckyfriedtakahe, :k17e)](/user_profile?user_id=443088)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1048517#c10)• 10 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #9](/show_bug.cgi?id=1048517#c9 "RESOLVED FIXED - [libstagefright] |MPEG4Source::read| has several potential uninitialized variable errors"))
> How far back does this issue go?
It has always been pref'ed off in Firefox but this code is used on all Android phones in their system libraries. If this bug is exploitable then Fennec is exposed to it until we move away from using the system libstagefright MP4 demuxer.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a8738070_280903)• 10 years ago |

[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=%3F)
[tracking-firefox-esr31](/buglist.cgi?f1=cf_tracking_firefox_esr31&o1=isnotempty):
--- → [-](/buglist.cgi?f1=cf_tracking_firefox_esr31&o1=equals&v1=-)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a9433280_280903)• 10 years ago |

[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=wontfix)
[tracking-firefox-esr31](/buglist.cgi?f1=cf_tracking_firefox_esr31&o1=isnotempty):
[-](/buglist.cgi?f1=cf_tracking_firefox_esr31&o1=equals&v1=-) → ---Whiteboard: [CID 1221246] [CID 1221247] [CID 1221248] [CID 1221249] [CID 1221250] [CID 1225496] → [CID 1221246] [CID 1221247] [CID 1221248] [CID 1221249] [CID 1221250] [CID 1225496][adv-main34+]

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a33991870_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a57896060_1689)• 9 years ago |

Group: core-security-release

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1048517#a123716320_495955)• 7 years ago |

Blocks: [coverity-analysis](/show_bug.cgi?id=1230156 "NEW - [meta] Coverity Static Analysis fixes")
You need to [log in](/show_bug.cgi?id=1048517&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Eric Rahm [:erahm]](/user_profile?user_id=496127)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_b188c83d_20250125_020602.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1086842)
* [XML](/show_bug.cgi?ctype=xml&id=1086842)

Closed
[Bug 1086842](/show_bug.cgi?id=1086842)

Opened 10 years ago
Closed 10 years ago

# Assertion failure: [infer failure] Missing type in object [0x10512ecf0] value: [0x10512e858], at js/src/jsinfer.cpp

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: [infer failure] Missing type in object [0x10512ecf0] value: [0x10512e858], at js/src/jsinfer.cpp

## Categories

### (Core :: JavaScript Engine: JIT, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT#JavaScript%20Engine%3A%20JIT)

JavaScript Engine: JIT
▾

Core :: JavaScript Engine: JIT
JavaScript engine's JIT compilers
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla36

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox33 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix) |
| firefox34 | [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) |
| firefox35 | [+](/buglist.cgi?f1=cf_tracking_firefox35&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed) |
| firefox36 | [+](/buglist.cgi?f1=cf_tracking_firefox36&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed) |
| firefox-esr31 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected) |
| b2g-v1.4 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected) |
| b2g-v2.0 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=fixed) |
| b2g-v2.0M | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=fixed) |
| b2g-v2.1 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox33 |  | wontfix |
| firefox34 | + | fixed |
| firefox35 | + | fixed |
| firefox36 | + | fixed |
| firefox-esr31 |  | unaffected |
| b2g-v1.4 |  | unaffected |
| b2g-v2.0 |  | fixed |
| b2g-v2.0M |  | fixed |
| b2g-v2.1 |  | fixed |
| b2g-v2.2 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: jandem)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/709c5feed942bf99f098bb24aa1cc86f?d=mm&size=40)  [jandem](/user_profile?user_id=375297)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1000942](/show_bug.cgi?id=1000942 "RESOLVED FIXED - Eliminate some unnecessary object type barriers")

Dependency [tree](/showdependencytree.cgi?id=1086842&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1086842)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [jsbugmon:update][adv-main34+][b2g-adv-main2.2-])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:update][adv-main34+][b2g-adv-main2.2-]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [stack](/attachment.cgi?id=8508883)  [10 years ago](#c1)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   4.98 KB, text/plain |  | [Details](/attachment.cgi?id=8508883&action=edit) |
| --- | --- | --- |
| [Part 1 - Fix](/attachment.cgi?id=8511153)  [10 years ago](#c2)  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)   2.49 KB, patch | bhackett1024 : [review+](#a257805_346231 "10 years ago")  dveditz : [approval-mozilla-aurora+](#c6 "10 years ago")  dveditz : [approval-mozilla-beta+](#c6 "10 years ago")  dveditz : [sec-approval+](#c6 "10 years ago") | [Details](/attachment.cgi?id=8511153&action=edit) | [Diff](/attachment.cgi?id=8511153&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1086842&attachment=8511153) |
| [Part 2 - Add debug checks](/attachment.cgi?id=8511162)  [10 years ago](#c3)  [Jan de Mooij [:jandem]](/user_profile?user_id=375297)   1.17 KB, patch | bhackett1024 : [review+](#a257865_346231 "10 years ago") | [Details](/attachment.cgi?id=8511162&action=edit) | [Diff](/attachment.cgi?id=8511162&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1086842&attachment=8511162) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1086842#c0)• 10 years ago |
|  | |

x = []
for (v of x) {}
Object.defineProperty(x, 1, {})
Set(Object.create([0, Number, []]))
asserts js debug shell on m-c changeset 33c0181c4a25 with --ion-eager --no-threads at Assertion failure: [infer failure] Missing type in object [0x10512ecf0] value: [0x10512e858], at js/src/jsinfer.cpp.
Debug configure options:
CC="clang -Qunused-arguments" CXX="clang++ -Qunused-arguments" AR=ar sh /Users/skywalker/trees/mozilla-central/js/src/configure --target=x86\_64-apple-darwin12.5.0 --enable-debug --enable-optimize --enable-nspr-build --enable-more-deterministic --with-ccache --enable-gczeal --enable-debug-symbols --disable-tests
autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: <https://hg.mozilla.org/mozilla-central/rev/2048240a81d2>
user: Jan de Mooij
date: Tue Apr 29 08:54:46 2014 +0200
summary: [Bug 1000942](/show_bug.cgi?id=1000942 "RESOLVED FIXED - Eliminate some unnecessary object type barriers") - Eliminate some unnecessary object type barriers. r=bhackett
Setting s-s and assuming sec-critical because this is a type inference failure.
Jan, is [bug 1000942](/show_bug.cgi?id=1000942 "RESOLVED FIXED - Eliminate some unnecessary object type barriers") a possible regressor?Flags: needinfo?(jdemooij)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1086842#c1)• 10 years ago |
|  | |

Attached file
[stack](attachment.cgi?id=8508883)
— [Details](attachment.cgi?id=8508883&action=edit)

(lldb) bt 5
\* thread #1: tid = 0x8a14d, 0x00000001004fefaf js-dbg-opt-64-dm-nsprBuild-darwin-33c0181c4a25`js::types::TypeFailure(JSContext\*, char const\*, ...) [inlined] js::ExclusiveContext::compartment() const + 52 at jscntxt.h:367, queue = 'com.apple.main-thread', stop reason = EXC\_BAD\_ACCESS (code=1, address=0x0)
\* frame #0: 0x00000001004fefaf js-dbg-opt-64-dm-nsprBuild-darwin-33c0181c4a25`js::types::TypeFailure(JSContext\*, char const\*, ...) [inlined] js::ExclusiveContext::compartment() const + 52 at jscntxt.h:367
frame #1: 0x00000001004fef7b js-dbg-opt-64-dm-nsprBuild-darwin-33c0181c4a25`js::types::TypeFailure(cx=<unavailable>, fmt=<unavailable>) + 411 at jsinfer.cpp:287
frame #2: 0x00000001004feddf js-dbg-opt-64-dm-nsprBuild-darwin-33c0181c4a25`js::types::TypeHasProperty(cx=<unavailable>, obj=<unavailable>, value=<unavailable>, id=<unavailable>) + 847 at jsinfer.cpp:264
frame #3: 0x000000010064246b js-dbg-opt-64-dm-nsprBuild-darwin-33c0181c4a25`bool NativeGetInline<(cx=0x0000000101b0eb00, obj=<unavailable>, receiver=<unavailable>, pobj=<unavailable>, shape=<unavailable>, vp=<unavailable>)1>(JSContext\*, js::MaybeRooted<JSObject\*, (js::AllowGC)1>::HandleType, js::MaybeRooted<JSObject\*, (js::AllowGC)1>::HandleType, js::MaybeRooted<js::NativeObject\*, (js::AllowGC)1>::HandleType, js::MaybeRooted<js::Shape\*, (js::AllowGC)1>::HandleType, js::MaybeRooted<JS::Value, (js::AllowGC)1>::MutableHandleType) + 379 at NativeObject.cpp:1596
frame #4: 0x000000010064280b js-dbg-opt-64-dm-nsprBuild-darwin-33c0181c4a25`bool GetPropertyHelperInline<(cx=0x0000000101b0eb00, obj=<unavailable>, receiver=<unavailable>, id=<unavailable>, vp=<unavailable>)1>(JSContext\*, js::MaybeRooted<js::NativeObject\*, (js::AllowGC)1>::HandleType, js::MaybeRooted<JSObject\*, (js::AllowGC)1>::HandleType, js::MaybeRooted<jsid, (js::AllowGC)1>::HandleType, js::MaybeRooted<JS::Value, (js::AllowGC)1>::MutableHandleType) + 267 at NativeObject.cpp:1874
(lldb)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a196_132034)• 10 years ago |

[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a7566_75935)• 10 years ago |

[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)
[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1086842#c2)• 10 years ago |
|  | |

Attached patch

[Part 1 - Fix](attachment.cgi?id=8511153&action=diff)
— [Details](attachment.cgi?id=8511153&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1086842&attachment=8511153)

Problem is that we have a MGetElementCache with a BarrierKind::TypeTagOnly barrier, and we set the "monitoredResult = true" flag on the cache. This means the cache doesn't call TypeScript::Monitor, but this is wrong: with TypeTagOnly we don't check the object types.
Fix is to only set monitoredResult = true for BarrierKind::TypeSet. Also fixes the same issue with MGetPropertyCache.Assignee: nobody → jdemooijStatus: NEW → ASSIGNEDFlags: needinfo?(jdemooij)
[Attachment #8511153](/attachment.cgi?id=8511153&action=edit "Part 1 - Fix") -
Flags: review?(bhackett1024)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1086842#c3)• 10 years ago |
|  | |

Attached patch

[Part 2 - Add debug checks](attachment.cgi?id=8511162&action=diff)
— [Details](attachment.cgi?id=8511162&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1086842&attachment=8511162)

Some debug-only code to verify that if we have a TypeTagOnly barrier, the object type is in the TypeSet, to catch bugs sooner.
This patch can land after the first patch is on all branches.
[Attachment #8511162](/attachment.cgi?id=8511162&action=edit "Part 2 - Add debug checks") -
Flags: review?(bhackett1024)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1086842#c4)• 10 years ago |
|  | |

Very nice catch btw, Gary! This is bad.
Part 2 should make it much easier for the fuzzers to find those bugs.

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a257805_346231)• 10 years ago |

[Attachment #8511153](/attachment.cgi?id=8511153&action=edit "Part 1 - Fix") -
Flags: review?(bhackett1024) → review+

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a257865_346231)• 10 years ago |

[Attachment #8511162](/attachment.cgi?id=8511162&action=edit "Part 2 - Add debug checks") -
Flags: review?(bhackett1024) → review+

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1086842#c5)• 10 years ago |
|  | |

Comment on [attachment 8511153](/attachment.cgi?id=8511153 "Part 1 - Fix") [[details]](/attachment.cgi?id=8511153&action=edit "Part 1 - Fix") [[diff]](/attachment.cgi?id=8511153&action=diff "Part 1 - Fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1086842&attachment=8511153)
Part 1 - Fix
[Security approval request comment]
> How easily could an exploit be constructed based on the patch?
Not trivial but with some work it's doable.
> Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No.
> Which older supported branches are affected by this flaw?
32+
> If not all supported branches, which bug introduced the flaw?
[Bug 1000942](/show_bug.cgi?id=1000942 "RESOLVED FIXED - Eliminate some unnecessary object type barriers").
> Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Should be easy.
> How likely is this patch to cause regressions; how much testing does it need?
Unlikely to cause regressions.
[Attachment #8511153](/attachment.cgi?id=8511153&action=edit "Part 1 - Fix") -
Flags: sec-approval?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1086842#c6)• 10 years ago |
|  | |

Comment on [attachment 8511153](/attachment.cgi?id=8511153 "Part 1 - Fix") [[details]](/attachment.cgi?id=8511153&action=edit "Part 1 - Fix") [[diff]](/attachment.cgi?id=8511153&action=diff "Part 1 - Fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1086842&attachment=8511153)
Part 1 - Fix
sec-approval+ and a=dveditz for aurora and beta
Please land soon so we can start testing for regressions.
[Attachment #8511153](/attachment.cgi?id=8511153&action=edit "Part 1 - Fix") -
Flags: sec-approval?
[Attachment #8511153](/attachment.cgi?id=8511153&action=edit "Part 1 - Fix") -
Flags: sec-approval+
[Attachment #8511153](/attachment.cgi?id=8511153&action=edit "Part 1 - Fix") -
Flags: approval-mozilla-beta+
[Attachment #8511153](/attachment.cgi?id=8511153&action=edit "Part 1 - Fix") -
Flags: approval-mozilla-aurora+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a627773_1689)• 10 years ago |

[tracking-firefox34](/buglist.cgi?f1=cf_tracking_firefox34&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B)
[tracking-firefox35](/buglist.cgi?f1=cf_tracking_firefox35&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox35&o1=equals&v1=%2B)
[tracking-firefox36](/buglist.cgi?f1=cf_tracking_firefox36&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox36&o1=equals&v1=%2B)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1086842#c7)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/1128da4be7b3>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1086842#c8)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/393498c26e3c>
<https://hg.mozilla.org/releases/mozilla-beta/rev/b58f505f18df>
I'm adding leave-open as well since I assume that Part 2 still needs to land.
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed)
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed)Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1086842#c9)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1128da4be7b3>Target Milestone: --- → mozilla36

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a707299_395101)• 10 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1086842#c10)• 10 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 80e18ff7c7b2).

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1086842#c11)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-b2g34_v2_1/rev/b58f505f18df>
<https://hg.mozilla.org/releases/mozilla-b2g32_v2_0/rev/2da2e7714b52>
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=fixed)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1086842#c12)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-b2g32_v2_0m/rev/2da2e7714b52>
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a2698371_280903)• 10 years ago |

Whiteboard: [jsbugmon:update,ignore] → [jsbugmon:update,ignore][adv-main34+]

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1086842#c13)• 10 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM UTC-5] from [comment #8](/show_bug.cgi?id=1086842#c8 "RESOLVED FIXED - Assertion failure: [infer failure] Missing type in object [0x10512ecf0] value: [0x10512e858], at js/src/jsinfer.cpp"))
> I'm adding leave-open as well since I assume that Part 2 still needs to land.
Setting needinfo? from Jan about Part 2 in [comment 3](/show_bug.cgi?id=1086842#c3 "RESOLVED FIXED - Assertion failure: [infer failure] Missing type in object [0x10512ecf0] value: [0x10512e858], at js/src/jsinfer.cpp"). Part 1 has landed on all branches.Flags: needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1086842#c14)• 10 years ago |
|  | |

(In reply to Gary Kwong [:gkw] [:nth10sd] from [comment #13](/show_bug.cgi?id=1086842#c13 "RESOLVED FIXED - Assertion failure: [infer failure] Missing type in object [0x10512ecf0] value: [0x10512e858], at js/src/jsinfer.cpp"))
> Setting needinfo? from Jan about Part 2 in [comment 3](/show_bug.cgi?id=1086842#c3 "RESOLVED FIXED - Assertion failure: [infer failure] Missing type in object [0x10512ecf0] value: [0x10512e858], at js/src/jsinfer.cpp"). Part 1 has landed on
> all branches.
Thanks for the reminder!
<https://hg.mozilla.org/integration/mozilla-inbound/rev/e3411194bf98>Flags: needinfo?(jdemooij)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a3808930_375297)• 10 years ago |

Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1086842#c15)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/e3411194bf98>Status: ASSIGNED → RESOLVEDClosed: 10 years agoResolution: --- → FIXED

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a3880345_132034)• 10 years ago |

Whiteboard: [jsbugmon:update,ignore][adv-main34+] → [jsbugmon:update][adv-main34+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a4189703_1689)• 10 years ago |

Group: javascript-core-security

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a22295020_465475)• 10 years ago |

Whiteboard: [jsbugmon:update][adv-main34+] → [jsbugmon:update][adv-main34+][b2g-adv-main2.2-]

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a27262067_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1086842#a51166944_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1086842&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_7d2ae640_20250126_051450.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sat Jan 25 2025 21:14:49 PST

* **Bug ID:**
  1013001,
  1023158,
  1064835,
  1096026,
  1075546,
  1086842,
  1073577,
  1048517,
  1026037,
  1037830,
  1077687

---

11 bugs found.

| [ID](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1048517](/show_bug.cgi?id=1048517 "RESOLVED FIXED - [libstagefright] |MPEG4Source::read| has several potential uninitialized variable errors") |  | [[libstagefright] |MPEG4Source::read| has several potential uninitialized variable errors](/show_bug.cgi?id=1048517) | Core | Audio/Video | ajones | RESO | FIXE | 2018-07-06 |
| [1096026](/show_bug.cgi?id=1096026 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") |  | [Assertion failure: !isInside(\*pSlotsElems), at gc/Nursery.cpp:481](/show_bug.cgi?id=1096026) | Core | JavaScript Engine | bhackett1024 | RESO | FIXE | 2016-06-04 |
| [1026037](/show_bug.cgi?id=1026037 "RESOLVED FIXED - UAF of cc_call_info_t_") |  | [UAF of cc\_call\_info\_t\_](/show_bug.cgi?id=1026037) | Core | WebRTC: Signaling | docfaraday | RESO | FIXE | 2016-06-04 |
| [1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC") |  | [Objects can be put into the wrong entry in the new object cache after a minor GC](/show_bug.cgi?id=1073577) | Core | JavaScript: GC | jcoppeard | RESO | FIXE | 2016-06-04 |
| [1086842](/show_bug.cgi?id=1086842 "RESOLVED FIXED - Assertion failure: [infer failure] Missing type in object [0x10512ecf0] value: [0x10512e858], at js/src/jsinfer.cpp") |  | [Assertion failure: [infer failure] Missing type in object [0x10512ecf0] value: [0x10512e858], at js/src/jsinfer.cpp](/show_bug.cgi?id=1086842) | Core | JavaScript Engine: J | jdemooij | RESO | FIXE | 2016-06-04 |
| [1077687](/show_bug.cgi?id=1077687 "RESOLVED FIXED - Style struct may refer to removed CounterStyle object") |  | [Style struct may refer to removed CounterStyle object](/show_bug.cgi?id=1077687) | Core | CSS Parsing and Comp | MatsPalmgren\_bugz | RESO | FIXE | 2016-06-04 |
| [1037830](/show_bug.cgi?id=1037830 "RESOLVED FIXED - GMP encoder trusts plugin's length report") |  | [GMP encoder trusts plugin's length report](/show_bug.cgi?id=1037830) | Core | WebRTC: Audio/Video | rjesup | RESO | FIXE | 2016-06-04 |
| [1075546](/show_bug.cgi?id=1075546 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h") |  | [Assertion failure: entry\_ == makeIndex(clasp, key, kind), at vm/Runtime.h](/show_bug.cgi?id=1075546) | Core | JavaScript: GC | jcoppeard | VERI | FIXE | 2016-06-04 |
| [1064835](/show_bug.cgi?id=1064835 "VERIFIED FIXED - Assertion failure: stack_[*size_].isJs(), at vm/SPSProfiler.cpp:192 or Crash on Heap") |  | [Assertion failure: stack\_[\*size\_].isJs(), at vm/SPSProfiler.cpp:192 or Crash on Heap](/show_bug.cgi?id=1064835) | Core | JavaScript Engine | kvijayan | VERI | FIXE | 2016-06-04 |
| [1013001](/show_bug.cgi?id=1013001 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189") |  | [Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189](/show_bug.cgi?id=1013001) | Core | JavaScript Engine: J | terrence.d.cole | VERI | FIXE | 2016-06-04 |
| [1023158](/show_bug.cgi?id=1023158 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js") |  | [Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js](/show_bug.cgi?id=1023158) | Core | JavaScript Engine: J | terrence.d.cole | VERI | FIXE | 2016-06-04 |

11 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=1013001%2C1023158%2C1064835%2C1096026%2C1075546%2C1086842%2C1073577%2C1048517%2C1026037%2C1037830%2C1077687&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Core" product](/enter_bug.cgi?product=Core)



=== Content from bugzilla.mozilla.org_1250e40e_20250125_020555.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1073577)
* [XML](/show_bug.cgi?ctype=xml&id=1073577)

Closed
[Bug 1073577](/show_bug.cgi?id=1073577)

Opened 10 years ago
Closed 10 years ago

# Objects can be put into the wrong entry in the new object cache after a minor GC

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Objects can be put into the wrong entry in the new object cache after a minor GC

## Categories

### (Core :: JavaScript: GC, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%3A%20GC#JavaScript%3A%20GC)

JavaScript: GC
▾

Core :: JavaScript: GC
File bugs here for issues involving the garbage collector (crashes, leaks, etc.), where the issue is *not* one caused by failure to use the JSAPI correctly.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20GC&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20GC&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%3A%20GC)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla35

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=wontfix) |
| firefox33 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix) |
| firefox34 | [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) |
| firefox35 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed) |
| firefox-esr31 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected) |
| b2g-v1.4 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected) |
| b2g-v2.0 | --- | [disabled](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=disabled) |
| b2g-v2.0M | --- | [disabled](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=disabled) |
| b2g-v2.1 | --- | [disabled](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=disabled) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 |  | wontfix |
| firefox33 |  | wontfix |
| firefox34 | + | fixed |
| firefox35 |  | fixed |
| firefox-esr31 |  | unaffected |
| b2g-v1.4 |  | unaffected |
| b2g-v2.0 |  | disabled |
| b2g-v2.0M |  | disabled |
| b2g-v2.1 |  | disabled |
| b2g-v2.2 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jonco, Assigned: jonco)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9ec760b0d3a20a6775614baa4086871?d=mm&size=40)  [jonco](/user_profile?user_id=443194)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/c9ec760b0d3a20a6775614baa4086871?d=mm&size=40)  [jonco](/user_profile?user_id=443194)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1075546](/show_bug.cgi?id=1075546 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1073577&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1073577)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-high, Whiteboard: [adv-main34+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main34+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [fix-new-object-cache](/attachment.cgi?id=8496056)  [10 years ago](#c1)  [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)   4.36 KB, patch | terrence : [review+](#c4 "10 years ago")  Sylvestre : [approval-mozilla-aurora+](#c12 "10 years ago")  Sylvestre : [approval-mozilla-beta-](#c12 "10 years ago")  abillings : [sec-approval+](#c8 "10 years ago") | [Details](/attachment.cgi?id=8496056&action=edit) | [Diff](/attachment.cgi?id=8496056&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1073577&attachment=8496056) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1073577#c0)• 10 years ago |
|  | |

The new object cache is partly keyed based on object address. The computed entry index is not re-looked up after operations that can GC and cause the key to be moved, so a entry can be inserted in the wrong place. If a subsequent lookup happens with the same class and kind but with a new key object allocated at the same address as the original key, the wrong entry will be returned.
I'm not entirely sure of the implications of this so I'm marking security sensitive.

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1073577#c1)• 10 years ago |
|  | |

Attached patch

[fix-new-object-cache](attachment.cgi?id=8496056&action=diff)
— [Details](attachment.cgi?id=8496056&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1073577&attachment=8496056)

This patch checks the gc number on the one path where this can happen, and adds an assertion to check the entry index is correct when adding.
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: review?(terrence)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1073577#c2)• 10 years ago |
|  | |

Why does this not also affect the two other newObjectCache usages in jsobj.cpp and the one in jsarray.cpp?Flags: needinfo?(jcoppeard)

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1073577#c3)• 10 years ago |
|  | |

(In reply to Terrence Cole [:terrence] from [comment #2](/show_bug.cgi?id=1073577#c2 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC"))
The other uses are keyed off either a global object or a type object, and we don't move any of those.Flags: needinfo?(jcoppeard)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1073577#c4)• 10 years ago |
|  | |

Comment on [attachment 8496056](/attachment.cgi?id=8496056 "fix-new-object-cache") [[details]](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") [[diff]](/attachment.cgi?id=8496056&action=diff "fix-new-object-cache") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1073577&attachment=8496056)
fix-new-object-cache
Review of [attachment 8496056](/attachment.cgi?id=8496056 "fix-new-object-cache") [[details]](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") [[diff]](/attachment.cgi?id=8496056&action=diff "fix-new-object-cache") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1073577&attachment=8496056):
-----------------------------------------------------------------
Ah, right!
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: review?(terrence) → review+

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1073577#c5)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/f33f7dc50aa9>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1073577#a351147_1689)• 10 years ago |

Keywords: [sec-audit](/buglist.cgi?keywords=sec-audit&resolution=---)

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1073577#c6)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/f33f7dc50aa9>Status: NEW → RESOLVEDClosed: 10 years ago
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla35

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1073577#a424925_132034)• 10 years ago |

Depends on: [1075546](/show_bug.cgi?id=1075546 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h")

|  | [Benjamin Kerensa [:bkerensa]](/user_profile?user_id=294742) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1073577#a531302_294742)• 10 years ago |

[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected)

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1073577#c7)• 10 years ago |
|  | |

Comment on [attachment 8496056](/attachment.cgi?id=8496056 "fix-new-object-cache") [[details]](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") [[diff]](/attachment.cgi?id=8496056&action=diff "fix-new-object-cache") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1073577&attachment=8496056)
fix-new-object-cache
[Security approval request comment]
I should have requested security approval before landing this one too, so sorry about that.
How easily could an exploit be constructed based on the patch?
Definitely hard.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
The addition of a check for GC number does indicate there is a problem if GC happens here. But I think it would still be hard to trigger this.
Which older supported branches are affected by this flaw?
Everything back to FF 32 since we enabled GGC on this.
If not all supported branches, which bug introduced the flaw?
Generational GC enabled on desktop in [bug 619558](/show_bug.cgi?id=619558 "RESOLVED FIXED - [meta] Implement generational garbage collection").
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Not yet. Also the backport will need to include the fix for [bug 1075546](/show_bug.cgi?id=1075546 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h").
How likely is this patch to cause regressions; how much testing does it need?
I think it's unlikely but we should probably give it a week for the fuzzers to find any other potential issues.
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1073577#a850917_75935)• 10 years ago |

[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=disabled)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=disabled)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=disabled)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)
[status-firefox32](/buglist.cgi?f1=cf_status_firefox32&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=wontfix)
[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1073577#c8)• 10 years ago |
|  | |

Comment on [attachment 8496056](/attachment.cgi?id=8496056 "fix-new-object-cache") [[details]](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") [[diff]](/attachment.cgi?id=8496056&action=diff "fix-new-object-cache") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1073577&attachment=8496056)
fix-new-object-cache
This is too late to make it into 33. We're building soon for the release build. We should get this on Aurora though. Can you make and nominate an Aurora patch?
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1073577#a865775_280903)• 10 years ago |

[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix)
[tracking-firefox34](/buglist.cgi?f1=cf_tracking_firefox34&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1073577#c9)• 10 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #8](/show_bug.cgi?id=1073577#c8 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC"))
> This is too late to make it into 33. We're building soon for the release
> build. We should get this on Aurora though. Can you make and nominate an
> Aurora patch?
FYI, this and [bug 1075546](/show_bug.cgi?id=1075546 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h") apply cleanly to Aurora as-is.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1073577#c10)• 10 years ago |
|  | |

Let's get this nominated, approved, and then into Aurora then.Flags: needinfo?(jcoppeard)

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1073577#c11)• 10 years ago |
|  | |

Comment on [attachment 8496056](/attachment.cgi?id=8496056 "fix-new-object-cache") [[details]](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") [[diff]](/attachment.cgi?id=8496056&action=diff "fix-new-object-cache") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1073577&attachment=8496056)
fix-new-object-cache
Approval Request Comment
[Feature/regressing bug #]: [Bug 619558](/show_bug.cgi?id=619558 "RESOLVED FIXED - [meta] Implement generational garbage collection")
[User impact if declined]: Potential security vulnerability
[Describe test coverage new/current, TBPL]: On central for 1 week.
[Risks and why]: Low
[String/UUID change made/needed]: None
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: approval-mozilla-beta?
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: approval-mozilla-aurora?Flags: needinfo?(jcoppeard)

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1073577#c12)• 10 years ago |
|  | |

Comment on [attachment 8496056](/attachment.cgi?id=8496056 "fix-new-object-cache") [[details]](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") [[diff]](/attachment.cgi?id=8496056&action=diff "fix-new-object-cache") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1073577&attachment=8496056)
fix-new-object-cache
This is too late for 33 but OK for 34.
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: approval-mozilla-beta?
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: approval-mozilla-beta-
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: approval-mozilla-aurora?
[Attachment #8496056](/attachment.cgi?id=8496056&action=edit "fix-new-object-cache") -
Flags: approval-mozilla-aurora+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1073577#a955771_280903)• 10 years ago |

Keywords: [sec-audit](/buglist.cgi?keywords=sec-audit&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1073577#c13)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/fef8fb959d28>
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1073577#a4868187_280903)• 10 years ago |

Whiteboard: [adv-main34+]

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1073577#a29429673_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1073577#a53333824_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1073577&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_a5f003a4_20250125_020605.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1096026)
* [XML](/show_bug.cgi?ctype=xml&id=1096026)

Closed
[Bug 1096026](/show_bug.cgi?id=1096026)

Opened 10 years ago
Closed 10 years ago

# Assertion failure: !isInside(\*pSlotsElems), at gc/Nursery.cpp:481

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: !isInside(\*pSlotsElems), at gc/Nursery.cpp:481

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla36

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox34 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) |
| firefox35 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed) |
| firefox36 | --- | [verified](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=verified) |
| firefox-esr31 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected) |
| b2g-v1.4 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected) |
| b2g-v2.0 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) |
| b2g-v2.0M | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected) |
| b2g-v2.1 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox34 |  | fixed |
| firefox35 |  | fixed |
| firefox36 |  | verified |
| firefox-esr31 |  | unaffected |
| b2g-v1.4 |  | unaffected |
| b2g-v2.0 |  | unaffected |
| b2g-v2.0M |  | unaffected |
| b2g-v2.1 |  | unaffected |
| b2g-v2.2 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: bhackett1024)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/764aa0af2fda6f02fb17dc9771bb18d9?d=mm&size=40)  [bhackett1024](/user_profile?user_id=346231)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1085029](/show_bug.cgi?id=1085029 "RESOLVED FIXED - Use common-descriptor logic more often in TypedObjectPrediction"), [1103273](/show_bug.cgi?id=1103273 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481")

Dependency [tree](/showdependencytree.cgi?id=1096026&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1096026)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [jsbugmon:update,ignore][adv-main34+][b2g-adv-main2.2-])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:update,ignore][adv-main34+][b2g-adv-main2.2-]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [[crash-signature] Machine-readable crash signature](/attachment.cgi?id=8519541)  [10 years ago](#c1)  [Christian Holler (:decoder)](/user_profile?user_id=395101)   779 bytes, text/plain |  | [Details](/attachment.cgi?id=8519541&action=edit) |
| --- | --- | --- |
| [WIP](/attachment.cgi?id=8521490)  [10 years ago](#c5)  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)   30.30 KB, patch |  | [Details](/attachment.cgi?id=8521490&action=edit) | [Diff](/attachment.cgi?id=8521490&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521490) |
| [patch](/attachment.cgi?id=8521714)  [10 years ago](#c6)  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)   31.46 KB, patch | sfink : [review+](#c29 "10 years ago") | [Details](/attachment.cgi?id=8521714&action=edit) | [Diff](/attachment.cgi?id=8521714&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521714) |
| [elements patch](/attachment.cgi?id=8521738)  [10 years ago](#c8)  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)   4.80 KB, patch | terrence : [review+](#c16 "10 years ago")  lmandel : [approval-mozilla-aurora+](#c19 "10 years ago")  lmandel : [approval-mozilla-beta+](#c19 "10 years ago")  abillings : [sec-approval+](#c18 "10 years ago") | [Details](/attachment.cgi?id=8521738&action=edit) | [Diff](/attachment.cgi?id=8521738&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1096026#c0)• 10 years ago |
|  | |

The following testcase asserts on mozilla-central revision d380166816dd (run with --no-threads --fuzzing-safe):
gczeal(2);
var Vec3u16Type = TypedObject.uint16.array(3);
function foo\_u16() {
for (var i = 0; i < 30000; i += 3) {
var vec = new Vec3u16Type([i, i+1, i+2]);
var sum = vec[0] + vec[1] + vec[(/[]/g )];
foo\_u16(sum, 3\*i + 3);
}
}
foo\_u16();

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1096026#c1)• 10 years ago |
|  | |

Attached file
[[crash-signature] Machine-readable crash signature](attachment.cgi?id=8519541)
— [Details](attachment.cgi?id=8519541&action=edit)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1096026#c2)• 10 years ago |
|  | |

Another GC assertion in TypedObject, marking s-s.
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=affected)Flags: needinfo?(nmatsakis)Whiteboard: [jsbugmon:update,bisect]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a14749_395101)• 10 years ago |

Whiteboard: [jsbugmon:update,bisect] → [jsbugmon:update]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1096026#c3)• 10 years ago |
|  | |

JSBugMon: Bisection requested, result:
autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: <https://hg.mozilla.org/mozilla-central/rev/a9cab8a15d2b>
user: Brian Hackett
date: Wed Oct 29 11:19:51 2014 -0700
summary: [Bug 1085029](/show_bug.cgi?id=1085029 "RESOLVED FIXED - Use common-descriptor logic more often in TypedObjectPrediction") - Use common-descriptor logic more often in TypedObjectPrediction, r=nmatsakis.
This iteration took 331.308 seconds to run.

|  | [Hannes Verschore [:h4writer]](/user_profile?user_id=196399) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1096026#c4)• 10 years ago |
|  | |

Is this caused by the above mentioned revision?Flags: needinfo?(bhackett1024)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a190133_1689)• 10 years ago |

Blocks: [1085029](/show_bug.cgi?id=1085029 "RESOLVED FIXED - Use common-descriptor logic more often in TypedObjectPrediction")Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a190176_1689)• 10 years ago |

[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=unaffected)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1096026#c5)• 10 years ago |
|  | |

Attached patch

[WIP](attachment.cgi?id=8521490&action=diff) (obsolete)
— [Details](attachment.cgi?id=8521490&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521490)

The immediate problem here is that forwarding pointers aren't being set for typed objects. While fixing this though I found some other problems with typed objects and tracing, namely that data pointers for typed arrays whose buffer has data in an inline typed object won't be updated properly.
Additionally, the forwarding logic for zero-length elements vectors is incorrect; the code just skips inserting a forwarding pointer in this case, but these zero length vectors can still be used to access array lengths and initialized lengths at negative offsets, so they need to be forwarded properly.
The attached patch should fix all this stuff. I need to write tests for the various problems this patch is trying to fix, especially the zero length elements issue mentioned above, since that doesn't involve typed objects at all. If I can get that to crash (and probably even if I can't) I'll write a smaller patch just targeting that which can be uplifted.Assignee: nobody → bhackett1024Flags: needinfo?(nmatsakis)Flags: needinfo?(bhackett1024)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1096026#c6)• 10 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=8521714&action=diff)
— [Details](attachment.cgi?id=8521714&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521714)

Above patch with some tests added.
[Attachment #8521490](/attachment.cgi?id=8521490&action=edit "WIP") -
Attachment is obsolete: true
[Attachment #8521714](/attachment.cgi?id=8521714&action=edit "patch") -
Flags: review?(sphink)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1096026#c7)• 10 years ago |
|  | |

Here's a testcase that shows a problem with the don't-forward-zero-length element arrays stuff. Tested on 10.9 x64.
with({}){}
gczeal(2);
function foo(arr) {
var z = arr.length;
var y = [];
var x = arr[0];
print(0. + x + y + z);
return y;
}
for (var i = 0; i < 100; i++)
foo([1]);
for (var i = 0; i < 100; i++)
foo([undefined]);
var arr = [];
Object.preventExtensions(arr);
for (var i = 0; i < 100; i++)
foo(arr);
What happens is that Ion keeps the array elements live across the NewArray opcode. When that opcode triggers a minor GC, the elements aren't forwarded properly since their capacity is zero. Then the MInitializedLength associated with the element read accesses a negative index of the bogus elements, reads a bogus value and the element read then gets another bogus value rather than returning undefined. This could also be used to write out values to bogus locations.

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1096026#c8)• 10 years ago |
|  | |

Attached patch

[elements patch](attachment.cgi?id=8521738&action=diff)
— [Details](attachment.cgi?id=8521738&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738)

Chunk from the above patch which fixes the zero length elements issue.
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: review?(terrence)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1096026#c9)• 10 years ago |
|  | |

Comment on [attachment 8521738](/attachment.cgi?id=8521738 "elements patch") [[details]](/attachment.cgi?id=8521738&action=edit "elements patch") [[diff]](/attachment.cgi?id=8521738&action=diff "elements patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738)
elements patch
Review of [attachment 8521738](/attachment.cgi?id=8521738 "elements patch") [[details]](/attachment.cgi?id=8521738&action=edit "elements patch") [[diff]](/attachment.cgi?id=8521738&action=diff "elements patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738):
-----------------------------------------------------------------
Do you know why we can't just put the forwarding pointer somewhere in ObjectElements, since that memory is always present? I guess there may have been some path where we use the length before checking for forwarding, but it seems like it would be better fix those cases than add more complexity to our forwarding paths.
Also, is the reason you made forwardedPointers lazy performance? None of the extra overhead appears to be in particularly hot paths, so I think we should initialize it eagerly for the simplicity wins.
I'm fine with this approach, but I'd like to see it again in non-lazy form, assuming that there isn't some aspect I'm missing.
::: js/src/gc/Nursery.cpp
@@ +444,3 @@
> MOZ\_ASSERT(isInside(oldHeader));
> MOZ\_ASSERT(!isInside(newHeader));
> + if (nelems - ObjectElements::VALUES\_PER\_HEADER < 1) {
Let's add a comment explaining why we need this test. Something like:
// If there is not enough room to store the forwarding pointer inline, put it in the forwardedBuffers map.
@@ +444,4 @@
> MOZ\_ASSERT(isInside(oldHeader));
> MOZ\_ASSERT(!isInside(newHeader));
> + if (nelems - ObjectElements::VALUES\_PER\_HEADER < 1) {
> + if (!forwardedBuffers.initialized() && !forwardedBuffers.init())
This is on the runtime, so let's initialize it eagerly in Nursery::init for simplicity.
@@ +453,1 @@
> \*reinterpret\_cast<HeapSlot \*\*>(oldHeader->elements()) = newHeader->elements();
// Otherwise store it inline in the first element.
@@ +472,5 @@
>
> + // The new location for this buffer is either stored inline with it or in
> + // the forwardedBuffers table.
> + do {
> + if (forwardedBuffers.initialized()) {
And we can then remove this check and rephrase this as:
if (ForwardedBufferMap::Ptr p = forwardedBuffers.lookup(old))
\*pSlotsElems = reinterpret\_cast<HeapSlot \*>(p->value());
else
\*pSlotsElems = \*reinterpret\_cast<HeapSlot \*\*>(old);
I suppose unconditionally doing a lookup will be a bit slower here, but this code should be rarely run very rarely.
@@ +849,5 @@
>
> // Update any slot or element pointers whose destination has been tenured.
> TIME\_START(updateJitActivations);
> js::jit::UpdateJitActivationsForMinorGC<Nursery>(&rt->mainThread, &trc);
> + forwardedBuffers.finish();
And move this to ~Nursery.
::: js/src/gc/Nursery.h
@@ +212,5 @@
> + \* for buffers whose length is less than pointer width, or when different
> + \* buffers might overlap each other. For these, an entry in the following
> + \* table is used.
> + \*/
> + typedef HashMap<void \*, void \*, PointerHasher<void \*, 1>, SystemAllocPolicy> ForwardedBufferMap;
ObjectElements should have Value alignment, so use a shift of 3 for PointerHasher.
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: review?(terrence)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1096026#c10)• 10 years ago |
|  | |

Comment on [attachment 8521714](/attachment.cgi?id=8521714 "patch") [[details]](/attachment.cgi?id=8521714&action=edit "patch") [[diff]](/attachment.cgi?id=8521714&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521714)
patch
Review of [attachment 8521714](/attachment.cgi?id=8521714 "patch") [[details]](/attachment.cgi?id=8521714&action=edit "patch") [[diff]](/attachment.cgi?id=8521714&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521714):
-----------------------------------------------------------------
::: js/src/builtin/TypedObject.cpp
@@ +1552,5 @@
> + if (buffer.forInlineTypedObject()) {
> + InlineTypedObject &realOwner = buffer.firstView()->as<InlineTypedObject>();
> + attach(cx, realOwner, offset);
> + return;
> + }
So does this mean we can assert in OutlineTypedObject::setOwnerAndData that the owner is either nullptr, an InlineTypedObject or an ArrayBuffer that holds its own data? If so, please do.
Oh, it looks like you assert this in the new obj\_trace(). Please assert in setOwnerAndData as well (as documentation).
@@ +1689,5 @@
>
> // Update the data pointer if the owner moved and the owner's data is
> + // inline with it. Note that if the owner is an array buffer we don't need
> + // to handle the case where its data is from some inline typed object, as
> + // in that case this object will be directly parented to that typed object.
I'd like this to read more like an invariant.
// Note that an array buffer pointing to data in an inline typed object will
// never be used as an owner for another view. In such cases, the owner will
// be the inline typed object itself.
@@ +1697,5 @@
> (owner->is<InlineTypedObject>() ||
> owner->as<ArrayBufferObject>().hasInlineData()))
> {
> + ptrdiff\_t d = reinterpret\_cast<uint8\_t \*>(owner) - reinterpret\_cast<uint8\_t \*>(oldOwner);
> + newData = oldData + d;
I would be fine with just
newData += reinterpret\_cast<uint8\_t \*>(owner) - reinterpret\_cast<uint8\_t \*>(oldOwner);
but this is good too.
::: js/src/gc/Nursery.cpp
@@ +428,5 @@
> return zone->allocator.arenas.allocateFromArena(zone, thingKind);
> }
>
> void
> +Nursery::setForwardingPointer(void \*oldData, void \*newData, bool canInline)
The 'canInline' param confused me because of the other use of "inline". Can you make it the painfully verbose canInlineForwardingPointer instead?
@@ +437,5 @@
> + if (canInline) {
> + \*reinterpret\_cast<void \*\*>(oldData) = newData;
> + } else {
> + if (!forwardedBuffers.initialized() && !forwardedBuffers.init())
> + CrashAtUnhandlableOOM("Nursery::setForwardingPointer");
Please init this unconditionally instead of lazily.
@@ +485,5 @@
>
> + // The new location for this buffer is either stored inline with it or in
> + // the forwardedBuffers table.
> + do {
> + if (forwardedBuffers.initialized()) {
If this is important for perf, is it possible to check the number of elements here instead?
@@ +834,5 @@
>
> // Update any slot or element pointers whose destination has been tenured.
> TIME\_START(updateJitActivations);
> js::jit::UpdateJitActivationsForMinorGC<Nursery>(&rt->mainThread, &trc);
> + forwardedBuffers.finish();
(.clear() if you end up making this non-lazy.)
::: js/src/vm/ArrayBufferObject.cpp
@@ +1208,5 @@
> + obj->setPrivate(dstData);
> +
> + // We can't use an inline forwarding pointer here, as there might
> + // not be enough bytes available, and other views might have data
> + // pointers whose forwarding pointers would overlap this one.
I don't follow this. Why can't lazyArrayBuffers guarantee enough space? AllocKindForLazyBuffer guarantees enough space, right? Or am I getting things mixed up?
And how would other views overlap?

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1096026#c11)• 10 years ago |
|  | |

So it basically looks good to me, but I'm worried that I'm not understanding everything correctly. ni? bhackett to answer my last question in that review.Flags: needinfo?(bhackett1024)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1096026#c12)• 10 years ago |
|  | |

(In reply to Terrence Cole [:terrence] from [comment #9](/show_bug.cgi?id=1096026#c9 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"))
> Comment on [attachment 8521738](/attachment.cgi?id=8521738 "elements patch") [[details]](/attachment.cgi?id=8521738&action=edit "elements patch") [[diff]](/attachment.cgi?id=8521738&action=diff "elements patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738)
> elements patch
>
> Review of [attachment 8521738](/attachment.cgi?id=8521738 "elements patch") [[details]](/attachment.cgi?id=8521738&action=edit "elements patch") [[diff]](/attachment.cgi?id=8521738&action=diff "elements patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738):
> -----------------------------------------------------------------
>
> Do you know why we can't just put the forwarding pointer somewhere in
> ObjectElements, since that memory is always present? I guess there may have
> been some path where we use the length before checking for forwarding, but
> it seems like it would be better fix those cases than add more complexity to
> our forwarding paths.
Ion stack values which store slots/elements pointers don't distinguish between object dense elements and other types (slots, typed array buffers). So when we try to get the forwarding pointer for a given array of values we don't know whether there is an ObjectElements header available to access. This could be fixed but it would add a big mess of complexity to Ion and wouldn't fix the issues which typed objects bring to the table anyways, which you can see in the full patch.
> Also, is the reason you made forwardedPointers lazy performance? None of the
> extra overhead appears to be in particularly hot paths, so I think we should
> initialize it eagerly for the simplicity wins.
This is less for performance than it is for memory and simplicity. Why have this table taking up room at all times when it is only used during nursery GCs? If we end up sticking a lot of entries into this table during the nursery GC and want to reclaim the memory after the nursery GC finishes, we need to use HashMap::finish since HashMap::clear doesn't shrink the table. So I think initializing this lazily is the best thing to do here, and the difference in complexity is pretty small.
> ::: js/src/gc/Nursery.cpp
> @@ +444,3 @@
> > MOZ\_ASSERT(isInside(oldHeader));
> > MOZ\_ASSERT(!isInside(newHeader));
> > + if (nelems - ObjectElements::VALUES\_PER\_HEADER < 1) {
>
> Let's add a comment explaining why we need this test. Something like:
> // If there is not enough room to store the forwarding pointer inline, put
> it in the forwardedBuffers map.
Since this bug allows people to read or write to arbitrary addresses, I don't think extra comments are the best idea.
> ::: js/src/gc/Nursery.h
> @@ +212,5 @@
> > + \* for buffers whose length is less than pointer width, or when different
> > + \* buffers might overlap each other. For these, an entry in the following
> > + \* table is used.
> > + \*/
> > + typedef HashMap<void \*, void \*, PointerHasher<void \*, 1>, SystemAllocPolicy> ForwardedBufferMap;
>
> ObjectElements should have Value alignment, so use a shift of 3 for
> PointerHasher.
This is true for ObjectElements, but not for nursery element pointers from typed objects and typed arrays which point into inline typed objects (which the full patch addresses).

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a641874_346231)• 10 years ago |

[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: review?(terrence)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1096026#c13)• 10 years ago |
|  | |

(In reply to Steve Fink [:sfink, :s:] from [comment #10](/show_bug.cgi?id=1096026#c10 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"))
> I don't follow this. Why can't lazyArrayBuffers guarantee enough space?
> AllocKindForLazyBuffer guarantees enough space, right? Or am I getting
> things mixed up?
>
> And how would other views overlap?
This code is for the case where we create an inline typed object in the nursery, access its buffer, then use that buffer to create a typed array or data view pointing into the inline typed object's data. This typed array might not be long enough to store a forwarding pointer since, even if the inline typed object was originally long enough, the typed array can point to any offset in it. More importantly though, other typed arrays or typed objects can point to other offsets in the inline typed object's data, and if we store forwarding pointers for all of these they can overlap and we'll end up reading garbage values back out.
It's possible to do a little better here, if we store forwarding pointers in the inline typed object when (a) the view is large enough to accommodate a pointer, and (b) the array is aligned at pointer width. But the complexity involved doesn't seem worth it since this case is pretty pathological.
This is all different from a typed array created in the nursery whose buffer is lazily constructed. In that case, only the original typed array can point to its data, so there is no overlapping views issue, and AllocKindForLazyBuffer ensures there is enough space for a forwarding pointer.Flags: needinfo?(bhackett1024)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a652179_75935)• 10 years ago |

[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=unaffected)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1096026#c14)• 10 years ago |
|  | |

I don't think those flags are set correctly. The TypedObject thing only affects nightly, but the crash in [comment 7](/show_bug.cgi?id=1096026#c7 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") probably affects any builds with GGC enabled.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1096026#c15)• 10 years ago |
|  | |

GGC is only enabled on B2G v2.2. Feel free to set the Fx flags correctly if you want.

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1096026#c16)• 10 years ago |
|  | |

Comment on [attachment 8521738](/attachment.cgi?id=8521738 "elements patch") [[details]](/attachment.cgi?id=8521738&action=edit "elements patch") [[diff]](/attachment.cgi?id=8521738&action=diff "elements patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738)
elements patch
Review of [attachment 8521738](/attachment.cgi?id=8521738 "elements patch") [[details]](/attachment.cgi?id=8521738&action=edit "elements patch") [[diff]](/attachment.cgi?id=8521738&action=diff "elements patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738):
-----------------------------------------------------------------
Thank you for the answers! The fact that HashTable::clear doesn't shrink is a bit surprising, but does indeed make the lazy approach correct here.
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: review?(terrence) → review+

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a718920_346231)• 10 years ago |

[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1096026#c17)• 10 years ago |
|  | |

Comment on [attachment 8521738](/attachment.cgi?id=8521738 "elements patch") [[details]](/attachment.cgi?id=8521738&action=edit "elements patch") [[diff]](/attachment.cgi?id=8521738&action=diff "elements patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738)
elements patch
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
not easily
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
no
Which older supported branches are affected by this flaw?
builds with gGC
If not all supported branches, which bug introduced the flaw?
GGC
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
should be straightforward
How likely is this patch to cause regressions; how much testing does it need?
not likely
Approval Request Comment
[Feature/regressing bug #]: GGC
[User impact if declined]: potentially exploitable crashes
[Describe test coverage new/current, TBPL]: none
[Risks and why]: low, adds some new functionality but nothing complicated
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: sec-approval?
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: approval-mozilla-beta?
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: approval-mozilla-aurora?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1096026#c18)• 10 years ago |
|  | |

Comment on [attachment 8521738](/attachment.cgi?id=8521738 "elements patch") [[details]](/attachment.cgi?id=8521738&action=edit "elements patch") [[diff]](/attachment.cgi?id=8521738&action=diff "elements patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738)
elements patch
sec-approval+ for trunk.
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: sec-approval? → sec-approval+

|  | [Lawrence Mandel [:lmandel] (use needinfo)](/user_profile?user_id=424995) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1096026#c19)• 10 years ago |
|  | |

Comment on [attachment 8521738](/attachment.cgi?id=8521738 "elements patch") [[details]](/attachment.cgi?id=8521738&action=edit "elements patch") [[diff]](/attachment.cgi?id=8521738&action=diff "elements patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521738)
elements patch
Beta+
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: approval-mozilla-beta?
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: approval-mozilla-beta+
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: approval-mozilla-aurora?
[Attachment #8521738](/attachment.cgi?id=8521738&action=edit "elements patch") -
Flags: approval-mozilla-aurora+

|  | [Lawrence Mandel [:lmandel] (use needinfo)](/user_profile?user_id=424995) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1096026#c20)• 10 years ago |
|  | |

Note that this bug is approved for Beta but Ryan is out. If this is to make beta10 is will need to land very soon (minutes not hours). Can you please land on mozilla-beta yourself?Flags: needinfo?(bhackett1024)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a724946_1689)• 10 years ago |

Group: javascript-core-security

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1096026#c21)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/11f5e8e1d39e>Flags: needinfo?(bhackett1024)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a735925_75935)• 10 years ago |

[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1096026#c22)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/2f6e43721856>

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a785505_346231)• 10 years ago |

Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Lawrence Mandel [:lmandel] (use needinfo)](/user_profile?user_id=424995) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1096026#c23)• 10 years ago |
|  | |

Brian - Can you also please land on Aurora?Flags: needinfo?(bhackett1024)

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1096026#c24)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/2f6e43721856>

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a827074_395101)• 10 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1096026#c25)• 10 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 64e7a6391916).

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1096026#c26)• 10 years ago |
|  | |

(In reply to Lawrence Mandel [:lmandel] (use needinfo) from [comment #23](/show_bug.cgi?id=1096026#c23 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"))
> Brian - Can you also please land on Aurora?
I've been trying repeatedly to update my aurora tree and am getting some error I haven't seen before (some SSL thing: SSL3\_GET\_RECORD:decryption failed or bad record mac.) Is there anyone else who can do this?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1096026#c27)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/b34fe7ba8f13>
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed)Flags: needinfo?(bhackett1024)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1096026#c28)• 10 years ago |
|  | |

Thanks!

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1096026#c29)• 10 years ago |
|  | |

Comment on [attachment 8521714](/attachment.cgi?id=8521714 "patch") [[details]](/attachment.cgi?id=8521714&action=edit "patch") [[diff]](/attachment.cgi?id=8521714&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521714)
patch
Review of [attachment 8521714](/attachment.cgi?id=8521714 "patch") [[details]](/attachment.cgi?id=8521714&action=edit "patch") [[diff]](/attachment.cgi?id=8521714&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1096026&attachment=8521714):
-----------------------------------------------------------------
Oh, ok. I think what I was missing was in your first reply to terrence re: slots/elements storage.
[Attachment #8521714](/attachment.cgi?id=8521714&action=edit "patch") -
Flags: review?(sphink) → review+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1096026#c30)• 10 years ago |
|  | |

Why is this marked 36 affected but fixed for 34 and 35? Oversight or ?Flags: needinfo?(choller)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a1073499_280903)• 10 years ago |

Whiteboard: [jsbugmon:update,ignore] → [jsbugmon:update,ignore][adv-main34+]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1096026#c31)• 10 years ago |
|  | |

Per the last paragraph in [comment 5](/show_bug.cgi?id=1096026#c5 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"), I think that there are two issues exposed by the initial test case. One affects beta etc., and has had a patch landed. The other issue only affects TypedObjects, and thus only affects trunk. The latter issue has not been fixed. Maybe we should just close out this one and open a new one for the specific TypedObjects issue, to simplify advisory tracking, etc. Somebody correct me if I'm wrong.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1096026#c32)• 10 years ago |
|  | |

Hmm, or maybe this is being left open for tests? bhackett, can this be marked "fixed" for 36, and then this is just being left open for tests or something?Flags: needinfo?(bhackett1024)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a1077439_346231)• 10 years ago |

Blocks: [1103273](/show_bug.cgi?id=1103273 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481")

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1096026#c33)• 10 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #31](/show_bug.cgi?id=1096026#c31 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"))
> Per the last paragraph in [comment 5](/show_bug.cgi?id=1096026#c5 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"), I think that there are two issues
> exposed by the initial test case. One affects beta etc., and has had a
> patch landed. The other issue only affects TypedObjects, and thus only
> affects trunk. The latter issue has not been fixed. Maybe we should just
> close out this one and open a new one for the specific TypedObjects issue,
> to simplify advisory tracking, etc. Somebody correct me if I'm wrong.
Yeah, this is right, filed [bug 1103273](/show_bug.cgi?id=1103273 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") for the typed objects issues.Flags: needinfo?(choller)Flags: needinfo?(bhackett1024)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a1077532_346231)• 10 years ago |

[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a1077604_346231)• 10 years ago |

Status: NEW → RESOLVEDClosed: 10 years agoResolution: --- → FIXED

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1096026#c34)• 10 years ago |
|  | |

Thanks.Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a1080697_75935)• 10 years ago |

[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a1296322_75935)• 10 years ago |

Target Milestone: --- → mozilla36

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1096026#c35)• 10 years ago |
|  | |

Reproduced the original issue using changeset d380166816dd with the instructions from [comment #0](/show_bug.cgi?id=1096026#c0 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"):
- Assertion failure: !isInside(\*pSlotsElems), at /home/kjozwiak/code/mozilla-central/js/src/gc/Nursery.cpp:481
fx 36 (changeset: 74edfbf0e6a3) - PASSED
When I try to run the above poc in fx35 (changeset: 56f456359253) and fx34 (changeset: c8ff4c93ee85), I get the following error:
"poc.js:2:4 ReferenceError: TypedObject is not defined"
Christian, is there any way I can verify this on fx35 and fx34? Perhaps I'm doing something incorrectly?
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=verified)Flags: needinfo?(choller)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1096026#c36)• 10 years ago |
|  | |

You will have to ask the developers if they can write a test for fx35/34. The test in [comment 0](/show_bug.cgi?id=1096026#c0 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") won't work there since it required TypedObject which is Nightly only.Flags: needinfo?(choller)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1096026#c37)• 10 years ago |
|  | |

Brian, would you be able to add a test case that works for fx35/34 as TypedObject is only available under m-c? Would the test case that you added in [comment # 7](/show_bug.cgi?id=1096026#c7 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") be sufficient for verification?Flags: needinfo?(bhackett1024)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1096026#c38)• 10 years ago |
|  | |

(In reply to Kamil Jozwiak [:kjozwiak] from [comment #37](/show_bug.cgi?id=1096026#c37 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"))
> Brian, would you be able to add a test case that works for fx35/34 as
> TypedObject is only available under m-c? Would the test case that you added
> in [comment # 7](/show_bug.cgi?id=1096026#c7 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") be sufficient for verification?
Yes, the [comment 7](/show_bug.cgi?id=1096026#c7 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") testcase is sufficient for this.Flags: needinfo?(bhackett1024)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1096026#c39)• 10 years ago |
|  | |

I ran the testcase from [comment #7](/show_bug.cgi?id=1096026#c7 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") using m-a 4af988d1770f but got the same results when I run the testcase against m-c d380166816dd which is the build I reproduced the original assertion with. The output appears to be the same.
The output lists several 11, NaN1, NaN0 entries.
Brian, I'm not really sure how the non-fixed output should look like as the output looks to be the same every time. (even against the changeset that crashes when using the poc from [comment #0](/show_bug.cgi?id=1096026#c0 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"))Flags: needinfo?(bhackett1024)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1096026#c40)• 10 years ago |
|  | |

(In reply to Kamil Jozwiak [:kjozwiak] from [comment #39](/show_bug.cgi?id=1096026#c39 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"))
> I ran the testcase from [comment #7](/show_bug.cgi?id=1096026#c7 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") using m-a 4af988d1770f but got the same
> results when I run the testcase against m-c d380166816dd which is the build
> I reproduced the original assertion with. The output appears to be the same.
>
> The output lists several 11, NaN1, NaN0 entries.
>
> Brian, I'm not really sure how the non-fixed output should look like as the
> output looks to be the same every time. (even against the changeset that
> crashes when using the poc from [comment #0](/show_bug.cgi?id=1096026#c0 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481"))
Like many JS testcases this is sensitive to the particular machine and platform on which you're testing. Sometimes the [comment 7](/show_bug.cgi?id=1096026#c7 "RESOLVED FIXED - Assertion failure: !isInside(*pSlotsElems), at gc/Nursery.cpp:481") testcase will crash an affected build, other times one of the lines will be some random double value rather than NaN.Flags: needinfo?(bhackett1024)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a2565425_1689)• 10 years ago |

Group: javascript-core-security

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a20671356_465475)• 10 years ago |

Whiteboard: [jsbugmon:update,ignore][adv-main34+] → [jsbugmon:update,ignore][adv-main34+][b2g-adv-main2.2-]

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a25637792_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1096026#a49542311_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1096026&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Christian Holler (:decoder)](/user_profile?user_id=395101)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from blog.mozilla.org_a1905f2a_20250126_051449.html ===

[Skip to content](#content)

[Mozilla](https://blog.mozilla.org/en/)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

* [Internet Culture](https://blog.mozilla.org/en/category/internet-culture/)
  + [Deep Dives](https://blog.mozilla.org/en/category/internet-culture/deep-dives/)
  + [Mozilla Explains](https://blog.mozilla.org/en/category/internet-culture/mozilla-explains/)
  + [Interviews](https://blog.mozilla.org/en/category/internet-culture/interviews/)
  + [Videos](https://blog.mozilla.org/en/category/videos/)
* [Privacy & Security](https://blog.mozilla.org/en/category/privacy-security/)
* [Products](https://blog.mozilla.org/en/category/products/)
  + [Firefox](https://blog.mozilla.org/en/category/products/firefox/)
  + [Pocket](https://blog.mozilla.org/en/category/products/pocket/)
  + [Mozilla VPN](https://blog.mozilla.org/en/category/products/mozilla-vpn/)
* [Mozilla](https://blog.mozilla.org/en/category/mozilla/)
  + [News](https://blog.mozilla.org/en/category/mozilla/news/)
  + [Internet Policy](https://blog.mozilla.org/en/category/mozilla/internet-policy/)
  + [Leadership](https://blog.mozilla.org/en/category/mozilla/leadership/)
    - [Mitchell Baker, CEO](https://blog.mozilla.org/en/author/mitchellmozillacom/)
    - [Mark Surman, ED Foundation](https://blog.mozilla.org/en/author/markmozillafoundation-org/)
    - [Eric Rescorla, Firefox CTO](https://blog.mozilla.org/en/author/ekrmozilla-com/)

[Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_medium=referral&utm_campaign=blog-nav)

![search](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/icons/search.svg)

#### Search

Search for:

![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2019/01/mozilla-logo-bw-rgb.png)
## News

Official announcements and press releases

[![Room filled with people listening to a speaker on stage. Demo Day visual image in the background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/Demo_Day_Blog_Header_-1-800x800.jpg)
Mozilla
## Mozilla Builders: Celebrating community-driven innovation in AI

Read More](https://blog.mozilla.org/en/mozilla/mozilla-builders-demo-day/)

[![The Mozilla logo in green on a black background](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/12/logo-lockup-video-poster-800x800.png)
Mozilla
## Mozilla welcomes new executive team members

Read More](https://blog.mozilla.org/en/mozilla/new-executives/)

[![Decorative image of wrapped gifts in front of an iphone](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/11/moz_header_holiday_firefox-phone-gifts_blue-03.png-800x800.png)
Products
## Shopping for everyone? We’ve got you covered with the Fakespot Holiday Gift Guide 2024

Read More](https://blog.mozilla.org/en/products/shopping-for-everyone-weve-got-you-covered-with-the-fakespot-holiday-gift-guide-2024/)

[![Text: Mozilla Builders](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/Blog-16_9-1920x1080-1-800x800.png)
Mozilla
## 14 AI projects to watch: Mozilla’s first Builders Accelerator cohort kicks off

Read More](https://blog.mozilla.org/en/mozilla/14-ai-projects-to-watch-mozillas-first-builders-accelerator-cohort-kicks-off/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot’s guide to trending back-to-school products

Read More](https://blog.mozilla.org/en/mozilla/news/fakespots-guide-to-trending-back-to-school-products/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## BAFTA Award-Winner Siobhán McSweeney to host Mozilla’s 2nd Annual Rise25 Awards in Dublin, Ireland on Aug. 13

Read More](https://blog.mozilla.org/en/mozilla/bafta-award-winner-siobhan-mcsweeney-to-host-mozillas-2nd-annual-rise25-awards-in-dublin-ireland-on-august-13/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/05/fx_website_meta-image_tips-tricks_alt-04-1-800x800.webp)
Mozilla
## Here’s what we’re working on in Firefox

Read More](https://blog.mozilla.org/en/mozilla/heres-what-were-working-on-in-firefox/)

[![A check mark next to the text "Fakespot."](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2023/07/Fakespot_ProductBlog-2-800x800.jpg)
News
## Fakespot reveals the product categories with the most and least reliable product reviews

Read More](https://blog.mozilla.org/en/mozilla/news/fakespot-reveals-the-product-categories-with-the-most-and-least-reliable-product-reviews-for-summer-and-back-to-school-shopping/)

[![A dark blue speech bubble with horizontal purple and red bars on a pink background.](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2020/03/fx_blog_header_announcements_001_1920x1080-800x800.jpg)
Firefox
## Engaging with our Firefox community: Highlights from our recent AMA

Read More](https://blog.mozilla.org/en/products/firefox/engaging-with-our-firefox-community-highlights-from-our-recent-ama/)

[![](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/IG_Highlights_Icon-800x800.png)
Mozilla
## Mozilla announces finalists for the 2nd annual Rise25 Awards

Read More](https://blog.mozilla.org/en/mozilla/mozilla-announces-finalists-for-the-2nd-annual-rise25-awards/)

[![Mozilla and Anonym logos](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/blog_1200x800_v2-800x800.png)
Mozilla
## Introducing Anonym: Raising the bar for privacy-preserving digital advertising

Read More](https://blog.mozilla.org/en/mozilla/mozilla-anonym-raising-the-bar-for-privacy-preserving-digital-advertising/)

[![logo - zero with a diagonal line through it, and the letters D, I, N](https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/06/odintbanner-500x500.png)
Mozilla
## Keeping GenAI technologies secure is a shared responsibility

Read More](https://blog.mozilla.org/en/mozilla/keeping-genai-technologies-secure-is-a-shared-responsibility/)

1
[2](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compa)
[3](https://blog.mozilla.org/en/category/mozilla/news/page/3?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compa)
…
[24](https://blog.mozilla.org/en/category/mozilla/news/page/24?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compa)
[next](https://blog.mozilla.org/en/category/mozilla/news/page/2?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=compa)

![newsletter](https://blog.mozilla.org/wp-content/themes/foxtail/assets/images/newsletter.png)

### Keep up with all things Firefox

Get how-tos, advice and news to make your Firefox experience work best for you.

Your e-mail address

Country
- select -
Afghanistan
Akrotiri
Albania
Algeria
American Samoa
Andorra
Angola
Anguilla
Antarctica
Antigua and Barbuda
Argentina
Armenia
Aruba
Ashmore and Cartier Islands
Australia
Austria
Azerbaijan
Bahamas, The
Bahrain
Baker Island
Bangladesh
Barbados
Bassas da India
Belarus
Belgium
Belize
Benin
Bermuda
Bhutan
Bolivia
Bonaire, Sint Eustatius, and Saba
Bosnia and Herzegovina
Botswana
Bouvet Island
Brazil
British Indian Ocean Territory
Brunei
Bulgaria
Burkina Faso
Burma
Burundi
Cabo Verde
Cambodia
Cameroon
Canada
Cayman Islands
Central African Republic
Chad
Chile
China
Christmas Island
Clipperton Island
Cocos (Keeling) Islands
Colombia
Comoros
Congo (Brazzaville)
Congo (Kinshasa)
Cook Islands
Coral Sea Islands
Costa Rica
Croatia
Cuba
Curaçao
Cyprus
Czech Republic
Côte d’Ivoire
Denmark
Dhekelia
Diego Garcia
Djibouti
Dominica
Dominican Republic
Ecuador
Egypt
El Salvador
Equatorial Guinea
Eritrea
Estonia
Ethiopia
Europa Island
Falkland Islands (Islas Malvinas)
Faroe Islands
Fiji
Finland
France
French Guiana
French Polynesia
French Southern and Antarctic Lands
Gabon
Gambia, The
Gaza Strip
Georgia
Germany
Ghana
Gibraltar
Glorioso Islands
Greece
Greenland
Grenada
Guadeloupe
Guam
Guatemala
Guernsey
Guinea
Guinea-Bissau
Guyana
Haiti
Heard Island and McDonald Islands
Honduras
Hong Kong
Howland Island
Hungary
Iceland
India
Indonesia
Iran
Iraq
Ireland
Isle of Man
Israel
Italy
Jamaica
Jan Mayen
Japan
Jarvis Island
Jersey
Johnston Atoll
Jordan
Juan de Nova Island
Kazakhstan
Kenya
Kingman Reef
Kiribati
Korea, North
Korea, South
Kosovo
Kuwait
Kyrgyzstan
Laos
Latvia
Lebanon
Lesotho
Liberia
Libya
Liechtenstein
Lithuania
Luxembourg
Macau
Macedonia
Madagascar
Malawi
Malaysia
Maldives
Mali
Malta
Marshall Islands
Martinique
Mauritania
Mauritius
Mayotte
Mexico
Micronesia, Federated States of
Midway Islands
Moldova
Monaco
Mongolia
Montenegro
Montserrat
Morocco
Mozambique
Namibia
Nauru
Navassa Island
Nepal
Netherlands
New Caledonia
New Zealand
Nicaragua
Niger
Nigeria
Niue
Norfolk Island
Northern Mariana Islands
Norway
Oman
Pakistan
Palau
Palmyra Atoll
Panama
Papua New Guinea
Paracel Islands
Paraguay
Peru
Philippines
Pitcairn Islands
Poland
Portugal
Puerto Rico
Qatar
Reunion
Romania
Russia
Rwanda
Saint Barthelemy
Saint Helena, Ascension, and Tristan da Cunha
Saint Kitts and Nevis
Saint Lucia
Saint Martin
Saint Pierre and Miquelon
Saint Vincent and the Grenadines
Samoa
San Marino
Sao Tome and Principe
Saudi Arabia
Senegal
Serbia
Seychelles
Sierra Leone
Singapore
Sint Maarten
Slovakia
Slovenia
Solomon Islands
Somalia
South Africa
South Georgia and South Sandwich Islands
South Sudan
Spain
Spratly Islands
Sri Lanka
Sudan
Suriname
Svalbard
Swaziland
Sweden
Switzerland
Syria
Taiwan
Tajikistan
Tanzania
Thailand
Timor-Leste
Togo
Tokelau
Tonga
Trinidad and Tobago
Tromelin Island
Tunisia
Turkey
Turkmenistan
Turks and Caicos Islands
Tuvalu
Uganda
Ukraine
United Arab Emirates
United Kingdom
United States
Uruguay
Uzbekistan
Vanuatu
Vatican City
Venezuela
Vietnam
Virgin Islands, British
Virgin Islands, U.S.
Wake Island
Wallis and Futuna
West Bank
Western Sahara
Yemen
Zambia
Zimbabwe

Language
English
Bahasa Indonesia
Deutsch
Español
Français
Polski
Português
Русский
正體中文

Format

 HTML

 Text

I’m okay with Mozilla handling my info as explained in this [Privacy Policy](https://www.mozilla.org/privacy/).

Sign up now
We will only send you
Mozilla-related information.

## Thanks!

If you haven’t previously confirmed a subscription to a Mozilla-related newsletter you may have to do so. Please check your inbox or your spam filter for an e-mail from us.

[Mozilla](https://www.mozilla.org/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Mozilla

* [About](https://www.mozilla.org/about/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Contact Us](https://www.mozilla.org/contact/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Donate](https://donate.mozilla.org/?presets=50,30,20,10&amount=30¤cy=usd&utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Firefox

* [Download Firefox](https://www.mozilla.org/firefox/new/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Desktop](https://www.mozilla.org/firefox/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Mobile](https://www.mozilla.org/firefox/mobile/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Features](https://www.mozilla.org/firefox/features/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Beta, Nightly, Developer Edition](https://www.mozilla.org/firefox/channel/desktop/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Resources

* [Privacy Hub](https://www.mozilla.org/privacy/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Browser Comparison](https://www.mozilla.org/firefox/browsers/compare/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Brand Standards](https://mozilla.design/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)

##### Social

Follow @Firefox

* [Twitter (@mozilla)](https://twitter.com/firefox)
* [Instagram (@mozilla)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)

Follow @Mozilla

* [Twitter (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)

* [Website Privacy Notice](https://www.mozilla.org/privacy/websites/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)
* [Legal](https://www.mozilla.org/about/legal/?utm_source=blog.mozilla.org&utm_campaign=footer&utm_medium=referral)



=== Content from bugzilla.mozilla.org_2e08e637_20250125_020542.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1023158)
* [XML](/show_bug.cgi?ctype=xml&id=1023158)

Closed
[Bug 1023158](/show_bug.cgi?id=1023158)

Opened 11 years ago
Closed 10 years ago

# Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js

## Categories

### (Core :: JavaScript Engine: JIT, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT#JavaScript%20Engine%3A%20JIT)

JavaScript Engine: JIT
▾

Core :: JavaScript Engine: JIT
JavaScript engine's JIT compilers
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine%3A%20JIT)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla36

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=wontfix) |
| firefox33 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix) |
| firefox34 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) |
| firefox35 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed) |
| firefox36 | --- | [verified](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=verified) |
| firefox-esr31 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected) |
| b2g-v1.4 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected) |
| b2g-v2.0 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected) |
| b2g-v2.0M | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected) |
| b2g-v2.1 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 |  | wontfix |
| firefox33 |  | wontfix |
| firefox34 |  | fixed |
| firefox35 |  | fixed |
| firefox36 |  | verified |
| firefox-esr31 |  | unaffected |
| b2g-v1.4 |  | unaffected |
| b2g-v2.0 |  | unaffected |
| b2g-v2.0M |  | unaffected |
| b2g-v2.1 |  | unaffected |
| b2g-v2.2 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: terrence)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/045baa1e1ab4c1401b5ee569f11eaabf?d=mm&size=40)  [terrence](/user_profile?user_id=231770)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1013001](/show_bug.cgi?id=1013001 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[GC.stability](/show_bug.cgi?id=1008341 "NEW - [meta] GC Correctness & Stability")

Dependency [tree](/showdependencytree.cgi?id=1023158&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1023158)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1057625](/show_bug.cgi?id=1057625 "RESOLVED DUPLICATE - Assertion failure: static_cast<gc::Cell*>(val.toGCThing())->isTenured(), at jit/shared/Assembler-x86-shared.h:151")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1013001](/show_bug.cgi?id=1013001 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189")

## Details

### (Keywords: assertion, sec-high, testcase, Whiteboard: [jsbugmon:update,ignore][only a sec issue with GGC][adv-main34+][b2g-adv-main2.2-])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:update,ignore][only a sec issue with GGC][adv-main34+][b2g-adv-main2.2-]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [[crash-signature] Machine-readable crash signature](/attachment.cgi?id=8437577)  [11 years ago](#c1)  [Christian Holler (:decoder)](/user_profile?user_id=395101)   544 bytes, text/plain |  | [Details](/attachment.cgi?id=8437577&action=edit) |
| --- | --- | --- |
| [backtrace.txt](/attachment.cgi?id=8441569)  [11 years ago](#c3)  [Luke Wagner [:luke]](/user_profile?user_id=347312)   4.02 KB, text/plain |  | [Details](/attachment.cgi?id=8441569&action=edit) |
| [fix pushValue](/attachment.cgi?id=8470215)  [10 years ago](#c13)  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)   951 bytes, patch | jandem : [review+](#c14 "10 years ago") | [Details](/attachment.cgi?id=8470215&action=edit) | [Diff](/attachment.cgi?id=8470215&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1023158&attachment=8470215) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1023158#c0)• 11 years ago |
|  | |

The following testcase asserts on mozilla-central revision 9dc0ffca10f4 (run with --fuzzing-safe --ion-eager):
this.\_\_defineSetter\_\_("x", (function(stdlib) {
"use asm";
function f() {}
return f;
}));
evaluate('var x = "";', { compileAndGo : true });

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a425_395101)• 11 years ago |

[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected)Whiteboard: [jsbugmon:update,bisect]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1023158#c1)• 11 years ago |
|  | |

Attached file
[[crash-signature] Machine-readable crash signature](attachment.cgi?id=8437577)
— [Details](attachment.cgi?id=8437577&action=edit)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a5252_395101)• 11 years ago |

Whiteboard: [jsbugmon:update,bisect] → [jsbugmon:update]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1023158#c2)• 11 years ago |
|  | |

Jan, do you know who might be able to look at this?Flags: needinfo?(jdemooij)Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Luke Wagner [:luke]](/user_profile?user_id=347312) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1023158#c3)• 11 years ago |
|  | |

Attached file
[backtrace.txt](attachment.cgi?id=8441569)
— [Details](attachment.cgi?id=8441569&action=edit)

I was able to reproduce, but only on 32-bit Linux debug (not 64) and only with --thread-count=1. Attached is the full backtrace from gdb. It looks like the IC code assumes that IsCacheableGetPropCallNative implies that the setter is tenured and that is being violated by an asm.js module function (which isNative() and gets cloned non-tenured by JSOP\_LAMBDA). I'm not sure if this is a generally valid assumption or not; the IC code predates GGC. It seems like the fix would be to either update IsCacheableSetPropCallNative to additionally require shape->setterObject()->isTenured() or to change js::CloneFunctionObject to tenure cloned asm.js native functions. Both fix the assert, but I'm not sure which is the "right" fix because I'm not familiar with our general tenuring invariants. Should, e.g., fun->isNative() imply fun->isTenured?Flags: needinfo?(jdemooij) → needinfo?(terrence)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1023158#c4)• 11 years ago |
|  | |

(In reply to Luke Wagner [:luke] from [comment #3](/show_bug.cgi?id=1023158#c3 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"))
> Created [attachment 8441569](/attachment.cgi?id=8441569 "backtrace.txt") [[details]](/attachment.cgi?id=8441569&action=edit "backtrace.txt")
> backtrace.txt
>
> I was able to reproduce, but only on 32-bit Linux debug (not 64) and only
> with --thread-count=1. Attached is the full backtrace from gdb. It looks
> like the IC code assumes that IsCacheableGetPropCallNative implies that the
> setter is tenured and that is being violated by an asm.js module function
> (which isNative() and gets cloned non-tenured by JSOP\_LAMBDA). I'm not sure
> if this is a generally valid assumption or not; the IC code predates GGC.
> It seems like the fix would be to either update IsCacheableSetPropCallNative
> to additionally require shape->setterObject()->isTenured() or to change
> js::CloneFunctionObject to tenure cloned asm.js native functions. Both fix
> the assert, but I'm not sure which is the "right" fix because I'm not
> familiar with our general tenuring invariants. Should, e.g.,
> fun->isNative() imply fun->isTenured?
Initially the invariant was that nursery things would not flow into IC's -- this turned out to be impossible to ensure in practice, so we added ImmMaybeNurseryPtr to do the appropriate tracing. It sounds like I missed a pointer when making this change. Does making the ImmGCPtr at the top of the stack here into an ImmMaybeNurseryPtr fix the crash?
I think this would be the preferred solution over the other two: we shouldn't disable the prop cache ic just because the thing we're caching happens to initially be a nursery thing. Also, I don't see a reason why isNative() JSFunction would necessarily be long-lived, so I'm not sure it makes sense to always tenure those either.Flags: needinfo?(terrence)

|  | [Luke Wagner [:luke]](/user_profile?user_id=347312) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1023158#c5)• 11 years ago |
|  | |

Yes, that does fix the assertion.
Looking around jit/\*/MacroAssembler-\*, there seem to be a bunch of places baking in pointers without any special ImmMaybeNurseryPtr.

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1023158#c6)• 11 years ago |
|  | |

(In reply to Luke Wagner [:luke] from [comment #5](/show_bug.cgi?id=1023158#c5 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"))
> Yes, that does fix the assertion.
>
> Looking around jit/\*/MacroAssembler-\*, there seem to be a bunch of places
> baking in pointers without any special ImmMaybeNurseryPtr.
Yes. The relevant invariant here that I should have stated explicitly above is that anything directly attached to MIR or LIR -- e.g. template objects and such -- must be tenured. Specifically, off-main-thread codegen is synchronized only against major gc, not against minor collection; if anything in the nursery wanders into MIR or LIR this is a serious bug and thus ImmGCPtr asserts that the thing is tenured.
The special case here is where we are compiling a new IC at runtime from an object that hasn't been created specifically as a template. Templates have explicit tenured heap creation, whereas IC's can sometimes be created from arbitrary objects floating around in the system.
Since having a nursery thing flow into codegen would be catastrophic, except in the special case where we are compiling in the foreground for an IC, ImmGCPtr and ImmManybeNurseryPtr are inconvertible and we have created totally separate, duplicated code paths in jit/\*/MacroAssembler-\* taking ImmMaybeNurseryPtr for IC usage. Fortunately this is only 2 functions at the moment.

|  | [Luke Wagner [:luke]](/user_profile?user_id=347312) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1023158#c7)• 11 years ago |
|  | |

Ah, I see, so the issue isn't the nursery pointer being baked into JIT code, we're just using ImmGCPtr as a sort of pinch-point to catch nursery pointers that passed through MIR/LIR. Is that right?
In that case, then it seems like we shouldn't just change ImmGCPtr to ImmMaybeNurseryPtr inside pushValue, since that would add a hole in our assertion wall. It seems like, instead, we'd have a pushValueMaybeInNursery, so that we bubble the maybe-nursery-ness up to the caller in IonCaches.cpp. Does that make sense?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a1323832_406194)• 11 years ago |

Flags: needinfo?(terrence)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1023158#c8)• 11 years ago |
|  | |

(In reply to Luke Wagner [:luke] from [comment #7](/show_bug.cgi?id=1023158#c7 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"))
> Ah, I see, so the issue isn't the nursery pointer being baked into JIT code,
> we're just using ImmGCPtr as a sort of pinch-point to catch nursery pointers
> that passed through MIR/LIR. Is that right?
Yes, well said.
> In that case, then it seems like we shouldn't just change ImmGCPtr to
> ImmMaybeNurseryPtr inside pushValue, since that would add a hole in our
> assertion wall. It seems like, instead, we'd have a
> pushValueMaybeInNursery, so that we bubble the maybe-nursery-ness up to the
> caller in IonCaches.cpp. Does that make sense?
That is exactly right.Flags: needinfo?(terrence)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a1383740_375297)• 11 years ago |

See Also: → [1013001](/show_bug.cgi?id=1013001 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189")

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1023158#c9)• 11 years ago |
|  | |

Marty found a major hole in our assertions here: we don't have any ImmGCPtr equivalent for pointers embedded in Value. The particular case he found, Push(Value), isn't too bad because at least on x86 and arm, this ends up eventually doing push(ImmGCPtr()). On x64, however, we're doing push(ImmWord(layout.asBits)), totally skipping the relevant assertions. We should audit any Value taking entries in \*Assembler\* to make sure they're not baking in nursery pointers by accident.

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1023158#c10)• 11 years ago |
|  | |

(In reply to Terrence Cole [:terrence] from [comment #9](/show_bug.cgi?id=1023158#c9 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"))
> The particular case he found,
> Push(Value), isn't too bad because at least on x86 and arm, this ends up
> eventually doing push(ImmGCPtr()). On x64, however, we're doing
> push(ImmWord(layout.asBits)), totally skipping the relevant assertions. We
> should audit any Value taking entries in \*Assembler\* to make sure they're
> not baking in nursery pointers by accident.
Good catch, but this is not just skipping an assertion, it's also a GC hazard.. push(ImmGCPtr) calls writeDataRelocation, to record the offset of the GC pointer, so that we can trace it later. If we use ImmWord instead of ImmGCPtr, we won't mark this pointer. pushValue on x64 should check val.isMarkable() and in that case use ImmGCPtr instead of ImmWord.
According to "hg annotate", this goes back to [bug 713526](/show_bug.cgi?id=713526 "RESOLVED FIXED - IonMonkey: stub + PIC for SETPROP and SETNAME"), so it's an old bug.

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a1844952_231770)• 11 years ago |

Blocks: [GC.stability](/show_bug.cgi?id=1008341 "NEW - [meta] GC Correctness & Stability")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a2926360_1689)• 11 years ago |

Group: javascript-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1023158#c11)• 10 years ago |
|  | |

[Comment 10](/show_bug.cgi?id=1023158#c10 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js") suggests this is a regression from [bug 713526](/show_bug.cgi?id=713526 "RESOLVED FIXED - IonMonkey: stub + PIC for SETPROP and SETNAME"). Is this something you could look at Brian? Thanks.
[status-firefox32](/buglist.cgi?f1=cf_status_firefox32&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=affected)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)Flags: needinfo?(bhackett1024)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1023158#c12)• 10 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #11](/show_bug.cgi?id=1023158#c11 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"))
> [Comment 10](/show_bug.cgi?id=1023158#c10 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js") suggests this is a regression from [bug 713526](/show_bug.cgi?id=713526 "RESOLVED FIXED - IonMonkey: stub + PIC for SETPROP and SETNAME"). Is this something
> you could look at Brian? Thanks.
I think the assertion / crash here is a GGC bug; comments 9 and 10 are sidetrack and talk about a problem with our x64 backend, whereas this report is for x86.
The method added in [bug 713526](/show_bug.cgi?id=713526 "RESOLVED FIXED - IonMonkey: stub + PIC for SETPROP and SETNAME") does indeed fail to trace the immediate correctly, but I don't think this is a GC hazard by itself without either a moving GC or another bug somewhere in Ion --- for Ion to execute code using a pointer to an object that has been swept, it would have to be executing the code incorrectly. (I suppose Ion could execute code using a pointer to a swept string, which would require either it or baseline to be able to manufacture and bake in string constants for e.g. folded concat, but I don't think we do such things anywhere.) This still needs to be fixed of course but I don't think it is a security risk, and fixing it with a call to writeDataRelocation() would still be problematic with GGC since calling writeDataRelocation() explicitly won't cause post barriers to trigger.

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1023158#c13)• 10 years ago |
|  | |

Attached patch

[fix pushValue](attachment.cgi?id=8470215&action=diff)
— [Details](attachment.cgi?id=8470215&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1023158&attachment=8470215)

[Attachment #8470215](/attachment.cgi?id=8470215&action=edit "fix pushValue") -
Flags: review?(jdemooij)Flags: needinfo?(bhackett1024)

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1023158#c14)• 10 years ago |
|  | |

Comment on [attachment 8470215](/attachment.cgi?id=8470215 "fix pushValue") [[details]](/attachment.cgi?id=8470215&action=edit "fix pushValue") [[diff]](/attachment.cgi?id=8470215&action=diff "fix pushValue") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1023158&attachment=8470215)
fix pushValue
Review of [attachment 8470215](/attachment.cgi?id=8470215 "fix pushValue") [[details]](/attachment.cgi?id=8470215&action=edit "fix pushValue") [[diff]](/attachment.cgi?id=8470215&action=diff "fix pushValue") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1023158&attachment=8470215):
-----------------------------------------------------------------
Looks good but you're right, there's still the GGC issue..
[Attachment #8470215](/attachment.cgi?id=8470215&action=edit "fix pushValue") -
Flags: review?(jdemooij) → review+

|  | [Jan de Mooij [:jandem]](/user_profile?user_id=375297) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1023158#c15)• 10 years ago |
|  | |

NI terrence for the ImmMaybeNurseryPtr issue discussed in [comment 4](/show_bug.cgi?id=1023158#c4 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js") and later.Flags: needinfo?(terrence)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1023158#c16)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/36814bee6277>Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1023158#c17)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/36814bee6277>Assignee: nobody → bhackett1024

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a5394257_346231)• 10 years ago |

Assignee: bhackett1024 → nobody

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a5554785_395101)• 10 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1023158#c18)• 10 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 76b55c0850ca).

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1023158#c20)• 10 years ago |
|  | |

Terrence, can you look at the GGC issue here mentioned in [comment 15](/show_bug.cgi?id=1023158#c15 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js")?

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1023158#c21)• 10 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #20](/show_bug.cgi?id=1023158#c20 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"))
> Terrence, can you look at the GGC issue here mentioned in [comment 15](/show_bug.cgi?id=1023158#c15 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js")?
Sorry for the delay! I thought that the problem here was purely theoretical because of the lack of a new fuzzer testcase in this bug. It turns out Christian actually found a great testcase for this bug back in May and filed it as [bug 1013001](/show_bug.cgi?id=1013001 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189"). It was initially marked as a jit issue and I didn't get NI'd on it, missing it in the tide of bugmail, so was totally unaware of it until Jan linked it in related bugs.
The ball got dropped and I'm not entirely sure how to make sure this situation doesn't happen again. :-(Flags: needinfo?(terrence)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1023158#c22)• 10 years ago |
|  | |

And the additional thing discussed in [comment 6](/show_bug.cgi?id=1023158#c6 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js")+ is now fixed by [bug 1013001](/show_bug.cgi?id=1013001 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189"), so closing the bug as FIXED via the original issue and testcase.Status: NEW → RESOLVEDClosed: 10 years agoResolution: --- → FIXED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a12204794_395101)• 10 years ago |

Status: RESOLVED → VERIFIED
[status-firefox36](/buglist.cgi?f1=cf_status_firefox36&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox36&o1=equals&v1=verified)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1023158#c23)• 10 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1023158#c24)• 10 years ago |
|  | |

Brian, wasn't this fixed in Firefox 34 per the checkin in [comment 17](/show_bug.cgi?id=1023158#c17 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js")? I'm unclear why this didn't go through sec-approval before it was checked in though.
As a sec-high bug, assuming ESR31 is affected, we need to backport this bug to ESR31 unless there is a reason not to do so.Flags: needinfo?(bhackett1024)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1023158#c25)• 10 years ago |
|  | |

Per [comment 12](/show_bug.cgi?id=1023158#c12 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"), Brian thinks this is only a sec issue with generational GC enabled, which is maybe 32 or later, so 31 shouldn't be affected.
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected)Whiteboard: [jsbugmon:update,ignore] → [jsbugmon:update,ignore][only a sec issue with GGC]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1023158#c26)• 10 years ago |
|  | |

Brian, this is a sec-high. Can we get this nominated for 34 and 35 (Beta and Aurora) ASAP and get it checked in?

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1023158#c27)• 10 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #24](/show_bug.cgi?id=1023158#c24 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js"))
> Brian, wasn't this fixed in Firefox 34 per the checkin in [comment 17](/show_bug.cgi?id=1023158#c17 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js")? I'm
> unclear why this didn't go through sec-approval before it was checked in
> though.
>
> As a sec-high bug, assuming ESR31 is affected, we need to backport this bug
> to ESR31 unless there is a reason not to do so.
The patch in 36814bee6277 isn't fixing the crash in this bug, it is addressing a sidetrack unrelated to the original assertion/crash and per [comment 12](/show_bug.cgi?id=1023158#c12 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:203 with asm.js") I don't believe this can trigger any crashing / bad behavior.Flags: needinfo?(bhackett1024)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a13796181_75935)• 10 years ago |

Assignee: nobody → terrence
[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=unaffected)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=unaffected)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=unaffected)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)
[status-firefox32](/buglist.cgi?f1=cf_status_firefox32&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=wontfix)
[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed)Depends on: [1013001](/show_bug.cgi?id=1013001 "VERIFIED FIXED - Assertion failure: ptr->isTenured(), at jit/shared/Assembler-shared.h:189")Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)Target Milestone: --- → mozilla36

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a13854954_1689)• 10 years ago |

Group: javascript-core-security

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a14217263_280903)• 10 years ago |

Whiteboard: [jsbugmon:update,ignore][only a sec issue with GGC] → [jsbugmon:update,ignore][only a sec issue with GGC][adv-main34+]

|  | [Christiane Ruetten [INACTIVE]](/user_profile?user_id=465475) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a32329586_465475)• 10 years ago |

Whiteboard: [jsbugmon:update,ignore][only a sec issue with GGC][adv-main34+] → [jsbugmon:update,ignore][only a sec issue with GGC][adv-main34+][b2g-adv-main2.2-]

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a38781669_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1023158#a62686239_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1023158&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Christian Holler (:decoder)](/user_profile?user_id=395101)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_c4f5afa7_20250125_020558.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1075546)
* [XML](/show_bug.cgi?ctype=xml&id=1075546)

Closed
[Bug 1075546](/show_bug.cgi?id=1075546)

Opened 10 years ago
Closed 10 years ago

# Assertion failure: entry\_ == makeIndex(clasp, key, kind), at vm/Runtime.h

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: entry\_ == makeIndex(clasp, key, kind), at vm/Runtime.h

## Categories

### (Core :: JavaScript: GC, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%3A%20GC#JavaScript%3A%20GC)

JavaScript: GC
▾

Core :: JavaScript: GC
File bugs here for issues involving the garbage collector (crashes, leaks, etc.), where the issue is *not* one caused by failure to use the JSAPI correctly.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20GC&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20GC&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%3A%20GC)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla35

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=wontfix) |
| firefox33 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix) |
| firefox34 | [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=verified) |
| firefox35 | --- | [verified](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=verified) |
| firefox-esr31 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected) |
| b2g-v1.4 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected) |
| b2g-v2.0 | --- | [disabled](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=disabled) |
| b2g-v2.0M | --- | [disabled](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=disabled) |
| b2g-v2.1 | --- | [disabled](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=disabled) |
| b2g-v2.2 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox32 |  | wontfix |
| firefox33 |  | wontfix |
| firefox34 | + | verified |
| firefox35 |  | verified |
| firefox-esr31 |  | unaffected |
| b2g-v1.4 |  | unaffected |
| b2g-v2.0 |  | disabled |
| b2g-v2.0M |  | disabled |
| b2g-v2.1 |  | disabled |
| b2g-v2.2 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: jonco)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9ec760b0d3a20a6775614baa4086871?d=mm&size=40)  [jonco](/user_profile?user_id=443194)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC")

Dependency [tree](/showdependencytree.cgi?id=1075546&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1075546)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1075598](/show_bug.cgi?id=1075598 "RESOLVED DUPLICATE - Intermittent browser_markupview_anonymous_02.js | application crashed [@ js::NewObjectCache::fill(int, js::Class const*, js::gc::Cell*, js::gc::AllocKind, JSObject*)] | Assertion failure: entry_ == makeIndex(clasp, key, kind), at /builds/slave/m-in-lx-d-")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [jsbugmon:][adv-main34+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:][adv-main34+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c14 "10 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [bug1075546](/attachment.cgi?id=8499493)  [10 years ago](#c5)  [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)   1.71 KB, patch | terrence : [review+](#a176054_231770 "10 years ago")  abillings : [approval-mozilla-aurora+](#a614143_280903 "10 years ago")  abillings : [sec-approval+](#a527231_280903 "10 years ago") | [Details](/attachment.cgi?id=8499493&action=edit) | [Diff](/attachment.cgi?id=8499493&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075546&attachment=8499493) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1075546#c0)• 10 years ago |
|  | |

for (var i = 0; i < 200; ++i) {
Object.getOwnPropertyNames(undefined + "");
}
function p(s) {
for (var i = 0; i < s.length; i++) {
s.charCodeAt(i);
}
}
function m(f) {
var a = [];
for (var j = 0; j < 700; ++j) {
try {
f()
} catch (e) {
a.push(e.toString());
}
}
p(uneval(a));
}
f = Function("\
function f() {\
functionf\n{}\
}\
m(f);\
");
f();
f();
for (var x = 0; x < 99; x++) {
newGlobal()
}
asserts the following js debug shell on m-c changeset 6c824fbb73e8 with --no-asmjs --no-baseline --no-ion --no-threads at Assertion failure: entry\_ == makeIndex(clasp, key, kind), at vm/Runtime.h.
<https://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2014-10-01-mozilla-central-debug/jsshell-mac64.zip>
=== Tinderbox Build Bisection Results by autoBisect ===
The "good" changeset has the timestamp "20140930050920" and the hash "1de7e7a7ad8d".
The "bad" changeset has the timestamp "20140930052624" and the hash "f33f7dc50aa9".
Likely regression window: <https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=1de7e7a7ad8d&tochange=f33f7dc50aa9>
Jon, is [bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC") a possible regressor? (Setting this as s-s because [bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC") is s-s.)Flags: needinfo?(jcoppeard)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1075546#c1)• 10 years ago |
|  | |

There are no nice stacks available for js shells from tinderbox-builds.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a2123_395101)• 10 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1075546#c2)• 10 years ago |
|  | |

JSBugMon: Cannot process bug: Unable to automatically reproduce, please track manually.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1075546#c3)• 10 years ago |
|  | |

This does not reproduce for locally compiled builds but seems to reproduce readily with tinderbox-builds ones.

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1075546#c4)• 10 years ago |
|  | |

(In reply to Gary Kwong [:gkw] [:nth10sd] GMT-4 Sep 29 - Oct 3 from [comment #0](/show_bug.cgi?id=1075546#c0 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h"))
[Bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC") added the assertion, but this may be a pre-existing problem.Assignee: nobody → jcoppeardFlags: needinfo?(jcoppeard)

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1075546#c5)• 10 years ago |
|  | |

Attached patch

[bug1075546](attachment.cgi?id=8499493&action=diff)
— [Details](attachment.cgi?id=8499493&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1075546&attachment=8499493)

Repros fine for me with the attached testcase.
The problem was the fix for [bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC") was incomplete. When recording the current GC number, it's important to record it \*before\* a GC can happen :)
With this patch, the gc number is recorded only if the cache lookup fails. If it succeeds, there are two cases - either we create a new object successfully and return, or we fail and GC. In the latter case we just leave gcNumber initialized to zero, which means the later test for GC will always fail.
[Attachment #8499493](/attachment.cgi?id=8499493&action=edit "bug1075546") -
Flags: review?(terrence)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a176054_231770)• 10 years ago |

[Attachment #8499493](/attachment.cgi?id=8499493&action=edit "bug1075546") -
Flags: review?(terrence) → review+

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1075546#c6)• 10 years ago |
|  | |

Comment on [attachment 8499493](/attachment.cgi?id=8499493 "bug1075546") [[details]](/attachment.cgi?id=8499493&action=edit "bug1075546") [[diff]](/attachment.cgi?id=8499493&action=diff "bug1075546") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075546&attachment=8499493)
[bug1075546](/show_bug.cgi?id=1075546 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h")
[Security approval request comment]
This is a followup to fix an issue with the fix in [bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC"), so the details here are mostly the same.
How easily could an exploit be constructed based on the patch?
Difficult.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
The contents of the patch indicate an issue with GCs occurring in specific places, but I don't think it's easy to take advantage of that.
Which older supported branches are affected by this flaw?
As per [bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC"), everything back to FF 32.
If not all supported branches, which bug introduced the flaw?
Generational GC enabled on desktop in [bug 619558](/show_bug.cgi?id=619558 "RESOLVED FIXED - [meta] Implement generational garbage collection").
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Backporting should be combined with [bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC"), the patch is easy to create and should apply without problems.
How likely is this patch to cause regressions; how much testing does it need?
Should be low risk, again it would be a good idea to let it sit on central for a week first.
[Attachment #8499493](/attachment.cgi?id=8499493&action=edit "bug1075546") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a426057_75935)• 10 years ago |

[status-b2g-v1.4](/buglist.cgi?f1=cf_status_b2g_1_4&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g_1_4&o1=equals&v1=unaffected)
[status-b2g-v2.0](/buglist.cgi?f1=cf_status_b2g_2_0&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_b2g_2_0&o1=equals&v1=disabled)
[status-b2g-v2.0M](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_b2g_2_0m&o1=equals&v1=disabled)
[status-b2g-v2.1](/buglist.cgi?f1=cf_status_b2g_2_1&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_b2g_2_1&o1=equals&v1=disabled)
[status-b2g-v2.2](/buglist.cgi?f1=cf_status_b2g_2_2&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_b2g_2_2&o1=equals&v1=fixed)
[status-firefox32](/buglist.cgi?f1=cf_status_firefox32&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox32&o1=equals&v1=wontfix)
[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected)
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected)
[status-firefox-esr31](/buglist.cgi?f1=cf_status_firefox_esr31&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr31&o1=equals&v1=unaffected)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1075546#c7)• 10 years ago |
|  | |

Comment on [attachment 8499493](/attachment.cgi?id=8499493 "bug1075546") [[details]](/attachment.cgi?id=8499493&action=edit "bug1075546") [[diff]](/attachment.cgi?id=8499493&action=diff "bug1075546") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075546&attachment=8499493)
[bug1075546](/show_bug.cgi?id=1075546 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h")
This is too late to make it into 33. We're building soon for the release build. We should get this on Aurora though. Can you make and nominate an Aurora patch?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a440869_280903)• 10 years ago |

[status-firefox33](/buglist.cgi?f1=cf_status_firefox33&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox33&o1=equals&v1=wontfix)
[tracking-firefox34](/buglist.cgi?f1=cf_tracking_firefox34&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox34&o1=equals&v1=%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1075546#c8)• 10 years ago |
|  | |

What is the security severity on this? [bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC") is a sec-audit, though I don't know if that's actually correct.

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1075546#c9)• 10 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #8](/show_bug.cgi?id=1075546#c8 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h"))
I've nominated the [bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC") for aurora/beta uplift. The patch here will apply cleanly after that one. I'm waiting on sec-approval to land this though (my guess at a security rating is for the original bug is sec-high).

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a527231_280903)• 10 years ago |

[Attachment #8499493](/attachment.cgi?id=8499493&action=edit "bug1075546") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a530824_1689)• 10 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1075546#c10)• 10 years ago |
|  | |

Jon, please go ahead and do the Aurora approval request when you push this to inbound so we don't wait another day to cycle around.

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1075546#c11)• 10 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/4007aeccec79>

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1075546#c12)• 10 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/4007aeccec79>Status: NEW → RESOLVEDClosed: 10 years ago
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla35

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1075546#c13)• 10 years ago |
|  | |

Comment on [attachment 8499493](/attachment.cgi?id=8499493 "bug1075546") [[details]](/attachment.cgi?id=8499493&action=edit "bug1075546") [[diff]](/attachment.cgi?id=8499493&action=diff "bug1075546") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1075546&attachment=8499493)
[bug1075546](/show_bug.cgi?id=1075546 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h")
Approval Request Comment
[Feature/regressing bug #]: [Bug 619558](/show_bug.cgi?id=619558 "RESOLVED FIXED - [meta] Implement generational garbage collection") (fix in [bug 1073577](/show_bug.cgi?id=1073577 "RESOLVED FIXED - Objects can be put into the wrong entry in the new object cache after a minor GC") is incomplete)
[User impact if declined]: Potential security vulnerability
[Describe test coverage new/current, TBPL]: Test case in bug
[Risks and why]: Low
[String/UUID change made/needed]: None
[Attachment #8499493](/attachment.cgi?id=8499493&action=edit "bug1075546") -
Flags: approval-mozilla-aurora?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a614143_280903)• 10 years ago |

[Attachment #8499493](/attachment.cgi?id=8499493&action=edit "bug1075546") -
Flags: approval-mozilla-aurora? → approval-mozilla-aurora+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a614159_280903)• 10 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1075546#c14)• 10 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/75ebb70f8b38>
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed)Flags: in-testsuite+Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1075546#c16)• 10 years ago |
|  | |

Reproduced the original issue using the steps from [comment #0](/show_bug.cgi?id=1075546#c0 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h"):
\* Build Used: <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2014/10/2014-10-01-mozilla-central-debug/>
\*\* Assertion: Assertion failure: entry\_ == makeIndex(clasp, key, kind), at /builds/slave/m-cen-osx64-d-0000000000000000/build/js/src/vm/Runtime.h:334
Verified using the following builds:
\* Build Used: <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2014-11-21-mozilla-central-debug/>
\*\* ran the poc from [comment #0](/show_bug.cgi?id=1075546#c0 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h") several times (10x) without receiving the original assertion
\* Build Used: <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2014-11-21-mozilla-aurora-debug/>
\*\* ran the poc from [comment #0](/show_bug.cgi?id=1075546#c0 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h") several times (10x) without receiving the original assertion
\* Build Used: <http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2014-11-21-mozilla-beta-debug/>
\*\* ran the poc from [comment #0](/show_bug.cgi?id=1075546#c0 "VERIFIED FIXED - Assertion failure: entry_ == makeIndex(clasp, key, kind), at vm/Runtime.h") several times (10x) without receiving the original assertionStatus: RESOLVED → VERIFIED
[status-firefox34](/buglist.cgi?f1=cf_status_firefox34&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox34&o1=equals&v1=verified)
[status-firefox35](/buglist.cgi?f1=cf_status_firefox35&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox35&o1=equals&v1=verified)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a4441032_280903)• 10 years ago |

Whiteboard: [jsbugmon:] → [jsbugmon:][adv-main34+]

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a29004749_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1075546#a52909257_1689)• 9 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1075546&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


