=== Content from www.debian.org_7485ef5c_20250124_164739.html ===


---

[[Date Prev](msg00127.html)][[Date Next](msg00129.html)]
[[Thread Prev](msg00127.html)][[Thread Next](msg00129.html)]
[[Date Index](maillist.html#00128)]
[[Thread Index](threads.html#00128)]

# [SECURITY] [DSA 2946-1] python-gnupg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2946-1] python-gnupg security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 4 Jun 2014 18:55:29 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20140604165521.GA2313%40pisco.westfalen.local)Â [20140604165521.GA2313@pisco.westfalen.local](msg00128.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2946-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
June 04, 2014                          <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : python-gnupg
CVE ID         : CVE-2013-7323 CVE-2014-1927 CVE-2014-1928 CVE-2014-1929

Multiple vulnerabilities were discovered in the Python wrapper for the
Gnu Privacy Guard (GPG). Insufficient sanitising could lead to the
execution of arbitrary shell commands.

For the stable distribution (wheezy), these problems have been fixed in
version 0.3.6-1~deb7u1.

For the testing distribution (jessie), these problems have been fixed in
version 0.3.6-1.

For the unstable distribution (sid), these problems have been fixed in
version 0.3.6-1.

We recommend that you upgrade your python-gnupg packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJTj0GeAAoJEBDCk7bDfE42aroQAJ75f7AJw24Ak+kOjP7G8bas
R3duqHp0TZVgIo4qlp/hH7Nv2wEtQVPzUcc2BjlZG/h8olfYnQfINZgBU/qVgXg3
AKYBhO/Vli/ZJO1svH9fJIKNxfzWclZuCqF/rrpd2t+sIxQmdANoV/U/rQ+eAHoS
RBPEgrHBsbL8IlufzJcdCE2K1IxFj+4ARuzsLKiZigCAZfg2L/p5W6x+SDPP5Yt0
hGCX/G76iSBwXsoievcPa43m+iGSLpphUankpsknZzfpBCx3vcrznpkP6Lt8S/Se
toyKBWXPWQMP77qf5wFxb31Xd/TSLJ+wZtK4Sl5pEOD25B4I59YcMlSxzNj/AGGs
R34jImIdAuCuVEP5oeq2bE4Ps0i0lbZwmDzJ9hNHhZ1lbs4CLehECWCFS0FYuqux
FgdXydAWcgLw9YOQM42jWg6m8kt3zzcrv9zjyC2wX/IQG3E8/h7q3I356Bw1wboQ
wX5GI5uaA1uNFq0fY3htbxEwN5J+skazVr0sns+JfQcPJtOtbM+L8HdJ6so+wpgr
crmbljhd/vpEQGI2UcF05zympdhP7ss4S/Sapn9c6Ws/XZl4JfUoaU6FKtUY7c/2
n/ZNfD/V9SxW7cgA0qQUm9NvOXa0BkynxyZ0aU/DrUEyvPWMQRU5qwraLU8noUHZ
gDxLHLrhunBSY+71FPg1
=0p3h
-----END PGP SIGNATURE-----

```

---



=== Content from seclists.org_7b516762_20250124_164738.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](293)
[By Date](date.html#294)
[![Next](/images/right-icon-16x16.png)](295)

[![Previous](/images/left-icon-16x16.png)](262)
[By Thread](index.html#294)
[![Next](/images/right-icon-16x16.png)](303)

![](/shared/images/nst-icons.svg#search)

# Re: CVE request: python-gnupg before 0.3.5 shell injection

---

*From*: cve-assign () mitre org

*Date*: Sun, 9 Feb 2014 16:40:24 -0500 (EST)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> CVE request is still pending. I think we now need two:
> 1. Shell injection partly fixed in 0.3.5.
> 2. Incomplete fix for shell injection fixed in 0.3.6.
>
> ```

```

We think either 3 or 4 may be a better number of CVEs.

First, it seems that the shell_quote function in version 0.3.5 has two
fundamentally different problems with different flaw types and
different discoverers. The code in question is:

  elif len(s) >= 2 and (s[0], s[-1]) == ("'", "'"):
      result = '"%s"' % s.replace('"', r'\"')

The first problem, noted by Florian Weimer, is that this type of
attempt to quote ' characters by using " characters is inherently
wrong because the " and ' characters are not equivalent in the shell.
In his example, the input ends up surrounded by " characters, but the
string inside has a $( command substitution, and thus the command will
be executed. In other words, using " characters simply cannot work
correctly because "$(command)" is unsafe whereas '$(command)' is safe.

The second problem, noted by Matthew Daley, is that arbitrary
insertion of a \ character into a string is unsafe because it can
convert a single command into a list. This is independent of the
non-equivalence of " and ' in the shell. In particular, the same list
vulnerability can be seen with this 0.3.5 code variant:

  elif len(s) >= 2 and (s[0], s[-1]) == ('"', '"'):
      result = "'%s'" % s.replace("'", r"\'")

along with the analogous variant of the Python input. The only
difference is that the shell prints a different number of \
characters. In each case, the erroneous \ insertion separates the
string into a list of two commands, and the touch command is executed.

Specifically, using the original 0.3.5 code:

  >>> print shell_quote("'\\\"; touch foo #'")
  "'\\"; touch foo #'"

  % ls foo
  ls: cannot access foo: No such file or directory
  % echo "'\\"; touch foo #'"
  '\
  % ls foo
  foo

Using the above 0.3.5 code variant:

  >>> print shell_quote('"\\\'; touch foo #"')
  '"\\'; touch foo #"'

  % rm foo
  % ls foo
  ls: cannot access foo: No such file or directory
  % echo '"\\'; touch foo #"'
  "\\
  % ls foo
  foo

So, the CVE assignments for these issues are:

  CVE-2013-7323 Unrestricted use of unquoted strings in a shell,
                within version 0.3.4

  CVE-2014-1927 Erroneous assumptions about the usability of "
                characters within version 0.3.5, leading to attacks
                such as $( command substitution within a "-quoted
                string

  CVE-2014-1928 Erroneous insertion of a \ character within version
                0.3.5, leading to attacks involving command lists
                (such as lists separated by a ; character)

Second, 0.3.5 and 0.3.6 have a series of differences in handling of
command-line arguments. This seems to be most likely a reaction to
Florian Weimer's observation of "you need to make sure that you
prevent option injection through positional arguments." Does anyone
believe that option injection was impossible in 0.3.5? If not, we will
make a fourth CVE assignment.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJS9/R/AAoJEKllVAevmvms2KEIAL8fK5oUKE0AKsgy2yDka8dn
uPBgXFVnls9/SIPrX3d+Zc1ouGerBvEQlaTIv+CgN6e9NzH3YTeec9KIVnCvCunf
wgaSe0xFzRTWf+qviEpe0vbc9wgz2wmct0qHLoE0i9vsrYhn4x+2+xEoliD38d12
QSNu93KLhZJ1VqQMaROrjKuv1jIkR27yEdf5JLSflBvyu3mxR6dlBByqLOdBbfHG
rj4MMJfcwsD6fvWrk22clX2ZLVZsZAUvuSzcuD0kWiCHABcn00DWFYv1cC0plxDI
GnlGPeHg5+2lQUVt5QHy/0MYiJ7g4h7gxXeB8w1JH0DL7ASYaF3wDLkdBrrJT8I=
=G9KN
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](293)
[By Date](date.html#294)
[![Next](/images/right-icon-16x16.png)](295)

[![Previous](/images/left-icon-16x16.png)](262)
[By Thread](index.html#294)
[![Next](/images/right-icon-16x16.png)](303)

### Current thread:

* **Re: CVE request: python-gnupg before 0.3.5 shell injection**, *(continued)** + [Re: CVE request: python-gnupg before 0.3.5 shell injection](244) *Henri Salo (Feb 04)*
      - [Re: CVE request: python-gnupg before 0.3.5 shell injection](245) *Florian Weimer (Feb 04)*
        * [Re: CVE request: python-gnupg before 0.3.5 shell injection](247) *Henri Salo (Feb 04)*
        * [Re: CVE request: python-gnupg before 0.3.5 shell injection](248) *Henri Salo (Feb 04)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](249) *Florian Weimer (Feb 04)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](254) *Vinay Sajip (Feb 05)** [Re: Re: CVE request: python-gnupg before 0.3.5 shell injection](255) *Florian Weimer (Feb 05)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](256) *Vinay Sajip (Feb 05)*
      - [Re: CVE request: python-gnupg before 0.3.5 shell injection](246) *Matthew Daley (Feb 04)*
    + [Re: CVE request: python-gnupg before 0.3.5 shell injection](262) *Hanno BÃ¶ck (Feb 06)*
      - **Re: CVE request: python-gnupg before 0.3.5 shell injection** *cve-assign (Feb 09)*
        * [Re: Re: CVE request: python-gnupg before 0.3.5 shell injection](303) *Simon McVittie (Feb 10)*
        * [Re: CVE request: python-gnupg before 0.3.5 shell injection](335) *cve-assign (Feb 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from code.google.com_08aa85e6_20250124_164740.html ===

[# Google Code](/archive/)

[## Archive](/archive/)
[Skip to content](#content)

The Google Code Archive requires JavaScript to be enabled in your browser.

* [Google](//www.google.com/)
* [About Google](//www.google.com/intl/en/about/)
* [Privacy](//www.google.com/intl/en/policies/privacy/)
* [Terms](//www.google.com/intl/en/policies/terms/)



=== Content from seclists.org_2ea0a4d3_20250124_164737.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](245)
[By Date](date.html#246)
[![Next](/images/right-icon-16x16.png)](247)

[![Previous](/images/left-icon-16x16.png)](256)
[By Thread](index.html#246)
[![Next](/images/right-icon-16x16.png)](262)

![](/shared/images/nst-icons.svg#search)

# Re: CVE request: python-gnupg before 0.3.5 shell injection

---

*From*: Matthew Daley <mattd () bugfuzz com>

*Date*: Tue, 4 Feb 2014 23:27:34 +1300

---

```
On Tue, Feb 4, 2014 at 11:04 PM, Henri Salo <henri () nerv fi> wrote:

```
> ```
> On Tue, Feb 04, 2014 at 10:35:46AM +0100, Hanno BÃ¶ck wrote:
>
> ```
> > ```
> > python-gnupg 0.3.5 lists in the changelog:
> > "Added improved shell quoting to guard against shell injection."
> >
> > Sounds like a severe security issue, but further info is lacking.
> >
> > ```
>
> ```
>
>
> Diff attached. New function shell_quote() seems to represent major changes to
> shell input quoting against unsafe input.
> [...]
>
> ```

```

This appears to (at least) miss escaping of backslashes:

$ ls foo
ls: cannot access foo: No such file or directory
$ python
Python 2.7.6 (default, Jan 11 2014, 14:34:26)
[GCC 4.8.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.

```
> > > ```
> > > import gnupg
> > > gnupg.GPG().sign_file(open("/dev/null"), "'\\\"; touch foo #'")
> > >
> > > ```

```
<gnupg.Sign object at 0x7fb3dbfad7d0>

```
> > > ```
> > >
> > >
> > >
> > > ```

```
$ ls foo
foo

- Matthew

```

---

[![Previous](/images/left-icon-16x16.png)](245)
[By Date](date.html#246)
[![Next](/images/right-icon-16x16.png)](247)

[![Previous](/images/left-icon-16x16.png)](256)
[By Thread](index.html#246)
[![Next](/images/right-icon-16x16.png)](262)

### Current thread:

* [CVE request: python-gnupg before 0.3.5 shell injection](243) *Hanno BÃ¶ck (Feb 04)*
  + [Re: CVE request: python-gnupg before 0.3.5 shell injection](244) *Henri Salo (Feb 04)*
    - [Re: CVE request: python-gnupg before 0.3.5 shell injection](245) *Florian Weimer (Feb 04)*
      * [Re: CVE request: python-gnupg before 0.3.5 shell injection](247) *Henri Salo (Feb 04)*
      * [Re: CVE request: python-gnupg before 0.3.5 shell injection](248) *Henri Salo (Feb 04)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](249) *Florian Weimer (Feb 04)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](254) *Vinay Sajip (Feb 05)** [Re: Re: CVE request: python-gnupg before 0.3.5 shell injection](255) *Florian Weimer (Feb 05)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](256) *Vinay Sajip (Feb 05)*
    - **Re: CVE request: python-gnupg before 0.3.5 shell injection** *Matthew Daley (Feb 04)*
  + [Re: CVE request: python-gnupg before 0.3.5 shell injection](262) *Hanno BÃ¶ck (Feb 06)*
    - [Re: CVE request: python-gnupg before 0.3.5 shell injection](294) *cve-assign (Feb 09)*
      * [Re: Re: CVE request: python-gnupg before 0.3.5 shell injection](303) *Simon McVittie (Feb 10)*
      * [Re: CVE request: python-gnupg before 0.3.5 shell injection](335) *cve-assign (Feb 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


