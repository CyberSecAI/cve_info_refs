=== Content from www.debian.org_7485ef5c_20250125_235143.html ===


---

[[Date Prev](msg00127.html)][[Date Next](msg00129.html)]
[[Thread Prev](msg00127.html)][[Thread Next](msg00129.html)]
[[Date Index](maillist.html#00128)]
[[Thread Index](threads.html#00128)]

# [SECURITY] [DSA 2946-1] python-gnupg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2946-1] python-gnupg security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 4 Jun 2014 18:55:29 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20140604165521.GA2313%40pisco.westfalen.local)Â [20140604165521.GA2313@pisco.westfalen.local](msg00128.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2946-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
June 04, 2014                          <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : python-gnupg
CVE ID         : CVE-2013-7323 CVE-2014-1927 CVE-2014-1928 CVE-2014-1929

Multiple vulnerabilities were discovered in the Python wrapper for the
Gnu Privacy Guard (GPG). Insufficient sanitising could lead to the
execution of arbitrary shell commands.

For the stable distribution (wheezy), these problems have been fixed in
version 0.3.6-1~deb7u1.

For the testing distribution (jessie), these problems have been fixed in
version 0.3.6-1.

For the unstable distribution (sid), these problems have been fixed in
version 0.3.6-1.

We recommend that you upgrade your python-gnupg packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJTj0GeAAoJEBDCk7bDfE42aroQAJ75f7AJw24Ak+kOjP7G8bas
R3duqHp0TZVgIo4qlp/hH7Nv2wEtQVPzUcc2BjlZG/h8olfYnQfINZgBU/qVgXg3
AKYBhO/Vli/ZJO1svH9fJIKNxfzWclZuCqF/rrpd2t+sIxQmdANoV/U/rQ+eAHoS
RBPEgrHBsbL8IlufzJcdCE2K1IxFj+4ARuzsLKiZigCAZfg2L/p5W6x+SDPP5Yt0
hGCX/G76iSBwXsoievcPa43m+iGSLpphUankpsknZzfpBCx3vcrznpkP6Lt8S/Se
toyKBWXPWQMP77qf5wFxb31Xd/TSLJ+wZtK4Sl5pEOD25B4I59YcMlSxzNj/AGGs
R34jImIdAuCuVEP5oeq2bE4Ps0i0lbZwmDzJ9hNHhZ1lbs4CLehECWCFS0FYuqux
FgdXydAWcgLw9YOQM42jWg6m8kt3zzcrv9zjyC2wX/IQG3E8/h7q3I356Bw1wboQ
wX5GI5uaA1uNFq0fY3htbxEwN5J+skazVr0sns+JfQcPJtOtbM+L8HdJ6so+wpgr
crmbljhd/vpEQGI2UcF05zympdhP7ss4S/Sapn9c6Ws/XZl4JfUoaU6FKtUY7c/2
n/ZNfD/V9SxW7cgA0qQUm9NvOXa0BkynxyZ0aU/DrUEyvPWMQRU5qwraLU8noUHZ
gDxLHLrhunBSY+71FPg1
=0p3h
-----END PGP SIGNATURE-----

```

---



=== Content from seclists.org_c9c7ad31_20250125_235141.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](334)
[By Date](date.html#335)
[![Next](/images/right-icon-16x16.png)](336)

[![Previous](/images/left-icon-16x16.png)](303)
[By Thread](index.html#335)
[![Next](/images/right-icon-16x16.png)](258)

![](/shared/images/nst-icons.svg#search)

# Re: CVE request: python-gnupg before 0.3.5 shell injection

---

*From*: cve-assign () mitre org

*Date*: Wed, 12 Feb 2014 11:21:18 -0500 (EST)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> Second, 0.3.5 and 0.3.6 have a series of differences in handling of
> command-line arguments. This seems to be most likely a reaction to
> Florian Weimer's observation of "you need to make sure that you
> prevent option injection through positional arguments." Does anyone
> believe that option injection was impossible in 0.3.5? If not, we will
> make a fourth CVE assignment.
>
> ```

```

Use CVE-2014-1929.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJS+57hAAoJEKllVAevmvmshgoH/i9CI0xncK8FfQE2t8dA96Cc
3u94LLYzD+hqLMKSuNdArk7ekx00M/53p6ntFqff+neZWGLqVteo4ZPUFspWIv0W
P7u1GWAMZl75KamqgRXrcp5mPbE5axe7FrEW0Z3Wd0PdT4xWMa9GUALypqGrOYNr
zHehk+eLhqqapD4Z2xBFDjMEAzHobTeOHXP7tOL7e7+ut3UMmGAlG/i6FIBn3XKq
/X2mHQ8EykDyb09oyih20NuttOtNr9aOkTJyODJK6Yqdr7gPu3tD3TVogqYvYNRm
qwPZZLfEqvH4rlMsua/exySvQSMp+eOl+NJ720YRU8XPRzZGzxqZguaayAryT+U=
=Pt+A
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](334)
[By Date](date.html#335)
[![Next](/images/right-icon-16x16.png)](336)

[![Previous](/images/left-icon-16x16.png)](303)
[By Thread](index.html#335)
[![Next](/images/right-icon-16x16.png)](258)

### Current thread:

* **Re: CVE request: python-gnupg before 0.3.5 shell injection**, *(continued)** + - * [Re: CVE request: python-gnupg before 0.3.5 shell injection](247) *Henri Salo (Feb 04)*
        * [Re: CVE request: python-gnupg before 0.3.5 shell injection](248) *Henri Salo (Feb 04)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](249) *Florian Weimer (Feb 04)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](254) *Vinay Sajip (Feb 05)** [Re: Re: CVE request: python-gnupg before 0.3.5 shell injection](255) *Florian Weimer (Feb 05)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](256) *Vinay Sajip (Feb 05)*
      - [Re: CVE request: python-gnupg before 0.3.5 shell injection](246) *Matthew Daley (Feb 04)*
    + [Re: CVE request: python-gnupg before 0.3.5 shell injection](262) *Hanno BÃ¶ck (Feb 06)*
      - [Re: CVE request: python-gnupg before 0.3.5 shell injection](294) *cve-assign (Feb 09)*
        * [Re: Re: CVE request: python-gnupg before 0.3.5 shell injection](303) *Simon McVittie (Feb 10)*
        * **Re: CVE request: python-gnupg before 0.3.5 shell injection** *cve-assign (Feb 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_c7f4eeaf_20250125_235140.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](244)
[By Date](date.html#245)
[![Next](/images/right-icon-16x16.png)](246)

[![Previous](/images/left-icon-16x16.png)](244)
[By Thread](index.html#245)
[![Next](/images/right-icon-16x16.png)](247)

![](/shared/images/nst-icons.svg#search)

# Re: CVE request: python-gnupg before 0.3.5 shell injection

---

*From*: Florian Weimer <fweimer () redhat com>

*Date*: Tue, 04 Feb 2014 11:19:25 +0100

---

```

On 02/04/2014 11:04 AM, Henri Salo wrote:

```
> ```
>
> On Tue, Feb 04, 2014 at 10:35:46AM +0100, Hanno BÃ¶ck wrote:
>
> ```
> > ```
> >
> > python-gnupg 0.3.5 lists in the changelog:
> > "Added improved shell quoting to guard against shell injection."
> >
> > Sounds like a severe security issue, but further info is lacking.
> >
> > ```
>
> ```
>
>
> Diff attached. New function shell_quote() seems to represent major changes to
> shell input quoting against unsafe input.
>
> +# We use the test below because it works for Jython as well as CPython
> +if os.path.__name__ == 'ntpath':
> +    # On Windows, we don't need shell quoting, other than worrying about
> +    # paths with spaces in them.
> +    def shell_quote(s):
> +        return '"%s"' % s
> +else:
> +    # Section copied from sarge
> +
> +    # This regex determines which shell input needs quoting
> +    # because it may be unsafe
> +    UNSAFE = re.compile(r'[^\w%+,./:=@-]')
> +
> +    def shell_quote(s):
> +        """
> +        Quote text so that it is safe for Posix command shells.
> +
> +        For example, "*.py" would be converted to "'*.py'". If the text is
> +        considered safe it is returned unquoted.
> +
> +        :param s: The value to quote
> +        :type s: str (or unicode on 2.x)
> +        :return: A safe version of the input, from the point of view of Posix
> +                 command shells
> +        :rtype: The passed-in type
> +        """
> +        if not isinstance(s, string_types):
> +            raise TypeError('Expected string type, got %s' % type(s))
> +        if not s:
> +            result = "''"
> +        elif len(s) >= 2 and (s[0], s[-1]) == ("'", "'"):
> +            result = '"%s"' % s.replace('"', r'\"')
> +        elif not UNSAFE.search(s):
> +            result = s
> +        else:
> +            result = "'%s'" % s.replace("'", "'\"'\"'")
> +        return result
> +
> +    # end of sarge code
>
> ```

```

This fix appears to be incomplete:

>>> print shell_quote("'$(touch /tmp/I_was_here'")
"'$(touch /tmp/I_was_here'"

[fweimer@oldenburg ~]$ echo "'$(touch /tmp/I_was_here)'"
''
[fweimer@oldenburg ~]$ ls -l /tmp/I_was_here
-rw-rw-r--. 1 fweimer fweimer 0 Feb  4 11:12 /tmp/I_was_here

```
The proper way (at least if your shell runs in a UTF-8 or ISO-8859
locale) to escape shell arguments is to wrap them in '', after replacing
embedded ' characters with the four character sequence '\''. However,
using the subprocess module with shell=False (the default) is strongly
preferred.
```

```
In both cases, you need to make sure that you prevent option injection
through positional arguments. With a GNU getopt-derived command line
parser, option processing can be terminated with a -- argument.
(Warning: GnuPG does not strictly follow GNU command line processing
conventions.)
```

```
Is anyone in touch with the python-gpg folks and can rely this
information? Thanks.
```

--
Florian Weimer / Red Hat Product Security Team

```

---

[![Previous](/images/left-icon-16x16.png)](244)
[By Date](date.html#245)
[![Next](/images/right-icon-16x16.png)](246)

[![Previous](/images/left-icon-16x16.png)](244)
[By Thread](index.html#245)
[![Next](/images/right-icon-16x16.png)](247)

### Current thread:

* [CVE request: python-gnupg before 0.3.5 shell injection](243) *Hanno BÃ¶ck (Feb 04)*
  + [Re: CVE request: python-gnupg before 0.3.5 shell injection](244) *Henri Salo (Feb 04)*
    - **Re: CVE request: python-gnupg before 0.3.5 shell injection** *Florian Weimer (Feb 04)*
      * [Re: CVE request: python-gnupg before 0.3.5 shell injection](247) *Henri Salo (Feb 04)*
      * [Re: CVE request: python-gnupg before 0.3.5 shell injection](248) *Henri Salo (Feb 04)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](249) *Florian Weimer (Feb 04)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](254) *Vinay Sajip (Feb 05)** [Re: Re: CVE request: python-gnupg before 0.3.5 shell injection](255) *Florian Weimer (Feb 05)** [Re: CVE request: python-gnupg before 0.3.5 shell injection](256) *Vinay Sajip (Feb 05)*
    - [Re: CVE request: python-gnupg before 0.3.5 shell injection](246) *Matthew Daley (Feb 04)*
  + [Re: CVE request: python-gnupg before 0.3.5 shell injection](262) *Hanno BÃ¶ck (Feb 06)*
    - [Re: CVE request: python-gnupg before 0.3.5 shell injection](294) *cve-assign (Feb 09)*
      * [Re: Re: CVE request: python-gnupg before 0.3.5 shell injection](303) *Simon McVittie (Feb 10)*
*(Thread continues...)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


