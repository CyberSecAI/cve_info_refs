=== Content from github.com_8fc57187_20250124_191721.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frestlet%2Frestlet-framework-java%2Fwiki%2FXEE-security-enhancements)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frestlet%2Frestlet-framework-java%2Fwiki%2FXEE-security-enhancements)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fwiki%2Fshow&source=header-repo&source_repo=restlet%2Frestlet-framework-java)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[restlet](/restlet)
/
**[restlet-framework-java](/restlet/restlet-framework-java)**
Public

* [Notifications](/login?return_to=%2Frestlet%2Frestlet-framework-java) You must be signed in to change notification settings
* [Fork
  284](/login?return_to=%2Frestlet%2Frestlet-framework-java)
* [Star
   654](/login?return_to=%2Frestlet%2Frestlet-framework-java)

* [Code](/restlet/restlet-framework-java)
* [Issues
  590](/restlet/restlet-framework-java/issues)
* [Pull requests
  16](/restlet/restlet-framework-java/pulls)
* [Discussions](/restlet/restlet-framework-java/discussions)
* [Actions](/restlet/restlet-framework-java/actions)
* [Projects
  0](/restlet/restlet-framework-java/projects)
* [Wiki](/restlet/restlet-framework-java/wiki)
* [Security](/restlet/restlet-framework-java/security)
* [Insights](/restlet/restlet-framework-java/pulse)

Additional navigation options

* [Code](/restlet/restlet-framework-java)
* [Issues](/restlet/restlet-framework-java/issues)
* [Pull requests](/restlet/restlet-framework-java/pulls)
* [Discussions](/restlet/restlet-framework-java/discussions)
* [Actions](/restlet/restlet-framework-java/actions)
* [Projects](/restlet/restlet-framework-java/projects)
* [Wiki](/restlet/restlet-framework-java/wiki)
* [Security](/restlet/restlet-framework-java/security)
* [Insights](/restlet/restlet-framework-java/pulse)

# XEE security enhancements

[Jump to bottom](#wiki-pages-box)
 [Edit](/restlet/restlet-framework-java/wiki/XEE-security-enhancements/_edit)
 [New page](/restlet/restlet-framework-java/wiki/_new)

Thierry Boileau edited this page Oct 2, 2017
·
[18 revisions](/restlet/restlet-framework-java/wiki/XEE-security-enhancements/_history)

## Summary

Here are listed the several security issues reported and the related enhancements.

## Vulnerability CVE-2017-14949

Restlet Framework XEE vulnerability is referenced as [CVE-2017-14949](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14949).

**Note:** Version 2.3.12 introduced enhancement to to circumvent this vulnerability, as well as newer versions also include the fix.

Thanks to Man Yue Mo of [Semmle Inc.](https://semmle.com/) and [lgtm.com](https://lgtm.com) for reporting us this issue and providing assistance while fixing it.

### Identified vulnerabilities

Are subject to XEE vulnerability, user codes that rely on the "XML" Restlet Framework extension.

### Security enhancements

The XmlRepresentation (and inherited DOMRepresentation and SaxRepresentation), JacksonRepresentation classes and subclasses leverage one attribute called "expandingEntityRefs". This attribute has been introduced when handling [vulnerability CVE-2014-1868](#vulnerability-cve-2014-1868). Unfortunately, setting this attribute to `false` did not prevent properly to expand external entities.
The security fix ensures incoming XML streams are parsed safely in order to block expansion of entities.

## Vulnerability CVE-2017-14868

Restlet Framework XEE vulnerability is referenced as [CVE-2017-14868](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14868).

**Note:** Version 2.3.11 introduced enhancement to to circumvent this vulnerability, as well as newer versions also include the fix.

Thanks to Man Yue Mo of [Semmle Inc.](https://semmle.com/) and [lgtm.com](https://lgtm.com) for reporting us this issue and providing assistance while fixing it.

### Identified vulnerabilities

Are subject to XEE vulnerability, user codes that rely on the "Jax-rs" Restlet Framework extension.

### Security enhancements

The security fix ensures incoming XML streams are parsed safely in order to block expansion of entities.

##### Technical details

The issue was introduced by external library `simple-xml`. At the time of writing, this library has been forked in order to provide a fix quickly. The maintenance team has been contacted, and we wait for their answer.

## Vulnerability CVE-2014-1868

Restlet Framework XEE vulnerability is referenced as [CVE-2014-1868](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1868).

**Note:** Versions 2.1.7 and 2.2 RC1 introduced enhancements and default behaviors to circumvent this vulnerability, as well as newer versions also include the fix.

For details regarding XEE (XML ENTITY EXPANSION), see <http://en.wikipedia.org/wiki/Billion_laughs>. Thanks to Alvaro Munoz from HP Fortify for reporting the issue and his assistance with the CVE process.

### Identified vulnerabilities

Are subject to XEE vulnerability, user codes that rely on the following Restlet Framework extensions :

* "xml" extension,
* "atom", "javamail", "lucene", "odata", "openid", "rdf", "wadl", "xdb" that directly depends on the "xml" extension.
* "jackson", "jaxb", "jibx", "xstream", "rome" that provides automatic converters.

### Security enhancements

#### If your code leverages XMLRepresentation or XML serializers

The following Restlet Framework components are concerned :

* XMLRepresentation and its sub classes : SaxRepresentation, DomRepresentation.
* but also representations that help handling serialization/deserializations from class instances to XML streams : JacksonRepresentation, JibxRepresentation, XStreamRepresentation, SyndFeedRepresentation (rome).

The security fix ensures incoming XML streams are parsed safely : at the representation level, we've added specific attributes, accessors and constructors (in case XML parsing happens at instantiation time)

##### Technical details

The XmlRepresentation (and inherited DOMRepresentation and SaxRepresentation), JacksonRepresentation classes and subclasses declare two new attributes :

* "expandingEntityRefs": instance attribute which specifies if the parser should expand entity referenced nodes, default value : false (inherited from XML\_EXPANDING\_ENTITY\_REFS),
* "validatingDtd": instance attribute to enforce XML stream validation against a DTD, default value : false (inherited from XML\_VALIDATING\_DTD).

You may override the default value of these attributes if you need Entity Expansion or DTD validation. In these cases, you 'll be subject to XEE vulnerability.

Moreover, the SaxRepresentation and its subclasses declare a third new attribute :

* "secureProcessing": instance attribute which activates the Sax internal secure processing feature (to avoid XML overflow attacks), default value : true (inherited from XML\_SECURE\_PROCESSING).

#### If your code uses Annotated ServerResources

In this case, the Restlet Framework engine calls XML converters, that leverage the Representation classes and subclasses discussed above.

The security fix enlarges the control you have regarding the XML parsing handled at the Representation level.

* XML\_EXPANDING\_ENTITY\_REFS: class attribute that sets the default value for the "expandingEntityRefs" instance attribute. Default value is false (inherited from the "org.restlet.ext.xml.expandingEntityRefs" system property).
* XML\_VALIDATING\_DTD: class attribute that provides the default value for the "validatingDtd" attribute. Default value is false (inherited from the "org.restlet.ext.xml.validatingDtd" system property).
* XML\_SECURE\_PROCESSING class attribute that provides the default value for the "secureProcessing" attribute. Default value is true (overrided by the "org.restlet.ext.xml.secureProcessing" system property).

#### Other XML Parsers

The enhancements described above concern the Jackson and Jaxb parsers.

The Rome extension relies on JDOM. Our XEE internal tests did not reveal XEE vulnerability.

The XStream extension relies on SAX, and is explicitely configured to be XEE safe. Our XEE internal tests confirmed no XEE vulnerability.

Concerning the JiBX and Emf extensions, our XEE internal tests did not reveal XEE vulnerability. Yet, we welcome your feedbacks on these later extensions.

[Add a custom footer](/restlet/restlet-framework-java/wiki/_new?wiki%5Bname%5D=_Footer)

### Toggle table of contents Pages 7

* Loading

  [Home](/restlet/restlet-framework-java/wiki)
* Loading

  [Contribute](/restlet/restlet-framework-java/wiki/Contribute)
* Loading

  [Contribute using Eclipse IDE](/restlet/restlet-framework-java/wiki/Contribute-using-Eclipse-IDE)
* Loading

  [Inception](/restlet/restlet-framework-java/wiki/Inception)
* Loading

  [Roadmap](/restlet/restlet-framework-java/wiki/Roadmap)
* Loading

  [Specifications of ValidatorService](/restlet/restlet-framework-java/wiki/Specifications-of-ValidatorService)
* Loading

  [XEE security enhancements](/restlet/restlet-framework-java/wiki/XEE-security-enhancements)

  + [Summary](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#summary)
  + [Vulnerability CVE-2017-14949](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#vulnerability-cve-2017-14949)
  + [Identified vulnerabilities](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#identified-vulnerabilities)
  + [Security enhancements](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#security-enhancements)
  + [Vulnerability CVE-2017-14868](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#vulnerability-cve-2017-14868)
  + [Identified vulnerabilities](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#identified-vulnerabilities-1)
  + [Security enhancements](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#security-enhancements-1)
  + [Technical details](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#technical-details)
  + [Vulnerability CVE-2014-1868](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#vulnerability-cve-2014-1868)
  + [Identified vulnerabilities](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#identified-vulnerabilities-2)
  + [Security enhancements](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#security-enhancements-2)
  + [If your code leverages XMLRepresentation or XML serializers](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#if-your-code-leverages-xmlrepresentation-or-xml-serializers)
  + [Technical details](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#technical-details-1)
  + [If your code uses Annotated ServerResources](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#if-your-code-uses-annotated-serverresources)
  + [Other XML Parsers](/restlet/restlet-framework-java/wiki/XEE-security-enhancements#other-xml-parsers)

[Add a custom sidebar](/restlet/restlet-framework-java/wiki/_new?wiki%5Bname%5D=_Sidebar)
##### Clone this wiki locally

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


