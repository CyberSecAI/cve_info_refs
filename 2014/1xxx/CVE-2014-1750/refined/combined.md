=== Content from plugins.trac.wordpress.org_bf63bec0_20250125_185040.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fnokia-mapsplaces%2Ftrunk%2Fnokia-mapsplaces.php%3Frev%3D841883)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=802499 "Revision 802499")
* [Latest Revision](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php)
* [Next Revision](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=842384 "Revision 842384") →
* [Blame](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?annotate=blame&rev=841883 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=841883)

---

# [source:](/browser?rev=841883&order=name "Go to repository root") [nokia-mapsplaces](/browser/nokia-mapsplaces?rev=841883&order=name "View nokia-mapsplaces")/[trunk](/browser/nokia-mapsplaces/trunk?rev=841883&order=name "View trunk")/[nokia-mapsplaces.php](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=841883&order=name "View nokia-mapsplaces.php") @ [841883](/changeset/841883/ "View changeset 841883")

View diff against:

View revision:

| [Last change](/changeset/841883/nokia-mapsplaces/trunk/nokia-mapsplaces.php "View differences") on this file since 841883 was [841883](/changeset/841883/ "View changeset 841883"), checked in by radek.adamczyk, [11 years ago](/timeline?from=2014-01-20T16%3A43%3A53Z&precision=second "See timeline at 01/20/2014 04:43:53 PM") |
| --- |
| fixing href sec. issue. Place is is extracted instead of passing the full url which can be compromised |
| **File size:** 4.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* This file is part of Nokia Maps Places Wordpress plugin |
| [3](#L3) |  |
| [4](#L4) | Copyright (c) 2011 Nokia Corporation and/or its subsidiary(-ies).\* |
| [5](#L5) | All rights reserved. |
| [6](#L6) |  |
| [7](#L7) | Contact:  Nokia Corporation radoslaw.adamczyk@nokia.com |
| [8](#L8) |  |
| [9](#L9) | You may use this file under the terms of the BSD license as follows: |
| [10](#L10) |  |
| [11](#L11) | Redistribution and use in source and binary forms, with or without modification, |
| [12](#L12) | are permitted provided that the following conditions are met: |
| [13](#L13) | \* Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. |
| [14](#L14) | \* Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. |
| [15](#L15) | \* Neither the name of Nokia Corporation and its Subsidiary(-ies) nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. |
| [16](#L16) |  |
| [17](#L17) | THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. |
| [18](#L18) | \*/ |
| [19](#L19) |  |
| [20](#L20) | /\* |
| [21](#L21) | Plugin Name: Nokia Maps Places |
| [22](#L22) | Plugin URI: http://wordpress.org/extend/plugins/nokia-mapsplaces/ |
| [23](#L23) | Description: With this plugin you are able to add a places and addresses into a post or a page. |
| [24](#L24) | Version: 1.6.6 |
| [25](#L25) | Author: Nokia Corporation |
| [26](#L26) | Author Email: radoslaw.adamczyk@nokia.com |
| [27](#L27) | License: BSD License |
| [28](#L28) | \*/ |
| [29](#L29) |  |
| [30](#L30) | include\_once (dirname(\_\_FILE\_\_) . '/widget.php'); |
| [31](#L31) |  |
| [32](#L32) |  |
| [33](#L33) | /\*\* |
| [34](#L34) | \* get\_nokiaplaces\_url |
| [35](#L35) | \* |
| [36](#L36) | \* @package Nokia Places Plugin |
| [37](#L37) | \* Get plugin\_url > used in tinymce.php |
| [38](#L38) | \* |
| [39](#L39) | \*/ |
| [40](#L40) | function nokiaplaces\_url($path = '') { |
| [41](#L41) | global $wp\_version; |
| [42](#L42) | if (version\_compare($wp\_version, '2.8', '<')) { // Using WordPress 2.7 |
| [43](#L43) | $folder = dirname(plugin\_basename(\_\_FILE\_\_)); |
| [44](#L44) | if ('.' != $folder) |
| [45](#L45) | $path = path\_join(ltrim($folder, '/'), $path); |
| [46](#L46) |  |
| [47](#L47) | return plugins\_url($path); |
| [48](#L48) | } |
| [49](#L49) | return plugins\_url($path, \_\_FILE\_\_); |
| [50](#L50) | } |
| [51](#L51) |  |
| [52](#L52) | include\_once (dirname(\_\_FILE\_\_) . '/tinymce/tinymce.php'); |
| [53](#L53) |  |
| [54](#L54) | /\*\* |
| [55](#L55) | \* allow\_iframe |
| [56](#L56) | \* |
| [57](#L57) | \* Allows iframe in editor |
| [58](#L58) | \* |
| [59](#L59) | \*/ |
| [60](#L60) | function add\_iframe($initArray) { |
| [61](#L61) | $initArray['extended\_valid\_elements'] = "iframe[id|frameborder|height|scrolling|src|width]"; |
| [62](#L62) | return $initArray; |
| [63](#L63) | } |
| [64](#L64) |  |
| [65](#L65) | add\_filter('tiny\_mce\_before\_init', 'add\_iframe'); |
| [66](#L66) |  |
| [67](#L67) | /\*\* |
| [68](#L68) | \* |
| [69](#L69) | \* @package Nokia Places Plugin |
| [70](#L70) | \* Register Nokia places shortcode and the way extracting it |
| [71](#L71) | \* |
| [72](#L72) | \*/ |
| [73](#L73) | // [nokia-maps template="template" place="placeId"] |
| [74](#L74) | //or [nokia-maps template="template" place\_data="jsonObject"] |
| [75](#L75) | function nokia\_place\_shortcode($atts, $c) { |
| [76](#L76) | $map = array( |
| [77](#L77) | 'placeid' => '', |
| [78](#L78) | 'place\_data\_params' => '', |
| [79](#L79) | 'template' => '', |
| [80](#L80) | 'sizes' => '', |
| [81](#L81) | 'display\_options' => '', |
| [82](#L82) | 'tiletype' => '', |
| [83](#L83) | 'zoomlevel' => '', |
| [84](#L84) | 'latitude' => '', |
| [85](#L85) | 'longitude' => '', |
| [86](#L86) | 'title' => '' |
| [87](#L87) | ); |
| [88](#L88) |  |
| [89](#L89) | if(isset($atts['place\_data\_params'])){ |
| [90](#L90) | for($i = 1; $i <= $atts['place\_data\_params']; $i++){ |
| [91](#L91) | $map['place\_data\_'.$i] = ''; |
| [92](#L92) | } |
| [93](#L93) | } |
| [94](#L94) |  |
| [95](#L95) | //extract place identifier from the url |
| [96](#L96) | preg\_match('([\w\d]{8}-[\w\d]{32}[;context=\w\d]\*)', $atts['href'], $matches); |
| [97](#L97) | $atts['placeid'] = $matches[0]; |
| [98](#L98) | unset($atts['href']); |
| [99](#L99) |  |
| [100](#L100) | $atts = shortcode\_atts($map, $atts); |
| [101](#L101) | $str = http\_build\_query($atts); |
| [102](#L102) | preg\_match("#height':\s?'(\d+)'#", $atts['sizes'], $size); |
| [103](#L103) |  |
| [104](#L104) | return create\_nokia\_places\_post($str, $size[1]); |
| [105](#L105) | } |
| [106](#L106) |  |
| [107](#L107) | add\_shortcode('nokia-maps', 'nokia\_place\_shortcode'); |
| [108](#L108) |  |
| [109](#L109) | /\*\* |
| [110](#L110) | \* insert\_nokiaplace |
| [111](#L111) | \* |
| [112](#L112) | \* @package Nokia Places Plugin |
| [113](#L113) | \* Insert nokia places basic place |
| [114](#L114) | \* |
| [115](#L115) | \*/ |
| [116](#L116) | function create\_nokia\_places\_post($query, $height) { |
| [117](#L117) | //Replace shortcode with div+js core |
| [118](#L118) | $frame\_id = md5($query); |
| [119](#L119) | return "<iframe id='places\_api\_view{$frame\_id}' frameborder='no' scrolling='no' height='{$height}' width='100%' src='".get\_option('siteurl')."/wp-content/plugins/nokia-mapsplaces/page/place.html?{$query}&amp;iframeid={$frame\_id}'>IFRAMES not supported</iframe>"; |
| [120](#L120) | } |
| [121](#L121) |  |
| [122](#L122) |  |
| [123](#L123) |  |
| [124](#L124) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=841883&format=txt)
* [Original Format](/export/841883/nokia-mapsplaces/trunk/nokia-mapsplaces.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from seclists.org_d935b790_20250125_185039.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](180)
[By Date](date.html#181)
[![Next](/images/right-icon-16x16.png)](182)

[![Previous](/images/left-icon-16x16.png)](173)
[By Thread](index.html#181)
[![Next](/images/right-icon-16x16.png)](174)

![](/shared/images/nst-icons.svg#search)

# Re: CVE: Request

---

*From*: cve-assign () mitre org

*Date*: Wed, 29 Jan 2014 23:54:22 -0500 (EST)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> I have reported cross site scripting(xss) in Nokia Maps & Places(v:1.6.6)
> wordpress plugin.
>
> ```

```

```
> ```
> Issue Fixed on : 20/01/2014
>
> ```

```

```
> ```
> <https://plugins.trac.wordpress.org/changeset?new=842384%40nokia-mapsplaces%2Ftrunk%2Fnokia-mapsplaces.php&old=802499%40nokia-mapsplaces%2Ftrunk%2Fnokia-mapsplaces.php>
>
> ```

```

```
> ```
> <https://plugins.trac.wordpress.org/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=841883>
> fixing href sec. issue. Place is is extracted instead of passing the full url which can be compromised
>
> ```

```

```
> ```
> <https://plugins.trac.wordpress.org/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=842384>
> adding context to placeid when stored, removing href to prevent url injection
>
> ```

```

Use CVE-2014-1750.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJS6dgPAAoJEKllVAevmvms2RUIALgdXfCiG7qNw9vDGay7u6fK
k00XiXVomz74EZ5NcFQhowXeDD7w/3SB/b1184DSxeAyV8OgzbNNZIM2eebb3n/7
ZeoVni1mifs9SreoQj1mp8bzSr/IDCUgjU58qAHYC7Bekqw1Sy/nSvWFfEGxxxJ3
paccCGcfJqcJyoIVuAKJre0avFB7fXXsFwovOjgto/K4TqDGa2wabrYF9lcx6kew
3uu3D4gyBdCbioZRhoe0F5R32XQrlHep9OX9wIhveIKUV/JqHxROxO+3oZmjDpr4
qU5qVvG1eLy7ZOM3bl/rQWnEE6opoNLJ/HonQxN2d9rXXwlnh+tLl5m3AjM46jU=
=oS6K
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](180)
[By Date](date.html#181)
[![Next](/images/right-icon-16x16.png)](182)

[![Previous](/images/left-icon-16x16.png)](173)
[By Thread](index.html#181)
[![Next](/images/right-icon-16x16.png)](174)

### Current thread:

* [CVE: Request](173) *Puneeth Gowda (Jan 29)*
  + **Re: CVE: Request** *cve-assign (Jan 29)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_36495e1c_20250125_185038.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](172)
[By Date](date.html#173)
[![Next](/images/right-icon-16x16.png)](174)

[![Previous](/images/left-icon-16x16.png)](175)
[By Thread](index.html#173)
[![Next](/images/right-icon-16x16.png)](181)

![](/shared/images/nst-icons.svg#search)

# CVE: Request

---

*From*: Puneeth Gowda <puneethis021 () gmail com>

*Date*: Wed, 29 Jan 2014 20:40:43 +0530

---

```
Kindly issue the CVE-ID.

I have reported cross site scripting(xss) in Nokia Maps & Places(v:1.6.6)
wordpress plugin.

Link: <http://wordpress.org/plugins/nokia-mapsplaces/>
Disclosed to plugins () wordpress org : 18/01/2014
Contacted author via twitter : No response
vulnerable link from wordpress svn :
<http://plugins.svn.wordpress.org/nokia-mapsplaces/tags/1.6.6/page/place.html>

Issue Fixed on : 20/01/2014
Reference for change log :
<https://plugins.trac.wordpress.org/log/nokia-mapsplaces/>

Regards
Puneeth Gowda
CEH | OSCP
puneethis021 () gmail com

---------- Forwarded message ----------
From: Puneeth Gowda <puneethis021 () gmail com>
Date: Sat, Jan 18, 2014 at 5:15 PM
Subject: Vulnerability in Nokia Maps & Places (Version:1.6.6)
To: plugins () wordpress org

Hi,

I would like to report cross site scripting(xss) in Nokia Maps &
Places(v:1.6.6) wordpress plugin.

Please find the attached document for POC.

Kindly let me know if you face any issues while reproducing POC.

Thanks
Puneeth Gowda

```

**Attachment:
[XSS in Nokia Maps & Places plugin v 1.6.6.pdf](att-173/XSS_in_Nokia_Maps_%26_Places_plugin_v_1_6_6_pdf.bin)**

*Description:*

---

[![Previous](/images/left-icon-16x16.png)](172)
[By Date](date.html#173)
[![Next](/images/right-icon-16x16.png)](174)

[![Previous](/images/left-icon-16x16.png)](175)
[By Thread](index.html#173)
[![Next](/images/right-icon-16x16.png)](181)

### Current thread:

* **CVE: Request** *Puneeth Gowda (Jan 29)*
  + [Re: CVE: Request](181) *cve-assign (Jan 29)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from plugins.trac.wordpress.org_a588f0bf_20250126_110936.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fnokia-mapsplaces%2Ftrunk%2Fnokia-mapsplaces.php%3Frev%3D842384)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=841883 "Revision 841883")
* [Latest Revision](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php)
* [Next Revision](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=842387 "Revision 842387") →
* [Blame](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?annotate=blame&rev=842384 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=842384)

---

# [source:](/browser?rev=842384&order=name "Go to repository root") [nokia-mapsplaces](/browser/nokia-mapsplaces?rev=842384&order=name "View nokia-mapsplaces")/[trunk](/browser/nokia-mapsplaces/trunk?rev=842384&order=name "View trunk")/[nokia-mapsplaces.php](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=842384&order=name "View nokia-mapsplaces.php") @ [842384](/changeset/842384/ "View changeset 842384")

View diff against:

View revision:

| [Last change](/changeset/842384/nokia-mapsplaces/trunk/nokia-mapsplaces.php "View differences") on this file since 842384 was [842384](/changeset/842384/ "View changeset 842384"), checked in by radek.adamczyk, [11 years ago](/timeline?from=2014-01-21T11%3A38%3A26Z&precision=second "See timeline at 01/21/2014 11:38:26 AM") |
| --- |
| adding context to placeid when stored, removing href to prevent url injection |
| **File size:** 4.8 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* This file is part of Nokia Maps Places Wordpress plugin |
| [3](#L3) |  |
| [4](#L4) | Copyright (c) 2011 Nokia Corporation and/or its subsidiary(-ies).\* |
| [5](#L5) | All rights reserved. |
| [6](#L6) |  |
| [7](#L7) | Contact:  Nokia Corporation radoslaw.adamczyk@nokia.com |
| [8](#L8) |  |
| [9](#L9) | You may use this file under the terms of the BSD license as follows: |
| [10](#L10) |  |
| [11](#L11) | Redistribution and use in source and binary forms, with or without modification, |
| [12](#L12) | are permitted provided that the following conditions are met: |
| [13](#L13) | \* Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. |
| [14](#L14) | \* Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. |
| [15](#L15) | \* Neither the name of Nokia Corporation and its Subsidiary(-ies) nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. |
| [16](#L16) |  |
| [17](#L17) | THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. |
| [18](#L18) | \*/ |
| [19](#L19) |  |
| [20](#L20) | /\* |
| [21](#L21) | Plugin Name: Nokia Maps Places |
| [22](#L22) | Plugin URI: http://wordpress.org/extend/plugins/nokia-mapsplaces/ |
| [23](#L23) | Description: With this plugin you are able to add a places and addresses into a post or a page. |
| [24](#L24) | Version: 1.6.6 |
| [25](#L25) | Author: Nokia Corporation |
| [26](#L26) | Author Email: radoslaw.adamczyk@nokia.com |
| [27](#L27) | License: BSD License |
| [28](#L28) | \*/ |
| [29](#L29) |  |
| [30](#L30) | include\_once (dirname(\_\_FILE\_\_) . '/widget.php'); |
| [31](#L31) |  |
| [32](#L32) |  |
| [33](#L33) | /\*\* |
| [34](#L34) | \* get\_nokiaplaces\_url |
| [35](#L35) | \* |
| [36](#L36) | \* @package Nokia Places Plugin |
| [37](#L37) | \* Get plugin\_url > used in tinymce.php |
| [38](#L38) | \* |
| [39](#L39) | \*/ |
| [40](#L40) | function nokiaplaces\_url($path = '') { |
| [41](#L41) | global $wp\_version; |
| [42](#L42) | if (version\_compare($wp\_version, '2.8', '<')) { // Using WordPress 2.7 |
| [43](#L43) | $folder = dirname(plugin\_basename(\_\_FILE\_\_)); |
| [44](#L44) | if ('.' != $folder) |
| [45](#L45) | $path = path\_join(ltrim($folder, '/'), $path); |
| [46](#L46) |  |
| [47](#L47) | return plugins\_url($path); |
| [48](#L48) | } |
| [49](#L49) | return plugins\_url($path, \_\_FILE\_\_); |
| [50](#L50) | } |
| [51](#L51) |  |
| [52](#L52) | include\_once (dirname(\_\_FILE\_\_) . '/tinymce/tinymce.php'); |
| [53](#L53) |  |
| [54](#L54) | /\*\* |
| [55](#L55) | \* allow\_iframe |
| [56](#L56) | \* |
| [57](#L57) | \* Allows iframe in editor |
| [58](#L58) | \* |
| [59](#L59) | \*/ |
| [60](#L60) | function add\_iframe($initArray) { |
| [61](#L61) | $initArray['extended\_valid\_elements'] = "iframe[id|frameborder|height|scrolling|src|width]"; |
| [62](#L62) | return $initArray; |
| [63](#L63) | } |
| [64](#L64) |  |
| [65](#L65) | add\_filter('tiny\_mce\_before\_init', 'add\_iframe'); |
| [66](#L66) |  |
| [67](#L67) | /\*\* |
| [68](#L68) | \* |
| [69](#L69) | \* @package Nokia Places Plugin |
| [70](#L70) | \* Register Nokia places shortcode and the way extracting it |
| [71](#L71) | \* |
| [72](#L72) | \*/ |
| [73](#L73) | // [nokia-maps template="template" place="placeId"] |
| [74](#L74) | //or [nokia-maps template="template" place\_data="jsonObject"] |
| [75](#L75) | function nokia\_place\_shortcode($atts, $c) { |
| [76](#L76) | $map = array( |
| [77](#L77) | 'placeid' => '', |
| [78](#L78) | 'place\_data\_params' => '', |
| [79](#L79) | 'template' => '', |
| [80](#L80) | 'sizes' => '', |
| [81](#L81) | 'display\_options' => '', |
| [82](#L82) | 'tiletype' => '', |
| [83](#L83) | 'zoomlevel' => '', |
| [84](#L84) | 'latitude' => '', |
| [85](#L85) | 'longitude' => '', |
| [86](#L86) | 'title' => '' |
| [87](#L87) | ); |
| [88](#L88) |  |
| [89](#L89) | if(isset($atts['place\_data\_params'])){ |
| [90](#L90) | for($i = 1; $i <= $atts['place\_data\_params']; $i++){ |
| [91](#L91) | $map['place\_data\_'.$i] = ''; |
| [92](#L92) | } |
| [93](#L93) | } |
| [94](#L94) |  |
| [95](#L95) | //extract place identifier from the url |
| [96](#L96) | if(!isset($atts['placeid'])){ |
| [97](#L97) | //try to find place id |
| [98](#L98) | preg\_match('([\w\d]{8}-[\w\d]{32}[;context=\w\d]\*)', $atts['href'], $matches); |
| [99](#L99) | if(!isset($matches[0])){ |
| [100](#L100) | //try to find the 'loc' id (for addresses) |
| [101](#L101) | preg\_match('(loc-[\w\d]+[;context=\w\d]\*)', $atts['href'], $matches); |
| [102](#L102) | $atts['placeid'] = $matches[0]; |
| [103](#L103) | } else { |
| [104](#L104) | $atts['placeid'] = $matches[0]; |
| [105](#L105) | } |
| [106](#L106) | } |
| [107](#L107) |  |
| [108](#L108) | unset($atts['href']); |
| [109](#L109) |  |
| [110](#L110) | $atts = shortcode\_atts($map, $atts); |
| [111](#L111) | $str = http\_build\_query($atts); |
| [112](#L112) | preg\_match("#height':\s?'(\d+)'#", $atts['sizes'], $size); |
| [113](#L113) |  |
| [114](#L114) | return create\_nokia\_places\_post($str, $size[1]); |
| [115](#L115) | } |
| [116](#L116) |  |
| [117](#L117) | add\_shortcode('nokia-maps', 'nokia\_place\_shortcode'); |
| [118](#L118) |  |
| [119](#L119) | /\*\* |
| [120](#L120) | \* insert\_nokiaplace |
| [121](#L121) | \* |
| [122](#L122) | \* @package Nokia Places Plugin |
| [123](#L123) | \* Insert nokia places basic place |
| [124](#L124) | \* |
| [125](#L125) | \*/ |
| [126](#L126) | function create\_nokia\_places\_post($query, $height) { |
| [127](#L127) | //Replace shortcode with div+js core |
| [128](#L128) | $frame\_id = md5($query); |
| [129](#L129) | return "<iframe id='places\_api\_view{$frame\_id}' frameborder='no' scrolling='no' height='{$height}' width='100%' src='".get\_option('siteurl')."/wp-content/plugins/nokia-mapsplaces/page/place.html?{$query}&amp;iframeid={$frame\_id}'>IFRAMES not supported</iframe>"; |
| [130](#L130) | } |
| [131](#L131) |  |
| [132](#L132) |  |
| [133](#L133) |  |
| [134](#L134) | ?> |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/nokia-mapsplaces/trunk/nokia-mapsplaces.php?rev=842384&format=txt)
* [Original Format](/export/842384/nokia-mapsplaces/trunk/nokia-mapsplaces.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


