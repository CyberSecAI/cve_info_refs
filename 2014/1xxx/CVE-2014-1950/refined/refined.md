```
{
  "vulnerability_details": {
    "root_cause": "The `xc_cpupool_getinfo()` function in Xen does not properly handle a failure by the `xc_cpumap_alloc()` function. If `xc_cpumap_alloc()` fails, `xc_cpupool_getinfo()` frees the pointer and then incorrectly returns the freed pointer.",
    "weaknesses": [
      "Use-after-free vulnerability"
    ],
    "impact": "An attacker may be able to cause a multi-threaded toolstack using this function to race against itself leading to heap corruption and a potential DoS. Depending on the malloc implementation, privilege escalation cannot be ruled out.",
    "attack_vectors": "An attacker can trigger the vulnerability by exploiting a multi-threaded toolstack that calls `xc_cpupool_getinfo()` under memory pressure.",
    "attacker_capabilities": "The attacker requires access to management functions of a system running a vulnerable Xen version with a multi-threaded toolstack. Untrusted users with access to such toolstack functionality are a threat."
  },
  "affected_systems": [
    "Xen 4.1 onwards",
    "Multithreaded toolstacks (e.g., xend)",
    "Systems where management functions are exposed to untrusted users",
    "Systems using libxl as a library in a multithreaded context"
  ],
  "mitigation": "Not allowing untrusted users access to toolstack functionality will avoid this issue.",
   "patches": [
        "xsa88.patch"
    ]
}
```