=== Content from github.com_1b40aebd_20250125_155055.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplack%2FPlack%2Fissues%2F405)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplack%2FPlack%2Fissues%2F405)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=plack%2FPlack)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[plack](/plack)
/
**[Plack](/plack/Plack)**
Public

* [Notifications](/login?return_to=%2Fplack%2FPlack) You must be signed in to change notification settings
* [Fork
  212](/login?return_to=%2Fplack%2FPlack)
* [Star
   488](/login?return_to=%2Fplack%2FPlack)

* [Code](/plack/Plack)
* [Issues
  72](/plack/Plack/issues)
* [Pull requests
  34](/plack/Plack/pulls)
* [Actions](/plack/Plack/actions)
* [Projects
  0](/plack/Plack/projects)
* [Wiki](/plack/Plack/wiki)
* [Security](/plack/Plack/security)
* [Insights](/plack/Plack/pulse)

Additional navigation options

* [Code](/plack/Plack)
* [Issues](/plack/Plack/issues)
* [Pull requests](/plack/Plack/pulls)
* [Actions](/plack/Plack/actions)
* [Projects](/plack/Plack/projects)
* [Wiki](/plack/Plack/wiki)
* [Security](/plack/Plack/security)
* [Insights](/plack/Plack/pulse)

# Plack::App::File prunes trailing slashes via split() invocation #405

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Plack::App::File prunes trailing slashes via split() invocation](#top)#405Copy link[![@avar](https://avatars.githubusercontent.com/u/45301?v=4&size=80)](/avar)
## Description

[![@avar](https://avatars.githubusercontent.com/u/45301?v=4&size=48)](/avar)[avar](https://github.com/avar)opened [on May 28, 2013](https://github.com/plack/Plack/issues/405#issue-14840250)

I had to deal with a security issue/bug that arose due to an

interaction with Plack::App::File which was basically:

1. I'd do a regex /.txt.pl\z/ on a file to see if it was a text file
2. If so, do magic to generate text file via perl
3. Else it's not a /.txt.pl\z/ file, so it must be some other static file with a different extension
4. Serve it up with Plack::Middleware::Static

The problem is that if you request:

```
/file.txt.pl/

```

You'll get the file at:

```
/file.txt.pl

```

But without it having gone throug step [#2](https://github.com/plack/Plack/issues/2), it just gets served up as a plain file!

The reason for this is that Plack::App::File does a split on "/"

without having a third -1 argument. So e.g. this:

```
$ perl -MData::Dumper -wle 'print Dumper [split /[\\\/]/, shift]' a/file.txt
$VAR1 = [
          'a',
          'file.txt'
        ];

```

Is the same as:

```
$ perl -MData::Dumper -wle 'print Dumper [split /[\\\/]/, shift]' a/file.txt///
$VAR1 = [
          'a',
          'file.txt'
        ];

```

As opposed to:

```
$ perl -MData::Dumper -wle 'print Dumper [split /[\\\/]/, shift, -1]' a/file.txt///
$VAR1 = [
          'a',
          'file.txt',
          '',
          '',
          ''
        ];

```

I don't think the magical split behavior of ignoring empty trailing

fields has any place in the implicit Plack::App::File API. But

opinions may differ, so filing this bug.

Note the difference in behavior v.s. standard \*nix utilities:

```
$ touch /tmp/foo.txt
$ file /tmp/foo.txt
/tmp/foo.txt: empty
$ file /tmp/foo.txt/
/tmp/foo.txt/: ERROR: cannot open `/tmp/foo.txt/' (Not a directory)

```

If touch behaved like Plack::App::File it would happily ignore the

trailing slash.

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_42e64573_20250125_155054.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Favar%2FPlack%2Fcommit%2Fbc1731dbb53850c380875ad683cd87c8ec99eee3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Favar%2FPlack%2Fcommit%2Fbc1731dbb53850c380875ad683cd87c8ec99eee3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=avar%2FPlack)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[avar](/avar)
/
**[Plack](/avar/Plack)**
Public

forked from [plack/Plack](/plack/Plack)

* [Notifications](/login?return_to=%2Favar%2FPlack) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Favar%2FPlack)
* [Star
   0](/login?return_to=%2Favar%2FPlack)

* [Code](/avar/Plack)
* [Pull requests
  0](/avar/Plack/pulls)
* [Actions](/avar/Plack/actions)
* [Projects
  0](/avar/Plack/projects)
* [Wiki](/avar/Plack/wiki)
* [Security](/avar/Plack/security)
* [Insights](/avar/Plack/pulse)

Additional navigation options

* [Code](/avar/Plack)
* [Pull requests](/avar/Plack/pulls)
* [Actions](/avar/Plack/actions)
* [Projects](/avar/Plack/projects)
* [Wiki](/avar/Plack/wiki)
* [Security](/avar/Plack/security)
* [Insights](/avar/Plack/pulse)

## Commit

[Permalink](/avar/Plack/commit/bc1731dbb53850c380875ad683cd87c8ec99eee3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Plack::App::File: Fix a security issue by not pruning trailing slashes

[Browse files](/avar/Plack/tree/bc1731dbb53850c380875ad683cd87c8ec99eee3)
Browse the repository at this point in the history

```
Before this Plack::App::File would prune trailing slashes via its split
invocation. I.e. it would think this:

    $ perl -MData::Dumper -wle 'print Dumper [split /[\\\/]/, shift]' a/file.txt
    $VAR1 = [
              'a',
              'file.txt'
            ];

Was the same as:

    $ perl -MData::Dumper -wle 'print Dumper [split /[\\\/]/, shift]' a/file.txt///
    $VAR1 = [
              'a',
              'file.txt'
            ];

This can. turn into a nasty code exposure issue if you e.g. have an app
that basically does this:

    1. I'd do a regex /.txt.pl\z/ on a file to see if it was a text file
    2. If so, do magic to generate text file via perl
    3. Else it's not a /.txt.pl\z/ file, so it must be some other static
       file with a different extension
    4. Serve it up with Plack::Middleware::Static

This is also not how other webservers or Unix utilities work:

    $ touch /tmp/foo.txt
    $ file /tmp/foo.txt
    /tmp/foo.txt: empty
    $ file /tmp/foo.txt/
    /tmp/foo.txt/: ERROR: cannot open `/tmp/foo.txt/' (Not a directory)

This resolves issue [plack#405](https://github.com/plack/Plack/issues/405) that I filed around 9 months ago. I was
previously working around it in my own code by doing:

    {
        # Let's see if someone's trying to be evil by
        # requesting e.g. /index.html/ instead of
        # /index.html. We don't want to fall through
        # and just serve up the raw content.
        my $plack_app_file = Plack::App::File->new({ root => PLACK_WEBSERVER_DOCUMENT_ROOT() });
        my ($file) = $plack_app_file->locate_file($env);
        if (
            # We'll get a reference if it's a full
            # Plack response. I.e. a 404 or whatever.
            ref $file ne 'ARRAY'
            and
            # WTF once we canonicalize the file and it
            # looks like a Mason handled path let's
            # not accept it, because we don't want to
            # serve up the raw unprocessed Mason page
            # via this hack.
            $file =~ $mason_handles_this_path_rx
        ) {
            TELL "Middleware::Static: Path <$path> request, doesn't match <$mason_handles_this_path_rx>, but actually resolves to it via resolved file <$file>" if DEBUG;
            # Tells our app to just serve up a
            # 400. Apache would do a 404 but I think
            # these requests are bad, so say so.
            $env->{$magic_marker_to_return_400} = 1;
            return;
        }
    }
```

* Loading branch information

[![@avar](https://avatars.githubusercontent.com/u/45301?s=40&v=4)](/avar)

[avar](/avar/Plack/commits?author=avar "View all commits by avar")
committed
Feb 7, 2014

1 parent
[9c8a5bc](/avar/Plack/commit/9c8a5bc1ea8750613767a70085e8d9eb522cfc94)

commit bc1731d

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**31 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Changes
  [Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2)
* lib/Plack/App

  + lib/Plack/App/File.pm
    [File.pm](#diff-44f817bebb009e78bd02dbd9ac71c49b0b7e909060e7f54bd34d8bdf504ee562)
* t/Plack-Middleware

  + t/Plack-Middleware/file.t
    [file.t](#diff-b2a5c25dac01fec8f223268c418f813fabe9fbef7f0df22b2efe14de47658f6c)

## There are no files selected for viewing

11 changes: 11 additions & 0 deletions

11
[Changes](#diff-bbd4b6a86bc65b6ac8e79e97afc61499158edb40f7bb404c70637b46d80a7ad2 "Changes")

Show comments

[View file](/avar/Plack/blob/bc1731dbb53850c380875ad683cd87c8ec99eee3/Changes)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,17 @@ |
|  |  | Go to http://github.com/plack/Plack/issues for the roadmap and known issues. |
|  |  |  |
|  |  | {{$NEXT}} |
|  |  | [SECURITY] |
|  |  | - Plack::App::File would previously strip trailing slashes off |
|  |  | provided paths. |
|  |  |  |
|  |  | This in combination with the common pattern of dynamically |
|  |  | generating some files in a tree and serving the rest up with |
|  |  | Plack::Middleware::Static could allow an attacker to bypass |
|  |  | a whitelist of generated files by just requesting |
|  |  | /file.disallowed/ instead of /file.disallowed, provided that |
|  |  | Plack::Middleware::Static was used for all paths except |
|  |  | those matching /\.disallowed$/ |
|  |  |  |
|  |  | 1.0030 2013-11-23 08:54:01 CET |
|  |  | [IMPROVEMENTS] |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[lib/Plack/App/File.pm](#diff-44f817bebb009e78bd02dbd9ac71c49b0b7e909060e7f54bd34d8bdf504ee562 "lib/Plack/App/File.pm")

Show comments

[View file](/avar/Plack/blob/bc1731dbb53850c380875ad683cd87c8ec99eee3/lib/Plack/App/File.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -44,7 +44,7 @@ sub locate\_file { |
|  |  | } |
|  |  |  |
|  |  | my $docroot = $self->root || "."; |
|  |  | my @path = split /[\\\/]/, $path; |
|  |  | my @path = split /[\\\/]/, $path, -1; # -1 \*MUST\* be here to avoid security issues! |
|  |  | if (@path) { |
|  |  | shift @path if $path[0] eq ''; |
|  |  | } else { |
| Expand Down | |  |

19 changes: 19 additions & 0 deletions

19
[t/Plack-Middleware/file.t](#diff-b2a5c25dac01fec8f223268c418f813fabe9fbef7f0df22b2efe14de47658f6c "t/Plack-Middleware/file.t")

Show comments

[View file](/avar/Plack/blob/bc1731dbb53850c380875ad683cd87c8ec99eee3/t/Plack-Middleware/file.t)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,6 +3,7 @@ use Plack::Test; |
|  |  | use Test::More; |
|  |  | use HTTP::Request::Common; |
|  |  | use Plack::App::File; |
|  |  | use FindBin qw($Bin); |
|  |  |  |
|  |  | my $app = Plack::App::File->new(file => 'Changes'); |
|  |  |  |
| Expand Down  Expand Up | | @@ -35,6 +36,24 @@ test\_psgi $app\_content\_type, sub { |
|  |  | is $res->code, 200; |
|  |  | }; |
|  |  |  |
|  |  | my $app\_secure = Plack::App::File->new(root => $Bin); |
|  |  |  |
|  |  | test\_psgi $app\_secure, sub { |
|  |  | my $cb = shift; |
|  |  |  |
|  |  | my $res = $cb->(GET "/file.t"); |
|  |  | is $res->code, 200; |
|  |  | like $res->content, qr/We will find for this literal string/; |
|  |  |  |
|  |  | my $res = $cb->(GET "/../Plack-Middleware/file.t"); |
|  |  | is $res->code, 403; |
|  |  | is $res->content, 'forbidden'; |
|  |  |  |
|  |  | for my $i (1..100) { |
|  |  | $res = $cb->(GET "/file.t" . ("/" x $i)); |
|  |  | is $res->code, 404; |
|  |  | is $res->content, 'not found'; |
|  |  | } |
|  |  | }; |
|  |  |  |
|  |  | done\_testing; |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bc1731d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Favar%2FPlack%2Fcommit%2Fbc1731dbb53850c380875ad683cd87c8ec99eee3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seclists.org_eb45c968_20250125_155053.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](383)
[By Date](date.html#384)
[![Next](/images/right-icon-16x16.png)](385)

[![Previous](/images/left-icon-16x16.png)](345)
[By Thread](index.html#384)
[![Next](/images/right-icon-16x16.png)](346)

![](/shared/images/nst-icons.svg#search)

# Re: CVE Request: Plack::App::File does not prune trailing slashes: possible code exposure / information disclosure

---

*From*: cve-assign () mitre org

*Date*: Sat, 16 Aug 2014 02:12:41 -0400 (EDT)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
>    - Plack::App::File would previously strip trailing slashes off
>      provided paths. This in combination with the common pattern
>      of serving files with Plack::Middleware::Static could allow
>      an attacker to bypass a whitelist of generated files
>
> <http://api.metacpan.org/source/MIYAGAWA/Plack-1.0031/Changes>
> <https://github.com/plack/Plack/issues/405>
>
> ```

```

The underlying issue is that Plack::App::File allowed a trailing slash
in a pathname referring to a plain file. There is at least one
specification suggesting that this is wrong:

  <http://pubs.opengroup.org/onlinepubs/9699919799/xrat/V4_xbd_chap04.html#tag_21_04_12>

  Pathnames that end with one or more trailing <slash> characters must
  refer to directory paths. Earlier versions of this standard were not
  specific about the distinction between trailing <slash> characters
  on files and directories, and both were permitted.

Without going into the question of whether Plack is responsible for
following that specification, it seems that the vendor identified
arguably wrong behavior that had a security impact, and fixed it. Use
CVE-2014-5269.

(In some related but non-identical situations -- for example, if a
product decided to reject a valid pathname such as /etc//// as a
possibly misguided attempt at security hardening -- there wouldn't be
a CVE ID.)

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJT7vXRAAoJEKllVAevmvmsybAIAISVSn6yyAhD842i4/pVgJ5t
86heLybkqoFgCYlmWXDacwX6stqK8/ndhD1+mhUCMXNs1iqsPJ43xBT+RF1gOVOw
5AoYOIiqyWF0rLYdkgAaOYxNxDIHhb+iZswEyLi3RNKAAZESunDO5RzIhxn492d/
NoCZEzT/FWLju0skoV8+YTN5UrAxPZspVD7tRJ99tFQTsmDj72qMRUqfrey59W0e
O4jtU+7laffKTPFVlHzO7X2BuAm9739mObaicvgH3CjCdOV3Zg9jp2zzpvfdMxfH
SDzwJctY+Q4mlIGK0vv2h3ouKUKQudeVGevQzh8Epa7G/Jrp6bq7f8mVaTRLyCo=
=e2Sd
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](383)
[By Date](date.html#384)
[![Next](/images/right-icon-16x16.png)](385)

[![Previous](/images/left-icon-16x16.png)](345)
[By Thread](index.html#384)
[![Next](/images/right-icon-16x16.png)](346)

### Current thread:

* [CVE Request: Plack::App::File does not prune trailing slashes: possible code exposure / information disclosure](345) *Salvatore Bonaccorso (Aug 11)*
  + **Re: CVE Request: Plack::App::File does not prune trailing slashes: possible code exposure / information disclosure** *cve-assign (Aug 15)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


