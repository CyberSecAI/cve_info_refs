=== Content from www.mandriva.com_e05b80e2_20250125_192009.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from seclists.org_c6c67420_20250125_192007.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](443)
[By Date](date.html#444)
[![Next](/images/right-icon-16x16.png)](445)

[![Previous](/images/left-icon-16x16.png)](443)
[By Thread](index.html#444)
[![Next](/images/right-icon-16x16.png)](445)

![](/shared/images/nst-icons.svg#search)

# CVE request: Multiple incorrect default permissions in Zarafa

---

*From*: Robert Scheck <robert () fedoraproject org>

*Date*: Sun, 24 Aug 2014 22:51:08 +0200

---

```
Hello,

I discovered that the Zarafa Collaboration Platform has multiple incorrect
default permissions (CWE-276):

1. In order to fix CVE-2014-0103, Zarafa introduced constants PASSWORD_KEY
and PASSWORD_IV in /etc/zarafa/webaccess-ajax/config.php (Zarafa WebAccess)
and /etc/zarafa/webapp/config.php (Zarafa WebApp), both are the upstream
path names of a default installation, downstream names might be different.
Both files have default permissions of root:root and 644, thus decryption
of the symmetric encrypted passwords in the on-disk PHP session files is
possible again (similar like initially described in CVE-2014-0103). Affects
Zarafa WebAccess >= 7.1.10, Zarafa WebApp >= 1.6 beta.

2. The log directory /var/log/zarafa/ is shipped by default with root:root
and 755 and all created log files by the Zarafa daemons have by default
root:root and 644. This is leaking (depending on the log level of the given
service) only e.g. subject, sender/recipient, message-id, SMTP queue id of
in- and outbound e-mails but might be even a cleartext protocol dump of
IMAP, POP3, CalDAV and iCal as well (including possible credentials) to any
local system user. Affects Zarafa >= 5.00.

3. The directories /var/lib/zarafa-webaccess/tmp/ (Zarafa WebAccess) and
/var/lib/zarafa-webapp/tmp/ (Zarafa WebApp) are read- and writable by the
Apache system user by default - but also world readable for local system
users (e.g. apache:apache and 755 on RHEL). Thus all the temporary session
data such as uploaded e-mail attachments can be read-only accessed because
all created files below previously mentioned directories have permissions
644, too. Upstream path names changed over the time and releases. Affects
Zarafa WebAccess >= 4.1, Zarafa WebApp (any version).

4. The optional (but proprietary) license daemon /usr/bin/zarafa-licensed
runs by default with root permissions, the subscription/license key is put
into '/etc/zarafa/license/*'. The license files are recommented (according
upstream documentation) to be created using echo(1) which usually leads to
root:root and 644. But the parent directory /etc/zarafa/license/ is shipped
by default with root:root and 755. As result the key files can be accessed
and copied by any local system user. Affects Zarafa >= 4.1.

As of writing Zarafa doesn't seem to have built-in permission checks (like
e.g. fetchmail(1) has), too.

With kind regards

Robert Scheck
--
Fedora Project * Fedora Ambassador * Fedora Mentor * Fedora Packager

```

**Attachment:
[\_bin](att-444/_bin)**

*Description:*

---

[![Previous](/images/left-icon-16x16.png)](443)
[By Date](date.html#444)
[![Next](/images/right-icon-16x16.png)](445)

[![Previous](/images/left-icon-16x16.png)](443)
[By Thread](index.html#444)
[![Next](/images/right-icon-16x16.png)](445)

### Current thread:

* **CVE request: Multiple incorrect default permissions in Zarafa** *Robert Scheck (Aug 24)*
  + [Re: CVE request: Multiple incorrect default permissions in Zarafa](445) *cve-assign (Aug 25)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_69015bd6_20250125_192007.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](444)
[By Date](date.html#445)
[![Next](/images/right-icon-16x16.png)](446)

[![Previous](/images/left-icon-16x16.png)](444)
[By Thread](index.html#445)
[![Next](/images/right-icon-16x16.png)](448)

![](/shared/images/nst-icons.svg#search)

# Re: CVE request: Multiple incorrect default permissions in Zarafa

---

*From*: cve-assign () mitre org

*Date*: Mon, 25 Aug 2014 13:09:29 -0400 (EDT)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> I discovered that the Zarafa Collaboration Platform has multiple incorrect
> default permissions (CWE-276):
>
> ```

```

This needs separate CVE IDs because the product/version information
isn't identical in any of the cases.

```
> ```
> 1. In order to fix CVE-2014-0103, Zarafa introduced constants PASSWORD_KEY
> and PASSWORD_IV in /etc/zarafa/webaccess-ajax/config.php (Zarafa WebAccess)
> and /etc/zarafa/webapp/config.php (Zarafa WebApp), both are the upstream
> path names of a default installation, downstream names might be different.
> Both files have default permissions of root:root and 644, thus decryption
> of the symmetric encrypted passwords in the on-disk PHP session files is
> possible again (similar like initially described in CVE-2014-0103). Affects
> Zarafa WebAccess >= 7.1.10, Zarafa WebApp >= 1.6 beta.
>
> ```

```

Use CVE-2014-5447. The scope of this CVE ID is only the 0644 permission issue,
not anything about the encryption algorithm. There is only one CVE ID because
it appears that the design was chosen once and then directly copied into
two products that have their own pathname conventions.

```
> ```
> 2. The log directory /var/log/zarafa/ is shipped by default with root:root
> and 755 and all created log files by the Zarafa daemons have by default
> root:root and 644. This is leaking (depending on the log level of the given
> service) only e.g. subject, sender/recipient, message-id, SMTP queue id of
> in- and outbound e-mails but might be even a cleartext protocol dump of
> IMAP, POP3, CalDAV and iCal as well (including possible credentials) to any
> local system user. Affects Zarafa >= 5.00.
>
> ```

```

Use CVE-2014-5448. The scope of this CVE ID is only the permission issue.
In some cases of other products, there have been reported vulnerabilities
related to the existence of a protocol dump (e.g., the administrator may be
configuring protocol dumps without realizing this, or the dumping code
tried to remove especially sensitive information but failed, etc.). Any
such issue, if one exists, would have a separate CVE ID.

```
> ```
> 3. The directories /var/lib/zarafa-webaccess/tmp/ (Zarafa WebAccess) and
> /var/lib/zarafa-webapp/tmp/ (Zarafa WebApp) are read- and writable by the
> Apache system user by default - but also world readable for local system
> users (e.g. apache:apache and 755 on RHEL). Thus all the temporary session
> data such as uploaded e-mail attachments can be read-only accessed because
> all created files below previously mentioned directories have permissions
> 644, too. Upstream path names changed over the time and releases. Affects
> Zarafa WebAccess >= 4.1, Zarafa WebApp (any version).
>
> ```

```

Use CVE-2014-5449. The scope of this CVE ID is only the permission
issue. There is only one CVE ID because it appears that the design was
chosen once and then directly copied into two products that have their
own pathname conventions.

```
> ```
> 4. The optional (but proprietary) license daemon /usr/bin/zarafa-licensed
> runs by default with root permissions, the subscription/license key is put
> into '/etc/zarafa/license/*'. The license files are recommended (according
> upstream documentation) to be created using echo(1) which usually leads to
> root:root and 644. But the parent directory /etc/zarafa/license/ is shipped
> by default with root:root and 755. As result the key files can be accessed
> and copied by any local system user. Affects Zarafa >= 4.1.
>
> ```

```

Use CVE-2014-5450. The scope of this CVE ID is only the permission
issue. In some cases of other products, there have been reported
vulnerabilities related to the presence of sensitive data on the
command line, which is exposed to local users who run the ps program
or a similar program. Here,

  <http://doc.zarafa.com/6.40/Administrator_Manual/en-US/html/_configure_the_license_manager.html>

does not specify that only root may be logged in during execution of
the echo command. If this is a vulnerability in Zarafa, then a
separate CVE ID is needed.

This might be an open question. Stealing a license key might have an
adverse effect on the vendor's revenue, but perhaps doesn't have an
adverse effect on confidentiality, integrity, or availability of data
within the specific Zarafa instance. There are many possible vendor
strategies for detecting and thwarting stolen license keys. Some of
these do have an availability impact.

If the original vulnerability report was coordinated with upstream,
then maybe upstream has agreed that weak permissions for license files
were unintended. However, maybe upstream intentionally chose "echo" as
a security/complexity tradeoff (i.e., the attack is relatively
unlikely, and "echo" was an easy way to write the documentation).

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJT+20eAAoJEKllVAevmvmsbKYH/2Qz1J3Ig/VAIc8EfWmrzUoP
MGipVqXOUyI6layARuZN7NnEqVuW/tafvWwCDXMcFX21KE74w7b3RhAh574i2/wU
hwLIKrM9IrMhMblnaQH+urBoddB5Qw4FST0XgcevwQxWyak19j2CdnWrSn+yPTKo
r5vcqsy39xobYfaGLB3L5zd+j24Aqi8ZpvK56miwFtfujX1eUQsyMKCVMYDRYaPU
bSDrF7pDVYMq8oolBGVbCMwdLWGfoqYxT92Be+q7aruIfg+/7AetTSTTckO/Iid/
pbkyTF8K2Wt2OKO2GJaab0tiU5vZ1vvEfRrqVfexM+t4Eg9RlF9jyJTkG2HatN0=
=lLHM
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](444)
[By Date](date.html#445)
[![Next](/images/right-icon-16x16.png)](446)

[![Previous](/images/left-icon-16x16.png)](444)
[By Thread](index.html#445)
[![Next](/images/right-icon-16x16.png)](448)

### Current thread:

* [CVE request: Multiple incorrect default permissions in Zarafa](444) *Robert Scheck (Aug 24)*
  + **Re: CVE request: Multiple incorrect default permissions in Zarafa** *cve-assign (Aug 25)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from bugs.mageia.org_f1ea7505_20250126_111740.html ===


Mageia Bugzilla – Bug 13822
zarafa - passwords stored in cleartext on server (CVE-2014-0103)
Last modified: 2014-09-22 10:31:50 CEST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=13822&GoAheadAndLogIn=1)

  [x]
* |
  [New Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug 13822**](show_bug.cgi?id=13822)
- zarafa - passwords stored in cleartext on server (CVE-2014-0103)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
zarafa - passwords stored in cleartext on server (CVE-2014-0103)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sec team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/606888/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | MGA3TOO has\_procedure advisory mga3-3... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | validated\_update | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [14016](show_bug.cgi?id=14016 "RESOLVED FIXED - clucene ships old boost libs that prevents zarafa and probably other packages from building") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=13822&hide_resolved=1) / [graph](showdependencygraph.cgi?id=13822) | |  | | Reported: | 2014-07-30 09:16 CEST by Oden Eriksson | | --- | --- | | Modified: | 2014-09-22 10:31 CEST ([History](show_activity.cgi?id=13822)) | | CC List: | 3 users (show)  luigiwalser sysadmin-bugs thomas | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | zarafa | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Build logs for mga3, mga4 and cauldron**](attachment.cgi?id=5318 "View the content of the attachment") (56.11 KB, application/gzip)  [2014-07-30 10:13 CEST](#attach_5318 "Go to the comment associated with the attachment"), Oden Eriksson | [Details](attachment.cgi?id=5318&action=edit) | | [View All](attachment.cgi?bugid=13822&action=viewall)  [Add an attachment](attachment.cgi?bugid=13822&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=13822#c0)  Oden Eriksson    2014-07-30 09:16:35 CEST  ``` ====================================================== Name: CVE-2014-0103 Status: Candidate URL: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0103> Final-Decision:  Interim-Decision:  Modified:  Proposed:  Assigned: 20131203 Category:  Reference: CONFIRM:<https://bugzilla.redhat.com/show_bug.cgi?id=1073618> Reference: FEDORA:FEDORA-2014-7889 Reference: URL:<http://lists.fedoraproject.org/pipermail/package-announce/2014-July/136044.html> Reference: FEDORA:FEDORA-2014-7896 Reference: URL:<http://lists.fedoraproject.org/pipermail/package-announce/2014-July/136033.html> Reference: BID:68247 Reference: URL:<http://www.securityfocus.com/bid/68247>  WebAccess in Zarafa before 7.1.10 and WebApp before 1.6 stores credentials in cleartext, which allows local Apache users to obtain sensitive information by reading the PHP session files.   Reproducible:   Steps to Reproduce: ```  [Comment 1](show_bug.cgi?id=13822#c1)  Oden Eriksson    2014-07-30 09:18:01 CEST  ``` 7.1.10 FTBS on mga3, mga4 and cauldron. boost related. ```  [Comment 2](show_bug.cgi?id=13822#c2)  Oden Eriksson    2014-07-30 10:13:29 CEST  ``` Created [attachment 5318](attachment.cgi?id=5318 "Build logs for mga3, mga4 and cauldron") [[details]](attachment.cgi?id=5318&action=edit "Build logs for mga3, mga4 and cauldron") Build logs for mga3, mga4 and cauldron ```  David Walser    2014-07-30 19:40:15 CEST   Assignee: bugsquad => thomasSummary: CVE-2014-0103: zarafa - passwords stored in cleartext on server => zarafa - passwords stored in cleartext on server (CVE-2014-0103)  David Walser    2014-07-30 19:43:10 CEST   Whiteboard: (none) => MGA4TOO, MGA3TOOVersion: 3 => Cauldron  David Walser    2014-07-30 20:14:19 CEST   URL: (none) => http://lwn.net/Vulnerabilities/606888/  Thomas Spuhler    2014-07-31 01:31:33 CEST   Status: NEW => ASSIGNED  [Comment 3](show_bug.cgi?id=13822#c3)  David Walser    2014-08-25 19:23:50 CEST  ``` Several new CVEs have just been assigned to Zarafa: <http://openwall.com/lists/oss-security/2014/08/25/1> ```  ---   CC: (none) => luigiwalser  [Comment 4](show_bug.cgi?id=13822#c4)  David Walser    2014-08-28 16:33:12 CEST  ``` Not sure if we have the Zarafa webapp packaged, but this might be relevant: <http://openwall.com/lists/oss-security/2014/08/28/4> ```  [Comment 5](show_bug.cgi?id=13822#c5)  David Walser    2014-08-29 15:22:10 CEST  ``` Pascal got zarafa-7.1.11-1.mga5 to build in Cauldron.  I'm guessing none of the CVEs mentioned in [Comment 3](show_bug.cgi?id=13822#c3) have been fixed yet.  I'm also guessing we don't have Zarafa webapp. ```  [Comment 6](show_bug.cgi?id=13822#c6)  Thomas Spuhler    2014-08-29 22:14:37 CEST  ``` We don't package the (In reply to David Walser from [comment #4](show_bug.cgi?id=13822#c4)) > Not sure if we have the Zarafa webapp packaged, but this might be relevant: > <http://openwall.com/lists/oss-security/2014/08/28/4>  We don't package teh webapp ```  [Comment 7](show_bug.cgi?id=13822#c7)  Thomas Spuhler    2014-08-29 22:16:54 CEST  ``` (In reply to David Walser from [comment #5](show_bug.cgi?id=13822#c5)) > Pascal got zarafa-7.1.11-1.mga5 to build in Cauldron.  I'm guessing none of > the CVEs mentioned in [Comment 3](show_bug.cgi?id=13822#c3) have been fixed yet.  I'm also guessing we > don't have Zarafa webapp.  I need to double check after installing, but we change the perms to zarafa:zarafa in %post: chown %{name}:%{name} %{_localstatedir}/log/%{name}/server.* > /dev/null 2>&1 || : ```  Thomas Spuhler    2014-08-30 01:28:53 CEST   Depends on: (none) => 14016  [Comment 8](show_bug.cgi?id=13822#c8)  Thomas Spuhler    2014-08-30 23:17:51 CEST  ``` (In reply to Thomas Spuhler from [comment #6](show_bug.cgi?id=13822#c6)) > We don't package the (In reply to David Walser from [comment #4](show_bug.cgi?id=13822#c4)) > > Not sure if we have the Zarafa webapp packaged, but this might be relevant: > > <http://openwall.com/lists/oss-security/2014/08/28/4> >  > We don't package the webapp Let me elaborate a little more on this: We don't ship the separate Zarafa WebApp (~1.6) so per the link above, we should be OK. ```  [Comment 9](show_bug.cgi?id=13822#c9)  David Walser    2014-09-02 20:58:42 CEST  ``` Fedora has issued an advisory for CVE-2014-544[7-9] and CVE-2014-5450 on August 27: <https://lists.fedoraproject.org/pipermail/package-announce/2014-August/137158.html>  from <http://lwn.net/Vulnerabilities/610413/>  They fixed it in this commit: <http://pkgs.fedoraproject.org/cgit/zarafa.git/commit/?id=7739e805bc476cfc3979649c5774c9a111bebe01> ```  [Comment 10](show_bug.cgi?id=13822#c10)  Thomas Spuhler    2014-09-05 03:55:49 CEST  ``` We'll do the same for the permissions. ```  [Comment 11](show_bug.cgi?id=13822#c11)  David Walser    2014-09-05 22:57:03 CEST  ``` I believe zarafa-7.1.11-5.mga5 fixes all of these issues in Cauldron. ```  ---   Version: Cauldron => 4Whiteboard: MGA4TOO, MGA3TOO => MGA3TOO  [Comment 12](show_bug.cgi?id=13822#c12)  Thomas Spuhler    2014-09-05 23:01:00 CEST  ``` (In reply to Thomas Spuhler from [comment #10](show_bug.cgi?id=13822#c10)) > We'll do the same for the permissions.  Fixed in cauldron ```  [Comment 13](show_bug.cgi?id=13822#c13)  Thomas Spuhler    2014-09-12 20:36:45 CEST  ``` These bugs have now been resolved. The following updated packages are now in updates_testing:  zarafa-7.1.11-1.mga4.src.rpm zarafa-7.1.11-1.mga4.x86_64.rpm zarafa-client-7.1.11-1.mga4.x86_64.rpm zarafa-common-7.1.11-1.mga4.x86_64.rpm zarafa-dagent-7.1.11-1.mga4.x86_64.rpm lib64zarafa-devel-7.1.11-1.mga4.x86_64.rpm zarafa-gateway-7.1.11-1.mga4.x86_64.rpm zarafa-ical-7.1.11-1.mga4.x86_64.rpm zarafa-caldav-7.1.11-1.mga4.x86_64.rpm zarafa-monitor-7.1.11-1.mga4.x86_64.rpm zarafa-spooler-7.1.11-1.mga4.x86_64.rpm zarafa-utils-7.1.11-1.mga4.x86_64.rpm lib64zarafa0-7.1.11-1.mga4.x86_64.rpm python-MAPI-7.1.11-1.mga4.x86_64.rpm php-mapi-7.1.11-1.mga4.x86_64.rpm zarafa-indexer-7.1.11-1.mga4.x86_64.rpm zarafa-webaccess-7.1.11-1.mga4.noarch.rpm zarafa-archiver-7.1.11-1.mga4.x86_64.rpm zarafa-debuginfo-7.1.11-1.mga4.x86_64.rpm  and mga3 packages with same name ```  ---   Assignee: thomas => qa-bugsCC: (none) => thomas  [Comment 14](show_bug.cgi?id=13822#c14)  David Walser    2014-09-12 20:48:53 CEST  ``` Thanks Thomas!  Advisory: ========================  Updated zarafa packages fix security vulnerabilities:  Robert Scheck reported that Zarafa's WebAccess stored session information, including login credentials, on-disk in PHP session files. This session file would contain a user's username and password to the Zarafa IMAP server (CVE-2014-0103).  Robert Scheck discovered that the Zarafa Collaboration Platform has multiple incorrect default permissions (CVE-2014-5447, CVE-2014-5448, CVE-2014-5449, CVE-2014-5450).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0103> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5447> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5448> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5449> <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5450> <https://lists.fedoraproject.org/pipermail/package-announce/2014-July/136033.html> <https://lists.fedoraproject.org/pipermail/package-announce/2014-August/137158.html> ```  [Comment 15](show_bug.cgi?id=13822#c15)  claire robinson    2014-09-16 17:29:21 CEST  ``` Testing mga4 64  Edited /etc/zarafa/server.cfg and added the mysql root password..  # The password for the user (leave empty for no password) mysql_password          =   You could create a database add those details instead but this is Ok for testing purposes (not production).  Started all the services.  # systemctl start zarafa-{dagent,gateway,ical,monitor,server,spooler}.service  Checked they are all running  # systemctl status zarafa-{dagent,gateway,ical,monitor,server,spooler}.service  Tried to log into the webaccess which should be available at  <http://localhost/webaccess> It gives 403 Forbidden.  Adding 'Require all granted' into /etc/httpd/conf/sites.d/zarafa-webaccess.conf like so..  <Directory /usr/share/zarafa-webaccess/>     Require all granted     # Some apache settings   ..allows access but just shows a blank page.  More testing info here [https://bugs.mageia.org/show_bug.cgi?id=12813#c35](show_bug.cgi?id=12813#c35 "RESOLVED FIXED - zarafa new security issues CVE-2014-0037 and CVE-2014-0079") See 'man zarafa-admin' for the cli switches.  eg.  # zarafa-admin -c username -p password -f 'full name' -e 'email@address.com' User created.  List users..  # zarafa-admin -l User list for Default(2):         Username        Fullname        Homeserver         -------------------------------------------         SYSTEM          SYSTEM          Zarafa         username        full name  # zarafa-admin -d username User deleted.   So apart from zarafa-webaccess it seems to work. Adding feedback marker for now. ```  ---   Whiteboard: MGA3TOO => MGA3TOO feedback  [Comment 16](show_bug.cgi?id=13822#c16)  claire robinson    2014-09-16 17:34:07 CEST  ``` Should probably mention to restart/reload httpd after adding 'Require all granted'. ```  claire robinson    2014-09-16 18:00:00 CEST   Whiteboard: MGA3TOO feedback => MGA3TOO has\_procedure feedback  [Comment 17](show_bug.cgi?id=13822#c17)  Thomas Spuhler    2014-09-16 18:09:36 CEST  ``` Thanks Claire I will make the change for zarafa-webaccess in cauldron. ```  [Comment 18](show_bug.cgi?id=13822#c18)  claire robinson    2014-09-16 18:14:09 CEST  ``` The actual webaccess doesn't appear to be working though Thomas even with the 'Require' added. Not sure what's wrong there, I'll enable debug logging in the server.cfg tomorrow unless you beat me to it. I've run out of time today. ```  [Comment 19](show_bug.cgi?id=13822#c19)  Thomas Spuhler    2014-09-16 18:19:28 CEST  ``` The webaccess may never worked, but we have no bug reports. Upstream claims: Which issues have been resolved? The first issue is related to RPM-based systems. Administrators have noted that they werenât able to install WebAccess on their systems. Unfortunately, a patch from the community caused this bug. We have corrected the patch to work with RPM-based systems.  Le'ts get this tested and released w/o the webaccess resolved as the security issue has been around for much too long. ```  [Comment 20](show_bug.cgi?id=13822#c20)  claire robinson    2014-09-17 15:12:30 CEST  ``` Ok. [Bug 14107](show_bug.cgi?id=14107 "RESOLVED FIXED - zarafa webaccess is inaccessible") created for the webaccess issue. It should possibly be against Cauldron rather than mga4.  Testing complete then for mga4 64 ensuring the services start/stop and a user can be created and deleted with zarafa-admin ```  ---   Whiteboard: MGA3TOO has\_procedure feedback => MGA3TOO has\_procedure mga4-64-ok  [Comment 21](show_bug.cgi?id=13822#c21)  claire robinson    2014-09-17 15:49:09 CEST  ``` Testing complete mga3 32  Installed php-mapi from updates before zarafa as there is a php in updates testing currently.  webaccess is the same here so it's very likely Cauldron is also affected. ```  ---   Whiteboard: MGA3TOO has\_procedure mga4-64-ok => MGA3TOO has\_procedure mga3-32-ok mga4-64-ok  [Comment 22](show_bug.cgi?id=13822#c22)  claire robinson    2014-09-17 16:11:19 CEST  ``` php-mapi is actually part of this update, oops. Doing too many things at once.  Testing mga3-64 next. ```  [Comment 23](show_bug.cgi?id=13822#c23)  claire robinson    2014-09-17 16:33:47 CEST  ``` Testing complete mga3 64 ```  ---   Whiteboard: MGA3TOO has\_procedure mga3-32-ok mga4-64-ok => MGA3TOO has\_procedure mga3-32-ok mga3-64-ok mga4-64-ok  [Comment 24](show_bug.cgi?id=13822#c24)  claire robinson    2014-09-17 16:45:51 CEST  ``` Testing complete mga4 32 ```  ---   Whiteboard: MGA3TOO has\_procedure mga3-32-ok mga3-64-ok mga4-64-ok => MGA3TOO has\_procedure mga3-32-ok mga3-64-ok mga4-32-ok mga4-64-ok  [Comment 25](show_bug.cgi?id=13822#c25)  claire robinson    2014-09-18 16:12:10 CEST  ``` Validating. Advisory uploaded.  Could sysadmin please push to 3 & 4 updates  Thanks ```  ---   Keywords: (none) => validated\_updateWhiteboard: MGA3TOO has\_procedure mga3-32-ok mga3-64-ok mga4-32-ok mga4-64-ok => MGA3TOO has\_procedure advisory mga3-32-ok mga3-64-ok mga4-32-ok mga4-64-okCC: (none) => sysadmin-bugs  [Comment 26](show_bug.cgi?id=13822#c26)  Mageia Robot    2014-09-22 10:31:50 CEST  ``` An update for this issue has been pushed to Mageia Updates repository.  <http://advisories.mageia.org/MGASA-2014-0380.html> ```  ---   Status: ASSIGNED => RESOLVEDResolution: (none) => FIXED |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=13822&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=13822)
* - [XML](show_bug.cgi?ctype=xml&id=13822)
* - [Clone ThisBug](enter_bug.cgi?cloned_bug_id=13822&normal=1)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=13822&GoAheadAndLogIn=1)

    [x]
  + |
    [New Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)



=== Content from advisories.mageia.org_4e164d99_20250125_192005.html ===

# [Advisories](index.html) » MGASA-2014-0380

## Updated zarafa packages fix multiple vulnerabilities

Publication date: 22 Sep 2014

Modification date: 22 Sep 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-0103](CVE-2014-0103.html)
,
[CVE-2014-5447](CVE-2014-5447.html)
,
[CVE-2014-5448](CVE-2014-5448.html)
,
[CVE-2014-5449](CVE-2014-5449.html)
,
[CVE-2014-5450](CVE-2014-5450.html)

## Description

```
Updated zarafa packages fix security vulnerabilities:

Robert Scheck reported that Zarafa's WebAccess stored session information,
including login credentials, on-disk in PHP session files. This session file
would contain a user's username and password to the Zarafa IMAP server
(CVE-2014-0103).

Robert Scheck discovered that the Zarafa Collaboration Platform has multiple
incorrect default permissions (CVE-2014-5447, CVE-2014-5448, CVE-2014-5449,
CVE-2014-5450).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=13822>
* <https://lists.fedoraproject.org/pipermail/package-announce/2014-July/136033.html>
* <https://lists.fedoraproject.org/pipermail/package-announce/2014-August/137158.html>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0103>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5447>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5448>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5449>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5450>

## SRPMS

### 3/core

* zarafa-7.1.11-1.mga3

### 4/core

* zarafa-7.1.11-1.mga4


