=== Content from seclists.org_73f25bb6_20250124_120744.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](369)
[By Date](date.html#370)
[![Next](/images/right-icon-16x16.png)](371)

[![Previous](/images/left-icon-16x16.png)](347)
[By Thread](index.html#370)
[![Next](/images/right-icon-16x16.png)](348)

![](/shared/images/nst-icons.svg#search)

# Re: [oCERT-2014-006] Ganeti insecure archive permission

---

*From*: cve-assign () mitre org

*Date*: Thu, 14 Aug 2014 12:10:24 -0400 (EDT)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> Such archives are written with too lax permissions that make it
> possible to access them as unprivileged user.
>
> ```

```

```
> ```
> The configuration archive contains sensitive information, including
> SSL keys for the inter-node RPC communication as well as the
> credentials for the remote API (RAPI).
>
> ```

```

Use CVE-2014-5247.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJT7N2eAAoJEKllVAevmvmsrioH/33ive+8TrDkuY7hfT+4UsHK
GO6NH8c3omBnlNGXsdQ27xSBXzhol/kfW03/NcqBMK9SKPtcGMUk3GugMWAtv2yt
oDyvOP54QUtCS8ei7faqQLUjjW5zOxfrVJg14eaPPVYOdfatfoHOvVqcz7chqzUg
/RgoIvaslpRRK74s7CQdMOqQNOcfmD2KBxAUGNUUX/REx3QE2ojTUXTEL0dcTfyx
nn7HfoyikBE1VpHA+GS8Ew0Nqh5wTP+W0YGnL7AU+btY/BQR4aZJma567BnL63CC
Hb9pVneqCJq8HUjygmwgPDaDO6ivCnUuhZypg4kVg8ja37OysWfokzicK7kl03o=
=pveN
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](369)
[By Date](date.html#370)
[![Next](/images/right-icon-16x16.png)](371)

[![Previous](/images/left-icon-16x16.png)](347)
[By Thread](index.html#370)
[![Next](/images/right-icon-16x16.png)](348)

### Current thread:

* [[oCERT-2014-006] Ganeti insecure archive permission](347) *Andrea Barisani (Aug 12)*
  + **Re: [oCERT-2014-006] Ganeti insecure archive permission** *cve-assign (Aug 14)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_5d135c55_20250124_120742.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

Â [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.ocert.org_dd57cfc9_20250124_120744.html ===


**oCERT-2014-006 Ganeti insecure archive permission**

**Description**:

[Ganeti](http://code.google.com/p/ganeti), an open source
virtualisation manager, suffers from an insecure file permission vulnerability
that leads to sensitive information disclosure.

The Ganeti upgrade command 'gnt-cluster upgrade' creates an archive of
the current configuration of the cluster (e.g. the contents of
'/var/lib/ganeti'). The archive is named following the pattern ganet\*.tar and
is written to '/var/lib/'. Such archives are written with too lax
permissions that make it possible to access them as unprivileged user.

The configuration archive contains sensitive information, including SSL
keys for the inter-node RPC communication as well as the credentials for the
remote API (RAPI). Such information can be used to control various operations
of the cluster, including shutting down and removing instances and nodes from
the cluster, or assuming the identity of the cluster in a MITM attack.

This vulnerability only affects Ganeti clusters meeting the following criterias:

* The cluster is running Ganeti version 2.10.0 or higher.
* The upgrade command was run, for example when upgrading from 2.10 to 2.11.
* Unprivileged users have access to the host machines and in particular to the cluster master.

In the fixed releases the upgrade command sets the permissions of the
archives properly. However, in case previous versions have created an unsafe
archive already, the following mitigations are advised:

* Remove the access to the archive for unprivileged users (for example by
  running 'chmod 400 /var/lib/ganeti\*.tar').
* Renew the SSL keys by running 'gnt-cluster renew-crypto'. You may need
  to pass the --new-cluster-certificate, --new-confd-hmac-key,
  --new-rapi-certificate, --new-spice-certificate and
  --new-cluster-domain-secret flags.
* Renew the RAPI credentials by editing the '/var/lib/ganeti/rapi\_users'
  file. Note that this will need to be updated in any out-of-the-cluster
  RAPI client.
* Look for any other information regarded as secret in '/var/lib/ganeti'
  and change it. For example VNC and SPICE passwords are not by default kept
  there, but could, if Ganeti is so configured.

**Affected version**:

[Ganeti](http://code.google.com/p/ganeti) >= 2.10.0, <= 2.10.6

[Ganeti](http://code.google.com/p/ganeti) >= 2.11.0, <= 2.11.4

**Fixed version**:

[Ganeti](http://code.google.com/p/ganeti) >= 2.10.7

[Ganeti](http://code.google.com/p/ganeti) >= 2.11.5

**Credit**: vulnerability report, PoC received from Ganeti authors Helga Velroyen
<helgav AT google.com> and Guido Trotter <ultrotter AT google.com>,
patch created by Apollon Oikonomopoulos.

**CVE**: [CVE-2014-5247](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5247)

**Timeline**:

2014-08-07: vulnerability report received

2014-08-07: disclosure coordinated on 2014-08-12

2014-08-08: contacted affected vendors

2014-08-12: advisory release

2014-08-14: assigned CVE

**References**:

<http://git.ganeti.org/?p=ganeti.git;a=commit;h=a89f62e2db9ccf715d64d1a6322474b54d2d9ae0>


