```
Message-Id: <201407172231.s6HMVeS9019777@linus.mitre.org>
Date: Thu, 17 Jul 2014 18:31:40 -0400 (EDT)
From: cve-assign@...re.org
To: larry0@...com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: Vulnerability Report for Ruby Gem codders-dataset-1.3.2.1 (etc.)

>   Vulnerability Report for Ruby Gem lynx-0.2.0
>
> Ruby command line wrapper for MySQL.
>
> Exposes password to the process table

Use CVE-2014-5002.

> Doesn't properly sanitize user input before sending to command line:
>       def perform(command)
>         system(command.to_s)

We weren't able to establish that this attack crosses privilege boundaries.
Given that the input is intentionally being used for a "system" call,
we aren't sure what restrictions would be imposed by the "sanitize
user input" recommendation.

```
**Root cause of vulnerability:** The `lynx` gem does not properly sanitize user input before executing system commands, and it exposes the MySQL password in the process table.

**Weaknesses/vulnerabilities present:**
-  **Command Injection:** The gem's `perform` method uses `system(command.to_s)` which can execute arbitrary commands if the `command` variable contains malicious input.
-  **Password Exposure:** The gem constructs command-line arguments that include the MySQL password directly, which can be exposed via the process table.

**Impact of exploitation:**
- **Command Injection:** An attacker could execute arbitrary commands on the server where the `lynx` gem is used if they can control the `command` variable.
- **Password Exposure:** An attacker with access to the process table (e.g. via `ps` or similar utilities) can gain access to the MySQL password.

**Attack vectors:**
-  **Command Injection:**  By manipulating the `command` variable, an attacker can inject malicious commands.
-  **Password Exposure:** An attacker with access to the process table can gain access to the MySQL password if they can view process arguments.

**Required attacker capabilities/position:**
- An attacker needs the ability to control the `command` variable used in the `system()` call in order to achieve command injection.
- An attacker needs access to process table on the system to be able to read the mysql password via process arguments.
```