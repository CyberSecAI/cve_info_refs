```
RELATED: CVE-2014-5287
Root cause of vulnerability:
The web application functionality is based on multiple bash scripts contained in the /usr/wui/progs folder. The application uses CGI, which allows scripts to handle HTTP requests. The vulnerability exists due to a dangerous "eval" against user-supplied parameters in the `util.sh` script. Specifically, the arguments passed to the `fwaccess` page, which are separated by a slash "/", are then passed to the `eval` function without proper sanitization, allowing command injection.

Weaknesses/vulnerabilities:
- Command injection via the `eval` function in the `util.sh` script.
- Lack of input sanitization on parameters passed to bash scripts.
- Vulnerable CGI implementation.
- Predictable CSRF token based on the unix epoch timestamp.
- Multiple XSS vulnerabilities (reflected and stored)

Impact of exploitation:
- Remote code execution on the server.
- Arbitrary command execution with the privileges of the web server.
- Cross-site request forgery (CSRF) allowing an attacker to force an authenticated user's browser to perform actions on the vulnerable application.
- Cross-site scripting (XSS) attacks to potentially steal user credentials or perform actions on behalf of a user.
- Denial of service by crashing the SSL service of the load balancer.

Attack vectors:
- HTTP GET requests to `/progs/fwaccess/add/` with a crafted payload in the URL.
- HTTP POST requests to various endpoints, including `/progs/geoctrl/doadd`, `/progs/networks/hostname`, `/progs/networks/servadd`, `/progs/useradmin/setopts`, `/progs/fwaccess/add/0`, and `/progs/doconfig/setmotd` with crafted parameters.
- User-Agent header for exploiting Shell-shock vulnerability.
- CSRF attacks to bypass authentication.
- Reflected and stored XSS attacks.

Required attacker capabilities/position:
- Network access to the vulnerable Kemp LoadMaster appliance.
- For command injection via GET requests, no authentication is initially required, however the provided exploits also use XSS and CSRF which would require an authenticated user to be targeted.
- Ability to craft HTTP requests to the vulnerable endpoints.
- For CSRF attacks, the attacker must trick an authenticated user into submitting a malicious request, for XSS the attacker can craft a malicious link to be clicked or stored XSS payload on the application
```