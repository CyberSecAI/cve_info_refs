=== Content from vexatioustendencies.com_2dfbff25_20250125_012807.html ===

# [Vexatious Tendencies](https://vexatioustendencies.com/ "Vexatious Tendencies")

## Random Blog Thing on the Internet, Wait, I Mean Computer Stuff

1. [Home](https://vexatioustendencies.com "Vexatious Tendencies")
»3. [Security](https://vexatioustendencies.com/category/security/ "Security category")
»5. **CSRF in Disqus WordPress Plugin v2.77**

# CSRF in Disqus WordPress Plugin v2.77

Posted on Aug 16, 2014 by [Voxel@Night](https://vexatioustendencies.com/author/voxelnight/ "View all posts by Voxel@Night")

There are several cross site request forgery vulnerabilities in the Disqus WordPress Plugin, version 2.77.

Let’s start with the technical details, then I’ll get to the commentary.

Three settings in the admin interface lack nonces. By exploiting this you can activate or deactivate the plugin, and import or export comments between your wordpress database and disqus.

Example URLs:

```
http://wptestbox1.dev/wordpress/wp-admin/edit-comments.php?page=disqus&active=0
```
```
http://wptestbox1.dev/wordpress/wp-admin/index.php?cf_action=export_comments&post_id=0&timestamp=1408220878.213
```
```
http://wptestbox1.dev/wordpress/wp-admin/index.php?cf_action=import_comments&last_comment_id=0&wipe=1
```

These are all just simple GET requests. There is nothing terribly interesting in the plugin’s code related to this. It is just the simple lack of a nonce (for GET requests).

Recently, Nik Cubrilovic reported CSRF and XSS vulnerabilities in this plugin to Disqus. These vulnerabilities were fixed relatively quickly. That’s great, but these vulnerabilities were glaringly obvious and this plugin is several years old. They weren’t sanitizing input and they were using nonces in their form, but weren’t checking the value when the form was submitted. I’m not sure whether the nonce issue was simply an oversight that went unnoticed for years, or was the result of a lack of understanding about how nonces (for CSRF protection) work or how wordpress plugins should be using them. Either way, when Nik Cubrilovic informed them of the problem in June and they released a new version, I would at least expect it to be fixed correctly, especially considering how simple (and obvious) the problem is. They now verify the nonce for all POST requests, but not for GET requests.

You can take a look at the changes that were made to fix the issues reported by Nik [here](https://plugins.trac.wordpress.org/changeset/935878/disqus-comment-system/trunk/manage.php). The update added this code to check for nonces:

```
if ( ! empty($_POST) ) {
    $nonce_result_check = has_valid_nonce();
    if ($nonce_result_check === false) {
        die('Unable to save changes. Make sure you are accessing this page from the WordPress dashboard.');
    }
}
```

And it also changed this:

```
// handle disqus_active
if (isset($_GET['active'])) {
    update_option('disqus_active', ($_GET['active'] == '1' ? '1' : '0'));
}
```

To this:

```
// handle disqus_active
if ( isset($_GET['active']) ) {
    update_option('disqus_active', ($_GET['active'] == '1' ? '1' : '0'));
}
```

Notice the change is spacing around ‘isset’? The formatting in the source isn’t consistent is this regard so I doubt this change was completely automated. Someone (most likely) looked right at code vulnerable to CSRF and didn’t recognize it. This change was made in the same release that was made primarily to fix CSRF. I don’t know whether this is funny or scary.

Links:

[Nik Cubrilovic’s Blog Post](https://www.nikcub.com/posts/multiple-vulnerabilities-in-disqus-wordpress-plugin/) on the CSRF and XSS Vulnerabilities he reported.

[Disqus WordPress Plugin](http://wordpress.org/plugins/disqus-comment-system/)

[Disqus’ Website](https://disqus.com/)

Tags: [csrf](https://vexatioustendencies.com/tag/csrf/), [security](https://vexatioustendencies.com/tag/security-2/), [vulnerability](https://vexatioustendencies.com/tag/vulnerability/), [web app](https://vexatioustendencies.com/tag/web-app/), [wordpress](https://vexatioustendencies.com/tag/wordpress-2/)

![](https://secure.gravatar.com/avatar/c7b51f0f2360573ce1970da469a2eec4?s=44&d=mm&r=r)
## Author: Voxel@Night

[← Stored XSS in WP Photo Album Plus 5.4.5](https://vexatioustendencies.com/stored-xss-in-wp-photo-album-plus-5-4-5/) [The Many Animals of Linux – AKA WTF is a ‘Trusty Tahr’? – Part 1 →](https://vexatioustendencies.com/the-many-animals-of-linux-aka-wtf-is-a-trusty-tahr-part-1/)
## Comments

1. Pingback: [Disqus plugin v2.77 for WordPress vulnerable to CSRF](http://wordpressdo.com/disqus-plugin-v2-77-for-wordpress-vulnerable-to-csrf/)
3. Pingback: [Vulnerability Summary for the Week of August 18, 2014 | US-CERT](https://www.us-cert.gov/ncas/bulletins/SB14-237)
5. ![](https://i0.wp.com/pbs.twimg.com/profile_images/3637537240/3f5abb4964ee948f02030cbc00be87b8_normal.png?resize=44%2C44)
   [Disqus Help (@disqushelp)](https://twitter.com/disqushelp)

   [October 22, 2014 at 4:15 pm](https://vexatioustendencies.com/csrf-in-disqus-wordpress-plugin-v2-77/#comment-54)

   Update: We have released an updated version of the Disqus plugin today (2.79) which addresses the CSRF security issue. It can be updated here: <https://wordpress.org/plugins/disqus-comment-system/>

   [Reply](https://vexatioustendencies.com/csrf-in-disqus-wordpress-plugin-v2-77/?replytocom=54#respond)

### Leave a Reply[Cancel reply](/csrf-in-disqus-wordpress-plugin-v2-77/#respond)

### Static Things

* [Contact Me](https://vexatioustendencies.com/contact-me/)
* [wtfian](https://vexatioustendencies.com/limited-automated-wp-plugin-vulnerability-scanning-with-wtfian/)

### Recent Posts

* [The Many Animals of Linux – AKA WTF is a ‘Trusty Tahr’? – Part 2](https://vexatioustendencies.com/the-many-animals-of-linux-aka-wtf-is-a-trusty-tahr-part-2/)
* [Analysis of the August Information Stealer](https://vexatioustendencies.com/analysis-of-the-august-information-stealer/)
* [Limited Automated WP Plugin Vulnerability Scanning with wtfian](https://vexatioustendencies.com/limited-automated-wp-plugin-vulnerability-scanning-with-wtfian/)
* [PHP Backdoor Obfuscation Techniques](https://vexatioustendencies.com/php-backdoor-obfuscation-techniques/)
* [Let’s Go to Fry’s!](https://vexatioustendencies.com/lets-go-to-frys/)
### Archives

* [December 2022](https://vexatioustendencies.com/2022/12/)
* [January 2017](https://vexatioustendencies.com/2017/01/)
* [March 2015](https://vexatioustendencies.com/2015/03/)
* [November 2014](https://vexatioustendencies.com/2014/11/)
* [September 2014](https://vexatioustendencies.com/2014/09/)
* [August 2014](https://vexatioustendencies.com/2014/08/)
### Categories

* [Email](https://vexatioustendencies.com/category/email/)
* [Free Stuff](https://vexatioustendencies.com/category/free-stuff/)
* [Linux](https://vexatioustendencies.com/category/linux/)
* [Microsoft](https://vexatioustendencies.com/category/microsoft/)
* [Security](https://vexatioustendencies.com/category/security/)
* [WordPress](https://vexatioustendencies.com/category/wordpress/)
* [WTF?](https://vexatioustendencies.com/category/wtf/)

Copyright © 2025 Vexatious Tendencies

Powered by [WordPress](http://wordpress.org) and [Underline](http://wpmisc.com)



=== Content from seclists.org_5df859f6_20250125_012805.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](45)
[By Date](date.html#46)
[![Next](/images/right-icon-16x16.png)](47)

[![Previous](/images/left-icon-16x16.png)](45)
[By Thread](index.html#46)
[![Next](/images/right-icon-16x16.png)](47)

![](/shared/images/nst-icons.svg#search)

# CSRF in Disqus for Wordpress 2.77

---

*From*: "Voxel@Night" <voxelnight () vexatioustendencies com>

*Date*: Sat, 16 Aug 2014 12:45:23 -0700

---

```

Disqus for Wordpress
<https://wordpress.org/plugins/disqus-comment-system>
Version affected: up to v2.77

CSRF allows for activation and deactivation of the plugin and syncing comments between Disqus servers and the WP
database.
They supposedly just fixed the CSRF issues. Ugh. Sorry Nik. Even when you tell them about nonces they still don't get
it right.

More details can be found here:
<https://vexatioustendencies.com/csrf-in-disqus-wordpress-plugin-v2-77/>

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](45)
[By Date](date.html#46)
[![Next](/images/right-icon-16x16.png)](47)

[![Previous](/images/left-icon-16x16.png)](45)
[By Thread](index.html#46)
[![Next](/images/right-icon-16x16.png)](47)

### Current thread:

* **CSRF in Disqus for Wordpress 2.77** *Voxel@Night (Aug 16)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


