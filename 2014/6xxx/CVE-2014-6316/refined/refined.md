```
{
  "cveId": "CVE-2014-6316",
  "description": "core/string_api.php in MantisBT before 1.2.18 does not properly categorize URLs when running under the web root, which allows remote attackers to conduct open redirect and phishing attacks via a crafted URL in the return parameter to login_page.php.",
  "vulnerability": {
    "rootCause": "The vulnerability lies in the `string_sanitize_url` function within `core/string_api.php`. When MantisBT is installed at the web server's root, the `$g_short_path` is set to '/'. The `string_sanitize_url()` function incorrectly removes the trailing '/' from the short path which results in URLs being incorrectly categorized and thereby allows redirection outside the MantisBT instance domain.",
    "weaknesses": [
      "Improper URL sanitization",
      "Inadequate input validation"
    ],
    "impact": "An attacker can craft a URL with a malicious redirect in the `return` parameter, leading to users being redirected to an external, malicious site. This can be used for phishing attacks or to spread malware.",
    "attackVectors": [
      "Crafted URL in the `return` parameter of `login_page.php`"
    ],
     "requiredCapabilities": "The attacker needs to be able to craft a malicious URL with an external redirection. No special permissions are required."
  },
    "fixes": [
        "The issue was fixed by modifying the `string_sanitize_url()` function in `core/string_api.php` to correctly handle cases where MantisBT is installed at the web server's root and the `$g_short_path` is '/'.",
        "The fix involves adding a check to see if the short path is not empty before categorizing the URL as type 2. If the short path is empty, it categorizes as type 3 which forces the function to return `index.php` preventing the redirection."
    ],
   "workarounds": "There are no practical workarounds, updating to the patched version is highly recommended"
}
```