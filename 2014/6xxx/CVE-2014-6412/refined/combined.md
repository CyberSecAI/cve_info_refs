=== Content from bugzilla.redhat.com_1f03e1c7_20250125_235645.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1192474)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1192474)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1192474)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1192474

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1192474**](show_bug.cgi?id=1192474)
(CVE-2014-6412)
- [CVE-2014-6412](https://access.redhat.com/security/cve/CVE-2014-6412) wordpress: lack of CSPRNG might lead to information disclosure

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-6412 wordpress: lack of CSPRNG might lead to information disclosure

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED UPSTREAM | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-6412 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1192475](show_bug.cgi?id=1192475 "CLOSED EOL - CVE-2014-6412 wordpress: lack of CSPRNG might lead to information disclosure [fedora-all]") [1192476](show_bug.cgi?id=1192476 "CLOSED EOL - CVE-2014-6412 wordpress: lack of CSPRNG might lead to information disclosure [epel-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1192474&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1192474&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-02-13 13:28 UTC by Vasyl Kaigorodov | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:28 UTC ([History](show_activity.cgi?id=1192474)) | | [CC List:](page.cgi?id=fields.html#cclist) | 3 users (show)  carnil fedora gwync | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-08 02:38:49 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1192474#c0)  Vasyl Kaigorodov    2015-02-13 13:28:21 UTC  ``` It was reported [1] that all versions of WordPress are using weak random number generation algorithm, which makes it possible to predict the password reset token for admin user. Non-upstream patch is available here: <https://core.trac.wordpress.org/attachment/ticket/28633/28633.3.patch>  [1]: <http://seclists.org/fulldisclosure/2015/Feb/42>   ```  [Comment 1](show_bug.cgi?id=1192474#c1)  Vasyl Kaigorodov    2015-02-13 13:28:52 UTC  ```  Created wordpress tracking bugs for this issue:  Affects: fedora-all [[bug 1192475](show_bug.cgi?id=1192475 "CLOSED EOL - CVE-2014-6412 wordpress: lack of CSPRNG might lead to information disclosure [fedora-all]")] Affects: epel-all [[bug 1192476](show_bug.cgi?id=1192476 "CLOSED EOL - CVE-2014-6412 wordpress: lack of CSPRNG might lead to information disclosure [epel-all]")]   ```  [Comment 2](show_bug.cgi?id=1192474#c2)  Product Security DevOps Team    2019-06-08 02:38:49 UTC  ``` This CVE Bugzilla entry is for community support informational purposes only as it does not affect a package in a commercially supported Red Hat product. Refer to the dependent bugs for status of those individual community products.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1192474&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_bd441b31_20250126_125517.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from nmap.org_b689adf5_20250126_125518.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

* [Nmap Network Scanning](toc.html)
* Chapter 15. Nmap Reference Guide

[Prev](data-files-replacing-data-files.html)[Next](man-briefoptions.html)
# Chapter 15. Nmap Reference Guide

Table of Contents

* [Description](man.html#man-description)
* [Options Summary](man-briefoptions.html)
* [Target Specification](man-target-specification.html)
* [Host Discovery](man-host-discovery.html)
* [Port Scanning Basics](man-port-scanning-basics.html)
* [Port Scanning Techniques](man-port-scanning-techniques.html)
* [Port Specification and Scan Order](man-port-specification.html)
* [Service and Version Detection](man-version-detection.html)
* [OS Detection](man-os-detection.html)
* [Nmap Scripting Engine (NSE)](man-nse.html)
* [Timing and Performance](man-performance.html)
* [Firewall/IDS Evasion and Spoofing](man-bypass-firewalls-ids.html)
* [Output](man-output.html)
* [Miscellaneous Options](man-misc-options.html)
* [Runtime Interaction](man-runtime-interaction.html)
* [Examples](man-examples.html)
* [Nmap Book](man-book.html)
* [Bugs](man-bugs.html)
* [Authors](man-author.html)
* [Legal Notices](man-legal.html)
  + [Nmap Copyright and Licensing](man-legal.html#nmap-copyright)
  + [Creative Commons License for this Nmap Guide](man-legal.html#man-copyright)
  + [Source Code Availability and Community Contributions](man-legal.html#source-contrib)
  + [No Warranty](man-legal.html#no-warranty)
  + [Inappropriate Usage](man-legal.html#inappropriate-usage)
  + [Third-Party Software and Funding Notices](man-legal.html#third-party-soft)
  + [United States Export Control](man-legal.html#us-export)
## Name

nmap — Network exploration tool and security / port scanner

## Synopsis

`nmap` [
*`<Scan Type>`*
...] [
*`<Options>`*
] {
*`<target specification>`*
}

## Description

| [Note] | Note |
| --- | --- |
| This document describes the very latest version of Nmap available from [`https://nmap.org/download.html`](https://nmap.org/download.html) or [`https://nmap.org/dist/?C=M&O=D`](https://nmap.org/dist/?C=M&O=D). Please ensure you are using the latest version before reporting that a feature doesn't work as described. |

Nmap (“Network Mapper”) is an open source tool for network
exploration and security auditing. It was designed to rapidly
scan large networks, although it works fine against single
hosts. Nmap uses raw IP packets in novel ways to determine what
hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other
characteristics. While Nmap is commonly used for security audits,
many systems and network administrators find it useful for routine
tasks such as network inventory, managing service upgrade
schedules, and monitoring host or service uptime.

The output from Nmap is a list of scanned targets, with
supplemental information on each depending on the options
used. Key among that information is the “interesting ports
table”.
That table lists the port number and protocol,
service name, and state. The state is either
`open`, `filtered`,
`closed`, or `unfiltered`.
`Open`
means that an application on the target machine is listening for
connections/packets on that port.
`Filtered`
means that a firewall, filter, or other network
obstacle is blocking the port so that Nmap cannot tell whether it is
`open` or `closed`.
`Closed`
ports have no application listening on them,
though they could open up at any time.
Ports are classified as
`unfiltered`
when they are
responsive to Nmap's probes, but Nmap cannot determine whether they are
open or closed.
Nmap reports the state combinations
`open|filtered`
and `closed|filtered`
when it cannot determine which
of the two states describe a port. The port table may also
include software version details when version detection has been
requested. When an IP protocol scan is requested
(`-sO`), Nmap provides information on supported IP
protocols rather than listening ports.

In addition to the interesting ports table, Nmap can provide
further information on targets, including reverse DNS names,
operating system guesses, device types, and MAC addresses.

A typical Nmap scan is shown in [Example 15.1](man.html#man-ex-repscan "Example 15.1. A representative Nmap scan"). The only Nmap arguments used in
this example are `-A`, to enable OS and version
detection, script scanning, and traceroute; `-T4` for
faster execution; and then the hostname.

Example 15.1. A representative Nmap scan
```
# nmap -A -T4 scanme.nmap.org

Nmap scan report for scanme.nmap.org (74.207.244.221)
Host is up (0.029s latency).
rDNS record for 74.207.244.221: li86-221.members.linode.com
Not shown: 995 closed ports
PORT     STATE    SERVICE     VERSION
22/tcp   open     ssh         OpenSSH 5.3p1 Debian 3ubuntu7 (protocol 2.0)
| ssh-hostkey: 1024 8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA)
|_2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)
80/tcp   open     http        Apache httpd 2.2.14 ((Ubuntu))
|_http-title: Go ahead and ScanMe!
646/tcp  filtered ldp
1720/tcp filtered H.323/Q.931
9929/tcp open     nping-echo  Nping echo
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6.39
OS details: Linux 2.6.39
Network Distance: 11 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:kernel

TRACEROUTE (using port 53/tcp)
HOP RTT      ADDRESS
[Cut first 10 hops for brevity]
11  17.65 ms li86-221.members.linode.com (74.207.244.221)

Nmap done: 1 IP address (1 host up) scanned in 14.40 seconds

```

The newest version of Nmap can be obtained from
[`https://nmap.org`](https://nmap.org). The newest version of this man page
is available at [`https://nmap.org/book/man.html`](https://nmap.org/book/man.html).
It is also included as a chapter of [*Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning*](https://nmap.org/book/).

---

[Prev](data-files-replacing-data-files.html)Using Customized Data Files[Up](toc.html)Nmap Network Scanning[Home](toc.html)[Next](man-briefoptions.html)Options Summary

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_9c2e9e7e_20250125_235642.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](41)
[By Date](date.html#42)
[![Next](/images/right-icon-16x16.png)](43)

[![Previous](/images/left-icon-16x16.png)](41)
[By Thread](index.html#42)
[![Next](/images/right-icon-16x16.png)](54)

![](/shared/images/nst-icons.svg#search)

# CVE-2014-6412 - WordPress (all versions) lacks CSPRNG

---

*From*: Scott Arciszewski <scott () arciszewski me>

*Date*: Tue, 10 Feb 2015 11:50:16 -0500

---

```
Ticket opened: 2014-06-25
Affected Versions: ALL
Problem: No CSPRNG
Patch available, collecting dust because of negligent (and questionably
competent) WP maintainers

On June 25, 2014 I opened a ticked on WordPress's issue tracker to expose a
cryptographically secure pseudorandom number generator, since none was
present (although it looks like others have tried to hack together a
band-aid solution to mitigate php_mt_seed until WordPress gets their "let's
support PHP < 5.3" heads out of their asses).

For the past 8 months, I have tried repeatedly to raise awareness of this
bug, even going as far as to attend WordCamp Orlando to troll^H advocate
for its examination in person. And they blew me off every time.

If anyone with RNG breaking experience (cough solar designer cough) can PoC
it, without the patch I've provided you should be able to trivially predict
the password reset token for admin users and take over any WordPress site
completely.

Eight fucking months.

Patch available with unit tests and PHP 5.2 on Windows support at
<https://core.trac.wordpress.org/attachment/ticket/28633/28633.3.patch>

Scott
<https://scott.arciszewski.me>
@voodooKobra

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](41)
[By Date](date.html#42)
[![Next](/images/right-icon-16x16.png)](43)

[![Previous](/images/left-icon-16x16.png)](41)
[By Thread](index.html#42)
[![Next](/images/right-icon-16x16.png)](54)

### Current thread:

* **CVE-2014-6412 - WordPress (all versions) lacks CSPRNG** *Scott Arciszewski (Feb 11)*
  + [Re: CVE-2014-6412 - WordPress (all versions) lacks CSPRNG](54) *Paul McMillan (Feb 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from profiles.wordpress.org_d5c1a6ae_20250126_125520.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

# [Profiles](https://profiles.wordpress.org/nacin/)

* [Register](https://login.wordpress.org/register?locale=en_US&redirect_to=https%3A%2F%2Fprofiles.wordpress.org%2Fnacin%2F)
* [Log In](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fprofiles.wordpress.org%2Fnacin%2F&locale=en_US)

![](https://secure.gravatar.com/avatar/1a7df76f4f6519a5618c32428b277a5c7a89798394965b67e50528ca57c1b5a8?s=100&d=mm&r=g)
## [Andrew Nacin](https://profiles.wordpress.org/nacin/)

@nacin on WordPress.org and [Slack](https://make.wordpress.org/chat/)

### Bio

Lead Developer of WordPress

* Member Since:
  **November 6th, 2009**
* Location:
  **Washington, D.C.**
* Website:
  **[nacin.com](https://profiles.wordpress.org/website-redirect/nacin)**
* Job Title:
  **Lead Developer**
* Employer:
  **WordPress**
* Find me on:

### Contribution History

Andrew Nacin’s badges:

* bbPress Contributor
* BuddyPress Contributor
* Core Contributor
* Core Team
* Meta Contributor
* Meta Team
* Plugin Developer
* Themes Team
* Translation Contributor
* WordCamp Organizer
* WordCamp Speaker

* [Activity](#content-activity)
* [Plugins](#content-plugins)
* [Translations](#content-translations)

* Mentioned in [[59698]](https://core.trac.wordpress.org/changeset/59698/) on Core SVN:
  Themes: Add `wp-theme-` and `wp-child-theme-` classes to `body\_class`.

  2 days ago
* Mentioned in [[59677]](https://core.trac.wordpress.org/changeset/59677/) on Core SVN:
  Formatting: Preserve `target="\_blank"` in Biographical Info and Category Description.

  5 days ago
* Mentioned in [[59592]](https://core.trac.wordpress.org/changeset/59592/) on Core SVN:
  I18N: Mail: Make PHPMailer messages translatable.

  3 weeks ago
* Mentioned in [[58097]](https://core.trac.wordpress.org/changeset/58097/) on Core SVN:
  Bootstrap/Load: Add support for custom ports in multisite site addresses.

  9 months ago
* Mentioned in [[57681]](https://core.trac.wordpress.org/changeset/57681/) on Core SVN:
  Export: Include featured image for posts or pages.

  11 months ago
* Mentioned in [[57545]](https://core.trac.wordpress.org/changeset/57545/) on Core SVN:
  Upgrade/Install: Introduce Plugin Dependencies.

  12 months ago
* Mentioned in [[56939]](https://core.trac.wordpress.org/changeset/56939/) on Core SVN:
  Posts, Post Types: Don't force trailing slash in `get\_pagenum\_link()`.

  1 year ago
* Mentioned in [[56681]](https://core.trac.wordpress.org/changeset/56681/) on Core SVN:
  Options, Meta APIs: Improve logic to avoid unnecessary database writes in `update\_option()`.

  1 year ago
* Mentioned in [[56635]](https://core.trac.wordpress.org/changeset/56635/) on Core SVN:
  Themes: Deprecate usage of `TEMPLATEPATH` and `STYLESHEETPATH` constants.

  1 year ago
* Mentioned in [[56611]](https://core.trac.wordpress.org/changeset/56611/) on Core SVN:
  Quick Edit: Allow Quick Edit to be disabled for custom post types or taxonomies.

  1 year ago
* Mentioned in [[56439]](https://core.trac.wordpress.org/changeset/56439/) on Core SVN:
  Build/Test Tools: Expand database testing to account for all supported versions and types.

  1 year ago
* Mentioned in [[56220]](https://core.trac.wordpress.org/changeset/56220/) on Core SVN:
  Help/About: Add a “Get Involved” tab to the About page.

  2 years ago
* Mentioned in [[55569]](https://core.trac.wordpress.org/changeset/55569/) on Core SVN:
  Posts, Post Types: Use WP\_Query internally in get\_pages.

  2 years ago
* Mentioned in [[55113]](https://core.trac.wordpress.org/changeset/55113/) on Core SVN:
  Posts, Post Types: Increase the input field's width in the Slug metabox.

  2 years ago
* Mentioned in [[54496]](https://core.trac.wordpress.org/changeset/54496/) on Core SVN:
  Query: Avoid PHP notices when `get\_queried\_object()` returns `null`.

  2 years ago
* Mentioned in [[54378]](https://core.trac.wordpress.org/changeset/54378/) on Core SVN:
  Administration: Remove private delegation from list tables.

  2 years ago
* Mentioned in [[54262]](https://core.trac.wordpress.org/changeset/54262/) on Core SVN:
  Users: Make `wp\_list\_authors()` and `wp\_list\_users()` filterable.

  2 years ago
* Mentioned in [[54247]](https://core.trac.wordpress.org/changeset/54247/) on Core SVN:
  Administration: Allow to wrap Settings sections with custom HTML content.

  2 years ago
* Mentioned in [[54240]](https://core.trac.wordpress.org/changeset/54240/) on Core SVN:
  Networks and Sites: Officially remove global terms.

  2 years ago
* Mentioned in [[53941]](https://core.trac.wordpress.org/changeset/53941/) on Core SVN:
  Query: Cache post ID database query within `WP\_Query`.

  2 years ago
* Mentioned in [[53891]](https://core.trac.wordpress.org/changeset/53891/) on Core SVN:
  Query: Be better at forcing data types for query vars.

  2 years ago
* Mentioned in [[53884]](https://core.trac.wordpress.org/changeset/53884/) on Core SVN:
  Login and Registration: Introduce `is\_login\_screen()` function.

  2 years ago
* Mentioned in [[53803]](https://core.trac.wordpress.org/changeset/53803/) on Core SVN:
  Plugins: Introduce `did\_filter()` function.

  2 years ago
* Mentioned in [[53754]](https://core.trac.wordpress.org/changeset/53754/) on Core SVN:
  Formatting: Normalize to Unicode NFC encoding before converting accent characters in `remove\_accents()`.

  3 years ago
* Mentioned in [[53685]](https://core.trac.wordpress.org/changeset/53685/) on Core SVN:
  Media:

  3 years ago
* Mentioned in [[53486]](https://core.trac.wordpress.org/changeset/53486/) on Core SVN:
  Query: Add a hook to filter author full name from `wp\_list\_authors()`.

  3 years ago
* Mentioned in [[53408]](https://core.trac.wordpress.org/changeset/53408/) on Core SVN:
  Users: Fail gracefully when checking mapped capabilities without providing the required object ID.

  3 years ago
* Reopened ticket [#55104](https://core.trac.wordpress.org/ticket/55104#comment:10) on Core Trac:
  is\_main\_query() fatal error on null

  3 years ago
* Mentioned in [[53058]](https://core.trac.wordpress.org/changeset/53058/) on Core SVN:
  Posts, Post Types; Taxonomy: Translate default labels once.

  3 years ago
* Mentioned in [[53036]](https://core.trac.wordpress.org/changeset/53036/) on Core SVN:
  Comments: Improve performance of the `wp\_count\_comments` function.

  3 years ago
* Mentioned in [[52195]](https://core.trac.wordpress.org/changeset/52195/) on Core SVN:
  WPDB: Call `wp\_load\_translations\_early()` in `wpdb::\_real\_escape()`.

  3 years ago
* Mentioned in [[52064]](https://core.trac.wordpress.org/changeset/52064/) on Core SVN:
  Users: Introduce `wp\_list\_users()` function.

  3 years ago
* Wrote a [comment](https://make.wordpress.org/core/2021/02/03/committers-maintainers-and-emeriti/#comment-40725) on the post *Committers, Maintainers, and Emeriti*, on the site Make WordPress Core:
  Denoting some committers as active and some as dormant/inactive/emeriti seems like a great idea! I…

  4 years ago
* Mentioned in [[50135]](https://core.trac.wordpress.org/changeset/50135/) on Core SVN:
  Cron API: Run alternative wp-cron later, do not run on archived blogs.

  4 years ago
* Mentioned in [[49845]](https://core.trac.wordpress.org/changeset/49845/) on Core SVN:
  Upload: Introduce the `{$action}\_overrides` filter that allows the overrides parameter for file uploads and file sideloads to be filtered.

  4 years ago
* Mentioned in [[49565]](https://core.trac.wordpress.org/changeset/49565/) on Core SVN:
  Feeds: Register transient feed cache handler using the recommended method for SimplePie 1.3 or later.

  4 years ago
* Mentioned in [[49563]](https://core.trac.wordpress.org/changeset/49563/) on Core SVN:
  Canonical: Prevent ID enumeration of private post slugs.

  4 years ago
* Mentioned in [[48601]](https://core.trac.wordpress.org/changeset/48601/) on Core SVN:
  Mail: Ensure that a server hostname can be set by using `network\_home\_url()`.

  5 years ago
* Mentioned in [[48433]](https://core.trac.wordpress.org/changeset/48433/) on Core SVN:
  Formatting: Prevent wp\_slash from returning non-strings as strings.

  5 years ago
* Mentioned in [[48370]](https://core.trac.wordpress.org/changeset/48370/) on Core SVN:
  Themes: Allow template loading functions to pass additional arguments to the template via the `$args` parameter.

  5 years ago
* Mentioned in [[48060]](https://core.trac.wordpress.org/changeset/48060/) on Core SVN:
  Themes: Add additional later escaping to `post\_class()` and `body\_class()` functions.

  5 years ago
* Mentioned in [[47938]](https://core.trac.wordpress.org/changeset/47938/) on Core SVN:
  Cache API: Introduce `wp\_cache\_get\_multi()`.

  5 years ago
* Mentioned in [[47878]](https://core.trac.wordpress.org/changeset/47878/) on Core SVN:
  Canonical: Add the ability to disable `redirect\_guess\_404\_permalink()`.

  5 years ago
* Mentioned in [[47600]](https://core.trac.wordpress.org/changeset/47600/) on Core SVN:
  Users: Change "Your Profile" and "My Profile" links in admin menu and toolbar to just "Profile" for consistency.

  5 years ago
* Mentioned in [[9580]](https://meta.trac.wordpress.org/changeset/9580/) on Meta SVN:
  Main theme: Update broken footnote link on security page to appropriate Core Handbook page.

  5 years ago
* Mentioned in [[47227]](https://core.trac.wordpress.org/changeset/47227/) on Core SVN:
  Import: Remove "Blogroll" import option (for links in OPML format) from the list of popular importer plugins.

  5 years ago
* Mentioned in [[47107]](https://core.trac.wordpress.org/changeset/47107/) on Core SVN:
  Cache API: Remove `WP\_Object\_Cache::\_\_destruct()` and `wpdb::\_\_destruct()`.

  5 years ago
* Mentioned in [[46642]](https://core.trac.wordpress.org/changeset/46642/) on Core SVN:
  Toolbar: Use `add\_node()` instead of `add\_menu()` in core.

  5 years ago
* Mentioned in [[46194]](https://core.trac.wordpress.org/changeset/46194/) on Core SVN:
  Multisite: Remove the redundant `blog\_versions` table.

  5 years ago
* Mentioned in [[45901]](https://core.trac.wordpress.org/changeset/45901/) on Core SVN:
  Date/Time: Introduce `wp\_date()` to retrieve the date in localized format.

  5 years ago

### Developer

* [![](https://ps.w.org/background-update-tester/assets/icon-256x256.png?rev=1908362)](//wordpress.org/plugins/background-update-tester/)
  ### [Background Update Tester](//wordpress.org/plugins/background-update-tester/)

  Active Installs: 1,000+
* [![](https://s.w.org/plugins/geopattern-icon/comment-probation.svg)](//wordpress.org/plugins/comment-probation/)
  ### [Comment Probation](//wordpress.org/plugins/comment-probation/)

  Active Installs: 60+
* [![](https://ps.w.org/debug-bar/assets/icon.svg?rev=3050748)](//wordpress.org/plugins/debug-bar/)
  ### [Debug Bar](//wordpress.org/plugins/debug-bar/)

  Active Installs: 20,000+
* [![](https://s.w.org/plugins/geopattern-icon/filtered-html-for-editors.svg)](//wordpress.org/plugins/filtered-html-for-editors/)
  ### [Filtered HTML for Editors](//wordpress.org/plugins/filtered-html-for-editors/)

  Active Installs: 10+
* [![](https://s.w.org/plugins/geopattern-icon/hide-welcome-panel-for-multisite.svg)](//wordpress.org/plugins/hide-welcome-panel-for-multisite/)
  ### [Hide Welcome Panel for Multisite](//wordpress.org/plugins/hide-welcome-panel-for-multisite/)

  Active Installs: 10+
* [![](https://s.w.org/plugins/geopattern-icon/hotfix_2b1504.svg)](//wordpress.org/plugins/hotfix/)
  ### [Hotfix](//wordpress.org/plugins/hotfix/)

  Active Installs: 5,000+
* [![](https://s.w.org/plugins/geopattern-icon/link-manager.svg)](//wordpress.org/plugins/link-manager/)
  ### [Link Manager](//wordpress.org/plugins/link-manager/)

  Active Installs: 40,000+
* [![](https://s.w.org/plugins/geopattern-icon/log-deprecated-notices.svg)](//wordpress.org/plugins/log-deprecated-notices/)
  ### [Log Deprecated Notices](//wordpress.org/plugins/log-deprecated-notices/)

  Active Installs: 1,000+
* [![](https://s.w.org/plugins/geopattern-icon/memcached.svg)](//wordpress.org/plugins/memcached/)
  ### [Memcached Object Cache](//wordpress.org/plugins/memcached/)

  Active Installs: 20+
* [![](https://s.w.org/plugins/geopattern-icon/simple-footnotes.svg)](//wordpress.org/plugins/simple-footnotes/)
  ### [Simple Footnotes](//wordpress.org/plugins/simple-footnotes/)

  Active Installs: 800+

### Contributor

* [![](https://ps.w.org/glotpress/assets/icon-256x256.png?rev=2699206)](//wordpress.org/plugins/glotpress/)
  ### [GlotPress](//wordpress.org/plugins/glotpress/)

  Active Installs: 600+
* [![](https://s.w.org/plugins/geopattern-icon/quick-admin-color-scheme-picker.svg)](//wordpress.org/plugins/quick-admin-color-scheme-picker/)
  ### [Quick admin color scheme picker](//wordpress.org/plugins/quick-admin-color-scheme-picker/)

  Active Installs: 10+
* [![](https://ps.w.org/ricg-responsive-images/assets/icon.svg?rev=1119324)](//wordpress.org/plugins/ricg-responsive-images/)
  ### [RICG Responsive Images](//wordpress.org/plugins/ricg-responsive-images/)

  Active Installs: 3,000+
* [![](https://s.w.org/plugins/geopattern-icon/the-future-is-now.svg)](//wordpress.org/plugins/the-future-is-now/)
  ### [The Future Is Now](//wordpress.org/plugins/the-future-is-now/)

  Active Installs: 2,000+

### Suomi (Finnish) Translation Contributor - #fi

[Custom Post Type Widgets](https://translate.wordpress.org/locale/fi/default/wp-plugins/custom-post-type-widgets/#contributor-nacin) and [WordPress 4.2.x](https://translate.wordpress.org/locale/fi/default/wp/4.2.x/#contributor-nacin)
### English (Canada) Translation Contributor - #en\_CA

[WordPress 6.7.x - Development](https://translate.wordpress.org/locale/en-ca/default/wp/dev/#contributor-nacin)
### עִבְרִית (Hebrew) Translation Contributor - #he\_IL

[WordPress 6.7.x - Development](https://translate.wordpress.org/locale/he/default/wp/dev/#contributor-nacin)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from nmap.org_b89a31d3_20250126_125518.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

* [Nmap Network Scanning](toc.html)
* Chapter 15. Nmap Reference Guide

[Prev](data-files-replacing-data-files.html)[Next](man-briefoptions.html)
# Chapter 15. Nmap Reference Guide

Table of Contents

* [Description](man.html#man-description)
* [Options Summary](man-briefoptions.html)
* [Target Specification](man-target-specification.html)
* [Host Discovery](man-host-discovery.html)
* [Port Scanning Basics](man-port-scanning-basics.html)
* [Port Scanning Techniques](man-port-scanning-techniques.html)
* [Port Specification and Scan Order](man-port-specification.html)
* [Service and Version Detection](man-version-detection.html)
* [OS Detection](man-os-detection.html)
* [Nmap Scripting Engine (NSE)](man-nse.html)
* [Timing and Performance](man-performance.html)
* [Firewall/IDS Evasion and Spoofing](man-bypass-firewalls-ids.html)
* [Output](man-output.html)
* [Miscellaneous Options](man-misc-options.html)
* [Runtime Interaction](man-runtime-interaction.html)
* [Examples](man-examples.html)
* [Nmap Book](man-book.html)
* [Bugs](man-bugs.html)
* [Authors](man-author.html)
* [Legal Notices](man-legal.html)
  + [Nmap Copyright and Licensing](man-legal.html#nmap-copyright)
  + [Creative Commons License for this Nmap Guide](man-legal.html#man-copyright)
  + [Source Code Availability and Community Contributions](man-legal.html#source-contrib)
  + [No Warranty](man-legal.html#no-warranty)
  + [Inappropriate Usage](man-legal.html#inappropriate-usage)
  + [Third-Party Software and Funding Notices](man-legal.html#third-party-soft)
  + [United States Export Control](man-legal.html#us-export)
## Name

nmap — Network exploration tool and security / port scanner

## Synopsis

`nmap` [
*`<Scan Type>`*
...] [
*`<Options>`*
] {
*`<target specification>`*
}

## Description

| [Note] | Note |
| --- | --- |
| This document describes the very latest version of Nmap available from [`https://nmap.org/download.html`](https://nmap.org/download.html) or [`https://nmap.org/dist/?C=M&O=D`](https://nmap.org/dist/?C=M&O=D). Please ensure you are using the latest version before reporting that a feature doesn't work as described. |

Nmap (“Network Mapper”) is an open source tool for network
exploration and security auditing. It was designed to rapidly
scan large networks, although it works fine against single
hosts. Nmap uses raw IP packets in novel ways to determine what
hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other
characteristics. While Nmap is commonly used for security audits,
many systems and network administrators find it useful for routine
tasks such as network inventory, managing service upgrade
schedules, and monitoring host or service uptime.

The output from Nmap is a list of scanned targets, with
supplemental information on each depending on the options
used. Key among that information is the “interesting ports
table”.
That table lists the port number and protocol,
service name, and state. The state is either
`open`, `filtered`,
`closed`, or `unfiltered`.
`Open`
means that an application on the target machine is listening for
connections/packets on that port.
`Filtered`
means that a firewall, filter, or other network
obstacle is blocking the port so that Nmap cannot tell whether it is
`open` or `closed`.
`Closed`
ports have no application listening on them,
though they could open up at any time.
Ports are classified as
`unfiltered`
when they are
responsive to Nmap's probes, but Nmap cannot determine whether they are
open or closed.
Nmap reports the state combinations
`open|filtered`
and `closed|filtered`
when it cannot determine which
of the two states describe a port. The port table may also
include software version details when version detection has been
requested. When an IP protocol scan is requested
(`-sO`), Nmap provides information on supported IP
protocols rather than listening ports.

In addition to the interesting ports table, Nmap can provide
further information on targets, including reverse DNS names,
operating system guesses, device types, and MAC addresses.

A typical Nmap scan is shown in [Example 15.1](man.html#man-ex-repscan "Example 15.1. A representative Nmap scan"). The only Nmap arguments used in
this example are `-A`, to enable OS and version
detection, script scanning, and traceroute; `-T4` for
faster execution; and then the hostname.

Example 15.1. A representative Nmap scan
```
# nmap -A -T4 scanme.nmap.org

Nmap scan report for scanme.nmap.org (74.207.244.221)
Host is up (0.029s latency).
rDNS record for 74.207.244.221: li86-221.members.linode.com
Not shown: 995 closed ports
PORT     STATE    SERVICE     VERSION
22/tcp   open     ssh         OpenSSH 5.3p1 Debian 3ubuntu7 (protocol 2.0)
| ssh-hostkey: 1024 8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA)
|_2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)
80/tcp   open     http        Apache httpd 2.2.14 ((Ubuntu))
|_http-title: Go ahead and ScanMe!
646/tcp  filtered ldp
1720/tcp filtered H.323/Q.931
9929/tcp open     nping-echo  Nping echo
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6.39
OS details: Linux 2.6.39
Network Distance: 11 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:kernel

TRACEROUTE (using port 53/tcp)
HOP RTT      ADDRESS
[Cut first 10 hops for brevity]
11  17.65 ms li86-221.members.linode.com (74.207.244.221)

Nmap done: 1 IP address (1 host up) scanned in 14.40 seconds

```

The newest version of Nmap can be obtained from
[`https://nmap.org`](https://nmap.org). The newest version of this man page
is available at [`https://nmap.org/book/man.html`](https://nmap.org/book/man.html).
It is also included as a chapter of [*Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning*](https://nmap.org/book/).

---

[Prev](data-files-replacing-data-files.html)Using Customized Data Files[Up](toc.html)Nmap Network Scanning[Home](toc.html)[Next](man-briefoptions.html)Options Summary

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_3103a408_20250125_235643.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](49)
[By Date](date.html#53)
[![Next](/images/right-icon-16x16.png)](54)

[![Previous](/images/left-icon-16x16.png)](49)
[By Thread](index.html#53)
[![Next](/images/right-icon-16x16.png)](55)

![](/shared/images/nst-icons.svg#search)

# Followup on CVE-2014-6412

---

*From*: Scott Arciszewski <kobrasrealm () gmail com>

*Date*: Thu, 12 Feb 2015 21:11:36 -0500

---

```
Since my last post, I have learned from Andrew Nacin (the lead developer of
WordPress and security team member that I was corresponding with) that my
emails weren't ignored, they were lost to an aggressive spam filter.

Despite this, he has admitted fault for not following up on the bug report.

Before the spam filter blackholed my emails, I was communicating with the
security team about a separate enhancement (using openssl to sign their
auto-update packages with an offline key so if wordpress.org gets 0wned it
doesn't propagate to countless blogs being compromised), and failed to
communicate that I still considered the lack of a CSPRNG an issue.

Nacin also had this to say about the matter:
<https://core.trac.wordpress.org/ticket/28633#comment:25>

Although my words were harsh, they were not entirely deserved. Nacin's not
the asshole he appeared to be.

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](49)
[By Date](date.html#53)
[![Next](/images/right-icon-16x16.png)](54)

[![Previous](/images/left-icon-16x16.png)](49)
[By Thread](index.html#53)
[![Next](/images/right-icon-16x16.png)](55)

### Current thread:

* **Followup on CVE-2014-6412** *Scott Arciszewski (Feb 12)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from nmap.org_9ba698e9_20250126_125518.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from core.trac.wordpress.org_76c636a5_20250125_235647.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Core](https://make.wordpress.org/core/)

* [Blog](https://make.wordpress.org/core/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Browse Source](https://core.trac.wordpress.org/browser "Browse Source")
* [Trac Timeline](https://core.trac.wordpress.org/timeline "Trac Timeline")
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket "Create a New Ticket")

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fcore.trac.wordpress.org%2Fticket%2F28633)
* [Notifications](https://make.wordpress.org/core/notifications/)

## Context Navigation

* ← [Previous Ticket](/ticket/28632 "Ticket #28632")
* [Next Ticket](/ticket/28634 "Ticket #28634") →

---

Opened [11 years ago](/timeline?from=2014-06-25T15%3A54%3A11Z&precision=second "See timeline at 06/25/2014 03:54:11 PM")

Closed [9 years ago](/timeline?from=2015-10-23T04%3A21%3A02Z&precision=second "See timeline at 10/23/2015 04:21:02 AM")

Last modified [8 years ago](/timeline?from=2017-01-11T20%3A43%3A16Z&precision=second "See timeline at 01/11/2017 08:43:16 PM")

## [#28633](/ticket/28633) [closed](/query?status=closed) [enhancement](/query?status=!closed&type=enhancement) ([fixed](/query?status=closed&resolution=fixed))

# Generate better random numbers

| Reported by: | [sarciszewski's profile](https://profiles.wordpress.org/sarciszewski) [sarciszewski](/query?status=!closed&reporter=sarciszewski) | Owned by: | [dd32's profile](https://profiles.wordpress.org/dd32) [dd32](/query?status=!closed&owner=dd32) |
| --- | --- | --- | --- |
| Milestone: | [4.4](/milestone/4.4 "Completed 9 years ago (12/08/2015 12:19:15 AM)") | Priority: | [normal](/query?status=!closed&priority=normal) |
| Severity: | [normal](/query?status=!closed&severity=normal) | Version: |  |
| Component: | [Security](/query?status=!closed&component=Security) | Keywords: | [needs-testing](/query?status=!closed&keywords=~needs-testing) [has-patch](/query?status=!closed&keywords=~has-patch) [early](/query?status=!closed&keywords=~early) |
| Focuses: |  | Cc: |  |

### Description

Never used Trac/SVN at all, so I apologize if I'm doing this wrong. I want to submit what a github user would call a pull request. Although this is classified as security, it's not exactly a critical 0day vulnerability I found or anything.

### Attachments (15)

[28633.patch](/attachment/ticket/28633/28633.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.patch "Download") (5.5 KB) - added by sarciszewski [10 years ago](/timeline?from=2014-11-19T21%3A15%3A10Z&precision=second "See timeline at 11/19/2014 09:15:10 PM").

Bugfix

[28633.2.patch](/attachment/ticket/28633/28633.2.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.2.patch "Download") (7.2 KB) - added by sarciszewski [10 years ago](/timeline?from=2014-12-07T21%3A07%3A25Z&precision=second "See timeline at 12/07/2014 09:07:25 PM").

Updated patch

[28633.3.patch](/attachment/ticket/28633/28633.3.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.3.patch "Download") (9.4 KB) - added by sarciszewski [10 years ago](/timeline?from=2014-12-10T14%3A09%3A46Z&precision=second "See timeline at 12/10/2014 02:09:46 PM").

Now with Windows + 5.2 support

[28633.4.patch](/attachment/ticket/28633/28633.4.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.4.patch "Download") (9.5 KB) - added by sarciszewski [10 years ago](/timeline?from=2015-02-12T16%3A09%3A41Z&precision=second "See timeline at 02/12/2015 04:09:41 PM").

Edited the patch file manually because ​git://develop.git.wordpress.org is not working atm

[28633.5.patch](/attachment/ticket/28633/28633.5.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.5.patch "Download") (8.5 KB) - added by sarciszewski [10 years ago](/timeline?from=2015-02-12T18%3A23%3A11Z&precision=second "See timeline at 02/12/2015 06:23:11 PM").

Figured the git problem out, previous patch didn't work, so I remade it.

[28633\_alt.patch](/attachment/ticket/28633/28633_alt.patch "View attachment")[​](/raw-attachment/ticket/28633/28633_alt.patch "Download") (8.8 KB) - added by sarciszewski [10 years ago](/timeline?from=2015-02-12T18%3A36%3A25Z&precision=second "See timeline at 02/12/2015 06:36:25 PM").

Alternative, based on [​https://github.com/resonantcore/lib/blob/develop/src/Secure.php](https://github.com/resonantcore/lib/blob/develop/src/Secure.php) which I have tested extensively.

[28633.6.patch](/attachment/ticket/28633/28633.6.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.6.patch "Download") (10.6 KB) - added by sarciszewski [10 years ago](/timeline?from=2015-02-13T02%3A08%3A43Z&precision=second "See timeline at 02/13/2015 02:08:43 AM").

More paranoid return checking, use a binary-safe strlen() and substr()

[28633\_with\_md5.patch](/attachment/ticket/28633/28633_with_md5.patch "View attachment")[​](/raw-attachment/ticket/28633/28633_with_md5.patch "Download") (10.0 KB) - added by sarciszewski [10 years ago](/timeline?from=2015-02-14T00%3A54%3A31Z&precision=second "See timeline at 02/14/2015 12:54:31 AM").

Same as previous patch but without replacing the md5(time()) hack

[28633.6.1.patch](/attachment/ticket/28633/28633.6.1.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.6.1.patch "Download") (9.8 KB) - added by yantchi [10 years ago](/timeline?from=2015-02-14T13%3A29%3A51Z&precision=second "See timeline at 02/14/2015 01:29:51 PM").

Patch 28633.6 with fixed syntax errors (few missed closing parentheses and try-catch syntax)

[28633.7.patch](/attachment/ticket/28633/28633.7.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.7.patch "Download") (11.4 KB) - added by sarciszewski [10 years ago](/timeline?from=2015-02-14T22%3A44%3A47Z&precision=second "See timeline at 02/14/2015 10:44:47 PM").

@Otto42 - You're absolutely correct. Also, there's a bug in mcrypt on Windows for PHP < 5.3.7 where it always produces insufficient entropy.

[28633.8.diff](/attachment/ticket/28633/28633.8.diff "View attachment")[​](/raw-attachment/ticket/28633/28633.8.diff "Download") (6.1 KB) - added by dd32 [10 years ago](/timeline?from=2015-02-16T01%3A30%3A20Z&precision=second "See timeline at 02/16/2015 01:30:20 AM").

[28633.9.diff](/attachment/ticket/28633/28633.9.diff "View attachment")[​](/raw-attachment/ticket/28633/28633.9.diff "Download") (5.8 KB) - added by dd32 [10 years ago](/timeline?from=2015-02-16T07%3A09%3A07Z&precision=second "See timeline at 02/16/2015 07:09:07 AM").

[28633.10.patch](/attachment/ticket/28633/28633.10.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.10.patch "Download") (33.9 KB) - added by sarciszewski [9 years ago](/timeline?from=2015-09-09T21%3A54%3A47Z&precision=second "See timeline at 09/09/2015 09:54:47 PM").

Use paragonie/random\_compat

[28633.11.patch](/attachment/ticket/28633/28633.11.patch "View attachment")[​](/raw-attachment/ticket/28633/28633.11.patch "Download") (34.1 KB) - added by sarciszewski [9 years ago](/timeline?from=2015-09-09T22%3A01%3A37Z&precision=second "See timeline at 09/09/2015 10:01:37 PM").

Return after random\_int()

[28633.diff](/attachment/ticket/28633/28633.diff "View attachment")[​](/raw-attachment/ticket/28633/28633.diff "Download") (2.5 KB) - added by dd32 [9 years ago](/timeline?from=2015-09-23T03%3A41%3A34Z&precision=second "See timeline at 09/23/2015 03:41:34 AM").

Download all attachments as: [.zip](/zip-attachment/ticket/28633/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (89)

### [#1](#comment:1) [@johnbillion](https://profiles.wordpress.org/johnbillion) [11 years](/timeline?from=2014-06-25T16%3A05%3A38Z&precision=second "See timeline at 06/25/2014 04:05:38 PM") ago

Thanks for your interest in WordPress, sarciszewski!

If your issue is a security enhancement rather than a vulnerability, then go ahead and post it here.

If you think it might be a vulnerability, or if you're not sure, then you should email your report to `security@wordpress.org` rather than posting it here.

Thank you

### [#2](#comment:2) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [11 years](/timeline?from=2014-06-25T16%3A16%3A12Z&precision=second "See timeline at 06/25/2014 04:16:12 PM") ago

Okay, SVN is giving me a headache. Here's the pull request on github. I give up on trying to figure out how to work SVN/Trac.

[​https://github.com/WordPress/WordPress/pull/84](https://github.com/WordPress/WordPress/pull/84)

Basically, this adds a wp\_secure\_rand() function that takes 1 parameter (the number of bytes desired) and returns a raw binary stream. This should be use in place of rand(), mt\_rand(), uniqid(), etc in places where the unpredictability of the output matters to security. (e.g. password resets)

I've also patched wp\_rand() to call this function internally, so that all random numbers generated by wp\_rand() benefit from this greater security. Where possible, I tried to make changes seamless to developers.

### [#3](#comment:3) [@georgestephanis](https://profiles.wordpress.org/georgestephanis) [11 years](/timeline?from=2014-06-25T16%3A25%3A00Z&precision=second "See timeline at 06/25/2014 04:25:00 PM") ago

Here's links to a git-produced patch and diff for the pull request:

[​https://github.com/WordPress/WordPress/pull/84.patch](https://github.com/WordPress/WordPress/pull/84.patch)

[​https://github.com/WordPress/WordPress/pull/84.diff](https://github.com/WordPress/WordPress/pull/84.diff)

### [#4](#comment:4) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [11 years](/timeline?from=2014-06-25T16%3A30%3A08Z&precision=second "See timeline at 06/25/2014 04:30:08 PM") ago

I apologize for the ms.php and schema.php patch being literally every line in the file. I think there's a whitespace issue somewhere. The only lines that should be changed are the ones with the string wp\_secure\_rand in my version.

### [#5](#comment:5) follow-up: [↓ 11](#comment:11) [@johnbillion](https://profiles.wordpress.org/johnbillion) [11 years](/timeline?from=2014-06-25T17%3A04%3A07Z&precision=second "See timeline at 06/25/2014 05:04:07 PM") ago

* **Keywords**
  *needs-patch* *needs-testing* added

You can get GitHub to hide whitespace changes by tacking the `w=1` parameter onto the URL: [​https://github.com/sarciszewski/WordPress/commit/22f587ea4b22ed0e4473a52832b4fbd5ecaa58c1?w=1](https://github.com/sarciszewski/WordPress/commit/22f587ea4b22ed0e4473a52832b4fbd5ecaa58c1?w=1)

Regardless, the patch will need re-doing without the whitespace changes.

### [#6](#comment:6) [@helen](https://profiles.wordpress.org/helen) [10 years](/timeline?from=2014-08-15T05%3A43%3A50Z&precision=second "See timeline at 08/15/2014 05:43:50 AM") ago

* **Version**
  changed from *trunk* to *3.9*

### [#7](#comment:7) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-09-16T13%3A31%3A01Z&precision=second "See timeline at 09/16/2014 01:31:01 PM") ago

* **Severity**
  changed from *normal* to *major*

The patch I provided resolves CVE-2014-6412 -- I would appreciate it if this was given a second look, esp. by the security team.

### [#8](#comment:8) [@nacin](https://profiles.wordpress.org/nacin) [10 years](/timeline?from=2014-09-16T13%3A43%3A16Z&precision=second "See timeline at 09/16/2014 01:43:16 PM") ago

I'm just seeing this. If you've requested a CVE identifier, I'm thinking *maybe* this should have been reported privately.

[​http://make.wordpress.org/core/handbook/reporting-security-vulnerabilities/](http://make.wordpress.org/core/handbook/reporting-security-vulnerabilities/)

### [#9](#comment:9) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-09-16T18%3A34%3A21Z&precision=second "See timeline at 09/16/2014 06:34:21 PM") ago

I requested a CVE identifier this week, the patch was submitted in June. I've reported the avenue to exploitation to your security team.

The actual exploitation (which I will not discuss publicly) is not trivial, and I don't expect most script kiddies are capable of doing so.

EDIT: The reason is, I didn't realize until this past Friday how it could be leveraged to abuse a WordPress installation. While I understand that security holes are sensitive matters, the fact remains you had the patch for months and nobody did anything with it.

Last edited [10 years ago](/timeline?from=2014-09-16T18%3A39%3A22Z&precision=second "See timeline at 09/16/2014 06:39:22 PM")
by sarciszewski
([previous](/ticket/28633?cversion=1&cnum_hist=9#comment:9))
([diff](/ticket/28633?action=comment-diff&cnum=9&version=2))

### [#10](#comment:10) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-09-16T19%3A17%3A43Z&precision=second "See timeline at 09/16/2014 07:17:43 PM") ago

As a follow-up, I feel that I should mention that I don't intend on dropping exploit code on Full Disclosure or anything reckless like that. If the patch I provided isn't sufficient for you, feel free to take your time to fix the problem and make sure the fix is correct. Just, please, keep me updated on where everyone is.

### [#11](#comment:11) in reply to: [↑ 5](#comment:5) ; follow-up: [↓ 12](#comment:12) [@SergeyBiryukov](https://profiles.wordpress.org/sergeybiryukov) [10 years](/timeline?from=2014-09-16T19%3A56%3A47Z&precision=second "See timeline at 09/16/2014 07:56:47 PM") ago

Replying to [johnbillion](/ticket/28633#comment:5 "Comment 5"):

> Regardless, the patch will need re-doing without the whitespace changes.

I think line ending format difference is the issue.

### [#12](#comment:12) in reply to: [↑ 11](#comment:11) ; follow-up: [↓ 13](#comment:13) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-09-16T20%3A58%3A08Z&precision=second "See timeline at 09/16/2014 08:58:08 PM") ago

Replying to [SergeyBiryukov](/ticket/28633#comment:11 "Comment 11"):

> Replying to [johnbillion](/ticket/28633#comment:5 "Comment 5"):
>
>
> > Regardless, the patch will need re-doing without the whitespace changes.
>
> I think line ending format difference is the issue.

If the github repo were authoritative, patching this would be a lot smoother on my end. But I don't have the time or patience to learn SVN right now.

### [#13](#comment:13) in reply to: [↑ 12](#comment:12) [@SergeyBiryukov](https://profiles.wordpress.org/sergeybiryukov) [10 years](/timeline?from=2014-09-16T21%3A02%3A21Z&precision=second "See timeline at 09/16/2014 09:02:21 PM") ago

Replying to [sarciszewski](/ticket/28633#comment:12 "Comment 12"):

> If the github repo were authoritative, patching this would be a lot smoother on my end. But I don't have the time or patience to learn SVN right now.

This might help:

[​http://scribu.net/wordpress/svn-patches-from-git.html](http://scribu.net/wordpress/svn-patches-from-git.html)

[​http://scribu.net/wordpress/contributing-to-wordpress-using-github.html](http://scribu.net/wordpress/contributing-to-wordpress-using-github.html)

### [#14](#comment:14) [@nacin](https://profiles.wordpress.org/nacin) [10 years](/timeline?from=2014-09-16T21%3A06%3A16Z&precision=second "See timeline at 09/16/2014 09:06:16 PM") ago

This is now being handled by the security team and with sarciszewski privately. No need for further conversations here, thanks.

### [#15](#comment:15) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-11-19T21%3A13%3A43Z&precision=second "See timeline at 11/19/2014 09:13:43 PM") ago

* **Keywords**
  *needs-patch* removed

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-11-19T21%3A15%3A10Z&precision=second "See timeline at 11/19/2014 09:15:10 PM") ago

* **Attachment**
  [*28633.patch*](/attachment/ticket/28633/28633.patch)[​](/raw-attachment/ticket/28633/28633.patch "Download")
  added

Bugfix

### [#16](#comment:16) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-11-20T23%3A06%3A14Z&precision=second "See timeline at 11/20/2014 11:06:14 PM") ago

* **Keywords**
  *has-patch* added

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-12-07T21%3A07%3A25Z&precision=second "See timeline at 12/07/2014 09:07:25 PM") ago

* **Attachment**
  [*28633.2.patch*](/attachment/ticket/28633/28633.2.patch)[​](/raw-attachment/ticket/28633/28633.2.patch "Download")
  added

Updated patch

### [#17](#comment:17) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-12-07T21%3A10%3A46Z&precision=second "See timeline at 12/07/2014 09:10:46 PM") ago

Current patch does the following:

* Adds functions:
  + `wp_random_bytes(int $number)`
  + `wp_random_positive_int()`
  + `wp_secure_rand(int $min, int $max)`
* Does not patch `wp_rand()` like the previous patch did.
* Updates `wp_generate_password()` to use `wp_secure_rand()` instead.
* Adds a unit test in `tests/phpunit/tests/functions.php`

I'd like to request this gets bumped up for evaluation in 4.1 or 4.1.1

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by sarciszewski. [​View the logs](https://wordpress.slack.com/archives/core/p1418138460000259).* [10 years](/timeline?from=2014-12-09T15%3A21%3A03Z&precision=second "See timeline at 12/09/2014 03:21:03 PM") ago

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-12-10T14%3A09%3A46Z&precision=second "See timeline at 12/10/2014 02:09:46 PM") ago

* **Attachment**
  [*28633.3.patch*](/attachment/ticket/28633/28633.3.patch)[​](/raw-attachment/ticket/28633/28633.3.patch "Download")
  added

Now with Windows + 5.2 support

### [#19](#comment:19) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2014-12-10T14%3A11%3A43Z&precision=second "See timeline at 12/10/2014 02:11:43 PM") ago

The latest patch should now work on incredibly ancient versions of Windows. (a.k.a. 5.2)

`x` Supports unsupported PHP versions

`x` Has unit tests

This should now be fully compatible with your requirements.

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by sarciszewski. [​View the logs](https://wordpress.slack.com/archives/core/p1418220933000455).* [10 years](/timeline?from=2014-12-10T14%3A15%3A35Z&precision=second "See timeline at 12/10/2014 02:15:35 PM") ago

### [#21](#comment:21) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-10T17%3A02%3A19Z&precision=second "See timeline at 02/10/2015 05:02:19 PM") ago

* **Version**
  changed from *3.9* to *trunk*

Head's up, sent this to Full Disclosure.

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by sarciszewski. [​View the logs](https://wordpress.slack.com/archives/core/p1423601929003385).* [10 years](/timeline?from=2015-02-10T20%3A58%3A52Z&precision=second "See timeline at 02/10/2015 08:58:52 PM") ago

### [#23](#comment:23) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-12T15%3A43%3A07Z&precision=second "See timeline at 02/12/2015 03:43:07 PM") ago

From CodeIgniter 3.0-dev:

`is_php('5.4') && stream_set_chunk_size($fp, $length);`

I think this can resolve the issue Stefan Esser pointed to.

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-12T16%3A09%3A41Z&precision=second "See timeline at 02/12/2015 04:09:41 PM") ago

* **Attachment**
  [*28633.4.patch*](/attachment/ticket/28633/28633.4.patch)[​](/raw-attachment/ticket/28633/28633.4.patch "Download")
  added

Edited the patch file manually because ​git://develop.git.wordpress.org is not working atm

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by sarciszewski. [​View the logs](https://wordpress.slack.com/archives/core/p1423760446004162).* [10 years](/timeline?from=2015-02-12T17%3A00%3A50Z&precision=second "See timeline at 02/12/2015 05:00:50 PM") ago

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-12T18%3A23%3A11Z&precision=second "See timeline at 02/12/2015 06:23:11 PM") ago

* **Attachment**
  [*28633.5.patch*](/attachment/ticket/28633/28633.5.patch)[​](/raw-attachment/ticket/28633/28633.5.patch "Download")
  added

Figured the git problem out, previous patch didn't work, so I remade it.

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-12T18%3A36%3A25Z&precision=second "See timeline at 02/12/2015 06:36:25 PM") ago

* **Attachment**
  [*28633\_alt.patch*](/attachment/ticket/28633/28633_alt.patch)[​](/raw-attachment/ticket/28633/28633_alt.patch "Download")
  added

Alternative, based on [​https://github.com/resonantcore/lib/blob/develop/src/Secure.php](https://github.com/resonantcore/lib/blob/develop/src/Secure.php) which I have tested extensively.

### [#25](#comment:25) [@nacin](https://profiles.wordpress.org/nacin) [10 years](/timeline?from=2015-02-13T01%3A24%3A12Z&precision=second "See timeline at 02/13/2015 01:24:12 AM") ago

This coming in as a public bug report immediately triggered alarm bells. When this happens, and it does sometimes, the security team mobilizes to see whether the report is indeed a vulnerability. It was pretty quickly determined that while there may be *something* that could be improved here, there was no smoking gun here. At some point, @sarciszewski started emailing me directly, rather than the security team or by posting here. I never saw these due to aggressive email filters. I get a lot of email and don't have time to read lower priority stuff in a timely manner; there's a reason why it's a security team and not a nacin team.

@sarciszewski then posted this to FD: [​http://seclists.org/fulldisclosure/2015/Feb/42](http://seclists.org/fulldisclosure/2015/Feb/42). I'm paraphrasing an old movie here: it's not what was done, it's how it was done. I deal with a lot of tiring stuff every day, and the tone wasn't all that necessary to get the results he wanted. If he really does think WordPress has a critical issue, then the facts would ideally speak for themselves. I sent a tweet in reply to @sarciszewski that vaguely tried to convey my feelings about the tone (not content). That then resulted in a lot of random people replying at me in shall we say less than complimentary ways, because they found the tweet through Reddit, so I deleted it. It's archived on Reddit if you wish to read it.

Like many complicated security-related issues in WordPress, the original code here was written far before I got involved on the project. Someone else mentioned on Reddit some previous circumstances where I ended up somehow being the public face for WordPress.com delivering their cookies in the clear (1), and also WordPress not having user cookies backed by a server-side session (2). For the first part, yeah, it was a bug, and they addressed all aspects of it in under a week. (Also note, I don't work at Automattic or at WordPress.com, and never have.) That second part is a known issue going back to the b2/cafelog project WordPress was forked from 12 years ago. It wasn't something that could be changed overnight. Everyone of course knew it was an issue. Once it became clear we did have a viable and performant solution for it, we shipped it.

There was a reason WordPress cookies only last for 14 days even when "Remember me" is checked, and why of course we enforce cookie expiration times as part of our auth cookie hash. Now that we have sessions, it's perhaps time to extend that beyond 14 days, but with most sites not having SSL, that's still not exactly ideal either. Security and usability always have a tradeoff. And, hey, look, I sure as hell didn't write it that way more than a decade ago.

In the course of my research on this CSPRNG bug report, I found that the original code here was written in 2008 in response to a report by Stefan Esser, a well-known security researcher who is intimately familiar with PHP, and has reported a few issues to us over the years. I couldn't locate any conversations on our end, but I did some research and was comfortable with the solution we had as a result of that work, as hacky as it was. Some of Stefan's comments on Twitter have supported that sentiment, though I've asked more specifically whether he also thinks that's true.

For the record: I think it would be nice to make an adjustment here. This is precisely the kind of security debate that a maintainer loves to see happen out in the open, in a healthy and positive manner, because it only means the software will get better.

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-13T02%3A08%3A43Z&precision=second "See timeline at 02/13/2015 02:08:43 AM") ago

* **Attachment**
  [*28633.6.patch*](/attachment/ticket/28633/28633.6.patch)[​](/raw-attachment/ticket/28633/28633.6.patch "Download")
  added

More paranoid return checking, use a binary-safe strlen() and substr()

### [#26](#comment:26) [@jeremyfelt](https://profiles.wordpress.org/jeremyfelt) [10 years](/timeline?from=2015-02-13T02%3A12%3A53Z&precision=second "See timeline at 02/13/2015 02:12:53 AM") ago

In `schema.php`, `$hostname = substr( md5( time() ), 0, 6 ) . '.' . $domain; // Very random hostname!` is used as a random enough hostname only to check that wildcard DNS is supported for subdomain multisite installs. We can leave it out of any improvements.

### [#27](#comment:27) follow-up: [↓ 28](#comment:28) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-13T02%3A18%3A27Z&precision=second "See timeline at 02/13/2015 02:18:27 AM") ago

> We can leave it out of any improvements.

I disagree strongly for one simple reason: Some developers can and will refer to the WordPress core as a source of authority and inspiration. If we expose an insecure method as "very random", it may lead to bad habits propagating into the next generation.

I learned how to use MySQL from PHP by reading the source code in nulled copies of Invision Power Board circa 2002.

### [#28](#comment:28) in reply to: [↑ 27](#comment:27) [@jeremyfelt](https://profiles.wordpress.org/jeremyfelt) [10 years](/timeline?from=2015-02-13T02%3A27%3A08Z&precision=second "See timeline at 02/13/2015 02:27:08 AM") ago

Replying to [sarciszewski](/ticket/28633#comment:27 "Comment 27"):

> If we expose an insecure method as "very random", it may lead to bad habits propagating into the next generation.
>
>
> I learned how to use MySQL from PHP by reading the source code in nulled copies of Invision Power Board circa 2002.

Absolutely. Improved documentation to clarify code is always good. The "very random" in this case is—or I read it as— tongue in cheek in the context of the surrounding code, though it could be updated.

The `md5()` approach itself doesn't really need to be made more complex as security is not a factor here.

### [#29](#comment:29) follow-up: [↓ 30](#comment:30) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-13T02%3A53%3A04Z&precision=second "See timeline at 02/13/2015 02:53:04 AM") ago

> The `md5()` approach itself doesn't really need to be made more complex as security is not a factor here.

Are you saying to revert it, or "since you made it secure random anyway, leave it, but it wasn't necessary"?

Taking 3 random bytes and converting it to hex is actually simpler than taking a cryptographic hash of the current time, then grabbing the first 6 hexits from it, since the secure random is abstracted away.

Last edited [10 years ago](/timeline?from=2015-02-13T02%3A53%3A57Z&precision=second "See timeline at 02/13/2015 02:53:57 AM")
by sarciszewski
([previous](/ticket/28633?cversion=0&cnum_hist=29#comment:29))
([diff](/ticket/28633?action=comment-diff&cnum=29&version=1))

### [#30](#comment:30) in reply to: [↑ 29](#comment:29) [@jeremyfelt](https://profiles.wordpress.org/jeremyfelt) [10 years](/timeline?from=2015-02-13T07%3A19%3A50Z&precision=second "See timeline at 02/13/2015 07:19:50 AM") ago

Replying to [sarciszewski](/ticket/28633#comment:29 "Comment 29"):

> Are you saying to revert it, or "since you made it secure random anyway, leave it, but it wasn't necessary"?

Let's leave it out of any patch on this ticket. We can address any simplification or documentation of that segment elsewhere.

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by sarciszewski. [​View the logs](https://wordpress.slack.com/archives/core/p1423852059004527).* [10 years](/timeline?from=2015-02-13T18%3A27%3A41Z&precision=second "See timeline at 02/13/2015 06:27:41 PM") ago

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-14T00%3A54%3A31Z&precision=second "See timeline at 02/14/2015 12:54:31 AM") ago

* **Attachment**
  [*28633\_with\_md5.patch*](/attachment/ticket/28633/28633_with_md5.patch)[​](/raw-attachment/ticket/28633/28633_with_md5.patch "Download")
  added

Same as previous patch but without replacing the md5(time()) hack

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by sarciszewski. [​View the logs](https://wordpress.slack.com/archives/core/p1423875298004565).* [10 years](/timeline?from=2015-02-14T00%3A55%3A00Z&precision=second "See timeline at 02/14/2015 12:55:00 AM") ago

### [@yantchi](https://profiles.wordpress.org/yantchi) [10 years](/timeline?from=2015-02-14T13%3A29%3A51Z&precision=second "See timeline at 02/14/2015 01:29:51 PM") ago

* **Attachment**
  [*28633.6.1.patch*](/attachment/ticket/28633/28633.6.1.patch)[​](/raw-attachment/ticket/28633/28633.6.1.patch "Download")
  added

Patch 28633.6 with fixed syntax errors (few missed closing parentheses and try-catch syntax)

### [#33](#comment:33) [@Otto42](https://profiles.wordpress.org/otto42) [10 years](/timeline?from=2015-02-14T19%3A55%3A42Z&precision=second "See timeline at 02/14/2015 07:55:42 PM") ago

I think you might need a php version check on the `if (function_exists('mcrypt_create_iv'))` line as well. On a Windows machine running 5.2.x, where the mcrypt extension is also enabled, a call made using `MCRYPT_DEV_URANDOM` will cause a "Cannot open source device" warning. This warning will prevent logins if display\_errors is enabled (which it sadly is by default on most hosts).

Alternatively, error suppression by using `@mcrypt_create_iv()` would probably work just as well.

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-14T22%3A44%3A47Z&precision=second "See timeline at 02/14/2015 10:44:47 PM") ago

* **Attachment**
  [*28633.7.patch*](/attachment/ticket/28633/28633.7.patch)[​](/raw-attachment/ticket/28633/28633.7.patch "Download")
  added

@Otto42 - You're absolutely correct. Also, there's a bug in mcrypt on Windows for PHP < 5.3.7 where it always produces insufficient entropy.

### [#34](#comment:34) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-14T22%3A45%3A21Z&precision=second "See timeline at 02/14/2015 10:45:21 PM") ago

@yantchi - Thanks for catching those, I don't know what I was thinking :)

### [@dd32](https://profiles.wordpress.org/dd32) [10 years](/timeline?from=2015-02-16T01%3A30%3A20Z&precision=second "See timeline at 02/16/2015 01:30:20 AM") ago

* **Attachment**
  [*28633.8.diff*](/attachment/ticket/28633/28633.8.diff)[​](/raw-attachment/ticket/28633/28633.8.diff "Download")
  added

### [#35](#comment:35) [@dd32](https://profiles.wordpress.org/dd32) [10 years](/timeline?from=2015-02-16T02%3A17%3A10Z&precision=second "See timeline at 02/16/2015 02:17:10 AM") ago

I've spent some time looking into this, and as a hardening-only patch, this seems like it's going in a good direction. I'm approaching this explicitly as a hardening-only patch as I believe `wp_rand()` we have in WordPress is already safe from prediction (and related) attacks, but that it was also written when the latest version of PHP available was 5.2.8, so did not have most of these available to it.

Here's a rundown of the currently available sources that we can use:

* Mcrypt
  + If the extension is available
  + PHP 5.3.7+ only for Windows (uses native Crypto Library)
* /dev/urandom
  + If \*nix and readable
  + may eat entropy in PHP < 5.3.3 (as it'll use read-ahead buffering)
  + not available on Windows
* OpenSSL
  + If the extension available
  + PHP 5.3.4+ only for Windows, as it's interactive-display random seed uses lots of processing time (30-60s+) on a non-interactive screen
  + Uses Windows native Crypto API in PHP 5.4+ (might be a better minimum for windows)
  + May use a non-strong crypto source on some "rare" systems (see `$crypto_strong` param)
  + Also worth noting OpenSSL has a myriad of random generators, I believe at least one of these leverages `/dev/random` (or urandom/srandom) on supported platforms, but I'm unable to determine what platforms/OpenSSL versions at a glance
* Windows specific: CAPICOM
  + Deprecated; For Windows 2008 and lower (XP, Visa, 7, 2003, 2008)
  + Available when the optional package is installed
  + Haven't tested this, seems like it can have permissions issues
* Windows specific: DOTNET API
  + Supported in Windows 2008 R2 and greater with .NET 1.0 or greater bindings enabled
  + Haven't tested this, seems like it can have permissions issues
  + Reports of it not working reliably at all in PHP due to incompatible types

It seems that randomness support on Windows servers is not-great in older versions of PHP, and we should potentially ditch windows-specific external API's and leverage OpenSSL/Mcrypt instead as they work reliably with the native Windows crypto API's in PHP 5.3.7/5.4+.

The simple approach we can take here, assuming that our existing `wp_rand()` is not insecure, is to simply beef up `wp_rand()` to leverage these alternative random sources when available.

This also leads me to questioning if we should support `/dev/urandom` which although is available on many hosting environments, is also less and less useful as OpenSSL or Mcrypt are available on more installs. Although i'm not sure of the penetration of Mcrypt, OpenSSL is very commonly supported. The code to use `urandom` is lightweight and straight-forward however, so I don't see a significant reason not to include it.

So, I've attached two patches

* [28633.8.diff](/attachment/ticket/28633/28633.8.diff "Attachment '28633.8.diff' in Ticket #28633")[​](/raw-attachment/ticket/28633/28633.8.diff "Download") This is my WIP patch against the ones suggested here and was based off of [28633\_with\_md5.patch](/attachment/ticket/28633/28633_with_md5.patch "Attachment '28633_with_md5.patch' in Ticket #28633")[​](/raw-attachment/ticket/28633/28633_with_md5.patch "Download")
  + PHP syntax issues corrected
  + Windows version checks added
  + uses our `mbstring_binary_safe_encoding()` function to avoid the need for `wp_binsafe_strlen()`
  + rewrites the urandom handling in `wp_random_bytes()` to be more explicit and cleaner
  + fixes `wp_secure_rand()` to return inclusive values between `$min` and `$max` while making the code easier to read (It can also now handle `wp_secure_rand(1, 2)` which it couldn't previously)
  + a bunch of other formatting and code cleanliness issues
* [28633.9.diff](/attachment/ticket/28633/28633.9.diff "Attachment '28633.9.diff' in Ticket #28633")[​](/raw-attachment/ticket/28633/28633.9.diff "Download") however is an initial rewrite into what I think we should aim for
  + it renames the functions (although I'm really not sold on the names I've chosen at all, just wanted to remove the secure keyword)
  + moves towards ditching `wp_secure_rand()` and simply having `wp_rand()`
  + Drops the Windows-specific branches but leaves urandom in play.
  + In this scenario these functions would live elsewhere, i'm just including them in this file for ease of patch comparison

Thoughts? Suggestions?

### [@dd32](https://profiles.wordpress.org/dd32) [10 years](/timeline?from=2015-02-16T07%3A09%3A07Z&precision=second "See timeline at 02/16/2015 07:09:07 AM") ago

* **Attachment**
  [*28633.9.diff*](/attachment/ticket/28633/28633.9.diff)[​](/raw-attachment/ticket/28633/28633.9.diff "Download")
  added

### [#36](#comment:36) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-02-16T17%3A02%3A39Z&precision=second "See timeline at 02/16/2015 05:02:39 PM") ago

I am rather fond of 28633.9.diff personally. Avoiding `wp_binsafe_strlen()` is a good idea too :)

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by sarciszewski. [​View the logs](https://wordpress.slack.com/archives/core/p1425055410000350).* [10 years](/timeline?from=2015-02-27T16%3A43%3A32Z&precision=second "See timeline at 02/27/2015 04:43:32 PM") ago

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by sarciszewski. [​View the logs](https://wordpress.slack.com/archives/core/p1426859360006230).* [10 years](/timeline?from=2015-03-20T13%3A49%3A22Z&precision=second "See timeline at 03/20/2015 01:49:22 PM") ago

### [#39](#comment:39) [@masakielastic](https://profiles.wordpress.org/masakielastic) [10 years](/timeline?from=2015-03-21T23%3A19%3A18Z&precision=second "See timeline at 03/21/2015 11:19:18 PM") ago

It is probable that `random_bytes` and `random_int` will be introduced in PHP 7.0. The vote will be finished at March 28th.

[​https://wiki.php.net/rfc/easy\_userland\_csprng](https://wiki.php.net/rfc/easy_userland_csprng)

### [#40](#comment:40) [@dd32](https://profiles.wordpress.org/dd32) [10 years](/timeline?from=2015-03-22T23%3A33%3A46Z&precision=second "See timeline at 03/22/2015 11:33:46 PM") ago

* **Keywords**
  *early* added
* **Milestone**
  changed from *Awaiting Review* to *Future Release*
* **Severity**
  changed from *major* to *normal*

I'd prefer to land these changes at the start of a cycle, to allow for full testing by everyone and to surface any issues from reliance upon any of the functions.

Based on the PHP7 RFC, which looks like it'll succeed, we should change the direction of the patch to simply provide a compat layer for the PHP7 function signatures instead, which will benefit us in the long term.

The changes:

* `wp_external_random_bytes()` -> `random_bytes()` not sure if the byte length changes, or if it's a required param..
* `wp_external_rand()` -> `random_int()` which also needs to support negative numbers, ie. `random_int( -1000, -10 )` should work.
* `wp_external_random_positive_int()` becomes an internal private function, only defined when the wrapper for random\_int is, however it might not even be needed based on the negative number support for `random_int()`

### [#41](#comment:41) [@iseulde](https://profiles.wordpress.org/iseulde) [10 years](/timeline?from=2015-04-07T01%3A32%3A50Z&precision=second "See timeline at 04/07/2015 01:32:50 AM") ago

* **Version**
  *trunk* deleted

### [#42](#comment:42) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-04-07T01%3A42%3A15Z&precision=second "See timeline at 04/07/2015 01:42:15 AM") ago

`wp_external_random_positive_int()` is there to generate a random number along a range. If you use bitshifting to get `0..1023` then add the minimum (`-1000`), that should be suitable for `(-1000, -10)`.

(The result from `wp_external_random_positive_int()` will be discarded if it exceeds `990` in that case, and it will start over.)

Last edited [10 years ago](/timeline?from=2015-04-07T01%3A43%3A26Z&precision=second "See timeline at 04/07/2015 01:43:26 AM")
by sarciszewski
([previous](/ticket/28633?cversion=1&cnum_hist=42#comment:42))
([diff](/ticket/28633?action=comment-diff&cnum=42&version=2))

### [#43](#comment:43) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [10 years](/timeline?from=2015-07-08T05%3A42%3A07Z&precision=second "See timeline at 07/08/2015 05:42:07 AM") ago

Hey, it's been a while.

I see that this still hasn't gotten merged. This might be a good thing.

I've put together a polyfill library for PHP7's `random_int()` and `random_bytes()` functions for PHP 5.x projects and (with WordPress in mind) I kept PHP 5.2 compatibility.

[​https://github.com/paragonie/random\_compat](https://github.com/paragonie/random_compat)

@dd32 If you would prefer to use an external library and have `wp_external_random_bytes()` just invoke it rather than try to manage this internally, that might make upgrading/patching any bugs that crop up in the future more sane. "Upgrade random\_compat to 1.0.1" is probably an easier change to audit than a comprehensive rewrite of core functions.

### [#44](#comment:44) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [9 years](/timeline?from=2015-09-04T19%3A26%3A08Z&precision=second "See timeline at 09/04/2015 07:26:08 PM") ago

@dd32 random\_compat should see a 1.0.0 release this weekend.

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by miss\_jwo. [​View the logs](https://wordpress.slack.com/archives/core/p1441452401003222).* [9 years](/timeline?from=2015-09-05T11%3A26%3A43Z&precision=second "See timeline at 09/05/2015 11:26:43 AM") ago

### [#46](#comment:46) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-09-06T23%3A44%3A08Z&precision=second "See timeline at 09/06/2015 11:44:08 PM") ago

* **Milestone**
  changed from *Future Release* to *4.4*
* **Owner**
  set to *dd32*
* **Status**
  changed from *new* to *reviewing*

I'm marking for 4.4 for review purposes. I'll go through the libraries code and see if there's going to be any issues - at first glance It all looks pretty straight forward and compatible, so shouldn't be an issue.

### [#47](#comment:47) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [9 years](/timeline?from=2015-09-07T01%3A58%3A14Z&precision=second "See timeline at 09/07/2015 01:58:14 AM") ago

Sounds great! v1.0.0 has been tagged and released. Additionally, it should work all the way back on 5.2.4 on Windows without ext/mcrypt. :)

[​https://github.com/paragonie/random\_compat/releases/tag/v1.0.0](https://github.com/paragonie/random_compat/releases/tag/v1.0.0)

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by sarciszewski. [​View the logs](https://wordpress.slack.com/archives/core/p1441831900000483).* [9 years](/timeline?from=2015-09-09T20%3A51%3A42Z&precision=second "See timeline at 09/09/2015 08:51:42 PM") ago

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [9 years](/timeline?from=2015-09-09T21%3A54%3A47Z&precision=second "See timeline at 09/09/2015 09:54:47 PM") ago

* **Attachment**
  [*28633.10.patch*](/attachment/ticket/28633/28633.10.patch)[​](/raw-attachment/ticket/28633/28633.10.patch "Download")
  added

Use paragonie/random\_compat

### [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [9 years](/timeline?from=2015-09-09T22%3A01%3A37Z&precision=second "See timeline at 09/09/2015 10:01:37 PM") ago

* **Attachment**
  [*28633.11.patch*](/attachment/ticket/28633/28633.11.patch)[​](/raw-attachment/ticket/28633/28633.11.patch "Download")
  added

Return after random\_int()

### [#49](#comment:49) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-09-14T05%3A36%3A48Z&precision=second "See timeline at 09/14/2015 05:36:48 AM") ago

Fun facts: `wp_rand()` only returns positive numbers (no matter the input), and it also doesn't care about the order of `$min` and `$max`.

@sarciszewski Since PHP's implementation of `random_int()` has changed in the last few days since PHP7-RC2 was released (They've switched from PHP warnings to Exceptions, which your compat library deals with), I'd like to test this against PHP7-RC3 which is due to be released at the end of the week. I'm having a hard time comparing the compat library and PHP7's behaviours to ensure we don't have any issues at release time.

### [#50](#comment:50) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [9 years](/timeline?from=2015-09-14T11%3A15%3A03Z&precision=second "See timeline at 09/14/2015 11:15:03 AM") ago

Testing versus RC3 makes sense to me.

### [#51](#comment:51) [@helen](https://profiles.wordpress.org/helen) [9 years](/timeline?from=2015-09-17T21%3A29%3A14Z&precision=second "See timeline at 09/17/2015 09:29:14 PM") ago

Just a note that RC3 is out now if somebody would like to test, so we don't lose momentum here. :)

### [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-09-23T03%3A41%3A34Z&precision=second "See timeline at 09/23/2015 03:41:34 AM") ago

* **Attachment**
  [*28633.diff*](/attachment/ticket/28633/28633.diff)[​](/raw-attachment/ticket/28633/28633.diff "Download")
  added

### [#52](#comment:52) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-09-23T03%3A48%3A35Z&precision=second "See timeline at 09/23/2015 03:48:35 AM") ago

[28633.diff](/attachment/ticket/28633/28633.diff "Attachment '28633.diff' in Ticket #28633")[​](/raw-attachment/ticket/28633/28633.diff "Download") is tested against PHP 5.6 & PHP7-RC3 (This patch doesn't include the random\_compat library itself though, for easier review)

A few things to note

* `wp_rand()` always returns positive numbers, even if a negative range is offered
* `wp_rand()` accepts the parameters in either order
* streamlined the `try {} catch {} catch {}` to avoid needing to use version comparisons

The only issue I noted in the compat library, is that PHP7's `random_int()` claims to accept Integers, but accepts numeric types (floats/numeric strings) happily, and it appears that `wp_rand()` probably does too. *edit: this is patched in [​https://github.com/paragonie/random\_compat/pull/36](https://github.com/paragonie/random_compat/pull/36)*

I was delayed in testing this thanks to conferences & the PHP7 packages being delayed (I'm testing using [​Webtatic PHP7 packages](https://webtatic.com/news/tag/php/) for Centos/RHEL 6 (In case anyone wants to also verify my experience)

Last edited [9 years ago](/timeline?from=2015-09-23T04%3A14%3A15Z&precision=second "See timeline at 09/23/2015 04:14:15 AM")
by dd32
([previous](/ticket/28633?cversion=0&cnum_hist=52#comment:52))
([diff](/ticket/28633?action=comment-diff&cnum=52&version=1))

### [#53](#comment:53) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [9 years](/timeline?from=2015-09-23T03%3A59%3A22Z&precision=second "See timeline at 09/23/2015 03:59:22 AM") ago

Should it return `abs( $val );` or `absint( $val );`?

Your patch for random\_compat makes sense. I can't believe I overlooked that. As soon as you're ready, I'll merge it and tag version 1.0.2, which is what I'd propose to be included in WP 4.4.

Thanks a ton, Dion.

### [#54](#comment:54) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-09-23T04%3A17%3A57Z&precision=second "See timeline at 09/23/2015 04:17:57 AM") ago

> Should it return abs( $val ); or absint( $val );?

Since `random_int()` should be returning an int already, they're mostly the same, however for consistency you're right, we should use `absval()`.

> Your patch for random\_compat makes sense. I can't believe I overlooked that. As soon as you're ready, I'll merge it and tag version 1.0.2, which is what I'd propose to be included in WP 4.4.

Thanks for the super-fast merge! I couldn't find any other edge-cases in my testing, so a pretty good job :) The PHP7-style exception handlers seem solid too.

### [#55](#comment:55) [@jorbin](https://profiles.wordpress.org/jorbin) [9 years](/timeline?from=2015-09-23T04%3A33%3A58Z&precision=second "See timeline at 09/23/2015 04:33:58 AM") ago

One minor thing at a glance is that there is no reference in src/wp-includes/compat.php to the version of PHP that random\_int is introduced. I think it makes sense to include a reference so that years in the future, when this compat library is no longer needed, it can be removed.

### [#56](#comment:56) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [9 years](/timeline?from=2015-09-23T04%3A40%3A24Z&precision=second "See timeline at 09/23/2015 04:40:24 AM") ago

That's a good point. Who knows when 5.6 will stop being supported by WP? I for one might be long gone when hosting companies finally get their act together and stay up-to-date.

Last edited [9 years ago](/timeline?from=2015-09-23T04%3A40%3A43Z&precision=second "See timeline at 09/23/2015 04:40:43 AM")
by sarciszewski
([previous](/ticket/28633?cversion=0&cnum_hist=56#comment:56))
([diff](/ticket/28633?action=comment-diff&cnum=56&version=1))

### [#57](#comment:57) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-01T02%3A40%3A02Z&precision=second "See timeline at 10/01/2015 02:40:02 AM") ago

After asking for more reviews of the code here, the only issue that's been raised, is the following use-case:

```
$val = wp_rand(); // (int) 0

```

This is because `$min` and `$max` are `0` by default, so.. it makes sense, but `wp_rand()` decides that this should instead be interpreted as a maximum of `4294967295`. I think we can/should just use `4294967295` when `$max = 0`

### [#58](#comment:58) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-08T00%3A01%3A26Z&precision=second "See timeline at 10/08/2015 12:01:26 AM") ago

In [34922](/changeset/34922 "Use PHP7's `random_int()` CSPRNG functionality in `wp_rand()` with a ..."):

Use PHP7's `random_int()` CSPRNG functionality in `wp_rand()` with a fallback to the `random_compat` library for PHP 5.x.

`random_compat` offers a set of compatible functions for older versions of PHP, filling in the gap by using other PHP extensions when available.

We still include our existing `wp_rand()` functionality as a fallback for when no proper CSPRNG exists on the system.

Props sarciszewski

See [#28633](/ticket/28633 "#28633: enhancement: Generate better random numbers (closed: fixed)")

### [#59](#comment:59) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-08T00%3A05%3A16Z&precision=second "See timeline at 10/08/2015 12:05:16 AM") ago

Lets see if anything breaks :)

A few thoughts:

* I've used `$max_random_number` which is a 32bit maximum, 64bit systems can achieve much greater sizes. We should update the function to handle 64bit values on 64bit systems.
* I've used random\_compat `master` here, just for clarity over what's included - that is [​https://github.com/paragonie/random\_compat/commit/456d84c8823207a18fb146c29f8b9e3aa0a9a31c](https://github.com/paragonie/random_compat/commit/456d84c8823207a18fb146c29f8b9e3aa0a9a31c)
* I've included no tests here, based on that `random_compat` has it's own set of tests

### [#60](#comment:60) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-08T00%3A16%3A08Z&precision=second "See timeline at 10/08/2015 12:16:08 AM") ago

In [34924](/changeset/34924 "Revert [34922] pending PHP 5.2 compatibility.
See #28633
"):

Revert [[34922]](/changeset/34922 "Use PHP7's `random_int()` CSPRNG functionality in `wp_rand()` with a ...") pending PHP 5.2 compatibility.

See [#28633](/ticket/28633 "#28633: enhancement: Generate better random numbers (closed: fixed)")

### [#61](#comment:61) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-08T00%3A17%3A57Z&precision=second "See timeline at 10/08/2015 12:17:57 AM") ago

Unfortunately we've run into a PHP 5.2 compatibility issue:

[​https://travis-ci.org/aaronjorbin/develop.wordpress/jobs/84210246](https://travis-ci.org/aaronjorbin/develop.wordpress/jobs/84210246)

```
Fatal error: Class Error contains 1 abstract method and must therefore be declared abstract or implement the remaining methods (Throwable::getPrevious) in src/wp-includes/random_compat/error_polyfill.php on line 48

```

It looks like this was caused by [​https://github.com/paragonie/random\_compat/commit/90da7f3c0f4e92a1c44871de038e801d764ccc93](https://github.com/paragonie/random_compat/commit/90da7f3c0f4e92a1c44871de038e801d764ccc93)

I've reverted it for now as I can't debug it properly on a PHP 5.2 system right this second.

### [#62](#comment:62) [@sarciszewski](https://profiles.wordpress.org/sarciszewski) [9 years](/timeline?from=2015-10-08T12%3A57%3A58Z&precision=second "See timeline at 10/08/2015 12:57:58 PM") ago

Does this fix it? [​https://github.com/paragonie/random\_compat/commit/f667aa2000a192adfa53332335a2ae0c1cb9ea6e](https://github.com/paragonie/random_compat/commit/f667aa2000a192adfa53332335a2ae0c1cb9ea6e)

### [#63](#comment:63) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-09T02%3A09%3A42Z&precision=second "See timeline at 10/09/2015 02:09:42 AM") ago

@sarciszewski

Here's PHP parsing the committed code: [​https://3v4l.org/ei523](https://3v4l.org/ei523)

And here's PHP parsing the code with those method declarations removed: [​https://3v4l.org/Qsse1](https://3v4l.org/Qsse1)

No output is good, so it looks like removing those declarations fixes it, and is compatible with all PHP5 releases.

I'll recommit shortly with that change.

### [#64](#comment:64) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-09T04%3A27%3A42Z&precision=second "See timeline at 10/09/2015 04:27:42 AM") ago

In [34981](/changeset/34981 "Use PHP7's `random_int()` CSPRNG functionality in `wp_rand()` with a ..."):

Use PHP7's `random_int()` CSPRNG functionality in `wp_rand()` with a fallback to the `random_compat` library for PHP 5.x.

`random_compat` offers a set of compatible functions for older versions of PHP, filling in the gap by using other PHP extensions when available.

We still include our existing `wp_rand()` functionality as a fallback for when no proper CSPRNG exists on the system.

Take Two, this was previously committed in [[34922]](/changeset/34922 "Use PHP7's `random_int()` CSPRNG functionality in `wp_rand()` with a ...") but had an issue on PHP 5.2 which sarciszewski has now resolved.

Props sarciszewski

See [#28633](/ticket/28633 "#28633: enhancement: Generate better random numbers (closed: fixed)")

### [#65](#comment:65) [@SergeyBiryukov](https://profiles.wordpress.org/sergeybiryukov) [9 years](/timeline?from=2015-10-09T05%3A19%3A32Z&precision=second "See timeline at 10/09/2015 05:19:32 AM") ago

In [34986](/changeset/34986 "Fix typo in `wp_rand()` docs.

See #28633."):

Fix typo in `wp_rand()` docs.

See [#28633](/ticket/28633 "#28633: enhancement: Generate better random numbers (closed: fixed)").

### [#66](#comment:66) [@SergeyBiryukov](https://profiles.wordpress.org/sergeybiryukov) [9 years](/timeline?from=2015-10-09T20%3A42%3A20Z&precision=second "See timeline at 10/09/2015 08:42:20 PM") ago

[#25816](/ticket/25816 "#25816: enhancement: Use a CSPRNG when generating passwords (closed: duplicate)") was marked as a duplicate.

### [#67](#comment:67) [@wonderboymusic](https://profiles.wordpress.org/wonderboymusic) [9 years](/timeline?from=2015-10-20T04%3A41%3A16Z&precision=second "See timeline at 10/20/2015 04:41:16 AM") ago

* **Resolution**
  set to *fixed*
* **Status**
  changed from *reviewing* to *closed*

Calling it fixed. Reopen if the sky is falling.

### [#68](#comment:68) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-23T02%3A01%3A04Z&precision=second "See timeline at 10/23/2015 02:01:04 AM") ago

* **Resolution**
  *fixed* deleted
* **Status**
  changed from *closed* to *reopened*

### [#69](#comment:69) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-23T04%3A21%3A02Z&precision=second "See timeline at 10/23/2015 04:21:02 AM") ago

* **Resolution**
  set to *fixed*
* **Status**
  changed from *reopened* to *closed*

In [35365](/changeset/35365 "Update to Random_Compat 1.0.9.
This update includes fixes for Windows ..."):

Update to Random\_Compat 1.0.9.

This update includes fixes for Windows support & libSodium support, and removes the `Throwable` Polyfill due to PHP7 incompatibilities.

Fixes [#28633](/ticket/28633 "#28633: enhancement: Generate better random numbers (closed: fixed)")

### [#70](#comment:70) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-23T08%3A30%3A00Z&precision=second "See timeline at 10/23/2015 08:30:00 AM") ago

Followup for slow performance under windows: [#34409](/ticket/34409 "#34409: defect (bug): random_bytes() prevents me to log in if PHP is 5.3.5 (closed: fixed)") (OpenSSL times out)

### [#71](#comment:71) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-10-28T01%3A11%3A57Z&precision=second "See timeline at 10/28/2015 01:11:57 AM") ago

In [35410](/changeset/35410 "Update Random_Compat to master.
This update mostly concerns OpenSSL ..."):

Update Random\_Compat to master.

This update mostly concerns OpenSSL being unusable on PHP 5.3~5.3.3.

See [#28633](/ticket/28633 "#28633: enhancement: Generate better random numbers (closed: fixed)"), [#34409](/ticket/34409 "#34409: defect (bug): random_bytes() prevents me to log in if PHP is 5.3.5 (closed: fixed)")

### [#72](#comment:72) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-11-10T11%3A59%3A17Z&precision=second "See timeline at 11/10/2015 11:59:17 AM") ago

In [35600](/changeset/35600 "Update random_compat to master.
Clarifies strings, Merges [35587] ..."):

Update random\_compat to master.

Clarifies strings, Merges [[35587]](/changeset/35587 "Random_Compat: Bump the OpenSSL requirement for windows servers to ...") upstream.

See [#34409](/ticket/34409 "#34409: defect (bug): random_bytes() prevents me to log in if PHP is 5.3.5 (closed: fixed)"), [#28633](/ticket/28633 "#28633: enhancement: Generate better random numbers (closed: fixed)")

### [#73](#comment:73) [@dd32](https://profiles.wordpress.org/dd32) [9 years](/timeline?from=2015-11-10T11%3A59%3A46Z&precision=second "See timeline at 11/10/2015 11:59:46 AM") ago

I'm marking this as fixed. Please open new tickets for any further issues and reference them here.

### *This ticket was mentioned in [​Slack](https://make.wordpress.org/chat/) in #core by paragonie. [​View the logs](https://wordpress.slack.com/archives/core/p1484167392005087).* [8 years](/timeline?from=2017-01-11T20%3A43%3A16Z&precision=second "See timeline at 01/11/2017 08:43:16 PM") ago

**Note:** See
[TracTickets](/wiki/TracTickets) for help on using
tickets.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Comma-delimited Text](/ticket/28633?format=csv)
* [Tab-delimited Text](/ticket/28633?format=tab)
* [RSS Feed](/ticket/28633?format=rss)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from packetstormsecurity.com_9157dd6d_20250125_235639.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


