=== Content from www.openwall.com_f4247388_20250125_123119.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201402210339.s1L3dkS1000100@linus.mitre.org>
Date: Thu, 20 Feb 2014 22:39:46 -0500 (EST)
From: cve-assign@...re.org
To: carnil@...ian.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: Possible CVE Requests: several issues fixed in Jenkins (Advisory 2014-02-14)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> SECURITY-105
> | In some places, Jenkins XML API uses XStream to deserialize arbitrary
> | content, which is affected by CVE-2013-7285 reported against XStream.
> | This allows malicious users of Jenkins with a limited set of permissions
> | to execute arbitrary code inside Jenkins master.
>
> <https://github.com/jenkinsci/jenkins/commit/d030fbbaeeb5ee8980b5680b26217930834387f4>

MITRE may be making a CVE assignment for SECURITY-105, but it won't be
immediate because we need to discuss that one internally within our
team more. This is related to:

  <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-7285>

not existing yet.

> where for SECURITY-76 and SECURITY-88 CVE-2013-5573 was assigned

> SECURITY-76 & SECURITY-88 / CVE-2013-5573
> | Restrictions of HTML tags for user-editable contents are too lax. This
> | allows malicious users of Jenkins to trick other unsuspecting users into
> | providing sensitive information.
>
> <https://github.com/jenkinsci/jenkins/commit/7541e83cc9812afc2b464f0a3254a2453da53f4c>
> <https://github.com/jenkinsci/jenkins/commit/535c1115bbf07f8a57d509f2d00598d6e21870d4>

The vendor says "SECURITY-76 & SECURITY-88 / CVE-2013-5573" on that
"Jenkins Security Advisory 2014-02-14" page, but the originally
intended scope of CVE-2013-5573 is only the issue involving FORM
elements (aka SECURITY-88), not the issue involving IFRAME elements
(aka SECURITY-76). This may be just a parsing difference. We believe
it's:

   SECURITY-76 & ( SECURITY-88 / CVE-2013-5573 )

not:

   ( SECURITY-76 & SECURITY-88 ) / CVE-2013-5573

The commit that you didn't list is:

  <https://github.com/jenkinsci/jenkins/commit/788b7d7a067fad4972fefaaa527141847bfeff55>

The IFRAME issue wasn't part of the original disclosures such as
<http://www.exploit-db.com/exploits/30408/> so we normally can't change
the scope of CVE-2013-5573 to include it later.
<https://issues.jenkins-ci.org/browse/SECURITY-76> and
<https://issues.jenkins-ci.org/browse/SECURITY-88> apparently are not
public, and could possibly have clarifying information (e.g., if there
were a later finding that only FORM is exploitable, and IFRAME isn't
actually exploitable). Unless that information becomes available and
suggests a different course of action, we will proceed to assign a new
CVE-2013-#### ID for SECURITY-76 soon.

> SECURITY-55
> <https://github.com/jenkinsci/jenkins/commit/36342d71e29e0620f803a7470ce96c61761648d8>

Use CVE-2013-7330.

> SECURITY-109
> | Plugging a hole in the earlier fix to SECURITY-55. Under some
> | circumstances, a malicious user of Jenkins can configure job X to
> | trigger another job Y that the user has no access to.
>
> <https://github.com/jenkinsci/jenkins/commit/b6b2a367a7976be80a799c6a49fa6c58d778b50e>

Use CVE-2014-2058.

> SECURITY-108
> | CLI job creation had a directory traversal vulnerability. This allows a
> | malicious user of Jenkins with a limited set of permissions to overwrite
> | files in the Jenkins master and escalate privileges.
>
> <https://github.com/jenkinsci/jenkins/commit/ad38d8480f20ce3cbf8fec3e2003bc83efda4f7d>

Use CVE-2014-2059.

> SECURITY-106
> | The embedded Winstone servlet container is susceptible to session
> | hijacking attack.
>
> <https://github.com/jenkinsci/jenkins/commit/29351af4bd01f61715418916fc12c52be46bd9b0>
> (issue in jenkins-winstone?)

Use CVE-2014-2060.

> SECURITY-93
> | The password input control in the password parameter definition in the
> | Jenkins UI was serving the actual value of the password in HTML, not an
> | encrypted one. If a sensitive value is set as the default value of such
> | a parameter definition, it can be exposed to unintended audience.
>
> <https://github.com/jenkinsci/jenkins/commit/bf539198564a1108b7b71a973bf7de963a6213ef>

Use CVE-2014-2061.

> SECURITY-89
> | Deleting the user was not invalidating the API token, allowing users to
> | access Jenkins when they shouldn't be allowed to do so.
>
> <https://github.com/jenkinsci/jenkins/commit/5548b5220cfd496831b5721124189ff18fbb12a3>

Use CVE-2014-2062.

> SECURITY-80
> | Jenkins UI was vulnerable to click jacking attacks.
>
> <https://github.com/jenkinsci/jenkins/commit/16931bd7bf7560e26ef98328b8e95e803d0e90f6>

Use CVE-2014-2063.

> SECURITY-79
> | "Jenkins' own user database" was revealing the presence/absence of users
> | when login attempts fail.
>
> <https://github.com/jenkinsci/jenkins/commit/fbf96734470caba9364f04e0b77b0bae7293a1ec>

Use CVE-2014-2064.

> SECURITY-77
> | Jenkins had a cross-site scripting vulnerability in one of its cookies.
> | If Jenkins is deployed in an environment that allows an attacker to
> | override Jenkins cookies in victim's browser, this vulnerability can be
> | exploited.
>
> <https://github.com/jenkinsci/jenkins/commit/a0b00508eeb74d7033dc4100eb382df4e8fa72e7>

Use CVE-2014-2065. This is an input-validation issue but perhaps
shouldn't be categorized as a standard XSS issue because of the
unusual threat model.

> SECURITY-75
> | Jenkins was vulnerable to session fixation attack. If Jenkins is
> | deployed in an environment that allows an attacker to override Jenkins
> | cookies in victim's browser, this vulnerability can be exploited.
>
> <https://github.com/jenkinsci/jenkins/commit/8ac74c350779921598f9d5edfed39dd35de8842a>

Use CVE-2014-2066. Again, the unusual threat model might limit the practical
relevance of this.

> SECURITY-74
> | Stored XSS vulnerability. A malicious user of Jenkins with a certain set
> | of permissions can cause Jenkins to store arbitrary HTML fragment.
>
> <https://github.com/jenkinsci/jenkins/commit/5d57c855f3147bfc5e7fda9252317b428a700014>

Use CVE-2014-2067.

> SECURITY-73
> | Some of the system diagnostic functionalities were checking a lesser
> | permission than it should have. In a very limited circumstances, this
> | can cause an attacker to gain information that he shouldn't have
> | access to.
>
> <https://github.com/jenkinsci/jenkins/commit/0530a6645aac10fec005614211660e98db44b5eb>

Use CVE-2014-2068.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJTBsmDAAoJEKllVAevmvms5NkH/RDlkoZIC6ktfTQtnYRRff4E
JwTVhINZ+fQTpcag3zCivHKzUxcxFOZL1aOntywuWdPDmNVSDorpuN1JDS6nQNgj
gai7aRx+g6ngg+phyAO06oNiAU4NzZm2B84KOtoOccuZWPFw1GOPgkoOT+IyDRes
NvYUgFB9ikcl8fJHroIZr14pwPUnSbVnb1xA3pOvReCdT9HfjYxMvl0Ax6i9g6ok
QLd56C8ARKBmjfHpWCYwVj00GiUshN9jv4rv9h+QdrdRoLvah5PAvMoLY6BoojFB
XVd5dg99XRV/+J/Izz3v1ooeSllncKri48NFSHq8cbJlMxj5YKuTWU2akT/FUC8=
=aoN1
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from wiki.jenkins-ci.org_217f6902_20250125_123123.html ===


# Jenkins Security Advisory 2014-02-14

This advisory announces multiple security vulnerabilities that were found in Jenkins core.

## Description

### SECURITY-105

In some places, Jenkins XML API uses XStream to deserialize arbitrary content, which is affected by [CVE-2013-7285](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-7285) reported against XStream. This allows malicious users of Jenkins with a limited set of permissions to execute arbitrary code inside the Jenkins controller.

### SECURITY-76 & SECURITY-88 / CVE-2013-5573

Restrictions of HTML tags for user-editable contents are too lax. This allows malicious users of Jenkins to trick other unsuspecting users into providing sensitive information.

### SECURITY-109

Plugging a hole in the earlier fix to SECURITY-55. Under some circimstances, a malicious user of Jenkins can configure job X to trigger another job Y that the user has no access to.

### SECURITY-108

CLI job creation had a directory traversal vulnerability. This allows a malicious user of Jenkins with a limited set of permissions to overwrite files in the Jenkins controller and escalate privileges.

### SECURITY-106

The embedded Winstone servlet container is susceptive to session hijacking attack.

### SECURITY-93

The password input control in the password parameter definition in the Jenkins UI was serving the actual value of the password in HTML, not an encrypted one. If a sensitive value is set as the default value of such a parameter definition, it can be exposed to unintended audience.

### SECURITY-89

Deleting the user was not invalidating the API token, allowing users to access Jenkins when they shouldn’t be allowed to do so.

### SECURITY-80

Jenkins UI was vulnerable to click jacking attacks.

### SECURITY-79

"Jenkins' own user database" was revealing the presence/absence of users when login attempts fail.

### SECURITY-77

Jenkins had a cross-site scripting vulnerability in one of its cookies. If Jenkins is deployed in an environment that allows an attacker to override Jenkins cookies in victim’s browser, this vulnerability can be exploited.

### SECURITY-75

Jenkins was vulnerable to session fixation attack. If Jenkins is deployed in an environment that allows an attacker to override Jenkins cookies in victim’s browser, this vulnerability can be exploited.

### SECURITY-74

Stored XSS vulnerability. A malicious user of Jenkins with a certain set of permissions can cause Jenkins to store arbitrary HTML fragment.

### SECURITY-73

Some of the system diagnostic functionalities were checking a lesser permission than it should have. In a very limited circumstances, this can cause an attacker to gain information that he shouldn’t have access to.

## Severity

SECURITY-106, and SECURITY-80 are rated **high**. An attacker only needs direct HTTP access to the server to mount this attack.

SECURITY-105, SECURITY-109, SECURITY-108, and SECURITY-74 are rated **high**. These vulnerabilities allow attackers with valid Jenkins user accounts to escalate privileges in various ways.

SECURITY-76, SECURIT-88, and SECURITY-89 are rated **medium**. These vulnerabilities requires an attacker to be an user of Jenkins, and the mode of the attack is limited.

SECURITY-93, and SECURITY-79 are rated **low**. These vulnerabilities only affect a small part of Jenkins and has limited impact.

SECURITY-77, SECURITY-75, and SECURITY-73 are rated **low**. These vulnerabilities are hard to exploit unless combined with other exploit in the network.

## Fix

* Main line users should upgrade to Jenkins 1.551
* LTS users should upgrade to 1.532.2

All the prior versions are affected by these vulnerabilities.

## Other Resources

* [Corresponding security advisory on CloudBees regarding DEV@cloud and Jenkins Enterprise by CloudBees](https://www.cloudbees.com/jenkins-advisory/jenkins-security-advisory-2014-02-14.cb)



=== Content from github.com_05b04ea5_20250126_083055.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjenkinsci%2Fjenkins%2Fcommit%2Fb6b2a367a7976be80a799c6a49fa6c58d778b50e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjenkinsci%2Fjenkins%2Fcommit%2Fb6b2a367a7976be80a799c6a49fa6c58d778b50e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jenkinsci%2Fjenkins)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jenkinsci](/jenkinsci)
/
**[jenkins](/jenkinsci/jenkins)**
Public

* [Notifications](/login?return_to=%2Fjenkinsci%2Fjenkins) You must be signed in to change notification settings
* [Fork
  8.9k](/login?return_to=%2Fjenkinsci%2Fjenkins)
* [Star
   23.5k](/login?return_to=%2Fjenkinsci%2Fjenkins)

* [Code](/jenkinsci/jenkins)
* [Pull requests
  77](/jenkinsci/jenkins/pulls)
* [Actions](/jenkinsci/jenkins/actions)
* [Security](/jenkinsci/jenkins/security)
* [Insights](/jenkinsci/jenkins/pulse)

Additional navigation options

* [Code](/jenkinsci/jenkins)
* [Pull requests](/jenkinsci/jenkins/pulls)
* [Actions](/jenkinsci/jenkins/actions)
* [Security](/jenkinsci/jenkins/security)
* [Insights](/jenkinsci/jenkins/pulse)

## Commit

[Permalink](/jenkinsci/jenkins/commit/b6b2a367a7976be80a799c6a49fa6c58d778b50e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[FIXED SECURITY-109] SECURITY-55 fix to BuildTrigger configuration fa…

[Browse files](/jenkinsci/jenkins/tree/b6b2a367a7976be80a799c6a49fa6c58d778b50e)
Browse the repository at this point in the history

```
…iled if downstream project was not visible.
```

* Loading branch information

[![@jglick](https://avatars.githubusercontent.com/u/154109?s=40&v=4)](/jglick)

[jglick](/jenkinsci/jenkins/commits?author=jglick "View all commits by jglick")
committed
Feb 11, 2014

1 parent
[ad38d84](/jenkinsci/jenkins/commit/ad38d8480f20ce3cbf8fec3e2003bc83efda4f7d)

commit b6b2a36

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**52 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core/src/main/java/hudson/model

  + core/src/main/java/hudson/model/AbstractProject.java
    [AbstractProject.java](#diff-eb4d2dca54b3deb3978c9a0db818d3f25b83082da391d7eca41139761257a1fe)
* test/src/test/java/hudson/tasks

  + test/src/test/java/hudson/tasks/BuildTriggerTest.java
    [BuildTriggerTest.java](#diff-91ac7d32a6ceadba339d1f28dcae2defaf2702e12fe833c98581422ba87a33a2)

## There are no files selected for viewing

9 changes: 8 additions & 1 deletion

9
[core/src/main/java/hudson/model/AbstractProject.java](#diff-eb4d2dca54b3deb3978c9a0db818d3f25b83082da391d7eca41139761257a1fe "core/src/main/java/hudson/model/AbstractProject.java")

Show comments

[View file](/jenkinsci/jenkins/blob/b6b2a367a7976be80a799c6a49fa6c58d778b50e/core/src/main/java/hudson/model/AbstractProject.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1939,7 +1939,14 @@ protected void submit(StaplerRequest req, StaplerResponse rsp) throws IOExceptio |
|  |  |  |
|  |  | for (Publisher \_t : Descriptor.newInstancesFromHeteroList(req, json, "publisher", Jenkins.getInstance().getExtensionList(BuildTrigger.DescriptorImpl.class))) { |
|  |  | BuildTrigger t = (BuildTrigger) \_t; |
|  |  | for (AbstractProject downstream : t.getChildProjects(this)) { |
|  |  | List<AbstractProject> childProjects; |
|  |  | SecurityContext orig = ACL.impersonate(ACL.SYSTEM); |
|  |  | try { |
|  |  | childProjects = t.getChildProjects(this); |
|  |  | } finally { |
|  |  | SecurityContextHolder.setContext(orig); |
|  |  | } |
|  |  | for (AbstractProject downstream : childProjects) { |
|  |  | downstream.checkPermission(BUILD); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

44 changes: 44 additions & 0 deletions

44
[test/src/test/java/hudson/tasks/BuildTriggerTest.java](#diff-91ac7d32a6ceadba339d1f28dcae2defaf2702e12fe833c98581422ba87a33a2 "test/src/test/java/hudson/tasks/BuildTriggerTest.java")

Show comments

[View file](/jenkinsci/jenkins/blob/b6b2a367a7976be80a799c6a49fa6c58d778b50e/test/src/test/java/hudson/tasks/BuildTriggerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,14 +23,26 @@ |
|  |  | \*/ |
|  |  | package hudson.tasks; |
|  |  |  |
|  |  | import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException; |
|  |  | import com.gargoylesoftware.htmlunit.html.HtmlForm; |
|  |  | import com.gargoylesoftware.htmlunit.html.HtmlPage; |
|  |  | import com.gargoylesoftware.htmlunit.html.HtmlTextInput; |
|  |  | import hudson.maven.MavenModuleSet; |
|  |  | import hudson.maven.MavenModuleSetBuild; |
|  |  | import hudson.model.FreeStyleBuild; |
|  |  | import hudson.model.FreeStyleProject; |
|  |  | import hudson.model.Item; |
|  |  | import hudson.model.Result; |
|  |  | import hudson.model.Run; |
|  |  | import hudson.security.AuthorizationMatrixProperty; |
|  |  | import hudson.security.LegacySecurityRealm; |
|  |  | import hudson.security.Permission; |
|  |  | import hudson.security.ProjectMatrixAuthorizationStrategy; |
|  |  | import java.util.Collections; |
|  |  | import java.util.HashMap; |
|  |  | import java.util.Map; |
|  |  | import java.util.Set; |
|  |  | import jenkins.model.Jenkins; |
|  |  | import org.jvnet.hudson.test.ExtractResourceSCM; |
|  |  | import org.jvnet.hudson.test.HudsonTestCase; |
|  |  | import org.jvnet.hudson.test.MockBuilder; |
| Expand Down  Expand Up | | @@ -131,4 +143,36 @@ public void testMavenBuildTrigger() throws Exception { |
|  |  | public void testMavenTriggerEvenWhenUnstable() throws Exception { |
|  |  | doMavenTriggerTest(true); |
|  |  | } |
|  |  |  |
|  |  | public void testConfigureDownstreamProjectSecurity() throws Exception { |
|  |  | jenkins.setSecurityRealm(new LegacySecurityRealm()); |
|  |  | ProjectMatrixAuthorizationStrategy auth = new ProjectMatrixAuthorizationStrategy(); |
|  |  | auth.add(Jenkins.READ, "alice"); |
|  |  | jenkins.setAuthorizationStrategy(auth); |
|  |  | FreeStyleProject upstream = createFreeStyleProject("upstream"); |
|  |  | Map<Permission,Set<String>> perms = new HashMap<Permission,Set<String>>(); |
|  |  | perms.put(Item.READ, Collections.singleton("alice")); |
|  |  | perms.put(Item.CONFIGURE, Collections.singleton("alice")); |
|  |  | upstream.addProperty(new AuthorizationMatrixProperty(perms)); |
|  |  | FreeStyleProject downstream = createFreeStyleProject("downstream"); |
|  |  | /\* Original SECURITY-55 test case: |
|  |  | downstream.addProperty(new AuthorizationMatrixProperty(Collections.singletonMap(Item.READ, Collections.singleton("alice")))); |
|  |  | \*/ |
|  |  | WebClient wc = createWebClient(); |
|  |  | wc.login("alice"); |
|  |  | HtmlPage page = wc.getPage(upstream, "configure"); |
|  |  | HtmlForm config = page.getFormByName("config"); |
|  |  | config.getButtonByCaption("Add post-build action").click(); // lib/hudson/project/config-publishers2.jelly |
|  |  | page.getAnchorByText("Build other projects").click(); |
|  |  | HtmlTextInput childProjects = config.getInputByName("buildTrigger.childProjects"); |
|  |  | childProjects.setValueAttribute("downstream"); |
|  |  | try { |
|  |  | submit(config); |
|  |  | fail(); |
|  |  | } catch (FailingHttpStatusCodeException x) { |
|  |  | assertEquals(403, x.getStatusCode()); |
|  |  | } |
|  |  | assertEquals(Collections.emptyList(), upstream.getDownstreamProjects()); |
|  |  | } |
|  |  |  |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b6b2a36`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjenkinsci%2Fjenkins%2Fcommit%2Fb6b2a367a7976be80a799c6a49fa6c58d778b50e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


