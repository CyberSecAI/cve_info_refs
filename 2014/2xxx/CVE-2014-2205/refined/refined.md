```
Advisory: McAfee ePolicy Orchestrator XML External Entity Expansion in Dashboard
Vulnerability: XML External Entity (XXE) Injection
Affected Product: McAfee ePolicy Orchestrator (ePO)
Affected Versions: 4.6.7 and below
Fixed Versions: 4.6.7 + hotfix 940148, 5.x branch
Root cause of vulnerability: The ePO system allows to add a user-defined DTD to the XML data used to define dashboards. This allows the inclusion of external entities, which are then expanded by the system.
Weaknesses/vulnerabilities: XML External Entity (XXE) Injection
Attack vectors: Users with the ability to create new dashboards in the ePO web interface can import malicious XML containing external entity references.
Impact of exploitation:
- Reading local files on the ePO server, including sensitive data like the ePO database configuration (db.properties)
- Potentially gain access to the ePO database using the decrypted credentials found in the db.properties file.
- Possible compromise of clients managed by the ePO server by altering information in the database.
Required attacker capabilities/position:
- Valid login credentials for the ePO system.
- Permission to create dashboards within the ePO web interface.
```