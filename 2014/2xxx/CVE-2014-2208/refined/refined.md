The provided content is a commit message from the Facebook HHVM repository on GitHub. It describes a fix for an issue in the LightProcess protocol.

**Root cause of vulnerability:** The LightProcess mechanism sends newline-terminated commands over a pipe. However, it did not properly escape newlines contained within the payload.

**Weaknesses/vulnerabilities present:**
- Improper handling of newlines in the payload of commands sent over a pipe. Specifically, newlines within the payload were not escaped. This could lead to the receiver misinterpreting the command structure.
- The vulnerability appears to involve a lack of proper input sanitization or encoding within the LightProcess protocol when passing data through a pipe.

**Impact of exploitation:**
- The vulnerability could potentially allow an attacker to manipulate or inject commands by including unescaped newlines in the payload. This could lead to unexpected or malicious behavior on the receiving end of the pipe.
- It could also cause a failure in processing the commands correctly.

**Attack vectors:**
- An attacker would need to be in a position to send commands over the LightProcess pipe with payloads including unescaped newlines to exploit the vulnerability.

**Required attacker capabilities/position:**
- The attacker needs the ability to send messages through the pipe that is used by the LightProcess protocol.
- The attacker must be able to control the payload of those messages and be able to inject unescaped newlines within.