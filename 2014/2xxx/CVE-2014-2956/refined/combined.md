=== Content from www.kb.cert.org_5b1e013a_20250125_180548.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#960193

## AVG Safeguard and Secure Search ActiveX controls provides insecure methods

#### Vulnerability Note VU#960193

Original Release Date: 2014-07-07 | Last Revised: 2014-07-25

---

### Overview

The AVG Secure Search toolbar, also known as AVG Safeguard includes an ActiveX control that provides a number of unsafe methods, which may allow a remote, unauthenticated attacker to execute arbitrary code with the privileges of the user.

### Description

| [AVG Secure Search](http://www.avg.com/us-en/secure-search) is a toolbar add-on for web browsers that "... provides an additional security layer while searching and surfing to protect you from infected websites." One of the components provided by AVG Secure Search is an ActiveX control called ScriptHelperApi, which is provided by ScriptHelper.exe. This ActiveX control is marked as [Safe for Scripting](http://msdn.microsoft.com/en-us/library/aa751977%28v%3Dvs.85%29.aspx) in Internet Explorer, which means that the author has [determined](http://msdn.microsoft.com/en-us/library/aa752035%28v%3Dvs.85%29.aspx#ax_judging) that the control cannot be [repurposed](http://msdn.microsoft.com/en-us/library/aa752035%28v%3Dvs.85%29.aspx#ax_repurposing) by an attacker. Because this control does not internally enforce any restrictions on which sites may invoke its methods, such as by using the [SiteLock template](http://www.microsoft.com/en-us/download/details.aspx?id=23438), this means that any website can invoke the methods exposed by the ScriptHelper ActiveX control. The installer for AVG Secure Search also sets the [ElevationPolicy registry value](http://msdn.microsoft.com/en-us/library/bb250462%28v%3Dvs.85%29.aspx) for the control, which means that the control is excluded from the [Internet Explorer Protected Mode](http://windows.microsoft.com/en-us/windows-vista/what-does-internet-explorer-protected-mode-do) sandbox. The installer for AVG Secure Search also sets the Preapproved registry value, which bypasses the Internet Explorer [ActiveX Opt-In](http://msdn.microsoft.com/en-us/library/bb250471%28v%3Dvs.85%29.aspx) feature that was introduced with IE 7.  The AVG Safeguard and Secure Search ScriptHelper ActiveX control versions up to and including version 18.1.6 contain a number of unsafe methods that can be used in Internet Explorer. Other browsers do not appear to be affected. |
| --- |

### Impact

| By convincing a user to view a specially crafted HTML document (e.g., a web page or an HTML email message or attachment), an attacker may be able to download and execute arbitrary code with the privileges of the logged-on user. |
| --- |

### Solution

| **Apply an update**This issue is addressed in AVG Secure Search toolbar version 18.1.7.598 and AVG Safeguard 18.1.7.644. While these versions are still marked as Safe for Scripting, this version of the control has restrictions in place that prevent its use by web pages hosted by domains other than .avg.com or .avg.nation.com. Please also consider the following workaround: |
| --- |

| **Disable the AVG ScriptHelper ActiveX control in Internet Explorer**The vulnerable AVG ScriptHelper ActiveX control can be disabled in Internet Explorer by setting the kill bit for the following CLSID:   {F25AF245-4A81-40DC-92F9-E9021F207706} More information about how to set the kill bit is available in [Microsoft Support Document 240797](http://support.microsoft.com/kb/240797). Alternatively, the following text can be saved as a .REG file and imported to set the kill bit for this control:  Windows Registry Editor Version 5.00[HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{F25AF245-4A81-40DC-92F9-E9021F207706}]"Compatibility Flags"=dword:00000400[HKEY\_LOCAL\_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\ActiveX Compatibility\{F25AF245-4A81-40DC-92F9-E9021F207706}]"Compatibility Flags"=dword:00000400 |
| --- |

### Vendor Information

960193
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23960193/) to view vendors.**
### [AVG Anti-virus Software](#WDON-9KHJ9B) Affected

Notified:  May 19, 2014  Updated: May 27, 2014

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 9.3 | AV:N/AC:M/Au:N/C:C/I:C/A:C |
| Temporal | 8 | E:POC/RL:W/RC:C |
| Environmental | 6.0 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.avg.com/us-en/secure-search>
* [http://msdn.microsoft.com/en-us/library/aa751977%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa751977%28v%3Dvs.85%29.aspx)
* [http://msdn.microsoft.com/en-us/library/aa752035%28v=vs.85%29.aspx#ax\_repurposing](http://msdn.microsoft.com/en-us/library/aa752035%28v%3Dvs.85%29.aspx#ax_repurposing)
* [http://msdn.microsoft.com/en-us/library/aa752035%28v=vs.85%29.aspx#ax\_judging](http://msdn.microsoft.com/en-us/library/aa752035%28v%3Dvs.85%29.aspx#ax_judging)
* [http://msdn.microsoft.com/en-us/library/bb250462%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/bb250462%28v%3Dvs.85%29.aspx)
* <http://windows.microsoft.com/en-us/windows-vista/what-does-internet-explorer-protected-mode-do>
* <http://blogs.msdn.com/b/ieinternals/archive/2011/04/02/activex-control-restrictions-in-ie.aspx>
* [http://msdn.microsoft.com/en-us/library/bb250471%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/bb250471%28v%3Dvs.85%29.aspx)
### Acknowledgements

This vulnerability was reported by Will Dormann of the CERT/CC.

This document was written by Will Dormann.

### Other Information

| **CVE IDs:** | [CVE-2014-2956](http://web.nvd.nist.gov/vuln/detail/CVE-2014-2956) |
| --- | --- |
| **Date Public:** | 2014-07-07 |
| **Date First Published:** | 2014-07-07 |
| **Date Last Updated:** | 2014-07-25 14:04 UTC |
| **Document Revision:** | 25 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


