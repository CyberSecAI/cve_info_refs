=== Content from lists.exim.org_8323fe13_20250124_133627.html ===


| [exim] Exim Security Advisory CVE-2014-2972 | | [Top Page](../splash/index.en.html) | CatalàDanskDeutschΕλληνικάEnglishEspañolsuomiFrançaisGalegomagyarItaliano日本語NederlandsPolskiPortuguêsPortuguês Brasileiro | | --- | --- | |
| --- | --- | --- | --- |

| This message is part of the following thread: | |
| --- | --- |
| [M](../message/20140722.152452.d6c019e8.en.html) | [the complete thread tree sorted by date](../thread/20140722.152452.d6c019e8.en.html#i20140722.152452.d6c019e8) |
|  |  |
|  |  |

| Delete this messageReply to this message |
| --- |

**Author:**Todd Lyons
**Date:**2014-07-22 15:24 UTC
**To:**Exim Users, Exim Dev
**Subject:**[exim] Exim Security Advisory CVE-2014-2972
The Exim developers want to inform you of a local vulnerability in Exim.

Exploitability requires the ability to provide unsanitised data to a

data source used by Exim for looking up a value, and the impact is the

ability to get a string expansion done as the Exim runtime user (so, run

commands, etc) because in a certain scenario, there's a

double-expansion, so it's equivalent to the result of the data being

"eval"d again. This bug was discovered by Patrick William of Rack911,

and reported to us by the Cpanel Security Team. Exploitation using this

method was discovered by penetration testing; it was not observed in the

wild. This security advisory has been assigned CVE-2014-2972.

We would like to publicly thank Rack911 and Cpanel for responsibly

notifying the Exim developers with a description of the problem

and coordinating their release of software fixes with ours. Appearing so

close to the end of the release cycle allowed us to handle the issue

with relative ease.

This is not a remote exploit. It requires a user account on a server

where Exim is configured to do lookups against files to which the user

has edit access. As such, this does not require a Security Release, so

we will proceed with the regular release cycle.

The root cause of this issue is the arguments to mathematical comparison

operations are expanded twice (<, <=, >, >=, =). The intent of the

original code was the first expansion could (for example) lookup an item

from a file. The assumption was that entry would be some form of valid

integer so that value was then passed to the expand function again to do

a numeric conversion of values such as 19k or 45M to integers. However,

if the content of the lookup is under direct user control, they could

insert something with an expansion, such as:

 ${run {/bin/touch /tmp/OUCH}}

Since the data is not sanitized when the second expansion occurs

(intended to process numerical conversion), that command would get

executed as the exim user.

We Exim developers agree this behavior is a bug in Exim because it is

expected that an argument to a function will only be expanded once. As

such, we have a patch which will be applied to 4.83 when it is

officially released on Tue which will modify this behavior: for math

based comparisons, the arguments are only expanded once, followed by a

numeric only conversion. This is changing a behavior that has been

present in Exim since the original code was committed in 2004.

Regards,

- - -- Todd Lyons, pp The Exim Maintainers.

```

- --
Regards...        Todd
Linux kernel 2.6.16.27-0.9-smp   load average: 0.45, 0.71, 0.94
```

| This message was posted to the following mailing lists: | | | | |
| --- | --- | --- | --- | --- |
| **Exim-dev**[Mailing List Info](../list/exim-dev.en.html) | [Nearby Messages](../mindex/exim-dev%4020140722.152452.d6c019e8.en.html) | [<-](20140722.145949.42c043f5.en.html#exim-dev) | [[exim] Exim 4.83 Released](20140722.145949.42c043f5.en.html#exim-dev) | [[exim-dev] [Bug 1506] New: expand.c:1882 compile fails with no-return-in-nonvoid-function](20140723.130828.1290e9cb.en.html#exim-dev) | [->](20140723.130828.1290e9cb.en.html#exim-dev) |
| **Exim-users**[Mailing List Info](../list/exim-users.en.html) | [Nearby Messages](../mindex/exim-users%4020140722.152452.d6c019e8.en.html) | [<-](20140722.145949.42c043f5.en.html#exim-users) | [[exim] Exim 4.83 Released](20140722.145949.42c043f5.en.html#exim-users) | [Re: [exim] Decide what router to use according to the from field](20140722.235247.fd5662a9.en.html#exim-users) | [->](20140722.235247.fd5662a9.en.html#exim-users) |

| [Tahini and Hummus and Cumin Development Archives](../splash/index.en.html) administrated by cumin Admins | **[Lurker](http://lurker.sourceforge.net/)** (version 2.3) |
| --- | --- |



=== Content from security.gentoo.org_b8468bf2_20250124_133627.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Exim: Arbitrary code execution — GLSA **201607-12**

A local attacker could execute arbitrary code by providing
unsanitized data to a data source or escalate privileges.

### Affected packages

| Package | **mail-mta/exim** on all architectures |
| --- | --- |
| Affected versions | < **4.87** |
| Unaffected versions | >= **4.87** |

### Background

Exim is a message transfer agent (MTA) designed to be a a highly
configurable, drop-in replacement for sendmail.

### Description

Vulnerabilities have been discovered in Exim’s implementation of
set-uid root and when using ‘perl\_startup’. These vulnerabilities
require a user account on the Exim server and a configuration that does
lookups against files to which the user has edit access.

### Impact

A local attacker could possibly execute arbitrary code with the
privileges of the process, or escalate privileges.

### Workaround

There is no known workaround at this time.

### Resolution

All Exim users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-mta/exim-4.87"

```
### References

* [CVE-2014-2972](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-2972)

**Release date**

July 20, 2016

**Latest revision**

July 20, 2016: 1

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [517934](https://bugs.gentoo.org/show_bug.cgi?id=517934)
* [576582](https://bugs.gentoo.org/show_bug.cgi?id=576582)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.redhat.com_e0ba70c9_20250124_133626.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1122552)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1122552)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1122552)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1122552

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1122552**](show_bug.cgi?id=1122552)
(CVE-2014-2972)
- [CVE-2014-2972](https://access.redhat.com/security/cve/CVE-2014-2972) exim: local code execution via string expansion

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-2972 exim: local code execution via string expansion

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-2972 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1122554](show_bug.cgi?id=1122554 "CLOSED ERRATA - CVE-2014-2972 exim: local code execution via string expansion [fedora-all]") [1122555](show_bug.cgi?id=1122555 "CLOSED ERRATA - CVE-2014-2972 exim: local code execution via string expansion [epel-6]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1122552&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1122552&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2014-07-23 13:33 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 06:21 UTC ([History](show_activity.cgi?id=1122552)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  dwmw2 jrusnack jskarvad tremble | | Fixed In Version: | exim 4.83 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2014-08-05 15:17:52 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1122552#c0)  Vincent Danen    2014-07-23 13:33:16 UTC  ``` As reported to the exim user's mailing list [1], Exim suffers from a local vulnerability where a string expansion is evaluated twice.  If a local attacker were able to provide unsanitized data to a data source used by Exim for looking up a value, in certain situations, the data would be eval()'d twice.  This is not remotely exploitable and requires a user account on the Exim server, and an Exim configuration that does lookups against files to which the user has edit access.  The end result is that, if the conditions are true, arbitrary code could be executed as the exim user.  As described in the posting:  """ The root cause of this issue is the arguments to mathematical comparison  operations are expanded twice (<, <=, >, >=, =). The intent of the  original code was the first expansion could (for example) lookup an item  from a file. The assumption was that entry would be some form of valid  integer so that value was then passed to the expand function again to do  a numeric conversion of values such as 19k or 45M to integers. However,  if the content of the lookup is under direct user control, they could  insert something with an expansion, such as:   ${run {/bin/touch /tmp/OUCH}}   Since the data is not sanitized when the second expansion occurs  (intended to process numerical conversion), that command would get  executed as the exim user.  """  This is corrected in the Exim 4.83 release [2],[3],[4].  From the description, it looks as though every version of Exim released since 2004 is affected.  [1] <https://lists.exim.org/lurker/message/20140722.152452.d6c019e8.en.html> [2] [http://git.exim.org/exim.git/blob/exim-4_83:/doc/doc-txt/ChangeLog](http://git.exim.org/exim.git/blob/exim-4_83%3A/doc/doc-txt/ChangeLog) [3] <http://git.exim.org/exim.git/commitdiff/7685ce68148a083d7759e78d01aa5198fc099c44> [4] <http://git.exim.org/exim.git/commitdiff/0de7239e563eff6e83c3e72d7deb9fd26a54a3a7>   ```  [Comment 1](show_bug.cgi?id=1122552#c1)  Vincent Danen    2014-07-23 13:42:43 UTC  ```  Created exim tracking bugs for this issue:  Affects: fedora-all [[bug 1122554](show_bug.cgi?id=1122554 "CLOSED ERRATA - CVE-2014-2972 exim: local code execution via string expansion [fedora-all]")] Affects: epel-6 [[bug 1122555](show_bug.cgi?id=1122555 "CLOSED ERRATA - CVE-2014-2972 exim: local code execution via string expansion [epel-6]")]   ```  [Comment 2](show_bug.cgi?id=1122552#c2)  Vincent Danen    2014-07-23 13:50:22 UTC  ``` Statement:  Red Hat Enterprise Linux 5 is now in Production 3 Phase of the support and maintenance life cycle. This has been rated as having Low security impact and is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle: <https://access.redhat.com/support/policy/updates/errata/>.   ```  [Comment 3](show_bug.cgi?id=1122552#c3)  Fedora Update System    2014-08-01 23:55:17 UTC  ``` exim-4.80.1-4.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 4](show_bug.cgi?id=1122552#c4)  Fedora Update System    2014-08-01 23:56:47 UTC  ``` exim-4.80.1-7.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1122552&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from access.redhat.com_75ced79a_20250126_012037.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.exim.org_6a5fad15_20250124_133627.html ===


| [exim] Exim 4.83 Released | | [Top Page](../splash/index.en.html) | CatalàDanskDeutschΕλληνικάEnglishEspañolsuomiFrançaisGalegomagyarItaliano日本語NederlandsPolskiPortuguêsPortuguês Brasileiro | | --- | --- | |
| --- | --- | --- | --- |

| This message is part of the following thread: | |
| --- | --- |
| [M](../message/20140722.145949.42c043f5.en.html) | [the complete thread tree sorted by date](../thread/20140722.145949.42c043f5.en.html#i20140722.145949.42c043f5) |
| [M](../message/20140724.123202.4090ccb2.en.html)+\[M](../message/20140722.160524.be7e58a9.en.html) |  |
| [M](../message/20140724.124212.d7ecb8b6.en.html)[M](../message/20140724.124110.dc937570.en.html)[M](../message/20140724.124608.9c8040ac.en.html) | [Todd Lyons at 2014-07-22 16:05->](20140722.160524.be7e58a9.en.html) |

| Delete this messageReply to this message |
| --- |

**Author:**Todd Lyons
**Date:**2014-07-22 14:59 UTC
**To:**Exim Users, Exim Dev
**Subject:**[exim] Exim 4.83 Released
 have uploaded Exim 4.83 to:

ftp://ftp.exim.org/pub/exim/exim4/

This release of Exim includes one incompatible fix: the behavior of

expansion of arguments to math comparison functions (<, <=, =, =>, >)

was unexpected, expanding the values twice. This fix also addresses a

security advisory, CVE-2014-2972. This is not a remote exploit, but if

content that is searched by the above math comparison functions is under

the control of an attacker, specially crafted data can be inserted that

will cause the Exim mail server to perform various file-system functions

as the exim user.

This release contains the following enhancements and bugfixes:

+ PRDR was promoted from Experimental to mainline

+ OCSP Stapling was promoted from Experimental to mainline

+ new Experimental feature Proxy Protocol

+ new Experimental feature DSN (Delivery Status Notifications)

+ TLS session improvements

+ TLS SNI fixes

+ LDAP enhancements

+ DMARC fixes (previous CVE-2014-2957) and new $dmarc\_domain\_policy

+ several new operations (listextract, utf8clean, md5, sha1)

+ enforce header formatting with verify=header\_names\_ascii

+ new commandline option -oMm

+ new TLSA dns lookup

+ new malware "sock" type

+ cutthrough routing enhancements

+ logging enhancements

+ DNSSEC enhancements

+ exiqgrep enhancements

+ deprecating non-standard SPF results

+ build and portability fixes

+ documentation fixes and enhancements

The ChangeLog/NewStuff/README.UPDATING are packaged with the exim

tarball or can be reviewed online at:

[http://git.exim.org/exim.git/blob/exim-4\_83:/doc/doc-txt/ChangeLog](http://git.exim.org/exim.git/blob/exim-4_83%3A/doc/doc-txt/ChangeLog)

[http://git.exim.org/exim.git/blob/exim-4\_83:/doc/doc-txt/NewStuff](http://git.exim.org/exim.git/blob/exim-4_83%3A/doc/doc-txt/NewStuff)

[http://git.exim.org/exim.git/blob/exim-4\_83:/src/README.UPDATING](http://git.exim.org/exim.git/blob/exim-4_83%3A/src/README.UPDATING)

The files are signed with the PGP key 0x04D29EBA, which has a uid

"Todd Lyons (Exim Maintainer) <tlyons@???>". Please use your own

discretion in assessing what trust paths you might have to this uid.

Checksums are below. Detached PGP signatures in .asc files are available

alongside the tarballs.

Please report issues by replying to this email on exim-users.

Thank you for your patronage,

- ---Todd Lyons, pp The Exim Maintainers

SHA256(exim-4.83.tar.bz2) = efa031b89ffb2ab844a4bf9d3a5d7ca4d587d82b62ae233d68c4f26e079a6a02

SHA256(exim-4.83.tar.bz2.asc) = 1d7c4cd0e3714244904f31e5b690226d258c5f8ef32c9a344ef662f05fcb8a73

SHA256(exim-4.83.tar.gz) = 200880381fdd1b2ce36e49b9c9bcc8b57008ff02084b87d31c6ff9867e9fea06

SHA256(exim-4.83.tar.gz.asc) = 91ef599c66df5661ca018116e7ca7408e57d22f9d3c0b7e6c465951a878ae044

SHA256(exim-html-4.83.tar.bz2) = d7b38922f2aedd9eb4db7aa0e1e1c0fcd948777a4c8bac7971eaf4b2959bf0de

SHA256(exim-html-4.83.tar.bz2.asc) = 9d20439e8c1f6c25cb120fe9e7ecc689c513bf5607ebd80e07a511a8def8d5a1

SHA256(exim-html-4.83.tar.gz) = a58e077170225efe78cadcedd4bc1d66d34c87a5581ee597e0634e475e1f60ab

SHA256(exim-html-4.83.tar.gz.asc) = c7bfb22f2df14af4f5e058138f347d3868c5d8b0c366ca26fe3b3a16b0c66cb3

SHA256(exim-pdf-4.83.tar.bz2) = 478fca2c13fbda403fb0c373dc61e82aa434e7167c0341f24b83195afd294b82

SHA256(exim-pdf-4.83.tar.bz2.asc) = fc01512d0be78b1412be0abcb0a204afa5ab46a8b45bc9396ded364d1ddc0e00

SHA256(exim-pdf-4.83.tar.gz) = 8f5e31e4b8c1fa8e402f6e0baf24350df916d78bfa888a4a6b435d0853766b2e

SHA256(exim-pdf-4.83.tar.gz.asc) = 3203916a6fe142f258e69e8c2361df40b9b3b67bbbe8bb34de58e17597acc517

SHA256(exim-postscript-4.83.tar.bz2) = 7f8ef825a832debdab54173bfb4e86acaaa6eb139a64e8b87a785183354375cf

SHA256(exim-postscript-4.83.tar.bz2.asc) = ff13e6e5799a98336b3953045f1348aab1f9e52b9d0da2b0fbe909a22d264a40

SHA256(exim-postscript-4.83.tar.gz) = 9f184baee80875caa4d27b15495500afc4eae44f275b63b170dcccc3cdf19769

SHA256(exim-postscript-4.83.tar.gz.asc) = 31171cba3aac6205abf08f122154a6d8a84c12763ccf0a78719ab3af9356c86d

```

- --
Regards...        Todd
All truth passes through three stages. First, it is ridiculed. Second,
it is violently opposed. Third, it is accepted as being self-evident.
Linux kernel 2.6.16.27-0.9-smp   load average: 0.63, 0.78, 0.70
To:
Cc:
Bcc:
Subject:
Reply-To:
Organization: exim.org Exim MTA Developers
```

```

- --
Regards...        Todd
I've visited conferences where the wireless LAN was deemed "secure" by
the organisation because they had outlawed sniffers.    --Neils Bakker
Linux kernel 2.6.16.27-0.9-smp   load average: 0.61, 0.48, 0.42
```

| This message was posted to the following mailing lists: | | | | |
| --- | --- | --- | --- | --- |
| **Exim-dev**[Mailing List Info](../list/exim-dev.en.html) | [Nearby Messages](../mindex/exim-dev%4020140722.145949.42c043f5.en.html) | [<-](20140722.125301.cdc87ecc.en.html#exim-dev) | [[exim-dev] [Bug 1505] New: Misleading message "clamd: failed to connect to 127.0.0.1: couldn't connect to any host: Connection refused"](20140722.125301.cdc87ecc.en.html#exim-dev) | [[exim] Exim Security Advisory CVE-2014-2972](20140722.152452.d6c019e8.en.html#exim-dev) | [->](20140722.152452.d6c019e8.en.html#exim-dev) |
| **Exim-users**[Mailing List Info](../list/exim-users.en.html) | [Nearby Messages](../mindex/exim-users%4020140722.145949.42c043f5.en.html) | [<-](20140718.125107.ac3dfdf0.en.html#exim-users) | [Re: [exim] errors-to](20140718.125107.ac3dfdf0.en.html#exim-users) | [[exim] Exim Security Advisory CVE-2014-2972](20140722.152452.d6c019e8.en.html#exim-users) | [->](20140722.152452.d6c019e8.en.html#exim-users) |

| [Tahini and Hummus and Cumin Development Archives](../splash/index.en.html) administrated by cumin Admins | **[Lurker](http://lurker.sourceforge.net/)** (version 2.3) |
| --- | --- |



=== Content from www.ubuntu.com_8518fcb7_20250124_133625.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2933-1: Exim vulnerabilities

15 March 2016

Several security issues were fixed in Exim.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 15.10](/security/notices?release=wily)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [exim4](/security/cves?package=exim4) - Exim is a mail transport agent

## Details

It was discovered that Exim incorrectly filtered environment variables when

used with the perl\_startup configuration option. If the perl\_startup option

was enabled, a local attacker could use this issue to escalate their

privileges to the root user. This issue has been fixed by having Exim clean

the complete execution environment by default on startup, including any

subprocesses such as transports that call other programs. This change in

behaviour may break existing installations and can be adjusted by using two

new configuration options, keep\_environment and add\_environment.

([CVE-2016-1531](/security/CVE-2016-1531))

Patrick William discovered that Exim incorrectly expanded mathematical

comparisons twice. A local attacker could possibly use this issue to

perform arbitrary file operations as the Exim user. This issue only

affected Ubuntu 12.04 LTS and Ubuntu 14.04 LTS. ([CVE-2014-2972](/security/CVE-2014-2972))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 15.10

* [exim4-daemon-heavy](https://launchpad.net/ubuntu/%2Bsource/exim4)
  -
  [4.86-3ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/exim4/4.86-3ubuntu1.1)
* [exim4-daemon-light](https://launchpad.net/ubuntu/%2Bsource/exim4)
  -
  [4.86-3ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/exim4/4.86-3ubuntu1.1)

##### Ubuntu 14.04

* [exim4-daemon-heavy](https://launchpad.net/ubuntu/%2Bsource/exim4)
  -
  [4.82-3ubuntu2.1](https://launchpad.net/ubuntu/%2Bsource/exim4/4.82-3ubuntu2.1)
* [exim4-daemon-light](https://launchpad.net/ubuntu/%2Bsource/exim4)
  -
  [4.82-3ubuntu2.1](https://launchpad.net/ubuntu/%2Bsource/exim4/4.82-3ubuntu2.1)

##### Ubuntu 12.04

* [exim4-daemon-custom](https://launchpad.net/ubuntu/%2Bsource/exim4)
  -
  [4.76-3ubuntu3.3](https://launchpad.net/ubuntu/%2Bsource/exim4/4.76-3ubuntu3.3)
* [exim4-daemon-heavy](https://launchpad.net/ubuntu/%2Bsource/exim4)
  -
  [4.76-3ubuntu3.3](https://launchpad.net/ubuntu/%2Bsource/exim4/4.76-3ubuntu3.3)
* [exim4-daemon-light](https://launchpad.net/ubuntu/%2Bsource/exim4)
  -
  [4.76-3ubuntu3.3](https://launchpad.net/ubuntu/%2Bsource/exim4/4.76-3ubuntu3.3)

This update introduces environment filtering, which may break certain

existing installations. After performing a standard system update, the new

keep\_environment and add\_environment configurations options can be used

to adjust the new behaviour.

## References

* [CVE-2014-2972](/security/CVE-2014-2972)
* [CVE-2016-1531](/security/CVE-2016-1531)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugs.gentoo.org_25ad0c71_20250126_012037.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 517934
<mail-mta/exim-4.84: local code execution via string expansion (CVE-2014-2972)
Last modified: 2016-07-20 11:20:05 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=517934&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=517934&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 517934**](show_bug.cgi?id=517934)
(CVE-2014-2972)
- <mail-mta/exim-4.84: local code execution via string expansion (CVE-2014-2972)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<mail-mta/exim-4.84: local code execution via string expansion (CVE-2014-2972)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2014-2972 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [https://bugzilla.redhat.com/show\_bug....](https://bugzilla.redhat.com/show_bug.cgi?id=1122552) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B1 [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [489676](show_bug.cgi?id=489676 "RESOLVED FIXED - please keyword new optional dependencies for >=mail-mta/exim-4.82.1 -- mail-filter/opendmarc and dev-libs/hiredis") [524154](show_bug.cgi?id=524154 "RESOLVED FIXED - =mail-mta/exim-4.84 =dev-libs/hiredis-0.11.0-r1 =mail-filter/opendmarc-1.1.3: stable request") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=517934&hide_resolved=1) | |  | | Reported: | 2014-07-24 07:52 UTC by Agostino Sarubbo | | --- | --- | | Modified: | 2016-07-20 11:20 UTC ([History](show_activity.cgi?id=517934)) | | CC List: | 3 users (show)  bug grobian net-mail+disabled | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=517934&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=517934&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Agostino Sarubbo   gentoo-dev  2014-07-24 07:52:24 UTC  ``` From ${URL} :  As reported to the exim user's mailing list [1], Exim suffers from a local vulnerability where a string expansion is evaluated twice.  If a local attacker were able to provide unsanitized data to a data source used by Exim for looking up a value, in certain  situations, the data would be eval()'d twice.  This is not remotely exploitable and requires a user account on the Exim server, and an Exim configuration that does lookups against files to which the user has edit access.  The end result is that, if the conditions  are true, arbitrary code could be executed as the exim user.  As described in the posting:  """ The root cause of this issue is the arguments to mathematical comparison  operations are expanded twice (<, <=, >, >=, =). The intent of the  original code was the first expansion could (for example) lookup an item  from a file. The assumption was that entry would be some form of valid  integer so that value was then passed to the expand function again to do  a numeric conversion of values such as 19k or 45M to integers. However,  if the content of the lookup is under direct user control, they could  insert something with an expansion, such as:   ${run {/bin/touch /tmp/OUCH}}   Since the data is not sanitized when the second expansion occurs  (intended to process numerical conversion), that command would get  executed as the exim user.  """  This is corrected in the Exim 4.83 release [2],[3],[4].  From the description, it looks as though every version of Exim released since 2004 is affected.  [1] <https://lists.exim.org/lurker/message/20140722.152452.d6c019e8.en.html> [2] [http://git.exim.org/exim.git/blob/exim-4_83:/doc/doc-txt/ChangeLog](http://git.exim.org/exim.git/blob/exim-4_83%3A/doc/doc-txt/ChangeLog) [3] <http://git.exim.org/exim.git/commitdiff/7685ce68148a083d7759e78d01aa5198fc099c44> [4] <http://git.exim.org/exim.git/commitdiff/0de7239e563eff6e83c3e72d7deb9fd26a54a3a7>   @maintainer(s): since the fixed package is already in the tree, please let us know if it is ready for the stabilization or not. ```  [Comment 1](#c1)  Fabian Groffen   gentoo-dev  2014-07-24 08:54:56 UTC  ``` I added the update yesterday.  Been running the RCs for as long as they are out (months) on my own servers, so I see no immediate problems going forward with stabilisation.  There is just a bug for a new dependency that needs fast forwarding too in that case.  [Bug #489676](show_bug.cgi?id=489676 "RESOLVED FIXED - please keyword new optional dependencies for >=mail-mta/exim-4.82.1 -- mail-filter/opendmarc and dev-libs/hiredis") ```  [Comment 2](#c2)  Yury German   Gentoo Infrastructure gentoo-dev  2014-07-26 01:52:28 UTC  ``` Since all versions from 2004 are vulnerable do we have to keyword for? alpha, amd64, arm, hppa, ia64, ppc, ppc64, sparc, x86  Since the only version with all of them keyworded is: 4.80.1-r2 ```  [Comment 3](#c3)  GLSAMaker/CVETool Bot   gentoo-dev  2014-10-14 21:31:49 UTC  ``` CVE-2014-2972 (<http://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-2972>):   expand.c in Exim before 4.83 expands mathematical comparisons twice, which   allows local users to gain privileges and execute arbitrary commands via a   crafted lookup value. ```  [Comment 4](#c4)  Yury German   Gentoo Infrastructure gentoo-dev  2014-10-15 04:49:35 UTC  ```  =mail-mta/exim-4.84 =dev-libs/hiredis-0.11.0-r1 =mail-filter/opendmarc-1.1.3 is being stabilized in [bug #524154](show_bug.cgi?id=524154 "RESOLVED FIXED - =mail-mta/exim-4.84 =dev-libs/hiredis-0.11.0-r1 =mail-filter/opendmarc-1.1.3: stable request") (Dependency already set). ```  [Comment 5](#c5)  Tobias Heinlein (RETIRED)   gentoo-dev  2015-03-28 20:48:14 UTC  ``` GLSA request filed. ```  [Comment 6](#c6)  GLSAMaker/CVETool Bot   gentoo-dev  2016-07-20 11:20:05 UTC  ``` This issue was resolved and addressed in  GLSA 201607-12 at <https://security.gentoo.org/glsa/201607-12> by GLSA coordinator Aaron Bauman (b-man). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=517934)
* - [XML](show_bug.cgi?ctype=xml&id=517934)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=517934)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=517934&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=517934&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=517934&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from lists.ubuntu.com_be8ed54b_20250126_012038.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from git.exim.org_47c40049_20250124_133623.html ===

This website requires JavaScript.
[![Logo](/assets/img/logo.svg)](/)

[Explore](/explore/repos)
[Help](https://forgejo.org/docs/latest/)

[Sign in](/user/login?redirect_to=%2fexim%2fexim)

[exim](/exim)/[exim](/exim/exim)

Watch

[4](/exim/exim/watchers)

Star

[0](/exim/exim/stars)

Fork
You've already forked exim

[0](/exim/exim/forks)

[Code](/exim/exim)
[Issues](https://bugs.exim.org/)
[Pull requests
1](/exim/exim/pulls)
[Projects](/exim/exim/projects)
[Releases](/exim/exim/releases)
[Packages](/exim/exim/packages)
[Wiki](/exim/exim/wiki)
[Activity](/exim/exim/activity)
[Actions](/exim/exim/actions)

Master Exim source repository

[**6525** commits](/exim/exim/commits/branch/master)
[**61** branches](/exim/exim/branches)
[**176** tags](/exim/exim/tags)
 **90** MiB

C

92.3%

Perl

4.4%

Shell

1.9%

Elixir

0.4%

Makefile

0.3%

Other

0.5%

**master**

[Find a file](/exim/exim/find/branch/master)

HTTPS

Open with VS Code
Open with VSCodium
Open with Intellij IDEA

Cite this repository

BibTeX

Cancel

Exact

Exact

Union

RegExp

|  | | 2025-01-21 21:47:58 +01:00 |
| --- | --- | --- |
| [.github](/exim/exim/src/branch/master/.github ".github") | [fix the list URL](/exim/exim/commit/138860785cc96f077f052043d46f697abbf87947) | 2023-05-09 16:49:30 +02:00 |
| [configs](/exim/exim/src/branch/master/configs "configs") | [typo](/exim/exim/commit/48c7888d7a53e88f7933320c2cb2e0bdbc5504a8) | 2025-01-21 21:47:58 +01:00 |
| [doc](/exim/exim/src/branch/master/doc "doc") | [Docs: another removal candidate](/exim/exim/commit/e4223aa011afd150863e8605082e738019effb0d) | 2025-01-21 19:12:00 +00:00 |
| [release-process](/exim/exim/src/branch/master/release-process "release-process") | [Release process: script for cleaning changebars from .xfpt files](/exim/exim/commit/d4d0b596c0dfd5501b8d552606eb158b3a972b8c) | 2024-06-07 15:38:07 +01:00 |
| [src](/exim/exim/src/branch/master/src "src") | [OpenSSL: for early-banner, no need to set an early-data size](/exim/exim/commit/2d74f7c4d7b64d4c753550244935bd9a2ab21f48) | 2025-01-21 19:08:13 +00:00 |
| [test](/exim/exim/src/branch/master/test "test") | [Update SRV SMTPS for STARTTLS record, per draft-03](/exim/exim/commit/00baa0ac8c46958872a738c18ebc71659ea15040) | 2025-01-21 18:59:40 +00:00 |
| [.editorconfig](/exim/exim/src/branch/master/.editorconfig ".editorconfig") | [Testsuite: Use .editorconfig for test/runtest](/exim/exim/commit/1ef2730eb3d31c57a088b0491dfb5096f65b289a) | 2016-10-20 00:48:29 +02:00 |
| [.exim-project-root](/exim/exim/src/branch/master/.exim-project-root ".exim-project-root") | [mk\_exim\_release: rework for dotted release scheme](/exim/exim/commit/525c441c8defd07ec9c1c235eb8ac4da304d70be) | 2018-12-13 23:11:36 +01:00 |
| [.gitattributes](/exim/exim/src/branch/master/.gitattributes ".gitattributes") | [meta: git controls for text changelogs; github controls](/exim/exim/commit/b988b06146c5d16e0ca0ea86ffcf2d83938088ed) | 2018-02-25 02:51:22 -05:00 |
| [.gitignore](/exim/exim/src/branch/master/.gitignore ".gitignore") | [Add systemd units (examples)](/exim/exim/commit/bb6a0f57e5c1a04c9c191af6a37184970003b1c2) | 2023-10-19 09:56:29 +02:00 |
| [.mailmap](/exim/exim/src/branch/master/.mailmap ".mailmap") | [mailmap: real name for bes-internal](/exim/exim/commit/faad4a0eab268f7a52b6d6e6102a41e31399de38) | 2023-10-04 00:18:16 +02:00 |
| [Readme.pod](/exim/exim/src/branch/master/Readme.pod "Readme.pod") | [fix the list URL](/exim/exim/commit/138860785cc96f077f052043d46f697abbf87947) | 2023-05-09 16:49:30 +02:00 |
| [SECURITY.md](/exim/exim/src/branch/master/SECURITY.md "SECURITY.md") | [Microfix in SECURITY.md: exim-VERSION+fixes](/exim/exim/commit/275dd1deb9b22da56d0d20cec505387a5b9d2070) | 2019-07-06 23:34:06 +02:00 |

#### **[Readme.pod](#readme)**

```
=head1 Exim Development Repository

This is the Exim (Mail Transport Agent) Development Repository. Please
read the following information if you wish to use or contribute to the
Exim development process - this is to prevent your or our time being
unnecessarily wasted.

If you just want to use, build or get information on Exim then have a
look at the pointers further down this file at L<General Exim Information>.

=head2 General Development Information

The general Exim development process and resources are documented in
the wiki page at L<http://wiki.exim.org/EximDevelopment> - although
the wiki is likely to be moved and rehashed in the near future.

The sections below this duplicate much of the information form the
wiki document.

=head2 Development Repositories

Exim development is kept within a  git (L<https://git-scm.com/>)
repository. The master repository is at L<git://git.exim.org/exim.git>
with a web interface giving change and source visibility at
L<https://git.exim.org/exim.git>

There is a secondary repository on github at
L<https://github.com/Exim/exim> managed by the Exim Organisation
- however this may currently fall out of synchronisation with the
main one.

=head2 Bug Tracking

Currently this is all done using Bugzilla at L<https://bugs.exim.org/>
- please do not use github issue tracking.

=head2 Mailing List

Development issues are normally discussed on the exim-dev mailing list
- see L<https://www.exim.org/maillist.html>

=head2 Exim Release Process

Some documentation on the release process can be found at
L<http://wiki.exim.org/EximRelease>.

=head2 General Exim Information

The best place to get general information is on the website at
L<https://www.exim.org/>.

You can find Download locations L<https://www.exim.org/mirrors.html>,
Mailing list info L<https://www.exim.org/maillist.html> and Full
Documentation L<https://www.exim.org/docs.html> on that website.

If you are using a Linux or other freely available Unix like operating
system it is very likely that your system will have Exim packaged for
it already. In this case it is probably prudent to use these packages
unless you have specialised requirements.

In any case you can always ask on the
Exim Users mailing list L<https://lists.exim.org/mailman3/postorius/lists/exim-users.lists.exim.org/>
for further information.

[End]

```

[Powered by Forgejo](https://forgejo.org)
Version:
10.0.0
Page: **43ms**
Template: **9ms**

 English
Bahasa Indonesia
Deutsch
English
Español
Esperanto
Filipino
Français
Italiano
Latviešu
Magyar nyelv
Nederlands
Plattdüütsch
Polski
Português de Portugal
Português do Brasil
Slovenščina
Suomi
Svenska
Türkçe
Čeština
Ελληνικά
Български
Русский
Українська
فارسی
日本語
简体中文
繁體中文（台灣）
繁體中文（香港）
한국어

[Licenses](/assets/licenses.txt)
[API](/api/swagger)


