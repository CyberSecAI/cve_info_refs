```
{
  "CVE-2014-2241": {
    "related": true,
    "summary": "FreeType could be made to crash or run programs as your login if it opened a specially crafted font file.",
    "details": "Mateusz Jurczyk discovered that FreeType did not correctly handle certain malformed font files. If a user were tricked into using a specially crafted font file, a remote attacker could cause FreeType to crash or possibly execute arbitrary code with user privileges.",
     "root_cause": "The vulnerability is caused by an incorrect program flow after an error is detected when handling a charstring with too many stem hints. Specifically, when an invalid hint mask is encountered in `cf2_hintmap_build()`, the function does not return early enough, leading to an out-of-bounds read.",
    "weaknesses": [
      "CWE-617: Reachable Assertion",
      "Out-of-bounds read"
    ],
    "impact": "A remote attacker could cause FreeType to crash or potentially execute arbitrary code with the privileges of the user running the application using the library.",
    "attack_vectors": [
      "Specially crafted font file",
       "User tricked into opening malicious font file"
    ],
    "attacker_capabilities": "The attacker needs to create a malformed font file. They also need to trick the victim into opening the malformed font file with an application using the vulnerable FreeType library.",
      "additional_information": "The vulnerability is located in the CFF rasterizer code. The specific issue is a reachable assertion, and not a stack-based buffer overflow as initially described. The incorrect program flow occurs when `cf2_hintmap_build()` does not return early enough after detecting an invalid hint mask, leading to an out-of-bounds read. The fix involves adding an early return in this function, preventing the out-of-bounds read. Also, assertions in `cf2_initLocalRegionBuffer` and `cf2_initGlobalRegionBuffer` were adjusted to account for cases where charstrings could call subroutines when no subroutines exist, which is an error but not an assertion trigger."
  }
}
```