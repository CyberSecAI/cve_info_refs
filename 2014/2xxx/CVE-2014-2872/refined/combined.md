=== Content from www.kb.cert.org_c5096f5d_20250125_225940.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#437385

## PaperThin CommonSpot CMS contains multiple vulnerabilities

#### Vulnerability Note VU#437385

Original Release Date: 2014-04-14 | Last Revised: 2014-04-14

---

### Overview

PaperThin CommonSpot contains multiple vulnerabilities, which may allow an unauthenticated remote attacker to execute arbitrary code on the server.

### Description

| [PaperThin CommonSpot](http://www.paperthin.com/products/index.cfm) is a content management system (CMS) that is based on Adobe ColdFusion. CommonSpot is composed of over 3000 individual ColdFusion pages (CFM files). When a web site is created using CommonSpot, most of these pages are exposed to the public internet. CommonSpot contains multiple vulnerabilities with a range of impacts. Server-side vulnerabilities in CommonSpot will run with the privileges of the ColdFusion service, which is SYSTEM by default.  [**CWE-425**](http://cwe.mitre.org/data/definitions/425.html)**: Direct Request ('Forced Browsing')**Most of the vulnerabilities in CommonSpot are exposed because of CWE-425. While the CFM pages that comprise CommonSpot are intended to be used together to provide CMS functionality, many of the individual CFM pages can be accessed directly. Many of these pages also accept untrusted input.[**CWE-79**](http://cwe.mitre.org/data/definitions/79.html)**: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**Many CommonSpot pages read data from the HTTP request and reflect it back in the HTTP response (Type 1: reflected XSS). In some cases, the reflected data is improperly sanitized, which can allow an attacker to inject HTML elements, such as <script>. In other cases, the reflected data is already within a <script> element, which makes most attempts at sanitization futile. With some pages, some sanitization does take place, such as stripping URI parameters that contain the string "alert". CommonSpot contains instances of CWE-79 that are ColdFusion-based (CFM) as well as pure JavaScript and HTML based. Instances of CWE-79 can be used to steal cookies, which are used for authentication.[**CWE-284**](http://cwe.mitre.org/data/definitions/284.html)**: Improper Access Control**CommonSpot inconsistently enforces access control. Many pages can be used by an anonymous actor when accessed directly.[**CWE-285**](http://cwe.mitre.org/data/definitions/285.html)**: Improper Authorization**In many cases, CommonSpot fails to authorize users before taking potentially-dangerous actions.[**CWE-73**](http://cwe.mitre.org/data/definitions/73.html)**: External Control of File Name or Path**Some pages that are provided by CommonSpot accept parameters that are fully-qualified filesystem paths.[**CWE-22**](http://cwe.mitre.org/data/definitions/22.html)**: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'**)Some pages that use file names as parameters are vulnerable to directory traversal attacks.[**CWE-158**](http://cwe.mitre.org/data/definitions/158.html)**: Improper Neutralization of Null Byte or NUL Character**Some pages may terminate an attacker-provided string to be terminated earlier than expected. When combined with CWE-22, this can allow for control of a file path on the same drive as the ColdFusion web root.[**CWE-602**](http://cwe.mitre.org/data/definitions/602.html)**: Client-Side Enforcement of Server-Side Security**Several unsafe CommonSpot operations are restricted on the client side using JavaScript. Because client-side JavaScript is under attacker control, these restrictions are not properly enforced.[**CWE-434**](http://cwe.mitre.org/data/definitions/434.html)**: Unrestricted Upload of File with Dangerous Type**CommonSpot can allow authenticated users to upload arbitrary ColdFusion pages, which can allow arbitrary code execution on the server with the privileges of the ColdFusion service.[**CWE-472**](http://cwe.mitre.org/data/definitions/472.html)**: External Control of Assumed-Immutable Web Parameter**Many CommonSpot pages use ColdFusion variables that can be overriden via the URI (HTTP GET).[**CWE-200**](http://cwe.mitre.org/data/definitions/200.html)**: Information Exposure**Several CommonSpot pages disclose sensitive information about the server, including server name, filesystem paths, SQL server type and DSNs, administrative email and SMTP server address.[**CWE-312**](http://cwe.mitre.org/data/definitions/312.html)**: Cleartext Storage of Sensitive Information**CommonSpot by default stores cleartext credentials in its database. Note that this behavior is documented, and it is possible to enable encryption.[**CWE-319**](http://cwe.mitre.org/data/definitions/319.html)**: Cleartext Transmission of Sensitive Information**The login pages used by CommonSpot transmit credentials in cleartext. If a CommonSpot server is administered over an untrusted network, the administrative credentials may be observed by an attacker.[**CWE-548**](http://cwe.mitre.org/data/definitions/548.html)**: Information Exposure Through Directory Listing**Some CommonSpot pages expose the ability to obtain an arbitrary directory listing.[**CWE-532**](http://cwe.mitre.org/data/definitions/532.html)**: Information Exposure Through Log Files**CommonSpot exposes unauthenticated access to its log file directory. If an attacker accesses a guessable file name, additional information about the server can be exposed.[**CWE-78**](http://cwe.mitre.org/data/definitions/78.html)**: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')**CommonSpot allows for unauthenticated arbitrary command execution with arbitrary parameters. This command execution happens with the privileges of the ColdFusion service. |
| --- |

### Impact

| Depending on the vulnerabilities exploited, a remote unauthenticated attacker may be able to cause a variety of impacts, up to and including remote code execution on the CommonSpot / ColdFusion server with SYSTEM privileges. |
| --- |

### Solution

| **Apply an update**The issues that we reported to PaperThin are addressed in CommonSpot versions 7.0.2, 8.0.3 and 9.0. To help harden CommonSpot against vulnerabilities that may not have been addressed in these updates, please also consider the following workaround: |
| --- |

| **Restrict access to /commonspot**Most of these vulnerabilities can be mitigated by restricting access to the /commonspot directory on a CommonSpot server. This restriction may be possible on the network layer and/or the web server application layer. Note that by simply restricting access on the internet-facing side of CommonSpot, users on the internal network may still be able to trigger the vulnerabilities, e.g. by clicking on a link. Due to the level of access exposed, CommonSpot contributors must be trusted with SYSTEM-level access to the CommonSpot server. |
| --- |

### Vendor Information

437385
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23437385/) to view vendors.**
### [Paperthin](#BLUU-9C9SH3) Affected

Notified:  October 07, 2013  Updated: April 14, 2014

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Addendum

CommonSpot 7.0.2, 8.0.3 and 9.0 address the issues that we reported to PaperThin. Please consider the workarounds listed in the vulnerability note to protect against other vulnerabilities.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 10 | AV:N/AC:L/Au:N/C:C/I:C/A:C |
| Temporal | 8.5 | E:POC/RL:W/RC:C |
| Environmental | 6.4 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.paperthin.com/>
* <http://cwe.mitre.org/data/definitions/425.html>
* <http://cwe.mitre.org/data/definitions/79.html>
* <http://cwe.mitre.org/data/definitions/284.html>
* <http://cwe.mitre.org/data/definitions/79.html>
* <http://cwe.mitre.org/data/definitions/22.html>
* <http://cwe.mitre.org/data/definitions/158.html>
* <http://cwe.mitre.org/data/definitions/602.html>
* <http://cwe.mitre.org/data/definitions/434.html>
* <http://cwe.mitre.org/data/definitions/472.html>
* <http://cwe.mitre.org/data/definitions/200.html>
* <http://cwe.mitre.org/data/definitions/312.html>
* <http://cwe.mitre.org/data/definitions/319.html>
* <http://cwe.mitre.org/data/definitions/548.html>
* <http://cwe.mitre.org/data/definitions/532.html>
* <http://cwe.mitre.org/data/definitions/78.html>
### Acknowledgements

This vulnerability was reported by Will Dormann of the CERT/CC.

This document was written by Will Dormann.

### Other Information

| **CVE IDs:** | [None](http://web.nvd.nist.gov/vuln/detail/None) |
| --- | --- |
| **Date Public:** | 2014-04-14 |
| **Date First Published:** | 2014-04-14 |
| **Date Last Updated:** | 2014-04-14 13:17 UTC |
| **Document Revision:** | 32 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


