=== Content from openwall.com_4324154f_20250125_043754.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2014/04/05/1) [[thread-next>]](../../../2014/04/09/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201404072132.s37LWF5J021244@linus.mitre.org>
Date: Mon, 7 Apr 2014 17:32:15 -0400 (EDT)
From: cve-assign@...re.org
To: carnil@...ian.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: Possible CVE Request: Uncontrolled Resource Consumption with XMPP-Layer Compression

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Is this something which should get one CVE, or is a CVE for each
> implementation needed?

A single CVE for this cross-vendor situation seems wrong because the
specification apparently does not require implementations to have an
unrestricted decompression capability.

There could conceivably be two CVEs for a single implementation,
although we haven't yet found a reference that is reporting an
implementation's problems at that level of detail. Most likely there
would be one CVE per implementation.

> <http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/>

The two types of CVEs would be:

(1)
> XEP-0170 on "Recommended Order of Stream Feature Negotiation" suggests
> to negotiate stream compression after the authentication of the
> principals. This suggests that xmppbombs can be used only after the
> user authentication. When decompressing XMPP stanzas, an XMPP server
> must limit the resources allocated to this task. If the server fails
> to do that, it can monopolize the CPU usage and allocate all the
> available memory.

Here, the root cause is that the behavior in the authenticated case
does not properly address resource consumption. Apparently multiple
vendors are characterizing this as a vulnerability.

(2)
> it has been reported that some implementations allow the use of
> compression before the authentication phase therefore opening up this
> vulnerability to unknown attackers.

Here, the root cause is a violation of a specification, resulting in a
security impact.

A hypothetical example is that a server is willing to decompress
relatively short strings in unauthenticated sessions (e.g., decompress
32 kilobytes to 32 megabytes). That same server has no restrictions on
authenticated sessions, and can produce gigabytes of uncompressed
data. In this scenario, two CVE IDs would be assigned because the two
resource-consumption issues occur for different reasons.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJTQxkWAAoJEKllVAevmvmsBs4H/RbrYMIZK+/VDh//wVFXySou
dIeEeguVFWqs5YMAp6GCsXbQoZYhCpGmENTuu5hXst8KhxLvnCmQ4XuRVWedaGdQ
qVwI1ip5EOgi3Ij1V7ML6KiPlcx8FhPLxWOE5O/xH6e4vX3qQHiEynWNVOgEP/zq
nIjrgivTQygJwHZQp6FevGiD/S5lSeyaKlP82E0mCaRHPo1ZDnlPqoVux8O0TlND
oysVbHsCcdXBGAusoUPANvtmQrSN6UHC3H9Zy/vV2Vc029ew5Zr/AgGwiR4Je5d5
+0XnH/6sJoVzGWTah5e5vQhFV24h9w5kXBu/Sr8zWzwjsYOby1Y7dh2evLdN1qk=
=58gv
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.kb.cert.org_1360baa8_20250125_043755.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#495476

## Openfire contains an uncontrolled resource consumption vulnerability

#### Vulnerability Note VU#495476

Original Release Date: 2014-04-16 | Last Revised: 2014-04-23

---

### Overview

Openfire 3.9.1, and possibly earlier versions, contains an uncontrolled resource consumption ([CWE-400](https://cwe.mitre.org/data/definitions/400.html)) vulnerability when using XMPP DEFLATE message compression.

### Description

| Openfire 3.9.1, and possibly earlier versions, contains an uncontrolled resource consumption ([CWE-400](https://cwe.mitre.org/data/definitions/400.html)) vulnerability when using XMPP DEFLATE message compression. It has been reported that a highly compressed XMPP message of 4MB that uncompresses to 4GB may cause a resource exhaustion denial of service. The highly compressed XMPP messages may be sent in parallel to enhance the denial of service. |
| --- |

### Impact

| A remote unauthenticated attacker may be able to cause a denial-of-service condition. |
| --- |

### Solution

| We are currently unaware of a practical solution to this problem. A fix is available in the [development branch of Openfire](http://fisheye.igniterealtime.org/changelog/openfiregit?cs=3aec383e07ee893b77396fe946766bbd3758af77) but a stable release is not available yet. Please consider the following workarounds. |
| --- |

| **Restrict Network Access**  As a general good security practice, only allow connections from trusted hosts and networks if possible. Restricting access would prevent an attacker from connecting to the service from a blocked network location.**Disable XMPP Compression**Navigate to the menu Server -> Server Settings -> Compression Settings -> Client Compression Policy and check the option Not Available - Clients will not receive the option to use compressed traffic. |
| --- |

### Vendor Information

495476
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23495476/) to view vendors.**
### [Openfire](#JALR-9J8KZ6) Affected

Notified:  February 25, 2014  Updated: April 16, 2014

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 7.8 | AV:N/AC:L/Au:N/C:N/I:N/A:C |
| Temporal | 7 | E:F/RL:W/RC:C |
| Environmental | 5.3 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <https://cwe.mitre.org/data/definitions/400.html>
* <http://www.igniterealtime.org/projects/openfire/>
* <http://community.igniterealtime.org/thread/52317>
* <http://fisheye.igniterealtime.org/changelog/openfiregit?cs=3aec383e07ee893b77396fe946766bbd3758af77>
* <http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/>
### Acknowledgements

Thanks to Giancarlo Pellegrino for reporting this vulnerability.

This document was written by Jared Allar.

### Other Information

| **CVE IDs:** | [CVE-2014-2741](http://web.nvd.nist.gov/vuln/detail/CVE-2014-2741) |
| --- | --- |
| **Date Public:** | 2014-04-16 |
| **Date First Published:** | 2014-04-16 |
| **Date Last Updated:** | 2014-04-23 18:54 UTC |
| **Document Revision:** | 21 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from openwall.com_55c23296_20250125_043755.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2014/04/08/15) [[next>]](2) [[<thread-prev]](../../../2014/04/07/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201404090108.s39181ns004077@linus.mitre.org>
Date: Tue, 8 Apr 2014 21:08:01 -0400 (EDT)
From: cve-assign@...re.org
To: carnil@...ian.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: (Openfire M-Link Metronome Prosody Tigase) Possible CVE Request: Uncontrolled Resource Consumption with XMPP-Layer Compression

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> <http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-with-highly-compressed-xmpp-stanzas/>

igniterealtime.org   Openfire   Fixed in 3.9.2

We did not find any commits for this under the
<http://fisheye.igniterealtime.org/changelog/> URL. Accordingly, only
one CVE is possible at present. Use CVE-2014-2741.

Isode Ltd.           M-Link     Fixed in 16.0v7

We did not find any details about the change under the
<http://www.isode.com/products/m-link.html> URL. (Also, the
<http://www.isode.com/evaluate/instant-messaging-xmpp.html> page seems
to imply that this is not open source.) Accordingly, only one CVE is
possible at present. Use CVE-2014-2742.

lightwitch.org       Metronome  Fix in progress
<http://code.lightwitch.org/metronome/rev/49f47277a411>

Use CVE-2014-2743 for "Don't process deflated data if it exceedes the
max allowed limit."

Use CVE-2014-2744 for "Don't allow to compress a stream if it's not
authenticated."

Prosody              Prosody    Fixed in 0.9.4
<http://blog.prosody.im/prosody-0-9-4-released/>

Use CVE-2014-2745 for these changes that address resource consumption
in general:
  <http://hg.prosody.im/0.9/rev/a97591d2e1ad>
  <http://hg.prosody.im/0.9/rev/1107d66d2ab2>

Use CVE-2014-2744 for this change that addresses decompression of
unauthenticated data:
  <http://hg.prosody.im/0.9/rev/b3b1c9da38fb>

(This is exactly the same plugins/mod_compression.lua fix as in
Metronome, and thus has the same CVE ID. Metronome was originally
based on the Prosody codebase.)

Tigase               Tigase     Fixed in 5.2.1
<http://www.tigase.org/content/uncontrolled-resource-consumption-highly-compressed-xmpp-messages>
<https://projects.tigase.org/projects/tigase-server/repository/revisions/7f5af2f8c5b97bbf9def66fbb9dd47746a7ac292>
<https://projects.tigase.org/issues/1780> (not a public bug)

We did not determine that more than one issue was fixed. Accordingly,
only one CVE is possible at present. Use CVE-2014-2746.

Erlang Solutions     MongooseIM Under Investigation

We did not find anything under the
<https://github.com/esl/MongooseIM/commits/master> URL. There is
apparently no publicly known vulnerability and thus no CVE assignment.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJTRJxDAAoJEKllVAevmvmsUdcH/0W6GGzE1yTEOnxFqtZ8ghvE
gavs13esHOeB/FLHdliJx54y/xzKoXbWPwItKVju/lqbRJwCMpy1G7+to4PoZ3ZO
O1hanQGjCwmH48D4pY0z203d3whXuMGoZI+DLhyDqvVvwYAwboTCu2E36j0q8Zj2
kwpxfzShE6v13PKriEwMgVLZMj1xUZSD6yXMg24v48vjcRnDqReZ5wdrnXRYIwPP
Kkzlj9P6D+gR98ZQp5pLX5Db574vcAP+7v5jn2EvfGJRsofUhX/K2oPrQ/xGfCpH
rJpvIvBglugtW3/iVKtrKK9QBF5bcFxBrFGWAfrTois5du4FA9iQoi0jC6J0AHo=
=U9OB
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from community.igniterealtime.org_861ebb70_20250125_043754.html ===


![Ignite Realtime Community Forums](data:image/svg;base64...)
Loading

[Ignite Realtime Community Forums](/)

# [Security Issue: Uncontrolled Resource Consumption with XMPP-Layer Compression](/t/security-issue-uncontrolled-resource-consumption-with-xmpp-layer-compression/59636)

[Openfire](/c/openfire/openfire-support/8)

[Openfire Support](/c/openfire/openfire-support/8)

[Justin\_Bennett](https://discourse.igniterealtime.org/u/Justin_Bennett)

April 14, 2014, 5:58pm

1

<http://xmpp.org/resources/security-notices/uncontrolled-resource-consumption-wit> h-highly-compressed-xmpp-stanzas/

Any insight how to mitigate this issue on older servers? Reportedly, Openfire 3.9.2 resolves this issue, but it doesn’t appear to be downloadable to the public.

It’s also reportedly recommended to disable XMPP Compression. I found the xmpp.client.compression.policy setting ([http://community.igniterealtime.org/docs/DOC-1061](https://community.igniterealtime.org/docs/DOC-1061)), but I don’t know if this is a solution or not. It’s not a property by default in our System Properties, and I figured I’d ask before tinkering.

Thank you,

Justin

[akrherz](https://discourse.igniterealtime.org/u/akrherz)

April 14, 2014, 7:31pm

2

This commit is in reference to this CVE <http://fisheye.igniterealtime.org/changelog/openfiregit?cs=3aec383e07ee893b77396> fe946766bbd3758af77

Unsure when we’ll get a new release pushed out.

[LG1](https://discourse.igniterealtime.org/u/LG1)

April 14, 2014, 7:37pm

3

You can either open

**Server / Server Manager / System Properties** and set there:

‘xmpp.client.compression.policy’ = ‘disabled’

‘xmpp.server.compression.policy’ = ‘disabled’

Or use the more easy way:

**Server / Server Settings / Compression Settings**

Client Compression Policy

[x] **Not Available** - Clients will not receive the option to use compressed traffic.

Openfire 3.9.2 is indeed not yet available.

[Justin\_Bennett](https://discourse.igniterealtime.org/u/Justin_Bennett)

April 14, 2014, 7:59pm

4

Thank you both!

-Justin

[akrherz](https://discourse.igniterealtime.org/u/akrherz)

April 17, 2014, 8:10pm

5

OF-770 created to tie up the loose end on this

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

[Ignite Realtime](/)

1. [Home](http://www.igniterealtime.org/)
2. [Projects](http://www.igniterealtime.org/projects/)
3. [Downloads](http://www.igniterealtime.org/downloads/)
4. [Community](https://discourse.igniterealtime.org)
5. [Fans](http://www.igniterealtime.org/fans/)
6. [Support](http://www.igniterealtime.org/support/index.jsp)
7. [News](https://www.igniterealtime.org/news/)


