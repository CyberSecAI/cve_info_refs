Based on the provided information, here's an analysis of CVE-2014-2287:

**Root Cause of Vulnerability:**
The vulnerability stems from how Asterisk's chan_sip module handles SIP INVITE requests with malformed or disallowed Session-Expires or Min-SE headers when session timers are enabled. Additionally, it can be triggered when an INVITE request offers the "timer" option while session timers are set to refuse in the configuration.  The core issue is that Asterisk allocates resources (channels and file descriptors) even when it rejects the INVITE, and these resources are not released properly leading to resource exhaustion.

**Weaknesses/Vulnerabilities Present:**
- **Resource Leak:** The primary vulnerability is a resource leak. When Asterisk receives a crafted INVITE request, it allocates a channel and file descriptors but fails to release them when the request is rejected due to invalid session timer parameters or configuration mismatches.
- **Improper Error Handling:** The code doesn't properly handle errors related to session timer negotiation before allocating resources.
- **Lack of Input Validation:** The SIP module does not fully validate the Session-Expires and Min-SE headers, leading to errors that are not handled well.

**Impact of Exploitation:**
- **Denial of Service (DoS):** An attacker can send a large number of specially crafted INVITE requests to exhaust the server's file descriptors, causing it to become unresponsive and unable to process legitimate requests.
- **Bypass Intrusion Detection:**  By sending the malicious INVITE requests slowly, attackers may be able to bypass intrusion detection systems because the resource exhaustion is gradual and does not cause an immediate catastrophic failure.

**Attack Vectors:**
- **SIP INVITE Requests:** The attack is carried out by sending specially crafted SIP INVITE requests.
- **Malformed Headers:**  The INVITE requests must contain either malformed Session-Expires or Min-SE headers, or offer the "timer" option when the server is configured to refuse session timers.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be able to send SIP INVITE requests to the Asterisk server.
- **Valid Credentials or Anonymous Access:** The attacker needs either valid SIP account credentials or must be able to dial into the system anonymously.
- **Knowledge of a Valid Extension:** The attacker needs to know a valid extension that can be dialed on the target Asterisk system.
- **Understanding of SIP Session Timers:** The attacker needs to understand SIP session timers and how to craft INVITE requests with specific headers that will trigger the vulnerability.

The provided patch moves the session timer negotiation to before channel creation, preventing the resource leak. The patch also adds checks for malformed session-timers, and configuration mismatches.