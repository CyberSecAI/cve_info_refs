=== Content from seclists.org_620b8d9c_20250124_201144.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](304)
[By Date](date.html#305)
[![Next](/images/right-icon-16x16.png)](306)

[![Previous](/images/left-icon-16x16.png)](303)
[By Thread](index.html#305)
[![Next](/images/right-icon-16x16.png)](308)

![](/shared/images/nst-icons.svg#search)

# Arbitrary code execution by admins in File Gallery 1.7.7 (WordPress plugin)

---

*From*: dxw Security <security () dxw com>

*Date*: Tue, 29 Apr 2014 10:32:01 +0000

---

```
Details
================
Software: File Gallery
Version: 1.7.7,1.7.9
Homepage: <http://wordpress.org/plugins/file-gallery/>
Advisory ID: dxw-1970-638
CVE: CVE-2014-2558
CVSS: 8 (High; AV:N/AC:L/Au:S/C:C/I:P/A:P)

Description
================
Arbitrary code execution by admins in File Gallery 1.7.7

Vulnerability
================
An admin user can execute arbitrary code due to using create_function(). The plugin’s authors made it tricky by using
single-quotes instead of double quotes, and they replaced all single quotes with a backslash followed by single quotes.
Unfortunately, escaping strings is not quite that easy. Using backslash-quote we are able to escape the backslash
leaving us a quote.

Proof of concept
================

Visit the settings page (integrated into the media settings at /wp-admin/options-media.php)
Type the following into any of the plugin’s settings fields, for instance “How many page links should be shown in
pagination?”:

\',phpinfo(),#
WordPress keeps eating the backslash so I’ll spell it out: backslash, apostrophe, comma, “phpinfo”, open paren, close
paren, comma, hash

Click Save Changes
Part way down the page you should see the PHP logo

Mitigations
================
Upgrade to version 1.7.9.2.

Disclosure policy
================
dxw believes in responsible disclosure. Your attention is drawn to our disclosure policy:
<https://security.dxw.com/disclosure/>

Please contact us on security () dxw com to acknowledge this report if you received it via a third party (for example,
plugins () wordpress org) as they generally cannot communicate with us on your behalf.

This vulnerability will be published if we do not receive a response to this report with 14 days.

Timeline
================

2013-10-08: Discovered
2014-03-17: Reported to plugins () wordpress org
2014-04-24: Updated version available

<<<<<<< HEAD

Discovered by dxw:
================
Tom Adams
=======

Discovered by dxw:
================
Tom Adams

```
> > > > > > > ```
> > > > > > > 65c687d5cb3c4aa66c28a30a4f2aaf33169dc464
> > > > > > >
> > > > > > > ```

```
Please visit security.dxw.com for more information.

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](304)
[By Date](date.html#305)
[![Next](/images/right-icon-16x16.png)](306)

[![Previous](/images/left-icon-16x16.png)](303)
[By Thread](index.html#305)
[![Next](/images/right-icon-16x16.png)](308)

### Current thread:

* **Arbitrary code execution by admins in File Gallery 1.7.7 (WordPress plugin)** *dxw Security (Apr 29)*
  + [Re: Arbitrary code execution by admins in File Gallery 1.7.7 (WordPress plugin)](308) *Illwill (Apr 29)*
    - [Re: Arbitrary code execution by admins in File Gallery 1.7.7 (WordPress plugin)](312) *Dave Warren (Apr 29)*
      * [Re: Arbitrary code execution by admins in File Gallery 1.7.7 (WordPress plugin)](315) *Harry Metcalfe (Apr 30)** *Message not available** [Re: Arbitrary code execution by admins in File Gallery 1.7.7 (WordPress plugin)](316) *Harry Metcalfe (Apr 30)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from wordpress.org_d981b71a_20250124_201145.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

File Gallery

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Ffile-gallery&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Ffile-gallery&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/file-gallery_fdfbfb.svg)
# file-gallery

By [Bruno “Aesqe” Babic](http://skyphe.org)

* [Details](https://wordpress.org/plugins/file-gallery/#description)
* [Reviews](https://wordpress.org/plugins/file-gallery/#reviews)
* [Development](https://wordpress.org/plugins/file-gallery/#developers)

[Support](https://wordpress.org/support/plugin/file-gallery/)

## Description

This plugin has been closed as of March 7, 2024 and is not available for download. Reason: Security Issue.

## Reviews

![](https://secure.gravatar.com/avatar/93e12fcf26583c619847a43c49c7adac0c23586871f1537e5b443cfd052c2053?s=60&d=retro&r=g)
### [Best attachment plugin](https://wordpress.org/support/topic/best-attachment-plugin/)

[attila](https://profiles.wordpress.org/indeus/ "Posts by attila")
September 3, 2016

Simply the best!
No any conflict with any plugins or themes over several years.
Easy to use and “must have” Wordpress media tool for any developer!

[Read all 13 reviews](https://wordpress.org/support/plugin/file-gallery/reviews/)
## Contributors & Developers

“File Gallery” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/90c17f7f8408e251acb0f5432335a10a9737cf16764cef195f71b829022fb6d0?s=32&d=mm&r=g) [Aesqe](https://profiles.wordpress.org/aesqe/)

“File Gallery” has been translated into 1 locale. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/file-gallery/contributors) for their contributions.

[Translate “File Gallery” into your language.](https://translate.wordpress.org/projects/wp-plugins/file-gallery)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/file-gallery/), check out the [SVN repository](https://plugins.svn.wordpress.org/file-gallery/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/file-gallery/) by [RSS](https://plugins.trac.wordpress.org/log/file-gallery/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **1.8.5.4**
* Last updated **2 years ago**
* Active installations **N/A**
* WordPress version **4.0 or higher**
* Tested up to **4.9.26**
* Languages
  See all 2

  Close

  [English (US)](https://wordpress.org/plugins/file-gallery/) and [French (France)](https://fr.wordpress.org/plugins/file-gallery/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/file-gallery)
* [Advanced View](https://wordpress.org/plugins/file-gallery/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


