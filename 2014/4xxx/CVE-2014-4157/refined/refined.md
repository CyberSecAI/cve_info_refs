### Summary of CVE-2014-4157

**Root Cause:** The Linux kernel on MIPS architecture, prior to version 3.14.8, lacked proper configuration of `_TIF_SECCOMP` checks on the fast system call path. This oversight meant that when a process enabled seccomp (secure computing mode) using `prctl(PR_SET_SECCOMP, 1, ...)`, subsequent system calls weren't being filtered as intended when the fast path was used.

**Weaknesses/Vulnerabilities Present:**
*   **Missing Security Check:** The core vulnerability was the absence of a seccomp check in the fast system call path for MIPS. This path was taken when tracing or auditing wasn't enabled for a process.
*   **Bypass of seccomp Restrictions:**  The intended system call restrictions set by seccomp could be completely bypassed.

**Impact of Exploitation:**
*   **Privilege Escalation:** A local user, through a crafted application, could bypass restrictions imposed by `PR_SET_SECCOMP`, potentially allowing for unauthorized actions or privilege escalation.
*   **Circumvention of Security Policy:** The application could make system calls not allowed by the seccomp policy, effectively circumventing the intended security controls.

**Attack Vectors:**
*   **Local Execution:** The attack vector involves local execution of a specifically crafted application.

**Required Attacker Capabilities/Position:**
*   **Local User:** The attacker needs to have local user privileges on the MIPS system.
*   **Application Execution:**  The attacker needs to be able to execute arbitrary programs on the system.
*   **Knowledge of the Vulnerability**: The attacker needs to be aware of the lack of seccomp enforcement in the fast syscall path on MIPS

**Technical Details from the provided content:**
*   The vulnerability exists specifically on the MIPS platform where the `_TIF_SECCOMP` flag was not checked on the 'fast path' of syscall execution. The check only occurred on the 'slow path', which was only used when tracing or auditing was enabled for the task.
*   A test program was presented that reproduced the vulnerability using `prctl(PR_SET_SECCOMP, 1, ...)`, which did not trigger the intended SIGKILL when a subsequent `getuid()` system call was executed.
*   The fix for the vulnerability involves adding the `_TIF_SECCOMP` flag to the `_TIF_WORK_SYSCALL_ENTRY` definition within the MIPS thread information structure, ensuring that seccomp is checked regardless of whether tracing or auditing is enabled for the process.
*   The vulnerability is identified as CVE-2014-4157.
*   Patches for multiple kernel versions were created, demonstrating a need to fix the issue across various Linux kernel branches.
*   The issue was first reported against Linux kernel 3.2.x, indicating it was a long standing vulnerability on MIPS.