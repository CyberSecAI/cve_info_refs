```text
RELATED
```

### Vulnerability Details
- **Vulnerability:** Medium risk security vulnerability in Dolphin 7.1.4 and possibly earlier versions.
- **Root Cause:** SQL injection vulnerability in `administration/profiles.php` due to unsanitized input.
- **Attack Vector:** CSRF. An attacker needs to trick a logged-in administrator into visiting a web page containing a CSRF exploit.
- **Impact:** Successful exploitation can lead to SQL injection, allowing an attacker to perform unauthorized actions such as activating unconfirmed or suspended members.
- **Affected Versions:** Dolphin 7.1.4 and possibly earlier versions.
- **Mitigation:** Apply the provided manual fix to the `administration/profiles.php` file. This involves adding input validation and sanitization to prevent SQL injection.
```
1) Add the following code to administration/profiles.php file near ~38 line:
$sViewType = isset($_POST['adm-mp-members-view-type']) && in_array($_POST['adm-mp-members-view-type'], array('geeky', 'simple', 'extended')) ? $_POST['adm-mp-members-view-type'] : BX_DOL_ADM_MP_VIEW;
bx_import('BxDolForm');
$oChecker = new BxDolFormCheckerHelper();
//--- Process Actions ---//

2) Change ~43 line in administration/profiles.php file:
$GLOBALS['MySQL']->query("UPDATE `Profiles` SET `Status`='Active' WHERE `ID` IN ('" . implode("','", $_POST['members']) . "')");
to:
$GLOBALS['MySQL']->query("UPDATE `Profiles` SET `Status`='Active' WHERE `ID` IN ('" . implode("','", $oChecker->passInt($_POST['members'])) . "')");

3) Change ~60 line in administration/profiles.php file:
$GLOBALS['MySQL']->query("UPDATE `Profiles` SET `Status`='Approval' WHERE `ID` IN ('" . implode("','", $_POST['members']) . "')");
to:
$GLOBALS['MySQL']->query("UPDATE `Profiles` SET `Status`='Approval' WHERE `ID` IN ('" . implode("','", $oChecker->passInt($_POST['members'])) . "')");

4) Change ~72 line in administration/profiles.php file:
$GLOBALS['MySQL']->query("REPLACE INTO `sys_admin_ban_list` SET `ProfID`='" . $iId . "', `Time`='0',  `DateTime`=NOW()");
to:
$GLOBALS['MySQL']->query("REPLACE INTO `sys_admin_ban_list` SET `ProfID`='" . (int)$iId . "', `Time`='0',  `DateTime`=NOW()");

5) Change ~77 line in administration/profiles.php file:
$GLOBALS['MySQL']->query("DELETE FROM `sys_admin_ban_list` WHERE `ProfID` IN ('" . implode("','", $_POST['members']) . "')");
to:
$GLOBALS['MySQL']->query("DELETE FROM `sys_admin_ban_list` WHERE `ProfID` IN ('" . implode("','", $oChecker->passInt($_POST['members'])) . "')");
```